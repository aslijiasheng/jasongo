cscope 15 /Library/WebServer/Documents/truecolorpro/newpbi -q 0000013286 0003406573
	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/autoload.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

40 
	g$autŞßd
['·ckages'] = 
¬¿y
();

55 
	g$autŞßd
['lib¿r›s'] = 
¬¿y
('database','session');

67 
	g$autŞßd
['h–³r'] = 
¬¿y
('url');

83 
	g$autŞßd
['cÚfig'] = 
¬¿y
();

99 
	g$autŞßd
['Ïnguage'] = 
¬¿y
();

112 
	g$autŞßd
['mod–'] = 
¬¿y
();

124 
	g$autŞßd
['cÚŒŞËr'] = 
¬¿y
();

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/config.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

17 
	g$cÚfig
['base_url'] = 'http://localhost/truecolorpro/newpbi';

29 
	g$cÚfig
['index_page'] = 'index.php';

47 
	g$cÚfig
['uri_protocol'] = 'AUTO';

60 
	g$cÚfig
['url_suffix'] = '';

72 
	g$cÚfig
['language'] = 'ch';

83 
	g$cÚfig
['charset'] = 'UTF-8';

94 
	g$cÚfig
['’abË_hooks'] = 
TRUE
;

109 
	g$cÚfig
['subclass_prefix'] = 'MY_';

129 
	g$cÚfig
['permitted_uri_chars'] = 'a-z 0-9~%.:_\-';

157 
	g$cÚfig
['®low_g‘_¬¿y'] = 
TRUE
;

158 
	g$cÚfig
['’abË_qu”y_¡ršgs'] = 
FALSE
;

159 
	g$cÚfig
['controller_trigger'] = 'c';

160 
	g$cÚfig
['function_trigger'] = 'm';

161 
	g$cÚfig
['directory_trigger'] = 'd';

183 
	g$cÚfig
['log_threshold'] = 0;

194 
	g$cÚfig
['log_path'] = '';

205 
	g$cÚfig
['log_date_format'] = 'Y-m-d H:i:s';

216 
	g$cÚfig
['cache_path'] = '';

227 
	g$cÚfig
['encryption_key'] = 'asdfa3wasa4#gfa/saa';

247 
	g$cÚfig
['sess_cookie_name'] = 'ci_session';

248 
	g$cÚfig
['sess_expiration'] = 7200;

249 
	g$cÚfig
['£ss_expœe_Ú_şo£'] = 
FALSE
;

250 
	g$cÚfig
['£ss_’üy±_cook›'] = 
FALSE
;

251 
	g$cÚfig
['£ss_u£_d©aba£'] = 
FALSE
;

252 
	g$cÚfig
['sess_table_name'] = 'ci_sessions';

253 
	g$cÚfig
['£ss_m©ch_'] = 
FALSE
;

254 
	g$cÚfig
['£ss_m©ch_u£¿g’t'] = 
TRUE
;

255 
	g$cÚfig
['sess_time_to_update'] = 300;

268 
	g$cÚfig
['cookie_prefix'] = "";

269 
	g$cÚfig
['cookie_domain'] = "";

270 
	g$cÚfig
['cookie_path'] = "/";

271 
	g$cÚfig
['cook›_£cu»'] = 
FALSE
;

282 
	g$cÚfig
['glob®_xss_f‹ršg'] = 
FALSE
;

296 
	g$cÚfig
['c¤f_´ÙeùiÚ'] = 
FALSE
;

297 
	g$cÚfig
['csrf_token_name'] = 'csrf_test_name';

298 
	g$cÚfig
['csrf_cookie_name'] = 'csrf_cookie_name';

299 
	g$cÚfig
['csrf_expire'] = 7200;

318 
	g$cÚfig
['com´ess_ouut'] = 
FALSE
;

331 
	g$cÚfig
['time_reference'] = 'local';

344 
	g$cÚfig
['»wr™e_shÜt_gs'] = 
FALSE
;

358 
	g$cÚfig
['proxy_ips'] = '';

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/constants.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

16 
defše
('FILE_READ_MODE', 0644);

17 
defše
('FILE_WRITE_MODE', 0666);

18 
defše
('DIR_READ_MODE', 0755);

19 
defše
('DIR_WRITE_MODE', 0777);

30 
defše
('FOPEN_READ', 'rb');

31 
defše
('FOPEN_READ_WRITE', 'r+b');

32 
defše
('FOPEN_WRITE_CREATE_DESTRUCTIVE', 'wb');

33 
defše
('FOPEN_READ_WRITE_CREATE_DESTRUCTIVE', 'w+b');

34 
defše
('FOPEN_WRITE_CREATE', 'ab');

35 
defše
('FOPEN_READ_WRITE_CREATE', 'a+b');

36 
defše
('FOPEN_WRITE_CREATE_STRICT', 'xb');

37 
defše
('FOPEN_READ_WRITE_CREATE_STRICT', 'x+b');

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/database.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

48 
	g$aùive_group
 = 'default';

49 
	g$aùive_»cÜd
 = 
TRUE
;

51 
	g$db
['default']['hostname'] = 'localhost';

52 
	g$db
['default']['username'] = 'root';

53 
	g$db
['default']['password'] = '871027';

54 
	g$db
['default']['database'] = 'newpbi';

55 
	g$db
['default']['dbdriver'] = "mysql";

56 
	g$db
['default']['dbprefix'] = "";

57 
	g$db
['deçuÉ']['pcÚÃù'] = 
TRUE
;

58 
	g$db
['deçuÉ']['db_debug'] = 
FALSE
;

59 
	g$db
['deçuÉ']['ÿche_Ú'] = 
FALSE
;

60 
	g$db
['default']['cachedir'] = "";

61 
	g$db
['default']['char_set'] = "UTF-8";

62 
	g$db
['default']['dbcollat'] = "utf8_general_ci";

63 
	g$db
['default']['swap_pre'] = '';

64 
	g$db
['deçuÉ']['autoš™'] = 
TRUE
;

65 
	g$db
['deçuÉ']['¡riùÚ'] = 
FALSE
;

68 
	g$db
['portal']['hostname'] = 'localhost';

69 
	g$db
['portal']['username'] = 'sky';

70 
	g$db
['portal']['password'] = '826031';

71 
	g$db
['portal']['database'] = 'sky';

72 
	g$db
['portal']['dbdriver'] = "postgre";

73 
	g$db
['portal']['dbprefix'] = "";

74 
	g$db
['pÜl']['pcÚÃù'] = 
TRUE
;

75 
	g$db
['pÜl']['db_debug'] = 
FALSE
;

76 
	g$db
['pÜl']['ÿche_Ú'] = 
FALSE
;

77 
	g$db
['portal']['cachedir'] = "";

78 
	g$db
['portal']['char_set'] = "UTF-8";

79 
	g$db
['portal']['dbcollat'] = "utf8_general_ci";

80 
	g$db
['portal']['swap_pre'] = '';

81 
	g$db
['pÜl']['autoš™'] = 
TRUE
;

82 
	g$db
['pÜl']['¡riùÚ'] = 
FALSE
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/doctypes.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

3 
	g$_doùy³s
 = 
¬¿y
(

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/foreign_chars.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

10 
	g$fÜeign_ch¬aù”s
 = 
¬¿y
(

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/hooks.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/migration.php

1 <?
php
 
defšed
('BASEPATH'è
OR
 
ex™
('No direct script‡ccess‡llowed');

11 
	g$cÚfig
['mig¿tiÚ_’abËd'] = 
FALSE
;

24 
	g$cÚfig
['migration_version'] = 0;

37 
	g$cÚfig
['mig¿tiÚ_·th'] = 
APPPATH
 . 'migrations/';

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/mimes.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

11 
	g$mimes
 = 
¬¿y
( 'hqx' => 'application/mac-binhex40',

13 'csv' => 
¬¿y
('text/x-comma-separated-values', 'text/comma-separated-values', 'application/octet-stream', 'application/vnd.ms-excel', 'application/x-csv', 'text/x-csv', 'text/csv', 'application/csv', 'application/excel', 'application/vnd.msexcel','application/force-download'),

18 'exe' => 
¬¿y
('application/octet-stream', 'application/x-msdownload'),

25 'pdf' => 
¬¿y
('application/pdf', 'application/x-download'),

32 'xls' => 
¬¿y
('application/excel', 'application/vnd.ms-excel', 'application/msexcel'),

33 'µt' => 
¬¿y
('application/powerpoint', 'application/vnd.ms-powerpoint'),

51 'tgz' => 
¬¿y
('application/x-tar', 'application/x-gzip-compressed'),

54 'z' => 
¬¿y
('application/x-zip', 'application/zip', 'application/x-zip-compressed'),

59 'mp3' => 
¬¿y
('audio/mpeg', 'audio/mpg', 'audio/mpeg3', 'audio/mp3'),

68 'wav' => 
¬¿y
('audio/x-wav', 'audio/wave', 'audio/wav'),

69 'bmp' => 
¬¿y
('image/bmp', 'image/x-windows-bmp'),

71 'j³g' => 
¬¿y
('image/jpeg', 'image/pjpeg'),

72 'jpg' => 
¬¿y
('image/jpeg', 'image/pjpeg'),

73 'j³' => 
¬¿y
('image/jpeg', 'image/pjpeg'),

74 '²g' => 
¬¿y
('image/png', 'image/x-png'),

83 'log' => 
¬¿y
('text/plain', 'text/x-log'),

96 'docx' => 
¬¿y
('application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/zip'),

97 'xlsx' => 
¬¿y
('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/zip'),

98 'wÜd' => 
¬¿y
('application/msword', 'application/octet-stream'),

101 'jsÚ' => 
¬¿y
('application/json', 'text/json')

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/profiler.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/routes.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

41 
	g$rou‹
['default_controller'] = "www/home";

42 
	g$rou‹
['404_override'] = '';

43 
	g$rou‹
['admin']='admin/home';

45 
	g$rou‹
['www']='www/home';

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/smileys.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

15 
	g$smeys
 = 
¬¿y
(

19 ':-)' => 
¬¿y
('grin.gif', '19', '19', 'grin'),

20 ':lŞ:' => 
¬¿y
('lol.gif', '19', '19', 'LOL'),

21 ':ch“£:' => 
¬¿y
('cheese.gif', '19', '19', 'cheese'),

22 ':)' => 
¬¿y
('smile.gif', '19', '19', 'smile'),

23 ';-)' => 
¬¿y
('wink.gif', '19', '19', 'wink'),

24 ';)' => 
¬¿y
('wink.gif', '19', '19', 'wink'),

25 ':smœk:' => 
¬¿y
('smirk.gif', '19', '19', 'smirk'),

26 ':rŞl:' => 
¬¿y
('rolleyes.gif', '19', '19', 'rolleyes'),

27 ':-S' => 
¬¿y
('confused.gif', '19', '19', 'confused'),

28 ':wow:' => 
¬¿y
('surprise.gif', '19', '19', 'surprised'),

29 ':bug:' => 
¬¿y
('bigsurprise.gif', '19', '19', 'big surprise'),

30 ':-P' => 
¬¿y
('tongue_laugh.gif', '19', '19', 'tongue†augh'),

31 '%-P' => 
¬¿y
('tongue_rolleye.gif', '19', '19', 'tongue„olleye'),

32 ';-P' => 
¬¿y
('tongue_wink.gif', '19', '19', 'tongue wink'),

33 ':P' => 
¬¿y
('raspberry.gif', '19', '19', 'raspberry'),

34 ':bÏnk:' => 
¬¿y
('blank.gif', '19', '19', 'blank stare'),

35 ':lÚg:' => 
¬¿y
('longface.gif', '19', '19', 'long face'),

36 ':ohh:' => 
¬¿y
('ohh.gif', '19', '19', 'ohh'),

37 ':g¼r:' => 
¬¿y
('grrr.gif', '19', '19', 'grrr'),

38 ':guÍ:' => 
¬¿y
('gulp.gif', '19', '19', 'gulp'),

39 '8-/' => 
¬¿y
('ohoh.gif', '19', '19', 'oh oh'),

40 ':down:' => 
¬¿y
('downer.gif', '19', '19', 'downer'),

41 ':»d:' => 
¬¿y
('embarrassed.gif', '19', '19', 'red face'),

42 ':sick:' => 
¬¿y
('sick.gif', '19', '19', 'sick'),

43 ':shut:' => 
¬¿y
('shuteye.gif', '19', '19', 'shutƒye'),

44 ':-/' => 
¬¿y
('hmm.gif', '19', '19', 'hmmm'),

45 '>:(' => 
¬¿y
('mad.gif', '19', '19', 'mad'),

46 ':mad:' => 
¬¿y
('mad.gif', '19', '19', 'mad'),

47 '>:-(' => 
¬¿y
('angry.gif', '19', '19', 'angry'),

48 ':ªgry:' => 
¬¿y
('angry.gif', '19', '19', 'angry'),

49 ':z:' => 
¬¿y
('zip.gif', '19', '19', 'zipper'),

50 ':kiss:' => 
¬¿y
('kiss.gif', '19', '19', 'kiss'),

51 ':ahhh:' => 
¬¿y
('shock.gif', '19', '19', 'shock'),

52 ':coŞsme:' => 
¬¿y
('shade_smile.gif', '19', '19', 'cool smile'),

53 ':coŞsmœk:' => 
¬¿y
('shade_smirk.gif', '19', '19', 'cool smirk'),

54 ':coŞgrš:' => 
¬¿y
('shade_grin.gif', '19', '19', 'cool grin'),

55 ':coŞhmm:' => 
¬¿y
('shade_hmm.gif', '19', '19', 'cool hmm'),

56 ':coŞmad:' => 
¬¿y
('shade_mad.gif', '19', '19', 'cool mad'),

57 ':coŞch“£:' => 
¬¿y
('shade_cheese.gif', '19', '19', 'cool cheese'),

58 ':vampœe:' => 
¬¿y
('vampire.gif', '19', '19', 'vampire'),

59 ':¢ake:' => 
¬¿y
('snake.gif', '19', '19', 'snake'),

60 ':exşaim:' => 
¬¿y
('exclaim.gif', '19', '19', 'excaim'),

61 ':que¡iÚ:' => 
¬¿y
('question.gif', '19', '19', 'question')

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/config/user_agents.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

13 
	g$¶©fÜms
 = 
¬¿y
 (

50 
	g$brow£rs
 = 
¬¿y
(

75 
	g$mobes
 = 
¬¿y
(

166 
	g$robÙs
 = 
¬¿y
(

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/admin/enum.php

1 <?
php


2 şas 
	cEnum
 
ex‹nds
 
	mWWW_cÚŒŞËr
{

3 
public
 
funùiÚ
 
	$__cÚ¡ruù
(){

4 
·»Á
::
	`__cÚ¡ruù
();

5 
$this
->
lßd
->
	`mod–
('admin/enum_model','enum');

8 
public
 
funùiÚ
 
	$S–eùChdEnums
(){

9 
$OrgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

10 
$©Œ_Çme
 = 
$_POST
['attr_name'];

11 
$¬r
 = 
	`ex¶ode
(".", 
$©Œ_Çme
);

12 
$’um_key
 = 
$_POST
['enum_key'];

13 
$LªgID
 = 2;

14 
$d©a
=
$this
->->
	`S–eùChdEnums
(
$©Œ_Çme
,
$’um_key
,
$OrgID
,
$LªgID
,
$¬r
[0]);

19 
echo
 
	`jsÚ_’code
(
$d©a
);

20 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/admin/home.php

1 <?
php


2 
CÏss
 
Home
 
ex‹nds
 
	gADMIN_cÚŒŞËr
{

3 
public
 
funùiÚ
 
__cÚ¡ruùiÚ
(){

4 
	g·»Á
::
__cÚ¡ruùiÚ
;

7 
public
 
funùiÚ
 
šdex
(){

8 
	g$this
->
	glßd
->
lib¿ry
('session');

9 if(
is£t
(
$this
->
£ssiÚ
->
u£rd©a
['user_id'])){

10 if(
	g$this
->
	g£ssiÚ
->
	gu£rd©a
['is_admin']==1){

11 
$this
->
homes
();

14 
»dœeù
('www/login');

21 
public
 
funùiÚ
 
out
(){

22 
	g$this
->
	g£ssiÚ
->
£ss_de¡roy
();

23 
»dœeù
("admin/");

29 
public
 
funùiÚ
 
homes
(){

30 
	g$d©a
 = "";

31 
	g$this
->
»nd”
('admš/home/home',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/admin/install.php

1 <?
php


10 şas 
	cIn¡®l
 
ex‹nds
 
	mADMIN_CÚŒŞËr
{

11 
public
 
funùiÚ
 
	$__cÚ¡ruù
(){

12 
·»Á
::
	`__cÚ¡ruù
();

15 
public
 
funùiÚ
 
	$šdex
(){

18 
echo
 "å®‰è£…";

19 
	}
}

24 
public
 
funùiÚ
 
	$add_db
(){

26 
$this
->
	`AT_sys_mod–
();

28 
$this
->
	`AF_u£r
();

29 
$this
->
	`AF_m’u
();

30 
$this
->
	`AF_©Œ
();

32 
echo
 "è¯­å¥åˆ›å»ºå®Œæ¯•<br>";

35 
	}
}

40 
public
 
funùiÚ
 
	$UD_®l
(){

41 
$sql
 = "";

42 
$this
->
db
->
	`qu”y
(
$sql
);

43 
	}
}

52 
public
 
funùiÚ
 
	$AF_u£r
(){

53 if(!
$this
->
	`TabËIsF›ld
('tc_user','lee_password')){

55 
$sql
 = "alterablec_user‡dd†ee_password NVARCHAR2(128)";

56 
$this
->
db
->
	`qu”y
(
$sql
);

58 
	}
}

64 
public
 
funùiÚ
 
	$AF_©Œ
(){

65 if(
$this
->
	`TabËIsF›ld
('dd_attribute','lee_is_query')){

66 
$sql
 = "alterable dd_attribute drop (lee_is_query)";

67 
$this
->
db
->
	`qu”y
(
$sql
);

70 
$sql
 = "alterable dd_attribute‡dd†ee_is_query NUMBER(6) DEFAULT 0 ";

71 
$this
->
db
->
	`qu”y
(
$sql
);

73 
$sql
 = "update dd_attribute set†ee_is_query = 1 where obj_name = 'Lead'‡nd org_id = 1‡nd‡ttr_name†ike '%.Department'";

74 
$this
->
db
->
	`qu”y
(
$sql
);

77 if(
$this
->
	`TabËIsF›ld
('dd_attribute','lee_refer_obj_type')){

78 
$sql
 = "alterable dd_attribute drop (lee_refer_obj_type)";

79 
$this
->
db
->
	`qu”y
(
$sql
);

81 
$sql
 = "alterable dd_attribute‡dd†ee_refer_obj_type NVARCHAR2(128)";

82 
$this
->
db
->
	`qu”y
(
$sql
);

85 
$sql
 = "update dd_attribute set†ee_refer_obj_type = 'Account.SrcType' where obj_name = 'Account'‡nd org_id = 1‡nd‡ttr_name = 'Account.SrcObject'";

86 
$this
->
db
->
	`qu”y
(
$sql
);

89 if(
$this
->
	`TabËIsF›ld
('dd_attribute','lee_calc_formula')){

90 
$sql
 = "alterable dd_attribute drop (lee_calc_formula)";

91 
$this
->
db
->
	`qu”y
(
$sql
);

93 
$sql
 = "alterable dd_attribute‡dd†ee_calc_formula NVARCHAR2(255)";

94 
$this
->
db
->
	`qu”y
(
$sql
);

101 if(
$this
->
	`TabËIsF›ld
('dd_attribute','lee_is_calc_point')){

102 
$sql
 = "alterable dd_attribute drop (lee_is_calc_point)";

103 
$this
->
db
->
	`qu”y
(
$sql
);

105 
$sql
 = "alterable dd_attribute‡dd†ee_is_calc_point NUMBER(6) DEFAULT 0";

106 
$this
->
db
->
	`qu”y
(
$sql
);

109 if(
$this
->
	`TabËIsF›ld
('dd_attribute','lee_calc_result_attr')){

110 
$sql
 = "alterable dd_attribute drop (lee_calc_result_attr)";

111 
$this
->
db
->
	`qu”y
(
$sql
);

113 
$sql
 = "alterable dd_attribute‡dd†ee_calc_result_attr NVARCHAR2(128)";

114 
$this
->
db
->
	`qu”y
(
$sql
);

118 
$sql
="

119 
upd©e
 
dd_©Œibu‹


120 
£t
 
Ëe_ÿlc_fÜmuÏ
 = '{INTSUM(#OµÜtun™yI‹m.Quªt™y#)}', 
Ëe_is_ÿlc_pošt
 = 0, 
Ëe_ÿlc_»suÉ_©Œ
 = ''

121 
wh”e
 
©Œ_Çme
 = 
N
'Opportunity.Quantity'

123 
$this
->
db
->
	`qu”y
(
$sql
);

125 
$sql
 = "update dd_attribute

126 
£t
 
Ëe_ÿlc_fÜmuÏ
 = '', 
Ëe_is_ÿlc_pošt
 = 1, 
Ëe_ÿlc_»suÉ_©Œ
 = 'OpportunityItem.Amount,OpportunityItem.FinalPrice,Opportunity.Quantity'

127 
wh”e
 
©Œ_Çme
 = 
N
'OpportunityItem.Quantity'";

128 
$this
->
db
->
	`qu”y
(
$sql
);

130 
$sql
 = "update dd_attribute

131 
£t
 
Ëe_ÿlc_fÜmuÏ
 = '#OµÜtun™yI‹m.AmouÁ#/#OµÜtun™yI‹m.Quªt™y#', 
Ëe_is_ÿlc_pošt
 = 1, 
Ëe_ÿlc_»suÉ_©Œ
 = 'OpportunityItem.Amount'

132 
wh”e
 
©Œ_Çme
 = 
N
'OpportunityItem.FinalPrice'";

133 
$this
->
db
->
	`qu”y
(
$sql
);

135 
$sql
 = "update dd_attribute

136 
£t
 
Ëe_ÿlc_fÜmuÏ
 = '#OµÜtun™yI‹m.Fš®Priû#*#OµÜtun™yI‹m.Quªt™y#', 
Ëe_is_ÿlc_pošt
 = 1, 
Ëe_ÿlc_»suÉ_©Œ
 = 'Opportunity.Amount,OpportunityItem.FinalPrice'

137 
wh”e
 
©Œ_Çme
 = 
N
'OpportunityItem.Amount'";

138 
$this
->
db
->
	`qu”y
(
$sql
);

140 
$sql
 = "update dd_attribute

141 
£t
 
Ëe_ÿlc_fÜmuÏ
 = '{INTSUM(#OµÜtun™yI‹m.AmouÁ#)}', 
Ëe_is_ÿlc_pošt
 = 0, 
Ëe_ÿlc_»suÉ_©Œ
 = ''

142 
wh”e
 
©Œ_Çme
 = 
N
'Opportunity.Amount'";

143 
$this
->
db
->
	`qu”y
(
$sql
);

144 
	}
}

149 
public
 
funùiÚ
 
	$AF_»l_´ofe
() {

150 if(
$this
->
	`TabËIsF›ld
('tc_user_rel_profile','lee_condition')){

151 
$sql
 = "alterablec_menu drop (lee_condition)";

152 
$this
->
db
->
	`qu”y
(
$sql
);

155 
$sql
 = "alterablec_user_rel_profile‡dd†ee_condition NVARCHAR2(300)";

156 
$this
->
db
->
	`qu”y
(
$sql
);

158 
	}
}

163 
public
 
funùiÚ
 
	$AF_m’u
(){

164 if(
$this
->
	`TabËIsF›ld
('tc_menu','lee_url')){

165 
$sql
 = "alterablec_menu drop (lee_url)";

166 
$this
->
db
->
	`qu”y
(
$sql
);

169 
$sql
 = "alterablec_menu‡dd†ee_url NVARCHAR2(300)";

170 
$this
->
db
->
	`qu”y
(
$sql
);

172 if(
$this
->
	`TabËIsF›ld
('tc_menu','lee_icon')){

173 
$sql
 = "alterablec_menu drop (lee_icon)";

174 
$this
->
db
->
	`qu”y
(
$sql
);

177 
$sql
 = "alterablec_menu‡dd†ee_icon NVARCHAR2(100)";

178 
$this
->
db
->
	`qu”y
(
$sql
);

181 if(
$this
->
	`TabËIsF›ld
('tc_menu','lee_stop_flag')){

182 
$sql
 = "alterablec_menu drop (lee_stop_flag)";

183 
$this
->
db
->
	`qu”y
(
$sql
);

186 
$sql
 = "alterablec_menu‡dd†ee_stop_flag NUMBER(6) default 0";

187 
$this
->
db
->
	`qu”y
(
$sql
);

192 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-crosshairs',lee_url = '' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 1";

193 
$this
->
db
->
	`qu”y
(
$sql
);

195 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list',lee_url='www/objects/lists?obj_type=3' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 3";

196 
$this
->
db
->
	`qu”y
(
$sql
);

198 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-user',lee_url = '' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 9";

199 
$this
->
db
->
	`qu”y
(
$sql
);

201 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list',lee_url='www/objects/lists?obj_type=1' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 11";

202 
$this
->
db
->
	`qu”y
(
$sql
);

204 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-globe',lee_url = '' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 25";

205 
$this
->
db
->
	`qu”y
(
$sql
);

207 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list',lee_url = 'www/objects/lists?obj_type=8' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 27";

208 
$this
->
db
->
	`qu”y
(
$sql
);

210 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-suitcase',lee_url = '' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 3047";

211 
$this
->
db
->
	`qu”y
(
$sql
);

213 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list',lee_url = 'www/objects/lists?obj_type=2003' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 3048";

214 
$this
->
db
->
	`qu”y
(
$sql
);

216 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-phone',lee_url = '' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 17";

217 
$this
->
db
->
	`qu”y
(
$sql
);

219 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list',lee_url = 'www/objects/lists?obj_type=2' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 19";

220 
$this
->
db
->
	`qu”y
(
$sql
);

222 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-money',lee_url = '' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 41";

223 
$this
->
db
->
	`qu”y
(
$sql
);

225 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list',lee_url = 'www/objects/lists?obj_type=4' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 43";

226 
$this
->
db
->
	`qu”y
(
$sql
);

228 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list-alt',lee_url = 'www/objects/lists?obj_type=23' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 419";

229 
$this
->
db
->
	`qu”y
(
$sql
);

232 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-pencil',lee_url = '' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 57";

233 
$this
->
db
->
	`qu”y
(
$sql
);

235 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list',lee_url = 'www/objects/lists?obj_type=6' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 59";

236 
$this
->
db
->
	`qu”y
(
$sql
);

238 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list-alt',lee_url = 'www/objects/lists?obj_type=13' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 416";

239 
$this
->
db
->
	`qu”y
(
$sql
);

242 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-comments-o',lee_url = '' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 372";

243 
$this
->
db
->
	`qu”y
(
$sql
);

245 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list',lee_url = 'www/objects/lists?obj_type=51' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 373";

246 
$this
->
db
->
	`qu”y
(
$sql
);

249 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-file-text-o',lee_url = '' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 3287";

250 
$this
->
db
->
	`qu”y
(
$sql
);

252 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list',lee_url = 'www/objects/lists?obj_type=2004' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 3293";

253 
$this
->
db
->
	`qu”y
(
$sql
);

255 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-list-alt',lee_url = 'www/objects/lists?obj_type=2005' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 3316";

256 
$this
->
db
->
	`qu”y
(
$sql
);

260 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-link',lee_url = 'http://npbi.ishopex.cn/' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 3187";

261 
$this
->
db
->
	`qu”y
(
$sql
);

264 
$sql
 = "updatec_menu set†ee_icon = 'fa fa-link',lee_url = 'http://192.168.0.61:8036/' where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id = 3320";

265 
$this
->
db
->
	`qu”y
(
$sql
);

270 
$sql
 = "updatec_menu set†ee_stop_flag=1 where org_id = 1‡nd sys_type = 'CRM'‡nd menu_id in (

373 
$this
->
db
->
	`qu”y
(
$sql
);

375 
	}
}

380 
public
 
funùiÚ
 
	$AT_sys_mod–
(){

381 if(
$this
->
	`IsTabË
('LEE_SYS_MODEL')){

382 
$sql
 = "DROP TABLE LEE_SYS_MODEL";

383 
$this
->
db
->
	`qu”y
(
$sql
);

385 
$sql
 = "

386 
ü—‹
 
bË
 
	`LEE_SYS_MODEL
(

387 
SYS_ID
 
	`NUMBER
(22è 0 
nÙ
 
nuÎ
,

388 
SYS_NAME
 
	`NVARCHAR2
(128è
nÙ
 
nuÎ
,

389 
SYS_URL
 
	`NVARCHAR2
(300),

390 
PRIMARY
 
	`KEY
 (
SYS_ID
)

393 
$this
->
db
->
	`qu”y
(
$sql
);

395 
$sql
 = "insert into LEE_SYS_MODEL (SYS_ID, SYS_NAME, SYS_URL) values (20000, 'KEY', 'admin')";

396 
$this
->
db
->
	`qu”y
(
$sql
);

397 
$sql
 = "insert into LEE_SYS_MODEL (SYS_ID, SYS_NAME, SYS_URL) values (1, 'CRM', 'www')";

398 
$this
->
db
->
	`qu”y
(
$sql
);

399 
	}
}

407 
public
 
funùiÚ
 
	$TabËIsF›ld
(
$bË_Çme
,
$f›ld_Çme
){

409 
$bË_Çme
 = 
	`¡¹ouµ”
($table_name);

410 
$f›ld_Çme
 = 
	`¡¹ouµ”
($field_name);

411 
$sql
 = "£Ëù couÁ(1ècouÁ from sys.u£r_b_cŞumn wh”bË_Çme='".
$bË_Çme
."'‡nd cŞumn_Çmğ'".
$f›ld_Çme
."'";

412 
$d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

414 if(
$d©a
[0]['COUNT']>0){

415  
Œue
;

417  
çl£
;

419 
	}
}

426 
public
 
funùiÚ
 
	$IsTabË
(
$bË_Çme
){

428 
$bË_Çme
 = 
	`¡¹ouµ”
($table_name);

429 
$sql
 = "£Ëù couÁ(1ècouÁ from sys.u£r_b_cŞumn wh”bË_Çme='".
$bË_Çme
."'";

430 
$d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

432 if(
$d©a
[0]['COUNT']>0){

433  
Œue
;

435  
çl£
;

437 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/admin/login.php

1 <?
php


2 şas 
	cLogš
 
ex‹nds
 
	mWWW_cÚŒŞËr
{

3 
public
 
funùiÚ
 
	$__cÚ¡ruù
(){

4 
·»Á
::
	`__cÚ¡ruù
();

5 
$this
->
lßd
->
	`mod–
('www/user_model','user');

8 
public
 
funùiÚ
 
	$šdex
(){

9 
$”rÜ
="";

10 
$d©a
['”rÜ']=
$”rÜ
;

11 if(
	`is£t
(
$_GET
["sys"])){

12 
$d©a
['logš_sys']=
$_GET
["sys"];

15 if(!
	`em±y
(
$_POST
['user'])){

16 
$d©a
['logš_Çme']=
$_POST
['user']["login_name"];

17 
$d©a
['·sswÜd']=
$_POST
['user']["password"];

18 
$d©a
['Ügcode']=
$_POST
['user']["orgcode"];

19 
$d©a
['logš_sys']=
$_POST
['user']["login_sys"];

21 
$d©a
['”rÜ'] = 
$this
->
u£r
->
	`CheckLogš
(
$_POST
['user']["login_sys"],$_POST['user']['login_name'],$_POST['user']['password'],"ShopEx");

23 
$this
->
lßd
->
	`v›w
('www/logš/šdex',
$d©a
);

24 
	}
}

26 
public
 
funùiÚ
 
	$logout
(){

27 
$this
->
lßd
->
	`lib¿ry
('session');

28 
$this
->
£ssiÚ
->
	`£ss_de¡roy
();

29 
$this
->
	`šdex
();

30 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/announcement.php

1 <?
php


2 
CÏss
 
AÂounûm’t
 
ex‹nds
 
	gWWW_cÚŒŞËr
{

4 
´iv©e
 
	g$htmlP©h
 = "htmltemplete/announcement/@.html";

6 
funùiÚ
 
__cÚ¡ruù
(){

7 
	g·»Á
::
__cÚ¡ruù
();

8 
	g$this
->
	glßd
->
mod–
('www/announcement_model', 'announcementModel');

9 
	g$this
->
	glßd
->
mod–
('www/marteria_model', 'marteria');

18 
public
 
funùiÚ
 
cked™MuÉiFes
(){

19 
	g$mes§ge
 = '';

20 
	g$feName
 = 
$_FILES
['upload']['name'];

21 
	g$feTmpDœ
 = 
$_FILES
['upload']['tmp_name'];

22 
	g$funcNum
 = 
$_GET
['CKEditorFuncNum'];

23 
	g$CKEd™Ü
 = 
$_GET
['CKEditor'];

24 
	g$ÏngCode
 = 
$_GET
['langCode'];

25 
	g$»tWr™eP©h
 = 
$this
->
m¬‹rŸ
->
§veM¬‹rŸP©h
(
$feTmpDœ
, 
$feName
);

26 
	g$»tWr™eP©h
){

28 
$mes§ge
 = 'fileExtension isƒrror';

31 
$wr™”Pic
 = 
ba£_u¾
(è. 
$»tWr™eP©h
;

32 
	g$m¬‹rŸD©a
 = 
¬¿y
();

33 
	g$m¬‹rŸD©a
['m¬‹rŸ_·th'] = 
$wr™”Pic
;

34 
	g$m¬‹rŸD©a
['m¬‹rŸ_is_¡©us'] = 
TRUE
;

35 
	g$m¬‹rŸID
 = 
$this
->
m¬‹rŸ
->
addM¬‹rŸ
(
$m¬‹rŸD©a
);

36 if(!
	g$m¬‹rŸID
è
	g$mes§ge
 = 'marteriaData‡dd is FALSE';

39 
	gecho
 "<scriptype='text/javascript'>innerAnnouncement({$marteriaID});window.parent.CKEDITOR.tools.callFunction($funcNum, '$bannerPic', '$message');</script>";

48 
public
 
funùiÚ
 
v›wAùiÚ
(){

49 
	g$ªnounûm’tD©a
 = 
$this
->
ªnounûm’tMod–
->
g‘AÂounûm’tD©a
();

50 
	g$this
->
»nd”
('www/pÜl/ªnounûm’t', 
¬¿y
('ªnounûm’tD©a' => 
$ªnounûm’tD©a
));

59 
public
 
funùiÚ
 
addAÂounûm’t
(){

60 
	g$ªnounûm’tT™Ë
 = 
$this
->
šput
->
po¡
("announcement_title");

61 
	g$ªnounûm’tPic
 = 
$this
->
šput
->
po¡
("announcement_pic");

62 
	g$ªnounûm’tC»©eD©e
 = 
¡¹Ùime
(
d©e
('Y-m-d'));

63 
	g$ªnounûm’tTag
 = 
$this
->
šput
->
po¡
("announcement_tag");

64 
	g$ªnounûm’tHtml
 = 
$this
->
šput
->
po¡
("announcement_html");

65 
	g$ªnounûm’tC»©eU£rName
 = 
em±y
(
$this
->
šput
->
po¡
("ªnounûm’t_ü—‹_u£r")è? $this->
£ssiÚ
->
u£rd©a
['user_name'] : $this->input->post("announcement_create_user");

66 
	g$ªnounûm’tIsStus
 = 
£lf
::
cÚv”Stus
(1);

67 
	g$ªnounûm’tD©a
 = 
¬¿y
(

68 "ªnounûm’t_t™Ë" => 
$ªnounûm’tT™Ë
,

69 "ªnounûm’t_pic" => 
$ªnounûm’tPic
,

70 "ªnounûm’t_ü—‹_d©e" => 
$ªnounûm’tC»©eD©e
,

71 "ªnounûm’t_g" => 
$ªnounûm’tTag
,

72 "ªnounûm’t_html_·th" => 
£lf
::
$htmlP©h
,

73 "ªnounûm’t_is_¡©us" => 
$ªnounûm’tIsStus
,

74 "ªnounûm’t_ü—‹_u£r" => 
$ªnounûm’tC»©eU£rName
,

76 
	g$»t
 = 
$this
->
ªnounûm’tMod–
->
addAÂounûm’t
(
$ªnounûm’tD©a
);

77 if(
	g$»t
){

78 
	g$ªnounûm’tHtmlP©h
 = 
£lf
::
ªnounûm’tSaveHtmlP©h
(
$»t
, 
$ªnounûm’tHtml
);

79 
	g$ªnounûm’tUpD©a
 = 
¬¿y
(

80 "ªnounûm’t_html_·th" => 
$ªnounûm’tHtmlP©h
,

82 
	g$»t
 = 
$this
->
ªnounûm’tMod–
->
upd©eAÂounûm’t
(
$»t
, 
$ªnounûm’tUpD©a
);

84 
	g$this
->
£nd”
(
$»t
);

85 
	gd›
;

88 
public
 
funùiÚ
 
d–AÂounûm’t
(){

89 
	g$ªnounûm’tID
 = 
štv®
(
$this
->
šput
->
po¡
('announcement_id'));

90 
	g$»t
 = 
$this
->
ªnounûm’tMod–
->
upd©eAÂounûm’t
(
$ªnounûm’tID
, 
¬¿y
('announcement_is_status' => 'FALSE'));

91 
d›
(
$»t
);

94 
public
 
funùiÚ
 
v›wAÂounûm’t
(){

95 
	g$ªnounûm’tD©a
 = 
¬¿y
();

96 
	g$ªnounûm’tID
 = 
štv®
(
$this
->
šput
->
po¡
('announcement_id'));

97 if(!
em±y
(
$ªnounûm’tID
))

98 
	g$ªnounûm’tD©a
 = 
$this
->
ªnounûm’tMod–
->
g‘AÂounûm’tD©a
(
$ªnounûm’tID
);

99 
v¬_dump
(
$ªnounûm’tD©a
);

100 
	g$this
->
	glßd
->
v›w
('www/pÜl/v›wAÂounûm’t', 
¬¿y
('ªnounûm’tID' => 
$ªnounûm’tID
, 'ªnounûm’tD©a' => 
$ªnounûm’tD©a
));

109 
public
 
funùiÚ
 
»v›wAÂounûm’t
(){

110 
	g$ªnounûm’tD©a
 = 
¬¿y
();

111 
	g$ªnounûm’tID
 = 
štv®
(
$this
->
šput
->
po¡
('announcement_id'));

112 if(!
em±y
(
$ªnounûm’tID
))

113 
	g$ªnounûm’tD©a
 = 
$this
->
ªnounûm’tMod–
->
g‘AÂounûm’tD©a
(
$ªnounûm’tID
);

114 
v¬_dump
(
$ªnounûm’tD©a
);

115 
	g$this
->
	glßd
->
v›w
('www/pÜl/»v›wAÂounûm’t', 
¬¿y
('ªnounûm’tID' => 
$ªnounûm’tID
, 'ªnounûm’tD©a' => 
$ªnounûm’tD©a
));

118 
public
 
funùiÚ
 
ed™AÂounûm’t
(){

119 
	g$ªnounûm’tID
 = 
štv®
(
$this
->
šput
->
po¡
("announcement_id"));

120 
	g$ªnounûm’tT™Ë
 = 
$this
->
šput
->
po¡
("announcement_title");

121 
	g$ªnounûm’tPic
 = 
$this
->
šput
->
po¡
("announcement_pic");

122 
	g$ªnounûm’tC»©eD©e
 = 
¡¹Ùime
(
d©e
('Y-m-d'));

123 
	g$ªnounûm’tTag
 = 
$this
->
šput
->
po¡
("announcement_tag");

124 
	g$ªnounûm’tHtml
 = 
$this
->
šput
->
po¡
("announcement_html");

125 
	g$ªnounûm’tC»©eU£rName
 = 
em±y
(
$this
->
šput
->
po¡
("ªnounûm’t_ü—‹_u£r")è? $this->
£ssiÚ
->
u£rd©a
['user_name'] : $this->input->post("announcement_create_user");

126 
	g$ªnounûm’tIsStus
 = 
£lf
::
cÚv”Stus
(1);

127 
	g$ªnounûm’tHtmlP©h
 = 
£lf
::
ªnounûm’tSaveHtmlP©h
(
$ªnounûm’tID
, 
$ªnounûm’tHtml
);

128 
	g$ªnounûm’tD©a
 = 
¬¿y
(

129 "ªnounûm’t_t™Ë" => 
$ªnounûm’tT™Ë
,

130 "ªnounûm’t_pic" => 
$ªnounûm’tPic
,

131 "ªnounûm’t_ü—‹_d©e" => 
$ªnounûm’tC»©eD©e
,

132 "ªnounûm’t_g" => 
$ªnounûm’tTag
,

133 "ªnounûm’t_html_·th" => 
$ªnounûm’tHtmlP©h
,

134 "ªnounûm’t_is_¡©us" => 
$ªnounûm’tIsStus
,

135 "ªnounûm’t_ü—‹_u£r" => 
$ªnounûm’tC»©eU£rName
,

137 
	g$»t
 = 
$this
->
ªnounûm’tMod–
->
upd©eAÂounûm’t
(
$ªnounûm’tID
, 
$ªnounûm’tD©a
);

138 
echo
 
	g$»t
;

139 
	gd›
;

150 
´iv©e
 
funùiÚ
 
ªnounûm’tSaveHtmlP©h
(
$ªnounûm’tID
, 
$ªnounûm’tHtml
){

151 
fe_put_cÚ‹Ás
("htmÉem¶‘e/ªnounûm’t/{$ªnounûm’tID}.html", 
$ªnounûm’tHtml
);

163 
´iv©e
 
funùiÚ
 
cÚv”Stus
(
$ªnounûm’tStus
){

164 
	g$ªnounûm’tStus
){

166  
FALSE
;

169  
TRUE
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/api.php

1 <?
php


3 şas 
	cApi
 
ex‹nds
 
	mCI_cÚŒŞËr
 {

5 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

6 
·»Á
::
	`__cÚ¡ruù
();

7 
$this
->
lßd
->
	`mod–
('www/lead_model', 'lead');

8 
$this
->
lßd
->
	`mod–
('www/user_model', 'user');

9 
$this
->
lßd
->
	`mod–
('www/objects_model', 'objects');

10 
$this
->
lßd
->
	`mod–
('admin/obj_model', 'obj');

11 
$this
->
lßd
->
	`mod–
('admin/format_model', 'format');

12 
$this
->
lßd
->
	`mod–
('admin/attr_model', 'attr');

13 
$this
->
lßd
->
	`mod–
('admin/org_model', 'org');

16 
public
 
funùiÚ
 
	$šdex
() {

19 
$LogšName
 = 
$_POST
["LoginName"];

20 
$LogšPasswÜd
 = 
$_POST
["LoginPassword"];

21 
$OrgName
 = 
$_POST
["OrgName"];

22 
$ObjName
 = 
$_POST
["ObjectName"];

23 
$d©a
 = 
$_POST
["Data"];

24 
$Ty³
 = 
$_POST
["Type"];

25 
$PageSize
 =
$_POST
['PageSize'];

26 
$d©a
 = 
$this
->
	`JsÚToA¼ay
($data);

29 
$OrgID
 = 
$this
->
Üg
->
	`NameG‘Id
(
$OrgName
);

30 if(!
	`em±y
(
$OrgID
)){

31 
$U£rd©a
 = 
$this
->
u£r
->
	`LogšU£rD©a
(
$LogšName
,
$Org
);

32 if(!
	`em±y
(
$U£rd©a
è&& 
	`couÁ
($Userdata) == 1){

33 
$LogšPasswÜd
=
$this
->
u£r
->
	`’codePasswÜd
($LoginPassword);

34 if(
$U£rd©a
[0]['LOGIN_PASSWORD'] =ğ
$LogšPasswÜd
){

36 
$Objd©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$ObjName
);

37 if(!
	`em±y
(
$Objd©a
) && $Objdata['IS_RECYCLABLE']){

39 if(!
	`em±y
(
$Ty³
)){

40 
$Ty³
) {

42  
$this
->
	`li¡s
(
$OrgID
,
$Objd©a
,
$U£rd©a
[0]['USER_ID'], 
$d©a
,
$PageSize
);

45 
$´emissiÚ
 = 
$this
->
objeùs
->
	`´emissiÚAù
(
$Objd©a
, 
$OrgID
, 
$U£rd©a
[0]['USER_ID'], 
$Ty³
);

46 if(
$´emissiÚ
){

47  
$this
->
	`add
(
$OrgID
,
$Objd©a
,
$d©a
,
$U£rd©a
[0]['USER_ID']);

49  
$this
->
	`­i_”rÜ
('200');

53  
$this
->
	`upd©e
(
$OrgID
,
$Objd©a
,
$d©a
,
$U£rd©a
[0]['USER_ID']);

56  
$this
->
	`d–
(
$OrgID
,
$Objd©a
,
$d©a
,
$U£rd©a
[0]['USER_ID']);

59  
$this
->
	`­i_”rÜ
('102');

63  
$this
->
	`­i_”rÜ
('101');

66  
$this
->
	`­i_”rÜ
('106');

69  
$this
->
	`­i_”rÜ
('105');

72  
$this
->
	`­i_”rÜ
('103');

75  
$this
->
	`­i_”rÜ
('104');

77 
	}
}

79 
public
 
funùiÚ
 
	$JsÚToA¼ay
(
$d©a
){

80 
$d©a
=
	`jsÚ_decode
($data);

81 if(
	`is_objeù
(
$d©a
)){

82 
$d©a
 = (
¬¿y
)$data;

84 if(
	`is_¬¿y
(
$d©a
)){

85 
	`fÜ—ch
(
$d©a
 
as
 
$key
=>
$v®ue
){

86 
$d©a
[
$key
] = 
	`objeù_¬¿y
(
$v®ue
);

89  
$d©a
;

90 
	}
}

93 
´iv©e
 
funùiÚ
 
	$li¡s
(
$OrgID
, 
$Objd©a
, 
$U£rID
, 
$d©a
,
$PageSize
=10){

95 
$wh”e
['wh”e'] = 
	`is£t
(
$d©a
['wh”e']è? $d©a['wh”e'] : 
nuÎ
;

96 
$wh”e
['»l'] = 
	`is£t
(
$d©a
['»l']è? $d©a['»l'] : 
nuÎ
;

97 ià(
	`em±y
(
$wh”e
['where']) &&ƒmpty($where['rel'])) {

98 
$wh”e
 = 
nuÎ
;

101 
$Cu¼’tPage
 = 1;

103 
	`exŒaù
(
$Objd©a
, 
EXTR_OVERWRITE
);

105 
$Ëad_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$OBJ_NAME
);

106 
	`fÜ—ch
 (
$Ëad_©Œ
 
as
 
$key
 => 
$v®ue
) {

107 if(
$v®ue
['is_»f_obj']==0 && 
	`em±y
($value['fld_name'])){

108 }
	`–£if
(
$key
==
$KEY_ATTR_NAME
){

110 
$li¡_fÜm©
[] = 
$key
;

114 
$li¡_d©a
 = 
$this
->
objeùs
->
	`G‘InfoLi¡
(
$li¡_fÜm©
, 
$Ëad_©Œ
, 
$Objd©a
, 
$OrgID
, 
$Cu¼’tPage
, 
$PageSize
, 
$wh”e
,
$U£rID
);

116 
$li¡_d©a
 = 
$this
->
	`JsÚToA¼ay
($list_data);

118 if(!
	`is£t
(
$li¡_d©a
['rows'])){

119 
	`p
(
$this
->
	`­i_”rÜ
('303'));

120  
$this
->
	`­i_”rÜ
('303');

122 
	`fÜ—ch
 (
$li¡_d©a
['rows'] 
as
 
$k
 => 
$v
) {

123 
	`fÜ—ch
 (
$v
['ûÎ'] 
as
 
$kk
 => 
$vv
) {

124 
$¬r
 = 
	`ex¶ode
('.', 
$kk
);

125 if(
	`is£t
(
$¬r
[2]) && $arr[2]== '0'){

128 
$f_d©a
[
$k
][
$kk
] = 
$vv
;

132 
	`p
(
$f_d©a
);

133  
$this
->
	`­i_succ
("é«˜çº§æŸ¥è¯¢æ¥å£æ‰§è¡ŒæˆåŠŸï¼",
$f_d©a
);

134 
	}
}

137 
public
 
funùiÚ
 
	$add
(
$OrgID
,
$Objd©a
,
$d©a
,
$U£rID
) {

138 
	`exŒaù
(
$Objd©a
,
EXTR_OVERWRITE
);

139 
$objeù_©Œ
=
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$OBJ_NAME
);

140 
	`fÜ—ch
 (
$objeù_©Œ
 
as
 
$k
 => 
$v
) {

141 if(
$v
['is_mu¡'] && !
	`is£t
(
$d©a
[
$k
])){

142 
$»s
['res'] = "fail";

143 
$»s
['error_code'] = "201";

144 
$»s
['msg'] = "ç¼ºå°‘\"" . 
$k
 . "\"å‚æ•°ï¼Œä¿å­˜å¤±è´¥ï¼";

145 
echo
 "\"" . 
$k
 . "\"æœªå¡«ï¼Œä¿å­˜å¤±è´¥ï¼";

146  
$this
->
	`­i_”rÜ
(
$»s
['error_code'],$res['msg']);

149 
$U£rd©a
 = 
$this
->
u£r
->
	`S–eùOÃ
(
$OrgID
,
$d©a
[
$OBJ_NAME
.'.OwnerID']);

150 if(
$OBJ_NAME
=='Contact'){

151 if(
$U£rd©a
['DEPT_ID'] !ğ
$d©a
[
$OBJ_NAME
.'.OwnerDeptID']){

152  
$this
->
	`­i_”rÜ
('304');

155 if(
$U£rd©a
['DEPT_ID'] !ğ
$d©a
[
$OBJ_NAME
.'.DepartmentID']){

156  
$this
->
	`­i_”rÜ
('304');

160 
$r_d©a
 = 
$this
->
objeùs
->
	`_add
(
$d©a
, 
$OBJ_NAME
,
$OrgID
,
$U£rID
);

161 if(
$r_d©a
['res']=='fail'){

162  
$this
->
	`­i_”rÜ
(
$r_d©a
['”rÜ_code'],
$d©a
['msg']);

164  
$this
->
	`­i_succ
("",
$r_d©a
['id']);

166 
d›
;

169 
	}
}

171 
public
 
funùiÚ
 
	$upd©e
(
$OrgID
,
$Objd©a
,
$d©a
,
$U£rID
) {

172 
	`exŒaù
(
$Objd©a
,
EXTR_OVERWRITE
);

173 
$objeù_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$OBJ_NAME
);

174 if(!
	`is£t
(
$d©a
[
$KEY_ATTR_NAME
])){

175  
	`­i_”rÜ
('202',"IDå¿…é¡»å­˜åœ¨");

176 }
	`–£if
(
	`em±y
(
$d©a
[
$KEY_ATTR_NAME
])){

177  
	`­i_”rÜ
('203',"IDä¸èƒ½ä¸ºç©º");

179 
$wh”e
 = 
	`¬¿y
(

180 
$KEY_ATTR_FLD
 => 
$d©a
[
$KEY_ATTR_NAME
],

182 
	`un£t
(
$d©a
[
$KEY_ATTR_NAME
]);

185 if(
	`is£t
(
$d©a
[
$OBJ_NAME
.'.OwnerID'])){

186 
$U£rd©a
 = 
$this
->
u£r
->
	`S–eùOÃ
(
$OrgID
,
$d©a
[
$OBJ_NAME
.'.OwnerID']);

187 if(
$OBJ_NAME
=='Contact'){

188 if(
$U£rd©a
['DEPT_ID'] !ğ
$d©a
[
$OBJ_NAME
.'.OwnerDeptID']){

189  
$this
->
	`­i_”rÜ
('304');

192 if(
$U£rd©a
['DEPT_ID'] !ğ
$d©a
[
$OBJ_NAME
.'.DepartmentID']){

193  
$this
->
	`­i_”rÜ
("304");

199 
$r_d©a
 = 
$this
->
objeùs
->
	`_upd©e
(
$d©a
, 
$wh”e
, 
$objeù_©Œ
, 
$OBJ_NAME
,
$OrgID
=1,
$U£rID
);

201 
	`p
(
$r_d©a
);

202 if(
$r_d©a
['res']=='fail'){

204  
$this
->
	`­i_”rÜ
(
$r_d©a
['error_code'],$r_data['msg']);

206  
$this
->
	`­i_succ
();

208 
d›
;

211 
	}
}

213 
public
 
funùiÚ
 
	$d–
(
$OrgID
,
$Objd©a
,
$d©a
,
$U£rID
) {

215 
	`exŒaù
(
$Objd©a
, 
EXTR_OVERWRITE
);

216 if(!
	`is£t
(
$d©a
[
$KEY_ATTR_NAME
])){

217  
	`­i_”rÜ
('202',"IDå¿…é¡»å­˜åœ¨");

218 }
	`–£if
(
	`em±y
(
$d©a
[
$KEY_ATTR_NAME
])){

219  
	`­i_”rÜ
('203',"IDä¸èƒ½ä¸ºç©º");

221 
$id
 = 
$d©a
[
$OBJ_NAME
.".ID"];

224 
$d_d©a
['DELETED_USER_ID'] = 
$U£rID
;

225 
$d_d©a
['IS_DELETED'] = '1';

226 
$d_d©a
['DELETED_TIME'] = "to_d©e('" . 
	`d©aReduû8
("Y-m-d H:i:s", 
	`d©e
('Y-m-d H:i:s')) . "','yyyy-mm-dd hh24:mi:ss')";

227 
$pwh”e
 = 
$this
->
objeùs
->
	`´emissiÚLi¡
(
$Objd©a
, 
$OrgID
, 
$d_d©a
['DELETED_USER_ID'], "delete");

228 ià(
$this
->
objeùs
->
	`_d–
(
$id
, 
$OBJ_TYPE
, 
$d_d©a
, 
$pwh”e
)) {

229  
$this
->
	`­i_succ
();

231  
$this
->
	`­i_”rÜ
('200',"");

236 
	}
}

243 
public
 
funùiÚ
 
­i_succ
(
$msg
="",
$d©a
=""){

244 
$»s_d©a
["res"]="succ";

245 if(
	g$d©a
!=""){

246 
$»s_d©a
["d©a"]=
$d©a
;

248 if(
	g$msg
==""){

249 
$»s_d©a
["msg"]="æ¥å£æ‰§è¡ŒæˆåŠŸ";

251 
	g$»s_d©a
["msg"]=
$msg
;

253  
jsÚ_’code
(
$»s_d©a
);

261 
public
 
funùiÚ
 
­i_”rÜ
(
$”rÜ_code
,
$msg
=""){

262 
$”rÜ_¬r
ğ
¬¿y
(

281 
	g$d©a
["res"]="fail";

282 
	g$d©a
["”rÜ_code"]=
$”rÜ_code
;

283 if(
	g$msg
==""){

284 
$d©a
["msg"]=
$”rÜ_¬r
[
$”rÜ_code
];

286 
	g$d©a
["msg"]=
$msg
;

288  
jsÚ_’code
(
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/banner.php

1 <?
php


2 
CÏss
 
BªÃr
 
ex‹nds
 
	gWWW_cÚŒŞËr
{

4 
´iv©e
 
	g$pÜlDB
;

6 
funùiÚ
 
__cÚ¡ruù
(){

7 
	g·»Á
::
__cÚ¡ruù
();

8 
	g$this
->
	gpÜlDB
 = 
$this
->
lßd
->
d©aba£
('pÜl', 
TRUE
);

9 
	g$this
->
	glßd
->
mod–
('www/banner_model', 'banner');

12 
public
 
funùiÚ
 
images
(){

13 
	g$»t
['d©a'] = 
$this
->
bªÃr
->
qu”yBªÃr
(
TRUE
);

14 
	g$this
->
»nd”
('www/pÜl/images',
$»t
);

17 
public
 
funùiÚ
 
d–BªÃr
(){

19 
	g$pÜlId
 = 
štv®
(
$this
->
šput
->
po¡
('portalId'));

20 
	g$»t
 = 
$this
->
bªÃr
->
d–BªÃr
(
$pÜlId
);

21 
echo
 
	g$»t
;

22 
	gd›
;

25 
public
 
funùiÚ
 
muÉife
(){

26 
	g$d©a
['u¾'] = 
s™e_u¾
('www/portal/multiFiles');

27 
	g$this
->
	glßd
->
v›w
('www/objeùs/imagesu¶ßd', 
$d©a
);

30 
public
 
funùiÚ
 
muÉiFes
(){

31 
	g$feName
 = 
$_FILES
['file']['name'];

32 
	g$feTmpDœ
 = 
$_FILES
['file']['tmp_name'];

33 
	g$¡»amR—d”
 = 
fe_g‘_cÚ‹Ás
(
$feTmpDœ
);

34 
fe_put_cÚ‹Ás
("images/bªÃrImages/{$feName}", 
$¡»amR—d”
);

35 
	g$bªÃrPic
 = 
ba£_u¾
() . "images/bannerImages/{$fileName}";

36 
	g$bªÃrAddSql
 = "insert intoc_banner(banner_pic, banner_is_status) values('{$bannerPic}', 'TRUE')";

37 
	g$»t
 = 
$this
->
pÜlDB
->
qu”y
(
$bªÃrAddSql
);

38 
d›
(
$»t
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/contants.php

1 <?
php


14 
CÏss
 
CÚÁs
 
ex‹nds
 
	gWWW_cÚŒŞËr
{

16 
´iv©e
 
	g$lim™
 = 10;

17 
´iv©e
 
	g$_İ”
 = "";

19 
funùiÚ
 
__cÚ¡ruù
(){

20 
	g·»Á
::
__cÚ¡ruù
();

21 
	g$this
->
	glßd
->
mod–
('service/contants_service_model', 'contantsService');

30 
public
 
funùiÚ
 
v›wAùiÚ
(){

31 
	g$cÚÁsD©a
 = 
$this
->
cÚÁsS”viû
->
ãtchAÎCÚÁs
();

32 
	g$d©a
['cÚÁsD©a'] = 
$cÚÁsD©a
;

33 
	g$this
->
»nd”
('www/pÜl/cÚùs', 
$d©a
);

42 
public
 
funùiÚ
 
addV›wAùiÚ
(){

43 
	g$cÚÁsD©a
 = 
¬¿y
();

44 
	g$d©a
['cÚÁsD©a'] = 
$cÚÁsD©a
;

45 
	g$this
->
	glßd
->
v›w
('www/pÜl/v›wCÚÁs', 
$d©a
);

54 
public
 
funùiÚ
 
impÜtV›wCÚÁsAùiÚ
(){

55 
	g$»t
 = "";

56 
	g$this
->
	g_İ”
 = 
$this
->
šput
->
po¡
('oper');

57 
	g$d©a
['u¾'] = 
s™e_u¾
("www/contants/importContantsAction?oper={$this->_oper}");

58 
	g$this
->
	glßd
->
v›w
('www/objeùs/imagesu¶ßd', 
$d©a
);

67 
public
 
funùiÚ
 
impÜtCÚÁsAùiÚ
(){

68 
	g$»t
 = 
¬¿y
("succ" => 
TRUE
, "msg" =>‡rray());

69 
	g$İ”
 = 
$this
->
šput
->
g‘
('oper');

70 
	g$feP©h
 = 
$this
->
cÚÁsS”viû
->
cÚÁsFeU¶ßd
(
$_FILES
);

71 
v¬_dump
(
$feP©h
);

72 if(!
	g$feP©h
){

73 
	g$»t
["succ"] = 
FALSE
;

74 
	g$»t
["msg"] = "ä¿å­˜æ–‡ä»¶å¤±è´¥";

75 
	g$this
->
£nd”
(
$»t
);

77 
	g$İ”
){

78 "­³nd" : 
$»t
 = 
$this
->
cÚÁsS”viû
->
­³ndCÚÁs
(
$feP©h
, $this->cÚÁsS”viû->
_aùiveSh“t
, $this->cÚÁsS”viû->
_h—d”s
);;

79 "Œunÿt" : 
$»t
 = 
$this
->
cÚÁsS”viû
->
ŒunÿtCÚÁs
(
$feP©h
, $this->cÚÁsS”viû->
_aùiveSh“t
, $this->cÚÁsS”viû->
_h—d”s
);;

81 
	g$this
->
£nd”
(
$»t
);

90 
public
 
funùiÚ
 
addCÚÁsAùiÚ
(){

91 
	g$»t
 = 
¬¿y
("succ" => 
FALSE
, "msg" =>‡rray());

92 
	g$gÚghao
 = 
$this
->
šput
->
po¡
('gonghao');

93 
	g$phÚe
 = 
$this
->
šput
->
po¡
('phone');

94 
	g$‹l
 = 
$this
->
šput
->
po¡
('tel');

95 
	g$Çme
 = 
$this
->
šput
->
po¡
('name');

96 if(!
»gexPhÚe
(
$phÚe
)){

97 
	g$»t
[] = 'æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®';

98 
	g$this
->
£nd”
(
$»t
);

100 if(!
»gexT–
(
$‹l
)){

101 
	g$»t
[] = 'å›ºå®šç”µè¯å·ç æ ¼å¼ä¸æ­£ç¡®';

102 
	g$this
->
£nd”
(
$»t
);

104 
	g$this
->
	gcÚÁsS”viû
->
cÚÁsAddA‰r
(
$gÚghao
, 
$phÚe
, 
$‹l
, 
$Çme
);

105 
	g$this
->
£nd”
(
$»t
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/customer.php

1 <?
php


13 şas 
	cCu¡om”
 
ex‹nds
 
	mWWW_cÚŒŞËr
 {

15 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

16 
·»Á
::
	`__cÚ¡ruù
();

17 
$this
->
lßd
->
	`mod–
('admin/customer_model', 'cus');

23 
public
 
funùiÚ
 
	$li¡s
() {

24 
$OrgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

25 
$U£rID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

26 
$this
->
	`»nd”
('www/cu¡om”/li¡', 
$d©a
);

27 
	}
}

32 
public
 
funùiÚ
 
	$ajax_li¡s
() {

33 
$this
->
lßd
->
	`v›w
('www/cu¡om”/ajax_li¡', 
$d©a
);

34 
	}
}

36 
public
 
funùiÚ
 
	$li¡_objeù_jsÚ
() {

37 
$li¡D©a
 = 
$this
->
cus
->
	`g‘Info
();

38 
echo
 
	`jsÚ_’code
(
$li¡D©a
);

39 
d›
;

40 
	}
}

42 
public
 
funùiÚ
 
	$İ”
(){

43 
$İ”
 = 
$_POST
['oper'];

44 
$this
->
	`$İ”
(
$_POST
);

45 
	}
}

47 
public
 
funùiÚ
 
	$§ve
(
$d©a
) {

48 
$»t
 = 
$this
->
cus
->
	`§ve
(
$d©a
);

49 
	`d›
(
$»t
);

50 
	}
}

52 
public
 
funùiÚ
 
	$ed™
(
$d©a
) {

53 
$»t
 = 
$this
->
cus
->
	`upd©e
(
$d©a
);

54 
	`d›
(
$»t
);

55 
	}
}

57 
public
 
funùiÚ
 
	$d–
(
$d©a
) {

58 
$»t
 = 
$this
->
cus
->
	`d–‘e
(
$d©a
);

59 
	`d›
(
$»t
);

60 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/express.php

1 <?
php


2 
CÏss
 
Ex´ess
 
ex‹nds
 
	gWWW_cÚŒŞËr
{

4 
funùiÚ
 
__cÚ¡ruù
(){

5 
	g·»Á
::
__cÚ¡ruù
();

6 
	g$this
->
	glßd
->
mod–
('service/express_service_model', 'expressService');

9 
public
 
funùiÚ
 
ex´essMªag”AùiÚ
(){

10 
	g$ex´essLi¡U£rs
 = 
$this
->
ex´essS”viû
->
ex´essLi¡U£rs
();

11 
	g$d©a
['ex´essLi¡U£rs'] = 
$ex´essLi¡U£rs
;

12 
	g$this
->
»nd”
('www/pÜl/ex´essMªag”', 
$d©a
);

15 
public
 
funùiÚ
 
ex´essTakeD‘aAùiÚ
(){

16 
	g$u£rID
 = 
$this
->
šput
->
po¡
('userID');

17 if(
em±y
(
$u£rID
)){

18 
echo
 
¬¿y
("succ" => 
FALSE
);

19 
	gd›
;

21 
	g$ex´essTakeD‘a
 = 
$this
->
ex´essS”viû
->
ex´essTakeD‘a
(
štv®
(
$u£rID
));

22 
	g$d©a
['ex´essTakeD‘a'] = 
$ex´essTakeD‘a
;

23 
	g$this
->
	glßd
->
v›w
('www/pÜl/v›wEx´essD‘a', 
$d©a
);

26 
public
 
funùiÚ
 
ex´essTakeAùiÚ
(){

27 
	g$keU£rID
 = 
$this
->
šput
->
po¡
('takeUserID');

28 if(
em±y
(
$keU£rID
)){

29 
echo
 
¬¿y
("succ" => 
FALSE
);

30 
	gd›
;

32 
	g$this
->
	gex´essS”viû
->
ex´essTakeEma
(
štv®
(
$keU£rID
), 
$this
->
£ssiÚ
->
u£rd©a
['user_id']);

33 
echo
 
¬¿y
("succ" => 
FALSE
);

34 
	gex™
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/home.php

1 <?
php


2 
CÏss
 
Home
 
ex‹nds
 
	gWWW_cÚŒŞËr
{

3 
public
 
funùiÚ
 
__cÚ¡ruùiÚ
(){

4 
	g·»Á
::
__cÚ¡ruùiÚ
;

7 
public
 
funùiÚ
 
šdex
(){

8 
	g$this
->
	glßd
->
lib¿ry
('session');

9 if(
is£t
(
$this
->
£ssiÚ
->
u£rd©a
['user_id'])){

10 
	g$this
->
homes
();

12 
»dœeù
('www/login');

16 
public
 
funùiÚ
 
out
(){

17 
	g$this
->
	g£ssiÚ
->
£ss_de¡roy
();

18 
»dœeù
("www/");

24 
public
 
funùiÚ
 
homes
(){

25 
	g$d©a
 = "";

41 
	g$this
->
»nd”
('www/home/šdex',
$d©a
);

43 
public
 
funùiÚ
 
g‘Li¡s
(
$obj_Çme
, 
$func_Çme
) {

44 
	g$this
->
	glßd
->
mod–
('www/remind_model','remind');

45 
	g$d©a
['menu_active'] = 3;

46 
	g$Üg_id
 = 
$this
->
£ssiÚ
->
u£rd©a
('org_id');

47 
	g$LªgID
 = 
$this
->
£ssiÚ
->
u£rd©a
('lang_id');

48 
	g$u£r_id
 = 
$this
->
£ssiÚ
->
u£rd©a
('user_id');

49 
	g$S’iÜQu”yA‰rs
 = 
¬¿y
(

50 "Üg_id" => 
$Üg_id
,

51 "LªgID" => 
$LªgID
,

52 "obj_Çme" => 
$obj_Çme
,

53 "u£r_id" => 
$u£r_id
,

55  
	g$this
->
	g»mšd
->
g‘Li¡sA‰r
(
$S’iÜQu”yA‰rs
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/info.php

1 <?
php


13 
CÏss
 
Info
 
ex‹nds
 
	gWWW_cÚŒŞËr
{

15 
funùiÚ
 
__cÚ¡ruù
(){

16 
	g·»Á
::
__cÚ¡ruù
();

17 
	g$this
->
	glßd
->
mod–
('service/info_service_model', 'infoService');

26 
public
 
funùiÚ
 
v›wAùiÚ
(){

27 
	g$šfoD©a
 = 
$this
->
šfoS”viû
->
ãtchAÎInfo
();

28 
	g$this
->
»nd”
('www/pÜl/šfo', 
$šfoD©a
);

37 
public
 
funùiÚ
 
addAùiÚ
(){

38 
	g$»t
 = 
¬¿y
("succ" => 
TRUE
, "msg" =>‡rray());

39 
	g$šfoY—r
 = 
štv®
(
$this
->
šput
->
po¡
('infoYear'));

40 
	g$šfoOrd”
 = 
štv®
(
$this
->
šput
->
po¡
('infoOrder'));

41 
	g$šfoDesc
 = 
mb_sub¡r
(
$this
->
šput
->
po¡
('infoDesc'), 0, 100, 'UTF-8');

42 if(
em±y
(
$šfoY—r
è&&ƒm±y(
$šfoOrd”
è&&ƒm±y(
$šfoDesc
)){

43 
	g$»t
['succ'] = 
FALSE
;

44 
	g$»t
['msg'] = "å¹´ä»½æˆ–è€…æ’åºæˆ–è€…æè¿°ä¸ºç©º";

45 
	g$this
->
£nd”
(
$»t
);

47 
	g$»t
 = 
$this
->
šfoS”viû
->
addInfo
(
$šfoY—r
, 
$šfoOrd”
, 
$šfoDesc
);

48 
	g$this
->
£nd”
(
$»t
);

57 
public
 
funùiÚ
 
ed™AùiÚ
(){

58 
	g$»t
 = 
¬¿y
("succ" => 
TRUE
, "msg" =>‡rray());

59 
	g$šfoID
 = 
štv®
(
$this
->
šput
->
po¡
('infoID'));

60 
	g$šfoY—r
 = 
štv®
(
$this
->
šput
->
po¡
('infoYear'));

61 
	g$šfoOrd”
 = 
štv®
(
$this
->
šput
->
po¡
('infoOrder'));

62 
	g$šfoDesc
 = 
mb_sub¡r
(
$this
->
šput
->
po¡
('infoDesc'), 0, 100, 'UTF-8');

63 if(
	g$šfoID
 > 0){

64 
	g$»t
['succ'] = 
FALSE
;

65 
	g$»t
['msg'] = "éæ³•è¯·æ±‚";

66 
	g$this
->
£nd”
(
$»t
);

68 if(
em±y
(
$šfoY—r
è&&ƒm±y(
$šfoOrd”
è&&ƒm±y(
$šfoDesc
)){

69 
	g$»t
['succ'] = 
FALSE
;

70 
	g$»t
['msg'] = "å¹´ä»½æˆ–è€…æ’åºæˆ–è€…æè¿°ä¸ºç©º";

71 
	g$this
->
£nd”
(
$»t
);

73 
	g$this
->
	gšfoS”viû
->
upd©eInfo
(
$šfoID
, 
$šfoY—r
, 
$šfoOrd”
, 
$šfoDesc
);

74 
	g$this
->
£nd”
(
$»t
);

83 
public
 
funùiÚ
 
d–AùiÚ
(){

84 
	g$»t
 = 
¬¿y
("succ" => 
TRUE
, "msg" =>‡rray());

85 
	g$šfoID
 = 
štv®
(
$this
->
šput
->
po¡
('infoID'));

86 
	g$»t
 = 
$this
->
šfoS”viû
->
d–Info
(
$šfoID
);

87 
	g$this
->
£nd”
(
$»t
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/lead.php

1 <?
php


2 şas 
	cL—d
 
ex‹nds
 
	mWWW_cÚŒŞËr
{

3 
public
 
funùiÚ
 
	$__cÚ¡ruù
(){

4 
·»Á
::
	`__cÚ¡ruù
();

5 
$this
->
lßd
->
	`mod–
('www/lead_model','lead');

6 
$this
->
lßd
->
	`mod–
('admin/obj_model','obj');

7 
$this
->
lßd
->
	`mod–
('admin/format_model','format');

8 
$this
->
lßd
->
	`mod–
('admin/attr_model','attr');

9 
$this
->
lßd
->
	`mod–
('www/objects_model', 'objects');

12 
public
 
funùiÚ
 
	$šdex
(){

14 
	}
}

18 
public
 
funùiÚ
 
	$ËadCÚv”siÚ
(){

20 
$obj_ty³
 = 
	`¬¿y
(

26 
$obj_ty³_d©a
 = 
$this
 -> 
Ëad
 -> 
	`G‘ObjTy³D©a
(
$obj_ty³
);

27 
$id
 = 
$this
 -> 
šput
 -> 
	`po¡
("id");

28 
$obj_ty³
 = 
$this
 -> 
šput
 -> 
	`po¡
("obj_type");

29 
$Çme
 = 
$this
 -> 
Ëad
 -> 
	`G‘AccouÁName
(
$id
);

30 
	`fÜ—ch
(
$obj_ty³_d©a
 
as
 
$v
) {

31 
$obj_ty³_£Ëù
 = "";

32 
	`fÜ—ch
(
$v
 
as
 
$v®ue
) {

33 if(
$v®ue
["TYPE_ID"] == "2056"){

34 
$obj_ty³_£Ëù
 .ğ'<İtiÚ s–eùed styË="width:128px;" v®ue="'.
$v®ue
["TYPE_ID"].'">'.$value['TYPE_NAME'].'</option>';

37 
$obj_ty³_£Ëù
 .ğ'<İtiÚ styË="width:128px;" v®ue="'.
$v®ue
["TYPE_ID"].'">'.$value['TYPE_NAME'].'</option>';

39 
$obj_ty³_£Ëù_¬r
[] = 
$obj_ty³_£Ëù
;

42 
$d©a
["obj_ty³_£Ëù_¬r"] = 
$obj_ty³_£Ëù_¬r
;

43 
$d©a
['Çme'] = 
$Çme
;

44 
$d©a
['id'] = 
$id
;

45 
$d©a
['obj_ty³'] = 
$obj_ty³
;

46 
$this
->
lßd
->
	`v›w
('www/Ëad/cÚv”siÚ', 
$d©a
);

48 
	}
}

55 
public
 
funùiÚ
 
	$şuesIÁo
(){

56 
$Üg_id
 = 
$this
 -> 
£ssiÚ
 -> 
	`u£rd©a
("org_id");

57 
$u£r_id
 = 
$this
 -> 
£ssiÚ
 -> 
	`u£rd©a
("org_id");

58 
$id
 = 
$_POST
["LEAD_ID"];

60 ifĞ
$this
 -> 
šput
 -> 
	`po¡
("AccouÁ"è&& 
	`¡¾’
($this -> input ->…ost("Account_Owner_ID")) ){

62 
$tc_id
 = 
$this
 -> 
šput
 -> 
	`po¡
("LEAD_ID");

63 
$Ëad_d©a
 = 
$this
-> 
objeùs
 -> 
	`G‘OÃCÚ‹Á
("L—d", "1", 
$tc_id
);

65 
$d©aAccouÁ
 = 
$this
 -> 
Ëad
 -> 
	`g‘AccouÁA¼
(
$Ëad_d©a
,281);

67 
$d©aAccouÁ
['AccouÁ.Name'] = 
$this
 -> 
šput
 -> 
	`po¡
("Account_Name");

68 
$d©aAccouÁ
['AccouÁ.OwÃr'] = 
$this
 -> 
šput
 -> 
	`po¡
("Account_Owner");

69 
$d©aAccouÁ
['AccouÁ.OwÃr.ID'] = 
$this
 -> 
šput
 -> 
	`po¡
("Account_Owner_ID");

70 
$d©aAccouÁ
['AccouÁ.Ty³'] = 
$this
 -> 
šput
 -> 
	`po¡
("Account_Type_ID");

71 
$d©aAccouÁ
['AccouÁ.Ty³.ID'] = 
$this
 -> 
šput
 -> 
	`po¡
("Account_Type_ID");

72 
$d©aAccouÁ
['Account.SrcType'] = 3;

73 
$d©aAccouÁ
['AccouÁ.SrcID'] = 
$tc_id
;

79 
$š£¹_id
 = 
$this
 -> 
objeùs
 -> 
	`_add
(
$d©aAccouÁ
,'AccouÁ',
$Üg_id
,
$u£r_id
);

80 ifĞ
$š£¹_id
['res'] != 'suc' ){

82 
echo
 
$š£¹_id
["msg"];

85 if(
$this
 -> 
šput
 -> 
	`po¡
("Contact")) {

86 if(
	`¡¾’
(
$this
 -> 
šput
 -> 
	`po¡
("Contact_Owner_ID"))){

88 
$d©aCÚù
 = 
$this
 -> 
Ëad
 -> 
	`g‘AccouÁA¼
(
$Ëad_d©a
,280);

90 
$d©aCÚù
['CÚù.OwÃr'] = 
$this
 -> 
šput
 -> 
	`po¡
("Contact_Owner");

91 
$d©aCÚù
['CÚù.OwÃr.ID'] = 
$this
 -> 
šput
 -> 
	`po¡
("Contact_Owner_ID");

92 
$d©aCÚù
['CÚù.Ty³'] = 
$this
 -> 
šput
 -> 
	`po¡
("Contact_Type_ID");

93 
$d©aCÚù
['CÚù.Ty³.ID'] = 
$this
 -> 
šput
 -> 
	`po¡
("Contact_Type_ID");

94 
$d©aCÚù
['CÚù.AccouÁ'] = 
$š£¹_id
['id'];

95 
$d©aCÚù
['CÚù.AccouÁ.ID'] = 
$š£¹_id
['id'];

96 
$d©aCÚù
['Contact.SourceObjectType'] = 3;

97 
$d©aCÚù
['CÚù.SourûObjeùID'] = 
$tc_id
;

99 
$cÚù
 = 
$this
 -> 
objeùs
 -> 
	`_add
(
$d©aCÚù
,'CÚù',
$Üg_id
,
$u£r_id
);

100 if(
$cÚù
["res"] != "suc"){

101 
echo
 
$cÚù
['msg'];

102 
d›
;

109 ifĞ
$this
 -> 
šput
 -> 
	`po¡
("Opportunity") ) {

110 if(
	`¡¾’
(
$this
 -> 
šput
 -> 
	`po¡
("Opportunity_Owner_ID"))){

112 
$d©aOµÜtun™y
 = 
$this
 -> 
Ëad
 -> 
	`g‘AccouÁA¼
(
$Ëad_d©a
,282);

114 
$d©aOµÜtun™y
['OµÜtun™y.Name'] = 
$this
 -> 
šput
 -> 
	`po¡
("Opportunity_Name");

115 
$d©aOµÜtun™y
['OµÜtun™y.OwÃr'] = 
$this
 -> 
šput
 -> 
	`po¡
("Opportunity_Owner");

116 
$d©aOµÜtun™y
['OµÜtun™y.OwÃr.ID'] = 
$this
 -> 
šput
 -> 
	`po¡
("Opportunity_Owner_ID");

117 
$d©aOµÜtun™y
['OµÜtun™y.Ty³'] = 
$this
 -> 
šput
 -> 
	`po¡
("Opportunity_Type_ID");

118 
$d©aOµÜtun™y
['OµÜtun™y.Ty³ID'] = 
$this
 -> 
šput
 -> 
	`po¡
("Opportunity_Type_ID");

119 
$d©aOµÜtun™y
['OµÜtun™y.AccouÁ'] = 
$š£¹_id
['id'];

120 
$d©aOµÜtun™y
['OµÜtun™y.AccouÁ.ID'] = 
$š£¹_id
['id'];

121 
$d©aOµÜtun™y
['Opportunity.SourceObjectType'] = 3;

122 
$d©aOµÜtun™y
['OµÜtun™y.SourûObjeùID'] = 
$tc_id
;

123 
$d©aOµÜtun™y
["module_model"] = "Opportunity";

124 
$d©aOµÜtun™y
["module_action"] = "module_add";

126 
$İpÜtun™y
 = 
$this
 -> 
objeùs
 -> 
	`š™
(
$d©aOµÜtun™y
);

127 if(
$İpÜtun™y
["res"] != "suc"){

128 
echo
 
$İpÜtun™y
['msg'];

129 
d›
;

136 
$this
 -> 
Ëad
 -> 
	`Ëad_sucûss
(
$id
);

137 
echo
 '<script>window.history.go(-1);alert("success")</script>';

143 
echo
 '<script>window.history.go(-1);alert("error")</script>';

145 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/lee.php

1 <?
php


3 şas 
	cL“
 
ex‹nds
 
	mWWW_cÚŒŞËr
 {

5 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

6 
·»Á
::
	`__cÚ¡ruù
();

7 
$this
->
lßd
->
	`mod–
('www/lead_model', 'lead');

8 
$this
->
lßd
->
	`mod–
('www/objects_model', 'objects');

9 
$this
->
lßd
->
	`mod–
('admin/obj_model', 'obj');

10 
$this
->
lßd
->
	`mod–
('admin/format_model', 'format');

11 
$this
->
lßd
->
	`mod–
('admin/attr_model', 'attr');

13 
public
 
funùiÚ
 
	$Ëe_expÜt
(){

14 
$d©a
 = "";

15 
$this
->
lßd
->
	`v›w
('www/Ëe/expÜt',
$d©a
);

16 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/login.php

1 <?
php


3 şas 
	cLogš
 
ex‹nds
 
	mCI_CÚŒŞËr
 {

5 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

6 
·»Á
::
	`__cÚ¡ruù
();

7 
$this
->
lßd
->
	`mod–
('www/user_model', 'user');

10 
public
 
funùiÚ
 
	$šdex
() {

11 
$”rÜ
 = "";

12 
$d©a
['”rÜ'] = 
$”rÜ
;

13 ià(!
	`em±y
(
$_POST
['user'])) {

14 
$d©a
['logš_Çme'] = 
$_POST
['user']["login_name"];

15 
$d©a
['·sswÜd'] = 
$_POST
['user']["password"];

16 
$d©a
['Ügcode'] = 
$_POST
['user']["orgcode"];

17 
$d©a
['logš_sys'] = 
$_POST
['user']["login_sys"];

19 
$d©a
['”rÜ'] = 
$this
->
u£r
->
	`CheckLogš
(
$_POST
['user']["login_sys"], $_POST['user']['login_name'], $_POST['user']['password'], "ShopEx");

21 
$this
->
lßd
->
	`v›w
('www/logš/šdex', 
$d©a
);

22 
	}
}

24 
public
 
funùiÚ
 
	$logout
() {

25 
$this
->
lßd
->
	`lib¿ry
('session');

26 
$this
->
£ssiÚ
->
	`£ss_de¡roy
();

27 
$this
->
	`šdex
();

28 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/message.php

1 <?
php


2 şas 
	cMes§ge
 
ex‹nds
 
	mWWW_cÚŒŞËr
 {

4 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

5 
·»Á
::
	`__cÚ¡ruù
();

6 
$this
->
lßd
->
	`mod–
('www/lead_model', 'lead');

7 
$this
->
lßd
->
	`mod–
('www/objects_model', 'objects');

8 
$this
->
lßd
->
	`mod–
('admin/obj_model', 'obj');

9 
$this
->
lßd
->
	`mod–
('admin/format_model', 'format');

10 
$this
->
lßd
->
	`mod–
('admin/attr_model', 'attr');

11 
$this
->
lßd
->
	`mod–
('www/message_model','message');

12 
$this
->
lßd
->
	`mod–
('www/remind_model','remind');

14 
public
 
funùiÚ
 
	$li¡s
() {

15 
$OrgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

16 
$ObjTy³
 = 
$_GET
['obj_type'];

17 
$U£rID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

18 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$ObjTy³
);

19 
$obj_Çme
 = 
$obj
['OBJ_NAME'];

20 
$d©a
 = 
$this
->
	`g‘Li¡s
(
$obj_Çme
, 
__FUNCTION__
);

22 
$d©a
["objName"] = 
$this
 ->
obj
-> 
	`g‘Li¡Name
(
$obj_Çme
);

24 
$d©a
["ObjTy³"] = 
$ObjTy³
;

26 
$d©a
 = 
$this
 ->
objeùs
-> 
	`pub_bu‰Ú
(
$OrgID
,$data);

27 
$d©a
['mes§ge'] = 
$this
->
mes§ge
->
	`couÁn4
(
$U£rID
);

28 
$this
->
	`»nd”
('www/mes§ge/li¡', 
$d©a
);

30 
	}
}

36 
public
 
funùiÚ
 
	$g‘Li¡s
(
$obj_Çme
, 
$func_Çme
) {

37 
$d©a
['menu_active'] = 3;

38 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

39 
$LªgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('lang_id');

40 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

41 
$S’iÜQu”yA‰rs
 = 
	`¬¿y
(

42 "Üg_id" => 
$Üg_id
,

43 "LªgID" => 
$LªgID
,

44 "obj_Çme" => 
$obj_Çme
,

45 "u£r_id" => 
$u£r_id
,

46 "func_Çme" => 
$func_Çme
,

48  
$this
->
mes§ge
->
	`g‘Li¡sA‰r
(
$S’iÜQu”yA‰rs
);

49 
	}
}

51 
public
 
funùiÚ
 
	$li¡_jsÚ
(){

52 
$obj_ty³
 = 170;

53 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

55 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

56 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj_ty³
);

57 
$obj_Çme
 = 
$obj
['OBJ_NAME'];

58 
$fÜm©
 = 
$this
->
fÜm©
->
	`G‘Li¡FÜm©
(
$Üg_id
, 
$obj_ty³
, 0);

59 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 
$obj_Çme
);

60 
$wh”e
['wh”e'] = 
	`is£t
(
$_POST
['£niÜqu”y']['wh”e']è? $_POST['£niÜqu”y']['wh”e'] : 
nuÎ
;

61 
$wh”e
['»l'] = 
	`is£t
(
$_POST
['£niÜqu”y']['»l']è? $_POST['£niÜqu”y']['»l'] : 
nuÎ
;

62 ià(
	`em±y
(
$wh”e
['where']) &&ƒmpty($where['rel'])) {

63 
$wh”e
 = 
nuÎ
;

65 
$Cu¼’tPage
 = 
	`is£t
(
$_REQUEST
['page']) ? $_REQUEST['page'] : 1;

66 
$PageSize
 = 
	`is£t
(
$_REQUEST
['rows']) ? $_REQUEST['rows'] : 10;

67 
	`exŒaù
(
$obj_d©a
, 
EXTR_OVERWRITE
);

70 
$Ëad_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$obj_Çme
);

71 
$li¡_d©a
 = 
$this
->
mes§ge
->
	`InfoPag”Li¡
(
$fÜm©
, 
$Ëad_©Œ
, 
$obj_d©a
, 
$Üg_id
, 
$u£r_id
,
$Cu¼’tPage
, 
$PageSize
,
$wh”e
);

72 
echo
 
$li¡_d©a
;

74 
d›
;

75 
	}
}

76 
public
 
funùiÚ
 
	$v›w
() {

78 
$mes§ge_id
 = 
$_GET
['id'];

79 
$d©a
['id'] = 
$mes§ge_id
;

80 
$LªgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('lang_id');

81 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

82 
$ObjTy³
 = 
$_GET
['obj_type'];

84 
$d©a
['obj_ty³'] = 
$ObjTy³
;

85 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$ObjTy³
);

86 
$obj_Çme
 = 
$obj
['OBJ_NAME'];

87 
$d©a
['OBJ_NAME'] = 
$obj_Çme
;

89 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

90 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 
$obj_Çme
);

91 
$obj_diù
 = 
$this
->
obj
->
	`g‘Li¡Name
(
$obj_Çme
,
$LªgID
);

92 
	`exŒaù
(
$obj_d©a
, 
EXTR_OVERWRITE
);

94 
$Ëad_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$obj_Çme
);

96 
$DiùA‰r
 = 
	`_HashD©a
(
$this
->
obj
->
	`NameG‘CnDiù
(
$Üg_id
, 
$LªgID
), "DICT_NAME");

98 
$d©a
['Ëad_d©a'] = 
$this
->
objeùs
->
	`G‘šfo
(
$obj_Çme
, 
$Üg_id
, 
$DiùA‰r
, 
$Ëad_©Œ
, 
$mes§ge_id
);

99 
$d©a
['mes§ge'] = 
$this
->
mes§ge
->
	`couÁn4
(
$u£r_id
);

103 
$fÜm©
 = 
	`A¼ay
(

107 "bËs" => 
	`A¼ay
(

108 0 => 
	`A¼ay
(

109 "bËNames" => 
	`A¼ay
(

116 "ûÎs" => 
	`A¼ay
(

117 0 => 
	`A¼ay
(

122 "»quœed" => 
nuÎ
,

125 1 => 
	`A¼ay
(

130 "»quœed" =>
nuÎ
,

132 2 => 
	`A¼ay
(

137 "»quœed" =>
nuÎ
,

139 3 => 
	`A¼ay
(

144 "»quœed" =>
nuÎ
,

146 4 => 
	`A¼ay
(

151 "»quœed" =>
nuÎ
,

153 5 => 
	`A¼ay
(

158 "»quœed" =>
nuÎ
,

160 6 => 
	`A¼ay
(

165 "»quœed" =>
nuÎ
,

167 7 => 
	`A¼ay
(

172 "»quœed" =>
nuÎ
,

179 
$d©a
['fÜm©_d©a'] = 
$this
->
objeùs
->
	`G‘InfoV›w
(
$Üg_id
, 
$fÜm©
, $d©a['Ëad_d©a'], 
$Ëad_©Œ
, 
$mes§ge_id
);

180 
$this
->
mes§ge
->
	`»ad_æag
(
$mes§ge_id
,
$Üg_id
,
$u£r_id
);

182 
$d©a
["obj_ty³_¬r"] = 
	`¬¿y
(

187 
$d©a
["obj_ty³_d©a"] = 
$this
->
Ëad
->
	`G‘ObjTy³D©a
($data["obj_type_arr"]);

188 
$d©a
 = 
$this
 ->
objeùs
-> 
	`v›w_pub_bu‰Ú
($this->
£ssiÚ
->
	`u£rd©a
('org_id'),$data);

189 
$d©a
['diù'] = 
$obj_diù
[0]['LABEL'];

190 
$this
->
	`»nd”
('www/mes§ge/v›w', 
$d©a
);

191 
	}
}

193 
public
 
funùiÚ
 
	$add
() {

194 if(
	`em±y
(
$_GET
['type_id'])){

195 
$Ty³ID
=0;

197 
$Ty³ID
 = 
$_GET
['type_id'];

200 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

201 
$LªgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
("lang_id");

202 
$ObjTy³
 = 
$_GET
['obj_type'];

203 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$ObjTy³
);

204 
$obj_Çme
 = 
$obj
['OBJ_NAME'];

205 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 
$obj_Çme
);

206 
	`p
(
$obj_d©a
);

207 
	`exŒaù
(
$obj_d©a
, 
EXTR_OVERWRITE
);

208 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

209 
$Ëad_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$obj_Çme
);

211 
$’um_©Œ
 = 
$this
->->
	`S–eùAÎ
();

212 
$DiùA‰r
 = 
	`_HashD©a
(
$this
->
obj
->
	`NameG‘CnDiù
(
$Üg_id
, 
$LªgID
), "DICT_NAME");

213 
$d©a
['Ëad_d©a'] = 
$this
->
mes§ge
->
	`G‘šfo
(
$Üg_id
, 
$Ëad_©Œ
, 
$u£r_id
,
$Ty³ID
);

216 
$fÜm©
 = 
	`A¼ay
(

220 "bËs" => 
	`A¼ay
(

221 0 => 
	`A¼ay
(

222 "bËNames" => 
	`A¼ay
(

229 "ûÎs" => 
	`A¼ay
(

230 0 => 
	`A¼ay
(

235 "»quœed" => 
nuÎ
,

238 1 => 
	`A¼ay
(

243 "»quœed" =>
nuÎ
,

245 2 => 
	`A¼ay
(

250 "»quœed" =>
nuÎ
,

252 3 => 
	`A¼ay
(

257 "»quœed" =>
nuÎ
,

259 4 => 
	`A¼ay
(

264 "»quœed" =>
nuÎ
,

266 5 => 
	`A¼ay
(

271 "»quœed" =>
nuÎ
,

273 6 => 
	`A¼ay
(

278 "»quœed" =>
nuÎ
,

280 7 => 
	`A¼ay
(

285 "»quœed" =>
nuÎ
,

292 
$d©a
['fÜm©_d©a'] = 
$this
->
objeùs
->
	`G‘InfoEd™
(
$Üg_id
, 
$fÜm©
, $d©a['Ëad_d©a'], 
$Ëad_©Œ
, "", 
$’um_©Œ
);

293 
$d©a
['mes§ge'] = 
$this
->
mes§ge
->
	`couÁn4
(
$u£r_id
);

294 
$d©a
['obj_ty³'] = 
$ObjTy³
;

295 
$this
->
	`»nd”
('www/mess§ge/add', 
$d©a
);

296 
	}
}

297 
public
 
funùiÚ
 
	$§ve
(){

298 
$po¡
 = @
$_POST
;

299 
	`fÜ—ch
 (
$po¡
['d©a'] 
as
 
$k
 => 
$v
) {

300 
$po¡_d©a
[
$v
['name']]=$v['value'];

303 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

304 
$d©a
 = 
$this
->
»mšd
->
	`In£¹Mes§ge
(
$Üg_id
,
$u£r_Çme
,
$Çme
,
$u£r_id
,
$ev’t_Çme
="",
$obj_ty³
="",
$obj_id
="");

305  
$d©a
;

306 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/objects.php

1 <?
php


11 şas 
	cObjeùs
 
ex‹nds
 
	mWWW_cÚŒŞËr
 {

13 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

14 
·»Á
::
	`__cÚ¡ruù
();

15 
$this
->
lßd
->
	`mod–
('admin/obj_model', 'obj');

21 
public
 
funùiÚ
 
	$li¡s
() {

22 
$OrgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

23 
$U£rID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

24 
$this
->
	`»nd”
('www/objeùs/li¡', 
$d©a
);

25 
	}
}

30 
public
 
funùiÚ
 
	$imagesU¶ßd
() {

31 
$d©a
['u¾'] = 
	`s™e_u¾
('www/objects/multiFiles');

32 
$this
->
	`»nd”
('www/objeùs/imagesu¶ßd', 
$d©a
);

33 
	}
}

38 
public
 
funùiÚ
 
	$muÉiFes
(){

39 
$feName
 = 
$_FILES
['file']['name'];

40 
$feTmpDœ
 = 
$_FILES
['file']['tmp_name'];

41 
$¡»amR—d”
 = 
	`fe_g‘_cÚ‹Ás
(
$feTmpDœ
);

42 
	`fe_put_cÚ‹Ás
("images/HDImages/{$feName}", 
$¡»amR—d”
);

43 
d›
;

44 
	}
}

48 
public
 
funùiÚ
 
	$ajax_li¡s
() {

49 
$this
->
lßd
->
	`v›w
('www/objeùs/ajax_li¡', 
$d©a
);

50 
	}
}

52 
public
 
funùiÚ
 
	$li¡_objeù_jsÚ
() {

53 
$li¡D©a
 = 
$this
->
obj
->
	`g‘Info
();

54 
echo
 
	`jsÚ_’code
(
$li¡D©a
);

55 
d›
;

56 
	}
}

58 
public
 
funùiÚ
 
	$İ”
(){

59 
$İ”
 = 
$_POST
['oper'];

60 
$this
->
	`$İ”
(
$_POST
);

61 
	}
}

63 
public
 
funùiÚ
 
	$§ve
(
$d©a
) {

64 
$»t
 = 
$this
->
obj
->
	`§ve
(
$d©a
);

65 
	`d›
(
$»t
);

66 
	}
}

68 
public
 
funùiÚ
 
	$ed™
(
$d©a
) {

69 
$»t
 = 
$this
->
obj
->
	`§ve
(
$d©a
);

70 
	`d›
(
$»t
);

71 
	}
}

73 
public
 
funùiÚ
 
	$d–
(
$d©a
) {

74 
$»t
 = 
$this
->
obj
->
	`d–‘e
(
$d©a
);

75 
	`d›
(
$»t
);

76 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/opportunity.php

1 <?
php


2 
»quœe
 
	gAPPPATH
.'/libraries/oauth.php';

3 
»quœe
 
	gAPPPATH
.'/libraries/Snoopy.php';

4 şas 
	cOµÜtun™y
 
ex‹nds
 
	mWWW_cÚŒŞËr
 {

5 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

6 
·»Á
::
	`__cÚ¡ruù
();

7 
$this
->
lßd
->
	`mod–
("www/opportunity_model", "opportunity");

8 
$this
->
lßd
->
	`mod–
("www/api_model", "api");

15 
public
 
funùiÚ
 
	$pha£_´omÙiÚ
(){

16 
$id
 = 
$_GET
["id"];

17 if(
$this
 -> 
İpÜtun™y
 -> 
	`g‘_İpÜtun™y_Ãw_¡age
(
$id
è!ğ
çl£
){

18 
$d©a
["id"] = 
$id
;

19 
$d©a
["»s"] = 
$this
 -> 
İpÜtun™y
 -> 
	`g‘_İpÜtun™y_Ãw_¡age
(
$id
);

20 
$this
->
lßd
->
	`v›w
('www/İpÜtun™y/pha£_´omÙiÚ',
$d©a
);

22 
echo
 "æ²¡æœ‰å¯ä»¥ç”³è¿çš„é˜¶æ®µ";

25 
	}
}

29 
public
 
funùiÚ
 
	$§ve_´omÙiÚ_d©a
(){

30 
$d©a
["OµÜtun™y.Sge"] = 
$_POST
["new_stage"];

31 
$id
 = 
$_POST
["id"];

32 
$d©a
["OµÜtun™y.ID"] = 
$id
;

33 if(
	`is£t
(
$_POST
["success_hidden"]) && $_POST["success_hidden"] ==1 ){

34 
$accouÁ_id
 = 
$this
 -> 
İpÜtun™y
 -> 
	`g‘_accouÁ_id
(
$id
);

35 
$accouÁ_em¡©us
 = 
$this
 -> 
İpÜtun™y
 -> 
	`g‘_accouÁ_em¡©us
(
$accouÁ_id
);

36 if(
$accouÁ_em¡©us
){

37 
$accouÁ_šfo
 = 
$this
 -> 
İpÜtun™y
 -> 
	`g‘_accouÁ_šfo
(
$accouÁ_id
);

41 
$»s_ema
 = 
$this
 -> 
­i
 -> 
	`£¬ch_busšess_id
(
$accouÁ_šfo
["ACCOUNT_EMAIL"]);

42 if(
$»s_ema
["status"] == "success"){

43 
$bussiÚ_couÁ
 = 
$this
 -> 
İpÜtun™y
 -> 
	`»checkšg_id
(
$»s_ema
["data"]["uid"]);

44 if(
$bussiÚ_couÁ
){

45 
echo
 "å•†ä¸šidé‡å¤";

46 
d›
;

48 
$busšess_id
 = 
$»s_ema
["data"]["uid"];

52 
$»s_phÚe
 = 
$this
 -> 
­i
 -> 
	`£¬ch_busšess_id
(
$accouÁ_šfo
["ACCOUNT_MOBILE_PHONE"]);

53 if(
$»s_phÚe
["status"] == "success"){

54 
$bussiÚ_couÁ
 = 
$this
 -> 
İpÜtun™y
 -> 
	`»checkšg_id
(
$»s_phÚe
["data"]["uid"]);

55 if(
$bussiÚ_couÁ
){

56 
echo
 "å•†ä¸šidé‡å¤";

57 
d›
;

59 
$busšess_id
 = 
$»s_phÚe
["data"]["uid"];

62 
$·¿ms
['u£ºame'] = 
$accouÁ_šfo
["ACCOUNT_EMAIL"];

63 
$·¿ms
['usertype'] = 0;

64 ià(
$accouÁ_šfo
["ACCOUNT_TYPE"]==26){

65 
$·¿ms
['enttype'] = 1;

66 
$·¿ms
['com·ny'] = 
$accouÁ_šfo
["ACCOUNT_NAME"];

68 ià(
$accouÁ_šfo
["ACCOUNT_TYPE"]==90){

69 
$·¿ms
['enttype'] = 0;

70 
$·¿ms
['owÃr'] = 
$accouÁ_šfo
["ACCOUNT_NAME"];

72 
$·¿ms
['source'] = 'shopex_pbi';

73 
$·¿ms
['ema'] = 
$accouÁ_šfo
["ACCOUNT_EMAIL"];

74 
$·¿ms
['´ovšû'] = 
$this
 -> 
­i
 -> 
	`´ovšû
(
	`¡rv®
(
$accouÁ_šfo
["ACCT_INT04"]));

75 
$·¿ms
['trade'] = 42;

76 
$·¿ms
['mobe'] = 
$accouÁ_šfo
["ACCOUNT_MOBILE_PHONE"];

80 
$¬¼es
 = 
$this
 -> 
­i
 -> 
	`g’”©e_busšess_id
(
$·¿ms
);

81 ià(
$¬¼es
["result"]=='false'){

82 
echo
 
$¬¼es
["message"];

83 
d›
;

85 
$busšess_id
 = 
$¬¼es
['shopex.user.add']['user']['entid'];

94 
$buss_d©a
["AccouÁ.ID"] = 
$accouÁ_id
;

95 
$buss_d©a
["AccouÁ.cu¡om”ID"] = 
$busšess_id
;

96 
$buss_d©a
["Account.emstatus"] = 1002;

97 
$buss_d©a
["Account.emstatus.enum_key"] = 1002;

98 
$buss_d©a
["module_action"] = "module_update";

99 
$buss_d©a
["module_model"] = "Account";

100 
$busšess_»s
 = 
$this
 -> 
İpÜtun™y
 -> 
	`upd©e_accouÁ_busšess_ty³
(
$buss_d©a
);

101 if(
$busšess_»s
["res"] != "suc"){

102 
echo
 "å•†ä¸šidå†™å…¥å¤±è´¥";

103 
d›
;

112 
$d©a
["module_action"] = "module_update";

113 
$d©a
["module_model"] = "Opportunity";

114 
$»s
 = 
$this
 -> 
İpÜtun™y
 -> 
	`İpÜtun™y_§ve
(
$d©a
);

116 if(
$»s
["res"] == "suc"){

117 
echo
 1;

119 
echo
 
$»s
["msg"];

123 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/platform.php

1 <?
php


13 
CÏss
 
PÏtfÜm
 
ex‹nds
 
	gWWW_cÚŒŞËr
{

15 
funùiÚ
 
__cÚ¡ruù
(){

16 
	g·»Á
::
__cÚ¡ruù
();

17 
	g$this
->
	glßd
->
mod–
('service/platform_service_model', 'platformService');

26 
public
 
funùiÚ
 
v›wAùiÚ
(){

27 
	g$¶©fÜmD©a
 = 
$this
->
¶©fÜmS”viû
->
ãtchAÎPÏtfÜm
();

28 
	g$this
->
»nd”
('www/pÜl/¶©fÜm', 
$¶©fÜmD©a
);

37 
public
 
funùiÚ
 
addAùiÚ
(){

38 
	g$»t
 = 
¬¿y
("succ" => 
TRUE
, "msg" =>‡rray());

39 
	g$¶©fÜmName
 = 
mb_sub¡r
(
$this
->
šput
->
po¡
('platformName'), 0, 20, 'UTF-8');

40 
	g$¶©fÜmU¾
 = 
mb_sub¡r
(
$this
->
šput
->
po¡
('platformUrl'), 0, 20, 'UTF-8');

41 
	g$¶©fÜmDesc
 = 
mb_sub¡r
(
$this
->
šput
->
po¡
('platformDesc'), 0, 20, 'UTF-8');

42 if(
em±y
(
$¶©fÜmName
è&&ƒm±y(
$¶©fÜmU¾
)){

43 
	g$»t
['succ'] = 
FALSE
;

44 
	g$»t
['msg'] = "åœ°å€æˆ–è€…æ ‡é¢˜ä¸èƒ½ä¸ºç©º";

45 
	g$this
->
£nd”
(
$»t
);

47 
	g$»t
 = 
$this
->
¶©fÜmS”viû
->
addPÏtfÜm
(
$¶©fÜmName
, 
$¶©fÜmU¾
, 
$¶©fÜmDesc
);

48 
	g$this
->
£nd”
(
$»t
);

57 
public
 
funùiÚ
 
ed™AùiÚ
(){

58 
	g$»t
 = 
¬¿y
("succ" => 
TRUE
, "msg" =>‡rray());

59 
	g$¶©fÜmID
 = 
štv®
(
$this
->
šput
->
po¡
('platformID'));

60 
	g$¶©fÜmName
 = 
mb_sub¡r
(
$this
->
šput
->
po¡
('platformName'), 0, 20, 'UTF-8');

61 
	g$¶©fÜmU¾
 = 
mb_sub¡r
(
$this
->
šput
->
po¡
('platformUrl'), 0, 20, 'UTF-8');

62 
	g$¶©fÜmDesc
 = 
mb_sub¡r
(
$this
->
šput
->
po¡
('platformDesc'), 0, 20, 'UTF-8');

63 if(
	g$¶©fÜmID
 > 0){

64 
	g$»t
['succ'] = 
FALSE
;

65 
	g$»t
['msg'] = "éæ³•è¯·æ±‚";

66 
	g$this
->
£nd”
(
$»t
);

68 if(
em±y
(
$¶©fÜmName
è&&ƒm±y(
$¶©fÜmU¾
)){

69 
	g$»t
['succ'] = 
FALSE
;

70 
	g$»t
['msg'] = "åœ°å€æˆ–è€…æ ‡é¢˜ä¸èƒ½ä¸ºç©º";

71 
	g$this
->
£nd”
(
$»t
);

73 
	g$this
->
	g¶©fÜmS”viû
->
upd©ePÏtfÜm
(
$¶©fÜmID
, 
$¶©fÜmName
, 
$¶©fÜmU¾
, 
$¶©fÜmDesc
);

74 
	g$this
->
£nd”
(
$»t
);

83 
public
 
funùiÚ
 
d–AùiÚ
(){

84 
	g$»t
 = 
¬¿y
("succ" => 
TRUE
, "msg" =>‡rray());

85 
	g$¶©fÜmID
 = 
štv®
(
$this
->
šput
->
po¡
('platformID'));

86 
	g$»t
 = 
$this
->
¶©fÜmS”viû
->
d–PÏtfÜm
(
$¶©fÜmID
);

87 
	g$this
->
£nd”
(
$»t
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/portal.php

1 <?
php


2 
CÏss
 
PÜl
 
ex‹nds
 
	gWWW_cÚŒŞËr
{

4 
´iv©e
 
	g$pÜlDB
;

5 
´iv©e
 
	g$htmlP©h
 = "htmltemplete/announcement/@.html";

7 
funùiÚ
 
__cÚ¡ruù
(){

8 
	g·»Á
::
__cÚ¡ruù
();

9 
	g$this
->
	gpÜlDB
 = 
$this
->
lßd
->
d©aba£
('pÜl', 
TRUE
);

10 
	g$this
->
	glßd
->
mod–
('www/banner_model', 'banner');

11 
	g$this
->
	glßd
->
mod–
('www/announcement_model', 'announcementModel');

12 
	g$this
->
	glßd
->
mod–
('www/marteria_model', 'marteria');

15 
public
 
funùiÚ
 
images
(){

16 
	g$»t
['d©a'] = 
$this
->
bªÃr
->
qu”yBªÃr
(
TRUE
);

17 
	g$this
->
»nd”
('www/pÜl/images',
$»t
);

20 
public
 
funùiÚ
 
d–BªÃr
(){

22 
	g$pÜlId
 = 
štv®
(
$this
->
šput
->
po¡
('portalId'));

23 
	g$»t
 = 
$this
->
bªÃr
->
d–BªÃr
(
$pÜlId
);

24 
echo
 
	g$»t
;

25 
	gd›
;

28 
public
 
funùiÚ
 
muÉife
(){

29 
	g$d©a
['u¾'] = 
s™e_u¾
('www/portal/multiFiles');

30 
	g$this
->
	glßd
->
v›w
('www/objeùs/imagesu¶ßd', 
$d©a
);

33 
public
 
funùiÚ
 
muÉiFes
(){

34 
	g$feName
 = 
$_FILES
['file']['name'];

35 
	g$feTmpDœ
 = 
$_FILES
['file']['tmp_name'];

36 
	g$¡»amR—d”
 = 
fe_g‘_cÚ‹Ás
(
$feTmpDœ
);

37 
fe_put_cÚ‹Ás
("images/bªÃrImages/{$feName}", 
$¡»amR—d”
);

38 
	g$bªÃrPic
 = 
ba£_u¾
() . "images/bannerImages/{$fileName}";

39 
	g$bªÃrAddSql
 = "insert intoc_banner(banner_pic, banner_is_status) values('{$bannerPic}', 'TRUE')";

40 
	g$»t
 = 
$this
->
pÜlDB
->
qu”y
(
$bªÃrAddSql
);

41 
d›
(
$»t
);

50 
public
 
funùiÚ
 
cked™MuÉiFes
(){

51 
	g$mes§ge
 = '';

52 
	g$feName
 = 
$_FILES
['upload']['name'];

53 
	g$feTmpDœ
 = 
$_FILES
['upload']['tmp_name'];

54 
	g$funcNum
 = 
$_GET
['CKEditorFuncNum'];

55 
	g$CKEd™Ü
 = 
$_GET
['CKEditor'];

56 
	g$ÏngCode
 = 
$_GET
['langCode'];

57 
	g$»tWr™eP©h
 = 
$this
->
m¬‹rŸ
->
§veM¬‹rŸP©h
(
$feTmpDœ
, 
$feName
);

58 
	g$»tWr™eP©h
){

60 
$mes§ge
 = 'fileExtension isƒrror';

63 
$wr™”Pic
 = 
ba£_u¾
(è. 
$»tWr™eP©h
;

64 
	g$m¬‹rŸD©a
 = 
¬¿y
();

65 
	g$m¬‹rŸD©a
['m¬‹rŸ_·th'] = 
$wr™”Pic
;

66 
	g$m¬‹rŸD©a
['marteria_is_status'] = 'TRUE';

67 
	g$m¬‹rŸID
 = 
$this
->
m¬‹rŸ
->
addM¬‹rŸ
(
$m¬‹rŸD©a
);

68 if(!
	g$m¬‹rŸID
è
	g$mes§ge
 = 'marteriaData‡dd is FALSE';

74 
	gecho
 "<scriptype='text/javascript'>window.parent.innerAnnouncement({$marteriaID});</script>";

78 
	gecho
 "<scriptype='text/javascript'>window.parent.CKEDITOR.tools.callFunction($funcNum, '$writerPic', '$message');</script>";

87 
public
 
funùiÚ
 
ªnounûm’t
(){

88 
	g$ªnounûm’tD©a
 = 
$this
->
ªnounûm’tMod–
->
g‘AÂounûm’tD©a
();

89 
	g$this
->
»nd”
('www/pÜl/ªnounûm’t', 
$ªnounûm’tD©a
);

98 
public
 
funùiÚ
 
addAÂounûm’t
(){

99 
	g$ªnounûm’tT™Ë
 = 
$this
->
šput
->
po¡
("announcement_title");

100 
	g$ªnounûm’tPic
 = 
$this
->
šput
->
po¡
("announcement_pic");

101 
	g$ªnounûm’tC»©eD©e
 = 
¡¹Ùime
(
$this
->
šput
->
po¡
("announcement_create_date"));

102 
	g$ªnounûm’tTag
 = 
$this
->
šput
->
po¡
("announcement_tag");

103 
	g$ªnounûm’tHtml
 = 
$this
->
šput
->
po¡
("announcement_html");

104 
	g$ªnounûm’tIsStus
 = 
štv®
(
$this
->
šput
->
po¡
("announcement_is_status"));

105 
	g$ªnounûm’tD©a
 = 
¬¿y
(

106 "ªnounûm’t_t™Ë" => 
$ªnounûm’tT™Ë
,

107 "ªnounûm’t_pic" => 
$ªnounûm’tPic
,

108 "ªnounûm’t_ü—‹_d©e" => 
$ªnounûm’tC»©eD©e
,

109 "ªnounûm’t_g" => 
$ªnounûm’tTag
,

110 "ªnounûm’t_html_·th" => 
£lf
::
htmlP©h
,

111 "ªnounûm’t_is_¡©us" => 
$ªnounûm’tIsStus
,

113 
	g$»t
 = 
$this
->
ªnounûm’tMod–
->
addAÂounûm’t
(
$ªnounûm’tD©a
);

114 if(
	g$»t
){

115 
	g$ªnounûm’tHtmlP©h
 = 
£lf
::
ªnounûm’tSaveHtmlP©h
(
$»t
, 
$ªnounûm’tHtml
);

116 
	g$ªnounûm’tUpD©a
 = 
¬¿y
(

117 "ªnounûm’t_html_·th" => 
$ªnounûm’tHtmlP©h
,

119 
	g$»t
 = 
$this
->
ªnounûm’tMod–
->
upd©eAÂounûm’t
(
$»t
, 
$ªnounûm’tUpD©a
);

121 
echo
 
	g$»t
;

122 
	gd›
;

125 
public
 
funùiÚ
 
d–AÂounûm’t
(){

126 
	g$ªnounûm’tID
 = 
štv®
(
$this
->
šput
->
po¡
('announcement_id'));

127 
	g$»t
 = 
$this
->
ªnounûm’tMod–
->
upd©eAÂounûm’t
(
$ªnounûm’tID
, 
¬¿y
('ªnounûm’t_is_¡©us', 
FALSE
));

128 
d›
(
$»t
);

131 
public
 
funùiÚ
 
v›wAÂounûm’t
(){

132 
	g$ªnounûm’tID
 = 
štv®
(
$this
->
šput
->
po¡
('announcement_id'));

133 
	g$ªnounûm’tD©a
 = 
$this
->
ªnounûm’tMod–
->
g‘AÂounûm’tD©a
(
$ªnounûm’tID
);

134 
	g$this
->
	glßd
->
v›w
('www/pÜl/v›wAÂounûm’t', 
$ªnounûm’tD©a
);

135 
	gd›
;

138 
public
 
funùiÚ
 
ed™AÂounûm’t
(){

139 
	g$ªnounûm’tID
 = 
štv®
(
$this
->
šput
->
po¡
("announcement_id"));

140 
	g$ªnounûm’tT™Ë
 = 
$this
->
šput
->
po¡
("announcement_title");

141 
	g$ªnounûm’tPic
 = 
$this
->
šput
->
po¡
("announcement_pic");

142 
	g$ªnounûm’tC»©eD©e
 = 
¡¹Ùime
(
$this
->
šput
->
po¡
("announcement_create_date"));

143 
	g$ªnounûm’tTag
 = 
$this
->
šput
->
po¡
("announcement_tag");

144 
	g$ªnounûm’tHtml
 = 
$this
->
šput
->
po¡
("announcement_html");

145 
	g$ªnounûm’tIsStus
 = 
štv®
(
$this
->
šput
->
po¡
("announcement_is_status"));

146 
	g$ªnounûm’tHtmlP©h
 = 
£lf
::
ªnounûm’tSaveHtmlP©h
(
$ªnounûm’tID
, 
$ªnounûm’tHtml
);

147 
	g$ªnounûm’tD©a
 = 
¬¿y
(

148 "ªnounûm’t_t™Ë" => 
$ªnounûm’tT™Ë
,

149 "ªnounûm’t_pic" => 
$ªnounûm’tPic
,

150 "ªnounûm’t_ü—‹_d©e" => 
$ªnounûm’tC»©eD©e
,

151 "ªnounûm’t_g" => 
$ªnounûm’tTag
,

152 "ªnounûm’t_html_·th" => 
$ªnounûm’tHtmlP©h
,

153 "ªnounûm’t_is_¡©us" => 
$ªnounûm’tIsStus
,

155 
	g$»t
 = 
$this
->
ªnounûm’tMod–
->
upd©eAÂounûm’t
(
$ªnounûm’tID
, 
$ªnounûm’tD©a
);

156 
echo
 
	g$»t
;

157 
	gd›
;

168 
´iv©e
 
funùiÚ
 
ªnounûm’tSaveHtmlP©h
(
$ªnounûm’tID
, 
$ªnounûm’tHtml
){

169 
fe_put_cÚ‹Ás
("htmÉem¶‘e/ªnounûm’t/{$ªnounûm’tID}.html", 
$ªnounûm’tHtml
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/relprivilege.php

1 <?
php


9 şas 
	cR–´ivege
 
ex‹nds
 
	mWWW_CÚŒŞËr
 {

11 
funùiÚ
 
	$__cÚ¡ruù
() {

12 
·»Á
::
	`__cÚ¡ruù
();

13 
$this
->
lßd
->
	`mod–
("www/relprivilege_model", "relprivilege");

14 
$this
->
lßd
->
	`mod–
("admin/obj_model", "obj");

17 
public
 
funùiÚ
 
	$ajax_li¡s
() {

18 
$d©a
['id'] = 
$_GET
['id'];

19 
$d©a
['obj_ty³'] = 
$_GET
['obj_type'];

20 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$d©a
['obj_type']);

21 
$obj_Çme
 = 
$obj
['OBJ_NAME'];

22 
$d©a
['´im¬ty_id'] = 
$obj_Çme
 . "_" . 
	`time
(è. 
	`¿nd
(100, 999);;

23 
$this
->
lßd
->
	`v›w
('www/»Írivege/ajax_»Írivege_li¡s', 
$d©a
);

24 
	}
}

29 
public
 
funùiÚ
 
	$ajax_v›w_li¡s
() {

30 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

31 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

32 
$d©a
['id'] = 
$_REQUEST
['id'];

33 
$d©a
['obj_ty³'] = 
$_REQUEST
['obj_type'];

35 
$Cu¼’tPage
 = 
	`is£t
(
$_REQUEST
['page']) ? $_REQUEST['page'] : 1;

36 
$PageSize
 = 
	`is£t
(
$_REQUEST
['rows']) ? $_REQUEST['rows'] : 10;

37 
$·ges_d©a
 = 
$this
->
»Írivege
->
	`·g”_šfo_li¡
(
$d©a
, 
$u£r_id
, 
$Üg_id
, 
$Cu¼’tPage
, 
$PageSize
);

38 
echo
 
$·ges_d©a
;

39 
d›
;

40 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/reluser.php

1 <?
php


9 şas 
	cR–u£r
 
ex‹nds
 
	mWWW_CÚŒŞËr
 {

11 
funùiÚ
 
	$__cÚ¡ruù
() {

12 
·»Á
::
	`__cÚ¡ruù
();

13 
$this
->
lßd
->
	`mod–
("www/reluser_model", "reluser");

16 
public
 
funùiÚ
 
	$ajax_li¡s
() {

17 
$d©a
['id'] = 
$_GET
['id'];

18 
$d©a
['obj_ty³'] = 
$_GET
['obj_type'];

19 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$d©a
['obj_type']);

20 
$obj_Çme
 = 
$obj
['OBJ_NAME'];

21 
$d©a
['´im¬ty_id'] = 
$obj_Çme
 . "_" . 
	`time
(è. 
	`¿nd
(100, 999);

22 
$this
->
lßd
->
	`v›w
('www/»lu£r/ajax_»lu£r_li¡s', 
$d©a
);

23 
	}
}

28 
public
 
funùiÚ
 
	$ajax_v›w_li¡s
() {

29 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

30 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

31 
$d©a
['id'] = 
$_REQUEST
['id'];

32 
$d©a
['obj_ty³'] = 
$_REQUEST
['obj_type'];

34 
$Cu¼’tPage
 = 
	`is£t
(
$_REQUEST
['page']) ? $_REQUEST['page'] : 1;

35 
$PageSize
 = 
	`is£t
(
$_REQUEST
['rows']) ? $_REQUEST['rows'] : 10;

36 
$·ges_d©a
 = 
$this
->
»lu£r
->
	`·g”_šfo_li¡
(
$d©a
, 
$u£r_id
, 
$Üg_id
, 
$Cu¼’tPage
, 
$PageSize
);

37 
echo
 
$·ges_d©a
;

38 
d›
;

39 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/remind.php

1 <?
php


2 şas 
	cRemšd
 
ex‹nds
 
	mWWW_cÚŒŞËr
 {

4 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

5 
·»Á
::
	`__cÚ¡ruù
();

6 
$this
->
lßd
->
	`mod–
('www/lead_model', 'lead');

7 
$this
->
lßd
->
	`mod–
('www/objects_model', 'objects');

8 
$this
->
lßd
->
	`mod–
('admin/obj_model', 'obj');

9 
$this
->
lßd
->
	`mod–
('admin/format_model', 'format');

10 
$this
->
lßd
->
	`mod–
('admin/attr_model', 'attr');

11 
$this
->
lßd
->
	`mod–
('www/remind_model','remind');

12 
$this
->
lßd
->
	`mod–
('www/message_model','message');

14 
public
 
funùiÚ
 
	$šdex
(){

15 
$this
->
	`Desktİ»mšd”li¡
();

16 
	}
}

18 
public
 
funùiÚ
 
	$li¡s
() {

19 
$OrgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

20 
$ObjTy³
 = 
$_GET
['obj_type'];

21 
$U£rID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

22 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$ObjTy³
);

23 
$obj_Çme
 = 
$obj
['OBJ_NAME'];

24 
$d©a
 = 
$this
->
	`g‘Li¡s
(
$obj_Çme
, 
__FUNCTION__
);

26 
$d©a
["objName"] = 
$this
 ->
obj
-> 
	`g‘Li¡Name
(
$obj_Çme
);

28 
$d©a
["ObjTy³"] = 
$ObjTy³
;

30 
$d©a
 = 
$this
 ->
objeùs
-> 
	`pub_bu‰Ú
(
$OrgID
,$data);

31 
$d©a
['mes§ge'] = 
$this
->
mes§ge
->
	`couÁn4
(
$U£rID
);

33 
$d©a
['ColModel']['Col'][0]['Width']=700;

34 
$d©a
['ColModel']['Col'][0]['Url']="{REMIND.url}";

36 
$this
->
	`»nd”
('www/»mšd/li¡', 
$d©a
);

38 
	}
}

40 
public
 
funùiÚ
 
	$g‘Li¡s
(
$obj_Çme
, 
$func_Çme
) {

41 
$d©a
['menu_active'] = 3;

42 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

43 
$LªgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('lang_id');

44 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

45 
$S’iÜQu”yA‰rs
 = 
	`¬¿y
(

46 "Üg_id" => 
$Üg_id
,

47 "LªgID" => 
$LªgID
,

48 "obj_Çme" => 
$obj_Çme
,

49 "u£r_id" => 
$u£r_id
,

51  
$this
->
»mšd
->
	`g‘Li¡sA‰r
(
$S’iÜQu”yA‰rs
);

52 
	}
}

54 
public
 
funùiÚ
 
	$DesktİRemšd”Li¡
(){

55 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

56 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

57 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 'Reminder');

58 
$»mšd”_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 'Reminder');

60 
$d©a
 = 
$this
->
»mšd
->
	`Remšd”Li¡
(
$Üg_id
,
$u£r_id
,
Œue
);

61 
echo
 
$d©a
;

62 
d›
;

63 
	}
}

65 
public
 
funùiÚ
 
	$Remšd”Li¡
(){

66 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

67 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

68 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 'Reminder');

69 
$»mšd”_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 'Reminder');

71 
$Cu¼’tPage
 = 
	`is£t
(
$_REQUEST
['page']) ? $_REQUEST['page'] : 1;

72 
$PageSize
 = 
	`is£t
(
$_REQUEST
['rows']) ? $_REQUEST['rows'] : 10;

73 
$d©a
 = 
$this
->
»mšd
->
	`Remšd”Li¡
(
$Üg_id
,
$u£r_id
,
çl£
,
$Cu¼’tPage
,
$PageSize
);

75 
echo
 
$d©a
;

76 
d›
;

77 
	}
}

78 
public
 
funùiÚ
 
	$add
(){

80 
$this
->
»mšd
->
	`AddRemšd
(3,1,1,2046116);

81 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/user.php

1 <?
php


2 şas 
	cU£r
 
ex‹nds
 
	mWWW_cÚŒŞËr
 {

4 
public
 
funùiÚ
 
	$modify_·sswÜd
(){

5 
$d©a
="";

6 
$this
->
lßd
->
	`v›w
('www/logš/modify_·sswÜd',
$d©a
);

8 
public
 
funùiÚ
 
	$upd©e_·sswÜd
(){

9 
$this
->
lßd
->
	`mod–
('www/u£r_mod–',
$u£r
);

10 
$Şd·ss
 = 
$_POST
['User.LoginPassword'];

11 
$Ãw·ss
 = 
$_POST
['User.NewPassword'];

12 
	`p
(
$Ãw·ss
);

14 
$ºew·ss
 = 
$_POST
['User.RepeatPassword'];

15 
	`p
(
$ºew·ss
);

16 
$LogšName
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('login_name');

17 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

18 
$OrgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

20 
$u£r_d©a
 = 
$this
->
u£r
->
	`LogšU£rD©a2
(
$LogšName
,
$OrgID
);

22 if(
$this
->
u£r
->
	`checkPasswÜd
(
$Şd·ss
, 
$u£r_d©a
['LOGIN_PASSWORD'])==
Œue
){

23 if(
$Ãw·ss
 =ğ
$ºew·ss
){

25 
$»s
['res'] = 'suc';

26 
$»s
['msg'] = ' å¯†ç ä¿®æ”¹æˆåŠŸï¼';

28 
$»s
['res'] = 'fail';

29 
$»s
['msg'] = 'é‡å¤å¯†ç ä¸ä¸€è‡´ï¼';

32 
$»s
['res'] = 'fail';

33 
$»s
['msg'] = 'åŸå¯†ç é”™è¯¯ï¼';

36 
echo
 
	`jsÚ_’code
(
$»s
);

37 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/core/MY_Controller.php

1 <?
php


3 ià(!
defšed
('BASEPATH'))

4 
ex™
('No direct script‡ccess‡llowed');

6 şas 
	cADMIN_CÚŒŞËr
 
ex‹nds
 
	mCI_CÚŒŞËr
 {

7 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

8 
·»Á
::
	`__cÚ¡ruù
();

9 
	`defše
('css_u¾', 
	`ba£_u¾
() . 'style/css');

10 
$this
->
ouut
->
	`’abË_´of”
(
TRUE
);

11 
$this
->
lßd
->
	`h–³r
("form");

17 
public
 
funùiÚ
 
	$£ssiÚ_time
(){

18 if(
	`is£t
(
$this
->
£ssiÚ
->
u£rd©a
)){

19 if(!
	`is£t
(
$this
->
£ssiÚ
->
u£rd©a
['user_id'])){

20 if(
$this
->
£ssiÚ
->
u£rd©a
['is_admin']!=1){

21 
	`»dœeù
('admin/login');

25 
	}
}

27 
public
 
funùiÚ
 
»nd”
(
$v›w
, 
$d©a
 = '') {

28 
$this
->
£ssiÚ_time
();

29 
	g$this
->
	glßd
->
v›w
('admš/Ïyouts/h—d', 
$d©a
);

30 
	g$this
->
	glßd
->
v›w
(
$v›w
, 
$d©a
);

31 
	g$this
->
	glßd
->
v›w
('admin/layouts/bottom');

34 
public
 
funùiÚ
 
	$Ïb–
(
$f‹r_Ïb–
, 
$f‹r_Çme
) {

35 
$Ïb–_f‹r
 = 
	`¬¿y
(

38  
	`fÜm_Ïb–
(
$f‹r_Ïb–
 . "<¥ª cÏss='»quœed'>*</¥ª>", 
$f‹r_Çme
, 
$Ïb–_f‹r
);

39 
	}
}

42 
public
 
funùiÚ
 
	$‹xtF›ld
(
$d©a
, 
$obj_Çme
) {

43 
$f‹r_Çme
 = 
$obj_Çme
 . '_' . 
$d©a
['attr_name'];

44 
$f‹r_Ïb–
 = 
$d©a
['attr_label'];

45 
$f‹r_ty³
 = 
$d©a
['attr_field_type'];

46 
$‹xt_f‹r
 = 
	`¬¿y
(

47 'Çme' => 
$f‹r_Çme
,

48 'id' => 
$f‹r_Çme
,

49 '¶aûhŞd”' => 
$f‹r_Ïb–
,

52 
$html_compÚªt
 = "";

53 
$html_compÚªt
 .ğ"<div cÏss='cÚŒŞ-group'>" . 
$this
->
	`Ïb–
(
$f‹r_Ïb–
, 
$f‹r_Çme
);

54 
$html_compÚªt
 .="<div cÏss='cÚŒŞs'>" . 
	`fÜm_šput
(
$‹xt_f‹r
) . "</div></div>

56  
$html_compÚªt
;

57 
	}
}

60 
public
 
funùiÚ
 
	$»ã»nû
(
$d©a
, 
$obj_Çme
) {

62 
	}
}

65 
public
 
funùiÚ
 
	$checkbox
(
$d©a
, 
$obj_Çme
) {

67 
	}
}

70 
public
 
funùiÚ
 
	$¿diobu‰Ú
(
$d©a
, 
$obj_Çme
) {

71 
$f‹r_Çme
 = 
$obj_Çme
 . '_' . 
$d©a
['attr_name'];

72 
$f‹r_Ïb–
 = 
$d©a
['attr_label'];

74 
$¿dio_f‹r
 = 
	`¬¿y
(

75 'Çme' => 
$f‹r_Çme
,

77 
$html_compÚªt
 = "<div cÏss='cÚŒŞ-group'>" . 
$this
->
	`Ïb–
(
$f‹r_Ïb–
, 
$f‹r_Çme
);

78 
$html_compÚªt
.="<div cÏss='cÚŒŞs'>" . "<Ïb– cÏss='¿diØšlše'>" . 
	`fÜm_¿dio
(
$¿dio_f‹r
) . "aa</label>";

79 
$html_compÚªt
.="<Ïb– cÏss='¿diØšlše'>" . 
	`fÜm_¿dio
(
$¿dio_f‹r
) . "aa</label></div></div>

81  
$html_compÚªt
;

82 
	}
}

85 
public
 
funùiÚ
 
	$drİdowÆi¡
(
$d©a
, 
$obj_Çme
) {

86 
$f‹r_Çme
 = 
$obj_Çme
 . '_' . 
$d©a
['attr_name'];

87 
$f‹r_Ïb–
 = 
$d©a
['attr_label'];

88 
$html_compÚªt
 = "<div cÏss='cÚŒŞ-group'>" . 
$this
->
	`Ïb–
(
$f‹r_Ïb–
, 
$f‹r_Çme
);

89 
$html_compÚªt
.="<div class='controls'>" . "<selected‚ame='{$filter_name}'>

91 
	}
}

95 şas 
	cWWW_CÚŒŞËr
 
ex‹nds
 
	mCI_CÚŒŞËr
 {

97 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

98 
·»Á
::
	`__cÚ¡ruù
();

99 
	`defše
('css_u¾', 
	`ba£_u¾
() . 'style/css');

101 
$this
->
	`£ssiÚ_time
();

102 
$this
->
lßd
->
	`mod–
('www/user_model', 'user');

108 
public
 
funùiÚ
 
	$£ssiÚ_time
(){

109 if(
	`is£t
(
$this
->
£ssiÚ
->
u£rd©a
)){

110 if(!
	`is£t
(
$this
->
£ssiÚ
->
u£rd©a
['user_id'])){

111 
	`»dœeù
('www/login');

114 
	}
}

116 
public
 
funùiÚ
 
»nd”
(
$v›w
, 
$d©a
 = '') {

117 
$this
->
£ssiÚ_time
();

120 
	g$this
->
	glßd
->
mod–
('admin/menu_model','menu');

121 if(
is£t
(
$d©a
['menu_active'])){

122 
	g$m’u_aùive
 = 
$d©a
['menu_active'];

124 
	g$m’u_aùive
 = "";

126 
	g$d©a
['m’u_jsÚ'] = 
$this
->
m’u
->
G‘M’uJsÚ
($this->
£ssiÚ
->
u£rd©a
['Üg_id'],$this->£ssiÚ->u£rd©a['logš_sys'],
$m’u_aùive
);

127 
	g$d©a
['£ssiÚ']['u£r_Çme'] = 
$this
->
£ssiÚ
->
u£rd©a
['user_name'];

128 
	g$this
->
	glßd
->
v›w
('www/Ïyouts/h—d', 
$d©a
);

129 
	g$this
->
	glßd
->
v›w
(
$v›w
, 
$d©a
);

130 
	g$this
->
	glßd
->
v›w
('www/layouts/bottom');

133 
public
 
funùiÚ
 
	$£nd”
(
$d©a
){

134 
	`h—d”
('Content-type:‡pplication/json');

135 
echo
 
	`jsÚ_’code
(
$d©a
);

136 
d›
;

137 
	}
}

139 
public
 
funùiÚ
 
»nd”_ajax
(
$v›w
, 
$d©a
 = '') {

140 
$this
->
lßd
->
v›w
('www/layouts/head_ajax');

141 
	g$this
->
	glßd
->
v›w
(
$v›w
, 
$d©a
);

142 
	g$this
->
	glßd
->
v›w
('www/layouts/bottom_ajax');

145 
public
 
funùiÚ
 
	$g‘_d©a_auth
(
$obj_Çme
) {

146 
$u£r_auth
 = 
$this
->
u£r
->
	`u£r_auth
($this->
£ssiÚ
->
	`u£rd©a
('user_id'));

149 
$d©a_auth
 = 
	`¬¿y
();

150 ià(!
	`em±y
(
$u£r_auth
['data_auth_arr'])) {

151 
	`fÜ—ch
 (
$u£r_auth
['d©a_auth_¬r'] 
as
 
$key
 => 
$v®ue
) {

152 
$‹m
 = 
	`ex¶ode
('.', 
$v®ue
);

154 ià(
$‹m
[0] =ğ
$obj_Çme
) {

155 
$d©a_auth
[] = 
$‹m
[1];

160 
$max_auth_v®
 = 0;

162 
	`fÜ—ch
 (
$d©a_auth
 
as
 
$key
 => 
$v®ue
) {

163 ià(
	`d©a_auth_to_num
(
$v®ue
è> 
$max_auth_v®
) {

164 
$max_auth_v®
 = 
	`d©a_auth_to_num
(
$v®ue
);

169 
$wh”e
 = 
	`¬¿y
();

170 ià(
$max_auth_v®
 == 3) {

171 
$wh”e
['w1'] = 
	`¬¿y
(

173 'v®ue' => 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id'),

176 
$wh”e
['w2'] = 
	`¬¿y
(

178 'v®ue' => 
$this
->
£ssiÚ
->
	`u£rd©a
('department_id'),

181 
$wh”e_»l
 = "w1 or w2";

182 
$d©a
['wh”e'] = 
	`jsÚ_’code
(
$wh”e
);

183 
$d©a
['wh”e_»l'] = 
$wh”e_»l
;

184 } ià(
$max_auth_v®
 == 2) {

185 
$wh”e
['w1'] = 
	`¬¿y
(

187 'v®ue' => 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id'),

190 
$wh”e
['w2'] = 
	`¬¿y
(

192 'v®ue' => 
$this
->
£ssiÚ
->
	`u£rd©a
('department_id'),

195 
$wh”e_»l
 = "w1 or w2";

196 
$d©a
['wh”e'] = 
	`jsÚ_’code
(
$wh”e
);

197 
$d©a
['wh”e_»l'] = 
$wh”e_»l
;

200 } ià(
$max_auth_v®
 == 4) {

202 
$wh”e_»l
 = "w1";

203 
$d©a
['where'] = "''";

204 
$d©a
['where_rel'] = "";

205 } ià(
$max_auth_v®
 == 1) {

206 
$wh”e
['w1'] = 
	`¬¿y
(

208 'v®ue' => 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id'),

211 
$wh”e
['w2'] = 
	`¬¿y
(

213 'v®ue' => 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id'),

216 
$wh”e
['w3'] = 
	`¬¿y
(

218 'v®ue' => 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id'),

221 
$wh”e
['w4'] = 
	`¬¿y
(

223 'v®ue' => 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id'),

226 
$wh”e
['w5'] = 
	`¬¿y
(

228 'v®ue' => 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id'),

231 
$wh”e_»l
 = "w1 or w2 or w3 or w4 or w5";

232 
$d©a
['wh”e'] = 
	`jsÚ_’code
(
$wh”e
);

233 
$d©a
['wh”e_»l'] = 
$wh”e_»l
;

239  
	`¬¿y
();

242  
$d©a
;

243 
	}
}

246 
public
 
funùiÚ
 
	$feu¶ßd
() {

247 
$cÚfig
['upload_path'] = "./upload";

248 
$cÚfig
['allowed_types'] = "gif|jpg|png|jpeg";

249 
$cÚfig
['max_size'] = "10000";

250 
$cÚfig
['fe_Çme'] = 
	`time
(è. 
	`mt_¿nd
(1000, 9999);

251 
$this
->
lßd
->
	`lib¿ry
("u¶ßd", 
$cÚfig
);

252 
$¡©us
 = 
$this
->
u¶ßd
->
	`do_u¶ßd
('thumb');

253 ià(!
$¡©us
) {

254 
	`”rÜ
("æ²¡æœ‰ä¸Šä¼ å›¾ç‰‡");

256 
$wrÚg
 = 
$this
->
u¶ßd
->
	`di¥Ïy_”rÜs
();

257 ià(
$wrÚg
) {

258 
	`”rÜ
(
$wrÚg
);

260 
$šfo
 = 
$this
->
u¶ßd
->
	`d©a
();

261 
$thcÚfig
['image_library'] = 'gd2';

262 
$thcÚfig
['sourû_image'] = 
$šfo
['full_path'];

263 
$thcÚfig
['ü—‹_thumb'] = 
FALSE
;

264 
$thcÚfig
['mašš_¿tio'] = 
FALSE
;

265 
$thcÚfig
['width'] = 48;

266 
$thcÚfig
['height'] = 48;

267 
$this
->
lßd
->
	`lib¿ry
('image_lib', 
$thcÚfig
);

268 
$¡©us
 = 
$this
->
image_lib
->
	`»size
();

270  
$cÚfig
['file_name'];

272 
	}
}

275 
funùiÚ
 
	$g‘_ş›Á_
(){

276 ià(
$_SERVER
['REMOTE_ADDR']) {

277 
$c
 = 
$_SERVER
['REMOTE_ADDR'];

278 } 
	`–£if
 (
	`g‘’v
("REMOTE_ADDR")) {

279 
$c
 = 
	`g‘’v
("REMOTE_ADDR");

280 } 
	`–£if
 (
	`g‘’v
("HTTP_CLIENT_IP")) {

281 
$c
 = 
	`g‘’v
("HTTP_CLIENT_IP");

283 
$c
 = "unknown";

285  
$c
;

286 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/errors/error_404.php

1 <!
DOCTYPE
 
	ghtml
>

2 <
html
 
	gÏng
="en">

3 <
h—d
>

4 <
t™Ë
>404 
Page
 
NÙ
 
Found
</title>

5 <
¡yË
 
ty³
="text/css">

7 ::
£ËùiÚ
{ 
background
-
cŞÜ
: #E13300; 
	gcŞÜ
: 
wh™e
; }

8 ::
moz
-
£ËùiÚ
{ 
background
-
cŞÜ
: #E13300; 
	gcŞÜ
: 
wh™e
; }

9 ::
webk™
-
£ËùiÚ
{ 
background
-
cŞÜ
: #E13300; 
	gcŞÜ
: 
wh™e
; }

11 
	gbody
 {

12 
	gbackground
-
	gcŞÜ
: #fff;

13 
	gm¬gš
: 40
px
;

14 
	gfÚt
: 13
px
/20px 
nÜm®
 
H–v‘iÿ
, 
	gArŸl
, 
	g§ns
-
	g£rif
;

15 
	gcŞÜ
: #4
F5155
;

18 
	ga
 {

19 
	gcŞÜ
: #003399;

20 
	gbackground
-
	gcŞÜ
: 
Œª¥¬’t
;

21 
	gfÚt
-
	gweight
: 
nÜm®
;

24 
	gh1
 {

25 
	gcŞÜ
: #444;

26 
	gbackground
-
	gcŞÜ
: 
Œª¥¬’t
;

27 
	gbÜd”
-
	gbÙtom
: 1
px
 
sŞid
 #D0D0D0;

28 
	gfÚt
-
	gsize
: 19
px
;

29 
	gfÚt
-
	gweight
: 
nÜm®
;

30 
	gm¬gš
: 0 0 14
px
 0;

31 
	g·ddšg
: 14
px
 15px 10px 15px;

34 
	gcode
 {

35 
	gfÚt
-
	gçmy
: 
CÚsŞas
, 
	gMÚaco
, 
Cour›r
 
	gNew
, 
	gCour›r
, 
	gmÚo¥aû
;

36 
	gfÚt
-
	gsize
: 12
px
;

37 
	gbackground
-
	gcŞÜ
: #f9f9f9;

38 
	gbÜd”
: 1
px
 
sŞid
 #D0D0D0;

39 
	gcŞÜ
: #002166;

40 
	gdi¥Ïy
: 
block
;

41 
	gm¬gš
: 14
px
 0 14px 0;

42 
	g·ddšg
: 12
px
 10px 12px 10px;

46 
	gm¬gš
: 10
px
;

47 
	gbÜd”
: 1
px
 
sŞid
 #D0D0D0;

48 -
	gwebk™
-
	gbox
-
	gshadow
: 0 0 8
px
 #D0D0D0;

51 
	gp
 {

52 
	gm¬gš
: 12
px
 15px 12px 15px;

54 </
	g¡yË
>

55 </
	gh—d
>

56 <
	gbody
>

57 <
div
 
	gid
="container">

58 <
h1
><?
php
 
echo
 
$h—dšg
; ?></
	gh1
>

59 <?
php
 
echo
 
	g$mes§ge
; ?>

60 </
	gdiv
>

61 </
	gbody
>

62 </
	ghtml
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/errors/error_db.php

1 <!
DOCTYPE
 
	ghtml
>

2 <
html
 
	gÏng
="en">

3 <
h—d
>

4 <
t™Ë
>
D©aba£
 
E¼Ü
</title>

5 <
¡yË
 
ty³
="text/css">

7 ::
£ËùiÚ
{ 
background
-
cŞÜ
: #E13300; 
	gcŞÜ
: 
wh™e
; }

8 ::
moz
-
£ËùiÚ
{ 
background
-
cŞÜ
: #E13300; 
	gcŞÜ
: 
wh™e
; }

9 ::
webk™
-
£ËùiÚ
{ 
background
-
cŞÜ
: #E13300; 
	gcŞÜ
: 
wh™e
; }

11 
	gbody
 {

12 
	gbackground
-
	gcŞÜ
: #fff;

13 
	gm¬gš
: 40
px
;

14 
	gfÚt
: 13
px
/20px 
nÜm®
 
H–v‘iÿ
, 
	gArŸl
, 
	g§ns
-
	g£rif
;

15 
	gcŞÜ
: #4
F5155
;

18 
	ga
 {

19 
	gcŞÜ
: #003399;

20 
	gbackground
-
	gcŞÜ
: 
Œª¥¬’t
;

21 
	gfÚt
-
	gweight
: 
nÜm®
;

24 
	gh1
 {

25 
	gcŞÜ
: #444;

26 
	gbackground
-
	gcŞÜ
: 
Œª¥¬’t
;

27 
	gbÜd”
-
	gbÙtom
: 1
px
 
sŞid
 #D0D0D0;

28 
	gfÚt
-
	gsize
: 19
px
;

29 
	gfÚt
-
	gweight
: 
nÜm®
;

30 
	gm¬gš
: 0 0 14
px
 0;

31 
	g·ddšg
: 14
px
 15px 10px 15px;

34 
	gcode
 {

35 
	gfÚt
-
	gçmy
: 
CÚsŞas
, 
	gMÚaco
, 
Cour›r
 
	gNew
, 
	gCour›r
, 
	gmÚo¥aû
;

36 
	gfÚt
-
	gsize
: 12
px
;

37 
	gbackground
-
	gcŞÜ
: #f9f9f9;

38 
	gbÜd”
: 1
px
 
sŞid
 #D0D0D0;

39 
	gcŞÜ
: #002166;

40 
	gdi¥Ïy
: 
block
;

41 
	gm¬gš
: 14
px
 0 14px 0;

42 
	g·ddšg
: 12
px
 10px 12px 10px;

46 
	gm¬gš
: 10
px
;

47 
	gbÜd”
: 1
px
 
sŞid
 #D0D0D0;

48 -
	gwebk™
-
	gbox
-
	gshadow
: 0 0 8
px
 #D0D0D0;

51 
	gp
 {

52 
	gm¬gš
: 12
px
 15px 12px 15px;

54 </
	g¡yË
>

55 </
	gh—d
>

56 <
	gbody
>

57 <
div
 
	gid
="container">

58 <
h1
><?
php
 
echo
 
$h—dšg
; ?></
	gh1
>

59 <?
php
 
echo
 
	g$mes§ge
; ?>

60 </
	gdiv
>

61 </
	gbody
>

62 </
	ghtml
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/errors/error_general.php

1 <!
DOCTYPE
 
	ghtml
>

2 <
html
 
	gÏng
="en">

3 <
h—d
>

4 <
t™Ë
>
E¼Ü
</title>

5 <
¡yË
 
ty³
="text/css">

7 ::
£ËùiÚ
{ 
background
-
cŞÜ
: #E13300; 
	gcŞÜ
: 
wh™e
; }

8 ::
moz
-
£ËùiÚ
{ 
background
-
cŞÜ
: #E13300; 
	gcŞÜ
: 
wh™e
; }

9 ::
webk™
-
£ËùiÚ
{ 
background
-
cŞÜ
: #E13300; 
	gcŞÜ
: 
wh™e
; }

11 
	gbody
 {

12 
	gbackground
-
	gcŞÜ
: #fff;

13 
	gm¬gš
: 40
px
;

14 
	gfÚt
: 13
px
/20px 
nÜm®
 
H–v‘iÿ
, 
	gArŸl
, 
	g§ns
-
	g£rif
;

15 
	gcŞÜ
: #4
F5155
;

18 
	ga
 {

19 
	gcŞÜ
: #003399;

20 
	gbackground
-
	gcŞÜ
: 
Œª¥¬’t
;

21 
	gfÚt
-
	gweight
: 
nÜm®
;

24 
	gh1
 {

25 
	gcŞÜ
: #444;

26 
	gbackground
-
	gcŞÜ
: 
Œª¥¬’t
;

27 
	gbÜd”
-
	gbÙtom
: 1
px
 
sŞid
 #D0D0D0;

28 
	gfÚt
-
	gsize
: 19
px
;

29 
	gfÚt
-
	gweight
: 
nÜm®
;

30 
	gm¬gš
: 0 0 14
px
 0;

31 
	g·ddšg
: 14
px
 15px 10px 15px;

34 
	gcode
 {

35 
	gfÚt
-
	gçmy
: 
CÚsŞas
, 
	gMÚaco
, 
Cour›r
 
	gNew
, 
	gCour›r
, 
	gmÚo¥aû
;

36 
	gfÚt
-
	gsize
: 12
px
;

37 
	gbackground
-
	gcŞÜ
: #f9f9f9;

38 
	gbÜd”
: 1
px
 
sŞid
 #D0D0D0;

39 
	gcŞÜ
: #002166;

40 
	gdi¥Ïy
: 
block
;

41 
	gm¬gš
: 14
px
 0 14px 0;

42 
	g·ddšg
: 12
px
 10px 12px 10px;

46 
	gm¬gš
: 10
px
;

47 
	gbÜd”
: 1
px
 
sŞid
 #D0D0D0;

48 -
	gwebk™
-
	gbox
-
	gshadow
: 0 0 8
px
 #D0D0D0;

51 
	gp
 {

52 
	gm¬gš
: 12
px
 15px 12px 15px;

54 </
	g¡yË
>

55 </
	gh—d
>

56 <
	gbody
>

57 <
div
 
	gid
="container">

58 <
h1
><?
php
 
echo
 
$h—dšg
; ?></
	gh1
>

59 <?
php
 
echo
 
	g$mes§ge
; ?>

60 </
	gdiv
>

61 </
	gbody
>

62 </
	ghtml
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/errors/error_php.php

1 <
div
 
	g¡yË
="border:1px solid #990000;padding-left:20px;margin:0 0 10px 0;">

3 <
h4
>
A
 
PHP
 
E¼Ü
 
was
 
’couÁ”ed
</h4>

5 <
p
>
Sev”™y
: <?
php
 
echo
 
$£v”™y
; ?></
	gp
>

6 <
	gp
>
	gMes§ge
: <?
php
 
echo
 
$mes§ge
; ?></p>

7 <
	gp
>
	gF’ame
: <?
php
 
echo
 
$f•©h
; ?></p>

8 <
	gp
>
Lše
 
	gNumb”
: <?
php
 
echo
 
$lše
; ?></p>

10 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/calendar_lang.php

1 <?
php


3 
	g$Ïng
['cal_su'] = "æ—¥";

4 
	g$Ïng
['cal_mo'] = "ä¸€";

5 
	g$Ïng
['cal_tu'] = "äºŒ";

6 
	g$Ïng
['cal_we'] = "ä¸‰";

7 
	g$Ïng
['cal_th'] = "å››";

8 
	g$Ïng
['cal_fr'] = "äº”";

9 
	g$Ïng
['cal_sa'] = "å…­";

10 
	g$Ïng
['cal_sun'] = "å‘¨æ—¥";

11 
	g$Ïng
['cal_mon'] = "å‘¨ä¸€";

12 
	g$Ïng
['cal_tue'] = "å‘¨äºŒ";

13 
	g$Ïng
['cal_wed'] = "å‘¨ä¸‰";

14 
	g$Ïng
['cal_thu'] = "å‘¨å››";

15 
	g$Ïng
['cal_fri'] = "å‘¨äº”";

16 
	g$Ïng
['cal_sat'] = "å‘¨å…­";

17 
	g$Ïng
['cal_sunday'] = "æ˜ŸæœŸæ—¥";

18 
	g$Ïng
['cal_monday'] = "æ˜ŸæœŸä¸€";

19 
	g$Ïng
['cal_tuesday'] = "æ˜ŸæœŸäºŒ";

20 
	g$Ïng
['cal_wednesday'] = "æ˜ŸæœŸä¸‰";

21 
	g$Ïng
['cal_thursday'] = "æ˜ŸæœŸå››";

22 
	g$Ïng
['cal_friday'] = "æ˜ŸæœŸäº”";

23 
	g$Ïng
['cal_saturday'] = "æ˜ŸæœŸå…­";

24 
	g$Ïng
['cal_jan'] = "1";

25 
	g$Ïng
['cal_feb'] = "2";

26 
	g$Ïng
['cal_mar'] = "3";

27 
	g$Ïng
['cal_apr'] = "4";

28 
	g$Ïng
['cal_may'] = "5";

29 
	g$Ïng
['cal_jun'] = "6";

30 
	g$Ïng
['cal_jul'] = "7";

31 
	g$Ïng
['cal_aug'] = "8";

32 
	g$Ïng
['cal_sep'] = "9";

33 
	g$Ïng
['cal_oct'] = "10";

34 
	g$Ïng
['cal_nov'] = "11";

35 
	g$Ïng
['cal_dec'] = "12";

36 
	g$Ïng
['cal_january'] = "ä¸€æœˆ";

37 
	g$Ïng
['cal_february'] = "äºŒæœˆ";

38 
	g$Ïng
['cal_march'] = "ä¸‰æœˆ";

39 
	g$Ïng
['cal_april'] = "å››æœˆ";

40 
	g$Ïng
['cal_mayl'] = "äº”æœˆ";

41 
	g$Ïng
['cal_june'] = "å…­æœˆ";

42 
	g$Ïng
['cal_july'] = "ä¸ƒæœˆ";

43 
	g$Ïng
['cal_august'] = "å…«æœˆ";

44 
	g$Ïng
['cal_september'] = "ä¹æœˆ";

45 
	g$Ïng
['cal_october'] = "åæœˆ";

46 
	g$Ïng
['cal_november'] = "åä¸€æœˆ";

47 
	g$Ïng
['cal_december'] = "åäºŒæœˆ";

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/date_lang.php

1 <?
php


3 
	g$Ïng
['date_year'] = "å¹´";

4 
	g$Ïng
['date_years'] = "å¹´";

5 
	g$Ïng
['date_month'] = "æœˆ";

6 
	g$Ïng
['date_months'] = "æœˆ";

7 
	g$Ïng
['date_week'] = "å‘¨";

8 
	g$Ïng
['date_weeks'] = "å‘¨";

9 
	g$Ïng
['date_day'] = "å¤©";

10 
	g$Ïng
['date_days'] = "å¤©";

11 
	g$Ïng
['date_hour'] = "å°æ—¶";

12 
	g$Ïng
['date_hours'] = "å°æ—¶";

13 
	g$Ïng
['date_minute'] = "åˆ†";

14 
	g$Ïng
['date_minutes'] = "åˆ†";

15 
	g$Ïng
['date_second'] = "ç§’";

16 
	g$Ïng
['date_seconds'] = "ç§’";

18 
	g$Ïng
['UM12'] = '(UTC -12:00) è´å…‹/è±ªå…°å²›';

19 
	g$Ïng
['UM11'] = '(UTC -11:00) è¨æ‘©äºšæ—¶åŒºã€çº½åŸƒ';

20 
	g$Ïng
['UM10'] = '(UTC -10:00) å¤å¨å¤·ç•™ç”³æ ‡å‡†æ—¶é—´ã€åº“å…‹ç¾¤å²›ã€å¡”å¸Œæå²›';

21 
	g$Ïng
['UM95'] = '(UTC -9:30) é©¬å…‹è¨æ–¯ç¾¤å²›';

22 
	g$Ïng
['UM9'] = '(UTC -9:00) é˜¿æ‹‰æ–¯åŠ æ ‡å‡†æ—¶é—´ã€ç”˜æ¯”å°”ç¾¤å²›';

23 
	g$Ïng
['UM8'] = '(UTC -8:00) å¤ªå¹³æ´‹æ ‡å‡†æ—¶é—´ã€ å…‹åˆ©ç€é¡¿å²›';

24 
	g$Ïng
['UM7'] = '(UTC -7:00) å±±åŒºæ ‡å‡†æ—¶é—´';

25 
	g$Ïng
['UM6'] = '(UTC -6:00) ä¸­éƒ¨æ ‡å‡†æ—¶é—´';

26 
	g$Ïng
['UM5'] = '(UTC -5:00) ä¸œéƒ¨æ ‡å‡†æ—¶é—´ã€è¥¿åŠ å‹’æ¯”æ ‡å‡†æ—¶é—´';

27 
	g$Ïng
['UM45'] = '(UTC -4:30) å§”å†…ç‘æ‹‰æ ‡å‡†æ—¶é—´';

28 
	g$Ïng
['UM4'] = '(UTC -4:00) å¤§è¥¿æ´‹æ ‡å‡†æ—¶é—´ã€ä¸œåŠ å‹’æ¯”æ ‡å‡†æ—¶é—´';

29 
	g$Ïng
['UM35'] = '(UTC -3:30) çº½èŠ¬å…°æ ‡å‡†æ—¶é—´';

30 
	g$Ïng
['UM3'] = '(UTC -3:00) é˜¿æ ¹å»·ã€å·´è¥¿ã€æ³•å±åœ­äºšé‚£ã€ä¹Œæ‹‰åœ­';

31 
	g$Ïng
['UM2'] = '(UTC -2:00) å—ä¹”æ²»äºš/å—æ¡‘å¨å¥‡ç¾¤å²›';

32 
	g$Ïng
['UM1'] = '(UTC -1:00) äºšé€Ÿå°”ç¾¤å²›ã€ä½›å¾—è§’ç¾¤å²›';

33 
	g$Ïng
['UTC'] = '(UTC) æ ¼æ—å¨æ²»æ ‡å‡†æ—¶é—´ã€è¥¿æ¬§';

34 
	g$Ïng
['UP1'] = '(UTC +1:00) ä¸­æ¬§ã€è¥¿é';

35 
	g$Ïng
['UP2'] = '(UTC +2:00) ä¸­éƒ¨éæ´²ã€ä¸œæ¬§ã€åŠ é‡Œå®æ ¼å‹’';

36 
	g$Ïng
['UP3'] = '(UTC +3:00) è«æ–¯ç§‘ã€ä¸œé';

37 
	g$Ïng
['UP35'] = '(UTC +3:30) ä¼Šæœ—æ ‡å‡†æ—¶é—´';

38 
	g$Ïng
['UP4'] = '(UTC +4:00) é˜¿å¡æ‹œç–†æ ‡å‡†æ—¶é—´ã€è¨é©¬æ‹‰';

39 
	g$Ïng
['UP45'] = '(UTC +4:30) é˜¿å¯Œæ±—';

40 
	g$Ïng
['UP5'] = '(UTC +5:00) å·´åŸºæ–¯å¦æ ‡å‡†æ—¶é—´ã€å¶å¡æ·ç³å ¡';

41 
	g$Ïng
['UP55'] = '(UTC +5:30) å°åº¦æ ‡å‡†æ—¶é—´ã€æ–¯é‡Œå…°å¡';

42 
	g$Ïng
['UP575'] = '(UTC +5:45) å°¼æ³Šå°”';

43 
	g$Ïng
['UP6'] = '(UTC +6:00) å­ŸåŠ æ‹‰å›½æ ‡å‡†æ—¶é—´ã€ä¸ä¸¹ã€é„‚æœ¨æ–¯å…‹';

44 
	g$Ïng
['UP65'] = '(UTC +6:30) ç§‘ç§‘æ–¯ç¾¤å²›ã€ç¼…ç”¸';

45 
	g$Ïng
['UP7'] = '(UTC +7:00) å…‹æ‹‰æ–¯è¯ºäºšå°”æ–¯å…‹ã€æŸ¬åŸ”å¯¨ã€è€æŒã€æ³°å›½ã€è¶Šå—';

46 
	g$Ïng
['UP8'] = '(UTC +8:00) æ¾³å¤§åˆ©äºšè¥¿éƒ¨æ ‡å‡†æ—¶é—´ã€å°åŒ—ã€åŒ—äº¬ã€ä¼Šå°”åº“èŒ¨å…‹';

47 
	g$Ïng
['UP875'] = '(UTC +8:45) æ¾³å¤§åˆ©äºšä¸­éƒ¨è¥¿éƒ¨æ ‡å‡†æ—¶é—´';

48 
	g$Ïng
['UP9'] = '(UTC +9:00) æ—¥æœ¬æ ‡å‡†æ—¶é—´ã€éŸ©å›½æ ‡å‡†æ—¶é—´ã€é›…åº“èŒ¨å…‹æ—¶é—´';

49 
	g$Ïng
['UP95'] = '(UTC +9:30) æ¾³å¤§åˆ©äºšä¸­éƒ¨æ ‡å‡†æ—¶é—´';

50 
	g$Ïng
['UP10'] = '(UTC +10:00) æ¾³å¤§åˆ©äºšä¸œéƒ¨æ ‡å‡†æ—¶é—´ã€ç¬¦æ‹‰è¿ªæ²ƒæ–¯æ‰˜å…‹';

51 
	g$Ïng
['UP105'] = '(UTC +10:30) è±ªå‹³çˆµå²›';

52 
	g$Ïng
['UP11'] = '(UTC +11:00) é©¬åŠ ä¸¹ã€æ‰€ç½—é—¨ç¾¤å²›ã€ç“¦åŠªé˜¿å›¾';

53 
	g$Ïng
['UP115'] = '(UTC +11:30) è¯ºç¦å…‹å²›';

54 
	g$Ïng
['UP12'] = '(UTC +12:00) æ–æµã€å‰å°”ä¼¯ç‰¹ç¾¤å²›ã€å ªå¯ŸåŠ åŠå²›ã€æ–°è¥¿å…°æ ‡å‡†æ—¶é—´';

55 
	g$Ïng
['UP1275'] = '(UTC +12:45) æŸ¥å¡”å§†ç¾¤å²›æ ‡å‡†æ—¶é—´';

56 
	g$Ïng
['UP13'] = '(UTC +13:00) è²å°¼å…‹æ–¯ç¾¤å²›ã€æ±¤åŠ ';

57 
	g$Ïng
['UP14'] = '(UTC +14:00) è±æ©ç¾¤å²›';

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/db_lang.php

1 <?
php


3 
	g$Ïng
['db_invalid_connection_str'] = 'ç”¨æ‚¨ç»™å‡ºçš„è¿æ¥å­—ç¬¦ä¸²æ— æ³•è·å¾—æ•°æ®åº“è®¾ç½®.';

4 
	g$Ïng
['db_unable_to_connect'] = 'ä½¿ç”¨ç»™å‡ºçš„è®¾ç½®æ— æ³•è¿æ¥æ•°æ®åº“.';

5 
	g$Ïng
['db_unable_to_select'] = 'æ— æ³•é€‰æ‹©æŒ‡å®šçš„æ•°æ®åº“: %s';

6 
	g$Ïng
['db_unable_to_create'] = 'æ— æ³•åˆ›å»ºæŒ‡å®šçš„æ•°æ®åº“: %s';

7 
	g$Ïng
['db_invalid_query'] = 'æŸ¥è¯¢æ— æ•ˆ.';

8 
	g$Ïng
['db_must_set_table'] = 'æŸ¥è¯¢ä¸­å¿…é¡»è®¾ç½®æ•°æ®åº“è¡¨.';

9 
	g$Ïng
['db_must_use_set'] = 'å¿…é¡»ä½¿ç”¨"set"å‘½ä»¤æ›´æ–°è®°å½•.';

10 
	g$Ïng
['db_must_use_index'] = 'æ‚¨å¿…é¡»ä¸ºæ‰¹é‡æ›´æ–°æŒ‡å®šä¸€ä¸ªç´¢å¼•.';

11 
	g$Ïng
['db_batch_missing_index'] = 'æ‰¹é‡æ›´æ–°ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªè®°å½•ç¼ºå°‘æŒ‡å®šçš„ç´¢å¼•.';

12 
	g$Ïng
['db_must_use_where'] = 'æ›´æ–°è®°å½•æ—¶å¿…é¡»åŒ…å«"where"å­å¥.';

13 
	g$Ïng
['db_del_must_use_where'] = 'åˆ é™¤è®°å½•æ—¶å¿…é¡»åŒ…å«"where"æˆ–"like"å­å¥.';

14 
	g$Ïng
['db_field_param_missing'] = 'å¿…é¡»æä¾›è¡¨åå‚æ•°æ‰èƒ½å–å¾—å­—æ®µä¿¡æ¯.';

15 
	g$Ïng
['db_unsupported_function'] = 'æ‚¨ä½¿ç”¨çš„æ•°æ®åº“ä¸æ”¯æŒæ­¤åŠŸèƒ½.';

16 
	g$Ïng
['db_transaction_failure'] = 'äº‹åŠ¡å¤±è´¥: å·²å›æ»š.';

17 
	g$Ïng
['db_unable_to_drop'] = 'æ— æ³•åˆ é™¤æ•°æ®åº“.';

18 
	g$Ïng
['db_unsuported_feature'] = 'æ•°æ®åº“å¹³å°ä¸æ”¯æŒæ­¤åŠŸèƒ½.';

19 
	g$Ïng
['db_unsuported_compression'] = 'ä¸æ”¯æŒæ­¤æ–‡ä»¶å‹ç¼©æ ¼å¼.';

20 
	g$Ïng
['db_filepath_error'] = 'æ‚¨æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„æ— æ³•å†™å…¥æ•°æ®.';

21 
	g$Ïng
['db_invalid_cache_path'] = 'ç¼“å­˜è·¯å¾„æ— æ•ˆæˆ–ä¸å¯å†™.';

22 
	g$Ïng
['db_table_name_required'] = 'å¿…é¡»æä¾›è¡¨å.';

23 
	g$Ïng
['db_column_name_required'] = 'å¿…é¡»æä¾›å­—æ®µå.';

24 
	g$Ïng
['db_column_definition_required'] = 'å¿…é¡»æä¾›å­—æ®µå®šä¹‰.';

25 
	g$Ïng
['db_unable_to_set_charset'] = 'æ— æ³•è®¾ç½®å®¢æˆ·ç«¯è¿æ¥çš„å­—ç¬¦é›†: %s';

26 
	g$Ïng
['db_error_heading'] = 'å‘ç”Ÿäº†ä¸€ä¸ªæ•°æ®åº“é”™è¯¯';

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/email_lang.php

1 <?
php


3 
	g$Ïng
['email_must_be_array'] = "ç”µå­é‚®ä»¶ç¡®è®¤æ–¹å¼å¿…é¡»ä¼ å…¥ä¸€ä¸ªæ•°ç»„.";

4 
	g$Ïng
['email_invalid_address'] = "æ— æ•ˆçš„ç”µå­é‚®ä»¶åœ°å€: %s";

5 
	g$Ïng
['email_attachment_missing'] = "æ— æ³•å®šä½æ­¤ç”µå­é‚®ä»¶é™„ä»¶: %s";

6 
	g$Ïng
['email_attachment_unreadable'] = "æ— æ³•æ‰“å¼€æ­¤é™„ä»¶: %s";

7 
	g$Ïng
['email_no_recipients'] = "å¿…é¡»åŒ…å«æ”¶ä»¶äºº(To)ã€æŠ„é€äºº(Cc)æˆ–æš—é€äºº(Bcc)";

8 
	g$Ïng
['email_send_failure_phpmail'] = "æ— æ³•ä½¿ç”¨PHP mail()å‘é€ç”µå­é‚®ä»¶. æ‚¨çš„æœåŠ¡å™¨å¯èƒ½æ²¡æœ‰é…ç½®ç”¨æ­¤æ–¹æ³•å‘é‚®ä»¶.";

9 
	g$Ïng
['email_send_failure_sendmail'] = "æ— æ³•ä½¿ç”¨PHP Sendmailå‘é€é‚®ä»¶. æ‚¨çš„æœåŠ¡å™¨å¯èƒ½æ²¡æœ‰é…ç½®ç”¨æ­¤æ–¹æ³•å‘é‚®ä»¶.";

10 
	g$Ïng
['email_send_failure_smtp'] = "æ— æ³•ç”¨PHP SMTPå‘é€é‚®ä»¶. æ‚¨çš„æœåŠ¡å™¨å¯èƒ½æ²¡æœ‰é…ç½®ç”¨æ­¤æ–¹æ³•å‘é‚®ä»¶.";

11 
	g$Ïng
['email_sent'] = "æ‚¨çš„ä¿¡ä»¶å·²ç»è¢«æˆåŠŸçš„å‘é€äº†,æ‰€ä½¿ç”¨çš„åè®®æ˜¯: %s";

12 
	g$Ïng
['email_no_socket'] = "æ— æ³•æ‰“å¼€å¥—æ¥å­—(socket)ä»¥ä½¿ç”¨Sendmail. è¯·æ£€æŸ¥è®¾ç½®.";

13 
	g$Ïng
['email_no_hostname'] = "æ‚¨æ²¡æœ‰æŒ‡å®šSMTPä¸»æœºå.";

14 
	g$Ïng
['email_smtp_error'] = "å‡ºç°SMTPé”™è¯¯: %s";

15 
	g$Ïng
['email_no_smtp_unpw'] = "é”™è¯¯: æ‚¨å¿…é¡»æŒ‡å®šSMTPç”¨æˆ·åå’Œå¯†ç .";

16 
	g$Ïng
['email_failed_smtp_login'] = "å‘é€AUTH LOGINå‘½ä»¤å¤±è´¥. é”™è¯¯ä¸º: %s";

17 
	g$Ïng
['email_smtp_auth_un'] = "éªŒè¯ç”¨æˆ·åå¤±è´¥. é”™è¯¯ä¸º: %s";

18 
	g$Ïng
['email_smtp_auth_pw'] = "éªŒè¯å¯†ç å¤±è´¥. é”™è¯¯ä¸º: %s";

19 
	g$Ïng
['email_smtp_data_failure'] = "æ— æ³•å‘é€æ•°æ®: %s";

20 
	g$Ïng
['email_exit_status'] = "é€€å‡ºçŠ¶æ€ä»£ç ä¸º: %s";

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/error_lang.php

3 
	g$Ïng
['error_install_db_table_exited']="æ•°æ®åº“è¡¨%så·²å­˜åœ¨ï¼Œè¯·å°†å…¶åˆ é™¤ä»¥ç»§ç»­è¿›è¡Œæ•°æ®è¿ç§»ã€‚è®°å¾—é¦–å…ˆè¦å¤‡ä»½æ‚¨çš„é‡è¦æ•°æ®ã€‚";

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/form_validation_lang.php

1 <?
php


3 
	g$Ïng
['required'] = "<strong>%s</strong> å¿…é¡»å¡«å†™";

4 
	g$Ïng
['isset'] = "<strong>%s</strong> ä¸€å®šè¦æœ‰å†…å®¹";

5 
	g$Ïng
['valid_email'] = "<strong>%s</strong> å¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€";

6 
	g$Ïng
['valid_emails'] = "<strong>%s</strong> å¿…é¡»æ˜¯æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€";

7 
	g$Ïng
['valid_url'] = "<strong>%s</strong> å¿…é¡»æ˜¯æœ‰æ•ˆçš„ç½‘å€";

8 
	g$Ïng
['valid_ip'] = "<strong>%s</strong> å¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆIPåœ°å€";

9 
	g$Ïng
['min_length'] = "<strong>%s</strong> è‡³å°‘åŒ…å« <strong>%s</strong> ä¸ªå­—";

10 
	g$Ïng
['max_length'] = "<strong>%s</strong> ä¸èƒ½è¶…è¿‡ <strong>%s</strong> ä¸ªå­—";

11 
	g$Ïng
['exact_length'] = "<strong>%s</strong> å¿…é¡»åˆšå¥½ <strong>%s</strong> ä¸ªå­—";

12 
	g$Ïng
['alpha'] = "<strong>%s</strong> åªèƒ½åŒ…å«è‹±æ–‡å­—æ¯";

13 
	g$Ïng
['alpha_numeric'] = "<strong>%s</strong> åªèƒ½åŒ…å«è‹±æ–‡å­—æ¯æˆ–æ•°å­—";

14 
	g$Ïng
['alpha_dash'] = "<strong>%s</strong> åªèƒ½åŒ…å«è‹±æ–‡å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€æˆ–ç ´æŠ˜å·";

15 
	g$Ïng
['alpha_underscore'] = "<strong>%s</strong> åªèƒ½åŒ…å«è‹±æ–‡å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿";

16 
	g$Ïng
['capital_letter'] = "<strong>%s</strong> åªèƒ½åŒ…å«å¤§å†™è‹±æ–‡å­—æ¯";

17 
	g$Ïng
['low_letter'] = "<strong><strong>%s</strong> </strong> åªèƒ½åŒ…å«å°å†™è‹±æ–‡å­—æ¯";

18 
	g$Ïng
['numeric'] = "<strong>%s</strong> åªèƒ½åŒ…å«æ•°å­—";

19 
	g$Ïng
['is_numeric'] = "<strong>%s</strong> åªèƒ½åŒ…å«æ•°å­—";

20 
	g$Ïng
['integer'] = "<strong>%s</strong> åªèƒ½åŒ…å«æ•´æ•°";

21 
	g$Ïng
['regex_match'] = "<strong>%s</strong> æ ¼å¼ä¸æ­£ç¡®";

22 
	g$Ïng
['matches'] = "<strong>%s</strong> ä¸ <strong>%s</strong> ä¸ç›¸ç¬¦åˆ";

23 
	g$Ïng
['is_natural'] = "<strong>%s</strong> å¿…é¡»æ˜¯è‡ªç„¶æ•°(éè´Ÿæ•´æ•°)";

24 
	g$Ïng
['is_natural_no_zero'] = "<strong>%s</strong> å¿…é¡»æ˜¯å¤§äºé›¶çš„è‡ªç„¶æ•°(éè´Ÿæ•´æ•°)";

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/ftp_lang.php

1 <?
php


3 
	g$Ïng
['ftp_no_connection'] = "æ— æ³•å®šä½æœ‰æ•ˆçš„è¿æ¥ID. åœ¨æ‰§è¡Œæ–‡ä»¶æ“ä½œå‰,è¯·å…ˆç¡®è®¤æ‚¨å·²è¿æ¥æˆåŠŸ.";

4 
	g$Ïng
['ftp_unable_to_connect'] = "æ— æ³•è¿æ¥FTPæœåŠ¡å™¨.";

5 
	g$Ïng
['ftp_unable_to_login'] = "æ— æ³•ç™»å½•FTPæœåŠ¡å™¨. è¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç .";

6 
	g$Ïng
['ftp_unable_to_makdir'] = "æ— æ³•åˆ›å»ºæ‚¨æŒ‡å®šçš„ç›®å½•.";

7 
	g$Ïng
['ftp_unable_to_changedir'] = "æ— æ³•åˆ‡æ¢ç›®å½•.";

8 
	g$Ïng
['ftp_unable_to_chmod'] = "æ— æ³•è®¾ç½®æ–‡ä»¶æƒé™. è¯·æ£€æŸ¥æ‚¨çš„è·¯å¾„. æ³¨æ„:æ­¤åŠŸèƒ½ä»…é€‚ç”¨ä¸PHP5åŠä»¥ä¸Šç‰ˆæœ¬.";

9 
	g$Ïng
['ftp_unable_to_upload'] = "æ— æ³•ä¸Šä¼ æŒ‡å®šçš„æ–‡ä»¶. è¯·æ£€æŸ¥è·¯å¾„.";

10 
	g$Ïng
['ftp_unable_to_download'] = "æ— æ³•ä¸‹è½½æŒ‡å®šçš„æ–‡ä»¶. è¯·æ£€æŸ¥è·¯å¾„.";

11 
	g$Ïng
['ftp_no_source_file'] = "æ— æ³•å®šä½æºæ–‡ä»¶. è¯·æ£€æŸ¥è·¯å¾„.";

12 
	g$Ïng
['ftp_unable_to_rename'] = "æ— æ³•æ›´æ”¹æ–‡ä»¶åç§°.";

13 
	g$Ïng
['ftp_unable_to_delete'] = "æ— æ³•åˆ é™¤æ–‡ä»¶.";

14 
	g$Ïng
['ftp_unable_to_move'] = "æ— æ³•ç§»åŠ¨æ–‡ä»¶. è¯·ç¡®è®¤ç›®æ ‡ç›®å½•æ˜¯å¦å­˜åœ¨.";

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/imglib_lang.php

1 <?
php


3 
	g$Ïng
['imglib_source_image_required'] = "æ‚¨å¿…é¡»åœ¨é€‰é¡¹é‡ŒæŒ‡å®šæºå›¾ç‰‡.";

4 
	g$Ïng
['imglib_gd_required'] = "æ­¤åŠŸèƒ½å¿…é¡»ä½¿ç”¨GDå›¾å½¢åº“.";

5 
	g$Ïng
['imglib_gd_required_for_props'] = "æ‚¨çš„æœåŠ¡å™¨å¿…é¡»æ”¯æŒGDå›¾å½¢åº“ä»¥è·å¾—æ­¤å›¾ç‰‡çš„å±æ€§.";

6 
	g$Ïng
['imglib_unsupported_imagecreate'] = "æ‚¨çš„æœåŠ¡å™¨çš„GDå‡½æ•°åº“æ— æ³•å¤„ç†æ­¤æ ¼å¼çš„å›¾å½¢æ–‡ä»¶.";

7 
	g$Ïng
['imglib_gif_not_supported'] = "ç”±äºè®¸å¯é™åˆ¶ï¼ŒGIFæ–‡ä»¶é€šå¸¸ä¸è¢«æ”¯æŒ. æ‚¨å¯ä»¥ä½¿ç”¨JPGæˆ–PNGæ ¼å¼çš„æ–‡ä»¶.";

8 
	g$Ïng
['imglib_jpg_not_supported'] = "ä¸æ”¯æŒJPGæ–‡ä»¶.";

9 
	g$Ïng
['imglib_png_not_supported'] = "ä¸æ”¯æŒPNGæ–‡ä»¶.";

10 
	g$Ïng
['imglib_jpg_or_png_required'] = "åœ¨è®¾ç½®ä¸­å®šä¹‰çš„å›¾å½¢å°ºå¯¸çš„è°ƒæ•´åŠŸèƒ½åªèƒ½ç”¨äºJPEGå’ŒPNGæ–‡ä»¶.";

11 
	g$Ïng
['imglib_copy_error'] = "æ›¿æ¢æ–‡ä»¶å‘ç”Ÿé”™è¯¯. è¯·ç¡®è®¤æ‚¨çš„æ–‡ä»¶ç›®å½•æ˜¯å¯å†™çš„.";

12 
	g$Ïng
['imglib_rotate_unsupported'] = "æœåŠ¡å™¨ä¸æ”¯æŒå›¾å½¢æ—‹è½¬.";

13 
	g$Ïng
['imglib_libpath_invalid'] = "å›¾å½¢åº“çš„è·¯å¾„ä¸æ­£ç¡®. è¯·åœ¨è®¾ç½®ä¸­æ›´æ­£.";

14 
	g$Ïng
['imglib_image_process_failed'] = "å›¾å½¢å¤„ç†å¤±è´¥. è¯·æ£€æŸ¥æ‚¨çš„æœåŠ¡å™¨æ˜¯å¦æ”¯æŒé€‰æ‹©çš„åè®®ï¼Œä¸”å›¾å½¢åº“çš„è·¯å¾„æ˜¯å¦æ­£ç¡®.";

15 
	g$Ïng
['imglib_rotation_angle_required'] = "æ—‹è½¬å›¾å½¢æ—¶å¿…é¡»æŒ‡å®šæ—‹è½¬çš„è§’åº¦.";

16 
	g$Ïng
['imglib_writing_failed_gif'] = "GIF æ–‡ä»¶.";

17 
	g$Ïng
['imglib_invalid_path'] = "å›¾å½¢æ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®.";

18 
	g$Ïng
['imglib_copy_failed'] = "å›¾å½¢å¤åˆ¶ç¨‹åºå¤±è´¥.";

19 
	g$Ïng
['imglib_missing_font'] = "æ— æ³•æ‰¾åˆ°å¯ç”¨çš„å­—ä½“.";

20 
	g$Ïng
['imglib_save_failed'] = "æ— æ³•ä¿å­˜å›¾å½¢.è¯·ç¡®è®¤å›¾å½¢å’Œæ–‡ä»¶ç›®å½•å¯å†™.";

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/migration_lang.php

1 <?
php


3 
	g$Ïng
['migration_none_found'] = "æ²¡æœ‰å‘ç°è¿ç§»";

4 
	g$Ïng
['migration_not_found'] = "æ‰¾ä¸åˆ°è¿™ä¸ªè¿ç§»";

5 
	g$Ïng
['migration_multiple_version'] = "æœ‰å¤šä¸ªè¿ç§»æ•°æ®ä¸æ­¤ç‰ˆæœ¬å·ç›¸å…³: %d.";

6 
	g$Ïng
['migration_class_doesnt_exist'] = "è¿™ä¸ªè¿ç§»ç±» \"%s\" æ— æ³•æ‰¾åˆ°ã€‚";

7 
	g$Ïng
['migration_missing_up_method'] = "è¿™ä¸ªè¿ç§»ç±» \"%s\" ç¼ºå°‘ä¸€ä¸ª 'up' æ–¹æ³•ã€‚";

8 
	g$Ïng
['migration_missing_down_method'] = "è¿™ä¸ªè¿ç§»ç±» \"%s\" ç¼ºå°‘ä¸€ä¸ª 'up' æ–¹æ³•ã€‚";

9 
	g$Ïng
['migration_invalid_filename'] = "è¿ç§» \"%s\" æœ‰ ä¸€ä¸ªæ— æ•ˆçš„æ–‡ä»¶åã€‚";

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/number_lang.php

1 <?
php


3 
	g$Ïng
['terabyte_abbr'] = "TB";

4 
	g$Ïng
['gigabyte_abbr'] = "GB";

5 
	g$Ïng
['megabyte_abbr'] = "MB";

6 
	g$Ïng
['kilobyte_abbr'] = "KB";

7 
	g$Ïng
['bytes'] = "Bytes";

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/profiler_lang.php

1 <?
php


3 
	g$Ïng
['profiler_database'] = 'æ•°æ®åº“';

4 
	g$Ïng
['profiler_controller_info'] = 'ç±»/æ–¹æ³•';

5 
	g$Ïng
['profiler_benchmarks'] = 'è¯„æµ‹';

6 
	g$Ïng
['profiler_queries'] = 'æŸ¥è¯¢';

7 
	g$Ïng
['profiler_get_data'] = 'GETæ•°æ®';

8 
	g$Ïng
['profiler_post_data'] = 'POSTæ•°æ®';

9 
	g$Ïng
['profiler_uri_string'] = 'URI å­—ç¬¦ä¸²';

10 
	g$Ïng
['profiler_memory_usage'] = 'å†…å­˜ä½¿ç”¨';

11 
	g$Ïng
['profiler_config'] = 'é…ç½®å˜é‡';

12 
	g$Ïng
['profiler_headers'] = 'HTTPå¤´';

13 
	g$Ïng
['profiler_no_db'] = 'å½“å‰æ²¡æœ‰æ•°æ®åº“é©±åŠ¨è¢«åŠ è½½';

14 
	g$Ïng
['profiler_no_queries'] = 'æ²¡æœ‰æŸ¥è¯¢è¢«æ‰§è¡Œ';

15 
	g$Ïng
['profiler_no_post'] = 'æ²¡æœ‰POSTæ•°æ®å­˜åœ¨';

16 
	g$Ïng
['profiler_no_get'] = 'æ²¡æœ‰GETæ•°æ®å­˜åœ¨';

17 
	g$Ïng
['profiler_no_uri'] = 'æ²¡æœ‰URIæ•°æ®å­˜åœ¨';

18 
	g$Ïng
['profiler_no_memory'] = 'æ— æ³•è·å¾—å†…å­˜ä½¿ç”¨æƒ…å†µ';

19 
	g$Ïng
['profiler_no_profiles'] = 'æ²¡æœ‰é…ç½®æ–‡ä»¶æ•°æ® - å…¨éƒ¨é…ç½®é¡¹ç›®è¢«ç¦ç”¨.';

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/unit_test_lang.php

1 <?
php


3 
	g$Ïng
['ut_test_name'] = 'æµ‹è¯•åç§°';

4 
	g$Ïng
['ut_test_datatype'] = 'æµ‹è¯•æ•°æ®ç±»å‹';

5 
	g$Ïng
['ut_res_datatype'] = 'é¢„æœŸæ•°æ®ç±»å‹';

6 
	g$Ïng
['ut_result'] = 'ç»“æœ';

7 
	g$Ïng
['ut_undefined'] = 'æœªå®šä¹‰æµ‹è¯•åç§°';

8 
	g$Ïng
['ut_file'] = 'æ–‡ä»¶åç§°';

9 
	g$Ïng
['ut_line'] = 'è¡Œå·';

10 
	g$Ïng
['ut_passed'] = 'é€šè¿‡';

11 
	g$Ïng
['ut_failed'] = 'å¤±è´¥';

12 
	g$Ïng
['ut_boolean'] = 'å¸ƒå°”å€¼';

13 
	g$Ïng
['ut_integer'] = 'æ•´æ•°';

14 
	g$Ïng
['ut_float'] = 'æµ®ç‚¹æ•°';

15 
	g$Ïng
['ut_double'] = 'åŒç²¾åº¦æµ®ç‚¹æ•°';

16 
	g$Ïng
['ut_string'] = 'å­—ç¬¦ä¸²';

17 
	g$Ïng
['ut_array'] = 'æ•°ç»„';

18 
	g$Ïng
['ut_object'] = 'å¯¹è±¡';

19 
	g$Ïng
['ut_resource'] = 'èµ„æº';

20 
	g$Ïng
['ut_null'] = 'ç©º';

21 
	g$Ïng
['ut_notes'] = 'ä¾¿ç¬º';

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/upload_lang.php

1 <?
php


3 
	g$Ïng
['upload_userfile_not_set'] = "æ— æ³•åœ¨postä¸­æ‰¾åˆ°åä¸ºuserfileçš„å˜é‡.";

4 
	g$Ïng
['upload_file_exceeds_limit'] = "ä¸Šä¼ æ–‡ä»¶è¶…å‡ºPHPé…ç½®æ–‡ä»¶ä¸­å…è®¸çš„æœ€å¤§é•¿åº¦.";

5 
	g$Ïng
['upload_file_exceeds_form_limit'] = "ä¸Šä¼ æ–‡ä»¶è¶…å‡ºè¡¨å•å…è®¸çš„æœ€å¤§é•¿åº¦.";

6 
	g$Ïng
['upload_file_partial'] = "æ­¤æ–‡ä»¶ä»…æœ‰ä¸€éƒ¨åˆ†è¢«ä¸Šä¼ äº†.";

7 
	g$Ïng
['upload_no_temp_directory'] = "æ‰¾ä¸åˆ°ä¸´æ—¶ç›®å½•.";

8 
	g$Ïng
['upload_unable_to_write_file'] = "æ–‡ä»¶æ— æ³•å†™å…¥ç£ç›˜.";

9 
	g$Ïng
['upload_stopped_by_extension'] = "æ­¤æ–‡ä»¶çš„æ‰©å±•ååœ¨ç¦æ­¢ä¸Šä¼ ä¹‹åˆ—.";

10 
	g$Ïng
['upload_no_file_selected'] = "æ‚¨æ²¡æœ‰é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶.";

11 
	g$Ïng
['upload_invalid_filetype'] = "æ­¤æ–‡ä»¶çš„ç±»å‹åœ¨ç¦æ­¢ä¸Šä¼ ä¹‹åˆ—.";

12 
	g$Ïng
['upload_invalid_filesize'] = "æ­¤æ–‡ä»¶è¶…å‡ºå…è®¸ä¸Šä¼ çš„æœ€å¤§é•¿åº¦.";

13 
	g$Ïng
['upload_invalid_dimensions'] = "æ‚¨è¦ä¸Šä¼ çš„å›¾ç‰‡é«˜åº¦æˆ–å®½åº¦è¶…å‡ºäº†é™åˆ¶.";

14 
	g$Ïng
['upload_destination_error'] = "åœ¨ç§»åŠ¨ä¸Šä¼ æ–‡ä»¶åˆ°ç›®æ ‡ä½ç½®æ—¶å‘ç”Ÿäº†é”™è¯¯.";

15 
	g$Ïng
['upload_no_filepath'] = "ä¸Šä¼ è·¯å¾„æ— æ•ˆ.";

16 
	g$Ïng
['upload_no_file_types'] = "æ‚¨è¿˜æ²¡æœ‰æŒ‡å®šå…è®¸çš„æ–‡ä»¶ç±»å‹.";

17 
	g$Ïng
['upload_bad_filename'] = "æœåŠ¡å™¨ä¸Šå·²å­˜åœ¨ä¸æ‚¨ä¸Šä¼ çš„æ–‡ä»¶åŒåçš„æ–‡ä»¶.";

18 
	g$Ïng
['upload_not_writable'] = "ä¸Šä¼ ç›®å½•ä¸å¯å†™å…¥.";

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/Code.php

1 <?
php


19 şas 
	cCode
{

22 
´iv©e
 
	m$img
;

24 
public
 
	m$width
 = 150;

26 
public
 
	m$height
 = 45;

28 
public
 
	m$bgCŞÜ
 = "#ffffff";

30 
public
 
	m$code
;

32 
public
 
	m$codeSŒ
 = "123456789abcdefghijkmlnopqrstuvwxyz";

34 
public
 
	m$codeL’
 = 4;

36 
public
 
	m$fÚt
 = "Data/Font/font.ttf";

38 
public
 
	m$fÚtSize
 = 22;

40 
public
 
	m$fÚtCŞÜ
 ="";

45 
public
 
funùiÚ
 
__cÚ¡ruù
(
$¬r
 = 
	$¬¿y
()){

46 
$width
 = '';

47 
$height
 = '';

48 
$bgCŞÜ
 = '';

49 
$fÚtCŞÜ
 = '';

50 
$codeL’
 = '';

51 
$fÚtSize
 = '';

54 if(!
	`em±y
(
$¬r
)){

55 
	`exŒaù
(
$¬r
);

58 
$this
->
fÚt
=
BASEPATH
."fonts/font.ttf";

59 ià(!
	`is_fe
(
$this
->
fÚt
)) {

60 
	`”rÜ
("éªŒè¯ç å­—ä½“æ–‡ä»¶ä¸å­˜åœ¨");

62 
$this
->
width
 = 
	`em±y
(
$width
) ? $this->width : $width;

63 
$this
->
height
 = 
	`em±y
(
$height
) ? $this->height : $height;

64 
$this
->
bgCŞÜ
 = 
	`em±y
(
$bgCŞÜ
) ? $this->bgColor : $bgColor;

65 
$this
->
codeL’
 = 
	`em±y
(
$codeL’
) ? $this->codeLen : $codeLen;

66 
$this
->
fÚtSize
 = 
	`em±y
(
$fÚtSize
)? $this->fontSize :$fontSize;

67 
$this
->
fÚtCŞÜ
 = 
	`em±y
(
$fÚtCŞÜ
) ? $this->fontColor : $fontColor;

68 
$this
->
	`ü—‹
();

74 
´iv©e
 
funùiÚ
 
	$ü—‹Code
() {

75 
$code
 = '';

76 
$i
 = 0; $˜< 
$this
->
codeL’
; $i++) {

77 
$code
 .ğ
$this
->
codeSŒ
 [
	`mt_¿nd
(0, 
	`¡¾’
($this->codeStr) - 1)];

79 
$this
->
code
 = 
	`¡¹ouµ”
(
$code
);

80 if(!
	`is£t
(
$_SESSION
)){

81 
	`£ssiÚ_¡¬t
();

83 
$_SESSION
 ['code'] = 
$this
->
code
;

84 
	}
}

89 
public
 
funùiÚ
 
	$g‘Code
() {

90  
$this
->
code
;

91 
	}
}

96 
public
 
funùiÚ
 
	$ü—‹
() {

97 ià(!
$this
->
	`checkGD
())

98  
çl£
;

99 
$w
 = 
$this
->
width
;

100 
$h
 = 
$this
->
height
;

101 
$bgCŞÜ
 = 
$this
->
bgCŞÜ
;

102 
$img
 = 
	`imageü—‹ŒuecŞÜ
(
$w
, 
$h
);

103 
$bgCŞÜ
 = 
	`imagecŞÜ®loÿ‹
(
$img
, 
	`hexdec
(
	`sub¡r
($bgColor, 1, 2)), hexdec(substr($bgColor, 3, 2)), hexdec(substr($bgColor, 5, 2)));

104 
	`imagefl
(
$img
, 0, 0, 
$bgCŞÜ
);

105 
$this
->
img
 = 
$img
;

108 
$this
->
	`ü—‹Lše
();

109 
$this
->
	`ü—‹FÚt
();

110 
$this
->
	`ü—‹Pix
();

111 
$this
->
	`ü—‹Rec
();

112 
	}
}

116 
´iv©e
 
funùiÚ
 
	$ü—‹Lše
(){

117 
$w
 = 
$this
->
width
;

118 
$h
 = 
$this
->
height
;

119 
$lše_height
 = 
$h
/10;

120 
$lše_cŞÜ
 = "#D0D0D0";

121 
$cŞÜ
 = 
	`imagecŞÜ®loÿ‹
(
$this
->
img
, 
	`hexdec
(
	`sub¡r
(
$lše_cŞÜ
, 1, 2)), hexdec(substr($line_color, 3, 2)), hexdec(substr($line_color, 5, 2)));

122 
$i
=0;$i<10;$i++){

123 
$¡•
 =
$lše_height
*
$i
+2;

124 
	`imag–še
(
$this
->
img
, 0, 
$¡•
, 
$w
,$¡•, 
$cŞÜ
);

126 
$lše_width
 = 
$w
/10;

127 
$i
=0;$i<10;$i++){

128 
$¡•
 =
$lše_width
*
$i
+2;

129 
	`imag–še
(
$this
->
img
, 
$¡•
-2, 0, $¡•+2,
$h
, 
$cŞÜ
);

131 
	}
}

135 
´iv©e
 
funùiÚ
 
	$ü—‹Rec
() {

136 
	`imag”eùªgË
(
$this
->
img
, 0, 0, $this->
width
 - 1, $this->
height
 - 1, $this->
fÚtCŞÜ
);

137 
	}
}

142 
´iv©e
 
funùiÚ
 
	$ü—‹FÚt
() {

143 
$this
->
	`ü—‹Code
();

144 
$cŞÜ
 = 
$this
->
fÚtCŞÜ
;

145 ià(!
	`em±y
(
$cŞÜ
)) {

146 
$fÚtCŞÜ
 = 
	`imagecŞÜ®loÿ‹
(
$this
->
img
, 
	`hexdec
(
	`sub¡r
(
$cŞÜ
, 1, 2)), hexdec(substr($color, 3, 2)), hexdec(substr($color, 5, 2)));

148 
$x
 = (
$this
->
width
 - 10è/ $this->
codeL’
;

149 
$i
 = 0; $˜< 
$this
->
codeL’
; $i++) {

150 ià(
	`em±y
(
$cŞÜ
)) {

151 
$fÚtCŞÜ
 = 
	`imagecŞÜ®loÿ‹
(
$this
->
img
, 
	`mt_¿nd
(50, 155), mt_rand(50, 155), mt_rand(50, 155));

153 
	`imag‘táext
(
$this
->
img
, $this->
fÚtSize
, 
	`mt_¿nd
(- 30, 30), 
$x
 * 
$i
 + mt_¿nd(6, 10), mt_¿nd($this->
height
 / 1.3, $this->heighˆ- 5), 
$fÚtCŞÜ
, $this->
fÚt
, $this->
code
 [$i]);

155 
$this
->
fÚtCŞÜ
 = 
$fÚtCŞÜ
;

156 
	}
}

161 
´iv©e
 
funùiÚ
 
	$ü—‹Pix
() {

162 
$pix_cŞÜ
 = 
$this
->
fÚtCŞÜ
;

163 
$i
 = 0; $i < 50; $i++) {

164 
	`image£ix–
(
$this
->
img
, 
	`mt_¿nd
(0, $this->
width
), mt_¿nd(0, $this->
height
), 
$pix_cŞÜ
);

167 
$i
 = 0; $i < 2; $i++) {

168 
	`imag–še
(
$this
->
img
, 
	`mt_¿nd
(0, $this->
width
), mt_¿nd(0, $this->
height
), mt_¿nd(0, $this->width), mt_¿nd(0, $this->height), 
$pix_cŞÜ
);

171 
$i
 = 0; $i < 1; $i++) {

174 
	`imag—rc
(
$this
->
img
, 
	`mt_¿nd
(0, $this->
width
), mt_¿nd(0, $this->
height
), mt_rand(0, $this->width), mt_rand(0, $this->height)

175 , 
	`mt_¿nd
(0, 160), mt_¿nd(0, 200), 
$pix_cŞÜ
);

177 
	`image£‰hickÃss
(
$this
->
img
, 1);

178 
	}
}

183 
public
 
funùiÚ
 
	$show
() {

185 
	`h—d”
("Content-type:image/png");

186 
	`imag•ng
(
$this
->
img
);

187 
	`imagede¡roy
(
$this
->
img
);

188 
ex™
;

189 
	}
}

194 
´iv©e
 
funùiÚ
 
	$checkGD
() {

195  
	`ex‹nsiÚ_lßded
('gd'è&& 
	`funùiÚ_exi¡s
("imagepng");

196 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/Curl.php

1 <?
php


2 şas 
	cCu¾


4 cÚ¡ 
	mVERSION
 = '3.6.6';

5 cÚ¡ 
	mDEFAULT_TIMEOUT
 = 30;

6 
public
 
	m$cu¾
;

7 
public
 
	m$id
 = 
nuÎ
;

8 
public
 
	m$”rÜ
 = 
çl£
;

9 
public
 
	m$”rÜ_code
 = 0;

10 
public
 
	m$”rÜ_mes§ge
 = 
nuÎ
;

11 
public
 
	m$cu¾_”rÜ
 = 
çl£
;

12 
public
 
	m$cu¾_”rÜ_code
 = 0;

13 
public
 
	m$cu¾_”rÜ_mes§ge
 = 
nuÎ
;

14 
public
 
	m$h‰p_”rÜ
 = 
çl£
;

15 
public
 
	m$h‰p_¡©us_code
 = 0;

16 
public
 
	m$h‰p_”rÜ_mes§ge
 = 
nuÎ
;

17 
public
 
	m$ba£_u¾
 = 
nuÎ
;

18 
public
 
	m$u¾
 = 
nuÎ
;

19 
public
 
	m$»que¡_h—d”s
 = 
nuÎ
;

20 
public
 
	m$»¥Ú£_h—d”s
 = 
nuÎ
;

21 
public
 
	m$¿w_»¥Ú£_h—d”s
 = '';

22 
public
 
	m$»¥Ú£
 = 
nuÎ
;

23 
public
 
	m$¿w_»¥Ú£
 = 
nuÎ
;

24 
public
 
	m$befÜe_£nd_funùiÚ
 = 
nuÎ
;

25 
public
 
	m$dowÆßd_com¶‘e_funùiÚ
 = 
nuÎ
;

26 
´iv©e
 
	m$sucûss_funùiÚ
 = 
nuÎ
;

27 
´iv©e
 
	m$”rÜ_funùiÚ
 = 
nuÎ
;

28 
´iv©e
 
	m$com¶‘e_funùiÚ
 = 
nuÎ
;

29 
´iv©e
 
	m$cook›s
 = 
¬¿y
();

30 
´iv©e
 
	m$h—d”s
 = 
¬¿y
();

31 
´iv©e
 
	m$İtiÚs
 = 
¬¿y
();

32 
´iv©e
 
	m$jsÚ_decod”
 = 
nuÎ
;

33 
´iv©e
 
	m$jsÚ_·‰”n
 = '/^(?:application|text)\/(?:[a-z]+(?:[\.-][0-9a-z]+){0,}[\+\.]|x-)?json(?:-[a-z]+)?/i';

34 
´iv©e
 
	m$xml_·‰”n
 = '~^(?:text/|application/(?:atom\+|rss\+)?)xml~i';

42 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$ba£_u¾
 = 
nuÎ
)

44 ià(!
	`ex‹nsiÚ_lßded
('curl')) {

45 
throw
 
Ãw
 \
	`E¼ÜExû±iÚ
('cURL†ibrary is‚ot†oaded');

47 
$this
->
cu¾
 = 
	`cu¾_š™
();

48 
$this
->
id
 = 1;

49 
$this
->
	`£tDeçuÉU£rAg’t
();

50 
$this
->
	`£tDeçuÉJsÚDecod”
();

51 
$this
->
	`£tDeçuÉTimeout
();

52 
$this
->
	`£tO±
(
CURLINFO_HEADER_OUT
, 
Œue
);

53 
$this
->
	`£tO±
(
CURLOPT_HEADERFUNCTION
, 
	`¬¿y
($this, 'headerCallback'));

54 
$this
->
	`£tO±
(
CURLOPT_RETURNTRANSFER
, 
Œue
);

55 
$this
->
h—d”s
 = 
Ãw
 
	`Ca£In£ns™iveA¼ay
();

56 
$this
->
	`£tURL
(
$ba£_u¾
);

64 
public
 
funùiÚ
 
	$befÜeS’d
(
$ÿÎback
)

66 
$this
->
befÜe_£nd_funùiÚ
 = 
$ÿÎback
;

67 
	}
}

76 
public
 
funùiÚ
 
	$budPo¡D©a
(
$d©a
)

78 ià(
	`is_¬¿y
(
$d©a
)) {

79 ià(
£lf
::
	`is_¬¿y_muÉidim
(
$d©a
)) {

80 ià(
	`is£t
(
$this
->
h—d”s
['Content-Type']) &&

81 
	`´eg_m©ch
(
$this
->
jsÚ_·‰”n
, $this->
h—d”s
['Content-Type'])) {

82 
$jsÚ_¡r
 = 
	`jsÚ_’code
(
$d©a
);

83 ià(!(
$jsÚ_¡r
 ==ğ
çl£
)) {

84 
$d©a
 = 
$jsÚ_¡r
;

87 
$d©a
 = 
£lf
::
	`h‰p_bud_muÉi_qu”y
($data);

90 
$bš¬y_d©a
 = 
çl£
;

91 
	`fÜ—ch
 (
$d©a
 
as
 
$key
 => 
$v®ue
) {

95 ià(
	`is_¬¿y
(
$v®ue
è&& 
	`em±y
($value)) {

96 
$d©a
[
$key
] = '';

100 } 
	`–£if
 (
	`is_¡ršg
(
$v®ue
è&& 
	`¡½os
($value, '@') === 0) {

101 
$bš¬y_d©a
 = 
Œue
;

102 ià(
	`şass_exi¡s
('CURLFile')) {

103 
$d©a
[
$key
] = 
Ãw
 \
	`CURLFe
(
	`sub¡r
(
$v®ue
, 1));

105 } 
	`–£if
 (
$v®ue
 
š¡ªûof
 \
CURLFe
) {

106 
$bš¬y_d©a
 = 
Œue
;

109 ià(!
$bš¬y_d©a
) {

110 ià(
	`is£t
(
$this
->
h—d”s
['Content-Type']) &&

111 
	`´eg_m©ch
(
$this
->
jsÚ_·‰”n
, $this->
h—d”s
['Content-Type'])) {

112 
$jsÚ_¡r
 = 
	`jsÚ_’code
(
$d©a
);

113 ià(!(
$jsÚ_¡r
 ==ğ
çl£
)) {

114 
$d©a
 = 
$jsÚ_¡r
;

117 
$d©a
 = 
	`h‰p_bud_qu”y
($data, '', '&');

122  
$d©a
;

123 
	}
}

129 
public
 
funùiÚ
 
	$ÿÎ
()

131 
$¬gs
 = 
	`func_g‘_¬gs
();

132 
$funùiÚ
 = 
	`¬¿y_shiá
(
$¬gs
);

133 ià(
	`is_ÿÎabË
(
$funùiÚ
)) {

134 
	`¬¿y_unshiá
(
$¬gs
, 
$this
);

135 
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
);

137 
	}
}

143 
public
 
funùiÚ
 
	$şo£
()

145 ià(
	`is_»sourû
(
$this
->
cu¾
)) {

146 
	`cu¾_şo£
(
$this
->
cu¾
);

148 
$this
->
İtiÚs
 = 
nuÎ
;

149 
$this
->
jsÚ_decod”
 = 
nuÎ
;

150 
	}
}

157 
public
 
funùiÚ
 
	$com¶‘e
(
$ÿÎback
)

159 
$this
->
com¶‘e_funùiÚ
 = 
$ÿÎback
;

160 
	}
}

167 
public
 
funùiÚ
 
	$´og»ss
(
$ÿÎback
)

169 
$this
->
	`£tO±
(
CURLOPT_PROGRESSFUNCTION
, 
$ÿÎback
);

170 
$this
->
	`£tO±
(
CURLOPT_NOPROGRESS
, 
çl£
);

171 
	}
}

182 
public
 
funùiÚ
 
d–‘e
(
$u¾
, 
$qu”y_·¿m‘”s
 = 
¬¿y
(), 
$d©a
 = 
	$¬¿y
())

184 ià(
	`is_¬¿y
(
$u¾
)) {

185 
$d©a
 = 
$qu”y_·¿m‘”s
;

186 
$qu”y_·¿m‘”s
 = 
$u¾
;

187 
$u¾
 = 
$this
->
ba£_u¾
;

189 
$this
->
	`£tURL
(
$u¾
, 
$qu”y_·¿m‘”s
);

190 
$this
->
	`£tO±
(
CURLOPT_CUSTOMREQUEST
, 'DELETE');

191 
$this
->
	`£tO±
(
CURLOPT_POSTFIELDS
, $this->
	`budPo¡D©a
(
$d©a
));

192  
$this
->
	`exec
();

193 
	}
}

200 
public
 
funùiÚ
 
	$dowÆßdCom¶‘e
(
$fh
)

202 ià(!
$this
->
”rÜ
 && $this->
dowÆßd_com¶‘e_funùiÚ
) {

203 
	`»wšd
(
$fh
);

204 
$this
->
	`ÿÎ
($this->
dowÆßd_com¶‘e_funùiÚ
, 
$fh
);

205 
$this
->
dowÆßd_com¶‘e_funùiÚ
 = 
nuÎ
;

207 ià(
	`is_»sourû
(
$fh
)) {

208 
	`fşo£
(
$fh
);

213 ià(!
	`defšed
('STDOUT')) {

214 
	`defše
('STDOUT', 
	`fİ’
('php://stdout', 'w'));

218 
$this
->
	`£tO±
(
CURLOPT_FILE
, 
STDOUT
);

222 
$this
->
	`£tO±
(
CURLOPT_RETURNTRANSFER
, 
Œue
);

223 
	}
}

233 
public
 
funùiÚ
 
	$dowÆßd
(
$u¾
, 
$mixed_f’ame
)

235 ià(
	`is_ÿÎabË
(
$mixed_f’ame
)) {

236 
$this
->
dowÆßd_com¶‘e_funùiÚ
 = 
$mixed_f’ame
;

237 
$fh
 = 
	`tmpfe
();

239 
$f’ame
 = 
$mixed_f’ame
;

240 
$fh
 = 
	`fİ’
(
$f’ame
, 'wb');

242 
$this
->
	`£tO±
(
CURLOPT_FILE
, 
$fh
);

243 
$this
->
	`g‘
(
$u¾
);

244 
$this
->
	`dowÆßdCom¶‘e
(
$fh
);

245  ! 
$this
->
”rÜ
;

246 
	}
}

253 
public
 
funùiÚ
 
	$”rÜ
(
$ÿÎback
)

255 
$this
->
”rÜ_funùiÚ
 = 
$ÿÎback
;

256 
	}
}

265 
public
 
funùiÚ
 
	$exec
(
$ch
 = 
nuÎ
)

267 ià(!(
$ch
 ==ğ
nuÎ
)) {

268 
$this
->
¿w_»¥Ú£
 = 
	`cu¾_muÉi_g‘cÚ‹Á
(
$ch
);

270 
$this
->
	`ÿÎ
($this->
befÜe_£nd_funùiÚ
);

271 
$this
->
¿w_»¥Ú£
 = 
	`cu¾_exec
($this->
cu¾
);

272 
$this
->
cu¾_”rÜ_code
 = 
	`cu¾_”ºo
($this->
cu¾
);

274 
$this
->
cu¾_”rÜ_mes§ge
 = 
	`cu¾_”rÜ
($this->
cu¾
);

275 
$this
->
cu¾_”rÜ
 = !($this->
cu¾_”rÜ_code
 === 0);

276 
$this
->
h‰p_¡©us_code
 = 
	`cu¾_g‘šfo
($this->
cu¾
, 
CURLINFO_HTTP_CODE
);

277 
$this
->
h‰p_”rÜ
 = 
	`š_¬¿y
(
	`æoÜ
($this->
h‰p_¡©us_code
 / 100), 
	`¬¿y
(4, 5));

278 
$this
->
”rÜ
 = $this->
cu¾_”rÜ
 || $this->
h‰p_”rÜ
;

279 
$this
->
”rÜ_code
 = $this->
”rÜ
 ? ($this->
cu¾_”rÜ
 ? $this->
cu¾_”rÜ_code
 : $this->
h‰p_¡©us_code
) : 0;

280 
$this
->
»que¡_h—d”s
 = $this->
	`·r£Reque¡H—d”s
(
	`cu¾_g‘šfo
($this->
cu¾
, 
CURLINFO_HEADER_OUT
));

281 
$this
->
»¥Ú£_h—d”s
 = $this->
	`·r£Re¥Ú£H—d”s
($this->
¿w_»¥Ú£_h—d”s
);

282 
	`li¡
(
$this
->
»¥Ú£
, $this->
¿w_»¥Ú£
èğ$this->
	`·r£Re¥Ú£
($this->
»¥Ú£_h—d”s
, $this->raw_response);

283 
$this
->
h‰p_”rÜ_mes§ge
 = '';

284 ià(
$this
->
”rÜ
) {

285 ià(
	`is£t
(
$this
->
»¥Ú£_h—d”s
['Status-Line'])) {

286 
$this
->
h‰p_”rÜ_mes§ge
 = $this->
»¥Ú£_h—d”s
['Status-Line'];

289 
$this
->
”rÜ_mes§ge
 = $this->
cu¾_”rÜ
 ? $this->
cu¾_”rÜ_mes§ge
 : $this->
h‰p_”rÜ_mes§ge
;

290 ià(!
$this
->
”rÜ
) {

291 
$this
->
	`ÿÎ
($this->
sucûss_funùiÚ
);

293 
$this
->
	`ÿÎ
($this->
”rÜ_funùiÚ
);

295 
$this
->
	`ÿÎ
($this->
com¶‘e_funùiÚ
);

296  
$this
->
»¥Ú£
;

297 
	}
}

307 
public
 
funùiÚ
 
g‘
(
$u¾
, 
$d©a
 = 
	$¬¿y
())

309 ià(
	`is_¬¿y
(
$u¾
)) {

310 
$d©a
 = 
$u¾
;

311 
$u¾
 = 
$this
->
ba£_u¾
;

313 
$this
->
	`£tURL
(
$u¾
, 
$d©a
);

314 
$this
->
	`£tO±
(
CURLOPT_CUSTOMREQUEST
, 'GET');

315 
$this
->
	`£tO±
(
CURLOPT_HTTPGET
, 
Œue
);

316  
$this
->
	`exec
();

317 
	}
}

326 
public
 
funùiÚ
 
	$g‘O±
(
$İtiÚ
)

328  
$this
->
İtiÚs
[
$İtiÚ
];

329 
	}
}

339 
public
 
funùiÚ
 
h—d
(
$u¾
, 
$d©a
 = 
	$¬¿y
())

341 ià(
	`is_¬¿y
(
$u¾
)) {

342 
$d©a
 = 
$u¾
;

343 
$u¾
 = 
$this
->
ba£_u¾
;

345 
$this
->
	`£tURL
(
$u¾
, 
$d©a
);

346 
$this
->
	`£tO±
(
CURLOPT_CUSTOMREQUEST
, 'HEAD');

347 
$this
->
	`£tO±
(
CURLOPT_NOBODY
, 
Œue
);

348  
$this
->
	`exec
();

349 
	}
}

359 
public
 
funùiÚ
 
	$h—d”C®lback
(
$ch
, 
$h—d”
)

361 
$this
->
¿w_»¥Ú£_h—d”s
 .ğ
$h—d”
;

362  
	`¡¾’
(
$h—d”
);

363 
	}
}

373 
public
 
funùiÚ
 
İtiÚs
(
$u¾
, 
$d©a
 = 
	$¬¿y
())

375 ià(
	`is_¬¿y
(
$u¾
)) {

376 
$d©a
 = 
$u¾
;

377 
$u¾
 = 
$this
->
ba£_u¾
;

379 
$this
->
	`£tURL
(
$u¾
, 
$d©a
);

380 
$this
->
	`un£tH—d”
('Content-Length');

381 
$this
->
	`£tO±
(
CURLOPT_CUSTOMREQUEST
, 'OPTIONS');

382  
$this
->
	`exec
();

383 
	}
}

393 
public
 
funùiÚ
 
·tch
(
$u¾
, 
$d©a
 = 
	$¬¿y
())

395 ià(
	`is_¬¿y
(
$u¾
)) {

396 
$d©a
 = 
$u¾
;

397 
$u¾
 = 
$this
->
ba£_u¾
;

399 
$this
->
	`£tURL
(
$u¾
);

400 
$this
->
	`un£tH—d”
('Content-Length');

401 
$this
->
	`£tO±
(
CURLOPT_CUSTOMREQUEST
, 'PATCH');

402 
$this
->
	`£tO±
(
CURLOPT_POSTFIELDS
, 
$d©a
);

403  
$this
->
	`exec
();

404 
	}
}

414 
public
 
funùiÚ
 
po¡
(
$u¾
, 
$d©a
 = 
	$¬¿y
())

416 ià(
	`is_¬¿y
(
$u¾
)) {

417 
$d©a
 = 
$u¾
;

418 
$u¾
 = 
$this
->
ba£_u¾
;

420 ià(
	`is_¬¿y
(
$d©a
è&& 
	`em±y
($data)) {

421 
$this
->
	`un£tH—d”
('Content-Length');

423 
$this
->
	`£tURL
(
$u¾
);

424 
$this
->
	`£tO±
(
CURLOPT_CUSTOMREQUEST
, 'POST');

425 
$this
->
	`£tO±
(
CURLOPT_POST
, 
Œue
);

426 
$this
->
	`£tO±
(
CURLOPT_POSTFIELDS
, $this->
	`budPo¡D©a
(
$d©a
));

427  
$this
->
	`exec
();

428 
	}
}

438 
public
 
funùiÚ
 
put
(
$u¾
, 
$d©a
 = 
	$¬¿y
())

440 ià(
	`is_¬¿y
(
$u¾
)) {

441 
$d©a
 = 
$u¾
;

442 
$u¾
 = 
$this
->
ba£_u¾
;

444 
$this
->
	`£tURL
(
$u¾
);

445 
$this
->
	`£tO±
(
CURLOPT_CUSTOMREQUEST
, 'PUT');

446 
$put_d©a
 = 
$this
->
	`budPo¡D©a
(
$d©a
);

447 ià(
	`em±y
(
$this
->
İtiÚs
[
CURLOPT_INFILE
]è&&ƒm±y($this->İtiÚs[
CURLOPT_INFILESIZE
])) {

448 
$this
->
	`£tH—d”
('CÚ‹Á-L’gth', 
	`¡¾’
(
$put_d©a
));

450 
$this
->
	`£tO±
(
CURLOPT_POSTFIELDS
, 
$put_d©a
);

451  
$this
->
	`exec
();

452 
	}
}

460 
public
 
funùiÚ
 
£tBasicAuth’tiÿtiÚ
(
$u£ºame
, 
$·sswÜd
 = '')

462 
$this
->
£tO±
(
CURLOPT_HTTPAUTH
, 
CURLAUTH_BASIC
);

463 
	g$this
->
£tO±
(
CURLOPT_USERPWD
, 
$u£ºame
 . ':' . 
$·sswÜd
);

472 
public
 
funùiÚ
 
£tDige¡Auth’tiÿtiÚ
(
$u£ºame
, 
$·sswÜd
 = '')

474 
$this
->
£tO±
(
CURLOPT_HTTPAUTH
, 
CURLAUTH_DIGEST
);

475 
	g$this
->
£tO±
(
CURLOPT_USERPWD
, 
$u£ºame
 . ':' . 
$·sswÜd
);

484 
public
 
funùiÚ
 
	$£tCook›
(
$key
, 
$v®ue
)

486 
$this
->
cook›s
[
$key
] = 
$v®ue
;

487 
$this
->
	`£tO±
(
CURLOPT_COOKIE
, 
	`¡r_»¶aû
(' ', '%20', 
	`u¾decode
(
	`h‰p_bud_qu”y
($this->
cook›s
, '', '; '))));

488 
	}
}

495 
public
 
funùiÚ
 
	$£tPÜt
(
$pÜt
)

497 
$this
->
	`£tO±
(
CURLOPT_PORT
, 
	`štv®
(
$pÜt
));

498 
	}
}

505 
public
 
funùiÚ
 
	$£tCÚÃùTimeout
(
$£cÚds
)

507 
$this
->
	`£tO±
(
CURLOPT_CONNECTTIMEOUT
, 
$£cÚds
);

508 
	}
}

515 
public
 
funùiÚ
 
	$£tCook›Fe
(
$cook›_fe
)

517 
$this
->
	`£tO±
(
CURLOPT_COOKIEFILE
, 
$cook›_fe
);

518 
	}
}

525 
public
 
funùiÚ
 
	$£tCook›J¬
(
$cook›_j¬
)

527 
$this
->
	`£tO±
(
CURLOPT_COOKIEJAR
, 
$cook›_j¬
);

528 
	}
}

534 
public
 
funùiÚ
 
	$£tDeçuÉJsÚDecod”
()

536 
$this
->
jsÚ_decod”
 = 
	`funùiÚ
(
$»¥Ú£
) {

537 
$jsÚ_obj
 = 
	`jsÚ_decode
(
$»¥Ú£
, 
çl£
);

538 ià(!(
$jsÚ_obj
 ==ğ
nuÎ
)) {

539 
$»¥Ú£
 = 
$jsÚ_obj
;

541  
$»¥Ú£
;

543 
	}
}

549 
public
 
funùiÚ
 
	$£tDeçuÉTimeout
()

551 
$this
->
	`£tTimeout
(
£lf
::
DEFAULT_TIMEOUT
);

552 
	}
}

558 
public
 
funùiÚ
 
	$£tDeçuÉU£rAg’t
()

560 
$u£r_ag’t
 = 'PHP-Cu¾-CÏss/' . 
£lf
::
VERSION
 . ' (+https://github.com/php-curl-class/php-curl-class)';

561 
$u£r_ag’t
 .ğ' PHP/' . 
PHP_VERSION
;

562 
$cu¾_v”siÚ
 = 
	`cu¾_v”siÚ
();

563 
$u£r_ag’t
 .ğ' cu¾/' . 
$cu¾_v”siÚ
['version'];

564 
$this
->
	`£tU£rAg’t
(
$u£r_ag’t
);

565 
	}
}

575 
public
 
funùiÚ
 
	$£tH—d”
(
$key
, 
$v®ue
)

577 
$this
->
h—d”s
[
$key
] = 
$v®ue
;

578 
$h—d”s
 = 
	`¬¿y
();

579 
	`fÜ—ch
 (
$this
->
h—d”s
 
as
 
$key
 => 
$v®ue
) {

580 
$h—d”s
[
$key
] = 
$v®ue
;

582 
$this
->
	`£tO±
(
CURLOPT_HTTPHEADER
, 
	`¬¿y_m­
(
	`funùiÚ
(
$v®ue
, 
$key
) {

583  
$key
 . ': ' . 
$v®ue
;

584 }, 
$h—d”s
, 
	`¬¿y_keys
($headers)));

585 
	}
}

592 
public
 
funùiÚ
 
	$£tJsÚDecod”
(
$funùiÚ
)

594 ià(
	`is_ÿÎabË
(
$funùiÚ
)) {

595 
$this
->
jsÚ_decod”
 = 
$funùiÚ
;

597 
	}
}

607 
public
 
funùiÚ
 
	$£tO±
(
$İtiÚ
, 
$v®ue
)

609 
$»quœed_İtiÚs
 = 
	`¬¿y
(

610 
CURLINFO_HEADER_OUT
 => 'CURLINFO_HEADER_OUT',

611 
CURLOPT_RETURNTRANSFER
 => 'CURLOPT_RETURNTRANSFER',

613 ià(
	`š_¬¿y
(
$İtiÚ
, 
	`¬¿y_keys
(
$»quœed_İtiÚs
), 
Œue
è&& !(
$v®ue
 ===rue)) {

614 
	`Œigg”_”rÜ
(
$»quœed_İtiÚs
[
$İtiÚ
] . ' i ¨»quœed o±iÚ', 
E_USER_WARNING
);

616 
$this
->
İtiÚs
[
$İtiÚ
] = 
$v®ue
;

617  
	`cu¾_£tİt
(
$this
->
cu¾
, 
$İtiÚ
, 
$v®ue
);

618 
	}
}

625 
public
 
funùiÚ
 
	$£tReã»r
(
$»ã»r
)

627 
$this
->
	`£tReã¼”
(
$»ã»r
);

628 
	}
}

635 
public
 
funùiÚ
 
	$£tReã¼”
(
$»ã¼”
)

637 
$this
->
	`£tO±
(
CURLOPT_REFERER
, 
$»ã¼”
);

638 
	}
}

645 
public
 
funùiÚ
 
	$£tTimeout
(
$£cÚds
)

647 
$this
->
	`£tO±
(
CURLOPT_TIMEOUT
, 
$£cÚds
);

648 
	}
}

656 
public
 
funùiÚ
 
£tURL
(
$u¾
, 
$d©a
 = 
	$¬¿y
())

658 
$this
->
ba£_u¾
 = 
$u¾
;

659 
$this
->
u¾
 = $this->
	`budURL
(
$u¾
, 
$d©a
);

660 
$this
->
	`£tO±
(
CURLOPT_URL
, $this->
u¾
);

661 
	}
}

668 
public
 
funùiÚ
 
	$£tU£rAg’t
(
$u£r_ag’t
)

670 
$this
->
	`£tO±
(
CURLOPT_USERAGENT
, 
$u£r_ag’t
);

671 
	}
}

678 
public
 
funùiÚ
 
	$sucûss
(
$ÿÎback
)

680 
$this
->
sucûss_funùiÚ
 = 
$ÿÎback
;

681 
	}
}

688 
public
 
funùiÚ
 
	$un£tH—d”
(
$key
)

690 
$this
->
	`£tH—d”
(
$key
, '');

691 
	`un£t
(
$this
->
h—d”s
[
$key
]);

692 
	}
}

699 
public
 
funùiÚ
 
	$v”bo£
(
$Ú
 = 
Œue
)

701 
$this
->
	`£tO±
(
CURLOPT_VERBOSE
, 
$Ú
);

702 
	}
}

708 
public
 
funùiÚ
 
	$__de¡ruù
()

710 
$this
->
	`şo£
();

711 
	}
}

721 
´iv©e
 
funùiÚ
 
budURL
(
$u¾
, 
$d©a
 = 
	$¬¿y
())

723  
$u¾
 . (
	`em±y
(
$d©a
è? '' : '?' . 
	`h‰p_bud_qu”y
($data));

724 
	}
}

733 
´iv©e
 
funùiÚ
 
	$·r£H—d”s
(
$¿w_h—d”s
)

735 
$¿w_h—d”s
 = 
	`´eg_¥l™
('/\r\n/', $¿w_h—d”s, 
nuÎ
, 
PREG_SPLIT_NO_EMPTY
);

736 
$h‰p_h—d”s
 = 
Ãw
 
	`Ca£In£ns™iveA¼ay
();

737 
$¿w_h—d”s_couÁ
 = 
	`couÁ
(
$¿w_h—d”s
);

738 
$i
 = 1; $˜< 
$¿w_h—d”s_couÁ
; $i++) {

739 
	`li¡
(
$key
, 
$v®ue
èğ
	`ex¶ode
(':', 
$¿w_h—d”s
[
$i
], 2);

740 
$key
 = 
	`Œim
($key);

741 
$v®ue
 = 
	`Œim
($value);

743 ià(
	`is£t
(
$h‰p_h—d”s
[
$key
])) {

744 
$h‰p_h—d”s
[
$key
] .ğ',' . 
$v®ue
;

746 
$h‰p_h—d”s
[
$key
] = 
$v®ue
;

749  
	`¬¿y
(
	`is£t
(
$¿w_h—d”s
['0']è? $¿w_h—d”s['0'] : '', 
$h‰p_h—d”s
);

750 
	}
}

759 
´iv©e
 
funùiÚ
 
	$·r£Reque¡H—d”s
(
$¿w_h—d”s
)

761 
$»que¡_h—d”s
 = 
Ãw
 
	`Ca£In£ns™iveA¼ay
();

762 
	`li¡
(
$fœ¡_lše
, 
$h—d”s
èğ
$this
->
	`·r£H—d”s
(
$¿w_h—d”s
);

763 
$»que¡_h—d”s
['Reque¡-Lše'] = 
$fœ¡_lše
;

764 
	`fÜ—ch
 (
$h—d”s
 
as
 
$key
 => 
$v®ue
) {

765 
$»que¡_h—d”s
[
$key
] = 
$v®ue
;

767  
$»que¡_h—d”s
;

768 
	}
}

778 
´iv©e
 
funùiÚ
 
	$·r£Re¥Ú£
(
$»¥Ú£_h—d”s
, 
$¿w_»¥Ú£
)

780 
$»¥Ú£
 = 
$¿w_»¥Ú£
;

781 ià(
	`is£t
(
$»¥Ú£_h—d”s
['Content-Type'])) {

782 ià(
	`´eg_m©ch
(
$this
->
jsÚ_·‰”n
, 
$»¥Ú£_h—d”s
['Content-Type'])) {

783 
$jsÚ_decod”
 = 
$this
->
jsÚ_decod”
;

784 ià(
	`is_ÿÎabË
(
$jsÚ_decod”
)) {

785 
$»¥Ú£
 = 
	`$jsÚ_decod”
($response);

787 } 
	`–£if
 (
	`´eg_m©ch
(
$this
->
xml_·‰”n
, 
$»¥Ú£_h—d”s
['Content-Type'])) {

788 
$xml_obj
 = @
	`sim¶exml_lßd_¡ršg
(
$»¥Ú£
);

789 ià(!(
$xml_obj
 ==ğ
çl£
)) {

790 
$»¥Ú£
 = 
$xml_obj
;

794  
	`¬¿y
(
$»¥Ú£
, 
$¿w_»¥Ú£
);

795 
	}
}

804 
´iv©e
 
funùiÚ
 
	$·r£Re¥Ú£H—d”s
(
$¿w_»¥Ú£_h—d”s
)

806 
$»¥Ú£_h—d”_¬¿y
 = 
	`ex¶ode
("\r\n\r\n", 
$¿w_»¥Ú£_h—d”s
);

807 
$»¥Ú£_h—d”
 = '';

808 
$i
 = 
	`couÁ
(
$»¥Ú£_h—d”_¬¿y
) - 1; $i >= 0; $i--) {

809 ià(
	`¡ros
(
$»¥Ú£_h—d”_¬¿y
[
$i
], 'HTTP/') === 0) {

810 
$»¥Ú£_h—d”
 = 
$»¥Ú£_h—d”_¬¿y
[
$i
];

814 
$»¥Ú£_h—d”s
 = 
Ãw
 
	`Ca£In£ns™iveA¼ay
();

815 
	`li¡
(
$fœ¡_lše
, 
$h—d”s
èğ
$this
->
	`·r£H—d”s
(
$»¥Ú£_h—d”
);

816 
$»¥Ú£_h—d”s
['Stus-Lše'] = 
$fœ¡_lše
;

817 
	`fÜ—ch
 (
$h—d”s
 
as
 
$key
 => 
$v®ue
) {

818 
$»¥Ú£_h—d”s
[
$key
] = 
$v®ue
;

820  
$»¥Ú£_h—d”s
;

821 
	}
}

831 
public
 
funùiÚ
 
	$h‰p_bud_muÉi_qu”y
(
$d©a
, 
$key
 = 
nuÎ
)

833 
$qu”y
 = 
	`¬¿y
();

834 ià(
	`em±y
(
$d©a
)) {

835  
$key
 . '=';

837 
$is_¬¿y_assoc
 = 
£lf
::
	`is_¬¿y_assoc
(
$d©a
);

838 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v®ue
) {

839 ià(
	`is_¡ršg
(
$v®ue
è|| 
	`is_num”ic
($value)) {

840 
$b¿ck‘s
 = 
$is_¬¿y_assoc
 ? '[' . 
$k
 . ']' : '[]';

841 
$qu”y
[] = 
	`u¾’code
(
$key
 ==ğ
nuÎ
 ? 
$k
 : $key . 
$b¿ck‘s
è. '=' . 
	`¿wu¾’code
(
$v®ue
);

842 } 
	`–£if
 (
	`is_¬¿y
(
$v®ue
)) {

843 
$Ã¡ed
 = 
$key
 ==ğ
nuÎ
 ? 
$k
 : $key . '[' . $k . ']';

844 
$qu”y
[] = 
£lf
::
	`h‰p_bud_muÉi_qu”y
(
$v®ue
, 
$Ã¡ed
);

847  
	`im¶ode
('&', 
$qu”y
);

848 
	}
}

857 
public
 
funùiÚ
 
	$is_¬¿y_assoc
(
$¬¿y
)

859  (
boŞ
)
	`couÁ
(
	`¬¿y_f‹r
(
	`¬¿y_keys
(
$¬¿y
), 'is_string'));

860 
	}
}

869 
public
 
funùiÚ
 
	$is_¬¿y_muÉidim
(
$¬¿y
)

871 ià(!
	`is_¬¿y
(
$¬¿y
)) {

872  
çl£
;

874  (
boŞ
)
	`couÁ
(
	`¬¿y_f‹r
(
$¬¿y
, 'is_array'));

875 
	}
}

877 
şass
 
Ca£In£ns™iveA¼ay
 
	gim¶em’ts
 \
	gA¼ayAcûss
, \
	gCouÁabË
, \
	gI‹¿tÜ


879 
´iv©e
 
	g$cÚš”
 = 
¬¿y
();

880 
public
 
funùiÚ
 
off£tS‘
(
$off£t
, 
$v®ue
)

882 ià(
	g$off£t
 ==ğ
nuÎ
) {

883 
$this
->
cÚš”
[] = 
$v®ue
;

885 
	g$šdex
 = 
¬¿y_£¬ch
(
¡¹Şow”
(
$off£t
), 
¬¿y_keys
(
¬¿y_chªge_key_ÿ£
(
$this
->
cÚš”
, 
CASE_LOWER
)));

886 ià(!(
	g$šdex
 ==ğ
çl£
)) {

887 
$keys
 = 
¬¿y_keys
(
$this
->
cÚš”
);

888 
un£t
(
$this
->
cÚš”
[
$keys
[
$šdex
]]);

890 
	g$this
->
	gcÚš”
[
$off£t
] = 
$v®ue
;

893 
public
 
funùiÚ
 
off£tExi¡s
(
$off£t
)

895  
¬¿y_key_exi¡s
(
¡¹Şow”
(
$off£t
), 
¬¿y_chªge_key_ÿ£
(
$this
->
cÚš”
, 
CASE_LOWER
));

897 
public
 
funùiÚ
 
off£tUn£t
(
$off£t
)

899 
un£t
(
$this
->
cÚš”
[
$off£t
]);

901 
public
 
funùiÚ
 
off£tG‘
(
$off£t
)

903 
	g$šdex
 = 
¬¿y_£¬ch
(
¡¹Şow”
(
$off£t
), 
¬¿y_keys
(
¬¿y_chªge_key_ÿ£
(
$this
->
cÚš”
, 
CASE_LOWER
)));

904 ià(
	g$šdex
 ==ğ
çl£
) {

905  
nuÎ
;

907 
	g$v®ues
 = 
¬¿y_v®ues
(
$this
->
cÚš”
);

908  
	g$v®ues
[
$šdex
];

910 
public
 
funùiÚ
 
couÁ
()

912  
couÁ
(
$this
->
cÚš”
);

914 
public
 
funùiÚ
 
cu¼’t
()

916  
cu¼’t
(
$this
->
cÚš”
);

918 
public
 
funùiÚ
 
Ãxt
()

920  
Ãxt
(
$this
->
cÚš”
);

922 
public
 
funùiÚ
 
key
()

924  
key
(
$this
->
cÚš”
);

926 
public
 
funùiÚ
 
v®id
()

928  !(
	g$this
->
cu¼’t
(è==ğ
çl£
);

930 
public
 
funùiÚ
 
»wšd
()

932 
»£t
(
$this
->
cÚš”
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/Excel.php

1 <?
php


2 ià(!
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

4 
»quœe_Úû
 
	gAPPPATH
."/third_party/PHPExcel.php";

5 
»quœe_Úû
 
	gAPPPATH
."/third_party/PHPExcel/IOFactory.php";

7 şas 
	cExûl
 {

16 
public
 
funùiÚ
 
	$»adExûl
(
$exûl_fe
, 
$sh“t_id
, 
$h—d”s
, 
$cÚš_®l_cŞumn
 = 
Œue
) {

17 
$exûl_ty³
 = 
PHPExûl_IOFaùÜy
::
	`id’tify
(
$exûl_fe
);

18 
$exûl_»ad”
 = 
PHPExûl_IOFaùÜy
::
	`ü—‹R—d”
(
$exûl_ty³
);

19 if(
	`m‘hod_exi¡s
(
$exûl_»ad”
, "setReadDataOnly")) {

20 
$exûl_»ad”
->
	`£tR—dD©aOÆy
(
Œue
);

22 
$exûl
 = 
$exûl_»ad”
->
	`lßd
(
$exûl_fe
);

23 
$couÁ
 = 
$exûl
->
	`g‘Sh“tCouÁ
();

24 if(
$couÁ
< 
$sh“t_id
) {

27 
$sh“t
 = 
$exûl
->
	`g‘Sh“t
(
$sh“t_id
);

28 
$d©a
 = 
£lf
::
	`»adSh“t
(
$sh“t
, 
$h—d”s
, 
$cÚš_®l_cŞumn
);

29  
$d©a
;

33 
´iv©e
 
funùiÚ
 
	$»adSh“t
(
$sh“t
, 
$h—d”s
, 
$cÚš_®l_cŞumn
) {

34 
$cÚ‹Ás
 = 
	`¬¿y
();

35 
$šdex
 = 0;

36 
$h—d”_£q
 = 
	`¬¿y
();

37 
$cŞumn_£q
 = 
	`¬¿y
();

38 
	`fÜ—ch
 (
$sh“t
->
	`g‘RowI‹¿tÜ
(è
as
 
$row
) {

39 
$ûÎI‹¿tÜ
 = 
$row
->
	`g‘C–lI‹¿tÜ
();

40 
	`fÜ—ch
 (
$ûÎI‹¿tÜ
 
as
 
$cŞumn
 => 
$ûÎ
) {

41 ià(
$šdex
 == 0) {

42 
$h—d”
 = 
$ûÎ
->
	`g‘V®ue
();

44 if(
	`š_¬¿y
(
$h—d”
, 
$h—d”s
)) {

45 
$h—d”_£q
[] = 
$h—d”
;

46 
$cŞumn_£q
[] = 
$cŞumn
;

48 if(
$cÚš_®l_cŞumn
 =ğ
Œue
) {

49  "exûlæ–‡ä»¶æ ¼å¼ä¸å¯¹ï¼Œæ— æ³•è¯†åˆ«çš„åˆ—" . 
$h—d”
;

54 } if(
	`š_¬¿y
(
$cŞumn
, 
$cŞumn_£q
)){

55 
$cÚ‹Ás
[
$šdex
][] = 
$ûÎ
->
	`g‘V®ue
();

58 
$šdex
++;

60  
	`¬¿y
('h—d”s' => 
$h—d”_£q
, 'cÚ‹Ás' => 
$cÚ‹Ás
);

61 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/FileBase.php

1 <?
php


2 ià(!
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

13 şas 
	cFeBa£
 {

15 
´iv©e
 
	m$_feTmpP©h
 = "";

16 
´iv©e
 
	m$_feP©h
 = "";

17 
´iv©e
 
	m$_feName
 = "";

18 
´iv©e
 
	m$_feTy³
 = "";

19 
public
 
	m$_feEx‹rsiÚ
 = 
¬¿y
("image/gif", "image/jpg", "image/jpeg", "image/pjpeg", "image/png", "xls", "xlsx", "doc", "docx");

21 
public
 
funùiÚ
 
	$š™
(
$fes
, 
$şass
){

22 
$this
->
_feName
 = 
$fes
['file']['name'];

23 
$this
->
_feTy³
 = 
	`·thšfo
(
$fes
['fe']['Çme'], 
PATHINFO_EXTENSION
);;

24 
$this
->
_feTmpP©h
 = 
$fes
['file']['tmp_name'];

25 
$this
->
_feP©h
 = "images/{$class}/";

34 
public
 
funùiÚ
 
	$checkFeEx‹rsiÚ
(){

35 if(!
	`š_¬¿y
(
$this
->
_feTy³
, $this->
_feEx‹rsiÚ
))

36  
FALSE
;

37 if(!
	`fe_exi¡s
(
$this
->
_feP©h
))

38  
FALSE
;

39  
TRUE
;

40 
	}
}

48 
public
 
funùiÚ
 
	$§veFeP©h
(){

49 
$¡»amR—d”
 = 
	`fe_g‘_cÚ‹Ás
(
$this
->
_feTmpP©h
);

50 
	`fe_put_cÚ‹Ás
(
$this
->
_feP©h
 . $this->
_feName
, 
$¡»amR—d”
);

51  
$this
->
_feP©h
 . $this->
_feName
;

52 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/Page.php

1 <?
php


2 şas 
	cPage


4 
´iv©e
 
	m$myde_couÁ
;

5 
public
 
	m$myde_size
;

6 
´iv©e
 
	m$myde_·ge
;

7 
´iv©e
 
	m$myde_·ge_couÁ
;

8 
´iv©e
 
	m$·ge_u¾
;

9 
´iv©e
 
	m$·ge_i
;

10 
´iv©e
 
	m$·ge_ub
;

11 
public
 
	m$·ge_lim™
;

15 
funùiÚ
 
__cÚ¡ruù
(
$¬r
 = 
	$¬¿y
()){

16 
$myde_couÁ
='';

17 
$myde_size
='';

18 
$myde_·ge
='';

19 
$·ge_u¾
='';

20 if(!
	`em±y
(
$¬r
)){

21 
	`exŒaù
(
$¬r
);

25 
$this
->
myde_couÁ
=
	`em±y
(
$myde_couÁ
è? $this->myde_couÁ:$this->
	`num”ic
($myde_count);

26 
$this
->
myde_size
=
	`em±y
(
$myde_size
è? $this->myde_size:$this->
	`num”ic
($myde_size);

27 
$this
->
myde_·ge
=
	`em±y
(
$myde_·ge
è? $this->myde_·ge:$this->
	`num”ic
($myde_page);

28 
$this
->
·ge_lim™
=($this->
myde_·ge
 * $thi -> 
myde_size
) - $this -> myde_size;

30 ifĞ
$this
->
·ge_lim™
<0){

31 
$this
->
·ge_lim™
=0;

33 
$this
->
·ge_u¾
=
$·ge_u¾
;

35 if(
$this
->
myde_·ge
<1)$this->myde_page=1;

36 if(
$this
->
myde_couÁ
<0)$this->
myde_·ge
=0;

37 
$this
->
myde_·ge_couÁ
=
	`û
($this->
myde_couÁ
/$this->
myde_size
);

38 if(
$this
->
myde_·ge_couÁ
<1)

39 
$this
->
myde_·ge_couÁ
=1;

40 if(
$this
->
myde_·ge
 > $this->
myde_·ge_couÁ
)

41 
$this
->
myde_·ge
 = $this->
myde_·ge_couÁ
;

49 
$this
->
·ge_i
 = $this->
myde_·ge
;

50 
$this
->
·ge_ub
 = $this->
myde_·ge
+5;

52 if(
$this
->
·ge_ub
 > $this->
myde_·ge_couÁ
)

54 
$this
->
·ge_ub
 = $this->
myde_·ge_couÁ
;

55 
$this
->
·ge_i
 = $this->
·ge_ub
-5;

59 if(
$this
->
·ge_i
<1)$this->page_i=1;

60 if(
$this
->
·ge_ub
>$this->
myde_·ge_couÁ
){$this->page_ub=$this->myde_page_count; }

62 
´iv©e
 
funùiÚ
 
	$num”ic
(
$id
)

64 ià(
	`¡¾’
(
$id
))

66 ià(!
	`´eg_m©ch
("/^[0-9]+$/",
$id
)) $id = 1;

70 
$id
 = 1;

72  
$id
;

73 
	}
}

78 
´iv©e
 
funùiÚ
 
	$·ge_»¶aû
(
$·ge
)

79 { 
	`¡r_»¶aû
("{·ge}", 
$·ge
, 
$this
 -> 
·ge_u¾
);
	}
}

83 
´iv©e
 
funùiÚ
 
	$myde_home
()

84 { if(
$this
 -> 
myde_·ge
 != 1){

85  " <l˜şass=\"·ge_a\"><¨h»f=\"".
$this
 -> 
	`·ge_»¶aû
(1)."\"itle=\"é¦–é¡µ\" >é¦–é¡µ</a></li>\n";

87  " <l˜şass=\"di§bËd\"><¨h»f=\"".
$this
 -> 
	`·ge_»¶aû
(1)."\"itle=\"é¦–é¡µ\" >é¦–é¡µ</a></li>\n";

89 
	}
}

90 
´iv©e
 
funùiÚ
 
	$myde_´ev
()

91 { if(
$this
 -> 
myde_·ge
 != 1){

92  " <l˜şass=\"·ge_a\"><¨h»f=\"".
$this
 -> 
	`·ge_»¶aû
($this->
myde_·ge
-1) ."\"itle=\"ä¸Šä¸€é¡µ\" >ä¸Šä¸€é¡µ</a></li>\n";

94  " <l˜şass=\"di§bËd\"><¨h»f=\"".
$this
 -> 
	`·ge_»¶aû
($this->
myde_·ge
-1) ."\"itle=\"ä¸Šä¸€é¡µ\" >ä¸Šä¸€é¡µ</a></li>\n";

96 
	}
}

97 
´iv©e
 
funùiÚ
 
	$myde_Ãxt
()

99 if(
$this
 -> 
myde_·ge
 !ğ$thi -> 
myde_·ge_couÁ
){

100  " <l˜şass=\"·ge_a\"><¨h»f=\"".
$this
 -> 
	`·ge_»¶aû
($this->
myde_·ge
+1) ."\"itle=\"ä¸‹ä¸€é¡µ\" >ä¸‹ä¸€é¡µ</a></li>\n";

103  " <l˜şass=\"di§bËd\"><¨h»f=\"".
$this
 -> 
	`·ge_»¶aû
($this->
myde_·ge
+1) ."\"itle=\"ä¸‹ä¸€é¡µ\" >ä¸‹ä¸€é¡µ</a></li>\n";

105 
	}
}

106 
´iv©e
 
funùiÚ
 
	$myde_Ï¡
()

108 if(
$this
 -> 
myde_·ge
 !ğ$thi -> 
myde_·ge_couÁ
){

109  " <l˜şass=\"·ge_a\"><¨h»f=\"".
$this
 -> 
	`·ge_»¶aû
($thi -> 
myde_·ge_couÁ
)."\"itle=\"å°¾é¡µ\" >å°¾é¡µ</a></li>\n";

111  " <l˜şass=\"di§bËd\"><¨h»f=\"".
$this
 -> 
	`·ge_»¶aû
($thi -> 
myde_·ge_couÁ
)."\"itle=\"å°¾é¡µ\" >å°¾é¡µ</a></li>\n";

113 
	}
}

114 
funùiÚ
 
myde_wr™e
(
$id
='page')

116 
$¡r
 = "<div id=\"".
$id
."\" class=\"pages\">\n <ul>\n ";

117 
	g$¡r
 .ğ"<li><¥ª>:".
$this
 -> 
myde_couÁ
."</span></li>\n";

118 
	g$¡r
 .ğ"<li><¥ª>".
$this
 -> 
myde_·ge
."</¥ª>/<¥ª>".$thi -> 
myde_·ge_couÁ
."</span></li>\n";

119 
	g$¡r
 .ğ
$this
 -> 
myde_home
();

120 
	g$¡r
 .ğ
$this
 -> 
myde_´ev
();

123 
	g$·ge_fÜ_i
=
$this
->
·ge_i
;$·ge_fÜ_˜<ğ$thi -> 
·ge_ub
;$page_for_i++){

124 if(
	g$this
 -> 
	gmyde_·ge
 =ğ
$·ge_fÜ_i
){

125 
$¡r
 .ğ"<l˜şass=\"Ú\">".
$·ge_fÜ_i
."</li>\n";

128 
	g$¡r
 .ğ"<l˜şass=\"·ge_a\"><¨h»f=\"".
$this
 -> 
·ge_»¶aû
(
$·ge_fÜ_i
)."\"itle=\"ç¬¬".$page_for_i."é¡µ\">";

129 
	g$¡r
 .ğ
$·ge_fÜ_i
 . "</a></li>\n";

132 
	g$¡r
 .ğ
$this
 -> 
myde_Ãxt
();

133 
	g$¡r
 .ğ
$this
 -> 
myde_Ï¡
();

136 
	g$¡r
 .ğ"<l˜şass=\"·ges_šput\"><špuˆty³=\"‹xt\" v®ue=\"".
$this
 -> 
myde_·ge
."\"";

137 
	g$¡r
 .= "onmouseover=\"javascript:this.value='';this.focus();\" onkeydown=\"javascript: if(event.keyCode==13){†ocation='";

138 
	g$¡r
 .ğ
$this
 -> 
·ge_»¶aû
("'+this.value+'")."';return false;}\"";

139 
	g$¡r
 .= "itle=\"è¾“å…¥æ‚¨æƒ³è¦åˆ°è¾¾çš„é¡µç ,ç„¶åå›è½¦ï¼\" /></li>\n";

141 
	g$¡r
 .= " </ul></div>";

142  
	g$¡r
;

144 
funùiÚ
 
myde_wr™e1
(
$id
='page')

146 
$¡r
 = "<div id=\"".
$id
."\" class=\"pages\">\n <ul>\n ";

147 
	g$¡r
 .ğ"<li><¥ª>æ€»è®°å½•:".
$this
 -> 
myde_couÁ
."</span></li>\n";

149 
	g$¡r
 .ğ
$this
 -> 
myde_home
();

150 
	g$¡r
 .ğ
$this
 -> 
myde_´ev
();

152 
	g$·ge_fÜ_i
=
$this
->
·ge_i
;$·ge_fÜ_˜<ğ$this->
·ge_ub
;$page_for_i++){

153 if(
	g$this
 -> 
	gmyde_·ge
 =ğ
$·ge_fÜ_i
)

155 
$¡r
 .ğ"<l˜şass=\"di§bËd\"><¨h»f=\"".
$this
 -> 
·ge_»¶aû
(
$·ge_fÜ_i
)."\"itle=\"ç¬¬".$page_for_i."é¡µ\">";

156 
	g$¡r
 .ğ
$·ge_fÜ_i
 . "</a></li>\n";

159 
	g$¡r
 .ğ"<l˜şass=\"·ge_a\"><¨h»f=\"".
$this
 -> 
·ge_»¶aû
(
$·ge_fÜ_i
)."\"itle=\"ç¬¬".$page_for_i."é¡µ\">";

160 
	g$¡r
 .ğ
$·ge_fÜ_i
 . "</a></li>\n";

164 
	g$¡r
 .ğ
$this
 -> 
myde_Ãxt
();

165 
	g$¡r
 .ğ
$this
 -> 
myde_Ï¡
();

182 
	g$¡r
 .= " </ul></div>";

183  
	g$¡r
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/Snoopy.php

1 <?
php


38 şas 
	cSnoİy


44 
v¬
 
	m$ho¡
 = "www.php.net";

45 
v¬
 
	m$pÜt
 = 80;

46 
v¬
 
	m$´oxy_ho¡
 = "";

47 
v¬
 
	m$´oxy_pÜt
 = "";

48 
v¬
 
	m$´oxy_u£r
 = "";

49 
v¬
 
	m$´oxy_·ss
 = "";

51 
v¬
 
	m$ag’t
 = "Snoopy v1.2.3";

52 
v¬
 
	m$»ã»r
 = "";

53 
v¬
 
	m$cook›s
 = 
¬¿y
();

55 
v¬
 
	m$¿wh—d”s
 = 
¬¿y
();

58 
v¬
 
	m$max»dœs
 = 5;

59 
v¬
 
	m$Ï¡»dœeùaddr
 = "";

60 
v¬
 
	m$offs™eok
 = 
Œue
;

61 
v¬
 
	m$maxäames
 = 0;

62 
v¬
 
	m$ex·ndlšks
 = 
Œue
;

65 
v¬
 
	m$·sscook›s
 = 
Œue
;

69 
v¬
 
	m$u£r
 = "";

70 
v¬
 
	m$·ss
 = "";

73 
v¬
 
	m$acû±
 = "image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, */*";

75 
v¬
 
	m$»suÉs
 = "";

77 
v¬
 
	m$”rÜ
 = "";

78 
v¬
 
	m$»¥Ú£_code
 = "";

79 
v¬
 
	m$h—d”s
 = 
¬¿y
();

80 
v¬
 
	m$maxËngth
 = 500000;

81 
v¬
 
	m$»ad_timeout
 = 0;

84 
v¬
 
	m$timed_out
 = 
çl£
;

85 
v¬
 
	m$¡©us
 = 0;

87 
v¬
 
	m$‹mp_dœ
 = "/tmp";

91 
v¬
 
	m$cu¾_·th
 = "/usr/local/bin/curl";

105 
v¬
 
	m$_maxlš–’
 = 4096;

107 
v¬
 
	m$_h‰pm‘hod
 = "GET";

108 
v¬
 
	m$_h‰pv”siÚ
 = "HTTP/1.0";

109 
v¬
 
	m$_subm™_m‘hod
 = "POST";

110 
v¬
 
	m$_subm™_ty³
 = "application/x-www-form-urlencoded";

111 
v¬
 
	m$_mime_bound¬y
 = "";

112 
v¬
 
	m$_»dœeùaddr
 = 
çl£
;

113 
v¬
 
	m$_»dœeùd•th
 = 0;

114 
v¬
 
	m$_äameu¾s
 = 
¬¿y
();

115 
v¬
 
	m$_äamed•th
 = 0;

117 
v¬
 
	m$_i¥roxy
 = 
çl£
;

118 
v¬
 
	m$_å_timeout
 = 30;

129 
funùiÚ
 
	$ãtch
(
$URI
)

133 
$URI_PARTS
 = 
	`·r£_u¾
(
$URI
);

134 ià(!
	`em±y
(
$URI_PARTS
["user"]))

135 
$this
->
u£r
 = 
$URI_PARTS
["user"];

136 ià(!
	`em±y
(
$URI_PARTS
["pass"]))

137 
$this
->
·ss
 = 
$URI_PARTS
["pass"];

138 ià(
	`em±y
(
$URI_PARTS
["query"]))

139 
$URI_PARTS
["query"] = '';

140 ià(
	`em±y
(
$URI_PARTS
["path"]))

141 
$URI_PARTS
["path"] = '';

143 
	`¡¹Şow”
(
$URI_PARTS
["scheme"]))

146 
$this
->
ho¡
 = 
$URI_PARTS
["host"];

147 if(!
	`em±y
(
$URI_PARTS
["port"]))

148 
$this
->
pÜt
 = 
$URI_PARTS
["port"];

149 if(
$this
->
	`_cÚÃù
(
$å
))

151 if(
$this
->
_i¥roxy
)

154 
$this
->
	`_h‰´eque¡
(
$URI
,
$å
,$URI,$this->
_h‰pm‘hod
);

158 
$·th
 = 
$URI_PARTS
["path"].($URI_PARTS["query"] ? "?".$URI_PARTS["query"] : "");

160 
$this
->
	`_h‰´eque¡
(
$·th
, 
$å
, 
$URI
, $this->
_h‰pm‘hod
);

163 
$this
->
	`_discÚÃù
(
$å
);

165 if(
$this
->
_»dœeùaddr
)

168 if(
$this
->
max»dœs
 > $this->
_»dœeùd•th
)

171 if(
	`´eg_m©ch
("|^h‰p://".
	`´eg_quÙe
(
$this
->
ho¡
)."|i",$this->
_»dœeùaddr
è|| $this->
offs™eok
)

174 
$this
->
_»dœeùd•th
++;

175 
$this
->
Ï¡»dœeùaddr
=$this->
_»dœeùaddr
;

176 
$this
->
	`ãtch
($this->
_»dœeùaddr
);

181 if(
$this
->
_äamed•th
 < $this->
maxäames
 && 
	`couÁ
($this->
_äameu¾s
) > 0)

183 
$äameu¾s
 = 
$this
->
_äameu¾s
;

184 
$this
->
_äameu¾s
 = 
	`¬¿y
();

186 
	`li¡
(,
$äameu¾
èğ
	`—ch
(
$äameu¾s
))

188 if(
$this
->
_äamed•th
 < $this->
maxäames
)

190 
$this
->
	`ãtch
(
$äameu¾
);

191 
$this
->
_äamed•th
++;

200  
çl£
;

202  
Œue
;

205 if(!
$this
->
cu¾_·th
)

206  
çl£
;

207 if(
	`funùiÚ_exi¡s
("is_executable"))

208 ià(!
	`is_execubË
(
$this
->
cu¾_·th
))

209  
çl£
;

210 
$this
->
ho¡
 = 
$URI_PARTS
["host"];

211 if(!
	`em±y
(
$URI_PARTS
["port"]))

212 
$this
->
pÜt
 = 
$URI_PARTS
["port"];

213 if(
$this
->
_i¥roxy
)

216 
$this
->
	`_h‰p¤eque¡
(
$URI
,$URI,$this->
_h‰pm‘hod
);

220 
$·th
 = 
$URI_PARTS
["path"].($URI_PARTS["query"] ? "?".$URI_PARTS["query"] : "");

222 
$this
->
	`_h‰p¤eque¡
(
$·th
, 
$URI
, $this->
_h‰pm‘hod
);

225 if(
$this
->
_»dœeùaddr
)

228 if(
$this
->
max»dœs
 > $this->
_»dœeùd•th
)

231 if(
	`´eg_m©ch
("|^h‰p://".
	`´eg_quÙe
(
$this
->
ho¡
)."|i",$this->
_»dœeùaddr
è|| $this->
offs™eok
)

234 
$this
->
_»dœeùd•th
++;

235 
$this
->
Ï¡»dœeùaddr
=$this->
_»dœeùaddr
;

236 
$this
->
	`ãtch
($this->
_»dœeùaddr
);

241 if(
$this
->
_äamed•th
 < $this->
maxäames
 && 
	`couÁ
($this->
_äameu¾s
) > 0)

243 
$äameu¾s
 = 
$this
->
_äameu¾s
;

244 
$this
->
_äameu¾s
 = 
	`¬¿y
();

246 
	`li¡
(,
$äameu¾
èğ
	`—ch
(
$äameu¾s
))

248 if(
$this
->
_äamed•th
 < $this->
maxäames
)

250 
$this
->
	`ãtch
(
$äameu¾
);

251 
$this
->
_äamed•th
++;

257  
Œue
;

261 
$this
->
”rÜ
 = 'Inv®id…rÙocŞ "'.
$URI_PARTS
["scheme"].'"\n';

262  
çl£
;

265  
Œue
;

279 
funùiÚ
 
	`subm™
(
$URI
, 
$fÜmv¬s
="", 
$fÜmfes
="")

281 
	`un£t
(
$po¡d©a
);

283 
$po¡d©a
 = 
$this
->
	`_´•¬e_po¡_body
(
$fÜmv¬s
, 
$fÜmfes
);

285 
$URI_PARTS
 = 
	`·r£_u¾
(
$URI
);

286 ià(!
	`em±y
(
$URI_PARTS
["user"]))

287 
$this
->
u£r
 = 
$URI_PARTS
["user"];

288 ià(!
	`em±y
(
$URI_PARTS
["pass"]))

289 
$this
->
·ss
 = 
$URI_PARTS
["pass"];

290 ià(
	`em±y
(
$URI_PARTS
["query"]))

291 
$URI_PARTS
["query"] = '';

292 ià(
	`em±y
(
$URI_PARTS
["path"]))

293 
$URI_PARTS
["path"] = '';

295 
	`¡¹Şow”
(
$URI_PARTS
["scheme"]))

298 
$this
->
ho¡
 = 
$URI_PARTS
["host"];

299 if(!
	`em±y
(
$URI_PARTS
["port"]))

300 
$this
->
pÜt
 = 
$URI_PARTS
["port"];

301 if(
$this
->
	`_cÚÃù
(
$å
))

303 if(
$this
->
_i¥roxy
)

306 
$this
->
	`_h‰´eque¡
(
$URI
,
$å
,$URI,$this->
_subm™_m‘hod
,$this->
_subm™_ty³
,
$po¡d©a
);

310 
$·th
 = 
$URI_PARTS
["path"].($URI_PARTS["query"] ? "?".$URI_PARTS["query"] : "");

312 
$this
->
	`_h‰´eque¡
(
$·th
, 
$å
, 
$URI
, $this->
_subm™_m‘hod
, $this->
_subm™_ty³
, 
$po¡d©a
);

315 
$this
->
	`_discÚÃù
(
$å
);

317 if(
$this
->
_»dœeùaddr
)

320 if(
$this
->
max»dœs
 > $this->
_»dœeùd•th
)

322 if(!
	`´eg_m©ch
("|^".
$URI_PARTS
["scheme"]."://|", 
$this
->
_»dœeùaddr
))

323 
$this
->
_»dœeùaddr
 = $this->
	`_ex·ndlšks
($this->_»dœeùaddr,
$URI_PARTS
["scheme"]."://".$URI_PARTS["host"]);

326 if(
	`´eg_m©ch
("|^h‰p://".
	`´eg_quÙe
(
$this
->
ho¡
)."|i",$this->
_»dœeùaddr
è|| $this->
offs™eok
)

329 
$this
->
_»dœeùd•th
++;

330 
$this
->
Ï¡»dœeùaddr
=$this->
_»dœeùaddr
;

331 ifĞ
	`¡½os
Ğ
$this
->
_»dœeùaddr
, "?" ) > 0 )

332 
$this
->
	`ãtch
($this->
_»dœeùaddr
);

334 
$this
->
	`subm™
($this->
_»dœeùaddr
,
$fÜmv¬s
, 
$fÜmfes
);

339 if(
$this
->
_äamed•th
 < $this->
maxäames
 && 
	`couÁ
($this->
_äameu¾s
) > 0)

341 
$äameu¾s
 = 
$this
->
_äameu¾s
;

342 
$this
->
_äameu¾s
 = 
	`¬¿y
();

344 
	`li¡
(,
$äameu¾
èğ
	`—ch
(
$äameu¾s
))

346 if(
$this
->
_äamed•th
 < $this->
maxäames
)

348 
$this
->
	`ãtch
(
$äameu¾
);

349 
$this
->
_äamed•th
++;

359  
çl£
;

361  
Œue
;

364 if(!
$this
->
cu¾_·th
)

365  
çl£
;

366 if(
	`funùiÚ_exi¡s
("is_executable"))

367 ià(!
	`is_execubË
(
$this
->
cu¾_·th
))

368  
çl£
;

369 
$this
->
ho¡
 = 
$URI_PARTS
["host"];

370 if(!
	`em±y
(
$URI_PARTS
["port"]))

371 
$this
->
pÜt
 = 
$URI_PARTS
["port"];

372 if(
$this
->
_i¥roxy
)

375 
$this
->
	`_h‰p¤eque¡
(
$URI
, $URI, $this->
_subm™_m‘hod
, $this->
_subm™_ty³
, 
$po¡d©a
);

379 
$·th
 = 
$URI_PARTS
["path"].($URI_PARTS["query"] ? "?".$URI_PARTS["query"] : "");

381 
$this
->
	`_h‰p¤eque¡
(
$·th
, 
$URI
, $this->
_subm™_m‘hod
, $this->
_subm™_ty³
, 
$po¡d©a
);

384 if(
$this
->
_»dœeùaddr
)

387 if(
$this
->
max»dœs
 > $this->
_»dœeùd•th
)

389 if(!
	`´eg_m©ch
("|^".
$URI_PARTS
["scheme"]."://|", 
$this
->
_»dœeùaddr
))

390 
$this
->
_»dœeùaddr
 = $this->
	`_ex·ndlšks
($this->_»dœeùaddr,
$URI_PARTS
["scheme"]."://".$URI_PARTS["host"]);

393 if(
	`´eg_m©ch
("|^h‰p://".
	`´eg_quÙe
(
$this
->
ho¡
)."|i",$this->
_»dœeùaddr
è|| $this->
offs™eok
)

396 
$this
->
_»dœeùd•th
++;

397 
$this
->
Ï¡»dœeùaddr
=$this->
_»dœeùaddr
;

398 ifĞ
	`¡½os
Ğ
$this
->
_»dœeùaddr
, "?" ) > 0 )

399 
$this
->
	`ãtch
($this->
_»dœeùaddr
);

401 
$this
->
	`subm™
($this->
_»dœeùaddr
,
$fÜmv¬s
, 
$fÜmfes
);

406 if(
$this
->
_äamed•th
 < $this->
maxäames
 && 
	`couÁ
($this->
_äameu¾s
) > 0)

408 
$äameu¾s
 = 
$this
->
_äameu¾s
;

409 
$this
->
_äameu¾s
 = 
	`¬¿y
();

411 
	`li¡
(,
$äameu¾
èğ
	`—ch
(
$äameu¾s
))

413 if(
$this
->
_äamed•th
 < $this->
maxäames
)

415 
$this
->
	`ãtch
(
$äameu¾
);

416 
$this
->
_äamed•th
++;

422  
Œue
;

427 
$this
->
”rÜ
 = 'Inv®id…rÙocŞ "'.
$URI_PARTS
["scheme"].'"\n';

428  
çl£
;

431  
Œue
;

432 
	}
}

441 
funùiÚ
 
	$ãtchlšks
(
$URI
)

443 ià(
$this
->
	`ãtch
(
$URI
))

445 if(
$this
->
Ï¡»dœeùaddr
)

446 
$URI
 = 
$this
->
Ï¡»dœeùaddr
;

447 if(
	`is_¬¿y
(
$this
->
»suÉs
))

449 
$x
=0;$x<
	`couÁ
(
$this
->
»suÉs
);$x++)

450 
$this
->
»suÉs
[
$x
] = $this->
	`_¡rlšks
($this->results[$x]);

453 
$this
->
»suÉs
 = $this->
	`_¡rlšks
($this->results);

455 if(
$this
->
ex·ndlšks
)

456 
$this
->
»suÉs
 = $this->
	`_ex·ndlšks
($this->»suÉs, 
$URI
);

457  
Œue
;

460  
çl£
;

461 
	}
}

470 
funùiÚ
 
	$ãtchfÜm
(
$URI
)

473 ià(
$this
->
	`ãtch
(
$URI
))

476 if(
	`is_¬¿y
(
$this
->
»suÉs
))

478 
$x
=0;$x<
	`couÁ
(
$this
->
»suÉs
);$x++)

479 
$this
->
»suÉs
[
$x
] = $this->
	`_¡rfÜm
($this->results[$x]);

482 
$this
->
»suÉs
 = $this->
	`_¡rfÜm
($this->results);

484  
Œue
;

487  
çl£
;

488 
	}
}

498 
funùiÚ
 
	$ãtch‹xt
(
$URI
)

500 if(
$this
->
	`ãtch
(
$URI
))

502 if(
	`is_¬¿y
(
$this
->
»suÉs
))

504 
$x
=0;$x<
	`couÁ
(
$this
->
»suÉs
);$x++)

505 
$this
->
»suÉs
[
$x
] = $this->
	`_¡r‹xt
($this->results[$x]);

508 
$this
->
»suÉs
 = $this->
	`_¡r‹xt
($this->results);

509  
Œue
;

512  
çl£
;

513 
	}
}

522 
funùiÚ
 
subm™lšks
(
$URI
, 
$fÜmv¬s
="", 
$fÜmfes
="")

524 if(
$this
->
subm™
(
$URI
,
$fÜmv¬s
, 
$fÜmfes
))

526 if(
$this
->
Ï¡»dœeùaddr
)

527 
$URI
 = 
$this
->
Ï¡»dœeùaddr
;

528 if(
is_¬¿y
(
$this
->
»suÉs
))

530 
	g$x
=0;$x<
couÁ
(
$this
->
»suÉs
);$x++)

532 
	g$this
->
	g»suÉs
[
$x
] = 
$this
->
_¡rlšks
($this->
»suÉs
[$x]);

533 if(
	g$this
->
	gex·ndlšks
)

534 
	g$this
->
	g»suÉs
[
$x
] = 
$this
->
_ex·ndlšks
($this->
»suÉs
[$x],
$URI
);

539 
	g$this
->
	g»suÉs
 = 
$this
->
_¡rlšks
($this->
»suÉs
);

540 if(
	g$this
->
	gex·ndlšks
)

541 
	g$this
->
	g»suÉs
 = 
$this
->
_ex·ndlšks
($this->
»suÉs
,
$URI
);

543  
	gŒue
;

546  
	gçl£
;

556 
funùiÚ
 
subm™‹xt
(
$URI
, 
$fÜmv¬s
 = "", 
$fÜmfes
 = "")

558 if(
$this
->
subm™
(
$URI
,
$fÜmv¬s
, 
$fÜmfes
))

560 if(
$this
->
Ï¡»dœeùaddr
)

561 
$URI
 = 
$this
->
Ï¡»dœeùaddr
;

562 if(
is_¬¿y
(
$this
->
»suÉs
))

564 
	g$x
=0;$x<
couÁ
(
$this
->
»suÉs
);$x++)

566 
	g$this
->
	g»suÉs
[
$x
] = 
$this
->
_¡r‹xt
($this->
»suÉs
[$x]);

567 if(
	g$this
->
	gex·ndlšks
)

568 
	g$this
->
	g»suÉs
[
$x
] = 
$this
->
_ex·ndlšks
($this->
»suÉs
[$x],
$URI
);

573 
	g$this
->
	g»suÉs
 = 
$this
->
_¡r‹xt
($this->
»suÉs
);

574 if(
	g$this
->
	gex·ndlšks
)

575 
	g$this
->
	g»suÉs
 = 
$this
->
_ex·ndlšks
($this->
»suÉs
,
$URI
);

577  
	gŒue
;

580  
	gçl£
;

590 
funùiÚ
 
	$£t_subm™_muÉ¬t
()

592 
$this
->
_subm™_ty³
 = "multipart/form-data";

593 
	}
}

601 
funùiÚ
 
	$£t_subm™_nÜm®
()

603 
$this
->
_subm™_ty³
 = "application/x-www-form-urlencoded";

604 
	}
}

621 
funùiÚ
 
	$_¡rlšks
(
$docum’t
)

623 
	`´eg_m©ch_®l
("'<\s*a\s.*?href\s*=\s* # find <a href=

625 (?(1è(.*?)\\1 | ([^\
s
\>]+)è#ià
quÙe
 
found
, 
m©ch
 
up
 
to
 
Ãxt
 
m©chšg


626 #quÙe, 
Ùh”wi£
 
m©ch
 
up
 
to
 
Ãxt
 
¥aû


632 
	`li¡
(
$key
,
$v®
èğ
	`—ch
(
$lšks
[2]))

634 if(!
	`em±y
(
$v®
))

635 
$m©ch
[] = 
$v®
;

638 
	`li¡
(
$key
,
$v®
èğ
	`—ch
(
$lšks
[3]))

640 if(!
	`em±y
(
$v®
))

641 
$m©ch
[] = 
$v®
;

645  
$m©ch
;

646 
	}
}

655 
funùiÚ
 
	$_¡rfÜm
(
$docum’t
)

657 
	`´eg_m©ch_®l
("'<\/?(FORM|INPUT|SELECT|TEXTAREA|(OPTION))[^<>]*>(?(2)(.*(?=<\/?(İtiÚ|£Ëù)[^<>]*>[\r\n]*)|(?=[\r\n]*))|(?=[\r\n]*))'Usi",
$docum’t
,
$–em’ts
);

660 
$m©ch
 = 
	`im¶ode
("\r\n",
$–em’ts
[0]);

663  
$m©ch
;

664 
	}
}

675 
funùiÚ
 
	$_¡r‹xt
(
$docum’t
)

682 
$£¬ch
 = 
	`¬¿y
("'<script[^>]*?>.*?</script>'si",

706 
$»¶aû
 = 
	`¬¿y
( "",

714 
	`chr
(161),

715 
	`chr
(162),

716 
	`chr
(163),

717 
	`chr
(169),

718 
	`chr
(174),

719 
	`chr
(176),

720 
	`chr
(39),

721 
	`chr
(128),

731 
$‹xt
 = 
	`´eg_»¶aû
(
$£¬ch
,
$»¶aû
,
$docum’t
);

733  
$‹xt
;

734 
	}
}

744 
funùiÚ
 
	$_ex·ndlšks
(
$lšks
,
$URI
)

747 
	`´eg_m©ch
("/^[^\?]+/",
$URI
,
$m©ch
);

749 
$m©ch
 = 
	`´eg_»¶aû
("|/[^\/\.]+\.[^\/\.]+$|","",$match[0]);

750 
$m©ch
 = 
	`´eg_»¶aû
("|/$|","",$match);

751 
$m©ch_·¹
 = 
	`·r£_u¾
(
$m©ch
);

752 
$m©ch_roÙ
 =

753 
$m©ch_·¹
["scheme"]."://".$match_part["host"];

755 
$£¬ch
 = 
	`¬¿y
Ğ"|^h‰p://".
	`´eg_quÙe
(
$this
->
ho¡
)."|i",

762 
$»¶aû
 = 
	`¬¿y
( "",

763 
$m©ch_roÙ
."/",

764 
$m©ch
."/",

769 
$ex·ndedLšks
 = 
	`´eg_»¶aû
(
$£¬ch
,
$»¶aû
,
$lšks
);

771  
$ex·ndedLšks
;

772 
	}
}

784 
funùiÚ
 
_h‰´eque¡
(
$u¾
,
$å
,
$URI
,
$h‰p_m‘hod
,
$cÚ‹Á_ty³
="",
$body
="")

786 
$cook›_h—d”s
 = '';

787 if(
	g$this
->
	g·sscook›s
 && $this->
	g_»dœeùaddr
)

788 
	g$this
->
£tcook›s
();

790 
	g$URI_PARTS
 = 
·r£_u¾
(
$URI
);

791 if(
em±y
(
$u¾
))

792 
	g$u¾
 = "/";

793 
	g$h—d”s
 = 
$h‰p_m‘hod
." ".
$u¾
." ".
$this
->
_h‰pv”siÚ
."\r\n";

794 if(!
em±y
(
$this
->
ag’t
))

795 
	g$h—d”s
 .ğ"U£r-Ag’t: ".
$this
->
ag’t
."\r\n";

796 if(!
em±y
(
$this
->
ho¡
è&& !
is£t
($this->
¿wh—d”s
['Host'])) {

797 
	g$h—d”s
 .ğ"Ho¡: ".
$this
->
ho¡
;

798 if(!
em±y
(
$this
->
pÜt
))

799 
	g$h—d”s
 .ğ":".
$this
->
pÜt
;

800 
	g$h—d”s
 .= "\r\n";

802 if(!
em±y
(
$this
->
acû±
))

803 
	g$h—d”s
 .ğ"Acû±: ".
$this
->
acû±
."\r\n";

804 if(!
em±y
(
$this
->
»ã»r
))

805 
	g$h—d”s
 .ğ"Reã»r: ".
$this
->
»ã»r
."\r\n";

806 if(!
em±y
(
$this
->
cook›s
))

808 if(!
is_¬¿y
(
$this
->
cook›s
))

809 
	g$this
->
	gcook›s
 = (
¬¿y
)
$this
->
cook›s
;

811 
»£t
(
$this
->
cook›s
);

812 iàĞ
couÁ
(
$this
->
cook›s
) > 0 ) {

813 
	g$cook›_h—d”s
 .= 'Cookie: ';

814 
fÜ—ch
 ( 
$this
->
cook›s
 
as
 
$cook›Key
 => 
$cook›V®
 ) {

815 
$cook›_h—d”s
 .ğ
$cook›Key
."=".
u¾’code
(
$cook›V®
)."; ";

817 
	g$h—d”s
 .ğ
sub¡r
(
$cook›_h—d”s
,0,-2) . "\r\n";

820 if(!
em±y
(
$this
->
¿wh—d”s
))

822 if(!
is_¬¿y
(
$this
->
¿wh—d”s
))

823 
	g$this
->
	g¿wh—d”s
 = (
¬¿y
)
$this
->
¿wh—d”s
;

824 
li¡
(
$h—d”Key
,
$h—d”V®
èğ
—ch
(
$this
->
¿wh—d”s
))

825 
$h—d”s
 .ğ
$h—d”Key
.": ".
$h—d”V®
."\r\n";

827 if(!
em±y
(
$cÚ‹Á_ty³
)) {

828 
	g$h—d”s
 .= "Content-type: $content_type";

829 ià(
	g$cÚ‹Á_ty³
 == "multipart/form-data")

830 
$h—d”s
 .ğ"; bound¬y=".
$this
->
_mime_bound¬y
;

831 
	g$h—d”s
 .= "\r\n";

833 if(!
em±y
(
$body
))

834 
	g$h—d”s
 .ğ"CÚ‹Á-Ëngth: ".
¡¾’
(
$body
)."\r\n";

835 if(!
em±y
(
$this
->
u£r
è|| !em±y($this->
·ss
))

836 
	g$h—d”s
 .ğ"AuthÜiz©iÚ: Basiø".
ba£64_’code
(
$this
->
u£r
.":".$this->
·ss
)."\r\n";

839 if(!
em±y
(
$this
->
´oxy_u£r
))

840 
	g$h—d”s
 .ğ'Proxy-AuthÜiz©iÚ: ' . 'Basiø' . 
ba£64_’code
(
$this
->
´oxy_u£r
 . ':' . $this->
´oxy_·ss
)."\r\n";

843 
	g$h—d”s
 .= "\r\n";

846 ià(
	g$this
->
	g»ad_timeout
 > 0)

847 
sock‘_£t_timeout
(
$å
, 
$this
->
»ad_timeout
);

848 
	g$this
->
	gtimed_out
 = 
çl£
;

850 
fwr™e
(
$å
,
$h—d”s
.
$body
,
¡¾’
($headers.$body));

852 
	g$this
->
	g_»dœeùaddr
 = 
çl£
;

853 
un£t
(
$this
->
h—d”s
);

855 
	g$cu¼’tH—d”
 = 
fg‘s
(
$å
,
$this
->
_maxlš–’
))

857 ià(
	g$this
->
	g»ad_timeout
 > 0 && $this->
_check_timeout
(
$å
))

859 
	g$this
->
	g¡©us
=-100;

860  
	gçl£
;

863 if(
	g$cu¼’tH—d”
 == "\r\n")

867 if(
´eg_m©ch
("/^(LoÿtiÚ:|URI:)/i",
$cu¼’tH—d”
))

870 
´eg_m©ch
("/^(LoÿtiÚ:|URI:)[ ]+(.*)/i",
chİ
(
$cu¼’tH—d”
),
$m©ches
);

872 if(!
´eg_m©ch
("|\:\/\/|",
$m©ches
[2]))

875 
	g$this
->
	g_»dœeùaddr
 = 
$URI_PARTS
["scheme"]."://".
$this
->
ho¡
.":".$this->
pÜt
;

877 if(!
´eg_m©ch
("|^/|",
$m©ches
[2]))

878 
	g$this
->
	g_»dœeùaddr
 .ğ"/".
$m©ches
[2];

880 
	g$this
->
	g_»dœeùaddr
 .ğ
$m©ches
[2];

883 
	g$this
->
	g_»dœeùaddr
 = 
$m©ches
[2];

886 if(
´eg_m©ch
("|^HTTP/|",
$cu¼’tH—d”
))

888 if(
´eg_m©ch
("|^HTTP/[^\s]*\s(.*?)\s|",
$cu¼’tH—d”
, 
$¡©us
))

890 
	g$this
->
	g¡©us
ğ
$¡©us
[1];

892 
	g$this
->
	g»¥Ú£_code
 = 
$cu¼’tH—d”
;

895 
	g$this
->
	gh—d”s
[] = 
$cu¼’tH—d”
;

898 
	g$»suÉs
 = '';

900 
	g$_d©a
 = 
ä—d
(
$å
, 
$this
->
maxËngth
);

901 ià(
¡¾’
(
$_d©a
) == 0) {

904 
	g$»suÉs
 .ğ
$_d©a
;

905 } 
	gŒue
);

907 ià(
	g$this
->
	g»ad_timeout
 > 0 && $this->
_check_timeout
(
$å
))

909 
	g$this
->
	g¡©us
=-100;

910  
	gçl£
;

915 if(
´eg_m©ch
("'<m‘a[\s]*h‰p-equiv[^>]*?cÚ‹Á[\s]*=[\s]*[\"\']?\d+;[\s]*URL[\s]*=[\s]*([^\"\']*?)[\"\']?>'i",
$»suÉs
,
$m©ch
))

918 
	g$this
->
	g_»dœeùaddr
 = 
$this
->
_ex·ndlšks
(
$m©ch
[1],
$URI
);

922 if((
	g$this
->
	g_äamed•th
 < $this->
	gmaxäames
è&& 
´eg_m©ch_®l
("'<äame\s+.*¤c[\s]*=[\'\"]?([^\'\"\>]+)'i",
$»suÉs
,
$m©ch
))

924 
	g$this
->
	g»suÉs
[] = 
$»suÉs
;

925 
	g$x
=0; $x<
couÁ
(
$m©ch
[1]); $x++)

926 
	g$this
->
	g_äameu¾s
[] = 
$this
->
_ex·ndlšks
(
$m©ch
[1][
$x
],
$URI_PARTS
["scheme"]."://".$this->
ho¡
);

929 
–£if
(
is_¬¿y
(
$this
->
»suÉs
))

930 
	g$this
->
	g»suÉs
[] = 
$»suÉs
;

933 
	g$this
->
	g»suÉs
 = 
$»suÉs
;

935  
	gŒue
;

947 
funùiÚ
 
_h‰p¤eque¡
(
$u¾
,
$URI
,
$h‰p_m‘hod
,
$cÚ‹Á_ty³
="",
$body
="")

949 if(
$this
->
·sscook›s
 && $this->
_»dœeùaddr
)

950 
$this
->
£tcook›s
();

952 
	g$h—d”s
 = 
¬¿y
();

954 
	g$URI_PARTS
 = 
·r£_u¾
(
$URI
);

955 if(
em±y
(
$u¾
))

956 
	g$u¾
 = "/";

959 if(!
em±y
(
$this
->
ag’t
))

960 
	g$h—d”s
[] = "U£r-Ag’t: ".
$this
->
ag’t
;

961 if(!
em±y
(
$this
->
ho¡
))

962 if(!
em±y
(
$this
->
pÜt
))

963 
	g$h—d”s
[] = "Ho¡: ".
$this
->
ho¡
.":".$this->
pÜt
;

965 
	g$h—d”s
[] = "Ho¡: ".
$this
->
ho¡
;

966 if(!
em±y
(
$this
->
acû±
))

967 
	g$h—d”s
[] = "Acû±: ".
$this
->
acû±
;

968 if(!
em±y
(
$this
->
»ã»r
))

969 
	g$h—d”s
[] = "Reã»r: ".
$this
->
»ã»r
;

970 if(!
em±y
(
$this
->
cook›s
))

972 if(!
is_¬¿y
(
$this
->
cook›s
))

973 
	g$this
->
	gcook›s
 = (
¬¿y
)
$this
->
cook›s
;

975 
»£t
(
$this
->
cook›s
);

976 iàĞ
couÁ
(
$this
->
cook›s
) > 0 ) {

977 
	g$cook›_¡r
 = 'Cookie: ';

978 
fÜ—ch
 ( 
$this
->
cook›s
 
as
 
$cook›Key
 => 
$cook›V®
 ) {

979 
$cook›_¡r
 .ğ
$cook›Key
."=".
u¾’code
(
$cook›V®
)."; ";

981 
	g$h—d”s
[] = 
sub¡r
(
$cook›_¡r
,0,-2);

984 if(!
em±y
(
$this
->
¿wh—d”s
))

986 if(!
is_¬¿y
(
$this
->
¿wh—d”s
))

987 
	g$this
->
	g¿wh—d”s
 = (
¬¿y
)
$this
->
¿wh—d”s
;

988 
li¡
(
$h—d”Key
,
$h—d”V®
èğ
—ch
(
$this
->
¿wh—d”s
))

989 
$h—d”s
[] = 
$h—d”Key
.": ".
$h—d”V®
;

991 if(!
em±y
(
$cÚ‹Á_ty³
)) {

992 ià(
	g$cÚ‹Á_ty³
 == "multipart/form-data")

993 
$h—d”s
[] = "CÚ‹Á-ty³: $cÚ‹Á_ty³; bound¬y=".
$this
->
_mime_bound¬y
;

995 
	g$h—d”s
[] = "Content-type: $content_type";

997 if(!
em±y
(
$body
))

998 
	g$h—d”s
[] = "CÚ‹Á-Ëngth: ".
¡¾’
(
$body
);

999 if(!
em±y
(
$this
->
u£r
è|| !em±y($this->
·ss
))

1000 
	g$h—d”s
[] = "AuthÜiz©iÚ: BASIC ".
ba£64_’code
(
$this
->
u£r
.":".$this->
·ss
);

1002 
	g$cu¼_h—d”
 = 0; $cu¼_h—d” < 
couÁ
(
$h—d”s
); $curr_header++) {

1003 
	g$§ãr_h—d”
 = 
¡¹r
Ğ
$h—d”s
[
$cu¼_h—d”
], "\"", " " );

1004 
	g$cmdlše_·¿ms
 .ğ" -H \"".
$§ãr_h—d”
."\"";

1007 if(!
em±y
(
$body
))

1008 
	g$cmdlše_·¿ms
 .= " -d \"$body\"";

1010 if(
	g$this
->
	g»ad_timeout
 > 0)

1011 
	g$cmdlše_·¿ms
 .ğ" -m ".
$this
->
»ad_timeout
;

1013 
	g$h—d”fe
 = 
‹m²am
(
$‹mp_dœ
, "sno");

1015 
	g$§ãr_URI
 = 
¡¹r
Ğ
$URI
, "\"", " " );

1016 
exec
(
$this
->
cu¾_·th
." -D \"$h—d”fe\"".
$cmdlše_·¿ms
." \"".
$§ãr_URI
."\"",
$»suÉs
,
$»tuº
);

1018 if(
	g$»tuº
)

1020 
	g$this
->
	g”rÜ
 = "Error: cURL could‚ot„etrievehe document,ƒrror $return.";

1021  
	gçl£
;

1025 
	g$»suÉs
 = 
im¶ode
("\r\n",
$»suÉs
);

1027 
	g$»suÉ_h—d”s
 = 
fe
("$headerfile");

1029 
	g$this
->
	g_»dœeùaddr
 = 
çl£
;

1030 
un£t
(
$this
->
h—d”s
);

1032 
	g$cu¼’tH—d”
 = 0; $cu¼’tH—d” < 
couÁ
(
$»suÉ_h—d”s
); $currentHeader++)

1036 if(
´eg_m©ch
("/^(LoÿtiÚ: |URI: )/i",
$»suÉ_h—d”s
[
$cu¼’tH—d”
]))

1039 
´eg_m©ch
("/^(LoÿtiÚ: |URI:)\s+(.*)/",
chİ
(
$»suÉ_h—d”s
[
$cu¼’tH—d”
]),
$m©ches
);

1041 if(!
´eg_m©ch
("|\:\/\/|",
$m©ches
[2]))

1044 
	g$this
->
	g_»dœeùaddr
 = 
$URI_PARTS
["scheme"]."://".
$this
->
ho¡
.":".$this->
pÜt
;

1046 if(!
´eg_m©ch
("|^/|",
$m©ches
[2]))

1047 
	g$this
->
	g_»dœeùaddr
 .ğ"/".
$m©ches
[2];

1049 
	g$this
->
	g_»dœeùaddr
 .ğ
$m©ches
[2];

1052 
	g$this
->
	g_»dœeùaddr
 = 
$m©ches
[2];

1055 if(
´eg_m©ch
("|^HTTP/|",
$»suÉ_h—d”s
[
$cu¼’tH—d”
]))

1056 
	g$this
->
	g»¥Ú£_code
 = 
$»suÉ_h—d”s
[
$cu¼’tH—d”
];

1058 
	g$this
->
	gh—d”s
[] = 
$»suÉ_h—d”s
[
$cu¼’tH—d”
];

1063 if(
´eg_m©ch
("'<m‘a[\s]*h‰p-equiv[^>]*?cÚ‹Á[\s]*=[\s]*[\"\']?\d+;[\s]*URL[\s]*=[\s]*([^\"\']*?)[\"\']?>'i",
$»suÉs
,
$m©ch
))

1065 
	g$this
->
	g_»dœeùaddr
 = 
$this
->
_ex·ndlšks
(
$m©ch
[1],
$URI
);

1069 if((
	g$this
->
	g_äamed•th
 < $this->
	gmaxäames
è&& 
´eg_m©ch_®l
("'<äame\s+.*¤c[\s]*=[\'\"]?([^\'\"\>]+)'i",
$»suÉs
,
$m©ch
))

1071 
	g$this
->
	g»suÉs
[] = 
$»suÉs
;

1072 
	g$x
=0; $x<
couÁ
(
$m©ch
[1]); $x++)

1073 
	g$this
->
	g_äameu¾s
[] = 
$this
->
_ex·ndlšks
(
$m©ch
[1][
$x
],
$URI_PARTS
["scheme"]."://".$this->
ho¡
);

1076 
–£if
(
is_¬¿y
(
$this
->
»suÉs
))

1077 
	g$this
->
	g»suÉs
[] = 
$»suÉs
;

1080 
	g$this
->
	g»suÉs
 = 
$»suÉs
;

1082 
uÆšk
("$headerfile");

1084  
	gŒue
;

1092 
funùiÚ
 
	$£tcook›s
()

1094 
$x
=0; $x<
	`couÁ
(
$this
->
h—d”s
); $x++)

1096 if(
	`´eg_m©ch
('/^£t-cook›:[\s]+([^=]+)=([^;]+)/i', 
$this
->
h—d”s
[
$x
],
$m©ch
))

1097 
$this
->
cook›s
[
$m©ch
[1]] = 
	`u¾decode
($match[2]);

1099 
	}
}

1108 
funùiÚ
 
	$_check_timeout
(
$å
)

1110 ià(
$this
->
»ad_timeout
 > 0) {

1111 
$å_¡©us
 = 
	`sock‘_g‘_¡©us
(
$å
);

1112 ià(
$å_¡©us
["timed_out"]) {

1113 
$this
->
timed_out
 = 
Œue
;

1114  
Œue
;

1117  
çl£
;

1118 
	}
}

1126 
funùiÚ
 
	$_cÚÃù
(&
$å
)

1128 if(!
	`em±y
(
$this
->
´oxy_ho¡
è&& !em±y($this->
´oxy_pÜt
))

1130 
$this
->
_i¥roxy
 = 
Œue
;

1132 
$ho¡
 = 
$this
->
´oxy_ho¡
;

1133 
$pÜt
 = 
$this
->
´oxy_pÜt
;

1137 
$ho¡
 = 
$this
->
ho¡
;

1138 
$pÜt
 = 
$this
->
pÜt
;

1141 
$this
->
¡©us
 = 0;

1143 if(
$å
 = 
	`fsockİ’
(

1144 
$ho¡
,

1145 
$pÜt
,

1146 
$”ºo
,

1147 
$”r¡r
,

1148 
$this
->
_å_timeout


1153  
Œue
;

1158 
$this
->
¡©us
 = 
$”ºo
;

1159 
$”ºo
)

1162 
$this
->
”rÜ
="socket creation failed (-3)";

1164 
$this
->
”rÜ
="dns†ookup failure (-4)";

1166 
$this
->
”rÜ
="connection„efused orimed out (-5)";

1168 
$this
->
”rÜ
="cÚÃùiÚ faed (".
$”ºo
.")";

1170  
çl£
;

1172 
	}
}

1179 
funùiÚ
 
	$_discÚÃù
(
$å
)

1181 (
	`fşo£
(
$å
));

1182 
	}
}

1193 
funùiÚ
 
	$_´•¬e_po¡_body
(
$fÜmv¬s
, 
$fÜmfes
)

1195 
	`£‰y³
(
$fÜmv¬s
, "array");

1196 
	`£‰y³
(
$fÜmfes
, "array");

1197 
$po¡d©a
 = '';

1199 ià(
	`couÁ
(
$fÜmv¬s
è=ğ0 && couÁ(
$fÜmfes
) == 0)

1202 
$this
->
_subm™_ty³
) {

1204 
	`»£t
(
$fÜmv¬s
);

1205 
	`li¡
(
$key
,
$v®
èğ
	`—ch
(
$fÜmv¬s
)) {

1206 ià(
	`is_¬¿y
(
$v®
è|| 
	`is_objeù
($val)) {

1207 
	`li¡
(
$cur_key
, 
$cur_v®
èğ
	`—ch
(
$v®
)) {

1208 
$po¡d©a
 .ğ
	`u¾’code
(
$key
)."[]=".u¾’code(
$cur_v®
)."&";

1211 
$po¡d©a
 .ğ
	`u¾’code
(
$key
)."=".u¾’code(
$v®
)."&";

1216 
$this
->
_mime_bound¬y
 = "Snoİy".
	`md5
(
	`uniqid
(
	`miüÙime
()));

1218 
	`»£t
(
$fÜmv¬s
);

1219 
	`li¡
(
$key
,
$v®
èğ
	`—ch
(
$fÜmv¬s
)) {

1220 ià(
	`is_¬¿y
(
$v®
è|| 
	`is_objeù
($val)) {

1221 
	`li¡
(
$cur_key
, 
$cur_v®
èğ
	`—ch
(
$v®
)) {

1222 
$po¡d©a
 .ğ"--".
$this
->
_mime_bound¬y
."\r\n";

1223 
$po¡d©a
 .= "Content-Disposition: form-data;‚ame=\"$key\[\]\"\r\n\r\n";

1224 
$po¡d©a
 .= "$cur_val\r\n";

1227 
$po¡d©a
 .ğ"--".
$this
->
_mime_bound¬y
."\r\n";

1228 
$po¡d©a
 .= "Content-Disposition: form-data;‚ame=\"$key\"\r\n\r\n";

1229 
$po¡d©a
 .= "$val\r\n";

1233 
	`»£t
(
$fÜmfes
);

1234 
	`li¡
(
$f›ld_Çme
, 
$fe_Çmes
èğ
	`—ch
(
$fÜmfes
)) {

1235 
	`£‰y³
(
$fe_Çmes
, "array");

1236 
	`li¡
(, 
$fe_Çme
èğ
	`—ch
(
$fe_Çmes
)) {

1237 ià(!
	`is_»adabË
(
$fe_Çme
)) ;

1239 
$å
 = 
	`fİ’
(
$fe_Çme
, "r");

1240 
$fe_cÚ‹Á
 = 
	`ä—d
(
$å
, 
	`fesize
(
$fe_Çme
));

1241 
	`fşo£
(
$å
);

1242 
$ba£_Çme
 = 
	`ba£Çme
(
$fe_Çme
);

1244 
$po¡d©a
 .ğ"--".
$this
->
_mime_bound¬y
."\r\n";

1245 
$po¡d©a
 .= "Content-Disposition: form-data;‚ame=\"$field_name\"; filename=\"$base_name\"\r\n\r\n";

1246 
$po¡d©a
 .= "$file_content\r\n";

1249 
$po¡d©a
 .ğ"--".
$this
->
_mime_bound¬y
."--\r\n";

1253  
$po¡d©a
;

1254 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/TemplateEngine.php

1 <?
php


2 şas 
	cTem¶©eEngše
{

4 
public
 
funùiÚ
 
	$»¶aû_ruË
(
$row
,
$d©a
){

6 
$row
 = 
$this
->
	`»¶aû_nÙes
($row,
$d©a
);

8 
$row
 = 
$this
->
	`»¶aû_v¬ŸbËs
($row,
$d©a
);

10 
$row
 = 
$this
->
	`»¶aû_fÜ—ch
($row,
$d©a
);

12 
$row
 = 
$this
->
	`»¶aû_fÜ—chs
($row,
$d©a
);

14 
$row
 = 
$this
->
	`»¶aû_šşude
($row,
$d©a
);

16 
$row
 = 
$this
->
	`»¶aû_if
($row,
$d©a
);

18 
$row
 = 
$this
->
	`»¶aû_v¬ŸbËs
($row,
$d©a
);

19  
$row
;

23 
public
 
funùiÚ
 
	$»¶aû_v¬ŸbËs
(
$row
,
$d©a
){

25 
$zz
 = "/{#([^#]*)#}/iUs";

26 
	`´eg_m©ch_®l
(
$zz
,
$row
,
$¬r
);

29 
	`fÜ—ch
 (
$¬r
[1] 
as
 
$key
=>
$v®ue
){

30 ià(
	`is£t
(
$d©a
[
$v®ue
])){

31 
$row
 = 
	`¡r_»¶aû
(
$¬r
[0][
$key
],
$d©a
[
$v®ue
],$row);

34 
$»suÉ
 = 
$this
->
	`»¶aû_¬r
(
$v®ue
,
$d©a
);

35 
$row
 = 
	`¡r_»¶aû
(
$¬r
[0][
$key
],
$»suÉ
,$row);

38  
$row
;

39 
	}
}

42 
public
 
funùiÚ
 
	$»¶aû_¬r
(
$row
,
$d©a
){

43 
$zz2
 = "/{#[^#\s\/\|]*#}/iUs";

44 
	`´eg_m©ch_®l
(
$zz2
,"{#".
$row
."#}",
$¬r2
);

45 if(
	`is£t
(
$¬r2
[0][0])){

46 
$row_¬r
 = 
	`ex¶ode
(".",
$row
);

47 if(
	`couÁ
(
$row_¬r
)>1){

48 
	`couÁ
(
$row_¬r
)){

50 if(
	`is£t
(
$d©a
[
$row_¬r
[0]][$row_arr[1]])){

51 
$row
 = 
	`¡r_»¶aû
($row,
$d©a
[
$row_¬r
[0]][$row_arr[1]],$row);

55 if(
	`is£t
(
$d©a
[
$row_¬r
[0]][$row_arr[1]][$row_arr[2]])){

56 
$row
 = 
	`¡r_»¶aû
($row,
$d©a
[
$row_¬r
[0]][$row_arr[1]][$row_arr[2]],$row);

60 if(
	`is£t
(
$d©a
[
$row_¬r
[0]][$row_arr[1]][$row_arr[2]][$row_arr[3]])){

61 
$row
 = 
	`¡r_»¶aû
($row,
$d©a
[
$row_¬r
[0]][$row_arr[1]][$row_arr[2]][$row_arr[3]],$row);

65 
echo
 
	`couÁ
(
$v®ue_¬r
)."æ•°ç»„å±‚æ¬¡è¿‡é«˜ï¼æ²¡å†™ï¼";
ex™
;

68 
$row
 = "{#".$row."#}";

70  
$row
;

73  "{#".
$row
."#}";

76 
	}
}

79 
public
 
funùiÚ
 
	$»¶aû_šşude
(
$row
,
$d©a
){

80 
$zz
="/{#include ([^#]*)#}/iUs";

81 
	`´eg_m©ch_®l
(
$zz
,
$row
,
$¬r
);

82 
	`fÜ—ch
 (
$¬r
[1] 
as
 
$k
=>
$v
){

83 
$®l
 = 
$¬r
[0][
$k
];

84 
$u¾
 = 
$¬r
[1][
$k
];

85 
$‹m¶©e_u¾
='­¶iÿtiÚ/‹m¶©e/'.
$u¾
;

88 
$Ä
 = 
	`fe_g‘_cÚ‹Ás
(
$‹m¶©e_u¾
);

90 
$Ä
 = 
$this
->
	`»¶aû_v¬ŸbËs
($Ä,
$d©a
);

92 
$row
 = 
	`¡r_»¶aû
(
$®l
,
$Ä
,$row);

95  
$row
;

96 
	}
}

99 
public
 
funùiÚ
 
	$g‘_äom_¬r
(
$row
,
$d©a
){

100 
$row_¬r
 = 
	`ex¶ode
(".",
$row
);

101 
$row_d©a
=
$d©a
;

102 
	`fÜ—ch
 (
$row_¬r
 
as
 
$k
=>
$v
){

103 ià(
	`is£t
(
$row_d©a
[
$v
])){

104 
$row_d©a
=$row_d©a[
$v
];

106 
$row_d©a
="";

109  
$row_d©a
;

110 
	}
}

143 
public
 
funùiÚ
 
	$»¶aû_fÜ—ch
(
$row
,
$d©a
){

145 
$zz
 = "/{#foreach ([^#]*)#}(.+){#\/foreach#}/iUs";

146 
	`´eg_m©ch_®l
(
$zz
,
$row
,
$¬r
);

149 
	`fÜ—ch
 (
$¬r
[1] 
as
 
$key
=>
$v®ue
){

151 
$p
 = 
	`ex¶ode
(" ",
$v®ue
);

153 
	`fÜ—ch
 (
$p
 
as
 
$p_k
=>
$p_v
){

154 
$p_k_v
 = 
	`ex¶ode
("=",
$p_v
);

156 
$·¿m‘”s
[
$p_k_v
[0]] = $p_k_v[1];

159 
$äom
 = 
$·¿m‘”s
['from'];

161 
$äomd©a
 = 
$this
->
	`g‘_äom_¬r
(
$äom
,
$d©a
);

163 
$™em
 = 
$·¿m‘”s
['item'];

164 
$p_key
 = 
$·¿m‘”s
['key'];

165 
$cÚ‹Á
 = 
$¬r
[2][
$key
];

166 
$cÚ‹Á_®l
="";

169 
	`fÜ—ch
 (
$äomd©a
 
as
 
$f_k
=>
$f_v
){

171 
$cc
 = 
$this
->
	`»¶aû_fÜ—ch_th
(
$cÚ‹Á
,
$äomd©a
[
$f_k
],
$™em
,
$d©a
);

174 
$cc
 = 
	`¡r_»¶aû
("{#".
$p_key
."#}",
$f_k
,$cc);

175 
$cÚ‹Á_®l
 .ğ
$cc
;

178 
$row
 = 
	`¡r_»¶aû
(
$¬r
[0][
$key
],
$cÚ‹Á_®l
,$row);

181  
$row
;

182 
	}
}

185 
public
 
funùiÚ
 
	$»¶aû_fÜ—ch_th
(
$row
,
$äomd©a
,
$™em
,
$d©a
){

187 
$cÚ‹Á_zz
 = "/{#".
$™em
."\|([^#]*)#}/iUs";

188 
	`´eg_m©ch_®l
(
$cÚ‹Á_zz
,
$row
,
$Ëe_¬r
);

191 
	`fÜ—ch
 (
$Ëe_¬r
[1] 
as
 
$Ï_k
=>
$Ï_v
){

192 ià(
	`is£t
(
$äomd©a
[
$Ï_v
])){

193 
$row
 = 
	`¡r_»¶aû
(
$Ëe_¬r
[0][
$Ï_k
],
$äomd©a
[
$Ï_v
],$row);

197 
$»suÉ
 = 
$this
->
	`»¶aû_¬r
(
$Ï_v
,
$äomd©a
);

200 
$row
 = 
	`¡r_»¶aû
(
$Ëe_¬r
[0][
$Ï_k
],
$»suÉ
,$row);

205 
$šşude_zz
="/{#include ([^#]*)#}/iUs";

206 
	`´eg_m©ch_®l
(
$šşude_zz
,
$row
,
$šşude_¬r
);

207 if(
	`is£t
(
$šşude_¬r
[0][0])){

209 
$row
 = 
$this
->
	`»¶aû_šşude
($row,
$d©a
);

211 
$row
 = 
$this
->
	`»¶aû_fÜ—ch_th
($row,
$äomd©a
,
$™em
,
$d©a
);

213  
$row
;

214 
	}
}

217 
public
 
funùiÚ
 
	$»¶aû_if
(
$row
,
$d©a
){

219 
$zz
 = "/({#if ([^#]*)#})(.+)({#\/if#})/iUs";

220 
	`´eg_m©ch_®l
(
$zz
,
$row
,
$¬r
);

223 
	`fÜ—ch
 (
$¬r
[0] 
as
 
$k
=>
$v
){

225 
$®l
 = 
$¬r
[0][
$k
];

226 
$¡¬t
 = 
$¬r
[1][
$k
];

227 
$tj
 = 
$¬r
[2][
$k
];

228 
$Ä
 = 
$¬r
[3][
$k
];

229 
$’d
 = 
$¬r
[4][
$k
];

232 
$is_–£
 = 
	`¡r¡r
(
$Ä
,"{#else#}");

233 if(
$is_–£
){

235 
$Ì_Ä
 = 
	`ex¶ode
("{#–£#}",
$Ä
);

236 
$Ì_v®
 = 
	`ex¶ode
("==",
$tj
);

237 ià(
$Ì_v®
[0]==$lr_val[1]){

238 
$v
 = 
	`¡r_»¶aû
(
$¡¬t
,"",$v);

239 
$v
 = 
	`¡r_»¶aû
(
$’d
,"",$v);

240 
$v
 = 
	`¡r_»¶aû
(
$Ì_Ä
[1],"",$v);

241 
$v
 = 
	`¡r_»¶aû
('{#else#}',"",$v);

243 
$v
 = 
	`¡r_»¶aû
(
$¡¬t
,"",$v);

244 
$v
 = 
	`¡r_»¶aû
(
$’d
,"",$v);

245 
$v
 = 
	`¡r_»¶aû
(
$Ì_Ä
[0],"",$v);

246 
$v
 = 
	`¡r_»¶aû
('{#else#}',"",$v);

250 
$Ì_v®
 = 
	`ex¶ode
("==",
$tj
);

251 ià(
$Ì_v®
[0]==$lr_val[1]){

252 
$v
 = 
	`¡r_»¶aû
(
$¡¬t
,"",$v);

253 
$v
 = 
	`¡r_»¶aû
(
$’d
,"",$v);

255 
$v
 = 
	`¡r_»¶aû
(
$®l
,"",$v);

260 
$row
 = 
	`¡r_»¶aû
(
$®l
,
$v
,$row);

264  
$row
;

265 
	}
}

268 
public
 
funùiÚ
 
	$»¶aû_nÙes
(
$row
,
$d©a
){

269 
$zz
 = "/\/\/\*(.+)\*\/\//iUs";

270 
	`´eg_m©ch_®l
(
$zz
,
$row
,
$¬r
);

271 
	`fÜ—ch
 (
$¬r
[1] 
as
 
$key
=>
$v®ue
){

272 
$row
 = 
	`¡r_»¶aû
(
$¬r
[0][
$key
],"",$row);

274  
$row
;

275 
	}
}

278 
public
 
funùiÚ
 
	$Ëe_cs
(
$row
){

279 
echo
 
$this
->
lßd
->
	`v›w
('admš/Ïyouts/h—d','',
Œue
);

280 
echo
 
$row
;

281 
echo
 
$this
->
lßd
->
	`v›w
('admš/Ïyouts/bÙtom','',
Œue
);

282 
	}
}

286 
public
 
funùiÚ
 
	$»¶aû_fÜ—chs
(
$row
,
$d©a
,
$i
=0){

287 
$i
++;

289 
$zz
 = "/{#fÜ—ch".
$i
." ([^#]*)#}(.+){#\/foreach".$i."#}/iUs";

290 
	`´eg_m©ch_®l
(
$zz
,
$row
,
$¬r
);

293 
$äomd©a
="";

294 
	`fÜ—ch
 (
$¬r
[1] 
as
 
$key
=>
$v®ue
){

296 
$p
 = 
	`ex¶ode
(" ",
$v®ue
);

298 
	`fÜ—ch
 (
$p
 
as
 
$p_k
=>
$p_v
){

299 
$p_k_v
 = 
	`ex¶ode
("=",
$p_v
);

301 
$·¿m‘”s
[
$p_k_v
[0]] = $p_k_v[1];

304 
$äom
 = 
$·¿m‘”s
['from'];

306 
$äomd©a
 = 
$this
->
	`g‘_äom_¬r
(
$äom
,
$d©a
);

307 
$™em
 = 
$·¿m‘”s
['item'];

308 
$p_key
 = 
$·¿m‘”s
['key'];

309 
$cÚ‹Á
 = 
$¬r
[2][
$key
];

310 
$cÚ‹Á_®l
="";

311 if(
$äomd©a
!=""){

314 
	`fÜ—ch
 (
$äomd©a
 
as
 
$f_k
=>
$f_v
){

316 
$cc
 = 
$this
->
	`»¶aû_fÜ—ch_th
(
$cÚ‹Á
,
$äomd©a
[
$f_k
],
$™em
,
$d©a
);

319 
$cc
 = 
	`¡r_»¶aû
("{#".
$p_key
."#}",
$f_k
,$cc);

321 if(!
	`is_¬¿y
(
$f_v
)){

322 
$cc
 = 
	`¡r_»¶aû
("{#".
$™em
."#}",
$f_v
,$cc);

324 if(
$i
<=3){

325 
$d©a
=
$f_v
;

326 
$cc
 = 
$this
->
	`»¶aû_fÜ—chs
($cc,
$d©a
,
$i
);

328 
$cÚ‹Á_®l
 .ğ
$cc
;

331 
$row
 = 
	`¡r_»¶aû
(
$¬r
[0][
$key
],
$cÚ‹Á_®l
,$row);

335 
$row
 = 
	`¡r_»¶aû
(
$¬r
[0][
$key
],"",$row);

339  
$row
;

340 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/oauth.php

1 <?
php


2 
šşude
("oauth/response.php");

3 
šşude
("oauth/request.php");

5 şas 
	cßuth2
{

6 
´Ùeùed
 
	m$tok’_ty³
 = 'Bearer';

8 
´iv©e
 
	m$__»que¡
;

9 
´iv©e
 
	m$__»¥Ú£
;

10 
´iv©e
 
	m$__cÚfig
;

14 
funùiÚ
 
	$__cÚ¡ruù
(
$cÚfig
){

15 
$this
->
key
 = 
$cÚfig
['key'];

16 
$this
->
£ü‘
 = 
$cÚfig
['secret'];

17 
$this
->
s™e
 = 
$cÚfig
['site'];

18 
$this
->
ßuth
 = 
$cÚfig
['oauth'];

19 
$this
->
__cÚfig
 = 
$cÚfig
;

22 
public
 
funùiÚ
 
	$g‘_tok’
(
$code
)

24 
$u¾
 = "{$this->oauth}/token";

25 
$d©a
 = 
	`¬¿y
(

27 'code' => 
$code
,

29 'ş›Á_id'=>
$this
->
key
,

30 'ş›Á_£ü‘'=>
$this
->
£ü‘
,

32 
$this
->
	`»que¡
()->
	`g‘_šfo
(
$u¾
, 
$d©a
);

33 
$·¿ms
 = 
$this
->
	`»que¡
()->
	`·r£d
();

35 
$tok’
 = 
$·¿ms
['access_token'];

36 
	`un£t
(
$·¿ms
['expires_in'], $params['token_type'], $params['access_token']);

38 
$this
->
tok’
 = 
$tok’
;

39  
	`¬¿y
('tok’'=>
$tok’
, '·¿ms'=>
$·¿ms
);

40 
	}
}

42 
public
 
funùiÚ
 
	$authÜize_u¾
(
$ÿÎback
){

43 
$d©a
 = 
	`¬¿y
(

45 'ş›Á_id' => 
$this
->
key
,

46 '»dœeù_uri'=>
$ÿÎback
,

48 
$qu”y
 = 
	`h‰p_bud_qu”y
(
$d©a
);

49 
$u¾
 = "{$this->oauth}/authorize?{$query}";

50  
$u¾
;

51 
	}
}

53 
public
 
funùiÚ
 
	$logout_u¾
(
$ÿÎback
)

55 
$d©a
 = 
	`¬¿y
(

56 '»dœeù_uri'=>
$ÿÎback
,

58 
$qu”y
 = 
	`h‰p_bud_qu”y
(
$d©a
);

59 
$u¾
 = "{$this->oauth}/logout?{$query}";

60  
$u¾
;

62 
	}
}

64 
public
 
funùiÚ
 
	$»que¡
(
$tok’
=
nuÎ
)

66 ià(!
$this
->
__»que¡
)

67 
$this
->
__»que¡
 = 
Ãw
 
	`ßuth2_»que¡
($this->
__cÚfig
, 
$tok’
);

69  
$this
->
__»que¡
;

70 
	}
}

72 
public
 
funùiÚ
 
	$»¥Ú£
()

74 ià(!
$this
->
__»¥Ú£
)

75 
$this
->
__»¥Ú£
 = 
Ãw
 
	`ßuth2_»¥Ú£
($this->
__cÚfig
);

76  
$this
->
__»¥Ú£
;

77 
	}
}

79 
public
 
funùiÚ
 
	$v”ify_­i_·¿ms
()

81 
$¬r_g‘
 = 
$_GET
;

82 
$¬r_po¡
 = 
$_POST
;

83 
$sign
 = 
$¬r_g‘
['sign'];

84 
$¬r_g‘
 = $arr_get['sign'];

87 #´št_r(
$_GET
);

88 #´št_r(
$_POST
);

89  
Œue
;

90 
	}
}

92 
public
 
funùiÚ
 
sign
(
$aùiÚ
, 
$u¾
, 
$d©a
=
¬¿y
(), 
$sigÁime
=
nuÎ
)

94 
$·r£_u¾
 = 
·r£_u¾
(
$u¾
);

95 
	g$·th
 = 
$·r£_u¾
['path'];

96 
	g$g‘_d©a
['sign_method'] = 'md5';

97 
	g$g‘_d©a
['sign_time'] = 
$sigÁime
 ? $sigÁim: 
time
();

98 
	g$g‘_d©a
['ş›Á_id'] = 
$this
->
key
;

99 
	g$po¡_d©a
 = 
$h—d”_d©a
 = 
¬¿y
();

100 if(
¡¹Şow”
(
$aùiÚ
)=='get') {

101 
$g‘_d©a
 = 
¬¿y_m”ge
(
$d©a
, $get_data);

103 
	g$po¡_d©a
 = 
$d©a
;

105 
	g$g‘_d©a
 = 
$this
->
ksÜt
(
$g‘_d©a
);

106 
	g$po¡_d©a
 = 
$this
->
ksÜt
(
$po¡_d©a
);

108 
	g$g‘_·¿ms
 = 
¿wu¾’code
(
u¾decode
(
h‰p_bud_qu”y
(
$g‘_d©a
)));

109 
	g$po¡_·¿ms
 = 
¿wu¾’code
(
u¾decode
(
h‰p_bud_qu”y
(
$po¡_d©a
)));

110 
	g$h—d”_·¿ms
 = 
¿wu¾’code
(
u¾decode
(
h‰p_bud_qu”y
(
$h—d”_d©a
)));

112 #$g‘_·¿m ğ
$po¡_·¿ms
 = 
$h—d”_·¿ms
 = 
nuÎ
;

113 #fÜ—ch(
¬¿y
('g‘_·¿ms' =>
$g‘_d©a
, 'po¡_·¿ms'=>
$po¡_d©a
è
as
 
$key
 => 
$v®
){

114 #$$key = 
$this
->
bud_qu”y
(
$v®
);

116 #$g‘_·¿m ğ
¿wu¾’code
(
Érim
(
$g‘_·¿ms
, '&'));

117 #$po¡_·¿m ğ
¿wu¾’code
(
Érim
(
$po¡_·¿ms
, '&'));

118 #$h—d”_·¿m ğ
¿wu¾’code
(
Érim
(
$h—d”_·¿ms
, '&'));

121 
	g$·th
 = 
¿wu¾’code
('/'.
Érim
(
$·th
, '/'));

123 #$ÜgsigÀğ"{$this->£ü‘}&".
¡¹ouµ”
(
$aùiÚ
)."&{$path}&{$get_params}&{$this->secret}";

124 
	g$Ügsign
 = "{$this->£ü‘}&".
¡¹ouµ”
(
$aùiÚ
)."&{$path}&{$header_params}&{$get_params}&{$post_params}&{$this->secret}";

126 #echØ
$Ügsign
,"<HR>";

128 
	g$sign
 = 
¡¹ouµ”
(
md5
(
$Ügsign
));

129 #echØ
$sign
;
ex™
;

131 #echØ"\r\n", 
$Ügsign
, "\r\n", 
$sign
, "\r\n";

133 
	g$g‘_d©a
['sign'] = 
$sign
;

134  
	g$g‘_d©a
;

138 
´iv©e
 
funùiÚ
 
bud_qu”y
(
$row
, 
$´e
=
nuÎ
)

140 
$r
 = 
nuÎ
;

141 
fÜ—ch
(
$row
 
as
 
$k
 => 
$v
) {

142 if(
is_¬¿y
(
$v
)){

143 
$r
 .ğ'&'. 
$this
->
bud_qu”y
(
$v
, (
$´e
 ? "{$´e}[$k]" : 
$k
));

145 
	g$r
 .ğ'&'. (
$´e
 ? "{$´e}[{$k}]" : 
$k
è. "=" .
$v
;

148  
	g$r
;

151 
´iv©e
 
funùiÚ
 
ksÜt
(
$d©a
)

153 
ksÜt
(
$d©a
);

154 
fÜ—ch
(
$d©a
 
as
 
$key
 => &
$v®
){

155 ià(
is_¬¿y
(
$v®
)) {

156 
$v®
 = 
$this
->
ksÜt
($val);

159  
	g$d©a
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/oauth/request.php

1 ï»¿<?
php


3 şas 
	cßuth2_»que¡
 
ex‹nds
 
	mßuth2
 {

4 
´iv©e
 
	m$__tok’
;

5 
´iv©e
 
	m$__»¥Ú£_hash
;

6 
´iv©e
 
	m$__»¥Ú£
;

8 
v¬
 
	m$deçuÉ_h—d”s
 = 
¬¿y
(

13 
v¬
 
	m$h‰p_v”
 = '1.1';

14 
v¬
 
	m$timeout
 = 10;

18 
funùiÚ
 
	$__cÚ¡ruù
(
$cÚfig
, 
$tok’
){

19 
·»Á
::
	`__cÚ¡ruù
(
$cÚfig
);

20 
$this
->
__tok’
 = 
$tok’
;

23 
public
 
funùiÚ
 
	$g‘_šfo
(
$­i
, 
$·¿ms
)

25 
$·¿ms
["Authorization"] = "{$this->token_type} {$this->__token}";

26 
$r
 = 
$this
->
	`aùiÚ
('po¡', 
$­i
, 
nuÎ
,‚uÎ, 
$·¿ms
);

27  
$r
->
__»¥Ú£
;

28 
	}
}

30 
public
 
funùiÚ
 
po¡
(
$­i
, 
$·¿ms
=
¬¿y
(), 
$sigÁime
=
nuÎ
)

32 
$u¾
 = "{$this->site}/{$api}";

33  
	g$this
->
aùiÚ
('po¡', "{$u¾}", 
nuÎ
,‚uÎ, 
$·¿ms
, 
$sigÁime
);

36 
public
 
funùiÚ
 
put
(
$­i
, 
$·¿ms
=
¬¿y
(), 
$sigÁime
=
nuÎ
)

38 
$u¾
 = "{$this->site}/{$api}";

39  
	g$this
->
aùiÚ
('put', "{$u¾}", 
nuÎ
,‚uÎ, 
$·¿ms
, 
$sigÁime
);

42 
public
 
funùiÚ
 
g‘
(
$­i
, 
$·¿ms
=
¬¿y
(), 
$sigÁime
=
nuÎ
)

44 
$u¾
 = "{$this->site}/{$api}";

45  
	g$this
->
aùiÚ
('g‘', "{$u¾}", 
nuÎ
,‚uÎ, 
$·¿ms
, 
$sigÁime
);

48 
public
 
funùiÚ
 
	$·r£d
()

50 
$this
->
	`__»¥Ú£_to_hash
();

51  
$this
->
__»¥Ú£_hash
;

52 
	}
}

54 
public
 
funùiÚ
 
	$sucûss
()

56 
$r
 = 
$this
->
	`·r£d
();

57 if(
	`is£t
(
$r
['status']))

58  
$r
['status']=='success';

60  
çl£
;

61 
	}
}

63 
public
 
funùiÚ
 
	$ç
()

65 
$r
 = 
$this
->
	`·r£d
();

66 if(
	`is£t
(
$r
['status']))

67  
$r
['status']=='error';

69  
çl£
;

70 
	}
}

72 
´iv©e
 
funùiÚ
 
	$__»¥Ú£_to_hash
()

74 
$this
->
__»¥Ú£_hash
 = 
	`jsÚ_decode
($this->
__»¥Ú£
, 
Œue
);

75 
	}
}

77 
´iv©e
 
funùiÚ
 
	$aùiÚ
(
$aùiÚ
,
$u¾
,
$h—d”s
=
nuÎ
,
$ÿÎback
òuÎ,
$d©a
òuÎ, 
$sigÁime
=null)

79 
$»s
 = 
$this
->
	`__aùiÚ
(
$aùiÚ
, 
$u¾
, 
$h—d”s
, 
$ÿÎback
, 
$d©a
, 
$sigÁime
);

80 
$this
->
__»¥Ú£
 = 
$»s
;

81  
$this
;

82 
	}
}

84 
´iv©e
 
funùiÚ
 
	$__aùiÚ
(
$aùiÚ
,
$u¾
,
$h—d”s
=
nuÎ
,
$ÿÎback
òuÎ,
$d©a
òuÎ, 
$sigÁime
=null)

86 
$sign_d©a
 = 
$this
->
	`sign
(
$aùiÚ
, 
$u¾
, 
$d©a
, 
$sigÁime
);

88 
$h—d”s
 = 
	`¬¿y_m”ge
(
$this
->
deçuÉ_h—d”s
,(
¬¿y
)$headers);

90 
$£t_h—d”s
 = 
	`¬¿y
();

91 
	`fÜ—ch
((
¬¿y
)
$h—d”s
 
as
 
$k
=>
$v
){

92 
$£t_h—d”s
[] .ğ
$k
.': '.
$v
;

94 
$£t_h—d”s
[] = 'Acû±: '. 
$aùiÚ
;

96 
$this
->
»¥Ú£Body
 = '';

98 
$ch
 = 
	`cu¾_š™
();

100 
$u¾
 = 
	`¹rim
($u¾, '&'è. (
	`¡½os
($u¾, '?')===
çl£
 ? '?' : '&'). 
	`h‰p_bud_qu”y
(
$sign_d©a
);

101 #echØ
$u¾
, "<HR>";

102 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_URL
, 
$u¾
);

105 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_HEADER
, 0);

106 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_RETURNTRANSFER
, 0);

107 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_TIMEOUT
, 
$this
->
timeout
);

108 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_HEADERFUNCTION
, 
	`¬¿y
(
$this
,'callback_header'));

109 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_WRITEFUNCTION
, 
	`¬¿y
(
$this
,'callback_body'));

110 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_HTTPHEADER
, 
$£t_h—d”s
);

111 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_HTTP_VERSION
, 
$this
->
h‰p_v”
);

113 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_SSL_VERIFYPEER
, 
çl£
);

115 
	`¡¹ouµ”
(
$aùiÚ
)){

117 
$this
->
	`__aùiÚ_g‘
(
$ch
, 
$u¾
, 
$d©a
);

120 
$this
->
	`__aùiÚ_po¡
(
$ch
, 
$u¾
, 
$d©a
);

123 
$this
->
	`__aùiÚ_put
(
$ch
, 
$u¾
, 
$d©a
);

126 
	`cu¾_şo£
(
$ch
);

133 
	`´eg_m©ch
('/\d{3}/',
$this
->
»¥Ú£H—d”
,
$m©ch
);

134 
$this
->
»¥Ú£Code
 = 
$m©ch
[0];

135 
$this
->
»¥Ú£Code
){

138  
çl£
;

141  
$this
->
»¥Ú£Body
;

144  
çl£
;

147  
çl£
;

149 
	}
}

151 
´iv©e
 
funùiÚ
 
	$__aùiÚ_g‘
(
$ch
, 
$u¾
, 
$d©a
)

153 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_POST
, 
çl£
);

154 
	`cu¾_exec
(
$ch
);

155 
	}
}

157 
´iv©e
 
funùiÚ
 
	$__aùiÚ_po¡
(
$ch
, 
$u¾
, 
$d©a
)

159 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_POST
, 
Œue
);

160 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_POSTFIELDS
, 
	`h‰p_bud_qu”y
(
$d©a
));

161 
	`cu¾_exec
(
$ch
);

162 
	}
}

164 
´iv©e
 
funùiÚ
 
	$__aùiÚ_put
(
$ch
, 
$u¾
, 
$d©a
)

166 
$qu”y
 = 
	`h‰p_bud_qu”y
(
$d©a
);

167 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_POSTFIELDS
, 
$qu”y
);

168 
$fh
 = 
	`fİ’
('php://memory', 'rw');

169 
	`fwr™e
(
$fh
, 
$qu”y
);

170 
	`»wšd
(
$fh
);

172 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_INFILE
, 
$fh
);

173 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_INFILESIZE
, 
	`¡¾’
(
$qu”y
));

174 
	`cu¾_£tİt
(
$ch
, 
CURLOPT_PUT
, 
Œue
);

175 
	`cu¾_exec
(
$ch
);

177 
	`fşo£
(
$fh
);

178 
	}
}

180 
funùiÚ
 
	$ÿÎback_h—d”
(
$cu¾
,
$h—d”
){

181 
$this
->
»¥Ú£H—d”
 .ğ
$h—d”
;

182  
	`¡¾’
(
$h—d”
);

183 
	}
}

184 
funùiÚ
 
	$ÿÎback_body
(
$cu¾
,
$cÚ‹Á
){

185 
$this
->
»¥Ú£Body
 .ğ
$cÚ‹Á
;

186  
	`¡¾’
(
$cÚ‹Á
);

187 
	}
}

189 
funùiÚ
 
	$¿wu¾’code_·th
(
$·th
){

190 
$d©a
 = 
	`ex¶ode
("/", 
$·th
);

191 
	`fÜ—ch
(
$d©a
 
AS
 
$k
=>
$v
){

192 
$d©a
[
$k
] = 
	`¿wu¾’code
(
$v
);

194  
	`još
("/", 
$d©a
);

195 
	}
}

197 
funùiÚ
 
	$¿w_h‰p_bud_qu”y
(
$·¿ms
){

198 
$¬r
 = 
	`¬¿y
();

199 
	`fÜ—ch
(
$·¿ms
 
AS
 
$key
=>
$v®
){

200 
$¬r
[] = 
	`¿wu¾’code
(
$key
è. "=" .„awu¾’code(
$v®
);

202  
	`još
("&", 
$¬r
);

203 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/oauth/response.php

1 <?
php


3 şas 
	cßuth2_»¥Ú£
 
ex‹nds
 
	mßuth2
 {

5 
funùiÚ
 
	$__cÚ¡ruù
(
$cÚfig
){

6 #·»Á::
	`__cÚ¡ruù
(
$cÚfig
);

9 
public
 
funùiÚ
 
	$sucûss
(
$d©a
)

11 
$r
 = 
	`¬¿y
(

13 'd©a' => 
$d©a
,

15  
	`jsÚ_’code
(
$r
);

16 
	}
}

18 
public
 
funùiÚ
 
	$ç
(
$code
, 
$d©a
)

20 
$r
 = 
	`¬¿y
(

22 'code' => 
$code
,

23 'd©a' => 
$d©a
,

25  
	`jsÚ_’code
(
$r
);

26 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/attr_model.php

1 <?
php


6 şas 
	cA‰r_mod–
 
ex‹nds
 
	mCI_Mod–
 {

8 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

9 
·»Á
 :: 
	`__cÚ¡ruù
();

10 
$this
->
lßd
->
	`mod–
('admin/enum_model', 'enum');

20 
public
 
funùiÚ
 
	$objeù_©Œ
(
$OrgID
, 
$ObjName
, 
$isBoŞQu”y
 = 
çl£
) {

21 
$£Ëù
 = 
	`¬¿y
(

45 
$wh”e
["dd_©Œibu‹.Üg_id"] = 
$OrgID
;

46 ià(!
	`em±y
(
$ObjName
)) {

47 
$wh”e
["dd_©Œibu‹.obj_Çme"] = 
$ObjName
;

49 ià(
$isBoŞQu”y
) {

50 
$wh”e
['dd_attribute.attr_type !='] = 18;

52 
$this
->
db
->
	`äom
("dd_attribute");

53 
$this
->
db
->
	`još
("dd_dict_str", "dd_dict_str.dict_name = dd_attribute.attr_name‡nd dd_dict_str.ORG_ID = $OrgID‡nd dd_dict_str.LANG_ID = 2", "inner");

54 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

55 
$this
->
db
->
	`wh”e
(
$wh”e
);

56 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

58 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

59 
$d©a_¬r
[
$v
['ATTR_NAME']]['tbl_name'] = $v['TBL_NAME'];

60 
$d©a_¬r
[
$v
['ATTR_NAME']]['fld_name'] = $v['FLD_NAME'];

61 
$d©a_¬r
[
$v
['ATTR_NAME']]['attr_type'] = $v['ATTR_TYPE'];

62 
$d©a_¬r
[
$v
['ATTR_NAME']]['attr_cn_name'] = $v['FLD_NAME'];

63 
$d©a_¬r
[
$v
['ATTR_NAME']]['is_ref_obj'] = $v['IS_REF_OBJ'];

64 
$d©a_¬r
[
$v
['ATTR_NAME']]['ref_obj_name'] = $v['REF_OBJ_NAME'];

65 
$d©a_¬r
[
$v
['ATTR_NAME']]['lee_is_query'] = $v['LEE_IS_QUERY'];

67 
$d©a_¬r
[
$v
['ATTR_NAME']]['is_must'] = $v['IS_MUST'];

68 
$d©a_¬r
[
$v
['ATTR_NAME']]['is_disp_list'] = $v['IS_DISP_LIST'];

69 
$d©a_¬r
[
$v
['ATTR_NAME']]['is_disp_view'] = $v['Is_DISP_VIEW'];

70 
$d©a_¬r
[
$v
['ATTR_NAME']]['is_hidden'] = $v['IS_HIDDEN'];

71 
$d©a_¬r
[
$v
['ATTR_NAME']]['disp_order'] = $v['DISP_ORDER'];

72 
$d©a_¬r
[
$v
['ATTR_NAME']]['refer_to'] = $v['REFER_TO'];

73 
$d©a_¬r
[
$v
['ATTR_NAME']]['is_unique'] = $v['IS_UNIQUE'];

74 ià(
$v
['IS_READONLY'] =ğ1 
Ü
 $v['IS_USER_EDITABLE'] == 0) {

75 
$d©a_¬r
[
$v
['ATTR_NAME']]['notedit'] = 1;

77 
$d©a_¬r
[
$v
['ATTR_NAME']]['notedit'] = 0;

80 ià(
$v
['IS_REF_OBJ'] == 1) {

81 
$d©a_¬r
[
$v
['ATTR_NAME']]['referred_by'] = $v['REFERRED_BY'];

82 
$d©a_¬r
[
$v
['ATTR_NAME']]['ref_obj_name'] = $v['REF_OBJ_NAME'];

84 
$d©a_¬r
[
$v
['ATTR_NAME']]['label'] = $v['LABEL'];

85 
$d©a_¬r
[
$v
['ATTR_NAME']]['is_history'] = $v['IS_HISTORY'];

86 
$d©a_¬r
[
$v
['ATTR_NAME']]['lee_calc_formula'] = $v['LEE_CALC_FORMULA'];

87 
$d©a_¬r
[
$v
['ATTR_NAME']]['lee_is_calc_point'] = $v['LEE_IS_CALC_POINT'];

88 
$d©a_¬r
[
$v
['ATTR_NAME']]['lee_calc_result_attr'] = $v['LEE_CALC_RESULT_ATTR'];

90  
$d©a_¬r
;

91 
	}
}

97 
public
 
funùiÚ
 
	$R–A‰rRŞe
(
$Üg_id
, 
$u£r_id
){

98 
$this
->
db
->
	`£Ëù
('rar.control,rar.attr_name');

99 
$this
->
db
->
	`äom
('rel_attribute_role„ar');

100 
$this
->
db
->
	`još
('rel_role_user„ru','rru.role_id =„ar.role_id‡nd„ru.org_id =„ar.org_id','inner');

101 
$wh”e
 = 
	`¬¿y
('¿r.Üg_id' => 
$Üg_id
,'¼u.u£r_id'=>
$u£r_id
);

102 
$d©a
 = 
$this
->
db
->
	`wh”e
(
$wh”e
)->
	`g‘
()->
	`»suÉ_¬¿y
();

104  
$d©a
;

105 
	}
}

113 
public
 
funùiÚ
 
	$objeù_©Œ_di¡nù
(
$ObjName
) {

114 
$this
->
db
->
	`£Ëù
("distinct„ef_obj_name");

115 
$this
->
db
->
	`wh”e
("obj_Çme", 
$ObjName
);

116 
$this
->
db
->
	`äom
("dd_attribute");

117 
$dis_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

118  
$dis_d©a
;

119 
	}
}

124 
public
 
funùiÚ
 
	$Çme2æd
(
$Üg_id
,
$Çme
,
$obj_Çme
){

125 
$this
->
db
->
	`£Ëù
("fld_name");

126 
$this
->
db
->
	`äom
("dd_attribute");

127 
$this
->
db
->
	`wh”e
('©Œ_Çme',
$Çme
);

128 
$this
->
db
->
	`wh”e
('Üg_id',
$Üg_id
);

129 
$this
->
db
->
	`wh”e
('obj_Çme',
$obj_Çme
);

130 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

131  
$d©a
[0]['FLD_NAME'];

132 
	}
}

141 
public
 
funùiÚ
 
	$G‘S’iÜQu”yA‰r
(
$OrgID
, 
$ObjName
, 
$LªgID
 = 2) {

142 
$£Ëù
 = 
	`¬¿y
(

149 
$wh”e
["dd_©Œibu‹.Üg_id"] = 
$OrgID
;

150 
$wh”e
["dd_©Œibu‹.obj_Çme"] = 
$ObjName
;

151 
$wh”e
["dd_attribute.attr_type !="] = '18';

152 
$this
->
db
->
	`äom
("dd_attribute");

153 
$this
->
db
->
	`još
("dd_dict_str", "dd_dict_str.dict_name = dd_attribute.attr_name‡nd dd_dict_str.ORG_ID = $OrgID‡nd dd_dict_str.LANG_ID = $LangID", "inner");

154 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

155 
$this
->
db
->
	`wh”e
(
$wh”e
);

156 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

158 
$d©a_¬r
 = 
	`¬¿y
();

159 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

160 
$d©a_¬r
[
$v
['ATTR_NAME']]['attr_type'] = $v['ATTR_TYPE'];

161 
$d©a_¬r
[
$v
['ATTR_NAME']]['is_ref_obj'] = $v['IS_REF_OBJ'];

164 
$v
['ATTR_TYPE']) {

166 ià(
$v
['IS_REF_OBJ'] == 1) {

176 ià(
$v
['ENUM_ATTR_NAME'] == "") {

177 
$d©a_¬r
[
$v
['ATTR_NAME']]['’um_¬r'] = 
$this
->->
	`G‘EnumA¼
(
$OrgID
, $v['ATTR_NAME'], 
$LªgID
);

179 
$d©a_¬r
[
$v
['ATTR_NAME']]['’um_¬r'] = 
$this
->->
	`G‘EnumA¼
(
$OrgID
, $v['ENUM_ATTR_NAME'], 
$LªgID
);

186 
$d©a_¬r
[
$v
['ATTR_NAME']]['label'] = $v['LABEL'];

188  
	`jsÚ_’code
(
$d©a_¬r
);

191 
	}
}

198 
public
 
funùiÚ
 
	$S–eùOÃ
(
$A‰rB—n
) {

199 
	`exŒaù
(
$A‰rB—n
, 
EXTR_OVERWRITE
);

200 
$£Ëù
 = 
	`em±y
($select) ? "*" : $select;

201 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

202 ià(!
	`em±y
(
$wh”e
)) {

203 
$this
->
db
->
	`wh”e
(
$wh”e
);

205 
$this
->
db
->
	`äom
("dd_attribute");

206 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

208 ià(
	`em±y
(
$d©a
)) {

209  
$d©a
;

211  
$d©a
[0];

213 
	}
}

220 
public
 
funùiÚ
 
	$Und”lšeToPošt
(
$¬r
) {

221 ià(!Ğ
	`is_¬¿y
(
$¬r
è&& 
	`couÁ
($arr) != 0 )) {

222  
çl£
;

225 
$po¡
 = 
	`¬¿y
();

226 
	`fÜ—ch
 (
$¬r
 
as
 
$key
 => 
$v®ue
) {

227 ià(
$this
->
	`Und”lšeCouÁ
(
$key
, "_")) {

228 
$key
 = 
	`´eg_»¶aû
('/_/', ".", $key, 1);

230 
$po¡
[
$key
] = 
$v®ue
;

233  
$po¡
;

234 
	}
}

241 
public
 
funùiÚ
 
	$Und”lšeCouÁ
(
$¡r
, 
$fšd
) {

242 
	`´eg_m©ch_®l
('/' . 
$fšd
 . '/', 
$¡r
, 
$m©ches
);

243 ià(
$m©ches
[0] > 0) {

244  
Œue
;

246  
çl£
;

248 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/customer_model.php

1 <?
php


3 şas 
	cCu¡om”_mod–
 
ex‹nds
 
	mCI_Mod–
 {

5 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

6 
·»Á
 :: 
	`__cÚ¡ruù
();

9 
public
 
funùiÚ
 
	$g‘F›lds
(){

10  
	`¬¿y
(

35 
	}
}

37 
public
 
funùiÚ
 
	$g‘Info
(){

38 
$f›lds
 = 
	`im¶ode
(',', 
$this
->
	`g‘F›lds
());

39 
$»t
 = 
$this
->
db
->
	`qu”y
("£Ëù {$f›lds} from ord”PÏcšgM“tšg.u£¸Üd” by uid desc")->
	`»suÉ_¬¿y
();

40  
$»t
;

41 
	}
}

43 
public
 
funùiÚ
 
	$d–‘e
(
$d©a
){

44 
$id
 = 
$d©a
['uid'];

45 
	`un£t
(
$d©a
['oper']);

46 
	`un£t
(
$d©a
['uid']);

47 
$id
 = 
$d©a
["id"];

48 
$sql
 = "delete from orderPlacingMeeting.user where uid = {$id}";

49 
$»t
 = 
$this
->
db
->
	`qu”y
("{$sql}");

50  
$»t
;

51 
	}
}

53 
public
 
funùiÚ
 
	$upd©e
(
$d©a
){

54 
$id
 = 
$d©a
['uid'];

55 
	`un£t
(
$d©a
['id']);

56 
	`un£t
(
$d©a
['oper']);

58 
$sqlSŒ
 = 
	`¬¿y
();

59 
	`fÜ—ch
(
$d©a
 
as
 
$key
 => 
$v®ue
){

60 
$sqlSŒ
[] = "{$key} = '{$value}'";

62 
$upf›lds
 = 
	`im¶ode
(",", 
$sqlSŒ
);

63 
$sql
 = "update orderPlacingMeeting.user set {$upfields} where uid = {$id}";

64 
$»t
 = 
$this
->
db
->
	`qu”y
("{$sql}");

65  
$»t
;

66 
	}
}

68 
public
 
funùiÚ
 
	$§ve
(
$d©a
){

69 
	`un£t
(
$d©a
['id']);

70 
	`un£t
(
$d©a
['oper']);

72 
$f›lds
 = 
	`im¶ode
(',', 
$this
->
	`g‘F›lds
());

73 
$d©as
 = 
	`im¶ode
(',', 
$d©a
);

74 
$sql
 = "insert into user($fields) values({$datas})";

75 
$»t
 = 
$this
->
db
->
	`qu”y
("{$sql}");

76  
$»t
;

77 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/enum_model.php

1 <?
php


6 şas 
	cEnum_mod–
 
ex‹nds
 
	mCI_Mod–
 {

8 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

9 
·»Á
 :: 
	`__cÚ¡ruù
();

20 
public
 
funùiÚ
 
	$S–eùOÃSŒ
(
$OrgID
, 
$LªgID
, 
$A‰rName
, 
$EnumKey
) {

21 
$£Ëù
 = "B.enum_value,A.Identify_Code,B.attr_name,B.enum_key";

22 
$wh”e
 = 
	`¬¿y
(

23 "A.Üg_id" => 
$OrgID
,

24 "A.©Œ_Çme" => 
$A‰rName
,

25 "B.’um_key" => 
$EnumKey
,

26 "B.Ïng_id" => 
$LªgID
,

28 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

29 
$this
->
db
->
	`äom
("tc_enum A");

30 
$this
->
db
->
	`još
("tc_enum_str B", "A.Attr_Name = B.Attr_Name‡nd B.org_id = $OrgID‡nd B.lang_id = $LangID‡nd A.ENUM_KEY = B.Enum_Key", "inner");

31 
$this
->
db
->
	`wh”e
(
$wh”e
);

32 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

34  
$d©a
[0];

35 
	}
}

44 
public
 
funùiÚ
 
	$S–eùWh”e
(
$OrgID
, 
$LªgId
, 
$A‰rName
) {

45 
$£Ëù
 = "B.enum_value ,A.Identify_Code,B.attr_name,B.enum_key";

46 
$wh”e
 = 
	`¬¿y
(

47 "A.©Œ_Çme" => 
$A‰rName
,

48 "B.Ïng_id" => 
$LªgId
,

50 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

51 
$this
->
db
->
	`äom
("tc_enum A");

52 
$this
->
db
->
	`još
("tc_enum_str B", "A.Attr_Name = B.Attr_Name‡nd B.org_id = $OrgID‡nd B.lang_id = $LangId‡nd A.ENUM_KEY = B.Enum_Key", "inner");

53 
$this
->
db
->
	`wh”e
(
$wh”e
);

54 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

56  
$d©a
;

57 
	}
}

63 
public
 
funùiÚ
 
	$S–eùAÎ
() {

64 
$d©a
 = 
$this
->
db
->
	`£Ëù
("©Œ_Çme,·»Á_©Œ_Çme,roÙ_©Œ_Çme")->
	`äom
("tc_’um_»ÏtiÚ")->
	`g‘
()->
	`»suÉ_¬¿y
();

66 
	`fÜ—ch
 (
$d©a
 
as
 
$key
 => 
$v®ue
) {

67 
$d©a_®l
['·»Á'][] = 
$v®ue
['PARENT_ATTR_NAME'];

68 
$d©a_®l
['chd'][] = 
$v®ue
['ATTR_NAME'];

70 
$d©a_®l
['·»Á'] = 
	`¬¿y_unique
($data_all['parent']);

71 
$d©a_®l
['chd'] = 
	`¬¿y_unique
($data_all['child']);

72  
$d©a_®l
;

73 
	}
}

75 
public
 
funùiÚ
 
	$S–eùChd
() {

76  
$this
->
db
->
	`£Ëù
("©Œ_Çme")->
	`äom
("tc_’um_»ÏtiÚ")->
	`g‘
()->
	`»suÉ_¬¿y
();

77 
	}
}

79 
public
 
funùiÚ
 
	$S–eùP¬’t
() {

80  
$this
->
db
->
	`£Ëù
("·»Á_©Œ_Çme")->
	`äom
("tc_’um_»ÏtiÚ")->
	`g‘
()->
	`»suÉ_¬¿y
();

81 
	}
}

90 
public
 
funùiÚ
 
	$G‘EnumA¼
(
$OrgID
, 
$A‰rName
, 
$LªgID
 = 2) {

91 
$£Ëù
 = 
	`¬¿y
(

95 
$wh”e
 = 
	`¬¿y
(

96 "Üg_id" => 
$OrgID
,

97 "©Œ_Çme" => 
$A‰rName
,

98 "Ïng_id" => 
$LªgID
,

100 
$this
->
db
->
	`äom
("tc_enum_str");

101 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

102 
$this
->
db
->
	`wh”e
(
$wh”e
);

103 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

104 
$d©a_¬r
 = 
	`¬¿y
();

105 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

106 
$d©a_¬r
[
$k
]['’um_v®ue'] = 
$v
['ENUM_VALUE'];

107 
$d©a_¬r
[
$k
]['’um_key'] = 
$v
['ENUM_KEY'];

110  
$d©a_¬r
;

111 
	}
}

113 
public
 
funùiÚ
 
	$S–eùAÎSŒ
(
$OrgID
, 
$LªgId
, 
$A‰rName
) {

114 
$£Ëù
 = "B.enum_value,A.Identify_Code,B.attr_name,B.enum_key";

115 
$wh”e
 = 
	`¬¿y
(

116 "A.Üg_id" => 
$OrgID
,

117 "A.©Œ_Çme" => 
$A‰rName
,

119 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

120 
$this
->
db
->
	`äom
("tc_enum A");

121 
$this
->
db
->
	`još
("tc_enum_str B", "A.Attr_Name = B.Attr_Name‡nd B.org_id = $OrgID‡nd B.lang_id = $LangId‡nd A.ENUM_KEY = B.Enum_Key", "inner");

122 
$this
->
db
->
	`wh”e
(
$wh”e
);

123 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

124  
$d©a
;

125 
	}
}

127 
public
 
funùiÚ
 
	$S–eùChdEnums
(
$©Œ_Çme
, 
$’um_key
, 
$OrgID
, 
$LªgID
, 
$obj_Çme
) {

128 
$Şd_©Œ_Çme
 = 
$©Œ_Çme
;

129 
$this
->
lßd
->
	`mod–
("admin/attr_model", "attr");

130 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

131 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$©Œ_Çme
;

132 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

133 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

135 
$©Œ_Çme
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]) ? $attr_name : $attr_data["ENUM_ATTR_NAME"];

136 if(
	`em±y
(
$’um_key
)){

137 
$£Ëù
 = "attr_name";

138 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

139 
$this
->
db
->
	`äom
('tc_enum_relation_value');

140 
$wh”e
 = 
	`¬¿y
("·»Á_©Œ_Çme" => 
$©Œ_Çme
,

142 
$this
->
db
->
	`wh”e
(
$wh”e
);

143 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

144 
$’um_©Œ
 = 
$this
->->
	`S–eùAÎ
();

145 
$ATTR_NAME
 = 
$d©a
[0]['ATTR_NAME'];

147 
$£Ëù
 = "a.enum_key,‡.enum_value,b.attr_name";

148 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

149 
$this
->
db
->
	`äom
('tc_enum_str‡');

150 
$this
->
db
->
	`još
("tc_enum_relation_value b", "a.enum_key=b.attr_enum_key‡nd‡.attr_name=b.attr_name", "inner");

151 
$wh”e
 = 
	`¬¿y
("b.·»Á_©Œ_Çme" => 
$©Œ_Çme
,

152 "b.·»Á_’um_key" => 
$’um_key
,

153 "a.Ïng_id" => 
$LªgID
);

154 
$this
->
db
->
	`wh”e
(
$wh”e
);

155 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

156 
$’um_©Œ
 = 
$this
->->
	`S–eùAÎ
();

158 
$A‰rB—n2
["select"] = "ATTR_NAME";

159 
$A‰rB—n2
["wh”e"]["’um_©Œ_Çme"] = 
$d©a
[0]['ATTR_NAME'];

160 
$A‰rB—n2
["wh”e"]["Üg_id"] = 
$OrgID
;

161 
$A‰rB—n2
["wh”e"]["obj_Çme"] = 
$obj_Çme
;

162 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n2
);

165 
$ATTR_NAME
 = 
	`em±y
(
$©Œ_d©a
è? 
$d©a
[0]['ATTR_NAME'] : $attr_data["ATTR_NAME"];

167 ià(!
	`em±y
(
$d©a
)) {

168 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

170 
$r_d©a
[
$ATTR_NAME
]['’um_¬r'][
$k
]['’um_key'] = 
$v
['ENUM_KEY'];

171 
$r_d©a
[
$ATTR_NAME
]['’um_¬r'][
$k
]['’um_v®ue'] = 
$v
['ENUM_VALUE'];

175 
$wh”e
 = 
	`¬¿y
(

176 'PARENT_ATTR_NAME' => 
$©Œ_Çme
,

179 
$chd_d©a
 = 
$this
->
db
->
	`£Ëù
("©Œ_Çme")->
	`äom
("tc_’um_»ÏtiÚ")->
	`wh”e
(
$wh”e
)->
	`g‘
()->
	`»suÉ_¬¿y
();

181 
	`fÜ—ch
 (
$chd_d©a
 
as
 
$key
 => 
$v
) {

183 ià(
	`š_¬¿y
(
$ATTR_NAME
, 
$’um_©Œ
['parent'])) {

184 
$r_d©a
[
$ATTR_NAME
]['is_parent'] = 1;

186 
$r_d©a
[
$ATTR_NAME
]['is_parent'] = 0;

188 ià(
	`š_¬¿y
(
$ATTR_NAME
, 
$’um_©Œ
['child'])) {

189 
$r_d©a
[
$ATTR_NAME
]['is_child'] = 1;

191 
$r_d©a
[
$ATTR_NAME
]['is_child'] = 0;

196  
$r_d©a
;

197 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/format_model.php

1 <?
php


4 şas 
	cFÜm©_mod–
 
ex‹nds
 
	mCI_Mod–
 {

13 
public
 
funùiÚ
 
	$G‘Li¡FÜm©
(
$obj_id
, 
$obj_ty³
, 
$u£r_id
 = 0,
$sub_ty³
=0) {

14 
$£Ëù
 = 
	`¬¿y
('quick_list_flds');

15 
$wh”e
["Üg_id"] = 
$obj_id
;

16 
$wh”e
["u£r_id"] = 
$u£r_id
;

17 
$wh”e
["obj_ty³"] = 
$obj_ty³
;

18 
$wh”e
["sub_ty³"] = 
$sub_ty³
;

19 
$this
->
db
->
	`äom
("tc_user_list_profile");

20 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

21 
$this
->
db
->
	`wh”e
(
$wh”e
);

22 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

24 if(
	`em±y
(
$d©a
)){

25 
$£Ëù
 = 
	`¬¿y
('quick_list_flds');

26 
$wh”e
["Üg_id"] = 
$obj_id
;

27 
$wh”e
["user_id"] = 0;

28 
$wh”e
["obj_ty³"] = 
$obj_ty³
;

29 
$wh”e
["sub_ty³"] = 
$sub_ty³
;

30 
$this
->
db
->
	`äom
("tc_user_list_profile");

31 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

32 
$this
->
db
->
	`wh”e
(
$wh”e
);

33 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

36 
$d©a_¬r
 = 
	`ex¶ode
(';', 
$d©a
[0]["QUICK_LIST_FLDS"]);

37 
$obj_Çme
ğ
	`sub¡r
(
$d©a_¬r
[0],0,
	`¡½os
($data_arr[0],'.'));

38  
$d©a_¬r
;

46 
public
 
funùiÚ
 
	$G‘FuÎIndexFÜm©
(
$obj_id
, 
$obj_ty³
, 
$u£r_id
 = 0) {

47 
$£Ëù
 = 
	`¬¿y
('display_fields');

48 
$wh”e
["Üg_id"] = 
$obj_id
;

49 
$wh”e
["obj_ty³"] = 
$obj_ty³
;

50 
$this
->
db
->
	`äom
("tc_search_profile");

51 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

52 
$this
->
db
->
	`wh”e
(
$wh”e
);

53 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

55 
$d©a_¬r
 = 
	`ex¶ode
(';', 
$d©a
[0]["DISPLAY_FIELDS"]);

56  
$d©a_¬r
;

57 
	}
}

66 
public
 
funùiÚ
 
	$G‘V›wFÜm©
(
$Üg_id
, 
$obj_ty³
, 
$ty³_id
 = 0) {

67 
$ty³_id
 = 
	`em±y
($type_id)?0:$type_id;

68 
$£Ëù
 = "format_content";

69 
$wh”e
["Üg_id"] = 
$Üg_id
;

70 
$wh”e
["obj_ty³"] = 
$obj_ty³
;

71 
$wh”e
["ty³_id"] = 
$ty³_id
;

72 
$this
->
db
->
	`äom
("tc_card_format");

73 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

74 
$this
->
db
->
	`wh”e
(
$wh”e
);

75 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

76 
$jsÚ
 = 
	`ba£64_decode
(
$d©a
[0]["FORMAT_CONTENT"]->
	`lßd
());

78 
$d©a_¬r
 = 
	`jsÚ_decode
(
$jsÚ
, 
TRUE
);

80  
$d©a_¬r
;

81 
	}
}

90 
public
 
funùiÚ
 
	$G‘Ed™FÜm©
(
$Üg_id
, 
$obj_ty³
, 
$ty³_id
 = 0 ,
$is_d‘a
=
çl£
) {

91 
$ty³_id
 = 
	`em±y
($type_id)?0:$type_id;

92 
$£Ëù
 = "format_content";

93 
$wh”e
["Üg_id"] = 
$Üg_id
;

94 
$wh”e
["obj_ty³"] = 
$obj_ty³
;

95 
$wh”e
["ty³_id"] = 
$ty³_id
;

96 
$this
->
db
->
	`äom
("tc_edit_card_format");

97 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

98 
$this
->
db
->
	`wh”e
(
$wh”e
);

100 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

101 ià(
$is_d‘a
) {

102  
$this
->
	`g‘InfoResuÉ
(
$d©a
);

104  
$this
->
	`g‘ResuÉ
(
$d©a
);

105 
	}
}

110 
´Ùeùed
 
funùiÚ
 
	$g‘InfoResuÉ
(
$fÜm©_cÚ‹Á
) {

111 ià(
	`em±y
(
$fÜm©_cÚ‹Á
)) {

112  
nuÎ
;

114 
$jsÚ
 = 
	`ba£64_decode
(
$fÜm©_cÚ‹Á
[0]["FORMAT_CONTENT"]->
	`lßd
());

115 
$d©a_¬r
 = 
	`ex¶ode
(";",
$jsÚ
);

116  
$d©a_¬r
;

117 
	}
}

122 
´Ùeùed
 
funùiÚ
 
	$g‘ResuÉ
(
$fÜm©_cÚ‹Á
){

123 
$jsÚ
 = 
	`ba£64_decode
(
$fÜm©_cÚ‹Á
[0]["FORMAT_CONTENT"]->
	`lßd
());

124 
$d©a_¬r
 = 
	`jsÚ_decode
(
$jsÚ
, 
TRUE
);

125  
$d©a_¬r
;

126 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/menu_model.php

1 <?
php


2 şas 
	cM’u_mod–
 
ex‹nds
 
	mCI_Mod–
{

11 
public
 
funùiÚ
 
G‘M’uJsÚ
(
$Üg_id
,
$logš_sys
,
$aùive
=""){

12 
$sys_Çme
 = 
$this
->
sysIdG‘Name
(
$logš_sys
);

13 
	m$sql
 = "

14 
£Ëù
 * 
äom
 
dd_m’u


16 
$d©a
 = 
$this
->
db
->
qu”y
(
$sql
)->
»suÉ_¬¿y
();

17 
fÜ—ch
(
$d©a
 
as
 
$k
=>
$v
){

18 
$d©a_¬r
[
$k
]["id"] = 
$v
['menu_id'];

19 
	m$d©a_¬r
[
$k
]["pid"] = 
$v
['menu_uid'];

20 
	m$d©a_¬r
[
$k
]["Çme"] = 
$v
['menu_name'];

21 
	m$d©a_¬r
[
$k
]["icÚ"] = 
$v
['menu_icon'];

22 
	m$d©a_¬r
[
$k
]["u¾"] = 
$v
['menu_url'];

23 if(
	m$v
['m’u_id'] =ğ
$aùive
){

24 
$d©a_¬r
[
$k
]["active"] = 1;

26 
	m$d©a_¬r
[
$k
]["active"] = 0;

29  
jsÚ_’code
(
$d©a_¬r
);

37 
public
 
funùiÚ
 
	$sysIdG‘Name
(
$sys_id
){

38 
$sys_id
){

49 
echo
 "æœªçŸ¥æ¨¡å—";
ex™
;

52 
	}
}

61 
public
 
funùiÚ
 
	$G‘Info
(
$šfo
){

63 
$this
->
db
->
	`äom
("tc_menu");

64 
	`exŒaù
(
$šfo
);

65 ià(!
	`em±y
(
$£Ëù
)){

66 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

68 ià(!
	`em±y
(
$wh”e
)){

69 
$this
->
db
->
	`wh”e
(
$wh”e
);

71 ià(!
	`em±y
(
$lim™
)){

72 
$this
->
db
->
	`lim™
(
$lim™
[0],$limit[1]);

74 ià(!
	`em±y
(
$like
)){

75 
$this
->
db
->
	`like
(
$like
);

77 
$d©a
=
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

78 if(
	`couÁ
(
$d©a
)==1){

79 
$d©a
 = $data[0];

81  
$d©a
;

82 
	}
}

88 
public
 
funùiÚ
 
	$couÁG‘Info
(
$šfo
){

89 
$this
->
db
->
	`äom
('tc_user');

90 
	`exŒaù
(
$šfo
);

91 ià(!
	`em±y
(
$wh”e
)){

92 
$this
->
db
->
	`wh”e
(
$wh”e
);

94 ià(!
	`em±y
(
$like
)){

95 
$this
->
db
->
	`like
(
$like
);

97 
$couÁ
 = 
$this
->
db
->
	`couÁ_®l_»suÉs
();

98  
$couÁ
;

99 
	}
}

104 
public
 
funùiÚ
 
	$ObjG‘M’uID
(
$ObjTy³
,
$Ty³
){

106 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/nextid_model.php

1 <?
php


2 şas 
	cNextid_mod–
 
ex‹nds
 
	mCI_Mod–
{

4 
public
 
funùiÚ
 
	$NewID
(
$·»Á_Çme
,
$Üg_id
=1){

5 
$wh”e
['TSYS_PARENT_NAME'] = 
	`¡¹ouµ”
(
$·»Á_Çme
);

6 
$wh”e
['Üg_id'] = 
$Üg_id
;

7 
$this
->
db
->
	`£Ëù
('TSYS_NEXT_ID');

8 
$this
->
db
->
	`äom
('TSYS_CRM_NEXTID');

9 
$this
->
db
->
	`wh”e
(
$wh”e
);

10 
$d©a
=
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

11 if(
	`em±y
(
$d©a
)){

13 
$upd©e
['TSYS_PARENT_NAME'] = 
$·»Á_Çme
;

14 
$id
=0;

15 
$upd©e
['TSYS_NEXT_ID'] =
$id
;

16 
$upd©e
['ORG_ID']=
$Üg_id
;

17 
$this
->
db
->
	`š£¹
('TSYS_CRM_NEXTID',
$upd©e
);

19 
$id
=
$d©a
[0]['TSYS_NEXT_ID'];

22 
$id
++;

24 
$upd©e
['TSYS_NEXT_ID']=
$id
;

25 
$this
->
db
->
	`wh”e
(
$wh”e
);

26 
$this
->
db
->
	`upd©e
('TSYS_CRM_NEXTID',
$upd©e
);

28  
$id
;

31 
public
 
funùiÚ
 
	$NewFÜm©ID
(
$ty³_id
,
$obj_d©a
,
$Üg_id
=1){

32 
$wh”e
=
	`¬¿y
(

33 'OBJ_NAME' => 
$obj_d©a
['OBJ_NAME'],

34 'ORG_ID' => 
$Üg_id
,

36 
$this
->
db
->
	`£Ëù
('ATTR_NAME,SEQ_FORMAT‡s format,SEQ_START_NO‡s START_NUMBER');

37 
$this
->
db
->
	`äom
('dd_attribute');

38 
$this
->
db
->
	`wh”e
(
$wh”e
);

39 
$this
->
db
->
	`wh”e
('SEQ_FORMAT is‚ot‚ull');

40 
$code_fÜm©
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

41 if(!
	`em±y
(
$code_fÜm©
)){

42 
$c_wh”e
=
	`¬¿y
(

43 'TYPE_ID' => 
$ty³_id
,

44 'OBJ_TYPE' => 
$obj_d©a
['OBJ_TYPE'],

45 'ORG_ID' => 
$Üg_id
,

47 
$this
->
db
->
	`£Ëù
('ATTR_NAME,CODE_FORMAT‡s format,START_NUMBER');

48 
$this
->
db
->
	`äom
('TC_CODE_FORMAT');

49 
$this
->
db
->
	`wh”e
(
$c_wh”e
);

50 
$c_code_fÜm©
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

52  
$code_fÜm©
;

54 if(
	`em±y
(
$c_code_fÜm©
)){

55  
$code_fÜm©
[0];

57  
$c_code_fÜm©
[0];

62 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/obj_model.php

1 <?
php


6 şas 
	cObj_mod–
 
ex‹nds
 
	mCI_Mod–
 {

8 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

9 
·»Á
 :: 
	`__cÚ¡ruù
();

12 
public
 
funùiÚ
 
	$g‘F›lds
(){

13  
	`¬¿y
(

38 
	}
}

40 
public
 
funùiÚ
 
	$g‘Info
(){

41 
$f›lds
 = 
	`im¶ode
(',', 
$this
->
	`g‘F›lds
());

42 
$»t
 = 
$this
->
db
->
	`qu”y
("£Ëù {$f›lds} from ord”PÏcšgM“tšg.´oduù ord” by‚umb” desc")->
	`»suÉ_¬¿y
();

43  
$»t
;

44 
	}
}

46 
public
 
funùiÚ
 
	$d–‘e
(
$d©a
){

47 
	`un£t
(
$d©a
['oper']);

48 
$id
 = 
$d©a
["id"];

49 
$sql
 = "delete from orderPlacingMeeting.product where id = {$id}";

50 
$»t
 = 
$this
->
db
->
	`qu”y
("{$sql}");

51  
$»t
;

52 
	}
}

54 
public
 
funùiÚ
 
	$§ve
(
$d©a
){

55 
	`un£t
(
$d©a
['oper']);

56 if(
	`is£t
(
$d©a
['id']è&& !
	`em±y
($data['id'])){

58 
$id
 = 
$d©a
['id'];

59 
	`un£t
(
$d©a
['id']);

60 
$sqlSŒ
 = 
	`¬¿y
();

61 
	`fÜ—ch
(
$d©a
 
as
 
$key
 => 
$v®ue
){

62 
$sqlSŒ
[] = "{$key} = '{$value}'";

64 
$upf›lds
 = 
	`im¶ode
(",", 
$sqlSŒ
);

65 
$sql
 = "update orderPlacingMeeting.product set {$upfields} where id = {$id}";

68 
$f›lds
 = 
	`im¶ode
(',', 
$this
->
	`g‘F›lds
());

69 
$d©as
 = 
	`im¶ode
(',', 
$d©a
);

70 
$sql
 = "insert into…roduct($fields) values({$datas})";

72 
$»t
 = 
$this
->
db
->
	`qu”y
("{$sql}");

73  
$»t
;

74 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/org_model.php

1 <?
php


3 şas 
	cOrg_mod–
 
ex‹nds
 
	mCI_Mod–
 {

10 
public
 
funùiÚ
 
	$NameG‘Id
(
$OrgName
) {

11 
$wh”e
["Üg_Çme"] = 
$OrgName
;

12 
$£Ëù
 = 
	`¬¿y
("org_id");

13 
$this
->
db
->
	`äom
("tc_org_profile");

14 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

15 
$this
->
db
->
	`wh”e
(
$wh”e
);

16 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

17 
$OrgID
 = 
$d©a
[0]["ORG_ID"];

18  
$OrgID
;

21 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/rel_model.php

1 <?
php


14 şas 
	cR–_mod–
 
ex‹nds
 
	mCI_Mod–
 {

16 
funùiÚ
 
	$__cÚ¡ruù
() {

17 
·»Á
::
	`__cÚ¡ruù
();

18 
$this
->
lßd
->
	`mod–
('www/user_model','user');

19 
$this
->
lßd
->
	`mod–
('www/relobjectprofile_model','rop');

25 
public
 
funùiÚ
 
	$»l_li¡_Ïb–s
(
$»l
) {

26 ià(
	`is_¬¿y
(
$»l
)) {

45 
$this
->
db
->
	`£Ëù
("obj_type,rel_list_flds,rel_list_name,rel_obj_type,rel_tables,cond_id,clear_ids,label,lee_condition,user_id");

46 
$this
->
db
->
	`äom
("tc_user_rel_profile A");

47 
$this
->
db
->
	`još
("dd_str_resource B", "A.REL_LIST_NAME = B.STR_RES_NAME", "inner");

48 
$w
 = 
	`¬¿y
(

49 "B.Üg_id" => 
$»l
['org_id'],

50 "obj_ty³" => 
$»l
['obj_type'],

51 "ty³_id" => 
$»l
['type_id'],

52 "Ïng_id" => 
$»l
['lang_id'],

55 
$this
->
db
->
	`wh”e
(
$w
);

56 
$w1
 = 
	`¬¿y
(

57 
$»l
['user_id'],

60 
$this
->
db
->
	`wh”e_š
("u£r_id", 
$w1
);

61 
$this
->
db
->
	`Üd”_by
("rel_list_name");

62 
$»s_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

63 ià(
	`em±y
(
$»s_d©a
)) {

64 
$this
->
db
->
	`£Ëù
("obj_type,rel_list_flds,rel_list_name,rel_obj_type,rel_tables,cond_id,clear_ids,label,lee_condition,user_id");

65 
$this
->
db
->
	`äom
("tc_user_rel_profile A");

66 
$this
->
db
->
	`još
("dd_str_resource B", "A.REL_LIST_NAME = B.STR_RES_NAME", "inner");

67 
$w
 = 
	`¬¿y
(

68 "B.Üg_id" => 
$»l
['org_id'],

69 "obj_ty³" => 
$»l
['obj_type'],

71 "Ïng_id" => 
$»l
['lang_id'],

74 
$this
->
db
->
	`wh”e
(
$w
);

75 
$w1
 = 
	`¬¿y
(

78 
$this
->
db
->
	`wh”e_š
("u£r_id", 
$w1
);

79 
$this
->
db
->
	`Üd”_by
("rel_list_name");

80 
$»s_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

82 
$»l_li¡_Çme
 = '';

84 
	`fÜ—ch
 (
$»s_d©a
 
as
 
$k
 => &
$v
) {

85 iàĞ
$»l_li¡_Çme
 =ğ
$v
['REL_LIST_NAME']è
	`un£t
(
$»s_d©a
[
$k
]);

86 
$»l_li¡_Çme
 = 
$v
['REL_LIST_NAME'];

100 
$»s_d©a
 = 
$this
->
	`»lbu‰Ú
(
$»l
, $res_data);

102  
$»s_d©a
;

104  
nuÎ
;

105 
	}
}

108 
public
 
funùiÚ
 
	$»lbu‰Ú
(
$»l
, & 
$»s_d©a
){

109 
	`exŒaù
(
$»l
, 
EXTR_OVERWRITE
);

110 
$func_Çme
 = "R–ObjeùProfe_" . 
$obj_ty³
;

111 
$»l_´o_d©a
 = 
$this
->
rİ
->
	`$func_Çme
();

112 
$»l_´o_d©a
 = 
	`em±y
($»l_´o_d©a[
$ty³_id
]) ? $rel_pro_data[0] : $rel_pro_data[$type_id];

113 
	`fÜ—ch
 (
$»s_d©a
 
as
 
$k
 => 
$v
) {

114 ià(
	`is£t
(
$»l_´o_d©a
[
$v
['REL_LIST_NAME']]è&& !
	`em±y
($rel_pro_data[$v['REL_LIST_NAME']])) {

115 
$»s_d©a
[
$k
]['bŠ_aùiÚ'] = 
$»l_´o_d©a
[
$v
['REL_LIST_NAME']];

118  
$»s_d©a
;

119 
	}
}

121 
public
 
funùiÚ
 
	$subbut
(
$Üg_id
=1,
$obj_ty³
,
$»l_obj_ty³
,
$ty³_id
){

122 
$d©a
 = 
$this
->
	`subbu‰Ú
(
$Üg_id
,
$obj_ty³
,
$»l_obj_ty³
,
$ty³_id
);

123 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

124 
$¬r
[
$v
['TYPE_ID']]['name'] = $v['TYPE_NAME'];

125 
$¬r
[
$v
['TYPE_ID']]['u¾'] = 
	`ba£_u¾
().'www/objeùs/addout?obj_ty³='.
$»l_obj_ty³
.'&ty³_id='.
$ty³_id
;

127  
$¬r
;

128 
	}
}

136 
public
 
funùiÚ
 
	$subbu‰Ú
(
$Üg_id
,
$obj_ty³
,
$»l_obj_ty³
,
$ty³_id
){

137 
$this
->
db
->
	`äom
('rel_object_task_type');

138 
$this
->
db
->
	`£Ëù
('task_type');

139 
$this
->
db
->
	`wh”e
('obj_ty³',
$obj_ty³
);

140 
$wh”e_š
 = 
	`¬¿y
(
$ty³_id
,'0');

141 
$this
->
db
->
	`wh”e_š
('ty³_id',
$wh”e_š
);

142 
$bªÃd
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

144 if(!
	`em±y
(
$bªÃd
)){

145 
	`fÜ—ch
 (
$bªÃd
 
as
 
$k
 => 
$v
) {

146 
$bª
[] =
$v
['TASK_TYPE'];

152 
$this
->
db
->
	`£Ëù
('type_name,type_id');

153 
$this
->
db
->
	`äom
('tc_type');

154 
$wh”e
 = 
	`¬¿y
(

155 'Üg_id' => 
$Üg_id
,

156 'obj_ty³' => 
$»l_obj_ty³


158 
$this
->
db
->
	`wh”e
(
$wh”e
);

159 if(!
	`is£t
(
$bª
)){

160 
$this
->
db
->
	`wh”e_nÙ_š
('ty³_id',
$bª
);

162  
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

163 
	}
}

165 
public
 
funùiÚ
 
	$G‘R–D©a
(
$¡y³
,
$¹y³
,
$scÚ‹Á
){

168 
$Üg_id
=
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

169 
$LªgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
("lang_id");

170 
$u£r_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

171 
$¡y³
) {

179 if(
$¹y³
==14){

180 
$Ãwd©a
['Task.AccouÁ'] = 
$scÚ‹Á
['Opportunity.Account'];

181 
$Ãwd©a
['Task.AccouÁID'] = 
$scÚ‹Á
['Opportunity.AccountID'];

182 
$Ãwd©a
['Task.AccouÁ.ID'] = 
$scÚ‹Á
['Opportunity.Account.ID'];

183 
$Ãwd©a
['Task.AccouÁ.Name'] = 
$scÚ‹Á
['Opportunity.Account.Name'];

184 
$u£rd©a
 = 
$this
->
u£r
->
	`S–eùOÃ
(
$Üg_id
, 
$u£r_id
);

185 
$Ãwd©a
['Task.AssigÃdTo'] = 
$u£rd©a
['Name'];

186 
$Ãwd©a
['Task.AssigÃdToID'] = 
$u£r_id
;

187 
$Ãwd©a
['Task.AssigÃdTo.ID'] = 
$u£r_id
;

188 
$Ãwd©a
['Task.AssigÃdTo.Name'] = 
$u£rd©a
['Name'];

189 
$Ãwd©a
['Task.R–©edToSge'] = 
$scÚ‹Á
['Opportunity.StageName'];

192 
$Ãwd©a
['Task.R–©edToSge.v®ue'] = 
$scÚ‹Á
['Opportunity.StageName.Name'];

193 
$Ãwd©a
['Task.RelatedToStage.enum_key'] = 1001;

194 
$Ãwd©a
['Task.R–©edToSge.’um_¬r'] = 
	`A¼ay
(

195 0 => 
	`A¼ay
(

196 '’um_v®ue' => 
$scÚ‹Á
['Opportunity.StageName'],

200 
$Ãwd©a
['Task.Status'] = 'æœªå¼€å§‹';

201 
$Ãwd©a
['Task.Status.enum_key'] = 1;

202 
$Ãwd©a
['Task.Status.value'] = 'æœªå¼€å§‹';

221  
$Ãwd©a
;

222 
	}
}

225 
public
 
funùiÚ
 
	$addÃwd©a
(
$robj_d©a
,
$sobj_d©a
,
$scÚ‹Á
,
$ID
,&
$Ãwd©a
){

228 if(
$robj_d©a
['OBJ_NAME']=='Task' && 
$sobj_d©a
['OBJ_NAME']=='Opportunity'){

229 
$Ãwd©a
['Task.AccouÁ'] = 
$scÚ‹Á
['Opportunity.Account'];

230 
$Ãwd©a
['Task.AccouÁID'] = 
$scÚ‹Á
['Opportunity.AccountID'];

231 
$Ãwd©a
['Task.AccouÁ.ID'] = 
$scÚ‹Á
['Opportunity.AccountID'];

232 
$Ãwd©a
['Task.R–©edToSge'] = 
$scÚ‹Á
['Opportunity.StageName'];

233 
$Ãwd©a
['Task.R–©edToSge.’um_key'] = 
$scÚ‹Á
['Opportunity.StageName.ID'];

234 
$Ãwd©a
['Task.R–©edToSge.’um_¬r'] = 
	`¬¿y
(0=>¬¿y('’um_key' => 
$scÚ‹Á
['Opportunity.StageName.ID'],'enum_value' => $scontent['Opportunity.StageName']));

235 
$Ãwd©a
['Task.Status'] = 'æœªå¼€å§‹';

236 
$Ãwd©a
['Task.Status.enum_key'] = 1;

237 
$Ãwd©a
['Task.R–©edToID'] = 
$ID
;

238 
$Ãwd©a
['Task.R–©edToTy³'] = 
$sobj_d©a
['OBJ_TYPE'];

240 if(
$robj_d©a
['OBJ_NAME']=='Task' && 
$sobj_d©a
['OBJ_NAME']=='Contract'){

241 
$Ãwd©a
['Task.AccouÁ'] = 
$scÚ‹Á
['Contract.Account'];

242 
$Ãwd©a
['Task.AccouÁID'] = 
$scÚ‹Á
['Contract.AccountID'];

243 
$Ãwd©a
['Task.AccouÁ.ID'] = 
$scÚ‹Á
['Contract.AccountID'];

244 
$Ãwd©a
['Task.R–©edToSge'] = 
$scÚ‹Á
['Contract.Stage'];

245 
$Ãwd©a
['Task.RelatedToStage.enum_key'] = 1;

246 
$Ãwd©a
['Task.R–©edToSge.’um_¬r'] = 
	`¬¿y
(0=>¬¿y('’um_key' => 1,'’um_v®ue' => 
$scÚ‹Á
['Contract.Stage']));

247 
$Ãwd©a
['Task.Status'] = 'æœªå¼€å§‹';

248 
$Ãwd©a
['Task.Status.enum_key'] = 1;

249 
$Ãwd©a
['Task.R–©edToID'] = 
$ID
;

250 
$Ãwd©a
['Task.R–©edToTy³'] = 
$sobj_d©a
['OBJ_TYPE'];

252 if(
$robj_d©a
['OBJ_NAME']=='CÚù' && 
$sobj_d©a
['OBJ_NAME']=='Account'){

253 
$Ãwd©a
['CÚù.AccouÁ'] = 
$scÚ‹Á
['Account.Name'];

254 
$Ãwd©a
['CÚù.AccouÁID'] = 
$scÚ‹Á
['Account.ID'];

255 
$Ãwd©a
['CÚù.AccouÁ.ID'] = 
$scÚ‹Á
['Account.ID'];

258 if(
$robj_d©a
['OBJ_NAME']=='Task' && 
$sobj_d©a
['OBJ_NAME']=='Lead'){

259 
$Ãwd©a
['Task.Status'] = 'æœªå¼€å§‹';

260 
$Ãwd©a
['Task.Status.enum_key'] = 1;

274 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/remind_model.php

1 <?
php


2 şas 
	cRemšd_mod–
 
ex‹nds
 
	mCI_Mod–
{

3 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

4 
·»Á
 :: 
	`__cÚ¡ruù
();

9 
public
 
funùiÚ
 
	$Remšd”Li¡
(
$Üg_id
,
$u£r_id
,
$is_desk
=
æa£
,
$Cu¼’tPage
=1,
$PageSize
=10){

10 
$wh”e
 = 
	`¬¿y
(

12 'tc_»mšd_³rsÚ.Üg_id' => 
$Üg_id
,

16 
$this
->
db
->
	`£Ëù
('tc_reminder.remind_mesg,tc_reminder.obj_type,tc_remind_person.is_new,tc_reminder.obj_id,');

17 
$this
->
db
->
	`£Ëù
("to_char(tc_remind_person.remind_time, 'yyyy-mm-dd hh24:ii:ss')‡s„emind_time");

18 
$this
->
db
->
	`wh”e
(
$wh”e
);

19 
$this
->
db
->
	`äom
('tc_remind_person');

20 
$još_Ú
 = 'tc_reminder.org_id =c_remind_person.org_id‡ndc_reminder.remind_id =c_remind_person.remind_id';

21 
$this
->
db
->
	`još
('tc_»mšd”',
$još_Ú
,'inner');

22 
$this
->
db
->
	`Üd”_by
('tc_remind_person.remind_id', "desc");

23 if(
$is_desk
){

24 
$this
->
db
->
	`lim™
(3,1);

27 
$this
->
db
->
	`lim™
(
$PageSize
, (
$Cu¼’tPage
 - 1) * $PageSize + 1);

28 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

29 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

30 
$d©a
[
$k
]['REMIND_TIME'] = 
$this
->
objeùs
->
	`isd©‘ime
(
$v
['REMIND_TIME'],8*60*60);

32 
$couÁ
 = 
$this
->
	`couÁ
(
$Üg_id
,
$u£r_id
);

33  
$this
->
	`InfoPag”s
(
$Cu¼’tPage
, 
$couÁ
, 
$PageSize
, 
$d©a
);

35 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

36 
$d©a
[
$k
]['REMIND_TIME'] = 
$this
->
objeùs
->
	`isd©‘ime
(
$v
['REMIND_TIME'],8*60*60);

38  
$d©a
;

39 
	}
}

41 
public
 
funùiÚ
 
	$couÁ
(
$Üg_id
,
$u£r_id
){

42 
$wh”e
 = 
	`¬¿y
(

44 'tc_»mšd_³rsÚ.Üg_id' => 
$Üg_id
,

48 
$this
->
db
->
	`£Ëù
('tc_reminder.remind_mesg,tc_reminder.obj_type,tc_reminder.obj_id');

49 
$this
->
db
->
	`£Ëù
("to_char(tc_remind_person.remind_time, 'yyyy-mm-dd hh24:ii:ss')‡s„emind_time");

50 
$this
->
db
->
	`wh”e
(
$wh”e
);

51 
$this
->
db
->
	`äom
('tc_remind_person');

52 
$još_Ú
 = 'tc_reminder.org_id =c_remind_person.org_id‡ndc_reminder.remind_id =c_remind_person.remind_id';

53 
$this
->
db
->
	`još
('tc_»mšd”',
$još_Ú
,'inner');

54 
$this
->
db
->
	`Üd”_by
('tc_remind_person.remind_id', "desc");

55 
$couÁ
 = 
$this
->
db
->
	`couÁ_®l_»suÉs
();

56  
$couÁ
;

57 
	}
}

59 
´Ùeùed
 
funùiÚ
 
	$InfoPag”s
(
$Cu¼’tPage
, 
$couÁ
, 
$PageSize
, 
$d©a
) {

61 
$»¥Úû
->
·ge
 = 
$Cu¼’tPage
;

62 
$»¥Úû
->
»cÜds
 = 
$couÁ
;

63 ià(
$couÁ
 > 0) {

64 
$tÙ®_·ges
 = 
	`û
(
$couÁ
 / 
$PageSize
);

66 
$tÙ®_·ges
 = 0;

68 
$»¥Úû
->
tÙ®
 = 
$tÙ®_·ges
;

70 ià(!
	`em±y
(
$d©a
)) {

71 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

72 
$»¥Úû
->
rows
[
$k
]["ûÎ"] = 
$v
;

76  
	`jsÚ_’code
(
$»¥Úû
);

77 
d›
;

78 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/type_model.php

1 <?
php


5 şas 
	cTy³_mod–
 
ex‹nds
 
	mCI_Mod–
 {

7 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

8 
·»Á
 :: 
	`__cÚ¡ruù
();

17 
public
 
funùiÚ
 
	$S–eùOÃ
(
$OrgID
, 
$©Œ_v®ue
) {

18 
$wh”e
 = 
	`¬¿y
(

19 "ty³_id" => 
$©Œ_v®ue
,

20 "Üg_id" => 
$OrgID
,

22 
$£Ëù
 = 
	`¬¿y
(

26 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

27 
$this
->
db
->
	`wh”e
(
$wh”e
);

28 
$this
->
db
->
	`äom
("tc_type");

29 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

30 
$Ãw_d©a
["Name"] = 
$d©a
[0]["TYPE_NAME"];

31 
$Ãw_d©a
["ID"] = 
$d©a
[0]["TYPE_ID"];

32  
$Ãw_d©a
;

33 
	}
}

41 
public
 
funùiÚ
 
	$ObjG‘Ty³
(
$OrgID
,
$ObjTy³
){

42 
$wh”e
 = 
	`¬¿y
(

43 "obj_ty³" => 
$ObjTy³
,

44 "Üg_id" => 
$OrgID
,

47 
$£Ëù
 = 
	`¬¿y
(

51 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

52 
$this
->
db
->
	`wh”e
(
$wh”e
);

53 
$this
->
db
->
	`äom
("tc_type");

54 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

55 if(
	`is£t
(
$d©a
[0])){

56 
	`fÜ—ch
(
$d©a
 
as
 
$k
=>
$v
){

57 
$Ãw_d©a
[
$k
]["Name"] = 
$v
["TYPE_NAME"];

58 
$Ãw_d©a
[
$k
]["ID"] = 
$v
["TYPE_ID"];

60  
$Ãw_d©a
;

62  
çl£
;

64 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/service/contants_service_model.php

1 <?
php


14 şas 
	cCÚÁs_£rviû_mod–
 
ex‹nds
 
	mCI_Mod–
 {

16 
´iv©e
 
	m$_feP©h
 = "";

17 
public
 
	m$_aùiveSh“t
 = 0;

18 
public
 
	m$_h—d”s
 = 
¬¿y
("å·¥å·", "æ‰‹æœºå·", "è”ç³»ç”µè¯", "å§“å");

20 
funùiÚ
 
	$__cÚ¡ruù
(){

21 
·»Á
::
	`__cÚ¡ruù
();

22 
$this
->
lßd
->
	`mod–
('www/contants_model', 'contants');

23 
$this
->
lßd
->
	`lib¿ry
('excel');

24 
$this
->
lßd
->
	`lib¿ry
('fileBase');

33 
public
 
funùiÚ
 
	$ãtchAÎCÚÁs
(){

34  
$this
->
cÚÁs
->
	`qu”yAÎCÚÁsD©a
();

35 
	}
}

46 
public
 
funùiÚ
 
	$­³ndCÚÁs
(
$feP©h
, 
$sh“t
, 
$h—d”s
){

47 
$this
->
_feP©h
 = 
$feP©h
;

48 
$this
->
_aùiveSh“t
 = 
$sh“t
;

49 
$this
->
_h—d”s
 = 
$h—d”s
;

50  
$this
->
	`§veCÚÁs
();

51 
	}
}

62 
public
 
funùiÚ
 
	$ŒunÿtCÚÁs
(
$feP©h
, 
$sh“t
, 
$h—d”s
){

63 
$this
->
_feP©h
 = 
$feP©h
;

64 
$this
->
_aùiveSh“t
 = 
$sh“t
;

65 
$this
->
_h—d”s
 = 
$h—d”s
;

66 
$»t
 = 
$this
->
cÚÁs
->
	`ŒunÿtCÚÁs
();

67 if(
FALSE
 ==ğ
$»t
){

68  
FALSE
;

70  
$this
->
	`§veCÚÁs
();

71 
	}
}

79 
´iv©e
 
funùiÚ
 
	$§veCÚÁs
(){

80 
$»t
 = 
	`¬¿y
("succ" => 
TRUE
, "msg" =>‡rray());

81 
$exûl
 = 
Ãw
 
	`Exûl
();

82 
$cÚÁsA¼
 = 
$exûl
->
	`»adExûl
(
$this
->
_feP©h
, $this->
_aùiveSh“t
, $this->
_h—d”s
);

83 
	`fÜ—ch
(
$cÚÁsA¼
['cÚ‹Ás'] 
as
 
$key
 => 
$cÚÁ
){

84 if(
FALSE
 ==ğ
$this
->
	`cÚÁsAddA‰r
(
$cÚÁ
[0], $contant[1], $contant[2], $contant[3])){

85 
$»t
['msg'] = 
FALSE
;

86 
	`¬¿y_push
(
$»t
['msg'], "{$contant[3]} æ’å…¥å¤±è´¥");

89  
$»t
;

90 
	}
}

99 
public
 
funùiÚ
 
	$cÚÁsFeU¶ßd
(
$fes
){

100 
$»t
 = 
FALSE
;

101 
$feBa£
 = 
Ãw
 
	`feBa£
();

102 
$feBa£
->
	`š™
(
$fes
, 
__CLASS__
);

103 
$feBa£
->
	`checkFeEx‹rsiÚ
(è&& 
$»t
 = $feBa£->
	`§veFeP©h
();

104  
$»t
;

105 
	}
}

117 
public
 
funùiÚ
 
	$cÚÁsAddA‰r
(
$gÚghao
, 
$phÚe
, 
$‹l
, 
$Çme
){

118 if(!
	`»gexPhÚe
(
$phÚe
)){

119  
FALSE
;

121 if(!
	`»gexT–
(
$‹l
)){

122  
FALSE
;

124 
$cÚÁsAddA¼
 = 
	`¬¿y
();

125 
$cÚÁsAddA¼
['cÚÁs_u£r_gÚghao'] = 
	`mysqlEsÿ³SŒ
(
$gÚghao
);

126 
$cÚÁsAddA¼
['cÚÁs_phÚe'] = 
$phÚe
;

127 
$cÚÁsAddA¼
['cÚÁs_‹l'] = 
$‹l
;

128 
$cÚÁsAddA¼
['cÚÁs_Çme'] = 
	`mysqlEsÿ³SŒ
(
$Çme
);

129  
$this
->
cÚÁs
->
	`addCÚÁs
(
$cÚÁsAddA¼
);

130 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/service/express_service_model.php

1 <?
php


3 şas 
	cEx´ess_£rviû_mod–
 
ex‹nds
 
	mCI_Mod–
 {

5 
´iv©e
 
	m$cu¾
;

7 
´iv©e
 
	m$u¾
 = 
¬¿y
(

16 
funùiÚ
 
	$__cÚ¡ruù
(){

17 
·»Á
::
	`__cÚ¡ruù
();

18 
$this
->
lßd
->
	`lib¿ry
('curl');

21 
public
 
funùiÚ
 
	$ex´essLi¡U£rs
(){

22 
$cu¾
 = 
Ãw
 
	`Cu¾
();

23 
$cu¾
->
	`g‘
(
$this
->
u¾
['expressListUsers']);

24  
$cu¾
->
»¥Ú£
;

25 
	}
}

27 
public
 
funùiÚ
 
	$ex´essTakeD‘a
(
$u£rID
){

28 
$cu¾
 = 
Ãw
 
	`Cu¾
();

29 
$cu¾
->
	`g‘
(
$this
->
u¾
['ex´essTakeU£r']."?u£rID=".
$u£rID
);

30  
$cu¾
->
»¥Ú£
;

31 
	}
}

33 
public
 
funùiÚ
 
	$ex´essTakeEma
(
$keU£rID
, 
$u£rID
){

34 
$cu¾
 = 
Ãw
 
	`Cu¾
();

35 
$d©a
 = 
	`¬¿y
("keU£rID" => 
$keU£rID
, "u£rID" => 
$u£rID
);

36 
$cu¾
->
	`g‘
(
$this
->
u¾
['ex´essEmaMes§ge'], 
$d©a
);

37  
$cu¾
->
»¥Ú£
;

38 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/service/info_service_model.php

1 <?
php


14 şas 
	cInfo_£rviû_mod–
 
ex‹nds
 
	mCI_Mod–
 {

16 
funùiÚ
 
	$__cÚ¡ruù
(){

17 
·»Á
::
	`__cÚ¡ruù
();

18 
$this
->
lßd
->
	`mod–
('www/info_model', 'info');

27 
public
 
funùiÚ
 
	$ãtchAÎInfo
(){

28  
$this
->
šfo
->
	`qu”yAÎInfoD©a
();

29 
	}
}

39 
public
 
funùiÚ
 
	$upd©eInfo
(
$šfoID
, 
$šfoY—r
, 
$šfoOrd”
, 
$šfoDesc
){

40 
$šfoD©a
 = 
	`¬¿y
();

41 
$šfoID
 = 
	`štv®
($infoID);

42 
$»t
 = 
$this
->
šfo
->
	`g‘InfoD©a
(
$šfoID
);

43 if(!
$»t
)

44  
FALSE
;

45 
$šfoD©a
['šfo_y—r'] = 
$šfoY—r
;

46 
$šfoD©a
['šfo_Üd”'] = 
$šfoOrd”
;

47 
$šfoD©a
['šfo_desc'] = 
$šfoDesc
;

48  
$this
->
šfo
->
	`upd©eInfo
(
$šfoID
, 
$šfoD©a
);

49 
	}
}

58 
public
 
funùiÚ
 
	$addInfo
(
$šfoName
, 
$šfoU¾
, 
$šfoDesc
){

59 
$šfoD©a
 = 
	`¬¿y
();

60 
$šfoD©a
['šfo_y—r'] = 
	`mysqlEsÿ³SŒ
(
$šfoY—r
);

61 
$šfoD©a
['šfo_Üd”'] = 
	`mysqlEsÿ³SŒ
(
$šfoOrd”
);

62 
$šfoD©a
['šfo_desc'] = 
	`mysqlEsÿ³SŒ
(
$šfoDesc
);

63  
$this
->
šfo
->
	`addInfo
(
$šfoD©a
);

65 
	}
}

74 
public
 
funùiÚ
 
	$d–Info
(
$šfoID
){

75 
$šfoID
 = 
	`štv®
($infoID);

76 
$»t
 = 
$this
->
šfo
->
	`g‘InfoD©a
(
$šfoID
);

77 if(!
$»t
)

78  
FALSE
;

79 
$this
->
šfo
->
	`d–Info
(
$šfoID
);

80 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/service/platform_service_model.php

1 <?
php


14 şas 
	cPÏtfÜm_£rviû_mod–
 
ex‹nds
 
	mCI_Mod–
 {

16 
´iv©e
 
	m$¶©fÜmIcÚ
 = "fa fa-dropbox color-grey";

18 
funùiÚ
 
	$__cÚ¡ruù
(){

19 
·»Á
::
	`__cÚ¡ruù
();

20 
$this
->
lßd
->
	`mod–
('www/platform_model', 'platform');

29 
public
 
funùiÚ
 
	$ãtchAÎPÏtfÜm
(){

30  
$this
->
¶©fÜm
->
	`qu”yAÎPÏtfÜmD©a
();

31 
	}
}

41 
public
 
funùiÚ
 
	$upd©ePÏtfÜm
(
$¶©fÜmID
, 
$¶©fÜmName
, 
$¶©fÜmU¾
, 
$¶©fÜmDesc
){

42 
$¶©fÜmD©a
 = 
	`¬¿y
();

43 
$¶©fÜmID
 = 
	`štv®
($platformID);

44 
$»t
 = 
$this
->
¶©fÜm
->
	`g‘PÏtfÜmD©a
(
$¶©fÜmID
);

45 if(!
$»t
)

46  
FALSE
;

47 
$¶©fÜmD©a
['¶©fÜm_Çme'] = 
$¶©fÜmName
;

48 
$¶©fÜmD©a
['¶©fÜm_u¾'] = 
$¶©fÜmU¾
;

49 
$¶©fÜmD©a
['¶©fÜm_desc'] = 
$¶©fÜmDesc
;

50  
$this
->
¶©fÜm
->
	`upd©ePÏtfÜm
(
$¶©fÜmID
, 
$¶©fÜmD©a
);

51 
	}
}

60 
public
 
funùiÚ
 
	$addPÏtfÜm
(
$¶©fÜmName
, 
$¶©fÜmU¾
, 
$¶©fÜmDesc
){

61 
$¶©fÜmD©a
 = 
	`¬¿y
();

62 
$¶©fÜmD©a
['¶©fÜm_Çme'] = 
	`mysqlEsÿ³SŒ
(
$¶©fÜmName
);

63 
$¶©fÜmD©a
['¶©fÜm_u¾'] = 
	`mysqlEsÿ³SŒ
(
$¶©fÜmU¾
);

64 
$¶©fÜmD©a
['¶©fÜm_desc'] = 
	`mysqlEsÿ³SŒ
(
$¶©fÜmDesc
);

65 
$¶©fÜmD©a
['¶©fÜm_icÚ'] = 
£lf
::
¶©fÜmIcÚ
;

66  
$this
->
¶©fÜm
->
	`addPÏtfÜm
(
$¶©fÜmD©a
);

68 
	}
}

77 
public
 
funùiÚ
 
	$d–PÏtfÜm
(
$¶©fÜmID
){

78 
$¶©fÜmID
 = 
	`štv®
($platformID);

79 
$»t
 = 
$this
->
¶©fÜm
->
	`g‘PÏtfÜmD©a
(
$¶©fÜmID
);

80 if(!
$»t
)

81  
FALSE
;

82 
$this
->
¶©fÜm
->
	`d–PÏtfÜm
(
$¶©fÜmID
);

83 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/account_model.php

1 <?
php


2 şas 
	cAccouÁ_mod–
 
ex‹nds
 
	mCI_Mod–
{

4 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

5 
·»Á
 :: 
	`__cÚ¡ruù
();

14 
public
 
funùiÚ
 
	$S–eùOÃ
(
$OrgID
, 
$D•tId
) {

15 
$wh”e
 = 
	`¬¿y
(

16 "accouÁ_id" => 
$D•tId
,

17 "Üg_id" => 
$OrgID
,

19 
$£Ëù
 = 
	`¬¿y
(

23 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

24 
$this
->
db
->
	`wh”e
(
$wh”e
);

25 
$this
->
db
->
	`äom
("tc_account");

26 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

27 
$Ãw_d©a
["Name"] = 
$d©a
[0]["ACCOUNT_NAME"];

28 
$Ãw_d©a
["ID"] = 
$d©a
[0]["ACCOUNT_ID"];

29  
$Ãw_d©a
;

30 
	}
}

32 
public
 
funùiÚ
 
	$accouÁ_is_unique
(&
$d©a
){

33 if(
$d©a
['tc_account']['Account.TypeID']==2057 || $data['tc_account']['Account.TypeID']==26){

34 
$wh”e
 = 
	`¬¿y
(

36 'accouÁ_Çme' => 
$d©a
['tc_account']['Account.Name'],

38 
$»s
 = 
$this
->
db
->
	`äom
('tc_accouÁ')->
	`wh”e
(
$wh”e
)->
	`g‘
()->
	`»suÉ_¬¿y
();

39 if(
	`couÁ
(
$»s
)>0){

41 
echo
 '{"»s":"ç","msg":"ä¿å­˜å¤±è´¥ï¼å®¢æˆ·åç§°é‡å¤ï¼Œæ•°æ®åº“ä¸­å·²å­˜åœ¨ï¼"}';
d›
;

44 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/announcement_model.php

1 <?
php


14 şas 
	cAÂounûm’t_mod–
 
ex‹nds
 
	mCI_Mod–
 {

16 
´iv©e
 
	m$pÜlDB
;

17 
´iv©e
 
	m$bË
 = "tc_announcement";

18 
´iv©e
 
	m$_ªnounûm’tID
;

19 
´iv©e
 
	m$mod–Requœed
 = 
TRUE
;

21 
funùiÚ
 
	$__cÚ¡ruù
(){

22 
·»Á
::
	`__cÚ¡ruù
();

23 
$this
->
pÜlDB
 = $this->
lßd
->
	`d©aba£
('pÜl', 
TRUE
);

24 
$this
->
lßd
->
	`mod–
('www/marteria_model', 'marteria');

33 
´iv©e
 
funùiÚ
 
	$g‘F›ldsName
(){

34  
	`¬¿y
(

44 
	}
}

46 
´iv©e
 
funùiÚ
 
	$š™RuË
(
$ªnounûm’tD©a
){

47 
$mod–R‘
 = 
	`mod–Requœed
(
£lf
::
$mod–Requœed
, s–f::
	`g‘F›ldsName
(), 
$ªnounûm’tD©a
);

48  
$mod–R‘
['succ'];

49 
	}
}

58 
public
 
funùiÚ
 
g‘AÂounûm’tD©a
(
$ªnounûm’tID
 = ""){

59 
$ªnounûm’tD©a
 = 
¬¿y
();

60 
	g$this
->
	g_ªnounûm’tID
 = 
$ªnounûm’tID
;

61 
	g$»t
 = 
$this
->
qu”yAÂounûm’t
();

62 
fÜ—ch
(
$»t
 
as
 
$key
 => 
$v®ue
){

63 
$id
 = 
$v®ue
['announcement_id'];

64 
	g$t™Ë
 = 
$v®ue
['announcement_title'];

66 
	g$pic
 = 
$v®ue
['announcement_pic'];

67 
	g$ü—‹D©e
 = 
d©e
('Y-m-d', 
$v®ue
['announcement_create_date']);

68 
	g$g
 = 
$v®ue
['announcement_tag'];

69 
	g$u£rName
 = 
$v®ue
['announcement_create_user'];

70 
	g$htmlP©h
 = '';

71 
fe_exi¡s
(
$v®ue
['ªnounûm’t_html_·th']è&& 
	g$htmlP©h
 = 
fe_g‘_cÚ‹Ás
($value['announcement_html_path']);

72 
	g$isStus
 = 
$v®ue
['announcement_is_status'];

73 
	g$ªnounûm’tD©a
[
$id
] = 
¬¿y
(

74 't™Ë' => 
$t™Ë
,

75 'pic' => 
$pic
,

76 'ü—‹D©e' => 
$ü—‹D©e
,

77 'g' => 
$g
,

78 'htmlP©h' => 
$htmlP©h
,

79 'isStus' => 
$isStus
,

80 'u£rName' => 
$u£rName
,

83  
	g$ªnounûm’tD©a
;

93 
´iv©e
 
funùiÚ
 
	$qu”yAÂounûm’t
(){

94 
$ªnounûm’tSql
 = " select * fromc_announcement ";

95 if(!
	`em±y
(
$this
->
_ªnounûm’tID
)){

96 
$ªnounûm’tSql
 .= "where‡nnouncement_id = ?";

97  
$this
->
pÜlDB
->
	`qu”y
(
$ªnounûm’tSql
, 
	`¬¿y
($this->
_ªnounûm’tID
))->
	`»suÉ_¬¿y
();

99  
$this
->
pÜlDB
->
	`qu”y
(
$ªnounûm’tSql
)->
	`»suÉ_¬¿y
();

100 
	}
}

109 
public
 
funùiÚ
 
	$addAÂounûm’t
(
$ªnounûm’tD©a
){

110 if(
	`em±y
(
$ªnounûm’tD©a
))

111  
çl£
;

112 
$ruË
 = 
£lf
::
	`š™RuË
(
$ªnounûm’tD©a
);

113 if(
FALSE
 ==ğ
$ruË
){

114  
FALSE
;

116 
$f›ldsKeys
 = 
	`im¶ode
(",", 
	`¬¿y_keys
(
$ªnounûm’tD©a
));

117 
$f›ldsV®ues
 = 
	`im¶ode
("','", 
	`¬¿y_v®ues
(
$ªnounûm’tD©a
));

118 
$ªnounûm’tSql
 = " insert intoc_announcement ({$fieldsKeys}) values('{$fieldsValues}')";

119  
FALSE
 ==ğ
$this
->
pÜlDB
->
	`qu”y
(
$ªnounûm’tSql
è? FALSE : $this->pÜlDB->
	`š£¹_id
();

120 
	}
}

130 
public
 
funùiÚ
 
upd©eAÂounûm’t
(
$ªnounûm’tID
, 
$ªnounûm’tD©a
 = 
	$¬¿y
()){

131 
$¡rS‘
 = 
	`¬¿y
();

132 if(
	`em±y
(
$ªnounûm’tD©a
))

133  
FALSE
;

134 
$ruË
 = 
£lf
::
	`š™RuË
(
$ªnounûm’tD©a
);

135 if(
FALSE
 ==ğ
$ruË
){

136  
FALSE
;

138 
	`fÜ—ch
(
$ªnounûm’tD©a
 
as
 
$ªnounûm’tKey
 => 
$ªnounûm’tV®ue
){

139 
$¡rS‘
[] = " {$announcementKey} = '{$announcementValue}' ";

141 
$ªnounûm’tSql
 = " updatec_announcement set ";

142 
$ªnounûm’tSql
 .ğ
	`im¶ode
(",", 
$¡rS‘
);

143 
$ªnounûm’tSql
 .= " where‡nnouncement_id = {$announcementID}";

144  
$this
->
pÜlDB
->
	`qu”y
(
$ªnounûm’tSql
);

145 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/api_model.php

1 <?
php


3 şas 
	cApi_mod–
 
ex‹nds
 
	mCI_Mod–


5 
´iv©e
 
	m$·s¥Üt_­i_u¾
 = 'http://my.shopex.cn/api.php';

8 
´iv©e
 
	m$·s¥Üt_­i_key
 = '123457';

9 
´iv©e
 
	m$·s¥Üt_£ü‘
 = '347cfd8d66cb341272bf5d2473c13648';

10 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

12 
·»Á
 :: 
	`__cÚ¡ruù
();

13 
$this
->
¢oİy
 = 
Ãw
 
	`¢oİy
();

20 
public
 
funùiÚ
 
	$£¬ch_busšess_id
(
$id
)

22 
$cÚfig
 = 
	`¬¿y
(

23 '´ism' => 
	`¬¿y
(

35 
$time
 = 
	`time
();

36 
$u¾
 = 'api/usercenter/passport/getinfo';

40 
$d©a
["logš_Çme"] = 
$id
;

41 
$´ism
 = 
Ãw
 
	`ßuth2
(
$cÚfig
['prism']);

43 
$r
 = 
$´ism
->
	`»que¡
()->
	`po¡
(
$u¾
, 
$d©a
, 
$time
);

46 
$»s
 = 
$r
->
	`·r£d
();

47  
$»s
;

48 
	}
}

54 
public
 
funùiÚ
 
	$g’”©e_busšess_id
(
$po¡
){

55 
$·¿ms
 = 
	`¬¿y
();

57 
$·¿ms
['method'] = "shopex.user.add";

58 
$·¿ms
['­p_key'] = 
$this
->
·s¥Üt_­i_key
;

60 
$¢oİy
 = 
Ãw
 
	`Snoİy
();

61 
$¢oİy
->
	`subm™
("http://openapi.ishopex.cn/api/platform/timestamp","");

62 
$·¿ms
['time¡amp'] = 
$¢oİy
->
»suÉs
;

64 
$·¿ms
['format'] = 'json';

65 
$·¿ms
['v'] = '1.0';

68 
$·¿ms
 = 
	`¬¿y_m”ge
($·¿ms,
$po¡
);

72 
$·¿ms
['sign'] = 
$this
->
	`make_sign
($·¿ms,$this->
·s¥Üt_£ü‘
,
	`¬¿y
('sign'));

73 
$this
->
¢oİy
->
	`subm™
($this->
·s¥Üt_­i_u¾
,
$·¿ms
);

74 
$»s
 = 
$this
->
¢oİy
->
»suÉs
;

75 
$¬¼es
 = 
	`jsÚ_decode
(
$»s
,
Œue
);

76  
$¬¼es
;

77 
	}
}

79 
public
 
funùiÚ
 
make_sign
(
$·¿ms
,
$k
 = '',
$exşude
){

80 
ksÜt
(
$·¿ms
);

81 
	g$¡r
 = '';

82 
fÜ—ch
(
$·¿ms
 
as
 
$key
=>
$v®ue
){

83 if(!
š_¬¿y
(
$key
,
$exşude
)){

84 
$¡r
.=
$v®ue
;

88  
	g$k
 =ğ'' ? 
md5
(
$¡r
è: md5($¡r.
$k
);

91 
public
 
funùiÚ
 
	$£tE¼Ü
(
$”rÜ
){

92 
$”rÜ_Ëv–
 = 
	`¬¿y
(

102 ià(
	`¬¿y_key_exi¡s
(
$”rÜ
,
$”rÜ_Ëv–
)){

103  
$”rÜ_Ëv–
[
$”rÜ
];

105  
$”rÜ
;

108 
	}
}

111 
public
 
funùiÚ
 
	$´ovšû
(
$numb”
){

112 
$´ovšû_¬r
 = 
	`¬¿y
(

148 if(
	`is£t
(
$´ovšû_¬r
[
$numb”
])){

149  
$´ovšû_¬r
[
$numb”
];

154 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/banner_model.php

1 <?
php


14 şas 
	cBªÃr_mod–
 
ex‹nds
 
	mCI_Mod–
 {

16 
´iv©e
 
	m$pÜlDB
;

17 
´iv©e
 
	m$bË
 = "tc_banner";

19 
funùiÚ
 
	$__cÚ¡ruù
(){

20 
·»Á
::
	`__cÚ¡ruù
();

21 
$this
->
pÜlDB
 = $this->
lßd
->
	`d©aba£
('pÜl', 
TRUE
);

27 
public
 
funùiÚ
 
	$qu”yBªÃr
(
$bªÃrIsStus
 = 
FALSE
){

28 
$bªÃrSql
 = "select * fromc_banner where banner_is_status = '?'";

29  
$this
->
pÜlDB
->
	`qu”y
(
$bªÃrSql
, 
	`¬¿y
(
$bªÃrIsStus
))->
	`»suÉ_¬¿y
();

30 
	}
}

39 
public
 
funùiÚ
 
	$d–BªÃr
(
$bªÃrID
){

40 if(!
	`em±y
(
$bªÃrID
)){

41 
$»t
 = 
$this
->
	`g‘BªÃr
(
$bªÃrID
);

45 if('t' !=ğ
$»t
['banner_is_status'])

46  
Œue
;

47 
$bªÃrD–Sql
 = "updatec_banner set banner_is_status = 'FALSE' where banner_id = ?";

48  
$this
->
pÜlDB
->
	`qu”y
(
$bªÃrD–Sql
, 
	`¬¿y
(
$bªÃrID
));

50  
çl£
;

51 
	}
}

60 
public
 
funùiÚ
 
	$g‘BªÃr
(
$bªÃrID
){

61 if(!
	`em±y
(
$bªÃrID
)){

62 
$bªÃrSql
 = "select * fromc_banner where banner_id = ?";

63 
$»t
 = 
$this
->
pÜlDB
->
	`qu”y
(
$bªÃrSql
, 
	`¬¿y
(
$bªÃrID
))->
	`»suÉ_¬¿y
();

64  
$»t
[0];

66  
çl£
;

67 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/campaign_model.php

1 <?
php


5 şas 
	cCam·ign_mod–
 
ex‹nds
 
	mCI_Mod–
 {

7 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

8 
·»Á
 :: 
	`__cÚ¡ruù
();

17 
public
 
funùiÚ
 
	$S–eùOÃ
(
$OrgID
, 
$CmpgId
) {

18 
$wh”e
 = 
	`¬¿y
(

19 "cmpg_id" => 
$CmpgId
,

20 "Üg_id" => 
$OrgID
,

22 
$£Ëù
 = 
	`¬¿y
(

26 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

27 
$this
->
db
->
	`wh”e
(
$wh”e
);

28 
$this
->
db
->
	`äom
("tc_campaign");

29 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

30 
$Ãw_d©a
["Name"] = 
$d©a
[0]["CMPG_NAME"];

31 
$Ãw_d©a
["ID"] = 
$d©a
[0]["CMPG_ID"];

32  
$Ãw_d©a
;

33 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/contants_model.php

1 <?
php


14 şas 
	cCÚÁs_mod–
 
ex‹nds
 
	mCI_Mod–
 {

16 
´iv©e
 
	m$pÜlDB
;

17 
´iv©e
 
	m$_cÚÁsD©a
 = 
¬¿y
();

18 
´iv©e
 
	m$_off£t
 = 0;

19 
´iv©e
 
	m$_lim™
 = 10;

20 
´iv©e
 
	m$_wh”e
 = "";

21 
´iv©e
 
	m$mod–Requœed
 = 
TRUE
;

22 
´iv©e
 
	m$bË
 = "tc_contants";

24 
funùiÚ
 
	$__cÚ¡ruù
(){

25 
·»Á
::
	`__cÚ¡ruù
();

26 
$this
->
pÜlDB
 = $this->
lßd
->
	`d©aba£
('pÜl', 
TRUE
);

27 
$this
->
lßd
->
	`mod–
('www/marteria_model', 'marteria');

30 
public
 
funùiÚ
 
	$š™
(
$off£t
, 
$lim™
, 
$cÚÁsD©a
){

31 
$this
->
_off£t
 = 
	`štv®
(
$off£t
);

32 
$this
->
_lim™
 = 
	`štv®
(
$lim™
);

33 
$this
->
_cÚÁsD©a
 = 
$cÚÁsD©a
;

34 
$this
->
	`š™Begš
();

35 
$this
->
	`š™D©a
();

36 
$this
->
	`š™End
();

37 
	}
}

39 
´Ùeùed
 
funùiÚ
 
	$š™Begš
(){

40 
	}
}

49 
´Ùeùed
 
funùiÚ
 
	$š™D©a
(){

50 if(!
	`is_¬¿y
(
$this
->
_cÚÁsD©a
))

51  
FALSE
;

52 
	`fÜ—ch
(
$this
->
_cÚÁsD©a
 
as
 
$key
 => 
$v®ue
){

53 
$v®ue
[1]){

55 
$this
->
_wh”e
 .ğ
$key
 . 
$v®ue
[1] . $value[0] . " " . $value[2]. " ";

58 
$this
->
_wh”e
 .ğ
$key
 . 
$v®ue
[1] . $value[0] . " " . $value[2]. " ";

61 
$this
->
_wh”e
 .ğ
$key
 . 
$v®ue
[1] . $value[0] . " " . $value[2]. " ";

64 
$this
->
_wh”e
 .ğ
$key
 . 
$v®ue
[1] . $value[0] . " " . $value[2]. " ";

67 
$this
->
_wh”e
 .ğ
$key
 . 
$v®ue
[1] . $value[0] . " " . $value[2]. " ";

70 
$this
->
_wh”e
 .ğ
$key
 . 
$v®ue
[1] . $value[0] . " " . $value[2]. " ";

73 
$this
->
_wh”e
 .ğ
$key
 . "†ik%" . 
$v®ue
[0] . " " . $value[2]. " ";

76 
$this
->
_wh”e
 .ğ
$key
 . "†ik" . 
$v®ue
[0] . "%" . " " . $value[2]. " ";

79 
$this
->
_wh”e
 .ğ
$key
 . "†ik%" . 
$v®ue
[0] . "%" . " " . $value[2]. " " ;

82 
$this
->
_wh”e
 .ğ
$key
 . " BETWEEN " . 
$v®ue
[0][0] . "AND" . $value[0][1] . " " . $value[2]. " ";

84 
$this
->
_wh”e
 .ğ
$key
 . " IN('" . 
	`im¶ode
(",'", 
$v®ue
[0]) . "')" . " " . $value[2]. " ";

88  
TRUE
;

89 
	}
}

91 
´Ùeùed
 
funùiÚ
 
	$š™End
(){

92 
	}
}

100 
´iv©e
 
funùiÚ
 
	$g‘F›ldsName
(){

101  
	`¬¿y
(

109 
	}
}

111 
´iv©e
 
funùiÚ
 
	$š™RuË
(
$cÚÁs
){

112 
$mod–R‘
 = 
	`mod–Requœed
(
£lf
::
$mod–Requœed
, s–f::
	`g‘F›ldsName
(), 
$cÚÁs
);

113  
$mod–R‘
['succ'];

114 
	}
}

123 
public
 
funùiÚ
 
	$g‘cÚÁsD©a
(
$cÚÁsID
){

124 
$sql
 = "select * fromc_contants where contants_id = ?";

125  
$this
->
pÜlDB
->
	`qu”y
(
$cÚÁsSql
, 
	`¬¿y
(
$cÚÁsID
))->
	`»suÉ_¬¿y
();

126 
	}
}

137 
public
 
funùiÚ
 
	$qu”yPageCÚÁsD©a
(
$cÚÁsD©a
, 
$off£t
 = 0, 
$lim™
 = 10){

138 
$cÚÁsSqlP»fix
 = "";

139 
$cÚÁsSqlPage
 = "";

140 
$cÚÁsSqlWh”e
 = "";

141 
$cÚÁsSql
 = "";

142 
$this
->
_cÚÁsD©a
 = 
$cÚÁsD©a
;

143 if(
	`em±y
(
$cÚÁsD©a
))

144  
çl£
;

145 
$ruË
 = 
£lf
::
	`š™RuË
(
$cÚÁsD©a
);

146 if(
FALSE
 ==ğ
$ruË
){

147  
FALSE
;

149 
$this
->
	`š™
(
$off£t
, 
$lim™
, 
$cÚÁsD©a
);

150 
$cÚÁsSqlP»fix
 = "select * fromc_contants";

151 
$cÚÁsSqlWh”e
 = 
$this
->
_wh”e
;

152 
$cÚÁsSqlPage
 = "†imit {$this->_limit} offset {$this->_offset}";

153 
$cÚÁsSql
 = 
$cÚÁsSqlP»fix
 . " " . 
$cÚÁsSqlPage
;

154 if(!
	`em±y
(
$this
->
_wh”e
)){

155 
$cÚÁsSql
 = 
$cÚÁsSqlP»fix
 . " wh”" . 
$cÚÁsSqlWh”e
 . " " . 
$cÚÁsSqlPage
;

157  
$this
->
pÜlDB
->
	`qu”y
(
$cÚÁsSql
)->
	`»suÉ_¬¿y
();

158 
	}
}

166 
public
 
funùiÚ
 
	$qu”yAÎCÚÁsD©a
(){

167 
$sql
 = "select * fromc_contants";

168  
$this
->
pÜlDB
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

169 
	}
}

178 
public
 
funùiÚ
 
	$addCÚÁs
(
$cÚÁsD©a
){

179 if(
	`em±y
(
$cÚÁsD©a
))

180  
çl£
;

181 
$ruË
 = 
£lf
::
	`š™RuË
(
$cÚÁsD©a
);

182 if(
FALSE
 ==ğ
$ruË
){

183  
FALSE
;

185 
$f›ldsKeys
 = 
	`im¶ode
(",", 
	`¬¿y_keys
(
$cÚÁsD©a
));

186 
$f›ldsV®ues
 = 
	`im¶ode
("','", 
	`¬¿y_v®ues
(
$cÚÁsD©a
));

187 
$cÚÁsSql
 = " insert intoc_contants ({$fieldsKeys}) values('{$fieldsValues}')";

188  
FALSE
 ==ğ
$this
->
pÜlDB
->
	`qu”y
(
$cÚÁsSql
è? FALSE : $this->pÜlDB->
	`š£¹_id
();

189 
	}
}

199 
public
 
funùiÚ
 
upd©eCÚÁs
(
$cÚÁsID
, 
$cÚÁsD©a
 = 
	$¬¿y
()){

200 
$¡rS‘
 = 
	`¬¿y
();

201 if(
	`em±y
(
$cÚÁsD©a
))

202  
FALSE
;

203 
$ruË
 = 
£lf
::
	`š™RuË
(
$cÚÁsD©a
);

204 if(
FALSE
 ==ğ
$ruË
){

205  
FALSE
;

207 
	`fÜ—ch
(
$cÚÁsD©a
 
as
 
$cÚÁsKey
 => 
$cÚÁsV®ue
){

208 
$¡rS‘
[] = " {$contantsKey} = {$contantsValue} ";

210 
$cÚÁsSql
 = " updatec_contants set ";

211 
$cÚÁsSql
 .ğ
	`im¶ode
(",", 
$¡rS‘
);

212 
$cÚÁsSql
 .= " where contantsID = {$contantsID}";

213  
$this
->
pÜlDB
->
	`qu”y
(
$cÚÁsSql
);

214 
	}
}

223 
public
 
funùiÚ
 
	$d–CÚÁs
(
$cÚÁsID
){

224 
$cÚÁsSql
 = " delete fromc_contants where contants_id = ? ";

225  
$this
->
pÜlDB
->
	`qu”y
(
$cÚÁsSql
, 
	`¬¿y
(
$cÚÁsID
));

226 
	}
}

234 
public
 
funùiÚ
 
	$ŒunÿtCÚÁs
(){

235 
$cÚÁsSql
 = " delete fromc_contants ";

236  
$this
->
pÜlDB
->
	`qu”y
(
$cÚÁsSql
);

237 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/department_model.php

1 <?
php


6 şas 
	cD•¬tm’t_mod–
 
ex‹nds
 
	mCI_Mod–
 {

8 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

9 
·»Á
 :: 
	`__cÚ¡ruù
();

18 
public
 
funùiÚ
 
	$S–eùOÃ
(
$OrgID
, 
$D•tId
) {

19 
$wh”e
 = 
	`¬¿y
(

20 "d•t_id" => 
$D•tId
,

21 "Üg_id" => 
$OrgID
,

23 
$£Ëù
 = 
	`¬¿y
(

28 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

29 
$this
->
db
->
	`wh”e
(
$wh”e
);

30 
$this
->
db
->
	`äom
("tc_department");

31 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

32 
$Ãw_d©a
["Name"] = 
$d©a
[0]["DEPT_NAME"];

33 
$Ãw_d©a
["ID"] = 
$d©a
[0]["DEPT_ID"];

34 
$Ãw_d©a
["T»eP©h"] = 
$d©a
[0]["TREE_PATH"];

35  
$Ãw_d©a
;

36 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/info_model.php

1 <?
php


14 şas 
	cInfo_mod–
 
ex‹nds
 
	mCI_Mod–
 {

16 
´iv©e
 
	m$pÜlDB
;

17 
´iv©e
 
	m$bË
 = "tc_info";

18 
´iv©e
 
	m$mod–Requœed
 = 
TRUE
;

20 
funùiÚ
 
	$__cÚ¡ruù
(){

21 
·»Á
::
	`__cÚ¡ruù
();

22 
$this
->
pÜlDB
 = $this->
lßd
->
	`d©aba£
('pÜl', 
TRUE
);

31 
´iv©e
 
funùiÚ
 
	$g‘F›ldsName
(){

32  
	`¬¿y
(

38 
	}
}

40 
´iv©e
 
funùiÚ
 
	$š™RuË
(
$d©a
){

41 
$mod–R‘
 = 
	`mod–Requœed
(
£lf
::
mod–Requœed
, s–f::
	`g‘F›ldsName
(), 
$d©a
);

42  
$mod–R‘
['succ'];

43 
	}
}

51 
public
 
funùiÚ
 
	$g‘InfoD©a
(
$šfoID
){

52 
$sql
 = "select * fromc_info where info_id = ?";

53  
$this
->
pÜlDB
->
	`qu”y
(
$sql
, 
	`¬¿y
(
$šfoID
))->
	`»suÉ_¬¿y
();

54 
	}
}

62 
public
 
funùiÚ
 
	$qu”yAÎInfoD©a
(){

63 
$sql
 = "select * fromc_info";

64  
$this
->
pÜlDB
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

65 
	}
}

75 
public
 
funùiÚ
 
upd©eInfo
(
$šfoID
, 
$šfoD©a
 = 
	$¬¿y
()){

76 
$¡rS‘
 = 
	`¬¿y
();

77 if(
	`em±y
(
$šfoD©a
))

78  
FALSE
;

79 
$ruË
 = 
£lf
::
	`š™RuË
(
$šfoD©a
);

80 if(
FALSE
 ==ğ
$ruË
){

81  
FALSE
;

83 
	`fÜ—ch
(
$šfoD©a
 
as
 
$šfoKey
 => 
$šfoV®ue
){

84 
$¡rS‘
[] = " {$infoKey} = {$infoValue} ";

86 
$šfoSql
 = " updatec_info set ";

87 
$šfoSql
 .ğ
	`im¶ode
(",", 
$¡rS‘
);

88 
$šfoSql
 .= " where info_id = {$infoID}";

89  
$this
->
pÜlDB
->
	`qu”y
(
$šfoSql
);

90 
	}
}

99 
public
 
funùiÚ
 
	$addInfo
(
$šfoD©a
){

100 if(
	`em±y
(
$šfoD©a
))

101  
çl£
;

102 
$ruË
 = 
£lf
::
	`š™RuË
(
$šfoD©a
);

103 if(
FALSE
 ==ğ
$ruË
){

104  
FALSE
;

106 
$f›ldsKeys
 = 
	`im¶ode
(",", 
	`¬¿y_keys
(
$šfoD©a
));

107 
$f›ldsV®ues
 = 
	`im¶ode
(",", 
	`¬¿y_v®ues
(
$šfoD©a
));

108 
$šfoSql
 = " insert intoc_info ({$fieldsKeys}) values({$fieldsValues})";

109  
FALSE
 ==ğ
$this
->
pÜlDB
->
	`qu”y
(
$šfoSql
è? FALSE : $this->pÜlDB->
	`š£¹_id
();

110 
	}
}

119 
public
 
funùiÚ
 
	$d–Info
(
$šfoID
){

120 
$šfoSql
 = " delete fromc_info where info_id = ? ";

121  
$this
->
pÜlDB
->
	`qu”y
(
$šfoSql
, 
	`¬¿y
(
$šfoID
));

122 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/lead_model.php

1 <?
php


3 şas 
	cL—d_mod–
 
ex‹nds
 
	mCI_Mod–
 {

5 
´iv©e
 
	m$moduË
 = "Lead";

7 
´iv©e
 
	m$RefTy³
 = "18";

9 
´iv©e
 
	m$RefU¾
 = "";

11 
´iv©e
 
	m$DŸlogWidth
 = 800;

13 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

14 
·»Á
 :: 
	`__cÚ¡ruù
();

15 
$this
->
lßd
->
	`mod–
("admin/obj_model", "obj");

16 
$this
->
lßd
->
	`mod–
("admin/enum_model", "enum");

17 
$this
->
lßd
->
	`mod–
("www/objects_model", "objects");

18 
$this
->
RefU¾
 = @$this->
cÚfig
->
	`ba£_u¾
(è. @$this->cÚfig->
	`™em
(@
šdex_·ge
) . "/www/objects/ajax_lists?obj_type=";

33 
public
 
funùiÚ
 
	$G‘InfoV›w
(
$Üg_id
, 
$V›wFÜm©
, 
$Ëad_d©a
, 
$L—dA‰r
, 
$Ëad_id
) {

34 
	`fÜ—ch
 (
$V›wFÜm©
['bËs'] 
as
 
$k
 => 
$v
) {

35 
	`fÜ—ch
 (
$v
['ûÎs'] 
as
 
$key
 => 
$v®ue
) {

36 ià(!
	`em±y
(
$v®ue
['name'])) {

37 ià(
$v®ue
['label']) {

38 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['©Œ_Ïb–'] = 
$L—dA‰r
[
$v®ue
['name']]['label'];

40 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['cÚ‹Á'] = 
$Ëad_d©a
[
$v®ue
['name']];

43 ià(
$v®ue
['label']) {

44 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['attr_label'] = "";

46 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['content'] = "";

51  
$V›wFÜm©
;

52 
	}
}

62 
public
 
funùiÚ
 
	$G‘InfoEd™
(
$Üg_id
, 
$V›wFÜm©
, 
$Ëad_d©a
, 
$L—dA‰r
, 
$Ëad_id
, 
$’um_©Œ
) {

63 
	`fÜ—ch
 (
$V›wFÜm©
['bËs'] 
as
 
$k
 => 
$v
) {

64 
	`fÜ—ch
 (
$v
['ûÎs'] 
as
 
$key
 => 
$v®ue
) {

65 ià(!
	`em±y
(
$v®ue
['name'])) {

66 ià(
$v®ue
['label']) {

67 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['©Œ_Ïb–'] = 
$L—dA‰r
[
$v®ue
['name']]['label'];

70 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['cÚ‹Á'] = 
$Ëad_d©a
[
$v®ue
['name']];

71 ià(
$L—dA‰r
[
$v®ue
['name']]['is_ref_obj']) {

72 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['©Œ_ty³'] = 
$this
->
RefTy³
;

74 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['©Œ_ty³'] = 
$L—dA‰r
[
$v®ue
['name']]['attr_type'];

78 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['v®ue'] = 
$Ëad_d©a
[
$v®ue
['name']];

79 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['Çme'] = 
$v®ue
['name'];

80 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['»quœed'] = 
$v®ue
['required'];

81 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['nÙed™'] = 
$L—dA‰r
[
$v®ue
['name']]['notedit'];

83 ià(
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . '.enum_arr'])) {

85 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['key'] = 
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . ".enum_key"]) ? $lead_data[$value['name'] . ".enum_key"] : "";

86 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['’um_¬r'] = 
$Ëad_d©a
[
$v®ue
['name'] . '.enum_arr'];

88 ià(
$L—dA‰r
[
$v®ue
['name']]['is_ref_obj']) {

89 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['»ã¼ed_by'] = 
$L—dA‰r
[
$v®ue
['name']]['referred_by'];

90 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['»f_obj_Çme'] = 
$L—dA‰r
[
$v®ue
['name']]['ref_obj_name'];

92 ià(
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . '.ObjName'])) {

93 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['ObjName'] = 
$Ëad_d©a
[
$v®ue
['name'] . ".ObjName"];

95 ià(
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . '.RefUrl'])) {

96 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['RefU¾'] = 
$Ëad_d©a
[
$v®ue
['name'] . '.RefUrl'];

98 ià(
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . '.DialogWidth'])) {

99 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['DŸlogWidth'] = 
$Ëad_d©a
[
$v®ue
['name'] . '.DialogWidth'];

101 
$v®ue_Çme
 = 
$v®ue
['name'];

102 ià(
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . ".enum_attr_name"])) {

103 
$v®ue_Çme
 = 
$Ëad_d©a
[
$v®ue
['name'] . ".enum_attr_name"];

105 ià(
	`š_¬¿y
(
$v®ue_Çme
, 
$’um_©Œ
['parent'])) {

106 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['is_parent'] = 1;

108 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['is_parent'] = 0;

110 ià(
	`š_¬¿y
(
$v®ue_Çme
, 
$’um_©Œ
['child'])) {

111 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['is_child'] = 1;

113 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['is_child'] = 0;

117 ià(
$v®ue
['label']) {

118 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['attr_label'] = "";

120 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['content'] = "";

126  
$V›wFÜm©
;

127 
	}
}

135 
public
 
funùiÚ
 
	$G‘AÎ
(
$OrgID
,
$L—dID
) {

136 
$this
->
db
->
	`äom
("tc_lead ");

137 
$this
->
db
->
	`još
("tc_lead_1_1 ", "tc_lead_1_1.org_id=$OrgID‡ndc_lead_1_1.lead_id=$LeadID", "inner");

138 
$this
->
db
->
	`još
("tc_lead_attr", "tc_lead_attr.org_id=$OrgID‡ndc_lead_attr.lead_id=$LeadID", "inner");

139 
$this
->
db
->
	`još
("tc_lead_xattr ", "tc_lead_xattr.org_id=$OrgID‡ndc_lead_xattr.lead_id=$LeadID", "inner");

140 
$this
->
db
->
	`wh”e
("tc_lead.org_id=$OrgID‡ndc_lead.lead_id=$LeadID");

141 
$cÚ‹Á
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

142  
$cÚ‹Á
;

143 
	}
}

154 
public
 
funùiÚ
 
	$G‘šfo
(
$OrgID
, 
$DiùA‰r
, 
$L—dA‰r
, 
$L—dID
, 
$is_ed™
 = 
çl£
) {

155 ià(
$L—dID
) {

156 
$cÚ‹Á
 = 
$this
->
	`G‘AÎ
(
$OrgID
, 
$L—dID
);

158 
	`fÜ—ch
 (
$L—dA‰r
 
as
 
$k
 => 
$v
) {

160 
$v
['attr_type']) {

162 ià(
$v
['is_ref_obj']) {

164 
$ObjName
 = 
$v
["ref_obj_name"];

165 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$ObjName
);

167 
$A‰rB—n
["select"] = "TBL_NAME,FLD_NAME,OBJ_NAME";

168 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$obj_d©a
["NAME_ATTR_NAME"];

169 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

170 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

172 
$æd_Çme
 = 
	`¡¹ouµ”
(
$L—dA‰r
[
$v
['referred_by']]['fld_name']);

173 ià(
	`is£t
(
$cÚ‹Á
)) {

174 
$moduË
 = "www/" . 
$©Œ_d©a
["OBJ_NAME"] . "_model";

175 
$this
->
lßd
->
	`mod–
(
$moduË
, 
$ObjName
);

176 
$r_d©a
 = 
$this
->
$ObjName
->
	`S–eùOÃ
(
$OrgID
, 
$cÚ‹Á
[0][
$æd_Çme
]);

177 
$Ëad_d©a
[
$k
] = 
$r_d©a
['Name'];

178 
$Ëad_d©a
[
$k
 . '.Name'] = 
$r_d©a
['Name'];

179 
$Ëad_d©a
[
$k
 . '.ObjName'] = 
$DiùA‰r
[
$©Œ_d©a
["OBJ_NAME"]]["LABEL"];

180 
$Ëad_d©a
[
$k
 . '.RefU¾'] = 
$this
->
RefU¾
 . 
$obj_d©a
['OBJ_TYPE'];

181 
$Ëad_d©a
[
$k
 . '.DŸlogWidth'] = 
$this
->
DŸlogWidth
;

182 
$Ëad_d©a
[
$k
 . '.ID'] = 
$r_d©a
['ID'];

183 
$L—dA‰r
[
$k
]['cÚ‹Á'] = 
$r_d©a
;

185 
$Ëad_d©a
[
$k
] = "";

188 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

189 ià(!
	`em±y
(
$æd_Çme
)) {

190 ià(
	`is£t
(
$cÚ‹Á
)) {

191 ià(
	`is_objeù
(
$cÚ‹Á
[0][
$æd_Çme
])) {

192 
$cÚ‹Á
[0][
$æd_Çme
] = 
	`ba£64_decode
($cÚ‹Á[0][$æd_Çme]->
	`lßd
());

194 
$Ëad_d©a
[
$k
] = 
$cÚ‹Á
[0][
$æd_Çme
];

196 
$Ëad_d©a
[
$k
] = "";

199 
$Ëad_d©a
[
$k
] = "";

204 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

205 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$k
;

206 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

207 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

208 
$LªgId
 = 2;

209 
$A‰rName
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]è? 
$k
 : $attr_data["ENUM_ATTR_NAME"];

210 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

211 ià(!
	`em±y
(
$cÚ‹Á
[0][
$æd_Çme
])) {

213 
$’um
 = 
$this
->->
	`S–eùOÃSŒ
(
$OrgID
, 
$LªgId
, 
$A‰rName
, 
$cÚ‹Á
[0][
$æd_Çme
]);

215 
$Ëad_d©a
[
$k
] = 
$’um
['ENUM_VALUE'];

216 
$Ëad_d©a
[
$k
 . '.’um_key'] = 
$cÚ‹Á
[0][
$æd_Çme
];

217 
$Ëad_d©a
[
$k
 . '.v®ue'] = 
$’um
['ENUM_VALUE'];

219 
$Ëad_d©a
[
$k
] = "";

220 
$Ëad_d©a
[
$k
 . '.enum_key'] = "";

221 
$Ëad_d©a
[
$k
 . '.value'] = "";

223 ià(
$is_ed™
) {

225 
$’um_¬r
 = 
$this
->->
	`G‘EnumA¼
(
$OrgID
, 
$A‰rName
, 
$LªgID
 = 2);

226 
$Ëad_d©a
[
$k
 . '.©Œ_ty³'] = 
$v
['attr_type'];

227 
$Ëad_d©a
[
$k
 . '.’um_¬r'] = 
$’um_¬r
;

231 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

232 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$k
;

233 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

234 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

235 
$LªgId
 = 2;

236 
$A‰rName
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]è? 
$k
 : $attr_data["ENUM_ATTR_NAME"];

237 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

238 ià(!
	`em±y
(
$cÚ‹Á
[0][
$æd_Çme
])) {

240 
$’um
 = 
$this
->->
	`S–eùOÃSŒ
(
$OrgID
, 
$LªgId
, 
$A‰rName
, 
$cÚ‹Á
[0][
$æd_Çme
]);

242 
$Ëad_d©a
[
$k
] = 
$’um
['ENUM_VALUE'];

243 
$Ëad_d©a
[
$k
 . '.’um_key'] = 
$cÚ‹Á
[0][
$æd_Çme
];

244 
$Ëad_d©a
[
$k
 . '.’um_©Œ_Çme'] = 
$A‰rName
;

245 
$Ëad_d©a
[
$k
 . '.v®ue'] = 
$’um
['ENUM_VALUE'];

247 
$Ëad_d©a
[
$k
] = "";

248 
$Ëad_d©a
[
$k
 . '.enum_key'] = "";

249 
$Ëad_d©a
[
$k
 . '.’um_©Œ_Çme'] = 
$A‰rName
;

250 
$Ëad_d©a
[
$k
 . '.value'] = "";

252 ià(
$is_ed™
) {

253 
$’um_¬r
 = 
$this
->->
	`G‘EnumA¼
(
$OrgID
, 
$A‰rName
, 
$LªgID
 = 2);

254 
$Ëad_d©a
[
$k
 . '.©Œ_ty³'] = 
$v
['attr_type'];

255 
$Ëad_d©a
[
$k
 . '.’um_©Œ_Çme'] = 
$A‰rName
;

256 
$Ëad_d©a
[
$k
 . '.’um_¬r'] = 
$’um_¬r
;

262 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

263 ià(
	`is£t
(
$cÚ‹Á
)) {

264 
$cÚ‹Á
[0][
$æd_Çme
] = 
$this
->
	`ToCh¬
($æd_Çme, 
$v
['tbl_Çme'], 
$OrgID
, 
$L—dID
);

265 ià(
	`em±y
(
$cÚ‹Á
[0][
$æd_Çme
])) {

266 
$Ëad_d©a
[
$k
] = "";

268 
$Ëad_d©a
[
$k
] = 
$this
->
	`isD©e
(
$cÚ‹Á
[0][
$æd_Çme
], 8 * 60 * 60);

271 
$Ëad_d©a
[
$k
] = "";

275 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

276 ià(
	`is£t
(
$cÚ‹Á
)) {

277 
$cÚ‹Á
[0][
$æd_Çme
] = 
$this
->
	`ToCh¬
($æd_Çme, 
$v
['tbl_Çme'], 
$OrgID
, 
$L—dID
);

278 ià(
	`em±y
(
$cÚ‹Á
[0][
$æd_Çme
])) {

279 
$Ëad_d©a
[
$k
] = "";

281 
$Ëad_d©a
[
$k
] = 
$this
->
	`isD©eTime
(
$cÚ‹Á
[0][
$æd_Çme
], 8 * 60 * 60);

284 
$Ëad_d©a
[
$k
] = "";

288 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

289 ià(!
	`em±y
(
$æd_Çme
)) {

290 ià(
	`is£t
(
$cÚ‹Á
)) {

291 ià(
	`is_objeù
(
$cÚ‹Á
[0][
$æd_Çme
])) {

292 
$cÚ‹Á
[0][
$æd_Çme
] = 
	`ba£64_decode
($cÚ‹Á[0][$æd_Çme]->
	`lßd
());

294 
$Ëad_d©a
[
$k
] = 
$cÚ‹Á
[0][
$æd_Çme
];

296 
$Ëad_d©a
[
$k
] = "";

299 
$Ëad_d©a
[
$k
] = "";

304  
$Ëad_d©a
;

305 
	}
}

307 
´iv©e
 
funùiÚ
 
	$ToCh¬
(
$æd_Çme
, 
$tbl_Çme
, 
$OrgID
, 
$L—dID
) {

308 
$this
->
db
->
	`£Ëù
("to_ch¬(" . 
$æd_Çme
 . ", 'yyyy-mm-dd hh24:ii:ss')‡s d");

309 
$this
->
db
->
	`äom
(
$tbl_Çme
);

310 
$wh”e
 = 
	`¬¿y
('LEAD_ID' => 
$L—dID
,

311 'ORG_ID' => 
$OrgID
);

312 
$this
->
db
->
	`wh”e
(
$wh”e
);

313 
$dddd
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

314 (
$dddd
[0]['D']);

315 
	}
}

317 
public
 
funùiÚ
 
	$upd©e
(
$ËadID
, 
$L—dA‰r
, 
$d©a
) {

318 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

319 ià(
$L—dA‰r
[
$k
]['tbl_name'] == 'tc_lead') {

320 
$æd_Çme
 = 
	`¡¹ouµ”
(
$L—dA‰r
[
$k
]['fld_name']);

321 
$upd©e1
[
$æd_Çme
] = 
$v
;

322 } 
	`–£if
 (
$L—dA‰r
[
$k
]['tbl_name'] == 'tc_lead_1_1') {

323 
$æd_Çme
 = 
	`¡¹ouµ”
(
$L—dA‰r
[
$k
]['fld_name']);

324 
$upd©e2
[
$æd_Çme
] = 
$v
;

325 } 
	`–£if
 (
$L—dA‰r
[
$k
]['tbl_name'] == 'tc_lead_attr') {

326 
$æd_Çme
 = 
	`¡¹ouµ”
(
$L—dA‰r
[
$k
]['fld_name']);

327 
$upd©e3
[
$æd_Çme
] = 
$v
;

329 
$æd_Çme
 = 
	`¡¹ouµ”
(
$L—dA‰r
[
$k
]['fld_name']);

330 
$upd©e4
[
$æd_Çme
] = 
$v
;

333 
$this
->
db
->
	`upd©e
('tc_Ëad', 
$upd©e1
, 'LEAD_ID=' . 
$ËadID
);

334 
$this
->
db
->
	`upd©e
('tc_Ëad', 
$upd©e2
, 'LEAD_ID=' . 
$ËadID
);

335 
$this
->
db
->
	`upd©e
('tc_Ëad', 
$upd©e3
, 'LEAD_ID=' . 
$ËadID
);

336 
$this
->
db
->
	`upd©e
('tc_Ëad', 
$upd©e4
, 'LEAD_ID=' . 
$ËadID
);

337 
	}
}

345 
´iv©e
 
funùiÚ
 
	$isD©e
(
$d©e
, 
$ex³ris
) {

346  
	`d©e
("Y-m-d", 
	`¡¹Ùime
(
$d©e
è+ 
$ex³ris
);

347 
	}
}

355 
´iv©e
 
funùiÚ
 
	$isD©eTime
(
$D©eTime
, 
$ex³ris
) {

356  
	`d©e
("Y-m-d h:i:s", 
	`¡¹Ùime
(
$D©eTime
è+ 
$ex³ris
);

357 
	}
}

364 
public
 
funùiÚ
 
	$G‘ObjTy³D©a
(
$objTy³A¼
){

365 ifĞ! ( 
	`is_¬¿y
(
$objTy³A¼
è&& 
	`couÁ
($objTypeArr) != 0 ) ){

366  
çl£
;

368 
$£Ëù
 = 
	`¬¿y
(

372 
$ty³_d©a_¬r
 = 
	`¬¿y
();

373 
	`fÜ—ch
(
$objTy³A¼
 
as
 
$v®ue
) {

374 
$cÚd™iÚ
 = 
	`¬¿y
(

375 'OBJ_TYPE' => 
$v®ue
,

378 
$ty³_d©a_¬r
[
$v®ue
] = 
$this
 ->
db


379 -> 
	`£Ëù
(
$£Ëù
è-> 
	`wh”e
(
$cÚd™iÚ
)

380 -> 
	`äom
("tc_ty³"è-> 
	`g‘
()

381 ->
	`»suÉ_¬¿y
();

383  
$ty³_d©a_¬r
;

384 
	}
}

390 
public
 
funùiÚ
 
	$G‘AccouÁName
(
$id
) {

391 
$£Ëù
 = "LEAD_NAME";

392 
$cÚd™iÚ
 = 
	`¬¿y
(

393 'LEAD_ID' => 
$id
,

396 
$d©a
 = 
$this
 ->
db


397 -> 
	`£Ëù
(
$£Ëù
è-> 
	`wh”e
(
$cÚd™iÚ
)

398 -> 
	`äom
("TC_LEAD"è-> 
	`g‘
()

399 -> 
	`row_¬¿y
();

402 if(
	`couÁ
(
$d©a
)){

403  
$d©a
[
$£Ëù
];

405  
çl£
;

408 
	}
}

415 
public
 
funùiÚ
 
	$g‘AccouÁA¼
(
$¬r
,
$´ofe_id
){

416 ifĞ! ( 
	`is_¬¿y
(
$¬r
è&& 
	`couÁ
($arr) != 0 ) ){

417  
çl£
;

420 
$tc_accouÁ
 = 
$this
 -> 
	`SrcT¿nsfÜmDe¡
(
$´ofe_id
);

426 
$d©a
 = 
	`¬¿y
();

427 
	`fÜ—ch
(
$tc_accouÁ
 
as
 
$key
 => 
$v®ue
){

428 
	`fÜ—ch
(
$¬r
 
as
 
$k
 => 
$v
){

429 ifĞ
$k
 =ğ
$v®ue
){

430 
$d©a
[
$key
] = 
$v
;

431 
	`fÜ—ch
(
$¬r
 
as
 
$kk
 => 
$vv
){

432 if(
	`¡½os
(
$kk
,
$k
.'.'è!=ğ
çl£
){

433 
$Ãw
 = 
	`¡r_»¶aû
(
$k
,
$key
,
$kk
);

434 
$d©a
[
$Ãw
] = 
$vv
;

440  
$d©a
;

441 
	}
}

447 
public
 
funùiÚ
 
	$SrcT¿nsfÜmDe¡
(
$´ofe_id
){

448 
$£Ëù
 = 
	`¬¿y
(

452 
$cÚd™iÚ
 = 
	`¬¿y
(

453 '±.´ofe_id' => 
$´ofe_id
,

455 
$qu”y
 = 
$this
 -> 
db
 -> 
	`äom
("tc_profile_trans…t") ->

456 
	`još
('dd_attribute‡1','pt.src_attribute =‡1.attr_name‡nd‡1.org_id = 1','inner') ->

457 
	`još
('dd_attribute‡2','pt.dest_attribute =‡2.attr_name‡nd‡2.org_id = 1','inner') ->

458 
	`wh”e
(
$cÚd™iÚ
è-> wh”e('a1.©Œ_ÇmIS NOT NULL', 
nuÎ
, 
çl£
) ->

459 
	`wh”e
('a2.©Œ_Çmi nÙ‚uÎ', 
nuÎ
, 
çl£
) ->

460 
	`£Ëù
(
$£Ëù
è->
	`g‘
(è->
	`»suÉ_¬¿y
();

461 
$d©a
 = 
	`¬¿y
();

463 
	`fÜ—ch
(
$qu”y
 
as
 
$v®ue
){

464 ifĞ! 
	`em±y
(
$v®ue
["DEST_ATTRIBUTE"]) ) {

465 
$d©a
[
$v®ue
["DEST_ATTRIBUTE"]] = $value["SRC_ATTRIBUTE"];

469  
$d©a
;

470 
	}
}

477 
public
 
funùiÚ
 
	$Ëad_sucûss
(
$id
){

478 
$d©a
["Lead_int04"] = 1001;

479 
$d©a
["Ï¡_Œªsãr_d©e"] = "to_d©e('" . 
	`d©aReduû8
("Y-m-d H:i:s", 
	`d©e
('Y-m-d H:i:s')) . "','yyyy-mm-dd hh24:mi:ss')";

480 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

481 ià(
$k
 == "last_transfer_date") {

482 
$this
->
db
->
	`£t
(
$k
, 
$v
, 
çl£
);

484 
$this
->
db
->
	`£t
(
$k
, 
$v
);

487 
$this
->
db
->
	`wh”e
('Ëad_id', 
$id
);

488 
$»s
 = 
$this
->
db
->
	`upd©e
('tc_lead');

489  
$»s
;

490 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/marteria_model.php

1 <?
php


13 şas 
	cM¬‹rŸ_mod–
 
ex‹nds
 
	mCI_Mod–
 {

15 
´iv©e
 
	m$pÜlDB
;

16 
´iv©e
 
	m$bË
 = "tc_marteria";

17 
´iv©e
 
	m$_ªnounûm’tID
;

18 
´iv©e
 
	m$mod–Requœed
 = 
TRUE
;

19 
´iv©e
 
	m$m¬‹rŸP©h
 = "images/marteriaImages/";

20 
´iv©e
 
	m$feEx‹nsiÚ
 = 
¬¿y
("jpg", "png", "jpeg");

22 
funùiÚ
 
	$__cÚ¡ruù
(){

23 
·»Á
::
	`__cÚ¡ruù
();

24 
$this
->
pÜlDB
 = $this->
lßd
->
	`d©aba£
('pÜl', 
TRUE
);

33 
´iv©e
 
funùiÚ
 
	$g‘F›ldsName
(){

34  
	`¬¿y
(

39 
	}
}

41 
´iv©e
 
funùiÚ
 
	$š™RuË
(
$m¬‹rŸD©a
){

42 
$mod–R‘
 = 
	`mod–Requœed
(
£lf
::
$mod–Requœed
, s–f::
	`g‘F›ldsName
(), 
$m¬‹rŸD©a
);

43  
$mod–R‘
['succ'];

44 
	}
}

54 
public
 
funùiÚ
 
	$§veM¬‹rŸP©h
(
$feTmpDœ
, 
$feName
){

55 
$feWr™eP©h
 = 
£lf
::
$m¬‹rŸP©h
 . 
$feName
;

56 if(
	`fe_exi¡s
(
$feWr™eP©h
))  $fileWritePath;

57 
$feEx‹nsiÚ
 = 
	`·thšfo
(
$feName
, 
PATHINFO_EXTENSION
);

58 if(!
	`š_¬¿y
(
$feEx‹nsiÚ
, 
£lf
::$fileExtension))  'EXTENSION IS FALSE';

59 
$¡»amR—d”
 = 
	`fe_g‘_cÚ‹Ás
(
$feTmpDœ
);

60 
	`fe_put_cÚ‹Ás
(
$feWr™eP©h
, 
$¡»amR—d”
);

61  
$feWr™eP©h
;

62 
	}
}

71 
public
 
funùiÚ
 
	$addM¬‹rŸ
(
$m¬‹rŸD©a
){

72 if(
	`em±y
(
$m¬‹rŸD©a
))

73  
çl£
;

74 
$ruË
 = 
£lf
::
	`š™RuË
(
$m¬‹rŸD©a
);

75 if(
FALSE
 ==ğ
$ruË
)  FALSE;

76 
$f›ldsKeys
 = 
	`im¶ode
(",", 
	`¬¿y_keys
(
$m¬‹rŸD©a
));

77 
$f›ldsV®ues
 = 
	`im¶ode
("','", 
	`¬¿y_v®ues
(
$m¬‹rŸD©a
));

78 
$m¬‹rŸSql
 = " insert intoc_marteria ({$fieldsKeys}) values('{$fieldsValues}')";

79  
FALSE
 ==ğ
$this
->
pÜlDB
->
	`qu”y
(
$m¬‹rŸSql
è? FALSE : $this->pÜlDB->
	`š£¹_id
();

80 
	}
}

90 
public
 
funùiÚ
 
upM¬‹rŸ
(
$m¬‹rŸID
, 
$m¬‹rŸD©a
 = 
	$¬¿y
()){

91 
$¡rS‘
 = 
	`¬¿y
();

92 if(
	`em±y
(
$m¬‹rŸD©a
))

93  
FALSE
;

94 
$ruË
 = 
£lf
::
	`š™RuË
(
$m¬‹rŸD©a
);

95 if(
FALSE
 ==ğ
$ruË
)  FALSE;

96 
	`fÜ—ch
(
$m¬‹rŸD©a
 
as
 
$m¬‹rŸKey
 => 
$m¬‹rŸV®ue
){

97 
$¡rS‘
[] = " {$marteriaKey} = {$marteriaValue} ";

99 
$m¬‹rŸSql
 = " updatec_marteria set ";

100 
$m¬‹rŸSql
 .ğ
	`im¶ode
(",", 
$¡rS‘
);

101 
$m¬‹rŸSql
 .= " where marteriaID = {$marteriaID}";

102  
$this
->
pÜlDB
->
	`qu”y
(
$m¬‹rŸSql
);

103 
	}
}

112 
public
 
funùiÚ
 
g‘Qu”yM¬‹rŸ
(
$m¬‹rŸIDs
 = 
	$¬¿y
()){

113 if(!
	`is_¬¿y
(
$m¬‹rŸIDs
)è 
FALSE
;

114 
$m¬‹rŸInD©a
 = 
	`im¶ode
(',', 
$m¬‹rŸIDs
);

115 
$m¬‹rŸSqlP»ix
 = "select marteria_id, marteria_path, marteria_path fromc_marteria";

116 
$m¬‹rŸInD©a
 = 
	`¡r_»¶aû
(",", "','", $marteriaInData);

117 
$m¬‹rŸSql
 = 
$m¬‹rŸSqlP»ix
 . " where marteria_id in ('{$marteriaIDs}')";

118  
$this
->
pÜlDB
->
	`qu”y
(
$m¬‹rŸSql
)->
	`»suÉ_¬¿y
();

119 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/message_model.php

1 <?
php


2 şas 
	cMes§ge_mod–
 
ex‹nds
 
	mCI_Mod–
{

3 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

4 
·»Á
 :: 
	`__cÚ¡ruù
();

5 
$this
->
lßd
->
	`mod–
('www/objects_model', 'objects');

6 
$this
->
lßd
->
	`mod–
('admin/obj_model', 'obj');

7 
$this
->
lßd
->
	`mod–
('admin/format_model', 'format');

8 
$this
->
lßd
->
	`mod–
('admin/attr_model', 'attr');

9 
$this
->
lßd
->
	`mod–
('www/user_model','user');

10 
$this
->
lßd
->
	`mod–
('www/type_model','type');

19 
public
 
funùiÚ
 
	$g‘Li¡sA‰r
(
$S’iÜQu”yA‰rs
) {

20 
	`exŒaù
(
$S’iÜQu”yA‰rs
, 
EXTR_OVERWRITE
);

21 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 
$obj_Çme
);

22 
	`exŒaù
(
$obj_d©a
, 
EXTR_OVERWRITE
);

24 
$li¡_fÜm©
 = 
$this
->
fÜm©
->
	`G‘Li¡FÜm©
(
$Üg_id
, 
$OBJ_TYPE
, 0);

26 
$Ëad_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$obj_Çme
);

27 
$CŞNames
 = 
$this
->
objeùs
->
	`G‘Li¡CŞNames
(
$li¡_fÜm©
, 
$Ëad_©Œ
, 
$obj_d©a
);

28 
$d©a
["CŞMod–"] = 
$this
->
	`G‘Li¡CŞMod–
(
$li¡_fÜm©
, 
$CŞNames
, 
$obj_d©a
, 
$OBJ_TYPE
);

29 
$d©a
["S’iÜQu”yA‰rJsÚ"] = 
$this
->
objeùs
->
	`g‘S’iÜQu”yA‰rs
(
$Üg_id
, 
$LªgID
, 
$obj_Çme
, 
$obj_d©a
, 
$Ëad_©Œ
);

30  
$d©a
;

31 
	}
}

39 
public
 
funùiÚ
 
G‘Li¡CŞMod–
(
$Li¡FÜm©
, 
$cŞNames
, 
$obj_d©a
, 
$obj_ty³
, 
$Width
 = 200, 
$O³¿tiÚWidth
 = 80, 
$r_ty³
 = "¬¿y", 
$func_Çme
 = 
nuÎ
) {

40 
$»s_d©a
 = 
¬¿y
();

54 
	g$»s_d©a
['CŞ'] = 
¬¿y
();

55 
	g$cŞNames
 = 
jsÚ_decode
(
$cŞNames
, 
Œue
);

56 
fÜ—ch
 (
$Li¡FÜm©
 
as
 
$k
 => 
$v
) {

57 ià(
$v
 =ğ
$obj_d©a
['NAME_ATTR_NAME']) {

58 ià(
em±y
(
$func_Çme
)) {

59 
$»s_d©a
['CŞ'][] = 
¬¿y
(

60 'Name' => 
$v
,

61 'LªgEn' => 
$cŞNames
[
$k
],

62 'U¾' => 
s™e_u¾
("www/mes§ge/v›w"è. "?id={" . 
$obj_d©a
['KEY_ATTR_NAME'] . "}&obj_ty³=" . 
$obj_ty³
,

65 
	g$»s_d©a
['CŞ'][] = 
¬¿y
(

66 'Name' => 
$v
,

67 'LªgEn' => 
$cŞNames
[
$k
],

71 
	g$»s_d©a
['CŞ'][] = 
¬¿y
(

72 'Name' => 
$v
,

73 'LªgEn' => 
$cŞNames
[
$k
],

91 
	g$»s_d©a
['KeyA‰rName'] = 
$obj_d©a
["KEY_ATTR_NAME"];

98 
	g$r_ty³
) {

100  
$»s_d©a
;

103  
jsÚ_’code
(
$»s_d©a
);

106  
jsÚ_’code
(
$»s_d©a
);

107 
	gd›
;

124  
jsÚ_’code
(
$»s_d©a
);

128 
public
 
funùiÚ
 
InfoPag”Li¡
(
$Li¡FÜm©
, 
$L—dA‰r
, 
$obj_d©a
, 
$OrgID
, 
$u£r_id
,
$Cu¼’tPage
 = 1, 
$PageSize
 = 10, 
$wh”e
 = 
	$¬¿y
()) {

129 
$fœ¡_tbl
 = 
$obj_d©a
["MAIN_TABLE"];

130 
$tbl_d©a
 = 
$this
->
	`G‘Tbl
(
$Li¡FÜm©
, 
$L—dA‰r
);

131 
$æd_d©a
 = 
$this
->
	`G‘Fld
(
$Li¡FÜm©
, 
$L—dA‰r
);

132 
	`¬¿y_push
(
$æd_d©a
, 
$fœ¡_tbl
 . "." . 
	`ucfœ¡
(
$obj_d©a
["KEY_ATTR_FLD"]));

133 
$couÁ_tbl
 = 
	`couÁ
(
$tbl_d©a
);

135 ià(!
	`em±y
(
$wh”e
)) {

136 
$w
 = 
$this
->
objeùs
->
	`·r£_w
(
$OrgID
, 
$wh”e
);

137 
$this
->
db
->
	`wh”e
(
$w
, 
NULL
, 
FALSE
);

139 
$this
->
db
->
	`£Ëù
(
$æd_d©a
);

141 ià(
$couÁ_tbl
 == 1) {

142 
$this
->
db
->
	`äom
(
	`cu¼’t
(
$tbl_d©a
));

144 
$this
->
db
->
	`äom
(
$fœ¡_tbl
);

145 
	`fÜ—ch
 (
$tbl_d©a
 
as
 
$k
 => 
$v
) {

146 
$još_Ú
 = "$fœ¡_tbl." . 
$obj_d©a
["KEY_ATTR_FLD"] . " = $v." . $obj_data["KEY_ATTR_FLD"] . "‡nd $v.ORG_ID = $OrgID";

147 ià(
$v
 =ğ
$fœ¡_tbl
) {

150 
$this
->
db
->
	`još
(
$v
, 
$još_Ú
, "inner");

156 
$F‹rPriKey
 = 
$fœ¡_tbl
 . "." . 
$obj_d©a
["KEY_ATTR_FLD"] . ">=";

158 ià(
$obj_d©a
['IS_RECYCLABLE']) {

159 
$IsDEË‹Key
 = 
$fœ¡_tbl
 . "." . "is_deleted";

160 
$F‹rWh”e
[
$IsDEË‹Key
] = 0;

162 
$F‹rWh”e
[
$F‹rPriKey
] = 1;

163 
$OrgIDKey
 = 
$fœ¡_tbl
 . "." . "org_id";

164 
$F‹rWh”e
[
$OrgIDKey
] = 1;

165 
$F‹rWh”e
['»l_mes§ge_u£r.u£r_id'] = 
$u£r_id
;

166 
$this
->
db
->
	`wh”e
(
$F‹rWh”e
);

168 
$this
->
db
->
	`Üd”_by
(
$fœ¡_tbl
 . "." . 
$obj_d©a
["KEY_ATTR_FLD"], "desc");

173 
$this
->
db
->
	`lim™
(
$PageSize
, (
$Cu¼’tPage
 - 1) * $PageSize + 1);

174 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

177 
	`¬¿y_push
(
$Li¡FÜm©
, 
$obj_d©a
["KEY_ATTR_NAME"]);

178 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

179 if(
$v
['READ_FLAG']==0){

180 
$d©a
[
$k
]['MESSAGE_SUBJECT'] = 
$v
['MESSAGE_SUBJECT']."<span class=\"badge badge-pink\">NEW!</span>";

183 ià(!
	`em±y
(
$d©a
)) {

184 
$d©a
 = 
$this
->
objeùs
->
	`FldCÚv”Name
($d©a, 
$Li¡FÜm©
,
$L—dA‰r
);

186 
$d©a
 = 
$this
->
objeùs
->
	`G‘D©aTy³
($d©a, 
$L—dA‰r
, 
$OrgID
);

187 ià(!
	`em±y
(
$»s_d©a
)) {

188 
$d©a
 = 
	`_HashD©a
($d©a, 
$obj_d©a
["KEY_ATTR_NAME"]);

189 
$this
->
objeùs
->
	`InfoM”g”
(
$d©a
, 
$»s_d©a
, 
$©Œ_d©a
, 
$fÜ_d©a
);

191 
$»s_d©a
 = 
$d©a
;

196 
$couÁ
 = 
$this
->
	`InoPageCouÁ
(
$fœ¡_tbl
, 
$obj_d©a
, 
$wh”e
, 
$w
, 
$w1
, 
$w_š
,
$u£r_id
,
$tbl_d©a
);

197  
$this
->
objeùs
->
	`InfoPag”s
(
$Cu¼’tPage
, 
$couÁ
, 
$PageSize
, 
$»s_d©a
);

198 
	}
}

199 
´iv©e
 
funùiÚ
 
	$G‘Tbl
(
$N“dA‰r
, 
$L—dA‰r
) {

200 
$»s_d©a
 = 
	`¬¿y
();

201 
	`fÜ—ch
 (
$N“dA‰r
 
as
 
$k
 => 
$v
) {

202 
$»s_d©a
[
$k
] = 
$L—dA‰r
[
$v
]["tbl_name"];

204  
	`¬¿y_f‹r
(
	`¬¿y_unique
(
$»s_d©a
));

205 
	}
}

206 
´iv©e
 
funùiÚ
 
	$G‘Fld
(
$N“dA‰r
, 
$L—dA‰r
) {

207 
$»s_d©a
 = 
	`¬¿y
();

208 
	`fÜ—ch
 (
$N“dA‰r
 
as
 
$k
 => 
$v
) {

209 ià(!
	`em±y
(
$L—dA‰r
[
$v
]["attr_type"])) {

210 
$L—dA‰r
[
$v
]["attr_type"]) {

212 ià(!
	`em±y
(
$L—dA‰r
[
$v
]["referred_by"])) {

213 
$»s_d©a
[
$k
] = 
$L—dA‰r
[$L—dA‰r[
$v
]["referred_by"]]["tbl_name"] . "." . $LeadAttr[$LeadAttr[$v]["referred_by"]]["fld_name"];

215 
$»s_d©a
[
$k
] = 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"];

219 
$»s_d©a
[
$k
] = "to_ch¬(" . 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"] . ", 'yyyy-mm-dd hh24:ii:ss')‡s " . $LeadAttr[$v]["fld_name"];

222 
$»s_d©a
[
$k
] = "to_ch¬(" . 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"] . ", 'yyyy-mm-dd hh24:ii:ss')‡s " . $LeadAttr[$v]["fld_name"];

225 
$»s_d©a
[
$k
] = 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"];

231  
	`¬¿y_unique
(
$»s_d©a
);

233 
	}
}

234 
´iv©e
 
funùiÚ
 
	$InoPageCouÁ
(
$fœ¡_tbl
, 
$obj_d©a
, 
$wh”e
, 
$w
, 
$w1
, 
$w_š
,
$u£r_id
,
$tbl_d©a
) {

237 ià(!
	`em±y
(
$wh”e
)) {

238 
$this
->
db
->
	`wh”e
(
$w
, 
NULL
, 
FALSE
);

240 ià(!
	`em±y
(
$w_š
)) {

241 
$this
->
db
->
	`wh”e
(
$w_š
, 
NULL
, 
FALSE
);

246 
$this
->
db
->
	`äom
(
$fœ¡_tbl
);

247 
	`fÜ—ch
 (
$tbl_d©a
 
as
 
$k
 => 
$v
) {

248 
$još_Ú
 = "$fœ¡_tbl." . 
$obj_d©a
["KEY_ATTR_FLD"] . " = $v." . $obj_data["KEY_ATTR_FLD"] . "‡nd $v.ORG_ID = 1";

249 ià(
$v
 =ğ
$fœ¡_tbl
) {

252 
$this
->
db
->
	`još
(
$v
, 
$još_Ú
, "inner");

255 
$F‹rPriKey
 = 
$fœ¡_tbl
 . "." . 
$obj_d©a
["KEY_ATTR_FLD"] . ">=";

257 ià(
$obj_d©a
['IS_RECYCLABLE']) {

258 
$IsDEË‹Key
 = 
$fœ¡_tbl
 . "." . "is_deleted";

259 
$F‹rWh”e
[
$IsDEË‹Key
] = 0;

261 
$F‹rWh”e
[
$F‹rPriKey
] = 1;

262 
$OrgIDKey
 = 
$fœ¡_tbl
 . "." . "org_id";

263 
$F‹rWh”e
[
$OrgIDKey
] = 1;

264 
$F‹rWh”e
['»l_mes§ge_u£r.u£r_id'] = 
$u£r_id
;

265 
$this
->
db
->
	`wh”e
(
$F‹rWh”e
);

269 if(!
	`em±y
(
$w1
)){

271 
$this
->
db
->
	`wh”e
(
$w1
, 
NULL
, 
FALSE
);

276 
$couÁ
 = 
$this
->
db
->
	`couÁ_®l_»suÉs
();

277  
$couÁ
;

278 
	}
}

280 
public
 
funùiÚ
 
	$couÁn4
(
$u£r_id
){

281 
$this
->
db
->
	`£Ëù
('a.message_subject,a.message_id');

282 
$this
->
db
->
	`äom
('tc_message_info‡');

283 
$još_Ú
 = 'a.org_id=b.org_id‡nd‡.message_id =b.message_id';

284 
$this
->
db
->
	`još
('»l_mes§ge_u£¸b', 
$još_Ú
, "inner");

288 
$F‹rPriKey
 = "a.message_id>=";

289 
$IsDEË‹Key
 = "a.is_deleted";

290 
$F‹rWh”e
[
$IsDEË‹Key
] = 0;

291 
$F‹rWh”e
[
$F‹rPriKey
] = 1;

292 
$OrgIDKey
 = "a.org_id";

293 
$F‹rWh”e
[
$OrgIDKey
] = 1;

294 
$F‹rWh”e
['b.u£r_id'] = 
$u£r_id
;

295 
$F‹rWh”e
['b.read_flag'] =0;

296 
$this
->
db
->
	`wh”e
(
$F‹rWh”e
);

298 
$this
->
db
->
	`Üd”_by
("a.message_id", "desc");

303 
$this
->
db
->
	`lim™
(4,1);

304 
$»t
['d©a'] = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

305 
	`fÜ—ch
 (
$»t
['d©a'] 
as
 
$k
 => 
$v
) {

306 if(
	`mb_¡¾’
 ( 
$v
['MESSAGE_SUBJECT'],'utf-8')>=15){

307 
$»t
['d©a'][
$k
]['MESSAGE_SUBJECT'] = 
	`mb_sub¡r
(
$v
['MESSAGE_SUBJECT'],0,15,'utf-8').'...';

309 
$»t
['d©a'][
$k
]['MESSAGE_SUBJECT'] = 
$v
['MESSAGE_SUBJECT'];

312 
$»t
['d©a'][
$k
]['u¾'] = 'šdex.php/www/mes§ge/v›w?id='.
$v
['MESSAGE_ID'].'&obj_type=170';

314 
$this
->
db
->
	`£Ëù
('message_subject');

315 
$this
->
db
->
	`äom
('tc_message_info‡');

316 
$this
->
db
->
	`još
('»l_mes§ge_u£¸b', 
$još_Ú
, "inner");

317 
$this
->
db
->
	`wh”e
(
$F‹rWh”e
);

318 
$this
->
db
->
	`Üd”_by
("a.message_id", "desc");

319 
$»t
['couÁ'] = 
$this
->
db
->
	`couÁ_®l_»suÉs
();

320  
$»t
;

321 
	}
}

323 
public
 
funùiÚ
 
	$G‘šfo
(
$OrgID
, 
$ObjA‰r
, 
$u£r_id
,
$Ty³ID
){

324 
	`fÜ—ch
 (
$ObjA‰r
 
as
 
$k
 => 
$v
) {

325 
$v
['attr_type']) {

327 ià(
$v
['is_ref_obj']) {

329 
$RefObjName
 = 
$v
["ref_obj_name"];

330 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$RefObjName
);

332 
$A‰rB—n
["select"] = "TBL_NAME,FLD_NAME,OBJ_NAME";

333 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$obj_d©a
["NAME_ATTR_NAME"];

334 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

335 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

337 
$æd_Çme
 = 
	`¡¹ouµ”
(
$ObjA‰r
[
$v
['referred_by']]['fld_name']);

338 
$objeù_d©a
[
$k
 . '.RefU¾'] = 
$this
->
RefU¾
 . 
$obj_d©a
['OBJ_TYPE'];

339 
$objeù_d©a
[
$k
 . '.Name'] = "";

340 
$objeù_d©a
[
$k
 . '.ObjName'] = 
$DiùA‰r
[
$©Œ_d©a
["OBJ_NAME"]]["LABEL"];

341 
$objeù_d©a
[
$k
 . '.DŸlogWidth'] = 
$this
->
DŸlogWidth
;

342 
$objeù_d©a
[
$k
 . '.ID'] = "";

343 
$objeù_d©a
[
$k
] = "";

346 
$objeù_d©a
[
$k
] = "";

350 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

351 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$k
;

352 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

353 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

354 
$LªgId
 = 2;

355 
$A‰rName
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]è? 
$k
 : $attr_data["ENUM_ATTR_NAME"];

356 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

358 
$objeù_d©a
[
$k
] = "";

359 
$objeù_d©a
[
$k
 . '.enum_key'] = "";

360 
$objeù_d©a
[
$k
 . '.value'] = "";

361 
$’um_¬r
 = 
$this
->->
	`G‘EnumA¼
(
$OrgID
, 
$A‰rName
, 
$LªgID
 = 2);

362 
$objeù_d©a
[
$k
 . '.©Œ_ty³'] = 
$v
['attr_type'];

363 
$objeù_d©a
[
$k
 . '.’um_¬r'] = 
$’um_¬r
;

366 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

367 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$k
;

368 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

369 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

370 
$LªgId
 = 2;

371 
$A‰rName
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]è? 
$k
 : $attr_data["ENUM_ATTR_NAME"];

372 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

373 
$objeù_d©a
[
$k
] = "";

374 
$objeù_d©a
[
$k
 . '.enum_key'] = "";

375 
$objeù_d©a
[
$k
 . '.value'] = "";

376 
$’um_¬r
 = 
$this
->->
	`G‘EnumA¼
(
$OrgID
, 
$A‰rName
, 
$LªgID
 = 2);

377 
$objeù_d©a
[
$k
 . '.©Œ_ty³'] = 
$v
['attr_type'];

378 
$objeù_d©a
[
$k
 . '.’um_©Œ_Çme'] = 
$A‰rName
;

379 
$objeù_d©a
[
$k
 . '.’um_¬r'] = 
$’um_¬r
;

385 
$objeù_d©a
[
$k
] = "";

388 
$objeù_d©a
[
$k
] = "";

391 
$objeù_d©a
[
$k
] = "";

395 
$time
 = 
	`d©e
("Y-m-d H:i:s");

397 
$u£rd©a
 = 
$this
->
u£r
->
	`S–eùOÃ
(
$OrgID
, 
$u£r_id
);

398 
$objeù_d©a
['Mes§geI‹m.C»©edByID'] = 
$u£r_id
;

399 
$objeù_d©a
['Mes§geI‹m.C»©edBy.ID'] = 
$u£r_id
;

400 
$objeù_d©a
['Mes§geI‹m.C»©edBy'] = 
$u£rd©a
['Name'];

401 
$objeù_d©a
['Mes§geI‹m.C»©edBy.Name'] = 
$u£rd©a
['Name'];

402 
$objeù_d©a
['Mes§geI‹m.C»©edTime'] = 
$time
;

403 
$objeù_d©a
['Mes§geI‹m.Ty³.’um_key'] = 
$Ty³ID
;

404 if(
$Ty³ID
==1){

405 
$objeù_d©a
['MessageItem.Type'] = "ç³»ç»Ÿæ¶ˆæ¯";

406 
$objeù_d©a
['MessageItem.Type.value'] = "ç³»ç»Ÿæ¶ˆæ¯";

408 
$objeù_d©a
['MessageItem.Type'] = "å‘˜å·¥æ¶ˆæ¯";

409 
$objeù_d©a
['MessageItem.Type.value'] = "å‘˜å·¥æ¶ˆæ¯";

412  
$objeù_d©a
;

413 
	}
}

415 
public
 
funùiÚ
 
	$»ad_æag
(
$id
,
$Üg_id
,
$u£r_id
){

416 
$upd©e
['read_flag'] = 1;

417 
$wh”e
 = 
	`¬¿y
(

418 'mes§ge_id' => 
$id
,

419 'Üg_id' => 
$Üg_id
,

420 'u£r_id' => 
$u£r_id


422 
$this
->
db
->
	`wh”e
(
$wh”e
);

423 
$this
->
db
->
	`upd©e
('»l_mes§ge_u£r',
$upd©e
);

424 
	}
}

428 
public
 
funùiÚ
 
	$sub¡r_cut
(
$¡r_cut
,
$Ëngth
){

429 ià(
	`¡¾’
(
$¡r_cut
è> 
$Ëngth
){

430 
$i
=0; $˜< 
$Ëngth
; $i++)

431 ià(
	`Üd
(
$¡r_cut
[
$i
]) > 128) $i++;

432 
$¡r_cut
 = 
	`sub¡r
($¡r_cut,0,
$i
)."..";

434  
$¡r_cut
;

435 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/objects_model.php

1 ï»¿<?
php


12 şas 
	cObjeùs_mod–
 
ex‹nds
 
	mCI_Mod–
 {

14 
´iv©e
 
	m$RefTy³
 = '18';

15 
´iv©e
 
	m$RefU¾
 = "";

16 
´iv©e
 
	m$DŸlogWidth
 = 800;

23 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

24 
·»Á
 :: 
	`__cÚ¡ruù
();

25 
$this
->
lßd
->
	`mod–
("admin/obj_model", "obj");

26 
$this
->
lßd
->
	`mod–
("admin/enum_model", "enum");

27 
$this
->
lßd
->
	`mod–
("admin/nextid_model", "nextid");

29 
$this
->
lßd
->
	`mod–
('www/user_model','user');

30 
$this
->
lßd
->
	`mod–
('www/department_model','dept');

31 
$this
->
lßd
->
	`mod–
("admin/type_model", "type");

32 
$this
->
lßd
->
	`mod–
("www/remind_model","remind");

34 
$this
->
RefU¾
 = $this->
cÚfig
->
	`ba£_u¾
(è. $this->cÚfig->
	`™em
(@
šdex_·ge
) . "/www/objects/ajax_lists?obj_type=";

42 
public
 
funùiÚ
 
	$add_©Œibu‹
(
$Li¡FÜm©
,
$obj_d©a
){

43 if(
$obj_d©a
["OBJ_TYPE"] == 1 || $obj_data["OBJ_TYPE"] == 3) {

44 
	`¬¿y_push
(
$Li¡FÜm©
,
$obj_d©a
["OBJ_NAME"].".StopFlag");

46  
$Li¡FÜm©
;

49 
	}
}

61 
public
 
funùiÚ
 
G‘InfoLi¡
(
$Li¡FÜm©
, 
$L—dA‰r
, 
$obj_d©a
, 
$OrgID
, 
$u£r_id
, 
$Cu¼’tPage
 = 1, 
$PageSize
 = 10, 
$wh”e
 = 
¬¿y
(), $user_id = "") {

62 
$fÜ_d©a
 = 
nuÎ
;

63 
	g$Li¡FÜm©
 = 
$this
 -> 
add_©Œibu‹
(
$Li¡FÜm©
,
$obj_d©a
);

64 ià(!
em±y
(
$obj_d©a
['DTL_OBJ_NAME'])) {

65 
	g$©Œs_fÜm©
 = 
$this
->
is_d‘a_fÜm©
(
$Li¡FÜm©
, 
$obj_d©a
, 
$OrgID
);

67 
	g$fÜ_d©a
 = 
$this
->
·r£_fÜm¬t
(
$Li¡FÜm©
);

69 
sÜt
(
$Li¡FÜm©
);

70 ià(!
em±y
(
$©Œs_fÜm©
)) {

71 
	g$L—dA‰r
['»l_cÚd™iÚ'] = 
$©Œs_fÜm©
;

73 
	g$šfo_š
 = 
nuÎ
;

74 ià(
	g$fÜ_d©a
) {

75 
	g$d©a_fÜm©
 = 
$fÜ_d©a
['new_data'];

76 
	g$hi¡Üy_d©a
 = 
$fÜ_d©a
['history_data'];

77 
	g$obj_Çme
 = 
cu¼’t
(
$fÜ_d©a
);

78 
	g$d©a_fÜm©_ËadA‰r
 = 
$this
->
©Œ
->
objeù_©Œ
(1, 
$obj_Çme
);

79 
	g$d©a_fÜm©_obj_d©a
 = 
$this
->
obj
->
NameG‘Obj
(1, 
$obj_Çme
);

80 
	g$»s_d©a
 = 
$this
->
InfoPag”Li¡
(
$Li¡FÜm©
, 
$L—dA‰r
, 
$obj_d©a
, 
$OrgID
, 
$u£r_id
, 
$Cu¼’tPage
, 
$PageSize
, 
$wh”e
, 
$d©a_fÜm©_obj_d©a
, 
nuÎ
, 
$fÜ_d©a
,‚uÎ, 
Œue
);

81 
	g$šfo_š
 = 
$this
->
InfoIn
(
$»s_d©a
, 
$d©a_fÜm©_obj_d©a
, 
$OrgID
);

82  
	g$this
->
InfoPag”Li¡
(
$d©a_fÜm©
, 
$d©a_fÜm©_ËadA‰r
, 
$d©a_fÜm©_obj_d©a
, 
$OrgID
, 
$u£r_id
, 
$Cu¼’tPage
, 
$PageSize
, 
$wh”e
, $d©a_fÜm©_obj_d©a, 
$»s_d©a
, 
$fÜ_d©a
, 
$šfo_š
);

84  
	g$this
->
InfoPag”Li¡
(
$Li¡FÜm©
, 
$L—dA‰r
, 
$obj_d©a
, 
$OrgID
, 
$u£r_id
, 
$Cu¼’tPage
, 
$PageSize
, 
$wh”e
);

90 
´Ùeùed
 
funùiÚ
 
	$is_d‘a_fÜm©
(&
$li¡_fÜm©
, 
$obj_d©a
, 
$Üg_id
) {

91 
$»s_d©a
 = 
	`¬¿y
();

92 
	`exŒaù
(
$obj_d©a
, 
EXTR_OVERWRITE
);

99 
	`fÜ—ch
 (
$li¡_fÜm©
 
as
 
$k
 => &
$v
) {

100 
$hi¡Üy_æd
 = 
$v
;

101 
$©ŒV®ues
 = 
	`CÚv”A¼ay
(
$v
, ".");

102 ià(
	`couÁ
(
$©ŒV®ues
) > 2) {

103 
$©Œ_Çme
 = 
$©ŒV®ues
[0] . "." . $attrValues[1];

104 
$©Œ_sql
 = "select * from dd_attribute where‡ttr_name = '$attr_name'‡nd org_id = $org_id";

105 
$¡r_obj
 = 
$this
->
db
->
	`qu”y
(
$©Œ_sql
)->
	`»suÉ_¬¿y
();

106 
$¡r_obj
 = $str_obj[0];

107 
$¡r_obj_Çme
 = 
$¡r_obj
['REF_OBJ_NAME'];

108 
$¡r_w
 = 
	`¬¿y
(

109 "Üg_id" => 
$Üg_id
,

110 "obj_Çme" => 
$¡r_obj_Çme
,

114 
$this
->
db
->
	`£Ëù
("MAIN_TABLE,KEY_ATTR_FLD");

115 
$this
->
db
->
	`äom
("dd_object");

116 
$this
->
db
->
	`wh”e
(
$¡r_w
);

117 
$»f_obj_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

118 
$»f_obj_d©a
 = $ref_obj_data[0];

120 
$»f_cÚd_w
 = 
	`¬¿y
(

121 "Üg_id" => 
$Üg_id
,

122 "©Œ_Çme" => 
$¡r_obj
['REFERRED_BY'],

124 
$this
->
db
->
	`£Ëù
("TBL_NAME,FLD_NAME");

125 
$this
->
db
->
	`äom
("dd_attribute");

126 
$this
->
db
->
	`wh”e
(
$»f_cÚd_w
);

127 
$»f_cÚd_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

128 
$»f_cÚd_d©a
 = $ref_cond_data[0];

130 
$cÚd_»f
 = 
$»f_obj_d©a
['MAIN_TABLE'] . "." . $»f_obj_d©a['KEY_ATTR_FLD'] . " = " . 
$»f_cÚd_d©a
['TBL_NAME'] . "." . $ref_cond_data['FLD_NAME'];

132 
$this
->
db
->
	`£Ëù
("PARENT_ATTR");

133 
$this
->
db
->
	`äom
("dd_object_option");

134 
$this
->
db
->
	`wh”e
(
$¡r_w
);

135 
$obj_İtiÚ
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

136 
$obj_İtiÚ
 = $obj_option[0];

138 
$©Œ_b—n
['wh”e']['©Œ_Çme'] = 
$obj_İtiÚ
['PARENT_ATTR'];

139 
$©Œ_b—n
['wh”e']['Üg_id'] = 
$Üg_id
;

140 
$©Œs
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$©Œ_b—n
);

141 
	`un£t
(
$©Œ_b—n
);

142 
$©Œ_b—n
['wh”e']['©Œ_Çme'] = 
$©Œs
['REFERRED_BY'];

143 
$©Œ_b—n
['wh”e']['Üg_id'] = 
$Üg_id
;

144 
$©Œs_tbl_»læd
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$©Œ_b—n
);

145 
	`un£t
(
$©Œ_b—n
);

146 
$©Œ_b—n
['wh”e']['©Œ_Çme'] = 
$¡r_obj_Çme
 . "." . 
$©ŒV®ues
[2];

147 
$©Œ_b—n
['wh”e']['Üg_id'] = 
$Üg_id
;

148 
$©Œs_æd
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$©Œ_b—n
);

149 
$li¡_fÜm©
[
$k
] = 
$©Œs_æd
['ATTR_NAME'];

150 
$»s_d©a
[] = 
	`¬¿y
(

151 "©Œs_tbl_»æd" => 
$©Œs_tbl_»læd
,

152 "©Œs_æd" => 
$©Œs_æd
['FLD_NAME'],

153 "hi¡Üy_æd" => 
$hi¡Üy_æd
,

154 "Ãw_æd" => 
$©Œs_æd
['ATTR_NAME'],

155 "cÚd_»f" => 
$cÚd_»f
,

159  
$»s_d©a
;

160 
	}
}

165 
´Ùeùed
 
funùiÚ
 
InfoPag”Li¡
(
$Li¡FÜm©
, 
$L—dA‰r
, 
$obj_d©a
, 
$OrgID
, 
$u£r_id
, 
$Cu¼’tPage
 = 1, 
$PageSize
 = 10, 
$wh”e
 = 
¬¿y
(), 
$d©a_fÜm©_obj_d©a
 = 
nuÎ
, 
$»s_d©a
 =‚uÎ, 
$fÜ_d©a
 =‚uÎ, 
$šfo_š
 =‚uÎ, 
$is_boŞ
 = 
çl£
) {

166 
$this
->
qu”yi¢ÙfÜm©
(
$Li¡FÜm©
, 
$L—dA‰r
);

167 
	g$fœ¡_tbl
 = 
$obj_d©a
["MAIN_TABLE"];

168 ià(
is£t
(
$L—dA‰r
['rel_condition'])) {

169 
	g$»l_cÚd™iÚ
 = 
$L—dA‰r
['rel_condition'];

170 
	g$»l_cÚd
 = 
¬¿y
();

171 
un£t
(
$L—dA‰r
['rel_condition']);

172 
fÜ—ch
 (
$»l_cÚd™iÚ
 
as
 
$k
 => 
$v
) {

173 
$»l_cÚd
[
$v
['attrs_tbl_refld']['TBL_NAME']] = $v['attrs_tbl_refld']['FLD_NAME'];

174 
	g$»l_cÚd
['cÚd_»f'] = 
$v
['cond_ref'];

175 
	g$»l_cÚd_obj_Çme
 = 
$v
['attrs_tbl_refld']['OBJ_NAME'];

176 
	g$»l_»s_d©a
 = 
$this
->
©Œ
->
objeù_©Œ
(
$OrgID
, 
$»l_cÚd_obj_Çme
);

177 
	g$L—dA‰r
 = 
¬¿y_m”ge
(
$L—dA‰r
, 
$»l_»s_d©a
);

180 
	g$tbl_d©a
 = 
$this
->
G‘Tbl
(
$Li¡FÜm©
, 
$L—dA‰r
);

181 
	g$æd_d©a
 = 
$this
->
G‘Fld
(
$Li¡FÜm©
, 
$L—dA‰r
);

182 
¬¿y_push
(
$æd_d©a
, 
$fœ¡_tbl
 . "." . 
ucfœ¡
(
$obj_d©a
["KEY_ATTR_FLD"]));

183 ià(!
em±y
(
$d©a_fÜm©_obj_d©a
)) {

184 
	g$A‰rB—n
['select'] = "*";

185 
	g$A‰rB—n
['wh”e']["FLD_NAME"] = 
$d©a_fÜm©_obj_d©a
["KEY_ATTR_FLD"];

186 
	g$A‰rB—n
['wh”e']['Üg_id'] = 
$OrgID
;

187 
	g$©Œ_d©a
 = 
$this
->
©Œ
->
S–eùOÃ
(
$A‰rB—n
);

188 ià(
	g$is_boŞ
) {

189 
¬¿y_push
(
$æd_d©a
, 
$fœ¡_tbl
 . "." . 
ucfœ¡
(
$d©a_fÜm©_obj_d©a
["KEY_ATTR_FLD"]));

193 ià(!
em±y
(
$wh”e
)) {

194 
	g$this
->
·¿£_tbl
(
$tbl_d©a
, 
$L—dA‰r
, 
$wh”e
);

195 
	g$w
 = 
$this
->
·r£_w
(
$OrgID
, 
$wh”e
);

196 
	g$this
->
	gdb
->
wh”e
(
$w
, 
NULL
, 
FALSE
);

198 ià(!
em±y
(
$šfo_š
)) {

199 
	g$w_š
 = 
$fœ¡_tbl
 . "." . 
$obj_d©a
["KEY_ATTR_FLD"] . " iÀĞ" . 
$šfo_š
 . ")";

200 
	g$this
->
	gdb
->
wh”e
(
$w_š
, 
nuÎ
, 
çl£
);

202 
	g$this
->
	gdb
->
£Ëù
(
$æd_d©a
);

203 
	g$couÁ_tbl
 = 
couÁ
(
$tbl_d©a
);

205 ià(
	g$couÁ_tbl
 == 1) {

206 
$this
->
db
->
äom
(
cu¼’t
(
$tbl_d©a
));

208 
	g$this
->
	gdb
->
äom
(
$fœ¡_tbl
);

209 ià(
is£t
(
$»l_cÚd
)) {

210 
	g$cÚd_»f
 = 
$»l_cÚd
['cond_ref'];

211 
un£t
(
$»l_cÚd
['cond_ref']);

212 
fÜ—ch
 (
$»l_cÚd
 
as
 
$k
 => 
$v
) {

213 
$još_Ú
 = "$fœ¡_tbl." . 
$obj_d©a
["KEY_ATTR_FLD"] . " = $k." . 
$v
;

214 
	g$još_Ú
 .= "‡nd $cond_ref ";

215 
	g$this
->
	gdb
->
još
(
$k
, 
$još_Ú
, "inner");

218 
sÜt
(
$tbl_d©a
);

219 
fÜ—ch
 (
$tbl_d©a
 
as
 
$k
 => 
$v
) {

220 
$još_Ú
 = "$fœ¡_tbl." . 
$obj_d©a
["KEY_ATTR_FLD"] . " = $v." . $obj_data["KEY_ATTR_FLD"] . "‡nd $v.ORG_ID = $OrgID";

221 ià(
	g$v
 =ğ
$fœ¡_tbl
) {

224 
	g$this
->
	gdb
->
još
(
$v
, 
$još_Ú
, "inner");

231 
	g$F‹rPriKey
 = 
$fœ¡_tbl
 . "." . 
$obj_d©a
["KEY_ATTR_FLD"] . ">=";

233 ià(
	g$obj_d©a
['IS_RECYCLABLE']) {

234 
	g$IsDEË‹Key
 = 
$fœ¡_tbl
 . "." . "is_deleted";

235 
	g$F‹rWh”e
[
$IsDEË‹Key
] = 0;

237 
	g$F‹rWh”e
[
$F‹rPriKey
] = 1;

238 
	g$OrgIDKey
 = 
$fœ¡_tbl
 . "." . "org_id";

239 
	g$F‹rWh”e
[
$OrgIDKey
] = 1;

240 
	g$this
->
	gdb
->
wh”e
(
$F‹rWh”e
);

244 
	g$w1
 = 
$this
->
´emissiÚLi¡
(
$obj_d©a
, 
$OrgID
, 
$u£r_id
);

245 
	g$this
->
	gdb
->
wh”e
(
$w1
, 
NULL
, 
FALSE
);

249 
	g$this
->
	gdb
->
Üd”_by
(
$fœ¡_tbl
 . "." . 
$obj_d©a
["KEY_ATTR_FLD"], "desc");

254 
	g$this
->
	gdb
->
lim™
(
$PageSize
, (
$Cu¼’tPage
 - 1) * $PageSize + 1);

255 
	g$d©a
 = 
$this
->
db
->
g‘
()->
»suÉ_¬¿y
();

258 
¬¿y_push
(
$Li¡FÜm©
, 
$obj_d©a
["KEY_ATTR_NAME"]);

262 ià(
is£t
(
$©Œ_d©a
)) {

263 
¬¿y_push
(
$Li¡FÜm©
, 
$©Œ_d©a
["ATTR_NAME"]);

266 ià(!
em±y
(
$d©a
)) {

268 
	g$d©a
 = 
$this
->
FldCÚv”Name
(
$d©a
, 
$Li¡FÜm©
, 
$L—dA‰r
);

270 
	g$d©a
 = 
$this
->
G‘D©aTy³
(
$d©a
, 
$L—dA‰r
, 
$OrgID
);

272 ià(
is£t
(
$»l_cÚd™iÚ
)) {

273 
	g$this
->
cÚdM”g”
(
$d©a
, 
$»l_cÚd™iÚ
);

275 ià(!
em±y
(
$»s_d©a
)) {

276 
	g$d©a
 = 
_HashD©a
(
$d©a
, 
$obj_d©a
["KEY_ATTR_NAME"]);

277 
	g$this
->
InfoM”g”
(
$d©a
, 
$»s_d©a
, 
$©Œ_d©a
, 
$fÜ_d©a
);

279 
	g$»s_d©a
 = 
$d©a
;

282 ià(
	g$is_boŞ
) {

283  
	g$d©a
;

285 
	g$couÁ
 = 
$this
->
InoPageCouÁ
(
$tbl_d©a
, 
$»l_cÚd
, 
$obj_d©a
, 
$wh”e
, 
$w
, 
$w1
, 
nuÎ
, 
$OrgID
);

286  
	g$this
->
InfoPag”s
(
$Cu¼’tPage
, 
$couÁ
, 
$PageSize
, 
$»s_d©a
);

297 
´Ùeùed
 
funùiÚ
 
	$·¿£_tbl
Ğ&
$tbl_d©a
, 
$L—dA‰r
, 
$wh”e
) {

298 
$w_©Œs
 = 
$wh”e
['where'];

299 
	`fÜ—ch
 (
$w_©Œs
 
as
 
$k
 => 
$v
) {

300 ià(
	`is£t
(
$L—dA‰r
[
$v
['©Œ']]è&& !
	`š_¬¿y
($L—dA‰r[$v['©Œ']]['tbl_Çme'], 
$tbl_d©a
)) {

301 
$tbl_d©a
[] = 
$L—dA‰r
[
$v
['attr']]['tbl_name'];

304 
	}
}

309 
´Ùeùed
 
funùiÚ
 
	$cÚdM”g”
(&
$d©a
, 
$»l_cÚd™iÚ
) {

310 
$»l_d©a
 = 
	`_HashD©a
(
$»l_cÚd™iÚ
, 'new_fld');

311 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

312 
	`fÜ—ch
 (
$v
 
as
 
$»l_k
 => 
$»l_v
) {

313 ià(
	`is£t
(
$»l_d©a
[
$»l_k
])) {

314 
$d©a
[
$k
][
$»l_d©a
[
$»l_k
]['hi¡Üy_æd']] = 
$»l_v
;

318 
	}
}

326 
public
 
funùiÚ
 
	$FldCÚv”Name
(
$d©a
, 
$N“dA‰r
, 
$L—dA‰r
) {

327 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

328 
$i
 = 0;

329 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

330 ià(
$kk
 != 'RNUM') {

331 
$Ãwd©a
[
$k
][
$N“dA‰r
[
$i
]] = 
$vv
;

335 
$i
++;

353  
$Ãwd©a
;

354 
	}
}

365 
´Ùeùed
 
funùiÚ
 
	$InfoM”g”
(
$»s_d©a
, &
$d©a
, 
$©Œ_d©a
, 
$fÜ_d©a
) {

366 
	`fÜ—ch
 (
$d©a
 
as
 
$key
 => &
$v®ue
) {

367 ià(
	`is£t
(
$»s_d©a
[
$v®ue
[
$©Œ_d©a
["ATTR_NAME"]]])) {

368 
	`fÜ—ch
 (
$fÜ_d©a
['hi¡Üy_d©a'] 
as
 
$k
 => 
$v
) {

369 
$v®ue
[
$v
] = 
$»s_d©a
[$v®ue[
$©Œ_d©a
["ATTR_NAME"]]][
$fÜ_d©a
['Ãw_d©a'][
$k
]];

373 
	}
}

384 
public
 
funùiÚ
 
	$InfoPag”s
(
$Cu¼’tPage
, 
$couÁ
, 
$PageSize
, 
$d©a
) {

386 
$»¥Úû
->
·ge
 = 
$Cu¼’tPage
;

387 
$»¥Úû
->
»cÜds
 = 
$couÁ
;

388 ià(
$couÁ
 > 0) {

389 
$tÙ®_·ges
 = 
	`û
(
$couÁ
 / 
$PageSize
);

391 
$tÙ®_·ges
 = 0;

393 
$»¥Úû
->
tÙ®
 = 
$tÙ®_·ges
;

395 ià(!
	`em±y
(
$d©a
)) {

396 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

397 
$»¥Úû
->
rows
[
$k
]["ûÎ"] = 
$v
;

401  
	`jsÚ_’code
(
$»¥Úû
);

402 
d›
;

403 
	}
}

418 
´Ùeùed
 
funùiÚ
 
	$InoPageCouÁ
(
$tbl_d©a
, 
$»l_cÚd
, 
$obj_d©a
, 
$wh”e
, 
$w
, 
$w1
, 
$w_š
, 
$OrgID
) {

420 
$fœ¡_tbl
 = 
$obj_d©a
['MAIN_TABLE'];

421 
$couÁ_tbl
 = 
	`couÁ
(
$tbl_d©a
);

423 ià(
$couÁ_tbl
 == 1) {

424 
$this
->
db
->
	`äom
(
	`cu¼’t
(
$tbl_d©a
));

426 
$this
->
db
->
	`äom
(
$fœ¡_tbl
);

427 ià(
	`is£t
(
$»l_cÚd
)) {

428 
$cÚd_»f
 = 
$»l_cÚd
['cond_ref'];

429 
	`un£t
(
$»l_cÚd
['cond_ref']);

430 
	`fÜ—ch
 (
$»l_cÚd
 
as
 
$k
 => 
$v
) {

431 
$još_Ú
 = "$fœ¡_tbl." . 
$obj_d©a
["KEY_ATTR_FLD"] . " = $k." . 
$v
;

432 
$još_Ú
 .= "‡nd $cond_ref ";

433 
$this
->
db
->
	`još
(
$k
, 
$još_Ú
, "inner");

436 
	`sÜt
(
$tbl_d©a
);

437 
	`fÜ—ch
 (
$tbl_d©a
 
as
 
$k
 => 
$v
) {

438 
$još_Ú
 = "$fœ¡_tbl." . 
$obj_d©a
["KEY_ATTR_FLD"] . " = $v." . $obj_data["KEY_ATTR_FLD"] . "‡nd $v.ORG_ID = $OrgID";

439 ià(
$v
 =ğ
$fœ¡_tbl
) {

442 
$this
->
db
->
	`još
(
$v
, 
$još_Ú
, "inner");

446 ià(!
	`em±y
(
$wh”e
)) {

447 
$this
->
db
->
	`wh”e
(
$w
, 
NULL
, 
FALSE
);

449 ià(!
	`em±y
(
$w_š
)) {

450 
$this
->
db
->
	`wh”e
(
$w_š
, 
NULL
, 
FALSE
);

455 
$F‹rPriKey
 = 
$fœ¡_tbl
 . "." . 
$obj_d©a
["KEY_ATTR_FLD"] . ">=";

457 ià(
$obj_d©a
['IS_RECYCLABLE']) {

458 
$IsDEË‹Key
 = 
$fœ¡_tbl
 . "." . "is_deleted";

459 
$F‹rWh”e
[
$IsDEË‹Key
] = 0;

461 
$F‹rWh”e
[
$F‹rPriKey
] = 1;

462 
$OrgIDKey
 = 
$fœ¡_tbl
 . "." . "org_id";

463 
$F‹rWh”e
[
$OrgIDKey
] = 1;

464 
$this
->
db
->
	`wh”e
(
$F‹rWh”e
);

468 
$this
->
db
->
	`wh”e
(
$w1
, 
NULL
, 
FALSE
);

472 
$couÁ
 = 
$this
->
db
->
	`couÁ_®l_»suÉs
();

473  
$couÁ
;

474 
	}
}

484 
´Ùeùed
 
funùiÚ
 
	$InfoIn
(
$»s_d©a
, 
$d©a_fÜm©_obj_d©a
, 
$Üg_id
) {

485 
$w
 = "";

489 
$A‰rB—n
['select'] = "*";

490 
$A‰rB—n
['wh”e']["FLD_NAME"] = 
$d©a_fÜm©_obj_d©a
["KEY_ATTR_FLD"];

491 
$A‰rB—n
['wh”e']['Üg_id'] = 
$Üg_id
;

492 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

493 
	`fÜ—ch
 (
$»s_d©a
 
as
 
$k
 => 
$v
) {

494 
$w
 .ğ
$v
[
$©Œ_d©a
["ATTR_NAME"]] . ",";

496  
	`sub¡r
(
$w
, 0, 
	`¡¾’
($w) - 1);

497 
	}
}

505 
public
 
funùiÚ
 
	$G‘InfoObjeùLi¡
(
$li¡_fÜm©
, 
$Ëad_©Œ
, 
$obj_d©a
, 
$Üg_id
, 
$Cu¼’tPage
, 
$PageSize
, 
$po¡_jsÚ
, 
$cÚd™iÚ
) {

506 
$li¡_fÜm©
 = 
	`ex¶ode
(";", $list_format);

507 
$this
->
	`qu”yi¢ÙfÜm©
(
$li¡_fÜm©
, 
$Ëad_©Œ
);

508 
$li¡_fÜm©
[] = 
$obj_d©a
['KEY_ATTR_NAME'];

509 
$æd_d©a
 = 
$this
->
	`G‘Fld
(
$li¡_fÜm©
, 
$Ëad_©Œ
);

510 
$this
->
	`li¡_objeù_æd
(
$æd_d©a
, 
$obj_d©a
);

511 
$sql
 = 
$this
->
	`»l_·r£_cÚd™iÚ
(
$cÚd™iÚ
, 
$po¡_jsÚ
, 
$obj_d©a
, 
$Ëad_©Œ
, 
$Üg_id
);

512 
$sql
 = "£Ëù " . 
	`im¶ode
(",", 
$æd_d©a
) . $sql;

513 
$sql
 = 
$this
->
	`sql_·r£
($sql, 
$po¡_jsÚ
);

514 
$d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

515 
$r_d©a
 = 
$d©a
;

516 ià(!
	`em±y
(
$d©a
)) {

517 
$d©a
 = 
$this
->
	`FldCÚv”Name
($d©a, 
$li¡_fÜm©
, 
$Ëad_©Œ
);

519 
$this
->
	`Cli¡_objeù_d©a
(
$r_d©a
, 
$d©a
, 
$obj_d©a
);

520 
$d©a
 = 
$this
->
	`G‘D©aTy³
($d©a, 
$Ëad_©Œ
, 
$Üg_id
);

522 
$couÁ
 = 
	`couÁ
(
$d©a
);

523  
$this
->
	`InfoPag”s
(
$Cu¼’tPage
, 
$couÁ
, 
$PageSize
, 
$d©a
);

524 
	}
}

533 
´Ùeùed
 
funùiÚ
 
	$qu”yi¢ÙfÜm©
(&
$li¡_fÜm©
, 
$©Œs
) {

535 
	`fÜ—ch
 (
$li¡_fÜm©
 
as
 
$k
 => 
$v
) {

536 ià(
	`em±y
(
$©Œs
[
$v
]['fld_name']) &&ƒmpty($attrs[$v]['is_ref_obj'])) {

537 
	`un£t
(
$li¡_fÜm©
[
$k
]);

540 
	`sÜt
(
$li¡_fÜm©
);

541 
	}
}

546 
´Ùeùed
 
funùiÚ
 
	$Cli¡_objeù_d©a
Ğ
$r_d©a
, &
$d©a
, 
$obj_d©a
) {

547 
$obj_d©a
['OBJ_TYPE']) {

549 
$this
->
	`CObjeù_d©a
(
$r_d©a
, 
$d©a
);

552 
	}
}

557 
´Ùeùed
 
funùiÚ
 
	$CObjeù_d©a
(
$r_d©a
, &
$d©a
) {

558 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => &
$v
) {

559 
$v
['U£r.IsMa¡”'] = 
$r_d©a
[
$k
]['IS_SELF'] == 1 ? "è´Ÿè´£å‘˜å·¥" : "ç›¸å…³å‘˜å·¥";

561 
	}
}

566 
´Ùeùed
 
funùiÚ
 
	$li¡_objeù_æd
Ğ& 
$æd_d©a
, 
$obj_d©a
) {

567 
$obj_d©a
['OBJ_TYPE']){

569 
$this
->
	`»l_u£r_objeù
(
$æd_d©a
);

572 
	}
}

577 
´Ùeùed
 
funùiÚ
 
	$»l_u£r_objeù
Ğ& 
$æd_d©a
) {

578 
$æd_d©a
[] = "is_self";

579 
	}
}

584 
´Ùeùed
 
funùiÚ
 
	$sql_·r£
(
$sql
, 
$po¡_jsÚ
) {

585 
$po¡_tbl
 = 
$po¡_jsÚ
[0];

586 
$po¡_id
 = 
$po¡_jsÚ
[1];

587 
$po¡_tbl_´im¬y
 = 
$po¡_tbl
['OBJ_TYPE'];

588 
$maš_objeù
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$po¡_tbl_´im¬y
);

589 
$´efix_tbl
 = 
	`¡¹Şow”
(
$maš_objeù
['OBJ_NAME']);

590 ià(!
	`¡½os
(
$sql
, "xxx")) {

591  
$sql
;

593 
$sql
 = 
	`¡r_»¶aû
("xxx", 
$´efix_tbl
, $sql);

594  
$sql
;

595 
	}
}

600 
´Ùeùed
 
funùiÚ
 
	$»l_·r£_cÚd™iÚ
(
$cÚd™iÚ
, 
$po¡_jsÚ
, 
$obj_d©a
, 
$Ëad_©Œ
, 
$Üg_id
) {

601 
$sql
 = "";

602 
$po¡_tbl
 = 
$po¡_jsÚ
[0];

603 
$po¡_id
 = 
$po¡_jsÚ
[1];

604 
$po¡_tbl_´im¬y
 = 
$po¡_tbl
['OBJ_TYPE'];

605 
$po¡_cÚd_id
 = 
$po¡_tbl
['COND_ID'];

606 
$maš_objeù
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$po¡_tbl_´im¬y
);

607 
$maš_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$maš_objeù
['OBJ_NAME']);

608 ià(!
	`em±y
(
$cÚd™iÚ
)) {

609 
	`fÜ—ch
 (
$cÚd™iÚ
 
as
 
$k
 => 
$v
) {

610 
$£Ëù_tbl
 = " from $k $k ";

611 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

612 
$sql
 .= " inner join $kk $kk on ";

613 
	`fÜ—ch
 (
$vv
 
as
 
$cÚd_k
 => 
$cÚd_v
) {

614 
$sql
 .ğ
$cÚd_k
 . "=" . 
$cÚd_v
;

615 
$sql
 .= "‡nd $kk.org_id = $org_id ";

619 
$sql
 = 
$£Ëù_tbl
 . $sql;

620 
$sql_cÚd
 = "select cond_attr,cond_value1,cond_value2,is_reference fromc_user_rel_condition where org_id=$org_id‡nd cond_id = $post_cond_id";

621 
$cÚd_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql_cÚd
)->
	`»suÉ_¬¿y
();

623 
$cÚd_»s
 = 
$this
->
	`»l_to_cÚd
(
$cÚd_d©a
, 
$maš_©Œ
, 
$Ëad_©Œ
, 
$po¡_id
);

624 
	`fÜ—ch
 (
$cÚd_»s
 
as
 
$k
 => 
$v
) {

625 
$sql
 .ğ" wh”" . 
$maš_objeù
['MAIN_TABLE'] . ".$k = $v‡nd";

627 
$sql
 = 
	`sub¡r
($sql, 0, 
	`¡¼pos
($sql, "and", -1));

628  
$sql
;

630 
$sql_cÚd
 = "select cond_attr,cond_value1,cond_value2,is_reference fromc_user_rel_condition where org_id=$org_id‡nd cond_id = $post_cond_id";

631 
$cÚd_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql_cÚd
)->
	`»suÉ_¬¿y
();

633 
$cÚd_»s
 = 
$this
->
	`»l_to_emp_cÚd
(
$cÚd_d©a
, 
$maš_objeù
, 
$maš_©Œ
, 
$obj_d©a
, 
$Ëad_©Œ
, 
$po¡_id
);

636 
$sql
 = " from " . 
$maš_objeù
['MAIN_TABLE'] . " " . $main_object['MAIN_TABLE'];

637 
$sql
 .ğ" iÂ” još " . 
$obj_d©a
['MAIN_TABLE'] . " " . $obj_data['MAIN_TABLE'];

638 
$sql_šÃr
 = "";

639 
	`fÜ—ch
 (
$cÚd_»s
 
as
 
$k
 => 
$v
) {

640 
$sql_šÃr
 .= " " . "$k = $v‡nd";

642 
$sql
 = $sqÈ. " oÀ" . 
$sql_šÃr
;

643 
$sql
 = 
	`sub¡r
($sql, 0, 
	`¡¼pos
($sql, "and", -1));

644 
$sql
 .ğ" wh”" . 
$maš_objeù
['MAIN_TABLE'] . "." . $maš_objeù['KEY_ATTR_FLD'] . "=" . 
$po¡_id
['id'];

645  
$sql
;

647 
d›
;

648 
	}
}

653 
´Ùeùed
 
funùiÚ
 
	$»l_·r£
(
$po¡_jsÚ
, 
$obj_d©a
, 
$Ëad_©Œ
, 
$Üg_id
) {

654 
$po¡_tbl
 = 
$po¡_jsÚ
[0];

655 
$po¡_id
 = 
$po¡_jsÚ
[1];

656 
$po¡_tbl_´im¬y
 = 
$po¡_tbl
['OBJ_TYPE'];

657 
$po¡_tbl_d©a
 = 
$po¡_tbl
['REL_TABLES'];

658 
$po¡_cÚd_id
 = 
$po¡_tbl
['COND_ID'];

660 
$maš_objeù
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$po¡_tbl_´im¬y
);

662 
$maš_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$maš_objeù
['OBJ_NAME']);

664 
$»l_d©a
 = 
	`ex¶ode
(";", 
$po¡_tbl_d©a
);

665 
$»l_d©a
 = 
$this
->
	`»l_to_¬rs
($rel_data);

668 
$sql
 = "select cond_attr,cond_value1,cond_value2,is_reference fromc_user_rel_condition where org_id=$org_id‡nd cond_id = $post_cond_id";

669 
$cÚd_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

671 
$cÚd_»s
 = 
$this
->
	`»l_to_cÚd
(
$cÚd_d©a
, 
$maš_©Œ
, 
$Ëad_©Œ
, 
$po¡_id
);

672 
$sql
 = " from " . 
$maš_objeù
['MAIN_TABLE'];

673 
$i
 = 0;

674 
	`fÜ—ch
 (
$»l_d©a
 
as
 
$k
 => 
$v
) {

676 
$i
++;

677 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

678 
$¡r
 = 
$vv
[2];

679 
	`un£t
(
$vv
[2]);

680 
$sql
 .ğ
$this
->
	`$¡r
(
$k
, 
$vv
, 
$maš_objeù
, 
$obj_d©a
, 
$po¡_id
, 
$Üg_id
, 
$i
);

683 
	`fÜ—ch
 (
$cÚd_»s
 
as
 
$k
 => 
$v
) {

684 
$sql
 .ğ" wh”" . 
$maš_objeù
['MAIN_TABLE'] . ".$k = $v‡nd";

686 
$sql
 = 
	`sub¡r
($sql, 0, 
	`¡¼pos
($sql, "and", -1));

687  
$sql
;

689 
	}
}

694 
´Ùeùed
 
funùiÚ
 
	$MF
(
$k
, 
$vv
, 
$maš_objeù
, 
$obj_d©a
, 
$po¡_id
, 
$Üg_id
, 
$i
) {

695 
$»l_w
 = 
$k
 . "." . 
$vv
[1];

696 
$maš_w
 = 
$maš_objeù
['MAIN_TABLE'] . "." . $main_object['KEY_ATTR_FLD'];

697 
$sql
 = "†eá još $k oÀ" . 
$»l_w
 . " = " . 
$maš_w
 . "‡nd " . $»l_w . " = " . 
$po¡_id
['id'];

698  
$sql
;

699 
	}
}

704 
´Ùeùed
 
funùiÚ
 
	$SF
(
$k
, 
$vv
, 
$maš_objeù
, 
$obj_d©a
, 
$po¡_id
, 
$Üg_id
, 
$i
) {

705 ià(
$i
 == 1) {

706 
$tbl_®Ÿs
 = 
$obj_d©a
['MAIN_TABLE'];

708 
$tbl_®Ÿs
 = 
$obj_d©a
['MAIN_TABLE'] . "_" . 
$i
;

710 
$tbl
 = 
$obj_d©a
['MAIN_TABLE'] . " " . 
$tbl_®Ÿs
;

711 
$»l_w
 = 
$tbl_®Ÿs
 . "." . 
$obj_d©a
['KEY_ATTR_FLD'];

712 
$»l_w1
 = 
$k
 . "." . 
$vv
[1];

713 
$sql
 = "†eá još $tbÈÚ $»l_w = $»l_w1‡nd " . 
$obj_d©a
['MAIN_TABLE'] . ".Üg_id = " . 
$Üg_id
;

714  
$sql
;

715 
	}
}

720 
´Ùeùed
 
funùiÚ
 
	$FC
(
$k
, 
$vv
, 
$maš_objeù
, 
$obj_d©a
, 
$po¡_id
, 
$Üg_id
, 
$i
) {

721 
$sql
 = "‡nd $k." . 
$vv
[0] . " = " . $vv[1];

722  
$sql
;

723 
	}
}

733 
´Ùeùed
 
funùiÚ
 
	$»l_to_emp_cÚd
(
$cÚd_d©a
, 
$maš_obj
, 
$maš_©Œ
, 
$»l_obj
, 
$Ëad_©Œ
, 
$po¡_id
) {

734 
$»s_d©a
 = 
	`¬¿y
();

735 
	`fÜ—ch
 (
$cÚd_d©a
 
as
 
$key
 => 
$v®ue
) {

736 
$cÚd_w
 = 
	`ex¶ode
(".", 
$v®ue
['COND_ATTR']);

737 ià(
	`š_¬¿y
("ObjeùID", 
$cÚd_w
) || in_array("ObjectType", $cond_w)) {

738 
$»s_d©a
[
$maš_obj
['MAIN_TABLE'] . "." . $maš_obj["KEY_ATTR_FLD"]] = 
$»l_obj
['MAIN_TABLE'] . "." . $main_obj["KEY_ATTR_FLD"];

740 ià(
$v®ue
['IS_REFERENCE'] == "1") {

741 
$»s_d©a
[
$»l_obj
['MAIN_TABLE'] . "." . 
$Ëad_©Œ
[
$v®ue
['COND_ATTR']]['æd_Çme']] = 
$maš_obj
['MAIN_TABLE'] . "." . 
$maš_©Œ
[$value['COND_VALUE1']]['fld_name'];

743 
$»s_d©a
[
$»l_obj
['MAIN_TABLE'] . "." . 
$Ëad_©Œ
[
$v®ue
['COND_ATTR']]['fld_name']] = $value['COND_VALUE1'];

747  
$»s_d©a
;

748 
	}
}

758 
´Ùeùed
 
funùiÚ
 
	$»l_to_cÚd
(
$cÚd_d©a
, 
$maš_©Œ
, 
$Ëad_©Œ
, 
$po¡_id
) {

759 
$»s_d©a
 = 
	`¬¿y
();

760 
	`fÜ—ch
 (
$cÚd_d©a
 
as
 
$key
 => 
$v®ue
) {

761 ià(
$v®ue
['IS_REFERENCE'] == "1") {

762 
$»s_d©a
[
$maš_©Œ
[
$v®ue
['COND_ATTR']]['æd_Çme']] = 
$po¡_id
['id'];

764 
$»s_d©a
[
$maš_©Œ
[
$v®ue
['COND_ATTR']]['fld_name']] = $value['COND_VALUE1'];

767  
$»s_d©a
;

768 
	}
}

777 
´Ùeùed
 
funùiÚ
 
	$»l_to_¬rs
(
$»l_¬rs
) {

778 
$»s_d©a
 = 
	`¬¿y
();

784 
	`fÜ—ch
 (
$»l_¬rs
 
as
 
$k
 => 
$v
) {

785 
$¬rs
 = 
	`ex¶ode
(":", 
$v
);

786 
$maš_key
 = 
$¬rs
[0];

787 
	`un£t
(
$¬rs
[0]);

788 
	`fÜ—ch
 (
$¬rs
 
as
 
$kk
 => 
$vv
) {

789 
$¬rs_vv
 = 
	`ex¶ode
(",", 
$vv
);

790 
$»s_d©a
[
$maš_key
][
$kk
] = 
$¬rs_vv
;

793  
$»s_d©a
;

794 
	}
}

799 
public
 
funùiÚ
 
´emissiÚLi¡
(
$objD©a
, 
$OrgID
, 
$u£r_id
 = 
nuÎ
, 
$İ”©iÚ_´emiss
 = "read") {

800 
$u£r_id
 = 
em±y
($u£r_idè? 
$this
->
£ssiÚ
->
u£rd©a
('user_id') : $user_id;

801 
	g$´emissLi¡
 = 
$this
->
´emiss_d©a_İ¿tiÚ
(
$objD©a
, 
$OrgID
, 
$u£r_id
, 
$İ”©iÚ_´emiss
);

803 
	g$´emiss_¡r
 = 
sub¡r
(
$´emissLi¡
, 0, 1);

804 ià(
em±y
(
$´emissLi¡
)) {

805 
	g$´emiss_¡r
 = 5;

807 
	g$´emiss_¡r
) {

812  
$this
->
Re¥ÚsibË
(
$objD©a
, 
$OrgID
, 
$u£r_id
, 
Œue
);

815  
$this
->
Re¥ÚsibË
(
$objD©a
, 
$OrgID
, 
$u£r_id
);

818  
$this
->
cÜ»sPÚdšg
(
$objD©a
, 
$OrgID
, 
$u£r_id
, 
Œue
);

821  
$this
->
cÜ»sPÚdšg
(
$objD©a
, 
$OrgID
, 
$u£r_id
);

827 
	gd›
;

832 
public
 
funùiÚ
 
´emissiÚLi¡2
(
$objD©a
, 
$bË
, 
$OrgID
, 
$u£r_id
 = 
nuÎ
, 
$İ”©iÚ_´emiss
 = "read") {

833 
$u£r_id
 = 
em±y
($u£r_idè? 
$this
->
£ssiÚ
->
u£rd©a
('user_id') : $user_id;

834 
	g$´emissLi¡
 = 
$this
->
´emiss_d©a_İ¿tiÚ
(
$objD©a
, 
$OrgID
, 
$u£r_id
, 
$İ”©iÚ_´emiss
);

836 
	g$´emiss_¡r
 = 
sub¡r
(
$´emissLi¡
, 0, 1);

837 ià(
em±y
(
$´emissLi¡
)) {

838 
	g$´emiss_¡r
 = 5;

840 
	g$´emiss_¡r
) {

845  
$this
->
Re¥ÚsibË2
(
$objD©a
, 
$bË
, 
$OrgID
, 
$u£r_id
, 
Œue
);

848  
$this
->
Re¥ÚsibË2
(
$objD©a
, 
$bË
, 
$OrgID
, 
$u£r_id
);

851  
$this
->
cÜ»sPÚdšg2
(
$objD©a
, 
$bË
, 
$OrgID
, 
$u£r_id
, 
Œue
);

854  
$this
->
cÜ»sPÚdšg2
(
$objD©a
, 
$bË
, 
$OrgID
, 
$u£r_id
);

860 
	gd›
;

865 
public
 
funùiÚ
 
	$Re¥ÚsibË2
(
$objD©a
, 
$bË
, 
$OrgID
, 
$u£r_id
, 
$is_£lf
 = 
FALSE
) {

866 
	`exŒaù
(
$objD©a
, 
EXTR_OVERWRITE
);

867 
$sql
 = 
	`¡¹Şow”
(
$bË
è. "." . 
$KEY_ATTR_FLD
 . " in (";

868 
$tbl_Çme
 = "»l_" . 
	`¡¹Şow”
(
$OBJ_NAME
) . "_user";

869 ià(!
$is_£lf
) {

870 
$sql
 .ğ" s–eù $tbl_Çme." . 
$KEY_ATTR_FLD
 . " from $tbl_name where $tbl_name.org_id = $OrgID‡nd $tbl_name.user_id = $user_id ";

872 
$sql
 .ğ" s–eù $tbl_Çme." . 
$KEY_ATTR_FLD
 . " from $tbl_name where $tbl_name.org_id = $OrgID‡nd $tbl_name.user_id = $user_id‡nd $tbl_name.is_self = 1 ";

874 
$sql
 .= ")";

875  
$sql
;

876 
d›
;

877 
	}
}

882 
public
 
funùiÚ
 
	$cÜ»sPÚdšg2
(
$objD©a
, 
$bË
, 
$OrgID
, 
$u£r_id
, 
$is_£lf
 = 
FALSE
) {

883 
	`exŒaù
(
$objD©a
, 
EXTR_OVERWRITE
);

884 
$sql
 = "select * fromc_user where user_id = $user_id‡nd org_id = $OrgID";

885 
$row_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

886 
$row_d©a
 = $row_data[0];

887 
$D•t_ID
 = 
$row_d©a
['DEPT_ID'];

888 
$sql
 = "select * fromc_department where org_id = $OrgID‡nd dept_id = $Dept_ID";

889 
$d•t_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

890 
$d•t_d©a
 = $dept_data[0];

891 
$Œ“_·th
 = 
$d•t_d©a
['TREE_PATH'];

892 
$sql
 = 
	`¡¹Şow”
(
$bË
) . "." . "$KEY_ATTR_FLD in (";

893 
	`un£t
(
$sql
);

894 
$tbl_u£r_Çme
 = "»l_" . 
	`¡¹Şow”
(
$OBJ_NAME
) . "_user";

895 
$tbl_´ivege_Çme
 = "»l_" . 
	`¡¹Şow”
(
$OBJ_NAME
) . "_privilege";

896 
$sql
 = 
	`¡¹Şow”
(
$bË
è. "." . 
$KEY_ATTR_FLD
 . " in (";

897 
$sql
 .ğ" s–eù $tbl_u£r_Çme." . 
$KEY_ATTR_FLD
 . " from $tbl_user_name where $tbl_user_name.org_id = $OrgID‡nd $tbl_user_name.user_id = $user_id";

898 
$sql
 .= " union ";

899 ià(!
$is_£lf
) {

900 
$sql
 .ğ" s–eù $tbl_´ivege_Çme." . 
$KEY_ATTR_FLD
 . " from $tbl_privilege_name where $tbl_privilege_name.privilege_id in (select dept_id fromc_department wherec_department.org_id = $OrgID‡ndc_department.tree_path†ike '$tree_path%') ";

902 
$sql
 .ğ" s–eù $tbl_´ivege_Çme." . 
$KEY_ATTR_FLD
 . " from $tbl_privilege_name where $tbl_privilege_name.org_id = $OrgID‡nd $tbl_privilege_name.privilege_id = $Dept_ID ";

904 
$sql
 .= ")";

905  
$sql
;

906 
d›
;

907 
	}
}

917 
public
 
funùiÚ
 
´emissiÚAù
(
$objD©a
, 
$OrgID
, 
$u£r_id
 = 
nuÎ
, 
$aù_¡r
 = "add") {

918 
$u£r_id
 = 
em±y
($u£r_idè? 
$this
->
£ssiÚ
->
u£rd©a
('user_id') : $user_id;

919 
	g$´emissLi¡
 = 
$this
->
´emiss_d©a_İ¿tiÚ
(
$objD©a
, 
$OrgID
, 
$u£r_id
, "other");

920 
	g$aù_¡r
) {

922  
sub¡r
(
$´emissLi¡
, 0, 1);

925  
sub¡r
(
$´emissLi¡
, 1, 1);

928  
sub¡r
(
$´emissLi¡
, 2, 1);

931  
sub¡r
(
$´emissLi¡
, 3, 1);

934  
sub¡r
(
$´emissLi¡
, 4, 1);

937  
sub¡r
(
$´emissLi¡
, 5, 1);

940  
sub¡r
(
$´emissLi¡
, 6, 1);

943  
sub¡r
(
$´emissLi¡
, 7, 1);

949 
	gd›
;

955 
public
 
funùiÚ
 
	$Re¥ÚsibË
(
$objD©a
, 
$OrgID
, 
$u£r_id
, 
$is_£lf
 = 
FALSE
) {

956 
	`exŒaù
(
$objD©a
, 
EXTR_OVERWRITE
);

957 
$sql
 = 
	`¡¹Şow”
(
$MAIN_TABLE
è. "." . 
$KEY_ATTR_FLD
 . " in (";

958 
$tbl_Çme
 = "»l_" . 
	`¡¹Şow”
(
$OBJ_NAME
) . "_user";

959 ià(!
$is_£lf
) {

960 
$sql
 .ğ" s–eù $tbl_Çme." . 
$KEY_ATTR_FLD
 . " from $tbl_name where $tbl_name.org_id = $OrgID‡nd $tbl_name.user_id = $user_id ";

962 
$sql
 .ğ" s–eù $tbl_Çme." . 
$KEY_ATTR_FLD
 . " from $tbl_name where $tbl_name.org_id = $OrgID‡nd $tbl_name.user_id = $user_id‡nd $tbl_name.is_self = 1 ";

964 
$sql
 .= ")";

965  
$sql
;

966 
d›
;

967 
	}
}

972 
public
 
funùiÚ
 
	$cÜ»sPÚdšg
(
$objD©a
, 
$OrgID
, 
$u£r_id
, 
$is_£lf
 = 
FALSE
) {

973 
	`exŒaù
(
$objD©a
, 
EXTR_OVERWRITE
);

974 
$sql
 = "select * fromc_user where user_id = $user_id‡nd org_id = $OrgID";

975 
$row_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

976 
$row_d©a
 = $row_data[0];

977 
$D•t_ID
 = 
$row_d©a
['DEPT_ID'];

978 
$sql
 = "select * fromc_department where org_id = $OrgID‡nd dept_id = $Dept_ID";

979 
$d•t_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

980 
$d•t_d©a
 = $dept_data[0];

981 
$Œ“_·th
 = 
$d•t_d©a
['TREE_PATH'];

982 
$sql
 = 
	`¡¹Şow”
(
$MAIN_TABLE
) . "." . "$KEY_ATTR_FLD in (";

983 
	`un£t
(
$sql
);

984 
$tbl_u£r_Çme
 = "»l_" . 
	`¡¹Şow”
(
$OBJ_NAME
) . "_user";

985 
$tbl_´ivege_Çme
 = "»l_" . 
	`¡¹Şow”
(
$OBJ_NAME
) . "_privilege";

986 
$sql
 = 
	`¡¹Şow”
(
$MAIN_TABLE
è. "." . 
$KEY_ATTR_FLD
 . " in (";

987 
$sql
 .ğ" s–eù $tbl_u£r_Çme." . 
$KEY_ATTR_FLD
 . " from $tbl_user_name where $tbl_user_name.org_id = $OrgID‡nd $tbl_user_name.user_id = $user_id";

988 
$sql
 .= " union ";

989 ià(!
$is_£lf
) {

990 
$sql
 .ğ" s–eù $tbl_´ivege_Çme." . 
$KEY_ATTR_FLD
 . " from $tbl_privilege_name where $tbl_privilege_name.privilege_id in (select dept_id fromc_department wherec_department.org_id = $OrgID‡ndc_department.tree_path†ike '$tree_path%') ";

992 
$sql
 .ğ" s–eù $tbl_´ivege_Çme." . 
$KEY_ATTR_FLD
 . " from $tbl_privilege_name where $tbl_privilege_name.org_id = $OrgID‡nd $tbl_privilege_name.privilege_id = $Dept_ID ";

994 
$sql
 .= ")";

995  
$sql
;

996 
d›
;

997 
	}
}

1002 
public
 
funùiÚ
 
	$´emiss_d©a_İ¿tiÚ
(
$objD©a
, 
$OrgID
, 
$u£r_id
, 
$İ”©iÚ_´emiss
) {

1003 
	`exŒaù
(
$objD©a
, 
EXTR_OVERWRITE
);

1004 
$w
 = "";

1005 
$sql
 = "select„ead_privilege,edit_privilege,delete_privilege,other_privilege fromc_user_scope where user_id = $user_id‡nd org_id = $OrgID‡nd obj_type = $OBJ_TYPE";

1006 
$row
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

1007 
$f›lds
 = 
	`¡¹ouµ”
(
$İ”©iÚ_´emiss
 . "_privilege");

1008  
$row
[0][
$f›lds
];

1009 
d›
;

1010 
	}
}

1018 
´iv©e
 
funùiÚ
 
	$·r£_w
(
$OrgID
, 
$Wh”e
) {

1019 
$L—dA‰r
 = 
$this
->
©Œ
->
	`objeù_©Œ
(1, 
NULL
);

1020 
	`exŒaù
(
$Wh”e
, 
EXTR_OVERWRITE
);

1021 
$sql_w
 = 
	`¬¿y
();

1022 
$obj_d©a
 = 
$this
->
obj
->
	`ObjP¬£D©a
($this->obj->
	`NameG‘Obj
(1, 
NULL
, 
TRUE
));

1023 
$i
 = 
	`couÁ
(
$wh”e
); $i > 0; $i--) {

1024 
$»l
 = 
	`¡r_»¶aû
(
$i
, "rel_" . $i, $rel);

1026 
	`fÜ—ch
 (
$wh”e
 
as
 
$k
 => 
$v
) {

1027 
$©Œ_v®ues
 = 
	`CÚv”A¼ay
(
$v
['attr'], '.');

1028 
$s_©Œ_v®ues
 = 
$©Œ_v®ues
;

1031 ià(
	`couÁ
(
$©Œ_v®ues
) > 2) {

1032 
$this
->
	`·r£A‰r
(
$L—dA‰r
, 
$obj_d©a
, 
$©Œ_v®ues
, 
$v
, 
$sql
);

1034 
$»s_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

1035 
$¡r_v®ues
 = 
	`im¶ode_r
(
	`¬¿y
(","), 
$»s_d©a
);

1036 
$æd
 = 
$L—dA‰r
[$L—dA‰r[
$s_©Œ_v®ues
[0] . "." . $s_attr_values[1]]['referred_by']]['fld_name'];

1037 
$v
['v®ue'] = 
$¡r_v®ues
;

1038 
$v
['action'] = 'INC';

1041 
$æd
 = 
$L—dA‰r
[
$v
["attr"]]['fld_name'];

1042 ià(
	`em±y
(
$æd
)) {

1043 
$©Œ_v®ues
 = 
$L—dA‰r
[
$v
["attr"]];

1044 ià(
$©Œ_v®ues
["attr_type"] == 4 && $attr_values["is_ref_obj"] == 1) {

1045 
$æd
 = 
$L—dA‰r
[$L—dA‰r[
$v
["attr"]]["referred_by"]]["fld_name"];

1049 
$v
['action']) {

1051 
$w
 = 
$æd
 . ' IS NULL';

1054 
$w
 = 
$æd
 . ' IS NOT NULL';

1057 
$w
 = 
$æd
 . ' !ğ\'' . 
$v
['value'] . '\'';

1060 
$w
 = 
$æd
 . ' > \'' . 
$v
['value'] . '\'';

1063 
$w
 = 
$æd
 . ' >ğ\'' . 
$v
['value'] . '\'';

1066 
$w
 = 
$æd
 . ' < \'' . 
$v
['value'] . '\'';

1069 
$equ®_v®ue
 = 
	`is£t
(
$v
['value']) ? $v['value'] : $v['value2'];

1070 
$w
 = 
$æd
 . ' = \'' . 
$equ®_v®ue
 . '\'';

1073 
$w
 = 
$æd
 . ' <ğ\'' . 
$v
['value'] . '\'';

1076 
$v
['v®ue'] = 
	`¡r_»¶aû
(',', '\',\'', $v['value']);

1077 
$w
 = 
$æd
 . ' IN(\'' . 
$v
['value'] . '\')';

1080 
$v
['v®ue'] = 
	`¡r_»¶aû
(',', '\',\'', $v['value']);

1081 
$w
 = 
$æd
 . ' NOT IN(\'' . 
$v
['value'] . '\')';

1084 ià(
	`´eg_m©ch
("/[0-9]{4}-[0-9]{1,2}-[0-9]{1,2}/", 
$v
['value2'])) {

1086 ià(
	`¡¾’
(
$v
['v®ue2']è<ğ10 
ªd
 strlen($v['value2']) >= 8) {

1087 
$v
['value2'] = $v['value2'] . " 23:59:59";

1090 
$w
 = 
$æd
 . ' >=' . "to_d©e('" . 
$v
['value1'] . "', 'yyyy-mm-dd hh24:mi:ss')" . ' AND ' . $fld . ' <= ' . "to_date('" . $v['value2'] . "', 'yyyy-mm-dd hh24:mi:ss')";

1093 
$w
 = 
$æd
 . " LIKE '%" . 
$v
['value'] . "%'";

1096 
$w
 = 
$æd
 . " NOT LIKE '%" . 
$v
['value'] . "%'";

1099 
$w
 = 
$æd
 . " < " . "to_d©e('" . 
$v
['value'] . "', 'yyyy-mm-dd hh24:mi:ss')" . "";

1102 
$w
 = 
$æd
 . " > " . "to_d©e('" . 
$v
['value'] . "', 'yyyy-mm-dd hh24:mi:ss')" . "";

1105 
$w
 = 
$æd
 . " >ğ" . "to_d©e('" . 
	`d©e
("Y-m-d H:i:s", 
	`¡¹Ùime
("-$v[value1] $v[value2]")) . "', 'yyyy-mm-dd hh24:mi:ss')" . "";

1108 
$w
 = 
$æd
 . " >ğ" . "to_d©e('" . 
	`d©e
("Y-m-d H:i:s", 
	`¡¹Ùime
("+$v[value1] $v[value2]")) . "', 'yyyy-mm-dd hh24:mi:ss')" . "";

1111 
$w
 = " 1 = 1 ";

1114 
$w
 = 
$æd
 . ' = \'' . 
$v
['value'] . '\'';

1117 ià(!
	`em±y
(
$w
)) {

1118 
$sql_w
[
$k
] = 
$w
;

1119 
$»l
 = 
	`¡r_»¶aû
("»l_" . 
$k
, 
$w
, $rel);

1122  
$»l
;

1123 
	}
}

1129 
´iv©e
 
funùiÚ
 
	$·r£A‰r
(
$L—dA‰r
, 
$obj_d©a
, &
$©Œ_v®ues
, 
$v®ue
, &
$sql
) {

1130 
$äu™
 = 
	`¬¿y_shiá
(
$©Œ_v®ues
);

1131 
	`fÜ—ch
 (
$©Œ_v®ues
 
as
 
$k
 => 
$v
) {

1132 ià(
$L—dA‰r
[
$äu™
 . "." . 
$v
]['attr_type'] == "4" && $LeadAttr[$fruit . "." . $v]['is_ref_obj'] == "1") {

1133 
$©Œ_v®ues
[
$k
] = 
$L—dA‰r
[
$äu™
 . "." . 
$v
]['ref_obj_name'];

1134 
$this
->
	`·r£A‰r
(
$L—dA‰r
, 
$obj_d©a
, 
$©Œ_v®ues
, 
$v®ue
, 
$sql
);

1136 
$tbl_Çme
 = 
$L—dA‰r
[
$äu™
 . "." . 
$v
]['tbl_name'];

1137 
$æd_Çme
 = 
$L—dA‰r
[
$äu™
 . "." . 
$v
]['fld_name'];

1138 
$obj_Çme
 = 
$L—dA‰r
[
$äu™
 . "." . 
$v
]['ref_obj_name'];

1139 
$KEY_ATTR_FLD
 = 
$obj_d©a
[
$äu™
]['KEY_ATTR_FLD'];

1140 
$sql
 = "£Ëù " . 
$KEY_ATTR_FLD
 . " from " . 
$tbl_Çme
 . " where ";

1142 
$v®ue
['action']) {

1144 
$sql
 .ğ
$æd_Çme
 . ' IS NULL';

1147 
$sql
 .ğ
$æd_Çme
 . ' IS NOT NULL';

1150 
$sql
 .ğ
$æd_Çme
 . ' !ğ\'' . 
$v®ue
['value'] . '\'';

1153 
$sql
 .ğ
$æd_Çme
 . ' > \'' . 
$v®ue
['value'] . '\'';

1156 
$sql
 .ğ
$æd_Çme
 . ' >ğ\'' . 
$v®ue
['value'] . '\'';

1159 
$sql
 .ğ
$æd_Çme
 . ' < \'' . 
$v®ue
['value'] . '\'';

1162 
$sql
 = 
$æd_Çme
 . ' = \'' . 
$v®ue
['value'] . '\'';

1165 
$sql
 .ğ
$æd_Çme
 . ' <ğ\'' . 
$v®ue
['value'] . '\'';

1168 
$v®ue
['v®ue'] = 
	`¡r_»¶aû
(',', '\',\'', $value['value']);

1169 
$sql
 .ğ
$æd_Çme
 . ' IN(\'' . 
$v®ue
['value'] . '\')';

1172 
$v®ue
['v®ue'] = 
	`¡r_»¶aû
(',', '\',\'', $value['value']);

1173 
$sql
 .ğ
$æd_Çme
 . ' NOT IN(\'' . 
$v®ue
['value'] . '\')';

1176 ià(
	`´eg_m©ch
("/[0-9]{4}-[0-9]{1,2}-[0-9]{1,2}/", 
$v®ue
['value2'])) {

1178 ià(
	`¡¾’
(
$v®ue
['v®ue2']è<ğ10 
ªd
 strlen($value['value2']) >= 8) {

1179 
$v®ue
['value2'] = $value['value2'] . " 23:59:59";

1182 
$sql
 .ğ
$æd
 . ' >=' . "to_d©e('" . 
$v®ue
['value1'] . "', 'yyyy-mm-dd hh24:mi:ss')" . ' AND ' . $fld . ' <= ' . "to_date('" . $value['value2'] . "', 'yyyy-mm-dd hh24:mi:ss')";

1185 
$sql
 .ğ
$æd_Çme
 . " LIKE '%" . 
$v®ue
['value'] . "%'";

1188 
$sql
 .ğ
$æd_Çme
 . " NOT LIKE '%" . 
$v®ue
['value'] . "%'";

1191 
$sql
 .ğ
$æd
 . " < " . "to_d©e('" . 
$v®ue
['value'] . "', 'yyyy-mm-dd hh24:mi:ss')" . "";

1194 
$sql
 .ğ
$æd
 . " > " . "to_d©e('" . 
$v®ue
['value'] . "', 'yyyy-mm-dd hh24:mi:ss')" . "";

1197 
$sql
 .ğ
$æd
 . " >ğ" . "to_d©e('" . 
	`d©e
("Y-m-d H:i:s", 
	`¡¹Ùime
("-$value[value1] $value[value2]")) . "', 'yyyy-mm-dd hh24:mi:ss')" . "";

1200 
$sql
 .ğ
$æd
 . " >ğ" . "to_d©e('" . 
	`d©e
("Y-m-d H:i:s", 
	`¡¹Ùime
("+$value[value1] $value[value2]")) . "', 'yyyy-mm-dd hh24:mi:ss')" . "";

1203 
$sql
 .= " 1=1 ";

1206 
$sql
 .ğ
$æd_Çme
 . ' = \'' . 
$v®ue
['value'] . '\'';

1211 
	}
}

1221 
public
 
funùiÚ
 
	$G‘Li¡CŞNames
(
$Li¡FÜm©
, 
$L—dA‰r
, 
$obj_d©a
, 
$Üg_id
 = 1, 
$Ïng_id
 = 2) {

1222 
$»s_d©a
 = 
$this
->
	`li¡CŞNames
(
$Li¡FÜm©
, 
$L—dA‰r
, 
$obj_d©a
, 
$Üg_id
, 
$Ïng_id
);

1223  
	`jsÚ_’code
(
$»s_d©a
);

1224 
	}
}

1229 
´Ùeùed
 
funùiÚ
 
	$li¡CŞNames
(
$Li¡FÜm©
, 
$L—dA‰r
, 
$obj_d©a
, 
$Üg_id
 = 1, 
$Ïng_id
 = 2) {

1230 
$»s_d©a
 = 
	`¬¿y
();

1231 
$i
 = 0;

1232 
	`fÜ—ch
 (
$Li¡FÜm©
 
as
 
$k
 => 
$v
) {

1233 
$©ŒV®ues
 = 
	`CÚv”A¼ay
(
$v
, ".");

1234 ià(
	`couÁ
(
$©ŒV®ues
) > 2) {

1235 
$¡r_©Œs
 = 
$this
->
©Œ
->
	`objeù_©Œ
(1, 
$©ŒV®ues
[1]);

1236 
$¡r_v®ues
 = 
$©ŒV®ues
[1] . "." . $attrValues[2];

1237 
$»s_d©a
[
$i
] = 
$¡r_©Œs
[
$¡r_v®ues
]["label"];

1238 ià(
	`em±y
(
$»s_d©a
[
$i
])) {

1240 
$©Œ_Çme
 = 
$©ŒV®ues
[0] . "." . $attrValues[1];

1241 
$sql
 = "select * from dd_attribute where‡ttr_name = '$attr_name'‡nd org_id =$org_id";

1242 
$»s_©Œ_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

1243 
$»s_©Œ_d©a
 = $res_attr_data[0];

1244 
$obj_Çme
 = 
$»s_©Œ_d©a
['REF_OBJ_NAME'];

1246 
$diù_Çme
 = 
$obj_Çme
 . "." . 
$©ŒV®ues
[2];

1247 
$sql
 = "select * from dd_dict_str where org_id = $org_id‡nd dict_name = '$dict_name'‡nd†ang_id = $lang_id";

1248 
$»s_diù_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

1249 
$»s_diù_d©a
 = $res_dict_data[0];

1251 
$sql
 = "select * from dd_dict_str where org_id = $org_id‡nd dict_name = '$obj_name'‡nd†ang_id = $lang_id";

1252 
$»s_obj_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

1253 
$»s_obj_d©a
 = $res_obj_data[0];

1255 
$»s_d©a
[
$i
] = 
$»s_obj_d©a
['LABEL'] . "-" . 
$»s_diù_d©a
['LABEL'];

1258 
$»s_d©a
[
$i
] = 
$L—dA‰r
[
$v
]["label"];

1260 
$i
++;

1262  
$»s_d©a
;

1263 
	}
}

1271 
public
 
funùiÚ
 
	$G‘D©aTy³
(
$d©a
, 
$L—dA‰r
, 
$OrgID
) {

1272 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

1273 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

1274 
$»s_d©a
 = 
$this
->
	`·¿£Ty³
(
$L—dA‰r
[
$kk
], $kk, 
$vv
, 
$OrgID
, 
$d©a
[
$k
][$kk], 
Œue
);

1276 ià(
	`is_¬¿y
(
$»s_d©a
)) {

1278 
	`fÜ—ch
 (
$»s_d©a
 
as
 
$r_k
 => 
$r_v
) {

1279 
$d_v
 = 
$kk
 . "." . 
$r_k
;

1280 
$d©a
[
$k
][
$d_v
] = 
$r_v
;

1283 
$d©a
[
$k
][
$kk
] = 
$»s_d©a
;

1287  
$d©a
;

1288 
	}
}

1295 
public
 
funùiÚ
 
	$g‘Li¡sA‰r
(
$S’iÜQu”yA‰rs
) {

1296 
	`exŒaù
(
$S’iÜQu”yA‰rs
, 
EXTR_OVERWRITE
);

1297 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 
$obj_Çme
);

1298 
	`exŒaù
(
$obj_d©a
, 
EXTR_OVERWRITE
);

1300 
$li¡_fÜm©
 = 
$this
->
fÜm©
->
	`G‘Li¡FÜm©
(
$Üg_id
, 
$OBJ_TYPE
, 
$u£r_id
);

1302 
$Ëad_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$obj_Çme
);

1303 
$CŞNames
 = 
$this
->
	`G‘Li¡CŞNames
(
$li¡_fÜm©
, 
$Ëad_©Œ
, 
$obj_d©a
);

1304 
$d©a
["CŞMod–"] = 
$this
->
	`G‘Li¡CŞMod–
(
$li¡_fÜm©
, 
$CŞNames
, 
$obj_d©a
, 
$OBJ_TYPE
);

1305 
$d©a
["S’iÜQu”yA‰rJsÚ"] = 
$this
->
	`g‘S’iÜQu”yA‰rs
(
$Üg_id
, 
$LªgID
, 
$obj_Çme
, 
$obj_d©a
, 
$Ëad_©Œ
);

1306  
$d©a
;

1307 
	}
}

1314 
public
 
funùiÚ
 
	$g‘AjaxLi¡sA‰r
(
$S’iÜQu”yA‰rs
, 
$is_fÜm©
 = 
çl£
, 
$func_Çme
 = 
nuÎ
) {

1315 
	`exŒaù
(
$S’iÜQu”yA‰rs
, 
EXTR_OVERWRITE
);

1316 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 
$obj_Çme
);

1317 
	`exŒaù
(
$obj_d©a
, 
EXTR_OVERWRITE
);

1319 
$li¡_fÜm©
 = 
	`em±y
(
$li¡_fÜm©s
è? 
$this
->
fÜm©
->
	`G‘Li¡FÜm©
(
$Üg_id
, 
$OBJ_TYPE
, 
$u£r_id
) : $list_formats;

1321 
$Ëad_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$obj_Çme
);

1322 
$d©a
["obj_d©a"] = 
$obj_d©a
;

1323 
$cŞNames
 = 
$this
->
	`G‘Li¡CŞNames
(
$li¡_fÜm©
, 
$Ëad_©Œ
, 
$obj_d©a
);

1324 
$d©a
["CŞMod–"] = 
$this
->
	`G‘Li¡CŞMod–
(
$li¡_fÜm©
, 
$cŞNames
, 
$obj_d©a
, 
$OBJ_TYPE
, 200, 25, "¬¿y", 
$func_Çme
);

1325 if(
$obj_Çme
 == 'Type'){

1326 
$d©a
["CŞMod–"] = 
	`¬¿y
(

1327 'CŞ'=>
	`¬¿y
(

1328 0 =>
	`¬¿y
(

1336 ià(
$is_fÜm©
) {

1337  
$d©a
;

1340 
$d©a
["S’iÜQu”yA‰rJsÚ"] = 
$this
->
	`g‘S’iÜQu”yA‰rs
(
$Üg_id
, 
$LªgID
, 
$obj_Çme
, 
$obj_d©a
, 
$Ëad_©Œ
);

1341  
$d©a
;

1342 
	}
}

1351 
public
 
funùiÚ
 
	$li¡_objeù_cŞ
Ğ& 
$d©a
, 
$sqid
) {

1352 
$sqid
) {

1354 
$this
->
	`»l_u£r_li¡
(
$d©a
);

1357 
	}
}

1365 
´Ùeùed
 
funùiÚ
 
	$»l_u£r_li¡
Ğ& 
$d©a
 ) {

1366 
$»¥ÚsibË_u£r
 = 
	`¬¿y
(

1370 
$d©a
['CŞMod–']['CŞ'][] = 
$»¥ÚsibË_u£r
;

1371 
	}
}

1379 
public
 
funùiÚ
 
G‘Li¡CŞMod–
(
$Li¡FÜm©
, 
$cŞNames
, 
$obj_d©a
, 
$obj_ty³
, 
$Width
 = 200, 
$O³¿tiÚWidth
 = 80, 
$r_ty³
 = "¬¿y", 
$func_Çme
 = 
nuÎ
) {

1380 
$»s_d©a
 = 
¬¿y
();

1381 
	g$»s_d©a
['CŞ'] = 
¬¿y
();

1382 
	g$cŞNames
 = 
jsÚ_decode
(
$cŞNames
, 
Œue
);

1383 
fÜ—ch
 (
$Li¡FÜm©
 
as
 
$k
 => 
$v
) {

1384 ià(
$v
 =ğ
$obj_d©a
['NAME_ATTR_NAME']) {

1385 ià(
em±y
(
$func_Çme
)) {

1386 
$»s_d©a
['CŞ'][] = 
¬¿y
(

1387 'Name' => 
$v
,

1388 'LªgEn' => 
$cŞNames
[
$k
],

1389 'U¾' => 
s™e_u¾
("www/objeùs/v›w"è. "?id={" . 
$obj_d©a
['KEY_ATTR_NAME'] . "}&obj_ty³=" . 
$obj_ty³
,

1392 if(
	g$obj_ty³
==10){

1393 
$»s_d©a
['CŞ'][] = 
¬¿y
(

1394 'Name' => 
$v
,

1395 'LªgEn' => 
$cŞNames
[
$k
],

1396 'U¾' => 
s™e_u¾
("www/objeùs/v›w"è. "?id={" . 
$obj_d©a
['KEY_ATTR_NAME'] . "}&obj_type=" . 14,

1399 
	g$»s_d©a
['CŞ'][] = 
¬¿y
(

1400 'Name' => 
$v
,

1401 'LªgEn' => 
$cŞNames
[
$k
],

1402 'U¾' => 
s™e_u¾
("www/objeùs/v›w"è. "?id={" . 
$obj_d©a
['KEY_ATTR_NAME'] . "}&obj_ty³=" . 
$obj_ty³
,

1408 
	g$»s_d©a
['CŞ'][] = 
¬¿y
(

1409 'Name' => 
$v
,

1410 'LªgEn' => 
$cŞNames
[
$k
],

1414 
	g$»s_d©a
['KeyA‰rName'] = 
$obj_d©a
["KEY_ATTR_NAME"];

1415 
	g$r_ty³
) {

1417  
$»s_d©a
;

1420  
jsÚ_’code
(
$»s_d©a
);

1423  
jsÚ_’code
(
$»s_d©a
);

1424 
	gd›
;

1431 
public
 
funùiÚ
 
	$®l_©Œ
(
$obj_Çme
) {

1432 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
("1", 
$obj_Çme
);

1433 
$Ëad_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
("1", 
$obj_Çme
);

1434  
$this
->
	`g‘S’iÜQu”yA‰rs
("1", "2", 
$obj_Çme
, 
$obj_d©a
, 
$Ëad_©Œ
);

1435 
	}
}

1445 
public
 
funùiÚ
 
	$g‘S’iÜQu”yA‰rs
(
$Üg_id
, 
$LªgID
, 
$obj_Çme
, 
$obj_d©a
, 
$Ëad_©Œ
) {

1446 
$DiùA‰r
 = 
	`_HashD©a
(
$this
->
obj
->
	`NameG‘CnDiù
(
$Üg_id
, 
$LªgID
), "DICT_NAME");

1452 
$dis_d©a
 = 
$this
->
	`g‘A‰rDi¡ªù
(
$Üg_id
, 
$obj_Çme
, 
$obj_d©a
, 
$DiùA‰r
, 
$Ëad_©Œ
);

1453 
$objeù_©Œ
 = 
$this
->
	`g‘A‰rQu”y
(
$Üg_id
, 
$obj_Çme
, 
$obj_d©a
, 
$DiùA‰r
, 
$Ëad_©Œ
, 
Œue
, 
$dis_d©a
);

1454 
$d©a
["S’iÜQu”yA‰rJsÚ"] = 
$this
->
	`g‘ObjA‰rs
(
$objeù_©Œ
);

1455  
	`jsÚ_’code
(
$d©a
["SeniorQueryAttrJson"]);

1456 
	}
}

1468 
´iv©e
 
funùiÚ
 
	$g‘A‰rQu”y
(
$Üg_id
, 
$obj_Çme
, 
$obj_d©a
, 
$DiùA‰r
, 
$Ëad_©Œ
, 
$isboŞ
 = 
çl£
, 
$dis_d©a
 = 
nuÎ
) {

1469  
$this
->
	`G‘S’iÜQu”yA‰r
(
$Üg_id
, 
$obj_Çme
, 
$obj_d©a
, 
$DiùA‰r
, 
$Ëad_©Œ
, 
$isboŞ
, 
$dis_d©a
);

1470 
	}
}

1482 
´iv©e
 
funùiÚ
 
	$G‘S’iÜQu”yA‰r
(
$OrgID
, 
$objName
, 
$ObjD©a
, 
$DiùA‰r
, 
$Ëad_©Œ
, 
$isboŞ
 = 
çl£
, 
$dis_d©a
 = 
nuÎ
) {

1488 
$objeù_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$objName
, 
Œue
);

1489 
	`fÜ—ch
 (
$objeù_©Œ
 
as
 
$k
 => &
$v
) {

1490 
$this
->
	`·¿£Qu”yTy³
(
$k
, 
$OrgID
, 
$v
, 
$ObjD©a
, 
$DiùA‰r
, 
$Ëad_©Œ
, 
$isboŞ
, 
$dis_d©a
);

1492  
$objeù_©Œ
;

1493 
	}
}

1500 
´iv©e
 
funùiÚ
 
	$g‘ObjA‰rs
(
$objeù_©Œ
) {

1501 
$i
 = 0;

1502 
	`fÜ—ch
 (
$objeù_©Œ
 
as
 
$k
 => 
$v
) {

1503 
$d©a
[
$i
]['©Œ_ty³'] = 
$v
['attr_type'];

1504 
$d©a
[
$i
]['Çme'] = 
$k
;

1505 
$d©a
[
$i
]['Ïb–'] = 
$v
['label'];

1506 ià(
	`is£t
(
$v
['enum_arr'])) {

1507 
	`fÜ—ch
 (
$v
['’um_¬r'] 
as
 
$kk
 => 
$vv
) {

1508 
$d©a
[
$i
]['fÜm_d©a']['’um_¬r'][
$kk
]['’um_key'] = 
$vv
['ENUM_KEY'];

1509 
$d©a
[
$i
]['fÜm_d©a']['’um_¬r'][
$kk
]['’um_v®ue'] = 
$vv
['ENUM_VALUE'];

1512 ià(
	`is£t
(
$v
['attr_ref'])) {

1513 
$d©a
[
$i
]['fÜm_d©a']['ObjName'] = 
$v
['©Œ_»f'][
$k
 . ".ObjName"];

1514 
$d©a
[
$i
]['fÜm_d©a']['RefU¾'] = 
$v
['©Œ_»f'][
$k
 . ".RefUrl"];

1515 
$d©a
[
$i
]['fÜm_d©a']['DŸlogWidth'] = 
$v
['©Œ_»f'][
$k
 . ".DialogWidth"];

1517 
$i
++;

1519 
	`fÜ—ch
 (
$objeù_©Œ
 
as
 
$key
 => 
$v®ue
) {

1520 
	`fÜ—ch
 (
$v®ue
 
as
 
$k
 => 
$v
) {

1521 ià(
	`is_¬¿y
(
$v
è&& !
	`em±y
($vè&& 
	`¡½os
(
$k
, ".")) {

1522 
$d©a
[
$i
]['©Œ_ty³'] = 
$v
['attr_type'];

1523 
$d©a
[
$i
]['Çme'] = 
$k
;

1524 
$d©a
[
$i
]['Ïb–'] = 
$v
['label'];

1525 ià(
	`is£t
(
$v
['enum_arr'])) {

1526 
	`fÜ—ch
 (
$v
['’um_¬r'] 
as
 
$kk
 => 
$vv
) {

1527 
$d©a
[
$i
]['fÜm_d©a']['’um_¬r'][
$kk
]['’um_key'] = 
$vv
['ENUM_KEY'];

1528 
$d©a
[
$i
]['fÜm_d©a']['’um_¬r'][
$kk
]['’um_v®ue'] = 
$vv
['ENUM_VALUE'];

1531 ià(
	`is£t
(
$v
['attr_ref'])) {

1532 
$»f_key
 = 
$v®ue
['»f_key'] . "." . 
	`’d
(
	`ex¶ode
(".", 
$k
));

1533 
$d©a
[
$i
]['fÜm_d©a']['ObjName'] = 
$v
['©Œ_»f'][
$»f_key
 . ".ObjName"];

1534 
$d©a
[
$i
]['fÜm_d©a']['RefU¾'] = 
$v
['©Œ_»f'][
$»f_key
 . ".RefUrl"];

1535 
$d©a
[
$i
]['fÜm_d©a']['DŸlogWidth'] = 
$v
['©Œ_»f'][
$»f_key
 . ".DialogWidth"];

1537 
$i
++;

1541  
$d©a
;

1542 
	}
}

1552 
´iv©e
 
funùiÚ
 
	$g‘A‰rDi¡ªù
(
$Üg_id
, 
$obj_Çme
, 
$obj_d©a
, 
$DiùA‰r
, 
$Ëad_©Œ
) {

1553 
$dis_d©a
 = 
	`_CÚv”OÃA¼ay
(
$this
->
©Œ
->
	`objeù_©Œ_di¡nù
(
$obj_Çme
));

1554 
$»s_d©a
 = 
	`¬¿y
();

1555 
	`fÜ—ch
 (
$dis_d©a
 
as
 
$k
 => 
$v
) {

1556 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 
$v
);

1557 
$»s_d©a
[
$v
] = 
$this
->
	`g‘A‰rQu”y
(
$Üg_id
, $v, 
$obj_d©a
, 
$DiùA‰r
, 
$Ëad_©Œ
);

1559  
$»s_d©a
;

1560 
	}
}

1571 
´iv©e
 
funùiÚ
 
	$·¿£Qu”yTy³
(
$qu”y_key
, 
$OrgID
, &
$qu”y_v®ue
, 
$ObjD©a
, 
$DiùA‰r
, 
$Ëad_©Œ
, 
$isboŞ
 = 
çl£
, 
$dis_d©a
 = 
nuÎ
) {

1572 
	`exŒaù
(
$qu”y_v®ue
, 
EXTR_OVERWRITE
);

1579 
$©Œ_ty³
) {

1581 
$this
->
	`qu”yIsRefObj
(
$qu”y_key
, 
$OrgID
, 
$qu”y_v®ue
, 
$ObjD©a
, 
$DiùA‰r
, 
$Ëad_©Œ
, 
$isboŞ
, 
$dis_d©a
);

1587 
$this
->
	`qu”yIsEnum
(
$qu”y_key
, 
$OrgID
, 
$qu”y_v®ue
, 
$Ëad_©Œ
);

1590  
$qu”y_v®ue
;

1593 
	}
}

1603 
public
 
funùiÚ
 
	$·¿£Ty³
(
$L—dA‰r
, 
$©Œ_key
, 
$©Œ_v®ue
, 
$OrgID
, &
$d©as
, 
$is_»f
 = 
FALSE
) {

1605 
$ty³Id
 = 
$L—dA‰r
["attr_type"];

1606 
$is_»f_obj
 = 
$L—dA‰r
["is_ref_obj"];

1607 
$ty³Id
) {

1615  
$this
->
	`isRefObj
(
$is_»f_obj
, 
$©Œ_key
, 
$L—dA‰r
, 
$OrgID
, 
$©Œ_v®ue
, 
$d©as
, 
$is_»f
);

1619 
$this
->
	`is_check
(
$©Œ_v®ue
);

1620  
$©Œ_v®ue
;

1624  
$this
->
	`isEnum
(
$©Œ_key
, 
$©Œ_v®ue
, 
$OrgID
, 
$LªgId
, 
$A‰rName
, 
$EnumKey
, 
$d©as
, 
$is_»f
);

1632  
$this
->
	`isD©e
(
$d©as
, 8 * 60 * 60);

1635  
$this
->
	`isD©eTime
(
$d©as
, 8 * 60 * 60);

1638 ià(
	`is_objeù
(
$©Œ_v®ue
)) {

1639 
$blob
 = !
	`em±y
(
$©Œ_v®ue
è? 
	`ba£64_decode
($©Œ_v®ue->
	`lßd
()) : base64_decode($attr_value);

1641  
$blob
;

1644  
$©Œ_v®ue
;

1646  
$©Œ_v®ue
;

1649 
	}
}

1654 
public
 
funùiÚ
 
	$is_check
(&
$v
) {

1655 ià(
$v
 == 1) {

1656 
$v
 = "æ˜¯";

1658 
$v
 = "å¦";

1660 
	}
}

1671 
´iv©e
 
funùiÚ
 
	$isRefObj
(
$is_»f_obj
, 
$©Œ_key
, 
$L—dA‰r
, 
$OrgID
, 
$©Œ_v®ue
, &
$d©as
, 
$is_»f
) {

1678 ià(
$is_»f_obj
 == "1") {

1683 
$»ãr_objeù
 = 
$L—dA‰r
["ref_obj_name"];

1684 
$tbl_Çme
 = 
$L—dA‰r
['tbl_name'];

1685 
$ObjName
 = 
$L—dA‰r
["ref_obj_name"];

1686 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$ObjName
);

1688 
$A‰rB—n
["select"] = "TBL_NAME,FLD_NAME,OBJ_NAME";

1690 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$obj_d©a
["NAME_ATTR_NAME"];

1691 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

1693 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

1694 
$wh”e
 = 
	`¬¿y
(

1695 
$obj_d©a
["KEY_ATTR_FLD"] => 
$©Œ_v®ue
,

1696 "Üg_id" => 
$OrgID
,

1699 ià(
$»ãr_objeù
 =ğ"ReãrObjeù" && (
	`¡½os
(
$tbl_Çme
, "privilege"))) {

1701 
$wh”e
['obj_type'] = 95;

1704 
$£Ëù
 = 
	`¬¿y
(

1705 
$©Œ_d©a
["FLD_NAME"],

1707 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

1708 
$this
->
db
->
	`wh”e
(
$wh”e
);

1709 
$this
->
db
->
	`äom
(
$©Œ_d©a
["TBL_NAME"]);

1710 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

1711 ià(
$is_»f
) {

1712 
$d©as
 = @
	`cu¼’t
(
$d©a
[0]);

1713 
$d©as
 = 
	`em±y
($datas) ? "" : $datas;

1715  
$d©a
;

1717  
$©Œ_v®ue
;

1719 
	}
}

1731 
´iv©e
 
funùiÚ
 
	$isEnum
(
$©Œ_key
, 
$©Œ_v®ue
, 
$OrgID
, 
$LªgId
, 
$A‰rName
, 
$EnumKey
, &
$d©as
, 
$is_»f
) {

1740 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

1742 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$©Œ_key
;

1743 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

1745 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

1748 
$LªgId
 = 
$this
->
£ssiÚ
->
	`u£rd©a
("lang_id");

1749 
$LªgId
 = 
	`em±y
($LangId) ? 2 : $LangId;

1750 
$A‰rName
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]è? 
$©Œ_key
 : $attr_data["ENUM_ATTR_NAME"];

1751 
$EnumKey
 = 
$©Œ_v®ue
;

1752 
$r_d©a
 = 
$this
->->
	`S–eùOÃSŒ
(
$OrgID
, 
$LªgId
, 
$A‰rName
, 
$EnumKey
);

1753 ià(
$is_»f
) {

1754 
$d©as
 = @
	`»£t
(
$r_d©a
);

1755 
$d©as
 = 
	`em±y
($datas) ? "" : $datas;

1757 ià(
$©Œ_key
 == "RelPrivilege.RelatedToType") {

1760  
$r_d©a
;

1761 
	}
}

1769 
public
 
funùiÚ
 
	$isD©e
(
$d©e
, 
$ex³ris
) {

1770 
$»s_d©e
 = 
	`em±y
(
$d©e
è? 
nuÎ
 : 
	`d©e
("Y-m-d", 
	`¡¹Ùime
($d©eè+ 
$ex³ris
);

1771  
$»s_d©e
;

1772 
	}
}

1781 
public
 
funùiÚ
 
	$isD©eTime
(
$D©eTime
, 
$ex³ris
) {

1782 
$»s_d©e
 = 
	`em±y
(
$D©eTime
è? 
nuÎ
 : 
	`d©e
("Y-m-d H:i:s", 
	`¡¹Ùime
($D©eTimeè+ 
$ex³ris
);

1783  
$»s_d©e
;

1785 
	}
}

1791 
´Ùeùed
 
funùiÚ
 
	$·r£_fÜm¬t
(&
$Li¡FÜm©
) {

1792 
$L—dA‰r
 = 
$this
->
©Œ
->
	`objeù_©Œ
(1, 
NULL
);

1793 
$obj_d©a
 = 
$this
->
obj
->
	`ObjP¬£D©a
($this->obj->
	`NameG‘Obj
(1, 
NULL
, 
TRUE
));

1794 
$fÜ_d©a
 = 
	`¬¿y
();

1795 
	`fÜ—ch
 (
$Li¡FÜm©
 
as
 
$k
 => &
$v
) {

1796 
$©Œ_v®ues
 = 
	`CÚv”A¼ay
(
$v
, '.');

1797 
$s_©Œ_v®ues
 = 
$©Œ_v®ues
;

1798 ià(
	`couÁ
(
$©Œ_v®ues
) > 2) {

1799 
$this
->
	`·r£_fÜm¬t_©Œ
(
$L—dA‰r
, 
$obj_d©a
, 
$©Œ_v®ues
, 
$fÜ_d©a
);

1800 
$fÜ_d©a
['hi¡Üy_d©a'][
$k
] = 
$Li¡FÜm©
[$k];

1801 
	`un£t
(
$Li¡FÜm©
[
$k
]);

1804  
$fÜ_d©a
;

1805 
d›
;

1806 
	}
}

1808 
´Ùeùed
 
funùiÚ
 
	$·r£_fÜm¬t_©Œ
(
$L—dA‰r
, 
$obj_d©a
, &
$©Œ_v®ues
, &
$fÜ_d©a
) {

1809 
$äu™
 = 
	`¬¿y_shiá
(
$©Œ_v®ues
);

1810 
	`fÜ—ch
 (
$©Œ_v®ues
 
as
 
$k
 => 
$v
) {

1811 ià(
$L—dA‰r
[
$äu™
 . "." . 
$v
]['attr_type'] == "4" && $LeadAttr[$fruit . "." . $v]['is_ref_obj'] == "1") {

1812 
$fÜ_d©a
[] = 
$L—dA‰r
[
$äu™
 . "." . 
$v
]['ref_obj_name'];

1813 
$this
->
	`·r£_fÜm¬t_©Œ
(
$L—dA‰r
, 
$obj_d©a
, 
$©Œ_v®ues
, 
$fÜ_d©a
);

1815 
$fÜ_d©a
['Ãw_d©a'][] = 
$äu™
 . "." . 
$v
 . "";

1818 
	}
}

1826 
´iv©e
 
funùiÚ
 
	$G‘Tbl
(
$N“dA‰r
, 
$L—dA‰r
) {

1827 
$»s_d©a
 = 
	`¬¿y
();

1828 
	`fÜ—ch
 (
$N“dA‰r
 
as
 
$k
 => 
$v
) {

1829 
$»s_d©a
[
$k
] = 
$L—dA‰r
[
$v
]["tbl_name"];

1831  
	`¬¿y_f‹r
(
	`¬¿y_unique
(
$»s_d©a
));

1832 
	}
}

1840 
´iv©e
 
funùiÚ
 
	$G‘Fld
(
$N“dA‰r
, 
$L—dA‰r
) {

1841 
$»s_d©a
 = 
	`¬¿y
();

1842 
$æd_que
 = "";

1843 
	`fÜ—ch
 (
$N“dA‰r
 
as
 
$k
 => 
$v
) {

1844 ià(!
	`em±y
(
$L—dA‰r
[
$v
]["attr_type"])) {

1845 
$L—dA‰r
[
$v
]["attr_type"]) {

1847 ià(!
	`em±y
(
$L—dA‰r
[
$v
]["referred_by"])) {

1848 
$»s_d©a
[
$k
] = 
$L—dA‰r
[$L—dA‰r[
$v
]["referred_by"]]["tbl_name"] . "." . $LeadAttr[$LeadAttr[$v]["referred_by"]]["fld_name"] . " " . $LeadAttr[$LeadAttr[$v]["referred_by"]]["fld_name"] . "__" . $k;

1851 
$»s_d©a
[
$k
] = 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"] . " " . $LeadAttr[$v]["fld_name"] . "__" . $k;

1855 
$»s_d©a
[
$k
] = "to_ch¬(" . 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"] . ", 'yyyy-mm-dd hh24:ii:ss')‡s " . $LeadAttr[$v]["fld_name"] . "__" . $k;

1858 
$»s_d©a
[
$k
] = "to_ch¬(" . 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"] . ", 'yyyy-mm-dd hh24:ii:ss')‡s " . $LeadAttr[$v]["fld_name"] . "__" . $k;

1861 ià(!
	`em±y
(
$L—dA‰r
[
$v
]["fld_name"])) {

1862 
$»s_d©a
[
$k
] = 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"] . " " . $LeadAttr[$v]["fld_name"] . "__" . $k;

1870  
	`¬¿y_unique
(
$»s_d©a
);

1871 
	}
}

1885 
´iv©e
 
funùiÚ
 
	$qu”yIsRefObj
(
$qu”y_key
, 
$OrgID
, &
$qu”y_v®ue
, 
$ObjD©a
, 
$DiùA‰r
, 
$Ëad_©Œ
, 
$isboŞ
 = 
çl£
, 
$dis_d©a
 = 
nuÎ
) {

1886 
	`exŒaù
(
$qu”y_v®ue
, 
EXTR_OVERWRITE
);

1887 ià(
$is_»f_obj
 == "1") {

1888 
$qu”y_v®ue
["©Œ_ty³"] = 
$this
->
RefTy³
;

1889 
$qu”y_v®ue
["©Œ_»f"] = 
$this
->
	`RefObjDŸlog
(
$qu”y_key
, $qu”y_v®ue, 
$OrgID
, 
$ObjD©a
, 
$DiùA‰r
);

1890 ià(
$isboŞ
) {

1891 
$»f_obj_Çme
 = 
$qu”y_v®ue
['ref_obj_name'];

1892 
$Ëe_is_qu”y
 = 
$qu”y_v®ue
['lee_is_query'];

1893 
$»ã¼ed_by
 = 
$Ëad_©Œ
[
$qu”y_v®ue
['referred_by']]["refer_to"];

1894 
$©Œ_»f
 = 
$qu”y_v®ue
["attr_ref"];

1895 
$Ïb–
 = 
$qu”y_v®ue
["label"];

1896 
$qu”y_v®ue
["»f_key"] = 
$»f_obj_Çme
;

1897 
	`fÜ—ch
 (
$dis_d©a
[
$»f_obj_Çme
] 
as
 
$k
 => 
$v
) {

1898 
$v
['Ïb–'] = 
$Ïb–
 . "ï¼š" . $v['label'];

1899 
$iks
 = 
	`ex¶ode
(".", 
$k
);

1900 
$iks_¡r
 = 
	`’d
(
$iks
);

1901 
$qu”y_v®ue
[
$»ã¼ed_by
 . "." . 
$iks_¡r
] = 
$v
;

1905 
	}
}

1916 
public
 
funùiÚ
 
	$RefObjDŸlog
(
$Qu”yKey
, 
$Qu”yV®ue
, 
$OrgID
, 
$ObjD©a
, 
$DiùA‰r
) {

1918 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$Qu”yV®ue
['ref_obj_name']);

1920 
$A‰rB—n
["select"] = "TBL_NAME,FLD_NAME,OBJ_NAME";

1921 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$obj_d©a
["NAME_ATTR_NAME"];

1922 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

1923 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

1925 
$æd_Çme
 = 
	`¡¹ouµ”
(
$L—dA‰r
[
$v
['referred_by']]['fld_name']);

1926 
$d©a
[
$Qu”yKey
 . '.ObjName'] = 
$DiùA‰r
[
$©Œ_d©a
["OBJ_NAME"]]["LABEL"];

1927 
$d©a
[
$Qu”yKey
 . '.RefU¾'] = 
$this
->
RefU¾
 . 
$obj_d©a
['OBJ_TYPE'] . "&robj_ty³=" . 
$ObjD©a
['OBJ_TYPE'];

1928 
$d©a
[
$Qu”yKey
 . '.DŸlogWidth'] = 
$this
->
DŸlogWidth
;

1929  
$d©a
;

1930 
	}
}

1939 
public
 
funùiÚ
 
	$qu”yIsEnum
(
$qu”y_key
, 
$OrgID
, &
$qu”y_v®ue
, 
$Ëad_©Œ
) {

1949 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

1951 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$qu”y_key
;

1952 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

1954 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

1957 
$LªgId
 = 2;

1958 
$A‰rName
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]è? 
$qu”y_key
 : $attr_data["ENUM_ATTR_NAME"];

1959 
$qu”y_d©a
 = 
$this
->->
	`S–eùWh”e
(
$OrgID
, 
$LªgId
, 
$A‰rName
);

1960 
$qu”y_v®ue
["’um_¬r"] = 
$qu”y_d©a
;

1961 
	}
}

1969 
public
 
funùiÚ
 
	$G‘AÎ
(
$OrgID
, 
$ObjID
, 
$ObjName
) {

1970 
$d©a
 = 
	`¬¿y
();

1971 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$ObjName
);

1973 
$bË_Çme
 = 
$this
->
	`G‘AÎTbl
(
$OrgID
, 
$ObjName
);

1974 
$A‰rB—n
['wh”e'] = 
	`¬¿y
('ATTR_NAME' => 
$ObjName
 . ".ID");

1975 
$A‰rB—n
['select'] = 'FLD_NAME';

1976 
$dddd
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

1979 
	`fÜ—ch
 (
$bË_Çme
 
as
 
$key
 => 
$v®ue
) {

1980 
$cÚ‹Á
 = @
$this
->
db
->
	`äom
(
$v®ue
)->
	`wh”e
("Üg_id=$OrgID‡nd " . 
$dddd
['FLD_NAME'] . "=$ObjID")->
	`g‘
()->
	`»suÉ_¬¿y
();

1981 ià(!
	`em±y
(
$cÚ‹Á
)) {

1982 
$d©a
[] = 
$cÚ‹Á
[0];

1985 
$d©a_®l
 = 
	`¬¿y
();

1986 ià(
	`couÁ
(
$d©a
) > 1) {

1987 
$i
 = 0; $˜<ğ
	`couÁ
(
$d©a
) - 1; $i++) {

1988 
$d©a_®l
 = 
	`¬¿y_m”ge
($d©a_®l, 
$d©a
[
$i
]);

1991 
$d©a_®l
 = 
$d©a
[0];

1993  
$d©a_®l
;

1994 
	}
}

2002 
public
 
funùiÚ
 
	$G‘AÎTbl
(
$OrgID
, 
$ObjName
) {

2003 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$ObjName
);

2004 
	`fÜ—ch
 (
$©Œ_d©a
 
as
 
$key
 => 
$v®ue
) {

2005 
$bË_Çme
[] = 
$v®ue
['tbl_name'];

2007 
$bË_Çme
 = 
	`¬¿y_unique
($table_name);

2008  
$bË_Çme
;

2009 
	}
}

2014 
public
 
funùiÚ
 
	$FÜTy³
(
$Üg_id
,
$obj_ty³
){

2015 
$wh”e
 = 
	`¬¿y
(

2016 'Üg_id' => 
$Üg_id
,

2017 'obj_ty³' => 
$obj_ty³


2019 
$d©a
 = 
$this
->
db
->
	`£Ëù
('ty³_id‡ ,ty³_Çme')->
	`äom
('tc_ty³')->
	`wh”e
(
$wh”e
)->
	`g‘
()->
	`»suÉ_¬¿y
();

2020 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

2021 
$d©a_¬r
[
$k
]['’um_v®ue'] = 
$v
['TYPE_NAME'];

2022 
$d©a_¬r
[
$k
]['’um_key'] = 
$v
['TYPE_ID'];

2024  
$d©a_¬r
;

2025 
	}
}

2035 
public
 
funùiÚ
 
G‘šfo
(
$ObjName
, 
$OrgID
, 
$DiùA‰r
, 
$ObjA‰r
, 
$ObjID
, 
$U£rID
 = "", 
$Ty³ID
 = "", 
$is_ed™
 = 
çl£
, 
$Ãwd©a
 = 
	$¬¿y
()) {

2036 ià(
$ObjID
) {

2037 
$cÚ‹Á
 = 
$this
->
	`G‘AÎ
(
$OrgID
, 
$ObjID
, 
$ObjName
);

2040 
$tobj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$ObjName
);

2041 
	`fÜ—ch
 (
$ObjA‰r
 
as
 
$k
 => 
$v
) {

2042 
$v
['attr_type']) {

2044 ià(
$v
['is_ref_obj']) {

2045 ià(
$v
["ref_obj_name"] == "ReferObject") {

2046 
$SRC_ID
 = 
$cÚ‹Á
[
	`¡¹ouµ”
(
$ObjA‰r
[
$v
["referred_by"]]["fld_name"])];

2047 ià(
$SRC_ID
 =ğ"0" || 
	`em±y
($SRC_ID)) {

2048 
$objeù_d©a
[
$k
] = "";

2056 
$ÌÙ
 = 
	`¬¿y
('Üg_id'=>
$OrgID
,'©Œ_Çme'=>
$k
);

2057 
$ÌÙd©a
 = 
$this
->
db
->
	`£Ëù
('Ëe_»ãr_obj_ty³‡ ÌÙ')->
	`äom
('dd_©Œibu‹')->
	`wh”e
(
$ÌÙ
)->
	`g‘
()->
	`»suÉ_¬¿y
();

2058 if(
	`em±y
(
$ÌÙd©a
[0]['LROT'])){

2059 
$ff
 = 
	`¡¹ouµ”
(
$ObjA‰r
[
$k
 . "Type"]['fld_name']);

2061 
$ff
 = 
	`¡¹ouµ”
(
$ObjA‰r
[
$ÌÙd©a
[0]['LROT']]['fld_name']);

2064 
$obj_d©a
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$cÚ‹Á
[
$ff
]);

2069 
$RefObjName
 = 
$v
["ref_obj_name"];

2070 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$RefObjName
);

2074 
$A‰rB—n
["select"] = "TBL_NAME,FLD_NAME,OBJ_NAME";

2075 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$obj_d©a
["NAME_ATTR_NAME"];

2076 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

2077 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

2080 
$æd_Çme
 = 
	`¡¹ouµ”
(
$ObjA‰r
[
$v
['referred_by']]['fld_name']);

2081 ià(
	`is£t
(
$cÚ‹Á
)) {

2082 
$wh”e
 = 
	`¬¿y
(

2083 
$obj_d©a
["KEY_ATTR_FLD"] => 
$cÚ‹Á
[
$æd_Çme
],

2084 "Üg_id" => 
$OrgID
,

2086 
$£Ëù
 = 
	`¬¿y
(

2087 
$©Œ_d©a
["FLD_NAME"],

2090 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

2091 
$this
->
db
->
	`wh”e
(
$wh”e
);

2092 
$this
->
db
->
	`äom
(
$©Œ_d©a
["TBL_NAME"]);

2093 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

2094 
$objeù_d©a
[
$k
] = 
$d©a
[0][
	`¡¹ouµ”
(
$©Œ_d©a
["FLD_NAME"])];

2095 
$objeù_d©a
[
$k
 . '.Name'] = 
$d©a
[0][
	`¡¹ouµ”
(
$©Œ_d©a
["FLD_NAME"])];

2096 
$objeù_d©a
[
$k
 . '.ObjName'] = 
$DiùA‰r
[
$©Œ_d©a
["OBJ_NAME"]]["LABEL"];

2097 
$objeù_d©a
[
$k
 . '.RefU¾'] = 
$this
->
RefU¾
 . 
$obj_d©a
['OBJ_TYPE'] . "&robj_ty³=" . 
$tobj_d©a
['OBJ_TYPE'];

2098 
$objeù_d©a
[
$k
 . '.DŸlogWidth'] = 
$this
->
DŸlogWidth
;

2099 
$objeù_d©a
[
$k
 . '.ID'] = 
$cÚ‹Á
[
$æd_Çme
];

2102 
$objeù_d©a
[
$k
 . '.RefU¾'] = 
$this
->
RefU¾
 . 
$obj_d©a
['OBJ_TYPE'] . "&robj_ty³=" . 
$tobj_d©a
['OBJ_TYPE'];

2103 
$objeù_d©a
[
$k
 . '.Name'] = "";

2104 
$objeù_d©a
[
$k
 . '.ObjName'] = 
$DiùA‰r
[
$©Œ_d©a
["OBJ_NAME"]]["LABEL"];

2105 
$objeù_d©a
[
$k
 . '.DŸlogWidth'] = 
$this
->
DŸlogWidth
;

2106 
$objeù_d©a
[
$k
 . '.ID'] = "";

2107 
$objeù_d©a
[
$k
] = "";

2110 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

2111 ià(!
	`em±y
(
$æd_Çme
)) {

2112 ià(
	`is£t
(
$cÚ‹Á
)) {

2113 ià(
	`is_objeù
(
$cÚ‹Á
[
$æd_Çme
])) {

2114 
$cÚ‹Á
[
$æd_Çme
] = 
	`ba£64_decode
($cÚ‹Á[$æd_Çme]->
	`lßd
());

2116 
$objeù_d©a
[
$k
] = 
$cÚ‹Á
[
$æd_Çme
];

2118 
$objeù_d©a
[
$k
] = "";

2121 
$objeù_d©a
[
$k
] = "";

2126 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

2127 if(!
	`em±y
(
$æd_Çme
)){

2128 ià(
	`is£t
(
$cÚ‹Á
)) {

2129 ià(
$cÚ‹Á
[
$æd_Çme
]==1) {

2130 
$objeù_d©a
[
$k
] = 'æ˜¯';

2131 
$objeù_d©a
[
$k
 . '.enum_key'] = 1;

2132 
$objeù_d©a
[
$k
 . '.value'] = 'æ˜¯';

2133 }
	`–£if
(
$cÚ‹Á
[
$æd_Çme
]==0) {

2134 
$objeù_d©a
[
$k
] = 'å¦';

2135 
$objeù_d©a
[
$k
 . '.enum_key'] = 0;

2136 
$objeù_d©a
[
$k
 . '.value'] = 'å¦';

2138 
$objeù_d©a
[
$k
] = "";

2139 
$objeù_d©a
[
$k
 . '.enum_key'] = "";

2140 
$objeù_d©a
[
$k
 . '.value'] = "";

2147 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

2148 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$k
;

2149 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

2150 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

2151 
$LªgId
 = 2;

2152 
$A‰rName
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]è? 
$k
 : $attr_data["ENUM_ATTR_NAME"];

2153 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

2154 ià(!
	`em±y
(
$cÚ‹Á
[0][
$æd_Çme
])) {

2156 
$’um
 = 
$this
->->
	`S–eùOÃSŒ
(
$OrgID
, 
$LªgId
, 
$A‰rName
, 
$cÚ‹Á
[
$æd_Çme
]);

2158 
$objeù_d©a
[
$k
] = 
$’um
['ENUM_VALUE'];

2159 
$objeù_d©a
[
$k
 . '.’um_key'] = 
$cÚ‹Á
[
$æd_Çme
];

2160 
$objeù_d©a
[
$k
 . '.v®ue'] = 
$’um
['ENUM_VALUE'];

2162 
$objeù_d©a
[
$k
] = "";

2163 
$objeù_d©a
[
$k
 . '.enum_key'] = "";

2164 
$objeù_d©a
[
$k
 . '.value'] = "";

2166 ià(
$is_ed™
) {

2168 
$’um_¬r
 = 
$this
->->
	`G‘EnumA¼
(
$OrgID
, 
$A‰rName
, 
$LªgID
 = 2);

2169 
$objeù_d©a
[
$k
 . '.©Œ_ty³'] = 
$v
['attr_type'];

2170 
$objeù_d©a
[
$k
 . '.’um_¬r'] = 
$’um_¬r
;

2174 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

2175 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$k
;

2176 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

2177 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

2178 
$LªgId
 = 2;

2179 
$A‰rName
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]è? 
$k
 : $attr_data["ENUM_ATTR_NAME"];

2180 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

2181 ià(!
	`em±y
(
$cÚ‹Á
[
$æd_Çme
])) {

2183 
$’um
 = 
$this
->->
	`S–eùOÃSŒ
(
$OrgID
, 
$LªgId
, 
$A‰rName
, 
$cÚ‹Á
[
$æd_Çme
]);

2185 
$objeù_d©a
[
$k
] = 
$’um
['ENUM_VALUE'];

2186 
$objeù_d©a
[
$k
 . '.’um_key'] = 
$cÚ‹Á
[
$æd_Çme
];

2187 
$objeù_d©a
[
$k
 . '.’um_©Œ_Çme'] = 
$A‰rName
;

2188 
$objeù_d©a
[
$k
 . '.v®ue'] = 
$’um
['ENUM_VALUE'];

2190 
$objeù_d©a
[
$k
] = "";

2191 
$objeù_d©a
[
$k
 . '.enum_key'] = "";

2192 
$objeù_d©a
[
$k
 . '.’um_©Œ_Çme'] = 
$A‰rName
;

2193 
$objeù_d©a
[
$k
 . '.value'] = "";

2195 ià(
$is_ed™
) {

2196 
$’um_¬r
 = 
$this
->->
	`G‘EnumA¼
(
$OrgID
, 
$A‰rName
, 
$LªgID
 = 2);

2197 
$objeù_d©a
[
$k
 . '.©Œ_ty³'] = 
$v
['attr_type'];

2198 
$objeù_d©a
[
$k
 . '.’um_©Œ_Çme'] = 
$A‰rName
;

2199 
$objeù_d©a
[
$k
 . '.’um_¬r'] = 
$’um_¬r
;

2205 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

2206 ià(
	`is£t
(
$cÚ‹Á
)) {

2207 
$cÚ‹Á
[
$æd_Çme
] = 
$this
->
	`ToCh¬
($æd_Çme, 
$v
['tbl_Çme'], 
$OrgID
, 
$ObjID
, 
$ObjName
);

2208 ià(
	`em±y
(
$cÚ‹Á
[
$æd_Çme
])) {

2209 
$objeù_d©a
[
$k
] = "";

2211 
$objeù_d©a
[
$k
] = 
$this
->
	`isD©e
(
$cÚ‹Á
[
$æd_Çme
], 8 * 60 * 60);

2214 
$objeù_d©a
[
$k
] = "";

2218 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

2219 if(!
	`em±y
(
$æd_Çme
)){

2220 ià(
	`is£t
(
$cÚ‹Á
)) {

2221 
$cÚ‹Á
[
$æd_Çme
] = 
$this
->
	`ToCh¬
($æd_Çme, 
$v
['tbl_Çme'], 
$OrgID
, 
$ObjID
, 
$ObjName
);

2222 ià(
	`em±y
(
$cÚ‹Á
[
$æd_Çme
])) {

2223 
$objeù_d©a
[
$k
] = "";

2225 
$objeù_d©a
[
$k
] = 
$this
->
	`isD©eTime
(
$cÚ‹Á
[
$æd_Çme
], 8 * 60 * 60);

2228 
$objeù_d©a
[
$k
] = "";

2234 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

2235 ià(!
	`em±y
(
$æd_Çme
)) {

2236 ià(
	`is£t
(
$cÚ‹Á
)) {

2237 ià(
	`is_objeù
(
$cÚ‹Á
[
$æd_Çme
])) {

2238 
$ddd
 = 
	`ba£64_decode
(
$cÚ‹Á
[
$æd_Çme
]->
	`lßd
());

2240 ià(
	`em±y
(
$ddd
)) {

2241 
$cÚ‹Á
[
$æd_Çme
] = "";

2243 
$cÚ‹Á
[
$æd_Çme
] = 
$ddd
;

2246 
$objeù_d©a
[
$k
] = 
$cÚ‹Á
[
$æd_Çme
];

2248 
$objeù_d©a
[
$k
] = "";

2251 
$objeù_d©a
[
$k
] = "";

2258 ià(
	`em±y
(
$ObjID
)) {

2260 ià(!
	`em±y
(
$Ty³ID
)) {

2261 
$this
->
lßd
->
	`mod–
('www/type_model', 'type');

2262 
$ty³d©a
 = 
$this
->
ty³
->
	`S–eùOÃ
(
$OrgID
, 
$Ty³ID
);

2263 
$objeù_d©a
[
$ObjName
.'.Ty³ID'] = 
$Ty³ID
;

2264 
$objeù_d©a
[
$ObjName
.'.Ty³.Name'] = 
$ty³d©a
['Name'];

2265 
$objeù_d©a
[
$ObjName
.'.Ty³'] = 
$ty³d©a
['Name'];

2266 
$objeù_d©a
[
$ObjName
.'.Ty³.ID'] = 
$Ty³ID
;

2268 ià(!
	`em±y
(
$U£rID
)) {

2270 
$u£rd©a
 = 
$this
->
u£r
->
	`S–eùOÃ
(
$OrgID
, 
$U£rID
);

2271 if(
$ObjName
=='Task'){

2272 
$objeù_d©a
[
$ObjName
.'.AssigÃdToID'] = 
$U£rID
;

2273 
$objeù_d©a
[
$ObjName
.'.AssigÃdTo.Name'] = 
$u£rd©a
['Name'];

2274 
$objeù_d©a
[
$ObjName
.'.AssigÃdTo'] = 
$u£rd©a
['Name'];

2275 
$objeù_d©a
[
$ObjName
.'.AssigÃdTo.ID'] = 
$U£rID
;

2277 
$objeù_d©a
[
$ObjName
.'.OwÃrID'] = 
$U£rID
;

2278 
$objeù_d©a
[
$ObjName
.'.OwÃr.Name'] = 
$u£rd©a
['Name'];

2279 
$objeù_d©a
[
$ObjName
.'.OwÃr'] = 
$u£rd©a
['Name'];

2280 
$objeù_d©a
[
$ObjName
.'.OwÃr.ID'] = 
$U£rID
;

2282 
$objeù_d©a
[
$ObjName
.'.C»©edByID'] = 
$U£rID
;

2283 
$objeù_d©a
[
$ObjName
.'.C»©edBy.Name'] = 
$u£rd©a
['Name'];

2284 
$objeù_d©a
[
$ObjName
.'.C»©edBy'] = 
$u£rd©a
['Name'];

2285 
$objeù_d©a
[
$ObjName
.'.C»©edBy.ID'] = 
$U£rID
;

2287 if(!
	`em±y
(
$u£rd©a
['Dept_ID'])){

2288 
$D•tId
=
$u£rd©a
['Dept_ID'];

2289 
$d•td©a
=
$this
->
d•t
->
	`S–eùOÃ
(
$OrgID
, 
$D•tId
);

2290 if(
$ObjName
=='Contact'){

2291 
$objeù_d©a
[
$ObjName
.'.OwÃrD•tID'] = 
$D•tId
;

2292 
$objeù_d©a
[
$ObjName
.'.OwÃrD•t'] = 
$d•td©a
['Name'];

2293 
$objeù_d©a
[
$ObjName
.'.OwÃrD•t.Name'] = 
$d•td©a
['Name'];

2294 
$objeù_d©a
[
$ObjName
.'.OwÃrD•t.ID'] = 
$D•tId
;

2296 
$objeù_d©a
[
$ObjName
.'.D•¬tm’tID'] = 
$D•tId
;

2297 
$objeù_d©a
[
$ObjName
.'.D•¬tm’t'] = 
$d•td©a
['Name'];

2298 
$objeù_d©a
[
$ObjName
.'.D•¬tm’t.Name'] = 
$d•td©a
['Name'];

2299 
$objeù_d©a
[
$ObjName
.'.D•¬tm’t.ID'] = 
$D•tId
;

2304 ià(!
	`em±y
(
$Ãwd©a
)) {

2305 
	`fÜ—ch
 (
$Ãwd©a
 
as
 
$k
 => 
$v
) {

2306 
$objeù_d©a
[
$k
] = 
$v
;

2309  
$objeù_d©a
;

2310 
	}
}

2312 
´iv©e
 
funùiÚ
 
	$ToCh¬
(
$æd_Çme
, 
$tbl_Çme
, 
$OrgID
, 
$ObjID
, 
$ObjName
) {

2313 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$ObjName
);

2315 
$A‰rB—n
['wh”e'] = 
	`¬¿y
('ATTR_NAME' => 
$ObjName
 . ".ID");

2316 
$A‰rB—n
['select'] = 'FLD_NAME';

2317 
$dddd
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

2319 
$this
->
db
->
	`£Ëù
("to_ch¬(" . 
$æd_Çme
 . ", 'yyyy-mm-dd hh24:ii:ss')‡s d");

2320 
$this
->
db
->
	`äom
(
$tbl_Çme
);

2321 
$wh”e
 = 
	`¬¿y
(

2322 
$dddd
['FLD_NAME'] => 
$ObjID
,

2323 'ORG_ID' => 
$OrgID


2325 
$this
->
db
->
	`wh”e
(
$wh”e
);

2326 
$dddd
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

2327 (
$dddd
[0]['D']);

2328 
	}
}

2330 
public
 
funùiÚ
 
	$R–A‰rRŞeAù
(
$d©a
,
$aù
){

2331 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

2332 
$aù
) {

2334 
$r_d©a
[
$v
['ATTR_NAME']] = 
	`sub¡r
($v['CONTROL'], 0, 1);

2337 
$r_d©a
[
$v
['ATTR_NAME']] = 
	`sub¡r
($v['CONTROL'], 1, 1);

2340 
$r_d©a
[
$v
['ATTR_NAME']] = 
	`sub¡r
($v['CONTROL'], 2, 1);

2343 
$r_d©a
[
$v
['ATTR_NAME']] = 
	`sub¡r
($v['CONTROL'], 3, 1);

2346 
$r_d©a
[
$v
['ATTR_NAME']] = 
	`sub¡r
($v['CONTROL'], 4, 1);

2349 
$r_d©a
[
$v
['ATTR_NAME']] = 
	`sub¡r
($v['CONTROL'], 5, 1);

2352 
$r_d©a
[
$v
['ATTR_NAME']] = "";

2356  
$r_d©a
;

2357 
	}
}

2363 
public
 
funùiÚ
 
	$IsS–fEd™
(
$Üg_id
,
$obj_Çme
,
$obj_id
,
$u£r_id
,
$pk
){

2364 
$wh”e
 = 
	`¬¿y
(

2365 'Üg_id' => 
$Üg_id
,

2366 
$pk
 => 
$obj_id
,

2367 'u£r_id' => 
$u£r_id


2369 
$d©a
 = 
$this
->
db
->
	`äom
('»l_'.
$obj_Çme
.'_u£r')->
	`wh”e
(
$wh”e
)->
	`g‘
()->
	`»suÉ_¬¿y
();

2370 if(
	`em±y
(
$d©a
)){

2372 }
	`–£if
(
$d©a
[0]['is_self']==1){

2377 
	}
}

2386 
public
 
funùiÚ
 
G‘InfoEd™
(
$Üg_id
, 
$V›wFÜm©
, 
$Ëad_d©a
, 
$L—dA‰r
, 
$Ëad_id
, 
$’um_©Œ
,
$¡İ_æag
="",
$rŞe_©Œ_¬r
=
	$¬¿y
()) {

2387 
$Ïng_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('lang_id');

2388 
	`fÜ—ch
 (
$V›wFÜm©
['bËs'] 
as
 
$k
 => 
$v
) {

2389 
	`fÜ—ch
 (
$v
['ûÎs'] 
as
 
$key
 => 
$v®ue
) {

2390 ià(!
	`em±y
(
$v®ue
['name'])) {

2391 ià(
$v®ue
['label'] == 1) {

2392 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['©Œ_Ïb–'] = 
$L—dA‰r
[
$v®ue
['name']]['label'];

2393 } 
	`–£if
 (
$v®ue
['label'] == 2) {

2394 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['©Œ_Ïb–'] = 
$v®ue
['Çme'][
$Ïng_id
];

2397 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['cÚ‹Á'] = 
$Ëad_d©a
[
$v®ue
['name']];

2398 ià(
$L—dA‰r
[
$v®ue
['name']]['is_ref_obj']) {

2399 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['id_v®ue'] = 
$Ëad_d©a
[
$v®ue
['name'] . ".ID"];

2400 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['©Œ_ty³'] = 
$this
->
RefTy³
;

2402 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['©Œ_ty³'] = 
$L—dA‰r
[
$v®ue
['name']]['attr_type'];

2406 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['v®ue'] = 
$Ëad_d©a
[
$v®ue
['name']];

2407 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['Çme'] = 
$v®ue
['name'];

2409 ià(
$v®ue
['»quœed'] || 
$L—dA‰r
[$value['name']]['is_must']) {

2410 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['required'] = 1;

2412 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['required'] = 0;

2415 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['nÙed™'] = 
$L—dA‰r
[
$v®ue
['name']]['notedit'];

2417 if(
$¡İ_æag
==1){

2418 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['notedit'] = 1;

2420 if(!
	`em±y
(
$rŞe_©Œ_¬r
)){

2421 if(
	`is£t
(
$rŞe_©Œ_¬r
[
$v®ue
['name']]) && $role_attr_arr[$value['name']]==1){

2422 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['notedit'] = 1;

2426 ià(
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . '.enum_arr'])) {

2428 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['key'] = 
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . ".enum_key"]) ? $lead_data[$value['name'] . ".enum_key"] : "";

2429 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['’um_¬r'] = 
$Ëad_d©a
[
$v®ue
['name'] . '.enum_arr'];

2431 ià(
$L—dA‰r
[
$v®ue
['name']]['is_ref_obj']) {

2432 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['»ã¼ed_by'] = 
$L—dA‰r
[
$v®ue
['name']]['referred_by'];

2433 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['»f_obj_Çme'] = 
$L—dA‰r
[
$v®ue
['name']]['ref_obj_name'];

2435 ià(
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . '.ObjName'])) {

2436 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['ObjName'] = 
$Ëad_d©a
[
$v®ue
['name'] . ".ObjName"];

2438 ià(
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . '.RefUrl'])) {

2439 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['RefU¾'] = 
$Ëad_d©a
[
$v®ue
['name'] . '.RefUrl'];

2441 ià(
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . '.DialogWidth'])) {

2442 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['fÜm_d©a']['DŸlogWidth'] = 
$Ëad_d©a
[
$v®ue
['name'] . '.DialogWidth'];

2444 
$v®ue_Çme
 = 
$v®ue
['name'];

2445 ià(
	`is£t
(
$Ëad_d©a
[
$v®ue
['name'] . ".enum_attr_name"])) {

2446 
$v®ue_Çme
 = 
$Ëad_d©a
[
$v®ue
['name'] . ".enum_attr_name"];

2448 ià(
	`š_¬¿y
(
$v®ue_Çme
, 
$’um_©Œ
['parent'])) {

2449 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['is_parent'] = 1;

2451 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['is_parent'] = 0;

2453 ià(
	`š_¬¿y
(
$v®ue_Çme
, 
$’um_©Œ
['child'])) {

2454 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['is_child'] = 1;

2456 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['form_data']['is_child'] = 0;

2460 ià(
$v®ue
['label']) {

2461 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['attr_label'] = "";

2463 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['content'] = "";

2468  
$V›wFÜm©
;

2469 
	}
}

2479 
public
 
funùiÚ
 
	$G‘InfoV›w
(
$Üg_id
, 
$V›wFÜm©
, 
$Ëad_d©a
, 
$L—dA‰r
, 
$Ëad_id
) {

2480 
$Ïng_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('lang_id');

2481 
	`fÜ—ch
 (
$V›wFÜm©
['bËs'] 
as
 
$k
 => 
$v
) {

2482 
	`fÜ—ch
 (
$v
['ûÎs'] 
as
 
$key
 => 
$v®ue
) {

2483 ià(!
	`em±y
(
$v®ue
['name'])) {

2484 ià(
$v®ue
['label'] == 1) {

2485 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['©Œ_Ïb–'] = 
$L—dA‰r
[
$v®ue
['name']]['label'];

2486 } 
	`–£if
 (
$v®ue
['label'] == 2) {

2487 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['©Œ_Ïb–'] = 
$v®ue
['Çme'][
$Ïng_id
];

2489 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['cÚ‹Á'] = 
$Ëad_d©a
[
$v®ue
['name']];

2492 ià(
$v®ue
['label']) {

2493 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['attr_label'] = "";

2495 
$V›wFÜm©
['bËs'][
$k
]['ûÎs'][
$key
]['content'] = "";

2500  
$V›wFÜm©
;

2501 
	}
}

2508 
public
 
funùiÚ
 
	$š™
(
$po¡_d©a
) {

2514 ià(
	`em±y
(
$po¡_d©a
)) {

2515  
	`_msg
("fail", "æ•°æ®ä¸èƒ½ä¸ºç©º");

2517 
$aùiÚ
 = 
	`¡¹Şow”
(
$po¡_d©a
["module_action"]);

2518 
$d©a
 = 
$this
->
	`$aùiÚ
(
$po¡_d©a
);

2519  
$d©a
;

2521 
	}
}

2523 
´iv©e
 
funùiÚ
 
	$moduË_upd©e
(
$po¡_d©a
) {

2527 
$moduË
 = 
$po¡_d©a
["module_model"];

2528 
$obj_id
 = 
$po¡_d©a
[
$moduË
 . '.ID'];

2529 
	`un£t
(
$po¡_d©a
[
$moduË
 . '.ID']);

2530 
	`un£t
(
$po¡_d©a
["module_model"]);

2531 
	`un£t
(
$po¡_d©a
["module_action"]);

2533 
$OrgID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

2537 
$objeù_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$moduË
);

2538 
$obj
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$moduË
);

2539 
$cÚ‹Á
 = 
$this
->
	`G‘OldInfo
(
$moduË
, 
$OrgID
, 
$objeù_©Œ
, 
$obj_id
);

2540 
	`fÜ—ch
 (
$po¡_d©a
 
as
 
$k
 => 
$v
) {

2541 ià(
$objeù_©Œ
[
$k
]['is_mu¡'] && 
	`em±y
(
$po¡_d©a
[$k])) {

2542 
$»t
['res'] = 'fail';

2543 
$»t
['msg'] = "ä¿å­˜å¤±è´¥ï¼" . 
$objeù_©Œ
[
$k
]['label'] . "ä¸ºå¿…å¡«å­—æ®µã€‚";

2544  
$»t
;

2555 
$d©a
 = 
	`¬¿y
();

2558 
	`fÜ—ch
 (
$po¡_d©a
 
as
 
$k
 => 
$v
) {

2560 ià(
	`is£t
(
$cÚ‹Á
[
$k
 . '.enum_key'])) {

2562 ià(
$v
 !ğ
$cÚ‹Á
[
$k
 . '.enum_key']) {

2563 
$d©a
[
$k
] = 
$v
;

2564 
$d©a
[
$k
 . '.’um_key'] = 
$v
;

2567 ià(
$v
 !ğ
$cÚ‹Á
[
$k
]) {

2569 
$d©a
[
$k
] = 
$v
;

2575 
$wh”e
[
$obj
['KEY_ATTR_FLD']] = 
$obj_id
;

2576 
$wh”e
['Üg_id'] = 
$OrgID
;

2577 
$U£rID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

2578 
$»tuº
 = 
$this
->
	`_upd©e
(
$d©a
, 
$wh”e
, 
$objeù_©Œ
, 
$moduË
, 
$OrgID
, 
$U£rID
,
$cÚ‹Á
);

2579 if(
$moduË
 == 'Task'){

2580 
$u£r_id
 = 
$d©a
[
$moduË
 . '.AssignedTo.ID'];

2582 
$u£r_id
 = 
$d©a
[
$moduË
 . '.Owner.ID'];

2584 if(!
	`em±y
(
$u£r_id
)){

2586 
$u_wh”e
 = 
	`¬¿y
(

2587 'Üg_id' => 
$OrgID
,

2588 'u£r_id' => 
$u£r_id


2590 
$d•t_id
 = 
$this
->
db
->
	`£Ëù
('d•t_id')->
	`äom
('tc_u£r')->
	`wh”e
(
$u_wh”e
)->
	`g‘
()->
	`»suÉ_¬¿y
();

2591 if(
	`couÁ
(
$d•t_id
)>1 || count($dept_id)==0){

2592 
$r_d©a
['res'] = 'fail';

2593 
$r_d©a
['msg'] = "ä¿å­˜å¤±è´¥ï¼è¿™ä¸ªå‘˜å·¥æ²¡æœ‰éƒ¨é—¨";

2594  
$r_d©a
;

2596 
$d_wh”e
 = 
	`¬¿y
(

2597 'Üg_id' => 
$OrgID
,

2598 'd•t_id' => 
$d•t_id
[0]['DEPT_ID']

2600 
$d•t_Çme
 = 
$this
->
db
->
	`£Ëù
('d•t_Çme')->
	`äom
('tc_d•¬tm’t')->
	`wh”e
(
$d_wh”e
)->
	`g‘
()->
	`»suÉ_¬¿y
();

2601 if(
$moduË
=='Contact'){

2602 
$d©a
[
$moduË
 . '.OwÃrD•t'] = 
$d•t_Çme
[0]['DEPT_NAME'];

2603 
$d©a
[
$moduË
 . '.OwÃrD•t.ID'] = 
$d•t_id
[0]['DEPT_ID'];

2604 }
	`–£if
(
$moduË
 == 'Task'){

2607 
$d©a
[
$moduË
 . '.D•¬tm’t'] = 
$d•t_Çme
[0]['DEPT_NAME'];

2608 
$d©a
[
$moduË
 . '.D•¬tm’t.ID'] = 
$d•t_id
[0]['DEPT_ID'];

2612 
	`un£t
(
$d©a
[
$moduË
 . '.OwnerDept']);

2613 
	`un£t
(
$d©a
[
$moduË
 . '.Department']);

2614 
	`un£t
(
$d©a
[
$moduË
 . '.OwnerDept.ID']);

2615 
	`un£t
(
$d©a
[
$moduË
 . '.Department.ID']);

2618 ià(
$»tuº
['res'] == 'suc') {

2620 ià(
$this
->
	`hi¡Üy
(
$d©a
, 
$obj_id
, 
$cÚ‹Á
, 
$objeù_©Œ
, 
$moduË
, 
$U£rID
)) {

2621 
$r_d©a
['res'] = 'suc';

2622 
$r_d©a
['msg'] = "ä¿å­˜æˆåŠŸï¼" ;

2624 
$r_d©a
['res'] = 'fail';

2625 
$r_d©a
['msg'] = "ä¿å­˜å¤±è´¥ï¼";

2628 
$r_d©a
['res'] = 'fail';

2629 
$r_d©a
['msg'] = "ä¿å­˜å¤±è´¥ï¼";

2631  
$r_d©a
;

2632 
	}
}

2634 
´iv©e
 
funùiÚ
 
	$moduË_add
(
$po¡_d©a
, 
$Üg_id
 = 1) {

2635 
$moduË
 = 
$po¡_d©a
["module_model"];

2638 
	`un£t
(
$po¡_d©a
["module_model"]);

2639 
	`un£t
(
$po¡_d©a
["module_action"]);

2643 
$OrgID
 = 
$Üg_id
;

2645 
$U£rID
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('user_id');

2648 
$objeù_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$moduË
);

2649 
	`fÜ—ch
 (
$po¡_d©a
 
as
 
$k
 => 
$v
) {

2650 ià(
$objeù_©Œ
[
$k
]['is_mu¡'] && 
	`em±y
(
$po¡_d©a
[$k])) {

2651 
$»t
['res'] = 'fail';

2652 
$»t
['msg'] = "ä¿å­˜å¤±è´¥ï¼" . 
$objeù_©Œ
[
$k
]['label'] . "ä¸ºå¿…å¡«å­—æ®µã€‚";

2653  
$»t
;

2654 
d›
;

2658 
$»tuº
 = 
$this
->
	`_add
(
$po¡_d©a
, 
$moduË
,
$OrgID
,
$U£rID
);

2659 ià(
$»tuº
['res'] == 'fail') {

2660  
$»tuº
;

2661 
d›
;

2663 
$func
 = 
__FUNCTION__
;

2664 
$this
->
	`is_m‘hod_ex™s
(
$»tuº
['id'], 
$moduË
, 
$func
, 
$Üg_id
);

2665  
$»tuº
;

2666 
	}
}

2673 
public
 
funùiÚ
 
	$is_m‘hod_ex™s
(
$»tuº
, 
$moduË
, 
$func
, 
$Üg_id
 = 1) {

2677 ià(
$this
->
	`»quœe_·th
(
$moduË
)) {

2678 
$m
 = 
	`¡¹Şow”
(
$moduË
);

2679 
$func
 = 
$m
 . "_" . $func;

2680 ià(
	`m‘hod_exi¡s
(
$this
->
$m
, 
$func
)) {

2681 
$this
->
$m
->
	`$func
(
$»tuº
, 
$moduË
, 
$Üg_id
);

2685 
	}
}

2692 
´Ùeùed
 
funùiÚ
 
	$»quœe_·th
(
$moduË
) {

2693 
$dœeùÜy_£·¿tÜ
 = 
DIRECTORY_SEPARATOR
;

2694 
$www_·th
 = 
FCPATH
 . "­¶iÿtiÚ" . 
$dœeùÜy_£·¿tÜ
 . "mod–s" . $dœeùÜy_£·¿tÜ . "www" . $dœeùÜy_£·¿tÜ . 
	`¡¹Şow”
(
$moduË
) . "_model.php";

2695 
$admš_·th
 = 
FCPATH
 . "­¶iÿtiÚ" . 
$dœeùÜy_£·¿tÜ
 . "mod–s" . $dœeùÜy_£·¿tÜ . "admš" . $dœeùÜy_£·¿tÜ . 
	`¡¹Şow”
(
$moduË
) . "_model.php";

2696 
$m
 = 
	`¡¹Şow”
(
$moduË
);

2697 ià(
	`fe_exi¡s
(
$www_·th
)) {

2698 
$this
->
lßd
->
	`mod–
("www/" . 
$m
 . "_model", $m);

2699  
Œue
;

2700 } 
	`–£if
 (
	`fe_exi¡s
(
$admš_·th
)) {

2701 
$this
->
lßd
->
	`mod–
("admš/" . 
$m
 . "_model", $m);

2702  
Œue
;

2704  
çl£
;

2706 
	}
}

2713 
public
 
funùiÚ
 
	$is_unique
(
$Üg_id
,
$d©a
,
$objeù_©Œ
,
$moduË
){

2714 
$func
 = 
__FUNCTION__
;

2715 
$this
->
	`is_m‘hod_ex™s
(
$d©a
, 
$moduË
, 
$func
, 
$Üg_id
);

2716 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

2717 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

2718 if(
$objeù_©Œ
[
$kk
]['is_unique']&&!
	`em±y
(
$vv
)){

2719 
$wh”e
[
$objeù_©Œ
[
$kk
]['æd_Çme']] = 
$vv
;

2720 
$»suÉ
 = 
$this
->
db
->
	`äom
(
$k
)->
	`wh”e
(
$wh”e
)->
	`g‘
()->
	`»suÉ_¬¿y
();

2721 if(
	`couÁ
(
$»suÉ
)>0){

2722  
$objeù_©Œ
[
$kk
]['label'];

2724 
	`un£t
(
$wh”e
);

2730 
	}
}

2731 
public
 
funùiÚ
 
	$fÜm©ID
(
$ty³_id
,
$obj_d©a
,
$OrgID
,&
$d©a
){

2732 
$this
->
lßd
->
	`mod–
('admin/nextid', 'nextid');

2733 
$IDfÜm©
 = 
$this
->
Ãxtid
->
	`NewFÜm©ID
(
$ty³_id
, 
$obj_d©a
, 
$OrgID
);

2735 ià(!
	`em±y
(
$IDfÜm©
['FORMAT'])) {

2736 
$¬r
 = 
	`ex¶ode
('.', 
$IDfÜm©
['ATTR_NAME']);

2737 
$FÜm©ID
 = 
$this
->
Ãxtid
->
	`NewID
(
	`¡¹ouµ”
(
$¬r
[0]).'_'.¡¹ouµ”($¬r[1]).'_' . 
$ty³_id
 . '_' . 
	`d©e
('Ymd'), 
$OrgID
);

2738 
$¡¿¼
 = 
	`¬¿y
(

2739 '{YYYY}' => 
	`d©e
('Y'),

2740 '{MM}' => 
	`d©e
('m'),

2741 '{DD}' => 
	`d©e
('d'),

2742 '{0000}' => 
	`¡r_·d
(
$FÜm©ID
, 4, "0", 
STR_PAD_LEFT
),

2745 
$Ëad_u£rid
 = 
	`¡¹r
(
$IDfÜm©
['FORMAT'], 
$¡¿¼
);

2746 
$d©a
[
$IDfÜm©
['ATTR_NAME']] = 
$Ëad_u£rid
;

2748  
$Ëad_u£rid
;

2749 
	}
}

2753 
public
 
funùiÚ
 
	$pub_add
(
$d©a
, 
$moduË
, 
$OrgID
 = 1, 
$U£rID
){

2754 
$this
->
lßd
->
	`mod–
('admin/nextid', 'nextid');

2756 
$time
 = 
	`d©e
("Y-m-d H:i:s");

2758 
$ty³_id
 = 
	`em±y
(
$d©a
[
$moduË
 . '.TypeID'])?$data[$module . '.Type.ID']:$data[$module . '.TypeID'];

2760 
$objeù_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$moduË
);

2761 
$tbl_Çme
 = 
$this
->
	`G‘AÎTbl
(
$OrgID
, 
$moduË
);

2762 
	`fÜ—ch
 (
$tbl_Çme
 
as
 
$k
 => 
$v
) {

2763 
$š£¹
[
$v
] = 
	`¬¿y
();

2766 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$moduË
);

2767 
$maš_tbl
 = 
$obj_d©a
['MAIN_TABLE'];

2768 
$pk
 = 
$obj_d©a
['KEY_ATTR_FLD'];

2771 
$this
->
	`fÜm©ID
(
$ty³_id
,
$obj_d©a
,
$OrgID
,
$d©a
);

2774 
$Ãxtid
 = 
$this
->
Ãxtid
->
	`NewID
(
$maš_tbl
, 
$OrgID
);

2775 
$u£rd©a
 = 
$this
->
u£r
->
	`S–eùOÃ
(
$OrgID
, 
$U£rID
);

2777 
$d©a
[
$moduË
 . '.C»©edByID'] = 
$U£rID
;

2778 
$d©a
[
$moduË
 . '.C»©edTime'] = 
$time
;

2779 
$d©a
[
$moduË
 . '.Modif›dByID'] = 
$U£rID
;

2780 
$d©a
[
$moduË
 . '.Modif›dTime'] = 
$time
;

2783 if(
$moduË
=='Account'){

2784 
$d©a
['Account.emstatus']='æ½œåœ¨å®¢æˆ·';

2785 
$d©a
['Account.emstatus.value']='æ½œåœ¨å®¢æˆ·';

2786 
$d©a
['Account.emstatus.enum_key']='1001';

2789 
$nd©a
 = 
$this
->
	`ŒªsfÜm
(
$d©a
, 
$moduË
, 
$OrgID
);

2790 ià(
$nd©a
 =ğ
çl£
 || 
	`em±y
($ndata)) {

2791 
$»s
['res'] = 'fail';

2792 
$»s
['msg'] = 'ä¿å­˜å¤±è´¥ï¼è¯·å¡«å†™æ­£ç¡®æ‰€æœ‰è€…æˆ–éƒ¨é—¨ï¼';

2793  
$»s
;

2796 
	`fÜ—ch
 (
$nd©a
 
as
 
$k
 => 
$v
) {

2797 ià(
	`em±y
(
$v
)) {

2800 
$š£¹
[
$objeù_©Œ
[
$k
]['tbl_Çme']][$k] = 
$v
;

2802 if(
$moduË
 == 'Task'){

2803 
$š£¹
['tc_aùiv™y']['Task.AùvtCÏss'] = 
$obj_d©a
['OBJ_TYPE'];

2806 
$is_unique
 = 
$this
->
	`is_unique
(
$Üg_id
,
$š£¹
,
$objeù_©Œ
,
$moduË
);

2807 if(
$is_unique
 != 1){

2808 
$»s
['res'] = 'fail';

2809 
$»s
['msg'] = 'ä¿å­˜å¤±è´¥ï¼'.
$is_unique
.'é‡å¤ï¼Œæ•°æ®åº“ä¸­å·²å­˜åœ¨ï¼';

2810  
$»s
;

2812 
$»s
['obj_d©a'] = 
$obj_d©a
;

2813 
$»s
['Ãxtid'] = 
$Ãxtid
;

2814 
$»s
['pk'] = 
$pk
;

2815 
$»s
['objeù_©Œ'] = 
$objeù_©Œ
;

2816 
$»s
['nd©a'] = 
$nd©a
;

2817 
$»s
['š£¹'] = 
$š£¹
;

2818 
$»s
['res'] = 'suc';

2819  
$»s
;

2821 
	}
}

2829 
public
 
funùiÚ
 
	$_add
(
$d©a
, 
$moduË
, 
$OrgID
 = 1, 
$U£rID
) {

2831 
$»t
 = 
$this
->
	`pub_add
(
$d©a
, 
$moduË
, 
$OrgID
 = 1, 
$U£rID
);

2832 if(
$»t
['res'] == 'fail'){

2833  
$»t
;

2837 
$this
->
	`Œªs_add_aù
(
$»t
['š£¹'],$»t['objeù_©Œ'],$»t['pk'],$»t['Ãxtid'],
$OrgID
,
$moduË
,$ret['ndata'],$ret['obj_data']);

2843 
$»s
['res'] = 'suc';

2844 
$»s
['id'] = 
$»t
['nextid'];

2845 
$»s
['msg'] = 'ä¿å­˜æˆåŠŸï¼';

2847  
$»s
;

2848 
	}
}

2861 
public
 
funùiÚ
 
	$Œªs_add_aù
(
$š£¹
,
$objeù_©Œ
,
$pk
,
$Ãxtid
,
$OrgID
,
$moduË
,
$nd©a
,
$obj_d©a
){

2862 
	`fÜ—ch
 (
$š£¹
 
as
 
$k
 => 
$v
) {

2863 ià(!
	`em±y
(
$v
)) {

2864 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

2866 
$objeù_©Œ
[
$kk
]['attr_type']) {

2868 if(
$objeù_©Œ
[
$kk
]['is_ref_obj']){

2869 
$this
->
db
->
	`£t
(
$objeù_©Œ
[$objeù_©Œ[
$kk
]['»ã¼ed_by']]['æd_Çme'], 
$vv
);

2871 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
);

2885 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
, 
çl£
);

2888 ià(!
	`em±y
(
$vv
)) {

2890 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], "to_d©e('" . 
$vv
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

2895 ià(!
	`em±y
(
$vv
)) {

2896 
$vv
 = 
	`d©aReduû8
('Y-m-d H:i:s', $vv);

2897 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], "to_d©e('" . 
$vv
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

2902 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
);

2908 
$this
->
db
->
	`£t
(
$pk
, 
$Ãxtid
);

2910 
$this
->
db
->
	`£t
('Üg_id', 
$OrgID
, 
çl£
);

2911 
$this
->
db
->
	`š£¹
(
$k
);

2916 
	`fÜ—ch
 (
$š£¹
 
as
 
$k
 => 
$v
) {

2917 ià(
	`em±y
(
$v
)) {

2920 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

2921 
$objeù_©Œ
[
$kk
]['attr_type']) {

2924 
$wh”e
 = 
	`¬¿y
(
$pk
 => 
$Ãxtid
, 'Üg_id' => 
$OrgID
);

2925 
$£t
 = 
	`¬¿y
(
$objeù_©Œ
[
$kk
]['æd_Çme'] => 
$vv
);

2926 
$this
->
objeùs
->
	`_blob_upd©e
(
$k
, 
$wh”e
, 
$£t
);

2935 
$obj_Çme
 = 
	`¡¹Şow”
(
$moduË
);

2936 
$»l_u£r
 = 
	`¡¹r
('»l_xxx_u£r', 'xxx', 
$obj_Çme
);

2937 
$»l_´ivege
 = 
	`¡¹r
('»l_xxx_´ivege', 'xxx', 
$obj_Çme
);

2938 if(
$moduË
 == 'Task'){

2939 
$»l_u£r_id
 = 
$nd©a
[
$moduË
 . '.AssignedToID']?$ndata[$module . '.AssignedToID']:$ndata[$module . '.AssignedTo'];

2941 
$this
->
	`§v”–u£r
(
$OrgID
,10,
$Ãxtid
,
$»l_u£r_id
,1);

2943 
$»l_u£r_id
 = 
$nd©a
[
$moduË
 . '.OwnerID']?$ndata[$module . '.OwnerID']:$ndata[$module . '.Owner'];

2945 
$this
->
	`§v”–u£r
(
$OrgID
,
$obj_d©a
['OBJ_TYPE'],
$Ãxtid
,
$»l_u£r_id
,1);

2948 if(
$moduË
=='Contact'){

2949 
$»l_d•t_id
 = 
$nd©a
[
$moduË
 . '.OwnerDeptID']?$ndata[$module . '.OwnerDeptID']:$ndata[$module . '.OwnerDept'];

2951 }
	`–£if
(
$moduË
 == 'Task'){

2954 
$»l_d•t_id
 = 
$nd©a
[
$moduË
 . '.DepartmentID']?$ndata[$module . '.DepartmentID']:$ndata[$module . '.Department'];

2958 if(
$moduË
 != 'Task'){

2959 
$this
->
	`§v”–´ivege
(
$OrgID
,
$obj_d©a
['OBJ_TYPE'],
$Ãxtid
,
$»l_d•t_id
);

2962 
$this
->
»mšd
->
	`AddRemšd
(
$obj_d©a
['OBJ_TYPE'],
$OrgID
,1,
$Ãxtid
);

2963 
	}
}

2965 
public
 
funùiÚ
 
	$add»Ïùvt
(
$Üg_id
, 
$obj_Çme
, 
$Ãxt_id
, 
$pk
, 
$pk_id
,
$u£r_id
){

2966 
$time
 = 
	`d©aReduû8
('Y-m-d H:i:s', 
	`d©e
("Y-m-d H:i:s"));

2967 
$š£¹
 = 
	`¬¿y
(

2968 'Üg_id' => 
$Üg_id
,

2969 'aùvt_id' => 
$Ãxt_id
,

2970 
$pk
 => 
$pk_id
,

2971 'ü—‹_u£r_id' => 
$u£r_id
,

2973 
$this
->
db
->
	`£t
('ü—‹_time', "to_d©e('" . 
$time
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

2974 
$this
->
db
->
	`š£¹
('»l_aùiv™y_'.
$obj_Çme
, 
$š£¹
);

2975 
	}
}

2977 
public
 
funùiÚ
 
	$add¡age
(
$Üg_id
=1,
$Ãxtid
){

2978 
$this
->
db
->
	`äom
('tc_opportunity_stage');

2979 
$wh”e
 = 
	`¬¿y
(

2980 'Üg_id' => 
$Üg_id
,

2984 
$this
->
db
->
	`wh”e
(
$wh”e
);

2985 
$¡age_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

2986 
$¡age_d©a
[0]['STAGE_ID'] = 
$this
->
Ãxtid
->
	`NewID
('tc_İpÜtun™y_¡age',
$Üg_id
);

2987 
$¡age_d©a
[0]['TYPE_ID'] = 0;

2988 
$¡age_d©a
[0]['OBJ_ID'] = 
$Ãxtid
;

2989 
$this
->
db
->
	`š£¹
('tc_İpÜtun™y_¡age',
$¡age_d©a
[0]);

2990  
$¡age_d©a
[0]['STAGE_ID'];

2991 
	}
}

2993 
public
 
funùiÚ
 
	$§v”–u£r
(
$OrgID
=1,
$obj_ty³
,
$id
,
$u£r_id
,
$is_£lf
){

2994 
$d©a
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj_ty³
);

2995 
$wh”e
 = 
	`¬¿y
(

2996 'Üg_id' => 
$OrgID
,

2997 
$d©a
['KEY_ATTR_FLD'] => 
$id
,

2998 'u£r_id' => 
$u£r_id


3000 
$this
->
db
->
	`wh”e
(
$wh”e
);

3001 
$this
->
db
->
	`äom
('»l_' . 
$d©a
['OBJ_NAME'] . '_user');

3002 
$check
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

3003 if(!
	`em±y
(
$check
)){

3004 
$»s
['res'] = 'fail';

3005 
$»s
['msg'] = 'é€‰æ‹©çš„å‘˜å·¥å·²åŠ å…¥ç›¸å…³å‘˜å·¥æˆ–è´Ÿè´£å‘˜å·¥ï¼';

3006  
$»s
;

3008 
$»l_u£r_¬r
 = 
	`¬¿y
(

3009 'Üg_id' => 
$OrgID
,

3010 
$d©a
['KEY_ATTR_FLD'] => 
$id
,

3011 'u£r_id' => 
$u£r_id
,

3012 'is_£lf' => 
$is_£lf


3014 
$this
->
db
->
	`š£¹
('»l_' . 
$d©a
['OBJ_NAME'] . '_u£r', 
$»l_u£r_¬r
);

3015 
$»s
['res'] = 'suc';

3016  
$»s
;

3017 
	}
}

3019 
public
 
funùiÚ
 
	$§v”–´ivege
(
$OrgID
=1,
$obj_ty³
,
$id
,
$d•t_id
){

3020 
$d©a
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj_ty³
);

3021 
$wh”e
 = 
	`¬¿y
(

3022 'Üg_id' => 
$OrgID
,

3023 
$d©a
['KEY_ATTR_FLD'] =>
$id
,

3025 '´ivege_id' => 
$d•t_id
,

3028 
$this
->
db
->
	`wh”e
(
$wh”e
);

3029 
$this
->
db
->
	`äom
('»l_' . 
$d©a
['OBJ_NAME'] . '_privilege');

3030 
$check
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

3031 if(!
	`em±y
(
$check
)){

3032 
$»s
['res'] = 'fail';

3033 
$»s
['msg'] = 'é€‰æ‹©çš„éƒ¨é—¨å·²åŠ å…¥ç›¸å…³ç®¡ç†ç»´åº¦ï¼';

3034  
$»s
;

3036 
$»l_´ivege_¬r
 = 
	`¬¿y
(

3037 'Üg_id' => 
$OrgID
,

3038 
$d©a
['KEY_ATTR_FLD'] =>
$id
,

3039 'p_id' => 
$this
->
Ãxtid
->
	`NewID
('»l_'.
$d©a
['OBJ_NAME'].'_´ivege',
$OrgID
),

3041 '´ivege_id' => 
$d•t_id
,

3044 
$this
->
db
->
	`š£¹
('»l_' . 
$d©a
['OBJ_NAME'] . '_´ivege', 
$»l_´ivege_¬r
);

3045 
$»s
['res'] = 'suc';

3046  
$»s
;

3047 
	}
}

3049 
public
 
funùiÚ
 
	$§v”–
(
$OrgID
=1,
$obj_ty³
,
$id
,
$»l_obj_ty³
,
$»l_id
){

3050 
$d©a
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj_ty³
);

3051 
$»l_d©a
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$»l_obj_ty³
);

3052 
$wh”e
 = 
	`¬¿y
(

3053 'Üg_id' => 
$OrgID
,

3054 
$d©a
['KEY_ATTR_FLD'] => 
$id
,

3055 
$»l_d©a
['KEY_ATTR_FLD'] => 
$»l_id
,

3057 
$this
->
db
->
	`wh”e
(
$wh”e
);

3058 
$this
->
db
->
	`äom
('»l_' . 
$d©a
['OBJ_NAME'] . '_'.
$»l_d©a
['OBJ_NAME']);

3059 
$check
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

3060 if(!
	`em±y
(
$check
)){

3061 
$»s
['res'] = 'fail';

3062 
$»s
['msg'] = 'å…³ç³»å·²ç»å­˜åœ¨ï¼è¯·é€‰æ‹©å…¶ä»–ã€‚';

3063  
$»s
;

3065 
$»l_¬r
 = 
	`¬¿y
(

3066 'Üg_id' => 
$OrgID
,

3067 
$d©a
['KEY_ATTR_FLD'] => 
$id
,

3068 
$»l_d©a
['KEY_ATTR_FLD'] => 
$»l_id
,

3070 
$»t
 = 
$this
->
db
->
	`š£¹
('»l_' . 
$d©a
['OBJ_NAME'] . '_'.
$»l_d©a
['OBJ_NAME'], 
$»l_¬r
);

3071 
$»s
['res'] = 'suc';

3072  
$»s
;

3073 
	}
}

3081 
public
 
funùiÚ
 
_upd©e
(
$d©a
, 
$wh”e
, 
$objeù_©Œ
, 
$moduË
, 
$OrgID
 = 1, 
$U£rID
,
$cÚ‹Á
=
	$¬¿y
()) {

3083 
$objD©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$moduË
);

3086 
$time
 = 
	`d©e
("Y-m-d H:i:s");

3087 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$moduË
);

3089 
$maš_tbl
 = 
$obj_d©a
['MAIN_TABLE'];

3091 
$d©a
[
$moduË
 . '.Modif›dByID'] = 
$U£rID
;

3092 
$d©a
[
$moduË
 . '.Modif›dTime'] = 
$time
;

3103 
$nd©a
 = 
$this
->
	`ŒªsfÜm
(
$d©a
, 
$moduË
, 
$OrgID
);

3104 
	`fÜ—ch
 (
$nd©a
 
as
 
$k
 => 
$v
) {

3105 if(
	`em±y
(
$v
)){

3106 
$upd©e
[
$objeù_©Œ
[
$k
]['tbl_name']][$k]="";

3108 
$upd©e
[
$objeù_©Œ
[
$k
]['tbl_Çme']][$k] = 
$v
;

3116 
	`fÜ—ch
 (
$upd©e
 
as
 
$k
 => 
$v
) {

3118 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

3120 
$objeù_©Œ
[
$kk
]['attr_type']) {

3140 if(
	`em±y
(
$vv
)){

3141 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
);

3143 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
, 
çl£
);

3148 ià(!
	`em±y
(
$vv
)) {

3150 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], "to_d©e('" . 
$vv
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

3154 ià(!
	`em±y
(
$vv
)) {

3155 
$vv
 = 
	`d©aReduû8
('Y-m-d H:i:s', $vv);

3156 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], "to_d©e('" . 
$vv
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

3161 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
, 
çl£
);

3165 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
);

3170 
$this
->
db
->
	`wh”e
(
$wh”e
);

3171 if(
$moduË
 != 'User'){

3172 
$pwh”e
 = 
$this
->
	`´emissiÚLi¡2
(
$objD©a
, 
$k
, 
$OrgID
, 
$U£rID
, "edit");

3173 
$this
->
db
->
	`wh”e
(
$pwh”e
, 
NULL
, 
FALSE
);

3175 
$this
->
db
->
	`upd©e
(
$k
);

3179 
	`fÜ—ch
 (
$upd©e
 
as
 
$k
 => 
$v
) {

3180 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

3181 
$objeù_©Œ
[
$kk
]['attr_type']) {

3183 
$£t
 = 
	`¬¿y
(
$objeù_©Œ
[
$kk
]['æd_Çme'] => 
$vv
);

3184 
$this
->
objeùs
->
	`_blob_upd©e
(
$k
, 
$wh”e
, 
$£t
);

3192 if(
	`is£t
(
$nd©a
[
$moduË
 . '.AssignedToID']) || isset($ndata[$module . '.OwnerID'])||isset($ndata[$module . '.AssignedTo'])||isset($ndata[$module . '.Owner'])){

3193 if(
$moduË
 == 'Task'){

3194 
$du_wh”e
 = 
	`¬¿y
(

3195 'Üg_id' => 
$OrgID
,

3196 
$obj_d©a
['KEY_ATTR_FLD'] => 
$wh”e
[$obj_data['KEY_ATTR_FLD']],

3197 'u£r_id' => 
$cÚ‹Á
[
$moduË
 . '.AssignedToID']?$content[$module . '.AssignedToID']:$content[$module . '.AssignedTo'],

3200 
$this
->
db
->
	`wh”e
(
$du_wh”e
)->
	`d–‘e
('»l_' . 
$moduË
 . '_user');

3202 
$»l_u£r_id
 = 
$nd©a
[
$moduË
 . '.AssignedToID']?$ndata[$module . '.AssignedToID']:$ndata[$module . '.AssignedTo'];

3204 
$this
->
	`§v”–u£r
(
$OrgID
,10,
$wh”e
[
$obj_d©a
['KEY_ATTR_FLD']],
$»l_u£r_id
,1);

3206 
$du_wh”e
 = 
	`¬¿y
(

3207 'Üg_id' => 
$OrgID
,

3208 
$obj_d©a
['KEY_ATTR_FLD'] => 
$wh”e
[$obj_data['KEY_ATTR_FLD']],

3209 'u£r_id' => 
$cÚ‹Á
[
$moduË
 . '.OwnerID']?$content[$module . '.OwnerID']:$content[$module . '.Owner'],

3212 
$this
->
db
->
	`wh”e
(
$du_wh”e
)->
	`d–‘e
('»l_' . 
$moduË
 . '_user');

3213 
$»l_u£r_id
 = 
$nd©a
[
$moduË
 . '.OwnerID']?$ndata[$module . '.OwnerID']:$ndata[$module . '.Owner'];

3215 
$this
->
	`§v”–u£r
(
$OrgID
,
$obj_d©a
['OBJ_TYPE'],
$wh”e
[$obj_d©a['KEY_ATTR_FLD']],
$»l_u£r_id
,1);

3218 if(
$moduË
=='Contact'){

3219 
$dp_wh”e
 = 
	`¬¿y
(

3220 'Üg_id'=>
$OrgID
,

3221 '´ivege_id' => 
$cÚ‹Á
[
$moduË
 . '.OwnerDeptID']?$content[$module . '.OwnerDeptID']:$content[$module . '.OwnerDept'],

3222 
$obj_d©a
['KEY_ATTR_FLD']=>
$wh”e
[$obj_data['KEY_ATTR_FLD']]

3224 
$this
->
db
->
	`wh”e
(
$dp_wh”e
)->
	`d–‘e
('»l_' . 
$moduË
 . '_privilege');

3225 
$»l_d•t_id
 = 
$nd©a
[
$moduË
 . '.OwnerDeptID']?$ndata[$module . '.OwnerDeptID']:$ndata[$module . '.OwnerDept'];

3227 }
	`–£if
(
$moduË
 == 'Task'){

3230 
$dp_wh”e
 = 
	`¬¿y
(

3231 'Üg_id'=>
$OrgID
,

3232 '´ivege_id' => 
$cÚ‹Á
[
$moduË
 . '.DepartmentID']?$content[$module . '.DepartmentID']:$content[$module . '.Department'],

3233 
$obj_d©a
['KEY_ATTR_FLD']=>
$wh”e
[$obj_data['KEY_ATTR_FLD']]

3235 
$this
->
db
->
	`wh”e
(
$dp_wh”e
)->
	`d–‘e
('»l_' . 
$moduË
 . '_privilege');

3236 
$»l_d•t_id
 = 
$nd©a
[
$moduË
 . '.DepartmentID']?$ndata[$module . '.DepartmentID']:$ndata[$module . '.Department'];

3240 if(
$moduË
 != 'Task'){

3241 
$this
->
	`§v”–´ivege
(
$OrgID
,
$obj_d©a
['OBJ_TYPE'],
$wh”e
[$obj_d©a['KEY_ATTR_FLD']],
$»l_d•t_id
);

3247 
$this
->
»mšd
->
	`AddRemšd
(
$obj_d©a
['OBJ_TYPE'],
$OrgID
,2,
$wh”e
[$obj_data['KEY_ATTR_FLD']]);

3253 
$»s
['res'] = 'suc';

3254 
$»s
['msg'] = 'æ›´æ–°æˆåŠŸï¼';

3255  
$»s
;

3257 
	}
}

3258 
public
 
funùiÚ
 
	$_d‘a_upd©e
(
$d©a
, 
$wh”e
, 
$objeù_©Œ
, 
$moduË
, 
$OrgID
 = 1, 
$U£rID
) {

3261 
$objD©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$moduË
);

3262 
$pwh”e
 = 
$this
->
	`´emissiÚLi¡
(
$objD©a
, 
$OrgID
, 
$U£rID
, "edit");

3264 
$time
 = 
	`d©e
("Y-m-d H:i:s");

3265 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$moduË
);

3267 
$maš_tbl
 = 
$obj_d©a
['MAIN_TABLE'];

3280 
$nd©a
 = 
$this
->
	`ŒªsfÜm
(
$d©a
, 
$moduË
, 
$OrgID
);

3282 
	`fÜ—ch
 (
$nd©a
 
as
 
$k
 => 
$v
) {

3283 
$upd©e
[
$objeù_©Œ
[
$k
]['tbl_Çme']][$k] = 
$v
;

3289 
	`fÜ—ch
 (
$upd©e
 
as
 
$k
 => 
$v
) {

3291 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

3293 
$objeù_©Œ
[
$kk
]['attr_type']) {

3314 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
, 
çl£
);

3317 ià(!
	`em±y
(
$vv
)) {

3318 
$vv
 = 
	`d©aReduû8
('Y-m-d', $vv);

3319 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], "to_d©e('" . 
$vv
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

3323 ià(!
	`em±y
(
$vv
)) {

3324 
$vv
 = 
	`d©aReduû8
('Y-m-d H:i:s', $vv);

3325 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], "to_d©e('" . 
$vv
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

3330 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
, 
çl£
);

3334 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
);

3339 
$this
->
db
->
	`wh”e
(
$wh”e
);

3340 
$this
->
db
->
	`wh”e
(
$pwh”e
, 
NULL
, 
FALSE
);

3341 
$this
->
db
->
	`upd©e
(
$k
);

3348 
$»s
['res'] = 'suc';

3349 
$»s
['msg'] = 'æ›´æ–°æˆåŠŸï¼';

3350  
$»s
;

3352 
	}
}

3356 
public
 
funùiÚ
 
	$is_»ã»nû
(
$obj_Çme
,
$id
){

3357 
$£Ëù
 = 
	`¬¿y
(

3361 
$cÚd™iÚ
 = 
	`¬¿y
(

3362 'a.»f_obj_Çme' => 
$obj_Çme
,

3363 'a.Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

3364 'b.Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

3367 
$qu”y
 = 
$this
->
db
->
	`äom
("dd_attribute‡")->

3368 
	`još
('dd_object b', 'a.obj_name=b.obj_name', 'left')->

3369 
	`wh”e
(
$cÚd™iÚ
)->

3370 
	`£Ëù
(
$£Ëù
)->
	`g‘
()->
	`»suÉ_¬¿y
();

3372 
	`fÜ—ch
(
$qu”y
 
as
 
$v®ue
){

3373 
$cÚd™iÚ
 = 
nuÎ
;

3374 
$cÚd™iÚ
[
$v®ue
["KEY_ATTR_FLD"]] = 
$id
;

3375 
$qu”y
 = 
$this
 -> 
db
-> 
	`äom
(
$v®ue
["MAIN_TABLE"]è-> 
	`wh”e
(
$cÚd™iÚ
)-> 
	`couÁ_®l_»suÉs
();

3376 if(
$qu”y
 > 0){

3377  
Œue
;

3380  
çl£
;

3382 
	}
}

3389 
public
 
funùiÚ
 
	$_d–
(
$id
, 
$obj_ty³
, 
$d©a
, 
$pwh”e
, 
$maš_ty³
 = 0) {

3391 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj_ty³
);

3392 
$obj_id
 = 
$obj
['KEY_ATTR_FLD'];

3393 
$cÚd™iÚ
[
$obj_id
] = 
$id
;

3394 
$bË_Çme
 = 
$this
->
	`g‘D–‘eTabË
(
$obj_ty³
);

3395 if(
$bË_Çme
){

3396 if(
	`¡½os
(
$bË_Çme
,"_xxx_")){

3397 
$maš_obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$maš_ty³
);

3398 
$maš_obj_Çme
ğ
$maš_obj
["OBJ_NAME"];

3399 
$bË_Çme
 = 
	`¡¹Şow”
(
	`¡r_»¶aû
("xxx",
$maš_obj_Çme
,$table_name) );

3400  
$this
->
db
->
	`wh”e
(
$cÚd™iÚ
)->wh”e(
$pwh”e
)->
	`d–‘e
(
$bË_Çme
);

3402 
$obj_Çme
 = 
$obj
["OBJ_NAME"];

3403 ifĞ
$this
 -> 
	`is_»cyşabË
(
$obj_Çme
) ){

3404 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

3405 ià(
$k
 == "DELETED_TIME") {

3406 
$this
->
db
->
	`£t
(
$k
, 
$v
, 
çl£
);

3408 
$this
->
db
->
	`£t
(
$k
, 
$v
);

3411  
$this
->
db
->
	`wh”e
(
$cÚd™iÚ
)->wh”e(
$pwh”e
)->
	`upd©e
(
$bË_Çme
);

3413  
$this
->
db
->
	`wh”e
(
$cÚd™iÚ
)->wh”e(
$pwh”e
)->
	`d–‘e
(
$bË_Çme
);

3417  
çl£
;

3420 
	}
}

3425 
public
 
funùiÚ
 
	$»Ï‹d_objeùs
(
$id
, 
$mid
,
$obj_ty³
, 
$d©a
, 
$pwh”e
, 
$maš_ty³
 ){

3426 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj_ty³
);

3427 
$maš_obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$maš_ty³
);

3428 
$maš_obj_Çme
ğ
$maš_obj
["OBJ_NAME"];

3429 
$bË_Çme
 = 
	`¡¹Şow”
("»l_".
$maš_obj_Çme
."_user");

3430 
$cÚd™iÚ
[
$obj
['KEY_ATTR_FLD']] = 
$id
;

3431 
$cÚd™iÚ
[
$maš_obj
['KEY_ATTR_FLD']] = 
$mid
;

3432  
$this
->
db
->
	`wh”e
(
$cÚd™iÚ
)->wh”e(
$pwh”e
)->
	`d–‘e
(
$bË_Çme
);

3433 
	}
}

3441 
public
 
funùiÚ
 
	$is_»cyşabË
(
$obj_Çme
){

3442 
$£Ëù
 = 
	`¬¿y
(

3445 
$cÚd™iÚ
 = 
	`¬¿y
(

3446 'Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

3447 'obj_Çme' => 
$obj_Çme


3449 
$qu”y
 = 
$this
->
db
 -> 
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
("dd_objeù")->
	`»suÉ_¬¿y
();

3450  
$qu”y
[0]['IS_RECYCLABLE'];

3452 
	}
}

3461 
´iv©e
 
funùiÚ
 
	$g‘D–‘eTabË
(
$obj_ty³
) {

3462 
$this
->
db
->
	`£Ëù
("MAIN_TABLE");

3463 
$this
->
db
->
	`äom
("dd_object");

3464 
$this
->
db
->
	`wh”e
('OBJ_TYPE', 
$obj_ty³
);

3465 
$qu”y
 = 
$this
->
db
->
	`g‘
();

3466 ià(
$qu”y
->
	`num_rows
() > 0) {

3467 
$row
 = 
$qu”y
->
	`row_¬¿y
();

3468  
$row
['MAIN_TABLE'];

3470  
nuÎ
;

3472 
	}
}

3483 
public
 
funùiÚ
 
	$hi¡Üy
(
$d©a
, 
$obj_id
, 
$cÚ‹Á
, 
$objeù_©Œ
, 
$moduË
, 
$u£r_id
) {

3484 
$this
->
lßd
->
	`mod–
('admin/nextid', 'nextid');

3485 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

3486 
$Üg_id
 = $org_id ? $org_id : 1;

3487 
$bË
 = 'tc_' . 
$moduË
 . '_history';

3488 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 
$moduË
);

3489 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

3490 ià(
$objeù_©Œ
[
$k
]['is_history']) {

3491 ià(
	`is£t
(
$cÚ‹Á
[
$k
 . '.enum_key'])) {

3492 
$Şd_v®ue
 = 
$cÚ‹Á
[
$k
 . '.enum_key'];

3494 
$Şd_v®ue
 = 
$cÚ‹Á
[
$k
];

3497 
$Ãxtid
 = 
$this
->
Ãxtid
->
	`NewId
(
$bË
, 
$Üg_id
);

3498 
$time
 = 
	`d©aReduû8
('Y-m-d H:i:s', 
	`d©e
("Y-m-d H:i:s"));

3499 
$š£¹
[] = 
	`¬¿y
(

3500 'his_id' => 
$Ãxtid
,

3501 'Üg_id' => 
$Üg_id
,

3502 
$obj_d©a
['KEY_ATTR_FLD'] => 
$obj_id
,

3503 '©Œ_Çme' => 
$k
,

3504 'Şd_v®ue' => 
$Şd_v®ue
,

3505 'Ãw_v®ue' => 
$v
,

3506 'ü—‹_u£r_id' => 
$u£r_id
,

3511 ià(!
	`em±y
(
$š£¹
)) {

3512 
	`fÜ—ch
 (
$š£¹
 
as
 
$k
 => 
$v
) {

3513 
	`fÜ—ch
 (
$v
 
as
 
$key
 => 
$v®ue
) {

3514 ià(
$key
 == 'create_time') {

3515 
$this
->
db
->
	`£t
(
$key
, 
$v®ue
, 
çl£
);

3517 
$this
->
db
->
	`£t
(
$key
, 
$v®ue
);

3520 
$this
->
db
->
	`š£¹
(
$bË
);

3523  
Œue
;

3524 
	}
}

3533 
public
 
funùiÚ
 
	$G‘OÃCÚ‹Á
(
$ObjName
, 
$OrgID
, 
$ObjID
) {

3534 
$ObjA‰r
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$ObjName
);

3535 
$d©a
 = 
$this
->
	`G‘OldInfo
(
$ObjName
, 
$OrgID
, 
$ObjA‰r
, 
$ObjID
);

3536  
$d©a
;

3537 
	}
}

3547 
public
 
funùiÚ
 
	$G‘OldInfo
(
$ObjName
, 
$OrgID
, 
$ObjA‰r
, 
$ObjID
) {

3548 ià(
$ObjID
) {

3549 
$cÚ‹Á
 = 
$this
->
	`G‘AÎ
(
$OrgID
, 
$ObjID
, 
$ObjName
);

3552 
	`fÜ—ch
 (
$ObjA‰r
 
as
 
$k
 => 
$v
) {

3554 
$v
['attr_type']) {

3556 ià(
$v
['is_ref_obj']) {

3558 ià(
$v
["ref_obj_name"] == "ReferObject") {

3559 
$SRC_ID
 = 
$cÚ‹Á
[
	`¡¹ouµ”
(
$ObjA‰r
[
$v
["referred_by"]]["fld_name"])];

3560 ià(
$SRC_ID
 =ğ"0" || 
	`em±y
($SRC_ID)) {

3561 
$Ëad_d©a
[
$k
] = "";

3569 
$ÌÙ
 = 
	`¬¿y
('Üg_id'=>
$OrgID
,'©Œ_Çme'=>
$k
);

3570 
$ÌÙd©a
 = 
$this
->
db
->
	`£Ëù
('Ëe_»ãr_obj_ty³‡ ÌÙ')->
	`äom
('dd_©Œibu‹')->
	`wh”e
(
$ÌÙ
)->
	`g‘
()->
	`»suÉ_¬¿y
();

3571 if(
	`em±y
(
$ÌÙd©a
[0]['LROT'])){

3572 
$ff
 = 
	`¡¹ouµ”
(
$ObjA‰r
[
$k
 . "Type"]['fld_name']);

3574 
$ff
 = 
	`¡¹ouµ”
(
$ObjA‰r
[
$ÌÙd©a
[0]['LROT']]['fld_name']);

3577 
$obj_d©a
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$cÚ‹Á
[
$ff
]);

3581 
$RefObjName
 = 
$v
["ref_obj_name"];

3582 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$RefObjName
);

3587 
$A‰rB—n
["select"] = "TBL_NAME,FLD_NAME,OBJ_NAME";

3588 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$obj_d©a
["NAME_ATTR_NAME"];

3589 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

3590 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

3593 
$æd_Çme
 = 
	`¡¹ouµ”
(
$ObjA‰r
[
$v
['referred_by']]['fld_name']);

3595 ià(
	`is£t
(
$cÚ‹Á
)) {

3599 
$wh”e
 = 
	`¬¿y
(

3600 
$obj_d©a
["KEY_ATTR_FLD"] => 
$cÚ‹Á
[
$æd_Çme
],

3601 "Üg_id" => 
$OrgID
,

3603 
$£Ëù
 = 
	`¬¿y
(

3604 
$©Œ_d©a
["FLD_NAME"],

3606 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

3607 
$this
->
db
->
	`wh”e
(
$wh”e
);

3608 
$this
->
db
->
	`äom
(
$©Œ_d©a
["TBL_NAME"]);

3609 
$r_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

3611 
$Ëad_d©a
[
$k
] = 
$r_d©a
[0][
	`¡¹ouµ”
(
$©Œ_d©a
["FLD_NAME"])];

3613 
$Ëad_d©a
[
$k
 . '.ID'] = 
$cÚ‹Á
[
$æd_Çme
];

3614 
$Ëad_d©a
[
$k
 . '.Name'] = 
$r_d©a
[0][
	`¡¹ouµ”
(
$©Œ_d©a
["FLD_NAME"])];

3615 
$ObjA‰r
[
$k
]['cÚ‹Á'] = 
$r_d©a
;

3617 
$Ëad_d©a
[
$k
] = "";

3620 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

3621 ià(!
	`em±y
(
$æd_Çme
)) {

3622 ià(
	`is£t
(
$cÚ‹Á
)) {

3623 ià(
	`is_objeù
(
$cÚ‹Á
[
$æd_Çme
])) {

3624 
$cÚ‹Á
[
$æd_Çme
] = 
	`ba£64_decode
($cÚ‹Á[$æd_Çme]->
	`lßd
());

3626 
$Ëad_d©a
[
$k
] = 
$cÚ‹Á
[
$æd_Çme
];

3628 
$Ëad_d©a
[
$k
] = "";

3631 
$Ëad_d©a
[
$k
] = "";

3636 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

3637 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$k
;

3638 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

3639 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

3640 
$LªgId
 = 2;

3641 
$A‰rName
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]è? 
$k
 : $attr_data["ENUM_ATTR_NAME"];

3642 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

3643 ià(!
	`em±y
(
$cÚ‹Á
[0][
$æd_Çme
])) {

3645 
$’um
 = 
$this
->->
	`S–eùOÃSŒ
(
$OrgID
, 
$LªgId
, 
$A‰rName
, 
$cÚ‹Á
[
$æd_Çme
]);

3647 
$Ëad_d©a
[
$k
] = 
$’um
['ENUM_VALUE'];

3648 
$Ëad_d©a
[
$k
 . '.’um_key'] = 
$cÚ‹Á
[
$æd_Çme
];

3649 
$Ëad_d©a
[
$k
 . '.v®ue'] = 
$’um
['ENUM_VALUE'];

3651 
$Ëad_d©a
[
$k
] = "";

3652 
$Ëad_d©a
[
$k
 . '.enum_key'] = "";

3653 
$Ëad_d©a
[
$k
 . '.value'] = "";

3658 
$A‰rB—n
["select"] = "ENUM_ATTR_NAME";

3659 
$A‰rB—n
["wh”e"]["©Œ_Çme"] = 
$k
;

3660 
$A‰rB—n
["wh”e"]["Üg_id"] = 
$OrgID
;

3661 
$©Œ_d©a
 = 
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

3662 
$LªgId
 = 2;

3663 
$A‰rName
 = 
	`em±y
(
$©Œ_d©a
["ENUM_ATTR_NAME"]è? 
$k
 : $attr_data["ENUM_ATTR_NAME"];

3664 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

3665 ià(!
	`em±y
(
$cÚ‹Á
[
$æd_Çme
])) {

3667 
$’um
 = 
$this
->->
	`S–eùOÃSŒ
(
$OrgID
, 
$LªgId
, 
$A‰rName
, 
$cÚ‹Á
[
$æd_Çme
]);

3669 
$Ëad_d©a
[
$k
] = 
$’um
['ENUM_VALUE'];

3670 
$Ëad_d©a
[
$k
 . '.’um_key'] = 
$cÚ‹Á
[
$æd_Çme
];

3672 
$Ëad_d©a
[
$k
 . '.v®ue'] = 
$’um
['ENUM_VALUE'];

3674 
$Ëad_d©a
[
$k
] = "";

3675 
$Ëad_d©a
[
$k
 . '.enum_key'] = "";

3677 
$Ëad_d©a
[
$k
 . '.value'] = "";

3683 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

3684 ià(
	`is£t
(
$cÚ‹Á
)) {

3685 
$cÚ‹Á
[
$æd_Çme
] = 
$this
->
	`ToCh¬
($æd_Çme, 
$v
['tbl_Çme'], 
$OrgID
, 
$ObjID
, 
$ObjName
);

3686 ià(
	`em±y
(
$cÚ‹Á
[
$æd_Çme
])) {

3687 
$Ëad_d©a
[
$k
] = "";

3689 
$Ëad_d©a
[
$k
] = 
$this
->
	`isD©e
(
$cÚ‹Á
[
$æd_Çme
], 8 * 60 * 60);

3692 
$Ëad_d©a
[
$k
] = "";

3696 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

3697 ià(
	`is£t
(
$cÚ‹Á
)) {

3698 
$cÚ‹Á
[
$æd_Çme
] = 
$this
->
	`ToCh¬
($æd_Çme, 
$v
['tbl_Çme'], 
$OrgID
, 
$ObjID
, 
$ObjName
);

3699 ià(
	`em±y
(
$cÚ‹Á
[
$æd_Çme
])) {

3700 
$Ëad_d©a
[
$k
] = "";

3702 
$Ëad_d©a
[
$k
] = 
$this
->
	`isD©eTime
(
$cÚ‹Á
[
$æd_Çme
], 8 * 60 * 60);

3705 
$Ëad_d©a
[
$k
] = "";

3709 
$æd_Çme
 = 
	`¡¹ouµ”
(
$v
['fld_name']);

3710 ià(!
	`em±y
(
$æd_Çme
)) {

3711 ià(
	`is£t
(
$cÚ‹Á
)) {

3712 ià(
	`is_objeù
(
$cÚ‹Á
[
$æd_Çme
])) {

3714 
$cÚ‹Á
[
$æd_Çme
] = 
	`ba£64_decode
($cÚ‹Á[$æd_Çme]->
	`lßd
());

3716 
$Ëad_d©a
[
$k
] = 
$cÚ‹Á
[
$æd_Çme
];

3718 
$Ëad_d©a
[
$k
] = "";

3721 
$Ëad_d©a
[
$k
] = "";

3726  
$Ëad_d©a
;

3727 
	}
}

3736 
public
 
funùiÚ
 
	$G‘ImpÜtCSV
(
$obj_ty³
, 
$fe
, 
$d©a
) {

3737 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('$org_id');

3738 
$symbŞ
 = 
$d©a
['symbol'];

3739 
$w™h_t™Ë
 = 
$d©a
['with_title'];

3740 
$’code
 = 
$_FILES
["myfile"]["encode"];

3741 
$fe_d©a
 = 
	`fg‘csv
(
$fe
, 1024 * 10, 
$symbŞ
);

3742 ià(
$’code
 != 'UTF-8') {

3743 
	`mb_cÚv”t_’codšg
(
$fe_d©a
, "UTF-8", 
$’code
);

3745 
$obj_d©a
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj_ty³
);

3746 
$objeù_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$obj_d©a
['OBJ_NAME']);

3748 
	`fÜ—ch
 (
$fe_d©a
[0] 
as
 
$k
 => 
$v
) {

3749 
$up_d©a
[
$k
] = $k . ':' . 
$v
;

3752 
	`fÜ—ch
 (
$objeù_©Œ
 
as
 
$k
 => 
$v
) {

3753 ià(
$v
['is_disp_list']) {

3754 
$v
['attr_type']) {

3760 
$sü_d©a
[
$k
]['is_key'] = 1;

3764 
$sü_d©a
[
$k
]['is_key'] = 0;

3767 ià(
$v
['is_ref_obj']) {

3768 
$obj_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$v
['ref_obj_name']);

3769 
	`fÜ—ch
 (
$obj_©Œ
 
as
 
$kk
 => 
$vv
) {

3770 ià(
$vv
['is_disp_list']) {

3771 
$sü_d©a
[
$k
]['Ïb–'] = 
$v
['label'];

3772 
$sü_d©a
[
$k
][
$kk
] = 
$v
['Ïb–'] . 
$vv
['label'];

3776 
$sü_d©a
[
$k
]['Ïb–'] = 
$v
['label'];

3780 
$d©a_¬r
['up_d©a'] = 
$up_d©a
;

3781 
$d©a_¬r
['sü_d©a'] = 
$sü_d©a
;

3782 
$d©a_¬r
['w™h_t™Ë'] = 
$w™h_t™Ë
;

3783 
$d©a_¬r
['ü—‹_’um'] = 
$ü—‹_’um
;

3784  
$d©a_¬r
;

3785 
	}
}

3794 
public
 
funùiÚ
 
	$ExpÜtCSV
(
$d©a
) {

3795 
	`exŒaù
(
$d©a
, 
EXTR_OVERWRITE
);

3797 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

3798 
$t™Ë
 = "";

3799 
$»cÜd
 = "";

3801 
$t™Ë
 = 
	`im¶ode
(",", 
$CŞNames
);

3803 
	`fÜ—ch
 (
$Ãed_d©a
 
as
 
$k
 => 
$v
) {

3805 
$lše
 = 
	`im¶ode
(",", 
$v
);

3807 
$»cÜd
 = $»cÜd . "\n" . 
$lše
;

3810 
$r_d©a
['fe_d©a'] = 
$t™Ë
 . 
$»cÜd
;

3812 
$r_d©a
['fe_Çme'] = 'exp' . 
	`chr
(
	`¿nd
(65, 90)) .„and(100, 999) . '.csv';

3814  
$r_d©a
;

3815 
	}
}

3823 
public
 
funùiÚ
 
	$moduË_impÜt
(
$d©a
) {

3824 
	`exŒaù
(
$d©a
, 
EXTR_OVERWRITE
);

3825 
$is_d—l
 = 
$po¡
['is_deal'];

3826 
$w™h_t™Ë
 = 
$po¡
['with_title'];

3827 
$ü—‹_’um
 = 
$po¡
['create_enum'];

3828 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

3829 
	`un£t
(
$po¡
['is_deal']);

3830 
	`un£t
(
$po¡
['with_title']);

3831 
	`un£t
(
$po¡
['create_enum']);

3833 
$obj_d©a
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj_ty³
);

3834 
$objeù_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$obj_d©a
['OBJ_NAME']);

3836 
$li¡
 = 
$po¡
;

3837 
$fe_d©a
 = 
$po¡
['fld_data'];

3838 
$li¡
 = 
	`¬¿y
(

3839 '©Œ_Çme' => 
	`¬¿y
(

3844 
	`fÜ—ch
 (
$li¡
 
as
 
$k
 => 
$v
) {

3845 ià(
$is_d—l
) {

3846 ià(
$v
['is_checked_key']) {

3848 
$š£¹
[1][
$k
] = 
$fe_d©a
[1];

3852 
	}
}

3859 
public
 
funùiÚ
 
	$ŒªsfÜm
(
$d©a
, 
$obj_Çme
, 
$OrgID
 = 1) {

3861 
$»f_©Œ
 = 
$this
->
	`G‘RefA‰r
(
$obj_Çme
, 
$OrgID
);

3863 
	`fÜ—ch
 (
$»f_©Œ
 
as
 
$k
 => 
$v
) {

3864 ià(
	`is£t
(
$d©a
[
$v
['ATTR_NAME'] . "ID"])) {

3866 
$d©a
[
$v
['REFERRED_BY']] = $data[$v['ATTR_NAME'] . "ID"];

3867 
	`un£t
(
$d©a
[
$v
['ATTR_NAME'] . ".ID"]);

3868 
	`un£t
(
$d©a
[
$v
['ATTR_NAME']]);

3869 
	`un£t
(
$d©a
[
$v
['ATTR_NAME'].".Name"]);

3870 } 
	`–£if
 (
	`is£t
(
$d©a
[
$v
['ATTR_NAME'] . ".ID"])) {

3871 
$d©a
[
$v
['REFERRED_BY']] = $data[$v['ATTR_NAME'] . ".ID"];

3872 
	`un£t
(
$d©a
[
$v
['ATTR_NAME'] . ".ID"]);

3873 
	`un£t
(
$d©a
[
$v
['ATTR_NAME']]);

3874 
	`un£t
(
$d©a
[
$v
['ATTR_NAME'].".Name"]);

3876 
$»f_obj_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$v
['REF_OBJ_NAME']);

3878 
	`fÜ—ch
 (
$»f_obj_©Œ
 
as
 
$kk
 => 
$vv
) {

3880 
$¬r
 = 
	`ex¶ode
(".", 
$kk
, 2);

3881 ià(
	`is£t
(
$d©a
[
$v
['REFERRED_BY']])) {

3882 
	`un£t
(
$d©a
[
$v
['ATTR_NAME'] . '.' . 
$¬r
[1]]);

3885 ià(
	`is£t
(
$d©a
[
$v
['ATTR_NAME'] . '.' . 
$¬r
[1]])) {

3887 
$»f_id
 = 
$this
->
	`Name2ID
(
$v
['REF_OBJ_NAME'], 
$vv
, 
$d©a
[$v['ATTR_NAME'] . '.' . 
$¬r
[1]], 
$OrgID
);

3889 ià(
	`couÁ
(
$»f_id
è> 1 
Ü
 count($ref_id) == 0) {

3890  
çl£
;

3891 } 
	`–£if
 (
	`couÁ
(
$»f_id
) == 1) {

3892 
$d©a
[
$v
['REFERRED_BY']] = 
$»f_id
[0]['ID'];

3894 
	`un£t
(
$d©a
[
$v
['ATTR_NAME'] . '.' . 
$¬r
[1]]);

3900 if(
$obj_Çme
 == 'Task'){

3901 
$u£r_id
 = 
$d©a
[
$obj_Çme
 . '.AssignedToID'];

3903 
$u£r_id
 = 
$d©a
[
$obj_Çme
 . '.OwnerID'];

3905 if(!
	`em±y
(
$u£r_id
)){

3907 
$u_wh”e
 = 
	`¬¿y
(

3908 'Üg_id' => 
$OrgID
,

3909 'u£r_id' => 
$u£r_id


3911 
$d•t_id
 = 
$this
->
db
->
	`£Ëù
('d•t_id')->
	`äom
('tc_u£r')->
	`wh”e
(
$u_wh”e
)->
	`g‘
()->
	`»suÉ_¬¿y
();

3912 if(
	`couÁ
(
$d•t_id
)>1 || count($dept_id)==0){

3913  
çl£
;

3915 if(
$obj_Çme
=='Contact'){

3916 
$d©a
[
$obj_Çme
 . '.OwÃrD•tID'] = 
$d•t_id
[0]['DEPT_ID'];

3918 }
	`–£if
(
$obj_Çme
 == 'Task'){

3921 
$d©a
[
$obj_Çme
 . '.D•¬tm’tID'] = 
$d•t_id
[0]['DEPT_ID'];

3925 
	`un£t
(
$d©a
[
$obj_Çme
 . '.OwnerDeptID']);

3926 
	`un£t
(
$d©a
[
$obj_Çme
 . '.DepartmentID']);

3928 
$’um_©Œ
 = 
$this
->
	`G‘EnumA‰r
(
$obj_Çme
, 
$OrgID
);

3931 
	`fÜ—ch
 (
$’um_©Œ
 
as
 
$k
 => 
$v
) {

3932 ià(
	`is£t
(
$d©a
[
$v
['ATTR_NAME']])) {

3934 ià(
	`is£t
(
$d©a
[
$v
['ATTR_NAME'] . ".enum_key"])) {

3936 
$d©a
[
$v
['ATTR_NAME']] = $data[$v['ATTR_NAME'] . ".enum_key"];

3937 
	`un£t
(
$d©a
[
$v
['ATTR_NAME'] . ".enum_key"]);

3938 
	`un£t
(
$d©a
[
$v
['ATTR_NAME'] . ".value"]);

3939 } 
	`–£if
 (
	`is£t
(
$d©a
[
$v
['ATTR_NAME'] . ".value"])) {

3940 
$’um_key
 = 
$this
->
	`Name2Key
(
$v
['ATTR_NAME'], 
$d©a
[$v['ATTR_NAME'] . ".v®ue"], 
$OrgID
);

3941 ià(
	`couÁ
(
$’um_key
) > 1) {

3942  
çl£
;

3943 } 
	`–£if
 (
	`couÁ
(
$’um_key
) == 1) {

3944 
$d©a
[
$v
['ATTR_NAME']] = 
$’um_key
[0]['ENUM_KEY'];

3945 } 
	`–£if
 (
	`couÁ
(
$’um_key
) == 0) {

3947 
$d©a
[
$v
['ATTR_NAME']] = "";

3949 
	`un£t
(
$d©a
[
$v
['ATTR_NAME'] . ".value"]);

3954  
$d©a
;

3955 
	}
}

3958 
public
 
funùiÚ
 
	$G‘RefA‰r
(
$obj_Çme
, 
$Üg_id
 = 1) {

3959 
$wh”e
 = 
	`¬¿y
(

3960 'obj_Çme' => 
$obj_Çme
,

3961 'Üg_id' => 
$Üg_id
,

3964 
$this
->
db
->
	`wh”e
(
$wh”e
);

3965 
$this
->
db
->
	`£Ëù
('attr_name,referred_by,ref_obj_name');

3966 
$this
->
db
->
	`äom
('dd_attribute');

3967 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

3968  
$d©a
;

3969 
	}
}

3972 
´iv©e
 
funùiÚ
 
	$G‘EnumA‰r
(
$obj_Çme
, 
$Üg_id
 = 1) {

3973 
$this
->
db
->
	`wh”e
('Üg_id', 
$Üg_id
);

3974 
$this
->
db
->
	`wh”e
('obj_Çme', 
$obj_Çme
);

3975 
$key_¬¿y
 = 
	`¬¿y
('12', '13');

3976 
$this
->
db
->
	`wh”e_š
('©Œ_ty³', 
$key_¬¿y
);

3977 
$this
->
db
->
	`£Ëù
('attr_name,tbl_name,fld_name');

3978 
$this
->
db
->
	`äom
('dd_attribute');

3979 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

3980  
$d©a
;

3981 
	}
}

3984 
public
 
funùiÚ
 
	$Name2ID
(
$obj_Çme
, 
$©Œ
, 
$v®ue
, 
$Üg_id
 = 1) {

3986 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 
$obj_Çme
);

3988 
$wh”e
 = 
	`¬¿y
(

3989 'Üg_id' => 
$Üg_id
,

3990 
$©Œ
['æd_Çme'] => 
$v®ue
,

3992 
$this
->
db
->
	`wh”e
(
$wh”e
);

3993 
$this
->
db
->
	`£Ëù
(
$obj_d©a
['KEY_ATTR_FLD'] . "‡s ID");

3994 
$this
->
db
->
	`äom
(
$©Œ
['tbl_name']);

3995 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

3996  
$d©a
;

3997 
	}
}

4000 
public
 
funùiÚ
 
	$Name2Key
(
$©Œ_Çme
, 
$’um_v®ue
, 
$Üg_id
 = 1) {

4002 
$Ïng_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('lang_id');

4003 
$wh”e
 = 
	`¬¿y
(

4004 'Üg_id' => 
$Üg_id
,

4005 'Ïng_id' => 
$Ïng_id
,

4006 '©Œ_Çme' => 
$©Œ_Çme
,

4007 '’um_v®ue' => 
$’um_v®ue
,

4009 
$this
->
db
->
	`£Ëù
('enum_key');

4010 
$this
->
db
->
	`wh”e
(
$wh”e
);

4011 
$this
->
db
->
	`äom
('tc_enum_str');

4012 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

4014  
$d©a
;

4015 
	}
}

4023 
public
 
funùiÚ
 
	$G‘Li¡CŞNames2
(
$Li¡FÜm©
, 
$L—dA‰r
, 
$obj_d©a
) {

4024 
$»s_d©a
 = 
	`¬¿y
();

4025 
$i
 = 0;

4026 
	`fÜ—ch
 (
$Li¡FÜm©
 
as
 
$k
 => 
$v
) {

4028 
$»s_d©a
[
$i
]['©Œ_Çme'] = 
$v
;

4029 
$»s_d©a
[
$i
]['Ïb–'] = 
$L—dA‰r
[
$v
]["label"];

4030 
$i
++;

4032  
$»s_d©a
;

4033 
	}
}

4041 
public
 
funùiÚ
 
	$G‘LeáLi¡
(
$objeù_©Œ
, 
$Ïb–s
) {

4044 
	`fÜ—ch
 (
$Ïb–s
 
as
 
$k
 => 
$v
) {

4045 
$r_Ïb–s
[
$v
['attr_name']] = $v['label'];

4048 
	`fÜ—ch
 (
$objeù_©Œ
 
as
 
$k
 => 
$v
) {

4051 ià(!
	`is£t
(
$r_Ïb–s
[
$k
]è&& !
$v
['is_hidden'] && $v['is_disp_list']) {

4052 
$Ëá_li¡
[
$v
['di¥_Üd”']]['©Œ_Çme'] = 
$k
;

4053 
$Ëá_li¡
[
$v
['disp_order']]['label'] = $v['label'];

4057 
	`ksÜt
(
$Ëá_li¡
);

4058  
$Ëá_li¡
;

4059 
	}
}

4061 
´iv©e
 
funùiÚ
 
	$G‘Fld2
(
$N“dA‰r
, 
$L—dA‰r
) {

4062 
$»s_d©a
 = 
	`¬¿y
();

4063 
$æd_que
 = "";

4064 
	`fÜ—ch
 (
$N“dA‰r
 
as
 
$k
 => 
$v
) {

4065 ià(!
	`em±y
(
$L—dA‰r
[
$v
]["attr_type"])) {

4066 
$L—dA‰r
[
$v
]["attr_type"]) {

4068 ià(!
	`em±y
(
$L—dA‰r
[
$v
]["referred_by"])) {

4069 
$»s_d©a
[
$k
] = 
$L—dA‰r
[$L—dA‰r[
$v
]["referred_by"]]["tbl_name"] . "." . $LeadAttr[$LeadAttr[$v]["referred_by"]]["fld_name"]. " " . $LeadAttr[$LeadAttr[$v]["referred_by"]]["fld_name"];

4071 
$»s_d©a
[
$k
] = 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"] . " " . $LeadAttr[$v]["fld_name"];

4075 
$»s_d©a
[
$k
] = "to_ch¬(" . 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"] . ", 'yyyy-mm-dd hh24:ii:ss')‡s " . $LeadAttr[$v]["fld_name"];

4078 
$»s_d©a
[
$k
] = "to_ch¬(" . 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"] . ", 'yyyy-mm-dd hh24:ii:ss')‡s " . $LeadAttr[$v]["fld_name"];

4081 ià(!
	`em±y
(
$L—dA‰r
[
$v
]["fld_name"])) {

4082 
$»s_d©a
[
$k
] = 
$L—dA‰r
[
$v
]["tbl_name"] . "." . $LeadAttr[$v]["fld_name"]. " " . $LeadAttr[$v]["fld_name"];

4089  
	`¬¿y_unique
(
$»s_d©a
);

4090 
	}
}

4101 
public
 
funùiÚ
 
G‘InfoLi¡2
(
$Li¡FÜm©
, 
$L—dA‰r
, 
$obj_d©a
, 
$OrgID
, 
$wh”e
 = 
	$¬¿y
()) {

4104 
	`fÜ—ch
 (
$Li¡FÜm©
 
as
 
$k
 => 
$v
) {

4105 
$¬r
 = 
	`ex¶ode
('.', 
$v
);

4107 
$li¡_fÜm©
[] = 
$¬r
[0] . '.' . $arr[1];

4108 ià(
	`is£t
(
$¬r
[2])) {

4109 
$»f_li¡
[
$¬r
[0] . '.' . $arr[1]][] = $arr[2];

4113 
$fœ¡_tbl
 = 
$obj_d©a
["MAIN_TABLE"];

4114 
$tbl_d©a
 = 
$this
->
	`G‘Tbl
(
$li¡_fÜm©
, 
$L—dA‰r
);

4115 
$æd_d©a
 = 
$this
->
	`G‘Fld2
(
$li¡_fÜm©
, 
$L—dA‰r
);

4116 
$d©a
["CŞNames"] = 
	`jsÚ_decode
(
$this
->
objeùs
->
	`G‘Li¡CŞNames
(
$li¡_fÜm©
, 
$L—dA‰r
, 
$obj_d©a
));

4119 
	`fÜ—ch
 (
$Li¡FÜm©
 
as
 
$k
 => 
$v
) {

4120 
$¬
 = 
	`ex¶ode
('.', 
$v
);

4122 ià(
$L—dA‰r
[
$¬
[0] . '.' . $ar[1]]['is_ref_obj']) {

4123 ià(
	`is£t
(
$¬
[2])) {

4124 
$this_obj
 = 
$L—dA‰r
[
$¬
[0] . '.' . $ar[1]]['ref_obj_name'];

4125 
$¼r
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$this_obj
);

4126 
$d©a
["CŞNames"][
$k
] = $d©a["CŞNames"][$k] . ':' . 
$¼r
[
$this_obj
 . '.' . 
$¬
[2]]['label'];

4131 
	`¬¿y_push
(
$æd_d©a
, 
$fœ¡_tbl
 . "." . 
	`ucfœ¡
(
$obj_d©a
["KEY_ATTR_FLD"]));

4132 
$couÁ_tbl
 = 
	`couÁ
(
$tbl_d©a
);

4134 ià(!
	`em±y
(
$wh”e
)) {

4135 
$this
->
db
->
	`wh”e_š
(
$fœ¡_tbl
 . "." . 
$obj_d©a
['KEY_ATTR_FLD'], 
$wh”e
);

4138 
$this
->
db
->
	`£Ëù
(
$æd_d©a
);

4140 ià(
$couÁ_tbl
 == 1) {

4141 
$this
->
db
->
	`äom
(
	`cu¼’t
(
$tbl_d©a
));

4143 
$this
->
db
->
	`äom
(
$fœ¡_tbl
);

4144 
	`fÜ—ch
 (
$tbl_d©a
 
as
 
$k
 => 
$v
) {

4145 
$još_Ú
 = "$fœ¡_tbl." . 
$obj_d©a
["KEY_ATTR_FLD"] . " = $v." . $obj_data["KEY_ATTR_FLD"] . "‡nd $v.ORG_ID = $OrgID";

4146 ià(
$v
 =ğ
$fœ¡_tbl
) {

4149 
$this
->
db
->
	`još
(
$v
, 
$još_Ú
, "inner");

4155 
$F‹rPriKey
 = 
$fœ¡_tbl
 . "." . 
$obj_d©a
["KEY_ATTR_FLD"] . ">=";

4157 ià(
$obj_d©a
['IS_RECYCLABLE']) {

4158 
$IsDEË‹Key
 = 
$fœ¡_tbl
 . "." . "is_deleted";

4159 
$F‹rWh”e
[
$IsDEË‹Key
] = 0;

4161 
$F‹rWh”e
[
$F‹rPriKey
] = 1;

4162 
$OrgIDKey
 = 
$fœ¡_tbl
 . "." . "org_id";

4163 
$F‹rWh”e
[
$OrgIDKey
] = 1;

4164 
$this
->
db
->
	`wh”e
(
$F‹rWh”e
);

4165 
$this
->
db
->
	`Üd”_by
(
$fœ¡_tbl
 . "." . 
$obj_d©a
["KEY_ATTR_FLD"], "desc");

4171 
$d©a
['li¡_d©a'] = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

4174 
	`¬¿y_push
(
$li¡_fÜm©
, 
$obj_d©a
["KEY_ATTR_NAME"]);

4176 ià(!
	`em±y
(
$d©a
)) {

4177 
	`fÜ—ch
 (
$d©a
['li¡_d©a'] 
as
 
$k
 => 
$v
) {

4178 
	`fÜ—ch
 (
$li¡_fÜm©
 
as
 
$kk
 => 
$vv
) {

4179 ià(
$L—dA‰r
[
$vv
]['is_ref_obj']) {

4180 
$ff
 = 
$L—dA‰r
[
$vv
]['referred_by'];

4181 
$li¡
[
$k
][
$vv
] = 
$v
[
	`¡¹ouµ”
(
$L—dA‰r
[
$ff
]['fld_name'])];

4183 
$li¡
[
$k
][
$vv
] = 
$v
[
	`¡¹ouµ”
(
$L—dA‰r
[$vv]['fld_name'])];

4192 
$d©a
['li¡_d©a'] = 
$this
->
	`G‘D©aTy³
(
$li¡
, 
$L—dA‰r
, 
$OrgID
);

4194 
	`fÜ—ch
 (
$d©a
['li¡_d©a'] 
as
 
$k
 => 
$v
) {

4195 
	`fÜ—ch
 (
$li¡_fÜm©
 
as
 
$kk
 => 
$vv
) {

4196 
$d©a
['Ãed_d©a1'][
$k
][
$vv
] = 
$v
[$vv];

4201 
	`fÜ—ch
 (
$d©a
['Ãed_d©a1'] 
as
 
$k
 => 
$v
) {

4202 
	`fÜ—ch
 (
$Li¡FÜm©
 
as
 
$kk
 => 
$vv
) {

4203 
$‰
 = 
	`ex¶ode
('.', 
$vv
);

4204 
$d©a
['Ãed_d©a'][
$k
][
$vv
] = 
$v
[
$‰
[0] . '.' . $tt[1]];

4206 ià(
	`is£t
(
$‰
[2])) {

4207 
	`fÜ—ch
 (
$»f_li¡
[
$‰
[0] . '.' . $‰[1]] 
as
 
$kkk
 => 
$vvv
) {

4209 
$d©a
['Ãed_d©a'][
$k
][
$vv
] = 
$li¡
[$k][
$‰
[0] . '.' . $tt[1]];

4216 
	`fÜ—ch
 (
$d©a
['Ãed_d©a'] 
as
 
$k
 => 
$v
) {

4217 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

4218 
$¯
 = 
	`ex¶ode
('.', 
$kk
);

4219 if(
	`is£t
(
$¯
[2])){

4221 
$obj
=
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$L—dA‰r
[
$¯
[0].'.'.$aa[1]]['ref_obj_name']);

4223 
$A‰rB—n
['wh”e']=
	`¬¿y
(

4224 'Üg_id'=>
$OrgID
,

4225 'ATTR_NAME'=>
$obj
['OBJ_NAME'].'.'.
$¯
[2]);

4226 
$A‰rB—n
['select']='FLD_NAME,TBL_NAME,IS_REF_OBJ,REF_OBJ_NAME,REFERRED_BY';

4227 
$ddd
=
$this
->
©Œ
->
	`S–eùOÃ
(
$A‰rB—n
);

4228 if(
$ddd
['IS_REF_OBJ']){

4229 
$B—n
['wh”e']=
	`¬¿y
(

4230 'Üg_id'=>
$OrgID
,

4231 'ATTR_NAME'=>
$ddd
['REFERRED_BY']);

4232 
$B—n
['select']='FLD_NAME,TBL_NAME';

4233 
$»f
=
$this
->
©Œ
->
	`S–eùOÃ
(
$B—n
);

4234 
$wh”e1
=
	`¬¿y
(

4235 
$obj
['KEY_ATTR_FLD'] => 
$vv
,

4236 "Üg_id" => 
$OrgID
,

4239 
$»r
 = 
$this
->
db
->
	`£Ëù
(
$»f
['FLD_NAME'].'‡ v®')->
	`äom
($»f['TBL_NAME'])->
	`wh”e
(
$wh”e1
)->
	`g‘
()->
	`»suÉ_¬¿y
();

4240 
$»fobj
=
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$ddd
['REF_OBJ_NAME']);

4242 
$B—n1
['wh”e']=
	`¬¿y
(

4243 'Üg_id'=>
$OrgID
,

4244 'ATTR_NAME'=>
$»fobj
['NAME_ATTR_NAME']);

4245 
$B—n1
['select']='FLD_NAME,TBL_NAME';

4246 
$»f1
=
$this
->
©Œ
->
	`S–eùOÃ
(
$B—n1
);

4248 
$wh”e2
=
	`¬¿y
(

4249 
$»fobj
['KEY_ATTR_FLD'] => 
$»r
[0]['VAL'],

4250 "Üg_id" => 
$OrgID
,

4253 
$»r2
 = 
$this
->
db
->
	`£Ëù
(
$»f1
['FLD_NAME'].'‡ v®')->
	`äom
($»f1['TBL_NAME'])->
	`wh”e
(
$wh”e2
)->
	`g‘
()->
	`»suÉ_¬¿y
();

4255 
$d©a
['Ãed_d©a'][
$k
][
$kk
]=
$»r2
[0]['VAL'];

4257 
$wh”e3
=
	`¬¿y
(

4258 
$obj
['KEY_ATTR_FLD'] => 
$vv
,

4259 "Üg_id" => 
$OrgID
,

4262 
$»r3
 = 
$this
->
db
->
	`£Ëù
(
$ddd
['FLD_NAME'].'‡ v®')->
	`äom
($ddd['TBL_NAME'])->
	`wh”e
(
$wh”e3
)->
	`g‘
()->
	`»suÉ_¬¿y
();

4263 
$d©a
['Ãed_d©a'][
$k
][
$kk
]=
$»r3
[0]['VAL'];

4273  
$d©a
;

4274 
	}
}

4281 
public
 
funùiÚ
 
	$FšdRefAÎ
(
$objeù_©Œ
) {

4282 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

4283 
	`fÜ—ch
 (
$objeù_©Œ
 
as
 
$k
 => 
$v
) {

4284 ià(
$v
['is_disp_list'] && !$v['is_hidden']) {

4285 ià(
$v
['is_ref_obj']) {

4286 
$obj_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$v
['ref_obj_name']);

4287 
	`fÜ—ch
 (
$obj_©Œ
 
as
 
$kk
 => 
$vv
) {

4289 ià(
$vv
['is_disp_list'] && !$vv['is_hidden'] && $vv['is_ref_obj']) {

4291 
$¬r
 = 
	`ex¶ode
(".", 
$kk
);

4292 
$sü_d©a
[
$kk
]['©Œ_Çme'] = 
$k
 . '.' . 
$¬r
[1];

4293 
$sü_d©a
[
$kk
]['Ïb–'] = 
$v
['Ïb–'] . ':' . 
$vv
['label'];

4300  
$sü_d©a
;

4301 
	}
}

4308 
public
 
funùiÚ
 
	$g‘ObjD©a
(
$obj
) {

4309 
$£Ëù
 = 
	`¬¿y
(

4320 
$cÚd™iÚ
 = 
	`¬¿y
(

4325 '©Œ.obj_Çme' => 
$obj
,

4328 
$©Œ_ty³
 = 
	`¬¿y
('18', '19', '20');

4329 
$this
->
db
->
	`wh”e_nÙ_š
('©Œ_ty³', 
$©Œ_ty³
);

4330 
$this
->
db
->
	`äom
('DD_ATTRIBUTE‡‰r')->
	`još
('dd_dict_str str', 'attr.attr_name = str.dict_name', 'left');

4331 
$qu”y
 = 
$this
->
db
->
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
()->
	`»suÉ_¬¿y
();

4332 
	`fÜ—ch
 (
$qu”y
 
as
 
$key
 => 
$v®ue
) {

4333 ià(
$v®ue
['IS_REF_OBJ'] == 0) {

4334 ià(
$v®ue
["ATTR_TYPE"] == 12 || $value["ATTR_TYPE"] == 13) {

4335 
$v®ue
['ATTR_NAME'] = $value['ATTR_NAME'] . ".value";

4336 
$d©a
['sy¡em'][] = 
$v®ue
;

4338 
$d©a
['sy¡em'][] = 
$v®ue
;

4341 
$Ãw_v®ue
 = 
$this
->
	`g‘ObjD©aNoRef
(
$v®ue
['ATTR_NAME'], $value['REF_OBJ_NAME']);

4342 
$Ãw_v®ue
["IS_MUST"] = 
$v®ue
["IS_MUST"];

4343 
$d©a
['»f'][
$v®ue
['LABEL']] = 
$Ãw_v®ue
;

4347 ià(
	`couÁ
(
$d©a
)) {

4348  
$d©a
;

4350  
	`¬¿y
();

4352 
	}
}

4359 
public
 
funùiÚ
 
	$g‘ObjD©aNoRef
(
$©Œ_Çme
, 
$obj
) {

4360 
$£Ëù
 = 
	`¬¿y
(

4369 
$cÚd™iÚ
 = 
	`¬¿y
(

4373 '©Œ.obj_Çme' => 
$obj
,

4376 
$©Œ_ty³
 = 
	`¬¿y
('18', '19', '20');

4377 
$this
->
db
->
	`wh”e_nÙ_š
('©Œ_ty³', 
$©Œ_ty³
);

4378 
$this
->
db
->
	`äom
('DD_ATTRIBUTE‡‰r')->
	`još
('dd_dict_str str', 'attr.attr_name = str.dict_name', 'left');

4379 
$qu”y
 = 
$this
->
db
->
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
()->
	`»suÉ_¬¿y
();

4380 ià(
	`couÁ
(
$qu”y
)) {

4381 
	`fÜ—ch
 (
$qu”y
 
as
 
$k
 => 
$v®
) {

4382 
$qu”y
[
$k
] = 
	`¡r_»¶aû
(
$obj
, 
$©Œ_Çme
, 
$v®
);

4384  
$qu”y
;

4386  
	`¬¿y
();

4388 
	}
}

4395 
public
 
funùiÚ
 
	$d–‘eR•—t
(
$¬r
, 
$checkbox
) {

4396 ià(!Ğ
	`is_¬¿y
(
$¬r
è&& 
	`couÁ
($arr) != 0 )) {

4397  
çl£
;

4399 
	`fÜ—ch
 (
$¬r
 
as
 
$key
 => 
$v®ue
) {

4400 
	`fÜ—ch
 (
$v®ue
 
as
 
$k
 => 
$v
) {

4402 ià(
	`š_¬¿y
(
$k
, 
$checkbox
)) {

4403 
$i
 = 0;

4404 
	`fÜ—ch
 (
$¬r
 
as
 
$kk
 => 
$vv
) {

4405 ià(
	`is£t
(
$vv
[
$k
])) {

4406 ià(
$vv
[
$k
] =ğ
$v
) {

4407 ià(
$i
 == 0) {

4408 
$i
++;

4410 
	`un£t
(
$¬r
[
$kk
]);

4418  
$¬r
;

4419 
	}
}

4425 
public
 
funùiÚ
 
	$b©ch_up_©Œ
(
$obj_Çme
) {

4426 
$£Ëù
 = 
	`¬¿y
(

4430 
$cÚd™iÚ
 = 
	`¬¿y
(

4434 'a.obj_Çme' => 
$obj_Çme
,

4437 
$qu”y
 = 
$this
->
db
->
	`äom
("dd_attribute‡")->

4438 
	`još
('dd_dict_str b', 'a.attr_name = b.dict_name', 'left')->

4439 
	`wh”e
(
$cÚd™iÚ
)->

4440 
	`£Ëù
(
$£Ëù
)->
	`g‘
()->
	`»suÉ_¬¿y
();

4441 ià(
	`couÁ
(
$qu”y
)) {

4442  
$qu”y
;

4444  
	`¬¿y
();

4446 
	}
}

4451 
public
 
funùiÚ
 
	$pub_bu‰Ú
(
$OrgID
, 
$d©a
) {

4452 
$¿ndom
 = 
	`¿nd
(1,10000);

4453 
$ty³_¬r
 = 
$this
->
ty³
->
	`ObjG‘Ty³
(
$OrgID
, 
$d©a
["ObjType"]);

4455 
$but_¬¿y
['1'] = 
	`¬¿y
(

4461 ià(
$ty³_¬r
) {

4462 
	`fÜ—ch
 (
$ty³_¬r
 
as
 
$k
 => 
$v
) {

4463 
$but_¬¿y
['1']['drİdown'][] = 
	`¬¿y
(

4464 "Çme" => 
$v
["Name"],

4465 "u¾" => 
	`ba£_u¾
(è. "šdex.php/www/objeùs/add?obj_ty³=" . 
$d©a
["ObjTy³"] . "&ty³_id=" . 
$v
["ID"],

4469 
$but_¬¿y
['1']['u¾'] = 
	`ba£_u¾
(è. "šdex.php/www/objeùs/add?obj_ty³=" . 
$d©a
["ObjType"];

4473 
$but_¬¿y
['2'] = 
	`¬¿y
(

4477 "id" => "Ëad_§Ë_£niÜqu”y".
$¿ndom
,

4479 
v¬
 
£niÜqu”y_©Œ
 = ' . $d©a['
S’iÜQu”yA‰rJsÚ
'] . ';

4480 
	`$
("#Ëad_§Ë_£niÜqu”y'.$¿ndom.'").
	`S’iÜQu”y
({

4481 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

4482 
Li¡U¾
: "' . ba£_u¾(è. 'šdex.php/www/objeùs/li¡_jsÚ?obj_ty³=' . $d©a["
ObjTy³
"] . '",

4483 
Li¡Div
: "#'.$d©a["
div_Çme
"].'" }); 
	}
});'

4486 
	g$but_¬¿y
['3'] = 
¬¿y
(

4493 
$
("#impÜt").
AjaxDŸlog
({

4494 
DŸlogU¾
: "' . ba£_u¾(è. 'šdex.php/www/objeùs/impÜt?obj_ty³=' . $d©a["
ObjTy³
"] . '",

4495 
DŸlogT™Ë
: "æ‰¹é‡å¯¼å…¥",

4496 
DŸlogWidth
: 700,

4497 
DŸlogHeight
: 400

4500 
	g$but_¬¿y
['4'] = 
¬¿y
(

4506 
v¬
 
d©a
 = "";

4507 
$DŸlogDivID
 = "DŸlogDiv" + 
$
(
this
).
©Œ
("id");

4509 
d©a
 = 
$
("#'. $d©a['obj_Çme'] . '_·ge-cÚ‹Á").
L“TabË
(\'GetSelectedID\');

4510 
cÚsŞe
.
debug
(
d©a
);

4511 ià(
$
(\'#\' + $DialogDivID).length == 0) {

4512 
$
(
this
).
aá”
(\'<div id="\' + $DialogDivID + \'" style="display:none;"></div>\');

4514 
$
.
ajax
({

4518 
$
(\'#\' + $DialogDivID).html(data);

4520 \'u¾\': "' . 
ba£_u¾
(è. 'šdex.php/www/objeùs/expÜt?obj_ty³=' . 
$d©a
['ObjType'] . '",

4523 
$
("#" + 
$DŸlogDivID
).
dŸlog
({

4524 
t™Ë
: "æ‰¹é‡å¯¼å‡º",

4525 
mod®
: 
Œue
,

4526 
width
: 700,

4527 
height
: 400,

4530 
$
(\'#\' + $DialogDivID).dialog(\'open\');

4535 
$but_¬¿y
['5'] = 
¬¿y
(

4541 
DŸlogU¾
: "' . ba£_u¾(è. 'šdex.php/www/objeùs/b©chUp?div_id='.$d©a["
div_Çme
"].'&obj_ty³=' . $d©a["
ObjTy³
"] . '",

4542 
DŸlogT™Ë
: "æ‰¹é‡æ›´æ–°",

4543 
DŸlogWidth
: 500,

4544 
DŸlogHeight
: 400});

4555 
$but_¬¿y
["7"] = 
¬¿y
(

4560 
$but_¬¿y
['7']['drİdown'][] = 
¬¿y
(

4564 
DŸlogU¾
: "' . ba£_u¾(è. 'šdex.php/www/objeùs/assign_¡aff?div_id='.$d©a["
div_Çme
"].'&bu‰Ú÷ssign_¡aff&em¶oy“s=0&obj_ty³=' . $d©a["
ObjTy³
"] . '",

4565 
DŸlogT™Ë
: "æ‰¹é‡åˆ†é…ç›¸å…³å‘˜å·¥",

4566 
DŸlogWidth
: 400,

4567 
DŸlogHeight
: 200});});'

4570 
$but_¬¿y
['7']['drİdown'][] = 
¬¿y
(

4574 
DŸlogU¾
: "' . ba£_u¾(è. 'šdex.php/www/objeùs/assign_¡aff?div_id='.$d©a["
div_Çme
"].'&bu‰Ú÷ssign_¡aff2&em¶oy“s=1&obj_ty³=' . $d©a["
ObjTy³
"] . '",

4575 
DŸlogT™Ë
: "æ‰¹é‡åˆ†é…è´Ÿè´£å‘˜å·¥",

4576 
DŸlogWidth
: 400,

4577 
DŸlogHeight
: 200});});'

4579 
	g$but_¬¿y
['7']['drİdown'][] = 
¬¿y
(

4583 
DŸlogU¾
: "' . ba£_u¾(è. 'šdex.php/www/objeùs/»cyc_¡aff?div_id='.$d©a["
div_Çme
"].'&obj_ty³=' . $d©a["
ObjTy³
"] . '",

4584 
DŸlogT™Ë
: "æ‰¹é‡å›æ”¶å‘˜å·¥",

4585 
DŸlogWidth
: 400,

4586 
DŸlogHeight
: 200});});'

4590 
	g$d©a
["but_¬¿y"] = 
$but_¬¿y
;

4591  
	g$d©a
;

4607 
public
 
funùiÚ
 
	$_blob_upd©e
(
$bË
, 
$wh”e
, 
$£t
) {

4608 
$cÚn
 = 
$this
->
db
->
cÚn_id
;

4609 
$£t_f›lds
 = 
$this
->
	`_£t
(
$£t
);

4610 
$£t_f›lds_bšk_Çme
 = ":" . 
$£t_f›lds
['blob_key'];

4611 
$£t_f›lds_´efix
 = 
$£t_f›lds
['blob_key'] . " = EMPTY_BLOB()";

4612 
$£t_f›lds_»tuºšg
 = 
$£t_f›lds
['blob_key'] . " INTO " . 
$£t_f›lds_bšk_Çme
;

4613 
$msg
 = 
	`ba£64_’code
(
$£t_f›lds
['blob_value']);

4615 
$sql
 = " update $table set ";

4616 
$sql
 .ğ" " . 
$£t_f›lds_´efix
 . " ";

4617 
$sql
 .ğ" wh”" . 
$this
->
	`_wh”e
(
$wh”e
);

4618 
$sql
 .ğ" RETURNING " . 
$£t_f›lds_»tuºšg
 . " ";

4620 
$şob
 = 
	`oci_Ãw_desütÜ
(
$cÚn
, 
OCI_D_LOB
);

4622 
$¡id
 = 
	`oci_·r£
(
$cÚn
, 
$sql
);

4624 
	`oci_bšd_by_Çme
(
$¡id
, 
$£t_f›lds_bšk_Çme
, 
$şob
, -1, 
OCI_B_BLOB
);

4626 ià(
	`v”siÚ_com·»
(
PHP_VERSION
, '5.3.1') >= 0) {

4627 
	`oci_execu‹
(
$¡id
, 
OCI_NO_AUTO_COMMIT
);

4629 
	`oci_execu‹
(
$¡id
, 
OCI_DEFAULT
);

4631 ià(!
$şob
->
	`§ve
(
$msg
)) {

4632 
	`oci_rŞlback
(
$cÚn
);

4633  
çl£
;

4635 
	`oci_comm™
(
$cÚn
);

4637 
	`oci_ä“_¡©em’t
(
$¡id
);

4639  
Œue
;

4663 
d›
;

4664 
	}
}

4669 
´Ùeùed
 
funùiÚ
 
	$_wh”e
(
$wh”e
) {

4670 
$sql
 = "";

4671 
	`fÜ—ch
 (
$wh”e
 
as
 
$key
 => 
$v®ue
) {

4672 
$sql
 .= "$key = $value‡nd ";

4674 
$sql
 .= " 1 = 1 ";

4675  
$sql
;

4676 
	}
}

4681 
´Ùeùed
 
funùiÚ
 
	$_£t
(
$£t
) {

4682 
$sql
 = 
	`¬¿y
();

4683 
	`fÜ—ch
 (
$£t
 
as
 
$key
 => 
$v®ue
) {

4684 
$sql
["blob_key"] = 
$key
;

4685 
$sql
["blob_v®ue"] = 
$v®ue
;

4687  
$sql
;

4688 
	}
}

4701 
public
 
funùiÚ
 
	$što_u£r
(
$bË_Çme
, 
$bË_f›ld
, 
$Üg_id
, 
$id
, 
$u£r_id
, 
$is_£lf
, 
$£rv”
 = 0) {

4702 
$¬¿y_£l
 = 
	`¬¿y
(
$bË_f›ld
 => 
$id
, 'USER_ID' => 
$u£r_id
);

4703 
$qu”y
 = 
$this
->
db
->
	`wh”e
(
$¬¿y_£l
)->
	`g‘
(
$bË_Çme
)->
	`»suÉ_¬¿y
();

4704 ià(
	`couÁ
(
$qu”y
) == 0) {

4705 
$¬¿y_š
 = 
	`¬¿y
("ORG_ID" => 
$Üg_id
, 
$bË_f›ld
 => 
$id
, 'USER_ID' => 
$u£r_id
, 'IS_SELF' => 
$is_£lf
, "SERVER_FLAG" => 
$£rv”
);

4706 
$this
->
db
->
	`£t
(
$¬¿y_š
);

4707  
$this
->
db
->
	`š£¹
(
$bË_Çme
);

4709  
Œue
;

4711 
	}
}

4722 
public
 
funùiÚ
 
	$d–_u£r
(
$bË_Çme
, 
$bË_f›ld
, 
$Üg_id
, 
$id
, 
$u£r_id
) {

4723 
$¬¿y
 = 
	`¬¿y
("ORG_ID" => 
$Üg_id
, 
$bË_f›ld
 => 
$id
, 'USER_ID' => 
$u£r_id
);

4724  
$this
->
db
->
	`d–‘e
(
$bË_Çme
, 
$¬¿y
);

4725 
	}
}

4733 
public
 
funùiÚ
 
	$_di§bË_’abË
(
$id
, 
$obj_ty³
, 
$d©a
) {

4734 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj_ty³
);

4735 
$bË_Çme
 = 
$obj
["MAIN_TABLE"];

4736 
$key_©Œ_Çme
 = 
$obj
["KEY_ATTR_FLD"];

4737 
$this
->
db
->
	`wh”e
(
$key_©Œ_Çme
, 
$id
);

4738  
$this
->
db
->
	`upd©e
(
$bË_Çme
, 
$d©a
);

4739 
	}
}

4747 
public
 
funùiÚ
 
	$v›w_pub_bu‰Ú
(
$OrgID
, 
$d©a
) {

4749 
$ty³_¬r
 = 
$this
->
ty³
->
	`ObjG‘Ty³
(
$OrgID
, 
$d©a
["obj_type"]);

4750 
$but_¬¿y
['1'] = 
	`¬¿y
(

4756 ià(
$ty³_¬r
) {

4757 
	`fÜ—ch
 (
$ty³_¬r
 
as
 
$k
 => 
$v
) {

4758 
$but_¬¿y
['1']['drİdown'][] = 
	`¬¿y
(

4759 "Çme" => 
$v
["Name"],

4760 "u¾" => 
	`ba£_u¾
(è. "šdex.php/www/objeùs/add?obj_ty³=" . 
$d©a
["ObjTy³"] . "&ty³_id=" . 
$v
["ID"],

4764 
$but_¬¿y
['1']['u¾'] = 
	`ba£_u¾
(è. "šdex.php/www/objeùs/add?obj_ty³=" . 
$d©a
["ObjType"];

4766 
$but_¬¿y
['2'] = 
	`¬¿y
(

4770 "u¾" => 
	`ba£_u¾
(è. "šdex.php/www/objeùs/li¡s?obj_ty³=" . 
$d©a
["obj_type"]

4772 
$but_¬¿y
['3'] = 
	`¬¿y
(

4776 "u¾" => 
	`ba£_u¾
(è. "šdex.php/www/objeùs/ed™?obj_ty³=" . 
$d©a
["obj_type"] . "&id=" . $data["id"]

4778 
$but_¬¿y
['4'] = 
	`¬¿y
(

4784 
	`$
("#d–").
	`şick
(
	`funùiÚ
(){

4785 ià(
	`cÚfœm
("ç¡®å®šè¦åˆ é™¤æ•°æ®å—ï¼Ÿ")) {

4786 
v¬
 
d–_u¾
 = "' . site_url() . '/www/objects/del";

4787 
$
.
	`ajax
({

4788 
ty³
: "GET",

4789 
u¾
: 
d–_u¾
,

4790 
d©a
: {
id
: ' . $d©a["id"] . ' ,
obj_ty³
: ' . $data["obj_type"] . '},

4791 
sucûss
: 
	`funùiÚ
 (
d©a
) {

4792 ià(
d©a
 == "success") {

4793 
	`®”t
("åˆ é™¤æ•°æ®æˆåŠŸ");

4794 
hi¡Üy
.
	`go
(-1);

4796 
	`®”t
("ç½‘ç»œå¼‚å¸¸ï¼Œåˆ é™¤å¤±è´¥ï¼");

4803 
	}
})'

4810 
	g$but_¬¿y
['6'] = 
¬¿y
(

4816 
$
("#di§bË").
şick
(
	$funùiÚ
(){

4817 ià(
	`cÚfœm
("ç¡®å®šè¦åœç”¨æ•°æ®å—ï¼Ÿ")) {

4818 
v¬
 
di§bË_u¾
 = "' . site_url() . '/www/objects/disable_enable";

4819 
$
.
	`ajax
({

4820 
ty³
: "GET",

4821 
u¾
: 
di§bË_u¾
,

4822 
d©a
: {
id
: ' . $d©a["id"] . ' ,
obj_ty³
: ' . $d©a["obj_ty³"] . ', 
¡İ_æag
:1},

4823 
sucûss
: 
	`funùiÚ
 (
d©a
) {

4824 ià(
d©a
 == "success") {

4825 
	`®”t
("åœç”¨æ•°æ®æˆåŠŸ");

4826 
wšdow
.
hi¡Üy
.
	`go
(0);

4828 
	`®”t
("ç½‘ç»œå¼‚å¸¸ï¼Œåœç”¨å¤±è´¥ï¼");

4833 
	}
})

4836 
	g$but_¬¿y
['7'] = 
¬¿y
(

4842 
$
("#’abË").
şick
(
	$funùiÚ
(){

4843 ià(
	`cÚfœm
("ç¡®å®šè¦å¯ç”¨æ•°æ®å—ï¼Ÿ")) {

4844 
v¬
 
di§bË_u¾
 = "' . site_url() . '/www/objects/disable_enable";

4845 
$
.
	`ajax
({

4846 
ty³
: "GET",

4847 
u¾
: 
di§bË_u¾
,

4848 
d©a
: {
id
: ' . $d©a["id"] . ' ,
obj_ty³
: ' . $d©a["obj_ty³"] . ', 
¡İ_æag
:0},

4849 
sucûss
: 
	`funùiÚ
 (
d©a
) {

4850 ià(
d©a
 == "success") {

4851 
	`®”t
("å¯ç”¨æ•°æ®æˆåŠŸ");

4852 
wšdow
.
hi¡Üy
.
	`go
(0);

4854 
	`®”t
("ç½‘ç»œå¼‚å¸¸ï¼Œå¯ç”¨å¤±è´¥ï¼");

4859 
	}
})

4862 
	g$´iv©e_but
['L—d']['1'] = 
¬¿y
(

4868 
$
("#şues_što").
AjaxDŸlog
({

4869 
DŸlogU¾
: "' . site_url() . '/www/lead/leadConversion",

4870 
DŸlogT™Ë
:"çº¿ç´¢è½¬åŒ–",

4871 
DŸlogWidth
: 560,

4872 
DŸlogHeight
: 500,

4873 
DŸlogD©a
:{
id
: ' . $d©a["id"] . ' ,
obj_ty³
: ' . $data["obj_type"] . '},

4874 
DŸlogBu‰Ús
: [{

4875 
‹xt
:"ç¡®å®š",

4876 
CÏss
:"btn btn-primary",

4877 
şick
: 
funùiÚ
(){

4878 
v¬
 
sub
 = 
Œue
;

4879 if(
$
("#šput_key_AccouÁ_OwÃr").
v®
().
Ëngth
 == 0){

4880 
sub
 = 
çl£
;

4881 
®”t
("è¯·é€‰æ‹©å®¢æˆ·æ‰€æœ‰è€…");

4884 if(
$
("#cÚù").
´İ
("checked"è&& $("#šput_key_CÚù_OwÃr").
v®
().
Ëngth
 == 0){

4885 
sub
 = 
çl£
;

4886 
®”t
("è¯·é€‰æ‹©è”ç³»äººæ‰€æœ‰è€…");

4889 if(
$
("#İpÜtun™y").
´İ
("checked"è&& $("#šput_key_OµÜtun™y_OwÃr").
v®
().
Ëngth
 == 0){

4890 
sub
 = 
çl£
;

4891 
®”t
("è¯·é€‰æ‹©è”ç³»äººæ‰€æœ‰è€…");

4894 if(
sub
){

4895 
$
(
this
).
dŸlog
("close");

4896 
$
("#şuesIÁoD©a").
subm™
();

4897 
®”t
("æˆåŠŸ")

4905 
	g$´iv©e_but
['OµÜtun™y']['1'] = 
¬¿y
(

4911 
$
("#pha£_´omÙiÚ").
AjaxDŸlog
({

4912 
DŸlogU¾
: "' . base_url() . 'index.php/www/opportunity/phase_promotion?id='.$data['id'].'",

4913 
DŸlogT™Ë
: "é˜¶æ®µå‡è¿",

4914 
DŸlogWidth
: 300,

4915 
DŸlogHeight
: 200

4920 
	g$d©a
["but_¬¿y"] = 
$but_¬¿y
;

4921 
	g$d©a
["´iv©e_but"] = 
$´iv©e_but
;

4922  
	g$d©a
;

4930 
public
 
funùiÚ
 
	$g‘_šdex_©Œ
(
$obj_Çme
, 
$Üg_id
) {

4931 
$£Ëù
 = 
	`¬¿y
(

4935 
$cÚd™iÚ
 = 
	`¬¿y
(

4936 'obj_Çme' => 
$obj_Çme
,

4938 'Üg_id' => 
$Üg_id


4940 
$qu”y
 = 
$this
->
db
->
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
("dd_©Œibu‹")->
	`»suÉ_¬¿y
();

4941 
$wh”e
 = "";

4942 
	`fÜ—ch
 (
$qu”y
 
as
 
$k
 => 
$v
) {

4943 
$»s
[
$v
['IS_SEARCH_FIELD']] = $v['ATTR_NAME'];

4945 ià(
	`couÁ
(
$qu”y
)) {

4946  
$»s
;

4948  
	`¬¿y
();

4950 
	}
}

4957 
public
 
funùiÚ
 
	$g‘_šdex_æd
(
$wh”e_v®ue
, 
$¬r
) {

4959 
$Üg_id
 = 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id');

4960 
$i
 = 0;

4961 
$»l
 = "";

4962 
	`fÜ—ch
 (
$¬r
 
as
 
$key
 => 
$v®ue
) {

4963 
$wh”e_¬r
[++
$i
] = 
	`¬¿y
(

4964 "©Œ" => 
$v®ue
,

4966 "v®ue" => 
$wh”e_v®ue


4968 
$»l
 .ğ
$i
 . " or ";

4970 
$»l
 = 
	`sub¡r
(
	`Œim
($rel), 0, -2);

4971 
$wh”e
 = 
	`¬¿y
(

4972 "wh”e" => 
$wh”e_¬r
,

4973 "»l" => 
$»l


4975  
$wh”e
;

4976 
	}
}

4983 
public
 
funùiÚ
 
	$©Œ_Çme
(
$©Œ
) {

4984 
$£Ëù
 = 
	`¬¿y
(

4989 
$cÚd™iÚ
 = 
	`¬¿y
(

4990 'Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

4991 'diù_Çme' => 
$©Œ


4993 
$qu”y
 = 
$this
->
db
->
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
("dd_diù_¡r")->
	`»suÉ_¬¿y
();

4994  
$qu”y
;

4995 
	}
}

5002 
public
 
funùiÚ
 
	$jqGridMod–
(
$¬r
) {

5003 
	`fÜ—ch
 (
$¬r
 
as
 
$key
 => 
$v®ue
) {

5004 
$Ïn
 = 
$this
->
	`©Œ_Çme
(
$v®ue
);

5005 
$d©a
['cŞ'][] = 
	`¬¿y
("Name" => 
$v®ue
,"LªgEn" => 
$Ïn
[1]["LABEL"] );

5008  
$d©a
;

5009 
	}
}

5016 
public
 
funùiÚ
 
	$d‘a
(
$obj_ty³
) {

5017 
$£Ëù
 = 
	`¬¿y
(

5020 
$cÚd™iÚ
 = 
	`¬¿y
(

5021 'Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

5022 'obj_ty³' => 
$obj_ty³


5024 
$qu”y
 = 
$this
->
db
->
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
("dd_objeù")->
	`»suÉ_¬¿y
();

5025 ià(
	`em±y
(
$qu”y
[0]["DTL_OBJ_NAME"])) {

5026  
çl£
;

5028  
$qu”y
[0]["DTL_OBJ_NAME"];

5030 
	}
}

5037 
public
 
funùiÚ
 
	$d‘a_t™Ë
(
$™me
) {

5038 
	`fÜ—ch
 (
$™me
 
as
 
$v®ue
) {

5039 ià(!
	`couÁ
(
$this
->
	`©Œ_Çme
(
$v®ue
))) {

5042 
$t™Ë
 = 
$this
->
	`©Œ_Çme
(
$v®ue
);

5043 
$¬r
[
$v®ue
] = 
$t™Ë
[1]["LABEL"];

5045  
$¬r
;

5046 
	}
}

5053 
public
 
funùiÚ
 
	$ÿlcuÏ‹
(
$obj_Çme
,
$is_pošt
=1) {

5054 
$£Ëù
 = 
	`¬¿y
(

5058 
$cÚd™iÚ
 = 
	`¬¿y
(

5059 'Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

5060 'obj_Çme' => 
$obj_Çme


5062 
$qu”y
 = 
$this
->
db
->
	`wh”e
('fÜmuÏ_ex´ i nÙ‚uÎ ',
nuÎ
,
çl£
è-> 
	`£Ëù
(
$£Ëù
)->wh”e(
$cÚd™iÚ
)->
	`g‘
("dd_©Œibu‹")->
	`»suÉ_¬¿y
();

5063 if(
	`¡½os
(
$qu”y
[0]['FORMULA_EXPR'],"+")){

5064 
$symbŞ
 = "+";

5065 }if(
	`¡½os
(
$qu”y
[0]['FORMULA_EXPR'],"-")){

5066 
$symbŞ
 = "-";

5067 }if(
	`¡½os
(
$qu”y
[0]['FORMULA_EXPR'],"*")){

5068 
$symbŞ
 = "*";

5069 }if(
	`¡½os
(
$qu”y
[0]['FORMULA_EXPR'],"/")){

5070 
$symbŞ
 = "/";

5072 
$d©a
['symbŞ'] = 
$symbŞ
;

5073 
$d©a_¬r
 = 
	`ex¶ode
(
$symbŞ
,
$qu”y
[0]['FORMULA_EXPR']);

5074 if(
$is_pošt
 == 1){

5075 
$d©a
['»suÉs'] = 
$qu”y
[0]['ATTR_NAME'];

5076 
$d©a
["fœ¡"] = 
$obj_Çme
.".".
$d©a_¬r
[0];

5077 
$d©a
["Ï¡"] = 
$obj_Çme
.".".
$d©a_¬r
[1];

5079 
$d©a
['»suÉs'] = 
	`¡r_»¶aû
(".",'_',
$qu”y
[0]['ATTR_NAME']) ;

5080 
$d©a
["fœ¡"] = 
$obj_Çme
."_".
$d©a_¬r
[0];

5081 
$d©a
["Ï¡"] = 
$obj_Çme
."_".
$d©a_¬r
[1];

5083  
$d©a
;

5084 
	}
}

5092 
public
 
funùiÚ
 
	$d‘a_cŞ
(
$®l_©Œ
,
$d‘a_t™Ë
,
$©Œ
){

5093 
	`fÜ—ch
 (
$d‘a_t™Ë
 
as
 
$key
 => 
$v®ue
) {

5094 
	`fÜ—ch
 (
$®l_©Œ
 
as
 
$k
 => 
$v
) {

5095 ià(
$key
 =ğ
$v
["name"]) {

5096 
$myd©a
[
$key
]["A‰rTy³"] = 
$v
["attr_type"];

5097 
$myd©a
[
$key
]["Name"] = 
$v
["name"];

5098 
$myd©a
[
$key
]["LªgEn"] = 
$v
["label"];

5099 if(
	`is£t
(
$v
["form_data"])){

5100 
$myd©a
[
$key
]["FÜmD©a"] = 
$v
["form_data"];

5102 
$myd©a
[
$key
]["FÜmD©a"]["Name"] = 
$v
["name"];

5103 if(
$©Œ
[
$key
]["is_must"] == 1){

5104 
$myd©a
[
$key
]["IsMu¡"] = 
Œue
;

5106 
$myd©a
[
$key
]["IsMu¡"] = 
çl£
;

5112  
$myd©a
;

5113 
	}
}

5115 
public
 
funùiÚ
 
	$d‘a_is_th”e
(
$wh”e
,
$bË_Çme
){

5116 
$couÁ
 = 
$this
->
db
->
	`wh”e
(
$wh”e
è->
	`couÁ_®l_»suÉs
(
$bË_Çme
);

5117  
$couÁ
;

5119 
	}
}

5129 
public
 
funùiÚ
 
	$d‘a_add
(
$d©a
, 
$moduË
, 
$OrgID
 = 1, 
$U£rID
) {

5130 
$this
->
lßd
->
	`mod–
('admin/nextid', 'nextid');

5133 
$time
 = 
	`d©e
("Y-m-d H:i:s");

5135 
$ty³_id
 = 
$d©a
[
$moduË
 . 'Type'];

5136 
$objeù_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$OrgID
, 
$moduË
);

5137 
$tbl_Çme
 = 
$this
->
	`G‘AÎTbl
(
$OrgID
, 
$moduË
);

5138 
	`fÜ—ch
 (
$tbl_Çme
 
as
 
$k
 => 
$v
) {

5139 
$š£¹
[
$v
] = 
	`¬¿y
();

5142 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$OrgID
, 
$moduË
);

5143 
$maš_tbl
 = 
$obj_d©a
['MAIN_TABLE'];

5144 
$pk
 = 
$obj_d©a
['KEY_ATTR_FLD'];

5145 
$IDfÜm©
 = 
$this
->
Ãxtid
->
	`NewFÜm©ID
(
$ty³_id
, 
$obj_d©a
, 
$OrgID
);

5146 ià(!
	`em±y
(
$IDfÜm©
['FORMAT'])) {

5147 
$FÜm©ID
 = 
$this
->
Ãxtid
->
	`NewID
('LEAD_USERID_' . 
$ty³_id
 . '_' . 
	`d©e
('Ymd'), 
$OrgID
);

5149 
$¡¿¼
 = 
	`¬¿y
(

5150 '{YYYY}' => 
	`d©e
('Y'),

5151 '{MM}' => 
	`d©e
('m'),

5152 '{DD}' => 
	`d©e
('d'),

5153 '{0000}' => 
	`¡r_·d
(
$FÜm©ID
, 4, "0", 
STR_PAD_LEFT
),

5156 
$Ëad_u£rid
 = 
	`¡¹r
(
$IDfÜm©
['FORMAT'], 
$¡¿¼
);

5157 
$d©a
[
$IDfÜm©
['ATTR_NAME']] = 
$Ëad_u£rid
;

5160 
$Ãxtid
 = 
$this
->
Ãxtid
->
	`NewID
(
$maš_tbl
, 
$OrgID
);

5161 
$u£rd©a
 = 
$this
->
u£r
->
	`S–eùOÃ
(
$OrgID
, 
$U£rID
);

5172 
$nd©a
 = 
$this
->
	`ŒªsfÜm
(
$d©a
, 
$moduË
, 
$OrgID
);

5174 ià(
$nd©a
 =ğ
çl£
 || 
	`em±y
($ndata)) {

5175 
$»s
['res'] = 'fail';

5176 
$»s
['msg'] = 'ä¿å­˜å¤±è´¥ï¼';

5177  
$»s
;

5179 
	`fÜ—ch
 (
$nd©a
 
as
 
$k
 => 
$v
) {

5180 ià(
	`em±y
(
$v
)) {

5183 
$š£¹
[
$objeù_©Œ
[
$k
]['tbl_Çme']][$k] = 
$v
;

5188 
	`fÜ—ch
 (
$š£¹
 
as
 
$k
 => 
$v
) {

5189 ià(!
	`em±y
(
$v
)) {

5190 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

5192 
$objeù_©Œ
[
$kk
]['attr_type']) {

5194 if(
$objeù_©Œ
[
$kk
]['is_ref_obj']){

5195 
$this
->
db
->
	`£t
(
$objeù_©Œ
[$objeù_©Œ[
$kk
]['»ã¼ed_by']]['æd_Çme'], 
$vv
);

5197 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
);

5217 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
, 
çl£
);

5220 ià(!
	`em±y
(
$vv
)) {

5222 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], "to_d©e('" . 
$vv
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

5227 ià(!
	`em±y
(
$vv
)) {

5228 
$vv
 = 
	`d©aReduû8
('Y-m-d H:i:s', $vv);

5229 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], "to_d©e('" . 
$vv
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

5234 
$this
->
db
->
	`£t
(
$objeù_©Œ
[
$kk
]['æd_Çme'], 
$vv
);

5240 
$this
->
db
->
	`£t
(
$pk
, 
$Ãxtid
);

5242 
$this
->
db
->
	`£t
('Üg_id', 
$OrgID
, 
çl£
);

5243 
$this
->
db
->
	`š£¹
(
$k
);

5249 
$»s
['res'] = 'suc';

5250 
$»s
['id'] = 
$Ãxtid
;

5251 
$»s
['msg'] = 'ä¿å­˜æˆåŠŸï¼';

5252  
$»s
;

5254 
	}
}

5264 
public
 
funùiÚ
 
	$fÜmuÌa_cÚd
(
$d_obj_Çme
, 
$Ëad_©Œ
, 
$Üg_id
, &
$cŞl
){

5270 
$ma¡”_obj
 = 
$this
->
obj
->
	`g‘Ma¡”ObjName
(
$d_obj_Çme
, 
$Üg_id
);

5271 
$ma¡”_obj_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$ma¡”_obj
['OBJ_NAME']);

5272 
$Ëad_©Œ
 = 
	`¬¿y_m”ge
($Ëad_©Œ, 
$ma¡”_obj_©Œ
);

5273 
	`fÜ—ch
 (
$cŞl
 
as
 
$k
 => 
$v
) {

5274 ià(
	`is£t
(
$Ëad_©Œ
[
$k
]) && $lead_attr[$k]['lee_is_calc_point'] == 1) {

5275 
$cŞl
[
$k
]['is_ÿlc_pošt'] = 
$Ëad_©Œ
[$k]['lee_is_calc_point'];

5276 
$ÿlc_»suÉ_©Œ
 = 
	`ex¶ode
(",", 
$Ëad_©Œ
[
$k
]['lee_calc_result_attr']);

5277 
	`fÜ—ch
 (
$ÿlc_»suÉ_©Œ
 
as
 
$ÿlc_k
 => 
$ÿlc_v
) {

5278 
$cŞl
[
$k
]['fÜmuÌa_d©a'][
$ÿlc_k
]['ÿlc_»suÉ_©Œ'] = 
$ÿlc_v
;

5279 
$cŞl
[
$k
]['fÜmuÌa_d©a'][
$ÿlc_k
]['ÿlc_fÜmuÏ'] = 
$Ëad_©Œ
[
$ÿlc_v
]['lee_calc_formula'];

5283 
	}
}

5291 
public
 
funùiÚ
 
	$g‘_bË_æd
(
$©Œ
,
$Üg_id
){

5292 
$£Ëù
 = 
	`¬¿y
(

5296 
$cÚd™iÚ
 = 
	`¬¿y
(

5297 'Üg_id' => 
$Üg_id
,

5298 '©Œ_Çme' => 
$©Œ


5300 
$qu”y
 = 
$this
->
db
 -> 
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
("dd_©Œibu‹")->
	`row_¬¿y
();

5301  
$qu”y
;

5303 
	}
}

5312 
public
 
funùiÚ
 
	$g‘_®l_d‘a_id
(
$¬r
,
$id
,
$Ãed_æd
){

5313 
$£Ëù
 = 
	`¬¿y
(

5314 
$Ãed_æd


5316 
$cÚd™iÚ
 = 
	`¬¿y
(

5317 'Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

5318 
$¬r
["FLD_NAME"] => 
$id


5320 
$qu”y
 = 
$this
->
db
 -> 
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
(
$¬r
["TBL_NAME"])->
	`»suÉ_¬¿y
();

5321 
	`fÜ—ch
(
$qu”y
 
as
 
$v®ue
){

5322 
$»s
[] = 
$v®ue
[
	`¡¹ouµ”
(
$Ãed_æd
)];

5324  
$»s
;

5325 
	}
}

5334 
public
 
funùiÚ
 
	$g‘_d‘a_®l_¬r
(
$obj_d©a
,
$KEY_ATTR_NAME
,
$KEY_ATTR_NAME_VALUE
){

5335 
$©Œ
 = 
$obj_d©a
["OBJ_NAME"].".".
	`¡r_»¶aû
(".","",
$KEY_ATTR_NAME
);

5336 
$¬r
 = 
$this
 ->
	`g‘_bË_æd
(
$©Œ
,$this->
£ssiÚ
->
	`u£rd©a
('org_id'));

5337 
$®l_d‘a_id_¬r
 = 
$this
 -> 
	`g‘_®l_d‘a_id
(
$¬r
,
$KEY_ATTR_NAME_VALUE
,
$obj_d©a
["KEY_ATTR_FLD"]);

5338  
$®l_d‘a_id_¬r
;

5339 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/opportunity_model.php

1 <?
php


3 şas 
	cOµÜtun™y_mod–
 
ex‹nds
 
	mCI_Mod–
 {

5 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

6 
·»Á
::
	`__cÚ¡ruù
();

7 
$this
->
lßd
->
	`mod–
("admin/nextid_model", "nextid");

8 
$this
->
lßd
->
	`mod–
("www/objects_model", "objects");

9 
$this
->
lßd
->
	`mod–
("admin/attr_model", "attr");

23 
public
 
funùiÚ
 
	$İpÜtun™y_moduË_add
(
$Ãxt_id
, 
$moduË
, 
$Üg_id
 = 1) {

24 
$æd
 = "owner_user_id,optnty_type,to_char(START_DATE,'yyyy-mm-dd') START_DATE";

25 
$İpÜ_d©a
 = 
$this
->
	`£ËùOÃ
(
$Ãxt_id
, 
$æd
);

26 
$İŠty_ty³
 = 
$İpÜ_d©a
['OPTNTY_TYPE'];

27 
$¡¬t_d©e
 = 
$İpÜ_d©a
['START_DATE'];

28 
$İŠty_tbl_wh”e
 = 
	`¬¿y
(

29 "ty³_id" => 
$İŠty_ty³
,

30 "Üg_id" => 
$Üg_id
,

36 
$İpÜ_¡age_d©a
 = 
$this
->
	`£ËùWh”e
(
$İŠty_tbl_wh”e
);

37 
	`un£t
(
$İŠty_tbl_wh”e
);

38 
$¡age_·th
 = 
	`¬¿y
();

40 
	`fÜ—ch
 (
$İpÜ_¡age_d©a
 
as
 
$key
 => 
$v®ue
) {

41 
$¡age_Ãxt_id
 = 
$this
->
Ãxtid
->
	`NewID
("tc_opportunity_stage");

42 
$¡age_id
 = 
$v®ue
['STAGE_ID'];

43 ià(
$¡age_Ãxt_id
 > 0) {

44 ià(
$key
 == 0) {

45 
$d©a
['OPTNTY_STAGE'] = 
$¡age_Ãxt_id
;

46 
$this
->
	`upd©e
(
$d©a
, 
$Ãxt_id
);

48 
$¡age_·th
[
$v®ue
['STAGE_ID']] = 
$¡age_Ãxt_id
;

49 
$v®ue
['STAGE_ID'] = 
$¡age_Ãxt_id
;

50 
$v®ue
['OBJ_ID'] = 
$Ãxt_id
;

51 
$v®ue
['TYPE_ID'] = 0;

52 
$this
->
	`doš£¹
(
$v®ue
);

53 if(!
	`em±y
(
$¡¬t_d©e
)){

55 
$this
->
db
->
	`£t
('PLAN_START_TIME', "to_d©e('" . 
$¡¬t_d©e
 . "','yyyy-mm-dd')", 
çl£
);

56 
$¡¬t_d©e
 = 
	`d©e_add_sub
($start_date);

57 
$this
->
db
->
	`£t
('PLAN_END_TIME', "to_d©e('" . 
$¡¬t_d©e
 . "','yyyy-mm-dd')", 
çl£
);

58 if(
$key
==0è
$this
->
db
->
	`£t
('START_TIME', "to_d©e('" . 
	`d©aReduû8
('Y-m-d H:i:s',
	`d©e
('Y-m-d H:i:s')è. "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

59 
$w
 = 
	`¬¿y
(

60 "STAGE_ID" => 
$¡age_Ãxt_id
,

62 
$this
->
db
->
	`wh”e
(
$w
);

63 
$this
->
db
->
	`upd©e
('tc_opportunity_stage');

67 
$tbl_wh”e
 = 
	`¬¿y
(

68 "¡age_id" => 
$¡age_id
,

70 
$¡age_d©a
 = 
$this
->
	`£ËùWh”e
(
$tbl_wh”e
, "tc_opportunity_stage_lang");

71 if(!
	`em±y
(
$¡age_d©a
)) {

72 
	`fÜ—ch
 (
$¡age_d©a
 
as
 
$k
 => 
$v
) {

73 
$v
['STAGE_ID'] = 
$¡age_Ãxt_id
;

74 
$this
->
	`doš£¹
(
$v
, "tc_opportunity_stage_lang");

77 
	`un£t
(
$tbl_wh”e
);

78 
$uš£¹
 = 
	`¬¿y
('Üg_id'=>
$Üg_id
,'u£r_id'=>
$İpÜ_d©a
['OWNER_USER_ID'],'İŠty_id'=>
$Ãxt_id
,'¡age_id'=>
$¡age_id
,'is_self'=>1);

79 
$this
->
db
->
	`š£¹
('»l_İpÜtun™y_¡age_u£r',
$uš£¹
);

87 
$İŠty_tbl_wh”e
 = 
	`¬¿y
(

89 "ty³_id" => 
$İŠty_ty³
,

90 "Üg_id" => 
$Üg_id


93 
$¡age_·th_d©a
 = 
$this
->
	`£ËùWh”e
(
$İŠty_tbl_wh”e
, "tc_stage_path");

95 
	`un£t
(
$İŠty_tbl_wh”e
);

96 
	`fÜ—ch
 (
$¡age_·th_d©a
 
as
 
$key
 => 
$v®ue
) {

97 
$¡age_·th_Ãxt_id
 = 
$this
->
Ãxtid
->
	`NewID
("tc_stage_path");

98 
$·th_id
 = 
$v®ue
['PATH_ID'];

99 ià(
$¡age_·th_Ãxt_id
 > 0) {

100 
$v®ue
['PATH_ID'] = 
$¡age_·th_Ãxt_id
;

101 
$v®ue
['OBJ_ID'] = 
$Ãxt_id
;

102 
$v®ue
['OLD_STAGE'] = 
$¡age_·th
[$value['OLD_STAGE']];

103 
$v®ue
['NEW_STAGE'] = 
$¡age_·th
[$value['NEW_STAGE']];

104 
$v®ue
['TYPE_ID'] = 0;

105 
$this
->
	`doš£¹
(
$v®ue
, "tc_stage_path");

106 
$tbl_wh”e
 = 
	`¬¿y
(

107 "·th_id" => 
$·th_id
,

109 
$¡age_·th_aùiÚ_d©a
 = 
$this
->
	`£ËùWh”e
(
$tbl_wh”e
, "tc_stage_path_action");

110 if(!
	`em±y
(
$¡age_·th_aùiÚ_d©a
)){

111 
	`fÜ—ch
 (
$¡age_·th_aùiÚ_d©a
 
as
 
$k
 => 
$v
) {

112 
$v
['PATH_ID'] = 
$¡age_·th_Ãxt_id
;

113 
$this
->
	`doš£¹
(
$v
, "tc_stage_path_action");

116 
	`un£t
(
$tbl_wh”e
);

120 
	}
}

128 
public
 
funùiÚ
 
£ËùOÃ
(
$id
, 
$æd
 = 
nuÎ
, 
$tbl_Çme
 = "tc_opportunity") {

129 
$this
->
db
->
äom
(
$tbl_Çme
);

130 
	g$this
->
	gdb
->
wh”e
("İŠty_id", 
$id
);

131 ià(!
em±y
(
$æd
)) {

132 
	g$this
->
	gdb
->
£Ëù
(
$æd
);

134 
	g$d©a
 = 
$this
->
db
->
g‘
()->
»suÉ_¬¿y
();

135  
	g$d©a
[0];

139 
public
 
funùiÚ
 
	$upd©e
(
$d©a
, 
$id
) {

140 
$this
->
db
->
	`wh”e
('İŠty_id', 
$id
)->
	`upd©e
('tc_İpÜtun™y', 
$d©a
);

141 
	}
}

146 
public
 
funùiÚ
 
£ËùWh”e
(
$tbl_wh”e
, 
$tbl_Çme
 = "tc_opportunity_stage") {

147 
$this
->
db
->
äom
(
$tbl_Çme
);

148 
	g$this
->
	gdb
->
wh”e
(
$tbl_wh”e
);

149 
	g$d©a
 = 
$this
->
db
->
g‘
()->
»suÉ_¬¿y
();

150  
	g$d©a
;

156 
public
 
funùiÚ
 
doš£¹
(
$tbl_d©a
, 
$tbl_Çme
 = "tc_opportunity_stage") {

157 
$this
->
db
->
š£¹
(
$tbl_Çme
, 
$tbl_d©a
);

164 
public
 
funùiÚ
 
	$g‘_İpÜtun™y_Ãw_¡age
(
$id
){

165 
$£Ëù
 = 
	`¬¿y
(

168 
$cÚd™iÚ
 = 
	`¬¿y
(

169 'Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

170 "İŠty_id" => 
$id


172 
$qu”y
 = 
$this
->
db
 -> 
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
("tc_İpÜtun™y")->
	`»suÉ_¬¿y
();

173 
$pha£_id
 = 
$qu”y
[0]["OPTNTY_STAGE"];

174 
$£Ëù
 = 
	`¬¿y
(

178 
$cÚd™iÚ
 = 
	`¬¿y
(

179 'a.obj_id' => 
$id
,

180 'a.Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

182 "a.Şd_¡age" => 
$pha£_id


185 
$»s
 = 
$this
->
db
->
	`äom
("tc_stage_path‡")->

186 
	`još
('tc_opportunity_stage_lang b', 'a.new_stage = b.stage_id', 'left')->

187 
	`wh”e
(
$cÚd™iÚ
)->

188 
	`£Ëù
(
$£Ëù
)->
	`g‘
()->
	`»suÉ_¬¿y
();

190 if(
	`couÁ
(
$»s
)) {

191  
$»s
;

193  
çl£
;

195 
	}
}

202 
public
 
funùiÚ
 
	$g‘_accouÁ_id
(
$id
){

203 
$£Ëù
 = "account_id";

204 
$cÚd™iÚ
 = 
	`¬¿y
(

205 'Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

206 "İŠty_id" => 
$id


208 
$qu”y
 = 
$this
->
db
 -> 
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
("tc_İpÜtun™y")->
	`»suÉ_¬¿y
();

209  
$qu”y
[0][
	`¡¹ouµ”
(
$£Ëù
)];

210 
	}
}

217 
public
 
funùiÚ
 
	$g‘_accouÁ_em¡©us
(
$accouÁ_id
){

218 
$£Ëù
 = "acct_int39";

219 
$cÚd™iÚ
 = 
	`¬¿y
(

220 'Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

221 "accouÁ_id" => 
$accouÁ_id


223 
$qu”y
 = 
$this
->
db
 -> 
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
("tc_accouÁ_©Œ")->
	`»suÉ_¬¿y
();

224 if(
$qu”y
[0][
	`¡¹ouµ”
(
$£Ëù
)] == 1001){

225  
Œue
;

227  
çl£
;

230 
	}
}

237 
public
 
funùiÚ
 
	$g‘_accouÁ_šfo
(
$accouÁ_id
){

238 
$£Ëù
 = 
	`¬¿y
(

245 
$cÚd™iÚ
 = 
	`¬¿y
(

246 'Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

247 "accouÁ_id" => 
$accouÁ_id


249 
$qu”y
 = 
$this
->
db
 -> 
	`£Ëù
(
$£Ëù
)->
	`wh”e
(
$cÚd™iÚ
)->
	`g‘
("tc_accouÁ")->
	`»suÉ_¬¿y
();

250  
$qu”y
[0];

251 
	}
}

258 
public
 
funùiÚ
 
	$»checkšg_id
(
$busšess_id
){

259 
$cÚd™iÚ
 = 
	`¬¿y
(

260 'Üg_id' => 
$this
->
£ssiÚ
->
	`u£rd©a
('org_id'),

261 "acù_ch¬01" => 
$busšess_id


263 
$»s
 = 
$this
->
db
 ->
	`wh”e
(
$cÚd™iÚ
)->
	`couÁ_®l_»suÉs
("tc_account");

264  
$»s
;

266 
	}
}

272 
public
 
funùiÚ
 
	$upd©e_accouÁ_busšess_ty³
(
$d©a
){

273  
$this
 -> 
objeùs
 -> 
	`š™
(
$d©a
);

274 
	}
}

278 
public
 
funùiÚ
 
	$İpÜtun™y_§ve
(
$d©a
){

279  
$this
 -> 
	`İpÜtun™y_pha£_§ve
(
$d©a
);

280 
	}
}

282 
´iv©e
 
funùiÚ
 
	$İpÜtun™y_pha£_§ve
(
$d©a
){

283  
$this
 -> 
objeùs
 -> 
	`š™
(
$d©a
);

284 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/platform_model.php

1 <?
php


14 şas 
	cPÏtfÜm_mod–
 
ex‹nds
 
	mCI_Mod–
 {

16 
´iv©e
 
	m$pÜlDB
;

17 
´iv©e
 
	m$bË
 = "tc_platform";

18 
´iv©e
 
	m$mod–Requœed
 = 
TRUE
;

20 
funùiÚ
 
	$__cÚ¡ruù
(){

21 
·»Á
::
	`__cÚ¡ruù
();

22 
$this
->
pÜlDB
 = $this->
lßd
->
	`d©aba£
('pÜl', 
TRUE
);

31 
´iv©e
 
funùiÚ
 
	$g‘F›ldsName
(){

32  
	`¬¿y
(

39 
	}
}

41 
´iv©e
 
funùiÚ
 
	$š™RuË
(
$d©a
){

42 
$mod–R‘
 = 
	`mod–Requœed
(
£lf
::
mod–Requœed
, s–f::
	`g‘F›ldsName
(), 
$d©a
);

43  
$mod–R‘
['succ'];

44 
	}
}

52 
public
 
funùiÚ
 
	$g‘PÏtfÜmD©a
(
$¶©fÜmID
){

53 
$sql
 = "select * fromc_platform where…latform_id = ?";

54  
$this
->
pÜlDB
->
	`qu”y
(
$sql
, 
	`¬¿y
(
$¶©fÜmID
))->
	`»suÉ_¬¿y
();

55 
	}
}

63 
public
 
funùiÚ
 
	$qu”yAÎPÏtfÜmD©a
(){

64 
$sql
 = "select * fromc_platform";

65  
$this
->
pÜlDB
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

66 
	}
}

76 
public
 
funùiÚ
 
upd©ePÏtfÜm
(
$¶©fÜmID
, 
$¶©fÜmD©a
 = 
	$¬¿y
()){

77 
$¡rS‘
 = 
	`¬¿y
();

78 if(
	`em±y
(
$¶©fÜmD©a
))

79  
FALSE
;

80 
$ruË
 = 
£lf
::
	`š™RuË
(
$¶©fÜmD©a
);

81 if(
FALSE
 ==ğ
$ruË
){

82  
FALSE
;

84 
	`fÜ—ch
(
$¶©fÜmD©a
 
as
 
$¶©fÜmKey
 => 
$¶©fÜmV®ue
){

85 
$¡rS‘
[] = " {$platformKey} = {$platformValue} ";

87 
$¶©fÜmSql
 = " updatec_platform set ";

88 
$¶©fÜmSql
 .ğ
	`im¶ode
(",", 
$¡rS‘
);

89 
$¶©fÜmSql
 .= " where…latform_id = {$platformID}";

90  
$this
->
pÜlDB
->
	`qu”y
(
$¶©fÜmSql
);

91 
	}
}

100 
public
 
funùiÚ
 
	$addPÏtfÜm
(
$¶©fÜmD©a
){

101 if(
	`em±y
(
$¶©fÜmD©a
))

102  
çl£
;

103 
$ruË
 = 
£lf
::
	`š™RuË
(
$¶©fÜmD©a
);

104 if(
FALSE
 ==ğ
$ruË
){

105  
FALSE
;

107 
$f›ldsKeys
 = 
	`im¶ode
(",", 
	`¬¿y_keys
(
$¶©fÜmD©a
));

108 
$f›ldsV®ues
 = 
	`im¶ode
(",", 
	`¬¿y_v®ues
(
$¶©fÜmD©a
));

109 
$¶©fÜmSql
 = " insert intoc_platform ({$fieldsKeys}) values({$fieldsValues})";

110  
FALSE
 ==ğ
$this
->
pÜlDB
->
	`qu”y
(
$¶©fÜmSql
è? FALSE : $this->pÜlDB->
	`š£¹_id
();

111 
	}
}

120 
public
 
funùiÚ
 
	$d–PÏtfÜm
(
$¶©fÜmID
){

121 
$¶©fÜmSql
 = " delete fromc_platform where…latform_id = ? ";

122  
$this
->
pÜlDB
->
	`qu”y
(
$¶©fÜmSql
, 
	`¬¿y
(
$¶©fÜmID
));

123 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/relobjectprofile_model.php

1 <?
php


2 şas 
	cR–objeù´ofe_mod–
 
ex‹nds
 
	mCI_Mod–
 {

5 
´iv©e
 
	m$RefU¾
 = "";

6 
funùiÚ
 
	$__cÚ¡ruù
() {

7 
·»Á
::
	`__cÚ¡ruù
();

8 
$this
->
lßd
->
	`mod–
('www/user_model','user');

9 
$this
->
RefU¾
 = $this->
cÚfig
->
	`ba£_u¾
(è. $this->cÚfig->
	`™em
(@
šdex_·ge
) . "/www/objects/ajax_lists?obj_type=";

15 
public
 
funùiÚ
 
	$R–ObjeùProfe_1
(){

16 
$¬r
 = 
	`¬¿y
(

17 26=>
	`¬¿y
(

18 '·¹ÃrcÚŒaù.AccouÁ' => 
	`¬¿y
(),

19 '¹jl.AccouÁ' => 
	`¬¿y
(),

20 'REL_USER' => 
	`¬¿y
(

22 'bu‰Ús' => 
	`¬¿y
(

23 0 => 
	`¬¿y
(

25 'u¾' => 
$this
->
RefU¾
 . 99,

26 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=99&is_self=1'

28 1 => 
	`¬¿y
(

30 'u¾' => 
$this
->
RefU¾
 . 99,

31 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=99&is_self=0'

35 'REL_ACCOUNT_SURVEY_ANSWER' => 
	`¬¿y
(),

36 'REL_ACCOUNTFORCEREL' => 
	`¬¿y
(

53 'REL_ACCOUNT_REL' => 
	`¬¿y
(

55 'bu‰Ús' => 
	`¬¿y
(

56 0 => 
	`¬¿y
(

58 'u¾' => 
$this
->
RefU¾
 . 1,

59 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=1'

63 'REL_ACCOUNT_SUBORDINATE' => 
	`¬¿y
(),

64 'REL_WORKSHEET' => 
	`¬¿y
(),

65 'REL_ACTIVITIES' => 
	`¬¿y
(

67 'bu‰Ús' => 
	`¬¿y
(

68 0 => 
	`¬¿y
(

70 'sub' => 
$this
->
	`subbut
(1,1,14,26)

74 'REL_ASSET' => 
	`¬¿y
(),

75 'REL_ATTACH' => 
	`¬¿y
(),

76 'REL_CAMPAIGN' => 
	`¬¿y
(),

77 'REL_CMPTCNTRT' => 
	`¬¿y
(),

78 'REL_COMMENT' => 
	`¬¿y
(),

79 'REL_COMPETITOR' => 
	`¬¿y
(),

80 'REL_CONTACT' => 
	`¬¿y
(

82 'bu‰Ús' => 
	`¬¿y
(

83 0 => 
	`¬¿y
(

85 'sub' => 
$this
->
	`subbut
(1,1,2,26)

89 'REL_CONTRACT' => 
	`¬¿y
(),

90 'REL_DELIVER' => 
	`¬¿y
(),

91 'REL_DSS_UPDATE_HISTORY' => 
	`¬¿y
(),

92 'REL_EMAIL_ITEM' => 
	`¬¿y
(),

93 'REL_HISTORY' => 
	`¬¿y
(),

94 'REL_INVOICE' => 
	`¬¿y
(),

95 'REL_LEAD' => 
	`¬¿y
(),

96 'REL_OPPORTUNITY' => 
	`¬¿y
(

98 'bu‰Ús' => 
	`¬¿y
(

99 0 => 
	`¬¿y
(

101 'sub' => 
$this
->
	`subbut
(1,1,4,26)

105 'REL_PRIVILEGE' => 
	`¬¿y
(

107 'bu‰Ús' => 
	`¬¿y
(

108 0 => 
	`¬¿y
(

110 'u¾' => 
$this
->
RefU¾
 . 95,

111 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=95'

115 'REL_QUOTE' => 
	`¬¿y
(),

116 'REL_RECEIPT' => 
	`¬¿y
(),

117 'REL_RESOURCE_ALLOCATE' => 
	`¬¿y
(),

118 'REL_SCOREDETAIL' => 
	`¬¿y
(),

119 'REL_SERVICE_PLAN' => 
	`¬¿y
(),

120 'REL_SERVICE_REQUEST' => 
	`¬¿y
(),

121 'REL_SMS_ITEM' => 
	`¬¿y
(),

123 90 => 
	`¬¿y
(

124 'REL_EMAIL_ITEM' => 
	`¬¿y
(),

125 'REL_HISTORY' => 
	`¬¿y
(),

126 'REL_SCOREDETAIL' => 
	`¬¿y
(),

127 'REL_SERVICE_PLAN' => 
	`¬¿y
(),

128 'REL_SERVICE_REQUEST' => 
	`¬¿y
(),

129 '·¹ÃrcÚŒaù.AccouÁ' => 
	`¬¿y
(),

130 '¹jl.AccouÁ' => 
	`¬¿y
(),

131 'REL_ACCOUNTFORCEREL' => 
	`¬¿y
(

148 'REL_ACCOUNT_REL' => 
	`¬¿y
(

150 'bu‰Ús' => 
	`¬¿y
(

151 0 => 
	`¬¿y
(

153 'u¾' => 
$this
->
RefU¾
 . 1,

154 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=1'

158 'REL_ACCOUNT_SUBORDINATE' => 
	`¬¿y
(),

159 'REL_ACCOUNT_SURVEY_ANSWER' => 
	`¬¿y
(),

160 'REL_INVOICE' => 
	`¬¿y
(),

161 'REL_LEAD' => 
	`¬¿y
(),

162 'REL_OPPORTUNITY' => 
	`¬¿y
(

164 'bu‰Ús' => 
	`¬¿y
(

165 0 => 
	`¬¿y
(

167 'sub' => 
$this
->
	`subbut
(1,1,4,90)

171 'REL_PRIVILEGE' => 
	`¬¿y
(

173 'bu‰Ús' => 
	`¬¿y
(

174 0 => 
	`¬¿y
(

176 'u¾' => 
$this
->
RefU¾
 . 95,

177 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=95'

181 'REL_QUOTE' => 
	`¬¿y
(),

182 'REL_RECEIPT' => 
	`¬¿y
(),

183 'REL_RESOURCE_ALLOCATE' => 
	`¬¿y
(),

184 'REL_ACTIVITIES' => 
	`¬¿y
(

186 'bu‰Ús' => 
	`¬¿y
(

187 0 => 
	`¬¿y
(

189 'sub' => 
$this
->
	`subbut
(1,1,14,90)

193 'REL_ASSET' => 
	`¬¿y
(),

194 'REL_ATTACH' => 
	`¬¿y
(),

195 'REL_CAMPAIGN' => 
	`¬¿y
(),

196 'REL_CMPTCNTRT' => 
	`¬¿y
(),

197 'REL_COMMENT' => 
	`¬¿y
(),

198 'REL_COMPETITOR' => 
	`¬¿y
(),

199 'REL_CONTACT' => 
	`¬¿y
(

201 'bu‰Ús' => 
	`¬¿y
(

202 0 => 
	`¬¿y
(

204 'sub' => 
$this
->
	`subbut
(1,1,2,90)

208 'REL_CONTRACT' => 
	`¬¿y
(),

209 'REL_DELIVER' => 
	`¬¿y
(),

210 'REL_DSS_UPDATE_HISTORY' => 
	`¬¿y
(),

211 'REL_SMS_ITEM' => 
	`¬¿y
(),

212 'REL_USER' => 
	`¬¿y
(

214 'bu‰Ús' => 
	`¬¿y
(

215 0 => 
	`¬¿y
(

217 'u¾' => 
$this
->
RefU¾
 . 99,

218 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=99&is_self=1'

220 1 => 
	`¬¿y
(

222 'u¾' => 
$this
->
RefU¾
 . 99,

223 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=99&is_self=0'

227 'REL_WORKSHEET' => 
	`¬¿y
(),

228 'REL_CONTRACTITEM' => 
	`¬¿y
(),

229 'REL_OPPORTUNITYITEM' => 
	`¬¿y
(),

230 'REL_WORKSHEETITEM' => 
	`¬¿y
(),

231 'ag»em’tI‹m.accouÁ' => 
	`¬¿y
(),

232 '·¹ÃrcÚŒaù.·¹Ãr' => 
	`¬¿y
()

235 2057=>
	`¬¿y
(

236 'REL_ACCOUNT_REL' => 
	`¬¿y
(

238 'bu‰Ús' => 
	`¬¿y
(

239 0 => 
	`¬¿y
(

241 'u¾' => 
$this
->
RefU¾
 . 1,

242 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=1'

246 'REL_ACCOUNT_SUBORDINATE' => 
	`¬¿y
(),

247 'REL_ACCOUNT_SURVEY_ANSWER' => 
	`¬¿y
(),

248 'REL_ASSET' => 
	`¬¿y
(),

249 'REL_ATTACH' => 
	`¬¿y
(),

250 'REL_CAMPAIGN' => 
	`¬¿y
(),

251 'REL_CMPTCNTRT' => 
	`¬¿y
(),

252 'REL_COMMENT' => 
	`¬¿y
(),

253 'REL_COMPETITOR' => 
	`¬¿y
(),

254 'REL_CONTACT' => 
	`¬¿y
(

256 'bu‰Ús' => 
	`¬¿y
(

257 0 => 
	`¬¿y
(

259 'sub' => 
$this
->
	`subbut
(1,1,2,2057)

263 'REL_CONTRACT' => 
	`¬¿y
(),

264 'REL_EMAIL_ITEM' => 
	`¬¿y
(),

265 'REL_HISTORY' => 
	`¬¿y
(),

266 'REL_INVOICE' => 
	`¬¿y
(),

267 'REL_LEAD' => 
	`¬¿y
(),

268 'REL_OPPORTUNITY' => 
	`¬¿y
(

270 'bu‰Ús' => 
	`¬¿y
(

271 0 => 
	`¬¿y
(

273 'sub' => 
$this
->
	`subbut
(1,1,4,2057)

277 'REL_QUOTE' => 
	`¬¿y
(),

278 'REL_RESOURCE_ALLOCATE' => 
	`¬¿y
(),

279 'REL_SERVICE_PLAN' => 
	`¬¿y
(),

280 'REL_SERVICE_REQUEST' => 
	`¬¿y
(),

281 'REL_SMS_ITEM' => 
	`¬¿y
(),

282 'REL_USER' => 
	`¬¿y
(

284 'bu‰Ús' => 
	`¬¿y
(

285 0 => 
	`¬¿y
(

287 'u¾' => 
$this
->
RefU¾
 . 99,

288 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=99&is_self=1'

290 1 => 
	`¬¿y
(

292 'u¾' => 
$this
->
RefU¾
 . 99,

293 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=99&is_self=0'

297 'REL_WORKSHEET' => 
	`¬¿y
(),

298 'REL_ACCOUNTFORCEREL' => 
	`¬¿y
(

315 'REL_ACTIVITIES' => 
	`¬¿y
(

317 'bu‰Ús' => 
	`¬¿y
(

318 0 => 
	`¬¿y
(

320 'sub' => 
$this
->
	`subbut
(1,1,14,2057)

324 'REL_DSS_UPDATE_HISTORY' => 
	`¬¿y
(),

325 'REL_SCOREDETAIL' => 
	`¬¿y
(),

326 'REL_PRIVILEGE' => 
	`¬¿y
(

328 'bu‰Ús' => 
	`¬¿y
(

329 0 => 
	`¬¿y
(

331 'u¾' => 
$this
->
RefU¾
 . 95,

332 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=1&rel_obj_type=95'

336 'REL_DELIVER' => 
	`¬¿y
(),

337 'REL_RECEIPT' => 
	`¬¿y
(),

338 '¹jl.AccouÁ' => 
	`¬¿y
(),

339 '·¹ÃrcÚŒaù.AccouÁ' => 
	`¬¿y
(),

340 '·¹ÃrcÚŒaù.·¹Ãr' => 
	`¬¿y
()

343  
$¬r
;

345 
	}
}

348 
public
 
funùiÚ
 
	$R–ObjeùProfe_2
(){

349 
$¬r
 = 
	`¬¿y
(

350 88=>
	`¬¿y
(

351 'REL_CONTACTFORCEREL' => 
	`¬¿y
(

368 'REL_CONTACT_SURVEY_ANSWER' => 
	`¬¿y
(),

369 'REL_DSS_UPDATE_HISTORY' => 
	`¬¿y
(),

370 'REL_EMAIL_ITEM' => 
	`¬¿y
(),

371 'REL_HISTORY' => 
	`¬¿y
(),

372 'REL_LEAD' => 
	`¬¿y
(),

373 'REL_PRIVILEGE' => 
	`¬¿y
(

375 'bu‰Ús' => 
	`¬¿y
(

376 0 => 
	`¬¿y
(

378 'u¾' => 
$this
->
RefU¾
 . 95,

379 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=2&rel_obj_type=95'

383 'REL_RESOURCE_ALLOCATE' => 
	`¬¿y
(),

384 'REL_SERVICE_PLAN' => 
	`¬¿y
(),

385 'REL_SERVICE_REQUEST' => 
	`¬¿y
(),

386 'REL_SMS_ITEM' => 
	`¬¿y
(),

387 'REL_USER' => 
	`¬¿y
(

389 'bu‰Ús' => 
	`¬¿y
(

390 0 => 
	`¬¿y
(

392 'u¾' => 
$this
->
RefU¾
 . 99,

393 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=2&rel_obj_type=99&is_self=1'

395 1 => 
	`¬¿y
(

397 'u¾' => 
$this
->
RefU¾
 . 99,

398 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=2&rel_obj_type=99&is_self=0'

402 'REL_WORKSHEET' => 
	`¬¿y
(

411 '¹jl.CÚù' => 
	`¬¿y
(),

412 'REL_ACCOUNT_CONTACT' => 
	`¬¿y
(),

413 'REL_ACTIVITIES' => 
	`¬¿y
(

415 'bu‰Ús' => 
	`¬¿y
(

416 0 => 
	`¬¿y
(

418 'sub' => 
$this
->
	`subbut
(1,2,14,88)

422 'REL_ATTACH' => 
	`¬¿y
(),

423 'REL_CAMPAIGN' => 
	`¬¿y
(),

424 'REL_COMMENT' => 
	`¬¿y
()

427  
$¬r
;

428 
	}
}

431 
public
 
funùiÚ
 
	$R–ObjeùProfe_3
(){

432 
$¬r
 = 
	`¬¿y
(

433 0=>
	`¬¿y
(

434 'REL_DSS_UPDATE_HISTORY' =>
	`¬¿y
(),

435 'REL_USER' =>
	`¬¿y
(

437 'bu‰Ús' => 
	`¬¿y
(

438 0 => 
	`¬¿y
(

440 'u¾' => 
$this
->
RefU¾
 . 99,

441 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=3&rel_obj_type=99&is_self=1'

443 1 => 
	`¬¿y
(

445 'u¾' => 
$this
->
RefU¾
 . 99,

446 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=3&rel_obj_type=99&is_self=0'

450 'REL_PRIVILEGE' =>
	`¬¿y
(

452 'bu‰Ús' => 
	`¬¿y
(

453 0 => 
	`¬¿y
(

455 'u¾' => 
$this
->
RefU¾
 . 95,

456 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=3&rel_obj_type=95'

460 'REL_RESOURCE_ALLOCATE' =>
	`¬¿y
(),

461 'REL_SMS_ITEM' =>
	`¬¿y
(),

462 'REL_ACCOUNT_CONVERSION' =>
	`¬¿y
(),

463 'REL_ACTIVITIES' =>
	`¬¿y
(

465 'bu‰Ús' => 
	`¬¿y
(

466 0 => 
	`¬¿y
(

468 'sub' => 
$this
->
	`subbut
(1,3,14,91)

473 'REL_ATTACH' =>
	`¬¿y
(),

474 'REL_COMMENT' =>
	`¬¿y
(),

475 'REL_CONTACT_CONVERSION' =>
	`¬¿y
(),

476 'REL_EMAIL_ITEM' =>
	`¬¿y
(),

477 'REL_HISTORY' =>
	`¬¿y
(),

478 'REL_LEAD_SURVEY_ANSWER' =>
	`¬¿y
(),

479 'REL_OPPORTUNITY_CONVERSION' =>
	`¬¿y
(),

480 'OµÜtun™y.SourûL—d' =>
	`¬¿y
(),

483  
$¬r
;

484 
	}
}

486 
public
 
funùiÚ
 
	$R–ObjeùProfe_4
(){

487 
$¬r
 = 
	`¬¿y
(

488 0=>
	`¬¿y
(

489 'REL_AUDITLOG' =>
	`¬¿y
(),

490 'REL_CONTACTOPPREL' =>
	`¬¿y
(

499 'REL_SOLUTION' =>
	`¬¿y
(),

500 'REL_USER' =>
	`¬¿y
(

502 'bu‰Ús' => 
	`¬¿y
(

503 0 => 
	`¬¿y
(

505 'u¾' => 
$this
->
RefU¾
 . 99,

506 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=99&is_self=1'

508 1 => 
	`¬¿y
(

510 'u¾' => 
$this
->
RefU¾
 . 99,

511 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=99&is_self=0'

515 'REL_PRIVILEGE' =>
	`¬¿y
(

517 'bu‰Ús' => 
	`¬¿y
(

518 0 => 
	`¬¿y
(

520 'u¾' => 
$this
->
RefU¾
 . 95,

521 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=95'

525 'REL_ACTIVITIES' =>
	`¬¿y
(

527 'bu‰Ús' => 
	`¬¿y
(

528 0 => 
	`¬¿y
(

530 'sub' => 
$this
->
	`subbut
(1,4,14,0)

535 'REL_ATTACH' =>
	`¬¿y
(),

536 'REL_CMPT_CNTRT' =>
	`¬¿y
(),

537 'REL_CMPT_PROD' =>
	`¬¿y
(),

538 'REL_COMMENT' =>
	`¬¿y
(),

539 'REL_COMPETITOR' =>
	`¬¿y
(),

540 'REL_CONTACT' =>
	`¬¿y
(

542 'bu‰Ús' => 
	`¬¿y
(

543 0 => 
	`¬¿y
(

545 'u¾' => 
$this
->
RefU¾
 . 2,

546 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=2'

550 'REL_CONTRACT' =>
	`¬¿y
(),

551 'REL_EVENT_CONFIG' =>
	`¬¿y
(

560 'REL_HISTORY' =>
	`¬¿y
(),

561 'REL_OBJECT_ROLE' =>
	`¬¿y
(),

562 'REL_OPPORTUNITY_ITEMS' =>
	`¬¿y
(),

563 'REL_OPPORTUNITY_ITEMS_SPLIT' =>
	`¬¿y
(),

564 'REL_OPPORTUNITY_STAGE' =>
	`¬¿y
(

573 'REL_OPPORTUNITY_STAGE_PATH' =>
	`¬¿y
(),

574 'REL_QUOTE' =>
	`¬¿y
(),

575 'REL_RESOURCE_ALLOCATE' =>
	`¬¿y
(),

577 2=>
	`¬¿y
(

578 'REL_USER' =>
	`¬¿y
(

580 'bu‰Ús' => 
	`¬¿y
(

581 0 => 
	`¬¿y
(

583 'u¾' => 
$this
->
RefU¾
 . 99,

584 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=99&is_self=1'

586 1 => 
	`¬¿y
(

588 'u¾' => 
$this
->
RefU¾
 . 99,

589 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=99&is_self=0'

593 'REL_ACTIVITIES' =>
	`¬¿y
(

595 'bu‰Ús' => 
	`¬¿y
(

596 0 => 
	`¬¿y
(

598 'sub' => 
$this
->
	`subbut
(1,4,14,2056)

603 'REL_ATTACH' =>
	`¬¿y
(),

604 'REL_AUDITLOG' =>
	`¬¿y
(),

605 'REL_CMPT_CNTRT' =>
	`¬¿y
(),

606 'REL_CMPT_PROD' =>
	`¬¿y
(),

607 'REL_COMMENT' =>
	`¬¿y
(),

608 'REL_COMPETITOR' =>
	`¬¿y
(),

609 'REL_CONTACT' =>
	`¬¿y
(

611 'bu‰Ús' => 
	`¬¿y
(

612 0 => 
	`¬¿y
(

614 'u¾' => 
$this
->
RefU¾
 . 2,

615 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=2'

619 'REL_CONTACTOPPREL' =>
	`¬¿y
(

628 'REL_CONTRACT' =>
	`¬¿y
(),

629 'REL_EVENT_CONFIG' =>
	`¬¿y
(

638 'REL_HISTORY' =>
	`¬¿y
(),

639 'REL_OBJECT_ROLE' =>
	`¬¿y
(),

640 'REL_OPPORTUNITY_ITEMS' =>
	`¬¿y
(),

641 'REL_OPPORTUNITY_ITEMS_SPLIT' =>
	`¬¿y
(),

642 'REL_OPPORTUNITY_STAGE' =>
	`¬¿y
(

651 'REL_OPPORTUNITY_STAGE_PATH' =>
	`¬¿y
(),

652 'REL_PRIVILEGE' =>
	`¬¿y
(

654 'bu‰Ús' => 
	`¬¿y
(

655 0 => 
	`¬¿y
(

657 'u¾' => 
$this
->
RefU¾
 . 95,

658 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=95'

662 'REL_QUOTE' =>
	`¬¿y
(),

663 'REL_RESOURCE_ALLOCATE' =>
	`¬¿y
(),

664 'REL_SOLUTION' =>
	`¬¿y
(),

666 2056=>
	`¬¿y
(

667 'REL_USER' =>
	`¬¿y
(

669 'bu‰Ús' => 
	`¬¿y
(

670 0 => 
	`¬¿y
(

672 'u¾' => 
$this
->
RefU¾
 . 99,

673 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=99&is_self=1'

675 1 => 
	`¬¿y
(

677 'u¾' => 
$this
->
RefU¾
 . 99,

678 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=99&is_self=0'

682 'REL_ACTIVITIES' =>
	`¬¿y
(

684 'bu‰Ús' => 
	`¬¿y
(

685 0 => 
	`¬¿y
(

687 'sub' => 
$this
->
	`subbut
(1,4,14,2056)

692 'REL_ATTACH' =>
	`¬¿y
(),

693 'REL_AUDITLOG' =>
	`¬¿y
(),

694 'REL_CMPT_CNTRT' =>
	`¬¿y
(),

695 'REL_CMPT_PROD' =>
	`¬¿y
(),

696 'REL_COMMENT' =>
	`¬¿y
(),

697 'REL_COMPETITOR' =>
	`¬¿y
(),

698 'REL_CONTACT' =>
	`¬¿y
(

700 'bu‰Ús' => 
	`¬¿y
(

701 0 => 
	`¬¿y
(

703 'u¾' => 
$this
->
RefU¾
 . 2,

704 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=2'

708 'REL_CONTACTOPPREL' =>
	`¬¿y
(

717 'REL_CONTRACT' =>
	`¬¿y
(),

718 'REL_EVENT_CONFIG' =>
	`¬¿y
(

727 'REL_HISTORY' =>
	`¬¿y
(),

728 'REL_OBJECT_ROLE' =>
	`¬¿y
(),

729 'REL_OPPORTUNITY_ITEMS' =>
	`¬¿y
(),

730 'REL_OPPORTUNITY_ITEMS_SPLIT' =>
	`¬¿y
(),

731 'REL_OPPORTUNITY_STAGE' =>
	`¬¿y
(

740 'REL_OPPORTUNITY_STAGE_PATH' =>
	`¬¿y
(),

741 'REL_PRIVILEGE' =>
	`¬¿y
(

743 'bu‰Ús' => 
	`¬¿y
(

744 0 => 
	`¬¿y
(

746 'u¾' => 
$this
->
RefU¾
 . 95,

747 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=4&rel_obj_type=95'

751 'REL_QUOTE' =>
	`¬¿y
(),

752 'REL_RESOURCE_ALLOCATE' =>
	`¬¿y
(),

753 'REL_SOLUTION' =>
	`¬¿y
(),

756  
$¬r
;

757 
	}
}

759 
public
 
funùiÚ
 
	$R–ObjeùProfe_6
(){

760 
$¬r
 = 
	`¬¿y
(

761 0=>
	`¬¿y
(

762 'REL_AUDITLOG' =>
	`¬¿y
(),

763 'REL_INVOICE' =>
	`¬¿y
(

772 'REL_DELIVER' =>
	`¬¿y
(

781 'REL_RECEIPT' =>
	`¬¿y
(

790 'REL_PRIVILEGE' =>
	`¬¿y
(

792 'bu‰Ús' => 
	`¬¿y
(

793 0 => 
	`¬¿y
(

795 'u¾' => 
$this
->
RefU¾
 . 95,

796 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=6&rel_obj_type=95'

800 'REL_SOLUTION' =>
	`¬¿y
(),

801 'REL_OBJECT_ROLE' =>
	`¬¿y
(),

802 'REL_RESOURCE_ALLOCATE' =>
	`¬¿y
(),

803 'REL_SERVICE_PLAN' =>
	`¬¿y
(),

804 'REL_STAGE' =>
	`¬¿y
(

813 'REL_STAGE_PATH' =>
	`¬¿y
(),

814 'REL_USER' =>
	`¬¿y
(

816 'bu‰Ús' => 
	`¬¿y
(

817 0 => 
	`¬¿y
(

819 'u¾' => 
$this
->
RefU¾
 . 99,

820 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=6&rel_obj_type=99&is_self=1'

822 1 => 
	`¬¿y
(

824 'u¾' => 
$this
->
RefU¾
 . 99,

825 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=6&rel_obj_type=99&is_self=0'

829 'REL_ACTIVITIES' =>
	`¬¿y
(

831 'bu‰Ús' => 
	`¬¿y
(

832 0 => 
	`¬¿y
(

834 'sub' => 
$this
->
»l
->
	`subbut
(1,6,14,0)

838 'REL_ATTACH' =>
	`¬¿y
(),

839 'REL_COMMENT' =>
	`¬¿y
(),

840 'REL_CONTACT' =>
	`¬¿y
(),

841 'REL_CONTRACT_ITEMS' =>
	`¬¿y
(),

842 'REL_CONTRACT_ITEMS_SPLIT' =>
	`¬¿y
(),

843 'REL_EVENT_CONFIG' =>
	`¬¿y
(

852 'REL_HISTORY' =>
	`¬¿y
()

854 40=>
	`¬¿y
(

855 'REL_ACTIVITIES' =>
	`¬¿y
(

857 'bu‰Ús' => 
	`¬¿y
(

858 0 => 
	`¬¿y
(

860 'sub' => 
$this
->
	`subbut
(1,6,14,40)

864 'REL_ATTACH' =>
	`¬¿y
(),

865 'REL_AUDITLOG' =>
	`¬¿y
(),

866 'REL_COMMENT' =>
	`¬¿y
(),

867 'REL_CONTACT' =>
	`¬¿y
(),

868 'REL_CONTRACT_ITEMS' =>
	`¬¿y
(),

869 'REL_CONTRACT_ITEMS_SPLIT' =>
	`¬¿y
(),

870 'REL_DELIVER' =>
	`¬¿y
(

879 'REL_EVENT_CONFIG' =>
	`¬¿y
(

888 'REL_HISTORY' =>
	`¬¿y
(),

889 'REL_INVOICE' =>
	`¬¿y
(

898 'REL_OBJECT_ROLE' =>
	`¬¿y
(),

899 'REL_PRIVILEGE' =>
	`¬¿y
(

901 'bu‰Ús' => 
	`¬¿y
(

902 0 => 
	`¬¿y
(

904 'u¾' => 
$this
->
RefU¾
 . 95,

905 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=6&rel_obj_type=95'

909 'REL_RECEIPT' =>
	`¬¿y
(

918 'REL_RESOURCE_ALLOCATE' =>
	`¬¿y
(),

919 'REL_SERVICE_PLAN' =>
	`¬¿y
(),

920 'REL_SOLUTION' =>
	`¬¿y
(),

921 'REL_STAGE' =>
	`¬¿y
(

930 'REL_STAGE_PATH' =>
	`¬¿y
(),

931 'REL_USER' =>
	`¬¿y
(

933 'bu‰Ús' => 
	`¬¿y
(

934 0 => 
	`¬¿y
(

936 'u¾' => 
$this
->
RefU¾
 . 99,

937 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=6&rel_obj_type=99&is_self=1'

939 1 => 
	`¬¿y
(

941 'u¾' => 
$this
->
RefU¾
 . 99,

942 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=6&rel_obj_type=99&is_self=0'

949  
$¬r
;

950 
	}
}

952 
public
 
funùiÚ
 
	$R–ObjeùProfe
(){

953 
$¬r
 = 
	`¬¿y
(

954 0=>
	`¬¿y
(

955 'REL_USER' =>
	`¬¿y
(

957 'bu‰Ús' => 
	`¬¿y
(

958 0 => 
	`¬¿y
(

960 'u¾' => 
$this
->
RefU¾
 . 99,

961 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=<?phpƒcho $v[\'OBJ_TYPE\'];?>&rel_obj_type=99&is_self=1'

963 1 => 
	`¬¿y
(

965 'u¾' => 
$this
->
RefU¾
 . 99,

966 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=<?phpƒcho $v[\'OBJ_TYPE\'];?>&rel_obj_type=99&is_self=0'

970 'REL_ACTIVITIES' =>
	`¬¿y
(

972 'bu‰Ús' => 
	`¬¿y
(

973 0 => 
	`¬¿y
(

975 'sub' => 
$this
->
	`subbut
(1,0,14,0)

979 'REL_PRIVILEGE' =>
	`¬¿y
(

981 'bu‰Ús' => 
	`¬¿y
(

982 0 => 
	`¬¿y
(

984 'u¾' => 
$this
->
RefU¾
 . 95,

985 '§ve_u¾' => 
	`ba£_u¾
().'index.php/www/objects/relsave?obj_type=<?phpƒcho $v[\'OBJ_TYPE\'];?>&rel_obj_type=95'

991 
	}
}

992 
public
 
funùiÚ
 
	$subbut
(
$Üg_id
=1,
$obj_ty³
,
$»l_obj_ty³
,
$ty³_id
){

993 
$d©a
 = 
$this
->
	`subbu‰Ú
(
$Üg_id
,
$obj_ty³
,
$»l_obj_ty³
,
$ty³_id
);

994 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

995 
$¬r
[
$v
['TYPE_ID']]['name'] = $v['TYPE_NAME'];

996 
$¬r
[
$v
['TYPE_ID']]['u¾'] = 
	`ba£_u¾
().'šdex.php/www/objeùs/addout?obj_ty³='.
$»l_obj_ty³
.'&type_id='.$v['TYPE_ID'];

998  
$¬r
;

999 
	}
}

1001 
public
 
funùiÚ
 
	$subbu‰Ú
(
$Üg_id
,
$obj_ty³
,
$»l_obj_ty³
,
$ty³_id
){

1002 
$this
->
db
->
	`äom
('rel_object_task_type');

1003 
$this
->
db
->
	`£Ëù
('task_type');

1004 
$this
->
db
->
	`wh”e
('obj_ty³',
$obj_ty³
);

1005 
$wh”e_š
 = 
	`¬¿y
(
$ty³_id
,'0');

1006 
$this
->
db
->
	`wh”e_š
('ty³_id',
$wh”e_š
);

1007 
$bªÃd
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

1009 if(!
	`em±y
(
$bªÃd
)){

1010 
	`fÜ—ch
 (
$bªÃd
 
as
 
$k
 => 
$v
) {

1011 
$bª
[] =
$v
['TASK_TYPE'];

1017 
$this
->
db
->
	`£Ëù
('type_name,type_id');

1018 
$this
->
db
->
	`äom
('tc_type');

1019 
$wh”e
 = 
	`¬¿y
(

1020 'Üg_id' => 
$Üg_id
,

1021 'obj_ty³' => 
$»l_obj_ty³


1023 
$this
->
db
->
	`wh”e
(
$wh”e
);

1024 if(
	`is£t
(
$bª
)){

1025 
$this
->
db
->
	`wh”e_nÙ_š
('ty³_id',
$bª
);

1027  
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

1028 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/relprivilege_model.php

1 <?
php


9 şas 
	cR–´ivege_mod–
 
ex‹nds
 
	mCI_Mod–
 {

11 
funùiÚ
 
	$__cÚ¡ruù
() {

12 
·»Á
::
	`__cÚ¡ruù
();

15 
public
 
funùiÚ
 
	$·g”_šfo_li¡
(
$d©a
, 
$u£r_id
, 
$Üg_id
, 
$Cu¼’tPage
, 
$PageSize
) {

17 
$sql
 = "select * fromc_user where user_id = $user_id‡nd org_id = $org_id";

18 
$row_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

19 
$row_d©a
 = $row_data[0];

20 
$DEPT_ID
 = 
$row_d©a
['DEPT_ID'];

22 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$d©a
['obj_type']);

23 
$obj_Çme
 = 
$obj
['OBJ_NAME'];

24 
$key_©Œ_æd
 = 
$obj
['KEY_ATTR_FLD'];

25 
$wh”e
[
$key_©Œ_æd
] = 
$d©a
['id'];

26 
$tbl_ûÁ”
 = 
	`¡¹Şow”
(
$obj_Çme
);

27 
$u£r_tbl
 = "»l_" . 
$tbl_ûÁ”
 . "_privilege A";

28 
$æd_d©a
 = "dept_id,dept_name";

29 
$w
 = 
	`¬¿y
();

30 
$w
["B.DEPT_ID"] = 
$DEPT_ID
;

31 
$this
->
db
->
	`£Ëù
(
$æd_d©a
);

32 
$this
->
db
->
	`äom
("$user_tbl");

33 
$this
->
db
->
	`još
("tc_department B", "A.PRIVILEGE_ID = B.DEPT_ID", "inner");

34 
	`fÜ—ch
 (
$wh”e
 
as
 
$key
 => 
$v®ue
) {

35 
$w
[
$key
] = 
$v®ue
;

37 
$this
->
db
->
	`wh”e
(
$w
);

38 
$this
->
db
->
	`lim™
(
$PageSize
, (
$Cu¼’tPage
 - 1) * $PageSize + 1);

39 
$»s_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

40 
$this
->
db
->
	`äom
("$user_tbl");

41 
$this
->
db
->
	`još
("tc_department B", "A.PRIVILEGE_ID = B.DEPT_ID", "inner");

42 
$this
->
db
->
	`wh”e
(
$w
);

43 
$couÁ
 = 
$this
->
db
->
	`couÁ_®l_»suÉs
();

44 
$jsÚ_d©a
 = 
$this
->
objeùs
->
	`InfoPag”s
(
$Cu¼’tPage
, 
$couÁ
, 
$PageSize
, 
$»s_d©a
);

45  
$jsÚ_d©a
;

46 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/relprofile_model.php

1 <?
php


7 şas 
	c»Írofe_mod–
 
ex‹nds
 
	mCI_Mod–
 {

10 
funùiÚ
 
	$__cÚ¡ruù
() {

11 
·»Á
::
	`__cÚ¡ruù
();

17 
public
 
funùiÚ
 
	$·r£_´ofe
(
$u£r_id
, 
$Üg_id
, 
$obj_ty³
, 
$ty³_id
, 
$is_š™
 = 
çl£
) {

18 ià(
$is_š™
) {

19 
$sql
 = " select * fromc_user_rel_profile where org_id = 1‡nd„el_tables is‚ot‚ull";

21 
$sql
 = " select * fromc_user_rel_profile where org_id = 1‡nd obj_type = $obj_type‡ndype_id = $type_id‡nd (user_id = $user_id or user_id = 0)‡nd is_disp = 1";

23 
$´ofe_d©a
 = 
$this
->
db
->
	`qu”y
(
$sql
)->
	`»suÉ_¬¿y
();

24 
$cÚd_d©a
 = 
$this
->
	`»l_to_cÚd
(
$´ofe_d©a
, 
$Üg_id
);

25 
echo
 
	`jsÚ_’code
(
$cÚd_d©a
);

26 
	`fÜ—ch
 (
$cÚd_d©a
 
as
 
$k
 => 
$v
) {

27 
$obj_ty³
 = 
$v
['obj_type'];

28 
$»l_obj_ty³
 = 
$v
['rel_obj_type'];

29 
	`un£t
(
$v
['obj_type']);

30 
	`un£t
(
$v
['rel_obj_type']);

31 
$cÚtiÚ
 = 
	`jsÚ_’code
(
$v
);

32 
$w
 = 
	`¬¿y
(

33 "obj_ty³" => 
$obj_ty³
,

34 "»l_obj_ty³" => 
$»l_obj_ty³
,

36 
$cÚtiÚ
 = 
	`¬¿y
(

37 "Ëe_cÚd™iÚ" => 
$cÚtiÚ
,

39 
$this
->
db
->
	`wh”e
(
$w
);

40 
$this
->
db
->
	`upd©e
("tc_u£r_»l_´ofe", 
$cÚtiÚ
);

42 
d›
;

43 
	}
}

48 
public
 
funùiÚ
 
	$»l_to_cÚd
(
$´ofe_d©a
, 
$Üg_id
) {

49 
$cÚd_d©a
 = 
	`¬¿y
();

62 
	`fÜ—ch
 (
$´ofe_d©a
 
as
 
$key_´o
 => 
$v®ue_´o
) {

63 
$maš_obj
 = 
$v®ue_´o
['OBJ_TYPE'];

64 
$»l_obj
 = 
$v®ue_´o
['REL_OBJ_TYPE'];

65 
$cÚd_d©a
[] = 
$this
->
	`g‘_©Œs
(
$maš_obj
, 
$»l_obj
, 
$v®ue_´o
['REL_TABLES'], 
$Üg_id
);

67  
$cÚd_d©a
;

68 
	}
}

70 
public
 
funùiÚ
 
	$g‘_©Œs
(
$maš_obj
, 
$»l_obj
, 
$»l_bËs
, 
$Üg_id
) {

71 
$maš_obj_»s
 = 
$this
->
	`g‘_obj_©Œ
(
$maš_obj
, 
$Üg_id
);

72 
$»l_obj_»s
 = 
$this
->
	`g‘_obj_©Œ
(
$»l_obj
, 
$Üg_id
);

73 
$»s_d©a
 = 
	`¬¿y
();

74 
$»s_d©a
['obj_ty³'] = 
$maš_obj
;

75 
$»s_d©a
['»l_obj_ty³'] = 
$»l_obj
;

76 
$maš_tbl_Çme
 = 
$maš_obj_»s
['objects']['MAIN_TABLE'];

77 
$maš_´im¬y_key
 = 
$maš_obj_»s
['objects']['KEY_ATTR_FLD'];

78 ià(!
	`¡½os
(
$»l_bËs
, ";")) {

80 
$»l_¡ruù
 = 
	`ex¶ode
(":", 
$»l_bËs
);

81 
$»l_tbl_¡ruù
 = 
$»l_¡ruù
[0];

82 
	`un£t
(
$»l_¡ruù
[0]);

99 
	`fÜ—ch
 (
$»l_¡ruù
 
as
 
$k
 => 
$v
) {

100 
$»l_v
 = 
	`ex¶ode
(",", 
$v
);

101 ià(
$»l_v
[2] == "MF") {

102 
$»s_d©a
[
$maš_obj_»s
['objeùs']['MAIN_TABLE']][
$»l_tbl_¡ruù
] = 
	`¬¿y
(

103 
$maš_obj_»s
['objeùs']['MAIN_TABLE'] . "." . $maš_obj_»s['objeùs']['KEY_ATTR_FLD'] => 
$»l_tbl_¡ruù
 . "." . 
$»l_v
[1],

105 } ià(
$»l_v
[2] == "SF") {

106 
$»s_d©a
[
$maš_obj_»s
['objeùs']['MAIN_TABLE']][
$»l_obj_»s
['objeùs']['MAIN_TABLE']] = 
	`¬¿y
(

107 
$»l_tbl_¡ruù
 . "." . 
$»l_v
[1] => 
$»l_obj_»s
['objects']['MAIN_TABLE'] . "." . $rel_v[1],

111  
$»s_d©a
;

114 
$»l_sub_bËs
 = 
	`sub¡r
(
$»l_bËs
, 0, 
	`¡½os
($rel_tables, ";"));

115 
$»l_¡ruù
 = 
	`ex¶ode
(":", 
$»l_sub_bËs
);

116 
$»l_tbl_¡ruù
 = 
$»l_¡ruù
[0];

117 
	`un£t
(
$»l_¡ruù
[0]);

118 
	`fÜ—ch
 (
$»l_¡ruù
 
as
 
$k
 => 
$v
) {

119 
$»l_v
 = 
	`ex¶ode
(",", 
$v
);

120 ià(
$»l_v
[2] == "MF") {

121 
$»s_d©a
[
$maš_obj_»s
['objeùs']['MAIN_TABLE']][
$»l_tbl_¡ruù
] = 
	`¬¿y
(

122 
$maš_obj_»s
['objeùs']['MAIN_TABLE'] . "." . $maš_obj_»s['objeùs']['KEY_ATTR_FLD'] => 
$»l_tbl_¡ruù
 . "." . 
$»l_v
[1],

124 } ià(
$»l_v
[2] == "SF") {

125 
$»s_d©a
[
$maš_obj_»s
['objeùs']['MAIN_TABLE']][
$»l_obj_»s
['objeùs']['MAIN_TABLE']] = 
	`¬¿y
(

126 
$»l_tbl_¡ruù
 . "." . 
$»l_v
[1] => 
$»l_obj_»s
['objects']['MAIN_TABLE'] . "." . $rel_v[1],

148  
$»s_d©a
;

150 
	}
}

152 
public
 
funùiÚ
 
	$g‘_obj_©Œ
(
$obj
, 
$Üg_id
) {

153 
$objeùs
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj
);

155 
$©Œs
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$objeùs
['OBJ_NAME']);

156 
$»s_d©a
 = 
	`¬¿y
(

157 "objeùs" => 
$objeùs
,

158 "©Œs" => 
$©Œs
,

160  
$»s_d©a
;

161 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/reluser_model.php

1 <?
php


9 şas 
	cR–u£r_mod–
 
ex‹nds
 
	mCI_Mod–
 {

11 
funùiÚ
 
	$__cÚ¡ruù
() {

12 
·»Á
::
	`__cÚ¡ruù
();

13 
$this
->
lßd
->
	`mod–
("www/objects_model", "objects");

16 
public
 
funùiÚ
 
	$·g”_šfo_li¡
(
$d©a
, 
$u£r_id
, 
$Üg_id
, 
$Cu¼’tPage
, 
$PageSize
) {

17 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$d©a
['obj_type']);

18 
$obj_Çme
 = 
$obj
['OBJ_NAME'];

19 
$key_©Œ_æd
 = 
$obj
['KEY_ATTR_FLD'];

20 
$wh”e
[
$key_©Œ_æd
] = 
$d©a
['id'];

21 
$tbl_ûÁ”
 = 
	`¡¹Şow”
(
$obj_Çme
);

22 
$u£r_tbl
 = "»l_" . 
$tbl_ûÁ”
 . "_user";

23 
$æd_d©a
 = "A.user_id,user_name,mobile,dept_name,is_self";

24 
$w
 = 
	`¬¿y
();

25 
$w
["A.USER_ID"] = 
$u£r_id
;

26 
$this
->
db
->
	`£Ëù
(
$æd_d©a
);

27 
$this
->
db
->
	`äom
("$user_tbl A");

28 
$this
->
db
->
	`još
("tc_user B", "B.USER_ID = A.USER_ID", "inner");

29 
$this
->
db
->
	`još
("tc_department C", "C.DEPT_ID = B.DEPT_ID", "inner");

30 
	`fÜ—ch
 (
$wh”e
 
as
 
$key
 => 
$v®ue
) {

31 
$w
[
$key
] = 
$v®ue
;

33 
$this
->
db
->
	`wh”e
(
$w
);

34 
$this
->
db
->
	`lim™
(
$PageSize
, (
$Cu¼’tPage
 - 1) * $PageSize + 1);

35 
$»s_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

36 
$this
->
db
->
	`äom
("$user_tbl A");

37 
$this
->
db
->
	`još
("tc_user B", "B.USER_ID = A.USER_ID", "inner");

38 
$this
->
db
->
	`još
("tc_department C", "C.DEPT_ID = B.DEPT_ID", "inner");

39 
$this
->
db
->
	`wh”e
(
$w
);

40 
$couÁ
 = 
$this
->
db
->
	`couÁ_®l_»suÉs
();

41 
$jsÚ_d©a
 = 
$this
->
objeùs
->
	`InfoPag”s
(
$Cu¼’tPage
, 
$couÁ
, 
$PageSize
, 
$»s_d©a
);

42  
$jsÚ_d©a
;

43 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/remind_model.php

1 <?
php


2 şas 
	cRemšd_mod–
 
ex‹nds
 
	mCI_Mod–
{

3 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

4 
·»Á
 :: 
	`__cÚ¡ruù
();

5 
$this
->
lßd
->
	`mod–
("admin/nextid_model","nextid");

14 
public
 
funùiÚ
 
	$g‘Li¡sA‰r
(
$S’iÜQu”yA‰rs
) {

15 
	`exŒaù
(
$S’iÜQu”yA‰rs
, 
EXTR_OVERWRITE
);

16 
$obj_d©a
 = 
$this
->
obj
->
	`NameG‘Obj
(
$Üg_id
, 
$obj_Çme
);

17 
	`exŒaù
(
$obj_d©a
, 
EXTR_OVERWRITE
);

18 
$li¡_fÜm©
 = 
	`¬¿y
(1=>'REMIND_MESG',2=>'REMIND_TIME');

20 
$Ëad_©Œ
 = 
$this
->
©Œ
->
	`objeù_©Œ
(
$Üg_id
, 
$obj_Çme
);

21 
$CŞNames
 = 
	`¬¿y
(1=>'ä¸»é¢˜',2=>'æé†’æ—¶é—´');

22 
$CŞNames
 = 
	`jsÚ_’code
($ColNames);

23 
$d©a
["CŞMod–"] = 
$this
->
	`G‘Li¡CŞMod–
(
$li¡_fÜm©
, 
$CŞNames
, 
$obj_d©a
, 
$OBJ_TYPE
);

24 
$d©a
["S’iÜQu”yA‰rJsÚ"] = 
$this
->
objeùs
->
	`g‘S’iÜQu”yA‰rs
(
$Üg_id
, 
$LªgID
, 
$obj_Çme
, 
$obj_d©a
, 
$Ëad_©Œ
);

25  
$d©a
;

26 
	}
}

34 
public
 
funùiÚ
 
G‘Li¡CŞMod–
(
$Li¡FÜm©
, 
$cŞNames
, 
$obj_d©a
, 
$obj_ty³
, 
$Width
 = 200, 
$O³¿tiÚWidth
 = 80, 
$r_ty³
 = "¬¿y", 
$func_Çme
 = 
nuÎ
) {

35 
$»s_d©a
 = 
¬¿y
();

49 
	g$»s_d©a
['CŞ'] = 
¬¿y
();

50 
	g$cŞNames
 = 
jsÚ_decode
(
$cŞNames
, 
Œue
);

51 
fÜ—ch
 (
$Li¡FÜm©
 
as
 
$k
 => 
$v
) {

52 ià(
$v
 =ğ
$obj_d©a
['NAME_ATTR_NAME']) {

53 ià(
em±y
(
$func_Çme
)) {

54 
$»s_d©a
['CŞ'][] = 
¬¿y
(

55 'Name' => 
$v
,

56 'LªgEn' => 
$cŞNames
[
$k
],

60 
	g$»s_d©a
['CŞ'][] = 
¬¿y
(

61 'Name' => 
$v
,

62 'LªgEn' => 
$cŞNames
[
$k
],

66 
	g$»s_d©a
['CŞ'][] = 
¬¿y
(

67 'Name' => 
$v
,

68 'LªgEn' => 
$cŞNames
[
$k
],

86 
	g$»s_d©a
['KeyA‰rName'] = 
$obj_d©a
["KEY_ATTR_NAME"];

93 
	g$r_ty³
) {

95  
$»s_d©a
;

98  
jsÚ_’code
(
$»s_d©a
);

101  
jsÚ_’code
(
$»s_d©a
);

102 
	gd›
;

119  
jsÚ_’code
(
$»s_d©a
);

123 
public
 
funùiÚ
 
	$Remšd”Li¡
(
$Üg_id
,
$u£r_id
,
$is_desk
=
æa£
,
$Cu¼’tPage
=1,
$PageSize
=10){

124 
$wh”e
 = 
	`¬¿y
(

125 'tc_»mšd_³rsÚ.to_obj_id' => 
$u£r_id
,

126 'tc_»mšd_³rsÚ.Üg_id' => 
$Üg_id
,

130 
$this
->
db
->
	`£Ëù
('tc_reminder.remind_id,tc_reminder.remind_type,tc_reminder.remind_mesg,tc_reminder.obj_type,tc_reminder.obj_id,tc_remind_person.is_new');

131 
$this
->
db
->
	`£Ëù
("to_char(tc_remind_person.remind_time, 'yyyy-mm-dd hh24:ii:ss')‡s„emind_time");

132 
$this
->
db
->
	`wh”e
(
$wh”e
);

133 
$this
->
db
->
	`äom
('tc_remind_person');

134 
$još_Ú
 = 'tc_reminder.org_id =c_remind_person.org_id‡ndc_reminder.remind_id =c_remind_person.remind_id';

135 
$this
->
db
->
	`još
('tc_»mšd”',
$još_Ú
,'inner');

136 
$this
->
db
->
	`Üd”_by
('tc_remind_person.remind_time', "desc");

137 if(
$is_desk
){

138 
$this
->
db
->
	`lim™
(8,1);

139 
$this
->
db
->
	`wh”e
('tc_remind_person.to_desktop',1);

140 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

142 
$this
->
db
->
	`lim™
(
$PageSize
, (
$Cu¼’tPage
 - 1) * $PageSize + 1);

143 
$this
->
db
->
	`wh”e
('tc_remind_person.to_desktop',0);

144 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

145 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

146 
$d©a
[
$k
]['REMIND_TIME'] = 
$this
->
objeùs
->
	`isd©‘ime
(
$v
['REMIND_TIME'],8*60*60);

148 
$d©a
 = 
$this
->
	`m»¶aû
($data);

149 
$couÁ
 = 
$this
->
	`couÁ
(
$Üg_id
,
$u£r_id
);

150  
$this
->
	`InfoPag”s
(
$Cu¼’tPage
, 
$couÁ
, 
$PageSize
, 
$d©a
);

152 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

153 
$d©a
[
$k
]['REMIND_TIME'] = 
$this
->
objeùs
->
	`isd©‘ime
(
$v
['REMIND_TIME'],8*60*60);

155 
$d©a
 = 
$this
->
	`m»¶aû
($data);

156  
$this
->
	`InfoPag”s
(1, 1, 8, 
$d©a
);

157 
	}
}

158 
public
 
funùiÚ
 
	$m»¶aû
(
$d©a
){

159 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

161 
$r_d©a
[
$k
]['REMIND_MESG'] = 
$v
['REMIND_MESG']."<span class=\"badge badge-pink\">NEW!</span>";

162 
$r_d©a
[
$k
]['REMIND_TIME'] = 
$v
['REMIND_TIME'];

163 if(
$v
['REMIND_TYPE']!=4){

164 
$r_d©a
[
$k
]['REMIND.u¾'] = 
	`ba£_u¾
()."šdex.php/www/objeùs/v›w?id=".
$v
['OBJ_ID']."&obj_type=".$v['OBJ_TYPE'];

166 
$r_d©a
[
$k
]['REMIND.url'] = 'javascript:void(0);';

168 
$r_d©a
[
$k
]['REMIND.ID'] = 
$v
['REMIND_ID'];

171  
$r_d©a
;

172 
	}
}

174 
public
 
funùiÚ
 
	$couÁ
(
$Üg_id
,
$u£r_id
){

175 
$wh”e
 = 
	`¬¿y
(

177 'tc_»mšd_³rsÚ.Üg_id' => 
$Üg_id
,

181 
$this
->
db
->
	`£Ëù
('tc_reminder.remind_mesg,tc_reminder.obj_type,tc_reminder.obj_id');

182 
$this
->
db
->
	`£Ëù
("to_char(tc_remind_person.remind_time, 'yyyy-mm-dd hh24:ii:ss')‡s„emind_time");

183 
$this
->
db
->
	`wh”e
(
$wh”e
);

184 
$this
->
db
->
	`äom
('tc_remind_person');

185 
$još_Ú
 = 'tc_reminder.org_id =c_remind_person.org_id‡ndc_reminder.remind_id =c_remind_person.remind_id';

186 
$this
->
db
->
	`još
('tc_»mšd”',
$još_Ú
,'inner');

187 
$this
->
db
->
	`Üd”_by
('tc_remind_person.remind_id', "desc");

188 
$couÁ
 = 
$this
->
db
->
	`couÁ_®l_»suÉs
();

189  
$couÁ
;

190 
	}
}

192 
´Ùeùed
 
funùiÚ
 
	$InfoPag”s
(
$Cu¼’tPage
, 
$couÁ
, 
$PageSize
, 
$d©a
) {

194 
$»¥Úû
->
·ge
 = 
$Cu¼’tPage
;

195 
$»¥Úû
->
»cÜds
 = 
$couÁ
;

196 ià(
$couÁ
 > 0) {

197 
$tÙ®_·ges
 = 
	`û
(
$couÁ
 / 
$PageSize
);

199 
$tÙ®_·ges
 = 0;

201 
$»¥Úû
->
tÙ®
 = 
$tÙ®_·ges
;

203 ià(!
	`em±y
(
$d©a
)) {

204 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

205 
$»¥Úû
->
rows
[
$k
]["ûÎ"] = 
$v
;

209  
	`jsÚ_’code
(
$»¥Úû
);

210 
d›
;

211 
	}
}

213 
´iv©e
 
funùiÚ
 
	$G‘OÃ
(
$Üg_id
,
$obj
,
$obj_id
){

214 
$æd
 = 
$this
->
©Œ
->
	`Çme2æd
(
$Üg_id
,
$obj
['NAME_ATTR_NAME'],$obj['OBJ_NAME']);

215 if(
$obj
['OBJ_NAME']=='Task'){

216 
$this
->
db
->
	`£Ëù
('a.assigÃd_u£r_id,b.u£r_Çme,a.'.
$æd
."‡s‚ame");

217 
$this
->
db
->
	`äom
(
$obj
['MAIN_TABLE'].'‡');

218 
$this
->
db
->
	`još
('tc_user b','a.assigned_user_id = b.user_id‡nd‡.org_id=b.org_id','inner');

220 
$this
->
db
->
	`£Ëù
('a.owÃr_u£r_id,b.u£r_Çme,a.'.
$æd
."‡s‚ame");

221 
$this
->
db
->
	`äom
(
$obj
['MAIN_TABLE'].'‡');

222 
$this
->
db
->
	`još
('tc_user b','a.owner_user_id = b.user_id‡nd‡.org_id=b.org_id','inner');

225 
$wh”e
['a.Üg_id'] = 
$Üg_id
;

226 
$wh”e
['a.'.
$obj
['KEY_ATTR_FLD']] = 
$obj_id
;

227 
$this
->
db
->
	`wh”e
(
$wh”e
);

228 
$r_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

229  
$r_d©a
[0];

230 
	}
}

232 
´iv©e
 
funùiÚ
 
	$G‘U£r
(
$Üg_id
,
$u£r_id
){

233 
$this
->
db
->
	`£Ëù
('USER_NAME,OWNER_USER_ID');

234 
$this
->
db
->
	`wh”e
('u£r_id',
$u£r_id
);

235 
$this
->
db
->
	`wh”e
('Üg_id',
$Üg_id
);

236 
$this
->
db
->
	`äom
('tc_user');

237 
$u£r_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

238  
$u£r_d©a
[0];

239 
	}
}

241 
public
 
funùiÚ
 
	$AddRemšd
(
$obj_ty³
,
$Üg_id
,
$ev’t_ty³
,
$obj_id
){

268 
$d©a
 = 
$this
->
	`checkÇme
(
$ev’t_ty³
,
$obj_ty³
,
$Üg_id
);

269 
$obj
 = 
$this
->
obj
->
	`g‘OÃD©a
(
$obj_ty³
);

270 
$r_d©a
 = 
$this
->
	`G‘OÃ
(
$Üg_id
,
$obj
,
$obj_id
);

271 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

272 
$v
['TO_TYPE']) {

274 
$u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$v
['USER_ID']);

276 
$Ãxt_id
 = 
$this
->
	`In£¹Remšd”
(
$Üg_id
,
$r_d©a
['NAME'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

277 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$v
['USER_ID'],
$Ãxt_id
,$v['TO_DESKTOP'],99);

278 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$v
['USER_ID'],$v['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

280 if(
$v
['TO_PARENT']){

281 if(
$u£r_d©a
['OWNER_USER_ID'] != 0){

282 
$owÃr_u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID']);

284 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID'],
$Ãxt_id
,
$v
['TO_DESKTOP'],99);

285 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$owÃr_u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$u£r_d©a
['OWNER_USER_ID'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

292 
$Ãxt_id
 = 
$this
->
	`In£¹Remšd”
(
$Üg_id
,
$r_d©a
['NAME'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

293 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$r_d©a
['OWNER_USER_ID'],
$Ãxt_id
,
$v
['TO_DESKTOP'],99);

294 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$r_d©a
['USER_NAME'],$r_d©a['NAME'],$r_d©a['OWNER_USER_ID'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

296 if(
$v
['TO_PARENT']){

297 if(
$u£r_d©a
['OWNER_USER_ID'] != 0){

298 
$owÃr_u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID']);

300 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID'],
$Ãxt_id
,
$v
['TO_DESKTOP'],99);

301 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$owÃr_u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$u£r_d©a
['OWNER_USER_ID'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

306 
$this
->
db
->
	`£Ëù
('user_id');

307 
$wh”e
 = 
	`¬¿y
(

308 'Üg_id' => 
$Üg_id
,

309 
$obj
['OBJ_NAME'].'_ID' =>
$obj_id
,

312 
$this
->
db
->
	`wh”e
(
$wh”e
);

313 
$this
->
db
->
	`äom
('»l_'.
$obj
['OBJ_NAME'].'_user');

314 
$ru_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

316 if(!
	`em±y
(
$ru_d©a
)){

317 
$u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$ru_d©a
[0]['USER_ID']);

319 
$Ãxt_id
 = 
$this
->
	`In£¹Remšd”
(
$Üg_id
,
$r_d©a
['NAME'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

320 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$ru_d©a
[0]['USER_ID'],
$Ãxt_id
,
$v
['TO_DESKTOP'],99);

321 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$ru_d©a
[0]['USER_ID'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

322 if(
$v
['TO_PARENT']){

323 if(
$u£r_d©a
['OWNER_USER_ID'] != 0){

324 
$owÃr_u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID']);

326 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID'],
$Ãxt_id
,
$v
['TO_DESKTOP'],99);

327 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$owÃr_u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$u£r_d©a
['OWNER_USER_ID'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

334 
$this
->
db
->
	`£Ëù
('user_id');

335 
$wh”e
 = 
	`¬¿y
(

336 'Üg_id' => 
$Üg_id
,

337 'rŞe_ID' =>
$v
['ROLE_ID'],

339 
$this
->
db
->
	`wh”e
(
$wh”e
);

340 
$this
->
db
->
	`äom
('rel_role_user');

341 
$ro_d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

342 if(!
	`em±y
(
$ro_d©a
)){

343 
$Ãxt_id
 = 
$this
->
	`In£¹Remšd”
(
$Üg_id
,
$r_d©a
['NAME'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

345 
	`fÜ—ch
 (
$ro_d©a
 
as
 
$kk
 => 
$vv
) {

346 
$u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$vv
['USER_ID']);

347 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$vv
['USER_ID'],
$Ãxt_id
,
$v
['TO_DESKTOP'],99);

348 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$vv
['USER_ID'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

349 if(
$v
['TO_PARENT']){

350 if(
$u£r_d©a
['OWNER_USER_ID'] != 0){

351 
$owÃr_u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID']);

352 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID'],
$Ãxt_id
,
$v
['TO_DESKTOP'],99);

353 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$owÃr_u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$u£r_d©a
['OWNER_USER_ID'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

361 
$u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$v
['USER_ID']);

363 
$Ãxt_id
 = 
$this
->
	`In£¹Remšd”
(
$Üg_id
,
$r_d©a
['NAME'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

364 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$v
['USER_ID'],
$Ãxt_id
,$v['TO_DESKTOP'],99);

365 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$v
['USER_ID'],$v['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

367 if(
$v
['TO_PARENT']){

368 
$owÃr_u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID']);

369 if(
$u£r_d©a
['OWNER_USER_ID'] != 0){

370 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID'],
$Ãxt_id
,
$v
['TO_DESKTOP'],99);

371 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$owÃr_u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$u£r_d©a
['OWNER_USER_ID'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

376 
$this
->
db
->
	`£Ëù
('user_id');

377 
$wh”e
 = 
	`¬¿y
(

378 'Üg_id' => 
$Üg_id
,

379 
$obj
['OBJ_NAME'].'_ID' =>
$obj_id
,

382 
$this
->
db
->
	`wh”e
(
$wh”e
);

383 
$this
->
db
->
	`äom
('»l_'.
$obj
['OBJ_NAME'].'_user');

384 
$ru_d©a1
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

385 if(!
	`em±y
(
$ru_d©a1
)){

386 
$u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$ru_d©a1
[0]['USER_ID']);

388 
$Ãxt_id
 = 
$this
->
	`In£¹Remšd”
(
$Üg_id
,
$r_d©a
['NAME'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

389 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$ru_d©a1
[0]['USER_ID'],
$Ãxt_id
,
$v
['TO_DESKTOP'],99);

390 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$ru_d©a1
[0]['USER_ID'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

391 if(
$v
['TO_PARENT']){

392 if(
$u£r_d©a
['OWNER_USER_ID'] != 0){

393 
$owÃr_u£r_d©a
 = 
$this
->
	`G‘U£r
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID']);

395 
$this
->
	`In£¹RemšdP”sÚ
(
$Üg_id
,
$u£r_d©a
['OWNER_USER_ID'],
$Ãxt_id
,
$v
['TO_DESKTOP'],99);

396 
$this
->
	`In£¹Mes§ge
(
$Üg_id
,
$owÃr_u£r_d©a
['USER_NAME'],
$r_d©a
['NAME'],
$u£r_d©a
['OWNER_USER_ID'],
$v
['EVENT_NAME'],
$obj_ty³
,
$obj_id
);

406 
	}
}

408 
´iv©e
 
funùiÚ
 
	$checkÇme
(
$ev’t_ty³
=1,
$obj_ty³
=3,
$Üg_id
=1){

409 
$this
->
db
->
	`äom
('tc_event_config');

410 
$wh”e
['tc_ev’t_cÚfig.ev’t_ty³'] = 
$ev’t_ty³
;

411 
$wh”e
['tc_ev’t_cÚfig.obj_ty³'] = 
$obj_ty³
;

412 
$wh”e
['tc_ev’t_cÚfig.Üg_id'] = 
$Üg_id
;

413 
$this
->
db
->
	`wh”e
(
$wh”e
);

414 
$još_Ú
 = 'tc_event_config_user.event_id =c_event_config.event_id';

415 
$this
->
db
->
	`još
('tc_ev’t_cÚfig_u£r',
$još_Ú
,'inner');

416 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

417 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

418 
$d©a
[
$k
]['COND_OBJECT'] = 
	`ba£64_decode
(
$v
['COND_OBJECT']->
	`lßd
());

420  
$d©a
;

421 
	}
}

422 
public
 
funùiÚ
 
In£¹Mes§ge
(
$Üg_id
=1,
$u£r_Çme
,
$Çme
,
$u£r_id
,
$ev’t_Çme
="",
$obj_ty³
="",
$obj_id
=""){

423 
$time
 = 
d©e
("Y-m-d H:i:s");

424 
	g$time
 = 
$this
->
objeùs
->
isd©‘ime
(
$time
,-8*60*60);

425 
	g$Ãxt_id
 = 
$this
->
Ãxtid
->
NewID
('TC_MESSAGE_INFO',
$Üg_id
);

426 
	g$š£¹
 = 
¬¿y
(

427 'Üg_id' => 
$Üg_id
,

428 'mes§ge_id' => 
$Ãxt_id
,

430 'mes§ge_to' => 
$u£r_Çme
,

432 'mes§ge_subjeù' => 
$ev’t_Çme
.':'.
$Çme
,

433 'mes§ge_cÚ‹Á' => 
$ev’t_Çme
.':'.
$Çme
,

435 '»l_obj_ty³' => 
$obj_ty³
,

436 '»l_obj_id' =>
$obj_id


438 
	g$this
->
	gdb
->
£t
('ü—‹_time',"to_d©e('" . 
$time
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

439 if(
	g$this
->
	gdb
->
š£¹
('TC_MESSAGE_INFO',
$š£¹
)){

440 
	g$š£¹2
 = 
¬¿y
(

441 'Üg_id' => 
$Üg_id
,

442 'mes§ge_id' => 
$Ãxt_id
,

443 'u£r_id' =>
$u£r_id


445 
	g$this
->
	gdb
->
š£¹
('REL_MESSAGE_USER',
$š£¹2
);

446  
	g$Ãxt_id
;

448  
	gçl£
;

452 
´iv©e
 
funùiÚ
 
	$In£¹Remšd”
(
$Üg_id
=1,
$Çme
,
$ev’t_Çme
,
$obj_ty³
,
$obj_id
){

454 
$Ãxt_id
 = 
$this
->
Ãxtid
->
	`NewID
('TC_REMINDER',
$Üg_id
);

455 
$š£¹
 = 
	`¬¿y
(

456 'Üg_id' => 
$Üg_id
,

457 '»mšd_id' => 
$Ãxt_id
,

459 'obj_ty³' => 
$obj_ty³
,

460 'obj_id' =>
$obj_id
,

461 '»mšd_mesg' => 
$ev’t_Çme
.':'.
$Çme
,

463 if(
$this
->
db
->
	`š£¹
('TC_REMINDER',
$š£¹
)){

464  
$Ãxt_id
;

466  
çl£
;

468 
	}
}

470 
´iv©e
 
funùiÚ
 
In£¹RemšdP”sÚ
(
$Üg_id
=1,
$to_obj_id
,
$Ãxt_id
,
$is_desktİ
=1,
$to_obj_ty³
=99,
$time
=
nuÎ
,
$¬r
=
	$¬¿y
()){

471 
$time
 = !
	`em±y
($timeè? $tim: 
	`d©e
("Y-m-d H:i:s");

472 
$time
 = 
$this
->
objeùs
->
	`isd©‘ime
($time,-8*60*60);

473 
$Ãxt_id2
 = 
$this
->
Ãxtid
->
	`NewID
('TC_REMIND_PERSON',
$Üg_id
);

474 
$š£¹
 = 
	`¬¿y
(

475 'Üg_id' => 
$Üg_id
,

476 '»mšd_d_id' => 
$Ãxt_id2
,

477 '»mšd_id' => 
$Ãxt_id
,

478 'to_obj_ty³' => 
$to_obj_ty³
,

479 'to_obj_id' => 
$to_obj_id
,

480 'to_desktİ' => 
$is_desktİ
,

483 
$this
->
db
->
	`£t
('»mšd_time',"to_d©e('" . 
$time
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

484 if(
$this
->
db
->
	`š£¹
('TC_REMIND_PERSON',
$š£¹
)){

485  
$Ãxt_id
;

487  
çl£
;

489 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/role_model.php

1 <?
php


2 şas 
	cRŞe_mod–
 
ex‹nds
 
	mCI_Mod–
{

4 
´iv©e
 
	m$u£r_d©a
;

9 
public
 
funùiÚ
 
	$U£rIsRŞe
(
$u£r_id
,
$rŞe_id
,
$Üg_id
){

10 
$wh”e
["Üg_id"] = 
$Üg_id
;

11 
$wh”e
["rŞe_id"] = 
$rŞe_id
;

12 
$wh”e
["u£r_id"] = 
$u£r_id
;

13 
$this
->
db
->
	`äom
("rel_role_user");

15 
$this
->
db
->
	`wh”e
(
$wh”e
);

16 
$couÁ
 = 
$this
->
db
->
	`couÁ_®l_»suÉs
();

18  
$couÁ
;

20 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/type_model.php

1 <?
php


5 şas 
	cTy³_mod–
 
ex‹nds
 
	mCI_Mod–
 {

7 
public
 
funùiÚ
 
	$__cÚ¡ruù
() {

8 
·»Á
 :: 
	`__cÚ¡ruù
();

17 
public
 
funùiÚ
 
	$S–eùOÃ
(
$OrgID
, 
$©Œ_v®ue
) {

18 
$wh”e
 = 
	`¬¿y
(

19 "ty³_id" => 
$©Œ_v®ue
,

20 "Üg_id" => 
$OrgID
,

22 
$£Ëù
 = 
	`¬¿y
(

26 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

27 
$this
->
db
->
	`wh”e
(
$wh”e
);

28 
$this
->
db
->
	`äom
("tc_type");

29 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

30 
$Ãw_d©a
["Name"] = 
$d©a
[0]["TYPE_NAME"];

31 
$Ãw_d©a
["ID"] = 
$d©a
[0]["TYPE_ID"];

32  
$Ãw_d©a
;

33 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/user_model.php

1 <?
php


3 şas 
	cU£r_mod–
 
ex‹nds
 
	mCI_Mod–
 {

5 
´iv©e
 
	m$u£r_d©a
;

6 
´iv©e
 
	m$logš_sys
;

10 
public
 
funùiÚ
 
	$LogšU£rD©a
(
$LogšName
,
$OrgName
){

11 
$this
->
lßd
->
	`mod–
('admin/org_model', 'org');

12 
$OrgID
 = 
$this
->
Üg
->
	`NameG‘Id
(
$OrgName
);

13 
$wh”e
 = 
	`¬¿y
(

14 'logš_Çme' => 
$LogšName
,

15 'Üg_id' => 
$OrgID


17 
$this
->
db
->
	`wh”e
(
$wh”e
);

18 
$this
->
db
->
	`äom
('tc_user');

19 
$d©a
=
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

20  
$d©a
;

23 
public
 
funùiÚ
 
	$LogšU£rD©a2
(
$LogšName
,
$OrgID
){

24 
$this
->
lßd
->
	`mod–
('admin/org_model', 'org');

25 
$wh”e
 = 
	`¬¿y
(

26 'logš_Çme' => 
$LogšName
,

27 'Üg_id' => 
$OrgID


29 
$this
->
db
->
	`wh”e
(
$wh”e
);

30 
$this
->
db
->
	`äom
('tc_user');

31 
$d©a
=
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

32  
$d©a
;

33 
	}
}

38 
public
 
funùiÚ
 
LogšNameIsExi¡
(
$logš_Çme
, 
$Üg
 = "") {

39 
$šfo
['wh”e']["logš_Çme"] = 
$logš_Çme
;

40 ià(
	g$Üg
 == "") {

41 
$wh”e
["org_id"] = 1;

43 
	g$this
->
	glßd
->
mod–
('admin/org_model', 'org');

44 
	g$this
->
	gÜg
->
NameG‘Id
(
$Üg
);

46 
	g$d©a
 = 
$this
->
couÁG‘Info
(
$šfo
);

54 
public
 
funùiÚ
 
	$’codePasswÜd
(
$pswd
) {

55 ià(
$pswd
 != "") {

56 
$’ü±ed
 = 
	`md5
(
$pswd
);

58 
$’ü±ed
 = "";

60  
$’ü±ed
;

61 
	}
}

69 
public
 
funùiÚ
 
	$checkPasswÜd
(
$pswd
, 
$’ü±ed
) {

70 ià(
$this
->
	`’codePasswÜd
(
$pswd
è=ğ
$’ü±ed
) {

71  
Œue
;

73  
æush
;

75 
	}
}

84 
public
 
funùiÚ
 
CheckLogš
(
$logš_sys
, 
$logšÇme
, 
$·sswÜd
, 
$Ügcode
 = "") {

85 
$this
->
lßd
->
mod–
('admin/org_model', 'org');

86 
	g$ÜgID
 = 1;

87 
	g$E¼No
 = 
$this
->
CheckU£r
(
$logšÇme
, 
$·sswÜd
, 
Œue
, 
$ÜgID
, 
$logš_sys
);

88 ià(
	g$E¼No
) {

90 
	g$”rmsg
 = 
$this
->
g‘E¼ÜMes§ge
(
$E¼No
);

91  
	g$”rmsg
;

95 
	g$d©a
 = 
$this
->
u£r_d©a
;

97 
	g$this
->
	g£ssiÚ
->
£t_u£rd©a
('lang_id', 2);

98 
	g$this
->
	g£ssiÚ
->
£t_u£rd©a
('Üg_id', 
$ÜgID
);

99 
	g$this
->
	g£ssiÚ
->
£t_u£rd©a
('logš_sys', 
$logš_sys
);

100 
	g$this
->
	g£ssiÚ
->
£t_u£rd©a
('u£r_id', 
$d©a
['user_id']);

101 
	g$this
->
	g£ssiÚ
->
£t_u£rd©a
('u£r_Çme', 
$d©a
['user_name']);

102 
	g$this
->
	g£ssiÚ
->
£t_u£rd©a
('logš_Çme', 
$d©a
['user_login_name']);

103 
	g$this
->
	g£ssiÚ
->
£t_u£rd©a
('is_admš', 
$is_admš
);

104 
	g$this
->
	g£ssiÚ
->
£t_u£rd©a
('time', 
time
());

107 
	g$this
->
	glogš_sys
) {

109 
h—d”
('LoÿtiÚ: ' . 
s™e_u¾
() . "/admin");

112 
h—d”
('LoÿtiÚ: ' . 
s™e_u¾
() . "/www");

115 
h—d”
('LoÿtiÚ: ' . 
s™e_u¾
() . "/www");

118 
echo
 "æœªçŸ¥æ¨¡å—";

119 
	gex™
;

134 
public
 
funùiÚ
 
CheckU£r
(
$logš_Çme
 = "", 
$logš_·sswÜd
 = "", 
$checkPass
 = 
Œue
, 
$Üg_id
, 
$logš_sys
) {

135 ià(
	g$logš_Çme
 == "") {

139 
	g$šfo
['wh”e']['u£r_logš_Çme'] = 
$logš_Çme
;

140 
	g$d©a
 = 
$this
->
G‘Info
(
$šfo
);

141 
	g$this
->
	gu£r_d©a
 = 
$d©a
;

142 
	g$this
->
	glogš_sys
 = 
$logš_sys
;

143 ià(!
	g$d©a
) {

146 ià(
md5
(
$d©a
["u£r_·sswÜd"]è!ğ
$this
->
’codePasswÜd
(
$logš_·sswÜd
)) {

149 ià(
	g$d©a
["STOP_FLAG"] == 1) {

157 
public
 
funùiÚ
 
	$g‘E¼ÜMes§ge
(
$E¼No
) {

158 
$E¼No
) {

160 
$”rmsg
 = "10000";

163 
$”rmsg
 = "ç”¨æˆ·åç©º";

166 
$”rmsg
 = "ç”¨æˆ·æ²¡æœ‰æ‰¾åˆ°";

169 
$”rmsg
 = "è¶…è¿‡å¿è¯•æ¬¡æ•°, ç”¨æˆ·è¢«é”å®š";

172 
$”rmsg
 = "å¯†ç é”™è¯¯";

175 
$”rmsg
 = "ç”¨æˆ·å·²ç»åœç”¨";

178 
$”rmsg
 = "æœªçŸ¥é”™è¯¯";

181  
$”rmsg
;

182 
	}
}

187 
public
 
funùiÚ
 
	$G‘Info
(
$šfo
) {

189 
$this
->
db
->
	`äom
("tc_user");

190 
	`exŒaù
(
$šfo
);

191 ià(!
	`em±y
(
$£Ëù
)) {

192 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

194 ià(!
	`em±y
(
$wh”e
)) {

195 
$this
->
db
->
	`wh”e
(
$wh”e
);

197 ià(!
	`em±y
(
$lim™
)) {

198 
$this
->
db
->
	`lim™
(
$lim™
[0], $limit[1]);

200 ià(!
	`em±y
(
$like
)) {

201 
$this
->
db
->
	`like
(
$like
);

203 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

204 ià(
	`couÁ
(
$d©a
) == 1) {

205 
$d©a
 = $data[0];

207  
$d©a
;

208 
	}
}

214 
public
 
funùiÚ
 
	$couÁG‘Info
(
$šfo
) {

215 
$this
->
db
->
	`äom
('tc_user');

216 
	`exŒaù
(
$šfo
);

217 ià(!
	`em±y
(
$wh”e
)) {

218 
$this
->
db
->
	`wh”e
(
$wh”e
);

220 ià(!
	`em±y
(
$like
)) {

221 
$this
->
db
->
	`like
(
$like
);

223 
$couÁ
 = 
$this
->
db
->
	`couÁ_®l_»suÉs
();

224  
$couÁ
;

225 
	}
}

232 
public
 
funùiÚ
 
li¡G‘Info
(
$wh”e
, 
$·ge
 = 1, 
$³rNumb”
 = 10, 
$like
 = "") {

233 
$lim™S¹
 = (
$·ge
 - 1è* 
$³rNumb”
 + 1 - 1;

234 
	g$lim™
 = 
¬¿y
(
$³rNumb”
, 
$lim™S¹
);

236 
	g$d©a
 = 
$this
->
G‘Info
(
$wh”e
, 
$lim™
, 
$like
);

237  
	g$d©a
;

241 
public
 
funùiÚ
 
	$id_aG‘Info
(
$id
) {

242 
$wh”e
 = 
	`¬¿y
(

243 'u£r_id' => 
$id
,

245 
$d©a
 = 
$this
->
	`G‘Info
(
$wh”e
);

246 
$d©a
 = $data[0];

247  
$d©a
;

248 
	}
}

251 
public
 
funùiÚ
 
	$upd©e
(
$d©a
, 
$id
) {

252 
$this
->
db
->
	`wh”e
('u£r_id', 
$id
)->
	`upd©e
('tc_u£r', 
$d©a
);

253 
	}
}

256 
public
 
funùiÚ
 
	$d–
(
$id
) {

257 
$this
->
db
->
	`wh”e
('u£r_id', 
$id
)->
	`d–‘e
('tc_user');

258 
	}
}

261 
public
 
funùiÚ
 
	$add
(
$d©a
) {

262 
$this
->
db
->
	`š£¹
('tc_u£r', 
$d©a
);

263 
$š£¹_id
 = 
$this
->
db
->
	`š£¹_id
();

264  
$š£¹_id
;

265 
	}
}

267 
public
 
funùiÚ
 
	$u£r_auth
(
$id
) {

269 
$rŞe_šfo
 = 
$this
->
db
->
	`g‘_wh”e
('tc_rŞe_u£r', 
	`¬¿y
('u£r_id' => 
$id
))->
	`»suÉ_¬¿y
();

271 
$m’u_auth_¬r
 = 
	`¬¿y
();

272 
$aùiv™y_auth_¬r
 = 
	`¬¿y
();

273 
$d©a_auth_¬r
 = 
	`¬¿y
();

276 ià(!
	`em±y
(
$rŞe_šfo
)) {

277 
	`fÜ—ch
 (
$rŞe_šfo
 
as
 
$¬r
) {

279 
$‹m
 = 
$this
->
db
->
	`£Ëù
('rŞe_id,rŞe_m’u_auth,rŞe_aùiv™y_auth,rŞe_d©a_auth')->
	`äom
('tc_rŞe')->
	`wh”e
('rŞe_id', 
$¬r
['rŞe_id'])->
	`g‘
()->
	`»suÉ_¬¿y
();

281 
$auth_¬r
[] = 
$‹m
[0];

283 
$u£r_auth
 = 
$auth_¬r
;

285 ià(!
	`em±y
(
$u£r_auth
)) {

287 
	`fÜ—ch
 (
$u£r_auth
 
as
 
$¬r
) {

288 
$m’u_auth_¬r
 = 
	`bšgji
($m’u_auth_¬r, 
	`jsÚ_decode
(
$¬r
['role_menu_auth']));

293 ià(!
	`em±y
(
$u£r_auth
)) {

294 
	`fÜ—ch
 (
$u£r_auth
 
as
 
$¬r
) {

298 
$aùiv™y_auth_¬r
 = 
	`bšgji
($aùiv™y_auth_¬r, 
	`jsÚ_decode
(
$¬r
['role_activity_auth']));

304 ià(!
	`em±y
(
$u£r_auth
)) {

306 
	`fÜ—ch
 (
$u£r_auth
 
as
 
$¬r
) {

307 
$¬r
['rŞe_d©a_auth'] = 
	`jsÚ_decode
($arr['role_data_auth']);

309 
$d©a_auth_¬r
 = 
	`bšgji
($d©a_auth_¬r, 
$¬r
['role_data_auth']);

315 
$d©a
['m’u_auth_¬r'] = 
$m’u_auth_¬r
;

316 
$d©a
['aùiv™y_auth_¬r'] = 
$aùiv™y_auth_¬r
;

317 
$d©a
['d©a_auth_¬r'] = 
$d©a_auth_¬r
;

319  
$d©a
;

320 
	}
}

322 
public
 
funùiÚ
 
rŞeG‘Info
(
$id
, 
$like
 = "") {

325 
$like_¡r
 = "";

326 ià(
	g$like
 != "") {

327 
fÜ—ch
 (
$like
 
as
 
$k
 => 
$v
) {

328 
$like_¡r
 .ğ'ªd ' . 
$k
 . "†ik'%" . 
$v
 . "%'";

331 
	g$sql
 = "£Ëù * fromc_u£¸wh”u£r_id in(SELECT u£r_id FROM `tc_rŞe_u£r` WHERE„Şe_id = " . 
$id
 . "è" . 
$like_¡r
;

332 
	g$d©a
 = 
$this
->
db
->
qu”y
(
$sql
)->
»suÉ_¬¿y
();

333 
fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

337 ià(
$v
['u£r_£x'] !ğ"" 
ªd
 $v['user_sex'] != 0) {

338 
$this
->
lßd
->
mod–
('admin/enum_model', 'enum');

340 
	g$d©a
[
$k
]['u£r_£x_¬r'] = 
$this
->->
g‘li¡
(64, 
$d©a
[$k]['user_sex']);

343 ià(
	g$v
['u£r_d•¬tm’t'] !ğ"" 
ªd
 
$v
['user_department'] != 0) {

344 
$this
->
lßd
->
mod–
('www/department_model', 'department');

345 
	g$d©a
[
$k
]['u£r_d•¬tm’t_¬r'] = 
$this
->
d•¬tm’t
->
id_aG‘Info
(
$v
['user_department']);

349 ià(
	g$v
['u£r_duty_Çme'] !ğ"" 
ªd
 
$v
['user_duty_name'] != 0) {

350 
$this
->
lßd
->
mod–
('admin/enum_model', 'enum');

352 
	g$d©a
[
$k
]['u£r_duty_Çme_¬r'] = 
$this
->->
g‘li¡
(69, 
$d©a
[$k]['user_duty_name']);

355 ià(
	g$v
['u£r_¡©us'] !ğ"" 
ªd
 
$v
['user_status'] != 0) {

356 
$this
->
lßd
->
mod–
('admin/enum_model', 'enum');

358 
	g$d©a
[
$k
]['u£r_¡©us_¬r'] = 
$this
->->
g‘li¡
(70, 
$d©a
[$k]['user_status']);

361  
	g$d©a
;

365 
public
 
funùiÚ
 
couÁRŞe
(
$id
, 
$like
 = "") {

367 
$like_¡r
 = "";

368 ià(
	g$like
 != "") {

369 
fÜ—ch
 (
$like
 
as
 
$k
 => 
$v
) {

370 
$like_¡r
 .ğ'ªd ' . 
$k
 . "†ik'%" . 
$v
 . "%'";

373 
	g$sql
 = "£Ëù couÁ(*èËe_couÁ fromc_u£¸wh”u£r_id in(SELECT u£r_id FROM `tc_rŞe_u£r` WHERE„Şe_id = " . 
$id
 . "è" . 
$like_¡r
;

374 
	g$d©a
 = 
$this
->
db
->
qu”y
(
$sql
)->
»suÉ_¬¿y
();

375 
	g$couÁ
 = 
$d©a
[0]['lee_count'];

376  
	g$couÁ
;

385 
public
 
funùiÚ
 
	$S–eùOÃ
(
$OrgID
, 
$U£rId
) {

386 
$wh”e
 = 
	`¬¿y
(

387 "u£r_id" => 
$U£rId
,

388 "Üg_id" => 
$OrgID
,

390 
$£Ëù
 = 
	`¬¿y
(

395 
$this
->
db
->
	`£Ëù
(
$£Ëù
);

396 
$this
->
db
->
	`wh”e
(
$wh”e
);

397 
$this
->
db
->
	`äom
("tc_user");

398 
$d©a
 = 
$this
->
db
->
	`g‘
()->
	`»suÉ_¬¿y
();

399 
$Ãw_d©a
["Name"] = 
$d©a
[0]["USER_NAME"];

400 
$Ãw_d©a
["ID"] = 
$d©a
[0]["USER_ID"];

401 
$Ãw_d©a
["D•t_ID"] = 
$d©a
[0]["DEPT_ID"];

402  
$Ãw_d©a
;

403 
	}
}

405 
public
 
funùiÚ
 
	$upd©e_·sswÜd
(
$OrgID
, 
$u£r_id
, 
$logš_·sswÜd
){

406 
$time
 = 
	`d©e
("Y-m-d H:i:s");

407 
$wh”e
 = 
	`¬¿y
(

408 'Üg_id' => 
$OrgID
,

409 'u£r_id' => 
$u£r_id


411 
$upd©e
 = 
	`¬¿y
(

412 'logš_·sswÜd' => 
$this
->
	`’codePasswÜd
(
$logš_·sswÜd
),

413 'MODIFY_USER_ID' => 
$u£r_id
,

415 
$this
->
db
->
	`£t
('MODIFY_TIME', "to_d©e('" . 
$time
 . "','yyyy-mm-dd hh24:mi:ss')", 
çl£
);

416 
$this
->
db
->
	`upd©e
('tc_u£r',
$upd©e
)->
	`wh”e
(
$wh”e
);

417 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/add.php

2 
public
 
funùiÚ
 
	$add
(){

3 
$this
->{#obj_Çme#}->
db
->
	`qu”y
('SET NAMES UTF8');

4 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

5 {#fÜ—ch 
äom
=
obj_©Œ
 
™em
=
ß
 
key
=
ß_k
#}

6 {#ià{#ß|
©Œ_ty³
#}==14#}

7 
$this
->
lßd
->
	`mod–
('admš/’um_mod–','’um');
$d©a
["{#obj_Çme#}_{#ß|©Œ_Çme#}_’um"]=$this->->
	`g‘li¡
({#ß|
©Œ_id
#});{#/#}{#ià{#ß|
©Œ_ty³
#}==15#}

8 
$this
->
lßd
->
	`mod–
('admš/’um_mod–','’um');
$d©a
["{#obj_Çme#}_{#ß|©Œ_Çme#}_’um"]=$this->->
	`g‘li¡
({#ß|
©Œ_id
#});{#/#}{#ià{#ß|
©Œ_ty³
#}==16#}

9 
$this
->
lßd
->
	`mod–
('admš/’um_mod–','’um');
$d©a
["{#obj_Çme#}_{#ß|©Œ_Çme#}_’um"]=$this->->
	`g‘li¡
({#ß|
©Œ_id
#});{#/#}

10 {#/
fÜ—ch
#}

11 if(!
	`em±y
(
$_POST
)){

12 if(
	`is£t
(
$_GET
['type_id'])){

13 
$_POST
['{#obj_Çme#}']['ty³_id']=
$_GET
['type_id'];

14 
$this
->{#obj_Çme#}->
	`add
(
$_POST
['{#obj_name#}']);

15 
	`sucûss
('www/{#obj_Çme#}?ty³_id='.
$_GET
['type_id'],'åˆ›å»ºæˆåŠŸ');

17 
$this
->{#obj_Çme#}->
	`add
(
$_POST
['{#obj_name#}']);

18 
	`sucûss
('www/{#obj_name#}','åˆ›å»ºæˆåŠŸ');

22 
$this
->
	`»nd”
('www/{#obj_Çme#}/add',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/ajax_list.php

2 
public
 
funùiÚ
 
	$ajax_li¡
(){

3 
$this
->{#obj_Çme#}->
db
->
	`qu”y
('SET NAMES UTF8');

4 ià(!
	`is£t
(
$_GET
['page'])){

5 
$_GET
['page']=1;

7 ià(!
	`is£t
(
$_GET
['perNumber'])){

8 
$_GET
['perNumber']=10;

10 
$d©a
['li¡D©a']=
$this
->{#obj_Çme#}->
	`li¡G‘Info
('',
$_GET
['page'],$_GET['perNumber']);

11 
$d©a
['tÙ®Numb”'] = 
$this
->{#obj_Çme#}->
	`couÁG‘Info
();

12 
$d©a
['³rNumb”'] = 
$_GET
['perNumber'];

13 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

14 
$d©a
['li¡Layout']=
$this
->{#obj_Çme#}->
	`li¡Layout
();

15 
$this
->
ouut
->
	`’abË_´of”
(
çl£
);

16 
$this
->
lßd
->
	`v›w
('www/{#obj_Çme#}/ajax_li¡',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/ajax_select.php

2 
public
 
funùiÚ
 
	$ajax_£Ëù
(){

3 ià(
	`is£t
(
$_POST
["£Ëù_jsÚ"]è
ªd
 $_POST["select_json"]!=""){

4 
$£Ëù_¬r
 = 
	`jsÚ_decode
(
$_POST
["£Ëù_jsÚ"],
Œue
);

5 
$like
["{#obj_Çme#}_".
$£Ëù_¬r
['attr']]=$select_arr['value'];

8 
$like
="";

10 ià(!
	`is£t
(
$_GET
['page'])){

11 
$_GET
['page']=1;

13 ià(!
	`is£t
(
$_GET
['perNumber'])){

14 
$_GET
['perNumber']=10;

16 
$wh”e
="";

17 ià(
	`is£t
(
$_GET
['type_id'])){

18 if(
$_GET
['ty³_id']!="" 
ªd
 $_GET['type_id']!=0){

19 
$wh”e
['ty³_id']=
$_GET
['type_id'];

23 
$d©a
['li¡D©a']=
$this
->{#obj_Çme#}->
	`li¡G‘Info
(
$wh”e
,
$_GET
['·ge'],$_GET['³rNumb”'],
$like
);

24 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

28 {#fÜ—ch1 
äom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

29 {#fÜ—ch2 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

30 
$d©a
['typelistlayout']['{#ta|type_id#}'][]='{#obj_name#}_{#lll|attr_name#}';

31 {#/
fÜ—ch2
#}

32 {#/
fÜ—ch1
#}

35 ià(!
	`is£t
(
$_GET
['perNumber'])){

36 
$_GET
['perNumber']=10;

38 
$d©a
['tÙ®Numb”'] = 
$this
->{#obj_Çme#}->
	`couÁG‘Info
(
$wh”e
,
$like
);

39 
$d©a
['³rNumb”'] = 
$_GET
['perNumber'];

41 
$this
->
ouut
->
	`’abË_´of”
(
çl£
);

42 
$this
->
lßd
->
	`v›w
('www/{#obj_Çme#}/ajax_£Ëù',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/ajax_select_quote-type.php

2 
public
 
funùiÚ
 
	$ajax_£Ëù_quÙe
(){

3 ià(
	`is£t
(
$_POST
["£Ëù_jsÚ"]è
ªd
 $_POST["select_json"]!=""){

4 
$£Ëù_¬r
 = 
	`jsÚ_decode
(
$_POST
["£Ëù_jsÚ"],
Œue
);

5 
$like
["{#obj_Çme#}_".
$£Ëù_¬r
['attr']]=$select_arr['value'];

8 
$like
="";

10 ià(!
	`is£t
(
$_GET
['page'])){

11 
$_GET
['page']=1;

13 ià(!
	`is£t
(
$_GET
['perNumber'])){

14 
$_GET
['perNumber']=10;

16 
$wh”e
="";

17 ià(
	`is£t
(
$_GET
['type_id'])){

18 if(
$_GET
['ty³_id']!="" 
ªd
 $_GET['type_id']!=0){

19 
$wh”e
['ty³_id']=
$_GET
['type_id'];

23 
$d©a
['li¡D©a']=
$this
->{#obj_Çme#}->
	`li¡G‘Info
(
$wh”e
,
$_GET
['·ge'],$_GET['³rNumb”'],
$like
);

24 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

28 {#fÜ—ch1 
äom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

29 {#fÜ—ch2 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

30 
$d©a
['typelistlayout']['{#ta|type_id#}'][]='{#obj_name#}_{#lll|attr_name#}';

31 {#/
fÜ—ch2
#}

32 {#/
fÜ—ch1
#}

35 ià(!
	`is£t
(
$_GET
['perNumber'])){

36 
$_GET
['perNumber']=10;

38 
$d©a
['tÙ®Numb”'] = 
$this
->{#obj_Çme#}->
	`couÁG‘Info
(
$wh”e
,
$like
);

39 
$d©a
['³rNumb”'] = 
$_GET
['perNumber'];

41 
$this
->
ouut
->
	`’abË_´of”
(
çl£
);

42 
$this
->
lßd
->
	`v›w
('www/{#obj_Çme#}/ajax_£Ëù_quÙe',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/ajax_select_quote.php

2 
public
 
funùiÚ
 
	$ajax_£Ëù_quÙe
(){

3 ià(
	`is£t
(
$_POST
["£Ëù_jsÚ"]è
ªd
 $_POST["select_json"]!=""){

4 
$£Ëù_¬r
 = 
	`jsÚ_decode
(
$_POST
["£Ëù_jsÚ"],
Œue
);

5 
$like
["{#obj_Çme#}_".
$£Ëù_¬r
['attr']]=$select_arr['value'];

8 
$like
="";

10 ià(!
	`is£t
(
$_GET
['page'])){

11 
$_GET
['page']=1;

13 ià(!
	`is£t
(
$_GET
['perNumber'])){

14 
$_GET
['perNumber']=10;

16 
$wh”e
="";

18 
$d©a
['li¡D©a']=
$this
->{#obj_Çme#}->
	`li¡G‘Info
(
$wh”e
,
$_GET
['·ge'],$_GET['³rNumb”'],
$like
);

19 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

23 {#fÜ—ch1 
äom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

24 {#fÜ—ch2 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

25 
$d©a
['typelistlayout']['{#ta|type_id#}'][]='{#obj_name#}_{#lll|attr_name#}';

26 {#/
fÜ—ch2
#}

27 {#/
fÜ—ch1
#}

30 ià(!
	`is£t
(
$_GET
['perNumber'])){

31 
$_GET
['perNumber']=10;

33 
$d©a
['tÙ®Numb”'] = 
$this
->{#obj_Çme#}->
	`couÁG‘Info
(
$wh”e
,
$like
);

34 
$d©a
['³rNumb”'] = 
$_GET
['perNumber'];

36 
$this
->
ouut
->
	`’abË_´of”
(
çl£
);

37 
$this
->
lßd
->
	`v›w
('www/{#obj_Çme#}/ajax_£Ëù_quÙe',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/controller.php

1 <?
php


2 
	gşass
 {#obj_Çme_uc#} 
ex‹nds
 
	gWWW_CÚŒŞËr
{

3 
public
 
	g$m’u1
='{#obj_name#}';

5 
public
 
funùiÚ
 
__cÚ¡ruù
(){

6 
	g·»Á
::
__cÚ¡ruù
();

7 
	g$this
->
	glßd
->
mod–
('www/{#obj_name#}_model','{#obj_name#}');

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/del.php

2 
public
 
funùiÚ
 
	$d–
(){

3 
$this
->{#obj_Çme#}->
	`d–
(
$_GET
['{#obj_name#}_id']);

4 
	`sucûss
('www/{#obj_name#}','åˆ é™¤æˆåŠŸ');

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/detailed_list_edit.php

2 
public
 
funùiÚ
 
	$d‘aed_li¡_ed™
(){

3 
$this
->{#obj_Çme#}->
db
->
	`qu”y
('SET NAMES UTF8');

4 
$d©a
['li¡D©a']=
$this
->{#obj_Çme#}->
	`li¡G‘Info
('',1,10);

5 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

6 
$d©a
['li¡Layout']=
$this
->{#obj_Çme#}->
	`li¡Layout
();

8 
$this
->
lßd
->
	`v›w
('www/{#obj_Çme#}/d‘aed_li¡_ed™',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/detailed_list_view.php

2 
public
 
funùiÚ
 
	$d‘aed_li¡_v›w
(){

3 
$this
->{#obj_Çme#}->
db
->
	`qu”y
('SET NAMES UTF8');

4 ià(!
	`is£t
(
$_GET
['page'])){

5 
$_GET
['page']=1;

7 ià(!
	`is£t
(
$_GET
['perNumber'])){

8 
$_GET
['perNumber']=10;

10 
$d©a
['li¡D©a']=
$this
->{#obj_Çme#}->
	`li¡G‘Info
('',
$_GET
['page'],$_GET['perNumber']);

11 
$d©a
['tÙ®Numb”'] = 
$this
->{#obj_Çme#}->
	`couÁG‘Info
();

12 
$d©a
['³rNumb”'] = 
$_GET
['perNumber'];

13 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

14 
$d©a
['li¡Layout']=
$this
->{#obj_Çme#}->
	`li¡Layout
();

15 
$this
->
ouut
->
	`’abË_´of”
(
çl£
);

17 
$this
->
lßd
->
	`v›w
('www/{#obj_Çme#}/d‘aed_li¡_v›w',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/index.php

2 
public
 
funùiÚ
 
	$šdex
(){

3 
$this
->{#obj_Çme#}->
db
->
	`qu”y
('SET NAMES UTF8');

4 ià(!
	`is£t
(
$_GET
['page'])){

5 
$_GET
['page']=1;

7 ià(!
	`is£t
(
$_GET
['perNumber'])){

8 
$_GET
['perNumber']=10;

10 
$d©a
['tÙ®Numb”'] = 
$this
->{#obj_Çme#}->
	`couÁG‘Info
();

11 
$d©a
['³rNumb”'] = 
$_GET
['perNumber'];

12 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

13 
$d©a
['li¡Layout']=
$this
->{#obj_Çme#}->
	`li¡Layout
();

14 
$this
->
	`»nd”
('www/{#obj_Çme#}/li¡',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/index_type.php

2 
public
 
funùiÚ
 
	$šdex
(){

4 
$this
->{#obj_Çme#}->
db
->
	`qu”y
('SET NAMES UTF8');

5 ià(!
	`is£t
(
$_GET
['page'])){

6 
$_GET
['page']=1;

8 ià(!
	`is£t
(
$_GET
['perNumber'])){

9 
$_GET
['perNumber']=10;

14 {#fÜ—ch 
äom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

15 
$d©a
['type_arr']['{#ta|type_id#}']["type_id"]='{#ta|type_id#}';

16 
$d©a
['type_arr']['{#ta|type_id#}']["type_name"]='{#ta|type_name#}';

17 if(
	`is£t
(
$_GET
['type_id'])){

18 if(
$_GET
['ty³_id']=={#|
ty³_id
#}){

19 
$this
->
m’u1
='{#ta|type_label#}';

22 {#/
fÜ—ch
#}

24 
$d©a
['tÙ®Numb”'] = 
$this
->{#obj_Çme#}->
	`couÁG‘Info
();

25 
$d©a
['³rNumb”'] = 
$_GET
['perNumber'];

26 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

27 
$d©a
['li¡Layout']=
$this
->{#obj_Çme#}->
	`li¡Layout
();

28 
$this
->
	`»nd”
('www/{#obj_Çme#}/li¡',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/update.php

2 
public
 
funùiÚ
 
	$upd©e
(){

3 
$this
->{#obj_Çme#}->
db
->
	`qu”y
('SET NAMES UTF8');

4 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

5 
$d©a
['id_aD©a']=
$this
->{#obj_Çme#}->
	`id_aG‘Info
(
$_GET
['{#obj_name#}_id']);

6 
$d©a
['li¡Layout']=
$this
->{#obj_Çme#}->
	`li¡Layout
();

7 {#fÜ—ch 
äom
=
obj_©Œ
 
™em
=
ß
 
key
=
ß_k
#}

8 {#ià{#ß|
©Œ_ty³
#}==14#}

9 
$this
->
lßd
->
	`mod–
('admin/enum_model','enum');

10 
$d©a
["{#obj_Çme#}_{#ß|©Œ_Çme#}_’um"]=
$this
->->
	`g‘li¡
({#ß|
©Œ_id
#});{#/#}{#ià{#ß|
©Œ_ty³
#}==15#}

11 
$this
->
lßd
->
	`mod–
('admin/enum_model','enum');

12 
$d©a
["{#obj_Çme#}_{#ß|©Œ_Çme#}_’um"]=
$this
->->
	`g‘li¡
({#ß|
©Œ_id
#});{#/#}{#ià{#ß|
©Œ_ty³
#}==16#}

13 
$this
->
lßd
->
	`mod–
('admin/enum_model','enum');

14 
$d©a
["{#obj_Çme#}_{#ß|©Œ_Çme#}_’um"]=
$this
->->
	`g‘li¡
({#ß|
©Œ_id
#});{#/#}

15 {#/
fÜ—ch
#}

16 if(!
	`em±y
(
$_POST
)){

17 if(
	`is£t
(
$_GET
['type_id'])){

18 
$_POST
['{#obj_Çme#}']['ty³_id']=
$_GET
['type_id'];

19 
$this
->{#obj_Çme#}->
	`upd©e
(
$_POST
['{#obj_Çme#}'],
$_GET
['{#obj_name#}_id']);

20 
	`sucûss
('www/{#obj_Çme#}?ty³_id='.
$_GET
['type_id'],'æ›´æ–°æˆåŠŸ');

22 
$this
->{#obj_Çme#}->
	`upd©e
(
$_POST
['{#obj_Çme#}'],
$_GET
['{#obj_name#}_id']);

23 
	`sucûss
('www/{#obj_name#}','æ›´æ–°æˆåŠŸ');

26 
$this
->
	`»nd”
('www/{#obj_Çme#}/upd©e',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/view.php

2 
public
 
funùiÚ
 
	$v›w
(){

3 
$this
->{#obj_Çme#}->
db
->
	`qu”y
('SET NAMES UTF8');

4 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

5 
$d©a
['li¡Layout']=
$this
->{#obj_Çme#}->
	`id_aG‘Info
(
$_GET
['{#obj_name#}_id']);

6 
$this
->
	`»nd”
('www/{#obj_Çme#}/v›w',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/lee_cs.php

1 
	g§dasd


2 {#obj_©Œ.0.a
	g‰r_id
#}

3 
	g§dasd


5 
	gasdasd


7 {#fÜ—ch 
	gäom
=
obj_©Œ
 
™em
=
©Œ
 
key
=
©Œ_k
#}

9 {#©Œ|
©Œ_ty³
.
©Œty³_id
#}

10 {#/
fÜ—ch
#}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/models/model.php

1 <?
php


2 
	gşass
 {#obj_Çme_uc#}
_mod–
 
ex‹nds
 
	gCI_Mod–
{

5 
public
 
funùiÚ
 
li¡Layout
(){

6  
¬¿y
(

7 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Î
 
key
=
Î_k
#}

9 {#/
fÜ—ch
#}

14 
public
 
funùiÚ
 
ed™Layout
(){

15  
¬¿y
(

16 {#fÜ—ch 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
–
 
key
=
–_k
#}

18 {#/
fÜ—ch
#}

23 
public
 
funùiÚ
 
v›wLayout
(){

24  
¬¿y
(

25 {#fÜ—ch 
äom
=
v›w_Ïyout
.
Ïyout_¬r
 
™em
=
vl
 
key
=
vl_k
#}

27 {#/
fÜ—ch
#}

32 
public
 
funùiÚ
 
©Œibu‹Lab–s
(){

33  
¬¿y
(

34 {#fÜ—ch 
äom
=
obj_©Œ
 
™em
=
g
 
key
=
k
#}

36 {#/
fÜ—ch
#}

45 
public
 
funùiÚ
 
li¡G‘Info
(
$wh”e
,
$·ge
=1,
$³rNumb”
=10,
$like
=""){

46 
$lim™S¹
 = (
$·ge
-1)*
$³rNumb”
+1-1;

47 
	g$lim™
=
¬¿y
(
$³rNumb”
,
$lim™S¹
);

49 
	g$d©a
 = 
$this
->
G‘Info
(
$wh”e
,
$lim™
,
$like
);

50  
	g$d©a
;

54 
public
 
funùiÚ
 
id_aG‘Info
(
$id
){

55 
	g$wh”e
=
¬¿y
(

56 '{#obj_Çme#}_id'=>
$id


58 
	g$d©a
 = 
$this
->
G‘Info
(
$wh”e
);

59 
	g$d©a
 = 
$d©a
[0];

60  
	g$d©a
;

64 
public
 
funùiÚ
 
upd©e
(
$d©a
,
$id
){

65 
	g$this
->
	gdb
->
wh”e
('{#obj_Çme#}_id',
$id
)->
upd©e
('{#obj_bË_Çme#}',
$d©a
);

69 
public
 
funùiÚ
 
d–
(
$id
){

70 
	g$this
->
	gdb
->
wh”e
('{#obj_Çme#}_id',
$id
)->
d–‘e
('{#obj_table_name#}');

74 
public
 
funùiÚ
 
add
(
$d©a
){

75 
	g$this
->
	gdb
->
š£¹
('{#obj_bË_Çme#}',
$d©a
);

76 
	g$š£¹_id
=
$this
->
db
->
š£¹_id
();

77  
	g$š£¹_id
;

81 
public
 
funùiÚ
 
couÁG‘Info
(
$wh”e
="",
$like
=""){

82 
$this
->
db
->
äom
('{#obj_table_name#}');

83 ià(
	g$wh”e
!=""){

84 
$this
->
db
->
wh”e
(
$wh”e
);

86 ià(
	g$like
!=""){

87 
$this
->
db
->
like
(
$like
);

89 
	g$couÁ
 = 
$this
->
db
->
couÁ_®l_»suÉs
();

90  
	g$couÁ
;

95 
public
 
funùiÚ
 
G‘Info
(
$wh”e
="",
$lim™
="",
$like
=""){

97 
$this
->
db
->
äom
('{#obj_table_name#}');

98 ià(
	g$wh”e
!=""){

99 
$this
->
db
->
wh”e
(
$wh”e
);

101 ià(
	g$lim™
!=""){

102 
$this
->
db
->
lim™
(
$lim™
[0],$limit[1]);

104 ià(
	g$like
!=""){

105 
$this
->
db
->
like
(
$like
);

107 
	g$d©a
=
$this
->
db
->
g‘
()->
»suÉ_¬¿y
();

110 
fÜ—ch
 (
$d©a
 
as
 
$k
=>
$v
){

113 {#fÜ—ch 
äom
=
obj_©Œ
 
™em
=
ß
 
key
=
ß_k
#}

114 {#ià{#ß|
©Œ_ty³
#}==19#}

115 if(
$v
['{#ß|©Œ_f›ld_Çme#}']!="" 
ªd
 $v['{#oa|attr_field_name#}']!=0){

116 
$this
->
lßd
->
mod–
('www/{#oa|attr_quote_id_arr.obj_name#}_model','{#oa|attr_quote_id_arr.obj_name#}');

117 
	g$d©a
[
$k
]['{#ß|©Œ_f›ld_Çme#}_¬r'] = 
$this
->{#ß|
©Œ_quÙe_id_¬r
.
obj_Çme
#}->
id_aG‘Info
(
$v
['{#oa|attr_field_name#}']);

121 {#ià{#ß|
	g©Œ_ty³
#}==14#}

122 if(
$v
['{#ß|©Œ_f›ld_Çme#}']!="" 
ªd
 $v['{#oa|attr_field_name#}']!=0){

123 
$this
->
lßd
->
mod–
('admin/enum_model','enum');

125 
	g$d©a
[
$k
]['{#ß|©Œ_f›ld_Çme#}_¬r']=
$this
->->
g‘li¡
({#ß|
©Œ_id
#},
$d©a
[$k]['{#oa|attr_field_name#}']);

129 {#ià{#ß|
	g©Œ_ty³
#}==15#}

130 if(
$v
['{#ß|©Œ_f›ld_Çme#}']!="" 
ªd
 $v['{#oa|attr_field_name#}']!=0){

131 
$this
->
lßd
->
mod–
('admin/enum_model','enum');

133 
	g$d©a
[
$k
]['{#ß|©Œ_f›ld_Çme#}_¬r']=
$this
->->
g‘li¡
({#ß|
©Œ_id
#},
$d©a
[$k]['{#oa|attr_field_name#}']);

137 {#/
	gfÜ—ch
#}

139  
	g$d©a
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/order/controllers/index_type.php

2 
public
 
funùiÚ
 
	$šdex
(){

4 
$this
->{#obj_Çme#}->
db
->
	`qu”y
('SET NAMES UTF8');

5 ià(!
	`is£t
(
$_GET
['page'])){

6 
$_GET
['page']=1;

8 ià(!
	`is£t
(
$_GET
['perNumber'])){

9 
$_GET
['perNumber']=10;

14 {#fÜ—ch 
äom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

15 
$d©a
['type_arr']['{#ta|type_id#}']["type_id"]='{#ta|type_id#}';

16 
$d©a
['type_arr']['{#ta|type_id#}']["type_name"]='{#ta|type_name#}';

17 if(
	`is£t
(
$_GET
['type_id'])){

18 if(
$_GET
['ty³_id']=={#|
ty³_id
#}){

19 
$this
->
m’u1
='{#ta|type_label#}';

22 {#/
fÜ—ch
#}

24 
$d©a
['select_attr_json']='{#select_attr_json#}';

25 
$d©a
['tÙ®Numb”'] = 
$this
->{#obj_Çme#}->
	`couÁG‘Info
();

26 
$d©a
['³rNumb”'] = 
$_GET
['perNumber'];

27 
$d©a
["Ïb–s"]=
$this
->{#obj_Çme#}->
	`©Œibu‹Lab–s
();

28 
$d©a
['li¡Layout']=
$this
->{#obj_Çme#}->
	`li¡Layout
();

29 
$this
->
	`»nd”
('www/{#obj_Çme#}/li¡',
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/order/models/model.php

1 <?
php


2 
	gşass
 {#obj_Çme_uc#}
_mod–
 
ex‹nds
 
	gCI_Mod–
{

5 
public
 
funùiÚ
 
li¡Layout
(){

6  
¬¿y
(

7 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Î
 
key
=
Î_k
#}

9 {#/
fÜ—ch
#}

14 
public
 
funùiÚ
 
ed™Layout
(){

15  
¬¿y
(

16 {#fÜ—ch 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
–
 
key
=
–_k
#}

18 {#/
fÜ—ch
#}

23 
public
 
funùiÚ
 
v›wLayout
(){

24  
¬¿y
(

25 {#fÜ—ch 
äom
=
v›w_Ïyout
.
Ïyout_¬r
 
™em
=
vl
 
key
=
vl_k
#}

27 {#/
fÜ—ch
#}

32 
public
 
funùiÚ
 
©Œibu‹Lab–s
(){

33  
¬¿y
(

34 {#fÜ—ch 
äom
=
obj_©Œ
 
™em
=
g
 
key
=
k
#}

36 {#/
fÜ—ch
#}

45 
public
 
funùiÚ
 
li¡G‘Info
(
$wh”e
,
$·ge
=1,
$³rNumb”
=10,
$like
=""){

46 
$lim™S¹
 = (
$·ge
-1)*
$³rNumb”
+1-1;

47 
	g$lim™
=
¬¿y
(
$³rNumb”
,
$lim™S¹
);

49 
	g$d©a
 = 
$this
->
G‘Info
(
$wh”e
,
$lim™
,
$like
);

50  
	g$d©a
;

54 
public
 
funùiÚ
 
id_aG‘Info
(
$id
){

55 
	g$wh”e
=
¬¿y
(

56 '{#obj_Çme#}_id'=>
$id


58 
	g$d©a
 = 
$this
->
G‘Info
(
$wh”e
);

59 
	g$d©a
 = 
$d©a
[0];

60  
	g$d©a
;

64 
public
 
funùiÚ
 
upd©e
(
$d©a
,
$id
){

65 
	g$this
->
	gdb
->
wh”e
('{#obj_Çme#}_id',
$id
)->
upd©e
('{#obj_bË_Çme#}',
$d©a
);

69 
public
 
funùiÚ
 
d–
(
$id
){

70 
	g$this
->
	gdb
->
wh”e
('{#obj_Çme#}_id',
$id
)->
d–‘e
('{#obj_table_name#}');

74 
public
 
funùiÚ
 
add
(
$d©a
){

75 
	g$this
->
	gdb
->
š£¹
('{#obj_bË_Çme#}',
$d©a
);

76 
	g$š£¹_id
=
$this
->
db
->
š£¹_id
();

77  
	g$š£¹_id
;

81 
public
 
funùiÚ
 
couÁG‘Info
(
$wh”e
="",
$like
=""){

82 
$this
->
db
->
äom
('{#obj_table_name#}');

83 ià(
	g$wh”e
!=""){

84 
$this
->
db
->
wh”e
(
$wh”e
);

86 ià(
	g$like
!=""){

87 
$this
->
db
->
like
(
$like
);

89 
	g$couÁ
 = 
$this
->
db
->
couÁ_®l_»suÉs
();

90  
	g$couÁ
;

95 
public
 
funùiÚ
 
G‘Info
(
$wh”e
="",
$lim™
="",
$like
=""){

97 
$this
->
db
->
äom
('{#obj_table_name#}');

98 ià(
	g$wh”e
!=""){

99 
$this
->
db
->
wh”e
(
$wh”e
);

101 ià(
	g$lim™
!=""){

102 
$this
->
db
->
lim™
(
$lim™
[0],$limit[1]);

104 ià(
	g$like
!=""){

105 
$this
->
db
->
like
(
$like
);

107 
	g$d©a
=
$this
->
db
->
g‘
()->
»suÉ_¬¿y
();

110 
fÜ—ch
 (
$d©a
 
as
 
$k
=>
$v
){

113 {#fÜ—ch 
äom
=
obj_©Œ
 
™em
=
ß
 
key
=
ß_k
#}

114 {#ià{#ß|
©Œ_ty³
#}==19#}

115 if(
$v
['{#ß|©Œ_f›ld_Çme#}']!="" 
ªd
 $v['{#oa|attr_field_name#}']!=0){

116 
$this
->
lßd
->
mod–
('www/{#oa|attr_quote_id_arr.obj_name#}_model','{#oa|attr_quote_id_arr.obj_name#}');

117 
	g$d©a
[
$k
]['{#ß|©Œ_f›ld_Çme#}_¬r'] = 
$this
->{#ß|
©Œ_quÙe_id_¬r
.
obj_Çme
#}->
id_aG‘Info
(
$v
['{#oa|attr_field_name#}']);

121 {#ià{#ß|
	g©Œ_ty³
#}==14#}

122 if(
$v
['{#ß|©Œ_f›ld_Çme#}']!="" 
ªd
 $v['{#oa|attr_field_name#}']!=0){

123 
$this
->
lßd
->
mod–
('admin/enum_model','enum');

125 
	g$d©a
[
$k
]['{#ß|©Œ_f›ld_Çme#}_¬r']=
$this
->->
g‘li¡
({#ß|
©Œ_id
#},
$d©a
[$k]['{#oa|attr_field_name#}']);

129 {#ià{#ß|
	g©Œ_ty³
#}==15#}

130 if(
$v
['{#ß|©Œ_f›ld_Çme#}']!="" 
ªd
 $v['{#oa|attr_field_name#}']!=0){

131 
$this
->
lßd
->
mod–
('admin/enum_model','enum');

133 
	g$d©a
[
$k
]['{#ß|©Œ_f›ld_Çme#}_¬r']=
$this
->->
g‘li¡
({#ß|
©Œ_id
#},
$d©a
[$k]['{#oa|attr_field_name#}']);

137 {#/
	gfÜ—ch
#}

139  
	g$d©a
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/order/views/index.php

1 <
div
 
	gşass
="all-sidebar">

2 <
div
 
şass
="row-fluid">

3 <
div
 
şass
="span12">

4 <
div
 
şass
="widget">

5 <
div
 
şass
="widget-header">

6 <
div
 
şass
="title">

7 <?
php
 if(
is£t
(
$_GET
['type_id'])){

8 if(
is£t
(
$ty³_¬r
[
$_GET
['type_id']]['type_name'])){

9 
echo
 
$ty³_¬r
[
$_GET
['type_id']]['type_name'];

11 
	gecho
 '{#obj_label#}';

14 
	gecho
 '{#obj_label#}';

17 <
¥ª
 
	gşass
="mini-title">

19 </
¥ª
>

20 </
div
>

21 <
¥ª
 
şass
="tools">

23 <
a
 
şass
="fs1" 
d©a
-
icÚ
="&#xe090;" 
¬Ÿ
-
hidd’
="Œue" d©a-
Üigš®
-
t™Ë
=""></a>

25 </
¥ª
>

26 </
div
>

27 <
div
 
şass
="widget-body">

28 <
div
 
şass
="row-fluid">

29 <
div
 
şass
="leebutton">

30 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
¡¬t
-->

31 <
div
 
şass
="btn-group">

32 <
a
 
id
="Ãw{#obj_Çme#}" 
şass
="bŠ bŠ-´im¬y" 
h»f
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/add')?>" 
d©a
-
toggË
="dropdown">

33 <
i
 
şass
="icon-file"></i>

35 </
a
>

36 <
ul
 
şass
="drİdown-m’u" 
rŞe
="menu">

37 <?
php
 
fÜ—ch
 (
$ty³_¬r
 
as
 
$k
=>
$v
){ ?>

38 <
li
>

39 <
a
 
h»f
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/add?ty³_id='.$v['ty³_id']);?>">æ–°å¢<?
php
 
echo
 
$v
['ty³_Çme'];?></
	ga
>

40 </
	gli
>

41 <?
	gphp
 }?>

42 </
	gul
>

43 </
	gdiv
>

44 <!--
	gËe
 æŒ‰é’®éƒ¨åˆ† 
	g’d
-->

45 </
	gdiv
>

46 <
div
 
	gid
="divmessagelist">

48 <
div
 
şass
="grid-view">

49 <
div
 
id
="{#obj_name#}_list"></div>

50 <
div
>

51 <
süt
 
ty³
="text/javascript">

52 
$
(
docum’t
).
»ady
(
funùiÚ
 () {

53 
$£ËùA‰r
=[

54 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

56 {#/
fÜ—ch
#}

59 
$
("#{#obj_Çme#}_li¡").
ËeD©aTabË
({

60 
£ËùA‰r
:
$£ËùA‰r
,

61 
u¾
:"<?phpƒcho site_url('www/{#obj_name#}/ajax_select'); ?>",

62 
³rNumb”
:5

66 </
	gsüt
>

67 </
	gdiv
>

68 </
	gdiv
>

69 </
	gdiv
>

70 </
	gdiv
>

71 </
	gdiv
>

72 </
	gdiv
>

73 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/order/views/list.php

1 <
bË
 
	gşass
="tableable-stripedable-borderedable-hover">

2 <
th—d
>

3 <
Œ
>

4 <
th
 
width
="100">æ“ä½œ</th>

7 <?
php


8 
fÜ—ch
(
$ty³li¡Ïyout
 
as
 
$k
=>
$v
){

9 ià(
$_GET
["ty³_id"]==
$k
){

10 
fÜ—ch
(
$v
 
as
 
$k2
=>
$v2
){

11 
echo
 "<th>".
$Ïb–s
[
$v2
]."</th>";

15 if(
	g$_GET
["ty³_id"]=="" 
Ü
 
$_GET
["type_id"]==0){

16 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

17 
echo
 "<th>".
$Ïb–s
['{#obj_name#}_{#lll|attr_name#}']."</th>";

18 {#/
	gfÜ—ch
#}

22 {#fÜ—ch 
	gäom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

23 <
th
><?
php
 
echo
 
$Ïb–s
['{#obj_Çme#}_{#Îl|©Œ_Çme#}'];?></
	gth
>

24 {#/
	gfÜ—ch
#}

27 </
	gŒ
>

28 </
	gth—d
>

29 <
	gtbody
>

30 <?
php
 
fÜ—ch
(
$li¡D©a
 
as
 
$li¡D©a_v®ue
){?>

31 <
	gŒ
>

32 <
td
 
	g¡yË
="text-align:left">

33 <
div
 
şass
="btn-toolbar">

34 <
div
 
şass
="btn-group">

35 <
a
 
şass
="bŠ bŠ-sm®ÈbŠ-´im¬y" 
h»f
="<?phpƒcho site_url('www/{#obj_name#}/view').'?{#obj_name#}_id='.$listData_value['{#obj_name#}_id'].'&type_id='.$_GET['type_id'] ?>">æŸ¥çœ‹</a>

36 <
bu‰Ú
 
şass
="bŠ bŠ-sm®Èdrİdown-toggË bŠ-´im¬y" 
d©a
-
toggË
="dropdown">

37 <
¥ª
 
şass
="caret"></span>

38 </
bu‰Ú
>

39 <
ul
 
şass
="dropdown-menu">

40 <
li
>

41 <
a
 
id
="<?ph°echØ$li¡D©a_v®ue['{#obj_Çme#}_id'];?>" 
şass
="add_salespay">æ–°å¢å…¥æ¬¾é¡¹</a>

42 </
li
>

43 <
li
>

44 <
a
 
h»f
="/yii/newrevenue/backend.php?r=salesOrder/view&order_id=15&active=1">å¤„ç†å…¥æ¬¾é¡¹</a>

45 </
li
>

46 <
li
>

47 <
a
 
id
="15" 
şass
="apply_invoice">ç”³è¯·å¼€ç¥¨</a>

48 </
li
>

49 <
li
>

50 <
a
 
h»f
="/yii/newrevenue/backend.php?r=salesOrder/view&order_id=15&active=2">å¤„ç†ç¥¨æ®</a>

51 </
li
>

52 <
li
>

53 <
a
 
h»f
="/yii/newrevenue/backend.php?r=salesOrder/view&order_id=15&active=4">å¤„ç†è¿”ç‚¹</a>

54 </
li
>

55 </
ul
>

56 </
div
>

57 </
div
>

58 </
td
>

61 <?
php
 
$_GET
["type_id"]){

65 {#fÜ—ch1 
	gäom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

66 <?
php
 {#|
ty³_id
#}: ?>

67 {#fÜ—ch2 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

68 <
td
>

69 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

70 </
td
>

71 {#/
fÜ—ch2
#}

72 <?
php
 ; ?>

73 {#/
	gfÜ—ch1
#}

74 <?
php
 : ?>

75 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

76 <
td
>

77 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

78 </
td
>

79 {#/
fÜ—ch
#}

80 <?
php
 } ?>

82 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

83 <
td
>

84 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

85 </
td
>

86 {#/
fÜ—ch
#}

90 </
Œ
>

91 <?
php
 }?>

92 </
tbody
>

94 </
bË
>

95 <
div
 
id
="d©a-bË_šfo" 
¡yË
="æßt:Ëá">å…±æŸ¥è¯¢åˆ°<?
php
 
echo
 
$tÙ®Numb”
;?>æ¡</
	gdiv
>

96 <
šput
 
	gty³
='hidd’' 
id
='tÙ®Numb”' 
v®ue
="<?phpƒcho $totalNumber;?>">

97 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/salespay/controllers/ajax_add.php

2 
public
 
funùiÚ
 
	$ajax_add
(){

3 
$this
->
§Ë¥ay
->
db
->
	`qu”y
('SET NAMES UTF8');

4 if(
	`is£t
(
$_GET
['order_id'])){

5 
$this
->
lßd
->
	`mod–
('www/order_model','order');

6 
$d©a
["Üd”_d©a"]=
$this
->
Üd”
->
	`id_aG‘Info
(
$_GET
['order_id']);

7 
$d©a
["Ïb–s"]=
$this
->
§Ë¥ay
->
	`©Œibu‹Lab–s
();

8 
$this
->
lßd
->
	`mod–
('admš/’um_mod–','’um');
$d©a
["§Ë¥ay_·y_m‘hod_’um"]=$this->->
	`g‘li¡
(144);

9 
$this
->
lßd
->
	`mod–
('admš/’um_mod–','’um');
$d©a
["§Ë¥ay_¡©us_’um"]=$this->->
	`g‘li¡
(146);

10 
$this
->
lßd
->
	`v›w
('www/§Ë¥ay/ajax_add',
$d©a
);

12 
echo
 "ä¸èƒ½æ²¡æœ‰ID";

14 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/salespay/views/ajax_add.php

1 <!--
	gËe
 å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

2 <
div
 
	gşass
="grid-view">

3 <
fÜm
 
şass
="fÜm-hÜizÚl" 
id
="§Ë¥ay-fÜm" 
aùiÚ
="<?ph°echØs™e_u¾('www/§Ë¥ay/add');?>" 
m‘hod
="post">

4 <
div
 
şass
="control-group">

5 <
Ïb–
 
şass
="control-label„equired" ="salespay_create_time">

7 <
¥ª
 
şass
="required"></span>

8 </
Ïb–
>

9 <
div
 
şass
="controls">

10 <
div
 
şass
="group-text">

11 <
bË
 
şass
="tableable-bordered">

12 <
tbody
>

13 <
Œ
>

14 <
td
 
width
="10%">è®¢å•æ€»é‡‘é¢</td>

15 <
td
 
width
="10%"><?
php
 
echo
 
$Üd”_d©a
['Üd”_amouÁ'];?></
	gtd
>

16 <
td
 
	gwidth
="10%">å¯åˆ°å¸é‡‘é¢</td>

17 <
td
 
width
="10%"><?
php
 
echo
 
$Üd”_d©a
['Üd”_amouÁ'];?></
	gtd
>

18 <
	gŒ
>

19 </
	gŒ
>

20 <
td
 
	gwidth
="10%">å·²ç¡®è®¤åˆ°å¸</td>

21 <
td
 
width
="10%"><?
php
 
echo
 
$Üd”_d©a
['Üd”_amouÁ'];?></
	gtd
>

22 <
td
 
	gwidth
="10%">æœªç¡®è®¤åˆ°å¸</td>

23 <
td
 
width
="10%"><?
php
 
echo
 
$Üd”_d©a
['Üd”_amouÁ'];?></
	gtd
>

25 </
	gŒ
>

26 </
	gtbody
>

27 </
	gbË
>

28 </
	gdiv
>

29 </
	gdiv
>

30 </
	gdiv
>

33 <
div
 
	gşass
="control-group">

34 <
Ïb–
 
şass
="control-label„equired" ="salespay_create_time">

36 <
¥ª
 
şass
="required"></span>

37 </
Ïb–
>

38 <
div
 
şass
="controls">

39 <
div
 
şass
="group-text">

40 <?
php
 
echo
 
$Üd”_d©a
['order_amount'];?>

41 </
	gdiv
>

42 </
	gdiv
>

43 </
	gdiv
>

44 <
div
 
	gşass
="control-group">

45 <
Ïb–
 
şass
="control-label„equired" ="salespay_create_time">

47 <
¥ª
 
şass
="required"></span>

48 </
Ïb–
>

49 <
div
 
şass
="controls">

50 <
div
 
şass
="group-text">

51 <?
php
 
echo
 
$Üd”_d©a
['order_amount'];?>

52 </
	gdiv
>

53 </
	gdiv
>

54 </
	gdiv
>

55 <
div
 
	gşass
="control-group">

56 <
Ïb–
 
şass
="control-label„equired" ="salespay_create_time">

58 <
¥ª
 
şass
="required"></span>

59 </
Ïb–
>

60 <
div
 
şass
="controls">

61 <
div
 
şass
="group-text">

62 <?
php
 
echo
 
$Üd”_d©a
['order_amount'];?>

63 </
	gdiv
>

64 </
	gdiv
>

65 </
	gdiv
>

66 <
div
 
	gşass
="control-group">

67 <
Ïb–
 
şass
="control-label„equired" ="salespay_create_time">

69 <
¥ª
 
şass
="required"></span>

70 </
Ïb–
>

71 <
div
 
şass
="controls">

72 <
div
 
şass
="group-text">

73 <?
php
 
echo
 
$Üd”_d©a
['order_amount'];?>

74 </
	gdiv
>

75 </
	gdiv
>

76 </
	gdiv
>

78 <
div
 
	gşass
="control-group">

79 <
Ïb–
 
şass
="control-label„equired" ="salespay_pay_amount">

81 <
¥ª
 
şass
="required"></span>

82 </
Ïb–
>

83 <
div
 
şass
="controls">

84 <
šput
 
size
="16" 
ty³
="‹xt" 
Çme
="salespay[salespay_pay_amount]">

85 </
div
>

86 </
div
>

90 <
div
 
şass
="control-group">

91 <
Ïb–
 
şass
="control-label„equired" ="salespay_pay_date">

92 <?
php
 
echo
 
$Ïb–s
["salespay_pay_date"];?>

93 <
¥ª
 
	gşass
="required"></span>

94 </
Ïb–
>

95 <
div
 
şass
="controls">

96 <
div
 
şass
="šput-­³nd d©fÜm_d©e" 
id
="salespay_pay_date">

97 <
šput
 
size
="16" 
ty³
="‹xt" 
Çme
="§Ë¥ay[§Ë¥ay_·y_d©e]" 
¡yË
="width: 154px;" 
v®ue
="">

98 <
¥ª
 
şass
="add-Ú"><
i
 class="icon-close"></i></span>

99 <
¥ª
 
şass
="add-Ú"><
i
 class="icon-clock"></i></span>

100 </
div
>

101 <
süt
 
ty³
="text/javascript">

102 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

103 
	`$
('#§Ë¥ay_·y_d©e').
	`d©‘im•ick”
({

104 
Ïnguage
: 'zh-CN',

105 
w“kS¹
: 1,

106 
todayBŠ
: 1,

107 
autoşo£
: 1,

108 
todayHighlight
: 1,

109 
¡¬tV›w
: 2,

110 
mšV›w
: 1,

111 
fÜûP¬£
: 0,

112 
fÜm©
:'yyyy-mm-dd hh:ii:ss'

114 
	}
});

115 </
	gsüt
>

116 <
¥ª
 
	gşass
="help-inline"></span>

117 </
div
>

118 </
div
>

120 <
div
 
şass
="control-group">

121 <
Ïb–
 
şass
="control-label„equired" ="salespay_pay_method">

122 <?
php
 
echo
 
$Ïb–s
["salespay_pay_method"];?>

123 <
¥ª
 
	gşass
="required"></span>

124 </
Ïb–
>

125 <
div
 
şass
="controls">

126 <
£Ëù
 
id
="§Ë¥ay_·y_m‘hod" 
Çme
="salespay[salespay_pay_method]">

127 <?
php
 
	$fÜ—ch
(
$§Ë¥ay_·y_m‘hod_’um
 
as
 
$·y_m‘hod_v
){ ?>

128 <
İtiÚ
 
v®ue
="<?phpƒcho $pay_method_v['enum_key'];?>">

129 <?
php
 
echo
 
$·y_m‘hod_v
['enum_name'];?>

130 </
İtiÚ
>

131 <?
php
 
	}
} ?>

132 </
	g£Ëù
>

133 </
	gdiv
>

134 </
	gdiv
>

136 <
div
 
	gşass
="control-group">

137 <
div
 
şass
="controls">

138 <
div
 
id
="»m™_šfo" 
şass
="well…ayinfo">

139 <
div
 
şass
="form-horizontal">

140 <
div
 
şass
="control-group">

141 <
Ïb–
 
şass
="cÚŒŞ-Ïb–" 
¡yË
="width: 120px;">æ±‡æ¬¾è´¦æˆ·ï¼š</label>

142 <
div
 
şass
="cÚŒŞs" 
¡yË
="margin-left: 120px;">

143 <
£Ëù
 
id
="couÁry" 
Çme
="payinfo[remit_bank]">

144 <
İtiÚ
 
v®ue
="1001">

146 </
İtiÚ
>

147 <
İtiÚ
 
v®ue
="1002">

149 </
İtiÚ
>

150 <
İtiÚ
 
v®ue
="1003">

152 </
İtiÚ
>

153 <
İtiÚ
 
v®ue
="1004">

155 </
İtiÚ
>

156 <
İtiÚ
 
v®ue
="1005">

158 </
İtiÚ
>

159 <
İtiÚ
 
v®ue
="1006">

161 </
İtiÚ
>

162 <
İtiÚ
 
v®ue
="1007">

163 
Pay·l
ï¼ˆè´å®ï¼‰

164 </
İtiÚ
>

165 </
£Ëù
>

166 </
div
>

167 </
div
>

168 <
div
 
şass
="control-group">

169 <
Ïb–
 
şass
="cÚŒŞ-Ïb–" 
¡yË
="width: 120px;">æ±‡æ¬¾äººå§“åï¼š</label>

170 <
div
 
şass
="cÚŒŞs" 
¡yË
="margin-left: 120px;">

171 <
šput
 
ty³
="‹xt" 
Çme
="payinfo[remit_person]">

172 </
div
>

173 </
div
>

174 <
div
 
şass
="control-group">

175 <
Ïb–
 
şass
="cÚŒŞ-Ïb–" 
¡yË
="width: 120px;">æ±‡æ¬¾äººé“¶è¡Œè´¦å·ï¼š</label>

176 <
div
 
şass
="cÚŒŞs" 
¡yË
="margin-left: 120px;">

177 <
šput
 
ty³
="‹xt" 
Çme
="payinfo[remit_account]">

178 </
div
>

179 </
div
>

180 </
div
>

181 </
div
>

182 <
div
 
id
="®ay_šfo" 
şass
="w–È·yšfo" 
¡yË
="display:none;">

183 <
div
 
şass
="control-group">

184 <
Ïb–
 
şass
="cÚŒŞ-Ïb–" 
¡yË
="width: 120px;">å…¥å¸æ”¯ä»˜å®å¸å·ï¼š</label>

185 <
div
 
şass
="cÚŒŞs" 
¡yË
="margin-left: 120px;">

186 <
£Ëù
 
id
="couÁry" 
Çme
="payinfo[remit_bank]">

187 <
İtiÚ
 
v®ue
="1001">

188 
·ym’t
@
shİex
.
ú


189 </
İtiÚ
>

190 <
İtiÚ
 
v®ue
="1002">

191 
®ay_f
@
shİex
.
ú


192 </
İtiÚ
>

193 <
İtiÚ
 
v®ue
="1003">

194 
wªggou
@
shİex
.
ú


195 </
İtiÚ
>

196 <
İtiÚ
 
v®ue
="1004">

197 
_obao
@
shİex
.
ú


198 </
İtiÚ
>

199 <
İtiÚ
 
v®ue
="1005">

200 
shªg·i
@
shİex
.
ú


201 </
İtiÚ
>

202 <
İtiÚ
 
v®ue
="1006">

203 
weishªgye
@
shİex
.
ú


204 </
İtiÚ
>

205 <
İtiÚ
 
v®ue
="1007">

206 
b2bobao
@
shİex
.
ú


207 </
İtiÚ
>

208 <
İtiÚ
 
v®ue
="1008">

209 
sms_®ay
@
shİex
.
ú


210 </
İtiÚ
>

211 <
İtiÚ
 
v®ue
="1009">

212 
wdwd_®ay
@
shİex
.
ú


213 </
İtiÚ
>

214 <
İtiÚ
 
v®ue
="1010">

215 
iwªcu
@
shİex
.
ú


216 </
İtiÚ
>

217 </
£Ëù
>

218 </
div
>

219 </
div
>

220 <
div
 
şass
="control-group">

221 <
Ïb–
 
şass
="cÚŒŞ-Ïb–" 
¡yË
="width: 120px;">äº¤æ˜“å·ï¼š</label>

222 <
div
 
şass
="cÚŒŞs" 
¡yË
="margin-left: 120px;">

223 <
šput
 
ty³
="‹xt" 
Çme
="payinfo[alipay_order]">

224 </
div
>

225 </
div
>

226 <
div
 
şass
="control-group">

227 <
Ïb–
 
şass
="cÚŒŞ-Ïb–" 
¡yË
="width: 120px;">æ”¯ä»˜å®è´¦å·ï¼š</label>

228 <
div
 
şass
="cÚŒŞs" 
¡yË
="margin-left: 120px;">

229 <
šput
 
ty³
="‹xt" 
Çme
="payinfo[alipay_account]">

230 </
div
>

231 </
div
>

232 </
div
>

233 <
div
 
id
="check_šfo" 
şass
="w–È·yšfo" 
¡yË
="display:none;">

234 <
div
 
şass
="control-group">

235 <
Ïb–
 
şass
="cÚŒŞ-Ïb–" 
¡yË
="width: 120px;">æ”¯ç¥¨åç§°ï¼š</label>

236 <
div
 
şass
="cÚŒŞs" 
¡yË
="margin-left: 120px;">

237 <
šput
 
ty³
="‹xt" 
Çme
="payinfo[check_name]">

238 </
div
>

239 </
div
>

240 </
div
>

241 <
div
 
id
="ÿsh_šfo" 
şass
="·yšfo" 
¡yË
="display:none;"> </div>

243 </
div
>

244 </
div
>

245 <
süt
 
ty³
="text/javascript">

246 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

247 
	`$
('#§Ë¥ay_·y_m‘hod').
	`chªge
(
	`funùiÚ
(){

249 
’umkey
 = 
	`$
(
this
).
	`v®
();

250 if(
’umkey
==1001){

251 
	`$
(".·yšfo").
	`hide
();

252 
	`$
("#»m™_šfo").
	`show
();

254 if(
’umkey
==1002){

255 
	`$
(".·yšfo").
	`hide
();

256 
	`$
("#®ay_šfo").
	`show
();

258 if(
’umkey
==1003){

259 
	`$
(".·yšfo").
	`hide
();

260 
	`$
("#check_šfo").
	`show
();

262 if(
’umkey
==1004){

263 
	`$
(".·yšfo").
	`hide
();

264 
	`$
("#ÿsh_šfo").
	`show
();

267 
	}
});

268 </
	gsüt
>

269 <
div
 
	gşass
="control-group">

270 <
Ïb–
 
şass
="control-label„equired" ="salespay_pay_note">

271 <?
php
 
echo
 
$Ïb–s
["salespay_pay_note"];?>

272 </
	gÏb–
>

273 <
div
 
	gşass
="controls">

274 <
‹x»a
 
Çme
="§Ë¥ay[§Ë¥ay_·y_nÙe]" 
id
="§Ë¥ay_·y_nÙe" 
¡yË
="width:400px" 
rows
="6"></textarea>

275 </
div
>

276 </
div
>

279 <!-- æŒ‰é’®åŒºåŸŸ 
¡¬t
 -->

281 <
div
 
şass
="form-actions">

282 <
bu‰Ú
 
şass
="bŠ bŠ-´im¬y" 
ty³
="submit">ä¿å­˜</button>

283 </
div
>

285 <!-- æŒ‰é’®åŒºåŸŸ 
’d
 -->

286 </
fÜm
>

287 </
div
>

288 <!--
Ëe
 å†…å®¹éƒ¨åˆ† 
’d
-->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/add.php

1 <
div
 
	gşass
="all-sidebar">

2 <
div
 
şass
="row-fluid">

3 <
div
 
şass
="span12">

4 <
div
 
şass
="widget">

5 <
div
 
şass
="widget-header">

6 <
div
 
şass
="title">

8 <
¥ª
 
şass
="mini-title">

10 </
¥ª
>

11 </
div
>

12 <
¥ª
 
şass
="tools">

14 <
a
 
şass
="fs1" 
d©a
-
icÚ
="&#xe090;" 
¬Ÿ
-
hidd’
="Œue" d©a-
Üigš®
-
t™Ë
=""></a>

16 </
¥ª
>

17 </
div
>

18 <
div
 
şass
="widget-body">

19 <
div
 
şass
="row-fluid">

20 <
div
 
şass
="leebutton">

21 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
¡¬t
-->

22 <
a
 
id
="yw0" 
şass
="bŠ bŠ-´im¬y" 
h»f
="<?phpƒcho site_url('www/{#obj_name#}/')?>">

23 <
i
 
şass
="icon-undo"></i>

25 </
a
>

26 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
’d
-->

27 </
div
>

28 <
div
 
id
="divmessagelist">

29 <
div
>

30 <!--
Ëe
 å†…å®¹éƒ¨åˆ† 
¡¬t
-->

31 <
div
 
şass
="grid-view">

32 <
fÜm
 
şass
="fÜm-hÜizÚl" 
id
="d•¬tm’t-fÜm" 
aùiÚ
="<?ph°if(!is£t($_GET['ty³_id'])){echØs™e_u¾('www/{#obj_Çme#}/add');}–£{echØs™e_u¾('www/{#obj_Çme#}/add?ty³_id='.$_GET['ty³_id']);}?>" 
m‘hod
="post">

33 <?
php
 if({#is_obj_type#}==1){?>

34 <?
php
 if(!
is£t
(
$_GET
['type_id'])){ ?>

35 {#fÜ—ch 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

36 <
div
 
şass
="control-group">

37 <
Ïb–
 
şass
="control-label„equired" ="{#obj_name#}_{#lll|attr_name#}">

38 <?
php
 
echo
 
$Ïb–s
["{#lll|attr_id_arr.attr_field_name#}"];?>

39 {#ià{#Îl|
	gis_»quœed
#}==1#}<
¥ª
 
şass
="required">*</span>{#else#}<span class="required"></span>{#/#}

40 </
Ïb–
>

41 <
div
 
şass
="controls">

42 {#šşud
v›ws
/
©Œty³
/
ed™
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_ed™_‹m¶©e
#}#}

43 <
¥ª
 
şass
="help-inline"></span>

44 </
div
>

45 </
div
>

46 {#/
fÜ—ch
#}

47 <?
php
 }{ ?>

48 <?
php
 
$_GET
["type_id"]){

52 {#fÜ—ch1 
	gäom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

53 <?
php
 {#|
ty³_id
#}: ?>

54 {#fÜ—ch2 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

55 <
div
 
şass
="control-group">

56 <
Ïb–
 
şass
="control-label„equired" ="{#obj_name#}_{#lll|attr_name#}">

57 <?
php
 
echo
 
$Ïb–s
["{#lll|attr_id_arr.attr_field_name#}"];?>

58 {#ià{#Îl|
	gis_»quœed
#}==1#}<
¥ª
 
şass
="required">*</span>{#else#}<span class="required"></span>{#/#}

59 </
Ïb–
>

60 <
div
 
şass
="controls">

61 {#šşud
v›ws
/
©Œty³
/
ed™
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_ed™_‹m¶©e
#}#}

62 <
¥ª
 
şass
="help-inline"></span>

63 </
div
>

64 </
div
>

65 {#/
fÜ—ch2
#}

66 <?
php
 ; ?>

67 {#/
	gfÜ—ch1
#}

68 <?
php
 : ?>

69 {#fÜ—ch 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

70 <
div
 
şass
="control-group">

71 <
Ïb–
 
şass
="control-label„equired" ="{#obj_name#}_{#lll|attr_name#}">

72 <?
php
 
echo
 
$Ïb–s
["{#lll|attr_id_arr.attr_field_name#}"];?>

73 {#ià{#Îl|
	gis_»quœed
#}==1#}<
¥ª
 
şass
="required">*</span>{#else#}<span class="required"></span>{#/#}

74 </
Ïb–
>

75 <
div
 
şass
="controls">

76 {#šşud
v›ws
/
©Œty³
/
ed™
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_ed™_‹m¶©e
#}#}

77 <
¥ª
 
şass
="help-inline"></span>

78 </
div
>

79 </
div
>

80 {#/
fÜ—ch
#}

81 <?
php
 }?>

82 <?
php
 }}{ ?>

83 {#fÜ—ch 
	gäom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

84 <
div
 
şass
="control-group">

85 <
Ïb–
 
şass
="control-label„equired" ="{#obj_name#}_{#lll|attr_name#}">

86 <?
php
 
echo
 
$Ïb–s
["{#lll|attr_id_arr.attr_field_name#}"];?>

87 {#ià{#Îl|
	gis_»quœed
#}==1#}<
¥ª
 
şass
="required">*</span>{#else#}<span class="required"></span>{#/#}

88 </
Ïb–
>

89 <
div
 
şass
="controls">

90 {#šşud
v›ws
/
©Œty³
/
ed™
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_ed™_‹m¶©e
#}#}

91 <
¥ª
 
şass
="help-inline"></span>

92 </
div
>

93 </
div
>

94 {#/
fÜ—ch
#}

95 <?
php
 }?>

97 <!-- æŒ‰é’®åŒºåŸŸ 
¡¬t
 -->

98 <
div
 
şass
="form-actions">

99 <
bu‰Ú
 
şass
="bŠ bŠ-´im¬y" 
ty³
="submit">ä¿å­˜</button>

100 </
div
>

101 <!-- æŒ‰é’®åŒºåŸŸ 
’d
 -->

102 </
fÜm
>

103 </
div
>

104 <!--
Ëe
 å†…å®¹éƒ¨åˆ† 
’d
-->

105 </
div
>

106 </
div
>

107 </
div
>

108 </
div
>

109 </
div
>

110 </
div
>

111 </
div
>

112 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/ajax_list.php

1 <
div
 
	gşass
="all-sidebar">

2 <
div
 
şass
="row-fluid">

3 <
div
 
şass
="span12">

4 <
div
 
şass
="widget">

5 <
div
 
şass
="widget-header">

6 <
div
 
şass
="title">

7 <?
php
 if(
is£t
(
$_GET
['type_id'])){

8 if(
is£t
(
$ty³_¬r
[
$_GET
['type_id']]['type_name'])){

9 
echo
 
$ty³_¬r
[
$_GET
['type_id']]['type_name'];

11 
	gecho
 '{#obj_label#}';

14 
	gecho
 '{#obj_label#}';

17 <
¥ª
 
	gşass
="mini-title">

19 </
¥ª
>

20 </
div
>

21 <
¥ª
 
şass
="tools">

23 <
a
 
şass
="fs1" 
d©a
-
icÚ
="&#xe090;" 
¬Ÿ
-
hidd’
="Œue" d©a-
Üigš®
-
t™Ë
=""></a>

25 </
¥ª
>

26 </
div
>

27 <
div
 
şass
="widget-body">

28 <
div
 
şass
="row-fluid">

29 <
div
 
şass
="leebutton">

31 </
div
>

32 <
div
 
id
="divmessagelist">

34 <
div
 
şass
="grid-view">

35 <
div
 
id
="{#obj_name#}_list"></div>

36 <
div
>

37 <
süt
 
ty³
="text/javascript">

38 
$
(
docum’t
).
»ady
(
funùiÚ
 () {

39 
$£ËùA‰r
=[

40 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

42 {#/
fÜ—ch
#}

45 
$
("#{#obj_Çme#}_li¡").
ËeD©aTabË
({

46 
£ËùA‰r
:
$£ËùA‰r
,

47 
u¾
:"<?phpƒcho site_url('www/{#obj_name#}/ajax_select_quote?hidden_v='.$_GET['hidden_v']); ?>",

48 
³rNumb”
:5,

53 </
	gsüt
>

54 </
	gdiv
>

55 </
	gdiv
>

56 </
	gdiv
>

57 </
	gdiv
>

58 </
	gdiv
>

59 </
	gdiv
>

60 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/ajax_select.php

1 <
bË
 
	gşass
="tableable-stripedable-borderedable-hover">

2 <
th—d
>

3 <
Œ
>

4 <
th
 
width
="100">æ“ä½œ</th>

7 <?
php


8 
fÜ—ch
(
$ty³li¡Ïyout
 
as
 
$k
=>
$v
){

9 ià(
$_GET
["ty³_id"]==
$k
){

10 
fÜ—ch
(
$v
 
as
 
$k2
=>
$v2
){

11 
echo
 "<th>".
$Ïb–s
[
$v2
]."</th>";

15 if(
	g$_GET
["ty³_id"]=="" 
Ü
 
$_GET
["type_id"]==0){

16 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

17 
echo
 "<th>".
$Ïb–s
['{#obj_name#}_{#lll|attr_name#}']."</th>";

18 {#/
	gfÜ—ch
#}

22 {#fÜ—ch 
	gäom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

23 <
th
><?
php
 
echo
 
$Ïb–s
['{#obj_Çme#}_{#Îl|©Œ_Çme#}'];?></
	gth
>

24 {#/
	gfÜ—ch
#}

27 </
	gŒ
>

28 </
	gth—d
>

29 <
	gtbody
>

30 <?
php
 
fÜ—ch
(
$li¡D©a
 
as
 
$li¡D©a_v®ue
){?>

31 <
	gŒ
>

32 <
td
 
	g¡yË
="font-size:16px;">

33 <
a
 
h»f
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/v›w').'?{#obj_Çme#}_id='.$li¡D©a_v®ue['{#obj_Çme#}_id'].'&ty³_id='.$_GET['ty³_id'] ?>" 
»l
="toŞt" 
t™Ë
="æŸ¥çœ‹"><
¥ª
 
şass
="icon-eye"></span></a>

34 <
a
 
h»f
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/upd©e').'?{#obj_Çme#}_id='.$li¡D©a_v®ue['{#obj_Çme#}_id'].'&ty³_id='.$_GET['ty³_id'] ?>" 
»l
="toŞt" 
t™Ë
="æ›´æ–°"><
¥ª
 
şass
="icon-pencil"></span></a>

35 <
a
 
h»f
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/d–').'?{#obj_Çme#}_id='.$li¡D©a_v®ue['{#obj_Çme#}_id'].'&ty³_id='.$_GET['ty³_id'] ?>" 
»l
="toŞt" 
t™Ë
="åˆ é™¤"><
¥ª
 
şass
="icon-remove-2"></span></a>

36 </
td
>

39 <?
php
 
$_GET
["type_id"]){

43 {#fÜ—ch1 
	gäom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

44 <?
php
 {#|
ty³_id
#}: ?>

45 {#fÜ—ch2 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

46 <
td
>

47 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

48 </
td
>

49 {#/
fÜ—ch2
#}

50 <?
php
 ; ?>

51 {#/
	gfÜ—ch1
#}

52 <?
php
 : ?>

53 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

54 <
td
>

55 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

56 </
td
>

57 {#/
fÜ—ch
#}

58 <?
php
 } ?>

60 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

61 <
td
>

62 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

63 </
td
>

64 {#/
fÜ—ch
#}

68 </
Œ
>

69 <?
php
 }?>

70 </
tbody
>

72 </
bË
>

73 <
div
 
id
="d©a-bË_šfo" 
¡yË
="æßt:Ëá">å…±æŸ¥è¯¢åˆ°<?
php
 
echo
 
$tÙ®Numb”
;?>æ¡</
	gdiv
>

74 <
šput
 
	gty³
='hidd’' 
id
='tÙ®Numb”' 
v®ue
="<?phpƒcho $totalNumber;?>">

75 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/ajax_select_quote.php

1 <
bË
 
	gşass
="tableable-stripedable-borderedable-hover">

2 <
th—d
>

3 <
Œ
>

4 <
th
 
width
="100">æ“ä½œ</th>

7 <?
php


8 
fÜ—ch
(
$ty³li¡Ïyout
 
as
 
$k
=>
$v
){

9 ià(
$_GET
["ty³_id"]==
$k
){

10 
fÜ—ch
(
$v
 
as
 
$k2
=>
$v2
){

11 
echo
 "<th>".
$Ïb–s
[
$v2
]."</th>";

15 if(
	g$_GET
["ty³_id"]=="" 
Ü
 
$_GET
["type_id"]==0){

16 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

17 
echo
 "<th>".
$Ïb–s
['{#obj_name#}_{#lll|attr_name#}']."</th>";

18 {#/
	gfÜ—ch
#}

22 {#fÜ—ch 
	gäom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

23 <
th
><?
php
 
echo
 
$Ïb–s
['{#obj_Çme#}_{#Îl|©Œ_Çme#}'];?></
	gth
>

24 {#/
	gfÜ—ch
#}

27 </
	gŒ
>

28 </
	gth—d
>

29 <
	gtbody
>

30 <?
php
 
fÜ—ch
(
$li¡D©a
 
as
 
$li¡D©a_v®ue
){?>

31 <
	gŒ
>

32 <
td
 
	g¡yË
="font-size:16px;">

33 <
šput
 
ty³
="¿dio" 
Çme
="İtiÚsRadios" 
v®ue
="<?ph°echØ$li¡D©a_v®ue['{#obj_Çme#}_id']; ?>" 
Çme_v®
="<?ph°echØ$li¡D©a_v®ue['{#obj_Çme#}_Çme']; ?>"<?
php
 if(
$_GET
["hidd’_v"]!=''){
$hidd’_id
=
ex¶ode
('?',$_GET["hidd’_v"]);
	g$hidd’_id
=$hidd’_id[0]; if($hidd’_id==
$li¡D©a_v®ue
['{#obj_Çme#}_id']){
echo
 "checked='checked'";}}?> >

34 </
	gtd
>

37 <?
php
 
$_GET
["type_id"]){

41 {#fÜ—ch1 
	gäom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

42 <?
php
 {#|
ty³_id
#}: ?>

43 {#fÜ—ch2 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

44 <
td
>

45 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

46 </
td
>

47 {#/
fÜ—ch2
#}

48 <?
php
 ; ?>

49 {#/
	gfÜ—ch1
#}

50 <?
php
 : ?>

51 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

52 <
td
>

53 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

54 </
td
>

55 {#/
fÜ—ch
#}

56 <?
php
 } ?>

58 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

59 <
td
>

60 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

61 </
td
>

62 {#/
fÜ—ch
#}

66 </
Œ
>

67 <?
php
 }?>

68 </
tbody
>

70 </
bË
>

71 <
div
 
id
="d©a-bË_šfo" 
¡yË
="æßt:Ëá">å…±æŸ¥è¯¢åˆ°<?
php
 
echo
 
$tÙ®Numb”
;?>æ¡</
	gdiv
>

72 <
šput
 
	gty³
='hidd’' 
id
='tÙ®Numb”' 
v®ue
="<?phpƒcho $totalNumber;?>">

73 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/aaa.php

1 <
	gdiv
>{#obj_name#}æ–‡ä»¶å†…å®¹</div>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/date.php

1 <
div
 
	gşass
="šput-­³nd d©fÜm_d©e" 
id
="{#obj_name#}_{#lll|attr_name#}">

2 <
šput
 
size
="16" 
ty³
="‹xt" 
Çme
="{#obj_Çme#}[{#Îl|©Œ_id_¬r.©Œ_f›ld_Çme#}]" 
v®ue
="2012-01-01 00:00:00" 
¡yË
="width: 154px;" value="<?php if(isset($id_aData['{#obj_name#}_{#lll|attr_name#}_arr']['{#lll|attr_id_arr.attr_quote_id_arr.obj_name#}_name'])){echo $id_aData['{#obj_name#}_{#lll|attr_name#}_arr']['{#lll|attr_id_arr.attr_quote_id_arr.obj_name#}_name'];} ?>">

3 <
¥ª
 
şass
="add-Ú"><
i
 class="icon-close"></i></span>

4 <
¥ª
 
şass
="add-Ú"><
i
 class="icon-calendar"></i></span>

5 </
div
>

6 <
süt
 
ty³
="text/javascript">

7 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

8 
	`$
('#{#obj_Çme#}_{#Îl|©Œ_Çme#}').
	`d©‘im•ick”
({

9 
Ïnguage
: 'zh-CN',

10 
w“kS¹
: 1,

11 
todayBŠ
: 1,

12 
autoşo£
: 1,

13 
todayHighlight
: 1,

14 
¡¬tV›w
: 2,

15 
mšV›w
: 2,

16 
fÜûP¬£
: 0,

17 
fÜm©
:'yyyy-mm-dd'

19 
	}
});

20 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/edit.php

1 <?
php
 if(
	$is£t
(
$id_aD©a
)){ ?>

2 <
šput
 
ty³
="‹xt" 
maxËngth
="128" 
Çme
="{#obj_Çme#}[{#Îl|©Œ_id_¬r.©Œ_f›ld_Çme#}]" 
v®ue
="<?ph°echØ$id_aD©a['{#Îl|©Œ_id_¬r.©Œ_f›ld_Çme#}'] ?>" 
id
="{#obj_name#}_{#lll|attr_name#}">

3 <?
php
 
	}

	g}–£
{ ?>

4 <
šput
 
	gty³
="‹xt" 
maxËngth
="128" 
Çme
="{#obj_Çme#}[{#Îl|©Œ_id_¬r.©Œ_f›ld_Çme#}]" 
id
="{#obj_name#}_{#lll|attr_name#}">

5 <?
php
 } ?>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/password.php

1 <?
php
 if(
	$is£t
(
$id_aD©a
)){ ?>

2 <
šput
 
ty³
="·sswÜd" 
maxËngth
="128" 
Çme
="{#obj_Çme#}[{#Îl|©Œ_id_¬r.©Œ_f›ld_Çme#}]" 
v®ue
="<?ph°echØ$id_aD©a['{#Îl|©Œ_id_¬r.©Œ_f›ld_Çme#}'] ?>" 
id
="{#obj_name#}_{#lll|attr_name#}">

3 <?
php
 
	}

	g}–£
{ ?>

4 <
šput
 
	gty³
="‹xt" 
maxËngth
="128" 
Çme
="{#obj_Çme#}[{#Îl|©Œ_id_¬r.©Œ_f›ld_Çme#}]" 
id
="{#obj_name#}_{#lll|attr_name#}">

5 <?
php
 } ?>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/quote.php

1 <
šput
 
	gty³
="‹xt" 
maxËngth
="128" 
Çme
="{#obj_Çme#}[{#Îl|©Œ_id_¬r.©Œ_f›ld_Çme#}]" 
id
="{#obj_Çme#}_{#Îl|©Œ_Çme#}" 
v®ue_id
 ="<?ph°if(is£t($id_aD©a['{#obj_Çme#}_{#Îl|©Œ_Çme#}_¬r']['{#Îl|©Œ_id_¬r.©Œ_quÙe_id_¬r.obj_Çme#}_id'])){echØ$id_aD©a['{#obj_Çme#}_{#Îl|©Œ_Çme#}_¬r']['{#Îl|©Œ_id_¬r.©Œ_quÙe_id_¬r.obj_Çme#}_id']; } ?>" 
v®ue
="<?ph°if(is£t($id_aD©a['{#obj_Çme#}_{#Îl|©Œ_Çme#}_¬r']['{#Îl|©Œ_id_¬r.©Œ_quÙe_id_¬r.obj_Çme#}_Çme'])){echØ$id_aD©a['{#obj_Çme#}_{#Îl|©Œ_Çme#}_¬r']['{#Îl|©Œ_id_¬r.©Œ_quÙe_id_¬r.obj_Çme#}_Çme'];} ?>" 
u¾
="<?ph°echØs™e_u¾('www/{#Îl|©Œ_id_¬r.©Œ_quÙe_id_¬r.obj_Çme#}/ajax_li¡'è?>" 
Ë‘y³
="quote">

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/radio.php

1 <?
php
 
fÜ—ch
(
$
{#obj_Çme#}
_
{#Îl|
©Œ_id_¬r
.
©Œ_Çme
#}
_’um
 
as
 ${#Îl|©Œ_id_¬r.©Œ_Çme#}
_v
){ ?>

2 <
Ïb–
 
	gşass
="radio inline">

3 <?
php
 if(
is£t
(
$id_aD©a
è&& 
$
{#Îl|
©Œ_id_¬r
.
©Œ_Çme
#}
_v
['enum_key']==$id_aData['{#lll|attr_id_arr.attr_field_name#}_arr']['enum_key'] ){ ?>

4 <
šput
 
id
="šlšeRadioB" 
ty³
="¿dio" 
v®ue
="<?ph°echØ${#Îl|©Œ_id_¬r.©Œ_Çme#}_v['’um_key']?>" 
Çme
="{#obj_Çme#}[{#Îl|©Œ_id_¬r.©Œ_f›ld_Çme#}]" 
checked
>

5 <?
php
 }{ ?>

6 <
šput
 
	gid
="šlšeRadioB" 
ty³
="¿dio" 
v®ue
="<?ph°echØ${#Îl|©Œ_id_¬r.©Œ_Çme#}_v['’um_key']?>" 
Çme
="{#obj_name#}[{#lll|attr_id_arr.attr_field_name#}]">

7 <?
php
 }?>

8 <?
php
 
echo
 
	g$
{#Îl|
	g©Œ_id_¬r
.
	g©Œ_Çme
#}
	g_v
['enum_name'];?>

9 </
	gÏb–
>

10 <?
	gphp
 } ?>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/select.php

1 <
£Ëù
 
	gid
="couÁry" 
Çme
="{#obj_name#}[{#lll|attr_id_arr.attr_field_name#}]">

2 <?
php
 
fÜ—ch
(
$
{#obj_Çme#}
_
{#Îl|
©Œ_id_¬r
.
©Œ_Çme
#}
_’um
 
as
 ${#Îl|©Œ_id_¬r.©Œ_Çme#}
_v
){ ?>

3 <?
php
 if(
is£t
(
$id_aD©a
è&& 
$
{#Îl|
©Œ_id_¬r
.
©Œ_Çme
#}
_v
['enum_key']==$id_aData['{#lll|attr_id_arr.attr_field_name#}_arr']['enum_key'] ){ ?>

4 <
İtiÚ
 
v®ue
="<?ph°echØ${#Îl|©Œ_id_¬r.©Œ_Çme#}_v['’um_key'];?>" 
£Ëùed
="selected">

5 <?
php
 }{ ?>

6 <
İtiÚ
 
	gv®ue
="<?phpƒcho ${#lll|attr_id_arr.attr_name#}_v['enum_key'];?>">

7 <?
php
 }?>

8 <?
php
 
echo
 
	g$
{#Îl|
	g©Œ_id_¬r
.
	g©Œ_Çme
#}
	g_v
['enum_name'];?>

9 </
	gİtiÚ
>

12 <?
	gphp
 } ?>

14 </
	g£Ëù
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/time.php

1 <
div
 
	gşass
="šput-­³nd d©fÜm_d©e" 
id
="{#obj_name#}_{#lll|attr_name#}">

2 <
šput
 
size
="16" 
ty³
="‹xt" 
Çme
="{#obj_Çme#}[{#Îl|©Œ_id_¬r.©Œ_f›ld_Çme#}]" 
v®ue
="2012-01-01 00:00:00" 
¡yË
="width: 154px;" value="<?php if(isset($id_aData['{#obj_name#}_{#lll|attr_name#}_arr']['{#lll|attr_id_arr.attr_quote_id_arr.obj_name#}_name'])){echo $id_aData['{#obj_name#}_{#lll|attr_name#}_arr']['{#lll|attr_id_arr.attr_quote_id_arr.obj_name#}_name'];} ?>">

3 <
¥ª
 
şass
="add-Ú"><
i
 class="icon-close"></i></span>

4 <
¥ª
 
şass
="add-Ú"><
i
 class="icon-clock"></i></span>

5 </
div
>

6 <
süt
 
ty³
="text/javascript">

7 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

8 
	`$
('#{#obj_Çme#}_{#Îl|©Œ_Çme#}').
	`d©‘im•ick”
({

9 
Ïnguage
: 'zh-CN',

10 
w“kS¹
: 1,

11 
todayBŠ
: 1,

12 
autoşo£
: 1,

13 
todayHighlight
: 1,

14 
¡¬tV›w
: 2,

15 
mšV›w
: 1,

16 
fÜûP¬£
: 0,

17 
fÜm©
:'yyyy-mm-dd hh:ii:ss'

19 
	}
});

20 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/view/checkbox.php

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/view/quote.php

1 <?
php


2 ià(
	g$li¡D©a_v®ue
['{#obj_Çme#}_{#Îl|©Œ_Çme#}']!=0 
ªd
 
$li¡D©a_v®ue
['{#obj_name#}_{#lll|attr_name#}']!=""){

3 
echo
 
$li¡D©a_v®ue
['{#obj_name#}_{#lll|attr_name#}_arr']['{#lll|attr_id_arr.attr_quote_id_arr.obj_name#}_name'];

5 
	gecho
 "&nbsp";

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/view/radio.php

1 <?
php
 
echo
 
	g$li¡D©a_v®ue
['{#obj_name#}_{#lll|attr_name#}_arr']['enum_name'];?>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/view/select.php

1 <?
php
 
echo
 
	g$li¡D©a_v®ue
['{#obj_name#}_{#lll|attr_name#}_arr']['enum_name'];?>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/view/view.php

1 <?
php
 
echo
 
	g$li¡D©a_v®ue
['{#obj_name#}_{#lll|attr_name#}'];?>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/detailed_list_edit.php

1 <
div
 
	gid
='{#obj_Çme#}_li¡_ed™' 
¡yË
="overflow-x:auto;">

2 <
bË
 
şass
="tableable-borderedable-hover">

3 <
th—d
>

4 <
Œ
>

5 <
th
 
width
="60">

6 <
a
 
id
="{#obj_Çme#}_d‘aed_add" 
t™Ë
="æ·»åŠ æ˜ç»†"><
¥ª
 
şass
="icon-plus"></span></a>

7 </
th
>

8 {#fÜ—ch 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
–l
 
key
=
–l_k
#}

9 <
th
><?
php
 
echo
 
$Ïb–s
['{#obj_Çme#}_{#–l|©Œ_Çme#}'];?></
	gth
>

10 {#/
	gfÜ—ch
#}

11 </
	gŒ
>

12 </
	gth—d
>

13 <
	gtbody
>

14 <?
php
 
fÜ—ch
(
$li¡D©a
 
as
 
$li¡D©a_v®ue
){?>

15 <
	gŒ
>

16 <
td
 
	g¡yË
="font-size:16px;">

17 <
a
><
¥ª
 
şass
="icon-remove-2"></span></a>

18 </
td
>

19 {#fÜ—ch 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

20 <
td
 >

21 {#šşud
v›ws
/
©Œty³
/
ed™
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_ed™_‹m¶©e
#}#}

22 </
td
>

23 {#/
fÜ—ch
#}

24 </
Œ
>

25 <?
php
 }?>

26 </
tbody
>

27 </
bË
>

28 </
div
>

29 <
süt
 
ty³
="text/javascript">

31 
$
(
docum’t
).
»ady
(
funùiÚ
 () {

33 
$©ŒA¼
 = [

34 {#fÜ—ch 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
–l
 
key
=
–l_k
#}

42 {#ià{#–l|
©Œ_id_¬r
.
©Œ_ty³
#}==19#}

48 {#/
fÜ—ch
#}

50 
$
('#{#obj_Çme#}_li¡_ed™').
ËeD‘aedEd™
({

52 "©ŒA¼":
$©ŒA¼


55 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/detailed_list_view.php

1 <
bË
 
	gşass
="tableable-stripedable-borderedable-hover">

2 <
th—d
>

3 <
Œ
>

4 <
th
 
width
="20"></th>

7 <?
php


8 
fÜ—ch
(
$ty³li¡Ïyout
 
as
 
$k
=>
$v
){

9 ià(
$_GET
["ty³_id"]==
$k
){

10 
fÜ—ch
(
$v
 
as
 
$k2
=>
$v2
){

11 
echo
 "<th>".
$Ïb–s
[
$v2
]."</th>";

15 if(
	g$_GET
["ty³_id"]=="" 
Ü
 
$_GET
["type_id"]==0){

16 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

17 
echo
 "<th>".
$Ïb–s
['{#obj_name#}_{#lll|attr_name#}']."</th>";

18 {#/
	gfÜ—ch
#}

22 {#fÜ—ch 
	gäom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

23 <
th
><?
php
 
echo
 
$Ïb–s
['{#obj_Çme#}_{#Îl|©Œ_Çme#}'];?></
	gth
>

24 {#/
	gfÜ—ch
#}

27 </
	gŒ
>

28 </
	gth—d
>

29 <
	gtbody
>

30 <?
php
 
fÜ—ch
(
$li¡D©a
 
as
 
$li¡D©a_v®ue
){?>

31 <
	gŒ
>

32 <
td
 
	g¡yË
="font-size:16px;">

34 </
td
>

37 <?
php
 
$_GET
["type_id"]){

41 {#fÜ—ch1 
	gäom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

42 <?
php
 {#|
ty³_id
#}: ?>

43 {#fÜ—ch2 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

44 <
td
>

45 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

46 </
td
>

47 {#/
fÜ—ch2
#}

48 <?
php
 ; ?>

49 {#/
	gfÜ—ch1
#}

50 <?
php
 : ?>

51 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

52 <
td
>

53 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

54 </
td
>

55 {#/
fÜ—ch
#}

56 <?
php
 } ?>

58 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

59 <
td
>

60 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

61 </
td
>

62 {#/
fÜ—ch
#}

66 </
Œ
>

67 <?
php
 }?>

68 </
tbody
>

70 </
bË
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/layouts/bottom.php

1 </
	gdiv
>

2 </
	gdiv
>

3 </
	gdiv
>

4 <
	gfoÙ”
>

5 <
	gp
>

7 </
	gp
>

8 </
	gfoÙ”
>

10 <
div
 
	g¡yË
="pos™iÚ: fixed; z-šdex: 2147483647;" 
t™Ë
="SüŞÈtØtİ" 
id
="süŞlUp">å›åˆ°<
br
>é¡¶éƒ¨</div>

12 <
süt
 
ty³
="text/javascript">

13 
v¬
 
¡2
=
docum’t
.
docum’tEËm’t
.
süŞlTİ
;

14 ià(
	g¡2
>200) {

15 
$
("#süŞlUp").
show
();

17 
$
("#süŞlUp").
hide
();

21 
$
(
wšdow
).
süŞl
(
	$funùiÚ
(){

22 
v¬
 
¡2
=
docum’t
.
docum’tEËm’t
.
süŞlTİ
;

23 ià(
¡2
>200) {

25 
	`$
("#süŞlUp").
	`çdeIn
();

26 
	`$
("#süŞlUp").
	`çdeIn
("slow");

27 
	`$
("#süŞlUp").
	`çdeIn
(3000);

29 
	`$
("#süŞlUp").
	`çdeOut
();

30 
	`$
("#süŞlUp").
	`çdeOut
("slow");

31 
	`$
("#süŞlUp").
	`çdeOut
(3000);

33 
	}
});

34 
$
("#süŞlUp").
şick
(
	$funùiÚ
(){

35 
	`$
('html').
	`ªim©e
({
süŞlTİ
:0},500);

36 
	}
});

37 </
	gsüt
>

39 <
süt
 
	g¤c
="<?phpƒcho base_url();?>style/index/js/tiny-scrollbar.js"></script>

40 <
süt
 
ty³
="text/javascript">

43 
funùiÚ
 
	$p›_ch¬t
() {

45 
	`$
(
	`funùiÚ
 () {

47 
	`$
('.ch¬t5').
	`—syP›Ch¬t
({

48 
ªim©e
: 3000,

49 
b¬CŞÜ
: '#F63131',

50 
ŒackCŞÜ
: '#dddddd',

51 
sÿËCŞÜ
: '#F63131',

52 
size
: 140,

53 
lšeWidth
: 6,

56 
	`£tTimeout
(
	`funùiÚ
 () {

57 
	`$
('.ch¬t5').
	`d©a
('—syP›Ch¬t').
	`upd©e
(30);

59 
	`£tTimeout
(
	`funùiÚ
 () {

60 
	`$
('.ch¬t5').
	`d©a
('—syP›Ch¬t').
	`upd©e
(87);

62 
	`£tTimeout
(
	`funùiÚ
 () {

63 
	`$
('.ch¬t5').
	`d©a
('—syP›Ch¬t').
	`upd©e
(28);

65 
	`£tTimeout
(
	`funùiÚ
 () {

66 
	`$
('.ch¬t5').
	`d©a
('—syP›Ch¬t').
	`upd©e
(69);

68 
	`£tTimeout
(
	`funùiÚ
 () {

69 
	`$
('.ch¬t5').
	`d©a
('—syP›Ch¬t').
	`upd©e
(99);

72 
	}
}

74 
$
('#süŞlb¬').
tšysüŞlb¬
();

75 
$
('#süŞlb¬-Úe').
tšysüŞlb¬
();

76 
$
('#süŞlb¬-two').
tšysüŞlb¬
();

77 
$
('#süŞlb¬-th»e').
tšysüŞlb¬
();

80 </
	gsüt
>

81 <
süt
 
	gty³
="‹xt/javasüt" 
¤c
="<?ph°echØba£_u¾();?>¡yË/admš/js/Ëe/Ëe.js" 
ch¬£t
="UTF-8"></script>

82 <
süt
 
ty³
="‹xt/javasüt" 
¤c
="<?ph°echØba£_u¾();?>¡yË/admš/js/jqu”y.d©aTabËs.js" 
ch¬£t
="UTF-8"></script>

83 </
body
>

84 </
html
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/layouts/head.php

1 <!
DOCTYPE
 
	ghtml
>

2 <
html
 
	gÏng
="en">

3 <
h—d
>

4 <
m‘a
 
h‰p
-
equiv
="CÚ‹Á-Ty³" 
cÚ‹Á
="text/html; charset=utf-8" />

5 <
m‘a
 
cÚ‹Á
="IEódge,chrome=1" 
h‰p
-
equiv
="X-UA-Compatible">

6 <
m‘a
 
Çme
="v›wpÜt" 
cÚ‹Á
="width=device-width, initial-scale=1.0">

7 <
m‘a
 
Çme
="desütiÚ" 
cÚ‹Á
="">

8 <
m‘a
 
Çme
="authÜ" 
cÚ‹Á
="">

9 <
süt
 
ty³
="‹xt/javasüt" 
¤c
="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>

10 <
t™Ë
>å®¢æˆ·åŒ–å¹³å°</title>

11 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/admš/css/boÙ¡¿p/css/boÙ¡¿p.css" 
»l
="stylesheet"></link>

12 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/admš/css/jqu”y-ui-boÙ¡¿p.css" 
»l
="stylesheet"></link>

13 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/admš/css/¡yË.css" 
»l
="stylesheet"></link>

14 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/admš/css/maš.css" 
»l
="stylesheet"></link>

15 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/admš/css/Ëe.css" 
»l
="stylesheet"></link>

16 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/d©‘im•ick”/css/boÙ¡¿p-d©‘im•ick”.mš.css" 
»l
="¡yËsh“t" 
medŸ
="screen">

17 <
süt
 
¤c
="<?phpƒcho base_url();?>style/admin/js/jquery.js"></script>

18 <
süt
 
¤c
="<?phpƒcho base_url();?>style/admin/js/jui/js/jquery-ui.min.js"></script>

19 <
süt
 
¤c
="<?phpƒcho base_url();?>style/admin/css/bootstrap/js/bootstrap.min.js"></script>

20 <
süt
 
ty³
="‹xt/javasüt" 
¤c
="<?ph°echØba£_u¾();?>¡yË/d©‘im•ick”/js/boÙ¡¿p-d©‘im•ick”.js" 
ch¬£t
="UTF-8"></script>

21 <
süt
 
ty³
="‹xt/javasüt" 
¤c
="<?ph°echØba£_u¾();?>¡yË/d©‘im•ick”/js/loÿËs/boÙ¡¿p-d©‘im•ick”.zh-CN.js" 
ch¬£t
="UTF-8"></script>

22 </
h—d
>

23 <
body
>

24 <
h—d”
>

25 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="šdex.php" 
şass
="logo">
LOGO
</a>

27 <
div
 
şass
="user-profile">

28 <
a
 
d©a
-
Üigš®
-
t™Ë
="" d©a-
toggË
="drİdown" 
şass
="dropdown-toggle">

29 <
img
 
¤c
="<?ph°echØba£_u¾();?>¡yË/admš/css/img/´ofe1.²g" 
®t
="Profile-Image">

30 <
¥ª
 
şass
="caret"></span>

31 </
a
>

32 <
ul
 
şass
="dropdown-menu…ull-right">

33 <
li
>

34 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="#">

35 
Ed™
 
Profe


36 </
a
>

37 </
li
>

38 <
li
>

39 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="#">

40 
AccouÁ
 
S‘tšgs


41 </
a
>

42 </
li
>

43 <
li
>

44 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="<?phpƒcho site_url('admin/home/out') ?>">

45 
Logout


46 </
a
>

47 </
li
>

48 </
ul
>

49 </
div
>

50 <
ul
 
şass
="mini-nav">

51 <
li
>

52 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="#">

53 <
div
 
şass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="î€"></div>

54 <
¥ª
 
şass
="šfo-Ïb–" 
id
="quickMessages">16</span>

55 </
a
>

56 </
li
>

57 <
li
>

58 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="#">

59 <
div
 
şass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="&#xe0aa;"></div>

60 <
¥ª
 
şass
="šfo-Ïb–-g»’" 
id
="quickAlerts">10</span>

61 </
a
>

62 </
li
>

63 <
li
>

64 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="#">

65 <
div
 
şass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="î€·"></div>

66 <
¥ª
 
şass
="šfo-Ïb–-Üªge" 
id
="quickShop">10</span>

67 </
a
>

68 </
li
>

69 </
ul
>

70 </
h—d”
>

71 <
div
 
şass
="container-fluid">

72 <
div
 
şass
="dashboard-container">

73 <
div
 
şass
="top-nav">

74 <
ul
>

75 {#fÜ—ch 
äom
=
tİm’u
 
™em
=
©Œ
 
key
=
–l_k
#}

76 <
li
>

77 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
Çme
='glšk' 
h»f
="<?ph°echØba£_u¾().'šdex.php/';?>{#©Œ|m’u_u¾#}" <?
php
 if(
¡½os
('{#©Œ|£Ëù#}',
$this
->
m’u1
)>0){
	gecho
 'class="selected"';}?>>

78 <
div
 
	gşass
="fs1" 
¬Ÿ
-
hidd’
="Œue"><
¥ª
 
şass
="{#©Œ|m’u_icÚ#}" 
¡yË
="fÚt-size:16px;"></¥ª></div>{#©Œ|
m’u_Çme
#}

79 </
a
>

80 </
li
>

81 {#/
fÜ—ch
#}

82 </
ul
>

83 <
div
 
şass
="clearfix"></div>

84 </
div
>

85 <
div
 
şass
="sub-nav">

86 <?
php
 
$i
=0; 
	g$i
<
couÁ
(
$subm’u
); $i++):?>

87 <
ul
>

88 <?
php
 
fÜ—ch
(
$subm’u
[
$i
] 
as
 
$k
=>
$v
): ?>

89 <
li
>

90 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="<?ph°echØs™e_u¾($v['m’u_u¾']); ?>" <?
php
 ià(
$this
->
m’u1
!='' 
ªd
 $this->m’u1==
$v
['m’u_Ïb–']){
echo
 'şass="£Ëùed"';}?>><?ph°echØ
	g$v
['m’u_Çme'];?></
	ga
>

91 </
	gli
>

92 <?
php
 
	g’dfÜ—ch
;?>

93 </
	gul
>

94 <?
php
 
	g’dfÜ
;?>

95 </
	gdiv
>

96 <
	gsüt
>

97 
$
(".sub-Çv ul").
css
("display","none");

98 
$
(
funùiÚ
(){

100 
v¬
 
£Ëù
 = 
$
(".tİ-Çv uÈl˜a[şass=£Ëùed]").
·»Á
().
šdex
();

101 
$
(".sub-Çv ul:eq("+
£Ëù
+")").
css
("display","block");

103 
$
(".tİ-Çv uÈli").
mou£’‹r
(
funùiÚ
(){

104 
n
=
$
(
this
).
šdex
();

106 
$
(".sub-Çv ul").
css
("display","none");

107 
$
(".tİ-Çv uÈl˜a").
»moveA‰r
("class", "selected");

109 
$
(
this
).
chd»n
('a').
©Œ
("class", "selected");

110 
$
(".sub-Çv ul:eq("+
n
+")").
css
("display","block");

113 
$
("div.dashbßrd-cÚš”").
mou£Ëave
(
funùiÚ
(){

115 
$
(".sub-Çv ul").
css
("display","none");

116 
$
(".tİ-Çv uÈl˜a").
»moveA‰r
("class", "selected");

118 
$
(".sub-Çv ul:eq("+
£Ëù
+")").
css
("display","block");

119 
$
(".tİ-Çv uÈli:eq("+
£Ëù
+")").
chd»n
('a').
©Œ
("class", "selected");

123 </
	gsüt
>

124 </
	gdiv
>

125 <
div
 
	gşass
="dashboard-wrapper">

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/list.php

1 <
div
 
	gşass
="all-sidebar">

2 <
div
 
şass
="row-fluid">

3 <
div
 
şass
="span12">

4 <
div
 
şass
="widget">

5 <
div
 
şass
="widget-header">

6 <
div
 
şass
="title">

8 <
¥ª
 
şass
="mini-title">

10 </
¥ª
>

11 </
div
>

12 <
¥ª
 
şass
="tools">

14 <
a
 
şass
="fs1" 
d©a
-
icÚ
="&#xe090;" 
¬Ÿ
-
hidd’
="Œue" d©a-
Üigš®
-
t™Ë
=""></a>

16 </
¥ª
>

17 </
div
>

18 <
div
 
şass
="widget-body">

19 <
div
 
şass
="row-fluid">

20 <
div
 
şass
="leebutton">

21 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
¡¬t
-->

22 <
a
 
id
="Ãw{#obj_Çme#}" 
şass
="bŠ bŠ-´im¬y" 
h»f
="<?phpƒcho site_url('www/{#obj_name#}/add')?>">

23 <
i
 
şass
="icon-file"></i>

25 </
a
>

26 <
a
 
id
="{#obj_Çme#}_£niÜqu”y" 
şass
="bŠ bŠ-´im¬y" 
u¾
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/£niÜqu”y')?>" 
Ë‘y³
='seniorquery'>

27 <
i
 
şass
="icon-search"></i>

29 </
a
>

30 <
šput
 
id
="£Ëù_jsÚ" 
ty³
="hidden">

31 <
div
 
id
="{#obj_Çme#}_£niÜqu”y_dŸlog_div" 
¡yË
="display:none;">

32 <
div
 
¡yË
="padding:20px;">

33 <
li
>åœ¨ä¸‹é¢çš„è¡Œä¸­è®¾å®šå±æ€§çš„é™åˆ¶æ¡ä»¶</li>

34 <
li
>æŸ¥è¯¢æ¡ä»¶ä¼šåœ¨ä¸‹é¢çš„æ–‡æœ¬åŒºåŸŸä¸­ç»„åˆ</li>

35 <
li
>ä½ å¯ä»¥æ”¹å˜æ¡ä»¶çš„ç»„åˆæ–¹å¼(å¦‚ 1 
Ü
 (2 
ªd
 3))</li>

36 <
br
>

37 <
fÜm
 
şass
="form-horizontal‚o-margin">

38 <
div
 
¡yË
="padding:5px 0;">

39 <
£Ëù
 
id
="¯a_1" 
şass
="span2">

40 <
İtiÚ
 
v®ue
="1"> éƒ¨é—¨åç§° </option>

41 <
İtiÚ
 
v®ue
="2"> ä¸Šæ¬¡éƒ¨é—¨ </option>

42 <
İtiÚ
 
v®ue
="3"> éƒ¨é—¨ç¼–ç  </option>

43 </
£Ëù
>

44 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2 input-left-top-margins" >

45 <
İtiÚ
 
v®ue
="1"> åŒ…å« </option>

46 <
İtiÚ
 
v®ue
="2"> ä¸åŒ…å« </option>

47 <
İtiÚ
 
v®ue
="3"> = </option>

48 <
İtiÚ
 
v®ue
="4"> ä¸ºç©º </option>

49 <
İtiÚ
 
v®ue
="5"> ä¸ä¸ºç©º </option>

50 </
£Ëù
>

51 <
šput
 
id
="¯a" 
ty³
="‹xt" 
şass
="span4 input-left-top-margins" >

52 </
div
>

53 <
div
 
¡yË
="padding:5px 0;">

54 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2">

55 <
İtiÚ
 
v®ue
="1"> éƒ¨é—¨åç§° </option>

56 <
İtiÚ
 
v®ue
="2"> ä¸Šæ¬¡éƒ¨é—¨ </option>

57 <
İtiÚ
 
v®ue
="3"> éƒ¨é—¨ç¼–ç  </option>

58 </
£Ëù
>

59 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2 input-left-top-margins" >

60 <
İtiÚ
 
v®ue
="1"> åŒ…å« </option>

61 <
İtiÚ
 
v®ue
="2"> ä¸åŒ…å« </option>

62 <
İtiÚ
 
v®ue
="3"> = </option>

63 <
İtiÚ
 
v®ue
="4"> ä¸ºç©º </option>

64 <
İtiÚ
 
v®ue
="5"> ä¸ä¸ºç©º </option>

65 </
£Ëù
>

66 <
šput
 
id
="¯a" 
ty³
="‹xt" 
şass
="span4 input-left-top-margins" >

67 </
div
>

68 <
div
 
¡yË
="padding:5px 0;">

69 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2">

70 <
İtiÚ
 
v®ue
="1"> éƒ¨é—¨åç§° </option>

71 <
İtiÚ
 
v®ue
="2"> ä¸Šæ¬¡éƒ¨é—¨ </option>

72 <
İtiÚ
 
v®ue
="3"> éƒ¨é—¨ç¼–ç  </option>

73 </
£Ëù
>

74 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2 input-left-top-margins" >

75 <
İtiÚ
 
v®ue
="1"> åŒ…å« </option>

76 <
İtiÚ
 
v®ue
="2"> ä¸åŒ…å« </option>

77 <
İtiÚ
 
v®ue
="3"> = </option>

78 <
İtiÚ
 
v®ue
="4"> ä¸ºç©º </option>

79 <
İtiÚ
 
v®ue
="5"> ä¸ä¸ºç©º </option>

80 </
£Ëù
>

81 <
šput
 
id
="¯a" 
ty³
="‹xt" 
şass
="span4 input-left-top-margins" >

82 </
div
>

83 <
div
 
¡yË
="padding:5px 0;">æ·»åŠ è¡Œ åˆ é™¤è¡Œ</div>

84 <
‹x»a
 
id
="desütiÚ3" 
şass
="šput-block-Ëv– s·n8" 
¶aûhŞd”
="DesütiÚ" 
Çme
="desütiÚ3" 
rows
="3"> </textarea>

85 </
fÜm
>

86 </
div
>

87 </
div
>

88 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
’d
-->

89 </
div
>

90 <
div
 
id
="divmessagelist">

92 <
div
 
şass
="grid-view">

93 <
div
 
id
="{#obj_name#}_list"></div>

94 <
div
>

95 <
süt
 
ty³
="text/javascript">

96 
$
(
docum’t
).
»ady
(
funùiÚ
 () {

97 
$£ËùA‰r
=[

98 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

100 {#/
fÜ—ch
#}

102 
$
("#{#obj_Çme#}_li¡").
ËeD©aTabË
({

103 
£ËùA‰r
:
$£ËùA‰r
,

104 
u¾
:"<?phpƒcho site_url('www/{#obj_name#}/ajax_select'); ?>",

105 
³rNumb”
:5

109 </
	gsüt
>

110 </
	gdiv
>

111 </
	gdiv
>

112 </
	gdiv
>

113 </
	gdiv
>

114 </
	gdiv
>

115 </
	gdiv
>

116 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/list111.php

1 <
div
 
	gşass
="all-sidebar">

2 <
div
 
şass
="row-fluid">

3 <
div
 
şass
="span12">

4 <
div
 
şass
="widget">

5 <
div
 
şass
="widget-header">

6 <
div
 
şass
="title">

8 <
¥ª
 
şass
="mini-title">

10 </
¥ª
>

11 </
div
>

12 <
¥ª
 
şass
="tools">

14 <
a
 
şass
="fs1" 
d©a
-
icÚ
="&#xe090;" 
¬Ÿ
-
hidd’
="Œue" d©a-
Üigš®
-
t™Ë
=""></a>

16 </
¥ª
>

17 </
div
>

18 <
div
 
şass
="widget-body">

19 <
div
 
şass
="row-fluid">

20 <
div
 
şass
="leebutton">

21 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
¡¬t
-->

22 <
a
 
id
="Ãw{#obj_Çme#}" 
şass
="bŠ bŠ-´im¬y" 
h»f
="<?phpƒcho site_url('www/{#obj_name#}/add')?>">

23 <
i
 
şass
="icon-file"></i>

25 </
a
>

26 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
’d
-->

27 </
div
>

28 <
div
 
id
="divmessagelist">

29 <
div
>

30 <
div
 
id
="objli¡" 
şass
="grid-view">

31 <
bË
 
şass
="tableable-stripedable-borderedable-hover">

32 <
th—d
>

33 <
Œ
>

34 <
th
 
width
="100">æ“ä½œ</th>

35 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

36 <
th
><?
php
 
echo
 
$Ïb–s
['{#obj_Çme#}_{#Îl|©Œ_Çme#}'];?></
	gth
>

37 {#/
	gfÜ—ch
#}

38 </
	gŒ
>

39 </
	gth—d
>

40 <
	gtbody
>

41 <?
php
 
fÜ—ch
(
$li¡D©a
 
as
 
$li¡D©a_v®ue
){?>

42 <
	gŒ
>

43 <
td
 
	g¡yË
="font-size:16px;">

44 <
a
 
h»f
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/{#obj_Çme#}_v›w').'?{#obj_Çme#}_id='.$li¡D©a_v®ue['{#obj_Çme#}_id'] ?>" 
»l
="toŞt" 
t™Ë
="æŸ¥çœ‹"><
¥ª
 
şass
="icon-file"></span></a>

45 </
td
>

46 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

48 <
td
>

49 {#ià{#Îl|
©Œ_id_¬r
.
©Œ_ty³
#}==19#}

50 <?
php


51 ià(
$li¡D©a_v®ue
['{#obj_Çme#}_{#Îl|©Œ_Çme#}']!=0 
ªd
 $listData_value['{#obj_name#}_{#lll|attr_name#}']!=""){

52 
echo
 
$li¡D©a_v®ue
['{#obj_name#}_{#lll|attr_name#}_arr']['{#lll|attr_id_arr.attr_obj_id_arr.obj_name#}_name'];

54 
	gecho
 "&nbsp";

58 <?
php
 
echo
 
	g$li¡D©a_v®ue
['{#obj_name#}_{#lll|attr_name#}'];?>

60 </
	gtd
>

61 {#/
	gfÜ—ch
#}

63 </
	gŒ
>

64 <?
	gphp
 }?>

65 </
	gtbody
>

67 </
	gbË
>

68 <
div
 
	gid
="¯a" 
Ë‘y³
="·gš©iÚ" 
·ge
="2" 
tÙ®Numb”
="99" 
³rNumb”
="10">åˆ†é¡µ</div>

70 <
div
 
şass
="pagination‚o-margin">

71 <
ul
>

72 <
li
 
şass
="disabled">

73 <
a
>ä¸Šä¸€é¡µ</a>

74 </
li
>

75 <
li
 
şass
="active">

76 <
a
>1</a>

77 </
li
>

78 <
li
 
şass
="hidden-phone">

79 <
a
 
h»f
="#" 
d©a
-
Üigš®
-
t™Ë
="">2</a>

80 </
li
>

81 <
li
 
şass
="hidden-phone">

82 <
a
 
h»f
="#" 
d©a
-
Üigš®
-
t™Ë
="">3</a>

83 </
li
>

84 <
li
 
şass
="hidden-phone">

85 <
a
 
h»f
="#" 
d©a
-
Üigš®
-
t™Ë
="">4</a>

86 </
li
>

87 <
li
 
şass
="hidden-phone">

88 <
a
 
h»f
="#" 
d©a
-
Üigš®
-
t™Ë
="">5</a>

89 </
li
>

90 <
li
 
şass
="hidden-phone">

91 <
a
 
h»f
="#" 
d©a
-
Üigš®
-
t™Ë
="">6</a>

92 </
li
>

93 <
li
 
şass
="hidden-phone">

94 <
a
 
h»f
="#" 
d©a
-
Üigš®
-
t™Ë
="">7</a>

95 </
li
>

96 <
li
 
şass
="hidden-phone">

97 <
a
 
h»f
="#" 
d©a
-
Üigš®
-
t™Ë
="">8</a>

98 </
li
>

99 <
li
>

100 <
a
 
h»f
="#" 
d©a
-
Üigš®
-
t™Ë
="">ä¸‹ä¸€é¡µ</a>

101 </
li
>

102 </
ul
>

103 </
div
>

105 </
div
>

107 </
div
>

108 </
div
>

109 </
div
>

110 </
div
>

111 </
div
>

112 </
div
>

113 </
div
>

114 </
div
>

117 <
süt
 
ty³
="text/javascript">

118 
$
(
docum’t
).
»ady
(
funùiÚ
 () {

120 
$
("[Ë‘y³='·gš©iÚ']").
—ch
(
funùiÚ
(){

121 
$
(
this
).
hide
();

122 
$tid
 = 
$
(
this
).
©Œ
('id');

123 
$ul_id
 = 
$tid
+'_ul';

124 
$³rNumb”
=
$
(
this
).
©Œ
('perNumber');

125 
$·ge
=
$
(
this
).
©Œ
('page');

127 if(!
$·ge
 || $page<1){

128 
$·ge
=1;

130 
$tÙ®Numb”
=
$
(
this
).
©Œ
('totalNumber');

131 
$tÙ®Page
=
·r£IÁ
((
$tÙ®Numb”
-1)/
$³rNumb”
)+1;

132 
$fÜPage
=
·r£IÁ
((
$·ge
-1)/
$³rNumb”
)+1;

136 
$
(
this
).
aá”
('<div cÏss="·gš©iÚ‚o-m¬gš"><uÈid="'+
$ul_id
+'"></ul></div>');

137 if(
$fÜPage
==1){

138 
$
("#"+
$ul_id
).
­³nd
('<li class="disabled"><a>é¦–é¡µ</a></li>');

140 
$
("#"+
$ul_id
).
­³nd
('<li><a href="#">é¦–é¡µ</a></li>');

142 if(
$·ge
==1){

143 
$
("#"+
$ul_id
).
­³nd
('<li class="disabled"><a>ä¸Šä¸€é¡µ</a></li>');

145 
$
("#"+
$ul_id
).
­³nd
('<li><a href="#">ä¸Šä¸€é¡µ</a></li>');

147 
i
=
$fÜPage
;i<=
$³rNumb”
;i++){

148 if(
i
==
$·ge
){

149 
$
("#"+
$ul_id
).
­³nd
('<l˜şass="di§bËd"><a>'+
i
+'</a></li>');

151 
$
("#"+
$ul_id
).
­³nd
('<li><¨h»f="#">'+
i
+'</a></li>');

154 if(
$·ge
==
$tÙ®Page
){

155 
$
("#"+
$ul_id
).
­³nd
('<li class="disabled"><a>ä¸‹ä¸€é¡µ</a></li>');

157 
$
("#"+
$ul_id
).
­³nd
('<li><a href="#">ä¸‹ä¸€é¡µ</a></li>');

160 
$¯a
 = 
·r£IÁ
((
$tÙ®Page
+1)/
$³rNumb”
)-1;

161 
$bbb
 = 
·r£IÁ
((
$·ge
+1)/
$³rNumb”
)-1;

162 if(
$¯a
==
$bbb
){

163 
$
("#"+
$ul_id
).
­³nd
('<li class="disabled"><a>å°¾é¡µ</a></li>');

165 
$
("#"+
$ul_id
).
­³nd
('<li><a href="#">å°¾é¡µ</a></li>');

171 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/list_type.php

1 <
div
 
	gşass
="all-sidebar">

2 <
div
 
şass
="row-fluid">

3 <
div
 
şass
="span12">

4 <
div
 
şass
="widget">

5 <
div
 
şass
="widget-header">

6 <
div
 
şass
="title">

7 <?
php
 if(
is£t
(
$_GET
['type_id'])){

8 if(
is£t
(
$ty³_¬r
[
$_GET
['type_id']]['type_name'])){

9 
echo
 
$ty³_¬r
[
$_GET
['type_id']]['type_name'];

11 
	gecho
 '{#obj_label#}';

14 
	gecho
 '{#obj_label#}';

17 <
¥ª
 
	gşass
="mini-title">

19 </
¥ª
>

20 </
div
>

21 <
¥ª
 
şass
="tools">

23 <
a
 
şass
="fs1" 
d©a
-
icÚ
="&#xe090;" 
¬Ÿ
-
hidd’
="Œue" d©a-
Üigš®
-
t™Ë
=""></a>

25 </
¥ª
>

26 </
div
>

27 <
div
 
şass
="widget-body">

28 <
div
 
şass
="row-fluid">

29 <
div
 
şass
="leebutton">

30 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
¡¬t
-->

31 <
div
 
şass
="btn-group">

32 <
a
 
id
="Ãw{#obj_Çme#}" 
şass
="bŠ bŠ-´im¬y" 
h»f
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/add')?>" 
d©a
-
toggË
="dropdown">

33 <
i
 
şass
="icon-file"></i>

35 </
a
>

36 <
ul
 
şass
="drİdown-m’u" 
rŞe
="menu">

37 <?
php
 
fÜ—ch
 (
$ty³_¬r
 
as
 
$k
=>
$v
){ ?>

38 <
li
>

39 <
a
 
h»f
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/add?ty³_id='.$v['ty³_id']);?>">æ–°å¢<?
php
 
echo
 
$v
['ty³_Çme'];?></
	ga
>

40 </
	gli
>

41 <?
	gphp
 }?>

42 </
	gul
>

43 </
	gdiv
>

44 <
a
 
	gid
="{#obj_Çme#}_£niÜqu”y" 
şass
="bŠ bŠ-´im¬y" 
u¾
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/£niÜqu”y')?>" 
Ë‘y³
='seniorquery'>

45 <
i
 
şass
="icon-search"></i>

47 </
a
>

48 <
šput
 
id
="£Ëù_jsÚ" 
ty³
="hidden">

49 <
div
 
id
="{#obj_Çme#}_£niÜqu”y_dŸlog_div" 
¡yË
="display:none;">

50 <
div
 
¡yË
="padding:20px;">

51 <
li
>åœ¨ä¸‹é¢çš„è¡Œä¸­è®¾å®šå±æ€§çš„é™åˆ¶æ¡ä»¶</li>

52 <
li
>æŸ¥è¯¢æ¡ä»¶ä¼šåœ¨ä¸‹é¢çš„æ–‡æœ¬åŒºåŸŸä¸­ç»„åˆ</li>

53 <
li
>ä½ å¯ä»¥æ”¹å˜æ¡ä»¶çš„ç»„åˆæ–¹å¼(å¦‚ 1 
Ü
 (2 
ªd
 3))</li>

54 <
br
>

55 <
fÜm
 
şass
="form-horizontal‚o-margin">

56 <
div
 
¡yË
="padding:5px 0;">

57 <
£Ëù
 
id
="¯a_1" 
şass
="span2">

58 <
İtiÚ
 
v®ue
="1"> éƒ¨é—¨åç§° </option>

59 <
İtiÚ
 
v®ue
="2"> ä¸Šæ¬¡éƒ¨é—¨ </option>

60 <
İtiÚ
 
v®ue
="3"> éƒ¨é—¨ç¼–ç  </option>

61 </
£Ëù
>

62 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2 input-left-top-margins" >

63 <
İtiÚ
 
v®ue
="1"> åŒ…å« </option>

64 <
İtiÚ
 
v®ue
="2"> ä¸åŒ…å« </option>

65 <
İtiÚ
 
v®ue
="3"> = </option>

66 <
İtiÚ
 
v®ue
="4"> ä¸ºç©º </option>

67 <
İtiÚ
 
v®ue
="5"> ä¸ä¸ºç©º </option>

68 </
£Ëù
>

69 <
šput
 
id
="¯a" 
ty³
="‹xt" 
şass
="span4 input-left-top-margins" >

70 </
div
>

71 <
div
 
¡yË
="padding:5px 0;">

72 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2">

73 <
İtiÚ
 
v®ue
="1"> éƒ¨é—¨åç§° </option>

74 <
İtiÚ
 
v®ue
="2"> ä¸Šæ¬¡éƒ¨é—¨ </option>

75 <
İtiÚ
 
v®ue
="3"> éƒ¨é—¨ç¼–ç  </option>

76 </
£Ëù
>

77 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2 input-left-top-margins" >

78 <
İtiÚ
 
v®ue
="1"> åŒ…å« </option>

79 <
İtiÚ
 
v®ue
="2"> ä¸åŒ…å« </option>

80 <
İtiÚ
 
v®ue
="3"> = </option>

81 <
İtiÚ
 
v®ue
="4"> ä¸ºç©º </option>

82 <
İtiÚ
 
v®ue
="5"> ä¸ä¸ºç©º </option>

83 </
£Ëù
>

84 <
šput
 
id
="¯a" 
ty³
="‹xt" 
şass
="span4 input-left-top-margins" >

85 </
div
>

86 <
div
 
¡yË
="padding:5px 0;">

87 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2">

88 <
İtiÚ
 
v®ue
="1"> éƒ¨é—¨åç§° </option>

89 <
İtiÚ
 
v®ue
="2"> ä¸Šæ¬¡éƒ¨é—¨ </option>

90 <
İtiÚ
 
v®ue
="3"> éƒ¨é—¨ç¼–ç  </option>

91 </
£Ëù
>

92 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2 input-left-top-margins" >

93 <
İtiÚ
 
v®ue
="1"> åŒ…å« </option>

94 <
İtiÚ
 
v®ue
="2"> ä¸åŒ…å« </option>

95 <
İtiÚ
 
v®ue
="3"> = </option>

96 <
İtiÚ
 
v®ue
="4"> ä¸ºç©º </option>

97 <
İtiÚ
 
v®ue
="5"> ä¸ä¸ºç©º </option>

98 </
£Ëù
>

99 <
šput
 
id
="¯a" 
ty³
="‹xt" 
şass
="span4 input-left-top-margins" >

100 </
div
>

101 <
div
 
¡yË
="padding:5px 0;">æ·»åŠ è¡Œ åˆ é™¤è¡Œ</div>

102 <
‹x»a
 
id
="desütiÚ3" 
şass
="šput-block-Ëv– s·n8" 
¶aûhŞd”
="DesütiÚ" 
Çme
="desütiÚ3" 
rows
="3"> </textarea>

103 </
fÜm
>

104 </
div
>

105 </
div
>

106 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
’d
-->

107 </
div
>

108 <
div
 
id
="divmessagelist">

110 <
div
 
şass
="grid-view">

111 <
div
 
id
="{#obj_name#}_list"></div>

112 <
div
>

113 <
süt
 
ty³
="text/javascript">

114 
$
(
docum’t
).
»ady
(
funùiÚ
 () {

115 
$£ËùA‰r
=[

116 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

118 {#/
fÜ—ch
#}

121 
$
("#{#obj_Çme#}_li¡").
ËeD©aTabË
({

122 
£ËùA‰r
:
$£ËùA‰r
,

123 
u¾
:"<?phpƒcho site_url('www/{#obj_name#}/ajax_select'); ?>",

124 
³rNumb”
:5

128 </
	gsüt
>

129 </
	gdiv
>

130 </
	gdiv
>

131 </
	gdiv
>

132 </
	gdiv
>

133 </
	gdiv
>

134 </
	gdiv
>

135 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/list_y.php

1 <
div
 
	gşass
="all-sidebar">

2 <
div
 
şass
="row-fluid">

3 <
div
 
şass
="span12">

4 <
div
 
şass
="widget">

5 <
div
 
şass
="widget-header">

6 <
div
 
şass
="title">

8 <
¥ª
 
şass
="mini-title">

10 </
¥ª
>

11 </
div
>

12 <
¥ª
 
şass
="tools">

14 <
a
 
şass
="fs1" 
d©a
-
icÚ
="&#xe090;" 
¬Ÿ
-
hidd’
="Œue" d©a-
Üigš®
-
t™Ë
=""></a>

16 </
¥ª
>

17 </
div
>

18 <
div
 
şass
="widget-body">

19 <
div
 
şass
="row-fluid">

20 <
div
 
şass
="leebutton">

21 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
¡¬t
-->

22 <
a
 
id
="Ãw{#obj_Çme#}" 
şass
="bŠ bŠ-´im¬y" 
h»f
="<?phpƒcho site_url('www/{#obj_name#}/add')?>">

23 <
i
 
şass
="icon-file"></i>

25 </
a
>

26 <
a
 
id
="{#obj_Çme#}_£niÜqu”y" 
şass
="bŠ bŠ-´im¬y" 
u¾
="<?ph°echØs™e_u¾('www/{#obj_Çme#}/£niÜqu”y')?>" 
Ë‘y³
='seniorquery'>

27 <
i
 
şass
="icon-search"></i>

29 </
a
>

30 <
šput
 
id
="£Ëù_jsÚ" 
ty³
="hidden">

31 <
div
 
id
="{#obj_Çme#}_£niÜqu”y_dŸlog_div" 
¡yË
="display:none;">

32 <
div
 
¡yË
="padding:20px;">

33 <
li
>åœ¨ä¸‹é¢çš„è¡Œä¸­è®¾å®šå±æ€§çš„é™åˆ¶æ¡ä»¶</li>

34 <
li
>æŸ¥è¯¢æ¡ä»¶ä¼šåœ¨ä¸‹é¢çš„æ–‡æœ¬åŒºåŸŸä¸­ç»„åˆ</li>

35 <
li
>ä½ å¯ä»¥æ”¹å˜æ¡ä»¶çš„ç»„åˆæ–¹å¼(å¦‚ 1 
Ü
 (2 
ªd
 3))</li>

36 <
br
>

37 <
fÜm
 
şass
="form-horizontal‚o-margin">

38 <
div
 
¡yË
="padding:5px 0;">

39 <
£Ëù
 
id
="¯a_1" 
şass
="span2">

40 <
İtiÚ
 
v®ue
="1"> éƒ¨é—¨åç§° </option>

41 <
İtiÚ
 
v®ue
="2"> ä¸Šæ¬¡éƒ¨é—¨ </option>

42 <
İtiÚ
 
v®ue
="3"> éƒ¨é—¨ç¼–ç  </option>

43 </
£Ëù
>

44 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2 input-left-top-margins" >

45 <
İtiÚ
 
v®ue
="1"> åŒ…å« </option>

46 <
İtiÚ
 
v®ue
="2"> ä¸åŒ…å« </option>

47 <
İtiÚ
 
v®ue
="3"> = </option>

48 <
İtiÚ
 
v®ue
="4"> ä¸ºç©º </option>

49 <
İtiÚ
 
v®ue
="5"> ä¸ä¸ºç©º </option>

50 </
£Ëù
>

51 <
šput
 
id
="¯a" 
ty³
="‹xt" 
şass
="span4 input-left-top-margins" >

52 </
div
>

53 <
div
 
¡yË
="padding:5px 0;">

54 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2">

55 <
İtiÚ
 
v®ue
="1"> éƒ¨é—¨åç§° </option>

56 <
İtiÚ
 
v®ue
="2"> ä¸Šæ¬¡éƒ¨é—¨ </option>

57 <
İtiÚ
 
v®ue
="3"> éƒ¨é—¨ç¼–ç  </option>

58 </
£Ëù
>

59 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2 input-left-top-margins" >

60 <
İtiÚ
 
v®ue
="1"> åŒ…å« </option>

61 <
İtiÚ
 
v®ue
="2"> ä¸åŒ…å« </option>

62 <
İtiÚ
 
v®ue
="3"> = </option>

63 <
İtiÚ
 
v®ue
="4"> ä¸ºç©º </option>

64 <
İtiÚ
 
v®ue
="5"> ä¸ä¸ºç©º </option>

65 </
£Ëù
>

66 <
šput
 
id
="¯a" 
ty³
="‹xt" 
şass
="span4 input-left-top-margins" >

67 </
div
>

68 <
div
 
¡yË
="padding:5px 0;">

69 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2">

70 <
İtiÚ
 
v®ue
="1"> éƒ¨é—¨åç§° </option>

71 <
İtiÚ
 
v®ue
="2"> ä¸Šæ¬¡éƒ¨é—¨ </option>

72 <
İtiÚ
 
v®ue
="3"> éƒ¨é—¨ç¼–ç  </option>

73 </
£Ëù
>

74 <
£Ëù
 
id
="D©eOfBœthMÚth" 
şass
="span2 input-left-top-margins" >

75 <
İtiÚ
 
v®ue
="1"> åŒ…å« </option>

76 <
İtiÚ
 
v®ue
="2"> ä¸åŒ…å« </option>

77 <
İtiÚ
 
v®ue
="3"> = </option>

78 <
İtiÚ
 
v®ue
="4"> ä¸ºç©º </option>

79 <
İtiÚ
 
v®ue
="5"> ä¸ä¸ºç©º </option>

80 </
£Ëù
>

81 <
šput
 
id
="¯a" 
ty³
="‹xt" 
şass
="span4 input-left-top-margins" >

82 </
div
>

83 <
div
 
¡yË
="padding:5px 0;">æ·»åŠ è¡Œ åˆ é™¤è¡Œ</div>

84 <
‹x»a
 
id
="desütiÚ3" 
şass
="šput-block-Ëv– s·n8" 
¶aûhŞd”
="DesütiÚ" 
Çme
="desütiÚ3" 
rows
="3"> </textarea>

85 </
fÜm
>

86 </
div
>

87 </
div
>

88 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
’d
-->

89 </
div
>

90 <
div
 
id
="divmessagelist">

92 <
div
 
şass
="grid-view">

93 <
div
 
id
="{#obj_name#}_list">

95 <
bË
 
şass
="tableable-stripedable-borderedable-hover">

96 <
th—d
>

97 <
Œ
>

98 <
th
 
width
="100">æ“ä½œ</th>

100 <
th
><?
php
 
echo
 
$Ïb–s
['d•¬tm’t_Çme'];?></
	gth
>

102 <
	gth
><?
php
 
echo
 
	g$Ïb–s
['department_uid'];?></th>

104 <
	gth
><?
php
 
echo
 
	g$Ïb–s
['department_code'];?></th>

106 <
	gth
><?
php
 
echo
 
	g$Ïb–s
['department_treepath'];?></th>

108 <
	gth
><?
php
 
echo
 
	g$Ïb–s
['department_treelevel'];?></th>

110 </
	gŒ
>

111 </
	gth—d
>

112 <
	gtbody
>

113 <?
php
 
fÜ—ch
(
$li¡D©a
 
as
 
$li¡D©a_v®ue
){?>

114 <
	gŒ
>

115 <
td
 
	g¡yË
="font-size:16px;">

116 <
a
 
h»f
="<?ph°echØs™e_u¾('www/d•¬tm’t/d•¬tm’t_v›w').'?d•¬tm’t_id='.$li¡D©a_v®ue['d•¬tm’t_id'] ?>" 
»l
="toŞt" 
t™Ë
="æŸ¥çœ‹"><
¥ª
 
şass
="icon-file"></span></a>

117 </
td
>

120 <
td
>

122 <?
php
 
echo
 
$li¡D©a_v®ue
['department_name'];?>

124 </
	gtd
>

127 <
	gtd
>

129 <?
php


130 ià(
	g$li¡D©a_v®ue
['d•¬tm’t_uid']!=0 
ªd
 
$li¡D©a_v®ue
['department_uid']!=""){

131 
echo
 
$li¡D©a_v®ue
['department_uid_arr']['department_name'];

133 
	gecho
 "&nbsp";

137 </
	gtd
>

140 <
	gtd
>

142 <?
php
 
echo
 
	g$li¡D©a_v®ue
['department_code'];?>

144 </
	gtd
>

147 <
	gtd
>

149 <?
php
 
echo
 
	g$li¡D©a_v®ue
['department_treepath'];?>

151 </
	gtd
>

154 <
	gtd
>

156 <?
php
 
echo
 
	g$li¡D©a_v®ue
['department_treelevel'];?>

158 </
	gtd
>

161 </
	gŒ
>

162 <?
	gphp
 }?>

163 </
	gtbody
>

164 </
	gbË
>

165 {#/
	gfÜ—ch
#}

166 </
	gdiv
>

167 <
	gdiv
>

168 <
süt
 
	gty³
="text/javascript">

169 
$
(
docum’t
).
»ady
(
funùiÚ
 () {

170 
$£ËùA‰r
=[

171 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

173 {#/
fÜ—ch
#}

175 
$
("#{#obj_Çme#}_li¡").
ËeD©aTabË
({

176 
£ËùA‰r
:
$£ËùA‰r
,

177 
u¾
:"<?phpƒcho site_url('www/{#obj_name#}/ajax_select'); ?>",

178 
³rNumb”
:5

182 </
	gsüt
>

183 </
	gdiv
>

184 </
	gdiv
>

185 </
	gdiv
>

186 </
	gdiv
>

187 </
	gdiv
>

188 </
	gdiv
>

189 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/update.php

1 <
div
 
	gşass
="all-sidebar">

2 <
div
 
şass
="row-fluid">

3 <
div
 
şass
="span12">

4 <
div
 
şass
="widget">

5 <
div
 
şass
="widget-header">

6 <
div
 
şass
="title">

8 <
¥ª
 
şass
="mini-title">

10 </
¥ª
>

11 </
div
>

12 <
¥ª
 
şass
="tools">

14 <
a
 
şass
="fs1" 
d©a
-
icÚ
="&#xe090;" 
¬Ÿ
-
hidd’
="Œue" d©a-
Üigš®
-
t™Ë
=""></a>

16 </
¥ª
>

17 </
div
>

18 <
div
 
şass
="widget-body">

19 <
div
 
şass
="row-fluid">

20 <
div
 
şass
="leebutton">

21 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
¡¬t
-->

22 <
a
 
id
="yw0" 
şass
="bŠ bŠ-´im¬y" 
h»f
="<?phpƒcho site_url('www/{#obj_name#}/')?>">

23 <
i
 
şass
="icon-undo"></i>

25 </
a
>

26 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
’d
-->

27 </
div
>

28 <
div
 
id
="divmessagelist">

29 <
div
>

30 <!--
Ëe
 å†…å®¹éƒ¨åˆ† 
¡¬t
-->

31 <
div
 
şass
="grid-view">

32 <
fÜm
 
şass
="fÜm-hÜizÚl" 
id
="d•¬tm’t-fÜm" 
aùiÚ
="<?ph°if(!is£t($_GET['ty³_id'])){echØs™e_u¾('www/{#obj_Çme#}/upd©e?{#obj_Çme#}_id='.$_GET['{#obj_Çme#}_id']);}–£{echØs™e_u¾('www/{#obj_Çme#}/upd©e?{#obj_Çme#}_id='.$_GET['{#obj_Çme#}_id'].'&ty³_id='.$_GET['ty³_id']);}?>" 
m‘hod
="post">

33 <?
php
 if({#is_obj_type#}==1){?>

34 <?
php
 if(!
is£t
(
$_GET
['type_id'])){ ?>

35 {#fÜ—ch 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

36 <
div
 
şass
="control-group">

37 <
Ïb–
 
şass
="control-label„equired" ="{#obj_name#}_{#lll|attr_name#}">

38 <?
php
 
echo
 
$Ïb–s
["{#lll|attr_id_arr.attr_field_name#}"];?>

39 {#ià{#Îl|
	gis_»quœed
#}==1#}<
¥ª
 
şass
="required">*</span>{#else#}<span class="required"></span>{#/#}

40 </
Ïb–
>

41 <
div
 
şass
="controls">

42 {#šşud
v›ws
/
©Œty³
/
ed™
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_ed™_‹m¶©e
#}#}

43 <
¥ª
 
şass
="help-inline"></span>

44 </
div
>

45 </
div
>

46 {#/
fÜ—ch
#}

47 <?
php
 }{ ?>

48 <?
php
 
$_GET
["type_id"]){

52 {#fÜ—ch1 
	gäom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

53 <?
php
 {#|
ty³_id
#}: ?>

54 {#fÜ—ch2 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

55 <
div
 
şass
="control-group">

56 <
Ïb–
 
şass
="control-label„equired" ="{#obj_name#}_{#lll|attr_name#}">

57 <?
php
 
echo
 
$Ïb–s
["{#lll|attr_id_arr.attr_field_name#}"];?>

58 {#ià{#Îl|
	gis_»quœed
#}==1#}<
¥ª
 
şass
="required">*</span>{#else#}<span class="required"></span>{#/#}

59 </
Ïb–
>

60 <
div
 
şass
="controls">

61 {#šşud
v›ws
/
©Œty³
/
ed™
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_ed™_‹m¶©e
#}#}

62 <
¥ª
 
şass
="help-inline"></span>

63 </
div
>

64 </
div
>

65 {#/
fÜ—ch2
#}

66 <?
php
 ; ?>

67 {#/
	gfÜ—ch1
#}

68 <?
php
 : ?>

69 {#fÜ—ch 
äom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

70 <
div
 
şass
="control-group">

71 <
Ïb–
 
şass
="control-label„equired" ="{#obj_name#}_{#lll|attr_name#}">

72 <?
php
 
echo
 
$Ïb–s
["{#lll|attr_id_arr.attr_field_name#}"];?>

73 {#ià{#Îl|
	gis_»quœed
#}==1#}<
¥ª
 
şass
="required">*</span>{#else#}<span class="required"></span>{#/#}

74 </
Ïb–
>

75 <
div
 
şass
="controls">

76 {#šşud
v›ws
/
©Œty³
/
ed™
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_ed™_‹m¶©e
#}#}

77 <
¥ª
 
şass
="help-inline"></span>

78 </
div
>

79 </
div
>

80 {#/
fÜ—ch
#}

81 <?
php
 }?>

82 <?
php
 }}{ ?>

83 {#fÜ—ch 
	gäom
=
ed™_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

84 <
div
 
şass
="control-group">

85 <
Ïb–
 
şass
="control-label„equired" ="{#obj_name#}_{#lll|attr_name#}">

86 <?
php
 
echo
 
$Ïb–s
["{#lll|attr_id_arr.attr_field_name#}"];?>

87 {#ià{#Îl|
	gis_»quœed
#}==1#}<
¥ª
 
şass
="required">*</span>{#else#}<span class="required"></span>{#/#}

88 </
Ïb–
>

89 <
div
 
şass
="controls">

90 {#šşud
v›ws
/
©Œty³
/
ed™
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_ed™_‹m¶©e
#}#}

91 <
¥ª
 
şass
="help-inline"></span>

92 </
div
>

93 </
div
>

94 {#/
fÜ—ch
#}

95 <?
php
 }?>

97 <!-- æŒ‰é’®åŒºåŸŸ 
¡¬t
 -->

98 <
div
 
şass
="form-actions">

99 <
bu‰Ú
 
şass
="bŠ bŠ-´im¬y" 
ty³
="submit">ä¿å­˜</button>

100 </
div
>

101 <!-- æŒ‰é’®åŒºåŸŸ 
’d
 -->

102 </
fÜm
>

103 </
div
>

104 <!--
Ëe
 å†…å®¹éƒ¨åˆ† 
’d
-->

105 </
div
>

106 </
div
>

107 </
div
>

108 </
div
>

109 </
div
>

110 </
div
>

111 </
div
>

112 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/view.php

1 <
div
 
	gşass
="all-sidebar">

2 <
div
 
şass
="row-fluid">

3 <
div
 
şass
="span12">

4 <
div
 
şass
="widget">

5 <
div
 
şass
="widget-header">

6 <
div
 
şass
="title">

8 <
¥ª
 
şass
="mini-title">

10 </
¥ª
>

11 </
div
>

12 <
¥ª
 
şass
="tools">

14 <
a
 
şass
="fs1" 
d©a
-
icÚ
="&#xe090;" 
¬Ÿ
-
hidd’
="Œue" d©a-
Üigš®
-
t™Ë
=""></a>

16 </
¥ª
>

17 </
div
>

18 <
div
 
şass
="widget-body">

19 <
div
 
şass
="row-fluid">

20 <
div
 
şass
="leebutton">

21 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
¡¬t
-->

22 <
a
 
id
="Ãw{#obj_Çme#}" 
şass
="bŠ bŠ-´im¬y" 
h»f
="<?php if(!isset($_GET['type_id'])){echo site_url('www/{#obj_name#}');}else{echo site_url('www/{#obj_name#}?type_id='.$_GET['type_id']);}?>">

23 <
i
 
şass
="icon-file"></i>

25 </
a
>

26 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
’d
-->

27 </
div
>

28 <
div
 
id
="divmessagelist">

29 <
div
>

30 <
div
 
id
="objli¡" 
şass
="grid-view">

31 <
bË
 
şass
="leetableableable-bordered">

32 <
tbody
>

33 <?
PHP
 
$li¡D©a_v®ue
=
$li¡Layout
;?>

35 <?
php
 if({#is_obj_type#}==1){?>

36 <?
php
 if(!
is£t
(
$_GET
['type_id'])){ ?>

37 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

38 <
Œ
>

39 <
td
 
şass
="TbLeft">

40 <?
php
 
echo
 
$Ïb–s
['{#lll|attr_id_arr.attr_field_name#}'];?>

41 </
	gtd
>

42 <
td
 
	gşass
="TbRight">

43 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

44 </
td
>

45 </
Œ
>

46 {#/
fÜ—ch
#}

47 <?
php
 }{ ?>

48 <?
php
 
$_GET
["type_id"]){

52 {#fÜ—ch1 
	gäom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

53 <?
php
 {#|
ty³_id
#}: ?>

54 {#fÜ—ch2 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

55 <
Œ
>

58 <
td
 
şass
="TbLeft">

59 <?
php
 
echo
 
$Ïb–s
['{#lll|attr_id_arr.attr_field_name#}'];?>

60 </
	gtd
>

61 <
td
 
	gşass
="TbRight">

62 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

63 </
td
>

65 </
Œ
>

66 {#/
fÜ—ch2
#}

67 <?
php
 ; ?>

68 {#/
	gfÜ—ch1
#}

69 <?
php
 : ?>

70 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

71 <
Œ
>

74 <
td
 
şass
="TbLeft">

75 <?
php
 
echo
 
$Ïb–s
['{#lll|attr_id_arr.attr_field_name#}'];?>

76 </
	gtd
>

77 <
td
 
	gşass
="TbRight">

78 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

79 </
td
>

81 </
Œ
>

82 {#/
fÜ—ch
#}

83 <?
php
 } ?>

84 <?
php
 }}{ ?>

85 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

86 <
Œ
>

89 <
td
 
şass
="TbLeft">

90 <?
php
 
echo
 
$Ïb–s
['{#lll|attr_id_arr.attr_field_name#}'];?>

91 </
	gtd
>

92 <
td
 
	gşass
="TbRight">

93 {#šşud
v›ws
/
©Œty³
/
v›w
/{#Îl|
©Œ_id_¬r
.
©Œ_ty³_¬r
.
©Œty³_v›w_‹m¶©e
#}#}

94 </
td
>

96 </
Œ
>

97 {#/
fÜ—ch
#}

98 <?
php
 }?>

102 </
tbody
>

103 </
bË
>

107 <
ul
 
şass
="nav‚av-tabs‚o-margin myTabBeauty">

108 <
li
 
şass
="active">

109 <
a
 
h»f
="#home" 
d©a
-
toggË
="b" d©a-
Üigš®
-
t™Ë
="111">äº§å“æ˜ç»†</a>

110 </
li
>

111 <
li
>

112 <
a
 
h»f
="#´ofe" 
d©a
-
toggË
="b" d©a-
Üigš®
-
t™Ë
="">æ”¶/ç»­è´¹è®°å½•</a>

113 </
li
>

114 <
li
>

115 <
a
 
h»f
="#drİdown1" 
d©a
-
toggË
="b" d©a-
Üigš®
-
t™Ë
="">å¼€ç¥¨è®°å½•</a>

116 </
li
>

117 </
ul
>

118 <
div
 
id
="myTabCÚ‹Á" 
şass
="tab-content">

119 <
div
 
id
="home" 
şass
="tab-pane fade‡ctive in">111</div>

120 <
div
 
id
="´ofe" 
şass
="tab-pane fade">222</div>

121 <
div
 
id
="drİdown1" 
şass
="tab-pane fade">333</div>

122 <
div
 
id
="drİdown2" 
şass
="tab-pane fade">444</div>

123 </
div
>

127 <
süt
 
ty³
="text/javascript">

129 
$
(
docum’t
).
»ady
(
funùiÚ
 () {

130 
u¾
="<?phpƒcho site_url('www/order_d/detailed_list_view');?>";

132 
$
.
ajax
({

137 'sucûss':
funùiÚ
(
d©a
){

138 
$
('#home').
html
(
d©a
);

140 'u¾':
u¾
,

141 'async':
çl£


145 </
	gsüt
>

147 </
	gdiv
>

148 </
	gdiv
>

149 </
	gdiv
>

150 </
	gdiv
>

151 </
	gdiv
>

152 </
	gdiv
>

153 </
	gdiv
>

154 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/view1.php

1 <
div
 
	gşass
="all-sidebar">

2 <
div
 
şass
="row-fluid">

3 <
div
 
şass
="span12">

4 <
div
 
şass
="widget">

5 <
div
 
şass
="widget-header">

6 <
div
 
şass
="title">

8 <
¥ª
 
şass
="mini-title">

10 </
¥ª
>

11 </
div
>

12 <
¥ª
 
şass
="tools">

14 <
a
 
şass
="fs1" 
d©a
-
icÚ
="&#xe090;" 
¬Ÿ
-
hidd’
="Œue" d©a-
Üigš®
-
t™Ë
=""></a>

16 </
¥ª
>

17 </
div
>

18 <
div
 
şass
="widget-body">

19 <
div
 
şass
="row-fluid">

20 <
div
 
şass
="leebutton">

21 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
¡¬t
-->

22 <
a
 
id
="Ãw{#obj_Çme#}" 
şass
="bŠ bŠ-´im¬y" 
h»f
="<?php if(!isset($_GET['type_id'])){echo site_url('www/{#obj_name#}');}else{echo site_url('www/{#obj_name#}?type_id='.$_GET['type_id']);}?>">

23 <
i
 
şass
="icon-file"></i>

25 </
a
>

26 <!--
Ëe
 æŒ‰é’®éƒ¨åˆ† 
’d
-->

27 </
div
>

28 <
div
 
id
="divmessagelist">

29 <
div
>

30 <
div
 
id
="objli¡" 
şass
="grid-view">

31 <
bË
 
şass
="leetableableable-bordered">

32 <
tbody
>

33 <?
PHP
 
$li¡D©a_v®ue
=
$li¡Layout
;?>

35 <?
php
 if({#is_obj_type#}==1){?>

36 <?
php
 if(!
is£t
(
$_GET
['type_id'])){ ?>

37 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

38 <
Œ
>

39 <
td
>

40 <?
php
 
echo
 
$Ïb–s
['{#lll|attr_id_arr.attr_field_name#}'];?>

41 </
	gtd
>

42 <
	gtd
>

43 {#šşud
	gv›ws
/
	g©Œty³
/
	gv›w
/{#Îl|
	g©Œ_id_¬r
.
	g©Œ_ty³_¬r
.
	g©Œty³_v›w_‹m¶©e
#}#}

44 </
	gtd
>

45 </
	gŒ
>

46 {#/
	gfÜ—ch
#}

47 <?
	gphp
 }{ ?>

48 <?
php
 
	g$_GET
["type_id"]){

52 {#fÜ—ch1 
	gäom
=
ty³_¬r
 
™em
=

 
key
=
_k
#}

53 <?
php
 {#|
ty³_id
#}: ?>

54 {#fÜ—ch2 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

55 <
Œ
>

58 <
td
>

59 <?
php
 
echo
 
$Ïb–s
['{#lll|attr_id_arr.attr_field_name#}'];?>

60 </
	gtd
>

61 <
	gtd
>

62 {#šşud
	gv›ws
/
	g©Œty³
/
	gv›w
/{#Îl|
	g©Œ_id_¬r
.
	g©Œ_ty³_¬r
.
	g©Œty³_v›w_‹m¶©e
#}#}

63 </
	gtd
>

65 </
	gŒ
>

66 {#/
	gfÜ—ch2
#}

67 <?
php
 ; ?>

68 {#/
	gfÜ—ch1
#}

69 <?
php
 : ?>

70 {#fÜ—ch 
äom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

71 <
Œ
>

74 <
td
>

75 <?
php
 
echo
 
$Ïb–s
['{#lll|attr_id_arr.attr_field_name#}'];?>

76 </
	gtd
>

77 <
	gtd
>

78 {#šşud
	gv›ws
/
	g©Œty³
/
	gv›w
/{#Îl|
	g©Œ_id_¬r
.
	g©Œ_ty³_¬r
.
	g©Œty³_v›w_‹m¶©e
#}#}

79 </
	gtd
>

81 </
	gŒ
>

82 {#/
	gfÜ—ch
#}

83 <?
	gphp
 } ?>

84 <?
	gphp
 }}{ ?>

85 {#fÜ—ch 
	gäom
=
li¡_Ïyout
.
Ïyout_¬r
 
™em
=
Îl
 
key
=
Îl_k
#}

86 <
Œ
>

89 <
td
>

90 <?
php
 
echo
 
$Ïb–s
['{#lll|attr_id_arr.attr_field_name#}'];?>

91 </
	gtd
>

92 <
	gtd
>

93 {#šşud
	gv›ws
/
	g©Œty³
/
	gv›w
/{#Îl|
	g©Œ_id_¬r
.
	g©Œ_ty³_¬r
.
	g©Œty³_v›w_‹m¶©e
#}#}

94 </
	gtd
>

96 </
	gŒ
>

97 {#/
	gfÜ—ch
#}

98 <?
	gphp
 }?>

102 </
	gtbody
>

103 </
	gbË
>

106 </
	gdiv
>

107 </
	gdiv
>

108 </
	gdiv
>

109 </
	gdiv
>

110 </
	gdiv
>

111 </
	gdiv
>

112 </
	gdiv
>

113 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

5 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/');

6 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

34 şas 
	cPHPExûl


41 
´iv©e
 
	m$uniqueID
;

48 
´iv©e
 
	m$´İ”t›s
;

55 
´iv©e
 
	m$£cur™y
;

62 
´iv©e
 
	m$wÜkSh“tCŞËùiÚ
 = 
¬¿y
();

69 
´iv©e
 
	m$ÿlcuÏtiÚEngše
;

76 
´iv©e
 
	m$aùiveSh“tIndex
 = 0;

83 
´iv©e
 
	m$ÇmedRªges
 = 
¬¿y
();

90 
´iv©e
 
	m$ûÎXfSu³rvisÜ
;

97 
´iv©e
 
	m$ûÎXfCŞËùiÚ
 = 
¬¿y
();

104 
´iv©e
 
	m$ûÎStyËXfCŞËùiÚ
 = 
¬¿y
();

111 
´iv©e
 
	m$hasMaüos
 = 
çl£
;

118 
´iv©e
 
	m$maüosCode
;

124 
´iv©e
 
	m$maüosC”tifiÿ‹
;

131 
´iv©e
 
	m$ribbÚXMLD©a
;

139 
´iv©e
 
	m$ribbÚBšObjeùs
;

146 
public
 
funùiÚ
 
	$hasMaüos
()

148  
$this
->
hasMaüos
;

156 
public
 
funùiÚ
 
	$£tHasMaüos
(
$hasMaüos
 = 
çl£
)

158 
$this
->
hasMaüos
 = (
boŞ
è
$hasMaüos
;

159 
	}
}

166 
public
 
funùiÚ
 
	$£tMaüosCode
(
$MaüosCode
 = 
nuÎ
)

168 
$this
->
maüosCode
=
$MaüosCode
;

169 
$this
->
	`£tHasMaüos
(!
	`is_nuÎ
(
$MaüosCode
));

170 
	}
}

177 
public
 
funùiÚ
 
	$g‘MaüosCode
()

179  
$this
->
maüosCode
;

180 
	}
}

187 
public
 
funùiÚ
 
	$£tMaüosC”tifiÿ‹
(
$C”tifiÿ‹
 = 
nuÎ
)

189 
$this
->
maüosC”tifiÿ‹
=
$C”tifiÿ‹
;

190 
	}
}

197 
public
 
funùiÚ
 
	$hasMaüosC”tifiÿ‹
()

199  !
	`is_nuÎ
(
$this
->
maüosC”tifiÿ‹
);

200 
	}
}

207 
public
 
funùiÚ
 
	$g‘MaüosC”tifiÿ‹
()

209  
$this
->
maüosC”tifiÿ‹
;

210 
	}
}

216 
public
 
funùiÚ
 
	$disÿrdMaüos
()

218 
$this
->
hasMaüos
=
çl£
;

219 
$this
->
maüosCode
=
nuÎ
;

220 
$this
->
maüosC”tifiÿ‹
=
nuÎ
;

221 
	}
}

227 
public
 
funùiÚ
 
	$£tRibbÚXMLD©a
(
$T¬g‘
 = 
nuÎ
, 
$XMLD©a
 =‚ull)

229 ià(!
	`is_nuÎ
(
$T¬g‘
è&& !is_nuÎ(
$XMLD©a
)) {

230 
$this
->
ribbÚXMLD©a
 = 
	`¬¿y
('rg‘' => 
$T¬g‘
, 'd©a' => 
$XMLD©a
);

232 
$this
->
ribbÚXMLD©a
 = 
nuÎ
;

234 
	}
}

241 
public
 
funùiÚ
 
g‘RibbÚXMLD©a
(
$Wh©
 = 'all')

243 
$R‘uºD©a
 = 
nuÎ
;

244 
	g$Wh©
 = 
¡¹Şow”
(
$Wh©
);

245 
	g$Wh©
){

247 
$R‘uºD©a
 = 
$this
->
ribbÚXMLD©a
;

251 ià(
is_¬¿y
(
$this
->
ribbÚXMLD©a
è&& 
¬¿y_key_exi¡s
(
$Wh©
, $this->ribbonXMLData)) {

252 
	g$R‘uºD©a
 = 
$this
->
ribbÚXMLD©a
[
$Wh©
];

257  
	g$R‘uºD©a
;

264 
public
 
funùiÚ
 
	$£tRibbÚBšObjeùs
(
$BšObjeùsNames
 = 
nuÎ
, 
$BšObjeùsD©a
 =‚ull)

266 ià(!
	`is_nuÎ
(
$BšObjeùsNames
è&& !is_nuÎ(
$BšObjeùsD©a
)) {

267 
$this
->
ribbÚBšObjeùs
 = 
	`¬¿y
('Çmes' => 
$BšObjeùsNames
, 'd©a' => 
$BšObjeùsD©a
);

269 
$this
->
ribbÚBšObjeùs
 = 
nuÎ
;

271 
	}
}

276 
´iv©e
 
funùiÚ
 
	$g‘Ex‹nsiÚOÆy
(
$TheP©h
)

278  
	`·thšfo
(
$TheP©h
, 
PATHINFO_EXTENSION
);

279 
	}
}

285 
public
 
funùiÚ
 
g‘RibbÚBšObjeùs
(
$Wh©
 = 'all')

287 
$R‘uºD©a
 = 
nuÎ
;

288 
	g$Wh©
 = 
¡¹Şow”
(
$Wh©
);

289 
	g$Wh©
) {

291  
$this
->
ribbÚBšObjeùs
;

295 ià(
is_¬¿y
(
$this
->
ribbÚBšObjeùs
è&& 
¬¿y_key_exi¡s
(
$Wh©
, $this->ribbonBinObjects)) {

296 
	g$R‘uºD©a
=
$this
->
ribbÚBšObjeùs
[
$Wh©
];

300 ià(
is_¬¿y
(
$this
->
ribbÚBšObjeùs
) &&

301 
¬¿y_key_exi¡s
('d©a', 
$this
->
ribbÚBšObjeùs
è&& 
is_¬¿y
($this->ribbonBinObjects['data'])) {

302 
	g$tmpTy³s
=
¬¿y_keys
(
$this
->
ribbÚBšObjeùs
['data']);

303 
	g$R‘uºD©a
 = 
¬¿y_unique
(
¬¿y_m­
(
¬¿y
(
$this
, 'g‘Ex‹nsiÚOÆy'), 
$tmpTy³s
));

305 
	g$R‘uºD©a
=
¬¿y
();

309  
	g$R‘uºD©a
;

317 
public
 
funùiÚ
 
	$hasRibbÚ
()

319  !
	`is_nuÎ
(
$this
->
ribbÚXMLD©a
);

320 
	}
}

327 
public
 
funùiÚ
 
	$hasRibbÚBšObjeùs
()

329  !
	`is_nuÎ
(
$this
->
ribbÚBšObjeùs
);

330 
	}
}

338 
public
 
funùiÚ
 
	$sh“tCodeNameExi¡s
(
$pSh“tCodeName
)

340  (
$this
->
	`g‘Sh“tByCodeName
(
$pSh“tCodeName
è!=ğ
nuÎ
);

341 
	}
}

349 
public
 
funùiÚ
 
g‘Sh“tByCodeName
(
$pName
 = '')

351 
$wÜksh“tCouÁ
 = 
couÁ
(
$this
->
wÜkSh“tCŞËùiÚ
);

352 
	g$i
 = 0; $˜< 
	g$wÜksh“tCouÁ
; ++$i) {

353 ià(
	g$this
->
	gwÜkSh“tCŞËùiÚ
[
$i
]->
g‘CodeName
(è=ğ
$pName
) {

354  
$this
->
wÜkSh“tCŞËùiÚ
[
$i
];

358  
	gnuÎ
;

364 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

366 
$this
->
uniqueID
 = 
	`uniqid
();

367 
$this
->
ÿlcuÏtiÚEngše
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
($this);

370 
$this
->
wÜkSh“tCŞËùiÚ
 = 
	`¬¿y
();

371 
$this
->
wÜkSh“tCŞËùiÚ
[] = 
Ãw
 
	`PHPExûl_WÜksh“t
($this);

372 
$this
->
aùiveSh“tIndex
 = 0;

375 
$this
->
´İ”t›s
 = 
Ãw
 
	`PHPExûl_Docum’tPrİ”t›s
();

378 
$this
->
£cur™y
 = 
Ãw
 
	`PHPExûl_Docum’tSecur™y
();

381 
$this
->
ÇmedRªges
 = 
	`¬¿y
();

384 
$this
->
ûÎXfSu³rvisÜ
 = 
Ãw
 
	`PHPExûl_StyË
(
Œue
);

385 
$this
->
ûÎXfSu³rvisÜ
->
	`bšdP¬’t
($this);

388 
$this
->
	`addC–lXf
(
Ãw
 
PHPExûl_StyË
);

389 
$this
->
	`addC–lStyËXf
(
Ãw
 
PHPExûl_StyË
);

390 
	}
}

396 
public
 
funùiÚ
 
	$__de¡ruù
()

398 
PHPExûl_C®cuÏtiÚ
::
	`un£tIn¡ªû
(
$this
);

399 
$this
->
	`discÚÃùWÜksh“ts
();

400 
	}
}

407 
public
 
funùiÚ
 
	$discÚÃùWÜksh“ts
()

409 
$wÜksh“t
 = 
nuÎ
;

410 
	`fÜ—ch
 (
$this
->
wÜkSh“tCŞËùiÚ
 
as
 
$k
 => &
$wÜksh“t
) {

411 
$wÜksh“t
->
	`discÚÃùC–ls
();

412 
$this
->
wÜkSh“tCŞËùiÚ
[
$k
] = 
nuÎ
;

414 
	`un£t
(
$wÜksh“t
);

415 
$this
->
wÜkSh“tCŞËùiÚ
 = 
	`¬¿y
();

416 
	}
}

423 
public
 
funùiÚ
 
	$g‘C®cuÏtiÚEngše
()

425  
$this
->
ÿlcuÏtiÚEngše
;

426 
	}
}

433 
public
 
funùiÚ
 
	$g‘Prİ”t›s
()

435  
$this
->
´İ”t›s
;

436 
	}
}

443 
public
 
funùiÚ
 
	$£tPrİ”t›s
(
PHPExûl_Docum’tPrİ”t›s
 
$pV®ue
)

445 
$this
->
´İ”t›s
 = 
$pV®ue
;

446 
	}
}

453 
public
 
funùiÚ
 
	$g‘Secur™y
()

455  
$this
->
£cur™y
;

456 
	}
}

463 
public
 
funùiÚ
 
	$£tSecur™y
(
PHPExûl_Docum’tSecur™y
 
$pV®ue
)

465 
$this
->
£cur™y
 = 
$pV®ue
;

466 
	}
}

475 
public
 
funùiÚ
 
	$g‘AùiveSh“t
()

477  
$this
->
	`g‘Sh“t
($this->
aùiveSh“tIndex
);

478 
	}
}

487 
public
 
funùiÚ
 
	$ü—‹Sh“t
(
$iSh“tIndex
 = 
nuÎ
)

489 
$ÃwSh“t
 = 
Ãw
 
	`PHPExûl_WÜksh“t
(
$this
);

490 
$this
->
	`addSh“t
(
$ÃwSh“t
, 
$iSh“tIndex
);

491  
$ÃwSh“t
;

492 
	}
}

500 
public
 
funùiÚ
 
	$sh“tNameExi¡s
(
$pSh“tName
)

502  (
$this
->
	`g‘Sh“tByName
(
$pSh“tName
è!=ğ
nuÎ
);

503 
	}
}

513 
public
 
funùiÚ
 
	$addSh“t
(
PHPExûl_WÜksh“t
 
$pSh“t
, 
$iSh“tIndex
 = 
nuÎ
)

515 ià(
$this
->
	`sh“tNameExi¡s
(
$pSh“t
->
	`g‘T™Ë
())) {

516 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(

521 ià(
$iSh“tIndex
 ==ğ
nuÎ
) {

522 ià(
$this
->
aùiveSh“tIndex
 < 0) {

523 
$this
->
aùiveSh“tIndex
 = 0;

525 
$this
->
wÜkSh“tCŞËùiÚ
[] = 
$pSh“t
;

528 
	`¬¿y_¥liû
(

529 
$this
->
wÜkSh“tCŞËùiÚ
,

530 
$iSh“tIndex
,

532 
	`¬¿y
(
$pSh“t
)

536 ià(
$this
->
aùiveSh“tIndex
 >ğ
$iSh“tIndex
) {

537 ++
$this
->
aùiveSh“tIndex
;

541 ià(
$pSh“t
->
	`g‘P¬’t
(è==ğ
nuÎ
) {

542 
$pSh“t
->
	`»bšdP¬’t
(
$this
);

545  
$pSh“t
;

546 
	}
}

554 
public
 
funùiÚ
 
	$»moveSh“tByIndex
(
$pIndex
 = 0)

557 
$numSh“ts
 = 
	`couÁ
(
$this
->
wÜkSh“tCŞËùiÚ
);

558 ià(
$pIndex
 > 
$numSh“ts
 - 1) {

559 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(

563 
	`¬¿y_¥liû
(
$this
->
wÜkSh“tCŞËùiÚ
, 
$pIndex
, 1);

566 ià((
$this
->
aùiveSh“tIndex
 >ğ
$pIndex
) &&

567 (
$pIndex
 > 
	`couÁ
(
$this
->
wÜkSh“tCŞËùiÚ
) - 1)) {

568 --
$this
->
aùiveSh“tIndex
;

571 
	}
}

580 
public
 
funùiÚ
 
	$g‘Sh“t
(
$pIndex
 = 0)

582 ià(!
	`is£t
(
$this
->
wÜkSh“tCŞËùiÚ
[
$pIndex
])) {

583 
$numSh“ts
 = 
$this
->
	`g‘Sh“tCouÁ
();

584 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(

589  
$this
->
wÜkSh“tCŞËùiÚ
[
$pIndex
];

590 
	}
}

597 
public
 
funùiÚ
 
	$g‘AÎSh“ts
()

599  
$this
->
wÜkSh“tCŞËùiÚ
;

600 
	}
}

608 
public
 
funùiÚ
 
g‘Sh“tByName
(
$pName
 = '')

610 
$wÜksh“tCouÁ
 = 
couÁ
(
$this
->
wÜkSh“tCŞËùiÚ
);

611 
	g$i
 = 0; $˜< 
	g$wÜksh“tCouÁ
; ++$i) {

612 ià(
	g$this
->
	gwÜkSh“tCŞËùiÚ
[
$i
]->
g‘T™Ë
(è==ğ
$pName
) {

613  
$this
->
wÜkSh“tCŞËùiÚ
[
$i
];

617  
	gnuÎ
;

627 
public
 
funùiÚ
 
	$g‘Index
(
PHPExûl_WÜksh“t
 
$pSh“t
)

629 
	`fÜ—ch
 (
$this
->
wÜkSh“tCŞËùiÚ
 
as
 
$key
 => 
$v®ue
) {

630 ià(
$v®ue
->
	`g‘HashCode
(è=ğ
$pSh“t
->getHashCode()) {

631  
$key
;

635 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Sheet does‚otƒxist.");

636 
	}
}

646 
public
 
funùiÚ
 
	$£tIndexByName
(
$sh“tName
, 
$ÃwIndex
)

648 
$ŞdIndex
 = 
$this
->
	`g‘Index
($this->
	`g‘Sh“tByName
(
$sh“tName
));

649 
$pSh“t
 = 
	`¬¿y_¥liû
(

650 
$this
->
wÜkSh“tCŞËùiÚ
,

651 
$ŞdIndex
,

654 
	`¬¿y_¥liû
(

655 
$this
->
wÜkSh“tCŞËùiÚ
,

656 
$ÃwIndex
,

658 
$pSh“t


660  
$ÃwIndex
;

661 
	}
}

668 
public
 
funùiÚ
 
	$g‘Sh“tCouÁ
()

670  
	`couÁ
(
$this
->
wÜkSh“tCŞËùiÚ
);

671 
	}
}

678 
public
 
funùiÚ
 
	$g‘AùiveSh“tIndex
()

680  
$this
->
aùiveSh“tIndex
;

681 
	}
}

690 
public
 
funùiÚ
 
	$£tAùiveSh“tIndex
(
$pIndex
 = 0)

692 
$numSh“ts
 = 
	`couÁ
(
$this
->
wÜkSh“tCŞËùiÚ
);

694 ià(
$pIndex
 > 
$numSh“ts
 - 1) {

695 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(

699 
$this
->
aùiveSh“tIndex
 = 
$pIndex
;

701  
$this
->
	`g‘AùiveSh“t
();

702 
	}
}

711 
public
 
funùiÚ
 
£tAùiveSh“tIndexByName
(
$pV®ue
 = '')

713 ià((
$wÜksh“t
 = 
$this
->
g‘Sh“tByName
(
$pV®ue
)è
š¡ªûof
 
PHPExûl_WÜksh“t
) {

714 
$this
->
£tAùiveSh“tIndex
($this->
g‘Index
(
$wÜksh“t
));

715  
	g$wÜksh“t
;

718 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('WÜkbook dÛ nÙ cÚš sh“t:' . 
$pV®ue
);

726 
public
 
funùiÚ
 
	$g‘Sh“tNames
()

728 
$»tuºV®ue
 = 
	`¬¿y
();

729 
$wÜksh“tCouÁ
 = 
$this
->
	`g‘Sh“tCouÁ
();

730 
$i
 = 0; $˜< 
$wÜksh“tCouÁ
; ++$i) {

731 
$»tuºV®ue
[] = 
$this
->
	`g‘Sh“t
(
$i
)->
	`g‘T™Ë
();

734  
$»tuºV®ue
;

735 
	}
}

745 
public
 
funùiÚ
 
	$addEx‹º®Sh“t
(
PHPExûl_WÜksh“t
 
$pSh“t
, 
$iSh“tIndex
 = 
nuÎ
)

747 ià(
$this
->
	`sh“tNameExi¡s
(
$pSh“t
->
	`g‘T™Ë
())) {

748 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Workbook‡lready contains‡ worksheet‚amed '{$pSheet->getTitle()}'. Renameheƒxternal sheet first.");

752 
$couÁC–lXfs
 = 
	`couÁ
(
$this
->
ûÎXfCŞËùiÚ
);

755 
	`fÜ—ch
 (
$pSh“t
->
	`g‘P¬’t
()->
	`g‘C–lXfCŞËùiÚ
(è
as
 
$ûÎXf
) {

756 
$this
->
	`addC–lXf
(
şÚe
 
$ûÎXf
);

760 
$pSh“t
->
	`»bšdP¬’t
(
$this
);

763 
	`fÜ—ch
 (
$pSh“t
->
	`g‘C–lCŞËùiÚ
(
çl£
è
as
 
$ûÎID
) {

764 
$ûÎ
 = 
$pSh“t
->
	`g‘C–l
(
$ûÎID
);

765 
$ûÎ
->
	`£tXfIndex
($ûÎ->
	`g‘XfIndex
(è+ 
$couÁC–lXfs
);

768  
$this
->
	`addSh“t
(
$pSh“t
, 
$iSh“tIndex
);

769 
	}
}

776 
public
 
funùiÚ
 
	$g‘NamedRªges
()

778  
$this
->
ÇmedRªges
;

779 
	}
}

787 
public
 
funùiÚ
 
	$addNamedRªge
(
PHPExûl_NamedRªge
 
$ÇmedRªge
)

789 ià(
$ÇmedRªge
->
	`g‘Scİe
(è=ğ
nuÎ
) {

791 
$this
->
ÇmedRªges
[
$ÇmedRªge
->
	`g‘Name
()] = $namedRange;

794 
$this
->
ÇmedRªges
[
$ÇmedRªge
->
	`g‘Scİe
()->
	`g‘T™Ë
().'!'.$ÇmedRªge->
	`g‘Name
()] = $namedRange;

796  
Œue
;

797 
	}
}

806 
public
 
funùiÚ
 
	$g‘NamedRªge
(
$ÇmedRªge
, 
PHPExûl_WÜksh“t
 
$pSh“t
 = 
nuÎ
)

808 
$»tuºV®ue
 = 
nuÎ
;

810 ià(
$ÇmedRªge
 !ğ'' && ($ÇmedRªg!=ğ
nuÎ
)) {

812 ià(
	`is£t
(
$this
->
ÇmedRªges
[
$ÇmedRªge
])) {

813 
$»tuºV®ue
 = 
$this
->
ÇmedRªges
[
$ÇmedRªge
];

817 ià((
$pSh“t
 !=ğ
nuÎ
è&& 
	`is£t
(
$this
->
ÇmedRªges
[$pSh“t->
	`g‘T™Ë
(è. '!' . 
$ÇmedRªge
])) {

818 
$»tuºV®ue
 = 
$this
->
ÇmedRªges
[
$pSh“t
->
	`g‘T™Ë
(è. '!' . 
$ÇmedRªge
];

822  
$»tuºV®ue
;

823 
	}
}

832 
public
 
funùiÚ
 
	$»moveNamedRªge
(
$ÇmedRªge
, 
PHPExûl_WÜksh“t
 
$pSh“t
 = 
nuÎ
)

834 ià(
$pSh“t
 ==ğ
nuÎ
) {

835 ià(
	`is£t
(
$this
->
ÇmedRªges
[
$ÇmedRªge
])) {

836 
	`un£t
(
$this
->
ÇmedRªges
[
$ÇmedRªge
]);

839 ià(
	`is£t
(
$this
->
ÇmedRªges
[
$pSh“t
->
	`g‘T™Ë
(è. '!' . 
$ÇmedRªge
])) {

840 
	`un£t
(
$this
->
ÇmedRªges
[
$pSh“t
->
	`g‘T™Ë
(è. '!' . 
$ÇmedRªge
]);

843  
$this
;

844 
	}
}

851 
public
 
funùiÚ
 
	$g‘WÜksh“tI‹¿tÜ
()

853  
Ãw
 
	`PHPExûl_WÜksh“tI‹¿tÜ
(
$this
);

854 
	}
}

861 
public
 
funùiÚ
 
	$cİy
()

863 
$cİ›d
 = 
şÚe
 
$this
;

865 
$wÜksh“tCouÁ
 = 
	`couÁ
(
$this
->
wÜkSh“tCŞËùiÚ
);

866 
$i
 = 0; $˜< 
$wÜksh“tCouÁ
; ++$i) {

867 
$this
->
wÜkSh“tCŞËùiÚ
[
$i
] = $this->wÜkSh“tCŞËùiÚ[$i]->
	`cİy
();

868 
$this
->
wÜkSh“tCŞËùiÚ
[
$i
]->
	`»bšdP¬’t
($this);

871  
$cİ›d
;

872 
	}
}

877 
public
 
funùiÚ
 
	$__şÚe
()

879 
	`fÜ—ch
 (
$this
 
as
 
$key
 => 
$v®
) {

880 ià(
	`is_objeù
(
$v®
è|| (
	`is_¬¿y
($val))) {

881 
$this
->{
$key
} = 
	`un£rŸlize
(
	`£rŸlize
(
$v®
));

884 
	}
}

891 
public
 
funùiÚ
 
	$g‘C–lXfCŞËùiÚ
()

893  
$this
->
ûÎXfCŞËùiÚ
;

894 
	}
}

902 
public
 
funùiÚ
 
	$g‘C–lXfByIndex
(
$pIndex
 = 0)

904  
$this
->
ûÎXfCŞËùiÚ
[
$pIndex
];

905 
	}
}

913 
public
 
funùiÚ
 
g‘C–lXfByHashCode
(
$pV®ue
 = '')

915 
fÜ—ch
 (
$this
->
ûÎXfCŞËùiÚ
 
as
 
$ûÎXf
) {

916 ià(
$ûÎXf
->
g‘HashCode
(è=ğ
$pV®ue
) {

917  
$ûÎXf
;

920  
	gçl£
;

929 
public
 
funùiÚ
 
	$ûÎXfExi¡s
(
$pC–lStyË
 = 
nuÎ
)

931  
	`š_¬¿y
(
$pC–lStyË
, 
$this
->
ûÎXfCŞËùiÚ
, 
Œue
);

932 
	}
}

940 
public
 
funùiÚ
 
	$g‘DeçuÉStyË
()

942 ià(
	`is£t
(
$this
->
ûÎXfCŞËùiÚ
[0])) {

943  
$this
->
ûÎXfCŞËùiÚ
[0];

945 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('No default style found forhis workbook');

946 
	}
}

953 
public
 
funùiÚ
 
	$addC–lXf
(
PHPExûl_StyË
 
$¡yË
)

955 
$this
->
ûÎXfCŞËùiÚ
[] = 
$¡yË
;

956 
$¡yË
->
	`£tIndex
(
	`couÁ
(
$this
->
ûÎXfCŞËùiÚ
) - 1);

957 
	}
}

965 
public
 
funùiÚ
 
	$»moveC–lXfByIndex
(
$pIndex
 = 0)

967 ià(
$pIndex
 > 
	`couÁ
(
$this
->
ûÎXfCŞËùiÚ
) - 1) {

968 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("CellXf index is out of bounds.");

971 
	`¬¿y_¥liû
(
$this
->
ûÎXfCŞËùiÚ
, 
$pIndex
, 1);

974 
	`fÜ—ch
 (
$this
->
wÜkSh“tCŞËùiÚ
 
as
 
$wÜksh“t
) {

975 
	`fÜ—ch
 (
$wÜksh“t
->
	`g‘C–lCŞËùiÚ
(
çl£
è
as
 
$ûÎID
) {

976 
$ûÎ
 = 
$wÜksh“t
->
	`g‘C–l
(
$ûÎID
);

977 
$xfIndex
 = 
$ûÎ
->
	`g‘XfIndex
();

978 ià(
$xfIndex
 > 
$pIndex
) {

980 
$ûÎ
->
	`£tXfIndex
(
$xfIndex
 - 1);

981 } 
	`–£if
 (
$xfIndex
 =ğ
$pIndex
) {

983 
$ûÎ
->
	`£tXfIndex
(0);

988 
	}
}

995 
public
 
funùiÚ
 
	$g‘C–lXfSu³rvisÜ
()

997  
$this
->
ûÎXfSu³rvisÜ
;

998 
	}
}

1005 
public
 
funùiÚ
 
	$g‘C–lStyËXfCŞËùiÚ
()

1007  
$this
->
ûÎStyËXfCŞËùiÚ
;

1008 
	}
}

1016 
public
 
funùiÚ
 
	$g‘C–lStyËXfByIndex
(
$pIndex
 = 0)

1018  
$this
->
ûÎStyËXfCŞËùiÚ
[
$pIndex
];

1019 
	}
}

1027 
public
 
funùiÚ
 
g‘C–lStyËXfByHashCode
(
$pV®ue
 = '')

1029 
fÜ—ch
 (
$this
->
ûÎStyËXfCŞËùiÚ
 
as
 
$ûÎStyËXf
) {

1030 ià(
$ûÎStyËXf
->
g‘HashCode
(è=ğ
$pV®ue
) {

1031  
$ûÎStyËXf
;

1034  
	gçl£
;

1042 
public
 
funùiÚ
 
	$addC–lStyËXf
(
PHPExûl_StyË
 
$pStyË
)

1044 
$this
->
ûÎStyËXfCŞËùiÚ
[] = 
$pStyË
;

1045 
$pStyË
->
	`£tIndex
(
	`couÁ
(
$this
->
ûÎStyËXfCŞËùiÚ
) - 1);

1046 
	}
}

1054 
public
 
funùiÚ
 
	$»moveC–lStyËXfByIndex
(
$pIndex
 = 0)

1056 ià(
$pIndex
 > 
	`couÁ
(
$this
->
ûÎStyËXfCŞËùiÚ
) - 1) {

1057 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("CellStyleXf index is out of bounds.");

1059 
	`¬¿y_¥liû
(
$this
->
ûÎStyËXfCŞËùiÚ
, 
$pIndex
, 1);

1061 
	}
}

1067 
public
 
funùiÚ
 
	$g¬bageCŞËù
()

1070 
$couÁReã»nûsC–lXf
 = 
	`¬¿y
();

1071 
	`fÜ—ch
 (
$this
->
ûÎXfCŞËùiÚ
 
as
 
$šdex
 => 
$ûÎXf
) {

1072 
$couÁReã»nûsC–lXf
[
$šdex
] = 0;

1075 
	`fÜ—ch
 (
$this
->
	`g‘WÜksh“tI‹¿tÜ
(è
as
 
$sh“t
) {

1077 
	`fÜ—ch
 (
$sh“t
->
	`g‘C–lCŞËùiÚ
(
çl£
è
as
 
$ûÎID
) {

1078 
$ûÎ
 = 
$sh“t
->
	`g‘C–l
(
$ûÎID
);

1079 ++
$couÁReã»nûsC–lXf
[
$ûÎ
->
	`g‘XfIndex
()];

1083 
	`fÜ—ch
 (
$sh“t
->
	`g‘RowDim’siÚs
(è
as
 
$rowDim’siÚ
) {

1084 ià(
$rowDim’siÚ
->
	`g‘XfIndex
(è!=ğ
nuÎ
) {

1085 ++
$couÁReã»nûsC–lXf
[
$rowDim’siÚ
->
	`g‘XfIndex
()];

1090 
	`fÜ—ch
 (
$sh“t
->
	`g‘CŞumnDim’siÚs
(è
as
 
$cŞumnDim’siÚ
) {

1091 ++
$couÁReã»nûsC–lXf
[
$cŞumnDim’siÚ
->
	`g‘XfIndex
()];

1097 
$couÁN“dedC–lXfs
 = 0;

1098 
	`fÜ—ch
 (
$this
->
ûÎXfCŞËùiÚ
 
as
 
$šdex
 => 
$ûÎXf
) {

1099 ià(
$couÁReã»nûsC–lXf
[
$šdex
] > 0 || $index == 0) {

1100 ++
$couÁN“dedC–lXfs
;

1102 
	`un£t
(
$this
->
ûÎXfCŞËùiÚ
[
$šdex
]);

1104 
$m­
[
$šdex
] = 
$couÁN“dedC–lXfs
 - 1;

1106 
$this
->
ûÎXfCŞËùiÚ
 = 
	`¬¿y_v®ues
($this->cellXfCollection);

1109 
	`fÜ—ch
 (
$this
->
ûÎXfCŞËùiÚ
 
as
 
$i
 => 
$ûÎXf
) {

1110 
$ûÎXf
->
	`£tIndex
(
$i
);

1114 ià(
	`em±y
(
$this
->
ûÎXfCŞËùiÚ
)) {

1115 
$this
->
ûÎXfCŞËùiÚ
[] = 
Ãw
 
	`PHPExûl_StyË
();

1119 
	`fÜ—ch
 (
$this
->
	`g‘WÜksh“tI‹¿tÜ
(è
as
 
$sh“t
) {

1121 
	`fÜ—ch
 (
$sh“t
->
	`g‘C–lCŞËùiÚ
(
çl£
è
as
 
$ûÎID
) {

1122 
$ûÎ
 = 
$sh“t
->
	`g‘C–l
(
$ûÎID
);

1123 
$ûÎ
->
	`£tXfIndex
(
$m­
[$ûÎ->
	`g‘XfIndex
()]);

1127 
	`fÜ—ch
 (
$sh“t
->
	`g‘RowDim’siÚs
(è
as
 
$rowDim’siÚ
) {

1128 ià(
$rowDim’siÚ
->
	`g‘XfIndex
(è!=ğ
nuÎ
) {

1129 
$rowDim’siÚ
->
	`£tXfIndex
(
$m­
[$rowDim’siÚ->
	`g‘XfIndex
()]);

1134 
	`fÜ—ch
 (
$sh“t
->
	`g‘CŞumnDim’siÚs
(è
as
 
$cŞumnDim’siÚ
) {

1135 
$cŞumnDim’siÚ
->
	`£tXfIndex
(
$m­
[$cŞumnDim’siÚ->
	`g‘XfIndex
()]);

1139 
$sh“t
->
	`g¬bageCŞËù
();

1141 
	}
}

1148 
public
 
funùiÚ
 
	$g‘ID
()

1150  
$this
->
uniqueID
;

1151 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Autoloader.php

1 <?
php


3 
	gPHPExûl_AutŞßd”
::();

8 ià(
ši_g‘
('mbstring.func_overload') & 2) {

9 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Multibyte function overloading in PHP must be disabled for string functions (2).');

11 
	gPHPExûl_Sh¬ed_SŒšg
::
budCh¬aù”S‘s
();

38 şas 
	cPHPExûl_AutŞßd”


44 
public
 
funùiÚ
 ()

46 ià(
	`funùiÚ_exi¡s
('__autoload')) {

48 
	`¥l_autŞßd_»gi¡”
('__autoload');

51 ià(
	`v”siÚ_com·»
(
PHP_VERSION
, '5.3.0') >= 0) {

52  
	`¥l_autŞßd_»gi¡”
(
	`¬¿y
('PHPExûl_AutŞßd”', 'lßd'), 
Œue
,rue);

54  
	`¥l_autŞßd_»gi¡”
(
	`¬¿y
('PHPExcel_Autoloader', 'load'));

63 
public
 
funùiÚ
 
	$lßd
(
$pCÏssName
)

65 ià((
	`şass_exi¡s
(
$pCÏssName
, 
çl£
)è|| (
	`¡½os
($pClassName, 'PHPExcel') !== 0)) {

67  
çl£
;

70 
$pCÏssFeP©h
 = 
PHPEXCEL_ROOT
 .

71 
	`¡r_»¶aû
('_', 
DIRECTORY_SEPARATOR
, 
$pCÏssName
) .

74 ià((
	`fe_exi¡s
(
$pCÏssFeP©h
è==ğ
çl£
è|| (
	`is_»adabË
($pClassFilePath) === false)) {

76  
çl£
;

79 
	`»quœe
(
$pCÏssFeP©h
);

80 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/APC.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_APC
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


36 
´iv©e
 
	m$ÿcheP»fix
 = 
nuÎ
;

44 
´iv©e
 
	m$ÿcheTime
 = 600;

54 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

56 ià(
$this
->
cu¼’tC–lIsDœty
 && !
	`em±y
($this->
cu¼’tObjeùID
)) {

57 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

59 ià(!
	`­c_¡Üe
(

60 
$this
->
ÿcheP»fix
 . $this->
cu¼’tObjeùID
 . '.cache',

61 
	`£rŸlize
(
$this
->
cu¼’tObjeù
),

62 
$this
->
ÿcheTime


64 
$this
->
	`__de¡ruù
();

65 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('FaedØ¡ÜûÎ ' . 
$this
->
cu¼’tObjeùID
 . ' in APC');

67 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

69 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

81 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

83 ià((
$pCoÜd
 !=ğ
$this
->
cu¼’tObjeùID
è&& ($this->cu¼’tObjeùID !=ğ
nuÎ
)) {

84 
$this
->
	`¡ÜeD©a
();

86 
$this
->
ûÎCache
[
$pCoÜd
] = 
Œue
;

88 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

89 
$this
->
cu¼’tObjeù
 = 
$ûÎ
;

90 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

92  
$ûÎ
;

93 
	}
}

103 
public
 
funùiÚ
 
	$isD©aS‘
(
$pCoÜd
)

106 ià(
·»Á
::
	`isD©aS‘
(
$pCoÜd
)) {

107 ià(
$this
->
cu¼’tObjeùID
 =ğ
$pCoÜd
) {

108  
Œue
;

111 
$sucûss
 = 
	`­c_ãtch
(
$this
->
ÿcheP»fix
.
$pCoÜd
.'.cache');

112 ià(
$sucûss
 ==ğ
çl£
) {

114 
·»Á
::
	`d–‘eCacheD©a
(
$pCoÜd
);

115 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('C–È’Œy '.
$pCoÜd
.'‚o†ongerƒxists in APC cache');

117  
Œue
;

119  
çl£
;

120 
	}
}

130 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

132 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

133  
$this
->
cu¼’tObjeù
;

135 
$this
->
	`¡ÜeD©a
();

138 ià(
·»Á
::
	`isD©aS‘
(
$pCoÜd
)) {

139 
$obj
 = 
	`­c_ãtch
(
$this
->
ÿcheP»fix
 . 
$pCoÜd
 . '.cache');

140 ià(
$obj
 ==ğ
çl£
) {

142 
·»Á
::
	`d–‘eCacheD©a
(
$pCoÜd
);

143 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('C–È’Œy '.
$pCoÜd
.'‚o†ongerƒxists in APC cache');

147  
nuÎ
;

151 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

152 
$this
->
cu¼’tObjeù
 = 
	`un£rŸlize
(
$obj
);

154 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

157  
$this
->
cu¼’tObjeù
;

158 
	}
}

165 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

167 ià(
$this
->
cu¼’tObjeùID
 !=ğ
nuÎ
) {

168 
$this
->
	`¡ÜeD©a
();

171  
·»Á
::
	`g‘C–lLi¡
();

172 
	}
}

181 
public
 
funùiÚ
 
	$d–‘eCacheD©a
(
$pCoÜd
)

184 
	`­c_d–‘e
(
$this
->
ÿcheP»fix
.
$pCoÜd
.'.cache');

187 
·»Á
::
	`d–‘eCacheD©a
(
$pCoÜd
);

188 
	}
}

198 
public
 
funùiÚ
 
	$cİyC–lCŞËùiÚ
(
PHPExûl_WÜksh“t
 
$·»Á
)

200 
·»Á
::
	`cİyC–lCŞËùiÚ
(
$·»Á
);

202 
$ba£Unique
 = 
$this
->
	`g‘UniqueID
();

203 
$ÃwCacheP»fix
 = 
	`sub¡r
(
	`md5
(
$ba£Unique
), 0, 8) . '.';

204 
$ÿcheLi¡
 = 
$this
->
	`g‘C–lLi¡
();

205 
	`fÜ—ch
 (
$ÿcheLi¡
 
as
 
$ûÎID
) {

206 ià(
$ûÎID
 !ğ
$this
->
cu¼’tObjeùID
) {

207 
$obj
 = 
	`­c_ãtch
(
$this
->
ÿcheP»fix
 . 
$ûÎID
 . '.cache');

208 ià(
$obj
 ==ğ
çl£
) {

210 
·»Á
::
	`d–‘eCacheD©a
(
$ûÎID
);

211 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('C–È’Œy ' . 
$ûÎID
 . '‚o†ongerƒxists in APC');

213 ià(!
	`­c_¡Üe
(
$ÃwCacheP»fix
 . 
$ûÎID
 . '.ÿche', 
$obj
, 
$this
->
ÿcheTime
)) {

214 
$this
->
	`__de¡ruù
();

215 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('FaedØ¡ÜûÎ ' . 
$ûÎID
 . ' in APC');

219 
$this
->
ÿcheP»fix
 = 
$ÃwCacheP»fix
;

220 
	}
}

227 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

229 ià(
$this
->
cu¼’tObjeù
 !=ğ
nuÎ
) {

230 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

231 
$this
->
cu¼’tObjeù
 = $this->
cu¼’tObjeùID
 = 
nuÎ
;

235 
$this
->
	`__de¡ruù
();

237 
$this
->
ûÎCache
 = 
	`¬¿y
();

240 
$this
->
·»Á
 = 
nuÎ
;

241 
	}
}

249 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$·»Á
, 
$¬gum’ts
)

251 
$ÿcheTime
 = (
	`is£t
(
$¬gum’ts
['cacheTime'])) ? $arguments['cacheTime'] : 600;

253 ià(
$this
->
ÿcheP»fix
 ==ğ
nuÎ
) {

254 
$ba£Unique
 = 
$this
->
	`g‘UniqueID
();

255 
$this
->
ÿcheP»fix
 = 
	`sub¡r
(
	`md5
(
$ba£Unique
), 0, 8) . '.';

256 
$this
->
ÿcheTime
 = 
$ÿcheTime
;

258 
·»Á
::
	`__cÚ¡ruù
(
$·»Á
);

260 
	}
}

265 
public
 
funùiÚ
 
	$__de¡ruù
()

267 
$ÿcheLi¡
 = 
$this
->
	`g‘C–lLi¡
();

268 
	`fÜ—ch
 (
$ÿcheLi¡
 
as
 
$ûÎID
) {

269 
	`­c_d–‘e
(
$this
->
ÿcheP»fix
 . 
$ûÎID
 . '.cache');

271 
	}
}

279 
public
 
funùiÚ
 
	$ÿcheM‘hodIsAvaabË
()

281 ià(!
	`funùiÚ_exi¡s
('apc_store')) {

282  
çl£
;

284 ià(
	`­c_sma_šfo
(è==ğ
çl£
) {

285  
çl£
;

288  
Œue
;

289 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/CacheBase.php

1 <?
php


28 
ab¡¿ù
 cÏs 
	cPHPExûl_CachedObjeùStÜage_CacheBa£


35 
´Ùeùed
 
	m$·»Á
;

42 
´Ùeùed
 
	m$cu¼’tObjeù
 = 
nuÎ
;

49 
´Ùeùed
 
	m$cu¼’tObjeùID
 = 
nuÎ
;

56 
´Ùeùed
 
	m$cu¼’tC–lIsDœty
 = 
Œue
;

64 
´Ùeùed
 
	m$ûÎCache
 = 
¬¿y
();

71 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$·»Á
)

76 
$this
->
·»Á
 = 
$·»Á
;

84 
public
 
funùiÚ
 
	$g‘P¬’t
()

86  
$this
->
·»Á
;

87 
	}
}

95 
public
 
funùiÚ
 
	$isD©aS‘
(
$pCoÜd
)

97 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

98  
Œue
;

101  
	`is£t
(
$this
->
ûÎCache
[
$pCoÜd
]);

102 
	}
}

111 
public
 
funùiÚ
 
	$moveC–l
(
$äomAdd»ss
, 
$toAdd»ss
)

113 ià(
$äomAdd»ss
 ==ğ
$this
->
cu¼’tObjeùID
) {

114 
$this
->
cu¼’tObjeùID
 = 
$toAdd»ss
;

116 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

117 ià(
	`is£t
(
$this
->
ûÎCache
[
$äomAdd»ss
])) {

118 
$this
->
ûÎCache
[
$toAdd»ss
] = &$this->ûÎCache[
$äomAdd»ss
];

119 
	`un£t
(
$this
->
ûÎCache
[
$äomAdd»ss
]);

122  
Œue
;

123 
	}
}

132 
public
 
funùiÚ
 
	$upd©eCacheD©a
(
PHPExûl_C–l
 
$ûÎ
)

134  
$this
->
	`addCacheD©a
(
$ûÎ
->
	`g‘CoÜdš©e
(), $cell);

135 
	}
}

143 
public
 
funùiÚ
 
	$d–‘eCacheD©a
(
$pCoÜd
)

145 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
 && !
	`is_nuÎ
($this->
cu¼’tObjeù
)) {

146 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

147 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

150 ià(
	`is_objeù
(
$this
->
ûÎCache
[
$pCoÜd
])) {

151 
$this
->
ûÎCache
[
$pCoÜd
]->
	`d‘ach
();

152 
	`un£t
(
$this
->
ûÎCache
[
$pCoÜd
]);

154 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

155 
	}
}

162 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

164  
	`¬¿y_keys
(
$this
->
ûÎCache
);

165 
	}
}

172 
public
 
funùiÚ
 
	$g‘SÜ‹dC–lLi¡
()

174 
$sÜtKeys
 = 
	`¬¿y
();

175 
	`fÜ—ch
 (
$this
->
	`g‘C–lLi¡
(è
as
 
$coÜd
) {

176 
	`ssÿnf
(
$coÜd
, '%[A-Z]%d', 
$cŞumn
, 
$row
);

177 
$sÜtKeys
[
	`¥rštf
('%09d%3s', 
$row
, 
$cŞumn
)] = 
$coÜd
;

179 
	`ksÜt
(
$sÜtKeys
);

181  
	`¬¿y_v®ues
(
$sÜtKeys
);

182 
	}
}

189 
public
 
funùiÚ
 
	$g‘Highe¡RowAndCŞumn
()

192 
$cŞ
 = 
	`¬¿y
('A' => '1A');

193 
$row
 = 
	`¬¿y
(1);

194 
	`fÜ—ch
 (
$this
->
	`g‘C–lLi¡
(è
as
 
$coÜd
) {

195 
	`ssÿnf
(
$coÜd
, '%[A-Z]%d', 
$c
, 
$r
);

196 
$row
[
$r
] = $r;

197 
$cŞ
[
$c
] = 
	`¡¾’
($c).$c;

199 ià(!
	`em±y
(
$row
)) {

201 
$highe¡Row
 = 
	`max
(
$row
);

202 
$highe¡CŞumn
 = 
	`sub¡r
(
	`max
(
$cŞ
), 1);

205  
	`¬¿y
(

206 'row' => 
$highe¡Row
,

207 'cŞumn' => 
$highe¡CŞumn


209 
	}
}

216 
public
 
funùiÚ
 
	$g‘Cu¼’tAdd»ss
()

218  
$this
->
cu¼’tObjeùID
;

219 
	}
}

226 
public
 
funùiÚ
 
	$g‘Cu¼’tCŞumn
()

228 
	`ssÿnf
(
$this
->
cu¼’tObjeùID
, '%[A-Z]%d', 
$cŞumn
, 
$row
);

229  
$cŞumn
;

230 
	}
}

237 
public
 
funùiÚ
 
	$g‘Cu¼’tRow
()

239 
	`ssÿnf
(
$this
->
cu¼’tObjeùID
, '%[A-Z]%d', 
$cŞumn
, 
$row
);

240  (
š‹g”
è
$row
;

241 
	}
}

250 
public
 
funùiÚ
 
	$g‘Highe¡CŞumn
(
$row
 = 
nuÎ
)

252 ià(
$row
 =ğ
nuÎ
) {

253 
$cŞRow
 = 
$this
->
	`g‘Highe¡RowAndCŞumn
();

254  
$cŞRow
['column'];

257 
$cŞumnLi¡
 = 
	`¬¿y
(1);

258 
	`fÜ—ch
 (
$this
->
	`g‘C–lLi¡
(è
as
 
$coÜd
) {

259 
	`ssÿnf
(
$coÜd
, '%[A-Z]%d', 
$c
, 
$r
);

260 ià(
$r
 !ğ
$row
) {

263 
$cŞumnLi¡
[] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$c
);

265  
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
	`max
(
$cŞumnLi¡
) - 1);

266 
	}
}

275 
public
 
funùiÚ
 
	$g‘Highe¡Row
(
$cŞumn
 = 
nuÎ
)

277 ià(
$cŞumn
 =ğ
nuÎ
) {

278 
$cŞRow
 = 
$this
->
	`g‘Highe¡RowAndCŞumn
();

279  
$cŞRow
['row'];

282 
$rowLi¡
 = 
	`¬¿y
(0);

283 
	`fÜ—ch
 (
$this
->
	`g‘C–lLi¡
(è
as
 
$coÜd
) {

284 
	`ssÿnf
(
$coÜd
, '%[A-Z]%d', 
$c
, 
$r
);

285 ià(
$c
 !ğ
$cŞumn
) {

288 
$rowLi¡
[] = 
$r
;

291  
	`max
(
$rowLi¡
);

292 
	}
}

299 
´Ùeùed
 
funùiÚ
 
	$g‘UniqueID
()

301 ià(
	`funùiÚ_exi¡s
('posix_getpid')) {

302 
$ba£Unique
 = 
	`posix_g‘pid
();

304 
$ba£Unique
 = 
	`mt_¿nd
();

306  
	`uniqid
(
$ba£Unique
, 
Œue
);

307 
	}
}

315 
public
 
funùiÚ
 
	$cİyC–lCŞËùiÚ
(
PHPExûl_WÜksh“t
 
$·»Á
)

317 
$this
->
cu¼’tC–lIsDœty
;

318 
$this
->
	`¡ÜeD©a
();

320 
$this
->
·»Á
 = 
$·»Á
;

321 ià((
$this
->
cu¼’tObjeù
 !=ğ
nuÎ
è&& (
	`is_objeù
($this->currentObject))) {

322 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

324 
	}
}

332 
public
 
funùiÚ
 
	$»moveRow
(
$row
)

334 
	`fÜ—ch
 (
$this
->
	`g‘C–lLi¡
(è
as
 
$coÜd
) {

335 
	`ssÿnf
(
$coÜd
, '%[A-Z]%d', 
$c
, 
$r
);

336 ià(
$r
 =ğ
$row
) {

337 
$this
->
	`d–‘eCacheD©a
(
$coÜd
);

340 
	}
}

348 
public
 
funùiÚ
 
	$»moveCŞumn
(
$cŞumn
)

350 
	`fÜ—ch
 (
$this
->
	`g‘C–lLi¡
(è
as
 
$coÜd
) {

351 
	`ssÿnf
(
$coÜd
, '%[A-Z]%d', 
$c
, 
$r
);

352 ià(
$c
 =ğ
$cŞumn
) {

353 
$this
->
	`d–‘eCacheD©a
(
$coÜd
);

356 
	}
}

364 
public
 
funùiÚ
 
	$ÿcheM‘hodIsAvaabË
()

366  
Œue
;

367 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/DiscISAM.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_DiscISAM
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


35 
´iv©e
 
	m$feName
 = 
nuÎ
;

42 
´iv©e
 
	m$feHªdË
 = 
nuÎ
;

49 
´iv©e
 
	m$ÿcheDœeùÜy
 = 
nuÎ
;

58 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

60 ià(
$this
->
cu¼’tC–lIsDœty
 && !
	`em±y
($this->
cu¼’tObjeùID
)) {

61 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

63 
	`f£ek
(
$this
->
feHªdË
, 0, 
SEEK_END
);

65 
$this
->
ûÎCache
[$this->
cu¼’tObjeùID
] = 
	`¬¿y
(

66 '±r' => 
	`á–l
(
$this
->
feHªdË
),

67 'sz' => 
	`fwr™e
(
$this
->
feHªdË
, 
	`£rŸlize
($this->
cu¼’tObjeù
))

69 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

71 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

82 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

84 ià((
$pCoÜd
 !=ğ
$this
->
cu¼’tObjeùID
è&& ($this->cu¼’tObjeùID !=ğ
nuÎ
)) {

85 
$this
->
	`¡ÜeD©a
();

88 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

89 
$this
->
cu¼’tObjeù
 = 
$ûÎ
;

90 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

92  
$ûÎ
;

93 
	}
}

102 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

104 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

105  
$this
->
cu¼’tObjeù
;

107 
$this
->
	`¡ÜeD©a
();

110 ià(!
	`is£t
(
$this
->
ûÎCache
[
$pCoÜd
])) {

112  
nuÎ
;

116 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

117 
	`f£ek
(
$this
->
feHªdË
, $this->
ûÎCache
[
$pCoÜd
]['ptr']);

118 
$this
->
cu¼’tObjeù
 = 
	`un£rŸlize
(
	`ä—d
($this->
feHªdË
, $this->
ûÎCache
[
$pCoÜd
]['sz']));

120 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

123  
$this
->
cu¼’tObjeù
;

124 
	}
}

131 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

133 ià(
$this
->
cu¼’tObjeùID
 !=ğ
nuÎ
) {

134 
$this
->
	`¡ÜeD©a
();

137  
·»Á
::
	`g‘C–lLi¡
();

138 
	}
}

145 
public
 
funùiÚ
 
	$cİyC–lCŞËùiÚ
(
PHPExûl_WÜksh“t
 
$·»Á
)

147 
·»Á
::
	`cİyC–lCŞËùiÚ
(
$·»Á
);

149 
$ba£Unique
 = 
$this
->
	`g‘UniqueID
();

150 
$ÃwFeName
 = 
$this
->
ÿcheDœeùÜy
.'/PHPExûl.'.
$ba£Unique
.'.cache';

152 
	`cİy
(
$this
->
feName
, 
$ÃwFeName
);

153 
$this
->
feName
 = 
$ÃwFeName
;

155 
$this
->
feHªdË
 = 
	`fİ’
($this->
feName
, 'a+');

156 
	}
}

162 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

164 ià(!
	`is_nuÎ
(
$this
->
cu¼’tObjeù
)) {

165 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

166 
$this
->
cu¼’tObjeù
 = $this->
cu¼’tObjeùID
 = 
nuÎ
;

168 
$this
->
ûÎCache
 = 
	`¬¿y
();

171 
$this
->
·»Á
 = 
nuÎ
;

174 
$this
->
	`__de¡ruù
();

175 
	}
}

183 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$·»Á
, 
$¬gum’ts
)

185 
$this
->
ÿcheDœeùÜy
 = ((
	`is£t
(
$¬gum’ts
['dœ'])è&& ($¬gum’ts['dœ'] !=ğ
nuÎ
))

186 ? 
$¬gum’ts
['dir']

187 : 
PHPExûl_Sh¬ed_Fe
::
	`sys_g‘_‹mp_dœ
();

189 
·»Á
::
	`__cÚ¡ruù
(
$·»Á
);

190 ià(
	`is_nuÎ
(
$this
->
feHªdË
)) {

191 
$ba£Unique
 = 
$this
->
	`g‘UniqueID
();

192 
$this
->
feName
 = $this->
ÿcheDœeùÜy
.'/PHPExûl.'.
$ba£Unique
.'.cache';

193 
$this
->
feHªdË
 = 
	`fİ’
($this->
feName
, 'a+');

195 
	}
}

200 
public
 
funùiÚ
 
	$__de¡ruù
()

202 ià(!
	`is_nuÎ
(
$this
->
feHªdË
)) {

203 
	`fşo£
(
$this
->
feHªdË
);

204 
	`uÆšk
(
$this
->
feName
);

206 
$this
->
feHªdË
 = 
nuÎ
;

207 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/ICache.php

1 <?
php


28 
š‹rçû
 
	gPHPExûl_CachedObjeùStÜage_ICache


38 
public
 
funùiÚ
 
addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
);

47 
public
 
funùiÚ
 
upd©eCacheD©a
(
PHPExûl_C–l
 
$ûÎ
);

56 
public
 
funùiÚ
 
g‘CacheD©a
(
$pCoÜd
);

64 
public
 
funùiÚ
 
d–‘eCacheD©a
(
$pCoÜd
);

72 
public
 
funùiÚ
 
isD©aS‘
(
$pCoÜd
);

79 
public
 
funùiÚ
 
g‘C–lLi¡
();

86 
public
 
funùiÚ
 
g‘SÜ‹dC–lLi¡
();

94 
public
 
funùiÚ
 
cİyC–lCŞËùiÚ
(
PHPExûl_WÜksh“t
 
$·»Á
);

102 
public
 
funùiÚ
 
ÿcheM‘hodIsAvaabË
();

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/Igbinary.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_Igbš¬y
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


37 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

39 ià(
$this
->
cu¼’tC–lIsDœty
 && !
	`em±y
($this->
cu¼’tObjeùID
)) {

40 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

42 
$this
->
ûÎCache
[$this->
cu¼’tObjeùID
] = 
	`igbš¬y_£rŸlize
($this->
cu¼’tObjeù
);

43 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

45 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

57 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

59 ià((
$pCoÜd
 !=ğ
$this
->
cu¼’tObjeùID
è&& ($this->cu¼’tObjeùID !=ğ
nuÎ
)) {

60 
$this
->
	`¡ÜeD©a
();

63 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

64 
$this
->
cu¼’tObjeù
 = 
$ûÎ
;

65 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

67  
$ûÎ
;

68 
	}
}

78 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

80 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

81  
$this
->
cu¼’tObjeù
;

83 
$this
->
	`¡ÜeD©a
();

86 ià(!
	`is£t
(
$this
->
ûÎCache
[
$pCoÜd
])) {

88  
nuÎ
;

92 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

93 
$this
->
cu¼’tObjeù
 = 
	`igbš¬y_un£rŸlize
($this->
ûÎCache
[
$pCoÜd
]);

95 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

98  
$this
->
cu¼’tObjeù
;

99 
	}
}

107 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

109 ià(
$this
->
cu¼’tObjeùID
 !=ğ
nuÎ
) {

110 
$this
->
	`¡ÜeD©a
();

113  
·»Á
::
	`g‘C–lLi¡
();

114 
	}
}

122 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

124 ià(!
	`is_nuÎ
(
$this
->
cu¼’tObjeù
)) {

125 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

126 
$this
->
cu¼’tObjeù
 = $this->
cu¼’tObjeùID
 = 
nuÎ
;

128 
$this
->
ûÎCache
 = 
	`¬¿y
();

131 
$this
->
·»Á
 = 
nuÎ
;

132 
	}
}

141 
public
 
funùiÚ
 
	$ÿcheM‘hodIsAvaabË
()

143 ià(!
	`funùiÚ_exi¡s
('igbinary_serialize')) {

144  
çl£
;

147  
Œue
;

148 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/Memcache.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_Memÿche
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


35 
´iv©e
 
	m$ÿcheP»fix
 = 
nuÎ
;

42 
´iv©e
 
	m$ÿcheTime
 = 600;

49 
´iv©e
 
	m$memÿche
 = 
nuÎ
;

59 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

61 ià(
$this
->
cu¼’tC–lIsDœty
 && !
	`em±y
($this->
cu¼’tObjeùID
)) {

62 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

64 
$obj
 = 
	`£rŸlize
(
$this
->
cu¼’tObjeù
);

65 ià(!
$this
->
memÿche
->
	`»¶aû
($this->
ÿcheP»fix
 . $this->
cu¼’tObjeùID
 . '.ÿche', 
$obj
, 
nuÎ
, $this->
ÿcheTime
)) {

66 ià(!
$this
->
memÿche
->
	`add
($this->
ÿcheP»fix
 . $this->
cu¼’tObjeùID
 . '.ÿche', 
$obj
, 
nuÎ
, $this->
ÿcheTime
)) {

67 
$this
->
	`__de¡ruù
();

68 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Failedo store cell {$this->currentObjectID} in MemCache");

71 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

73 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

85 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

87 ià((
$pCoÜd
 !=ğ
$this
->
cu¼’tObjeùID
è&& ($this->cu¼’tObjeùID !=ğ
nuÎ
)) {

88 
$this
->
	`¡ÜeD©a
();

90 
$this
->
ûÎCache
[
$pCoÜd
] = 
Œue
;

92 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

93 
$this
->
cu¼’tObjeù
 = 
$ûÎ
;

94 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

96  
$ûÎ
;

97 
	}
}

107 
public
 
funùiÚ
 
	$isD©aS‘
(
$pCoÜd
)

110 ià(
·»Á
::
	`isD©aS‘
(
$pCoÜd
)) {

111 ià(
$this
->
cu¼’tObjeùID
 =ğ
$pCoÜd
) {

112  
Œue
;

115 
$sucûss
 = 
$this
->
memÿche
->
	`g‘
($this->
ÿcheP»fix
.
$pCoÜd
.'.cache');

116 ià(
$sucûss
 ==ğ
çl£
) {

118 
·»Á
::
	`d–‘eCacheD©a
(
$pCoÜd
);

119 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('C–È’Œy '.
$pCoÜd
.'‚o†ongerƒxists in MemCache');

121  
Œue
;

123  
çl£
;

124 
	}
}

134 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

136 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

137  
$this
->
cu¼’tObjeù
;

139 
$this
->
	`¡ÜeD©a
();

142 ià(
·»Á
::
	`isD©aS‘
(
$pCoÜd
)) {

143 
$obj
 = 
$this
->
memÿche
->
	`g‘
($this->
ÿcheP»fix
 . 
$pCoÜd
 . '.cache');

144 ià(
$obj
 ==ğ
çl£
) {

146 
·»Á
::
	`d–‘eCacheD©a
(
$pCoÜd
);

147 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Cellƒntry {$pCoord}‚o†ongerƒxists in MemCache");

151  
nuÎ
;

155 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

156 
$this
->
cu¼’tObjeù
 = 
	`un£rŸlize
(
$obj
);

158 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

161  
$this
->
cu¼’tObjeù
;

162 
	}
}

169 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

171 ià(
$this
->
cu¼’tObjeùID
 !=ğ
nuÎ
) {

172 
$this
->
	`¡ÜeD©a
();

175  
·»Á
::
	`g‘C–lLi¡
();

176 
	}
}

184 
public
 
funùiÚ
 
	$d–‘eCacheD©a
(
$pCoÜd
)

187 
$this
->
memÿche
->
	`d–‘e
($this->
ÿcheP»fix
 . 
$pCoÜd
 . '.cache');

190 
·»Á
::
	`d–‘eCacheD©a
(
$pCoÜd
);

191 
	}
}

199 
public
 
funùiÚ
 
	$cİyC–lCŞËùiÚ
(
PHPExûl_WÜksh“t
 
$·»Á
)

201 
·»Á
::
	`cİyC–lCŞËùiÚ
(
$·»Á
);

203 
$ba£Unique
 = 
$this
->
	`g‘UniqueID
();

204 
$ÃwCacheP»fix
 = 
	`sub¡r
(
	`md5
(
$ba£Unique
), 0, 8) . '.';

205 
$ÿcheLi¡
 = 
$this
->
	`g‘C–lLi¡
();

206 
	`fÜ—ch
 (
$ÿcheLi¡
 
as
 
$ûÎID
) {

207 ià(
$ûÎID
 !ğ
$this
->
cu¼’tObjeùID
) {

208 
$obj
 = 
$this
->
memÿche
->
	`g‘
($this->
ÿcheP»fix
.
$ûÎID
.'.cache');

209 ià(
$obj
 ==ğ
çl£
) {

211 
·»Á
::
	`d–‘eCacheD©a
(
$ûÎID
);

212 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Cellƒntry {$cellID}‚o†ongerƒxists in MemCache");

214 ià(!
$this
->
memÿche
->
	`add
(
$ÃwCacheP»fix
 . 
$ûÎID
 . '.ÿche', 
$obj
, 
nuÎ
, $this->
ÿcheTime
)) {

215 
$this
->
	`__de¡ruù
();

216 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Failedo store cell {$cellID} in MemCache");

220 
$this
->
ÿcheP»fix
 = 
$ÃwCacheP»fix
;

221 
	}
}

228 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

230 ià(!
	`is_nuÎ
(
$this
->
cu¼’tObjeù
)) {

231 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

232 
$this
->
cu¼’tObjeù
 = $this->
cu¼’tObjeùID
 = 
nuÎ
;

236 
$this
->
	`__de¡ruù
();

238 
$this
->
ûÎCache
 = 
	`¬¿y
();

241 
$this
->
·»Á
 = 
nuÎ
;

242 
	}
}

250 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$·»Á
, 
$¬gum’ts
)

252 
$memÿcheS”v”
 = (
	`is£t
(
$¬gum’ts
['memcacheServer'])) ? $arguments['memcacheServer'] : 'localhost';

253 
$memÿchePÜt
 = (
	`is£t
(
$¬gum’ts
['memcachePort'])) ? $arguments['memcachePort'] : 11211;

254 
$ÿcheTime
 = (
	`is£t
(
$¬gum’ts
['cacheTime'])) ? $arguments['cacheTime'] : 600;

256 ià(
	`is_nuÎ
(
$this
->
ÿcheP»fix
)) {

257 
$ba£Unique
 = 
$this
->
	`g‘UniqueID
();

258 
$this
->
ÿcheP»fix
 = 
	`sub¡r
(
	`md5
(
$ba£Unique
), 0, 8) . '.';

261 
$this
->
memÿche
 = 
Ãw
 
	`Memÿche
();

262 ià(!
$this
->
memÿche
->
	`addS”v”
(
$memÿcheS”v”
, 
$memÿchePÜt
, 
çl£
, 50, 5, 5, 
Œue
, 
	`¬¿y
($this, 'failureCallback'))) {

263 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Could‚ot connecto MemCache server‡t {$memcacheServer}:{$memcachePort}");

265 
$this
->
ÿcheTime
 = 
$ÿcheTime
;

267 
·»Á
::
	`__cÚ¡ruù
(
$·»Á
);

269 
	}
}

278 
public
 
funùiÚ
 
	$çu»C®lback
(
$ho¡
, 
$pÜt
)

280 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("memcache {$host}:{$port} failed");

281 
	}
}

286 
public
 
funùiÚ
 
	$__de¡ruù
()

288 
$ÿcheLi¡
 = 
$this
->
	`g‘C–lLi¡
();

289 
	`fÜ—ch
 (
$ÿcheLi¡
 
as
 
$ûÎID
) {

290 
$this
->
memÿche
->
	`d–‘e
($this->
ÿcheP»fix
.
$ûÎID
 . '.cache');

292 
	}
}

300 
public
 
funùiÚ
 
	$ÿcheM‘hodIsAvaabË
()

302 ià(!
	`funùiÚ_exi¡s
('memcache_add')) {

303  
çl£
;

306  
Œue
;

307 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/Memory.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_MemÜy
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


35 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

47 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

49 
$this
->
ûÎCache
[
$pCoÜd
] = 
$ûÎ
;

52 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

54  
$ûÎ
;

55 
	}
}

65 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

68 ià(!
	`is£t
(
$this
->
ûÎCache
[
$pCoÜd
])) {

69 
$this
->
cu¼’tObjeùID
 = 
nuÎ
;

71  
nuÎ
;

75 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

78  
$this
->
ûÎCache
[
$pCoÜd
];

79 
	}
}

87 
public
 
funùiÚ
 
	$cİyC–lCŞËùiÚ
(
PHPExûl_WÜksh“t
 
$·»Á
)

89 
·»Á
::
	`cİyC–lCŞËùiÚ
(
$·»Á
);

91 
$ÃwCŞËùiÚ
 = 
	`¬¿y
();

92 
	`fÜ—ch
 (
$this
->
ûÎCache
 
as
 
$k
 => &
$ûÎ
) {

93 
$ÃwCŞËùiÚ
[
$k
] = 
şÚe
 
$ûÎ
;

94 
$ÃwCŞËùiÚ
[
$k
]->
	`©ch
(
$this
);

97 
$this
->
ûÎCache
 = 
$ÃwCŞËùiÚ
;

98 
	}
}

104 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

107 
	`fÜ—ch
 (
$this
->
ûÎCache
 
as
 
$k
 => &
$ûÎ
) {

108 
$ûÎ
->
	`d‘ach
();

109 
$this
->
ûÎCache
[
$k
] = 
nuÎ
;

111 
	`un£t
(
$ûÎ
);

113 
$this
->
ûÎCache
 = 
	`¬¿y
();

116 
$this
->
·»Á
 = 
nuÎ
;

117 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/MemoryGZip.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_MemÜyGZ
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


37 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

39 ià(
$this
->
cu¼’tC–lIsDœty
 && !
	`em±y
($this->
cu¼’tObjeùID
)) {

40 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

42 
$this
->
ûÎCache
[$this->
cu¼’tObjeùID
] = 
	`gzdeæ©e
(
	`£rŸlize
($this->
cu¼’tObjeù
));

43 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

45 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

57 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

59 ià((
$pCoÜd
 !=ğ
$this
->
cu¼’tObjeùID
è&& ($this->cu¼’tObjeùID !=ğ
nuÎ
)) {

60 
$this
->
	`¡ÜeD©a
();

63 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

64 
$this
->
cu¼’tObjeù
 = 
$ûÎ
;

65 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

67  
$ûÎ
;

68 
	}
}

78 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

80 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

81  
$this
->
cu¼’tObjeù
;

83 
$this
->
	`¡ÜeD©a
();

86 ià(!
	`is£t
(
$this
->
ûÎCache
[
$pCoÜd
])) {

88  
nuÎ
;

92 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

93 
$this
->
cu¼’tObjeù
 = 
	`un£rŸlize
(
	`gzšæ©e
($this->
ûÎCache
[
$pCoÜd
]));

95 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

98  
$this
->
cu¼’tObjeù
;

99 
	}
}

107 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

109 ià(
$this
->
cu¼’tObjeùID
 !=ğ
nuÎ
) {

110 
$this
->
	`¡ÜeD©a
();

113  
·»Á
::
	`g‘C–lLi¡
();

114 
	}
}

122 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

124 ià(!
	`is_nuÎ
(
$this
->
cu¼’tObjeù
)) {

125 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

126 
$this
->
cu¼’tObjeù
 = $this->
cu¼’tObjeùID
 = 
nuÎ
;

128 
$this
->
ûÎCache
 = 
	`¬¿y
();

131 
$this
->
·»Á
 = 
nuÎ
;

132 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/MemorySerialized.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_MemÜyS”Ÿlized
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


37 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

39 ià(
$this
->
cu¼’tC–lIsDœty
 && !
	`em±y
($this->
cu¼’tObjeùID
)) {

40 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

42 
$this
->
ûÎCache
[$this->
cu¼’tObjeùID
] = 
	`£rŸlize
($this->
cu¼’tObjeù
);

43 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

45 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

56 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

58 ià((
$pCoÜd
 !=ğ
$this
->
cu¼’tObjeùID
è&& ($this->cu¼’tObjeùID !=ğ
nuÎ
)) {

59 
$this
->
	`¡ÜeD©a
();

62 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

63 
$this
->
cu¼’tObjeù
 = 
$ûÎ
;

64 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

66  
$ûÎ
;

67 
	}
}

76 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

78 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

79  
$this
->
cu¼’tObjeù
;

81 
$this
->
	`¡ÜeD©a
();

84 ià(!
	`is£t
(
$this
->
ûÎCache
[
$pCoÜd
])) {

86  
nuÎ
;

90 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

91 
$this
->
cu¼’tObjeù
 = 
	`un£rŸlize
($this->
ûÎCache
[
$pCoÜd
]);

93 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

96  
$this
->
cu¼’tObjeù
;

97 
	}
}

104 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

106 ià(
$this
->
cu¼’tObjeùID
 !=ğ
nuÎ
) {

107 
$this
->
	`¡ÜeD©a
();

110  
·»Á
::
	`g‘C–lLi¡
();

111 
	}
}

118 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

120 ià(!
	`is_nuÎ
(
$this
->
cu¼’tObjeù
)) {

121 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

122 
$this
->
cu¼’tObjeù
 = $this->
cu¼’tObjeùID
 = 
nuÎ
;

124 
$this
->
ûÎCache
 = 
	`¬¿y
();

127 
$this
->
·»Á
 = 
nuÎ
;

128 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/PHPTemp.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_PHPTemp
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


35 
´iv©e
 
	m$feHªdË
 = 
nuÎ
;

42 
´iv©e
 
	m$memÜyCacheSize
 = 
nuÎ
;

51 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

53 ià(
$this
->
cu¼’tC–lIsDœty
 && !
	`em±y
($this->
cu¼’tObjeùID
)) {

54 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

56 
	`f£ek
(
$this
->
feHªdË
, 0, 
SEEK_END
);

58 
$this
->
ûÎCache
[$this->
cu¼’tObjeùID
] = 
	`¬¿y
(

59 '±r' => 
	`á–l
(
$this
->
feHªdË
),

60 'sz' => 
	`fwr™e
(
$this
->
feHªdË
, 
	`£rŸlize
($this->
cu¼’tObjeù
))

62 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

64 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

76 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

78 ià((
$pCoÜd
 !=ğ
$this
->
cu¼’tObjeùID
è&& ($this->cu¼’tObjeùID !=ğ
nuÎ
)) {

79 
$this
->
	`¡ÜeD©a
();

82 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

83 
$this
->
cu¼’tObjeù
 = 
$ûÎ
;

84 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

86  
$ûÎ
;

87 
	}
}

97 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

99 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

100  
$this
->
cu¼’tObjeù
;

102 
$this
->
	`¡ÜeD©a
();

105 ià(!
	`is£t
(
$this
->
ûÎCache
[
$pCoÜd
])) {

107  
nuÎ
;

111 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

112 
	`f£ek
(
$this
->
feHªdË
, $this->
ûÎCache
[
$pCoÜd
]['ptr']);

113 
$this
->
cu¼’tObjeù
 = 
	`un£rŸlize
(
	`ä—d
($this->
feHªdË
, $this->
ûÎCache
[
$pCoÜd
]['sz']));

115 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

118  
$this
->
cu¼’tObjeù
;

119 
	}
}

126 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

128 ià(
$this
->
cu¼’tObjeùID
 !=ğ
nuÎ
) {

129 
$this
->
	`¡ÜeD©a
();

132  
·»Á
::
	`g‘C–lLi¡
();

133 
	}
}

141 
public
 
funùiÚ
 
	$cİyC–lCŞËùiÚ
(
PHPExûl_WÜksh“t
 
$·»Á
)

143 
·»Á
::
	`cİyC–lCŞËùiÚ
(
$·»Á
);

145 
$ÃwFeHªdË
 = 
	`fİ’
('php://‹mp/maxmemÜy:' . 
$this
->
memÜyCacheSize
, 'a+');

147 
	`f£ek
(
$this
->
feHªdË
, 0);

148 !
	`ãof
(
$this
->
feHªdË
)) {

149 
	`fwr™e
(
$ÃwFeHªdË
, 
	`ä—d
(
$this
->
feHªdË
, 1024));

151 
$this
->
feHªdË
 = 
$ÃwFeHªdË
;

152 
	}
}

159 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

161 ià(!
	`is_nuÎ
(
$this
->
cu¼’tObjeù
)) {

162 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

163 
$this
->
cu¼’tObjeù
 = $this->
cu¼’tObjeùID
 = 
nuÎ
;

165 
$this
->
ûÎCache
 = 
	`¬¿y
();

168 
$this
->
·»Á
 = 
nuÎ
;

171 
$this
->
	`__de¡ruù
();

172 
	}
}

180 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$·»Á
, 
$¬gum’ts
)

182 
$this
->
memÜyCacheSize
 = (
	`is£t
(
$¬gum’ts
['memoryCacheSize'])) ? $arguments['memoryCacheSize'] : '1MB';

184 
·»Á
::
	`__cÚ¡ruù
(
$·»Á
);

185 ià(
	`is_nuÎ
(
$this
->
feHªdË
)) {

186 
$this
->
feHªdË
 = 
	`fİ’
('php://‹mp/maxmemÜy:' . $this->
memÜyCacheSize
, 'a+');

188 
	}
}

193 
public
 
funùiÚ
 
	$__de¡ruù
()

195 ià(!
	`is_nuÎ
(
$this
->
feHªdË
)) {

196 
	`fşo£
(
$this
->
feHªdË
);

198 
$this
->
feHªdË
 = 
nuÎ
;

199 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/SQLite.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_SQL™e
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


35 
´iv©e
 
	m$TabËName
 = 
nuÎ
;

42 
´iv©e
 
	m$DBHªdË
 = 
nuÎ
;

51 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

53 ià(
$this
->
cu¼’tC–lIsDœty
 && !
	`em±y
($this->
cu¼’tObjeùID
)) {

54 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

56 ià(!
$this
->
DBHªdË
->
	`qu”yExec
("INSERT OR REPLACE INTO kvp_".$this->
TabËName
." VALUES('".$this->
cu¼’tObjeùID
."','".
	`sql™e_esÿ³_¡ršg
(
	`£rŸlize
($this->
cu¼’tObjeù
))."')")) {

57 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
	`sql™e_”rÜ_¡ršg
(
$this
->
DBHªdË
->
	`Ï¡E¼Ü
()));

59 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

61 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

72 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

74 ià((
$pCoÜd
 !=ğ
$this
->
cu¼’tObjeùID
è&& ($this->cu¼’tObjeùID !=ğ
nuÎ
)) {

75 
$this
->
	`¡ÜeD©a
();

78 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

79 
$this
->
cu¼’tObjeù
 = 
$ûÎ
;

80 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

82  
$ûÎ
;

83 
	}
}

92 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

94 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

95  
$this
->
cu¼’tObjeù
;

97 
$this
->
	`¡ÜeD©a
();

99 
$qu”y
 = "SELECT v®uFROM kvp_".
$this
->
TabËName
." WHERE id='".
$pCoÜd
."'";

100 
$ûÎResuÉS‘
 = 
$this
->
DBHªdË
->
	`qu”y
(
$qu”y
, 
SQLITE_ASSOC
);

101 ià(
$ûÎResuÉS‘
 ==ğ
çl£
) {

102 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
	`sql™e_”rÜ_¡ršg
(
$this
->
DBHªdË
->
	`Ï¡E¼Ü
()));

103 } 
	`–£if
 (
$ûÎResuÉS‘
->
	`numRows
() == 0) {

105  
nuÎ
;

109 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

111 
$ûÎResuÉ
 = 
$ûÎResuÉS‘
->
	`ãtchSšgË
();

112 
$this
->
cu¼’tObjeù
 = 
	`un£rŸlize
(
$ûÎResuÉ
);

114 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

117  
$this
->
cu¼’tObjeù
;

118 
	}
}

126 
public
 
funùiÚ
 
	$isD©aS‘
(
$pCoÜd
)

128 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

129  
Œue
;

133 
$qu”y
 = "SELECT id FROM kvp_".
$this
->
TabËName
." WHERE id='".
$pCoÜd
."'";

134 
$ûÎResuÉS‘
 = 
$this
->
DBHªdË
->
	`qu”y
(
$qu”y
, 
SQLITE_ASSOC
);

135 ià(
$ûÎResuÉS‘
 ==ğ
çl£
) {

136 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
	`sql™e_”rÜ_¡ršg
(
$this
->
DBHªdË
->
	`Ï¡E¼Ü
()));

137 } 
	`–£if
 (
$ûÎResuÉS‘
->
	`numRows
() == 0) {

139  
çl£
;

141  
Œue
;

142 
	}
}

150 
public
 
funùiÚ
 
	$d–‘eCacheD©a
(
$pCoÜd
)

152 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

153 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

154 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

158 
$qu”y
 = "DELETE FROM kvp_".
$this
->
TabËName
." WHERE id='".
$pCoÜd
."'";

159 ià(!
$this
->
DBHªdË
->
	`qu”yExec
(
$qu”y
)) {

160 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
	`sql™e_”rÜ_¡ršg
(
$this
->
DBHªdË
->
	`Ï¡E¼Ü
()));

163 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

164 
	}
}

173 
public
 
funùiÚ
 
	$moveC–l
(
$äomAdd»ss
, 
$toAdd»ss
)

175 ià(
$äomAdd»ss
 ==ğ
$this
->
cu¼’tObjeùID
) {

176 
$this
->
cu¼’tObjeùID
 = 
$toAdd»ss
;

179 
$qu”y
 = "DELETE FROM kvp_".
$this
->
TabËName
." WHERE id='".
$toAdd»ss
."'";

180 
$»suÉ
 = 
$this
->
DBHªdË
->
	`exec
(
$qu”y
);

181 ià(
$»suÉ
 ==ğ
çl£
) {

182 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

185 
$qu”y
 = "UPDATE kvp_".
$this
->
TabËName
." SET id='".
$toAdd»ss
."' WHERE id='".
$äomAdd»ss
."'";

186 
$»suÉ
 = 
$this
->
DBHªdË
->
	`exec
(
$qu”y
);

187 ià(
$»suÉ
 ==ğ
çl£
) {

188 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

191  
Œue
;

192 
	}
}

199 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

201 ià(
$this
->
cu¼’tObjeùID
 !=ğ
nuÎ
) {

202 
$this
->
	`¡ÜeD©a
();

205 
$qu”y
 = "SELECT id FROM kvp_".
$this
->
TabËName
;

206 
$ûÎIdsResuÉ
 = 
$this
->
DBHªdË
->
	`unbufã»dQu”y
(
$qu”y
, 
SQLITE_ASSOC
);

207 ià(
$ûÎIdsResuÉ
 ==ğ
çl£
) {

208 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
	`sql™e_”rÜ_¡ršg
(
$this
->
DBHªdË
->
	`Ï¡E¼Ü
()));

211 
$ûÎKeys
 = 
	`¬¿y
();

212 
	`fÜ—ch
 (
$ûÎIdsResuÉ
 
as
 
$row
) {

213 
$ûÎKeys
[] = 
$row
['id'];

216  
$ûÎKeys
;

217 
	}
}

225 
public
 
funùiÚ
 
	$cİyC–lCŞËùiÚ
(
PHPExûl_WÜksh“t
 
$·»Á
)

227 
$this
->
cu¼’tC–lIsDœty
;

228 
$this
->
	`¡ÜeD©a
();

231 
$bËName
 = 
	`¡r_»¶aû
('.', '_', 
$this
->
	`g‘UniqueID
());

232 ià(!
$this
->
DBHªdË
->
	`qu”yExec
('CREATE TABLE kvp_'.
$bËName
.' (id VARCHAR(12) PRIMARY KEY, value BLOB)

233 
AS
 
SELECT
 * 
FROM
 
kvp_
'.$this->TableName)

235 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
	`sql™e_”rÜ_¡ršg
(
$this
->
DBHªdË
->
	`Ï¡E¼Ü
()));

239 
$this
->
TabËName
 = 
$bËName
;

240 
	}
}

247 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

249 ià(!
	`is_nuÎ
(
$this
->
cu¼’tObjeù
)) {

250 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

251 
$this
->
cu¼’tObjeù
 = $this->
cu¼’tObjeùID
 = 
nuÎ
;

254 
$this
->
·»Á
 = 
nuÎ
;

257 
$this
->
	`__de¡ruù
();

258 
	}
}

265 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$·»Á
)

267 
·»Á
::
	`__cÚ¡ruù
(
$·»Á
);

268 ià(
	`is_nuÎ
(
$this
->
DBHªdË
)) {

269 
$this
->
TabËName
 = 
	`¡r_»¶aû
('.', '_', $this->
	`g‘UniqueID
());

270 
$_DBName
 = ':memory:';

272 
$this
->
DBHªdË
 = 
Ãw
 
	`SQL™eD©aba£
(
$_DBName
);

273 ià(
$this
->
DBHªdË
 ==ğ
çl£
) {

274 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
	`sql™e_”rÜ_¡ršg
(
$this
->
DBHªdË
->
	`Ï¡E¼Ü
()));

276 ià(!
$this
->
DBHªdË
->
	`qu”yExec
('CREATE TABLE kvp_'.$this->
TabËName
.' (id VARCHAR(12) PRIMARY KEY, value BLOB)')) {

277 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
	`sql™e_”rÜ_¡ršg
(
$this
->
DBHªdË
->
	`Ï¡E¼Ü
()));

280 
	}
}

285 
public
 
funùiÚ
 
	$__de¡ruù
()

287 ià(!
	`is_nuÎ
(
$this
->
DBHªdË
)) {

288 
$this
->
DBHªdË
->
	`qu”yExec
('DROP TABLE kvp_'.$this->
TabËName
);

290 
$this
->
DBHªdË
 = 
nuÎ
;

291 
	}
}

299 
public
 
funùiÚ
 
	$ÿcheM‘hodIsAvaabË
()

301 ià(!
	`funùiÚ_exi¡s
('sqlite_open')) {

302  
çl£
;

305  
Œue
;

306 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/SQLite3.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_SQL™e3
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


35 
´iv©e
 
	m$TabËName
 = 
nuÎ
;

42 
´iv©e
 
	m$DBHªdË
 = 
nuÎ
;

49 
´iv©e
 
	m$£ËùQu”y
;

56 
´iv©e
 
	m$š£¹Qu”y
;

63 
´iv©e
 
	m$upd©eQu”y
;

70 
´iv©e
 
	m$d–‘eQu”y
;

79 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

81 ià(
$this
->
cu¼’tC–lIsDœty
 && !
	`em±y
($this->
cu¼’tObjeùID
)) {

82 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

84 
$this
->
š£¹Qu”y
->
	`bšdV®ue
('id', $this->
cu¼’tObjeùID
, 
SQLITE3_TEXT
);

85 
$this
->
š£¹Qu”y
->
	`bšdV®ue
('d©a', 
	`£rŸlize
($this->
cu¼’tObjeù
), 
SQLITE3_BLOB
);

86 
$»suÉ
 = 
$this
->
š£¹Qu”y
->
	`execu‹
();

87 ià(
$»suÉ
 ==ğ
çl£
) {

88 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

90 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

92 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

103 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

105 ià((
$pCoÜd
 !=ğ
$this
->
cu¼’tObjeùID
è&& ($this->cu¼’tObjeùID !=ğ
nuÎ
)) {

106 
$this
->
	`¡ÜeD©a
();

109 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

110 
$this
->
cu¼’tObjeù
 = 
$ûÎ
;

111 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

113  
$ûÎ
;

114 
	}
}

123 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

125 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

126  
$this
->
cu¼’tObjeù
;

128 
$this
->
	`¡ÜeD©a
();

130 
$this
->
£ËùQu”y
->
	`bšdV®ue
('id', 
$pCoÜd
, 
SQLITE3_TEXT
);

131 
$ûÎResuÉ
 = 
$this
->
£ËùQu”y
->
	`execu‹
();

132 ià(
$ûÎResuÉ
 ==ğ
çl£
) {

133 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

135 
$ûÎD©a
 = 
$ûÎResuÉ
->
	`ãtchA¼ay
(
SQLITE3_ASSOC
);

136 ià(
$ûÎD©a
 ==ğ
çl£
) {

138  
nuÎ
;

142 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

144 
$this
->
cu¼’tObjeù
 = 
	`un£rŸlize
(
$ûÎD©a
['value']);

146 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

149  
$this
->
cu¼’tObjeù
;

150 
	}
}

158 
public
 
funùiÚ
 
	$isD©aS‘
(
$pCoÜd
)

160 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

161  
Œue
;

165 
$this
->
£ËùQu”y
->
	`bšdV®ue
('id', 
$pCoÜd
, 
SQLITE3_TEXT
);

166 
$ûÎResuÉ
 = 
$this
->
£ËùQu”y
->
	`execu‹
();

167 ià(
$ûÎResuÉ
 ==ğ
çl£
) {

168 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

170 
$ûÎD©a
 = 
$ûÎResuÉ
->
	`ãtchA¼ay
(
SQLITE3_ASSOC
);

172  (
$ûÎD©a
 ==ğ
çl£
è? f®£ : 
Œue
;

173 
	}
}

181 
public
 
funùiÚ
 
	$d–‘eCacheD©a
(
$pCoÜd
)

183 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

184 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

185 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

189 
$this
->
d–‘eQu”y
->
	`bšdV®ue
('id', 
$pCoÜd
, 
SQLITE3_TEXT
);

190 
$»suÉ
 = 
$this
->
d–‘eQu”y
->
	`execu‹
();

191 ià(
$»suÉ
 ==ğ
çl£
) {

192 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

195 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

196 
	}
}

205 
public
 
funùiÚ
 
	$moveC–l
(
$äomAdd»ss
, 
$toAdd»ss
)

207 ià(
$äomAdd»ss
 ==ğ
$this
->
cu¼’tObjeùID
) {

208 
$this
->
cu¼’tObjeùID
 = 
$toAdd»ss
;

211 
$this
->
d–‘eQu”y
->
	`bšdV®ue
('id', 
$toAdd»ss
, 
SQLITE3_TEXT
);

212 
$»suÉ
 = 
$this
->
d–‘eQu”y
->
	`execu‹
();

213 ià(
$»suÉ
 ==ğ
çl£
) {

214 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

217 
$this
->
upd©eQu”y
->
	`bšdV®ue
('toid', 
$toAdd»ss
, 
SQLITE3_TEXT
);

218 
$this
->
upd©eQu”y
->
	`bšdV®ue
('äomid', 
$äomAdd»ss
, 
SQLITE3_TEXT
);

219 
$»suÉ
 = 
$this
->
upd©eQu”y
->
	`execu‹
();

220 ià(
$»suÉ
 ==ğ
çl£
) {

221 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

224  
Œue
;

225 
	}
}

232 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

234 ià(
$this
->
cu¼’tObjeùID
 !=ğ
nuÎ
) {

235 
$this
->
	`¡ÜeD©a
();

238 
$qu”y
 = "SELECT id FROM kvp_".
$this
->
TabËName
;

239 
$ûÎIdsResuÉ
 = 
$this
->
DBHªdË
->
	`qu”y
(
$qu”y
);

240 ià(
$ûÎIdsResuÉ
 ==ğ
çl£
) {

241 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

244 
$ûÎKeys
 = 
	`¬¿y
();

245 
$row
 = 
$ûÎIdsResuÉ
->
	`ãtchA¼ay
(
SQLITE3_ASSOC
)) {

246 
$ûÎKeys
[] = 
$row
['id'];

249  
$ûÎKeys
;

250 
	}
}

258 
public
 
funùiÚ
 
	$cİyC–lCŞËùiÚ
(
PHPExûl_WÜksh“t
 
$·»Á
)

260 
$this
->
cu¼’tC–lIsDœty
;

261 
$this
->
	`¡ÜeD©a
();

264 
$bËName
 = 
	`¡r_»¶aû
('.', '_', 
$this
->
	`g‘UniqueID
());

265 ià(!
$this
->
DBHªdË
->
	`exec
('CREATE TABLE kvp_'.
$bËName
.' (id VARCHAR(12) PRIMARY KEY, value BLOB)

266 
AS
 
SELECT
 * 
FROM
 
kvp_
'.$this->TableName)

268 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

272 
$this
->
TabËName
 = 
$bËName
;

273 
	}
}

280 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

282 ià(!
	`is_nuÎ
(
$this
->
cu¼’tObjeù
)) {

283 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

284 
$this
->
cu¼’tObjeù
 = $this->
cu¼’tObjeùID
 = 
nuÎ
;

287 
$this
->
·»Á
 = 
nuÎ
;

290 
$this
->
	`__de¡ruù
();

291 
	}
}

298 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$·»Á
)

300 
·»Á
::
	`__cÚ¡ruù
(
$·»Á
);

301 ià(
	`is_nuÎ
(
$this
->
DBHªdË
)) {

302 
$this
->
TabËName
 = 
	`¡r_»¶aû
('.', '_', $this->
	`g‘UniqueID
());

303 
$_DBName
 = ':memory:';

305 
$this
->
DBHªdË
 = 
Ãw
 
	`SQL™e3
(
$_DBName
);

306 ià(
$this
->
DBHªdË
 ==ğ
çl£
) {

307 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

309 ià(!
$this
->
DBHªdË
->
	`exec
('CREATE TABLE kvp_'.$this->
TabËName
.' (id VARCHAR(12) PRIMARY KEY, value BLOB)')) {

310 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(
$this
->
DBHªdË
->
	`Ï¡E¼ÜMsg
());

314 
$this
->
£ËùQu”y
 = $this->
DBHªdË
->
	`´•¬e
("SELECT v®uFROM kvp_".$this->
TabËName
." WHERE id = :id");

315 
$this
->
š£¹Qu”y
 = $this->
DBHªdË
->
	`´•¬e
("INSERT OR REPLACE INTO kvp_".$this->
TabËName
." VALUES(:id,:data)");

316 
$this
->
upd©eQu”y
 = $this->
DBHªdË
->
	`´•¬e
("UPDATE kvp_".$this->
TabËName
." SET id=:toId WHERE id=:fromId");

317 
$this
->
d–‘eQu”y
 = $this->
DBHªdË
->
	`´•¬e
("DELETE FROM kvp_".$this->
TabËName
." WHERE id = :id");

318 
	}
}

323 
public
 
funùiÚ
 
	$__de¡ruù
()

325 ià(!
	`is_nuÎ
(
$this
->
DBHªdË
)) {

326 
$this
->
DBHªdË
->
	`exec
('DROP TABLE kvp_'.$this->
TabËName
);

327 
$this
->
DBHªdË
->
	`şo£
();

329 
$this
->
DBHªdË
 = 
nuÎ
;

330 
	}
}

338 
public
 
funùiÚ
 
	$ÿcheM‘hodIsAvaabË
()

340 ià(!
	`şass_exi¡s
('SQL™e3', 
çl£
)) {

341  
çl£
;

344  
Œue
;

345 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/Wincache.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜage_Wšÿche
 
ex‹nds
 
PHPExûl_CachedObjeùStÜage_CacheBa£
 
im¶em’ts
 
	mPHPExûl_CachedObjeùStÜage_ICache


35 
´iv©e
 
	m$ÿcheP»fix
 = 
nuÎ
;

42 
´iv©e
 
	m$ÿcheTime
 = 600;

52 
´Ùeùed
 
funùiÚ
 
	$¡ÜeD©a
()

54 ià(
$this
->
cu¼’tC–lIsDœty
 && !
	`em±y
($this->
cu¼’tObjeùID
)) {

55 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

57 
$obj
 = 
	`£rŸlize
(
$this
->
cu¼’tObjeù
);

58 ià(
	`wšÿche_uÿche_exi¡s
(
$this
->
ÿcheP»fix
.$this->
cu¼’tObjeùID
.'.cache')) {

59 ià(!
	`wšÿche_uÿche_£t
(
$this
->
ÿcheP»fix
.$this->
cu¼’tObjeùID
.'.ÿche', 
$obj
, $this->
ÿcheTime
)) {

60 
$this
->
	`__de¡ruù
();

61 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('FaedØ¡ÜûÎ '.
$this
->
cu¼’tObjeùID
.' in WinCache');

64 ià(!
	`wšÿche_uÿche_add
(
$this
->
ÿcheP»fix
.$this->
cu¼’tObjeùID
.'.ÿche', 
$obj
, $this->
ÿcheTime
)) {

65 
$this
->
	`__de¡ruù
();

66 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('FaedØ¡ÜûÎ '.
$this
->
cu¼’tObjeùID
.' in WinCache');

69 
$this
->
cu¼’tC–lIsDœty
 = 
çl£
;

72 
$this
->
cu¼’tObjeùID
 = $this->
cu¼’tObjeù
 = 
nuÎ
;

83 
public
 
funùiÚ
 
	$addCacheD©a
(
$pCoÜd
, 
PHPExûl_C–l
 
$ûÎ
)

85 ià((
$pCoÜd
 !=ğ
$this
->
cu¼’tObjeùID
è&& ($this->cu¼’tObjeùID !=ğ
nuÎ
)) {

86 
$this
->
	`¡ÜeD©a
();

88 
$this
->
ûÎCache
[
$pCoÜd
] = 
Œue
;

90 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

91 
$this
->
cu¼’tObjeù
 = 
$ûÎ
;

92 
$this
->
cu¼’tC–lIsDœty
 = 
Œue
;

94  
$ûÎ
;

95 
	}
}

103 
public
 
funùiÚ
 
	$isD©aS‘
(
$pCoÜd
)

106 ià(
·»Á
::
	`isD©aS‘
(
$pCoÜd
)) {

107 ià(
$this
->
cu¼’tObjeùID
 =ğ
$pCoÜd
) {

108  
Œue
;

111 
$sucûss
 = 
	`wšÿche_uÿche_exi¡s
(
$this
->
ÿcheP»fix
.
$pCoÜd
.'.cache');

112 ià(
$sucûss
 ==ğ
çl£
) {

114 
·»Á
::
	`d–‘eCacheD©a
(
$pCoÜd
);

115 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('C–È’Œy '.
$pCoÜd
.'‚o†ongerƒxists in WinCache');

117  
Œue
;

119  
çl£
;

120 
	}
}

130 
public
 
funùiÚ
 
	$g‘CacheD©a
(
$pCoÜd
)

132 ià(
$pCoÜd
 ==ğ
$this
->
cu¼’tObjeùID
) {

133  
$this
->
cu¼’tObjeù
;

135 
$this
->
	`¡ÜeD©a
();

138 
$obj
 = 
nuÎ
;

139 ià(
·»Á
::
	`isD©aS‘
(
$pCoÜd
)) {

140 
$sucûss
 = 
çl£
;

141 
$obj
 = 
	`wšÿche_uÿche_g‘
(
$this
->
ÿcheP»fix
.
$pCoÜd
.'.ÿche', 
$sucûss
);

142 ià(
$sucûss
 ==ğ
çl£
) {

144 
·»Á
::
	`d–‘eCacheD©a
(
$pCoÜd
);

145 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('C–È’Œy '.
$pCoÜd
.'‚o†ongerƒxists in WinCache');

149  
nuÎ
;

153 
$this
->
cu¼’tObjeùID
 = 
$pCoÜd
;

154 
$this
->
cu¼’tObjeù
 = 
	`un£rŸlize
(
$obj
);

156 
$this
->
cu¼’tObjeù
->
	`©ch
($this);

159  
$this
->
cu¼’tObjeù
;

160 
	}
}

168 
public
 
funùiÚ
 
	$g‘C–lLi¡
()

170 ià(
$this
->
cu¼’tObjeùID
 !=ğ
nuÎ
) {

171 
$this
->
	`¡ÜeD©a
();

174  
·»Á
::
	`g‘C–lLi¡
();

175 
	}
}

183 
public
 
funùiÚ
 
	$d–‘eCacheD©a
(
$pCoÜd
)

186 
	`wšÿche_uÿche_d–‘e
(
$this
->
ÿcheP»fix
.
$pCoÜd
.'.cache');

189 
·»Á
::
	`d–‘eCacheD©a
(
$pCoÜd
);

190 
	}
}

198 
public
 
funùiÚ
 
	$cİyC–lCŞËùiÚ
(
PHPExûl_WÜksh“t
 
$·»Á
)

200 
·»Á
::
	`cİyC–lCŞËùiÚ
(
$·»Á
);

202 
$ba£Unique
 = 
$this
->
	`g‘UniqueID
();

203 
$ÃwCacheP»fix
 = 
	`sub¡r
(
	`md5
(
$ba£Unique
), 0, 8) . '.';

204 
$ÿcheLi¡
 = 
$this
->
	`g‘C–lLi¡
();

205 
	`fÜ—ch
 (
$ÿcheLi¡
 
as
 
$ûÎID
) {

206 ià(
$ûÎID
 !ğ
$this
->
cu¼’tObjeùID
) {

207 
$sucûss
 = 
çl£
;

208 
$obj
 = 
	`wšÿche_uÿche_g‘
(
$this
->
ÿcheP»fix
.
$ûÎID
.'.ÿche', 
$sucûss
);

209 ià(
$sucûss
 ==ğ
çl£
) {

211 
·»Á
::
	`d–‘eCacheD©a
(
$ûÎID
);

212 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('C–È’Œy '.
$ûÎID
.'‚o†ongerƒxists in Wincache');

214 ià(!
	`wšÿche_uÿche_add
(
$ÃwCacheP»fix
.
$ûÎID
.'.ÿche', 
$obj
, 
$this
->
ÿcheTime
)) {

215 
$this
->
	`__de¡ruù
();

216 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('FaedØ¡ÜûÎ '.
$ûÎID
.' in Wincache');

220 
$this
->
ÿcheP»fix
 = 
$ÃwCacheP»fix
;

221 
	}
}

229 
public
 
funùiÚ
 
	$un£tWÜksh“tC–ls
()

231 ià(!
	`is_nuÎ
(
$this
->
cu¼’tObjeù
)) {

232 
$this
->
cu¼’tObjeù
->
	`d‘ach
();

233 
$this
->
cu¼’tObjeù
 = $this->
cu¼’tObjeùID
 = 
nuÎ
;

237 
$this
->
	`__de¡ruù
();

239 
$this
->
ûÎCache
 = 
	`¬¿y
();

242 
$this
->
·»Á
 = 
nuÎ
;

243 
	}
}

251 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$·»Á
, 
$¬gum’ts
)

253 
$ÿcheTime
 = (
	`is£t
(
$¬gum’ts
['cacheTime'])) ? $arguments['cacheTime'] : 600;

255 ià(
	`is_nuÎ
(
$this
->
ÿcheP»fix
)) {

256 
$ba£Unique
 = 
$this
->
	`g‘UniqueID
();

257 
$this
->
ÿcheP»fix
 = 
	`sub¡r
(
	`md5
(
$ba£Unique
), 0, 8).'.';

258 
$this
->
ÿcheTime
 = 
$ÿcheTime
;

260 
·»Á
::
	`__cÚ¡ruù
(
$·»Á
);

262 
	}
}

267 
public
 
funùiÚ
 
	$__de¡ruù
()

269 
$ÿcheLi¡
 = 
$this
->
	`g‘C–lLi¡
();

270 
	`fÜ—ch
 (
$ÿcheLi¡
 
as
 
$ûÎID
) {

271 
	`wšÿche_uÿche_d–‘e
(
$this
->
ÿcheP»fix
.
$ûÎID
.'.cache');

273 
	}
}

281 
public
 
funùiÚ
 
	$ÿcheM‘hodIsAvaabË
()

283 ià(!
	`funùiÚ_exi¡s
('wincache_ucache_add')) {

284  
çl£
;

287  
Œue
;

288 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorageFactory.php

1 <?
php


28 şas 
	cPHPExûl_CachedObjeùStÜageFaùÜy


30 cÚ¡ 
	mÿche_š_memÜy
 = 'Memory';

31 cÚ¡ 
	mÿche_š_memÜy_gz
 = 'MemoryGZip';

32 cÚ¡ 
	mÿche_š_memÜy_£rŸlized
 = 'MemorySerialized';

33 cÚ¡ 
	mÿche_igbš¬y
 = 'Igbinary';

34 cÚ¡ 
	mÿche_to_discISAM
 = 'DiscISAM';

35 cÚ¡ 
	mÿche_to_­c
 = 'APC';

36 cÚ¡ 
	mÿche_to_memÿche
 = 'Memcache';

37 cÚ¡ 
	mÿche_to_phpTemp
 = 'PHPTemp';

38 cÚ¡ 
	mÿche_to_wšÿche
 = 'Wincache';

39 cÚ¡ 
	mÿche_to_sql™e
 = 'SQLite';

40 cÚ¡ 
	mÿche_to_sql™e3
 = 'SQLite3';

47 
´iv©e
 
	m$ÿcheStÜageM‘hod
 = 
nuÎ
;

54 
´iv©e
 
	m$ÿcheStÜageCÏss
 = 
nuÎ
;

61 
´iv©e
 
	m$¡ÜageM‘hods
 = 
¬¿y
(

62 
£lf
::
ÿche_š_memÜy
,

63 
£lf
::
ÿche_š_memÜy_gz
,

64 
£lf
::
ÿche_š_memÜy_£rŸlized
,

65 
£lf
::
ÿche_igbš¬y
,

66 
£lf
::
ÿche_to_phpTemp
,

67 
£lf
::
ÿche_to_discISAM
,

68 
£lf
::
ÿche_to_­c
,

69 
£lf
::
ÿche_to_memÿche
,

70 
£lf
::
ÿche_to_wšÿche
,

71 
£lf
::
ÿche_to_sql™e
,

72 
£lf
::
ÿche_to_sql™e3
,

80 
´iv©e
 
	m$¡ÜageM‘hodDeçuÉP¬am‘”s
 = 
¬¿y
(

81 
£lf
::
ÿche_š_memÜy
 => 
¬¿y
(

83 
£lf
::
ÿche_š_memÜy_gz
 => 
¬¿y
(

85 
£lf
::
ÿche_š_memÜy_£rŸlized
 => 
¬¿y
(

87 
£lf
::
ÿche_igbš¬y
 => 
¬¿y
(

89 
£lf
::
ÿche_to_phpTemp
 => 
¬¿y
( 'memoryCacheSize' => '1MB'

91 
£lf
::
ÿche_to_discISAM
 => 
¬¿y
Ğ'dœ' => 
nuÎ


93 
£lf
::
ÿche_to_­c
 => 
¬¿y
( 'cacheTime' => 600

95 
£lf
::
ÿche_to_memÿche
 => 
¬¿y
( 'memcacheServer' => 'localhost',

99 
£lf
::
ÿche_to_wšÿche
 => 
¬¿y
( 'cacheTime' => 600

101 
£lf
::
ÿche_to_sql™e
 => 
¬¿y
(

103 
£lf
::
ÿche_to_sql™e3
 => 
¬¿y
(

112 
´iv©e
 
	m$¡ÜageM‘hodP¬am‘”s
 = 
¬¿y
();

119 
public
 
funùiÚ
 
	$g‘CacheStÜageM‘hod
()

121  
£lf
::
$ÿcheStÜageM‘hod
;

129 
public
 
funùiÚ
 
	$g‘CacheStÜageCÏss
()

131  
£lf
::
$ÿcheStÜageCÏss
;

132 
	}
}

139 
public
 
funùiÚ
 
	$g‘AÎCacheStÜageM‘hods
()

141  
£lf
::
$¡ÜageM‘hods
;

142 
	}
}

149 
public
 
funùiÚ
 
	$g‘CacheStÜageM‘hods
()

151 
$aùiveM‘hods
 = 
	`¬¿y
();

152 
	`fÜ—ch
 (
£lf
::
$¡ÜageM‘hods
 
as
 
$¡ÜageM‘hod
) {

153 
$ÿcheStÜageCÏss
 = 'PHPExûl_CachedObjeùStÜage_' . 
$¡ÜageM‘hod
;

154 ià(
	`ÿÎ_u£r_func
(
	`¬¿y
(
$ÿcheStÜageCÏss
, 'cacheMethodIsAvailable'))) {

155 
$aùiveM‘hods
[] = 
$¡ÜageM‘hod
;

158  
$aùiveM‘hods
;

159 
	}
}

169 
public
 
funùiÚ
 
š™Ÿlize
(
$m‘hod
 = 
£lf
::
ÿche_š_memÜy
, 
$¬gum’ts
 = 
	$¬¿y
())

171 ià(!
	`š_¬¿y
(
$m‘hod
, 
£lf
::
$¡ÜageM‘hods
)) {

172  
çl£
;

175 
$ÿcheStÜageCÏss
 = 'PHPExûl_CachedObjeùStÜage_'.
$m‘hod
;

176 ià(!
	`ÿÎ_u£r_func
(
	`¬¿y
Ğ
$ÿcheStÜageCÏss
,

178  
çl£
;

181 
£lf
::
$¡ÜageM‘hodP¬am‘”s
[
$m‘hod
] = s–f::
$¡ÜageM‘hodDeçuÉP¬am‘”s
[$method];

182 
	`fÜ—ch
 (
$¬gum’ts
 
as
 
$k
 => 
$v
) {

183 ià(
	`¬¿y_key_exi¡s
(
$k
, 
£lf
::
$¡ÜageM‘hodP¬am‘”s
[
$m‘hod
])) {

184 
£lf
::
$¡ÜageM‘hodP¬am‘”s
[
$m‘hod
][
$k
] = 
$v
;

188 ià(
£lf
::
$ÿcheStÜageM‘hod
 ==ğ
nuÎ
) {

189 
£lf
::
$ÿcheStÜageCÏss
 = 'PHPExûl_CachedObjeùStÜage_' . 
$m‘hod
;

190 
£lf
::
$ÿcheStÜageM‘hod
 = 
$m‘hod
;

192  
Œue
;

193 
	}
}

201 
public
 
funùiÚ
 
	$g‘In¡ªû
(
PHPExûl_WÜksh“t
 
$·»Á
)

203 
$ÿcheM‘hodIsAvaabË
 = 
Œue
;

204 ià(
£lf
::
$ÿcheStÜageM‘hod
 ==ğ
nuÎ
) {

205 
$ÿcheM‘hodIsAvaabË
 = 
£lf
::
	`š™Ÿlize
();

208 ià(
$ÿcheM‘hodIsAvaabË
) {

209 
$š¡ªû
 = 
Ãw
 
£lf
::
	`$ÿcheStÜageCÏss
(

210 
$·»Á
,

211 
£lf
::
$¡ÜageM‘hodP¬am‘”s
[£lf::
$ÿcheStÜageM‘hod
]

213 ià(
$š¡ªû
 !=ğ
nuÎ
) {

214  
$š¡ªû
;

218  
çl£
;

219 
	}
}

225 
public
 
funùiÚ
 
	$fš®ize
()

227 
£lf
::
$ÿcheStÜageM‘hod
 = 
nuÎ
;

228 
£lf
::
$ÿcheStÜageCÏss
 = 
nuÎ
;

229 
£lf
::
$¡ÜageM‘hodP¬am‘”s
 = 
	`¬¿y
();

230 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CalcEngine/CyclicReferenceStack.php

1 <?
php


28 şas 
	cPHPExûl_C®cEngše_CyşicReã»nûSck


35 
´iv©e
 
	m$¡ack
 = 
¬¿y
();

42 
public
 
funùiÚ
 
	$couÁ
()

44  
	`couÁ
(
$this
->
¡ack
);

52 
public
 
funùiÚ
 
	$push
(
$v®ue
)

54 
$this
->
¡ack
[
$v®ue
] = $value;

55 
	}
}

62 
public
 
funùiÚ
 
	$pİ
()

64  
	`¬¿y_pİ
(
$this
->
¡ack
);

65 
	}
}

72 
public
 
funùiÚ
 
	$ÚSck
(
$v®ue
)

74  
	`is£t
(
$this
->
¡ack
[
$v®ue
]);

75 
	}
}

80 
public
 
funùiÚ
 
	$ş—r
()

82 
$this
->
¡ack
 = 
	`¬¿y
();

83 
	}
}

90 
public
 
funùiÚ
 
	$showSck
()

92  
$this
->
¡ack
;

93 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CalcEngine/Logger.php

1 <?
php


28 şas 
	cPHPExûl_C®cEngše_Logg”


37 
´iv©e
 
	m$wr™eDebugLog
 = 
çl£
;

47 
´iv©e
 
	m$echoDebugLog
 = 
çl£
;

54 
´iv©e
 
	m$debugLog
 = 
¬¿y
();

61 
´iv©e
 
	m$ûÎSck
;

68 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_C®cEngše_CyşicReã»nûSck
 
$¡ack
)

70 
$this
->
ûÎSck
 = 
$¡ack
;

78 
public
 
funùiÚ
 
	$£tWr™eDebugLog
(
$pV®ue
 = 
çl£
)

80 
$this
->
wr™eDebugLog
 = 
$pV®ue
;

81 
	}
}

88 
public
 
funùiÚ
 
	$g‘Wr™eDebugLog
()

90  
$this
->
wr™eDebugLog
;

91 
	}
}

98 
public
 
funùiÚ
 
	$£tEchoDebugLog
(
$pV®ue
 = 
çl£
)

100 
$this
->
echoDebugLog
 = 
$pV®ue
;

101 
	}
}

108 
public
 
funùiÚ
 
	$g‘EchoDebugLog
()

110  
$this
->
echoDebugLog
;

111 
	}
}

116 
public
 
funùiÚ
 
	$wr™eDebugLog
()

119 ià(
$this
->
wr™eDebugLog
) {

120 
$mes§ge
 = 
	`im¶ode
(
	`func_g‘_¬gs
());

121 
$ûÎReã»nû
 = 
	`im¶ode
(' -> ', 
$this
->
ûÎSck
->
	`showSck
());

122 ià(
$this
->
echoDebugLog
) {

123 
echo
 
$ûÎReã»nû
,

124 (
$this
->
ûÎSck
->
	`couÁ
() > 0 ? ' => ' : ''),

125 
$mes§ge
,

126 
PHP_EOL
;

128 
$this
->
debugLog
[] = 
$ûÎReã»nû
 .

129 (
$this
->
ûÎSck
->
	`couÁ
() > 0 ? ' => ' : '') .

130 
$mes§ge
;

132 
	}
}

137 
public
 
funùiÚ
 
	$ş—rLog
()

139 
$this
->
debugLog
 = 
	`¬¿y
();

140 
	}
}

147 
public
 
funùiÚ
 
	$g‘Log
()

149  
$this
->
debugLog
;

150 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

12 ià(!
defšed
('CALCULATION_REGEXP_CELLREF')) {

14 ià(
defšed
('PREG_BAD_UTF8_ERROR')) {

16 
defše
('CALCULATION_REGEXP_CELLREF', '((([^\s,!&%^\/\*\+<>=-]*)|(\'[^\']*\')|(\"[^\"]*\"))!)?\$?([a-z]{1,3})\$?(\d{1,7})');

18 
defše
('CALCULATION_REGEXP_NAMEDRANGE', '((([^\s,!&%^\/\*\+<>=-]*)|(\'[^\']*\')|(\"[^\"]*\"))!)?([_A-Z][_A-Z0-9\.]*)');

21 
defše
('CALCULATION_REGEXP_CELLREF', '(((\w*)|(\'[^\']*\')|(\"[^\"]*\"))!)?\$?([a-z]{1,3})\$?(\d+)');

23 
defše
('CALCULATION_REGEXP_NAMEDRANGE', '(((\w*)|(\'.*\')|(\".*\"))!)?([_A-Z][_A-Z0-9\.]*)');

52 şas 
	cPHPExûl_C®cuÏtiÚ


57 cÚ¡ 
	mCALCULATION_REGEXP_NUMBER
 = '[-+]?\d*\.?\d+(e[-+]?\d+)?';

59 cÚ¡ 
	mCALCULATION_REGEXP_STRING
 = '"(?:[^"]|"")*"';

61 cÚ¡ 
	mCALCULATION_REGEXP_OPENBRACE
 = '\(';

63 cÚ¡ 
	mCALCULATION_REGEXP_FUNCTION
 = '@?([A-Z][A-Z0-9\.]*)[\s]*\(';

65 cÚ¡ 
	mCALCULATION_REGEXP_CELLREF
 = 
CALCULATION_REGEXP_CELLREF
;

67 cÚ¡ 
	mCALCULATION_REGEXP_NAMEDRANGE
 = 
CALCULATION_REGEXP_NAMEDRANGE
;

69 cÚ¡ 
	mCALCULATION_REGEXP_ERROR
 = '\#[A-Z][A-Z0_\/]*[!\?]?';

73 cÚ¡ 
	mRETURN_ARRAY_AS_ERROR
 = 'error';

74 cÚ¡ 
	mRETURN_ARRAY_AS_VALUE
 = 'value';

75 cÚ¡ 
	mRETURN_ARRAY_AS_ARRAY
 = 'array';

77 
´iv©e
 
	m$»tuºA¼ayAsTy³
 = 
£lf
::
RETURN_ARRAY_AS_VALUE
;

86 
´iv©e
 
	m$š¡ªû
;

95 
´iv©e
 
	m$wÜkbook
;

103 
´iv©e
 
	m$wÜkbookS‘s
;

111 
´iv©e
 
	m$ÿlcuÏtiÚCache
 = 
¬¿y
 ();

120 
´iv©e
 
	m$ÿlcuÏtiÚCacheEÇbËd
 = 
Œue
;

130 
´iv©e
 
	m$İ”©Üs
 = 
¬¿y
(

131 '+' => 
Œue
, '-' =>rue, '*' =>rue, '/' =>rue,

132 '^' => 
Œue
, '&' =>rue, '%' => 
çl£
, '~' => false,

133 '>' => 
Œue
, '<' =>rue, '=' =>rue, '>=' =>rue,

134 '<=' => 
Œue
, '<>' =>rue, '|' =>rue, ':' =>rue

143 
´iv©e
 
	m$bš¬yO³¿tÜs
 = 
¬¿y
(

144 '+' => 
Œue
, '-' =>rue, '*' =>rue, '/' =>rue,

145 '^' => 
Œue
, '&' =>rue, '>' =>rue, '<' =>rue,

146 '=' => 
Œue
, '>=' =>rue, '<=' =>rue, '<>' =>rue,

147 '|' => 
Œue
, ':' =>rue

157 
´iv©e
 
	m$debugLog
;

168 
public
 
	m$suµ»ssFÜmuÏE¼Üs
 = 
çl£
;

177 
public
 
	m$fÜmuÏE¼Ü
 = 
nuÎ
;

186 
´iv©e
 
	m$cyşicReã»nûSck
;

188 
´iv©e
 
	m$ûÎSck
 = 
¬¿y
();

198 
´iv©e
 
	m$cyşicFÜmuÏCouÁ”
 = 1;

200 
´iv©e
 
	m$cyşicFÜmuÏC–l
 = '';

208 
public
 
	m$cyşicFÜmuÏCouÁ
 = 1;

216 
´iv©e
 
	m$§vedP»cisiÚ
 = 14;

225 
´iv©e
 
	m$loÿËLªguage
 = 'en_us';

234 
´iv©e
 
	m$v®idLoÿËLªguages
 = 
¬¿y
(

244 
´iv©e
 
	m$loÿËArgum’tS•¬©Ü
 = ',';

245 
´iv©e
 
	m$loÿËFunùiÚs
 = 
¬¿y
();

253 
public
 
	m$loÿËBoŞ—n
 = 
¬¿y
(

266 
´iv©e
 
	m$exûlCÚ¡ªts
 = 
¬¿y
(

267 'TRUE' => 
Œue
,

268 'FALSE' => 
çl£
,

269 'NULL' => 
nuÎ


273 
´iv©e
 
	m$PHPExûlFunùiÚs
 = 
¬¿y
(

274 'ABS' => 
¬¿y
(

275 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

279 'ACCRINT' => 
¬¿y
(

280 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

284 'ACCRINTM' => 
¬¿y
(

285 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

289 'ACOS' => 
¬¿y
(

290 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

294 'ACOSH' => 
¬¿y
(

295 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

299 'ADDRESS' => 
¬¿y
(

300 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

304 'AMORDEGRC' => 
¬¿y
(

305 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

309 'AMORLINC' => 
¬¿y
(

310 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

314 'AND' => 
¬¿y
(

315 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOGICAL
,

319 'AREAS' => 
¬¿y
(

320 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

324 'ASC' => 
¬¿y
(

325 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

329 'ASIN' => 
¬¿y
(

330 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

334 'ASINH' => 
¬¿y
(

335 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

339 'ATAN' => 
¬¿y
(

340 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

344 'ATAN2' => 
¬¿y
(

345 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

349 'ATANH' => 
¬¿y
(

350 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

354 'AVEDEV' => 
¬¿y
(

355 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

359 'AVERAGE' => 
¬¿y
(

360 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

364 'AVERAGEA' => 
¬¿y
(

365 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

369 'AVERAGEIF' => 
¬¿y
(

370 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

374 'AVERAGEIFS' => 
¬¿y
(

375 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

379 'BAHTTEXT' => 
¬¿y
(

380 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

384 'BESSELI' => 
¬¿y
(

385 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

389 'BESSELJ' => 
¬¿y
(

390 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

394 'BESSELK' => 
¬¿y
(

395 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

399 'BESSELY' => 
¬¿y
(

400 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

404 'BETADIST' => 
¬¿y
(

405 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

409 'BETAINV' => 
¬¿y
(

410 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

414 'BIN2DEC' => 
¬¿y
(

415 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

419 'BIN2HEX' => 
¬¿y
(

420 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

424 'BIN2OCT' => 
¬¿y
(

425 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

429 'BINOMDIST' => 
¬¿y
(

430 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

434 'CEILING' => 
¬¿y
(

435 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

439 'CELL' => 
¬¿y
(

440 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

444 'CHAR' => 
¬¿y
(

445 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

449 'CHIDIST' => 
¬¿y
(

450 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

454 'CHIINV' => 
¬¿y
(

455 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

459 'CHITEST' => 
¬¿y
(

460 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

464 'CHOOSE' => 
¬¿y
(

465 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

469 'CLEAN' => 
¬¿y
(

470 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

474 'CODE' => 
¬¿y
(

475 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

479 'COLUMN' => 
¬¿y
(

480 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

483 '·ssByReã»nû' => 
¬¿y
(
Œue
)

485 'COLUMNS' => 
¬¿y
(

486 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

490 'COMBIN' => 
¬¿y
(

491 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

495 'COMPLEX' => 
¬¿y
(

496 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

500 'CONCATENATE' => 
¬¿y
(

501 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

505 'CONFIDENCE' => 
¬¿y
(

506 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

510 'CONVERT' => 
¬¿y
(

511 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

515 'CORREL' => 
¬¿y
(

516 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

520 'COS' => 
¬¿y
(

521 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

525 'COSH' => 
¬¿y
(

526 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

530 'COUNT' => 
¬¿y
(

531 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

535 'COUNTA' => 
¬¿y
(

536 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

540 'COUNTBLANK' => 
¬¿y
(

541 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

545 'COUNTIF' => 
¬¿y
(

546 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

550 'COUNTIFS' => 
¬¿y
(

551 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

555 'COUPDAYBS' => 
¬¿y
(

556 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

560 'COUPDAYS' => 
¬¿y
(

561 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

565 'COUPDAYSNC' => 
¬¿y
(

566 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

570 'COUPNCD' => 
¬¿y
(

571 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

575 'COUPNUM' => 
¬¿y
(

576 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

580 'COUPPCD' => 
¬¿y
(

581 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

585 'COVAR' => 
¬¿y
(

586 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

590 'CRITBINOM' => 
¬¿y
(

591 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

595 'CUBEKPIMEMBER' => 
¬¿y
(

596 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_CUBE
,

600 'CUBEMEMBER' => 
¬¿y
(

601 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_CUBE
,

605 'CUBEMEMBERPROPERTY' => 
¬¿y
(

606 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_CUBE
,

610 'CUBERANKEDMEMBER' => 
¬¿y
(

611 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_CUBE
,

615 'CUBESET' => 
¬¿y
(

616 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_CUBE
,

620 'CUBESETCOUNT' => 
¬¿y
(

621 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_CUBE
,

625 'CUBEVALUE' => 
¬¿y
(

626 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_CUBE
,

630 'CUMIPMT' => 
¬¿y
(

631 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

635 'CUMPRINC' => 
¬¿y
(

636 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

640 'DATE' => 
¬¿y
(

641 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

645 'DATEDIF' => 
¬¿y
(

646 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

650 'DATEVALUE' => 
¬¿y
(

651 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

655 'DAVERAGE' => 
¬¿y
(

656 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

660 'DAY' => 
¬¿y
(

661 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

665 'DAYS360' => 
¬¿y
(

666 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

670 'DB' => 
¬¿y
(

671 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

675 'DCOUNT' => 
¬¿y
(

676 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

680 'DCOUNTA' => 
¬¿y
(

681 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

685 'DDB' => 
¬¿y
(

686 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

690 'DEC2BIN' => 
¬¿y
(

691 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

695 'DEC2HEX' => 
¬¿y
(

696 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

700 'DEC2OCT' => 
¬¿y
(

701 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

705 'DEGREES' => 
¬¿y
(

706 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

710 'DELTA' => 
¬¿y
(

711 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

715 'DEVSQ' => 
¬¿y
(

716 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

720 'DGET' => 
¬¿y
(

721 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

725 'DISC' => 
¬¿y
(

726 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

730 'DMAX' => 
¬¿y
(

731 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

735 'DMIN' => 
¬¿y
(

736 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

740 'DOLLAR' => 
¬¿y
(

741 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

745 'DOLLARDE' => 
¬¿y
(

746 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

750 'DOLLARFR' => 
¬¿y
(

751 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

755 'DPRODUCT' => 
¬¿y
(

756 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

760 'DSTDEV' => 
¬¿y
(

761 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

765 'DSTDEVP' => 
¬¿y
(

766 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

770 'DSUM' => 
¬¿y
(

771 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

775 'DURATION' => 
¬¿y
(

776 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

780 'DVAR' => 
¬¿y
(

781 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

785 'DVARP' => 
¬¿y
(

786 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATABASE
,

790 'EDATE' => 
¬¿y
(

791 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

795 'EFFECT' => 
¬¿y
(

796 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

800 'EOMONTH' => 
¬¿y
(

801 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

805 'ERF' => 
¬¿y
(

806 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

810 'ERFC' => 
¬¿y
(

811 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

815 'ERROR.TYPE' => 
¬¿y
(

816 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

820 'EVEN' => 
¬¿y
(

821 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

825 'EXACT' => 
¬¿y
(

826 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

830 'EXP' => 
¬¿y
(

831 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

835 'EXPONDIST' => 
¬¿y
(

836 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

840 'FACT' => 
¬¿y
(

841 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

845 'FACTDOUBLE' => 
¬¿y
(

846 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

850 'FALSE' => 
¬¿y
(

851 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOGICAL
,

855 'FDIST' => 
¬¿y
(

856 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

860 'FIND' => 
¬¿y
(

861 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

865 'FINDB' => 
¬¿y
(

866 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

870 'FINV' => 
¬¿y
(

871 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

875 'FISHER' => 
¬¿y
(

876 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

880 'FISHERINV' => 
¬¿y
(

881 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

885 'FIXED' => 
¬¿y
(

886 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

890 'FLOOR' => 
¬¿y
(

891 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

895 'FORECAST' => 
¬¿y
(

896 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

900 'FREQUENCY' => 
¬¿y
(

901 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

905 'FTEST' => 
¬¿y
(

906 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

910 'FV' => 
¬¿y
(

911 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

915 'FVSCHEDULE' => 
¬¿y
(

916 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

920 'GAMMADIST' => 
¬¿y
(

921 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

925 'GAMMAINV' => 
¬¿y
(

926 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

930 'GAMMALN' => 
¬¿y
(

931 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

935 'GCD' => 
¬¿y
(

936 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

940 'GEOMEAN' => 
¬¿y
(

941 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

945 'GESTEP' => 
¬¿y
(

946 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

950 'GETPIVOTDATA' => 
¬¿y
(

951 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

955 'GROWTH' => 
¬¿y
(

956 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

960 'HARMEAN' => 
¬¿y
(

961 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

965 'HEX2BIN' => 
¬¿y
(

966 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

970 'HEX2DEC' => 
¬¿y
(

971 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

975 'HEX2OCT' => 
¬¿y
(

976 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

980 'HLOOKUP' => 
¬¿y
(

981 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

985 'HOUR' => 
¬¿y
(

986 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

990 'HYPERLINK' => 
¬¿y
(

991 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

994 '·ssC–lReã»nû' => 
Œue


996 'HYPGEOMDIST' => 
¬¿y
(

997 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1001 'IF' => 
¬¿y
(

1002 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOGICAL
,

1006 'IFERROR' => 
¬¿y
(

1007 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOGICAL
,

1011 'IMABS' => 
¬¿y
(

1012 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1016 'IMAGINARY' => 
¬¿y
(

1017 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1021 'IMARGUMENT' => 
¬¿y
(

1022 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1026 'IMCONJUGATE' => 
¬¿y
(

1027 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1031 'IMCOS' => 
¬¿y
(

1032 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1036 'IMDIV' => 
¬¿y
(

1037 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1041 'IMEXP' => 
¬¿y
(

1042 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1046 'IMLN' => 
¬¿y
(

1047 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1051 'IMLOG10' => 
¬¿y
(

1052 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1056 'IMLOG2' => 
¬¿y
(

1057 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1061 'IMPOWER' => 
¬¿y
(

1062 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1066 'IMPRODUCT' => 
¬¿y
(

1067 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1071 'IMREAL' => 
¬¿y
(

1072 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1076 'IMSIN' => 
¬¿y
(

1077 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1081 'IMSQRT' => 
¬¿y
(

1082 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1086 'IMSUB' => 
¬¿y
(

1087 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1091 'IMSUM' => 
¬¿y
(

1092 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1096 'INDEX' => 
¬¿y
(

1097 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

1101 'INDIRECT' => 
¬¿y
(

1102 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

1105 '·ssC–lReã»nû' => 
Œue


1107 'INFO' => 
¬¿y
(

1108 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1112 'INT' => 
¬¿y
(

1113 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1117 'INTERCEPT' => 
¬¿y
(

1118 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1122 'INTRATE' => 
¬¿y
(

1123 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1127 'IPMT' => 
¬¿y
(

1128 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1132 'IRR' => 
¬¿y
(

1133 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1137 'ISBLANK' => 
¬¿y
(

1138 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1142 'ISERR' => 
¬¿y
(

1143 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1147 'ISERROR' => 
¬¿y
(

1148 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1152 'ISEVEN' => 
¬¿y
(

1153 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1157 'ISLOGICAL' => 
¬¿y
(

1158 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1162 'ISNA' => 
¬¿y
(

1163 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1167 'ISNONTEXT' => 
¬¿y
(

1168 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1172 'ISNUMBER' => 
¬¿y
(

1173 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1177 'ISODD' => 
¬¿y
(

1178 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1182 'ISPMT' => 
¬¿y
(

1183 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1187 'ISREF' => 
¬¿y
(

1188 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1192 'ISTEXT' => 
¬¿y
(

1193 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1197 'JIS' => 
¬¿y
(

1198 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1202 'KURT' => 
¬¿y
(

1203 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1207 'LARGE' => 
¬¿y
(

1208 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1212 'LCM' => 
¬¿y
(

1213 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1217 'LEFT' => 
¬¿y
(

1218 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1222 'LEFTB' => 
¬¿y
(

1223 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1227 'LEN' => 
¬¿y
(

1228 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1232 'LENB' => 
¬¿y
(

1233 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1237 'LINEST' => 
¬¿y
(

1238 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1242 'LN' => 
¬¿y
(

1243 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1247 'LOG' => 
¬¿y
(

1248 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1252 'LOG10' => 
¬¿y
(

1253 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1257 'LOGEST' => 
¬¿y
(

1258 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1262 'LOGINV' => 
¬¿y
(

1263 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1267 'LOGNORMDIST' => 
¬¿y
(

1268 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1272 'LOOKUP' => 
¬¿y
(

1273 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

1277 'LOWER' => 
¬¿y
(

1278 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1282 'MATCH' => 
¬¿y
(

1283 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

1287 'MAX' => 
¬¿y
(

1288 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1292 'MAXA' => 
¬¿y
(

1293 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1297 'MAXIF' => 
¬¿y
(

1298 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1302 'MDETERM' => 
¬¿y
(

1303 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1307 'MDURATION' => 
¬¿y
(

1308 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1312 'MEDIAN' => 
¬¿y
(

1313 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1317 'MEDIANIF' => 
¬¿y
(

1318 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1322 'MID' => 
¬¿y
(

1323 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1327 'MIDB' => 
¬¿y
(

1328 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1332 'MIN' => 
¬¿y
(

1333 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1337 'MINA' => 
¬¿y
(

1338 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1342 'MINIF' => 
¬¿y
(

1343 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1347 'MINUTE' => 
¬¿y
(

1348 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

1352 'MINVERSE' => 
¬¿y
(

1353 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1357 'MIRR' => 
¬¿y
(

1358 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1362 'MMULT' => 
¬¿y
(

1363 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1367 'MOD' => 
¬¿y
(

1368 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1372 'MODE' => 
¬¿y
(

1373 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1377 'MONTH' => 
¬¿y
(

1378 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

1382 'MROUND' => 
¬¿y
(

1383 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1387 'MULTINOMIAL' => 
¬¿y
(

1388 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1392 'N' => 
¬¿y
(

1393 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1397 'NA' => 
¬¿y
(

1398 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1402 'NEGBINOMDIST' => 
¬¿y
(

1403 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1407 'NETWORKDAYS' => 
¬¿y
(

1408 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

1412 'NOMINAL' => 
¬¿y
(

1413 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1417 'NORMDIST' => 
¬¿y
(

1418 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1422 'NORMINV' => 
¬¿y
(

1423 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1427 'NORMSDIST' => 
¬¿y
(

1428 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1432 'NORMSINV' => 
¬¿y
(

1433 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1437 'NOT' => 
¬¿y
(

1438 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOGICAL
,

1442 'NOW' => 
¬¿y
(

1443 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

1447 'NPER' => 
¬¿y
(

1448 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1452 'NPV' => 
¬¿y
(

1453 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1457 'OCT2BIN' => 
¬¿y
(

1458 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1462 'OCT2DEC' => 
¬¿y
(

1463 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1467 'OCT2HEX' => 
¬¿y
(

1468 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_ENGINEERING
,

1472 'ODD' => 
¬¿y
(

1473 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1477 'ODDFPRICE' => 
¬¿y
(

1478 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1482 'ODDFYIELD' => 
¬¿y
(

1483 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1487 'ODDLPRICE' => 
¬¿y
(

1488 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1492 'ODDLYIELD' => 
¬¿y
(

1493 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1497 'OFFSET' => 
¬¿y
(

1498 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

1501 '·ssC–lReã»nû' => 
Œue
,

1502 '·ssByReã»nû' => 
¬¿y
(
Œue
)

1504 'OR' => 
¬¿y
(

1505 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOGICAL
,

1509 'PEARSON' => 
¬¿y
(

1510 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1514 'PERCENTILE' => 
¬¿y
(

1515 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1519 'PERCENTRANK' => 
¬¿y
(

1520 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1524 'PERMUT' => 
¬¿y
(

1525 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1529 'PHONETIC' => 
¬¿y
(

1530 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1534 'PI' => 
¬¿y
(

1535 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1539 'PMT' => 
¬¿y
(

1540 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1544 'POISSON' => 
¬¿y
(

1545 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1549 'POWER' => 
¬¿y
(

1550 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1554 'PPMT' => 
¬¿y
(

1555 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1559 'PRICE' => 
¬¿y
(

1560 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1564 'PRICEDISC' => 
¬¿y
(

1565 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1569 'PRICEMAT' => 
¬¿y
(

1570 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1574 'PROB' => 
¬¿y
(

1575 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1579 'PRODUCT' => 
¬¿y
(

1580 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1584 'PROPER' => 
¬¿y
(

1585 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1589 'PV' => 
¬¿y
(

1590 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1594 'QUARTILE' => 
¬¿y
(

1595 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1599 'QUOTIENT' => 
¬¿y
(

1600 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1604 'RADIANS' => 
¬¿y
(

1605 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1609 'RAND' => 
¬¿y
(

1610 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1614 'RANDBETWEEN' => 
¬¿y
(

1615 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1619 'RANK' => 
¬¿y
(

1620 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1624 'RATE' => 
¬¿y
(

1625 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1629 'RECEIVED' => 
¬¿y
(

1630 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1634 'REPLACE' => 
¬¿y
(

1635 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1639 'REPLACEB' => 
¬¿y
(

1640 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1644 'REPT' => 
¬¿y
(

1645 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1649 'RIGHT' => 
¬¿y
(

1650 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1654 'RIGHTB' => 
¬¿y
(

1655 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1659 'ROMAN' => 
¬¿y
(

1660 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1664 'ROUND' => 
¬¿y
(

1665 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1669 'ROUNDDOWN' => 
¬¿y
(

1670 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1674 'ROUNDUP' => 
¬¿y
(

1675 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1679 'ROW' => 
¬¿y
(

1680 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

1683 '·ssByReã»nû' => 
¬¿y
(
Œue
)

1685 'ROWS' => 
¬¿y
(

1686 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

1690 'RSQ' => 
¬¿y
(

1691 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1695 'RTD' => 
¬¿y
(

1696 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

1700 'SEARCH' => 
¬¿y
(

1701 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1705 'SEARCHB' => 
¬¿y
(

1706 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1710 'SECOND' => 
¬¿y
(

1711 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

1715 'SERIESSUM' => 
¬¿y
(

1716 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1720 'SIGN' => 
¬¿y
(

1721 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1725 'SIN' => 
¬¿y
(

1726 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1730 'SINH' => 
¬¿y
(

1731 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1735 'SKEW' => 
¬¿y
(

1736 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1740 'SLN' => 
¬¿y
(

1741 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1745 'SLOPE' => 
¬¿y
(

1746 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1750 'SMALL' => 
¬¿y
(

1751 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1755 'SQRT' => 
¬¿y
(

1756 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1760 'SQRTPI' => 
¬¿y
(

1761 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1765 'STANDARDIZE' => 
¬¿y
(

1766 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1770 'STDEV' => 
¬¿y
(

1771 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1775 'STDEVA' => 
¬¿y
(

1776 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1780 'STDEVP' => 
¬¿y
(

1781 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1785 'STDEVPA' => 
¬¿y
(

1786 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1790 'STEYX' => 
¬¿y
(

1791 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1795 'SUBSTITUTE' => 
¬¿y
(

1796 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1800 'SUBTOTAL' => 
¬¿y
(

1801 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1805 'SUM' => 
¬¿y
(

1806 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1810 'SUMIF' => 
¬¿y
(

1811 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1815 'SUMIFS' => 
¬¿y
(

1816 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1820 'SUMPRODUCT' => 
¬¿y
(

1821 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1825 'SUMSQ' => 
¬¿y
(

1826 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1830 'SUMX2MY2' => 
¬¿y
(

1831 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1835 'SUMX2PY2' => 
¬¿y
(

1836 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1840 'SUMXMY2' => 
¬¿y
(

1841 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1845 'SYD' => 
¬¿y
(

1846 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1850 'T' => 
¬¿y
(

1851 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1855 'TAN' => 
¬¿y
(

1856 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1860 'TANH' => 
¬¿y
(

1861 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1865 'TBILLEQ' => 
¬¿y
(

1866 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1870 'TBILLPRICE' => 
¬¿y
(

1871 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1875 'TBILLYIELD' => 
¬¿y
(

1876 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1880 'TDIST' => 
¬¿y
(

1881 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1885 'TEXT' => 
¬¿y
(

1886 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1890 'TIME' => 
¬¿y
(

1891 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

1895 'TIMEVALUE' => 
¬¿y
(

1896 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

1900 'TINV' => 
¬¿y
(

1901 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1905 'TODAY' => 
¬¿y
(

1906 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

1910 'TRANSPOSE' => 
¬¿y
(

1911 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

1915 'TREND' => 
¬¿y
(

1916 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1920 'TRIM' => 
¬¿y
(

1921 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1925 'TRIMMEAN' => 
¬¿y
(

1926 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1930 'TRUE' => 
¬¿y
(

1931 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOGICAL
,

1935 'TRUNC' => 
¬¿y
(

1936 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_MATH_AND_TRIG
,

1940 'TTEST' => 
¬¿y
(

1941 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1945 'TYPE' => 
¬¿y
(

1946 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1950 'UPPER' => 
¬¿y
(

1951 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1955 'USDOLLAR' => 
¬¿y
(

1956 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1960 'VALUE' => 
¬¿y
(

1961 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_TEXT_AND_DATA
,

1965 'VAR' => 
¬¿y
(

1966 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1970 'VARA' => 
¬¿y
(

1971 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1975 'VARP' => 
¬¿y
(

1976 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1980 'VARPA' => 
¬¿y
(

1981 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

1985 'VDB' => 
¬¿y
(

1986 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

1990 'VERSION' => 
¬¿y
(

1991 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_INFORMATION
,

1995 'VLOOKUP' => 
¬¿y
(

1996 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_LOOKUP_AND_REFERENCE
,

2000 'WEEKDAY' => 
¬¿y
(

2001 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

2005 'WEEKNUM' => 
¬¿y
(

2006 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

2010 'WEIBULL' => 
¬¿y
(

2011 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

2015 'WORKDAY' => 
¬¿y
(

2016 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

2020 'XIRR' => 
¬¿y
(

2021 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

2025 'XNPV' => 
¬¿y
(

2026 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

2030 'YEAR' => 
¬¿y
(

2031 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

2035 'YEARFRAC' => 
¬¿y
(

2036 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_DATE_AND_TIME
,

2040 'YIELD' => 
¬¿y
(

2041 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

2045 'YIELDDISC' => 
¬¿y
(

2046 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

2050 'YIELDMAT' => 
¬¿y
(

2051 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_FINANCIAL
,

2055 'ZTEST' => 
¬¿y
(

2056 'ÿ‹gÜy' => 
PHPExûl_C®cuÏtiÚ_FunùiÚ
::
CATEGORY_STATISTICAL
,

2063 
´iv©e
 
	m$cÚŒŞFunùiÚs
 = 
¬¿y
(

2064 'MKMATRIX' => 
¬¿y
(

2071 
´iv©e
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$wÜkbook
 = 
nuÎ
)

2073 
$£tP»cisiÚ
 = (
PHP_INT_SIZE
 == 4) ? 14 : 16;

2074 
$this
->
§vedP»cisiÚ
 = 
	`ši_g‘
('precision');

2075 ià(
$this
->
§vedP»cisiÚ
 < 
$£tP»cisiÚ
) {

2076 
	`ši_£t
('´ecisiÚ', 
$£tP»cisiÚ
);

2078 
$this
->
d–
 = 1 * 
	`pow
(10, -
$£tP»cisiÚ
);

2080 ià(
$wÜkbook
 !=ğ
nuÎ
) {

2081 
£lf
::
$wÜkbookS‘s
[
$wÜkbook
->
	`g‘ID
()] = 
$this
;

2084 
$this
->
wÜkbook
 = 
$wÜkbook
;

2085 
$this
->
cyşicReã»nûSck
 = 
Ãw
 
	`PHPExûl_C®cEngše_CyşicReã»nûSck
();

2086 
$this
->
_debugLog
 = 
Ãw
 
	`PHPExûl_C®cEngše_Logg”
($this->
cyşicReã»nûSck
);

2090 
public
 
funùiÚ
 
	$__de¡ruù
()

2092 ià(
$this
->
§vedP»cisiÚ
 !ğ
	`ši_g‘
('precision')) {

2093 
	`ši_£t
('´ecisiÚ', 
$this
->
§vedP»cisiÚ
);

2095 
	}
}

2097 
´iv©e
 
funùiÚ
 
	$lßdLoÿËs
()

2099 
$loÿËFeDœeùÜy
 = 
PHPEXCEL_ROOT
.'PHPExcel/locale/';

2100 
	`fÜ—ch
 (
	`glob
(
$loÿËFeDœeùÜy
.'/*', 
GLOB_ONLYDIR
è
as
 
$f’ame
) {

2101 
$f’ame
 = 
	`sub¡r
($f’ame, 
	`¡¾’
(
$loÿËFeDœeùÜy
)+1);

2102 ià(
$f’ame
 != 'en') {

2103 
£lf
::
$v®idLoÿËLªguages
[] = 
$f’ame
;

2106 
	}
}

2116 
public
 
funùiÚ
 
	$g‘In¡ªû
(
PHPExûl
 
$wÜkbook
 = 
nuÎ
)

2118 ià(
$wÜkbook
 !=ğ
nuÎ
) {

2119 ià(
	`is£t
(
£lf
::
$wÜkbookS‘s
[
$wÜkbook
->
	`g‘ID
()])) {

2120  
£lf
::
$wÜkbookS‘s
[
$wÜkbook
->
	`g‘ID
()];

2122  
Ãw
 
	`PHPExûl_C®cuÏtiÚ
(
$wÜkbook
);

2125 ià(!
	`is£t
(
£lf
::
$š¡ªû
è|| (£lf::$š¡ªû ==ğ
nuÎ
)) {

2126 
£lf
::
$š¡ªû
 = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ
();

2129  
£lf
::
$š¡ªû
;

2130 
	}
}

2138 
public
 
funùiÚ
 
	$un£tIn¡ªû
(
PHPExûl
 
$wÜkbook
 = 
nuÎ
)

2140 ià(
$wÜkbook
 !=ğ
nuÎ
) {

2141 ià(
	`is£t
(
£lf
::
$wÜkbookS‘s
[
$wÜkbook
->
	`g‘ID
()])) {

2142 
	`un£t
(
£lf
::
$wÜkbookS‘s
[
$wÜkbook
->
	`g‘ID
()]);

2145 
	}
}

2154 
public
 
funùiÚ
 
	$æushIn¡ªû
()

2156 
$this
->
	`ş—rC®cuÏtiÚCache
();

2157 
	}
}

2166 
public
 
funùiÚ
 
	$g‘DebugLog
()

2168  
$this
->
_debugLog
;

2169 
	}
}

2177 
fš®
 
public
 
funùiÚ
 
	$__şÚe
()

2179 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
('Cloninghe calculationƒngine is‚ot‡llowed!');

2180 
	}
}

2189 
public
 
funùiÚ
 
	$g‘TRUE
()

2191  
£lf
::
$loÿËBoŞ—n
['TRUE'];

2192 
	}
}

2200 
public
 
funùiÚ
 
	$g‘FALSE
()

2202  
£lf
::
$loÿËBoŞ—n
['FALSE'];

2203 
	}
}

2212 
public
 
funùiÚ
 
	$£tA¼ayR‘uºTy³
(
$»tuºTy³
)

2214 ià((
$»tuºTy³
 =ğ
£lf
::
RETURN_ARRAY_AS_VALUE
) ||

2215 (
$»tuºTy³
 =ğ
£lf
::
RETURN_ARRAY_AS_ERROR
) ||

2216 (
$»tuºTy³
 =ğ
£lf
::
RETURN_ARRAY_AS_ARRAY
)) {

2217 
£lf
::
$»tuºA¼ayAsTy³
 = 
$»tuºTy³
;

2218  
Œue
;

2220  
çl£
;

2221 
	}
}

2230 
public
 
funùiÚ
 
	$g‘A¼ayR‘uºTy³
()

2232  
£lf
::
$»tuºA¼ayAsTy³
;

2233 
	}
}

2242 
public
 
funùiÚ
 
	$g‘C®cuÏtiÚCacheEÇbËd
()

2244  
$this
->
ÿlcuÏtiÚCacheEÇbËd
;

2245 
	}
}

2253 
public
 
funùiÚ
 
	$£tC®cuÏtiÚCacheEÇbËd
(
$pV®ue
 = 
Œue
)

2255 
$this
->
ÿlcuÏtiÚCacheEÇbËd
 = 
$pV®ue
;

2256 
$this
->
	`ş—rC®cuÏtiÚCache
();

2257 
	}
}

2263 
public
 
funùiÚ
 
	$’abËC®cuÏtiÚCache
()

2265 
$this
->
	`£tC®cuÏtiÚCacheEÇbËd
(
Œue
);

2266 
	}
}

2272 
public
 
funùiÚ
 
	$di§bËC®cuÏtiÚCache
()

2274 
$this
->
	`£tC®cuÏtiÚCacheEÇbËd
(
çl£
);

2275 
	}
}

2281 
public
 
funùiÚ
 
	$ş—rC®cuÏtiÚCache
()

2283 
$this
->
ÿlcuÏtiÚCache
 = 
	`¬¿y
();

2284 
	}
}

2291 
public
 
funùiÚ
 
	$ş—rC®cuÏtiÚCacheFÜWÜksh“t
(
$wÜksh“tName
)

2293 ià(
	`is£t
(
$this
->
ÿlcuÏtiÚCache
[
$wÜksh“tName
])) {

2294 
	`un£t
(
$this
->
ÿlcuÏtiÚCache
[
$wÜksh“tName
]);

2296 
	}
}

2304 
public
 
funùiÚ
 
	$»ÇmeC®cuÏtiÚCacheFÜWÜksh“t
(
$äomWÜksh“tName
, 
$toWÜksh“tName
)

2306 ià(
	`is£t
(
$this
->
ÿlcuÏtiÚCache
[
$äomWÜksh“tName
])) {

2307 
$this
->
ÿlcuÏtiÚCache
[
$toWÜksh“tName
] = &$this->ÿlcuÏtiÚCache[
$äomWÜksh“tName
];

2308 
	`un£t
(
$this
->
ÿlcuÏtiÚCache
[
$äomWÜksh“tName
]);

2310 
	}
}

2318 
public
 
funùiÚ
 
	$g‘LoÿË
()

2320  
£lf
::
$loÿËLªguage
;

2321 
	}
}

2330 
public
 
funùiÚ
 
£tLoÿË
(
$loÿË
 = 'en_us')

2333 
$Ïnguage
 = 
$loÿË
 = 
¡¹Şow”
($locale);

2334 ià(
¡½os
(
$loÿË
, '_'è!=ğ
çl£
) {

2335 
li¡
(
$Ïnguage
èğ
ex¶ode
('_', 
$loÿË
);

2338 ià(
couÁ
(
£lf
::
$v®idLoÿËLªguages
) == 1) {

2339 
£lf
::
lßdLoÿËs
();

2342 ià(
š_¬¿y
(
$Ïnguage
, 
£lf
::
$v®idLoÿËLªguages
)) {

2344 
£lf
::
$loÿËFunùiÚs
 = 
¬¿y
();

2345 
	g£lf
::
$loÿËArgum’tS•¬©Ü
 = ',';

2346 
	g£lf
::
$loÿËBoŞ—n
 = 
¬¿y
('TRUE' => 'TRUE', 'FALSE' => 'FALSE', 'NULL' => 'NULL');

2348 ià(
	g$loÿË
 != 'en_us') {

2350 
$funùiÚNamesFe
 = 
PHPEXCEL_ROOT
 . 'PHPExûl'.
DIRECTORY_SEPARATOR
.'loÿË'.DIRECTORY_SEPARATOR.
¡r_»¶aû
('_', DIRECTORY_SEPARATOR, 
$loÿË
).
	gDIRECTORY_SEPARATOR
.'functions';

2351 ià(!
fe_exi¡s
(
$funùiÚNamesFe
)) {

2353 
	g$funùiÚNamesFe
 = 
PHPEXCEL_ROOT
 . 'PHPExûl'.
DIRECTORY_SEPARATOR
.'loÿË'.DIRECTORY_SEPARATOR.
$Ïnguage
.DIRECTORY_SEPARATOR.'functions';

2354 ià(!
fe_exi¡s
(
$funùiÚNamesFe
)) {

2355  
	gçl£
;

2359 
	g$loÿËFunùiÚs
 = 
fe
(
$funùiÚNamesFe
, 
FILE_IGNORE_NEW_LINES
 | 
FILE_SKIP_EMPTY_LINES
);

2360 
fÜ—ch
 (
$loÿËFunùiÚs
 
as
 
$loÿËFunùiÚ
) {

2361 
li¡
(
$loÿËFunùiÚ
èğ
ex¶ode
('##', $localeFunction);

2362 ià(
¡½os
(
$loÿËFunùiÚ
, '='è!=ğ
çl£
) {

2363 
li¡
(
$fName
, 
$lfName
èğ
ex¶ode
('=', 
$loÿËFunùiÚ
);

2364 
	g$fName
 = 
Œim
(
$fName
);

2365 
	g$lfName
 = 
Œim
(
$lfName
);

2366 ià((
is£t
(
£lf
::
$PHPExûlFunùiÚs
[
$fName
])è&& (
$lfName
 != '') && ($fName != $lfName)) {

2367 
£lf
::
$loÿËFunùiÚs
[
$fName
] = 
$lfName
;

2372 ià(
is£t
(
£lf
::
$loÿËFunùiÚs
['TRUE'])) {

2373 
£lf
::
$loÿËBoŞ—n
['TRUE'] = s–f::
$loÿËFunùiÚs
['TRUE'];

2375 ià(
is£t
(
£lf
::
$loÿËFunùiÚs
['FALSE'])) {

2376 
£lf
::
$loÿËBoŞ—n
['FALSE'] = s–f::
$loÿËFunùiÚs
['FALSE'];

2379 
	g$cÚfigFe
 = 
PHPEXCEL_ROOT
 . 'PHPExûl'.
DIRECTORY_SEPARATOR
.'loÿË'.DIRECTORY_SEPARATOR.
¡r_»¶aû
('_', DIRECTORY_SEPARATOR, 
$loÿË
).
	gDIRECTORY_SEPARATOR
.'config';

2380 ià(!
fe_exi¡s
(
$cÚfigFe
)) {

2381 
	g$cÚfigFe
 = 
PHPEXCEL_ROOT
 . 'PHPExûl'.
DIRECTORY_SEPARATOR
.'loÿË'.DIRECTORY_SEPARATOR.
$Ïnguage
.DIRECTORY_SEPARATOR.'config';

2383 ià(
fe_exi¡s
(
$cÚfigFe
)) {

2384 
	g$loÿËS‘tšgs
 = 
fe
(
$cÚfigFe
, 
FILE_IGNORE_NEW_LINES
 | 
FILE_SKIP_EMPTY_LINES
);

2385 
fÜ—ch
 (
$loÿËS‘tšgs
 
as
 
$loÿËS‘tšg
) {

2386 
li¡
(
$loÿËS‘tšg
èğ
ex¶ode
('##', $localeSetting);

2387 ià(
¡½os
(
$loÿËS‘tšg
, '='è!=ğ
çl£
) {

2388 
li¡
(
$£‰šgName
, 
$£‰šgV®ue
èğ
ex¶ode
('=', 
$loÿËS‘tšg
);

2389 
	g$£‰šgName
 = 
¡¹ouµ”
(
Œim
(
$£‰šgName
));

2390 
	g$£‰šgName
) {

2392 
£lf
::
$loÿËArgum’tS•¬©Ü
 = 
Œim
(
$£‰šgV®ue
);

2400 
	g£lf
::
$funùiÚR•ÏûFromExûl
 = 
£lf
::
$funùiÚR•ÏûToExûl
 =

2401 
£lf
::
$funùiÚR•ÏûFromLoÿË
 = s–f::
$funùiÚR•ÏûToLoÿË
 = 
nuÎ
;

2402 
	g£lf
::
$loÿËLªguage
 = 
$loÿË
;

2403  
	gŒue
;

2405  
	gçl£
;

2410 
public
 
funùiÚ
 
	$Œª¦©eS•¬©Ü
(
$äomS•¬©Ü
, 
$toS•¬©Ü
, 
$fÜmuÏ
, &
$šB¿ûs
)

2412 
$¡¾’
 = 
	`mb_¡¾’
(
$fÜmuÏ
);

2413 
$i
 = 0; $˜< 
$¡¾’
; ++$i) {

2414 
$chr
 = 
	`mb_sub¡r
(
$fÜmuÏ
, 
$i
, 1);

2415 
$chr
) {

2417 
$šB¿ûs
 = 
Œue
;

2420 
$šB¿ûs
 = 
çl£
;

2422 
$äomS•¬©Ü
:

2423 ià(!
$šB¿ûs
) {

2424 
$fÜmuÏ
 = 
	`mb_sub¡r
($fÜmuÏ, 0, 
$i
).
$toS•¬©Ü
.mb_substr($formula, $i+1);

2428  
$fÜmuÏ
;

2429 
	}
}

2431 
´iv©e
 
funùiÚ
 
	$Œª¦©eFÜmuÏ
(
$äom
, 
$to
, 
$fÜmuÏ
, 
$äomS•¬©Ü
, 
$toS•¬©Ü
)

2434 ià(
£lf
::
$loÿËLªguage
 !== 'en_us') {

2435 
$šB¿ûs
 = 
çl£
;

2437 ià(
	`¡½os
(
$fÜmuÏ
, '"'è!=ğ
çl£
) {

2440 
$‹mp
 = 
	`ex¶ode
('"', 
$fÜmuÏ
);

2441 
$i
 = 
çl£
;

2442 
	`fÜ—ch
 (
$‹mp
 
as
 &
$v®ue
) {

2444 ià(
$i
 = !$i) {

2445 
$v®ue
 = 
	`´eg_»¶aû
(
$äom
, 
$to
, $value);

2446 
$v®ue
 = 
£lf
::
	`Œª¦©eS•¬©Ü
(
$äomS•¬©Ü
, 
$toS•¬©Ü
, $v®ue, 
$šB¿ûs
);

2449 
	`un£t
(
$v®ue
);

2451 
$fÜmuÏ
 = 
	`im¶ode
('"', 
$‹mp
);

2454 
$fÜmuÏ
 = 
	`´eg_»¶aû
(
$äom
, 
$to
, $formula);

2455 
$fÜmuÏ
 = 
£lf
::
	`Œª¦©eS•¬©Ü
(
$äomS•¬©Ü
, 
$toS•¬©Ü
, $fÜmuÏ, 
$šB¿ûs
);

2459  
$fÜmuÏ
;

2460 
	}
}

2462 
´iv©e
 
	g$funùiÚR•ÏûFromExûl
 = 
nuÎ
;

2463 
´iv©e
 
	g$funùiÚR•ÏûToLoÿË
 = 
nuÎ
;

2465 
public
 
funùiÚ
 
	$_Œª¦©eFÜmuÏToLoÿË
(
$fÜmuÏ
)

2467 ià(
£lf
::
$funùiÚR•ÏûFromExûl
 ==ğ
nuÎ
) {

2468 
£lf
::
$funùiÚR•ÏûFromExûl
 = 
	`¬¿y
();

2469 
	`fÜ—ch
 (
	`¬¿y_keys
(
£lf
::
$loÿËFunùiÚs
è
as
 
$exûlFunùiÚName
) {

2470 
£lf
::
$funùiÚR•ÏûFromExûl
[] = '/(@?[^\w\.])'.
	`´eg_quÙe
(
$exûlFunùiÚName
).'([\s]*\()/Ui';

2472 
	`fÜ—ch
 (
	`¬¿y_keys
(
£lf
::
$loÿËBoŞ—n
è
as
 
$exûlBoŞ—n
) {

2473 
£lf
::
$funùiÚR•ÏûFromExûl
[] = '/(@?[^\w\.])'.
	`´eg_quÙe
(
$exûlBoŞ—n
).'([^\w\.])/Ui';

2478 ià(
£lf
::
$funùiÚR•ÏûToLoÿË
 ==ğ
nuÎ
) {

2479 
£lf
::
$funùiÚR•ÏûToLoÿË
 = 
	`¬¿y
();

2480 
	`fÜ—ch
 (
	`¬¿y_v®ues
(
£lf
::
$loÿËFunùiÚs
è
as
 
$loÿËFunùiÚName
) {

2481 
£lf
::
$funùiÚR•ÏûToLoÿË
[] = '$1'.
	`Œim
(
$loÿËFunùiÚName
).'$2';

2483 
	`fÜ—ch
 (
	`¬¿y_v®ues
(
£lf
::
$loÿËBoŞ—n
è
as
 $localeBoolean) {

2484 
£lf
::
$funùiÚR•ÏûToLoÿË
[] = '$1'.
	`Œim
(
$loÿËBoŞ—n
).'$2';

2488  
£lf
::
	`Œª¦©eFÜmuÏ
(£lf::
$funùiÚR•ÏûFromExûl
, s–f::
$funùiÚR•ÏûToLoÿË
, 
$fÜmuÏ
, ',', s–f::
$loÿËArgum’tS•¬©Ü
);

2489 
	}
}

2492 
´iv©e
 
	g$funùiÚR•ÏûFromLoÿË
 = 
nuÎ
;

2493 
´iv©e
 
	g$funùiÚR•ÏûToExûl
 = 
nuÎ
;

2495 
public
 
funùiÚ
 
	$_Œª¦©eFÜmuÏToEnglish
(
$fÜmuÏ
)

2497 ià(
£lf
::
$funùiÚR•ÏûFromLoÿË
 ==ğ
nuÎ
) {

2498 
£lf
::
$funùiÚR•ÏûFromLoÿË
 = 
	`¬¿y
();

2499 
	`fÜ—ch
 (
	`¬¿y_v®ues
(
£lf
::
$loÿËFunùiÚs
è
as
 
$loÿËFunùiÚName
) {

2500 
£lf
::
$funùiÚR•ÏûFromLoÿË
[] = '/(@?[^\w\.])'.
	`´eg_quÙe
(
$loÿËFunùiÚName
).'([\s]*\()/Ui';

2502 
	`fÜ—ch
 (
	`¬¿y_v®ues
(
£lf
::
$loÿËBoŞ—n
è
as
 
$exûlBoŞ—n
) {

2503 
£lf
::
$funùiÚR•ÏûFromLoÿË
[] = '/(@?[^\w\.])'.
	`´eg_quÙe
(
$exûlBoŞ—n
).'([^\w\.])/Ui';

2507 ià(
£lf
::
$funùiÚR•ÏûToExûl
 ==ğ
nuÎ
) {

2508 
£lf
::
$funùiÚR•ÏûToExûl
 = 
	`¬¿y
();

2509 
	`fÜ—ch
 (
	`¬¿y_keys
(
£lf
::
$loÿËFunùiÚs
è
as
 
$exûlFunùiÚName
) {

2510 
£lf
::
$funùiÚR•ÏûToExûl
[] = '$1'.
	`Œim
(
$exûlFunùiÚName
).'$2';

2512 
	`fÜ—ch
 (
	`¬¿y_keys
(
£lf
::
$loÿËBoŞ—n
è
as
 
$exûlBoŞ—n
) {

2513 
£lf
::
$funùiÚR•ÏûToExûl
[] = '$1'.
	`Œim
(
$exûlBoŞ—n
).'$2';

2517  
£lf
::
	`Œª¦©eFÜmuÏ
(£lf::
$funùiÚR•ÏûFromLoÿË
, s–f::
$funùiÚR•ÏûToExûl
, 
$fÜmuÏ
, s–f::
$loÿËArgum’tS•¬©Ü
, ',');

2518 
	}
}

2521 
public
 
funùiÚ
 
	$loÿËFunc
(
$funùiÚ
)

2523 ià(
£lf
::
$loÿËLªguage
 !== 'en_us') {

2524 
$funùiÚName
 = 
	`Œim
(
$funùiÚ
, '(');

2525 ià(
	`is£t
(
£lf
::
$loÿËFunùiÚs
[
$funùiÚName
])) {

2526 
$b¿û
 = (
$funùiÚName
 !ğ
$funùiÚ
);

2527 
$funùiÚ
 = 
£lf
::
$loÿËFunùiÚs
[
$funùiÚName
];

2528 ià(
$b¿û
) {

2529 
$funùiÚ
 .= '(';

2533  
$funùiÚ
;

2534 
	}
}

2545 
public
 
funùiÚ
 
	$w¿pResuÉ
(
$v®ue
)

2547 ià(
	`is_¡ršg
(
$v®ue
)) {

2549 ià(
	`´eg_m©ch
('/^'.
£lf
::
CALCULATION_REGEXP_ERROR
.'$/i', 
$v®ue
, 
$m©ch
)) {

2551  
$v®ue
;

2554  '"'.
$v®ue
.'"';

2556 } 
	`–£if
 ((
	`is_æßt
(
$v®ue
)è&& ((
	`is_Çn
($v®ue)è|| (
	`is_šfš™e
($value)))) {

2557  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2560  
$v®ue
;

2561 
	}
}

2570 
public
 
funùiÚ
 
	$unw¿pResuÉ
(
$v®ue
)

2572 ià(
	`is_¡ršg
(
$v®ue
)) {

2573 ià((
	`is£t
(
$v®ue
{0})è&& ($v®ue{0} =ğ'"'è&& (
	`sub¡r
($value, -1) == '"')) {

2574  
	`sub¡r
(
$v®ue
, 1, -1);

2577 } 
	`–£if
 ((
	`is_æßt
(
$v®ue
)è&& ((
	`is_Çn
($v®ue)è|| (
	`is_šfš™e
($value)))) {

2578  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2580  
$v®ue
;

2581 
	}
}

2595 
public
 
funùiÚ
 
	$ÿlcuÏ‹
(
PHPExûl_C–l
 
$pC–l
 = 
nuÎ
)

2597 
Œy
 {

2598  
$this
->
	`ÿlcuÏ‹C–lV®ue
(
$pC–l
);

2599 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

2600 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
$e
->
	`g‘Mes§ge
());

2602 
	}
}

2614 
public
 
funùiÚ
 
	$ÿlcuÏ‹C–lV®ue
(
PHPExûl_C–l
 
$pC–l
 = 
nuÎ
, 
$»£tLog
 = 
Œue
)

2616 ià(
$pC–l
 ==ğ
nuÎ
) {

2617  
nuÎ
;

2620 
$»tuºA¼ayAsTy³
 = 
£lf
::$returnArrayAsType;

2621 ià(
$»£tLog
) {

2623 
$this
->
fÜmuÏE¼Ü
 = 
nuÎ
;

2624 
$this
->
_debugLog
->
	`ş—rLog
();

2625 
$this
->
cyşicReã»nûSck
->
	`ş—r
();

2626 
$this
->
cyşicFÜmuÏCouÁ”
 = 1;

2628 
£lf
::
$»tuºA¼ayAsTy³
 = s–f::
RETURN_ARRAY_AS_ARRAY
;

2632 
$this
->
ûÎSck
[] = 
	`¬¿y
(

2633 'sh“t' => 
$pC–l
->
	`g‘WÜksh“t
()->
	`g‘T™Ë
(),

2634 'ûÎ' => 
$pC–l
->
	`g‘CoÜdš©e
(),

2636 
Œy
 {

2637 
$»suÉ
 = 
£lf
::
	`unw¿pResuÉ
(
$this
->
	`_ÿlcuÏ‹FÜmuÏV®ue
(
$pC–l
->
	`g‘V®ue
(), $pC–l->
	`g‘CoÜdš©e
(), $pCell));

2638 
$ûÎAdd»ss
 = 
	`¬¿y_pİ
(
$this
->
ûÎSck
);

2639 
$this
->
wÜkbook
->
	`g‘Sh“tByName
(
$ûÎAdd»ss
['sh“t'])->
	`g‘C–l
($cellAddress['cell']);

2640 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

2641 
$ûÎAdd»ss
 = 
	`¬¿y_pİ
(
$this
->
ûÎSck
);

2642 
$this
->
wÜkbook
->
	`g‘Sh“tByName
(
$ûÎAdd»ss
['sh“t'])->
	`g‘C–l
($cellAddress['cell']);

2643 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
$e
->
	`g‘Mes§ge
());

2646 ià((
	`is_¬¿y
(
$»suÉ
)è&& (
£lf
::
$»tuºA¼ayAsTy³
 !ğ£lf::
RETURN_ARRAY_AS_ARRAY
)) {

2647 
£lf
::
$»tuºA¼ayAsTy³
 = $returnArrayAsType;

2648 
$‹¡ResuÉ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$»suÉ
);

2649 ià(
£lf
::
$»tuºA¼ayAsTy³
 =ğ£lf::
RETURN_ARRAY_AS_ERROR
) {

2650  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2653 ià(
	`couÁ
(
$‹¡ResuÉ
) != 1) {

2655 
$r
 = 
	`¬¿y_keys
(
$»suÉ
);

2656 
$r
 = 
	`¬¿y_shiá
($r);

2657 ià(!
	`is_num”ic
(
$r
)) {

2658  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2660 ià(
	`is_¬¿y
(
$»suÉ
[
$r
])) {

2661 
$c
 = 
	`¬¿y_keys
(
$»suÉ
[
$r
]);

2662 
$c
 = 
	`¬¿y_shiá
($c);

2663 ià(!
	`is_num”ic
(
$c
)) {

2664  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2668 
$»suÉ
 = 
	`¬¿y_shiá
(
$‹¡ResuÉ
);

2670 
£lf
::
$»tuºA¼ayAsTy³
 = $returnArrayAsType;

2673 ià(
$»suÉ
 ==ğ
nuÎ
) {

2675 } 
	`–£if
 ((
	`is_æßt
(
$»suÉ
)è&& ((
	`is_Çn
($»suÉ)è|| (
	`is_šfš™e
($result)))) {

2676  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2678  
$»suÉ
;

2679 
	}
}

2689 
public
 
funùiÚ
 
	$·r£FÜmuÏ
(
$fÜmuÏ
)

2693 
$fÜmuÏ
 = 
	`Œim
($formula);

2694 ià((!
	`is£t
(
$fÜmuÏ
{0})) || ($formula{0} != '=')) {

2695  
	`¬¿y
();

2697 
$fÜmuÏ
 = 
	`Érim
(
	`sub¡r
($formula, 1));

2698 ià(!
	`is£t
(
$fÜmuÏ
{0})) {

2699  
	`¬¿y
();

2703  
$this
->
	`_·r£FÜmuÏ
(
$fÜmuÏ
);

2704 
	}
}

2716 
public
 
funùiÚ
 
	$ÿlcuÏ‹FÜmuÏ
(
$fÜmuÏ
, 
$ûÎID
 = 
nuÎ
, 
PHPExûl_C–l
 
$pC–l
 =‚ull)

2719 
$this
->
fÜmuÏE¼Ü
 = 
nuÎ
;

2720 
$this
->
_debugLog
->
	`ş—rLog
();

2721 
$this
->
cyşicReã»nûSck
->
	`ş—r
();

2725 
$»£tCache
 = 
$this
->
	`g‘C®cuÏtiÚCacheEÇbËd
();

2726 
$this
->
ÿlcuÏtiÚCacheEÇbËd
 = 
çl£
;

2728 
Œy
 {

2729 
$»suÉ
 = 
£lf
::
	`unw¿pResuÉ
(
$this
->
	`_ÿlcuÏ‹FÜmuÏV®ue
(
$fÜmuÏ
, 
$ûÎID
, 
$pC–l
));

2730 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

2731 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
$e
->
	`g‘Mes§ge
());

2735 
$this
->
ÿlcuÏtiÚCacheEÇbËd
 = 
$»£tCache
;

2737  
$»suÉ
;

2738 
	}
}

2741 
public
 
funùiÚ
 
	$g‘V®ueFromCache
(
$ûÎReã»nû
, &
$ûÎV®ue
)

2745 
$this
->
_debugLog
->
	`wr™eDebugLog
('Te¡šg cachv®ufÜ c–È', 
$ûÎReã»nû
);

2746 ià((
$this
->
ÿlcuÏtiÚCacheEÇbËd
è&& (
	`is£t
($this->
ÿlcuÏtiÚCache
[
$ûÎReã»nû
]))) {

2747 
$this
->
_debugLog
->
	`wr™eDebugLog
('R‘r›všg v®ufÜ c–È', 
$ûÎReã»nû
, ' from cache');

2749 
$ûÎV®ue
 = 
$this
->
ÿlcuÏtiÚCache
[
$ûÎReã»nû
];

2750  
Œue
;

2752  
çl£
;

2753 
	}
}

2755 
public
 
funùiÚ
 
	$§veV®ueToCache
(
$ûÎReã»nû
, 
$ûÎV®ue
)

2757 ià(
$this
->
ÿlcuÏtiÚCacheEÇbËd
) {

2758 
$this
->
ÿlcuÏtiÚCache
[
$ûÎReã»nû
] = 
$ûÎV®ue
;

2760 
	}
}

2771 
public
 
funùiÚ
 
	$_ÿlcuÏ‹FÜmuÏV®ue
(
$fÜmuÏ
, 
$ûÎID
 = 
nuÎ
, 
PHPExûl_C–l
 
$pC–l
 =‚ull)

2773 
$ûÎV®ue
 = 
nuÎ
;

2777 
$fÜmuÏ
 = 
	`Œim
($formula);

2778 ià(
$fÜmuÏ
{0} != '=') {

2779  
£lf
::
	`w¿pResuÉ
(
$fÜmuÏ
);

2781 
$fÜmuÏ
 = 
	`Érim
(
	`sub¡r
($formula, 1));

2782 ià(!
	`is£t
(
$fÜmuÏ
{0})) {

2783  
£lf
::
	`w¿pResuÉ
(
$fÜmuÏ
);

2786 
$pC–lP¬’t
 = (
$pC–l
 !=ğ
nuÎ
è? $pC–l->
	`g‘WÜksh“t
() :‚ull;

2787 
$wsT™Ë
 = (
$pC–lP¬’t
 !=ğ
nuÎ
è? $pC–lP¬’t->
	`g‘T™Ë
() : "\x00Wrk";

2788 
$wsC–lReã»nû
 = 
$wsT™Ë
 . '!' . 
$ûÎID
;

2790 ià((
$ûÎID
 !=ğ
nuÎ
è&& (
$this
->
	`g‘V®ueFromCache
(
$wsC–lReã»nû
, 
$ûÎV®ue
))) {

2791  
$ûÎV®ue
;

2794 ià((
$wsT™Ë
{0} !=ğ"\x00"è&& (
$this
->
cyşicReã»nûSck
->
	`ÚSck
(
$wsC–lReã»nû
))) {

2795 ià(
$this
->
cyşicFÜmuÏCouÁ
 <= 0) {

2796 
$this
->
cyşicFÜmuÏC–l
 = '';

2797  
$this
->
	`¿i£FÜmuÏE¼Ü
('Cyclic Reference in Formula');

2798 } 
	`–£if
 (
$this
->
cyşicFÜmuÏC–l
 ==ğ
$wsC–lReã»nû
) {

2799 ++
$this
->
cyşicFÜmuÏCouÁ”
;

2800 ià(
$this
->
cyşicFÜmuÏCouÁ”
 >ğ$this->
cyşicFÜmuÏCouÁ
) {

2801 
$this
->
cyşicFÜmuÏC–l
 = '';

2802  
$ûÎV®ue
;

2804 } 
	`–£if
 (
$this
->
cyşicFÜmuÏC–l
 == '') {

2805 ià(
$this
->
cyşicFÜmuÏCouÁ”
 >ğ$this->
cyşicFÜmuÏCouÁ
) {

2806  
$ûÎV®ue
;

2808 
$this
->
cyşicFÜmuÏC–l
 = 
$wsC–lReã»nû
;

2813 
$this
->
cyşicReã»nûSck
->
	`push
(
$wsC–lReã»nû
);

2814 
$ûÎV®ue
 = 
$this
->
	`´oûssTok’Sck
($this->
	`_·r£FÜmuÏ
(
$fÜmuÏ
, 
$pC–l
), 
$ûÎID
, $pCell);

2815 
$this
->
cyşicReã»nûSck
->
	`pİ
();

2818 ià(
$ûÎID
 !=ğ
nuÎ
) {

2819 
$this
->
	`§veV®ueToCache
(
$wsC–lReã»nû
, 
$ûÎV®ue
);

2823  
$ûÎV®ue
;

2824 
	}
}

2839 
´iv©e
 
funùiÚ
 
	$checkM©rixO³¿nds
(&
$İ”ªd1
, &
$İ”ªd2
, 
$»size
 = 1)

2843 ià(!
	`is_¬¿y
(
$İ”ªd1
)) {

2844 
	`li¡
(
$m©rixRows
, 
$m©rixCŞumns
èğ
£lf
::
	`g‘M©rixDim’siÚs
(
$İ”ªd2
);

2845 
$İ”ªd1
 = 
	`¬¿y_fl
(0, 
$m©rixRows
,‡¼ay_fl(0, 
$m©rixCŞumns
, $operand1));

2846 
$»size
 = 0;

2847 } 
	`–£if
 (!
	`is_¬¿y
(
$İ”ªd2
)) {

2848 
	`li¡
(
$m©rixRows
, 
$m©rixCŞumns
èğ
£lf
::
	`g‘M©rixDim’siÚs
(
$İ”ªd1
);

2849 
$İ”ªd2
 = 
	`¬¿y_fl
(0, 
$m©rixRows
,‡¼ay_fl(0, 
$m©rixCŞumns
, $operand2));

2850 
$»size
 = 0;

2853 
	`li¡
(
$m©rix1Rows
, 
$m©rix1CŞumns
èğ
£lf
::
	`g‘M©rixDim’siÚs
(
$İ”ªd1
);

2854 
	`li¡
(
$m©rix2Rows
, 
$m©rix2CŞumns
èğ
£lf
::
	`g‘M©rixDim’siÚs
(
$İ”ªd2
);

2855 ià((
$m©rix1Rows
 =ğ
$m©rix2CŞumns
è&& (
$m©rix2Rows
 =ğ
$m©rix1CŞumns
)) {

2856 
$»size
 = 1;

2859 ià(
$»size
 == 2) {

2861 
£lf
::
	`»sizeM©riûsEx‹nd
(
$İ”ªd1
, 
$İ”ªd2
, 
$m©rix1Rows
, 
$m©rix1CŞumns
, 
$m©rix2Rows
, 
$m©rix2CŞumns
);

2862 } 
	`–£if
 (
$»size
 == 1) {

2864 
£lf
::
	`»sizeM©riûsShršk
(
$İ”ªd1
, 
$İ”ªd2
, 
$m©rix1Rows
, 
$m©rix1CŞumns
, 
$m©rix2Rows
, 
$m©rix2CŞumns
);

2866  
	`¬¿y
Ğ
$m©rix1Rows
, 
$m©rix1CŞumns
, 
$m©rix2Rows
, 
$m©rix2CŞumns
);

2867 
	}
}

2876 
´iv©e
 
funùiÚ
 
	$g‘M©rixDim’siÚs
(&
$m©rix
)

2878 
$m©rixRows
 = 
	`couÁ
(
$m©rix
);

2879 
$m©rixCŞumns
 = 0;

2880 
	`fÜ—ch
 (
$m©rix
 
as
 
$rowKey
 => 
$rowV®ue
) {

2881 
$m©rixCŞumns
 = 
	`max
(
	`couÁ
(
$rowV®ue
), $matrixColumns);

2882 ià(!
	`is_¬¿y
(
$rowV®ue
)) {

2883 
$m©rix
[
$rowKey
] = 
	`¬¿y
(
$rowV®ue
);

2885 
$m©rix
[
$rowKey
] = 
	`¬¿y_v®ues
(
$rowV®ue
);

2888 
$m©rix
 = 
	`¬¿y_v®ues
($matrix);

2889  
	`¬¿y
(
$m©rixRows
, 
$m©rixCŞumns
);

2890 
	}
}

2903 
´iv©e
 
funùiÚ
 
	$»sizeM©riûsShršk
(&
$m©rix1
, &
$m©rix2
, 
$m©rix1Rows
, 
$m©rix1CŞumns
, 
$m©rix2Rows
, 
$m©rix2CŞumns
)

2905 ià((
$m©rix2CŞumns
 < 
$m©rix1CŞumns
è|| (
$m©rix2Rows
 < 
$m©rix1Rows
)) {

2906 ià(
$m©rix2Rows
 < 
$m©rix1Rows
) {

2907 
$i
 = 
$m©rix2Rows
; $˜< 
$m©rix1Rows
; ++$i) {

2908 
	`un£t
(
$m©rix1
[
$i
]);

2911 ià(
$m©rix2CŞumns
 < 
$m©rix1CŞumns
) {

2912 
$i
 = 0; $˜< 
$m©rix1Rows
; ++$i) {

2913 
$j
 = 
$m©rix2CŞumns
; $j < 
$m©rix1CŞumns
; ++$j) {

2914 
	`un£t
(
$m©rix1
[
$i
][
$j
]);

2920 ià((
$m©rix1CŞumns
 < 
$m©rix2CŞumns
è|| (
$m©rix1Rows
 < 
$m©rix2Rows
)) {

2921 ià(
$m©rix1Rows
 < 
$m©rix2Rows
) {

2922 
$i
 = 
$m©rix1Rows
; $˜< 
$m©rix2Rows
; ++$i) {

2923 
	`un£t
(
$m©rix2
[
$i
]);

2926 ià(
$m©rix1CŞumns
 < 
$m©rix2CŞumns
) {

2927 
$i
 = 0; $˜< 
$m©rix2Rows
; ++$i) {

2928 
$j
 = 
$m©rix1CŞumns
; $j < 
$m©rix2CŞumns
; ++$j) {

2929 
	`un£t
(
$m©rix2
[
$i
][
$j
]);

2934 
	}
}

2947 
´iv©e
 
funùiÚ
 
	$»sizeM©riûsEx‹nd
(&
$m©rix1
, &
$m©rix2
, 
$m©rix1Rows
, 
$m©rix1CŞumns
, 
$m©rix2Rows
, 
$m©rix2CŞumns
)

2949 ià((
$m©rix2CŞumns
 < 
$m©rix1CŞumns
è|| (
$m©rix2Rows
 < 
$m©rix1Rows
)) {

2950 ià(
$m©rix2CŞumns
 < 
$m©rix1CŞumns
) {

2951 
$i
 = 0; $˜< 
$m©rix2Rows
; ++$i) {

2952 
$x
 = 
$m©rix2
[
$i
][
$m©rix2CŞumns
-1];

2953 
$j
 = 
$m©rix2CŞumns
; $j < 
$m©rix1CŞumns
; ++$j) {

2954 
$m©rix2
[
$i
][
$j
] = 
$x
;

2958 ià(
$m©rix2Rows
 < 
$m©rix1Rows
) {

2959 
$x
 = 
$m©rix2
[
$m©rix2Rows
-1];

2960 
$i
 = 0; $˜< 
$m©rix1Rows
; ++$i) {

2961 
$m©rix2
[
$i
] = 
$x
;

2966 ià((
$m©rix1CŞumns
 < 
$m©rix2CŞumns
è|| (
$m©rix1Rows
 < 
$m©rix2Rows
)) {

2967 ià(
$m©rix1CŞumns
 < 
$m©rix2CŞumns
) {

2968 
$i
 = 0; $˜< 
$m©rix1Rows
; ++$i) {

2969 
$x
 = 
$m©rix1
[
$i
][
$m©rix1CŞumns
-1];

2970 
$j
 = 
$m©rix1CŞumns
; $j < 
$m©rix2CŞumns
; ++$j) {

2971 
$m©rix1
[
$i
][
$j
] = 
$x
;

2975 ià(
$m©rix1Rows
 < 
$m©rix2Rows
) {

2976 
$x
 = 
$m©rix1
[
$m©rix1Rows
-1];

2977 
$i
 = 0; $˜< 
$m©rix2Rows
; ++$i) {

2978 
$m©rix1
[
$i
] = 
$x
;

2982 
	}
}

2991 
´iv©e
 
funùiÚ
 
	$showV®ue
(
$v®ue
)

2993 ià(
$this
->
_debugLog
->
	`g‘Wr™eDebugLog
()) {

2994 
$‹¡A¼ay
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$v®ue
);

2995 ià(
	`couÁ
(
$‹¡A¼ay
) == 1) {

2996 
$v®ue
 = 
	`¬¿y_pİ
(
$‹¡A¼ay
);

2999 ià(
	`is_¬¿y
(
$v®ue
)) {

3000 
$»tuºM©rix
 = 
	`¬¿y
();

3001 
$·d
 = 
$½ad
 = ', ';

3002 
	`fÜ—ch
 (
$v®ue
 
as
 
$row
) {

3003 ià(
	`is_¬¿y
(
$row
)) {

3004 
$»tuºM©rix
[] = 
	`im¶ode
(
$·d
, 
	`¬¿y_m­
(
	`¬¿y
(
$this
, 'showV®ue'), 
$row
));

3005 
$½ad
 = '; ';

3007 
$»tuºM©rix
[] = 
$this
->
	`showV®ue
(
$row
);

3010  '{ '.
	`im¶ode
(
$½ad
, 
$»tuºM©rix
).' }';

3011 } 
	`–£if
 (
	`is_¡ršg
(
$v®ue
è&& (
	`Œim
($value, '"') == $value)) {

3012  '"'.
$v®ue
.'"';

3013 } 
	`–£if
 (
	`is_boŞ
(
$v®ue
)) {

3014  (
$v®ue
è? 
£lf
::
$loÿËBoŞ—n
['TRUE'] : self::$localeBoolean['FALSE'];

3017  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
(
$v®ue
);

3018 
	}
}

3027 
´iv©e
 
funùiÚ
 
	$showTy³D‘as
(
$v®ue
)

3029 ià(
$this
->
_debugLog
->
	`g‘Wr™eDebugLog
()) {

3030 
$‹¡A¼ay
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$v®ue
);

3031 ià(
	`couÁ
(
$‹¡A¼ay
) == 1) {

3032 
$v®ue
 = 
	`¬¿y_pİ
(
$‹¡A¼ay
);

3035 ià(
$v®ue
 ==ğ
nuÎ
) {

3037 } 
	`–£if
 (
	`is_æßt
(
$v®ue
)) {

3038 
$ty³SŒšg
 = 'a floating…oint‚umber';

3039 } 
	`–£if
 (
	`is_št
(
$v®ue
)) {

3040 
$ty³SŒšg
 = 'an integer‚umber';

3041 } 
	`–£if
 (
	`is_boŞ
(
$v®ue
)) {

3042 
$ty³SŒšg
 = 'a boolean';

3043 } 
	`–£if
 (
	`is_¬¿y
(
$v®ue
)) {

3044 
$ty³SŒšg
 = 'a matrix';

3046 ià(
$v®ue
 == '') {

3048 } 
	`–£if
 (
$v®ue
{0} == '#') {

3049  '¨'.
$v®ue
.'ƒrror';

3051 
$ty³SŒšg
 = 'a string';

3054  
$ty³SŒšg
.' w™h‡ v®uoà'.
$this
->
	`showV®ue
(
$v®ue
);

3056 
	}
}

3059 
´iv©e
 
funùiÚ
 
	$cÚv”tM©rixReã»nûs
(
$fÜmuÏ
)

3061 
$m©rixR•ÏûFrom
 = 
	`¬¿y
('{', ';', '}');

3062 
$m©rixR•ÏûTo
 = 
	`¬¿y
('MKMATRIX(MKMATRIX(', '),MKMATRIX(', '))');

3065 ià(
	`¡½os
(
$fÜmuÏ
, '{'è!=ğ
çl£
) {

3067 ià(
	`¡½os
(
$fÜmuÏ
, '"'è!=ğ
çl£
) {

3070 
$‹mp
 = 
	`ex¶ode
('"', 
$fÜmuÏ
);

3072 
$İ’CouÁ
 = 
$şo£CouÁ
 = 0;

3073 
$i
 = 
çl£
;

3074 
	`fÜ—ch
 (
$‹mp
 
as
 &
$v®ue
) {

3076 ià(
$i
 = !$i) {

3077 
$İ’CouÁ
 +ğ
	`sub¡r_couÁ
(
$v®ue
, '{');

3078 
$şo£CouÁ
 +ğ
	`sub¡r_couÁ
(
$v®ue
, '}');

3079 
$v®ue
 = 
	`¡r_»¶aû
(
$m©rixR•ÏûFrom
, 
$m©rixR•ÏûTo
, $value);

3082 
	`un£t
(
$v®ue
);

3084 
$fÜmuÏ
 = 
	`im¶ode
('"', 
$‹mp
);

3087 
$İ’CouÁ
 = 
	`sub¡r_couÁ
(
$fÜmuÏ
, '{');

3088 
$şo£CouÁ
 = 
	`sub¡r_couÁ
(
$fÜmuÏ
, '}');

3089 
$fÜmuÏ
 = 
	`¡r_»¶aû
(
$m©rixR•ÏûFrom
, 
$m©rixR•ÏûTo
, $formula);

3092 ià(
$İ’CouÁ
 < 
$şo£CouÁ
) {

3093 ià(
$İ’CouÁ
 > 0) {

3094  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Mismatched matrix braces '}'");

3096  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Unexpected '}'ƒncountered");

3098 } 
	`–£if
 (
$İ’CouÁ
 > 
$şo£CouÁ
) {

3099 ià(
$şo£CouÁ
 > 0) {

3100  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Mismatched matrix braces '{'");

3102  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Unexpected '{'ƒncountered");

3107  
$fÜmuÏ
;

3108 
	}
}

3111 
´iv©e
 
funùiÚ
 
	$mkM©rix
()

3113  
	`func_g‘_¬gs
();

3114 
	}
}

3120 
´iv©e
 
	g$İ”©ÜAssocŸtiv™y
 = 
¬¿y
(

3131 
´iv©e
 
	g$com·risÚO³¿tÜs
 = 
¬¿y
('>' => 
Œue
, '<' =>rue, '=' =>rue, '>=' =>rue, '<=' =>rue, '<>' =>rue);

3136 
´iv©e
 
	g$İ”©ÜP»ûd’û
 = 
¬¿y
(

3149 
´iv©e
 
funùiÚ
 
	$_·r£FÜmuÏ
(
$fÜmuÏ
, 
PHPExûl_C–l
 
$pC–l
 = 
nuÎ
)

3151 ià((
$fÜmuÏ
 = 
$this
->
	`cÚv”tM©rixReã»nûs
(
	`Œim
($fÜmuÏ))è==ğ
çl£
) {

3152  
çl£
;

3157 
$pC–lP¬’t
 = (
$pC–l
 !=ğ
nuÎ
è? $pC–l->
	`g‘WÜksh“t
() :‚ull;

3159 
$»gexpM©chSŒšg
 = '/^('.
£lf
::
CALCULATION_REGEXP_FUNCTION
.

3160 '|'.
£lf
::
CALCULATION_REGEXP_CELLREF
.

3161 '|'.
£lf
::
CALCULATION_REGEXP_NUMBER
.

3162 '|'.
£lf
::
CALCULATION_REGEXP_STRING
.

3163 '|'.
£lf
::
CALCULATION_REGEXP_OPENBRACE
.

3164 '|'.
£lf
::
CALCULATION_REGEXP_NAMEDRANGE
.

3165 '|'.
£lf
::
CALCULATION_REGEXP_ERROR
.

3169 
$šdex
 = 0;

3170 
$¡ack
 = 
Ãw
 
PHPExûl_C®cuÏtiÚ_Tok’_Sck
;

3171 
$ouut
 = 
	`¬¿y
();

3172 
$ex³ùšgO³¿tÜ
 = 
çl£
;

3174 
$ex³ùšgO³¿nd
 = 
çl£
;

3178 
Œue
) {

3180 
$İCh¬aù”
 = 
$fÜmuÏ
{
$šdex
};

3182 ià((
	`is£t
(
£lf
::
$com·risÚO³¿tÜs
[
$İCh¬aù”
])è&& (
	`¡¾’
(
$fÜmuÏ
è> 
$šdex
) && (isset(self::$comparisonOperators[$formula{$index+1}]))) {

3183 
$İCh¬aù”
 .ğ
$fÜmuÏ
{++
$šdex
};

3188 
$isO³¿ndOrFunùiÚ
 = 
	`´eg_m©ch
(
$»gexpM©chSŒšg
, 
	`sub¡r
(
$fÜmuÏ
, 
$šdex
), 
$m©ch
);

3192 ià(
$İCh¬aù”
 =ğ'-' && !
$ex³ùšgO³¿tÜ
) {

3194 
$¡ack
->
	`push
('Unary Operator', '~');

3195 ++
$šdex
;

3196 } 
	`–£if
 (
$İCh¬aù”
 =ğ'%' && 
$ex³ùšgO³¿tÜ
) {

3198 
$¡ack
->
	`push
('Unary Operator', '%');

3199 ++
$šdex
;

3200 } 
	`–£if
 (
$İCh¬aù”
 =ğ'+' && !
$ex³ùšgO³¿tÜ
) {

3202 ++
$šdex
;

3203 } 
	`–£if
 (((
$İCh¬aù”
 =ğ'~'è|| ($İCh¬aù” =ğ'|')è&& (!
$isO³¿ndOrFunùiÚ
)) {

3204  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Illegal character '~'");

3206 } 
	`–£if
 ((
	`is£t
(
£lf
::
$İ”©Üs
[
$İCh¬aù”
]è
Ü
 
$isO³¿ndOrFunùiÚ
è&& 
$ex³ùšgO³¿tÜ
) {

3208 
$¡ack
->
	`couÁ
() > 0 &&

3209 (
$o2
 = 
$¡ack
->
	`Ï¡
()) &&

3210 
	`is£t
(
£lf
::
$İ”©Üs
[
$o2
['value']]) &&

3211 @(
£lf
::
$İ”©ÜAssocŸtiv™y
[
$İCh¬aù”
] ? s–f::
$İ”©ÜP»ûd’û
[$İCh¬aù”] < s–f::$İ”©ÜP»ûd’û[
$o2
['value']] : self::$operatorPrecedence[$opCharacter] <= self::$operatorPrecedence[$o2['value']])) {

3212 
$ouut
[] = 
$¡ack
->
	`pİ
();

3214 
$¡ack
->
	`push
('Bš¬y O³¿tÜ', 
$İCh¬aù”
);

3215 ++
$šdex
;

3216 
$ex³ùšgO³¿tÜ
 = 
çl£
;

3218 } 
	`–£if
 (
$İCh¬aù”
 =ğ')' && 
$ex³ùšgO³¿tÜ
) {

3220 
$ex³ùšgO³¿nd
 = 
çl£
;

3221 (
$o2
 = 
$¡ack
->
	`pİ
()) && $o2['value'] != '(') {

3222 ià(
$o2
 ==ğ
nuÎ
) {

3223  
$this
->
	`¿i£FÜmuÏE¼Ü
('Formula Error: Unexpected closing brace ")"');

3225 
$ouut
[] = 
$o2
;

3228 
$d
 = 
$¡ack
->
	`Ï¡
(2);

3229 ià(
	`´eg_m©ch
('/^'.
£lf
::
CALCULATION_REGEXP_FUNCTION
.'$/i', 
$d
['v®ue'], 
$m©ches
)) {

3230 
$funùiÚName
 = 
$m©ches
[1];

3232 
$d
 = 
$¡ack
->
	`pİ
();

3233 
$¬gum’tCouÁ
 = 
$d
['value'];

3241 
$ouut
[] = 
$d
;

3242 
$ouut
[] = 
$¡ack
->
	`pİ
();

3243 ià(
	`is£t
(
£lf
::
$cÚŒŞFunùiÚs
[
$funùiÚName
])) {

3245 
$ex³ùedArgum’tCouÁ
 = 
£lf
::
$cÚŒŞFunùiÚs
[
$funùiÚName
]['argumentCount'];

3246 
$funùiÚC®l
 = 
£lf
::
$cÚŒŞFunùiÚs
[
$funùiÚName
]['functionCall'];

3247 } 
	`–£if
 (
	`is£t
(
£lf
::
$PHPExûlFunùiÚs
[
$funùiÚName
])) {

3249 
$ex³ùedArgum’tCouÁ
 = 
£lf
::
$PHPExûlFunùiÚs
[
$funùiÚName
]['argumentCount'];

3250 
$funùiÚC®l
 = 
£lf
::
$PHPExûlFunùiÚs
[
$funùiÚName
]['functionCall'];

3252  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Internalƒrror,‚on-function on stack");

3255 
$¬gum’tCouÁE¼Ü
 = 
çl£
;

3256 ià(
	`is_num”ic
(
$ex³ùedArgum’tCouÁ
)) {

3257 ià(
$ex³ùedArgum’tCouÁ
 < 0) {

3259 ià(
$¬gum’tCouÁ
 > 
	`abs
(
$ex³ùedArgum’tCouÁ
)) {

3260 
$¬gum’tCouÁE¼Ü
 = 
Œue
;

3261 
$ex³ùedArgum’tCouÁSŒšg
 = 'nØmÜthª '.
	`abs
(
$ex³ùedArgum’tCouÁ
);

3265 ià(
$¬gum’tCouÁ
 !ğ
$ex³ùedArgum’tCouÁ
) {

3266 
$¬gum’tCouÁE¼Ü
 = 
Œue
;

3267 
$ex³ùedArgum’tCouÁSŒšg
 = 
$ex³ùedArgum’tCouÁ
;

3270 } 
	`–£if
 (
$ex³ùedArgum’tCouÁ
 != '*') {

3271 
$isO³¿ndOrFunùiÚ
 = 
	`´eg_m©ch
('/(\d*)([-+,])(\d*)/', 
$ex³ùedArgum’tCouÁ
, 
$¬gM©ch
);

3274 
$¬gM©ch
[2]) {

3276 ià(
$¬gum’tCouÁ
 < 
$¬gM©ch
[1]) {

3277 
$¬gum’tCouÁE¼Ü
 = 
Œue
;

3278 
$ex³ùedArgum’tCouÁSŒšg
 = 
$¬gM©ch
[1].' or more ';

3282 ià((
$¬gum’tCouÁ
 < 
$¬gM©ch
[1]) || ($argumentCount > $argMatch[3])) {

3283 
$¬gum’tCouÁE¼Ü
 = 
Œue
;

3284 
$ex³ùedArgum’tCouÁSŒšg
 = 'b‘w“À'.
$¬gM©ch
[1].'‡nd '.$argMatch[3];

3288 ià((
$¬gum’tCouÁ
 !ğ
$¬gM©ch
[1]) && ($argumentCount != $argMatch[3])) {

3289 
$¬gum’tCouÁE¼Ü
 = 
Œue
;

3290 
$ex³ùedArgum’tCouÁSŒšg
 = 'e™h” '.
$¬gM©ch
[1].' or '.$argMatch[3];

3295 ià(
$¬gum’tCouÁE¼Ü
) {

3296  
$this
->
	`¿i£FÜmuÏE¼Ü
("FÜmuÏ E¼Ü: WrÚg‚umb” oà¬gum’t fÜ $funùiÚName(èfunùiÚ: $¬gum’tCouÁ giv’, ".
$ex³ùedArgum’tCouÁSŒšg
."ƒxpected");

3299 ++
$šdex
;

3301 } 
	`–£if
 (
$İCh¬aù”
 == ',') {

3303 (
$o2
 = 
$¡ack
->
	`pİ
()) && $o2['value'] != '(') {

3304 ià(
$o2
 ==ğ
nuÎ
) {

3305  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Unexpected ,");

3307 
$ouut
[] = 
$o2
;

3312 ià((
$ex³ùšgO³¿nd
è|| (!
$ex³ùšgO³¿tÜ
)) {

3313 
$ouut
[] = 
	`¬¿y
('ty³' => 'NULL V®ue', 'v®ue' => 
£lf
::
$exûlCÚ¡ªts
['NULL'], '»ã»nû' => 
nuÎ
);

3316 
$d
 = 
$¡ack
->
	`Ï¡
(2);

3317 ià(!
	`´eg_m©ch
('/^'.
£lf
::
CALCULATION_REGEXP_FUNCTION
.'$/i', 
$d
['v®ue'], 
$m©ches
)) {

3318  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Unexpected ,");

3320 
$d
 = 
$¡ack
->
	`pİ
();

3321 
$¡ack
->
	`push
(
$d
['type'], ++$d['value'], $d['reference']);

3322 
$¡ack
->
	`push
('Brace', '(');

3323 
$ex³ùšgO³¿tÜ
 = 
çl£
;

3324 
$ex³ùšgO³¿nd
 = 
Œue
;

3325 ++
$šdex
;

3327 } 
	`–£if
 (
$İCh¬aù”
 =ğ'(' && !
$ex³ùšgO³¿tÜ
) {

3329 
$¡ack
->
	`push
('Brace', '(');

3330 ++
$šdex
;

3332 } 
	`–£if
 (
$isO³¿ndOrFunùiÚ
 && !
$ex³ùšgO³¿tÜ
) {

3333 
$ex³ùšgO³¿tÜ
 = 
Œue
;

3334 
$ex³ùšgO³¿nd
 = 
çl£
;

3335 
$v®
 = 
$m©ch
[1];

3336 
$Ëngth
 = 
	`¡¾’
(
$v®
);

3339 ià(
	`´eg_m©ch
('/^'.
£lf
::
CALCULATION_REGEXP_FUNCTION
.'$/i', 
$v®
, 
$m©ches
)) {

3340 
$v®
 = 
	`´eg_»¶aû
('/\s/u', '', $val);

3342 ià(
	`is£t
(
£lf
::
$PHPExûlFunùiÚs
[
	`¡¹ouµ”
(
$m©ches
[1])]è|| is£t(£lf::
$cÚŒŞFunùiÚs
[strtoupper($matches[1])])) {

3343 
$¡ack
->
	`push
('FunùiÚ', 
	`¡¹ouµ”
(
$v®
));

3344 
$ax
 = 
	`´eg_m©ch
('/^\s*(\s*\))/ui', 
	`sub¡r
(
$fÜmuÏ
, 
$šdex
+
$Ëngth
), 
$am©ch
);

3345 ià(
$ax
) {

3346 
$¡ack
->
	`push
('O³¿nd CouÁ fÜ FunùiÚ '.
	`¡¹ouµ”
(
$v®
).')', 0);

3347 
$ex³ùšgO³¿tÜ
 = 
Œue
;

3349 
$¡ack
->
	`push
('O³¿nd CouÁ fÜ FunùiÚ '.
	`¡¹ouµ”
(
$v®
).')', 1);

3350 
$ex³ùšgO³¿tÜ
 = 
çl£
;

3352 
$¡ack
->
	`push
('Brace', '(');

3354 
$ouut
[] = 
	`¬¿y
('ty³' => 'V®ue', 'v®ue' => 
$m©ches
[1], '»ã»nû' => 
nuÎ
);

3356 } 
	`–£if
 (
	`´eg_m©ch
('/^'.
£lf
::
CALCULATION_REGEXP_CELLREF
.'$/i', 
$v®
, 
$m©ches
)) {

3362 
$‹¡P»vOp
 = 
$¡ack
->
	`Ï¡
(1);

3363 ià(
$‹¡P»vOp
['value'] == ':') {

3365 ià(
$m©ches
[2] == '') {

3368 
$¡¬tC–lRef
 = 
$ouut
[
	`couÁ
($output)-1]['value'];

3369 
	`´eg_m©ch
('/^'.
£lf
::
CALCULATION_REGEXP_CELLREF
.'$/i', 
$¡¬tC–lRef
, 
$¡¬tM©ches
);

3370 ià(
$¡¬tM©ches
[2] > '') {

3371 
$v®
 = 
$¡¬tM©ches
[2].'!'.$val;

3374  
$this
->
	`¿i£FÜmuÏE¼Ü
("3D Range„eferences‡re‚ot yet supported");

3378 
$ouut
[] = 
	`¬¿y
('ty³' => 'C–ÈReã»nû', 'v®ue' => 
$v®
, 'reference' => $val);

3383 
$‹¡P»vOp
 = 
$¡ack
->
	`Ï¡
(1);

3384 ià(
$‹¡P»vOp
['value'] == ':') {

3385 
$¡¬tRowCŞRef
 = 
$ouut
[
	`couÁ
($output)-1]['value'];

3386 
$¿ngeWS1
 = '';

3387 ià(
	`¡½os
('!', 
$¡¬tRowCŞRef
è!=ğ
çl£
) {

3388 
	`li¡
(
$¿ngeWS1
, 
$¡¬tRowCŞRef
èğ
	`ex¶ode
('!', $startRowColRef);

3390 ià(
$¿ngeWS1
 != '') {

3391 
$¿ngeWS1
 .= '!';

3393 
$¿ngeWS2
 = 
$¿ngeWS1
;

3394 ià(
	`¡½os
('!', 
$v®
è!=ğ
çl£
) {

3395 
	`li¡
(
$¿ngeWS2
, 
$v®
èğ
	`ex¶ode
('!', $val);

3397 ià(
$¿ngeWS2
 != '') {

3398 
$¿ngeWS2
 .= '!';

3400 ià((
	`is_š‹g”
(
$¡¬tRowCŞRef
)è&& (
	`ùy³_dig™
(
$v®
)) &&

3401 (
$¡¬tRowCŞRef
 <ğ1048576è&& (
$v®
 <= 1048576)) {

3403 
$’dRowCŞRef
 = (
$pC–lP¬’t
 !=ğ
nuÎ
è? $pC–lP¬’t->
	`g‘Highe¡CŞumn
() : 'XFD';

3404 
$ouut
[
	`couÁ
($ouut)-1]['v®ue'] = 
$¿ngeWS1
.'A'.
$¡¬tRowCŞRef
;

3405 
$v®
 = 
$¿ngeWS2
.
$’dRowCŞRef
.$val;

3406 } 
	`–£if
 ((
	`ùy³_®pha
(
$¡¬tRowCŞRef
)è&& (ùy³_®pha(
$v®
)) &&

3407 (
	`¡¾’
(
$¡¬tRowCŞRef
è<ğ3è&& (¡¾’(
$v®
) <= 3)) {

3409 
$’dRowCŞRef
 = (
$pC–lP¬’t
 !=ğ
nuÎ
è? $pC–lP¬’t->
	`g‘Highe¡Row
() : 1048576;

3410 
$ouut
[
	`couÁ
($ouut)-1]['v®ue'] = 
$¿ngeWS1
.
	`¡¹ouµ”
(
$¡¬tRowCŞRef
).'1';

3411 
$v®
 = 
$¿ngeWS2
.$v®.
$’dRowCŞRef
;

3415 
$loÿËCÚ¡ªt
 = 
çl£
;

3416 ià(
$İCh¬aù”
 == '"') {

3419 
$v®
 = 
£lf
::
	`w¿pResuÉ
(
	`¡r_»¶aû
('""', '"', s–f::
	`unw¿pResuÉ
($val)));

3420 } 
	`–£if
 (
	`is_num”ic
(
$v®
)) {

3422 ià((
	`¡½os
(
$v®
, '.'è!=ğ
çl£
è|| (
	`¡ros
($v®, 'e'è!=ğçl£è|| ($v® > 
PHP_INT_MAX
) || ($val < -PHP_INT_MAX)) {

3424 
$v®
 = () $val;

3427 
$v®
 = (
š‹g”
) $val;

3429 } 
	`–£if
 (
	`is£t
(
£lf
::
$exûlCÚ¡ªts
[
	`Œim
(
	`¡¹ouµ”
(
$v®
))])) {

3430 
$exûlCÚ¡ªt
 = 
	`Œim
(
	`¡¹ouµ”
(
$v®
));

3432 
$v®
 = 
£lf
::
$exûlCÚ¡ªts
[
$exûlCÚ¡ªt
];

3433 } 
	`–£if
 ((
$loÿËCÚ¡ªt
 = 
	`¬¿y_£¬ch
(
	`Œim
(
	`¡¹ouµ”
(
$v®
)), 
£lf
::
$loÿËBoŞ—n
)è!=ğ
çl£
) {

3435 
$v®
 = 
£lf
::
$exûlCÚ¡ªts
[
$loÿËCÚ¡ªt
];

3437 
$d‘as
 = 
	`¬¿y
('ty³' => 'V®ue', 'v®ue' => 
$v®
, '»ã»nû' => 
nuÎ
);

3438 ià(
$loÿËCÚ¡ªt
) {

3439 
$d‘as
['loÿËV®ue'] = 
$loÿËCÚ¡ªt
;

3441 
$ouut
[] = 
$d‘as
;

3443 
$šdex
 +ğ
$Ëngth
;

3445 } 
	`–£if
 (
$İCh¬aù”
 == '$') {

3446 ++
$šdex
;

3447 } 
	`–£if
 (
$İCh¬aù”
 == ')') {

3448 ià(
$ex³ùšgO³¿nd
) {

3449 
$ouut
[] = 
	`¬¿y
('ty³' => 'NULL V®ue', 'v®ue' => 
£lf
::
$exûlCÚ¡ªts
['NULL'], '»ã»nû' => 
nuÎ
);

3450 
$ex³ùšgO³¿nd
 = 
çl£
;

3451 
$ex³ùšgO³¿tÜ
 = 
Œue
;

3453  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Unexpected ')'");

3455 } 
	`–£if
 (
	`is£t
(
£lf
::
$İ”©Üs
[
$İCh¬aù”
]è&& !
$ex³ùšgO³¿tÜ
) {

3456  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Unexpected operator '$opCharacter'");

3458  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: An unexpectedƒrror occured");

3461 ià(
$šdex
 =ğ
	`¡¾’
(
$fÜmuÏ
)) {

3464 ià((
	`is£t
(
£lf
::
$İ”©Üs
[
$İCh¬aù”
])) && ($opCharacter != '%')) {

3465  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Operator '$opCharacter' has‚o operands");

3471 (
$fÜmuÏ
{
$šdex
} == "\n") || ($formula{$index} == "\r")) {

3472 ++
$šdex
;

3474 ià(
$fÜmuÏ
{
$šdex
} == ' ') {

3475 
$fÜmuÏ
{
$šdex
} == ' ') {

3476 ++
$šdex
;

3481 ià((
$ex³ùšgO³¿tÜ
è&& (
	`´eg_m©ch
('/^'.
£lf
::
CALCULATION_REGEXP_CELLREF
.'.*/Ui', 
	`sub¡r
(
$fÜmuÏ
, 
$šdex
), 
$m©ch
)) &&

3482 (
$ouut
[
	`couÁ
($output)-1]['type'] == 'Cell Reference')) {

3484 
$¡ack
->
	`couÁ
() > 0 &&

3485 (
$o2
 = 
$¡ack
->
	`Ï¡
()) &&

3486 
	`is£t
(
£lf
::
$İ”©Üs
[
$o2
['value']]) &&

3487 @(
£lf
::
$İ”©ÜAssocŸtiv™y
[
$İCh¬aù”
] ? s–f::
$İ”©ÜP»ûd’û
[$İCh¬aù”] < s–f::$İ”©ÜP»ûd’û[
$o2
['value']] : self::$operatorPrecedence[$opCharacter] <= self::$operatorPrecedence[$o2['value']])) {

3488 
$ouut
[] = 
$¡ack
->
	`pİ
();

3490 
$¡ack
->
	`push
('Binary Operator', '|');

3491 
$ex³ùšgO³¿tÜ
 = 
çl£
;

3496 (
$İ
 = 
$¡ack
->
	`pİ
()è!=ğ
nuÎ
) {

3497 ià((
	`is_¬¿y
(
$İ
) && $op['value'] == '(') || ($op === '(')) {

3498  
$this
->
	`¿i£FÜmuÏE¼Ü
("Formula Error: Expecting ')'");

3500 
$ouut
[] = 
$İ
;

3502  
$ouut
;

3503 
	}
}

3506 
´iv©e
 
funùiÚ
 
	$d©aTe¡Reã»nû
(&
$İ”ªdD©a
)

3508 
$İ”ªd
 = 
$İ”ªdD©a
['value'];

3509 ià((
$İ”ªdD©a
['»ã»nû'] ==ğ
nuÎ
è&& (
	`is_¬¿y
(
$İ”ªd
))) {

3510 
$rKeys
 = 
	`¬¿y_keys
(
$İ”ªd
);

3511 
$rowKey
 = 
	`¬¿y_shiá
(
$rKeys
);

3512 
$cKeys
 = 
	`¬¿y_keys
×¼ay_keys(
$İ”ªd
[
$rowKey
]));

3513 
$cŞKey
 = 
	`¬¿y_shiá
(
$cKeys
);

3514 ià(
	`ùy³_uµ”
(
$cŞKey
)) {

3515 
$İ”ªdD©a
['»ã»nû'] = 
$cŞKey
.
$rowKey
;

3518  
$İ”ªd
;

3519 
	}
}

3522 
´iv©e
 
funùiÚ
 
	$´oûssTok’Sck
(
$tok’s
, 
$ûÎID
 = 
nuÎ
, 
PHPExûl_C–l
 
$pC–l
 =‚ull)

3524 ià(
$tok’s
 =ğ
çl£
) {

3525  
çl£
;

3530 
$pC–lWÜksh“t
 = (
$pC–l
 !=ğ
nuÎ
è? $pC–l->
	`g‘WÜksh“t
() :‚ull;

3531 
$pC–lP¬’t
 = (
$pC–l
 !=ğ
nuÎ
è? $pC–l->
	`g‘P¬’t
() :‚ull;

3532 
$¡ack
 = 
Ãw
 
PHPExûl_C®cuÏtiÚ_Tok’_Sck
;

3535 
	`fÜ—ch
 (
$tok’s
 
as
 
$tok’D©a
) {

3538 
$tok’
 = 
$tok’D©a
['value'];

3541 ià(
	`is£t
(
£lf
::
$bš¬yO³¿tÜs
[
$tok’
])) {

3544 ià((
$İ”ªd2D©a
 = 
$¡ack
->
	`pİ
()è==ğ
nuÎ
) {

3545  
$this
->
	`¿i£FÜmuÏE¼Ü
('Internalƒrror - Operand value missing from stack');

3547 ià((
$İ”ªd1D©a
 = 
$¡ack
->
	`pİ
()è==ğ
nuÎ
) {

3548  
$this
->
	`¿i£FÜmuÏE¼Ü
('Internalƒrror - Operand value missing from stack');

3551 
$İ”ªd1
 = 
£lf
::
	`d©aTe¡Reã»nû
(
$İ”ªd1D©a
);

3552 
$İ”ªd2
 = 
£lf
::
	`d©aTe¡Reã»nû
(
$İ”ªd2D©a
);

3555 ià(
$tok’
 == ':') {

3556 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg Rªg', $this->
	`showV®ue
(
$İ”ªd1D©a
['»ã»nû']), ' ', 
$tok’
, ' ', $this->showV®ue(
$İ”ªd2D©a
['reference']));

3558 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg ', $this->
	`showV®ue
(
$İ”ªd1
), ' ', 
$tok’
, ' ', $this->showV®ue(
$İ”ªd2
));

3562 
$tok’
) {

3570 
$this
->
	`execu‹Bš¬yCom·risÚO³¿tiÚ
(
$ûÎID
, 
$İ”ªd1
, 
$İ”ªd2
, 
$tok’
, 
$¡ack
);

3574 
$sh“t1
 = 
$sh“t2
 = '';

3575 ià(
	`¡½os
(
$İ”ªd1D©a
['»ã»nû'], '!'è!=ğ
çl£
) {

3576 
	`li¡
(
$sh“t1
, 
$İ”ªd1D©a
['»ã»nû']èğ
	`ex¶ode
('!', $operand1Data['reference']);

3578 
$sh“t1
 = (
$pC–lP¬’t
 !=ğ
nuÎ
è? 
$pC–lWÜksh“t
->
	`g‘T™Ë
() : '';

3580 ià(
	`¡½os
(
$İ”ªd2D©a
['»ã»nû'], '!'è!=ğ
çl£
) {

3581 
	`li¡
(
$sh“t2
, 
$İ”ªd2D©a
['»ã»nû']èğ
	`ex¶ode
('!', $operand2Data['reference']);

3583 
$sh“t2
 = 
$sh“t1
;

3585 ià(
$sh“t1
 =ğ
$sh“t2
) {

3586 ià(
$İ”ªd1D©a
['»ã»nû'] ==ğ
nuÎ
) {

3587 ià((
	`Œim
(
$İ”ªd1D©a
['v®ue']è!ğ''è&& (
	`is_num”ic
($operand1Data['value']))) {

3588 
$İ”ªd1D©a
['»ã»nû'] = 
$pC–l
->
	`g‘CŞumn
().$operand1Data['value'];

3589 } 
	`–£if
 (
	`Œim
(
$İ”ªd1D©a
['reference']) == '') {

3590 
$İ”ªd1D©a
['»ã»nû'] = 
$pC–l
->
	`g‘CoÜdš©e
();

3592 
$İ”ªd1D©a
['»ã»nû'] = $İ”ªd1D©a['v®ue'].
$pC–l
->
	`g‘Row
();

3595 ià(
$İ”ªd2D©a
['»ã»nû'] ==ğ
nuÎ
) {

3596 ià((
	`Œim
(
$İ”ªd2D©a
['v®ue']è!ğ''è&& (
	`is_num”ic
($operand2Data['value']))) {

3597 
$İ”ªd2D©a
['»ã»nû'] = 
$pC–l
->
	`g‘CŞumn
().$operand2Data['value'];

3598 } 
	`–£if
 (
	`Œim
(
$İ”ªd2D©a
['reference']) == '') {

3599 
$İ”ªd2D©a
['»ã»nû'] = 
$pC–l
->
	`g‘CoÜdš©e
();

3601 
$İ”ªd2D©a
['»ã»nû'] = $İ”ªd2D©a['v®ue'].
$pC–l
->
	`g‘Row
();

3605 
$oD©a
 = 
	`¬¿y_m”ge
(
	`ex¶ode
(':', 
$İ”ªd1D©a
['»ã»nû']),ƒx¶ode(':', 
$İ”ªd2D©a
['reference']));

3606 
$oCŞ
 = 
$oRow
 = 
	`¬¿y
();

3607 
	`fÜ—ch
 (
$oD©a
 
as
 
$oD©um
) {

3608 
$oCR
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$oD©um
);

3609 
$oCŞ
[] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$oCR
[0]) - 1;

3610 
$oRow
[] = 
$oCR
[1];

3612 
$ûÎRef
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
	`mš
(
$oCŞ
)).mš(
$oRow
).':'.PHPExûl_C–l::¡ršgFromCŞumnIndex(
	`max
($oCol)).max($oRow);

3613 ià(
$pC–lP¬’t
 !=ğ
nuÎ
) {

3614 
$ûÎV®ue
 = 
$this
->
	`exŒaùC–lRªge
(
$ûÎRef
, $this->
wÜkbook
->
	`g‘Sh“tByName
(
$sh“t1
), 
çl£
);

3616  
$this
->
	`¿i£FÜmuÏE¼Ü
('Unableo‡ccess Cell Reference');

3618 
$¡ack
->
	`push
('C–ÈReã»nû', 
$ûÎV®ue
, 
$ûÎRef
);

3620 
$¡ack
->
	`push
('E¼Ü', 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
(), 
nuÎ
);

3624 
$this
->
	`execu‹Num”icBš¬yO³¿tiÚ
(
$ûÎID
, 
$İ”ªd1
, 
$İ”ªd2
, 
$tok’
, '¶usEqu®s', 
$¡ack
);

3627 
$this
->
	`execu‹Num”icBš¬yO³¿tiÚ
(
$ûÎID
, 
$İ”ªd1
, 
$İ”ªd2
, 
$tok’
, 'mšusEqu®s', 
$¡ack
);

3630 
$this
->
	`execu‹Num”icBš¬yO³¿tiÚ
(
$ûÎID
, 
$İ”ªd1
, 
$İ”ªd2
, 
$tok’
, '¬¿yTimesEqu®s', 
$¡ack
);

3633 
$this
->
	`execu‹Num”icBš¬yO³¿tiÚ
(
$ûÎID
, 
$İ”ªd1
, 
$İ”ªd2
, 
$tok’
, '¬¿yRightDivide', 
$¡ack
);

3636 
$this
->
	`execu‹Num”icBš¬yO³¿tiÚ
(
$ûÎID
, 
$İ”ªd1
, 
$İ”ªd2
, 
$tok’
, 'pow”', 
$¡ack
);

3642 ià(
	`is_boŞ
(
$İ”ªd1
)) {

3643 
$İ”ªd1
 = ($İ”ªd1è? 
£lf
::
$loÿËBoŞ—n
['TRUE'] : self::$localeBoolean['FALSE'];

3645 ià(
	`is_boŞ
(
$İ”ªd2
)) {

3646 
$İ”ªd2
 = ($İ”ªd2è? 
£lf
::
$loÿËBoŞ—n
['TRUE'] : self::$localeBoolean['FALSE'];

3648 ià((
	`is_¬¿y
(
$İ”ªd1
)è|| (is_¬¿y(
$İ”ªd2
))) {

3650 
£lf
::
	`checkM©rixO³¿nds
(
$İ”ªd1
, 
$İ”ªd2
, 2);

3651 
Œy
 {

3653 
$m©rix
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$İ”ªd1
);

3655 
$m©rixResuÉ
 = 
$m©rix
->
	`cÚÿt
(
$İ”ªd2
);

3656 
$»suÉ
 = 
$m©rixResuÉ
->
	`g‘A¼ay
();

3657 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$ex
) {

3658 
$this
->
_debugLog
->
	`wr™eDebugLog
('JAMA M©rix Exû±iÚ: ', 
$ex
->
	`g‘Mes§ge
());

3659 
$»suÉ
 = '#VALUE!';

3662 
$»suÉ
 = '"'.
	`¡r_»¶aû
('""', '"', 
£lf
::
	`unw¿pResuÉ
(
$İ”ªd1
, '"').£lf::unw¿pResuÉ(
$İ”ªd2
, '"')).'"';

3664 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ i ', $this->
	`showTy³D‘as
(
$»suÉ
));

3665 
$¡ack
->
	`push
('V®ue', 
$»suÉ
);

3668 
$rowIÁ”£ù
 = 
	`¬¿y_š‹r£ù_key
(
$İ”ªd1
, 
$İ”ªd2
);

3669 
$ûÎIÁ”£ù
 = 
$oCŞ
 = 
$oRow
 = 
	`¬¿y
();

3670 
	`fÜ—ch
 (
	`¬¿y_keys
(
$rowIÁ”£ù
è
as
 
$row
) {

3671 
$oRow
[] = 
$row
;

3672 
	`fÜ—ch
 (
$rowIÁ”£ù
[
$row
] 
as
 
$cŞ
 => 
$d©a
) {

3673 
$oCŞ
[] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞ
) - 1;

3674 
$ûÎIÁ”£ù
[
$row
] = 
	`¬¿y_š‹r£ù_key
(
$İ”ªd1
[$row], 
$İ”ªd2
[$row]);

3677 
$ûÎRef
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
	`mš
(
$oCŞ
)).mš(
$oRow
).':'.PHPExûl_C–l::¡ršgFromCŞumnIndex(
	`max
($oCol)).max($oRow);

3678 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ i ', $this->
	`showTy³D‘as
(
$ûÎIÁ”£ù
));

3679 
$¡ack
->
	`push
('V®ue', 
$ûÎIÁ”£ù
, 
$ûÎRef
);

3684 } 
	`–£if
 ((
$tok’
 === '~') || ($token === '%')) {

3686 ià((
$¬g
 = 
$¡ack
->
	`pİ
()è==ğ
nuÎ
) {

3687  
$this
->
	`¿i£FÜmuÏE¼Ü
('Internalƒrror - Operand value missing from stack');

3689 
$¬g
 = $arg['value'];

3690 ià(
$tok’
 === '~') {

3692 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg Neg©iÚ oà', $this->
	`showV®ue
(
$¬g
));

3693 
$muÉl›r
 = -1;

3696 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg P”ûÁoà', $this->
	`showV®ue
(
$¬g
));

3697 
$muÉl›r
 = 0.01;

3699 ià(
	`is_¬¿y
(
$¬g
)) {

3700 
£lf
::
	`checkM©rixO³¿nds
(
$¬g
, 
$muÉl›r
, 2);

3701 
Œy
 {

3702 
$m©rix1
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬g
);

3703 
$m©rixResuÉ
 = 
$m©rix1
->
	`¬¿yTimesEqu®s
(
$muÉl›r
);

3704 
$»suÉ
 = 
$m©rixResuÉ
->
	`g‘A¼ay
();

3705 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$ex
) {

3706 
$this
->
_debugLog
->
	`wr™eDebugLog
('JAMA M©rix Exû±iÚ: ', 
$ex
->
	`g‘Mes§ge
());

3707 
$»suÉ
 = '#VALUE!';

3709 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ i ', $this->
	`showTy³D‘as
(
$»suÉ
));

3710 
$¡ack
->
	`push
('V®ue', 
$»suÉ
);

3712 
$this
->
	`execu‹Num”icBš¬yO³¿tiÚ
(
$ûÎID
, 
$muÉl›r
, 
$¬g
, '*', '¬¿yTimesEqu®s', 
$¡ack
);

3715 } 
	`–£if
 (
	`´eg_m©ch
('/^'.
£lf
::
CALCULATION_REGEXP_CELLREF
.'$/i', 
$tok’
, 
$m©ches
)) {

3716 
$ûÎRef
 = 
nuÎ
;

3718 ià(
	`is£t
(
$m©ches
[8])) {

3720 ià(
$pC–l
 ==ğ
nuÎ
) {

3722 
$ûÎV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

3724 
$ûÎRef
 = 
$m©ches
[6].$matches[7].':'.$matches[9].$matches[10];

3725 ià(
$m©ches
[2] > '') {

3726 
$m©ches
[2] = 
	`Œim
($matches[2], "\"'");

3727 ià((
	`¡½os
(
$m©ches
[2], '['è!=ğ
çl£
) || (strpos($matches[2], ']') !== false)) {

3729  
$this
->
	`¿i£FÜmuÏE¼Ü
('Unableo‡ccess External Workbook');

3731 
$m©ches
[2] = 
	`Œim
($matches[2], "\"'");

3733 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg C–ÈRªg', 
$ûÎRef
, ' iÀwÜksh“ˆ', 
$m©ches
[2]);

3734 ià(
$pC–lP¬’t
 !=ğ
nuÎ
) {

3735 
$ûÎV®ue
 = 
$this
->
	`exŒaùC–lRªge
(
$ûÎRef
, $this->
wÜkbook
->
	`g‘Sh“tByName
(
$m©ches
[2]), 
çl£
);

3737  
$this
->
	`¿i£FÜmuÏE¼Ü
('Unableo‡ccess Cell Reference');

3739 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ fÜ c–l ', 
$ûÎRef
, ' iÀwÜksh“ˆ', 
$m©ches
[2], ' i ', $this->
	`showTy³D‘as
(
$ûÎV®ue
));

3743 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg C–ÈRªg', 
$ûÎRef
, ' in current worksheet');

3744 ià(
$pC–lP¬’t
 !=ğ
nuÎ
) {

3745 
$ûÎV®ue
 = 
$this
->
	`exŒaùC–lRªge
(
$ûÎRef
, 
$pC–lWÜksh“t
, 
çl£
);

3747  
$this
->
	`¿i£FÜmuÏE¼Ü
('Unableo‡ccess Cell Reference');

3749 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ fÜ c–l ', 
$ûÎRef
, ' i ', $this->
	`showTy³D‘as
(
$ûÎV®ue
));

3754 ià(
$pC–l
 ==ğ
nuÎ
) {

3756 
$ûÎV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

3758 
$ûÎRef
 = 
$m©ches
[6].$matches[7];

3759 ià(
$m©ches
[2] > '') {

3760 
$m©ches
[2] = 
	`Œim
($matches[2], "\"'");

3761 ià((
	`¡½os
(
$m©ches
[2], '['è!=ğ
çl£
) || (strpos($matches[2], ']') !== false)) {

3763  
$this
->
	`¿i£FÜmuÏE¼Ü
('Unableo‡ccess External Workbook');

3766 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg C–È', 
$ûÎRef
, ' iÀwÜksh“ˆ', 
$m©ches
[2]);

3767 ià(
$pC–lP¬’t
 !=ğ
nuÎ
) {

3768 
$ûÎSh“t
 = 
$this
->
wÜkbook
->
	`g‘Sh“tByName
(
$m©ches
[2]);

3769 ià(
$ûÎSh“t
 && $ûÎSh“t->
	`ûÎExi¡s
(
$ûÎRef
)) {

3770 
$ûÎV®ue
 = 
$this
->
	`exŒaùC–lRªge
(
$ûÎRef
, $this->
wÜkbook
->
	`g‘Sh“tByName
(
$m©ches
[2]), 
çl£
);

3771 
$pC–l
->
	`©ch
(
$pC–lP¬’t
);

3773 
$ûÎV®ue
 = 
nuÎ
;

3776  
$this
->
	`¿i£FÜmuÏE¼Ü
('Unableo‡ccess Cell Reference');

3778 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ fÜ c–È', 
$ûÎRef
, ' iÀwÜksh“ˆ', 
$m©ches
[2], ' i ', $this->
	`showTy³D‘as
(
$ûÎV®ue
));

3782 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg C–È', 
$ûÎRef
, ' in current worksheet');

3783 ià(
$pC–lP¬’t
->
	`isD©aS‘
(
$ûÎRef
)) {

3784 
$ûÎV®ue
 = 
$this
->
	`exŒaùC–lRªge
(
$ûÎRef
, 
$pC–lWÜksh“t
, 
çl£
);

3785 
$pC–l
->
	`©ch
(
$pC–lP¬’t
);

3787 
$ûÎV®ue
 = 
nuÎ
;

3789 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ fÜ c–È', 
$ûÎRef
, ' i ', $this->
	`showTy³D‘as
(
$ûÎV®ue
));

3793 
$¡ack
->
	`push
('V®ue', 
$ûÎV®ue
, 
$ûÎRef
);

3796 } 
	`–£if
 (
	`´eg_m©ch
('/^'.
£lf
::
CALCULATION_REGEXP_FUNCTION
.'$/i', 
$tok’
, 
$m©ches
)) {

3798 
$funùiÚName
 = 
$m©ches
[1];

3799 
$¬gCouÁ
 = 
$¡ack
->
	`pİ
();

3800 
$¬gCouÁ
 = $argCount['value'];

3801 ià(
$funùiÚName
 != 'MKMATRIX') {

3802 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg FunùiÚ ', 
£lf
::
	`loÿËFunc
(
$funùiÚName
), '(èw™h ', ((
$¬gCouÁ
 == 0) ? 'no' : $argCount), '‡rgument', (($argCount == 1) ? '' : 's'));

3804 ià((
	`is£t
(
£lf
::
$PHPExûlFunùiÚs
[
$funùiÚName
])è|| (is£t(£lf::
$cÚŒŞFunùiÚs
[$functionName]))) {

3805 ià(
	`is£t
(
£lf
::
$PHPExûlFunùiÚs
[
$funùiÚName
])) {

3806 
$funùiÚC®l
 = 
£lf
::
$PHPExûlFunùiÚs
[
$funùiÚName
]['functionCall'];

3807 
$·ssByReã»nû
 = 
	`is£t
(
£lf
::
$PHPExûlFunùiÚs
[
$funùiÚName
]['passByReference']);

3808 
$·ssC–lReã»nû
 = 
	`is£t
(
£lf
::
$PHPExûlFunùiÚs
[
$funùiÚName
]['passCellReference']);

3809 } 
	`–£if
 (
	`is£t
(
£lf
::
$cÚŒŞFunùiÚs
[
$funùiÚName
])) {

3810 
$funùiÚC®l
 = 
£lf
::
$cÚŒŞFunùiÚs
[
$funùiÚName
]['functionCall'];

3811 
$·ssByReã»nû
 = 
	`is£t
(
£lf
::
$cÚŒŞFunùiÚs
[
$funùiÚName
]['passByReference']);

3812 
$·ssC–lReã»nû
 = 
	`is£t
(
£lf
::
$cÚŒŞFunùiÚs
[
$funùiÚName
]['passCellReference']);

3816 
$¬gs
 = 
$¬gA¼ayV®s
 = 
	`¬¿y
();

3817 
$i
 = 0; $˜< 
$¬gCouÁ
; ++$i) {

3818 
$¬g
 = 
$¡ack
->
	`pİ
();

3819 
$a
 = 
$¬gCouÁ
 - 
$i
 - 1;

3820 ià((
$·ssByReã»nû
) &&

3821 (
	`is£t
(
£lf
::
$PHPExûlFunùiÚs
[
$funùiÚName
]['·ssByReã»nû'][
$a
])) &&

3822 (
£lf
::
$PHPExûlFunùiÚs
[
$funùiÚName
]['·ssByReã»nû'][
$a
])) {

3823 ià(
$¬g
['»ã»nû'] ==ğ
nuÎ
) {

3824 
$¬gs
[] = 
$ûÎID
;

3825 ià(
$funùiÚName
 != 'MKMATRIX') {

3826 
$¬gA¼ayV®s
[] = 
$this
->
	`showV®ue
(
$ûÎID
);

3829 
$¬gs
[] = 
$¬g
['reference'];

3830 ià(
$funùiÚName
 != 'MKMATRIX') {

3831 
$¬gA¼ayV®s
[] = 
$this
->
	`showV®ue
(
$¬g
['reference']);

3835 
$¬gs
[] = 
£lf
::
	`unw¿pResuÉ
(
$¬g
['value']);

3836 ià(
$funùiÚName
 != 'MKMATRIX') {

3837 
$¬gA¼ayV®s
[] = 
$this
->
	`showV®ue
(
$¬g
['value']);

3842 
	`krsÜt
(
$¬gs
);

3843 ià((
$·ssByReã»nû
è&& (
$¬gCouÁ
 == 0)) {

3844 
$¬gs
[] = 
$ûÎID
;

3845 
$¬gA¼ayV®s
[] = 
$this
->
	`showV®ue
(
$ûÎID
);

3850 ià(
$funùiÚName
 != 'MKMATRIX') {

3851 ià(
$this
->
_debugLog
->
	`g‘Wr™eDebugLog
()) {

3852 
	`krsÜt
(
$¬gA¼ayV®s
);

3853 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg ', 
£lf
::
	`loÿËFunc
(
$funùiÚName
), 'Ğ', 
	`im¶ode
(£lf::
$loÿËArgum’tS•¬©Ü
.' ', 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$¬gA¼ayV®s
)), ' )');

3880 ià(
$·ssC–lReã»nû
) {

3881 
$¬gs
[] = 
$pC–l
;

3883 ià(
	`¡½os
(
$funùiÚC®l
, '::'è!=ğ
çl£
) {

3884 
$»suÉ
 = 
	`ÿÎ_u£r_func_¬¿y
(
	`ex¶ode
('::', 
$funùiÚC®l
), 
$¬gs
);

3886 
	`fÜ—ch
 (
$¬gs
 
as
 &
$¬g
) {

3887 
$¬g
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($arg);

3889 
	`un£t
(
$¬g
);

3890 
$»suÉ
 = 
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚC®l
, 
$¬gs
);

3892 ià(
$funùiÚName
 != 'MKMATRIX') {

3893 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ fÜ ', 
£lf
::
	`loÿËFunc
(
$funùiÚName
), '(èfunùiÚ c®Èi ', $this->
	`showTy³D‘as
(
$»suÉ
));

3895 
$¡ack
->
	`push
('V®ue', 
£lf
::
	`w¿pResuÉ
(
$»suÉ
));

3900 ià(
	`is£t
(
£lf
::
$exûlCÚ¡ªts
[
	`¡¹ouµ”
(
$tok’
)])) {

3901 
$exûlCÚ¡ªt
 = 
	`¡¹ouµ”
(
$tok’
);

3903 
$¡ack
->
	`push
('CÚ¡ªˆV®ue', 
£lf
::
$exûlCÚ¡ªts
[
$exûlCÚ¡ªt
]);

3904 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg CÚ¡ªˆ', 
$exûlCÚ¡ªt
, '‡ ', $this->
	`showTy³D‘as
(
£lf
::
$exûlCÚ¡ªts
[$excelConstant]));

3905 } 
	`–£if
 ((
	`is_num”ic
(
$tok’
)è|| ($tok’ ==ğ
nuÎ
è|| (
	`is_boŞ
($token)) || ($token == '') || ($token{0} == '"') || ($token{0} == '#')) {

3907 
$¡ack
->
	`push
('V®ue', 
$tok’
);

3909 } 
	`–£if
 (
	`´eg_m©ch
('/^'.
£lf
::
CALCULATION_REGEXP_NAMEDRANGE
.'$/i', 
$tok’
, 
$m©ches
)) {

3911 
$ÇmedRªge
 = 
$m©ches
[6];

3913 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg Named Rªg', 
$ÇmedRªge
);

3914 
$ûÎV®ue
 = 
$this
->
	`exŒaùNamedRªge
(
$ÇmedRªge
, ((
nuÎ
 !=ğ
$pC–l
è? 
$pC–lWÜksh“t
 :‚uÎ), 
çl£
);

3915 
$pC–l
->
	`©ch
(
$pC–lP¬’t
);

3916 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ fÜ‚amed„ªg', 
$ÇmedRªge
, ' i ', $this->
	`showTy³D‘as
(
$ûÎV®ue
));

3917 
$¡ack
->
	`push
('Named Rªge', 
$ûÎV®ue
, 
$ÇmedRªge
);

3919  
$this
->
	`¿i£FÜmuÏE¼Ü
("undefined variable '$token'");

3924 ià(
$¡ack
->
	`couÁ
() != 1) {

3925  
$this
->
	`¿i£FÜmuÏE¼Ü
("internalƒrror");

3927 
$ouut
 = 
$¡ack
->
	`pİ
();

3928 
$ouut
 = $output['value'];

3933  
$ouut
;

3934 
	}
}

3937 
´iv©e
 
funùiÚ
 
	$v®id©eBš¬yO³¿nd
(
$ûÎID
, &
$İ”ªd
, &
$¡ack
)

3939 ià(
	`is_¬¿y
(
$İ”ªd
)) {

3940 ià((
	`couÁ
(
$İ”ªd
, 
COUNT_RECURSIVE
) - count($operand)) == 1) {

3942 
$İ”ªd
 = 
	`¬¿y_pİ
($operand);

3943 } 
	`is_¬¿y
(
$İ”ªd
));

3947 ià(
	`is_¡ršg
(
$İ”ªd
)) {

3950 ià(
$İ”ªd
 > '' && $operand{0} == '"') {

3951 
$İ”ªd
 = 
£lf
::
	`unw¿pResuÉ
($operand);

3954 ià(!
	`is_num”ic
(
$İ”ªd
)) {

3956 ià(
$İ”ªd
 > '' && $operand{0} == '#') {

3957 
$¡ack
->
	`push
('V®ue', 
$İ”ªd
);

3958 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ i ', $this->
	`showTy³D‘as
(
$İ”ªd
));

3959  
çl£
;

3960 } 
	`–£if
 (!
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$İ”ªd
)) {

3962 
$¡ack
->
	`push
('Value', '#VALUE!');

3963 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ i ¨', $this->
	`showTy³D‘as
('#VALUE!'));

3964  
çl£
;

3970  
Œue
;

3971 
	}
}

3974 
´iv©e
 
funùiÚ
 
	$execu‹Bš¬yCom·risÚO³¿tiÚ
(
$ûÎID
, 
$İ”ªd1
, 
$İ”ªd2
, 
$İ”©iÚ
, &
$¡ack
, 
$»cursšgA¼ays
 = 
çl£
)

3977 ià((
	`is_¬¿y
(
$İ”ªd1
)è|| (is_¬¿y(
$İ”ªd2
))) {

3978 
$»suÉ
 = 
	`¬¿y
();

3979 ià((
	`is_¬¿y
(
$İ”ªd1
)è&& (!is_¬¿y(
$İ”ªd2
))) {

3980 
	`fÜ—ch
 (
$İ”ªd1
 
as
 
$x
 => 
$İ”ªdD©a
) {

3981 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg Com·risÚ ', $this->
	`showV®ue
(
$İ”ªdD©a
), ' ', 
$İ”©iÚ
, ' ', $this->showV®ue(
$İ”ªd2
));

3982 
$this
->
	`execu‹Bš¬yCom·risÚO³¿tiÚ
(
$ûÎID
, 
$İ”ªdD©a
, 
$İ”ªd2
, 
$İ”©iÚ
, 
$¡ack
);

3983 
$r
 = 
$¡ack
->
	`pİ
();

3984 
$»suÉ
[
$x
] = 
$r
['value'];

3986 } 
	`–£if
 ((!
	`is_¬¿y
(
$İ”ªd1
)è&& (is_¬¿y(
$İ”ªd2
))) {

3987 
	`fÜ—ch
 (
$İ”ªd2
 
as
 
$x
 => 
$İ”ªdD©a
) {

3988 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg Com·risÚ ', $this->
	`showV®ue
(
$İ”ªd1
), ' ', 
$İ”©iÚ
, ' ', $this->showV®ue(
$İ”ªdD©a
));

3989 
$this
->
	`execu‹Bš¬yCom·risÚO³¿tiÚ
(
$ûÎID
, 
$İ”ªd1
, 
$İ”ªdD©a
, 
$İ”©iÚ
, 
$¡ack
);

3990 
$r
 = 
$¡ack
->
	`pİ
();

3991 
$»suÉ
[
$x
] = 
$r
['value'];

3994 ià(!
$»cursšgA¼ays
) {

3995 
£lf
::
	`checkM©rixO³¿nds
(
$İ”ªd1
, 
$İ”ªd2
, 2);

3997 
	`fÜ—ch
 (
$İ”ªd1
 
as
 
$x
 => 
$İ”ªdD©a
) {

3998 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©šg Com·risÚ ', $this->
	`showV®ue
(
$İ”ªdD©a
), ' ', 
$İ”©iÚ
, ' ', $this->showV®ue(
$İ”ªd2
[
$x
]));

3999 
$this
->
	`execu‹Bš¬yCom·risÚO³¿tiÚ
(
$ûÎID
, 
$İ”ªdD©a
, 
$İ”ªd2
[
$x
], 
$İ”©iÚ
, 
$¡ack
, 
Œue
);

4000 
$r
 = 
$¡ack
->
	`pİ
();

4001 
$»suÉ
[
$x
] = 
$r
['value'];

4005 
$this
->
_debugLog
->
	`wr™eDebugLog
('Com·risÚ Ev®u©iÚ ResuÉ i ', $this->
	`showTy³D‘as
(
$»suÉ
));

4007 
$¡ack
->
	`push
('A¼ay', 
$»suÉ
);

4008  
Œue
;

4012 ià(
	`is_¡ršg
(
$İ”ªd1
) && $operand1 > '' && $operand1{0} == '"') {

4013 
$İ”ªd1
 = 
£lf
::
	`unw¿pResuÉ
($operand1);

4015 ià(
	`is_¡ršg
(
$İ”ªd2
) && $operand2 > '' && $operand2{0} == '"') {

4016 
$İ”ªd2
 = 
£lf
::
	`unw¿pResuÉ
($operand2);

4020 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è!ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

4021 ià(
	`is_¡ršg
(
$İ”ªd1
)) {

4022 
$İ”ªd1
 = 
	`¡¹ouµ”
($operand1);

4024 ià(
	`is_¡ršg
(
$İ”ªd2
)) {

4025 
$İ”ªd2
 = 
	`¡¹ouµ”
($operand2);

4029 
$u£Low”ÿ£Fœ¡Com·risÚ
 = 
	`is_¡ršg
(
$İ”ªd1
è&& is_¡ršg(
$İ”ªd2
è&& 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
;

4032 
$İ”©iÚ
) {

4035 ià(
$u£Low”ÿ£Fœ¡Com·risÚ
) {

4036 
$»suÉ
 = 
$this
->
	`¡rcmpLow”ÿ£Fœ¡
(
$İ”ªd1
, 
$İ”ªd2
) > 0;

4038 
$»suÉ
 = (
$İ”ªd1
 > 
$İ”ªd2
);

4043 ià(
$u£Low”ÿ£Fœ¡Com·risÚ
) {

4044 
$»suÉ
 = 
$this
->
	`¡rcmpLow”ÿ£Fœ¡
(
$İ”ªd1
, 
$İ”ªd2
) < 0;

4046 
$»suÉ
 = (
$İ”ªd1
 < 
$İ”ªd2
);

4051 ià(
	`is_num”ic
(
$İ”ªd1
è&& is_num”ic(
$İ”ªd2
)) {

4052 
$»suÉ
 = (
	`abs
(
$İ”ªd1
 - 
$İ”ªd2
è< 
$this
->
d–
);

4054 
$»suÉ
 = 
	`¡rcmp
(
$İ”ªd1
, 
$İ”ªd2
) == 0;

4059 ià(
	`is_num”ic
(
$İ”ªd1
è&& is_num”ic(
$İ”ªd2
)) {

4060 
$»suÉ
 = ((
	`abs
(
$İ”ªd1
 - 
$İ”ªd2
è< 
$this
->
d–
) || ($operand1 > $operand2));

4061 } 
	`–£if
 (
$u£Low”ÿ£Fœ¡Com·risÚ
) {

4062 
$»suÉ
 = 
$this
->
	`¡rcmpLow”ÿ£Fœ¡
(
$İ”ªd1
, 
$İ”ªd2
) >= 0;

4064 
$»suÉ
 = 
	`¡rcmp
(
$İ”ªd1
, 
$İ”ªd2
) >= 0;

4069 ià(
	`is_num”ic
(
$İ”ªd1
è&& is_num”ic(
$İ”ªd2
)) {

4070 
$»suÉ
 = ((
	`abs
(
$İ”ªd1
 - 
$İ”ªd2
è< 
$this
->
d–
) || ($operand1 < $operand2));

4071 } 
	`–£if
 (
$u£Low”ÿ£Fœ¡Com·risÚ
) {

4072 
$»suÉ
 = 
$this
->
	`¡rcmpLow”ÿ£Fœ¡
(
$İ”ªd1
, 
$İ”ªd2
) <= 0;

4074 
$»suÉ
 = 
	`¡rcmp
(
$İ”ªd1
, 
$İ”ªd2
) <= 0;

4079 ià(
	`is_num”ic
(
$İ”ªd1
è&& is_num”ic(
$İ”ªd2
)) {

4080 
$»suÉ
 = (
	`abs
(
$İ”ªd1
 - 
$İ”ªd2
) > 1E-14);

4082 
$»suÉ
 = 
	`¡rcmp
(
$İ”ªd1
, 
$İ”ªd2
) != 0;

4088 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ i ', $this->
	`showTy³D‘as
(
$»suÉ
));

4090 
$¡ack
->
	`push
('V®ue', 
$»suÉ
);

4091  
Œue
;

4092 
	}
}

4100 
´iv©e
 
funùiÚ
 
	$¡rcmpLow”ÿ£Fœ¡
(
$¡r1
, 
$¡r2
)

4102 
$šv”£dSŒ1
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`SŒCa£Rev”£
(
$¡r1
);

4103 
$šv”£dSŒ2
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`SŒCa£Rev”£
(
$¡r2
);

4105  
	`¡rcmp
(
$šv”£dSŒ1
, 
$šv”£dSŒ2
);

4106 
	}
}

4108 
´iv©e
 
funùiÚ
 
	$execu‹Num”icBš¬yO³¿tiÚ
(
$ûÎID
, 
$İ”ªd1
, 
$İ”ªd2
, 
$İ”©iÚ
, 
$m©rixFunùiÚ
, &
$¡ack
)

4111 ià(!
$this
->
	`v®id©eBš¬yO³¿nd
(
$ûÎID
, 
$İ”ªd1
, 
$¡ack
)) {

4112  
çl£
;

4114 ià(!
$this
->
	`v®id©eBš¬yO³¿nd
(
$ûÎID
, 
$İ”ªd2
, 
$¡ack
)) {

4115  
çl£
;

4121 ià((
	`is_¬¿y
(
$İ”ªd1
)è|| (is_¬¿y(
$İ”ªd2
))) {

4123 
£lf
::
	`checkM©rixO³¿nds
(
$İ”ªd1
, 
$İ”ªd2
, 2);

4125 
Œy
 {

4127 
$m©rix
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$İ”ªd1
);

4129 
$m©rixResuÉ
 = 
$m©rix
->
	`$m©rixFunùiÚ
(
$İ”ªd2
);

4130 
$»suÉ
 = 
$m©rixResuÉ
->
	`g‘A¼ay
();

4131 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$ex
) {

4132 
$this
->
_debugLog
->
	`wr™eDebugLog
('JAMA M©rix Exû±iÚ: ', 
$ex
->
	`g‘Mes§ge
());

4133 
$»suÉ
 = '#VALUE!';

4136 ià((
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è!ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) &&

4137 ((
	`is_¡ršg
(
$İ”ªd1
è&& !
	`is_num”ic
($İ”ªd1è&& 
	`¡¾’
($operand1)>0) ||

4138 (
	`is_¡ršg
(
$İ”ªd2
è&& !
	`is_num”ic
($İ”ªd2è&& 
	`¡¾’
($operand2)>0))) {

4139 
$»suÉ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

4142 
$İ”©iÚ
) {

4145 
$»suÉ
 = 
$İ”ªd1
 + 
$İ”ªd2
;

4149 
$»suÉ
 = 
$İ”ªd1
 - 
$İ”ªd2
;

4153 
$»suÉ
 = 
$İ”ªd1
 * 
$İ”ªd2
;

4157 ià(
$İ”ªd2
 == 0) {

4159 
$¡ack
->
	`push
('Value', '#DIV/0!');

4160 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ i ', $this->
	`showTy³D‘as
('#DIV/0!'));

4161  
çl£
;

4163 
$»suÉ
 = 
$İ”ªd1
 / 
$İ”ªd2
;

4168 
$»suÉ
 = 
	`pow
(
$İ”ªd1
, 
$İ”ªd2
);

4175 
$this
->
_debugLog
->
	`wr™eDebugLog
('Ev®u©iÚ ResuÉ i ', $this->
	`showTy³D‘as
(
$»suÉ
));

4177 
$¡ack
->
	`push
('V®ue', 
$»suÉ
);

4178  
Œue
;

4179 
	}
}

4183 
´Ùeùed
 
funùiÚ
 
	$¿i£FÜmuÏE¼Ü
(
$”rÜMes§ge
)

4185 
$this
->
fÜmuÏE¼Ü
 = 
$”rÜMes§ge
;

4186 
$this
->
cyşicReã»nûSck
->
	`ş—r
();

4187 ià(!
$this
->
suµ»ssFÜmuÏE¼Üs
) {

4188 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
$”rÜMes§ge
);

4190 
	`Œigg”_”rÜ
(
$”rÜMes§ge
, 
E_USER_ERROR
);

4191 
	}
}

4203 
public
 
funùiÚ
 
exŒaùC–lRªge
(&
$pRªge
 = 'A1', 
PHPExûl_WÜksh“t
 
$pSh“t
 = 
nuÎ
, 
$»£tLog
 = 
Œue
)

4206 
$»tuºV®ue
 = 
¬¿y
 ();

4209 ià(
	g$pSh“t
 !=ğ
nuÎ
) {

4210 
$pSh“tName
 = 
$pSh“t
->
g‘T™Ë
();

4213 ià(
¡½os
(
$pRªge
, '!'è!=ğ
çl£
) {

4215 
li¡
(
$pSh“tName
, 
$pRªge
èğ
PHPExûl_WÜksh“t
::
exŒaùSh“tT™Ë
($pRªge, 
Œue
);

4218 
	g$pSh“t
 = 
$this
->
wÜkbook
->
g‘Sh“tByName
(
$pSh“tName
);

4222 
	g$aReã»nûs
 = 
PHPExûl_C–l
::
exŒaùAÎC–lReã»nûsInRªge
(
$pRªge
);

4223 
	g$pRªge
 = 
$pSh“tName
.'!'.
$pRªge
;

4224 ià(!
is£t
(
$aReã»nûs
[1])) {

4226 
ssÿnf
(
$aReã»nûs
[0], '%[A-Z]%d', 
$cu¼’tCŞ
, 
$cu¼’tRow
);

4227 
	g$ûÎV®ue
 = 
nuÎ
;

4228 ià(
	g$pSh“t
->
ûÎExi¡s
(
$aReã»nûs
[0])) {

4229 
	g$»tuºV®ue
[
$cu¼’tRow
][
$cu¼’tCŞ
] = 
$pSh“t
->
g‘C–l
(
$aReã»nûs
[0])->
g‘C®cuÏ‹dV®ue
(
$»£tLog
);

4231 
	g$»tuºV®ue
[
$cu¼’tRow
][
$cu¼’tCŞ
] = 
nuÎ
;

4235 
fÜ—ch
 (
$aReã»nûs
 
as
 
$»ã»nû
) {

4237 
ssÿnf
(
$»ã»nû
, '%[A-Z]%d', 
$cu¼’tCŞ
, 
$cu¼’tRow
);

4238 
	g$ûÎV®ue
 = 
nuÎ
;

4239 ià(
	g$pSh“t
->
ûÎExi¡s
(
$»ã»nû
)) {

4240 
	g$»tuºV®ue
[
$cu¼’tRow
][
$cu¼’tCŞ
] = 
$pSh“t
->
g‘C–l
(
$»ã»nû
)->
g‘C®cuÏ‹dV®ue
(
$»£tLog
);

4242 
	g$»tuºV®ue
[
$cu¼’tRow
][
$cu¼’tCŞ
] = 
nuÎ
;

4248  
	g$»tuºV®ue
;

4261 
public
 
funùiÚ
 
exŒaùNamedRªge
(&
$pRªge
 = 'A1', 
PHPExûl_WÜksh“t
 
$pSh“t
 = 
nuÎ
, 
$»£tLog
 = 
Œue
)

4264 
$»tuºV®ue
 = 
¬¿y
 ();

4267 ià(
	g$pSh“t
 !=ğ
nuÎ
) {

4268 
$pSh“tName
 = 
$pSh“t
->
g‘T™Ë
();

4271 ià(
¡½os
(
$pRªge
, '!'è!=ğ
çl£
) {

4273 
li¡
(
$pSh“tName
, 
$pRªge
èğ
PHPExûl_WÜksh“t
::
exŒaùSh“tT™Ë
($pRªge, 
Œue
);

4276 
	g$pSh“t
 = 
$this
->
wÜkbook
->
g‘Sh“tByName
(
$pSh“tName
);

4280 
	g$ÇmedRªge
 = 
PHPExûl_NamedRªge
::
»sŞveRªge
(
$pRªge
, 
$pSh“t
);

4281 ià(
	g$ÇmedRªge
 !=ğ
nuÎ
) {

4282 
$pSh“t
 = 
$ÇmedRªge
->
g‘WÜksh“t
();

4284 
	g$pRªge
 = 
$ÇmedRªge
->
g‘Rªge
();

4285 
	g$¥l™Rªge
 = 
PHPExûl_C–l
::
¥l™Rªge
(
$pRªge
);

4287 ià(
ùy³_®pha
(
$¥l™Rªge
[0][0])) {

4288 
	g$pRªge
 = 
$¥l™Rªge
[0][0] . '1:' . $¥l™Rªge[0][1] . 
$ÇmedRªge
->
g‘WÜksh“t
()->
g‘Highe¡Row
();

4289 } 
–£if
 (
ùy³_dig™
(
$¥l™Rªge
[0][0])) {

4290 
	g$pRªge
 = 'A' . 
$¥l™Rªge
[0][0] . ':' . 
$ÇmedRªge
->
g‘WÜksh“t
()->
g‘Highe¡CŞumn
() . $splitRange[0][1];

4302  
	gPHPExûl_C®cuÏtiÚ_FunùiÚs
::
REF
();

4306 
	g$aReã»nûs
 = 
PHPExûl_C–l
::
exŒaùAÎC–lReã»nûsInRªge
(
$pRªge
);

4308 ià(!
is£t
(
$aReã»nûs
[1])) {

4310 
li¡
(
$cu¼’tCŞ
, 
$cu¼’tRow
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$aReã»nûs
[0]);

4311 
	g$ûÎV®ue
 = 
nuÎ
;

4312 ià(
	g$pSh“t
->
ûÎExi¡s
(
$aReã»nûs
[0])) {

4313 
	g$»tuºV®ue
[
$cu¼’tRow
][
$cu¼’tCŞ
] = 
$pSh“t
->
g‘C–l
(
$aReã»nûs
[0])->
g‘C®cuÏ‹dV®ue
(
$»£tLog
);

4315 
	g$»tuºV®ue
[
$cu¼’tRow
][
$cu¼’tCŞ
] = 
nuÎ
;

4319 
fÜ—ch
 (
$aReã»nûs
 
as
 
$»ã»nû
) {

4321 
li¡
(
$cu¼’tCŞ
, 
$cu¼’tRow
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$»ã»nû
);

4323 
	g$ûÎV®ue
 = 
nuÎ
;

4324 ià(
	g$pSh“t
->
ûÎExi¡s
(
$»ã»nû
)) {

4325 
	g$»tuºV®ue
[
$cu¼’tRow
][
$cu¼’tCŞ
] = 
$pSh“t
->
g‘C–l
(
$»ã»nû
)->
g‘C®cuÏ‹dV®ue
(
$»£tLog
);

4327 
	g$»tuºV®ue
[
$cu¼’tRow
][
$cu¼’tCŞ
] = 
nuÎ
;

4335  
	g$»tuºV®ue
;

4345 
public
 
funùiÚ
 
isIm¶em’‹d
(
$pFunùiÚ
 = '')

4347 
$pFunùiÚ
 = 
¡¹ouµ”
($pFunction);

4348 ià(
is£t
(
£lf
::
$PHPExûlFunùiÚs
[
$pFunùiÚ
])) {

4349  (
£lf
::
$PHPExûlFunùiÚs
[
$pFunùiÚ
]['functionCall'] != 'PHPExcel_Calculation_Functions::DUMMY');

4351  
	gçl£
;

4361 
public
 
funùiÚ
 
	$li¡FunùiÚs
()

4363 
$»tuºV®ue
 = 
	`¬¿y
();

4365 
	`fÜ—ch
 (
£lf
::
$PHPExûlFunùiÚs
 
as
 
$funùiÚName
 => 
$funùiÚ
) {

4366 ià(
$funùiÚ
['functionCall'] != 'PHPExcel_Calculation_Functions::DUMMY') {

4367 
$»tuºV®ue
[
$funùiÚName
] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FunùiÚ
(

4368 
$funùiÚ
['category'],

4369 
$funùiÚName
,

4370 
$funùiÚ
['functionCall']

4375  
$»tuºV®ue
;

4376 
	}
}

4384 
public
 
funùiÚ
 
	$li¡AÎFunùiÚNames
()

4386  
	`¬¿y_keys
(
£lf
::
$PHPExûlFunùiÚs
);

4387 
	}
}

4394 
public
 
funùiÚ
 
	$li¡FunùiÚNames
()

4396 
$»tuºV®ue
 = 
	`¬¿y
();

4397 
	`fÜ—ch
 (
£lf
::
$PHPExûlFunùiÚs
 
as
 
$funùiÚName
 => 
$funùiÚ
) {

4398 ià(
$funùiÚ
['functionCall'] != 'PHPExcel_Calculation_Functions::DUMMY') {

4399 
$»tuºV®ue
[] = 
$funùiÚName
;

4403  
$»tuºV®ue
;

4404 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Database.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_C®cuÏtiÚ_D©aba£


57 
´iv©e
 
funùiÚ
 
	$f›ldExŒaù
(
$d©aba£
, 
$f›ld
)

59 
$f›ld
 = 
	`¡¹ouµ”
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($field));

60 
$f›ldNames
 = 
	`¬¿y_m­
('¡¹ouµ”', 
	`¬¿y_shiá
(
$d©aba£
));

62 ià(
	`is_num”ic
(
$f›ld
)) {

63 
$keys
 = 
	`¬¿y_keys
(
$f›ldNames
);

64  
$keys
[
$f›ld
-1];

66 
$key
 = 
	`¬¿y_£¬ch
(
$f›ld
, 
$f›ldNames
);

67  (
$key
è? $key : 
nuÎ
;

89 
´iv©e
 
funùiÚ
 
	$f‹r
(
$d©aba£
, 
$ü™”Ÿ
)

91 
$f›ldNames
 = 
	`¬¿y_shiá
(
$d©aba£
);

92 
$ü™”ŸNames
 = 
	`¬¿y_shiá
(
$ü™”Ÿ
);

95 
$‹¡CÚd™iÚs
 = 
$‹¡V®ues
 = 
	`¬¿y
();

96 
$‹¡CÚd™iÚsCouÁ
 = 0;

97 
	`fÜ—ch
 (
$ü™”ŸNames
 
as
 
$key
 => 
$ü™”ŸName
) {

98 
$‹¡CÚd™iÚ
 = 
	`¬¿y
();

99 
$‹¡CÚd™iÚCouÁ
 = 0;

100 
	`fÜ—ch
 (
$ü™”Ÿ
 
as
 
$row
 => 
$ü™”iÚ
) {

101 ià(
$ü™”iÚ
[
$key
] > '') {

102 
$‹¡CÚd™iÚ
[] = '[:'.
$ü™”ŸName
.']'.
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`ifCÚd™iÚ
(
$ü™”iÚ
[
$key
]);

103 
$‹¡CÚd™iÚCouÁ
++;

106 ià(
$‹¡CÚd™iÚCouÁ
 > 1) {

107 
$‹¡CÚd™iÚs
[] = 'OR(' . 
	`im¶ode
(',', 
$‹¡CÚd™iÚ
) . ')';

108 
$‹¡CÚd™iÚsCouÁ
++;

109 } 
	`–£if
 (
$‹¡CÚd™iÚCouÁ
 == 1) {

110 
$‹¡CÚd™iÚs
[] = 
$‹¡CÚd™iÚ
[0];

111 
$‹¡CÚd™iÚsCouÁ
++;

115 ià(
$‹¡CÚd™iÚsCouÁ
 > 1) {

116 
$‹¡CÚd™iÚS‘
 = 'AND(' . 
	`im¶ode
(',', 
$‹¡CÚd™iÚs
) . ')';

117 } 
	`–£if
 (
$‹¡CÚd™iÚsCouÁ
 == 1) {

118 
$‹¡CÚd™iÚS‘
 = 
$‹¡CÚd™iÚs
[0];

122 
	`fÜ—ch
 (
$d©aba£
 
as
 
$d©aRow
 => 
$d©aV®ues
) {

124 
$‹¡CÚd™iÚLi¡
 = 
$‹¡CÚd™iÚS‘
;

125 
	`fÜ—ch
 (
$ü™”ŸNames
 
as
 
$key
 => 
$ü™”ŸName
) {

126 
$k
 = 
	`¬¿y_£¬ch
(
$ü™”ŸName
, 
$f›ldNames
);

127 ià(
	`is£t
(
$d©aV®ues
[
$k
])) {

128 
$d©aV®ue
 = 
$d©aV®ues
[
$k
];

129 
$d©aV®ue
 = (
	`is_¡ršg
($d©aV®ue)è? 
PHPExûl_C®cuÏtiÚ
::
	`w¿pResuÉ
(
	`¡¹ouµ”
($dataValue)) : $dataValue;

130 
$‹¡CÚd™iÚLi¡
 = 
	`¡r_»¶aû
('[:' . 
$ü™”ŸName
 . ']', 
$d©aV®ue
, $testConditionList);

134 
$»suÉ
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`_ÿlcuÏ‹FÜmuÏV®ue
('='.
$‹¡CÚd™iÚLi¡
);

136 ià(!
$»suÉ
) {

137 
	`un£t
(
$d©aba£
[
$d©aRow
]);

141  
$d©aba£
;

142 
	}
}

145 
´iv©e
 
funùiÚ
 
	$g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

148 
$d©aba£
 = 
£lf
::
	`f‹r
($d©aba£, 
$ü™”Ÿ
);

150 
$cŞD©a
 = 
	`¬¿y
();

151 
	`fÜ—ch
 (
$d©aba£
 
as
 
$row
) {

152 
$cŞD©a
[] = 
$row
[
$f›ld
];

155  
$cŞD©a
;

156 
	}
}

185 
public
 
funùiÚ
 
	$DAVERAGE
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

187 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

188 ià(
	`is_nuÎ
(
$f›ld
)) {

189  
nuÎ
;

193  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`AVERAGE
(

194 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

196 
	}
}

233 
public
 
funùiÚ
 
	$DCOUNT
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

235 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

236 ià(
	`is_nuÎ
(
$f›ld
)) {

237  
nuÎ
;

241  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`COUNT
(

242 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

244 
	}
}

277 
public
 
funùiÚ
 
	$DCOUNTA
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

279 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

280 ià(
	`is_nuÎ
(
$f›ld
)) {

281  
nuÎ
;

285 
$d©aba£
 = 
£lf
::
	`f‹r
($d©aba£, 
$ü™”Ÿ
);

287 
$cŞD©a
 = 
	`¬¿y
();

288 
	`fÜ—ch
 (
$d©aba£
 
as
 
$row
) {

289 
$cŞD©a
[] = 
$row
[
$f›ld
];

293  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`COUNTA
(

294 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

296 
	}
}

327 
public
 
funùiÚ
 
	$DGET
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

329 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

330 ià(
	`is_nuÎ
(
$f›ld
)) {

331  
nuÎ
;

335 
$cŞD©a
 = 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
);

336 ià(
	`couÁ
(
$cŞD©a
) > 1) {

337  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

340  
$cŞD©a
[0];

341 
	}
}

372 
public
 
funùiÚ
 
	$DMAX
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

374 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

375 ià(
	`is_nuÎ
(
$f›ld
)) {

376  
nuÎ
;

380  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`MAX
(

381 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

383 
	}
}

414 
public
 
funùiÚ
 
	$DMIN
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

416 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

417 ià(
	`is_nuÎ
(
$f›ld
)) {

418  
nuÎ
;

422  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`MIN
(

423 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

425 
	}
}

455 
public
 
funùiÚ
 
	$DPRODUCT
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

457 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

458 ià(
	`is_nuÎ
(
$f›ld
)) {

459  
nuÎ
;

463  
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`PRODUCT
(

464 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

466 
	}
}

497 
public
 
funùiÚ
 
	$DSTDEV
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

499 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

500 ià(
	`is_nuÎ
(
$f›ld
)) {

501  
nuÎ
;

505  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`STDEV
(

506 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

508 
	}
}

539 
public
 
funùiÚ
 
	$DSTDEVP
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

541 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

542 ià(
	`is_nuÎ
(
$f›ld
)) {

543  
nuÎ
;

547  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`STDEVP
(

548 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

550 
	}
}

580 
public
 
funùiÚ
 
	$DSUM
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

582 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

583 ià(
	`is_nuÎ
(
$f›ld
)) {

584  
nuÎ
;

588  
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`SUM
(

589 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

591 
	}
}

622 
public
 
funùiÚ
 
	$DVAR
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

624 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

625 ià(
	`is_nuÎ
(
$f›ld
)) {

626  
nuÎ
;

630  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`VARFunc
(

631 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

633 
	}
}

664 
public
 
funùiÚ
 
	$DVARP
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

666 
$f›ld
 = 
£lf
::
	`f›ldExŒaù
(
$d©aba£
, $field);

667 ià(
	`is_nuÎ
(
$f›ld
)) {

668  
nuÎ
;

672  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`VARP
(

673 
£lf
::
	`g‘F‹»dCŞumn
(
$d©aba£
, 
$f›ld
, 
$ü™”Ÿ
)

675 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/DateTime.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_C®cuÏtiÚ_D©eTime


45 
public
 
funùiÚ
 
	$isL—pY—r
(
$y—r
)

47  (((
$y—r
 % 4) == 0) && (($year % 100) != 0) || (($year % 400) == 0));

63 
´iv©e
 
funùiÚ
 
	$d©eDiff360
(
$¡¬tDay
, 
$¡¬tMÚth
, 
$¡¬tY—r
, 
$’dDay
, 
$’dMÚth
, 
$’dY—r
, 
$m‘hodUS
)

65 ià(
$¡¬tDay
 == 31) {

66 --
$¡¬tDay
;

67 } 
	`–£if
 (
$m‘hodUS
 && (
$¡¬tMÚth
 =ğ2 && (
$¡¬tDay
 =ğ29 || ($¡¬tDay =ğ28 && !
£lf
::
	`isL—pY—r
(
$¡¬tY—r
))))) {

68 
$¡¬tDay
 = 30;

70 ià(
$’dDay
 == 31) {

71 ià(
$m‘hodUS
 && 
$¡¬tDay
 != 30) {

72 
$’dDay
 = 1;

73 ià(
$’dMÚth
 == 12) {

74 ++
$’dY—r
;

75 
$’dMÚth
 = 1;

77 ++
$’dMÚth
;

80 
$’dDay
 = 30;

84  
$’dDay
 + 
$’dMÚth
 * 30 + 
$’dY—r
 * 360 - 
$¡¬tDay
 - 
$¡¬tMÚth
 * 30 - 
$¡¬tY—r
 * 360;

85 
	}
}

94 
public
 
funùiÚ
 
	$g‘D©eV®ue
(
$d©eV®ue
)

96 ià(!
	`is_num”ic
(
$d©eV®ue
)) {

97 ià((
	`is_¡ršg
(
$d©eV®ue
)) &&

98 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
)) {

99  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

101 ià((
	`is_objeù
(
$d©eV®ue
)è&& ($d©eV®u
š¡ªûof
 
D©eTime
)) {

102 
$d©eV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
($dateValue);

104 
$§veR‘uºD©eTy³
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
();

105 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`£tR‘uºD©eTy³
(PHPExûl_C®cuÏtiÚ_FunùiÚs::
RETURNDATE_EXCEL
);

106 
$d©eV®ue
 = 
£lf
::
	`DATEVALUE
($dateValue);

107 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`£tR‘uºD©eTy³
(
$§veR‘uºD©eTy³
);

110  
$d©eV®ue
;

111 
	}
}

120 
´iv©e
 
funùiÚ
 
	$g‘TimeV®ue
(
$timeV®ue
)

122 
$§veR‘uºD©eTy³
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
();

123 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`£tR‘uºD©eTy³
(PHPExûl_C®cuÏtiÚ_FunùiÚs::
RETURNDATE_EXCEL
);

124 
$timeV®ue
 = 
£lf
::
	`TIMEVALUE
($timeValue);

125 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`£tR‘uºD©eTy³
(
$§veR‘uºD©eTy³
);

126  
$timeV®ue
;

127 
	}
}

130 
´iv©e
 
funùiÚ
 
	$adju¡D©eByMÚths
(
$d©eV®ue
 = 0, 
$adju¡m’tMÚths
 = 0)

133 
$PHPD©eObjeù
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$d©eV®ue
);

134 
$oMÚth
 = (è
$PHPD©eObjeù
->
	`fÜm©
('m');

135 
$oY—r
 = (è
$PHPD©eObjeù
->
	`fÜm©
('Y');

137 
$adju¡m’tMÚthsSŒšg
 = (
¡ršg
è
$adju¡m’tMÚths
;

138 ià(
$adju¡m’tMÚths
 > 0) {

139 
$adju¡m’tMÚthsSŒšg
 = '+'.
$adju¡m’tMÚths
;

141 ià(
$adju¡m’tMÚths
 != 0) {

142 
$PHPD©eObjeù
->
	`modify
(
$adju¡m’tMÚthsSŒšg
.' months');

144 
$nMÚth
 = (è
$PHPD©eObjeù
->
	`fÜm©
('m');

145 
$nY—r
 = (è
$PHPD©eObjeù
->
	`fÜm©
('Y');

147 
$mÚthDiff
 = (
$nMÚth
 - 
$oMÚth
è+ ((
$nY—r
 - 
$oY—r
) * 12);

148 ià(
$mÚthDiff
 !ğ
$adju¡m’tMÚths
) {

149 
$adju¡Days
 = (è
$PHPD©eObjeù
->
	`fÜm©
('d');

150 
$adju¡DaysSŒšg
 = '-'.
$adju¡Days
.' days';

151 
$PHPD©eObjeù
->
	`modify
(
$adju¡DaysSŒšg
);

153  
$PHPD©eObjeù
;

154 
	}
}

176 
public
 
funùiÚ
 
	$DATETIMENOW
()

178 
$§veTimeZÚe
 = 
	`d©e_deçuÉ_timezÚe_g‘
();

179 
	`d©e_deçuÉ_timezÚe_£t
('UTC');

180 
$»tV®ue
 = 
çl£
;

181 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
()) {

182 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_EXCEL
:

183 
$»tV®ue
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
	`time
());

185 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_NUMERIC
:

186 
$»tV®ue
 = (
š‹g”
è
	`time
();

188 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_OBJECT
:

189 
$»tV®ue
 = 
Ãw
 
	`D©eTime
();

192 
	`d©e_deçuÉ_timezÚe_£t
(
$§veTimeZÚe
);

194  
$»tV®ue
;

195 
	}
}

217 
public
 
funùiÚ
 
	$DATENOW
()

219 
$§veTimeZÚe
 = 
	`d©e_deçuÉ_timezÚe_g‘
();

220 
	`d©e_deçuÉ_timezÚe_£t
('UTC');

221 
$»tV®ue
 = 
çl£
;

222 
$exûlD©eTime
 = 
	`æoÜ
(
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
	`time
()));

223 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
()) {

224 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_EXCEL
:

225 
$»tV®ue
 = (è
$exûlD©eTime
;

227 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_NUMERIC
:

228 
$»tV®ue
 = (
š‹g”
è
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
(
$exûlD©eTime
);

230 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_OBJECT
:

231 
$»tV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$exûlD©eTime
);

234 
	`d©e_deçuÉ_timezÚe_£t
(
$§veTimeZÚe
);

236  
$»tV®ue
;

237 
	}
}

290 
public
 
funùiÚ
 
	$DATE
(
$y—r
 = 0, 
$mÚth
 = 1, 
$day
 = 1)

292 
$y—r
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($year);

293 
$mÚth
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($month);

294 
$day
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($day);

296 ià((
$mÚth
 !=ğ
nuÎ
è&& (!
	`is_num”ic
($month))) {

297 
$mÚth
 = 
PHPExûl_Sh¬ed_D©e
::
	`mÚthSŒšgToNumb”
($month);

300 ià((
$day
 !=ğ
nuÎ
è&& (!
	`is_num”ic
($day))) {

301 
$day
 = 
PHPExûl_Sh¬ed_D©e
::
	`daySŒšgToNumb”
($day);

304 
$y—r
 = ($y—¸!=ğ
nuÎ
è? 
PHPExûl_Sh¬ed_SŒšg
::
	`‹¡SŒšgAsNum”ic
($year) : 0;

305 
$mÚth
 = ($mÚth !=ğ
nuÎ
è? 
PHPExûl_Sh¬ed_SŒšg
::
	`‹¡SŒšgAsNum”ic
($month) : 0;

306 
$day
 = ($day !=ğ
nuÎ
è? 
PHPExûl_Sh¬ed_SŒšg
::
	`‹¡SŒšgAsNum”ic
($day) : 0;

307 ià((!
	`is_num”ic
(
$y—r
)) ||

308 (!
	`is_num”ic
(
$mÚth
)) ||

309 (!
	`is_num”ic
(
$day
))) {

310  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

312 
$y—r
 = (
š‹g”
) $year;

313 
$mÚth
 = (
š‹g”
) $month;

314 
$day
 = (
š‹g”
) $day;

316 
$ba£Y—r
 = 
PHPExûl_Sh¬ed_D©e
::
	`g‘ExûlC®’d¬
();

318 ià(
$y—r
 < (
$ba£Y—r
-1900)) {

319  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

321 ià(((
$ba£Y—r
-1900è!ğ0è&& (
$y—r
 < $baseYear) && ($year >= 1900)) {

322  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

325 ià((
$y—r
 < 
$ba£Y—r
) && ($year >= ($baseYear-1900))) {

326 
$y—r
 += 1900;

329 ià(
$mÚth
 < 1) {

331 --
$mÚth
;

332 
$y—r
 +ğ
	`û
(
$mÚth
 / 12) - 1;

333 
$mÚth
 = 13 - 
	`abs
($month % 12);

334 } 
	`–£if
 (
$mÚth
 > 12) {

336 
$y—r
 +ğ
	`æoÜ
(
$mÚth
 / 12);

337 
$mÚth
 = ($month % 12);

341 ià((
$y—r
 < 
$ba£Y—r
) || ($year >= 10000)) {

342  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

346 
$exûlD©eV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`FÜm©‹dPHPToExûl
(
$y—r
, 
$mÚth
, 
$day
);

347 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
()) {

348 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_EXCEL
:

349  (è
$exûlD©eV®ue
;

350 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_NUMERIC
:

351  (
š‹g”
è
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
(
$exûlD©eV®ue
);

352 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_OBJECT
:

353  
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$exûlD©eV®ue
);

355 
	}
}

385 
public
 
funùiÚ
 
	$TIME
(
$hour
 = 0, 
$mšu‹
 = 0, 
$£cÚd
 = 0)

387 
$hour
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($hour);

388 
$mšu‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($minute);

389 
$£cÚd
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($second);

391 ià(
$hour
 == '') {

392 
$hour
 = 0;

394 ià(
$mšu‹
 == '') {

395 
$mšu‹
 = 0;

397 ià(
$£cÚd
 == '') {

398 
$£cÚd
 = 0;

401 ià((!
	`is_num”ic
(
$hour
)è|| (!is_num”ic(
$mšu‹
)è|| (!is_num”ic(
$£cÚd
))) {

402  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

404 
$hour
 = (
š‹g”
) $hour;

405 
$mšu‹
 = (
š‹g”
) $minute;

406 
$£cÚd
 = (
š‹g”
) $second;

408 ià(
$£cÚd
 < 0) {

409 
$mšu‹
 +ğ
	`æoÜ
(
$£cÚd
 / 60);

410 
$£cÚd
 = 60 - 
	`abs
($second % 60);

411 ià(
$£cÚd
 == 60) {

412 
$£cÚd
 = 0;

414 } 
	`–£if
 (
$£cÚd
 >= 60) {

415 
$mšu‹
 +ğ
	`æoÜ
(
$£cÚd
 / 60);

416 
$£cÚd
 = $second % 60;

418 ià(
$mšu‹
 < 0) {

419 
$hour
 +ğ
	`æoÜ
(
$mšu‹
 / 60);

420 
$mšu‹
 = 60 - 
	`abs
($minute % 60);

421 ià(
$mšu‹
 == 60) {

422 
$mšu‹
 = 0;

424 } 
	`–£if
 (
$mšu‹
 >= 60) {

425 
$hour
 +ğ
	`æoÜ
(
$mšu‹
 / 60);

426 
$mšu‹
 = $minute % 60;

429 ià(
$hour
 > 23) {

430 
$hour
 = $hour % 24;

431 } 
	`–£if
 (
$hour
 < 0) {

432  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

436 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
()) {

437 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_EXCEL
:

438 
$d©e
 = 0;

439 
$ÿËnd¬
 = 
PHPExûl_Sh¬ed_D©e
::
	`g‘ExûlC®’d¬
();

440 ià(
$ÿËnd¬
 !ğ
PHPExûl_Sh¬ed_D©e
::
CALENDAR_WINDOWS_1900
) {

441 
$d©e
 = 1;

443  (è
PHPExûl_Sh¬ed_D©e
::
	`FÜm©‹dPHPToExûl
(
$ÿËnd¬
, 1, 
$d©e
, 
$hour
, 
$mšu‹
, 
$£cÚd
);

444 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_NUMERIC
:

445  (
š‹g”
è
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
(PHPExûl_Sh¬ed_D©e::
	`FÜm©‹dPHPToExûl
(1970, 1, 1, 
$hour
, 
$mšu‹
, 
$£cÚd
));

446 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_OBJECT
:

447 
$dayAdju¡
 = 0;

448 ià(
$hour
 < 0) {

449 
$dayAdju¡
 = 
	`æoÜ
(
$hour
 / 24);

450 
$hour
 = 24 - 
	`abs
($hour % 24);

451 ià(
$hour
 == 24) {

452 
$hour
 = 0;

454 } 
	`–£if
 (
$hour
 >= 24) {

455 
$dayAdju¡
 = 
	`æoÜ
(
$hour
 / 24);

456 
$hour
 = $hour % 24;

458 
$phpD©eObjeù
 = 
Ãw
 
	`D©eTime
('1900-01-01 '.
$hour
.':'.
$mšu‹
.':'.
$£cÚd
);

459 ià(
$dayAdju¡
 != 0) {

460 
$phpD©eObjeù
->
	`modify
(
$dayAdju¡
.' days');

462  
$phpD©eObjeù
;

464 
	}
}

493 
public
 
funùiÚ
 
	$DATEVALUE
(
$d©eV®ue
 = 1)

495 
$d©eV®ue
 = 
	`Œim
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($dateValue), '"');

497 
$d©eV®ue
 = 
	`´eg_»¶aû
('/(\d)(st|nd|rd|th)([ -\/])/Ui', '$1$3', $dateValue);

499 
$d©eV®ue
 = 
	`¡r_»¶aû
(
	`¬¿y
('/', '.', '-', ' '),‡rray(' ', ' ', ' ', ' '), $dateValue);

501 
$y—rFound
 = 
çl£
;

502 
$t1
 = 
	`ex¶ode
(' ', 
$d©eV®ue
);

503 
	`fÜ—ch
 (
$t1
 
as
 &
$t
) {

504 ià((
	`is_num”ic
(
$t
)) && ($t > 31)) {

505 ià(
$y—rFound
) {

506  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

508 ià(
$t
 < 100) {

509 
$t
 += 1900;

511 
$y—rFound
 = 
Œue
;

515 ià((
	`couÁ
(
$t1
è=ğ1è&& (
	`¡½os
(
$t
, ':'è!ğ
çl£
)) {

518 } 
	`–£if
 (
	`couÁ
(
$t1
) == 2) {

520 ià(
$y—rFound
) {

521 
	`¬¿y_unshiá
(
$t1
, 1);

523 
	`¬¿y_push
(
$t1
, 
	`d©e
('Y'));

526 
	`un£t
(
$t
);

527 
$d©eV®ue
 = 
	`im¶ode
(' ', 
$t1
);

529 
$PHPD©eA¼ay
 = 
	`d©e_·r£
(
$d©eV®ue
);

530 ià((
$PHPD©eA¼ay
 ==ğ
çl£
) || ($PHPDateArray['error_count'] > 0)) {

531 
$‹¡V®1
 = 
	`¡¹ok
(
$d©eV®ue
, '- ');

532 ià(
$‹¡V®1
 !=ğ
çl£
) {

533 
$‹¡V®2
 = 
	`¡¹ok
('- ');

534 ià(
$‹¡V®2
 !=ğ
çl£
) {

535 
$‹¡V®3
 = 
	`¡¹ok
('- ');

536 ià(
$‹¡V®3
 ==ğ
çl£
) {

537 
$‹¡V®3
 = 
	`¡ráime
('%Y');

540  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

543  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

545 
$PHPD©eA¼ay
 = 
	`d©e_·r£
(
$‹¡V®1
.'-'.
$‹¡V®2
.'-'.
$‹¡V®3
);

546 ià((
$PHPD©eA¼ay
 ==ğ
çl£
) || ($PHPDateArray['error_count'] > 0)) {

547 
$PHPD©eA¼ay
 = 
	`d©e_·r£
(
$‹¡V®2
.'-'.
$‹¡V®1
.'-'.
$‹¡V®3
);

548 ià((
$PHPD©eA¼ay
 ==ğ
çl£
) || ($PHPDateArray['error_count'] > 0)) {

549  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

554 ià((
$PHPD©eA¼ay
 !=ğ
çl£
) && ($PHPDateArray['error_count'] == 0)) {

556 ià(
$PHPD©eA¼ay
['year'] == '') {

557 
$PHPD©eA¼ay
['y—r'] = 
	`¡ráime
('%Y');

559 ià(
$PHPD©eA¼ay
['year'] < 1900) {

560  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

562 ià(
$PHPD©eA¼ay
['month'] == '') {

563 
$PHPD©eA¼ay
['mÚth'] = 
	`¡ráime
('%m');

565 ià(
$PHPD©eA¼ay
['day'] == '') {

566 
$PHPD©eA¼ay
['day'] = 
	`¡ráime
('%d');

568 
$exûlD©eV®ue
 = 
	`æoÜ
(

569 
PHPExûl_Sh¬ed_D©e
::
	`FÜm©‹dPHPToExûl
(

570 
$PHPD©eA¼ay
['year'],

571 
$PHPD©eA¼ay
['month'],

572 
$PHPD©eA¼ay
['day'],

573 
$PHPD©eA¼ay
['hour'],

574 
$PHPD©eA¼ay
['minute'],

575 
$PHPD©eA¼ay
['second']

579 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
()) {

580 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_EXCEL
:

581  (è
$exûlD©eV®ue
;

582 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_NUMERIC
:

583  (
š‹g”
è
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
(
$exûlD©eV®ue
);

584 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_OBJECT
:

585  
Ãw
 
	`D©eTime
(
$PHPD©eA¼ay
['year'].'-'.$PHPDateArray['month'].'-'.$PHPDateArray['day'].' 00:00:00');

588  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

589 
	}
}

614 
public
 
funùiÚ
 
	$TIMEVALUE
(
$timeV®ue
)

616 
$timeV®ue
 = 
	`Œim
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($timeValue), '"');

617 
$timeV®ue
 = 
	`¡r_»¶aû
(
	`¬¿y
('/', '.'),‡rray('-', '-'), $timeValue);

619 
$PHPD©eA¼ay
 = 
	`d©e_·r£
(
$timeV®ue
);

620 ià((
$PHPD©eA¼ay
 !=ğ
çl£
) && ($PHPDateArray['error_count'] == 0)) {

621 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

622 
$exûlD©eV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`FÜm©‹dPHPToExûl
(

623 
$PHPD©eA¼ay
['year'],

624 
$PHPD©eA¼ay
['month'],

625 
$PHPD©eA¼ay
['day'],

626 
$PHPD©eA¼ay
['hour'],

627 
$PHPD©eA¼ay
['minute'],

628 
$PHPD©eA¼ay
['second']

631 
$exûlD©eV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`FÜm©‹dPHPToExûl
(1900, 1, 1, 
$PHPD©eA¼ay
['hour'], $PHPDateArray['minute'], $PHPDateArray['second']) - 1;

634 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
()) {

635 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_EXCEL
:

636  (è
$exûlD©eV®ue
;

637 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_NUMERIC
:

638  (
š‹g”
è
$phpD©eV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
(
$exûlD©eV®ue
+25569) - 3600;

639 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_OBJECT
:

640  
Ãw
 
	`D©eTime
('1900-01-01 '.
$PHPD©eA¼ay
['hour'].':'.$PHPDateArray['minute'].':'.$PHPDateArray['second']);

643  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

644 
	}
}

657 
public
 
funùiÚ
 
DATEDIF
(
$¡¬tD©e
 = 0, 
$’dD©e
 = 0, 
$un™
 = 'D')

659 
$¡¬tD©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($startDate);

660 
	g$’dD©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$’dD©e
);

661 
	g$un™
 = 
¡¹ouµ”
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$un™
));

663 ià(
is_¡ršg
(
$¡¬tD©e
 = 
£lf
::
g‘D©eV®ue
($startDate))) {

664  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
();

666 ià(
is_¡ršg
(
$’dD©e
 = 
£lf
::
g‘D©eV®ue
($endDate))) {

667  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
();

671 ià(
	g$¡¬tD©e
 >ğ
$’dD©e
) {

672  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
NaN
();

676 
	g$difã»nû
 = 
$’dD©e
 - 
$¡¬tD©e
;

678 
	g$PHPS¹D©eObjeù
 = 
PHPExûl_Sh¬ed_D©e
::
ExûlToPHPObjeù
(
$¡¬tD©e
);

679 
	g$¡¬tDays
 = 
$PHPS¹D©eObjeù
->
fÜm©
('j');

680 
	g$¡¬tMÚths
 = 
$PHPS¹D©eObjeù
->
fÜm©
('n');

681 
	g$¡¬tY—rs
 = 
$PHPS¹D©eObjeù
->
fÜm©
('Y');

683 
	g$PHPEndD©eObjeù
 = 
PHPExûl_Sh¬ed_D©e
::
ExûlToPHPObjeù
(
$’dD©e
);

684 
	g$’dDays
 = 
$PHPEndD©eObjeù
->
fÜm©
('j');

685 
	g$’dMÚths
 = 
$PHPEndD©eObjeù
->
fÜm©
('n');

686 
	g$’dY—rs
 = 
$PHPEndD©eObjeù
->
fÜm©
('Y');

688 
	g$»tV®
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
NaN
();

689 
	g$un™
) {

691 
$»tV®
 = 
štv®
(
$difã»nû
);

694 
$»tV®
 = 
štv®
(
$’dMÚths
 - 
$¡¬tMÚths
è+ (štv®(
$’dY—rs
 - 
$¡¬tY—rs
) * 12);

696 ià(
	g$’dDays
 < 
	g$¡¬tDays
) {

697 --
	g$»tV®
;

701 
$»tV®
 = 
štv®
(
$’dY—rs
 - 
$¡¬tY—rs
);

703 ià(
	g$’dMÚths
 < 
	g$¡¬tMÚths
) {

704 --
	g$»tV®
;

705 } 
–£if
 ((
$’dMÚths
 =ğ
$¡¬tMÚths
è&& (
$’dDays
 < 
$¡¬tDays
)) {

706 --
$»tV®
;

710 ià(
$’dDays
 < 
$¡¬tDays
) {

711 
$»tV®
 = 
$’dDays
;

712 
	g$PHPEndD©eObjeù
->
modify
('-'.
$’dDays
.' days');

713 
	g$adju¡Days
 = 
$PHPEndD©eObjeù
->
fÜm©
('j');

714 ià(
	g$adju¡Days
 > 
	g$¡¬tDays
) {

715 
	g$»tV®
 +ğ(
$adju¡Days
 - 
$¡¬tDays
);

718 
	g$»tV®
 = 
$’dDays
 - 
$¡¬tDays
;

722 
$»tV®
 = 
štv®
(
$’dMÚths
 - 
$¡¬tMÚths
);

723 ià(
	g$»tV®
 < 0) {

724 
	g$»tV®
 += 12;

727 ià(
	g$’dDays
 < 
	g$¡¬tDays
) {

728 --
	g$»tV®
;

732 
$»tV®
 = 
štv®
(
$difã»nû
);

733 ià(
	g$’dY—rs
 > 
	g$¡¬tY—rs
) {

734 
	g$’dY—rs
 > 
	g$¡¬tY—rs
) {

735 
	g$PHPEndD©eObjeù
->
modify
('-1 year');

736 
	g$’dY—rs
 = 
$PHPEndD©eObjeù
->
fÜm©
('Y');

738 
	g$»tV®
 = 
$PHPEndD©eObjeù
->
fÜm©
('z'è- 
$PHPS¹D©eObjeù
->format('z');

739 ià(
	g$»tV®
 < 0) {

740 
	g$»tV®
 += 365;

745 
$»tV®
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
NaN
();

747  
	g$»tV®
;

780 
public
 
funùiÚ
 
	$DAYS360
(
$¡¬tD©e
 = 0, 
$’dD©e
 = 0, 
$m‘hod
 = 
çl£
)

782 
$¡¬tD©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($startDate);

783 
$’dD©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($endDate);

785 ià(
	`is_¡ršg
(
$¡¬tD©e
 = 
£lf
::
	`g‘D©eV®ue
($startDate))) {

786  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

788 ià(
	`is_¡ršg
(
$’dD©e
 = 
£lf
::
	`g‘D©eV®ue
($endDate))) {

789  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

792 ià(!
	`is_boŞ
(
$m‘hod
)) {

793  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

797 
$PHPS¹D©eObjeù
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$¡¬tD©e
);

798 
$¡¬tDay
 = 
$PHPS¹D©eObjeù
->
	`fÜm©
('j');

799 
$¡¬tMÚth
 = 
$PHPS¹D©eObjeù
->
	`fÜm©
('n');

800 
$¡¬tY—r
 = 
$PHPS¹D©eObjeù
->
	`fÜm©
('Y');

802 
$PHPEndD©eObjeù
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$’dD©e
);

803 
$’dDay
 = 
$PHPEndD©eObjeù
->
	`fÜm©
('j');

804 
$’dMÚth
 = 
$PHPEndD©eObjeù
->
	`fÜm©
('n');

805 
$’dY—r
 = 
$PHPEndD©eObjeù
->
	`fÜm©
('Y');

807  
£lf
::
	`d©eDiff360
(
$¡¬tDay
, 
$¡¬tMÚth
, 
$¡¬tY—r
, 
$’dDay
, 
$’dMÚth
, 
$’dY—r
, !
$m‘hod
);

808 
	}
}

836 
public
 
funùiÚ
 
	$YEARFRAC
(
$¡¬tD©e
 = 0, 
$’dD©e
 = 0, 
$m‘hod
 = 0)

838 
$¡¬tD©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($startDate);

839 
$’dD©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($endDate);

840 
$m‘hod
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($method);

842 ià(
	`is_¡ršg
(
$¡¬tD©e
 = 
£lf
::
	`g‘D©eV®ue
($startDate))) {

843  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

845 ià(
	`is_¡ršg
(
$’dD©e
 = 
£lf
::
	`g‘D©eV®ue
($endDate))) {

846  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

849 ià(((
	`is_num”ic
(
$m‘hod
)è&& (!
	`is_¡ršg
($method))) || ($method == '')) {

850 
$m‘hod
) {

852  
£lf
::
	`DAYS360
(
$¡¬tD©e
, 
$’dD©e
) / 360;

854 
$days
 = 
£lf
::
	`DATEDIF
(
$¡¬tD©e
, 
$’dD©e
);

855 
$¡¬tY—r
 = 
£lf
::
	`YEAR
(
$¡¬tD©e
);

856 
$’dY—r
 = 
£lf
::
	`YEAR
(
$’dD©e
);

857 
$y—rs
 = 
$’dY—r
 - 
$¡¬tY—r
 + 1;

858 
$Ë­Days
 = 0;

859 ià(
$y—rs
 == 1) {

860 ià(
£lf
::
	`isL—pY—r
(
$’dY—r
)) {

861 
$¡¬tMÚth
 = 
£lf
::
	`MONTHOFYEAR
(
$¡¬tD©e
);

862 
$’dMÚth
 = 
£lf
::
	`MONTHOFYEAR
(
$’dD©e
);

863 
$’dDay
 = 
£lf
::
	`DAYOFMONTH
(
$’dD©e
);

864 ià((
$¡¬tMÚth
 < 3) ||

865 ((
$’dMÚth
 * 100 + 
$’dDay
) >= (2 * 100 + 29))) {

866 
$Ë­Days
 += 1;

870 
$y—r
 = 
$¡¬tY—r
; $y—¸<ğ
$’dY—r
; ++$year) {

871 ià(
$y—r
 =ğ
$¡¬tY—r
) {

872 
$¡¬tMÚth
 = 
£lf
::
	`MONTHOFYEAR
(
$¡¬tD©e
);

873 
$¡¬tDay
 = 
£lf
::
	`DAYOFMONTH
(
$¡¬tD©e
);

874 ià(
$¡¬tMÚth
 < 3) {

875 
$Ë­Days
 +ğ(
£lf
::
	`isL—pY—r
(
$y—r
)) ? 1 : 0;

877 } 
	`–£if
 (
$y—r
 =ğ
$’dY—r
) {

878 
$’dMÚth
 = 
£lf
::
	`MONTHOFYEAR
(
$’dD©e
);

879 
$’dDay
 = 
£lf
::
	`DAYOFMONTH
(
$’dD©e
);

880 ià((
$’dMÚth
 * 100 + 
$’dDay
) >= (2 * 100 + 29)) {

881 
$Ë­Days
 +ğ(
£lf
::
	`isL—pY—r
(
$y—r
)) ? 1 : 0;

884 
$Ë­Days
 +ğ(
£lf
::
	`isL—pY—r
(
$y—r
)) ? 1 : 0;

887 ià(
$y—rs
 == 2) {

888 ià((
$Ë­Days
 =ğ0è&& (
£lf
::
	`isL—pY—r
(
$¡¬tY—r
)è&& (
$days
 > 365)) {

889 
$Ë­Days
 = 1;

890 } 
	`–£if
 (
$days
 < 366) {

891 
$y—rs
 = 1;

894 
$Ë­Days
 /ğ
$y—rs
;

896  
$days
 / (365 + 
$Ë­Days
);

898  
£lf
::
	`DATEDIF
(
$¡¬tD©e
, 
$’dD©e
) / 360;

900  
£lf
::
	`DATEDIF
(
$¡¬tD©e
, 
$’dD©e
) / 365;

902  
£lf
::
	`DAYS360
(
$¡¬tD©e
, 
$’dD©e
, 
Œue
) / 360;

905  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

906 
	}
}

932 
public
 
funùiÚ
 
	$NETWORKDAYS
(
$¡¬tD©e
, 
$’dD©e
)

935 
$¡¬tD©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($startDate);

936 
$’dD©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($endDate);

938 
$d©eArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

939 
	`¬¿y_shiá
(
$d©eArgs
);

940 
	`¬¿y_shiá
(
$d©eArgs
);

943 ià(
	`is_¡ršg
(
$¡¬tD©e
 = 
$sD©e
 = 
£lf
::
	`g‘D©eV®ue
($startDate))) {

944  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

946 
$¡¬tD©e
 = (è
	`æoÜ
($startDate);

947 ià(
	`is_¡ršg
(
$’dD©e
 = 
$eD©e
 = 
£lf
::
	`g‘D©eV®ue
($endDate))) {

948  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

950 
$’dD©e
 = (è
	`æoÜ
($endDate);

952 ià(
$sD©e
 > 
$eD©e
) {

953 
$¡¬tD©e
 = 
$eD©e
;

954 
$’dD©e
 = 
$sD©e
;

958 
$¡¬tDoW
 = 6 - 
£lf
::
	`DAYOFWEEK
(
$¡¬tD©e
, 2);

959 ià(
$¡¬tDoW
 < 0) {

960 
$¡¬tDoW
 = 0;

962 
$’dDoW
 = 
£lf
::
	`DAYOFWEEK
(
$’dD©e
, 2);

963 ià(
$’dDoW
 >= 6) {

964 
$’dDoW
 = 0;

967 
$whŞeW“kDays
 = 
	`æoÜ
((
$’dD©e
 - 
$¡¬tD©e
) / 7) * 5;

968 
$·¹W“kDays
 = 
$’dDoW
 + 
$¡¬tDoW
;

969 ià(
$·¹W“kDays
 > 5) {

970 
$·¹W“kDays
 -= 5;

974 
$hŞidayCouÁedA¼ay
 = 
	`¬¿y
();

975 
	`fÜ—ch
 (
$d©eArgs
 
as
 
$hŞidayD©e
) {

976 ià(
	`is_¡ršg
(
$hŞidayD©e
 = 
£lf
::
	`g‘D©eV®ue
($holidayDate))) {

977  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

979 ià((
$hŞidayD©e
 >ğ
$¡¬tD©e
è&& ($hŞidayD©<ğ
$’dD©e
)) {

980 ià((
£lf
::
	`DAYOFWEEK
(
$hŞidayD©e
, 2è< 6è&& (!
	`š_¬¿y
($hŞidayD©e, 
$hŞidayCouÁedA¼ay
))) {

981 --
$·¹W“kDays
;

982 
$hŞidayCouÁedA¼ay
[] = 
$hŞidayD©e
;

987 ià(
$sD©e
 > 
$eD©e
) {

988  0 - (
$whŞeW“kDays
 + 
$·¹W“kDays
);

990  
$whŞeW“kDays
 + 
$·¹W“kDays
;

991 
	}
}

1019 
public
 
funùiÚ
 
	$WORKDAY
(
$¡¬tD©e
, 
$’dDays
)

1022 
$¡¬tD©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($startDate);

1023 
$’dDays
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($endDays);

1025 
$d©eArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

1026 
	`¬¿y_shiá
(
$d©eArgs
);

1027 
	`¬¿y_shiá
(
$d©eArgs
);

1029 ià((
	`is_¡ršg
(
$¡¬tD©e
 = 
£lf
::
	`g‘D©eV®ue
($¡¬tD©e))è|| (!
	`is_num”ic
(
$’dDays
))) {

1030  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1032 
$¡¬tD©e
 = (è
	`æoÜ
($startDate);

1033 
$’dDays
 = (è
	`æoÜ
($endDays);

1035 ià(
$’dDays
 == 0) {

1036  
$¡¬tD©e
;

1039 
$deüem’tšg
 = (
$’dDays
 < 0è? 
Œue
 : 
çl£
;

1043 
$¡¬tDoW
 = 
£lf
::
	`DAYOFWEEK
(
$¡¬tD©e
, 3);

1044 ià(
£lf
::
	`DAYOFWEEK
(
$¡¬tD©e
, 3) >= 5) {

1045 
$¡¬tD©e
 +ğ(
$deüem’tšg
è? -
$¡¬tDoW
 + 4: 7 - $startDoW;

1046 (
$deüem’tšg
è? 
$’dDays
++ : $endDays--;

1050 
$’dD©e
 = (è
$¡¬tD©e
 + (
	`štv®
(
$’dDays
 / 5) * 7) + ($endDays % 5);

1053 
$’dDoW
 = 
£lf
::
	`DAYOFWEEK
(
$’dD©e
, 3);

1054 ià(
$’dDoW
 >= 5) {

1055 
$’dD©e
 +ğ(
$deüem’tšg
è? -
$’dDoW
 + 4: 7 - $endDoW;

1059 ià(!
	`em±y
(
$d©eArgs
)) {

1060 
$hŞidayCouÁedA¼ay
 = 
$hŞidayD©es
 = 
	`¬¿y
();

1061 
	`fÜ—ch
 (
$d©eArgs
 
as
 
$hŞidayD©e
) {

1062 ià((
$hŞidayD©e
 !=ğ
nuÎ
è&& (
	`Œim
($holidayDate) > '')) {

1063 ià(
	`is_¡ršg
(
$hŞidayD©e
 = 
£lf
::
	`g‘D©eV®ue
($holidayDate))) {

1064  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1066 ià(
£lf
::
	`DAYOFWEEK
(
$hŞidayD©e
, 3) < 5) {

1067 
$hŞidayD©es
[] = 
$hŞidayD©e
;

1071 ià(
$deüem’tšg
) {

1072 
	`rsÜt
(
$hŞidayD©es
, 
SORT_NUMERIC
);

1074 
	`sÜt
(
$hŞidayD©es
, 
SORT_NUMERIC
);

1076 
	`fÜ—ch
 (
$hŞidayD©es
 
as
 
$hŞidayD©e
) {

1077 ià(
$deüem’tšg
) {

1078 ià((
$hŞidayD©e
 <ğ
$¡¬tD©e
è&& ($hŞidayD©>ğ
$’dD©e
)) {

1079 ià(!
	`š_¬¿y
(
$hŞidayD©e
, 
$hŞidayCouÁedA¼ay
)) {

1080 --
$’dD©e
;

1081 
$hŞidayCouÁedA¼ay
[] = 
$hŞidayD©e
;

1085 ià((
$hŞidayD©e
 >ğ
$¡¬tD©e
è&& ($hŞidayD©<ğ
$’dD©e
)) {

1086 ià(!
	`š_¬¿y
(
$hŞidayD©e
, 
$hŞidayCouÁedA¼ay
)) {

1087 ++
$’dD©e
;

1088 
$hŞidayCouÁedA¼ay
[] = 
$hŞidayD©e
;

1093 
$’dDoW
 = 
£lf
::
	`DAYOFWEEK
(
$’dD©e
, 3);

1094 ià(
$’dDoW
 >= 5) {

1095 
$’dD©e
 +ğ(
$deüem’tšg
è? -
$’dDoW
 + 4 : 7 - $endDoW;

1100 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
()) {

1101 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_EXCEL
:

1102  (è
$’dD©e
;

1103 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_NUMERIC
:

1104  (
š‹g”
è
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
(
$’dD©e
);

1105 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_OBJECT
:

1106  
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$’dD©e
);

1108 
	}
}

1124 
public
 
funùiÚ
 
	$DAYOFMONTH
(
$d©eV®ue
 = 1)

1126 
$d©eV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($dateValue);

1128 ià(
$d©eV®ue
 ==ğ
nuÎ
) {

1129 
$d©eV®ue
 = 1;

1130 } 
	`–£if
 (
	`is_¡ršg
(
$d©eV®ue
 = 
£lf
::
	`g‘D©eV®ue
($dateValue))) {

1131  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1132 } 
	`–£if
 (
$d©eV®ue
 == 0.0) {

1134 } 
	`–£if
 (
$d©eV®ue
 < 0.0) {

1135  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1139 
$PHPD©eObjeù
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$d©eV®ue
);

1141  (è
$PHPD©eObjeù
->
	`fÜm©
('j');

1142 
	}
}

1162 
public
 
funùiÚ
 
	$DAYOFWEEK
(
$d©eV®ue
 = 1, 
$¡yË
 = 1)

1164 
$d©eV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($dateValue);

1165 
$¡yË
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($style);

1167 ià(!
	`is_num”ic
(
$¡yË
)) {

1168  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1169 } 
	`–£if
 ((
$¡yË
 < 1) || ($style > 3)) {

1170  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1172 
$¡yË
 = 
	`æoÜ
($style);

1174 ià(
$d©eV®ue
 ==ğ
nuÎ
) {

1175 
$d©eV®ue
 = 1;

1176 } 
	`–£if
 (
	`is_¡ršg
(
$d©eV®ue
 = 
£lf
::
	`g‘D©eV®ue
($dateValue))) {

1177  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1178 } 
	`–£if
 (
$d©eV®ue
 < 0.0) {

1179  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1183 
$PHPD©eObjeù
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$d©eV®ue
);

1184 
$DoW
 = 
$PHPD©eObjeù
->
	`fÜm©
('w');

1186 
$fœ¡Day
 = 1;

1187 
$¡yË
) {

1189 ++
$DoW
;

1192 ià(
$DoW
 == 0) {

1193 
$DoW
 = 7;

1197 ià(
$DoW
 == 0) {

1198 
$DoW
 = 7;

1200 
$fœ¡Day
 = 0;

1201 --
$DoW
;

1204 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_EXCEL
) {

1206 ià((
$PHPD©eObjeù
->
	`fÜm©
('Y') == 1900) && ($PHPDateObject->format('n') <= 2)) {

1207 --
$DoW
;

1208 ià(
$DoW
 < 
$fœ¡Day
) {

1209 
$DoW
 += 7;

1214  (è
$DoW
;

1215 
	}
}

1238 
public
 
funùiÚ
 
	$WEEKOFYEAR
(
$d©eV®ue
 = 1, 
$m‘hod
 = 1)

1240 
$d©eV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($dateValue);

1241 
$m‘hod
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($method);

1243 ià(!
	`is_num”ic
(
$m‘hod
)) {

1244  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1245 } 
	`–£if
 ((
$m‘hod
 < 1) || ($method > 2)) {

1246  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1248 
$m‘hod
 = 
	`æoÜ
($method);

1250 ià(
$d©eV®ue
 ==ğ
nuÎ
) {

1251 
$d©eV®ue
 = 1;

1252 } 
	`–£if
 (
	`is_¡ršg
(
$d©eV®ue
 = 
£lf
::
	`g‘D©eV®ue
($dateValue))) {

1253  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1254 } 
	`–£if
 (
$d©eV®ue
 < 0.0) {

1255  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1259 
$PHPD©eObjeù
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$d©eV®ue
);

1260 
$dayOfY—r
 = 
$PHPD©eObjeù
->
	`fÜm©
('z');

1261 
$dow
 = 
$PHPD©eObjeù
->
	`fÜm©
('w');

1262 
$PHPD©eObjeù
->
	`modify
('-' . 
$dayOfY—r
 . ' days');

1263 
$dow
 = 
$PHPD©eObjeù
->
	`fÜm©
('w');

1264 
$daysInFœ¡W“k
 = 7 - ((
$dow
 + (2 - 
$m‘hod
)) % 7);

1265 
$dayOfY—r
 -ğ
$daysInFœ¡W“k
;

1266 
$w“kOfY—r
 = 
	`û
(
$dayOfY—r
 / 7) + 1;

1268  (è
$w“kOfY—r
;

1269 
	}
}

1285 
public
 
funùiÚ
 
	$MONTHOFYEAR
(
$d©eV®ue
 = 1)

1287 
$d©eV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($dateValue);

1289 ià(
$d©eV®ue
 ==ğ
nuÎ
) {

1290 
$d©eV®ue
 = 1;

1291 } 
	`–£if
 (
	`is_¡ršg
(
$d©eV®ue
 = 
£lf
::
	`g‘D©eV®ue
($dateValue))) {

1292  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1293 } 
	`–£if
 (
$d©eV®ue
 < 0.0) {

1294  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1298 
$PHPD©eObjeù
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$d©eV®ue
);

1300  (è
$PHPD©eObjeù
->
	`fÜm©
('n');

1301 
	}
}

1317 
public
 
funùiÚ
 
	$YEAR
(
$d©eV®ue
 = 1)

1319 
$d©eV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($dateValue);

1321 ià(
$d©eV®ue
 ==ğ
nuÎ
) {

1322 
$d©eV®ue
 = 1;

1323 } 
	`–£if
 (
	`is_¡ršg
(
$d©eV®ue
 = 
£lf
::
	`g‘D©eV®ue
($dateValue))) {

1324  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1325 } 
	`–£if
 (
$d©eV®ue
 < 0.0) {

1326  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1330 
$PHPD©eObjeù
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$d©eV®ue
);

1332  (è
$PHPD©eObjeù
->
	`fÜm©
('Y');

1333 
	}
}

1349 
public
 
funùiÚ
 
	$HOUROFDAY
(
$timeV®ue
 = 0)

1351 
$timeV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($timeValue);

1353 ià(!
	`is_num”ic
(
$timeV®ue
)) {

1354 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

1355 
$‹¡V®
 = 
	`¡¹ok
(
$timeV®ue
, '/-: ');

1356 ià(
	`¡¾’
(
$‹¡V®
è< sŒËn(
$timeV®ue
)) {

1357  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1360 
$timeV®ue
 = 
£lf
::
	`g‘TimeV®ue
($timeValue);

1361 ià(
	`is_¡ršg
(
$timeV®ue
)) {

1362  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1366 ià(
$timeV®ue
 >= 1) {

1367 
$timeV®ue
 = 
	`fmod
($timeValue, 1);

1368 } 
	`–£if
 (
$timeV®ue
 < 0.0) {

1369  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1371 
$timeV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
($timeValue);

1373  (è
	`gmd©e
('G', 
$timeV®ue
);

1374 
	}
}

1390 
public
 
funùiÚ
 
	$MINUTEOFHOUR
(
$timeV®ue
 = 0)

1392 
$timeV®ue
 = 
$timeTe¡”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($timeValue);

1394 ià(!
	`is_num”ic
(
$timeV®ue
)) {

1395 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

1396 
$‹¡V®
 = 
	`¡¹ok
(
$timeV®ue
, '/-: ');

1397 ià(
	`¡¾’
(
$‹¡V®
è< sŒËn(
$timeV®ue
)) {

1398  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1401 
$timeV®ue
 = 
£lf
::
	`g‘TimeV®ue
($timeValue);

1402 ià(
	`is_¡ršg
(
$timeV®ue
)) {

1403  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1407 ià(
$timeV®ue
 >= 1) {

1408 
$timeV®ue
 = 
	`fmod
($timeValue, 1);

1409 } 
	`–£if
 (
$timeV®ue
 < 0.0) {

1410  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1412 
$timeV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
($timeValue);

1414  (è
	`gmd©e
('i', 
$timeV®ue
);

1415 
	}
}

1431 
public
 
funùiÚ
 
	$SECONDOFMINUTE
(
$timeV®ue
 = 0)

1433 
$timeV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($timeValue);

1435 ià(!
	`is_num”ic
(
$timeV®ue
)) {

1436 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

1437 
$‹¡V®
 = 
	`¡¹ok
(
$timeV®ue
, '/-: ');

1438 ià(
	`¡¾’
(
$‹¡V®
è< sŒËn(
$timeV®ue
)) {

1439  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1442 
$timeV®ue
 = 
£lf
::
	`g‘TimeV®ue
($timeValue);

1443 ià(
	`is_¡ršg
(
$timeV®ue
)) {

1444  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1448 ià(
$timeV®ue
 >= 1) {

1449 
$timeV®ue
 = 
	`fmod
($timeValue, 1);

1450 } 
	`–£if
 (
$timeV®ue
 < 0.0) {

1451  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1453 
$timeV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
($timeValue);

1455  (è
	`gmd©e
('s', 
$timeV®ue
);

1456 
	}
}

1478 
public
 
funùiÚ
 
	$EDATE
(
$d©eV®ue
 = 1, 
$adju¡m’tMÚths
 = 0)

1480 
$d©eV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($dateValue);

1481 
$adju¡m’tMÚths
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($adjustmentMonths);

1483 ià(!
	`is_num”ic
(
$adju¡m’tMÚths
)) {

1484  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1486 
$adju¡m’tMÚths
 = 
	`æoÜ
($adjustmentMonths);

1488 ià(
	`is_¡ršg
(
$d©eV®ue
 = 
£lf
::
	`g‘D©eV®ue
($dateValue))) {

1489  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1493 
$PHPD©eObjeù
 = 
£lf
::
	`adju¡D©eByMÚths
(
$d©eV®ue
, 
$adju¡m’tMÚths
);

1495 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
()) {

1496 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_EXCEL
:

1497  (è
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
$PHPD©eObjeù
);

1498 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_NUMERIC
:

1499  (
š‹g”
è
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
(PHPExûl_Sh¬ed_D©e::
	`PHPToExûl
(
$PHPD©eObjeù
));

1500 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_OBJECT
:

1501  
$PHPD©eObjeù
;

1503 
	}
}

1524 
public
 
funùiÚ
 
	$EOMONTH
(
$d©eV®ue
 = 1, 
$adju¡m’tMÚths
 = 0)

1526 
$d©eV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($dateValue);

1527 
$adju¡m’tMÚths
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($adjustmentMonths);

1529 ià(!
	`is_num”ic
(
$adju¡m’tMÚths
)) {

1530  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1532 
$adju¡m’tMÚths
 = 
	`æoÜ
($adjustmentMonths);

1534 ià(
	`is_¡ršg
(
$d©eV®ue
 = 
£lf
::
	`g‘D©eV®ue
($dateValue))) {

1535  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1539 
$PHPD©eObjeù
 = 
£lf
::
	`adju¡D©eByMÚths
(
$d©eV®ue
, 
$adju¡m’tMÚths
+1);

1540 
$adju¡Days
 = (è
$PHPD©eObjeù
->
	`fÜm©
('d');

1541 
$adju¡DaysSŒšg
 = '-' . 
$adju¡Days
 . ' days';

1542 
$PHPD©eObjeù
->
	`modify
(
$adju¡DaysSŒšg
);

1544 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
()) {

1545 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_EXCEL
:

1546  (è
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
$PHPD©eObjeù
);

1547 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_NUMERIC
:

1548  (
š‹g”
è
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
(PHPExûl_Sh¬ed_D©e::
	`PHPToExûl
(
$PHPD©eObjeù
));

1549 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_PHP_OBJECT
:

1550  
$PHPD©eObjeù
;

1552 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Engineering.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

13 
defše
('EULER', 2.71828182845904523536);

40 şas 
	cPHPExûl_C®cuÏtiÚ_Engš“ršg


47 
´iv©e
 
	m$cÚv”siÚUn™s
 = 
¬¿y
(

48 'g' => 
¬¿y
('Group' => 'Mass', 'Un™ Name' => 'G¿m', 'AÎowP»fix' => 
Œue
),

49 'sg' => 
¬¿y
('Group' => 'Mass', 'Un™ Name' => 'Slug', 'AÎowP»fix' => 
çl£
),

50 'lbm' => 
¬¿y
('Group' => 'Mass', 'Un™ Name' => 'Pound mas ×voœdupois)', 'AÎowP»fix' => 
çl£
),

51 'u' => 
¬¿y
('Group' => 'Mass', 'Un™ Name' => 'U (©omiømas un™)', 'AÎowP»fix' => 
Œue
),

52 'ozm' => 
¬¿y
('Group' => 'Mass', 'Un™ Name' => 'Ounû mas ×voœdupois)', 'AÎowP»fix' => 
çl£
),

53 'm' => 
¬¿y
('Group' => 'Di¡ªû', 'Un™ Name' => 'M‘”', 'AÎowP»fix' => 
Œue
),

54 'mi' => 
¬¿y
('Group' => 'Di¡ªû', 'Un™ Name' => 'Stu‹ me', 'AÎowP»fix' => 
çl£
),

55 'Nmi' => 
¬¿y
('Group' => 'Di¡ªû', 'Un™ Name' => 'NautiÿÈme', 'AÎowP»fix' => 
çl£
),

56 'š' => 
¬¿y
('Group' => 'Di¡ªû', 'Un™ Name' => 'Inch', 'AÎowP»fix' => 
çl£
),

57 'á' => 
¬¿y
('Group' => 'Di¡ªû', 'Un™ Name' => 'FoÙ', 'AÎowP»fix' => 
çl£
),

58 'yd' => 
¬¿y
('Group' => 'Di¡ªû', 'Un™ Name' => 'Y¬d', 'AÎowP»fix' => 
çl£
),

59 'ªg' => 
¬¿y
('Group' => 'Di¡ªû', 'Un™ Name' => 'Ang¡rom', 'AÎowP»fix' => 
Œue
),

60 'Piÿ' => 
¬¿y
('Group' => 'Di¡ªû', 'Un™ Name' => 'Piÿ (1/72 in)', 'AÎowP»fix' => 
çl£
),

61 'yr' => 
¬¿y
('Group' => 'Time', 'Un™ Name' => 'Y—r', 'AÎowP»fix' => 
çl£
),

62 'day' => 
¬¿y
('Group' => 'Time', 'Un™ Name' => 'Day', 'AÎowP»fix' => 
çl£
),

63 'hr' => 
¬¿y
('Group' => 'Time', 'Un™ Name' => 'Hour', 'AÎowP»fix' => 
çl£
),

64 'mn' => 
¬¿y
('Group' => 'Time', 'Un™ Name' => 'Mšu‹', 'AÎowP»fix' => 
çl£
),

65 '£c' => 
¬¿y
('Group' => 'Time', 'Un™ Name' => 'SecÚd', 'AÎowP»fix' => 
Œue
),

66 'Pa' => 
¬¿y
('Group' => 'P»ssu»', 'Un™ Name' => 'Pasÿl', 'AÎowP»fix' => 
Œue
),

67 'p' => 
¬¿y
('Group' => 'P»ssu»', 'Un™ Name' => 'Pasÿl', 'AÎowP»fix' => 
Œue
),

68 '©m' => 
¬¿y
('Group' => 'P»ssu»', 'Un™ Name' => 'Atmo¥h”e', 'AÎowP»fix' => 
Œue
),

69 '©' => 
¬¿y
('Group' => 'P»ssu»', 'Un™ Name' => 'Atmo¥h”e', 'AÎowP»fix' => 
Œue
),

70 'mmHg' => 
¬¿y
('Group' => 'P»ssu»', 'Un™ Name' => 'mm oàM”cury', 'AÎowP»fix' => 
Œue
),

71 'N' => 
¬¿y
('Group' => 'FÜû', 'Un™ Name' => 'NewtÚ', 'AÎowP»fix' => 
Œue
),

72 'dyn' => 
¬¿y
('Group' => 'FÜû', 'Un™ Name' => 'DyÃ', 'AÎowP»fix' => 
Œue
),

73 'dy' => 
¬¿y
('Group' => 'FÜû', 'Un™ Name' => 'DyÃ', 'AÎowP»fix' => 
Œue
),

74 'lbf' => 
¬¿y
('Group' => 'FÜû', 'Un™ Name' => 'Pound fÜû', 'AÎowP»fix' => 
çl£
),

75 'J' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'JouË', 'AÎowP»fix' => 
Œue
),

76 'e' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'Erg', 'AÎowP»fix' => 
Œue
),

77 'c' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'Th”modyÇmiøÿlÜ›', 'AÎowP»fix' => 
Œue
),

78 'ÿl' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'IT c®Ü›', 'AÎowP»fix' => 
Œue
),

79 'eV' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'EËùrÚ vŞt', 'AÎowP»fix' => 
Œue
),

80 'ev' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'EËùrÚ vŞt', 'AÎowP»fix' => 
Œue
),

81 'HPh' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'HÜ£pow”-hour', 'AÎowP»fix' => 
çl£
),

82 'hh' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'HÜ£pow”-hour', 'AÎowP»fix' => 
çl£
),

83 'Wh' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'W©t-hour', 'AÎowP»fix' => 
Œue
),

84 'wh' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'W©t-hour', 'AÎowP»fix' => 
Œue
),

85 'æb' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'FoÙ-pound', 'AÎowP»fix' => 
çl£
),

86 'BTU' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'BTU', 'AÎowP»fix' => 
çl£
),

87 'btu' => 
¬¿y
('Group' => 'EÃrgy', 'Un™ Name' => 'BTU', 'AÎowP»fix' => 
çl£
),

88 'HP' => 
¬¿y
('Group' => 'Pow”', 'Un™ Name' => 'HÜ£pow”', 'AÎowP»fix' => 
çl£
),

89 'h' => 
¬¿y
('Group' => 'Pow”', 'Un™ Name' => 'HÜ£pow”', 'AÎowP»fix' => 
çl£
),

90 'W' => 
¬¿y
('Group' => 'Pow”', 'Un™ Name' => 'W©t', 'AÎowP»fix' => 
Œue
),

91 'w' => 
¬¿y
('Group' => 'Pow”', 'Un™ Name' => 'W©t', 'AÎowP»fix' => 
Œue
),

92 'T' => 
¬¿y
('Group' => 'MagÃtism', 'Un™ Name' => 'Te¦a', 'AÎowP»fix' => 
Œue
),

93 'ga' => 
¬¿y
('Group' => 'MagÃtism', 'Un™ Name' => 'Gauss', 'AÎowP»fix' => 
Œue
),

94 'C' => 
¬¿y
('Group' => 'Tem³¿tu»', 'Un™ Name' => 'C–sius', 'AÎowP»fix' => 
çl£
),

95 'ûl' => 
¬¿y
('Group' => 'Tem³¿tu»', 'Un™ Name' => 'C–sius', 'AÎowP»fix' => 
çl£
),

96 'F' => 
¬¿y
('Group' => 'Tem³¿tu»', 'Un™ Name' => 'Fah»nhe™', 'AÎowP»fix' => 
çl£
),

97 'çh' => 
¬¿y
('Group' => 'Tem³¿tu»', 'Un™ Name' => 'Fah»nhe™', 'AÎowP»fix' => 
çl£
),

98 'K' => 
¬¿y
('Group' => 'Tem³¿tu»', 'Un™ Name' => 'K–vš', 'AÎowP»fix' => 
çl£
),

99 'k–' => 
¬¿y
('Group' => 'Tem³¿tu»', 'Un™ Name' => 'K–vš', 'AÎowP»fix' => 
çl£
),

100 't¥' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'T—¥oÚ', 'AÎowP»fix' => 
çl£
),

101 'tbs' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'TabË¥oÚ', 'AÎowP»fix' => 
çl£
),

102 'oz' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'Fluid Ounû', 'AÎowP»fix' => 
çl£
),

103 'cup' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'Cup', 'AÎowP»fix' => 
çl£
),

104 '±' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'U.S. Pšt', 'AÎowP»fix' => 
çl£
),

105 'us_±' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'U.S. Pšt', 'AÎowP»fix' => 
çl£
),

106 'uk_±' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'U.K. Pšt', 'AÎowP»fix' => 
çl£
),

107 'qt' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'Qu¬t', 'AÎowP»fix' => 
çl£
),

108 'g®' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'G®lÚ', 'AÎowP»fix' => 
çl£
),

109 'l' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'L™»', 'AÎowP»fix' => 
Œue
),

110 'É' => 
¬¿y
('Group' => 'Liquid', 'Un™ Name' => 'L™»', 'AÎowP»fix' => 
Œue
),

118 
´iv©e
 
	m$cÚv”siÚMuÉl›rs
 = 
¬¿y
(

119 'Y' => 
¬¿y
('multiplier' => 1E24, 'name' => 'yotta'),

120 'Z' => 
¬¿y
('multiplier' => 1E21, 'name' => 'zetta'),

121 'E' => 
¬¿y
('multiplier' => 1E18, 'name' => 'exa'),

122 'P' => 
¬¿y
('multiplier' => 1E15, 'name' => 'peta'),

123 'T' => 
¬¿y
('multiplier' => 1E12, 'name' => 'tera'),

124 'G' => 
¬¿y
('multiplier' => 1E9, 'name' => 'giga'),

125 'M' => 
¬¿y
('multiplier' => 1E6, 'name' => 'mega'),

126 'k' => 
¬¿y
('multiplier' => 1E3, 'name' => 'kilo'),

127 'h' => 
¬¿y
('multiplier' => 1E2, 'name' => 'hecto'),

128 'e' => 
¬¿y
('multiplier' => 1E1, 'name' => 'deka'),

129 'd' => 
¬¿y
('multiplier' => 1E-1, 'name' => 'deci'),

130 'c' => 
¬¿y
('multiplier' => 1E-2, 'name' => 'centi'),

131 'm' => 
¬¿y
('multiplier' => 1E-3, 'name' => 'milli'),

132 'u' => 
¬¿y
('multiplier' => 1E-6, 'name' => 'micro'),

133 'n' => 
¬¿y
('multiplier' => 1E-9, 'name' => 'nano'),

134 'p' => 
¬¿y
('multiplier' => 1E-12, 'name' => 'pico'),

135 'f' => 
¬¿y
('multiplier' => 1E-15, 'name' => 'femto'),

136 'a' => 
¬¿y
('multiplier' => 1E-18, 'name' => 'atto'),

137 'z' => 
¬¿y
('multiplier' => 1E-21, 'name' => 'zepto'),

138 'y' => 
¬¿y
('multiplier' => 1E-24, 'name' => 'yocto'),

146 
´iv©e
 
	m$un™CÚv”siÚs
 = 
¬¿y
(

147 'Mass' => 
¬¿y
(

148 'g' => 
¬¿y
(

155 'sg' => 
¬¿y
(

162 'lbm' => 
¬¿y
(

169 'u' => 
¬¿y
(

176 'ozm' => 
¬¿y
(

184 'Di¡ªû' => 
¬¿y
(

185 'm' => 
¬¿y
(

195 'mi' => 
¬¿y
(

205 'Nmi' => 
¬¿y
(

215 'š' => 
¬¿y
(

225 'á' => 
¬¿y
(

235 'yd' => 
¬¿y
(

245 'ªg' => 
¬¿y
(

255 'Piÿ' => 
¬¿y
(

266 'Time' => 
¬¿y
(

267 'yr' => 
¬¿y
(

274 'day' => 
¬¿y
(

281 'hr' => 
¬¿y
(

288 'mn' => 
¬¿y
(

295 '£c' => 
¬¿y
(

303 'P»ssu»' => 
¬¿y
(

304 'Pa' => 
¬¿y
(

311 'p' => 
¬¿y
(

318 '©m' => 
¬¿y
(

325 '©' => 
¬¿y
(

332 'mmHg' => 
¬¿y
(

340 'FÜû' => 
¬¿y
(

341 'N' => 
¬¿y
(

347 'dyn' => 
¬¿y
(

353 'dy' => 
¬¿y
(

359 'lbf' => 
¬¿y
(

366 'EÃrgy' => 
¬¿y
(

367 'J' => 
¬¿y
(

382 'e' => 
¬¿y
(

397 'c' => 
¬¿y
(

412 'ÿl' => 
¬¿y
(

427 'eV' => 
¬¿y
(

442 'ev' => 
¬¿y
(

457 'HPh' => 
¬¿y
(

472 'hh' => 
¬¿y
(

487 'Wh' => 
¬¿y
(

502 'wh' => 
¬¿y
(

517 'æb' => 
¬¿y
(

532 'BTU' => 
¬¿y
(

547 'btu' => 
¬¿y
(

563 'Pow”' => 
¬¿y
(

564 'HP' => 
¬¿y
(

570 'h' => 
¬¿y
(

576 'W' => 
¬¿y
(

582 'w' => 
¬¿y
(

589 'MagÃtism' => 
¬¿y
(

590 'T' => 
¬¿y
(

594 'ga' => 
¬¿y
(

599 'Liquid' => 
¬¿y
(

600 't¥' => 
¬¿y
(

613 'tbs' => 
¬¿y
(

626 'oz' => 
¬¿y
(

639 'cup' => 
¬¿y
(

652 '±' => 
¬¿y
(

665 'us_±' => 
¬¿y
(

678 'uk_±' => 
¬¿y
(

691 'qt' => 
¬¿y
(

704 'g®' => 
¬¿y
(

717 'l' => 
¬¿y
(

730 'É' => 
¬¿y
(

755 
public
 
funùiÚ
 
	$·r£Com¶ex
(
$com¶exNumb”
)

757 
$wÜkSŒšg
 = (
¡ršg
è
$com¶exNumb”
;

759 
$»®Numb”
 = 
$imagš¬y
 = 0;

761 
$suffix
 = 
	`sub¡r
(
$wÜkSŒšg
, -1);

762 ià(!
	`is_num”ic
(
$suffix
)) {

763 
$wÜkSŒšg
 = 
	`sub¡r
($workString, 0, -1);

765 
$suffix
 = '';

769 
$ËadšgSign
 = 0;

770 ià(
	`¡¾’
(
$wÜkSŒšg
) > 0) {

771 
$ËadšgSign
 = ((
$wÜkSŒšg
{0} == '+') || ($workString{0} == '-')) ? 1 : 0;

773 
$pow”
 = '';

774 
$»®Numb”
 = 
	`¡¹ok
(
$wÜkSŒšg
, '+-');

775 ià(
	`¡¹ouµ”
(
	`sub¡r
(
$»®Numb”
, -1)) == 'E') {

776 
$pow”
 = 
	`¡¹ok
('+-');

777 ++
$ËadšgSign
;

780 
$»®Numb”
 = 
	`sub¡r
(
$wÜkSŒšg
, 0, 
	`¡¾’
($»®Numb”)+¡¾’(
$pow”
)+
$ËadšgSign
);

782 ià(
$suffix
 != '') {

783 
$imagš¬y
 = 
	`sub¡r
(
$wÜkSŒšg
, 
	`¡¾’
(
$»®Numb”
));

785 ià((
$imagš¬y
 =ğ''è&& ((
$»®Numb”
 == '') || ($realNumber == '+') || ($realNumber == '-'))) {

786 
$imagš¬y
 = 
$»®Numb”
.'1';

787 
$»®Numb”
 = '0';

788 } 
	`–£if
 (
$imagš¬y
 == '') {

789 
$imagš¬y
 = 
$»®Numb”
;

790 
$»®Numb”
 = '0';

791 } 
	`–£if
 ((
$imagš¬y
 == '+') || ($imaginary == '-')) {

792 
$imagš¬y
 .= '1';

796  
	`¬¿y
(

797 '»®' => 
$»®Numb”
,

798 'imagš¬y' => 
$imagš¬y
,

799 'suffix' => 
$suffix


810 
´iv©e
 
funùiÚ
 
	$ş—nCom¶ex
(
$com¶exNumb”
)

812 ià(
$com¶exNumb”
{0} == '+') {

813 
$com¶exNumb”
 = 
	`sub¡r
($complexNumber, 1);

815 ià(
$com¶exNumb”
{0} == '0') {

816 
$com¶exNumb”
 = 
	`sub¡r
($complexNumber, 1);

818 ià(
$com¶exNumb”
{0} == '.') {

819 
$com¶exNumb”
 = '0'.$complexNumber;

821 ià(
$com¶exNumb”
{0} == '+') {

822 
$com¶exNumb”
 = 
	`sub¡r
($complexNumber, 1);

824  
$com¶exNumb”
;

825 
	}
}

834 
´iv©e
 
funùiÚ
 
	$nbrCÚv”siÚFÜm©
(
$xV®
, 
$¶aûs
)

836 ià(!
	`is_nuÎ
(
$¶aûs
)) {

837 ià(
	`¡¾’
(
$xV®
è<ğ
$¶aûs
) {

838  
	`sub¡r
(
	`¡r_·d
(
$xV®
, 
$¶aûs
, '0', 
STR_PAD_LEFT
), -10);

840  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

844  
	`sub¡r
(
$xV®
, -10);

845 
	}
}

867 
public
 
funùiÚ
 
	$BESSELI
(
$x
, 
$Üd
)

869 
$x
 = (
	`is_nuÎ
($x)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

870 
$Üd
 = (
	`is_nuÎ
($Üd)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($ord);

872 ià((
	`is_num”ic
(
$x
)è&& (is_num”ic(
$Üd
))) {

873 
$Üd
 = 
	`æoÜ
($ord);

874 ià(
$Üd
 < 0) {

875  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

878 ià(
	`abs
(
$x
) <= 30) {

879 
$fResuÉ
 = 
$fT”m
 = 
	`pow
(
$x
 / 2, 
$Üd
è/ 
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`FACT
($ord);

880 
$ÜdK
 = 1;

881 
$fSqrX
 = (
$x
 * $x) / 4;

883 
$fT”m
 *ğ
$fSqrX
;

884 
$fT”m
 /ğ(
$ÜdK
 * ($ÜdK + 
$Üd
));

885 
$fResuÉ
 +ğ
$fT”m
;

886 } (
	`abs
(
$fT”m
è> 1e-12è&& (++
$ÜdK
 < 100));

888 
$f_2_PI
 = 2 * 
M_PI
;

890 
$fXAbs
 = 
	`abs
(
$x
);

891 
$fResuÉ
 = 
	`exp
(
$fXAbs
è/ 
	`sq¹
(
$f_2_PI
 * $fXAbs);

892 ià((
$Üd
 & 1è&& (
$x
 < 0)) {

893 
$fResuÉ
 = -$fResult;

896  (
	`is_Çn
(
$fResuÉ
)è? 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
() : $fResult;

898  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

899 
	}
}

920 
public
 
funùiÚ
 
	$BESSELJ
(
$x
, 
$Üd
)

922 
$x
 = (
	`is_nuÎ
($x)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

923 
$Üd
 = (
	`is_nuÎ
($Üd)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($ord);

925 ià((
	`is_num”ic
(
$x
)è&& (is_num”ic(
$Üd
))) {

926 
$Üd
 = 
	`æoÜ
($ord);

927 ià(
$Üd
 < 0) {

928  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

931 
$fResuÉ
 = 0;

932 ià(
	`abs
(
$x
) <= 30) {

933 
$fResuÉ
 = 
$fT”m
 = 
	`pow
(
$x
 / 2, 
$Üd
è/ 
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`FACT
($ord);

934 
$ÜdK
 = 1;

935 
$fSqrX
 = (
$x
 * $x) / -4;

937 
$fT”m
 *ğ
$fSqrX
;

938 
$fT”m
 /ğ(
$ÜdK
 * ($ÜdK + 
$Üd
));

939 
$fResuÉ
 +ğ
$fT”m
;

940 } (
	`abs
(
$fT”m
è> 1e-12è&& (++
$ÜdK
 < 100));

942 
$f_PI_DIV_2
 = 
M_PI
 / 2;

943 
$f_PI_DIV_4
 = 
M_PI
 / 4;

945 
$fXAbs
 = 
	`abs
(
$x
);

946 
$fResuÉ
 = 
	`sq¹
(
M_2DIVPI
 / 
$fXAbs
è* 
	`cos
($fXAb - 
$Üd
 * 
$f_PI_DIV_2
 - 
$f_PI_DIV_4
);

947 ià((
$Üd
 & 1è&& (
$x
 < 0)) {

948 
$fResuÉ
 = -$fResult;

951  (
	`is_Çn
(
$fResuÉ
)è? 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
() : $fResult;

953  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

954 
	}
}

957 
´iv©e
 
funùiÚ
 
	$bes£lK0
(
$fNum
)

959 ià(
$fNum
 <= 2) {

960 
$fNum2
 = 
$fNum
 * 0.5;

961 
$y
 = (
$fNum2
 * $fNum2);

962 
$fR‘
 = -
	`log
(
$fNum2
è* 
£lf
::
	`BESSELI
(
$fNum
, 0) +

963 (-0.57721566 + 
$y
 * (0.42278420 + $y * (0.23069756 + $y * (0.3488590e-1 + $y * (0.262698e-2 + $y *

964 (0.10750e-3 + 
$y
 * 0.74e-5))))));

966 
$y
 = 2 / 
$fNum
;

967 
$fR‘
 = 
	`exp
(-
$fNum
è/ 
	`sq¹
($fNum) *

968 (1.25331414 + 
$y
 * (-0.7832358e-1 + $y * (0.2189568e-1 + $y * (-0.1062446e-1 + $y *

969 (0.587872e-2 + 
$y
 * (-0.251540e-2 + $y * 0.53208e-3))))));

971  
$fR‘
;

972 
	}
}

975 
´iv©e
 
funùiÚ
 
	$bes£lK1
(
$fNum
)

977 ià(
$fNum
 <= 2) {

978 
$fNum2
 = 
$fNum
 * 0.5;

979 
$y
 = (
$fNum2
 * $fNum2);

980 
$fR‘
 = 
	`log
(
$fNum2
è* 
£lf
::
	`BESSELI
(
$fNum
, 1) +

981 (1 + 
$y
 * (0.15443144 + $y * (-0.67278579 + $y * (-0.18156897 + $y * (-0.1919402e-1 + $y *

982 (-0.110404e-2 + 
$y
 * (-0.4686e-4))))))è/ 
$fNum
;

984 
$y
 = 2 / 
$fNum
;

985 
$fR‘
 = 
	`exp
(-
$fNum
è/ 
	`sq¹
($fNum) *

986 (1.25331414 + 
$y
 * (0.23498619 + $y * (-0.3655620e-1 + $y * (0.1504268e-1 + $y * (-0.780353e-2 + $y *

987 (0.325614e-2 + 
$y
 * (-0.68245e-3)))))));

989  
$fR‘
;

990 
	}
}

1012 
public
 
funùiÚ
 
	$BESSELK
(
$x
, 
$Üd
)

1014 
$x
 = (
	`is_nuÎ
($x)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1015 
$Üd
 = (
	`is_nuÎ
($Üd)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($ord);

1017 ià((
	`is_num”ic
(
$x
)è&& (is_num”ic(
$Üd
))) {

1018 ià((
$Üd
 < 0è|| (
$x
 == 0.0)) {

1019  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1022 
	`æoÜ
(
$Üd
)) {

1024  
£lf
::
	`bes£lK0
(
$x
);

1026  
£lf
::
	`bes£lK1
(
$x
);

1028 
$fTox
 = 2 / 
$x
;

1029 
$fBkm
 = 
£lf
::
	`bes£lK0
(
$x
);

1030 
$fBk
 = 
£lf
::
	`bes£lK1
(
$x
);

1031 
$n
 = 1; $À< 
$Üd
; ++$n) {

1032 
$fBkp
 = 
$fBkm
 + 
$n
 * 
$fTox
 * 
$fBk
;

1033 
$fBkm
 = 
$fBk
;

1034 
$fBk
 = 
$fBkp
;

1037  (
	`is_Çn
(
$fBk
)è? 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
() : $fBk;

1039  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1040 
	}
}

1043 
´iv©e
 
funùiÚ
 
	$bes£lY0
(
$fNum
)

1045 ià(
$fNum
 < 8.0) {

1046 
$y
 = (
$fNum
 * $fNum);

1047 
$f1
 = -2957821389.0 + 
$y
 * (7062834065.0 + $y * (-512359803.6 + $y * (10879881.29 + $y * (-86327.92757 + $y * 228.4622733))));

1048 
$f2
 = 40076544269.0 + 
$y
 * (745249964.8 + $y * (7189466.438 + $y * (47447.26470 + $y * (226.1030244 + $y))));

1049 
$fR‘
 = 
$f1
 / 
$f2
 + 0.636619772 * 
£lf
::
	`BESSELJ
(
$fNum
, 0è* 
	`log
($fNum);

1051 
$z
 = 8.0 / 
$fNum
;

1052 
$y
 = (
$z
 * $z);

1053 
$xx
 = 
$fNum
 - 0.785398164;

1054 
$f1
 = 1 + 
$y
 * (-0.1098628627e-2 + $y * (0.2734510407e-4 + $y * (-0.2073370639e-5 + $y * 0.2093887211e-6)));

1055 
$f2
 = -0.1562499995e-1 + 
$y
 * (0.1430488765e-3 + $y * (-0.6911147651e-5 + $y * (0.7621095161e-6 + $y * (-0.934945152e-7))));

1056 
$fR‘
 = 
	`sq¹
(0.636619772 / 
$fNum
è* (
	`sš
(
$xx
è* 
$f1
 + 
$z
 * 
	`cos
($xxè* 
$f2
);

1058  
$fR‘
;

1059 
	}
}

1062 
´iv©e
 
funùiÚ
 
	$bes£lY1
(
$fNum
)

1064 ià(
$fNum
 < 8.0) {

1065 
$y
 = (
$fNum
 * $fNum);

1066 
$f1
 = 
$fNum
 * (-0.4900604943e13 + 
$y
 * (0.1275274390e13 + $y * (-0.5153438139e11 + $y * (0.7349264551e9 + $y *

1067 (-0.4237922726e7 + 
$y
 * 0.8511937935e4)))));

1068 
$f2
 = 0.2499580570e14 + 
$y
 * (0.4244419664e12 + $y * (0.3733650367e10 + $y * (0.2245904002e8 + $y *

1069 (0.1020426050e6 + 
$y
 * (0.3549632885e3 + $y)))));

1070 
$fR‘
 = 
$f1
 / 
$f2
 + 0.636619772 * ( 
£lf
::
	`BESSELJ
(
$fNum
, 1è* 
	`log
($fNum) - 1 / $fNum);

1072 
$fR‘
 = 
	`sq¹
(0.636619772 / 
$fNum
è* 
	`sš
($fNum - 2.356194491);

1074  
$fR‘
;

1075 
	}
}

1096 
public
 
funùiÚ
 
	$BESSELY
(
$x
, 
$Üd
)

1098 
$x
 = (
	`is_nuÎ
($x)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1099 
$Üd
 = (
	`is_nuÎ
($Üd)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($ord);

1101 ià((
	`is_num”ic
(
$x
)è&& (is_num”ic(
$Üd
))) {

1102 ià((
$Üd
 < 0è|| (
$x
 == 0.0)) {

1103  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1106 
	`æoÜ
(
$Üd
)) {

1108  
£lf
::
	`bes£lY0
(
$x
);

1110  
£lf
::
	`bes£lY1
(
$x
);

1112 
$fTox
 = 2 / 
$x
;

1113 
$fBym
 = 
£lf
::
	`bes£lY0
(
$x
);

1114 
$fBy
 = 
£lf
::
	`bes£lY1
(
$x
);

1115 
$n
 = 1; $À< 
$Üd
; ++$n) {

1116 
$fByp
 = 
$n
 * 
$fTox
 * 
$fBy
 - 
$fBym
;

1117 
$fBym
 = 
$fBy
;

1118 
$fBy
 = 
$fByp
;

1121  (
	`is_Çn
(
$fBy
)è? 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
() : $fBy;

1123  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1124 
	}
}

1145 
public
 
funùiÚ
 
	$BINTODEC
(
$x
)

1147 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1149 ià(
	`is_boŞ
(
$x
)) {

1150 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

1151 
$x
 = () $x;

1153  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1156 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

1157 
$x
 = 
	`æoÜ
($x);

1159 
$x
 = (
¡ršg
) $x;

1160 ià(
	`¡¾’
(
$x
è> 
	`´eg_m©ch_®l
('/[01]/', $x, 
$out
)) {

1161  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1163 ià(
	`¡¾’
(
$x
) > 10) {

1164  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1165 } 
	`–£if
 (
	`¡¾’
(
$x
) == 10) {

1167 
$x
 = 
	`sub¡r
($x, -9);

1168  '-'.(512-
	`bšdec
(
$x
));

1170  
	`bšdec
(
$x
);

1171 
	}
}

1198 
public
 
funùiÚ
 
	$BINTOHEX
(
$x
, 
$¶aûs
 = 
nuÎ
)

1200 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1201 
$¶aûs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($places);

1203 ià(
	`is_boŞ
(
$x
)) {

1204 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

1205 
$x
 = () $x;

1207  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1210 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

1211 
$x
 = 
	`æoÜ
($x);

1213 
$x
 = (
¡ršg
) $x;

1214 ià(
	`¡¾’
(
$x
è> 
	`´eg_m©ch_®l
('/[01]/', $x, 
$out
)) {

1215  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1217 ià(
	`¡¾’
(
$x
) > 10) {

1218  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1219 } 
	`–£if
 (
	`¡¾’
(
$x
) == 10) {

1221  
	`¡r_»³©
('F', 8).
	`sub¡r
(
	`¡¹ouµ”
(
	`dechex
(
	`bšdec
(sub¡r(
$x
, -9)))), -2);

1223 
$hexV®
 = (
¡ršg
è
	`¡¹ouµ”
(
	`dechex
(
	`bšdec
(
$x
)));

1225  
£lf
::
	`nbrCÚv”siÚFÜm©
(
$hexV®
, 
$¶aûs
);

1226 
	}
}

1253 
public
 
funùiÚ
 
	$BINTOOCT
(
$x
, 
$¶aûs
 = 
nuÎ
)

1255 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1256 
$¶aûs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($places);

1258 ià(
	`is_boŞ
(
$x
)) {

1259 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

1260 
$x
 = () $x;

1262  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1265 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

1266 
$x
 = 
	`æoÜ
($x);

1268 
$x
 = (
¡ršg
) $x;

1269 ià(
	`¡¾’
(
$x
è> 
	`´eg_m©ch_®l
('/[01]/', $x, 
$out
)) {

1270  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1272 ià(
	`¡¾’
(
$x
) > 10) {

1273  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1274 } 
	`–£if
 (
	`¡¾’
(
$x
) == 10) {

1276  
	`¡r_»³©
('7', 7).
	`sub¡r
(
	`¡¹ouµ”
(
	`decoù
(
	`bšdec
(sub¡r(
$x
, -9)))), -3);

1278 
$oùV®
 = (
¡ršg
è
	`decoù
(
	`bšdec
(
$x
));

1280  
£lf
::
	`nbrCÚv”siÚFÜm©
(
$oùV®
, 
$¶aûs
);

1281 
	}
}

1312 
public
 
funùiÚ
 
	$DECTOBIN
(
$x
, 
$¶aûs
 = 
nuÎ
)

1314 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1315 
$¶aûs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($places);

1317 ià(
	`is_boŞ
(
$x
)) {

1318 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

1319 
$x
 = () $x;

1321  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1324 
$x
 = (
¡ršg
) $x;

1325 ià(
	`¡¾’
(
$x
è> 
	`´eg_m©ch_®l
('/[-0123456789.]/', $x, 
$out
)) {

1326  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1328 
$x
 = (
¡ršg
è
	`æoÜ
($x);

1329 
$r
 = 
	`decbš
(
$x
);

1330 ià(
	`¡¾’
(
$r
) == 32) {

1332 
$r
 = 
	`sub¡r
($r, -10);

1333 } 
	`–£if
 (
	`¡¾’
(
$r
) > 11) {

1334  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1337  
£lf
::
	`nbrCÚv”siÚFÜm©
(
$r
, 
$¶aûs
);

1338 
	}
}

1369 
public
 
funùiÚ
 
	$DECTOHEX
(
$x
, 
$¶aûs
 = 
nuÎ
)

1371 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1372 
$¶aûs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($places);

1374 ià(
	`is_boŞ
(
$x
)) {

1375 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

1376 
$x
 = () $x;

1378  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1381 
$x
 = (
¡ršg
) $x;

1382 ià(
	`¡¾’
(
$x
è> 
	`´eg_m©ch_®l
('/[-0123456789.]/', $x, 
$out
)) {

1383  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1385 
$x
 = (
¡ršg
è
	`æoÜ
($x);

1386 
$r
 = 
	`¡¹ouµ”
(
	`dechex
(
$x
));

1387 ià(
	`¡¾’
(
$r
) == 8) {

1389 
$r
 = 'FF'.$r;

1392  
£lf
::
	`nbrCÚv”siÚFÜm©
(
$r
, 
$¶aûs
);

1393 
	}
}

1424 
public
 
funùiÚ
 
	$DECTOOCT
(
$x
, 
$¶aûs
 = 
nuÎ
)

1426 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1427 
$¶aûs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($places);

1429 ià(
	`is_boŞ
(
$x
)) {

1430 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

1431 
$x
 = () $x;

1433  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1436 
$x
 = (
¡ršg
) $x;

1437 ià(
	`¡¾’
(
$x
è> 
	`´eg_m©ch_®l
('/[-0123456789.]/', $x, 
$out
)) {

1438  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1440 
$x
 = (
¡ršg
è
	`æoÜ
($x);

1441 
$r
 = 
	`decoù
(
$x
);

1442 ià(
	`¡¾’
(
$r
) == 11) {

1444 
$r
 = 
	`sub¡r
($r, -10);

1447  
£lf
::
	`nbrCÚv”siÚFÜm©
(
$r
, 
$¶aûs
);

1448 
	}
}

1482 
public
 
funùiÚ
 
	$HEXTOBIN
(
$x
, 
$¶aûs
 = 
nuÎ
)

1484 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1485 
$¶aûs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($places);

1487 ià(
	`is_boŞ
(
$x
)) {

1488  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1490 
$x
 = (
¡ršg
) $x;

1491 ià(
	`¡¾’
(
$x
è> 
	`´eg_m©ch_®l
('/[0123456789ABCDEF]/', 
	`¡¹ouµ”
($x), 
$out
)) {

1492  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1494 
$bšV®
 = 
	`decbš
(
	`hexdec
(
$x
));

1496  
	`sub¡r
(
£lf
::
	`nbrCÚv”siÚFÜm©
(
$bšV®
, 
$¶aûs
), -10);

1497 
	}
}

1519 
public
 
funùiÚ
 
	$HEXTODEC
(
$x
)

1521 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1523 ià(
	`is_boŞ
(
$x
)) {

1524  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1526 
$x
 = (
¡ršg
) $x;

1527 ià(
	`¡¾’
(
$x
è> 
	`´eg_m©ch_®l
('/[0123456789ABCDEF]/', 
	`¡¹ouµ”
($x), 
$out
)) {

1528  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1530  
	`hexdec
(
$x
);

1531 
	}
}

1566 
public
 
funùiÚ
 
	$HEXTOOCT
(
$x
, 
$¶aûs
 = 
nuÎ
)

1568 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1569 
$¶aûs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($places);

1571 ià(
	`is_boŞ
(
$x
)) {

1572  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1574 
$x
 = (
¡ršg
) $x;

1575 ià(
	`¡¾’
(
$x
è> 
	`´eg_m©ch_®l
('/[0123456789ABCDEF]/', 
	`¡¹ouµ”
($x), 
$out
)) {

1576  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1578 
$oùV®
 = 
	`decoù
(
	`hexdec
(
$x
));

1580  
£lf
::
	`nbrCÚv”siÚFÜm©
(
$oùV®
, 
$¶aûs
);

1581 
	}
}

1618 
public
 
funùiÚ
 
	$OCTTOBIN
(
$x
, 
$¶aûs
 = 
nuÎ
)

1620 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1621 
$¶aûs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($places);

1623 ià(
	`is_boŞ
(
$x
)) {

1624  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1626 
$x
 = (
¡ršg
) $x;

1627 ià(
	`´eg_m©ch_®l
('/[01234567]/', 
$x
, 
$out
è!ğ
	`¡¾’
($x)) {

1628  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1630 
$r
 = 
	`decbš
(
	`oùdec
(
$x
));

1632  
£lf
::
	`nbrCÚv”siÚFÜm©
(
$r
, 
$¶aûs
);

1633 
	}
}

1655 
public
 
funùiÚ
 
	$OCTTODEC
(
$x
)

1657 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1659 ià(
	`is_boŞ
(
$x
)) {

1660  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1662 
$x
 = (
¡ršg
) $x;

1663 ià(
	`´eg_m©ch_®l
('/[01234567]/', 
$x
, 
$out
è!ğ
	`¡¾’
($x)) {

1664  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1666  
	`oùdec
(
$x
);

1667 
	}
}

1699 
public
 
funùiÚ
 
	$OCTTOHEX
(
$x
, 
$¶aûs
 = 
nuÎ
)

1701 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

1702 
$¶aûs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($places);

1704 ià(
	`is_boŞ
(
$x
)) {

1705  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1707 
$x
 = (
¡ršg
) $x;

1708 ià(
	`´eg_m©ch_®l
('/[01234567]/', 
$x
, 
$out
è!ğ
	`¡¾’
($x)) {

1709  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1711 
$hexV®
 = 
	`¡¹ouµ”
(
	`dechex
(
	`oùdec
(
$x
)));

1713  
£lf
::
	`nbrCÚv”siÚFÜm©
(
$hexV®
, 
$¶aûs
);

1714 
	}
}

1733 
public
 
funùiÚ
 
COMPLEX
(
$»®Numb”
 = 0.0, 
$imagš¬y
 = 0.0, 
$suffix
 = 'i')

1735 
$»®Numb”
 = (
is_nuÎ
($»®Numb”)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($realNumber);

1736 
	g$imagš¬y
 = (
is_nuÎ
(
$imagš¬y
)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($imaginary);

1737 
	g$suffix
 = (
is_nuÎ
(
$suffix
)è? 'i' : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($suffix);

1739 ià(((
is_num”ic
(
$»®Numb”
)è&& (is_num”ic(
$imagš¬y
))) &&

1740 ((
	g$suffix
 =ğ'i'è|| (
$suffix
 == 'j') || ($suffix == ''))) {

1741 
$»®Numb”
 = () $realNumber;

1742 
	g$imagš¬y
 = (è
$imagš¬y
;

1744 ià(
	g$suffix
 == '') {

1745 
$suffix
 = 'i';

1747 ià(
	g$»®Numb”
 == 0.0) {

1748 ià(
$imagš¬y
 == 0.0) {

1749  (
¡ršg
) '0';

1750 } 
–£if
 (
$imagš¬y
 == 1.0) {

1751  (
¡ršg
è
$suffix
;

1752 } 
–£if
 (
$imagš¬y
 == -1.0) {

1753  (
¡ršg
è'-'.
$suffix
;

1755  (
	g¡ršg
è
	g$imagš¬y
.
	g$suffix
;

1756 } 
–£if
 (
$imagš¬y
 == 0.0) {

1757  (
¡ršg
è
$»®Numb”
;

1758 } 
–£if
 (
$imagš¬y
 == 1.0) {

1759  (
¡ršg
è
$»®Numb”
.'+'.
$suffix
;

1760 } 
–£if
 (
$imagš¬y
 == -1.0) {

1761  (
¡ršg
è
$»®Numb”
.'-'.
$suffix
;

1763 ià(
	g$imagš¬y
 > 0) {

1764 
	g$imagš¬y
 = (
¡ršg
è'+'.
$imagš¬y
;

1766  (
	g¡ršg
è
	g$»®Numb”
.
	g$imagš¬y
.
	g$suffix
;

1769  
	gPHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
();

1787 
public
 
funùiÚ
 
	$IMAGINARY
(
$com¶exNumb”
)

1789 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

1791 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

1792  
$·r£dCom¶ex
['imaginary'];

1793 
	}
}

1809 
public
 
funùiÚ
 
	$IMREAL
(
$com¶exNumb”
)

1811 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

1813 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

1814  
$·r£dCom¶ex
['real'];

1815 
	}
}

1829 
public
 
funùiÚ
 
	$IMABS
(
$com¶exNumb”
)

1831 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

1833 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

1835  
	`sq¹
(

1836 (
$·r£dCom¶ex
['real'] * $parsedComplex['real']) +

1837 (
$·r£dCom¶ex
['imaginary'] * $parsedComplex['imaginary'])

1839 
	}
}

1854 
public
 
funùiÚ
 
	$IMARGUMENT
(
$com¶exNumb”
)

1856 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

1858 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

1860 ià(
$·r£dCom¶ex
['real'] == 0.0) {

1861 ià(
$·r£dCom¶ex
['imaginary'] == 0.0) {

1863 } 
	`–£if
 (
$·r£dCom¶ex
['imaginary'] < 0.0) {

1864  
M_PI
 / -2;

1866  
M_PI
 / 2;

1868 } 
	`–£if
 (
$·r£dCom¶ex
['real'] > 0.0) {

1869  
	`©ª
(
$·r£dCom¶ex
['imaginary'] / $parsedComplex['real']);

1870 } 
	`–£if
 (
$·r£dCom¶ex
['imaginary'] < 0.0) {

1871  0 - (
M_PI
 - 
	`©ª
(
	`abs
(
$·r£dCom¶ex
['imaginary']) /‡bs($parsedComplex['real'])));

1873  
M_PI
 - 
	`©ª
(
$·r£dCom¶ex
['imagš¬y'] / 
	`abs
($parsedComplex['real']));

1875 
	}
}

1889 
public
 
funùiÚ
 
	$IMCONJUGATE
(
$com¶exNumb”
)

1891 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

1893 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

1895 ià(
$·r£dCom¶ex
['imaginary'] == 0.0) {

1896  
$·r£dCom¶ex
['real'];

1898  
£lf
::
	`ş—nCom¶ex
(

1899 
£lf
::
	`COMPLEX
(

1900 
$·r£dCom¶ex
['real'],

1901 0 - 
$·r£dCom¶ex
['imaginary'],

1902 
$·r£dCom¶ex
['suffix']

1906 
	}
}

1920 
public
 
funùiÚ
 
	$IMCOS
(
$com¶exNumb”
)

1922 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

1924 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

1926 ià(
$·r£dCom¶ex
['imaginary'] == 0.0) {

1927  
	`cos
(
$·r£dCom¶ex
['real']);

1929  
£lf
::
	`IMCONJUGATE
(

1930 
£lf
::
	`COMPLEX
(

1931 
	`cos
(
$·r£dCom¶ex
['»®']è* 
	`cosh
($parsedComplex['imaginary']),

1932 
	`sš
(
$·r£dCom¶ex
['»®']è* 
	`sšh
($parsedComplex['imaginary']),

1933 
$·r£dCom¶ex
['suffix']

1937 
	}
}

1951 
public
 
funùiÚ
 
	$IMSIN
(
$com¶exNumb”
)

1953 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

1955 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

1957 ià(
$·r£dCom¶ex
['imaginary'] == 0.0) {

1958  
	`sš
(
$·r£dCom¶ex
['real']);

1960  
£lf
::
	`COMPLEX
(

1961 
	`sš
(
$·r£dCom¶ex
['»®']è* 
	`cosh
($parsedComplex['imaginary']),

1962 
	`cos
(
$·r£dCom¶ex
['»®']è* 
	`sšh
($parsedComplex['imaginary']),

1963 
$·r£dCom¶ex
['suffix']

1966 
	}
}

1980 
public
 
funùiÚ
 
	$IMSQRT
(
$com¶exNumb”
)

1982 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

1984 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

1986 
$th‘a
 = 
£lf
::
	`IMARGUMENT
(
$com¶exNumb”
);

1987 
$d1
 = 
	`cos
(
$th‘a
 / 2);

1988 
$d2
 = 
	`sš
(
$th‘a
 / 2);

1989 
$r
 = 
	`sq¹
(sq¹((
$·r£dCom¶ex
['real'] * $parsedComplex['real']) + ($parsedComplex['imaginary'] * $parsedComplex['imaginary'])));

1991 ià(
$·r£dCom¶ex
['suffix'] == '') {

1992  
£lf
::
	`COMPLEX
(
$d1
 * 
$r
, 
$d2
 * $r);

1994  
£lf
::
	`COMPLEX
(
$d1
 * 
$r
, 
$d2
 * $r, 
$·r£dCom¶ex
['suffix']);

1996 
	}
}

2010 
public
 
funùiÚ
 
	$IMLN
(
$com¶exNumb”
)

2012 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

2014 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

2016 ià((
$·r£dCom¶ex
['real'] == 0.0) && ($parsedComplex['imaginary'] == 0.0)) {

2017  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2020 
$logR
 = 
	`log
(
	`sq¹
((
$·r£dCom¶ex
['real'] * $parsedComplex['real']) + ($parsedComplex['imaginary'] * $parsedComplex['imaginary'])));

2021 
$t
 = 
£lf
::
	`IMARGUMENT
(
$com¶exNumb”
);

2023 ià(
$·r£dCom¶ex
['suffix'] == '') {

2024  
£lf
::
	`COMPLEX
(
$logR
, 
$t
);

2026  
£lf
::
	`COMPLEX
(
$logR
, 
$t
, 
$·r£dCom¶ex
['suffix']);

2028 
	}
}

2042 
public
 
funùiÚ
 
	$IMLOG10
(
$com¶exNumb”
)

2044 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

2046 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

2048 ià((
$·r£dCom¶ex
['real'] == 0.0) && ($parsedComplex['imaginary'] == 0.0)) {

2049  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2050 } 
	`–£if
 ((
$·r£dCom¶ex
['real'] > 0.0) && ($parsedComplex['imaginary'] == 0.0)) {

2051  
	`log10
(
$·r£dCom¶ex
['real']);

2054  
£lf
::
	`IMPRODUCT
(
	`log10
(
EULER
), s–f::
	`IMLN
(
$com¶exNumb”
));

2055 
	}
}

2069 
public
 
funùiÚ
 
	$IMLOG2
(
$com¶exNumb”
)

2071 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

2073 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

2075 ià((
$·r£dCom¶ex
['real'] == 0.0) && ($parsedComplex['imaginary'] == 0.0)) {

2076  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2077 } 
	`–£if
 ((
$·r£dCom¶ex
['real'] > 0.0) && ($parsedComplex['imaginary'] == 0.0)) {

2078  
	`log
(
$·r£dCom¶ex
['real'], 2);

2081  
£lf
::
	`IMPRODUCT
(
	`log
(
EULER
, 2), s–f::
	`IMLN
(
$com¶exNumb”
));

2082 
	}
}

2096 
public
 
funùiÚ
 
	$IMEXP
(
$com¶exNumb”
)

2098 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

2100 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

2102 ià((
$·r£dCom¶ex
['real'] == 0.0) && ($parsedComplex['imaginary'] == 0.0)) {

2106 
$e
 = 
	`exp
(
$·r£dCom¶ex
['real']);

2107 
$eX
 = 
$e
 * 
	`cos
(
$·r£dCom¶ex
['imaginary']);

2108 
$eY
 = 
$e
 * 
	`sš
(
$·r£dCom¶ex
['imaginary']);

2110 ià(
$·r£dCom¶ex
['suffix'] == '') {

2111  
£lf
::
	`COMPLEX
(
$eX
, 
$eY
);

2113  
£lf
::
	`COMPLEX
(
$eX
, 
$eY
, 
$·r£dCom¶ex
['suffix']);

2115 
	}
}

2130 
public
 
funùiÚ
 
	$IMPOWER
(
$com¶exNumb”
, 
$»®Numb”
)

2132 
$com¶exNumb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber);

2133 
$»®Numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($realNumber);

2135 ià(!
	`is_num”ic
(
$»®Numb”
)) {

2136  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2139 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”
);

2141 
$r
 = 
	`sq¹
((
$·r£dCom¶ex
['real'] * $parsedComplex['real']) + ($parsedComplex['imaginary'] * $parsedComplex['imaginary']));

2142 
$rPow”
 = 
	`pow
(
$r
, 
$»®Numb”
);

2143 
$th‘a
 = 
£lf
::
	`IMARGUMENT
(
$com¶exNumb”
è* 
$»®Numb”
;

2144 ià(
$th‘a
 == 0) {

2146 } 
	`–£if
 (
$·r£dCom¶ex
['imaginary'] == 0.0) {

2147  
£lf
::
	`COMPLEX
(
$rPow”
 * 
	`cos
(
$th‘a
), $rPow” * 
	`sš
($th‘a), 
$·r£dCom¶ex
['suffix']);

2149  
£lf
::
	`COMPLEX
(
$rPow”
 * 
	`cos
(
$th‘a
), $rPow” * 
	`sš
($th‘a), 
$·r£dCom¶ex
['suffix']);

2151 
	}
}

2166 
public
 
funùiÚ
 
	$IMDIV
(
$com¶exDivid’d
, 
$com¶exDivisÜ
)

2168 
$com¶exDivid’d
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexDividend);

2169 
$com¶exDivisÜ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexDivisor);

2171 
$·r£dCom¶exDivid’d
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exDivid’d
);

2172 
$·r£dCom¶exDivisÜ
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exDivisÜ
);

2174 ià((
$·r£dCom¶exDivid’d
['suffix'] !ğ''è&& (
$·r£dCom¶exDivisÜ
['suffix'] != '') &&

2175 (
$·r£dCom¶exDivid’d
['suffix'] !ğ
$·r£dCom¶exDivisÜ
['suffix'])) {

2176  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2178 ià((
$·r£dCom¶exDivid’d
['suffix'] !ğ''è&& (
$·r£dCom¶exDivisÜ
['suffix'] == '')) {

2179 
$·r£dCom¶exDivisÜ
['suffix'] = 
$·r£dCom¶exDivid’d
['suffix'];

2182 
$d1
 = (
$·r£dCom¶exDivid’d
['»®'] * 
$·r£dCom¶exDivisÜ
['real']) + ($parsedComplexDividend['imaginary'] * $parsedComplexDivisor['imaginary']);

2183 
$d2
 = (
$·r£dCom¶exDivid’d
['imagš¬y'] * 
$·r£dCom¶exDivisÜ
['real']) - ($parsedComplexDividend['real'] * $parsedComplexDivisor['imaginary']);

2184 
$d3
 = (
$·r£dCom¶exDivisÜ
['real'] * $parsedComplexDivisor['real']) + ($parsedComplexDivisor['imaginary'] * $parsedComplexDivisor['imaginary']);

2186 
$r
 = 
$d1
 / 
$d3
;

2187 
$i
 = 
$d2
 / 
$d3
;

2189 ià(
$i
 > 0.0) {

2190  
£lf
::
	`ş—nCom¶ex
(
$r
.'+'.
$i
.
$·r£dCom¶exDivisÜ
['suffix']);

2191 } 
	`–£if
 (
$i
 < 0.0) {

2192  
£lf
::
	`ş—nCom¶ex
(
$r
.
$i
.
$·r£dCom¶exDivisÜ
['suffix']);

2194  
$r
;

2196 
	}
}

2211 
public
 
funùiÚ
 
	$IMSUB
(
$com¶exNumb”1
, 
$com¶exNumb”2
)

2213 
$com¶exNumb”1
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber1);

2214 
$com¶exNumb”2
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($complexNumber2);

2216 
$·r£dCom¶ex1
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”1
);

2217 
$·r£dCom¶ex2
 = 
£lf
::
	`·r£Com¶ex
(
$com¶exNumb”2
);

2219 ià(((
$·r£dCom¶ex1
['suffix'] !ğ''è&& (
$·r£dCom¶ex2
['suffix'] != '')) &&

2220 (
$·r£dCom¶ex1
['suffix'] !ğ
$·r£dCom¶ex2
['suffix'])) {

2221  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2222 } 
	`–£if
 ((
$·r£dCom¶ex1
['suffix'] =ğ''è&& (
$·r£dCom¶ex2
['suffix'] != '')) {

2223 
$·r£dCom¶ex1
['suffix'] = 
$·r£dCom¶ex2
['suffix'];

2226 
$d1
 = 
$·r£dCom¶ex1
['»®'] - 
$·r£dCom¶ex2
['real'];

2227 
$d2
 = 
$·r£dCom¶ex1
['imagš¬y'] - 
$·r£dCom¶ex2
['imaginary'];

2229  
£lf
::
	`COMPLEX
(
$d1
, 
$d2
, 
$·r£dCom¶ex1
['suffix']);

2230 
	}
}

2244 
public
 
funùiÚ
 
	$IMSUM
()

2247 
$»tuºV®ue
 = 
£lf
::
	`·r£Com¶ex
('0');

2248 
$aùiveSuffix
 = '';

2251 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

2252 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

2253 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$¬g
);

2255 ià(
$aùiveSuffix
 == '') {

2256 
$aùiveSuffix
 = 
$·r£dCom¶ex
['suffix'];

2257 } 
	`–£if
 ((
$·r£dCom¶ex
['suffix'] !ğ''è&& (
$aùiveSuffix
 != $parsedComplex['suffix'])) {

2258  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2261 
$»tuºV®ue
['»®'] +ğ
$·r£dCom¶ex
['real'];

2262 
$»tuºV®ue
['imagš¬y'] +ğ
$·r£dCom¶ex
['imaginary'];

2265 ià(
$»tuºV®ue
['imaginary'] == 0.0) {

2266 
$aùiveSuffix
 = '';

2268  
£lf
::
	`COMPLEX
(
$»tuºV®ue
['»®'], $»tuºV®ue['imagš¬y'], 
$aùiveSuffix
);

2269 
	}
}

2283 
public
 
funùiÚ
 
	$IMPRODUCT
()

2286 
$»tuºV®ue
 = 
£lf
::
	`·r£Com¶ex
('1');

2287 
$aùiveSuffix
 = '';

2290 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

2291 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

2292 
$·r£dCom¶ex
 = 
£lf
::
	`·r£Com¶ex
(
$¬g
);

2294 
$wÜkV®ue
 = 
$»tuºV®ue
;

2295 ià((
$·r£dCom¶ex
['suffix'] !ğ''è&& (
$aùiveSuffix
 == '')) {

2296 
$aùiveSuffix
 = 
$·r£dCom¶ex
['suffix'];

2297 } 
	`–£if
 ((
$·r£dCom¶ex
['suffix'] !ğ''è&& (
$aùiveSuffix
 != $parsedComplex['suffix'])) {

2298  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2300 
$»tuºV®ue
['»®'] = (
$wÜkV®ue
['»®'] * 
$·r£dCom¶ex
['real']) - ($workValue['imaginary'] * $parsedComplex['imaginary']);

2301 
$»tuºV®ue
['imagš¬y'] = (
$wÜkV®ue
['»®'] * 
$·r£dCom¶ex
['imaginary']) + ($workValue['imaginary'] * $parsedComplex['real']);

2304 ià(
$»tuºV®ue
['imaginary'] == 0.0) {

2305 
$aùiveSuffix
 = '';

2307  
£lf
::
	`COMPLEX
(
$»tuºV®ue
['»®'], $»tuºV®ue['imagš¬y'], 
$aùiveSuffix
);

2308 
	}
}

2326 
public
 
funùiÚ
 
	$DELTA
(
$a
, 
$b
 = 0)

2328 
$a
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($a);

2329 
$b
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($b);

2331  (è(
$a
 =ğ
$b
);

2332 
	}
}

2350 
public
 
funùiÚ
 
	$GESTEP
(
$numb”
, 
$¡•
 = 0)

2352 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

2353 
$¡•
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($step);

2355  (è(
$numb”
 >ğ
$¡•
);

2356 
	}
}

2362 
´iv©e
 
	g$twoSq¹Pi
 = 1.128379167095512574;

2364 
public
 
funùiÚ
 
	$”fV®
(
$x
)

2366 ià(
	`abs
(
$x
) > 2.2) {

2367  1 - 
£lf
::
	`”fcV®
(
$x
);

2369 
$sum
 = 
$‹rm
 = 
$x
;

2370 
$xsqr
 = (
$x
 * $x);

2371 
$j
 = 1;

2373 
$‹rm
 *ğ
$xsqr
 / 
$j
;

2374 
$sum
 -ğ
$‹rm
 / (2 * 
$j
 + 1);

2375 ++
$j
;

2376 
$‹rm
 *ğ
$xsqr
 / 
$j
;

2377 
$sum
 +ğ
$‹rm
 / (2 * 
$j
 + 1);

2378 ++
$j
;

2379 ià(
$sum
 == 0.0) {

2382 } 
	`abs
(
$‹rm
 / 
$sum
è> 
PRECISION
);

2383  
£lf
::
$twoSq¹Pi
 * 
$sum
;

2384 
	}
}

2405 
public
 
funùiÚ
 
	$ERF
(
$low”
, 
$uµ”
 = 
nuÎ
)

2407 
$low”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($lower);

2408 
$uµ”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($upper);

2410 ià(
	`is_num”ic
(
$low”
)) {

2411 ià(
	`is_nuÎ
(
$uµ”
)) {

2412  
£lf
::
	`”fV®
(
$low”
);

2414 ià(
	`is_num”ic
(
$uµ”
)) {

2415  
£lf
::
	`”fV®
(
$uµ”
è- s–f::”fV®(
$low”
);

2418  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2419 
	}
}

2425 
´iv©e
 
	g$ÚeSq¹Pi
 = 0.564189583547756287;

2427 
´iv©e
 
funùiÚ
 
	$”fcV®
(
$x
)

2429 ià(
	`abs
(
$x
) < 2.2) {

2430  1 - 
£lf
::
	`”fV®
(
$x
);

2432 ià(
$x
 < 0) {

2433  2 - 
£lf
::
	`ERFC
(-
$x
);

2435 
$a
 = 
$n
 = 1;

2436 
$b
 = 
$c
 = 
$x
;

2437 
$d
 = (
$x
 * $x) + 0.5;

2438 
$q1
 = 
$q2
 = 
$b
 / 
$d
;

2439 
$t
 = 0;

2441 
$t
 = 
$a
 * 
$n
 + 
$b
 * 
$x
;

2442 
$a
 = 
$b
;

2443 
$b
 = 
$t
;

2444 
$t
 = 
$c
 * 
$n
 + 
$d
 * 
$x
;

2445 
$c
 = 
$d
;

2446 
$d
 = 
$t
;

2447 
$n
 += 0.5;

2448 
$q1
 = 
$q2
;

2449 
$q2
 = 
$b
 / 
$d
;

2450 } (
	`abs
(
$q1
 - 
$q2
è/ $q2è> 
PRECISION
);

2451  
£lf
::
$ÚeSq¹Pi
 * 
	`exp
(-
$x
 * $xè* 
$q2
;

2452 
	}
}

2471 
public
 
funùiÚ
 
	$ERFC
(
$x
)

2473 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

2475 ià(
	`is_num”ic
(
$x
)) {

2476  
£lf
::
	`”fcV®
(
$x
);

2478  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2479 
	}
}

2488 
public
 
funùiÚ
 
	$g‘CÚv”siÚGroups
()

2490 
$cÚv”siÚGroups
 = 
	`¬¿y
();

2491 
	`fÜ—ch
 (
£lf
::
$cÚv”siÚUn™s
 
as
 
$cÚv”siÚUn™
) {

2492 
$cÚv”siÚGroups
[] = 
$cÚv”siÚUn™
['Group'];

2494  
	`¬¿y_m”ge
(
	`¬¿y_unique
(
$cÚv”siÚGroups
));

2495 
	}
}

2505 
public
 
funùiÚ
 
	$g‘CÚv”siÚGroupUn™s
(
$group
 = 
nuÎ
)

2507 
$cÚv”siÚGroups
 = 
	`¬¿y
();

2508 
	`fÜ—ch
 (
£lf
::
$cÚv”siÚUn™s
 
as
 
$cÚv”siÚUn™
 => 
$cÚv”siÚGroup
) {

2509 ià((
	`is_nuÎ
(
$group
)è|| (
$cÚv”siÚGroup
['Group'] == $group)) {

2510 
$cÚv”siÚGroups
[
$cÚv”siÚGroup
['Group']][] = 
$cÚv”siÚUn™
;

2513  
$cÚv”siÚGroups
;

2514 
	}
}

2523 
public
 
funùiÚ
 
	$g‘CÚv”siÚGroupUn™D‘as
(
$group
 = 
nuÎ
)

2525 
$cÚv”siÚGroups
 = 
	`¬¿y
();

2526 
	`fÜ—ch
 (
£lf
::
$cÚv”siÚUn™s
 
as
 
$cÚv”siÚUn™
 => 
$cÚv”siÚGroup
) {

2527 ià((
	`is_nuÎ
(
$group
)è|| (
$cÚv”siÚGroup
['Group'] == $group)) {

2528 
$cÚv”siÚGroups
[
$cÚv”siÚGroup
['Group']][] = 
	`¬¿y
(

2529 'un™' => 
$cÚv”siÚUn™
,

2530 'desütiÚ' => 
$cÚv”siÚGroup
['Unit Name']

2534  
$cÚv”siÚGroups
;

2535 
	}
}

2544 
public
 
funùiÚ
 
	$g‘CÚv”siÚMuÉl›rs
()

2546  
£lf
::
$cÚv”siÚMuÉl›rs
;

2547 
	}
}

2566 
public
 
funùiÚ
 
	$CONVERTUOM
(
$v®ue
, 
$äomUOM
, 
$toUOM
)

2568 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

2569 
$äomUOM
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($fromUOM);

2570 
$toUOM
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($toUOM);

2572 ià(!
	`is_num”ic
(
$v®ue
)) {

2573  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2575 
$äomMuÉl›r
 = 1.0;

2576 ià(
	`is£t
(
£lf
::
$cÚv”siÚUn™s
[
$äomUOM
])) {

2577 
$un™Group1
 = 
£lf
::
$cÚv”siÚUn™s
[
$äomUOM
]['Group'];

2579 
$äomMuÉl›r
 = 
	`sub¡r
(
$äomUOM
, 0, 1);

2580 
$äomUOM
 = 
	`sub¡r
($fromUOM, 1);

2581 ià(
	`is£t
(
£lf
::
$cÚv”siÚMuÉl›rs
[
$äomMuÉl›r
])) {

2582 
$äomMuÉl›r
 = 
£lf
::
$cÚv”siÚMuÉl›rs
[$fromMultiplier]['multiplier'];

2584  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2586 ià((
	`is£t
(
£lf
::
$cÚv”siÚUn™s
[
$äomUOM
])) && (self::$conversionUnits[$fromUOM]['AllowPrefix'])) {

2587 
$un™Group1
 = 
£lf
::
$cÚv”siÚUn™s
[
$äomUOM
]['Group'];

2589  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2592 
$v®ue
 *ğ
$äomMuÉl›r
;

2594 
$toMuÉl›r
 = 1.0;

2595 ià(
	`is£t
(
£lf
::
$cÚv”siÚUn™s
[
$toUOM
])) {

2596 
$un™Group2
 = 
£lf
::
$cÚv”siÚUn™s
[
$toUOM
]['Group'];

2598 
$toMuÉl›r
 = 
	`sub¡r
(
$toUOM
, 0, 1);

2599 
$toUOM
 = 
	`sub¡r
($toUOM, 1);

2600 ià(
	`is£t
(
£lf
::
$cÚv”siÚMuÉl›rs
[
$toMuÉl›r
])) {

2601 
$toMuÉl›r
 = 
£lf
::
$cÚv”siÚMuÉl›rs
[$toMultiplier]['multiplier'];

2603  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2605 ià((
	`is£t
(
£lf
::
$cÚv”siÚUn™s
[
$toUOM
])) && (self::$conversionUnits[$toUOM]['AllowPrefix'])) {

2606 
$un™Group2
 = 
£lf
::
$cÚv”siÚUn™s
[
$toUOM
]['Group'];

2608  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2611 ià(
$un™Group1
 !ğ
$un™Group2
) {

2612  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2615 ià((
$äomUOM
 =ğ
$toUOM
è&& (
$äomMuÉl›r
 =ğ
$toMuÉl›r
)) {

2618  
$v®ue
 / 
$äomMuÉl›r
;

2619 } 
	`–£if
 (
$un™Group1
 == 'Temperature') {

2620 ià((
$äomUOM
 == 'F') || ($fromUOM == 'fah')) {

2621 ià((
$toUOM
 == 'F') || ($toUOM == 'fah')) {

2622  
$v®ue
;

2624 
$v®ue
 = (($value - 32) / 1.8);

2625 ià((
$toUOM
 == 'K') || ($toUOM == 'kel')) {

2626 
$v®ue
 += 273.15;

2628  
$v®ue
;

2630 } 
	`–£if
 (((
$äomUOM
 == 'K') || ($fromUOM == 'kel')) &&

2631 ((
$toUOM
 == 'K') || ($toUOM == 'kel'))) {

2632  
$v®ue
;

2633 } 
	`–£if
 (((
$äomUOM
 == 'C') || ($fromUOM == 'cel')) &&

2634 ((
$toUOM
 == 'C') || ($toUOM == 'cel'))) {

2635  
$v®ue
;

2637 ià((
$toUOM
 == 'F') || ($toUOM == 'fah')) {

2638 ià((
$äomUOM
 == 'K') || ($fromUOM == 'kel')) {

2639 
$v®ue
 -= 273.15;

2641  (
$v®ue
 * 1.8) + 32;

2643 ià((
$toUOM
 == 'C') || ($toUOM == 'cel')) {

2644  
$v®ue
 - 273.15;

2646  
$v®ue
 + 273.15;

2648  (
$v®ue
 * 
£lf
::
$un™CÚv”siÚs
[
$un™Group1
][
$äomUOM
][
$toUOM
]è/ 
$toMuÉl›r
;

2649 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Exception.php

1 <?
php


28 şas 
	cPHPExûl_C®cuÏtiÚ_Exû±iÚ
 
ex‹nds
 
	mPHPExûl_Exû±iÚ


39 
public
 
funùiÚ
 
	$”rÜHªdËrC®lback
(
$code
, 
$¡ršg
, 
$fe
, 
$lše
, 
$cÚ‹xt
)

41 
$e
 = 
Ãw
 
	`£lf
(
$¡ršg
, 
$code
);

42 
$e
->
lše
 = 
$lše
;

43 
$e
->
fe
 = 
$fe
;

44 
throw
 
$e
;

46 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/ExceptionHandler.php

1 <?
php


28 şas 
	cPHPExûl_C®cuÏtiÚ_Exû±iÚHªdËr


33 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

35 
	`£t_”rÜ_hªdËr
(
	`¬¿y
('PHPExûl_C®cuÏtiÚ_Exû±iÚ', '”rÜHªdËrC®lback'), 
E_ALL
);

41 
public
 
funùiÚ
 
	$__de¡ruù
()

43 
	`»¡Üe_”rÜ_hªdËr
();

44 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Financial.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

13 
defše
('FINANCIAL_MAX_ITERATIONS', 128);

16 
defše
('FINANCIAL_PRECISION', 1.0e-08);

43 şas 
	cPHPExûl_C®cuÏtiÚ_FšªcŸl


53 
´iv©e
 
funùiÚ
 
	$isLa¡DayOfMÚth
(
$‹¡D©e
)

55  (
$‹¡D©e
->
	`fÜm©
('d') == $testDate->format('t'));

67 
´iv©e
 
funùiÚ
 
	$isFœ¡DayOfMÚth
(
$‹¡D©e
)

69  (
$‹¡D©e
->
	`fÜm©
('d') == 1);

70 
	}
}

73 
´iv©e
 
funùiÚ
 
	$coupÚFœ¡P”iodD©e
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$Ãxt
)

75 
$mÚths
 = 12 / 
$äequ’cy
;

77 
$»suÉ
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$m©ur™y
);

78 
$eom
 = 
£lf
::
	`isLa¡DayOfMÚth
(
$»suÉ
);

80 
$£‰Ëm’t
 < 
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
$»suÉ
)) {

81 
$»suÉ
->
	`modify
('-'.
$mÚths
.' months');

83 ià(
$Ãxt
) {

84 
$»suÉ
->
	`modify
('+'.
$mÚths
.' months');

87 ià(
$eom
) {

88 
$»suÉ
->
	`modify
('-1 day');

91  
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
$»suÉ
);

92 
	}
}

95 
´iv©e
 
funùiÚ
 
	$isV®idF»qu’cy
(
$äequ’cy
)

97 ià((
$äequ’cy
 == 1) || ($frequency == 2) || ($frequency == 4)) {

98  
Œue
;

100 ià((
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) &&

101 ((
$äequ’cy
 == 6) || ($frequency == 12))) {

102  
Œue
;

104  
çl£
;

105 
	}
}

122 
´iv©e
 
funùiÚ
 
	$daysP”Y—r
(
$y—r
, 
$basis
 = 0)

124 
$basis
) {

128 
$daysP”Y—r
 = 360;

131 
$daysP”Y—r
 = 365;

134 
$daysP”Y—r
 = (
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`isL—pY—r
(
$y—r
)) ? 366 : 365;

137  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

139  
$daysP”Y—r
;

140 
	}
}

143 
´iv©e
 
funùiÚ
 
	$š‹»¡AndPršc®
(
$¿‹
 = 0, 
$³r
 = 0, 
$Å”
 = 0, 
$pv
 = 0, 
$fv
 = 0, 
$ty³
 = 0)

145 
$pmt
 = 
£lf
::
	`PMT
(
$¿‹
, 
$Å”
, 
$pv
, 
$fv
, 
$ty³
);

146 
$ÿp™®
 = 
$pv
;

147 
$i
 = 1; $i<ğ
$³r
; ++$i) {

148 
$š‹»¡
 = (
$ty³
 && 
$i
 =ğ1è? 0 : -
$ÿp™®
 * 
$¿‹
;

149 
$´šc®
 = 
$pmt
 - 
$š‹»¡
;

150 
$ÿp™®
 +ğ
$´šc®
;

152  
	`¬¿y
(
$š‹»¡
, 
$´šc®
);

153 
	}
}

191 
public
 
funùiÚ
 
	$ACCRINT
(
$issue
, 
$fœ¡š‹»¡
, 
$£‰Ëm’t
, 
$¿‹
, 
$·r
 = 1000, 
$äequ’cy
 = 1, 
$basis
 = 0)

193 
$issue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($issue);

194 
$fœ¡š‹»¡
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($firstinterest);

195 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

196 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

197 
$·r
 = (
	`is_nuÎ
($·r)è? 1000 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($par);

198 
$äequ’cy
 = (
	`is_nuÎ
($äequ’cy)è? 1 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($frequency);

199 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

202 ià((
	`is_num”ic
(
$¿‹
)è&& (is_num”ic(
$·r
))) {

203 
$¿‹
 = () $rate;

204 
$·r
 = () $par;

205 ià((
$¿‹
 <ğ0è|| (
$·r
 <= 0)) {

206  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

208 
$daysB‘w“nIssueAndS‘em’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$issue
, 
$£‰Ëm’t
, 
$basis
);

209 ià(!
	`is_num”ic
(
$daysB‘w“nIssueAndS‘em’t
)) {

211  
$daysB‘w“nIssueAndS‘em’t
;

214  
$·r
 * 
$¿‹
 * 
$daysB‘w“nIssueAndS‘em’t
;

216  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

217 
	}
}

243 
public
 
funùiÚ
 
	$ACCRINTM
(
$issue
, 
$£‰Ëm’t
, 
$¿‹
, 
$·r
 = 1000, 
$basis
 = 0)

245 
$issue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($issue);

246 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

247 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

248 
$·r
 = (
	`is_nuÎ
($·r)è? 1000 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($par);

249 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

252 ià((
	`is_num”ic
(
$¿‹
)è&& (is_num”ic(
$·r
))) {

253 
$¿‹
 = () $rate;

254 
$·r
 = () $par;

255 ià((
$¿‹
 <ğ0è|| (
$·r
 <= 0)) {

256  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

258 
$daysB‘w“nIssueAndS‘em’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$issue
, 
$£‰Ëm’t
, 
$basis
);

259 ià(!
	`is_num”ic
(
$daysB‘w“nIssueAndS‘em’t
)) {

261  
$daysB‘w“nIssueAndS‘em’t
;

263  
$·r
 * 
$¿‹
 * 
$daysB‘w“nIssueAndS‘em’t
;

265  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

266 
	}
}

300 
public
 
funùiÚ
 
	$AMORDEGRC
(
$co¡
, 
$purcha£d
, 
$fœ¡P”iod
, 
$§lvage
, 
$³riod
, 
$¿‹
, 
$basis
 = 0)

302 
$co¡
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($cost);

303 
$purcha£d
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($purchased);

304 
$fœ¡P”iod
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($firstPeriod);

305 
$§lvage
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($salvage);

306 
$³riod
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($period));

307 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

308 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

316 
$fU£P”
 = 1.0 / 
$¿‹
;

317 ià(
$fU£P”
 < 3.0) {

318 
$amÜti£CÛff
 = 1.0;

319 } 
	`–£if
 (
$fU£P”
 < 5.0) {

320 
$amÜti£CÛff
 = 1.5;

321 } 
	`–£if
 (
$fU£P”
 <= 6.0) {

322 
$amÜti£CÛff
 = 2.0;

324 
$amÜti£CÛff
 = 2.5;

327 
$¿‹
 *ğ
$amÜti£CÛff
;

328 
$fNR©e
 = 
	`round
(
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$purcha£d
, 
$fœ¡P”iod
, 
$basis
è* 
$¿‹
 * 
$co¡
, 0);

329 
$co¡
 -ğ
$fNR©e
;

330 
$fRe¡
 = 
$co¡
 - 
$§lvage
;

332 
$n
 = 0; $À< 
$³riod
; ++$n) {

333 
$fNR©e
 = 
	`round
(
$¿‹
 * 
$co¡
, 0);

334 
$fRe¡
 -ğ
$fNR©e
;

336 ià(
$fRe¡
 < 0.0) {

337 
$³riod
 - 
$n
) {

340  
	`round
(
$co¡
 * 0.5, 0);

345 
$co¡
 -ğ
$fNR©e
;

347  
$fNR©e
;

348 
	}
}

377 
public
 
funùiÚ
 
	$AMORLINC
(
$co¡
, 
$purcha£d
, 
$fœ¡P”iod
, 
$§lvage
, 
$³riod
, 
$¿‹
, 
$basis
 = 0)

379 
$co¡
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($cost);

380 
$purcha£d
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($purchased);

381 
$fœ¡P”iod
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($firstPeriod);

382 
$§lvage
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($salvage);

383 
$³riod
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($period);

384 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

385 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

387 
$fOÃR©e
 = 
$co¡
 * 
$¿‹
;

388 
$fCo¡D–
 = 
$co¡
 - 
$§lvage
;

390 
$purcha£dY—r
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEAR
(
$purcha£d
);

391 
$y—rF¿c
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$purcha£d
, 
$fœ¡P”iod
, 
$basis
);

393 ià((
$basis
 =ğ1è&& (
$y—rF¿c
 < 1è&& (
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`isL—pY—r
(
$purcha£dY—r
))) {

394 
$y—rF¿c
 *= 365 / 366;

397 
$f0R©e
 = 
$y—rF¿c
 * 
$¿‹
 * 
$co¡
;

398 
$nNumOfFuÎP”iods
 = 
	`štv®
((
$co¡
 - 
$§lvage
 - 
$f0R©e
è/ 
$fOÃR©e
);

400 ià(
$³riod
 == 0) {

401  
$f0R©e
;

402 } 
	`–£if
 (
$³riod
 <ğ
$nNumOfFuÎP”iods
) {

403  
$fOÃR©e
;

404 } 
	`–£if
 (
$³riod
 =ğ(
$nNumOfFuÎP”iods
 + 1)) {

405  (
$fCo¡D–
 - 
$fOÃR©e
 * 
$nNumOfFuÎP”iods
 - 
$f0R©e
);

409 
	}
}

444 
public
 
funùiÚ
 
	$COUPDAYBS
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$basis
 = 0)

446 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

447 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

448 
$äequ’cy
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($frequency);

449 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

451 ià(
	`is_¡ršg
(
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($settlement))) {

452  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

454 ià(
	`is_¡ršg
(
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($maturity))) {

455  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

458 ià((
$£‰Ëm’t
 > 
$m©ur™y
) ||

459 (!
£lf
::
	`isV®idF»qu’cy
(
$äequ’cy
)) ||

460 ((
$basis
 < 0) || ($basis > 4))) {

461  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

464 
$daysP”Y—r
 = 
£lf
::
	`daysP”Y—r
(
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEAR
(
$£‰Ëm’t
), 
$basis
);

465 
$´ev
 = 
£lf
::
	`coupÚFœ¡P”iodD©e
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
çl£
);

467  
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$´ev
, 
$£‰Ëm’t
, 
$basis
è* 
$daysP”Y—r
;

468 
	}
}

503 
public
 
funùiÚ
 
	$COUPDAYS
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$basis
 = 0)

505 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

506 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

507 
$äequ’cy
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($frequency);

508 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

510 ià(
	`is_¡ršg
(
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($settlement))) {

511  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

513 ià(
	`is_¡ršg
(
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($maturity))) {

514  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

517 ià((
$£‰Ëm’t
 > 
$m©ur™y
) ||

518 (!
£lf
::
	`isV®idF»qu’cy
(
$äequ’cy
)) ||

519 ((
$basis
 < 0) || ($basis > 4))) {

520  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

523 
$basis
) {

526  365 / 
$äequ’cy
;

529 ià(
$äequ’cy
 == 1) {

530 
$daysP”Y—r
 = 
£lf
::
	`daysP”Y—r
(
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEAR
(
$m©ur™y
), 
$basis
);

531  (
$daysP”Y—r
 / 
$äequ’cy
);

533 
$´ev
 = 
£lf
::
	`coupÚFœ¡P”iodD©e
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
çl£
);

534 
$Ãxt
 = 
£lf
::
	`coupÚFœ¡P”iodD©e
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
Œue
);

535  (
$Ãxt
 - 
$´ev
);

538  360 / 
$äequ’cy
;

540  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

541 
	}
}

576 
public
 
funùiÚ
 
	$COUPDAYSNC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$basis
 = 0)

578 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

579 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

580 
$äequ’cy
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($frequency);

581 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

583 ià(
	`is_¡ršg
(
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($settlement))) {

584  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

586 ià(
	`is_¡ršg
(
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($maturity))) {

587  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

590 ià((
$£‰Ëm’t
 > 
$m©ur™y
) ||

591 (!
£lf
::
	`isV®idF»qu’cy
(
$äequ’cy
)) ||

592 ((
$basis
 < 0) || ($basis > 4))) {

593  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

596 
$daysP”Y—r
 = 
£lf
::
	`daysP”Y—r
(
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEAR
(
$£‰Ëm’t
), 
$basis
);

597 
$Ãxt
 = 
£lf
::
	`coupÚFœ¡P”iodD©e
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
Œue
);

599  
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$Ãxt
, 
$basis
è* 
$daysP”Y—r
;

600 
	}
}

636 
public
 
funùiÚ
 
	$COUPNCD
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$basis
 = 0)

638 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

639 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

640 
$äequ’cy
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($frequency);

641 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

643 ià(
	`is_¡ršg
(
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($settlement))) {

644  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

646 ià(
	`is_¡ršg
(
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($maturity))) {

647  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

650 ià((
$£‰Ëm’t
 > 
$m©ur™y
) ||

651 (!
£lf
::
	`isV®idF»qu’cy
(
$äequ’cy
)) ||

652 ((
$basis
 < 0) || ($basis > 4))) {

653  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

656  
£lf
::
	`coupÚFœ¡P”iodD©e
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
Œue
);

657 
	}
}

693 
public
 
funùiÚ
 
	$COUPNUM
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$basis
 = 0)

695 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

696 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

697 
$äequ’cy
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($frequency);

698 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

700 ià(
	`is_¡ršg
(
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($settlement))) {

701  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

703 ià(
	`is_¡ršg
(
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($maturity))) {

704  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

707 ià((
$£‰Ëm’t
 > 
$m©ur™y
) ||

708 (!
£lf
::
	`isV®idF»qu’cy
(
$äequ’cy
)) ||

709 ((
$basis
 < 0) || ($basis > 4))) {

710  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

713 
$£‰Ëm’t
 = 
£lf
::
	`coupÚFœ¡P”iodD©e
($£‰Ëm’t, 
$m©ur™y
, 
$äequ’cy
, 
Œue
);

714 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$basis
) * 365;

716 
$äequ’cy
) {

718  
	`û
(
$daysB‘w“nS‘em’tAndM©ur™y
 / 360);

720  
	`û
(
$daysB‘w“nS‘em’tAndM©ur™y
 / 180);

722  
	`û
(
$daysB‘w“nS‘em’tAndM©ur™y
 / 90);

724  
	`û
(
$daysB‘w“nS‘em’tAndM©ur™y
 / 60);

726  
	`û
(
$daysB‘w“nS‘em’tAndM©ur™y
 / 30);

728  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

729 
	}
}

765 
public
 
funùiÚ
 
	$COUPPCD
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$basis
 = 0)

767 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

768 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

769 
$äequ’cy
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($frequency);

770 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

772 ià(
	`is_¡ršg
(
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($settlement))) {

773  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

775 ià(
	`is_¡ršg
(
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($maturity))) {

776  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

779 ià((
$£‰Ëm’t
 > 
$m©ur™y
) ||

780 (!
£lf
::
	`isV®idF»qu’cy
(
$äequ’cy
)) ||

781 ((
$basis
 < 0) || ($basis > 4))) {

782  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

785  
£lf
::
	`coupÚFœ¡P”iodD©e
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
çl£
);

786 
	}
}

810 
public
 
funùiÚ
 
	$CUMIPMT
(
$¿‹
, 
$Å”
, 
$pv
, 
$¡¬t
, 
$’d
, 
$ty³
 = 0)

812 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

813 
$Å”
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($nper);

814 
$pv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pv);

815 
$¡¬t
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($start);

816 
$’d
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($end);

817 
$ty³
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($type);

820 ià(
$ty³
 != 0 && $type != 1) {

821  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

823 ià(
$¡¬t
 < 1 || $¡¬ˆ> 
$’d
) {

824  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

828 
$š‹»¡
 = 0;

829 
$³r
 = 
$¡¬t
; $³¸<ğ
$’d
; ++$per) {

830 
$š‹»¡
 +ğ
£lf
::
	`IPMT
(
$¿‹
, 
$³r
, 
$Å”
, 
$pv
, 0, 
$ty³
);

833  
$š‹»¡
;

834 
	}
}

858 
public
 
funùiÚ
 
	$CUMPRINC
(
$¿‹
, 
$Å”
, 
$pv
, 
$¡¬t
, 
$’d
, 
$ty³
 = 0)

860 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

861 
$Å”
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($nper);

862 
$pv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pv);

863 
$¡¬t
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($start);

864 
$’d
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($end);

865 
$ty³
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($type);

868 ià(
$ty³
 != 0 && $type != 1) {

869  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

871 ià(
$¡¬t
 < 1 || $¡¬ˆ> 
$’d
) {

872  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

876 
$´šc®
 = 0;

877 
$³r
 = 
$¡¬t
; $³¸<ğ
$’d
; ++$per) {

878 
$´šc®
 +ğ
£lf
::
	`PPMT
(
$¿‹
, 
$³r
, 
$Å”
, 
$pv
, 0, 
$ty³
);

881  
$´šc®
;

882 
	}
}

911 
public
 
funùiÚ
 
	$DB
(
$co¡
, 
$§lvage
, 
$liã
, 
$³riod
, 
$mÚth
 = 12)

913 
$co¡
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($cost);

914 
$§lvage
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($salvage);

915 
$liã
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($life);

916 
$³riod
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($period);

917 
$mÚth
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($month);

920 ià((
	`is_num”ic
(
$co¡
)è&& (is_num”ic(
$§lvage
)è&& (is_num”ic(
$liã
)è&& (is_num”ic(
$³riod
)è&& (is_num”ic(
$mÚth
))) {

921 
$co¡
 = () $cost;

922 
$§lvage
 = () $salvage;

923 
$liã
 = () $life;

924 
$³riod
 = () $period;

925 
$mÚth
 = () $month;

926 ià(
$co¡
 == 0) {

928 } 
	`–£if
 ((
$co¡
 < 0è|| ((
$§lvage
 / $co¡è< 0è|| (
$liã
 <ğ0è|| (
$³riod
 < 1è|| (
$mÚth
 < 1)) {

929  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

932 
$fixedD•»cŸtiÚR©e
 = 1 - 
	`pow
((
$§lvage
 / 
$co¡
), (1 / 
$liã
));

933 
$fixedD•»cŸtiÚR©e
 = 
	`round
($fixedDepreciationRate, 3);

936 
$´eviousD•»cŸtiÚ
 = 0;

937 
$³r
 = 1; $³¸<ğ
$³riod
; ++$per) {

938 ià(
$³r
 == 1) {

939 
$d•»cŸtiÚ
 = 
$co¡
 * 
$fixedD•»cŸtiÚR©e
 * 
$mÚth
 / 12;

940 } 
	`–£if
 (
$³r
 =ğ(
$liã
 + 1)) {

941 
$d•»cŸtiÚ
 = (
$co¡
 - 
$´eviousD•»cŸtiÚ
è* 
$fixedD•»cŸtiÚR©e
 * (12 - 
$mÚth
) / 12;

943 
$d•»cŸtiÚ
 = (
$co¡
 - 
$´eviousD•»cŸtiÚ
è* 
$fixedD•»cŸtiÚR©e
;

945 
$´eviousD•»cŸtiÚ
 +ğ
$d•»cŸtiÚ
;

947 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

948 
$d•»cŸtiÚ
 = 
	`round
($depreciation, 2);

950  
$d•»cŸtiÚ
;

952  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

953 
	}
}

979 
public
 
funùiÚ
 
	$DDB
(
$co¡
, 
$§lvage
, 
$liã
, 
$³riod
, 
$çùÜ
 = 2.0)

981 
$co¡
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($cost);

982 
$§lvage
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($salvage);

983 
$liã
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($life);

984 
$³riod
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($period);

985 
$çùÜ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($factor);

988 ià((
	`is_num”ic
(
$co¡
)è&& (is_num”ic(
$§lvage
)è&& (is_num”ic(
$liã
)è&& (is_num”ic(
$³riod
)è&& (is_num”ic(
$çùÜ
))) {

989 
$co¡
 = () $cost;

990 
$§lvage
 = () $salvage;

991 
$liã
 = () $life;

992 
$³riod
 = () $period;

993 
$çùÜ
 = () $factor;

994 ià((
$co¡
 <ğ0è|| ((
$§lvage
 / $co¡è< 0è|| (
$liã
 <ğ0è|| (
$³riod
 < 1è|| (
$çùÜ
 <= 0.0) || ($period > $life)) {

995  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

998 
$fixedD•»cŸtiÚR©e
 = 1 - 
	`pow
((
$§lvage
 / 
$co¡
), (1 / 
$liã
));

999 
$fixedD•»cŸtiÚR©e
 = 
	`round
($fixedDepreciationRate, 3);

1002 
$´eviousD•»cŸtiÚ
 = 0;

1003 
$³r
 = 1; $³¸<ğ
$³riod
; ++$per) {

1004 
$d•»cŸtiÚ
 = 
	`mš
((
$co¡
 - 
$´eviousD•»cŸtiÚ
è* (
$çùÜ
 / 
$liã
), ($co¡ - 
$§lvage
 - $previousDepreciation));

1005 
$´eviousD•»cŸtiÚ
 +ğ
$d•»cŸtiÚ
;

1007 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

1008 
$d•»cŸtiÚ
 = 
	`round
($depreciation, 2);

1010  
$d•»cŸtiÚ
;

1012  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1013 
	}
}

1041 
public
 
funùiÚ
 
	$DISC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$´iû
, 
$»dem±iÚ
, 
$basis
 = 0)

1043 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

1044 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

1045 
$´iû
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($price);

1046 
$»dem±iÚ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($redemption);

1047 
$basis
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

1050 ià((
	`is_num”ic
(
$´iû
)è&& (is_num”ic(
$»dem±iÚ
)è&& (is_num”ic(
$basis
))) {

1051 
$´iû
 = () $price;

1052 
$»dem±iÚ
 = () $redemption;

1053 
$basis
 = () $basis;

1054 ià((
$´iû
 <ğ0è|| (
$»dem±iÚ
 <= 0)) {

1055  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1057 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$basis
);

1058 ià(!
	`is_num”ic
(
$daysB‘w“nS‘em’tAndM©ur™y
)) {

1060  
$daysB‘w“nS‘em’tAndM©ur™y
;

1063  ((1 - 
$´iû
 / 
$»dem±iÚ
è/ 
$daysB‘w“nS‘em’tAndM©ur™y
);

1065  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1066 
	}
}

1085 
public
 
funùiÚ
 
	$DOLLARDE
(
$äaùiÚ®_dŞÏr
 = 
nuÎ
, 
$äaùiÚ
 = 0)

1087 
$äaùiÚ®_dŞÏr
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($fractional_dollar);

1088 
$äaùiÚ
 = ()
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($fraction);

1091 ià(
	`is_nuÎ
(
$äaùiÚ®_dŞÏr
è|| 
$äaùiÚ
 < 0) {

1092  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1094 ià(
$äaùiÚ
 == 0) {

1095  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

1098 
$dŞÏrs
 = 
	`æoÜ
(
$äaùiÚ®_dŞÏr
);

1099 
$ûÁs
 = 
	`fmod
(
$äaùiÚ®_dŞÏr
, 1);

1100 
$ûÁs
 /ğ
$äaùiÚ
;

1101 
$ûÁs
 *ğ
	`pow
(10, 
	`û
(
	`log10
(
$äaùiÚ
)));

1102  
$dŞÏrs
 + 
$ûÁs
;

1103 
	}
}

1122 
public
 
funùiÚ
 
	$DOLLARFR
(
$decim®_dŞÏr
 = 
nuÎ
, 
$äaùiÚ
 = 0)

1124 
$decim®_dŞÏr
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($decimal_dollar);

1125 
$äaùiÚ
 = ()
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($fraction);

1128 ià(
	`is_nuÎ
(
$decim®_dŞÏr
è|| 
$äaùiÚ
 < 0) {

1129  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1131 ià(
$äaùiÚ
 == 0) {

1132  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

1135 
$dŞÏrs
 = 
	`æoÜ
(
$decim®_dŞÏr
);

1136 
$ûÁs
 = 
	`fmod
(
$decim®_dŞÏr
, 1);

1137 
$ûÁs
 *ğ
$äaùiÚ
;

1138 
$ûÁs
 *ğ
	`pow
(10, -
	`û
(
	`log10
(
$äaùiÚ
)));

1139  
$dŞÏrs
 + 
$ûÁs
;

1140 
	}
}

1158 
public
 
funùiÚ
 
	$EFFECT
(
$nomš®_¿‹
 = 0, 
$Å”y
 = 0)

1160 
$nomš®_¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($nominal_rate);

1161 
$Å”y
 = ()
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($npery);

1164 ià(
$nomš®_¿‹
 <ğ0 || 
$Å”y
 < 1) {

1165  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1168  
	`pow
((1 + 
$nomš®_¿‹
 / 
$Å”y
), $npery) - 1;

1169 
	}
}

1194 
public
 
funùiÚ
 
	$FV
(
$¿‹
 = 0, 
$Å”
 = 0, 
$pmt
 = 0, 
$pv
 = 0, 
$ty³
 = 0)

1196 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

1197 
$Å”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($nper);

1198 
$pmt
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pmt);

1199 
$pv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pv);

1200 
$ty³
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($type);

1203 ià(
$ty³
 != 0 && $type != 1) {

1204  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1208 ià(!
	`is_nuÎ
(
$¿‹
) && $rate != 0) {

1209  -
$pv
 * 
	`pow
(1 + 
$¿‹
, 
$Å”
è- 
$pmt
 * (1 + $¿‹ * 
$ty³
) * (pow(1 + $rate, $nper) - 1) / $rate;

1211  -
$pv
 - 
$pmt
 * 
$Å”
;

1212 
	}
}

1228 
public
 
funùiÚ
 
	$FVSCHEDULE
(
$´šc®
, 
$scheduË
)

1230 
$´šc®
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($principal);

1231 
$scheduË
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($schedule);

1233 
	`fÜ—ch
 (
$scheduË
 
as
 
$¿‹
) {

1234 
$´šc®
 *ğ1 + 
$¿‹
;

1237  
$´šc®
;

1238 
	}
}

1263 
public
 
funùiÚ
 
	$INTRATE
(
$£‰Ëm’t
, 
$m©ur™y
, 
$šve¡m’t
, 
$»dem±iÚ
, 
$basis
 = 0)

1265 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

1266 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

1267 
$šve¡m’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($investment);

1268 
$»dem±iÚ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($redemption);

1269 
$basis
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

1272 ià((
	`is_num”ic
(
$šve¡m’t
)è&& (is_num”ic(
$»dem±iÚ
)è&& (is_num”ic(
$basis
))) {

1273 
$šve¡m’t
 = () $investment;

1274 
$»dem±iÚ
 = () $redemption;

1275 
$basis
 = () $basis;

1276 ià((
$šve¡m’t
 <ğ0è|| (
$»dem±iÚ
 <= 0)) {

1277  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1279 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$basis
);

1280 ià(!
	`is_num”ic
(
$daysB‘w“nS‘em’tAndM©ur™y
)) {

1282  
$daysB‘w“nS‘em’tAndM©ur™y
;

1285  ((
$»dem±iÚ
 / 
$šve¡m’t
è- 1è/ (
$daysB‘w“nS‘em’tAndM©ur™y
);

1287  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1288 
	}
}

1307 
public
 
funùiÚ
 
	$IPMT
(
$¿‹
, 
$³r
, 
$Å”
, 
$pv
, 
$fv
 = 0, 
$ty³
 = 0)

1309 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

1310 
$³r
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($per);

1311 
$Å”
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($nper);

1312 
$pv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pv);

1313 
$fv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($fv);

1314 
$ty³
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($type);

1317 ià(
$ty³
 != 0 && $type != 1) {

1318  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1320 ià(
$³r
 <ğ0 || $³¸> 
$Å”
) {

1321  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1325 
$š‹»¡AndPršc®
 = 
£lf
::
	`š‹»¡AndPršc®
(
$¿‹
, 
$³r
, 
$Å”
, 
$pv
, 
$fv
, 
$ty³
);

1326  
$š‹»¡AndPršc®
[0];

1327 
	}
}

1348 
public
 
funùiÚ
 
	$IRR
(
$v®ues
, 
$guess
 = 0.1)

1350 ià(!
	`is_¬¿y
(
$v®ues
)) {

1351  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1353 
$v®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($values);

1354 
$guess
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($guess);

1357 
$x1
 = 0.0;

1358 
$x2
 = 
$guess
;

1359 
$f1
 = 
£lf
::
	`NPV
(
$x1
, 
$v®ues
);

1360 
$f2
 = 
£lf
::
	`NPV
(
$x2
, 
$v®ues
);

1361 
$i
 = 0; $˜< 
FINANCIAL_MAX_ITERATIONS
; ++$i) {

1362 ià((
$f1
 * 
$f2
) < 0.0) {

1365 ià(
	`abs
(
$f1
è<‡bs(
$f2
)) {

1366 
$f1
 = 
£lf
::
	`NPV
(
$x1
 +ğ1.6 * ($x1 - 
$x2
), 
$v®ues
);

1368 
$f2
 = 
£lf
::
	`NPV
(
$x2
 +ğ1.6 * ($x2 - 
$x1
), 
$v®ues
);

1371 ià((
$f1
 * 
$f2
) > 0.0) {

1372  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1375 
$f
 = 
£lf
::
	`NPV
(
$x1
, 
$v®ues
);

1376 ià(
$f
 < 0.0) {

1377 
$¹b
 = 
$x1
;

1378 
$dx
 = 
$x2
 - 
$x1
;

1380 
$¹b
 = 
$x2
;

1381 
$dx
 = 
$x1
 - 
$x2
;

1384 
$i
 = 0; $˜< 
FINANCIAL_MAX_ITERATIONS
; ++$i) {

1385 
$dx
 *= 0.5;

1386 
$x_mid
 = 
$¹b
 + 
$dx
;

1387 
$f_mid
 = 
£lf
::
	`NPV
(
$x_mid
, 
$v®ues
);

1388 ià(
$f_mid
 <= 0.0) {

1389 
$¹b
 = 
$x_mid
;

1391 ià((
	`abs
(
$f_mid
è< 
FINANCIAL_PRECISION
è|| (abs(
$dx
) < FINANCIAL_PRECISION)) {

1392  
$x_mid
;

1395  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1396 
	}
}

1415 
public
 
funùiÚ
 
	$ISPMT
()

1418 
$»tuºV®ue
 = 0;

1421 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

1422 
$š‹»¡R©e
 = 
	`¬¿y_shiá
(
$aArgs
);

1423 
$³riod
 = 
	`¬¿y_shiá
(
$aArgs
);

1424 
$numb”P”iods
 = 
	`¬¿y_shiá
(
$aArgs
);

1425 
$´šcËRemaššg
 = 
	`¬¿y_shiá
(
$aArgs
);

1428 
$´šcËPaym’t
 = (
$´šcËRemaššg
 * 1.0è/ (
$numb”P”iods
 * 1.0);

1429 
$i
=0; $˜<ğ
$³riod
; ++$i) {

1430 
$»tuºV®ue
 = 
$š‹»¡R©e
 * 
$´šcËRemaššg
 * -1;

1431 
$´šcËRemaššg
 -ğ
$´šcËPaym’t
;

1433 ià(
$i
 =ğ
$numb”P”iods
) {

1434 
$»tuºV®ue
 = 0;

1437 (
$»tuºV®ue
);

1438 
	}
}

1457 
public
 
funùiÚ
 
	$MIRR
(
$v®ues
, 
$fšªû_¿‹
, 
$»šve¡m’t_¿‹
)

1459 ià(!
	`is_¬¿y
(
$v®ues
)) {

1460  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1462 
$v®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($values);

1463 
$fšªû_¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($finance_rate);

1464 
$»šve¡m’t_¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($reinvestment_rate);

1465 
$n
 = 
	`couÁ
(
$v®ues
);

1467 
$¼
 = 1.0 + 
$»šve¡m’t_¿‹
;

1468 
$ä
 = 1.0 + 
$fšªû_¿‹
;

1470 
$Åv_pos
 = 
$Åv_Ãg
 = 0.0;

1471 
	`fÜ—ch
 (
$v®ues
 
as
 
$i
 => 
$v
) {

1472 ià(
$v
 >= 0) {

1473 
$Åv_pos
 +ğ
$v
 / 
	`pow
(
$¼
, 
$i
);

1475 
$Åv_Ãg
 +ğ
$v
 / 
	`pow
(
$ä
, 
$i
);

1479 ià((
$Åv_Ãg
 =ğ0è|| (
$Åv_pos
 =ğ0è|| (
$»šve¡m’t_¿‹
 <= -1)) {

1480  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1483 
$mœr
 = 
	`pow
((-
$Åv_pos
 *…ow(
$¼
, 
$n
))

1484 / (
$Åv_Ãg
 * (
$¼
)), (1.0 / (
$n
 - 1))) - 1.0;

1486  (
	`is_fš™e
(
$mœr
è? $mœ¸: 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
());

1487 
	}
}

1499 
public
 
funùiÚ
 
	$NOMINAL
(
$efãù_¿‹
 = 0, 
$Å”y
 = 0)

1501 
$efãù_¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($effect_rate);

1502 
$Å”y
 = ()
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($npery);

1505 ià(
$efãù_¿‹
 <ğ0 || 
$Å”y
 < 1) {

1506  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1510  
$Å”y
 * (
	`pow
(
$efãù_¿‹
 + 1, 1 / $npery) - 1);

1511 
	}
}

1526 
public
 
funùiÚ
 
	$NPER
(
$¿‹
 = 0, 
$pmt
 = 0, 
$pv
 = 0, 
$fv
 = 0, 
$ty³
 = 0)

1528 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

1529 
$pmt
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pmt);

1530 
$pv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pv);

1531 
$fv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($fv);

1532 
$ty³
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($type);

1535 ià(
$ty³
 != 0 && $type != 1) {

1536  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1540 ià(!
	`is_nuÎ
(
$¿‹
) && $rate != 0) {

1541 ià(
$pmt
 =ğ0 && 
$pv
 == 0) {

1542  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1544  
	`log
((
$pmt
 * (1 + 
$¿‹
 * 
$ty³
è/ $¿‹ - 
$fv
è/ (
$pv
 + $pmt * (1 + $rate * $type) / $rate)) /†og(1 + $rate);

1546 ià(
$pmt
 == 0) {

1547  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1549  (-
$pv
 -
$fv
è/ 
$pmt
;

1550 
	}
}

1559 
public
 
funùiÚ
 
	$NPV
()

1562 
$»tuºV®ue
 = 0;

1565 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

1568 
$¿‹
 = 
	`¬¿y_shiá
(
$aArgs
);

1569 
$i
 = 1; $˜<ğ
	`couÁ
(
$aArgs
); ++$i) {

1571 ià(
	`is_num”ic
(
$aArgs
[
$i
 - 1])) {

1572 
$»tuºV®ue
 +ğ
$aArgs
[
$i
 - 1] / 
	`pow
(1 + 
$¿‹
, $i);

1577  
$»tuºV®ue
;

1578 
	}
}

1592 
public
 
funùiÚ
 
	$PMT
(
$¿‹
 = 0, 
$Å”
 = 0, 
$pv
 = 0, 
$fv
 = 0, 
$ty³
 = 0)

1594 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

1595 
$Å”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($nper);

1596 
$pv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pv);

1597 
$fv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($fv);

1598 
$ty³
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($type);

1601 ià(
$ty³
 != 0 && $type != 1) {

1602  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1606 ià(!
	`is_nuÎ
(
$¿‹
) && $rate != 0) {

1607  (-
$fv
 - 
$pv
 * 
	`pow
(1 + 
$¿‹
, 
$Å”
)è/ (1 + $¿‹ * 
$ty³
) / ((pow(1 + $rate, $nper) - 1) / $rate);

1609  (-
$pv
 - 
$fv
è/ 
$Å”
;

1610 
	}
}

1626 
public
 
funùiÚ
 
	$PPMT
(
$¿‹
, 
$³r
, 
$Å”
, 
$pv
, 
$fv
 = 0, 
$ty³
 = 0)

1628 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

1629 
$³r
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($per);

1630 
$Å”
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($nper);

1631 
$pv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pv);

1632 
$fv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($fv);

1633 
$ty³
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($type);

1636 ià(
$ty³
 != 0 && $type != 1) {

1637  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1639 ià(
$³r
 <ğ0 || $³¸> 
$Å”
) {

1640  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1644 
$š‹»¡AndPršc®
 = 
£lf
::
	`š‹»¡AndPršc®
(
$¿‹
, 
$³r
, 
$Å”
, 
$pv
, 
$fv
, 
$ty³
);

1645  
$š‹»¡AndPršc®
[1];

1646 
	}
}

1649 
public
 
funùiÚ
 
	$PRICE
(
$£‰Ëm’t
, 
$m©ur™y
, 
$¿‹
, 
$y›ld
, 
$»dem±iÚ
, 
$äequ’cy
, 
$basis
 = 0)

1651 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

1652 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

1653 
$¿‹
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

1654 
$y›ld
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($yield);

1655 
$»dem±iÚ
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($redemption);

1656 
$äequ’cy
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($frequency);

1657 
$basis
 = (
	`is_nuÎ
($basis)è? 0 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

1659 ià(
	`is_¡ršg
(
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($settlement))) {

1660  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1662 ià(
	`is_¡ršg
(
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($maturity))) {

1663  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1666 ià((
$£‰Ëm’t
 > 
$m©ur™y
) ||

1667 (!
£lf
::
	`isV®idF»qu’cy
(
$äequ’cy
)) ||

1668 ((
$basis
 < 0) || ($basis > 4))) {

1669  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1672 
$dsc
 = 
£lf
::
	`COUPDAYSNC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$basis
);

1673 
$e
 = 
£lf
::
	`COUPDAYS
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$basis
);

1674 
$n
 = 
£lf
::
	`COUPNUM
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$basis
);

1675 
$a
 = 
£lf
::
	`COUPDAYBS
(
$£‰Ëm’t
, 
$m©ur™y
, 
$äequ’cy
, 
$basis
);

1677 
$ba£YF
 = 1.0 + (
$y›ld
 / 
$äequ’cy
);

1678 
$rå
 = 100 * (
$¿‹
 / 
$äequ’cy
);

1679 
$de
 = 
$dsc
 / 
$e
;

1681 
$»suÉ
 = 
$»dem±iÚ
 / 
	`pow
(
$ba£YF
, (--
$n
 + 
$de
));

1682 
$k
 = 0; $k <ğ
$n
; ++$k) {

1683 
$»suÉ
 +ğ
$rå
 / (
	`pow
(
$ba£YF
, (
$k
 + 
$de
)));

1685 
$»suÉ
 -ğ
$rå
 * (
$a
 / 
$e
);

1687  
$»suÉ
;

1688 
	}
}

1710 
public
 
funùiÚ
 
	$PRICEDISC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$discouÁ
, 
$»dem±iÚ
, 
$basis
 = 0)

1712 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

1713 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

1714 
$discouÁ
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($discount);

1715 
$»dem±iÚ
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($redemption);

1716 
$basis
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

1719 ià((
	`is_num”ic
(
$discouÁ
)è&& (is_num”ic(
$»dem±iÚ
)è&& (is_num”ic(
$basis
))) {

1720 ià((
$discouÁ
 <ğ0è|| (
$»dem±iÚ
 <= 0)) {

1721  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1723 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$basis
);

1724 ià(!
	`is_num”ic
(
$daysB‘w“nS‘em’tAndM©ur™y
)) {

1726  
$daysB‘w“nS‘em’tAndM©ur™y
;

1729  
$»dem±iÚ
 * (1 - 
$discouÁ
 * 
$daysB‘w“nS‘em’tAndM©ur™y
);

1731  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1732 
	}
}

1755 
public
 
funùiÚ
 
	$PRICEMAT
(
$£‰Ëm’t
, 
$m©ur™y
, 
$issue
, 
$¿‹
, 
$y›ld
, 
$basis
 = 0)

1757 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

1758 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

1759 
$issue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($issue);

1760 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

1761 
$y›ld
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($yield);

1762 
$basis
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

1765 ià(
	`is_num”ic
(
$¿‹
è&& is_num”ic(
$y›ld
)) {

1766 ià((
$¿‹
 <ğ0è|| (
$y›ld
 <= 0)) {

1767  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1769 
$daysP”Y—r
 = 
£lf
::
	`daysP”Y—r
(
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEAR
(
$£‰Ëm’t
), 
$basis
);

1770 ià(!
	`is_num”ic
(
$daysP”Y—r
)) {

1771  
$daysP”Y—r
;

1773 
$daysB‘w“nIssueAndS‘em’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$issue
, 
$£‰Ëm’t
, 
$basis
);

1774 ià(!
	`is_num”ic
(
$daysB‘w“nIssueAndS‘em’t
)) {

1776  
$daysB‘w“nIssueAndS‘em’t
;

1778 
$daysB‘w“nIssueAndS‘em’t
 *ğ
$daysP”Y—r
;

1779 
$daysB‘w“nIssueAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$issue
, 
$m©ur™y
, 
$basis
);

1780 ià(!
	`is_num”ic
(
$daysB‘w“nIssueAndM©ur™y
)) {

1782  
$daysB‘w“nIssueAndM©ur™y
;

1784 
$daysB‘w“nIssueAndM©ur™y
 *ğ
$daysP”Y—r
;

1785 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$basis
);

1786 ià(!
	`is_num”ic
(
$daysB‘w“nS‘em’tAndM©ur™y
)) {

1788  
$daysB‘w“nS‘em’tAndM©ur™y
;

1790 
$daysB‘w“nS‘em’tAndM©ur™y
 *ğ
$daysP”Y—r
;

1792  ((100 + ((
$daysB‘w“nIssueAndM©ur™y
 / 
$daysP”Y—r
è* 
$¿‹
 * 100)) /

1793 (1 + ((
$daysB‘w“nS‘em’tAndM©ur™y
 / 
$daysP”Y—r
è* 
$y›ld
)) -

1794 ((
$daysB‘w“nIssueAndS‘em’t
 / 
$daysP”Y—r
è* 
$¿‹
 * 100));

1796  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1797 
	}
}

1812 
public
 
funùiÚ
 
	$PV
(
$¿‹
 = 0, 
$Å”
 = 0, 
$pmt
 = 0, 
$fv
 = 0, 
$ty³
 = 0)

1814 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

1815 
$Å”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($nper);

1816 
$pmt
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pmt);

1817 
$fv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($fv);

1818 
$ty³
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($type);

1821 ià(
$ty³
 != 0 && $type != 1) {

1822  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1826 ià(!
	`is_nuÎ
(
$¿‹
) && $rate != 0) {

1827  (-
$pmt
 * (1 + 
$¿‹
 * 
$ty³
è* ((
	`pow
(1 + $¿‹, 
$Å”
è- 1è/ $¿‹è- 
$fv
) /…ow(1 + $rate, $nper);

1829  -
$fv
 - 
$pmt
 * 
$Å”
;

1830 
	}
}

1863 
public
 
funùiÚ
 
	$RATE
(
$Å”
, 
$pmt
, 
$pv
, 
$fv
 = 0.0, 
$ty³
 = 0, 
$guess
 = 0.1)

1865 
$Å”
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($nper);

1866 
$pmt
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pmt);

1867 
$pv
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($pv);

1868 
$fv
 = (
	`is_nuÎ
($fv)è? 0.0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($fv);

1869 
$ty³
 = (
	`is_nuÎ
($ty³)è? 0 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($type);

1870 
$guess
 = (
	`is_nuÎ
($guess)è? 0.1 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($guess);

1872 
$¿‹
 = 
$guess
;

1873 ià(
	`abs
(
$¿‹
è< 
FINANCIAL_PRECISION
) {

1874 
$y
 = 
$pv
 * (1 + 
$Å”
 * 
$¿‹
è+ 
$pmt
 * (1 + $¿‹ * 
$ty³
è* $Å” + 
$fv
;

1876 
$f
 = 
	`exp
(
$Å”
 * 
	`log
(1 + 
$¿‹
));

1877 
$y
 = 
$pv
 * 
$f
 + 
$pmt
 * (1 / 
$¿‹
 + 
$ty³
è* ($à- 1è+ 
$fv
;

1879 
$y0
 = 
$pv
 + 
$pmt
 * 
$Å”
 + 
$fv
;

1880 
$y1
 = 
$pv
 * 
$f
 + 
$pmt
 * (1 / 
$¿‹
 + 
$ty³
è* ($à- 1è+ 
$fv
;

1883 
$i
 = 
$x0
 = 0.0;

1884 
$x1
 = 
$¿‹
;

1885 (
	`abs
(
$y0
 - 
$y1
è> 
FINANCIAL_PRECISION
è&& (
$i
 < 
FINANCIAL_MAX_ITERATIONS
)) {

1886 
$¿‹
 = (
$y1
 * 
$x0
 - 
$y0
 * 
$x1
) / ($y1 - $y0);

1887 
$x0
 = 
$x1
;

1888 
$x1
 = 
$¿‹
;

1889 ià((
$Å”
 * 
	`abs
(
$pmt
)è> (
$pv
 - 
$fv
)) {

1890 
$x1
 = 
	`abs
($x1);

1892 ià(
	`abs
(
$¿‹
è< 
FINANCIAL_PRECISION
) {

1893 
$y
 = 
$pv
 * (1 + 
$Å”
 * 
$¿‹
è+ 
$pmt
 * (1 + $¿‹ * 
$ty³
è* $Å” + 
$fv
;

1895 
$f
 = 
	`exp
(
$Å”
 * 
	`log
(1 + 
$¿‹
));

1896 
$y
 = 
$pv
 * 
$f
 + 
$pmt
 * (1 / 
$¿‹
 + 
$ty³
è* ($à- 1è+ 
$fv
;

1899 
$y0
 = 
$y1
;

1900 
$y1
 = 
$y
;

1901 ++
$i
;

1903  
$¿‹
;

1904 
	}
}

1926 
public
 
funùiÚ
 
	$RECEIVED
(
$£‰Ëm’t
, 
$m©ur™y
, 
$šve¡m’t
, 
$discouÁ
, 
$basis
 = 0)

1928 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

1929 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

1930 
$šve¡m’t
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($investment);

1931 
$discouÁ
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($discount);

1932 
$basis
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

1935 ià((
	`is_num”ic
(
$šve¡m’t
)è&& (is_num”ic(
$discouÁ
)è&& (is_num”ic(
$basis
))) {

1936 ià((
$šve¡m’t
 <ğ0è|| (
$discouÁ
 <= 0)) {

1937  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1939 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$basis
);

1940 ià(!
	`is_num”ic
(
$daysB‘w“nS‘em’tAndM©ur™y
)) {

1942  
$daysB‘w“nS‘em’tAndM©ur™y
;

1945  
$šve¡m’t
 / ( 1 - (
$discouÁ
 * 
$daysB‘w“nS‘em’tAndM©ur™y
));

1947  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1948 
	}
}

1961 
public
 
funùiÚ
 
	$SLN
(
$co¡
, 
$§lvage
, 
$liã
)

1963 
$co¡
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($cost);

1964 
$§lvage
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($salvage);

1965 
$liã
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($life);

1968 ià((
	`is_num”ic
(
$co¡
)è&& (is_num”ic(
$§lvage
)è&& (is_num”ic(
$liã
))) {

1969 ià(
$liã
 < 0) {

1970  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1972  (
$co¡
 - 
$§lvage
è/ 
$liã
;

1974  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1975 
	}
}

1989 
public
 
funùiÚ
 
	$SYD
(
$co¡
, 
$§lvage
, 
$liã
, 
$³riod
)

1991 
$co¡
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($cost);

1992 
$§lvage
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($salvage);

1993 
$liã
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($life);

1994 
$³riod
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($period);

1997 ià((
	`is_num”ic
(
$co¡
)è&& (is_num”ic(
$§lvage
)è&& (is_num”ic(
$liã
)è&& (is_num”ic(
$³riod
))) {

1998 ià((
$liã
 < 1è|| (
$³riod
 > $life)) {

1999  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2001  ((
$co¡
 - 
$§lvage
è* (
$liã
 - 
$³riod
 + 1) * 2) / ($life * ($life + 1));

2003  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2004 
	}
}

2019 
public
 
funùiÚ
 
	$TBILLEQ
(
$£‰Ëm’t
, 
$m©ur™y
, 
$discouÁ
)

2021 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

2022 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

2023 
$discouÁ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($discount);

2026 
$‹¡V®ue
 = 
£lf
::
	`TBILLPRICE
(
$£‰Ëm’t
, 
$m©ur™y
, 
$discouÁ
);

2027 ià(
	`is_¡ršg
(
$‹¡V®ue
)) {

2028  
$‹¡V®ue
;

2031 ià(
	`is_¡ršg
(
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($maturity))) {

2032  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2035 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

2036 ++
$m©ur™y
;

2037 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
) * 360;

2039 
$daysB‘w“nS‘em’tAndM©ur™y
 = (
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
(
$m©ur™y
è- PHPExûl_C®cuÏtiÚ_D©eTime::g‘D©eV®ue(
$£‰Ëm’t
));

2042  (365 * 
$discouÁ
è/ (360 - $discouÁ * 
$daysB‘w“nS‘em’tAndM©ur™y
);

2043 
	}
}

2058 
public
 
funùiÚ
 
	$TBILLPRICE
(
$£‰Ëm’t
, 
$m©ur™y
, 
$discouÁ
)

2060 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

2061 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

2062 
$discouÁ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($discount);

2064 ià(
	`is_¡ršg
(
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
($maturity))) {

2065  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2069 ià(
	`is_num”ic
(
$discouÁ
)) {

2070 ià(
$discouÁ
 <= 0) {

2071  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2074 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

2075 ++
$m©ur™y
;

2076 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
) * 360;

2077 ià(!
	`is_num”ic
(
$daysB‘w“nS‘em’tAndM©ur™y
)) {

2079  
$daysB‘w“nS‘em’tAndM©ur™y
;

2082 
$daysB‘w“nS‘em’tAndM©ur™y
 = (
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
(
$m©ur™y
è- PHPExûl_C®cuÏtiÚ_D©eTime::g‘D©eV®ue(
$£‰Ëm’t
));

2085 ià(
$daysB‘w“nS‘em’tAndM©ur™y
 > 360) {

2086  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2089 
$´iû
 = 100 * (1 - ((
$discouÁ
 * 
$daysB‘w“nS‘em’tAndM©ur™y
) / 360));

2090 ià(
$´iû
 <= 0) {

2091  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2093  
$´iû
;

2095  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2096 
	}
}

2111 
public
 
funùiÚ
 
	$TBILLYIELD
(
$£‰Ëm’t
, 
$m©ur™y
, 
$´iû
)

2113 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

2114 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

2115 
$´iû
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($price);

2118 ià(
	`is_num”ic
(
$´iû
)) {

2119 ià(
$´iû
 <= 0) {

2120  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2123 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

2124 ++
$m©ur™y
;

2125 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
) * 360;

2126 ià(!
	`is_num”ic
(
$daysB‘w“nS‘em’tAndM©ur™y
)) {

2128  
$daysB‘w“nS‘em’tAndM©ur™y
;

2131 
$daysB‘w“nS‘em’tAndM©ur™y
 = (
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`g‘D©eV®ue
(
$m©ur™y
è- PHPExûl_C®cuÏtiÚ_D©eTime::g‘D©eV®ue(
$£‰Ëm’t
));

2134 ià(
$daysB‘w“nS‘em’tAndM©ur™y
 > 360) {

2135  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2138  ((100 - 
$´iû
è/ $´iûè* (360 / 
$daysB‘w“nS‘em’tAndM©ur™y
);

2140  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2141 
	}
}

2144 
public
 
funùiÚ
 
	$XIRR
(
$v®ues
, 
$d©es
, 
$guess
 = 0.1)

2146 ià((!
	`is_¬¿y
(
$v®ues
)è&& (!is_¬¿y(
$d©es
))) {

2147  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2149 
$v®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($values);

2150 
$d©es
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($dates);

2151 
$guess
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($guess);

2152 ià(
	`couÁ
(
$v®ues
è!ğcouÁ(
$d©es
)) {

2153  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2157 
$x1
 = 0.0;

2158 
$x2
 = 
$guess
;

2159 
$f1
 = 
£lf
::
	`XNPV
(
$x1
, 
$v®ues
, 
$d©es
);

2160 
$f2
 = 
£lf
::
	`XNPV
(
$x2
, 
$v®ues
, 
$d©es
);

2161 
$i
 = 0; $˜< 
FINANCIAL_MAX_ITERATIONS
; ++$i) {

2162 ià((
$f1
 * 
$f2
) < 0.0) {

2164 } 
	`–£if
 (
	`abs
(
$f1
è<‡bs(
$f2
)) {

2165 
$f1
 = 
£lf
::
	`XNPV
(
$x1
 +ğ1.6 * ($x1 - 
$x2
), 
$v®ues
, 
$d©es
);

2167 
$f2
 = 
£lf
::
	`XNPV
(
$x2
 +ğ1.6 * ($x2 - 
$x1
), 
$v®ues
, 
$d©es
);

2170 ià((
$f1
 * 
$f2
) > 0.0) {

2171  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2174 
$f
 = 
£lf
::
	`XNPV
(
$x1
, 
$v®ues
, 
$d©es
);

2175 ià(
$f
 < 0.0) {

2176 
$¹b
 = 
$x1
;

2177 
$dx
 = 
$x2
 - 
$x1
;

2179 
$¹b
 = 
$x2
;

2180 
$dx
 = 
$x1
 - 
$x2
;

2183 
$i
 = 0; $˜< 
FINANCIAL_MAX_ITERATIONS
; ++$i) {

2184 
$dx
 *= 0.5;

2185 
$x_mid
 = 
$¹b
 + 
$dx
;

2186 
$f_mid
 = 
£lf
::
	`XNPV
(
$x_mid
, 
$v®ues
, 
$d©es
);

2187 ià(
$f_mid
 <= 0.0) {

2188 
$¹b
 = 
$x_mid
;

2190 ià((
	`abs
(
$f_mid
è< 
FINANCIAL_PRECISION
è|| (abs(
$dx
) < FINANCIAL_PRECISION)) {

2191  
$x_mid
;

2194  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2195 
	}
}

2217 
public
 
funùiÚ
 
	$XNPV
(
$¿‹
, 
$v®ues
, 
$d©es
)

2219 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

2220 ià(!
	`is_num”ic
(
$¿‹
)) {

2221  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2223 ià((!
	`is_¬¿y
(
$v®ues
)è|| (!is_¬¿y(
$d©es
))) {

2224  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2226 
$v®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($values);

2227 
$d©es
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($dates);

2228 
$v®CouÁ
 = 
	`couÁ
(
$v®ues
);

2229 ià(
$v®CouÁ
 !ğ
	`couÁ
(
$d©es
)) {

2230  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2232 ià((
	`mš
(
$v®ues
è> 0è|| (
	`max
($values) < 0)) {

2233  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2236 
$xÅv
 = 0.0;

2237 
$i
 = 0; $˜< 
$v®CouÁ
; ++$i) {

2238 ià(!
	`is_num”ic
(
$v®ues
[
$i
])) {

2239  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2241 
$xÅv
 +ğ
$v®ues
[
$i
] / 
	`pow
(1 + 
$¿‹
, 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`DATEDIF
(
$d©es
[0], $dates[$i], 'd') / 365);

2243  (
	`is_fš™e
(
$xÅv
)è? $xÅv : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2244 
	}
}

2266 
public
 
funùiÚ
 
	$YIELDDISC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$´iû
, 
$»dem±iÚ
, 
$basis
 = 0)

2268 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

2269 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

2270 
$´iû
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($price);

2271 
$»dem±iÚ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($redemption);

2272 
$basis
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

2275 ià(
	`is_num”ic
(
$´iû
è&& is_num”ic(
$»dem±iÚ
)) {

2276 ià((
$´iû
 <ğ0è|| (
$»dem±iÚ
 <= 0)) {

2277  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2279 
$daysP”Y—r
 = 
£lf
::
	`daysP”Y—r
(
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEAR
(
$£‰Ëm’t
), 
$basis
);

2280 ià(!
	`is_num”ic
(
$daysP”Y—r
)) {

2281  
$daysP”Y—r
;

2283 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$basis
);

2284 ià(!
	`is_num”ic
(
$daysB‘w“nS‘em’tAndM©ur™y
)) {

2286  
$daysB‘w“nS‘em’tAndM©ur™y
;

2288 
$daysB‘w“nS‘em’tAndM©ur™y
 *ğ
$daysP”Y—r
;

2290  ((
$»dem±iÚ
 - 
$´iû
è/ $´iûè* (
$daysP”Y—r
 / 
$daysB‘w“nS‘em’tAndM©ur™y
);

2292  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2293 
	}
}

2316 
public
 
funùiÚ
 
	$YIELDMAT
(
$£‰Ëm’t
, 
$m©ur™y
, 
$issue
, 
$¿‹
, 
$´iû
, 
$basis
 = 0)

2318 
$£‰Ëm’t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($settlement);

2319 
$m©ur™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($maturity);

2320 
$issue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($issue);

2321 
$¿‹
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rate);

2322 
$´iû
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($price);

2323 
$basis
 = (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($basis);

2326 ià(
	`is_num”ic
(
$¿‹
è&& is_num”ic(
$´iû
)) {

2327 ià((
$¿‹
 <ğ0è|| (
$´iû
 <= 0)) {

2328  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2330 
$daysP”Y—r
 = 
£lf
::
	`daysP”Y—r
(
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEAR
(
$£‰Ëm’t
), 
$basis
);

2331 ià(!
	`is_num”ic
(
$daysP”Y—r
)) {

2332  
$daysP”Y—r
;

2334 
$daysB‘w“nIssueAndS‘em’t
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$issue
, 
$£‰Ëm’t
, 
$basis
);

2335 ià(!
	`is_num”ic
(
$daysB‘w“nIssueAndS‘em’t
)) {

2337  
$daysB‘w“nIssueAndS‘em’t
;

2339 
$daysB‘w“nIssueAndS‘em’t
 *ğ
$daysP”Y—r
;

2340 
$daysB‘w“nIssueAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$issue
, 
$m©ur™y
, 
$basis
);

2341 ià(!
	`is_num”ic
(
$daysB‘w“nIssueAndM©ur™y
)) {

2343  
$daysB‘w“nIssueAndM©ur™y
;

2345 
$daysB‘w“nIssueAndM©ur™y
 *ğ
$daysP”Y—r
;

2346 
$daysB‘w“nS‘em’tAndM©ur™y
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`YEARFRAC
(
$£‰Ëm’t
, 
$m©ur™y
, 
$basis
);

2347 ià(!
	`is_num”ic
(
$daysB‘w“nS‘em’tAndM©ur™y
)) {

2349  
$daysB‘w“nS‘em’tAndM©ur™y
;

2351 
$daysB‘w“nS‘em’tAndM©ur™y
 *ğ
$daysP”Y—r
;

2353  ((1 + ((
$daysB‘w“nIssueAndM©ur™y
 / 
$daysP”Y—r
è* 
$¿‹
è- ((
$´iû
 / 100è+ ((
$daysB‘w“nIssueAndS‘em’t
 / $daysPerYear) * $rate))) /

2354 ((
$´iû
 / 100è+ ((
$daysB‘w“nIssueAndS‘em’t
 / 
$daysP”Y—r
è* 
$¿‹
))) *

2355 (
$daysP”Y—r
 / 
$daysB‘w“nS‘em’tAndM©ur™y
);

2357  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2358 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/FormulaParser.php

1 <?
php


53 şas 
	cPHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r


56 cÚ¡ 
	mQUOTE_DOUBLE
 = '"';

57 cÚ¡ 
	mQUOTE_SINGLE
 = '\'';

58 cÚ¡ 
	mBRACKET_CLOSE
 = ']';

59 cÚ¡ 
	mBRACKET_OPEN
 = '[';

60 cÚ¡ 
	mBRACE_OPEN
 = '{';

61 cÚ¡ 
	mBRACE_CLOSE
 = '}';

62 cÚ¡ 
	mPAREN_OPEN
 = '(';

63 cÚ¡ 
	mPAREN_CLOSE
 = ')';

64 cÚ¡ 
	mSEMICOLON
 = ';';

65 cÚ¡ 
	mWHITESPACE
 = ' ';

66 cÚ¡ 
	mCOMMA
 = ',';

67 cÚ¡ 
	mERROR_START
 = '#';

69 cÚ¡ 
	mOPERATORS_SN
 = "+-";

70 cÚ¡ 
	mOPERATORS_INFIX
 = "+-*/^&=><";

71 cÚ¡ 
	mOPERATORS_POSTFIX
 = "%";

78 
´iv©e
 
	m$fÜmuÏ
;

85 
´iv©e
 
	m$tok’s
 = 
¬¿y
();

93 
public
 
funùiÚ
 
__cÚ¡ruù
(
$pFÜmuÏ
 = '')

96 ià(
is_nuÎ
(
$pFÜmuÏ
)) {

97 
throw
 
Ãw
 
PHPExûl_C®cuÏtiÚ_Exû±iÚ
("Invalid…arameter…assed: formula");

101 
	m$this
->
	mfÜmuÏ
 = 
Œim
(
$pFÜmuÏ
);

103 
	m$this
->
·r£ToTok’s
();

111 
public
 
funùiÚ
 
	$g‘FÜmuÏ
()

113  
$this
->
fÜmuÏ
;

114 
	}
}

123 
public
 
funùiÚ
 
	$g‘Tok’
(
$pId
 = 0)

125 ià(
	`is£t
(
$this
->
tok’s
[
$pId
])) {

126  
$this
->
tok’s
[
$pId
];

128 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
("Token with id $pId does‚otƒxist.");

130 
	}
}

137 
public
 
funùiÚ
 
	$g‘Tok’CouÁ
()

139  
	`couÁ
(
$this
->
tok’s
);

140 
	}
}

147 
public
 
funùiÚ
 
	$g‘Tok’s
()

149  
$this
->
tok’s
;

150 
	}
}

155 
´iv©e
 
funùiÚ
 
	$·r£ToTok’s
()

161 
$fÜmuÏL’gth
 = 
	`¡¾’
(
$this
->
fÜmuÏ
);

162 ià(
$fÜmuÏL’gth
 < 2 || 
$this
->
fÜmuÏ
{0} != '=') {

167 
$tok’s1
 = 
$tok’s2
 = 
$¡ack
 = 
	`¬¿y
();

168 
$šSŒšg
 = 
$šP©h
 = 
$šRªge
 = 
$šE¼Ü
 = 
çl£
;

169 
$tok’
 = 
$´eviousTok’
 = 
$ÃxtTok’
 = 
nuÎ
;

171 
$šdex
 = 1;

172 
$v®ue
 = '';

174 
$ERRORS
 = 
	`¬¿y
("#NULL!", "#DIV/0!", "#VALUE!", "#REF!", "#NAME?", "#NUM!", "#N/A");

175 
$COMPARATORS_MULTI
 = 
	`¬¿y
(">=", "<=", "<>");

177 
$šdex
 < 
$fÜmuÏL’gth
) {

183 ià(
$šSŒšg
) {

184 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
QUOTE_DOUBLE
) {

185 ià(((
$šdex
 + 2è<ğ
$fÜmuÏL’gth
è&& (
$this
->
fÜmuÏ
{$šdex + 1} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
QUOTE_DOUBLE
)) {

186 
$v®ue
 .ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
QUOTE_DOUBLE
;

187 ++
$šdex
;

189 
$šSŒšg
 = 
çl£
;

190 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
, PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_TEXT
);

191 
$v®ue
 = "";

194 
$v®ue
 .ğ
$this
->
fÜmuÏ
{
$šdex
};

196 ++
$šdex
;

203 ià(
$šP©h
) {

204 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
QUOTE_SINGLE
) {

205 ià(((
$šdex
 + 2è<ğ
$fÜmuÏL’gth
è&& (
$this
->
fÜmuÏ
{$šdex + 1} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
QUOTE_SINGLE
)) {

206 
$v®ue
 .ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
QUOTE_SINGLE
;

207 ++
$šdex
;

209 
$šP©h
 = 
çl£
;

212 
$v®ue
 .ğ
$this
->
fÜmuÏ
{
$šdex
};

214 ++
$šdex
;

221 ià(
$šRªge
) {

222 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
BRACKET_CLOSE
) {

223 
$šRªge
 = 
çl£
;

225 
$v®ue
 .ğ
$this
->
fÜmuÏ
{
$šdex
};

226 ++
$šdex
;

232 ià(
$šE¼Ü
) {

233 
$v®ue
 .ğ
$this
->
fÜmuÏ
{
$šdex
};

234 ++
$šdex
;

235 ià(
	`š_¬¿y
(
$v®ue
, 
$ERRORS
)) {

236 
$šE¼Ü
 = 
çl£
;

237 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
, PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_ERROR
);

238 
$v®ue
 = "";

244 ià(
	`¡½os
(
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
OPERATORS_SN
, 
$this
->
fÜmuÏ
{
$šdex
}è!=ğ
çl£
) {

245 ià(
	`¡¾’
(
$v®ue
) > 1) {

246 ià(
	`´eg_m©ch
("/^[1-9]{1}(\.[0-9]+)?E{1}$/", 
$this
->
fÜmuÏ
{
$šdex
}) != 0) {

247 
$v®ue
 .ğ
$this
->
fÜmuÏ
{
$šdex
};

248 ++
$šdex
;

257 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
QUOTE_DOUBLE
) {

258 ià(
	`¡¾’
(
$v®ue
 > 0)) {

260 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_UNKNOWN
);

261 
$v®ue
 = "";

263 
$šSŒšg
 = 
Œue
;

264 ++
$šdex
;

268 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
QUOTE_SINGLE
) {

269 ià(
	`¡¾’
(
$v®ue
) > 0) {

271 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_UNKNOWN
);

272 
$v®ue
 = "";

274 
$šP©h
 = 
Œue
;

275 ++
$šdex
;

279 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
BRACKET_OPEN
) {

280 
$šRªge
 = 
Œue
;

281 
$v®ue
 .ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
BRACKET_OPEN
;

282 ++
$šdex
;

286 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
ERROR_START
) {

287 ià(
	`¡¾’
(
$v®ue
) > 0) {

289 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_UNKNOWN
);

290 
$v®ue
 = "";

292 
$šE¼Ü
 = 
Œue
;

293 
$v®ue
 .ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
ERROR_START
;

294 ++
$šdex
;

299 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
BRACE_OPEN
) {

300 ià(
	`¡¾’
(
$v®ue
) > 0) {

302 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_UNKNOWN
);

303 
$v®ue
 = "";

306 
$tmp
 = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
("ARRAY", 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_FUNCTION
, PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_START
);

307 
$tok’s1
[] = 
$tmp
;

308 
$¡ack
[] = 
şÚe
 
$tmp
;

310 
$tmp
 = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
("ARRAYROW", 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_FUNCTION
, PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_START
);

311 
$tok’s1
[] = 
$tmp
;

312 
$¡ack
[] = 
şÚe
 
$tmp
;

314 ++
$šdex
;

318 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
SEMICOLON
) {

319 ià(
	`¡¾’
(
$v®ue
) > 0) {

320 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
);

321 
$v®ue
 = "";

324 
$tmp
 = 
	`¬¿y_pİ
(
$¡ack
);

325 
$tmp
->
	`£tV®ue
("");

326 
$tmp
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_STOP
);

327 
$tok’s1
[] = 
$tmp
;

329 
$tmp
 = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(",", 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_ARGUMENT
);

330 
$tok’s1
[] = 
$tmp
;

332 
$tmp
 = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
("ARRAYROW", 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_FUNCTION
, PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_START
);

333 
$tok’s1
[] = 
$tmp
;

334 
$¡ack
[] = 
şÚe
 
$tmp
;

336 ++
$šdex
;

340 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
BRACE_CLOSE
) {

341 ià(
	`¡¾’
(
$v®ue
) > 0) {

342 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
);

343 
$v®ue
 = "";

346 
$tmp
 = 
	`¬¿y_pİ
(
$¡ack
);

347 
$tmp
->
	`£tV®ue
("");

348 
$tmp
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_STOP
);

349 
$tok’s1
[] = 
$tmp
;

351 
$tmp
 = 
	`¬¿y_pİ
(
$¡ack
);

352 
$tmp
->
	`£tV®ue
("");

353 
$tmp
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_STOP
);

354 
$tok’s1
[] = 
$tmp
;

356 ++
$šdex
;

361 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
WHITESPACE
) {

362 ià(
	`¡¾’
(
$v®ue
) > 0) {

363 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
);

364 
$v®ue
 = "";

366 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
("", 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_WHITESPACE
);

367 ++
$šdex
;

368 (
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
WHITESPACE
è&& ($šdex < 
$fÜmuÏL’gth
)) {

369 ++
$šdex
;

375 ià((
$šdex
 + 2è<ğ
$fÜmuÏL’gth
) {

376 ià(
	`š_¬¿y
(
	`sub¡r
(
$this
->
fÜmuÏ
, 
$šdex
, 2), 
$COMPARATORS_MULTI
)) {

377 ià(
	`¡¾’
(
$v®ue
) > 0) {

378 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
);

379 
$v®ue
 = "";

381 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
	`sub¡r
(
$this
->
fÜmuÏ
, 
$šdex
, 2), 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORINFIX
, PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_LOGICAL
);

382 
$šdex
 += 2;

388 ià(
	`¡½os
(
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
OPERATORS_INFIX
, 
$this
->
fÜmuÏ
{
$šdex
}è!=ğ
çl£
) {

389 ià(
	`¡¾’
(
$v®ue
) > 0) {

390 
$tok’s1
[] =
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
);

391 
$v®ue
 = "";

393 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$this
->
fÜmuÏ
{
$šdex
}, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORINFIX
);

394 ++
$šdex
;

399 ià(
	`¡½os
(
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
OPERATORS_POSTFIX
, 
$this
->
fÜmuÏ
{
$šdex
}è!=ğ
çl£
) {

400 ià(
	`¡¾’
(
$v®ue
) > 0) {

401 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
);

402 
$v®ue
 = "";

404 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$this
->
fÜmuÏ
{
$šdex
}, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORPOSTFIX
);

405 ++
$šdex
;

410 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
PAREN_OPEN
) {

411 ià(
	`¡¾’
(
$v®ue
) > 0) {

412 
$tmp
 = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_FUNCTION
, PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_START
);

413 
$tok’s1
[] = 
$tmp
;

414 
$¡ack
[] = 
şÚe
 
$tmp
;

415 
$v®ue
 = "";

417 
$tmp
 = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
("", 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_SUBEXPRESSION
, PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_START
);

418 
$tok’s1
[] = 
$tmp
;

419 
$¡ack
[] = 
şÚe
 
$tmp
;

421 ++
$šdex
;

426 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
COMMA
) {

427 ià(
	`¡¾’
(
$v®ue
) > 0) {

428 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
);

429 
$v®ue
 = "";

432 
$tmp
 = 
	`¬¿y_pİ
(
$¡ack
);

433 
$tmp
->
	`£tV®ue
("");

434 
$tmp
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_STOP
);

435 
$¡ack
[] = 
$tmp
;

437 ià(
$tmp
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_FUNCTION
) {

438 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(",", 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORINFIX
, PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_UNION
);

440 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(",", 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_ARGUMENT
);

442 ++
$šdex
;

447 ià(
$this
->
fÜmuÏ
{
$šdex
} =ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏP¬£r
::
PAREN_CLOSE
) {

448 ià(
	`¡¾’
(
$v®ue
) > 0) {

449 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
);

450 
$v®ue
 = "";

453 
$tmp
 = 
	`¬¿y_pİ
(
$¡ack
);

454 
$tmp
->
	`£tV®ue
("");

455 
$tmp
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_STOP
);

456 
$tok’s1
[] = 
$tmp
;

458 ++
$šdex
;

463 
$v®ue
 .ğ
$this
->
fÜmuÏ
{
$šdex
};

464 ++
$šdex
;

468 ià(
	`¡¾’
(
$v®ue
) > 0) {

469 
$tok’s1
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
);

473 
$tok’CouÁ
 = 
	`couÁ
(
$tok’s1
);

474 
$i
 = 0; $˜< 
$tok’CouÁ
; ++$i) {

475 
$tok’
 = 
$tok’s1
[
$i
];

476 ià(
	`is£t
(
$tok’s1
[
$i
 - 1])) {

477 
$´eviousTok’
 = 
$tok’s1
[
$i
 - 1];

479 
$´eviousTok’
 = 
nuÎ
;

481 ià(
	`is£t
(
$tok’s1
[
$i
 + 1])) {

482 
$ÃxtTok’
 = 
$tok’s1
[
$i
 + 1];

484 
$ÃxtTok’
 = 
nuÎ
;

487 ià(
	`is_nuÎ
(
$tok’
)) {

491 ià(
$tok’
->
	`g‘Tok’Ty³
(è!ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_WHITESPACE
) {

492 
$tok’s2
[] = 
$tok’
;

496 ià(
	`is_nuÎ
(
$´eviousTok’
)) {

501 ((
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_FUNCTION
è&& ($´eviousTok’->
	`g‘Tok’SubTy³
(è=ğPHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_STOP
)) ||

502 ((
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_SUBEXPRESSION
è&& ($´eviousTok’->
	`g‘Tok’SubTy³
(è=ğPHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_STOP
)) ||

503 (
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
)

508 ià(
	`is_nuÎ
(
$ÃxtTok’
)) {

513 ((
$ÃxtTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_FUNCTION
è&& ($ÃxtTok’->
	`g‘Tok’SubTy³
(è=ğPHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_START
)) ||

514 ((
$ÃxtTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_SUBEXPRESSION
è&& ($ÃxtTok’->
	`g‘Tok’SubTy³
(è=ğPHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_START
)) ||

515 (
$ÃxtTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
)

520 
$tok’s2
[] = 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
(
$v®ue
, 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORINFIX
, PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_INTERSECTION
);

525 
$this
->
tok’s
 = 
	`¬¿y
();

527 
$tok’CouÁ
 = 
	`couÁ
(
$tok’s2
);

528 
$i
 = 0; $˜< 
$tok’CouÁ
; ++$i) {

529 
$tok’
 = 
$tok’s2
[
$i
];

530 ià(
	`is£t
(
$tok’s2
[
$i
 - 1])) {

531 
$´eviousTok’
 = 
$tok’s2
[
$i
 - 1];

533 
$´eviousTok’
 = 
nuÎ
;

535 ià(
	`is£t
(
$tok’s2
[
$i
 + 1])) {

536 
$ÃxtTok’
 = 
$tok’s2
[
$i
 + 1];

538 
$ÃxtTok’
 = 
nuÎ
;

541 ià(
	`is_nuÎ
(
$tok’
)) {

545 ià(
$tok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORINFIX
 && $tok’->
	`g‘V®ue
() == "-") {

546 ià(
$i
 == 0) {

547 
$tok’
->
	`£tTok’Ty³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORPREFIX
);

548 } 
	`–£if
 (((
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_FUNCTION
) &&

549 (
$´eviousTok’
->
	`g‘Tok’SubTy³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_STOP
)) ||

550 ((
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_SUBEXPRESSION
) &&

551 (
$´eviousTok’
->
	`g‘Tok’SubTy³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_STOP
)) ||

552 (
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORPOSTFIX
) ||

553 (
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
)) {

554 
$tok’
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_MATH
);

556 
$tok’
->
	`£tTok’Ty³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORPREFIX
);

559 
$this
->
tok’s
[] = 
$tok’
;

563 ià(
$tok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORINFIX
 && $tok’->
	`g‘V®ue
() == "+") {

564 ià(
$i
 == 0) {

566 } 
	`–£if
 (((
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_FUNCTION
) &&

567 (
$´eviousTok’
->
	`g‘Tok’SubTy³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_STOP
)) ||

568 ((
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_SUBEXPRESSION
) &&

569 (
$´eviousTok’
->
	`g‘Tok’SubTy³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_STOP
)) ||

570 (
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORPOSTFIX
) ||

571 (
$´eviousTok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
)) {

572 
$tok’
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_MATH
);

577 
$this
->
tok’s
[] = 
$tok’
;

581 ià(
$tok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERATORINFIX
 &&

582 
$tok’
->
	`g‘Tok’SubTy³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_NOTHING
) {

583 ià(
	`¡½os
("<>=", 
	`sub¡r
(
$tok’
->
	`g‘V®ue
(), 0, 1)è!=ğ
çl£
) {

584 
$tok’
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_LOGICAL
);

585 } 
	`–£if
 (
$tok’
->
	`g‘V®ue
() == "&") {

586 
$tok’
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_CONCATENATION
);

588 
$tok’
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_MATH
);

591 
$this
->
tok’s
[] = 
$tok’
;

595 ià(
$tok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_OPERAND
 &&

596 
$tok’
->
	`g‘Tok’SubTy³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_NOTHING
) {

597 ià(!
	`is_num”ic
(
$tok’
->
	`g‘V®ue
())) {

598 ià(
	`¡¹ouµ”
(
$tok’
->
	`g‘V®ue
()) == "TRUE" || strtoupper($token->getValue() == "FALSE")) {

599 
$tok’
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_LOGICAL
);

601 
$tok’
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_RANGE
);

604 
$tok’
->
	`£tTok’SubTy³
(
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_NUMBER
);

607 
$this
->
tok’s
[] = 
$tok’
;

611 ià(
$tok’
->
	`g‘Tok’Ty³
(è=ğ
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_FUNCTION
) {

612 ià(
	`¡¾’
(
$tok’
->
	`g‘V®ue
() > 0)) {

613 ià(
	`sub¡r
(
$tok’
->
	`g‘V®ue
(), 0, 1) == "@") {

614 
$tok’
->
	`£tV®ue
(
	`sub¡r
($tok’->
	`g‘V®ue
(), 1));

619 
$this
->
tok’s
[] = 
$tok’
;

621 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/FormulaToken.php

1 <?
php


53 şas 
	cPHPExûl_C®cuÏtiÚ_FÜmuÏTok’


56 cÚ¡ 
	mTOKEN_TYPE_NOOP
 = 'Noop';

57 cÚ¡ 
	mTOKEN_TYPE_OPERAND
 = 'Operand';

58 cÚ¡ 
	mTOKEN_TYPE_FUNCTION
 = 'Function';

59 cÚ¡ 
	mTOKEN_TYPE_SUBEXPRESSION
 = 'Subexpression';

60 cÚ¡ 
	mTOKEN_TYPE_ARGUMENT
 = 'Argument';

61 cÚ¡ 
	mTOKEN_TYPE_OPERATORPREFIX
 = 'OperatorPrefix';

62 cÚ¡ 
	mTOKEN_TYPE_OPERATORINFIX
 = 'OperatorInfix';

63 cÚ¡ 
	mTOKEN_TYPE_OPERATORPOSTFIX
 = 'OperatorPostfix';

64 cÚ¡ 
	mTOKEN_TYPE_WHITESPACE
 = 'Whitespace';

65 cÚ¡ 
	mTOKEN_TYPE_UNKNOWN
 = 'Unknown';

68 cÚ¡ 
	mTOKEN_SUBTYPE_NOTHING
 = 'Nothing';

69 cÚ¡ 
	mTOKEN_SUBTYPE_START
 = 'Start';

70 cÚ¡ 
	mTOKEN_SUBTYPE_STOP
 = 'Stop';

71 cÚ¡ 
	mTOKEN_SUBTYPE_TEXT
 = 'Text';

72 cÚ¡ 
	mTOKEN_SUBTYPE_NUMBER
 = 'Number';

73 cÚ¡ 
	mTOKEN_SUBTYPE_LOGICAL
 = 'Logical';

74 cÚ¡ 
	mTOKEN_SUBTYPE_ERROR
 = 'Error';

75 cÚ¡ 
	mTOKEN_SUBTYPE_RANGE
 = 'Range';

76 cÚ¡ 
	mTOKEN_SUBTYPE_MATH
 = 'Math';

77 cÚ¡ 
	mTOKEN_SUBTYPE_CONCATENATION
 = 'Concatenation';

78 cÚ¡ 
	mTOKEN_SUBTYPE_INTERSECTION
 = 'Intersection';

79 cÚ¡ 
	mTOKEN_SUBTYPE_UNION
 = 'Union';

86 
´iv©e
 
	m$v®ue
;

93 
´iv©e
 
	m$tok’Ty³
;

100 
´iv©e
 
	m$tok’SubTy³
;

109 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$pV®ue
, 
$pTok’Ty³
 = 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_UNKNOWN
, 
$pTok’SubTy³
 = PHPExûl_C®cuÏtiÚ_FÜmuÏTok’::
TOKEN_SUBTYPE_NOTHING
)

112 
$this
->
v®ue
 = 
$pV®ue
;

113 
$this
->
tok’Ty³
 = 
$pTok’Ty³
;

114 
$this
->
tok’SubTy³
 = 
$pTok’SubTy³
;

122 
public
 
funùiÚ
 
	$g‘V®ue
()

124  
$this
->
v®ue
;

125 
	}
}

132 
public
 
funùiÚ
 
	$£tV®ue
(
$v®ue
)

134 
$this
->
v®ue
 = 
$v®ue
;

135 
	}
}

142 
public
 
funùiÚ
 
	$g‘Tok’Ty³
()

144  
$this
->
tok’Ty³
;

145 
	}
}

152 
public
 
funùiÚ
 
	$£tTok’Ty³
(
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_TYPE_UNKNOWN
)

154 
$this
->
tok’Ty³
 = 
$v®ue
;

155 
	}
}

162 
public
 
funùiÚ
 
	$g‘Tok’SubTy³
()

164  
$this
->
tok’SubTy³
;

165 
	}
}

172 
public
 
funùiÚ
 
	$£tTok’SubTy³
(
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FÜmuÏTok’
::
TOKEN_SUBTYPE_NOTHING
)

174 
$this
->
tok’SubTy³
 = 
$v®ue
;

175 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Function.php

1 <?
php


28 şas 
	cPHPExûl_C®cuÏtiÚ_FunùiÚ


31 cÚ¡ 
	mCATEGORY_CUBE
 = 'Cube';

32 cÚ¡ 
	mCATEGORY_DATABASE
 = 'Database';

33 cÚ¡ 
	mCATEGORY_DATE_AND_TIME
 = 'Date‡nd Time';

34 cÚ¡ 
	mCATEGORY_ENGINEERING
 = 'Engineering';

35 cÚ¡ 
	mCATEGORY_FINANCIAL
 = 'Financial';

36 cÚ¡ 
	mCATEGORY_INFORMATION
 = 'Information';

37 cÚ¡ 
	mCATEGORY_LOGICAL
 = 'Logical';

38 cÚ¡ 
	mCATEGORY_LOOKUP_AND_REFERENCE
 = 'Lookup‡nd Reference';

39 cÚ¡ 
	mCATEGORY_MATH_AND_TRIG
 = 'Math‡nd Trig';

40 cÚ¡ 
	mCATEGORY_STATISTICAL
 = 'Statistical';

41 cÚ¡ 
	mCATEGORY_TEXT_AND_DATA
 = 'Text‡nd Data';

48 
´iv©e
 
	m$ÿ‹gÜy
;

55 
´iv©e
 
	m$exûlName
;

62 
´iv©e
 
	m$phpExûlName
;

72 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$pC©egÜy
 = 
nuÎ
, 
$pExûlName
 =‚uÎ, 
$pPHPExûlName
 =‚ull)

74 ià((
$pC©egÜy
 !=ğ
nuÎ
è&& (
$pExûlName
 !=ğnuÎè&& (
$pPHPExûlName
 !==‚ull)) {

76 
$this
->
ÿ‹gÜy
 = 
$pC©egÜy
;

77 
$this
->
exûlName
 = 
$pExûlName
;

78 
$this
->
phpExûlName
 = 
$pPHPExûlName
;

80 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
("Invalid…arameters…assed.");

89 
public
 
funùiÚ
 
	$g‘C©egÜy
()

91  
$this
->
ÿ‹gÜy
;

92 
	}
}

100 
public
 
funùiÚ
 
	$£tC©egÜy
(
$v®ue
 = 
nuÎ
)

102 ià(!
	`is_nuÎ
(
$v®ue
)) {

103 
$this
->
ÿ‹gÜy
 = 
$v®ue
;

105 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
("Invalid…arameter…assed.");

107 
	}
}

114 
public
 
funùiÚ
 
	$g‘ExûlName
()

116  
$this
->
exûlName
;

117 
	}
}

124 
public
 
funùiÚ
 
	$£tExûlName
(
$v®ue
)

126 
$this
->
exûlName
 = 
$v®ue
;

127 
	}
}

134 
public
 
funùiÚ
 
	$g‘PHPExûlName
()

136  
$this
->
phpExûlName
;

137 
	}
}

144 
public
 
funùiÚ
 
	$£tPHPExûlName
(
$v®ue
)

146 
$this
->
phpExûlName
 = 
$v®ue
;

147 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Functions.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

14 
defše
('MAX_VALUE', 1.2e308);

17 
defše
('M_2DIVPI', 0.63661977236758134307553505349006);

20 
defše
('MAX_ITERATIONS', 256);

23 
defše
('PRECISION', 8.88E-016);

51 şas 
	cPHPExûl_C®cuÏtiÚ_FunùiÚs


55 cÚ¡ 
	mCOMPATIBILITY_EXCEL
 = 'Excel';

56 cÚ¡ 
	mCOMPATIBILITY_GNUMERIC
 = 'Gnumeric';

57 cÚ¡ 
	mCOMPATIBILITY_OPENOFFICE
 = 'OpenOfficeCalc';

59 cÚ¡ 
	mRETURNDATE_PHP_NUMERIC
 = 'P';

60 cÚ¡ 
	mRETURNDATE_PHP_OBJECT
 = 'O';

61 cÚ¡ 
	mRETURNDATE_EXCEL
 = 'E';

70 
´Ùeùed
 
	m$com·tib™yMode
 = 
£lf
::
COMPATIBILITY_EXCEL
;

78 
´Ùeùed
 
	m$»tuºD©eTy³
 = 
£lf
::
RETURNDATE_EXCEL
;

86 
´Ùeùed
 
	m$”rÜCodes
 = 
¬¿y
(

110 
public
 
funùiÚ
 
	$£tCom·tib™yMode
(
$com·tib™yMode
)

112 ià((
$com·tib™yMode
 =ğ
£lf
::
COMPATIBILITY_EXCEL
) ||

113 (
$com·tib™yMode
 =ğ
£lf
::
COMPATIBILITY_GNUMERIC
) ||

114 (
$com·tib™yMode
 =ğ
£lf
::
COMPATIBILITY_OPENOFFICE
)) {

115 
£lf
::
$com·tib™yMode
 = $compatibilityMode;

116  
Œue
;

118  
çl£
;

133 
public
 
funùiÚ
 
	$g‘Com·tib™yMode
()

135  
£lf
::
$com·tib™yMode
;

136 
	}
}

151 
public
 
funùiÚ
 
	$£tR‘uºD©eTy³
(
$»tuºD©eTy³
)

153 ià((
$»tuºD©eTy³
 =ğ
£lf
::
RETURNDATE_PHP_NUMERIC
) ||

154 (
$»tuºD©eTy³
 =ğ
£lf
::
RETURNDATE_PHP_OBJECT
) ||

155 (
$»tuºD©eTy³
 =ğ
£lf
::
RETURNDATE_EXCEL
)) {

156 
£lf
::
$»tuºD©eTy³
 = $returnDateType;

157  
Œue
;

159  
çl£
;

160 
	}
}

174 
public
 
funùiÚ
 
	$g‘R‘uºD©eTy³
()

176  
£lf
::
$»tuºD©eTy³
;

177 
	}
}

187 
public
 
funùiÚ
 
	$DUMMY
()

190 
	}
}

200 
public
 
funùiÚ
 
	$DIV0
()

202  
£lf
::
$”rÜCodes
['divisionbyzero'];

203 
	}
}

219 
public
 
funùiÚ
 
	$NA
()

221  
£lf
::
$”rÜCodes
['na'];

222 
	}
}

234 
public
 
funùiÚ
 
	$NaN
()

236  
£lf
::
$”rÜCodes
['num'];

237 
	}
}

249 
public
 
funùiÚ
 
	$NAME
()

251  
£lf
::
$”rÜCodes
['name'];

252 
	}
}

264 
public
 
funùiÚ
 
	$REF
()

266  
£lf
::
$”rÜCodes
['reference'];

267 
	}
}

279 
public
 
funùiÚ
 
	$NULL
()

281  
£lf
::
$”rÜCodes
['null'];

282 
	}
}

294 
public
 
funùiÚ
 
	$VALUE
()

296  
£lf
::
$”rÜCodes
['value'];

297 
	}
}

300 
public
 
funùiÚ
 
	$isM©rixV®ue
(
$idx
)

302  ((
	`sub¡r_couÁ
(
$idx
, '.'è<ğ1è|| (
	`´eg_m©ch
('/\.[A-Z]/', $idx) > 0));

303 
	}
}

306 
public
 
funùiÚ
 
	$isV®ue
(
$idx
)

308  (
	`sub¡r_couÁ
(
$idx
, '.') == 0);

309 
	}
}

312 
public
 
funùiÚ
 
	$isC–lV®ue
(
$idx
)

314  (
	`sub¡r_couÁ
(
$idx
, '.') > 1);

315 
	}
}

318 
public
 
funùiÚ
 
	$ifCÚd™iÚ
(
$cÚd™iÚ
)

320 
$cÚd™iÚ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($condition);

321 ià(!
	`is£t
(
$cÚd™iÚ
{0})) {

322 
$cÚd™iÚ
 = '=""';

324 ià(!
	`š_¬¿y
(
$cÚd™iÚ
{0}, 
	`¬¿y
('>', '<', '='))) {

325 ià(!
	`is_num”ic
(
$cÚd™iÚ
)) {

326 
$cÚd™iÚ
 = 
PHPExûl_C®cuÏtiÚ
::
	`w¿pResuÉ
(
	`¡¹ouµ”
($condition));

328  '=' . 
$cÚd™iÚ
;

330 
	`´eg_m©ch
('/([<>=]+)(.*)/', 
$cÚd™iÚ
, 
$m©ches
);

331 
	`li¡
(, 
$İ”©Ü
, 
$İ”ªd
èğ
$m©ches
;

333 ià(!
	`is_num”ic
(
$İ”ªd
)) {

334 
$İ”ªd
 = 
	`¡r_»¶aû
('"', '""', $operand);

335 
$İ”ªd
 = 
PHPExûl_C®cuÏtiÚ
::
	`w¿pResuÉ
(
	`¡¹ouµ”
($operand));

338  
$İ”©Ü
.
$İ”ªd
;

340 
	}
}

348 
public
 
funùiÚ
 
ERROR_TYPE
(
$v®ue
 = '')

350 
$v®ue
 = 
£lf
::
æ©‹nSšgËV®ue
($value);

352 
	g$i
 = 1;

353 
fÜ—ch
 (
£lf
::
$”rÜCodes
 
as
 
$”rÜCode
) {

354 ià(
$v®ue
 ==ğ
$”rÜCode
) {

355  
$i
;

357 ++
	g$i
;

359  
	g£lf
::
NA
();

369 
public
 
funùiÚ
 
	$IS_BLANK
(
$v®ue
 = 
nuÎ
)

371 ià(!
	`is_nuÎ
(
$v®ue
)) {

372 
$v®ue
 = 
£lf
::
	`æ©‹nSšgËV®ue
($value);

375  
	`is_nuÎ
(
$v®ue
);

376 
	}
}

385 
public
 
funùiÚ
 
IS_ERR
(
$v®ue
 = '')

387 
$v®ue
 = 
£lf
::
æ©‹nSšgËV®ue
($value);

389  
	g£lf
::
IS_ERROR
(
$v®ue
è&& (!
£lf
::
IS_NA
($value));

399 
public
 
funùiÚ
 
IS_ERROR
(
$v®ue
 = '')

401 
$v®ue
 = 
£lf
::
æ©‹nSšgËV®ue
($value);

403 ià(!
is_¡ršg
(
$v®ue
)) {

404  
	gçl£
;

406  
š_¬¿y
(
$v®ue
, 
¬¿y_v®ues
(
£lf
::
$”rÜCodes
));

416 
public
 
funùiÚ
 
IS_NA
(
$v®ue
 = '')

418 
$v®ue
 = 
£lf
::
æ©‹nSšgËV®ue
($value);

420  (
	g$v®ue
 ==ğ
£lf
::
NA
());

430 
public
 
funùiÚ
 
	$IS_EVEN
(
$v®ue
 = 
nuÎ
)

432 
$v®ue
 = 
£lf
::
	`æ©‹nSšgËV®ue
($value);

434 ià(
$v®ue
 ==ğ
nuÎ
) {

435  
£lf
::
	`NAME
();

436 } 
	`–£if
 ((
	`is_boŞ
(
$v®ue
)è|| ((
	`is_¡ršg
($v®ue)è&& (!
	`is_num”ic
($value)))) {

437  
£lf
::
	`VALUE
();

440  (
$v®ue
 % 2 == 0);

441 
	}
}

450 
public
 
funùiÚ
 
	$IS_ODD
(
$v®ue
 = 
nuÎ
)

452 
$v®ue
 = 
£lf
::
	`æ©‹nSšgËV®ue
($value);

454 ià(
$v®ue
 ==ğ
nuÎ
) {

455  
£lf
::
	`NAME
();

456 } 
	`–£if
 ((
	`is_boŞ
(
$v®ue
)è|| ((
	`is_¡ršg
($v®ue)è&& (!
	`is_num”ic
($value)))) {

457  
£lf
::
	`VALUE
();

460  (
	`abs
(
$v®ue
) % 2 == 1);

461 
	}
}

470 
public
 
funùiÚ
 
	$IS_NUMBER
(
$v®ue
 = 
nuÎ
)

472 
$v®ue
 = 
£lf
::
	`æ©‹nSšgËV®ue
($value);

474 ià(
	`is_¡ršg
(
$v®ue
)) {

475  
çl£
;

477  
	`is_num”ic
(
$v®ue
);

478 
	}
}

487 
public
 
funùiÚ
 
	$IS_LOGICAL
(
$v®ue
 = 
nuÎ
)

489 
$v®ue
 = 
£lf
::
	`æ©‹nSšgËV®ue
($value);

491  
	`is_boŞ
(
$v®ue
);

492 
	}
}

501 
public
 
funùiÚ
 
	$IS_TEXT
(
$v®ue
 = 
nuÎ
)

503 
$v®ue
 = 
£lf
::
	`æ©‹nSšgËV®ue
($value);

505  (
	`is_¡ršg
(
$v®ue
è&& !
£lf
::
	`IS_ERROR
($value));

506 
	}
}

515 
public
 
funùiÚ
 
	$IS_NONTEXT
(
$v®ue
 = 
nuÎ
)

517  !
£lf
::
	`IS_TEXT
(
$v®ue
);

518 
	}
}

526 
public
 
funùiÚ
 
	$VERSION
()

529 
	}
}

547 
public
 
funùiÚ
 
	$N
(
$v®ue
 = 
nuÎ
)

549 
	`is_¬¿y
(
$v®ue
)) {

550 
$v®ue
 = 
	`¬¿y_shiá
($value);

553 
	`g‘ty³
(
$v®ue
)) {

557  
$v®ue
;

560  (
š‹g”
è
$v®ue
;

564 ià((
	`¡¾’
(
$v®ue
) > 0) && ($value{0} == '#')) {

565  
$v®ue
;

570 
	}
}

587 
public
 
funùiÚ
 
	$TYPE
(
$v®ue
 = 
nuÎ
)

589 
$v®ue
 = 
£lf
::
	`æ©‹nA¼ayIndexed
($value);

590 ià(
	`is_¬¿y
(
$v®ue
è&& (
	`couÁ
($value) > 1)) {

591 
	`’d
(
$v®ue
);

592 
$a
 = 
	`key
(
$v®ue
);

594 ià(
£lf
::
	`isC–lV®ue
(
$a
)) {

597 } 
	`–£if
 (
£lf
::
	`isM©rixV®ue
(
$a
)) {

600 } 
	`–£if
 (
	`em±y
(
$v®ue
)) {

604 
$v®ue
 = 
£lf
::
	`æ©‹nSšgËV®ue
($value);

606 ià((
$v®ue
 ==ğ
nuÎ
è|| (
	`is_æßt
($v®ue)è|| (
	`is_št
($value))) {

608 } 
	`–£if
 (
	`is_boŞ
(
$v®ue
)) {

610 } 
	`–£if
 (
	`is_¬¿y
(
$v®ue
)) {

612 } 
	`–£if
 (
	`is_¡ršg
(
$v®ue
)) {

614 ià((
	`¡¾’
(
$v®ue
) > 0) && ($value{0} == '#')) {

620 
	}
}

629 
public
 
funùiÚ
 
	$æ©‹nA¼ay
(
$¬¿y
)

631 ià(!
	`is_¬¿y
(
$¬¿y
)) {

632  (
¬¿y
è
$¬¿y
;

635 
$¬¿yV®ues
 = 
	`¬¿y
();

636 
	`fÜ—ch
 (
$¬¿y
 
as
 
$v®ue
) {

637 ià(
	`is_¬¿y
(
$v®ue
)) {

638 
	`fÜ—ch
 (
$v®ue
 
as
 
$v®
) {

639 ià(
	`is_¬¿y
(
$v®
)) {

640 
	`fÜ—ch
 (
$v®
 
as
 
$v
) {

641 
$¬¿yV®ues
[] = 
$v
;

644 
$¬¿yV®ues
[] = 
$v®
;

648 
$¬¿yV®ues
[] = 
$v®ue
;

652  
$¬¿yV®ues
;

653 
	}
}

662 
public
 
funùiÚ
 
	$æ©‹nA¼ayIndexed
(
$¬¿y
)

664 ià(!
	`is_¬¿y
(
$¬¿y
)) {

665  (
¬¿y
è
$¬¿y
;

668 
$¬¿yV®ues
 = 
	`¬¿y
();

669 
	`fÜ—ch
 (
$¬¿y
 
as
 
$k1
 => 
$v®ue
) {

670 ià(
	`is_¬¿y
(
$v®ue
)) {

671 
	`fÜ—ch
 (
$v®ue
 
as
 
$k2
 => 
$v®
) {

672 ià(
	`is_¬¿y
(
$v®
)) {

673 
	`fÜ—ch
 (
$v®
 
as
 
$k3
 => 
$v
) {

674 
$¬¿yV®ues
[
$k1
.'.'.
$k2
.'.'.
$k3
] = 
$v
;

677 
$¬¿yV®ues
[
$k1
.'.'.
$k2
] = 
$v®
;

681 
$¬¿yV®ues
[
$k1
] = 
$v®ue
;

685  
$¬¿yV®ues
;

686 
	}
}

695 
public
 
funùiÚ
 
æ©‹nSšgËV®ue
(
$v®ue
 = '')

697 
is_¬¿y
(
$v®ue
)) {

698 
$v®ue
 = 
¬¿y_pİ
($value);

701  
	g$v®ue
;

711 ià(!
funùiÚ_exi¡s
('acosh')) {

712 
funùiÚ
 
acosh
(
$x
)

714  2 * 
log
(
sq¹
((
$x
 + 1) / 2) + sqrt(($x - 1) / 2));

718 ià(!
funùiÚ_exi¡s
('asinh')) {

719 
funùiÚ
 
asšh
(
$x
)

721  
log
(
$x
 + 
sq¹
(1 + $x * $x));

725 ià(!
funùiÚ_exi¡s
('atanh')) {

726 
funùiÚ
 
©ªh
(
$x
)

728  (
log
(1 + 
$x
) -†og(1 - $x)) / 2;

737 ià((!
funùiÚ_exi¡s
('mb_str_replace')) &&

738 (
funùiÚ_exi¡s
('mb_substr')) && (function_exists('mb_strlen')) && (function_exists('mb_strpos'))) {

739 
funùiÚ
 
mb_¡r_»¶aû
(
$£¬ch
, 
$»¶aû
, 
$subjeù
)

741 ià(
is_¬¿y
(
$subjeù
)) {

742 
	g$»t
 = 
¬¿y
();

743 
fÜ—ch
 (
$subjeù
 
as
 
$key
 => 
$v®
) {

744 
$»t
[
$key
] = 
mb_¡r_»¶aû
(
$£¬ch
, 
$»¶aû
, 
$v®
);

746  
	g$»t
;

749 
fÜ—ch
 ((
¬¿y
è
$£¬ch
 
as
 
$key
 => 
$s
) {

750 ià(
$s
 == '' && $s !== 0) {

753 
	g$r
 = !
is_¬¿y
(
$»¶aû
è? $»¶aû : (
¬¿y_key_exi¡s
(
$key
, $»¶aûè? 
	g$»¶aû
[$key] : '');

754 
	g$pos
 = 
mb_¡½os
(
$subjeù
, 
$s
, 0, 'UTF-8');

755 
	g$pos
 !=ğ
çl£
) {

756 
$subjeù
 = 
mb_sub¡r
($subjeù, 0, 
$pos
, 'UTF-8'è. 
	g$r
 . mb_sub¡r($subjeù, $po + 
mb_¡¾’
(
$s
, 'UTF-8'), 65535, 'UTF-8');

757 
	g$pos
 = 
mb_¡½os
(
$subjeù
, 
$s
, 
$pos
 + 
mb_¡¾’
(
$r
, 'UTF-8'), 'UTF-8');

760  
	g$subjeù
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Logical.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_C®cuÏtiÚ_Logiÿl


51 
public
 
funùiÚ
 
	$TRUE
()

53  
Œue
;

69 
public
 
funùiÚ
 
	$FALSE
()

71  
çl£
;

72 
	}
}

96 
public
 
funùiÚ
 
	$LOGICAL_AND
()

99 
$»tuºV®ue
 = 
Œue
;

102 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

103 
$¬gCouÁ
 = -1;

104 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬gCouÁ
 => 
$¬g
) {

106 ià(
	`is_boŞ
(
$¬g
)) {

107 
$»tuºV®ue
 = $»tuºV®u&& 
$¬g
;

108 } 
	`–£if
 ((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

109 
$»tuºV®ue
 = $»tuºV®u&& (
$¬g
 != 0);

110 } 
	`–£if
 (
	`is_¡ršg
(
$¬g
)) {

111 
$¬g
 = 
	`¡¹ouµ”
($arg);

112 ià((
$¬g
 =ğ'TRUE'è|| ($¬g =ğ
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
())) {

113 
$¬g
 = 
Œue
;

114 } 
	`–£if
 ((
$¬g
 =ğ'FALSE'è|| ($¬g =ğ
PHPExûl_C®cuÏtiÚ
::
	`g‘FALSE
())) {

115 
$¬g
 = 
çl£
;

117  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

119 
$»tuºV®ue
 = $»tuºV®u&& (
$¬g
 != 0);

124 ià(
$¬gCouÁ
 < 0) {

125  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

127  
$»tuºV®ue
;

128 
	}
}

152 
public
 
funùiÚ
 
	$LOGICAL_OR
()

155 
$»tuºV®ue
 = 
çl£
;

158 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

159 
$¬gCouÁ
 = -1;

160 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬gCouÁ
 => 
$¬g
) {

162 ià(
	`is_boŞ
(
$¬g
)) {

163 
$»tuºV®ue
 = $»tuºV®u|| 
$¬g
;

164 } 
	`–£if
 ((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

165 
$»tuºV®ue
 = $»tuºV®u|| (
$¬g
 != 0);

166 } 
	`–£if
 (
	`is_¡ršg
(
$¬g
)) {

167 
$¬g
 = 
	`¡¹ouµ”
($arg);

168 ià((
$¬g
 =ğ'TRUE'è|| ($¬g =ğ
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
())) {

169 
$¬g
 = 
Œue
;

170 } 
	`–£if
 ((
$¬g
 =ğ'FALSE'è|| ($¬g =ğ
PHPExûl_C®cuÏtiÚ
::
	`g‘FALSE
())) {

171 
$¬g
 = 
çl£
;

173  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

175 
$»tuºV®ue
 = $»tuºV®u|| (
$¬g
 != 0);

180 ià(
$¬gCouÁ
 < 0) {

181  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

183  
$»tuºV®ue
;

184 
	}
}

207 
public
 
funùiÚ
 
	$NOT
(
$logiÿl
 = 
çl£
)

209 
$logiÿl
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($logical);

210 ià(
	`is_¡ršg
(
$logiÿl
)) {

211 
$logiÿl
 = 
	`¡¹ouµ”
($logical);

212 ià((
$logiÿl
 =ğ'TRUE'è|| ($logiÿÈ=ğ
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
())) {

213  
çl£
;

214 } 
	`–£if
 ((
$logiÿl
 =ğ'FALSE'è|| ($logiÿÈ=ğ
PHPExûl_C®cuÏtiÚ
::
	`g‘FALSE
())) {

215  
Œue
;

217  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

221  !
$logiÿl
;

222 
	}
}

256 
public
 
funùiÚ
 
	$STATEMENT_IF
(
$cÚd™iÚ
 = 
Œue
, 
$»tuºIfTrue
 = 0, 
$»tuºIfF®£
 = 
çl£
)

258 
$cÚd™iÚ
 = (
	`is_nuÎ
($cÚd™iÚ)è? 
Œue
 : (
boŞ—n
è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($condition);

259 
$»tuºIfTrue
 = (
	`is_nuÎ
($»tuºIfTrue)è? 0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($returnIfTrue);

260 
$»tuºIfF®£
 = (
	`is_nuÎ
($»tuºIfF®£)è? 
çl£
 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($returnIfFalse);

262  (
$cÚd™iÚ
è? 
$»tuºIfTrue
 : 
$»tuºIfF®£
;

263 
	}
}

278 
public
 
funùiÚ
 
IFERROR
(
$‹¡V®ue
 = '', 
$”rÜ·¹
 = '')

280 
$‹¡V®ue
 = (
is_nuÎ
($‹¡V®ue)è? '' : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($testValue);

281 
	g$”rÜ·¹
 = (
is_nuÎ
(
$”rÜ·¹
)è? '' : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($errorpart);

283  
	g£lf
::
STATEMENT_IF
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
IS_ERROR
(
$‹¡V®ue
), 
$”rÜ·¹
, $testValue);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/LookupRef.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_C®cuÏtiÚ_LookupRef


60 
public
 
funùiÚ
 
CELL_ADDRESS
(
$row
, 
$cŞumn
, 
$»Ïtiv™y
 = 1, 
$»ã»nûStyË
 = 
Œue
, 
$sh“tText
 = '')

62 
$row
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($row);

63 
	m$cŞumn
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$cŞumn
);

64 
	m$»Ïtiv™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$»Ïtiv™y
);

65 
	m$sh“tText
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$sh“tText
);

67 ià((
	m$row
 < 1è|| (
	m$cŞumn
 < 1)) {

68  
	mPHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
();

71 ià(
	m$sh“tText
 > '') {

72 ià(
¡½os
(
$sh“tText
, ' 'è!=ğ
çl£
) {

73 
$sh“tText
 = "'".$sheetText."'";

75 
	m$sh“tText
 .='!';

77 ià((!
is_boŞ
(
$»ã»nûStyË
)è|| 
	m$»ã»nûStyË
) {

78 
	m$rowR–©ive
 = 
$cŞumnR–©ive
 = '$';

79 
	m$cŞumn
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$cŞumn
-1);

80 ià((
	m$»Ïtiv™y
 =ğ2è|| (
$»Ïtiv™y
 == 4)) {

81 
$cŞumnR–©ive
 = '';

83 ià((
	m$»Ïtiv™y
 =ğ3è|| (
$»Ïtiv™y
 == 4)) {

84 
$rowR–©ive
 = '';

86  
	m$sh“tText
.
	m$cŞumnR–©ive
.
	m$cŞumn
.
	m$rowR–©ive
.
	m$row
;

88 ià((
	m$»Ïtiv™y
 =ğ2è|| (
$»Ïtiv™y
 == 4)) {

89 
$cŞumn
 = '['.$column.']';

91 ià((
	m$»Ïtiv™y
 =ğ3è|| (
$»Ïtiv™y
 == 4)) {

92 
$row
 = '['.$row.']';

94  
	m$sh“tText
.'R'.
	m$row
.'C'.
	m$cŞumn
;

113 
public
 
funùiÚ
 
	$COLUMN
(
$ûÎAdd»ss
 = 
nuÎ
)

115 ià(
	`is_nuÎ
(
$ûÎAdd»ss
è|| 
	`Œim
($cellAddress) === '') {

119 ià(
	`is_¬¿y
(
$ûÎAdd»ss
)) {

120 
	`fÜ—ch
 (
$ûÎAdd»ss
 
as
 
$cŞumnKey
 => 
$v®ue
) {

121 
$cŞumnKey
 = 
	`´eg_»¶aû
('/[^a-z]/i', '', $columnKey);

122  (
š‹g”
è
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞumnKey
);

125 ià(
	`¡½os
(
$ûÎAdd»ss
, '!'è!=ğ
çl£
) {

126 
	`li¡
(
$sh“t
, 
$ûÎAdd»ss
èğ
	`ex¶ode
('!', $cellAddress);

128 ià(
	`¡½os
(
$ûÎAdd»ss
, ':'è!=ğ
çl£
) {

129 
	`li¡
(
$¡¬tAdd»ss
, 
$’dAdd»ss
èğ
	`ex¶ode
(':', 
$ûÎAdd»ss
);

130 
$¡¬tAdd»ss
 = 
	`´eg_»¶aû
('/[^a-z]/i', '', $startAddress);

131 
$’dAdd»ss
 = 
	`´eg_»¶aû
('/[^a-z]/i', '', $endAddress);

132 
$»tuºV®ue
 = 
	`¬¿y
();

134 
$»tuºV®ue
[] = (
š‹g”
è
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$¡¬tAdd»ss
);

135 } 
$¡¬tAdd»ss
++ !ğ
$’dAdd»ss
);

136  
$»tuºV®ue
;

138 
$ûÎAdd»ss
 = 
	`´eg_»¶aû
('/[^a-z]/i', '', $cellAddress);

139  (
š‹g”
è
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$ûÎAdd»ss
);

142 
	}
}

156 
public
 
funùiÚ
 
	$COLUMNS
(
$ûÎAdd»ss
 = 
nuÎ
)

158 ià(
	`is_nuÎ
(
$ûÎAdd»ss
) || $cellAddress === '') {

160 } 
	`–£if
 (!
	`is_¬¿y
(
$ûÎAdd»ss
)) {

161  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

164 
	`»£t
(
$ûÎAdd»ss
);

165 
$isM©rix
 = (
	`is_num”ic
(
	`key
(
$ûÎAdd»ss
)));

166 
	`li¡
(
$cŞumns
, 
$rows
èğ
PHPExûl_C®cuÏtiÚ
::
	`_g‘M©rixDim’siÚs
(
$ûÎAdd»ss
);

168 ià(
$isM©rix
) {

169  
$rows
;

171  
$cŞumns
;

173 
	}
}

190 
public
 
funùiÚ
 
	$ROW
(
$ûÎAdd»ss
 = 
nuÎ
)

192 ià(
	`is_nuÎ
(
$ûÎAdd»ss
è|| 
	`Œim
($cellAddress) === '') {

196 ià(
	`is_¬¿y
(
$ûÎAdd»ss
)) {

197 
	`fÜ—ch
 (
$ûÎAdd»ss
 
as
 
$cŞumnKey
 => 
$rowV®ue
) {

198 
	`fÜ—ch
 (
$rowV®ue
 
as
 
$rowKey
 => 
$ûÎV®ue
) {

199  (
š‹g”
è
	`´eg_»¶aû
('/[^0-9]/i', '', 
$rowKey
);

203 ià(
	`¡½os
(
$ûÎAdd»ss
, '!'è!=ğ
çl£
) {

204 
	`li¡
(
$sh“t
, 
$ûÎAdd»ss
èğ
	`ex¶ode
('!', $cellAddress);

206 ià(
	`¡½os
(
$ûÎAdd»ss
, ':'è!=ğ
çl£
) {

207 
	`li¡
(
$¡¬tAdd»ss
, 
$’dAdd»ss
èğ
	`ex¶ode
(':', 
$ûÎAdd»ss
);

208 
$¡¬tAdd»ss
 = 
	`´eg_»¶aû
('/[^0-9]/', '', $startAddress);

209 
$’dAdd»ss
 = 
	`´eg_»¶aû
('/[^0-9]/', '', $endAddress);

210 
$»tuºV®ue
 = 
	`¬¿y
();

212 
$»tuºV®ue
[][] = (
š‹g”
è
$¡¬tAdd»ss
;

213 } 
$¡¬tAdd»ss
++ !ğ
$’dAdd»ss
);

214  
$»tuºV®ue
;

216 
	`li¡
(
$ûÎAdd»ss
èğ
	`ex¶ode
(':', $cellAddress);

217  (
š‹g”
è
	`´eg_»¶aû
('/[^0-9]/', '', 
$ûÎAdd»ss
);

220 
	}
}

234 
public
 
funùiÚ
 
	$ROWS
(
$ûÎAdd»ss
 = 
nuÎ
)

236 ià(
	`is_nuÎ
(
$ûÎAdd»ss
) || $cellAddress === '') {

238 } 
	`–£if
 (!
	`is_¬¿y
(
$ûÎAdd»ss
)) {

239  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

242 
	`»£t
(
$ûÎAdd»ss
);

243 
$isM©rix
 = (
	`is_num”ic
(
	`key
(
$ûÎAdd»ss
)));

244 
	`li¡
(
$cŞumns
, 
$rows
èğ
PHPExûl_C®cuÏtiÚ
::
	`_g‘M©rixDim’siÚs
(
$ûÎAdd»ss
);

246 ià(
$isM©rix
) {

247  
$cŞumns
;

249  
$rows
;

251 
	}
}

267 
public
 
funùiÚ
 
HYPERLINK
(
$lškURL
 = '', 
$di¥ÏyName
 = 
nuÎ
, 
PHPExûl_C–l
 
$pC–l
 =‚ull)

269 
$¬gs
 = 
func_g‘_¬gs
();

270 
	g$pC–l
 = 
¬¿y_pİ
(
$¬gs
);

272 
	g$lškURL
 = (
is_nuÎ
(
$lškURL
)è? '' : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($linkURL);

273 
	g$di¥ÏyName
 = (
is_nuÎ
(
$di¥ÏyName
)è? '' : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($displayName);

275 ià((!
is_objeù
(
$pC–l
)è|| (
Œim
(
$lškURL
) == '')) {

276  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
REF
();

279 ià((
is_objeù
(
$di¥ÏyName
)è|| 
Œim
($displayName) == '') {

280 
$di¥ÏyName
 = 
$lškURL
;

283 
	g$pC–l
->
g‘Hy³¾šk
()->
£tU¾
(
$lškURL
);

285  
	g$di¥ÏyName
;

307 
public
 
funùiÚ
 
	$INDIRECT
(
$ûÎAdd»ss
 = 
nuÎ
, 
PHPExûl_C–l
 
$pC–l
 =‚ull)

309 
$ûÎAdd»ss
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($cellAddress);

310 ià(
	`is_nuÎ
(
$ûÎAdd»ss
) || $cellAddress === '') {

311  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

314 
$ûÎAdd»ss1
 = 
$ûÎAdd»ss
;

315 
$ûÎAdd»ss2
 = 
nuÎ
;

316 ià(
	`¡½os
(
$ûÎAdd»ss
, ':'è!=ğ
çl£
) {

317 
	`li¡
(
$ûÎAdd»ss1
, 
$ûÎAdd»ss2
èğ
	`ex¶ode
(':', 
$ûÎAdd»ss
);

320 ià((!
	`´eg_m©ch
('/^'.
PHPExûl_C®cuÏtiÚ
::
CALCULATION_REGEXP_CELLREF
.'$/i', 
$ûÎAdd»ss1
, 
$m©ches
)) ||

321 ((!
	`is_nuÎ
(
$ûÎAdd»ss2
)è&& (!
	`´eg_m©ch
('/^'.
PHPExûl_C®cuÏtiÚ
::
CALCULATION_REGEXP_CELLREF
.'$/i', $ûÎAdd»ss2, 
$m©ches
)))) {

322 ià(!
	`´eg_m©ch
('/^'.
PHPExûl_C®cuÏtiÚ
::
CALCULATION_REGEXP_NAMEDRANGE
.'$/i', 
$ûÎAdd»ss1
, 
$m©ches
)) {

323  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

326 ià(
	`¡½os
(
$ûÎAdd»ss
, '!'è!=ğ
çl£
) {

327 
	`li¡
(
$sh“tName
, 
$ûÎAdd»ss
èğ
	`ex¶ode
('!', $cellAddress);

328 
$sh“tName
 = 
	`Œim
($sheetName, "'");

329 
$pSh“t
 = 
$pC–l
->
	`g‘WÜksh“t
()->
	`g‘P¬’t
()->
	`g‘Sh“tByName
(
$sh“tName
);

331 
$pSh“t
 = 
$pC–l
->
	`g‘WÜksh“t
();

334  
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`exŒaùNamedRªge
(
$ûÎAdd»ss
, 
$pSh“t
, 
çl£
);

337 ià(
	`¡½os
(
$ûÎAdd»ss
, '!'è!=ğ
çl£
) {

338 
	`li¡
(
$sh“tName
, 
$ûÎAdd»ss
èğ
	`ex¶ode
('!', $cellAddress);

339 
$sh“tName
 = 
	`Œim
($sheetName, "'");

340 
$pSh“t
 = 
$pC–l
->
	`g‘WÜksh“t
()->
	`g‘P¬’t
()->
	`g‘Sh“tByName
(
$sh“tName
);

342 
$pSh“t
 = 
$pC–l
->
	`g‘WÜksh“t
();

345  
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`exŒaùC–lRªge
(
$ûÎAdd»ss
, 
$pSh“t
, 
çl£
);

346 
	}
}

374 
public
 
funùiÚ
 
	$OFFSET
(
$ûÎAdd»ss
 = 
nuÎ
, 
$rows
 = 0, 
$cŞumns
 = 0, 
$height
 =‚uÎ, 
$width
 =‚ull)

376 
$rows
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rows);

377 
$cŞumns
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($columns);

378 
$height
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($height);

379 
$width
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($width);

380 ià(
$ûÎAdd»ss
 =ğ
nuÎ
) {

384 
$¬gs
 = 
	`func_g‘_¬gs
();

385 
$pC–l
 = 
	`¬¿y_pİ
(
$¬gs
);

386 ià(!
	`is_objeù
(
$pC–l
)) {

387  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

390 
$sh“tName
 = 
nuÎ
;

391 ià(
	`¡½os
(
$ûÎAdd»ss
, "!")) {

392 
	`li¡
(
$sh“tName
, 
$ûÎAdd»ss
èğ
	`ex¶ode
("!", $cellAddress);

393 
$sh“tName
 = 
	`Œim
($sheetName, "'");

395 ià(
	`¡½os
(
$ûÎAdd»ss
, ":")) {

396 
	`li¡
(
$¡¬tC–l
, 
$’dC–l
èğ
	`ex¶ode
(":", 
$ûÎAdd»ss
);

398 
$¡¬tC–l
 = 
$’dC–l
 = 
$ûÎAdd»ss
;

400 
	`li¡
(
$¡¬tC–lCŞumn
, 
$¡¬tC–lRow
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$¡¬tC–l
);

401 
	`li¡
(
$’dC–lCŞumn
, 
$’dC–lRow
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$’dC–l
);

403 
$¡¬tC–lRow
 +ğ
$rows
;

404 
$¡¬tC–lCŞumn
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($startCellColumn) - 1;

405 
$¡¬tC–lCŞumn
 +ğ
$cŞumns
;

407 ià((
$¡¬tC–lRow
 <ğ0è|| (
$¡¬tC–lCŞumn
 < 0)) {

408  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

410 
$’dC–lCŞumn
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($endCellColumn) - 1;

411 ià((
$width
 !ğ
nuÎ
è&& (!
	`is_objeù
($width))) {

412 
$’dC–lCŞumn
 = 
$¡¬tC–lCŞumn
 + 
$width
 - 1;

414 
$’dC–lCŞumn
 +ğ
$cŞumns
;

416 
$¡¬tC–lCŞumn
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($startCellColumn);

418 ià((
$height
 !ğ
nuÎ
è&& (!
	`is_objeù
($height))) {

419 
$’dC–lRow
 = 
$¡¬tC–lRow
 + 
$height
 - 1;

421 
$’dC–lRow
 +ğ
$rows
;

424 ià((
$’dC–lRow
 <ğ0è|| (
$’dC–lCŞumn
 < 0)) {

425  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

427 
$’dC–lCŞumn
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($endCellColumn);

429 
$ûÎAdd»ss
 = 
$¡¬tC–lCŞumn
.
$¡¬tC–lRow
;

430 ià((
$¡¬tC–lCŞumn
 !ğ
$’dC–lCŞumn
è|| (
$¡¬tC–lRow
 !ğ
$’dC–lRow
)) {

431 
$ûÎAdd»ss
 .ğ':'.
$’dC–lCŞumn
.
$’dC–lRow
;

434 ià(
$sh“tName
 !=ğ
nuÎ
) {

435 
$pSh“t
 = 
$pC–l
->
	`g‘WÜksh“t
()->
	`g‘P¬’t
()->
	`g‘Sh“tByName
(
$sh“tName
);

437 
$pSh“t
 = 
$pC–l
->
	`g‘WÜksh“t
();

440  
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`exŒaùC–lRªge
(
$ûÎAdd»ss
, 
$pSh“t
, 
çl£
);

441 
	}
}

462 
public
 
funùiÚ
 
	$CHOOSE
()

464 
$choo£Args
 = 
	`func_g‘_¬gs
();

465 
$cho£nEÁry
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`¬¿y_shiá
(
$choo£Args
));

466 
$’ŒyCouÁ
 = 
	`couÁ
(
$choo£Args
) - 1;

468 ià(
	`is_¬¿y
(
$cho£nEÁry
)) {

469 
$cho£nEÁry
 = 
	`¬¿y_shiá
($chosenEntry);

471 ià((
	`is_num”ic
(
$cho£nEÁry
)è&& (!
	`is_boŞ
($chosenEntry))) {

472 --
$cho£nEÁry
;

474  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

476 
$cho£nEÁry
 = 
	`æoÜ
($chosenEntry);

477 ià((
$cho£nEÁry
 < 0è|| ($cho£nEÁry > 
$’ŒyCouÁ
)) {

478  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

481 ià(
	`is_¬¿y
(
$choo£Args
[
$cho£nEÁry
])) {

482  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$choo£Args
[
$cho£nEÁry
]);

484  
$choo£Args
[
$cho£nEÁry
];

486 
	}
}

502 
public
 
funùiÚ
 
	$MATCH
(
$lookup_v®ue
, 
$lookup_¬¿y
, 
$m©ch_ty³
 = 1)

504 
$lookup_¬¿y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($lookup_array);

505 
$lookup_v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($lookup_value);

506 
$m©ch_ty³
 = (
	`is_nuÎ
($m©ch_ty³)è? 1 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($match_type);

508 
$lookup_v®ue
 = 
	`¡¹Şow”
($lookup_value);

511 ià((!
	`is_num”ic
(
$lookup_v®ue
)è&& (!
	`is_¡ršg
($lookup_v®ue)è&& (!
	`is_boŞ
($lookup_value))) {

512  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

516 ià((
$m©ch_ty³
 !== 0) && ($match_type !== -1) && ($match_type !== 1)) {

517  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

521 
$lookupA¼aySize
 = 
	`couÁ
(
$lookup_¬¿y
);

522 ià(
$lookupA¼aySize
 <= 0) {

523  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

527 
	`fÜ—ch
 (
$lookup_¬¿y
 
as
 
$i
 => 
$lookupA¼ayV®ue
) {

529 ià((!
	`is_num”ic
(
$lookupA¼ayV®ue
)è&& (!
	`is_¡ršg
($lookupArrayValue)) &&

530 (!
	`is_boŞ
(
$lookupA¼ayV®ue
)è&& (!
	`is_nuÎ
($lookupArrayValue))) {

531  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

534 ià(
	`is_¡ršg
(
$lookupA¼ayV®ue
)) {

535 
$lookup_¬¿y
[
$i
] = 
	`¡¹Şow”
(
$lookupA¼ayV®ue
);

537 ià((
	`is_nuÎ
(
$lookupA¼ayV®ue
)è&& ((
$m©ch_ty³
 == 1) || ($match_type == -1))) {

538 
$lookup_¬¿y
 = 
	`¬¿y_¦iû
($lookup_¬¿y, 0, 
$i
-1);

543 ià(
$m©ch_ty³
 == 1) {

544 
	`asÜt
(
$lookup_¬¿y
);

545 
$keyS‘
 = 
	`¬¿y_keys
(
$lookup_¬¿y
);

546 } 
	`–£if
 (
$m©ch_ty³
 == -1) {

547 
	`¬sÜt
(
$lookup_¬¿y
);

548 
$keyS‘
 = 
	`¬¿y_keys
(
$lookup_¬¿y
);

554 
	`fÜ—ch
 (
$lookup_¬¿y
 
as
 
$i
 => 
$lookupA¼ayV®ue
) {

555 ià((
$m©ch_ty³
 =ğ0è&& (
$lookupA¼ayV®ue
 =ğ
$lookup_v®ue
)) {

557  ++
$i
;

558 } 
	`–£if
 ((
$m©ch_ty³
 =ğ-1è&& (
$lookupA¼ayV®ue
 <ğ
$lookup_v®ue
)) {

559 
$i
 = 
	`¬¿y_£¬ch
($i, 
$keyS‘
);

561 ià(
$i
 < 1) {

566  
$keyS‘
[
$i
-1]+1;

568 } 
	`–£if
 ((
$m©ch_ty³
 =ğ1è&& (
$lookupA¼ayV®ue
 >ğ
$lookup_v®ue
)) {

569 
$i
 = 
	`¬¿y_£¬ch
($i, 
$keyS‘
);

571 ià(
$i
 < 1) {

576  
$keyS‘
[
$i
-1]+1;

582  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

583 
	}
}

599 
public
 
funùiÚ
 
	$INDEX
(
$¬¿yV®ues
, 
$rowNum
 = 0, 
$cŞumnNum
 = 0)

601 ià((
$rowNum
 < 0è|| (
$cŞumnNum
 < 0)) {

602  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

605 ià(!
	`is_¬¿y
(
$¬¿yV®ues
)) {

606  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

609 
$rowKeys
 = 
	`¬¿y_keys
(
$¬¿yV®ues
);

610 
$cŞumnKeys
 = @
	`¬¿y_keys
(
$¬¿yV®ues
[
$rowKeys
[0]]);

612 ià(
$cŞumnNum
 > 
	`couÁ
(
$cŞumnKeys
)) {

613  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

614 } 
	`–£if
 (
$cŞumnNum
 == 0) {

615 ià(
$rowNum
 == 0) {

616  
$¬¿yV®ues
;

618 
$rowNum
 = 
$rowKeys
[--$rowNum];

619 
$»tuºA¼ay
 = 
	`¬¿y
();

620 
	`fÜ—ch
 (
$¬¿yV®ues
 
as
 
$¬¿yCŞumn
) {

621 ià(
	`is_¬¿y
(
$¬¿yCŞumn
)) {

622 ià(
	`is£t
(
$¬¿yCŞumn
[
$rowNum
])) {

623 
$»tuºA¼ay
[] = 
$¬¿yCŞumn
[
$rowNum
];

625  
$¬¿yV®ues
[
$rowNum
];

628  
$¬¿yV®ues
[
$rowNum
];

631  
$»tuºA¼ay
;

633 
$cŞumnNum
 = 
$cŞumnKeys
[--$columnNum];

634 ià(
$rowNum
 > 
	`couÁ
(
$rowKeys
)) {

635  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

636 } 
	`–£if
 (
$rowNum
 == 0) {

637  
$¬¿yV®ues
[
$cŞumnNum
];

639 
$rowNum
 = 
$rowKeys
[--$rowNum];

641  
$¬¿yV®ues
[
$rowNum
][
$cŞumnNum
];

642 
	}
}

653 
public
 
funùiÚ
 
	$TRANSPOSE
(
$m©rixD©a
)

655 
$»tuºM©rix
 = 
	`¬¿y
();

656 ià(!
	`is_¬¿y
(
$m©rixD©a
)) {

657 
$m©rixD©a
 = 
	`¬¿y
(array($matrixData));

660 
$cŞumn
 = 0;

661 
	`fÜ—ch
 (
$m©rixD©a
 
as
 
$m©rixRow
) {

662 
$row
 = 0;

663 
	`fÜ—ch
 (
$m©rixRow
 
as
 
$m©rixC–l
) {

664 
$»tuºM©rix
[
$row
][
$cŞumn
] = 
$m©rixC–l
;

665 ++
$row
;

667 ++
$cŞumn
;

669  
$»tuºM©rix
;

670 
	}
}

673 
´iv©e
 
funùiÚ
 
	$vlookupSÜt
(
$a
, 
$b
)

675 
	`»£t
(
$a
);

676 
$fœ¡CŞumn
 = 
	`key
(
$a
);

677 ià((
$aLow”
 = 
	`¡¹Şow”
(
$a
[
$fœ¡CŞumn
])è=ğ(
$bLow”
 = sŒtŞow”(
$b
[$firstColumn]))) {

680  (
$aLow”
 < 
$bLow”
) ? -1 : 1;

681 
	}
}

693 
public
 
funùiÚ
 
	$VLOOKUP
(
$lookup_v®ue
, 
$lookup_¬¿y
, 
$šdex_numb”
, 
$nÙ_exaù_m©ch
 = 
Œue
)

695 
$lookup_v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($lookup_value);

696 
$šdex_numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($index_number);

697 
$nÙ_exaù_m©ch
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($not_exact_match);

700 ià(
$šdex_numb”
 < 1) {

701  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

705 ià((!
	`is_¬¿y
(
$lookup_¬¿y
)è|| (
	`em±y
($lookup_array))) {

706  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

708 
$f
 = 
	`¬¿y_keys
(
$lookup_¬¿y
);

709 
$fœ¡Row
 = 
	`¬¿y_pİ
(
$f
);

710 ià((!
	`is_¬¿y
(
$lookup_¬¿y
[
$fœ¡Row
])è|| (
$šdex_numb”
 > 
	`couÁ
($lookup_array[$firstRow]))) {

711  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

713 
$cŞumnKeys
 = 
	`¬¿y_keys
(
$lookup_¬¿y
[
$fœ¡Row
]);

714 
$»tuºCŞumn
 = 
$cŞumnKeys
[--
$šdex_numb”
];

715 
$fœ¡CŞumn
 = 
	`¬¿y_shiá
(
$cŞumnKeys
);

719 ià(!
$nÙ_exaù_m©ch
) {

720 
	`uasÜt
(
$lookup_¬¿y
, 
	`¬¿y
('self', 'vlookupSort'));

723 
$rowNumb”
 = 
$rowV®ue
 = 
çl£
;

724 
	`fÜ—ch
 (
$lookup_¬¿y
 
as
 
$rowKey
 => 
$rowD©a
) {

725 ià((
	`is_num”ic
(
$lookup_v®ue
è&& is_num”ic(
$rowD©a
[
$fœ¡CŞumn
]) && ($rowData[$firstColumn] > $lookup_value)) ||

726 (!
	`is_num”ic
(
$lookup_v®ue
è&& !is_num”ic(
$rowD©a
[
$fœ¡CŞumn
]è&& (
	`¡¹Şow”
($rowData[$firstColumn]) > strtolower($lookup_value)))) {

729 
$rowNumb”
 = 
$rowKey
;

730 
$rowV®ue
 = 
$rowD©a
[
$fœ¡CŞumn
];

733 ià(
$rowNumb”
 !=ğ
çl£
) {

734 ià((!
$nÙ_exaù_m©ch
è&& (
$rowV®ue
 !ğ
$lookup_v®ue
)) {

736  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

739  
$lookup_¬¿y
[
$rowNumb”
][
$»tuºCŞumn
];

743  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

744 
	}
}

756 
public
 
funùiÚ
 
	$HLOOKUP
(
$lookup_v®ue
, 
$lookup_¬¿y
, 
$šdex_numb”
, 
$nÙ_exaù_m©ch
 = 
Œue
)

758 
$lookup_v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($lookup_value);

759 
$šdex_numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($index_number);

760 
$nÙ_exaù_m©ch
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($not_exact_match);

763 ià(
$šdex_numb”
 < 1) {

764  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

768 ià((!
	`is_¬¿y
(
$lookup_¬¿y
)è|| (
	`em±y
($lookup_array))) {

769  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

771 
$f
 = 
	`¬¿y_keys
(
$lookup_¬¿y
);

772 
$fœ¡Row
 = 
	`¬¿y_pİ
(
$f
);

773 ià((!
	`is_¬¿y
(
$lookup_¬¿y
[
$fœ¡Row
])è|| (
$šdex_numb”
 > 
	`couÁ
($lookup_array[$firstRow]))) {

774  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`REF
();

776 
$cŞumnKeys
 = 
	`¬¿y_keys
(
$lookup_¬¿y
[
$fœ¡Row
]);

777 
$fœ¡key
 = 
$f
[0] - 1;

778 
$»tuºCŞumn
 = 
$fœ¡key
 + 
$šdex_numb”
;

779 
$fœ¡CŞumn
 = 
	`¬¿y_shiá
(
$f
);

783 ià(!
$nÙ_exaù_m©ch
) {

784 
$fœ¡RowH
 = 
	`asÜt
(
$lookup_¬¿y
[
$fœ¡CŞumn
]);

787 
$rowNumb”
 = 
$rowV®ue
 = 
çl£
;

788 
	`fÜ—ch
 (
$lookup_¬¿y
[
$fœ¡CŞumn
] 
as
 
$rowKey
 => 
$rowD©a
) {

789 ià((
	`is_num”ic
(
$lookup_v®ue
è&& is_num”ic(
$rowD©a
) && ($rowData > $lookup_value)) ||

790 (!
	`is_num”ic
(
$lookup_v®ue
è&& !is_num”ic(
$rowD©a
è&& (
	`¡¹Şow”
($rowData) > strtolower($lookup_value)))) {

793 
$rowNumb”
 = 
$rowKey
;

794 
$rowV®ue
 = 
$rowD©a
;

797 ià(
$rowNumb”
 !=ğ
çl£
) {

798 ià((!
$nÙ_exaù_m©ch
è&& (
$rowV®ue
 !ğ
$lookup_v®ue
)) {

800  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

803  
$lookup_¬¿y
[
$»tuºCŞumn
][
$rowNumb”
];

807  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

808 
	}
}

819 
public
 
funùiÚ
 
	$LOOKUP
(
$lookup_v®ue
, 
$lookup_veùÜ
, 
$»suÉ_veùÜ
 = 
nuÎ
)

821 
$lookup_v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($lookup_value);

823 ià(!
	`is_¬¿y
(
$lookup_veùÜ
)) {

824  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

826 
$lookupRows
 = 
	`couÁ
(
$lookup_veùÜ
);

827 
$l
 = 
	`¬¿y_keys
(
$lookup_veùÜ
);

828 
$l
 = 
	`¬¿y_shiá
($l);

829 
$lookupCŞumns
 = 
	`couÁ
(
$lookup_veùÜ
[
$l
]);

830 ià(((
$lookupRows
 =ğ1è&& (
$lookupCŞumns
 > 1)) || (($lookupRows == 2) && ($lookupColumns != 2))) {

831 
$lookup_veùÜ
 = 
£lf
::
	`TRANSPOSE
($lookup_vector);

832 
$lookupRows
 = 
	`couÁ
(
$lookup_veùÜ
);

833 
$l
 = 
	`¬¿y_keys
(
$lookup_veùÜ
);

834 
$lookupCŞumns
 = 
	`couÁ
(
$lookup_veùÜ
[
	`¬¿y_shiá
(
$l
)]);

837 ià(
	`is_nuÎ
(
$»suÉ_veùÜ
)) {

838 
$»suÉ_veùÜ
 = 
$lookup_veùÜ
;

840 
$»suÉRows
 = 
	`couÁ
(
$»suÉ_veùÜ
);

841 
$l
 = 
	`¬¿y_keys
(
$»suÉ_veùÜ
);

842 
$l
 = 
	`¬¿y_shiá
($l);

843 
$»suÉCŞumns
 = 
	`couÁ
(
$»suÉ_veùÜ
[
$l
]);

844 ià(((
$»suÉRows
 =ğ1è&& (
$»suÉCŞumns
 > 1)) || (($resultRows == 2) && ($resultColumns != 2))) {

845 
$»suÉ_veùÜ
 = 
£lf
::
	`TRANSPOSE
($result_vector);

846 
$»suÉRows
 = 
	`couÁ
(
$»suÉ_veùÜ
);

847 
$r
 = 
	`¬¿y_keys
(
$»suÉ_veùÜ
);

848 
$»suÉCŞumns
 = 
	`couÁ
(
$»suÉ_veùÜ
[
	`¬¿y_shiá
(
$r
)]);

851 ià(
$lookupRows
 == 2) {

852 
$»suÉ_veùÜ
 = 
	`¬¿y_pİ
(
$lookup_veùÜ
);

853 
$lookup_veùÜ
 = 
	`¬¿y_shiá
($lookup_vector);

855 ià(
$lookupCŞumns
 != 2) {

856 
	`fÜ—ch
 (
$lookup_veùÜ
 
as
 &
$v®ue
) {

857 ià(
	`is_¬¿y
(
$v®ue
)) {

858 
$k
 = 
	`¬¿y_keys
(
$v®ue
);

859 
$key1
 = 
$key2
 = 
	`¬¿y_shiá
(
$k
);

860 
$key2
++;

861 
$d©aV®ue1
 = 
$v®ue
[
$key1
];

863 
$key1
 = 0;

864 
$key2
 = 1;

865 
$d©aV®ue1
 = 
$v®ue
;

867 
$d©aV®ue2
 = 
	`¬¿y_shiá
(
$»suÉ_veùÜ
);

868 ià(
	`is_¬¿y
(
$d©aV®ue2
)) {

869 
$d©aV®ue2
 = 
	`¬¿y_shiá
($dataValue2);

871 
$v®ue
 = 
	`¬¿y
(
$key1
 => 
$d©aV®ue1
, 
$key2
 => 
$d©aV®ue2
);

873 
	`un£t
(
$v®ue
);

876  
£lf
::
	`VLOOKUP
(
$lookup_v®ue
, 
$lookup_veùÜ
, 2);

877 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/MathTrig.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_C®cuÏtiÚ_M©hTrig


42 
´iv©e
 
funùiÚ
 
	$çùÜs
(
$v®ue
)

44 
$¡¬tV®
 = 
	`æoÜ
(
	`sq¹
(
$v®ue
));

46 
$çùÜA¼ay
 = 
	`¬¿y
();

47 
$i
 = 
$¡¬tV®
; $i > 1; --$i) {

48 ià((
$v®ue
 % 
$i
) == 0) {

49 
$çùÜA¼ay
 = 
	`¬¿y_m”ge
($çùÜA¼ay, 
£lf
::
	`çùÜs
(
$v®ue
 / 
$i
));

50 
$çùÜA¼ay
 = 
	`¬¿y_m”ge
($çùÜA¼ay, 
£lf
::
	`çùÜs
(
$i
));

51 ià(
$i
 <ğ
	`sq¹
(
$v®ue
)) {

56 ià(!
	`em±y
(
$çùÜA¼ay
)) {

57 
	`rsÜt
(
$çùÜA¼ay
);

58  
$çùÜA¼ay
;

60  
	`¬¿y
((
š‹g”
è
$v®ue
);

65 
´iv©e
 
funùiÚ
 
	$romªCut
(
$num
, 
$n
)

67  (
$num
 - ($num % 
$n
 ) ) / $n;

68 
	}
}

93 
public
 
funùiÚ
 
	$ATAN2
(
$xCoÜdš©e
 = 
nuÎ
, 
$yCoÜdš©e
 =‚ull)

95 
$xCoÜdš©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($xCoordinate);

96 
$yCoÜdš©e
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($yCoordinate);

98 
$xCoÜdš©e
 = ($xCoÜdš©!=ğ
nuÎ
) ? $xCoordinate : 0.0;

99 
$yCoÜdš©e
 = ($yCoÜdš©!=ğ
nuÎ
) ? $yCoordinate : 0.0;

101 ià(((
	`is_num”ic
(
$xCoÜdš©e
)è|| (
	`is_boŞ
($xCoordinate))) &&

102 ((
	`is_num”ic
(
$yCoÜdš©e
))è|| (
	`is_boŞ
($yCoordinate))) {

103 
$xCoÜdš©e
 = () $xCoordinate;

104 
$yCoÜdš©e
 = () $yCoordinate;

106 ià((
$xCoÜdš©e
 =ğ0è&& (
$yCoÜdš©e
 == 0)) {

107  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

110  
	`©ª2
(
$yCoÜdš©e
, 
$xCoÜdš©e
);

112  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

113 
	}
}

133 
public
 
funùiÚ
 
	$CEILING
(
$numb”
, 
$signifiÿnû
 = 
nuÎ
)

135 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

136 
$signifiÿnû
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($significance);

138 ià((
	`is_nuÎ
(
$signifiÿnû
)) &&

139 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
)) {

140 
$signifiÿnû
 = 
$numb”
 / 
	`abs
($number);

143 ià((
	`is_num”ic
(
$numb”
)è&& (is_num”ic(
$signifiÿnû
))) {

144 ià((
$numb”
 =ğ0.0 ) || (
$signifiÿnû
 == 0.0)) {

146 } 
	`–£if
 (
£lf
::
	`SIGN
(
$numb”
è=ğ£lf::SIGN(
$signifiÿnû
)) {

147  
	`û
(
$numb”
 / 
$signifiÿnû
) * $significance;

149  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

152  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

153 
	}
}

171 
public
 
funùiÚ
 
	$COMBIN
(
$numObjs
, 
$numInS‘
)

173 
$numObjs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($numObjs);

174 
$numInS‘
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($numInSet);

176 ià((
	`is_num”ic
(
$numObjs
)è&& (is_num”ic(
$numInS‘
))) {

177 ià(
$numObjs
 < 
$numInS‘
) {

178  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

179 } 
	`–£if
 (
$numInS‘
 < 0) {

180  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

182  
	`round
(
£lf
::
	`FACT
(
$numObjs
è/ s–f::FACT($numObj - 
$numInS‘
)) / self::FACT($numInSet);

184  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

185 
	}
}

205 
public
 
funùiÚ
 
	$EVEN
(
$numb”
)

207 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

209 ià(
	`is_nuÎ
(
$numb”
)) {

211 } 
	`–£if
 (
	`is_boŞ
(
$numb”
)) {

212 
$numb”
 = () $number;

215 ià(
	`is_num”ic
(
$numb”
)) {

216 
$signifiÿnû
 = 2 * 
£lf
::
	`SIGN
(
$numb”
);

217  (è
£lf
::
	`CEILING
(
$numb”
, 
$signifiÿnû
);

219  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

220 
	}
}

237 
public
 
funùiÚ
 
	$FACT
(
$çùV®
)

239 
$çùV®
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($factVal);

241 ià(
	`is_num”ic
(
$çùV®
)) {

242 ià(
$çùV®
 < 0) {

243  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

245 
$çùLoİ
 = 
	`æoÜ
(
$çùV®
);

246 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

247 ià(
$çùV®
 > 
$çùLoİ
) {

248  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

252 
$çùÜŸl
 = 1;

253 
$çùLoİ
 > 1) {

254 
$çùÜŸl
 *ğ
$çùLoİ
--;

256  
$çùÜŸl
 ;

258  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

259 
	}
}

275 
public
 
funùiÚ
 
	$FACTDOUBLE
(
$çùV®
)

277 
$çùLoİ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
(
$çùV®
);

279 ià(
	`is_num”ic
(
$çùLoİ
)) {

280 
$çùLoİ
 = 
	`æoÜ
($factLoop);

281 ià(
$çùV®
 < 0) {

282  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

284 
$çùÜŸl
 = 1;

285 
$çùLoİ
 > 1) {

286 
$çùÜŸl
 *ğ
$çùLoİ
--;

287 --
$çùLoİ
;

289  
$çùÜŸl
 ;

291  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

292 
	}
}

309 
public
 
funùiÚ
 
	$FLOOR
(
$numb”
, 
$signifiÿnû
 = 
nuÎ
)

311 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

312 
$signifiÿnû
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($significance);

314 ià((
	`is_nuÎ
(
$signifiÿnû
)) &&

315 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
)) {

316 
$signifiÿnû
 = 
$numb”
/
	`abs
($number);

319 ià((
	`is_num”ic
(
$numb”
)è&& (is_num”ic(
$signifiÿnû
))) {

320 ià(
$signifiÿnû
 == 0.0) {

321  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

322 } 
	`–£if
 (
$numb”
 == 0.0) {

324 } 
	`–£if
 (
£lf
::
	`SIGN
(
$numb”
è=ğ£lf::SIGN(
$signifiÿnû
)) {

325  
	`æoÜ
(
$numb”
 / 
$signifiÿnû
) * $significance;

327  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

331  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

332 
	}
}

350 
public
 
funùiÚ
 
	$GCD
()

352 
$»tuºV®ue
 = 1;

353 
$®lV®uesFaùÜs
 = 
	`¬¿y
();

355 
	`fÜ—ch
 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
()è
as
 
$v®ue
) {

356 ià(!
	`is_num”ic
(
$v®ue
)) {

357  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

358 } 
	`–£if
 (
$v®ue
 == 0) {

360 } 
	`–£if
 (
$v®ue
 < 0) {

361  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

363 
$myFaùÜs
 = 
£lf
::
	`çùÜs
(
$v®ue
);

364 
$myCouÁedFaùÜs
 = 
	`¬¿y_couÁ_v®ues
(
$myFaùÜs
);

365 
$®lV®uesFaùÜs
[] = 
$myCouÁedFaùÜs
;

367 
$®lV®uesCouÁ
 = 
	`couÁ
(
$®lV®uesFaùÜs
);

368 ià(
$®lV®uesCouÁ
 == 0) {

372 
$m”gedA¼ay
 = 
$®lV®uesFaùÜs
[0];

373 
$i
=1; $˜< 
$®lV®uesCouÁ
; ++$i) {

374 
$m”gedA¼ay
 = 
	`¬¿y_š‹r£ù_key
($m”gedA¼ay, 
$®lV®uesFaùÜs
[
$i
]);

376 
$m”gedA¼ayV®ues
 = 
	`couÁ
(
$m”gedA¼ay
);

377 ià(
$m”gedA¼ayV®ues
 == 0) {

378  
$»tuºV®ue
;

379 } 
	`–£if
 (
$m”gedA¼ayV®ues
 > 1) {

380 
	`fÜ—ch
 (
$m”gedA¼ay
 
as
 
$m”gedKey
 => 
$m”gedV®ue
) {

381 
	`fÜ—ch
 (
$®lV®uesFaùÜs
 
as
 
$highe¡Pow”Te¡
) {

382 
	`fÜ—ch
 (
$highe¡Pow”Te¡
 
as
 
$‹¡Key
 => 
$‹¡V®ue
) {

383 ià((
$‹¡Key
 =ğ
$m”gedKey
è&& (
$‹¡V®ue
 < 
$m”gedV®ue
)) {

384 
$m”gedA¼ay
[
$m”gedKey
] = 
$‹¡V®ue
;

385 
$m”gedV®ue
 = 
$‹¡V®ue
;

391 
$»tuºV®ue
 = 1;

392 
	`fÜ—ch
 (
$m”gedA¼ay
 
as
 
$key
 => 
$v®ue
) {

393 
$»tuºV®ue
 *ğ
	`pow
(
$key
, 
$v®ue
);

395  
$»tuºV®ue
;

397 
$keys
 = 
	`¬¿y_keys
(
$m”gedA¼ay
);

398 
$key
 = 
$keys
[0];

399 
$v®ue
 = 
$m”gedA¼ay
[
$key
];

400 
	`fÜ—ch
 (
$®lV®uesFaùÜs
 
as
 
$‹¡V®ue
) {

401 
	`fÜ—ch
 (
$‹¡V®ue
 
as
 
$m”gedKey
 => 
$m”gedV®ue
) {

402 ià((
$m”gedKey
 =ğ
$key
è&& (
$m”gedV®ue
 < 
$v®ue
)) {

403 
$v®ue
 = 
$m”gedV®ue
;

407  
	`pow
(
$key
, 
$v®ue
);

409 
	}
}

425 
public
 
funùiÚ
 
	$INT
(
$numb”
)

427 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

429 ià(
	`is_nuÎ
(
$numb”
)) {

431 } 
	`–£if
 (
	`is_boŞ
(
$numb”
)) {

432  (è
$numb”
;

434 ià(
	`is_num”ic
(
$numb”
)) {

435  (è
	`æoÜ
(
$numb”
);

437  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

438 
	}
}

457 
public
 
funùiÚ
 
	$LCM
()

459 
$»tuºV®ue
 = 1;

460 
$®lPow”edFaùÜs
 = 
	`¬¿y
();

462 
	`fÜ—ch
 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
()è
as
 
$v®ue
) {

463 ià(!
	`is_num”ic
(
$v®ue
)) {

464  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

466 ià(
$v®ue
 == 0) {

468 } 
	`–£if
 (
$v®ue
 < 0) {

469  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

471 
$myFaùÜs
 = 
£lf
::
	`çùÜs
(
	`æoÜ
(
$v®ue
));

472 
$myCouÁedFaùÜs
 = 
	`¬¿y_couÁ_v®ues
(
$myFaùÜs
);

473 
$myPow”edFaùÜs
 = 
	`¬¿y
();

474 
	`fÜ—ch
 (
$myCouÁedFaùÜs
 
as
 
$myCouÁedFaùÜ
 => 
$myCouÁedPow”
) {

475 
$myPow”edFaùÜs
[
$myCouÁedFaùÜ
] = 
	`pow
($myCouÁedFaùÜ, 
$myCouÁedPow”
);

477 
	`fÜ—ch
 (
$myPow”edFaùÜs
 
as
 
$myPow”edV®ue
 => 
$myPow”edFaùÜ
) {

478 ià(
	`¬¿y_key_exi¡s
(
$myPow”edV®ue
, 
$®lPow”edFaùÜs
)) {

479 ià(
$®lPow”edFaùÜs
[
$myPow”edV®ue
] < 
$myPow”edFaùÜ
) {

480 
$®lPow”edFaùÜs
[
$myPow”edV®ue
] = 
$myPow”edFaùÜ
;

483 
$®lPow”edFaùÜs
[
$myPow”edV®ue
] = 
$myPow”edFaùÜ
;

487 
	`fÜ—ch
 (
$®lPow”edFaùÜs
 
as
 
$®lPow”edFaùÜ
) {

488 
$»tuºV®ue
 *ğ(
š‹g”
è
$®lPow”edFaùÜ
;

490  
$»tuºV®ue
;

491 
	}
}

508 
public
 
funùiÚ
 
	$LOG_BASE
(
$numb”
 = 
nuÎ
, 
$ba£
 = 10)

510 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

511 
$ba£
 = (
	`is_nuÎ
($ba£)è? 10 : (è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($base);

513 ià((!
	`is_num”ic
(
$ba£
)è|| (!is_num”ic(
$numb”
))) {

514  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

516 ià((
$ba£
 <ğ0è|| (
$numb”
 <= 0)) {

517  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

519  
	`log
(
$numb”
, 
$ba£
);

520 
	}
}

536 
public
 
funùiÚ
 
	$MDETERM
(
$m©rixV®ues
)

538 
$m©rixD©a
 = 
	`¬¿y
();

539 ià(!
	`is_¬¿y
(
$m©rixV®ues
)) {

540 
$m©rixV®ues
 = 
	`¬¿y
(array($matrixValues));

543 
$row
 = 
$maxCŞumn
 = 0;

544 
	`fÜ—ch
 (
$m©rixV®ues
 
as
 
$m©rixRow
) {

545 ià(!
	`is_¬¿y
(
$m©rixRow
)) {

546 
$m©rixRow
 = 
	`¬¿y
($matrixRow);

548 
$cŞumn
 = 0;

549 
	`fÜ—ch
 (
$m©rixRow
 
as
 
$m©rixC–l
) {

550 ià((
	`is_¡ršg
(
$m©rixC–l
)è|| ($m©rixC–È==ğ
nuÎ
)) {

551  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

553 
$m©rixD©a
[
$cŞumn
][
$row
] = 
$m©rixC–l
;

554 ++
$cŞumn
;

556 ià(
$cŞumn
 > 
$maxCŞumn
) {

557 
$maxCŞumn
 = 
$cŞumn
;

559 ++
$row
;

561 ià(
$row
 !ğ
$maxCŞumn
) {

562  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

565 
Œy
 {

566 
$m©rix
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m©rixD©a
);

567  
$m©rix
->
	`d‘
();

568 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$ex
) {

569  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

571 
	}
}

587 
public
 
funùiÚ
 
	$MINVERSE
(
$m©rixV®ues
)

589 
$m©rixD©a
 = 
	`¬¿y
();

590 ià(!
	`is_¬¿y
(
$m©rixV®ues
)) {

591 
$m©rixV®ues
 = 
	`¬¿y
(array($matrixValues));

594 
$row
 = 
$maxCŞumn
 = 0;

595 
	`fÜ—ch
 (
$m©rixV®ues
 
as
 
$m©rixRow
) {

596 ià(!
	`is_¬¿y
(
$m©rixRow
)) {

597 
$m©rixRow
 = 
	`¬¿y
($matrixRow);

599 
$cŞumn
 = 0;

600 
	`fÜ—ch
 (
$m©rixRow
 
as
 
$m©rixC–l
) {

601 ià((
	`is_¡ršg
(
$m©rixC–l
)è|| ($m©rixC–È==ğ
nuÎ
)) {

602  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

604 
$m©rixD©a
[
$cŞumn
][
$row
] = 
$m©rixC–l
;

605 ++
$cŞumn
;

607 ià(
$cŞumn
 > 
$maxCŞumn
) {

608 
$maxCŞumn
 = 
$cŞumn
;

610 ++
$row
;

612 ià(
$row
 !ğ
$maxCŞumn
) {

613  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

616 
Œy
 {

617 
$m©rix
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m©rixD©a
);

618  
$m©rix
->
	`šv”£
()->
	`g‘A¼ay
();

619 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$ex
) {

620  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

622 
	}
}

632 
public
 
funùiÚ
 
	$MMULT
(
$m©rixD©a1
, 
$m©rixD©a2
)

634 
$m©rixAD©a
 = 
$m©rixBD©a
 = 
	`¬¿y
();

635 ià(!
	`is_¬¿y
(
$m©rixD©a1
)) {

636 
$m©rixD©a1
 = 
	`¬¿y
(array($matrixData1));

638 ià(!
	`is_¬¿y
(
$m©rixD©a2
)) {

639 
$m©rixD©a2
 = 
	`¬¿y
(array($matrixData2));

642 
Œy
 {

643 
$rowA
 = 0;

644 
	`fÜ—ch
 (
$m©rixD©a1
 
as
 
$m©rixRow
) {

645 ià(!
	`is_¬¿y
(
$m©rixRow
)) {

646 
$m©rixRow
 = 
	`¬¿y
($matrixRow);

648 
$cŞumnA
 = 0;

649 
	`fÜ—ch
 (
$m©rixRow
 
as
 
$m©rixC–l
) {

650 ià((!
	`is_num”ic
(
$m©rixC–l
)è|| ($m©rixC–È==ğ
nuÎ
)) {

651  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

653 
$m©rixAD©a
[
$rowA
][
$cŞumnA
] = 
$m©rixC–l
;

654 ++
$cŞumnA
;

656 ++
$rowA
;

658 
$m©rixA
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m©rixAD©a
);

659 
$rowB
 = 0;

660 
	`fÜ—ch
 (
$m©rixD©a2
 
as
 
$m©rixRow
) {

661 ià(!
	`is_¬¿y
(
$m©rixRow
)) {

662 
$m©rixRow
 = 
	`¬¿y
($matrixRow);

664 
$cŞumnB
 = 0;

665 
	`fÜ—ch
 (
$m©rixRow
 
as
 
$m©rixC–l
) {

666 ià((!
	`is_num”ic
(
$m©rixC–l
)è|| ($m©rixC–È==ğ
nuÎ
)) {

667  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

669 
$m©rixBD©a
[
$rowB
][
$cŞumnB
] = 
$m©rixC–l
;

670 ++
$cŞumnB
;

672 ++
$rowB
;

674 
$m©rixB
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m©rixBD©a
);

676 ià(
$cŞumnA
 !ğ
$rowB
) {

677  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

680  
$m©rixA
->
	`times
(
$m©rixB
)->
	`g‘A¼ay
();

681 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$ex
) {

682 
	`v¬_dump
(
$ex
->
	`g‘Mes§ge
());

683  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

685 
	}
}

695 
public
 
funùiÚ
 
	$MOD
(
$a
 = 1, 
$b
 = 1)

697 
$a
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($a);

698 
$b
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($b);

700 ià(
$b
 == 0.0) {

701  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

702 } 
	`–£if
 ((
$a
 < 0.0è&& (
$b
 > 0.0)) {

703  
$b
 - 
	`fmod
(
	`abs
(
$a
), $b);

704 } 
	`–£if
 ((
$a
 > 0.0è&& (
$b
 < 0.0)) {

705  
$b
 + 
	`fmod
(
$a
, 
	`abs
($b));

708  
	`fmod
(
$a
, 
$b
);

709 
	}
}

721 
public
 
funùiÚ
 
	$MROUND
(
$numb”
, 
$muÉË
)

723 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

724 
$muÉË
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($multiple);

726 ià((
	`is_num”ic
(
$numb”
)è&& (is_num”ic(
$muÉË
))) {

727 ià(
$muÉË
 == 0) {

730 ià((
£lf
::
	`SIGN
(
$numb”
)è=ğ(£lf::SIGN(
$muÉË
))) {

731 
$muÉl›r
 = 1 / 
$muÉË
;

732  
	`round
(
$numb”
 * 
$muÉl›r
) / $multiplier;

734  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

736  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

737 
	}
}

748 
public
 
funùiÚ
 
	$MULTINOMIAL
()

750 
$summ”
 = 0;

751 
$divisÜ
 = 1;

753 
	`fÜ—ch
 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
()è
as
 
$¬g
) {

755 ià(
	`is_num”ic
(
$¬g
)) {

756 ià(
$¬g
 < 1) {

757  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

759 
$summ”
 +ğ
	`æoÜ
(
$¬g
);

760 
$divisÜ
 *ğ
£lf
::
	`FACT
(
$¬g
);

762  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

767 ià(
$summ”
 > 0) {

768 
$summ”
 = 
£lf
::
	`FACT
($summer);

769  
$summ”
 / 
$divisÜ
;

772 
	}
}

783 
public
 
funùiÚ
 
	$ODD
(
$numb”
)

785 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

787 ià(
	`is_nuÎ
(
$numb”
)) {

789 } 
	`–£if
 (
	`is_boŞ
(
$numb”
)) {

791 } 
	`–£if
 (
	`is_num”ic
(
$numb”
)) {

792 
$signifiÿnû
 = 
£lf
::
	`SIGN
(
$numb”
);

793 ià(
$signifiÿnû
 == 0) {

797 
$»suÉ
 = 
£lf
::
	`CEILING
(
$numb”
, 
$signifiÿnû
);

798 ià(
$»suÉ
 =ğ
£lf
::
	`EVEN
($result)) {

799 
$»suÉ
 +ğ
$signifiÿnû
;

802  (è
$»suÉ
;

804  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

805 
	}
}

817 
public
 
funùiÚ
 
	$POWER
(
$x
 = 0, 
$y
 = 2)

819 
$x
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($x);

820 
$y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($y);

823 ià(
$x
 =ğ0.0 && 
$y
 == 0.0) {

824  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

825 } 
	`–£if
 (
$x
 =ğ0.0 && 
$y
 < 0.0) {

826  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

830 
$»suÉ
 = 
	`pow
(
$x
, 
$y
);

831  (!
	`is_Çn
(
$»suÉ
è&& !
	`is_šfš™e
($»suÉ)è? $»suÉ : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

832 
	}
}

848 
public
 
funùiÚ
 
	$PRODUCT
()

851 
$»tuºV®ue
 = 
nuÎ
;

854 
	`fÜ—ch
 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
()è
as
 
$¬g
) {

856 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

857 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

858 
$»tuºV®ue
 = 
$¬g
;

860 
$»tuºV®ue
 *ğ
$¬g
;

866 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

869  
$»tuºV®ue
;

870 
	}
}

887 
public
 
funùiÚ
 
	$QUOTIENT
()

890 
$»tuºV®ue
 = 
nuÎ
;

893 
	`fÜ—ch
 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
()è
as
 
$¬g
) {

895 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

896 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

897 
$»tuºV®ue
 = (
$¬g
 == 0) ? 0 : $arg;

899 ià((
$»tuºV®ue
 =ğ0è|| (
$¬g
 == 0)) {

900 
$»tuºV®ue
 = 0;

902 
$»tuºV®ue
 /ğ
$¬g
;

909  
	`štv®
(
$»tuºV®ue
);

910 
	}
}

920 
public
 
funùiÚ
 
	$RAND
(
$mš
 = 0, 
$max
 = 0)

922 
$mš
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($min);

923 
$max
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($max);

925 ià(
$mš
 =ğ0 && 
$max
 == 0) {

926  (
	`mt_¿nd
(0, 10000000)) / 10000000;

928  
	`mt_¿nd
(
$mš
, 
$max
);

930 
	}
}

933 
public
 
funùiÚ
 
	$ROMAN
(
$aV®ue
, 
$¡yË
 = 0)

935 
$aV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($aValue);

936 
$¡yË
 = (
	`is_nuÎ
($¡yË)è? 0 : (
š‹g”
è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($style);

937 ià((!
	`is_num”ic
(
$aV®ue
)) || ($aValue < 0) || ($aValue >= 4000)) {

938  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

940 
$aV®ue
 = (
š‹g”
) $aValue;

941 ià(
$aV®ue
 == 0) {

945 
$ml
 = 
	`¬¿y
('', 'M', 'MM', 'MMM', 'MMMM', 'MMMMM');

946 
$ûÁ
 = 
	`¬¿y
('', 'C', 'CC', 'CCC', 'CD', 'D', 'DC', 'DCC', 'DCCC', 'CM');

947 
$‹ns
 = 
	`¬¿y
('', 'X', 'XX', 'XXX', 'XL', 'L', 'LX', 'LXX', 'LXXX', 'XC');

948 
$Úes
 = 
	`¬¿y
('', 'I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IX');

950 
$romª
 = '';

951 
$aV®ue
 > 5999) {

952 
$romª
 .= 'M';

953 
$aV®ue
 -= 1000;

955 
$m
 = 
£lf
::
	`romªCut
(
$aV®ue
, 1000);

956 
$aV®ue
 %= 1000;

957 
$c
 = 
£lf
::
	`romªCut
(
$aV®ue
, 100);

958 
$aV®ue
 %= 100;

959 
$t
 = 
£lf
::
	`romªCut
(
$aV®ue
, 10);

960 
$aV®ue
 %= 10;

962  
$romª
.
$ml
[
$m
].
$ûÁ
[
$c
].
$‹ns
[
$t
].
$Úes
[
$aV®ue
];

963 
	}
}

975 
public
 
funùiÚ
 
	$ROUNDUP
(
$numb”
, 
$dig™s
)

977 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

978 
$dig™s
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($digits);

980 ià((
	`is_num”ic
(
$numb”
)è&& (is_num”ic(
$dig™s
))) {

981 
$signifiÿnû
 = 
	`pow
(10, (è
$dig™s
);

982 ià(
$numb”
 < 0.0) {

983  
	`æoÜ
(
$numb”
 * 
$signifiÿnû
) / $significance;

985  
	`û
(
$numb”
 * 
$signifiÿnû
) / $significance;

988  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

989 
	}
}

1001 
public
 
funùiÚ
 
	$ROUNDDOWN
(
$numb”
, 
$dig™s
)

1003 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

1004 
$dig™s
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($digits);

1006 ià((
	`is_num”ic
(
$numb”
)è&& (is_num”ic(
$dig™s
))) {

1007 
$signifiÿnû
 = 
	`pow
(10, (è
$dig™s
);

1008 ià(
$numb”
 < 0.0) {

1009  
	`û
(
$numb”
 * 
$signifiÿnû
) / $significance;

1011  
	`æoÜ
(
$numb”
 * 
$signifiÿnû
) / $significance;

1014  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1015 
	}
}

1029 
public
 
funùiÚ
 
	$SERIESSUM
()

1031 
$»tuºV®ue
 = 0;

1034 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

1036 
$x
 = 
	`¬¿y_shiá
(
$aArgs
);

1037 
$n
 = 
	`¬¿y_shiá
(
$aArgs
);

1038 
$m
 = 
	`¬¿y_shiá
(
$aArgs
);

1040 ià((
	`is_num”ic
(
$x
)è&& (is_num”ic(
$n
)è&& (is_num”ic(
$m
))) {

1042 
$i
 = 0;

1043 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

1045 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

1046 
$»tuºV®ue
 +ğ
$¬g
 * 
	`pow
(
$x
, 
$n
 + (
$m
 * 
$i
++));

1048  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1051  
$»tuºV®ue
;

1053  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1054 
	}
}

1066 
public
 
funùiÚ
 
	$SIGN
(
$numb”
)

1068 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

1070 ià(
	`is_boŞ
(
$numb”
)) {

1071  (è
$numb”
;

1073 ià(
	`is_num”ic
(
$numb”
)) {

1074 ià(
$numb”
 == 0.0) {

1077  
$numb”
 / 
	`abs
($number);

1079  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1080 
	}
}

1091 
public
 
funùiÚ
 
	$SQRTPI
(
$numb”
)

1093 
$numb”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($number);

1095 ià(
	`is_num”ic
(
$numb”
)) {

1096 ià(
$numb”
 < 0) {

1097  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1099  
	`sq¹
(
$numb”
 * 
M_PI
) ;

1101  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1102 
	}
}

1115 
public
 
funùiÚ
 
	$SUBTOTAL
()

1117 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

1120 
$subtÙ®
 = 
	`¬¿y_shiá
(
$aArgs
);

1122 ià((
	`is_num”ic
(
$subtÙ®
)è&& (!
	`is_¡ršg
($subtotal))) {

1123 
$subtÙ®
) {

1125  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`AVERAGE
(
$aArgs
);

1127  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`COUNT
(
$aArgs
);

1129  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`COUNTA
(
$aArgs
);

1131  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`MAX
(
$aArgs
);

1133  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`MIN
(
$aArgs
);

1135  
£lf
::
	`PRODUCT
(
$aArgs
);

1137  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`STDEV
(
$aArgs
);

1139  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`STDEVP
(
$aArgs
);

1141  
£lf
::
	`SUM
(
$aArgs
);

1143  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`VARFunc
(
$aArgs
);

1145  
PHPExûl_C®cuÏtiÚ_Sti¡iÿl
::
	`VARP
(
$aArgs
);

1148  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1149 
	}
}

1165 
public
 
funùiÚ
 
	$SUM
()

1167 
$»tuºV®ue
 = 0;

1170 
	`fÜ—ch
 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
()è
as
 
$¬g
) {

1172 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

1173 
$»tuºV®ue
 +ğ
$¬g
;

1177  
$»tuºV®ue
;

1178 
	}
}

1195 
public
 
funùiÚ
 
SUMIF
(
$aArgs
, 
$cÚd™iÚ
, 
$sumArgs
 = 
	$¬¿y
())

1197 
$»tuºV®ue
 = 0;

1199 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($aArgs);

1200 
$sumArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($sumArgs);

1201 ià(
	`em±y
(
$sumArgs
)) {

1202 
$sumArgs
 = 
$aArgs
;

1204 
$cÚd™iÚ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`ifCÚd™iÚ
($condition);

1206 
	`fÜ—ch
 (
$aArgs
 
as
 
$key
 => 
$¬g
) {

1207 ià(!
	`is_num”ic
(
$¬g
)) {

1208 
$¬g
 = 
	`¡r_»¶aû
('"', '""', $arg);

1209 
$¬g
 = 
PHPExûl_C®cuÏtiÚ
::
	`w¿pResuÉ
(
	`¡¹ouµ”
($arg));

1212 
$‹¡CÚd™iÚ
 = '='.
$¬g
.
$cÚd™iÚ
;

1213 ià(
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`_ÿlcuÏ‹FÜmuÏV®ue
(
$‹¡CÚd™iÚ
)) {

1215 
$»tuºV®ue
 +ğ
$sumArgs
[
$key
];

1219  
$»tuºV®ue
;

1220 
	}
}

1234 
public
 
funùiÚ
 
	$SUMPRODUCT
()

1236 
$¬¿yLi¡
 = 
	`func_g‘_¬gs
();

1238 
$wrkA¼ay
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`¬¿y_shiá
(
$¬¿yLi¡
));

1239 
$wrkC–lCouÁ
 = 
	`couÁ
(
$wrkA¼ay
);

1241 
$i
=0; $i< 
$wrkC–lCouÁ
; ++$i) {

1242 ià((!
	`is_num”ic
(
$wrkA¼ay
[
$i
])è|| (
	`is_¡ršg
($wrkArray[$i]))) {

1243 
$wrkA¼ay
[
$i
] = 0;

1247 
	`fÜ—ch
 (
$¬¿yLi¡
 
as
 
$m©rixD©a
) {

1248 
$¬¿y2
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$m©rixD©a
);

1249 
$couÁ
 = 
	`couÁ
(
$¬¿y2
);

1250 ià(
$wrkC–lCouÁ
 !ğ
$couÁ
) {

1251  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1254 
	`fÜ—ch
 (
$¬¿y2
 
as
 
$i
 => 
$v®
) {

1255 ià((!
	`is_num”ic
(
$v®
)è|| (
	`is_¡ršg
($val))) {

1256 
$v®
 = 0;

1258 
$wrkA¼ay
[
$i
] *ğ
$v®
;

1262  
	`¬¿y_sum
(
$wrkA¼ay
);

1263 
	}
}

1279 
public
 
funùiÚ
 
	$SUMSQ
()

1281 
$»tuºV®ue
 = 0;

1284 
	`fÜ—ch
 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
()è
as
 
$¬g
) {

1286 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

1287 
$»tuºV®ue
 +ğ(
$¬g
 * $arg);

1291  
$»tuºV®ue
;

1292 
	}
}

1302 
public
 
funùiÚ
 
	$SUMX2MY2
(
$m©rixD©a1
, 
$m©rixD©a2
)

1304 
$¬¿y1
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$m©rixD©a1
);

1305 
$¬¿y2
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$m©rixD©a2
);

1306 
$couÁ
 = 
	`mš
(
	`couÁ
(
$¬¿y1
), couÁ(
$¬¿y2
));

1308 
$»suÉ
 = 0;

1309 
$i
 = 0; $˜< 
$couÁ
; ++$i) {

1310 ià(((
	`is_num”ic
(
$¬¿y1
[
$i
])è&& (!
	`is_¡ršg
($array1[$i]))) &&

1311 ((
	`is_num”ic
(
$¬¿y2
[
$i
])è&& (!
	`is_¡ršg
($array2[$i])))) {

1312 
$»suÉ
 +ğ(
$¬¿y1
[
$i
] * $¬¿y1[$i]è- (
$¬¿y2
[$i] * $array2[$i]);

1316  
$»suÉ
;

1317 
	}
}

1327 
public
 
funùiÚ
 
	$SUMX2PY2
(
$m©rixD©a1
, 
$m©rixD©a2
)

1329 
$¬¿y1
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$m©rixD©a1
);

1330 
$¬¿y2
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$m©rixD©a2
);

1331 
$couÁ
 = 
	`mš
(
	`couÁ
(
$¬¿y1
), couÁ(
$¬¿y2
));

1333 
$»suÉ
 = 0;

1334 
$i
 = 0; $˜< 
$couÁ
; ++$i) {

1335 ià(((
	`is_num”ic
(
$¬¿y1
[
$i
])è&& (!
	`is_¡ršg
($array1[$i]))) &&

1336 ((
	`is_num”ic
(
$¬¿y2
[
$i
])è&& (!
	`is_¡ršg
($array2[$i])))) {

1337 
$»suÉ
 +ğ(
$¬¿y1
[
$i
] * $¬¿y1[$i]è+ (
$¬¿y2
[$i] * $array2[$i]);

1341  
$»suÉ
;

1342 
	}
}

1352 
public
 
funùiÚ
 
	$SUMXMY2
(
$m©rixD©a1
, 
$m©rixD©a2
)

1354 
$¬¿y1
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$m©rixD©a1
);

1355 
$¬¿y2
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$m©rixD©a2
);

1356 
$couÁ
 = 
	`mš
(
	`couÁ
(
$¬¿y1
), couÁ(
$¬¿y2
));

1358 
$»suÉ
 = 0;

1359 
$i
 = 0; $˜< 
$couÁ
; ++$i) {

1360 ià(((
	`is_num”ic
(
$¬¿y1
[
$i
])è&& (!
	`is_¡ršg
($array1[$i]))) &&

1361 ((
	`is_num”ic
(
$¬¿y2
[
$i
])è&& (!
	`is_¡ršg
($array2[$i])))) {

1362 
$»suÉ
 +ğ(
$¬¿y1
[
$i
] - 
$¬¿y2
[$i]) * ($array1[$i] - $array2[$i]);

1366  
$»suÉ
;

1367 
	}
}

1379 
public
 
funùiÚ
 
	$TRUNC
(
$v®ue
 = 0, 
$dig™s
 = 0)

1381 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

1382 
$dig™s
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($digits);

1385 ià((!
	`is_num”ic
(
$v®ue
)è|| (!is_num”ic(
$dig™s
))) {

1386  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1388 
$dig™s
 = 
	`æoÜ
($digits);

1391 
$adju¡
 = 
	`pow
(10, 
$dig™s
);

1393 ià((
$dig™s
 > 0è&& (
	`¹rim
(
	`štv®
((
	`abs
(
$v®ue
è-‡bs(štv®($v®ue))è* 
$adju¡
), '0') < $adjust/10)) {

1394  
$v®ue
;

1397  (
	`štv®
(
$v®ue
 * 
$adju¡
)) / $adjust;

1398 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Statistical.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

13 
»quœe_Úû
 
	gPHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/trendClass.php';

17 
defše
('LOG_GAMMA_X_MAX_VALUE', 2.55e305);

20 
defše
('XMININ', 2.23e-308);

23 
defše
('EPS', 2.22e-16);

26 
defše
('SQRT2PI', 2.5066282746310005024157652848110452530069867406099);

53 şas 
	cPHPExûl_C®cuÏtiÚ_Sti¡iÿl


55 
´iv©e
 
funùiÚ
 
	$checkT»ndA¼ays
(&
$¬¿y1
, &
$¬¿y2
)

57 ià(!
	`is_¬¿y
(
$¬¿y1
)) {

58 
$¬¿y1
 = 
	`¬¿y
($array1);

60 ià(!
	`is_¬¿y
(
$¬¿y2
)) {

61 
$¬¿y2
 = 
	`¬¿y
($array2);

64 
$¬¿y1
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($array1);

65 
$¬¿y2
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($array2);

66 
	`fÜ—ch
 (
$¬¿y1
 
as
 
$key
 => 
$v®ue
) {

67 ià((
	`is_boŞ
(
$v®ue
)è|| (
	`is_¡ršg
($v®ue)è|| (
	`is_nuÎ
($value))) {

68 
	`un£t
(
$¬¿y1
[
$key
]);

69 
	`un£t
(
$¬¿y2
[
$key
]);

72 
	`fÜ—ch
 (
$¬¿y2
 
as
 
$key
 => 
$v®ue
) {

73 ià((
	`is_boŞ
(
$v®ue
)è|| (
	`is_¡ršg
($v®ue)è|| (
	`is_nuÎ
($value))) {

74 
	`un£t
(
$¬¿y1
[
$key
]);

75 
	`un£t
(
$¬¿y2
[
$key
]);

78 
$¬¿y1
 = 
	`¬¿y_m”ge
($array1);

79 
$¬¿y2
 = 
	`¬¿y_m”ge
($array2);

81  
Œue
;

94 
´iv©e
 
funùiÚ
 
	$b‘a
(
$p
, 
$q
)

96 ià(
$p
 <ğ0.0 || 
$q
 <ğ0.0 || ($°+ $qè> 
LOG_GAMMA_X_MAX_VALUE
) {

99  
	`exp
(
£lf
::
	`logB‘a
(
$p
, 
$q
));

101 
	}
}

116 
´iv©e
 
funùiÚ
 
	$šcom¶‘eB‘a
(
$x
, 
$p
, 
$q
)

118 ià(
$x
 <= 0.0) {

120 } 
	`–£if
 (
$x
 >= 1.0) {

122 } 
	`–£if
 ((
$p
 <ğ0.0è|| (
$q
 <ğ0.0è|| (($°+ $qè> 
LOG_GAMMA_X_MAX_VALUE
)) {

125 
$b‘a_gam
 = 
	`exp
((0 - 
£lf
::
	`logB‘a
(
$p
, 
$q
)è+ $°* 
	`log
(
$x
) + $q *†og(1.0 - $x));

126 ià(
$x
 < (
$p
 + 1.0è/ ($°+ 
$q
 + 2.0)) {

127  
$b‘a_gam
 * 
£lf
::
	`b‘aF¿ùiÚ
(
$x
, 
$p
, 
$q
) / $p;

129  1.0 - (
$b‘a_gam
 * 
£lf
::
	`b‘aF¿ùiÚ
(1 - 
$x
, 
$q
, 
$p
) / $q);

131 
	}
}

135 
´iv©e
 
	g$logB‘aCacheP
 = 0.0;

136 
´iv©e
 
	g$logB‘aCacheQ
 = 0.0;

137 
´iv©e
 
	g$logB‘aCacheResuÉ
 = 0.0;

147 
´iv©e
 
funùiÚ
 
	$logB‘a
(
$p
, 
$q
)

149 ià(
$p
 !ğ
£lf
::
$logB‘aCacheP
 || 
$q
 !ğ£lf::
$logB‘aCacheQ
) {

150 
£lf
::
$logB‘aCacheP
 = 
$p
;

151 
£lf
::
$logB‘aCacheQ
 = 
$q
;

152 ià((
$p
 <ğ0.0è|| (
$q
 <ğ0.0è|| (($°+ $qè> 
LOG_GAMMA_X_MAX_VALUE
)) {

153 
£lf
::
$logB‘aCacheResuÉ
 = 0.0;

155 
£lf
::
$logB‘aCacheResuÉ
 = s–f::
	`logGamma
(
$p
è+ s–f::logGamma(
$q
) - self::logGamma($p + $q);

158  
£lf
::
$logB‘aCacheResuÉ
;

159 
	}
}

167 
´iv©e
 
funùiÚ
 
	$b‘aF¿ùiÚ
(
$x
, 
$p
, 
$q
)

169 
$c
 = 1.0;

170 
$sum_pq
 = 
$p
 + 
$q
;

171 
$p_¶us
 = 
$p
 + 1.0;

172 
$p_mšus
 = 
$p
 - 1.0;

173 
$h
 = 1.0 - 
$sum_pq
 * 
$x
 / 
$p_¶us
;

174 ià(
	`abs
(
$h
è< 
XMININ
) {

175 
$h
 = 
XMININ
;

177 
$h
 = 1.0 / $h;

178 
$äac
 = 
$h
;

179 
$m
 = 1;

180 
$d–
 = 0.0;

181 
$m
 <ğ
MAX_ITERATIONS
 && 
	`abs
(
$d–
-1.0è> 
PRECISION
) {

182 
$m2
 = 2 * 
$m
;

184 
$d
 = 
$m
 * (
$q
 - $mè* 
$x
 / ( (
$p_mšus
 + 
$m2
è* (
$p
 + $m2));

185 
$h
 = 1.0 + 
$d
 * $h;

186 ià(
	`abs
(
$h
è< 
XMININ
) {

187 
$h
 = 
XMININ
;

189 
$h
 = 1.0 / $h;

190 
$c
 = 1.0 + 
$d
 / $c;

191 ià(
	`abs
(
$c
è< 
XMININ
) {

192 
$c
 = 
XMININ
;

194 
$äac
 *ğ
$h
 * 
$c
;

196 
$d
 = -(
$p
 + 
$m
è* (
$sum_pq
 + $mè* 
$x
 / (($°+ 
$m2
è* (
$p_¶us
 + $m2));

197 
$h
 = 1.0 + 
$d
 * $h;

198 ià(
	`abs
(
$h
è< 
XMININ
) {

199 
$h
 = 
XMININ
;

201 
$h
 = 1.0 / $h;

202 
$c
 = 1.0 + 
$d
 / $c;

203 ià(
	`abs
(
$c
è< 
XMININ
) {

204 
$c
 = 
XMININ
;

206 
$d–
 = 
$h
 * 
$c
;

207 
$äac
 *ğ
$d–
;

208 ++
$m
;

210  
$äac
;

211 
	}
}

258 
´iv©e
 
	g$logGammaCacheResuÉ
 = 0.0;

259 
´iv©e
 
	g$logGammaCacheX
 = 0.0;

261 
´iv©e
 
funùiÚ
 
	$logGamma
(
$x
)

264 
$lg_d1
 = -0.5772156649015328605195174;

265 
$lg_d2
 = 0.4227843350984671393993777;

266 
$lg_d4
 = 1.791759469228055000094023;

268 
$lg_p1
 = 
	`¬¿y
(

278 
$lg_p2
 = 
	`¬¿y
(

288 
$lg_p4
 = 
	`¬¿y
(

298 
$lg_q1
 = 
	`¬¿y
(

308 
$lg_q2
 = 
	`¬¿y
(

318 
$lg_q4
 = 
	`¬¿y
(

328 
$lg_c
 = 
	`¬¿y
(

339 
$lg_ätbig
 = 2.25e76;

340 
$²t68
 = 0.6796875;

343 ià(
$x
 =ğ
£lf
::
$logGammaCacheX
) {

344  
£lf
::
$logGammaCacheResuÉ
;

346 
$y
 = 
$x
;

347 ià(
$y
 > 0.0 && $y <ğ
LOG_GAMMA_X_MAX_VALUE
) {

348 ià(
$y
 <ğ
EPS
) {

349 
$»s
 = -
	`log
(
y
);

350 } 
	`–£if
 (
$y
 <= 1.5) {

354 ià(
$y
 < 
$²t68
) {

355 
$cÜr
 = -
	`log
(
$y
);

356 
$xm1
 = 
$y
;

358 
$cÜr
 = 0.0;

359 
$xm1
 = 
$y
 - 1.0;

361 ià(
$y
 <ğ0.5 || $y >ğ
$²t68
) {

362 
$xd’
 = 1.0;

363 
$xnum
 = 0.0;

364 
$i
 = 0; $i < 8; ++$i) {

365 
$xnum
 = $xnum * 
$xm1
 + 
$lg_p1
[
$i
];

366 
$xd’
 = $xd’ * 
$xm1
 + 
$lg_q1
[
$i
];

368 
$»s
 = 
$cÜr
 + 
$xm1
 * (
$lg_d1
 + $xm1 * (
$xnum
 / 
$xd’
));

370 
$xm2
 = 
$y
 - 1.0;

371 
$xd’
 = 1.0;

372 
$xnum
 = 0.0;

373 
$i
 = 0; $i < 8; ++$i) {

374 
$xnum
 = $xnum * 
$xm2
 + 
$lg_p2
[
$i
];

375 
$xd’
 = $xd’ * 
$xm2
 + 
$lg_q2
[
$i
];

377 
$»s
 = 
$cÜr
 + 
$xm2
 * (
$lg_d2
 + $xm2 * (
$xnum
 / 
$xd’
));

379 } 
	`–£if
 (
$y
 <= 4.0) {

383 
$xm2
 = 
$y
 - 2.0;

384 
$xd’
 = 1.0;

385 
$xnum
 = 0.0;

386 
$i
 = 0; $i < 8; ++$i) {

387 
$xnum
 = $xnum * 
$xm2
 + 
$lg_p2
[
$i
];

388 
$xd’
 = $xd’ * 
$xm2
 + 
$lg_q2
[
$i
];

390 
$»s
 = 
$xm2
 * (
$lg_d2
 + $xm2 * (
$xnum
 / 
$xd’
));

391 } 
	`–£if
 (
$y
 <= 12.0) {

395 
$xm4
 = 
$y
 - 4.0;

396 
$xd’
 = -1.0;

397 
$xnum
 = 0.0;

398 
$i
 = 0; $i < 8; ++$i) {

399 
$xnum
 = $xnum * 
$xm4
 + 
$lg_p4
[
$i
];

400 
$xd’
 = $xd’ * 
$xm4
 + 
$lg_q4
[
$i
];

402 
$»s
 = 
$lg_d4
 + 
$xm4
 * (
$xnum
 / 
$xd’
);

407 
$»s
 = 0.0;

408 ià(
$y
 <ğ
$lg_ätbig
) {

409 
$»s
 = 
$lg_c
[6];

410 
$ysq
 = 
$y
 * $y;

411 
$i
 = 0; $i < 6; ++$i) {

412 
$»s
 = $» / 
$ysq
 + 
$lg_c
[
$i
];

414 
$»s
 /ğ
$y
;

415 
$cÜr
 = 
	`log
(
$y
);

416 
$»s
 = $» + 
	`log
(
SQRT2PI
è- 0.5 * 
$cÜr
;

417 
$»s
 +ğ
$y
 * (
$cÜr
 - 1.0);

424 
$»s
 = 
MAX_VALUE
;

429 
£lf
::
$logGammaCacheX
 = 
$x
;

430 
£lf
::
$logGammaCacheResuÉ
 = 
$»s
;

431  
$»s
;

432 
	}
}

438 
´iv©e
 
funùiÚ
 
	$šcom¶‘eGamma
(
$a
, 
$x
)

440 
$max
 = 32;

441 
$summ”
 = 0;

442 
$n
=0; $n<=
$max
; ++$n) {

443 
$divisÜ
 = 
$a
;

444 
$i
=1; $i<=
$n
; ++$i) {

445 
$divisÜ
 *ğ(
$a
 + 
$i
);

447 
$summ”
 +ğ(
	`pow
(
$x
, 
$n
è/ 
$divisÜ
);

449  
	`pow
(
$x
, 
$a
è* 
	`exp
(0-$xè* 
$summ”
;

450 
	}
}

456 
´iv©e
 
funùiÚ
 
	$gamma
(
$d©a
)

458 ià(
$d©a
 == 0.0) {

462 
$p0
 = 1.000000000190015;

463 
$p
 = 
	`¬¿y
(

472 
$y
 = 
$x
 = 
$d©a
;

473 
$tmp
 = 
$x
 + 5.5;

474 
$tmp
 -ğ(
$x
 + 0.5è* 
	`log
($tmp);

476 
$summ”
 = 
$p0
;

477 
$j
=1; $j<=6; ++$j) {

478 
$summ”
 +ğ(
$p
[
$j
] / ++
$y
);

480  
	`exp
(0 - 
$tmp
 + 
	`log
(
SQRT2PI
 * 
$summ”
 / 
$x
));

481 
	}
}

492 
´iv©e
 
funùiÚ
 
	$šv”£Ncdf
(
$p
)

507 
$a
 = 
	`¬¿y
(

516 
$b
 = 
	`¬¿y
(

524 
$c
 = 
	`¬¿y
(

533 
$d
 = 
	`¬¿y
(

541 
$p_low
 = 0.02425;

542 
$p_high
 = 1 - 
$p_low
;

544 ià(0 < 
$p
 && $°< 
$p_low
) {

546 
$q
 = 
	`sq¹
(-2 * 
	`log
(
$p
));

547  (((((
$c
[1] * 
$q
 + $c[2]) * $q + $c[3]) * $q + $c[4]) * $q + $c[5]) * $q + $c[6]) /

548 ((((
$d
[1] * 
$q
 + $d[2]) * $q + $d[3]) * $q + $d[4]) * $q + 1);

549 } 
	`–£if
 (
$p_low
 <ğ
$p
 && $°<ğ
$p_high
) {

551 
$q
 = 
$p
 - 0.5;

552 
$r
 = 
$q
 * $q;

553  (((((
$a
[1] * 
$r
 + $a[2]è* $¸+ $a[3]è* $¸+ $a[4]è* $¸+ $a[5]è* $¸+ $a[6]è* 
$q
 /

554 (((((
$b
[1] * 
$r
 + $b[2]) * $r + $b[3]) * $r + $b[4]) * $r + $b[5]) * $r + 1);

555 } 
	`–£if
 (
$p_high
 < 
$p
 && $p < 1) {

557 
$q
 = 
	`sq¹
(-2 * 
	`log
(1 - 
$p
));

558  -(((((
$c
[1] * 
$q
 + $c[2]) * $q + $c[3]) * $q + $c[4]) * $q + $c[5]) * $q + $c[6]) /

559 ((((
$d
[1] * 
$q
 + $d[2]) * $q + $d[3]) * $q + $d[4]) * $q + 1);

562  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NULL
();

563 
	}
}

566 
´iv©e
 
funùiÚ
 
	$šv”£Ncdf2
(
$´ob
)

571 
$a1
 = 2.50662823884;

572 
$a2
 = -18.61500062529;

573 
$a3
 = 41.39119773534;

574 
$a4
 = -25.44106049637;

576 
$b1
 = -8.4735109309;

577 
$b2
 = 23.08336743743;

578 
$b3
 = -21.06224101826;

579 
$b4
 = 3.13082909833;

581 
$c1
 = 0.337475482272615;

582 
$c2
 = 0.976169019091719;

583 
$c3
 = 0.160797971491821;

584 
$c4
 = 2.76438810333863E-02;

585 
$c5
 = 3.8405729373609E-03;

586 
$c6
 = 3.951896511919E-04;

587 
$c7
 = 3.21767881768E-05;

588 
$c8
 = 2.888167364E-07;

589 
$c9
 = 3.960315187E-07;

591 
$y
 = 
$´ob
 - 0.5;

592 ià(
	`abs
(
$y
) < 0.42) {

593 
$z
 = (
$y
 * $y);

594 
$z
 = 
$y
 * (((
$a4
 * $z + 
$a3
è* $z + 
$a2
è* $z + 
$a1
è/ ((((
$b4
 * $z + 
$b3
è* $z + 
$b2
è* $z + 
$b1
) * $z + 1);

596 ià(
$y
 > 0) {

597 
$z
 = 
	`log
(-log(1 - 
$´ob
));

599 
$z
 = 
	`log
(-log(
$´ob
));

601 
$z
 = 
$c1
 + $z * (
$c2
 + $z * (
$c3
 + $z * (
$c4
 + $z * (
$c5
 + $z * (
$c6
 + $z * (
$c7
 + $z * (
$c8
 + $z * 
$c9
)))))));

602 ià(
$y
 < 0) {

603 
$z
 = -$z;

606  
$z
;

607 
	}
}

610 
´iv©e
 
funùiÚ
 
	$šv”£Ncdf3
(
$p
)

618 
$¥l™1
 = 0.425;

619 
$¥l™2
 = 5;

620 
$cÚ¡1
 = 0.180625;

621 
$cÚ¡2
 = 1.6;

624 
$a0
 = 3.3871328727963666080;

625 
$a1
 = 1.3314166789178437745E+2;

626 
$a2
 = 1.9715909503065514427E+3;

627 
$a3
 = 1.3731693765509461125E+4;

628 
$a4
 = 4.5921953931549871457E+4;

629 
$a5
 = 6.7265770927008700853E+4;

630 
$a6
 = 3.3430575583588128105E+4;

631 
$a7
 = 2.5090809287301226727E+3;

633 
$b1
 = 4.2313330701600911252E+1;

634 
$b2
 = 6.8718700749205790830E+2;

635 
$b3
 = 5.3941960214247511077E+3;

636 
$b4
 = 2.1213794301586595867E+4;

637 
$b5
 = 3.9307895800092710610E+4;

638 
$b6
 = 2.8729085735721942674E+4;

639 
$b7
 = 5.2264952788528545610E+3;

642 
$c0
 = 1.42343711074968357734;

643 
$c1
 = 4.63033784615654529590;

644 
$c2
 = 5.76949722146069140550;

645 
$c3
 = 3.64784832476320460504;

646 
$c4
 = 1.27045825245236838258;

647 
$c5
 = 2.41780725177450611770E-1;

648 
$c6
 = 2.27238449892691845833E-2;

649 
$c7
 = 7.74545014278341407640E-4;

651 
$d1
 = 2.05319162663775882187;

652 
$d2
 = 1.67638483018380384940;

653 
$d3
 = 6.89767334985100004550E-1;

654 
$d4
 = 1.48103976427480074590E-1;

655 
$d5
 = 1.51986665636164571966E-2;

656 
$d6
 = 5.47593808499534494600E-4;

657 
$d7
 = 1.05075007164441684324E-9;

660 
$e0
 = 6.65790464350110377720;

661 
$e1
 = 5.46378491116411436990;

662 
$e2
 = 1.78482653991729133580;

663 
$e3
 = 2.96560571828504891230E-1;

664 
$e4
 = 2.65321895265761230930E-2;

665 
$e5
 = 1.24266094738807843860E-3;

666 
$e6
 = 2.71155556874348757815E-5;

667 
$e7
 = 2.01033439929228813265E-7;

669 
$f1
 = 5.99832206555887937690E-1;

670 
$f2
 = 1.36929880922735805310E-1;

671 
$f3
 = 1.48753612908506148525E-2;

672 
$f4
 = 7.86869131145613259100E-4;

673 
$f5
 = 1.84631831751005468180E-5;

674 
$f6
 = 1.42151175831644588870E-7;

675 
$f7
 = 2.04426310338993978564E-15;

677 
$q
 = 
$p
 - 0.5;

680 ià(
	`abs
(
$q
è<ğ
¥l™1
) {

681 
$R
 = 
$cÚ¡1
 - 
$q
 * $q;

682 
$z
 = 
$q
 * (((((((
$a7
 * 
$R
 + 
$a6
è* $R + 
$a5
è* $R + 
$a4
è* $R + 
$a3
è* $R + 
$a2
è* $R + 
$a1
è* $R + 
$a0
) /

683 (((((((
$b7
 * 
$R
 + 
$b6
è* $R + 
$b5
è* $R + 
$b4
è* $R + 
$b3
è* $R + 
$b2
è* $R + 
$b1
) * $R + 1);

685 ià(
$q
 < 0) {

686 
$R
 = 
$p
;

688 
$R
 = 1 - 
$p
;

690 
$R
 = 
	`pow
(-
	`log
($R), 2);

693 ià(
$R
 <ğ
$¥l™2
) {

694 
$R
 = $R - 
$cÚ¡2
;

695 
$z
 = (((((((
$c7
 * 
$R
 + 
$c6
è* $R + 
$c5
è* $R + 
$c4
è* $R + 
$c3
è* $R + 
$c2
è* $R + 
$c1
è* $R + 
$c0
) /

696 (((((((
$d7
 * 
$R
 + 
$d6
è* $R + 
$d5
è* $R + 
$d4
è* $R + 
$d3
è* $R + 
$d2
è* $R + 
$d1
) * $R + 1);

699 
$R
 = $R - 
$¥l™2
;

700 
$z
 = (((((((
$e7
 * 
$R
 + 
$e6
è* $R + 
$e5
è* $R + 
$e4
è* $R + 
$e3
è* $R + 
$e2
è* $R + 
$e1
è* $R + 
$e0
) /

701 (((((((
$f7
 * 
$R
 + 
$f6
è* $R + 
$f5
è* $R + 
$f4
è* $R + 
$f3
è* $R + 
$f2
è* $R + 
$f1
) * $R + 1);

703 ià(
$q
 < 0) {

704 
$z
 = -$z;

707  
$z
;

708 
	}
}

725 
public
 
funùiÚ
 
	$AVEDEV
()

727 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

730 
$»tuºV®ue
 = 
nuÎ
;

732 
$aM—n
 = 
£lf
::
	`AVERAGE
(
$aArgs
);

733 ià(
$aM—n
 !ğ
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
()) {

734 
$aCouÁ
 = 0;

735 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

736 ià((
	`is_boŞ
(
$¬g
)) &&

737 ((!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isC–lV®ue
(
$k
)è|| (PHPExûl_C®cuÏtiÚ_FunùiÚs::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
))) {

738 
$¬g
 = (
š‹g”
) $arg;

741 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

742 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

743 
$»tuºV®ue
 = 
	`abs
(
$¬g
 - 
$aM—n
);

745 
$»tuºV®ue
 +ğ
	`abs
(
$¬g
 - 
$aM—n
);

747 ++
$aCouÁ
;

752 ià(
$aCouÁ
 == 0) {

753  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

755  
$»tuºV®ue
 / 
$aCouÁ
;

757  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

758 
	}
}

774 
public
 
funùiÚ
 
	$AVERAGE
()

776 
$»tuºV®ue
 = 
$aCouÁ
 = 0;

779 
	`fÜ—ch
 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
()è
as
 
$k
 => 
$¬g
) {

780 ià((
	`is_boŞ
(
$¬g
)) &&

781 ((!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isC–lV®ue
(
$k
)è|| (PHPExûl_C®cuÏtiÚ_FunùiÚs::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
))) {

782 
$¬g
 = (
š‹g”
) $arg;

785 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

786 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

787 
$»tuºV®ue
 = 
$¬g
;

789 
$»tuºV®ue
 +ğ
$¬g
;

791 ++
$aCouÁ
;

796 ià(
$aCouÁ
 > 0) {

797  
$»tuºV®ue
 / 
$aCouÁ
;

799  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

801 
	}
}

817 
public
 
funùiÚ
 
	$AVERAGEA
()

819 
$»tuºV®ue
 = 
nuÎ
;

821 
$aCouÁ
 = 0;

823 
	`fÜ—ch
 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
()è
as
 
$k
 => 
$¬g
) {

824 ià((
	`is_boŞ
(
$¬g
)) &&

825 (!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isM©rixV®ue
(
$k
))) {

827 ià((
	`is_num”ic
(
$¬g
)è|| (
	`is_boŞ
($¬g)è|| ((
	`is_¡ršg
($arg) && ($arg != '')))) {

828 ià(
	`is_boŞ
(
$¬g
)) {

829 
$¬g
 = (
š‹g”
) $arg;

830 } 
	`–£if
 (
	`is_¡ršg
(
$¬g
)) {

831 
$¬g
 = 0;

833 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

834 
$»tuºV®ue
 = 
$¬g
;

836 
$»tuºV®ue
 +ğ
$¬g
;

838 ++
$aCouÁ
;

843 ià(
$aCouÁ
 > 0) {

844  
$»tuºV®ue
 / 
$aCouÁ
;

846  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

848 
	}
}

866 
public
 
funùiÚ
 
AVERAGEIF
(
$aArgs
, 
$cÚd™iÚ
, 
$av”ageArgs
 = 
	$¬¿y
())

868 
$»tuºV®ue
 = 0;

870 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($aArgs);

871 
$av”ageArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($averageArgs);

872 ià(
	`em±y
(
$av”ageArgs
)) {

873 
$av”ageArgs
 = 
$aArgs
;

875 
$cÚd™iÚ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`ifCÚd™iÚ
($condition);

877 
$aCouÁ
 = 0;

878 
	`fÜ—ch
 (
$aArgs
 
as
 
$key
 => 
$¬g
) {

879 ià(!
	`is_num”ic
(
$¬g
)) {

880 
$¬g
 = 
PHPExûl_C®cuÏtiÚ
::
	`w¿pResuÉ
(
	`¡¹ouµ”
($arg));

882 
$‹¡CÚd™iÚ
 = '='.
$¬g
.
$cÚd™iÚ
;

883 ià(
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`_ÿlcuÏ‹FÜmuÏV®ue
(
$‹¡CÚd™iÚ
)) {

884 ià((
	`is_nuÎ
(
$»tuºV®ue
)è|| (
$¬g
 > $returnValue)) {

885 
$»tuºV®ue
 +ğ
$¬g
;

886 ++
$aCouÁ
;

891 ià(
$aCouÁ
 > 0) {

892  
$»tuºV®ue
 / 
$aCouÁ
;

894  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

895 
	}
}

910 
public
 
funùiÚ
 
	$BETADIST
(
$v®ue
, 
$®pha
, 
$b‘a
, 
$rMš
 = 0, 
$rMax
 = 1)

912 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

913 
$®pha
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($alpha);

914 
$b‘a
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($beta);

915 
$rMš
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rMin);

916 
$rMax
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rMax);

918 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$®pha
)è&& (is_num”ic(
$b‘a
)è&& (is_num”ic(
$rMš
)è&& (is_num”ic(
$rMax
))) {

919 ià((
$v®ue
 < 
$rMš
è|| ($v®u> 
$rMax
è|| (
$®pha
 <ğ0è|| (
$b‘a
 <= 0) || ($rMin == $rMax)) {

920  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

922 ià(
$rMš
 > 
$rMax
) {

923 
$tmp
 = 
$rMš
;

924 
$rMš
 = 
$rMax
;

925 
$rMax
 = 
$tmp
;

927 
$v®ue
 -ğ
$rMš
;

928 
$v®ue
 /ğ(
$rMax
 - 
$rMš
);

929  
£lf
::
	`šcom¶‘eB‘a
(
$v®ue
, 
$®pha
, 
$b‘a
);

931  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

932 
	}
}

949 
public
 
funùiÚ
 
	$BETAINV
(
$´obab™y
, 
$®pha
, 
$b‘a
, 
$rMš
 = 0, 
$rMax
 = 1)

951 
$´obab™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($probability);

952 
$®pha
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($alpha);

953 
$b‘a
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($beta);

954 
$rMš
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rMin);

955 
$rMax
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($rMax);

957 ià((
	`is_num”ic
(
$´obab™y
)è&& (is_num”ic(
$®pha
)è&& (is_num”ic(
$b‘a
)è&& (is_num”ic(
$rMš
)è&& (is_num”ic(
$rMax
))) {

958 ià((
$®pha
 <ğ0è|| (
$b‘a
 <ğ0è|| (
$rMš
 =ğ
$rMax
è|| (
$´obab™y
 <= 0) || ($probability > 1)) {

959  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

961 ià(
$rMš
 > 
$rMax
) {

962 
$tmp
 = 
$rMš
;

963 
$rMš
 = 
$rMax
;

964 
$rMax
 = 
$tmp
;

966 
$a
 = 0;

967 
$b
 = 2;

969 
$i
 = 0;

970 ((
$b
 - 
$a
è> 
PRECISION
è&& (
$i
++ < 
MAX_ITERATIONS
)) {

971 
$guess
 = (
$a
 + 
$b
) / 2;

972 
$»suÉ
 = 
£lf
::
	`BETADIST
(
$guess
, 
$®pha
, 
$b‘a
);

973 ià((
$»suÉ
 =ğ
$´obab™y
) || ($result == 0)) {

974 
$b
 = 
$a
;

975 } 
	`–£if
 (
$»suÉ
 > 
$´obab™y
) {

976 
$b
 = 
$guess
;

978 
$a
 = 
$guess
;

981 ià(
$i
 =ğ
MAX_ITERATIONS
) {

982  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

984  
	`round
(
$rMš
 + 
$guess
 * (
$rMax
 - $rMin), 12);

986  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

987 
	}
}

1008 
public
 
funùiÚ
 
	$BINOMDIST
(
$v®ue
, 
$ŒŸls
, 
$´obab™y
, 
$cumuÏtive
)

1010 
$v®ue
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value));

1011 
$ŒŸls
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($trials));

1012 
$´obab™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($probability);

1014 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$ŒŸls
)è&& (is_num”ic(
$´obab™y
))) {

1015 ià((
$v®ue
 < 0è|| ($v®u> 
$ŒŸls
)) {

1016  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1018 ià((
$´obab™y
 < 0) || ($probability > 1)) {

1019  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1021 ià((
	`is_num”ic
(
$cumuÏtive
)è|| (
	`is_boŞ
($cumulative))) {

1022 ià(
$cumuÏtive
) {

1023 
$summ”
 = 0;

1024 
$i
 = 0; $˜<ğ
$v®ue
; ++$i) {

1025 
$summ”
 +ğ
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`COMBIN
(
$ŒŸls
, 
$i
è* 
	`pow
(
$´obab™y
, $i) *…ow(1 - $probability, $trials - $i);

1027  
$summ”
;

1029  
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`COMBIN
(
$ŒŸls
, 
$v®ue
è* 
	`pow
(
$´obab™y
, $value) *…ow(1 - $probability, $trials - $value) ;

1033  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1034 
	}
}

1046 
public
 
funùiÚ
 
	$CHIDIST
(
$v®ue
, 
$deg»es
)

1048 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

1049 
$deg»es
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($degrees));

1051 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$deg»es
))) {

1052 ià(
$deg»es
 < 1) {

1053  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1055 ià(
$v®ue
 < 0) {

1056 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

1059  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1061  1 - (
£lf
::
	`šcom¶‘eGamma
(
$deg»es
/2, 
$v®ue
/2è/ s–f::
	`gamma
($degrees/2));

1063  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1064 
	}
}

1076 
public
 
funùiÚ
 
	$CHIINV
(
$´obab™y
, 
$deg»es
)

1078 
$´obab™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($probability);

1079 
$deg»es
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($degrees));

1081 ià((
	`is_num”ic
(
$´obab™y
)è&& (is_num”ic(
$deg»es
))) {

1082 
$xLo
 = 100;

1083 
$xHi
 = 0;

1085 
$x
 = 
$xNew
 = 1;

1086 
$dx
 = 1;

1087 
$i
 = 0;

1089 (
	`abs
(
$dx
è> 
PRECISION
è&& (
$i
++ < 
MAX_ITERATIONS
)) {

1091 
$»suÉ
 = 
£lf
::
	`CHIDIST
(
$x
, 
$deg»es
);

1092 
$”rÜ
 = 
$»suÉ
 - 
$´obab™y
;

1093 ià(
$”rÜ
 == 0.0) {

1094 
$dx
 = 0;

1095 } 
	`–£if
 (
$”rÜ
 < 0.0) {

1096 
$xLo
 = 
$x
;

1098 
$xHi
 = 
$x
;

1101 ià(
$»suÉ
 != 0.0) {

1102 
$dx
 = 
$”rÜ
 / 
$»suÉ
;

1103 
$xNew
 = 
$x
 - 
$dx
;

1108 ià((
$xNew
 < 
$xLo
è|| ($xNew > 
$xHi
è|| (
$»suÉ
 == 0.0)) {

1109 
$xNew
 = (
$xLo
 + 
$xHi
) / 2;

1110 
$dx
 = 
$xNew
 - 
$x
;

1112 
$x
 = 
$xNew
;

1114 ià(
$i
 =ğ
MAX_ITERATIONS
) {

1115  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

1117  
	`round
(
$x
, 12);

1119  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1120 
	}
}

1134 
public
 
funùiÚ
 
	$CONFIDENCE
(
$®pha
, 
$¡dDev
, 
$size
)

1136 
$®pha
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($alpha);

1137 
$¡dDev
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($stdDev);

1138 
$size
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($size));

1140 ià((
	`is_num”ic
(
$®pha
)è&& (is_num”ic(
$¡dDev
)è&& (is_num”ic(
$size
))) {

1141 ià((
$®pha
 <= 0) || ($alpha >= 1)) {

1142  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1144 ià((
$¡dDev
 <ğ0è|| (
$size
 < 1)) {

1145  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1147  
£lf
::
	`NORMSINV
(1 - 
$®pha
 / 2è* 
$¡dDev
 / 
	`sq¹
(
$size
);

1149  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1150 
	}
}

1162 
public
 
funùiÚ
 
	$CORREL
(
$yV®ues
, 
$xV®ues
 = 
nuÎ
)

1164 ià((
	`is_nuÎ
(
$xV®ues
)è|| (!
	`is_¬¿y
(
$yV®ues
)) || (!is_array($xValues))) {

1165  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1167 ià(!
£lf
::
	`checkT»ndA¼ays
(
$yV®ues
, 
$xV®ues
)) {

1168  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1170 
$yV®ueCouÁ
 = 
	`couÁ
(
$yV®ues
);

1171 
$xV®ueCouÁ
 = 
	`couÁ
(
$xV®ues
);

1173 ià((
$yV®ueCouÁ
 =ğ0è|| ($yV®ueCouÁ !ğ
$xV®ueCouÁ
)) {

1174  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

1175 } 
	`–£if
 (
$yV®ueCouÁ
 == 1) {

1176  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

1179 
$be¡F™Lš—r
 = 
Œ’dCÏss
::
	`ÿlcuÏ‹
Ñ»ndCÏss::
TREND_LINEAR
, 
$yV®ues
, 
$xV®ues
);

1180  
$be¡F™Lš—r
->
	`g‘CÜ»ÏtiÚ
();

1181 
	}
}

1197 
public
 
funùiÚ
 
	$COUNT
()

1199 
$»tuºV®ue
 = 0;

1202 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

1203 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

1204 ià((
	`is_boŞ
(
$¬g
)) &&

1205 ((!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isC–lV®ue
(
$k
)è|| (PHPExûl_C®cuÏtiÚ_FunùiÚs::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
))) {

1206 
$¬g
 = (
š‹g”
) $arg;

1209 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

1210 ++
$»tuºV®ue
;

1214  
$»tuºV®ue
;

1215 
	}
}

1231 
public
 
funùiÚ
 
	$COUNTA
()

1233 
$»tuºV®ue
 = 0;

1236 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

1237 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

1239 ià((
	`is_num”ic
(
$¬g
)è|| (
	`is_boŞ
($¬g)è|| ((
	`is_¡ršg
($arg) && ($arg != '')))) {

1240 ++
$»tuºV®ue
;

1244  
$»tuºV®ue
;

1245 
	}
}

1261 
public
 
funùiÚ
 
	$COUNTBLANK
()

1263 
$»tuºV®ue
 = 0;

1266 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

1267 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

1269 ià((
	`is_nuÎ
(
$¬g
)è|| ((
	`is_¡ršg
($arg)) && ($arg == ''))) {

1270 ++
$»tuºV®ue
;

1274  
$»tuºV®ue
;

1275 
	}
}

1292 
public
 
funùiÚ
 
	$COUNTIF
(
$aArgs
, 
$cÚd™iÚ
)

1294 
$»tuºV®ue
 = 0;

1296 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($aArgs);

1297 
$cÚd™iÚ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`ifCÚd™iÚ
($condition);

1299 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

1300 ià(!
	`is_num”ic
(
$¬g
)) {

1301 
$¬g
 = 
PHPExûl_C®cuÏtiÚ
::
	`w¿pResuÉ
(
	`¡¹ouµ”
($arg));

1303 
$‹¡CÚd™iÚ
 = '='.
$¬g
.
$cÚd™iÚ
;

1304 ià(
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`_ÿlcuÏ‹FÜmuÏV®ue
(
$‹¡CÚd™iÚ
)) {

1306 ++
$»tuºV®ue
;

1310  
$»tuºV®ue
;

1311 
	}
}

1323 
public
 
funùiÚ
 
	$COVAR
(
$yV®ues
, 
$xV®ues
)

1325 ià(!
£lf
::
	`checkT»ndA¼ays
(
$yV®ues
, 
$xV®ues
)) {

1326  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1328 
$yV®ueCouÁ
 = 
	`couÁ
(
$yV®ues
);

1329 
$xV®ueCouÁ
 = 
	`couÁ
(
$xV®ues
);

1331 ià((
$yV®ueCouÁ
 =ğ0è|| ($yV®ueCouÁ !ğ
$xV®ueCouÁ
)) {

1332  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

1333 } 
	`–£if
 (
$yV®ueCouÁ
 == 1) {

1334  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

1337 
$be¡F™Lš—r
 = 
Œ’dCÏss
::
	`ÿlcuÏ‹
Ñ»ndCÏss::
TREND_LINEAR
, 
$yV®ues
, 
$xV®ues
);

1338  
$be¡F™Lš—r
->
	`g‘Cov¬Ÿnû
();

1339 
	}
}

1361 
public
 
funùiÚ
 
	$CRITBINOM
(
$ŒŸls
, 
$´obab™y
, 
$®pha
)

1363 
$ŒŸls
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($trials));

1364 
$´obab™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($probability);

1365 
$®pha
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($alpha);

1367 ià((
	`is_num”ic
(
$ŒŸls
)è&& (is_num”ic(
$´obab™y
)è&& (is_num”ic(
$®pha
))) {

1368 ià(
$ŒŸls
 < 0) {

1369  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1370 } 
	`–£if
 ((
$´obab™y
 < 0) || ($probability > 1)) {

1371  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1372 } 
	`–£if
 ((
$®pha
 < 0) || ($alpha > 1)) {

1373  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1374 } 
	`–£if
 (
$®pha
 <= 0.5) {

1375 
$t
 = 
	`sq¹
(
	`log
(1 / (
$®pha
 * $alpha)));

1376 
$ŒŸlsAµrox
 = 0 - (
$t
 + (2.515517 + 0.802853 * $t + 0.010328 * $t * $t) / (1 + 1.432788 * $t + 0.189269 * $t * $t + 0.001308 * $t * $t * $t));

1378 
$t
 = 
	`sq¹
(
	`log
(1 / 
	`pow
(1 - 
$®pha
, 2)));

1379 
$ŒŸlsAµrox
 = 
$t
 - (2.515517 + 0.802853 * $t + 0.010328 * $t * $t) / (1 + 1.432788 * $t + 0.189269 * $t * $t + 0.001308 * $t * $t * $t);

1381 
$Guess
 = 
	`æoÜ
(
$ŒŸls
 * 
$´obab™y
 + 
$ŒŸlsAµrox
 * 
	`sq¹
($trials * $probability * (1 - $probability)));

1382 ià(
$Guess
 < 0) {

1383 
$Guess
 = 0;

1384 } 
	`–£if
 (
$Guess
 > 
$ŒŸls
) {

1385 
$Guess
 = 
$ŒŸls
;

1388 
$TÙ®UnsÿËdProbab™y
 = 
$UnsÿËdPGuess
 = 
$UnsÿËdCumPGuess
 = 0.0;

1389 
$Es£ÁŸÎyZ”o
 = 10e-12;

1391 
$m
 = 
	`æoÜ
(
$ŒŸls
 * 
$´obab™y
);

1392 ++
$TÙ®UnsÿËdProbab™y
;

1393 ià(
$m
 =ğ
$Guess
) {

1394 ++
$UnsÿËdPGuess
;

1396 ià(
$m
 <ğ
$Guess
) {

1397 ++
$UnsÿËdCumPGuess
;

1400 
$P»viousV®ue
 = 1;

1401 
$DÚe
 = 
çl£
;

1402 
$k
 = 
$m
 + 1;

1403 (!
$DÚe
è&& (
$k
 <ğ
$ŒŸls
)) {

1404 
$Cu¼’tV®ue
 = 
$P»viousV®ue
 * (
$ŒŸls
 - 
$k
 + 1è* 
$´obab™y
 / ($k * (1 - $probability));

1405 
$TÙ®UnsÿËdProbab™y
 +ğ
$Cu¼’tV®ue
;

1406 ià(
$k
 =ğ
$Guess
) {

1407 
$UnsÿËdPGuess
 +ğ
$Cu¼’tV®ue
;

1409 ià(
$k
 <ğ
$Guess
) {

1410 
$UnsÿËdCumPGuess
 +ğ
$Cu¼’tV®ue
;

1412 ià(
$Cu¼’tV®ue
 <ğ
$Es£ÁŸÎyZ”o
) {

1413 
$DÚe
 = 
Œue
;

1415 
$P»viousV®ue
 = 
$Cu¼’tV®ue
;

1416 ++
$k
;

1419 
$P»viousV®ue
 = 1;

1420 
$DÚe
 = 
çl£
;

1421 
$k
 = 
$m
 - 1;

1422 (!
$DÚe
è&& (
$k
 >= 0)) {

1423 
$Cu¼’tV®ue
 = 
$P»viousV®ue
 * 
$k
 + 1 * (1 - 
$´obab™y
è/ ((
$ŒŸls
 - $k) * $probability);

1424 
$TÙ®UnsÿËdProbab™y
 +ğ
$Cu¼’tV®ue
;

1425 ià(
$k
 =ğ
$Guess
) {

1426 
$UnsÿËdPGuess
 +ğ
$Cu¼’tV®ue
;

1428 ià(
$k
 <ğ
$Guess
) {

1429 
$UnsÿËdCumPGuess
 +ğ
$Cu¼’tV®ue
;

1431 ià(
$Cu¼’tV®ue
 <ğ
$Es£ÁŸÎyZ”o
) {

1432 
$DÚe
 = 
Œue
;

1434 
$P»viousV®ue
 = 
$Cu¼’tV®ue
;

1435 --
$k
;

1438 
$PGuess
 = 
$UnsÿËdPGuess
 / 
$TÙ®UnsÿËdProbab™y
;

1439 
$CumPGuess
 = 
$UnsÿËdCumPGuess
 / 
$TÙ®UnsÿËdProbab™y
;

1442 
$CumPGuessMšus1
 = 
$CumPGuess
 - 1;

1444 
Œue
) {

1445 ià((
$CumPGuessMšus1
 < 
$®pha
è&& (
$CumPGuess
 >= $alpha)) {

1446  
$Guess
;

1447 } 
	`–£if
 ((
$CumPGuessMšus1
 < 
$®pha
è&& (
$CumPGuess
 < $alpha)) {

1448 
$PGuessPlus1
 = 
$PGuess
 * (
$ŒŸls
 - 
$Guess
è* 
$´obab™y
 / $Guess / (1 - $probability);

1449 
$CumPGuessMšus1
 = 
$CumPGuess
;

1450 
$CumPGuess
 = $CumPGues + 
$PGuessPlus1
;

1451 
$PGuess
 = 
$PGuessPlus1
;

1452 ++
$Guess
;

1453 } 
	`–£if
 ((
$CumPGuessMšus1
 >ğ
$®pha
è&& (
$CumPGuess
 >= $alpha)) {

1454 
$PGuessMšus1
 = 
$PGuess
 * 
$Guess
 * (1 - 
$´obab™y
è/ (
$ŒŸls
 - $Guess + 1) / $probability;

1455 
$CumPGuess
 = 
$CumPGuessMšus1
;

1456 
$CumPGuessMšus1
 = $CumPGuessMšus1 - 
$PGuess
;

1457 
$PGuess
 = 
$PGuessMšus1
;

1458 --
$Guess
;

1462  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1463 
	}
}

1479 
public
 
funùiÚ
 
	$DEVSQ
()

1481 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

1484 
$»tuºV®ue
 = 
nuÎ
;

1486 
$aM—n
 = 
£lf
::
	`AVERAGE
(
$aArgs
);

1487 ià(
$aM—n
 !ğ
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
()) {

1488 
$aCouÁ
 = -1;

1489 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

1491 ià((
	`is_boŞ
(
$¬g
)) &&

1492 ((!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isC–lV®ue
(
$k
)) ||

1493 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
))) {

1494 
$¬g
 = (
š‹g”
) $arg;

1496 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

1497 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

1498 
$»tuºV®ue
 = 
	`pow
((
$¬g
 - 
$aM—n
), 2);

1500 
$»tuºV®ue
 +ğ
	`pow
((
$¬g
 - 
$aM—n
), 2);

1502 ++
$aCouÁ
;

1507 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

1508  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1510  
$»tuºV®ue
;

1513  
£lf
::
	`NA
();

1514 
	}
}

1529 
public
 
funùiÚ
 
	$EXPONDIST
(
$v®ue
, 
$Ïmbda
, 
$cumuÏtive
)

1531 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

1532 
$Ïmbda
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($lambda);

1533 
$cumuÏtive
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($cumulative);

1535 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$Ïmbda
))) {

1536 ià((
$v®ue
 < 0è|| (
$Ïmbda
 < 0)) {

1537  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1539 ià((
	`is_num”ic
(
$cumuÏtive
)è|| (
	`is_boŞ
($cumulative))) {

1540 ià(
$cumuÏtive
) {

1541  1 - 
	`exp
(0-
$v®ue
*
$Ïmbda
);

1543  
$Ïmbda
 * 
	`exp
(0-
$v®ue
*$lambda);

1547  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1548 
	}
}

1561 
public
 
funùiÚ
 
	$FISHER
(
$v®ue
)

1563 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

1565 ià(
	`is_num”ic
(
$v®ue
)) {

1566 ià((
$v®ue
 <= -1) || ($value >= 1)) {

1567  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1569  0.5 * 
	`log
((1+
$v®ue
)/(1-$value));

1571  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1572 
	}
}

1585 
public
 
funùiÚ
 
	$FISHERINV
(
$v®ue
)

1587 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

1589 ià(
	`is_num”ic
(
$v®ue
)) {

1590  (
	`exp
(2 * 
$v®ue
) - 1) / (exp(2 * $value) + 1);

1592  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1593 
	}
}

1606 
public
 
funùiÚ
 
	$FORECAST
(
$xV®ue
, 
$yV®ues
, 
$xV®ues
)

1608 
$xV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($xValue);

1609 ià(!
	`is_num”ic
(
$xV®ue
)) {

1610  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1611 } 
	`–£if
 (!
£lf
::
	`checkT»ndA¼ays
(
$yV®ues
, 
$xV®ues
)) {

1612  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1614 
$yV®ueCouÁ
 = 
	`couÁ
(
$yV®ues
);

1615 
$xV®ueCouÁ
 = 
	`couÁ
(
$xV®ues
);

1617 ià((
$yV®ueCouÁ
 =ğ0è|| ($yV®ueCouÁ !ğ
$xV®ueCouÁ
)) {

1618  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

1619 } 
	`–£if
 (
$yV®ueCouÁ
 == 1) {

1620  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

1623 
$be¡F™Lš—r
 = 
Œ’dCÏss
::
	`ÿlcuÏ‹
Ñ»ndCÏss::
TREND_LINEAR
, 
$yV®ues
, 
$xV®ues
);

1624  
$be¡F™Lš—r
->
	`g‘V®ueOfYFÜX
(
$xV®ue
);

1625 
	}
}

1640 
public
 
funùiÚ
 
	$GAMMADIST
(
$v®ue
, 
$a
, 
$b
, 
$cumuÏtive
)

1642 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

1643 
$a
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($a);

1644 
$b
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($b);

1646 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$a
)è&& (is_num”ic(
$b
))) {

1647 ià((
$v®ue
 < 0è|| (
$a
 <ğ0è|| (
$b
 <= 0)) {

1648  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1650 ià((
	`is_num”ic
(
$cumuÏtive
)è|| (
	`is_boŞ
($cumulative))) {

1651 ià(
$cumuÏtive
) {

1652  
£lf
::
	`šcom¶‘eGamma
(
$a
, 
$v®ue
 / 
$b
è/ s–f::
	`gamma
($a);

1654  (1 / (
	`pow
(
$b
, 
$a
è* 
£lf
::
	`gamma
($a))è*…ow(
$v®ue
, $a-1è* 
	`exp
(0-($value / $b));

1658  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1659 
	}
}

1673 
public
 
funùiÚ
 
	$GAMMAINV
(
$´obab™y
, 
$®pha
, 
$b‘a
)

1675 
$´obab™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($probability);

1676 
$®pha
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($alpha);

1677 
$b‘a
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($beta);

1679 ià((
	`is_num”ic
(
$´obab™y
)è&& (is_num”ic(
$®pha
)è&& (is_num”ic(
$b‘a
))) {

1680 ià((
$®pha
 <ğ0è|| (
$b‘a
 <ğ0è|| (
$´obab™y
 < 0) || ($probability > 1)) {

1681  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1684 
$xLo
 = 0;

1685 
$xHi
 = 
$®pha
 * 
$b‘a
 * 5;

1687 
$x
 = 
$xNew
 = 1;

1688 
$”rÜ
 = 
$pdf
 = 0;

1689 
$dx
 = 1024;

1690 
$i
 = 0;

1692 (
	`abs
(
$dx
è> 
PRECISION
è&& (
$i
++ < 
MAX_ITERATIONS
)) {

1694 
$”rÜ
 = 
£lf
::
	`GAMMADIST
(
$x
, 
$®pha
, 
$b‘a
, 
Œue
è- 
$´obab™y
;

1695 ià(
$”rÜ
 < 0.0) {

1696 
$xLo
 = 
$x
;

1698 
$xHi
 = 
$x
;

1700 
$pdf
 = 
£lf
::
	`GAMMADIST
(
$x
, 
$®pha
, 
$b‘a
, 
çl£
);

1702 ià(
$pdf
 != 0.0) {

1703 
$dx
 = 
$”rÜ
 / 
$pdf
;

1704 
$xNew
 = 
$x
 - 
$dx
;

1709 ià((
$xNew
 < 
$xLo
è|| ($xNew > 
$xHi
è|| (
$pdf
 == 0.0)) {

1710 
$xNew
 = (
$xLo
 + 
$xHi
) / 2;

1711 
$dx
 = 
$xNew
 - 
$x
;

1713 
$x
 = 
$xNew
;

1715 ià(
$i
 =ğ
MAX_ITERATIONS
) {

1716  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

1718  
$x
;

1720  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1721 
	}
}

1732 
public
 
funùiÚ
 
	$GAMMALN
(
$v®ue
)

1734 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

1736 ià(
	`is_num”ic
(
$v®ue
)) {

1737 ià(
$v®ue
 <= 0) {

1738  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1740  
	`log
(
£lf
::
	`gamma
(
$v®ue
));

1742  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1743 
	}
}

1761 
public
 
funùiÚ
 
	$GEOMEAN
()

1763 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

1765 
$aM—n
 = 
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`PRODUCT
(
$aArgs
);

1766 ià(
	`is_num”ic
(
$aM—n
) && ($aMean > 0)) {

1767 
$aCouÁ
 = 
£lf
::
	`COUNT
(
$aArgs
) ;

1768 ià(
£lf
::
	`MIN
(
$aArgs
) > 0) {

1769  
	`pow
(
$aM—n
, (1 / 
$aCouÁ
));

1772  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1773 
	}
}

1787 
public
 
funùiÚ
 
GROWTH
(
$yV®ues
, 
$xV®ues
 = 
¬¿y
(), 
$ÃwV®ues
 =‡¼ay(), 
$cÚ¡
 = 
Œue
)

1789 
$yV®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nA¼ay
($yValues);

1790 
	g$xV®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nA¼ay
(
$xV®ues
);

1791 
	g$ÃwV®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nA¼ay
(
$ÃwV®ues
);

1792 
	g$cÚ¡
 = (
is_nuÎ
(
$cÚ¡
)è? 
Œue
 : (
boŞ—n
è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($const);

1794 
	g$be¡F™ExpÚ’tŸl
 = 
Œ’dCÏss
::
ÿlcuÏ‹
Ñ»ndCÏss::
TREND_EXPONENTIAL
, 
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

1795 ià(
em±y
(
$ÃwV®ues
)) {

1796 
	g$ÃwV®ues
 = 
$be¡F™ExpÚ’tŸl
->
g‘XV®ues
();

1799 
	g$»tuºA¼ay
 = 
¬¿y
();

1800 
fÜ—ch
 (
$ÃwV®ues
 
as
 
$xV®ue
) {

1801 
	g$»tuºA¼ay
[0][] = 
$be¡F™ExpÚ’tŸl
->
g‘V®ueOfYFÜX
(
$xV®ue
);

1804  
	g$»tuºA¼ay
;

1822 
public
 
funùiÚ
 
	$HARMEAN
()

1825 
$»tuºV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

1828 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

1829 ià(
£lf
::
	`MIN
(
$aArgs
) < 0) {

1830  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1832 
$aCouÁ
 = 0;

1833 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

1835 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

1836 ià(
$¬g
 <= 0) {

1837  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1839 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

1840 
$»tuºV®ue
 = (1 / 
$¬g
);

1842 
$»tuºV®ue
 +ğ(1 / 
$¬g
);

1844 ++
$aCouÁ
;

1849 ià(
$aCouÁ
 > 0) {

1850  1 / (
$»tuºV®ue
 / 
$aCouÁ
);

1852  
$»tuºV®ue
;

1854 
	}
}

1870 
public
 
funùiÚ
 
	$HYPGEOMDIST
(
$§m¶eSucûs£s
, 
$§m¶eNumb”
, 
$pİuÏtiÚSucûs£s
, 
$pİuÏtiÚNumb”
)

1872 
$§m¶eSucûs£s
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($sampleSuccesses));

1873 
$§m¶eNumb”
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($sampleNumber));

1874 
$pİuÏtiÚSucûs£s
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($populationSuccesses));

1875 
$pİuÏtiÚNumb”
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($populationNumber));

1877 ià((
	`is_num”ic
(
$§m¶eSucûs£s
)è&& (is_num”ic(
$§m¶eNumb”
)è&& (is_num”ic(
$pİuÏtiÚSucûs£s
)è&& (is_num”ic(
$pİuÏtiÚNumb”
))) {

1878 ià((
$§m¶eSucûs£s
 < 0è|| ($§m¶eSucûs£ > 
$§m¶eNumb”
è|| ($§m¶eSucûs£ > 
$pİuÏtiÚSucûs£s
)) {

1879  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1881 ià((
$§m¶eNumb”
 <ğ0è|| ($§m¶eNumb” > 
$pİuÏtiÚNumb”
)) {

1882  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1884 ià((
$pİuÏtiÚSucûs£s
 <ğ0è|| ($pİuÏtiÚSucûs£ > 
$pİuÏtiÚNumb”
)) {

1885  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1887  
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`COMBIN
(
$pİuÏtiÚSucûs£s
, 
$§m¶eSucûs£s
) *

1888 
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`COMBIN
(
$pİuÏtiÚNumb”
 - 
$pİuÏtiÚSucûs£s
, 
$§m¶eNumb”
 - 
$§m¶eSucûs£s
) /

1889 
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`COMBIN
(
$pİuÏtiÚNumb”
, 
$§m¶eNumb”
);

1891  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1892 
	}
}

1904 
public
 
funùiÚ
 
	$INTERCEPT
(
$yV®ues
, 
$xV®ues
)

1906 ià(!
£lf
::
	`checkT»ndA¼ays
(
$yV®ues
, 
$xV®ues
)) {

1907  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

1909 
$yV®ueCouÁ
 = 
	`couÁ
(
$yV®ues
);

1910 
$xV®ueCouÁ
 = 
	`couÁ
(
$xV®ues
);

1912 ià((
$yV®ueCouÁ
 =ğ0è|| ($yV®ueCouÁ !ğ
$xV®ueCouÁ
)) {

1913  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

1914 } 
	`–£if
 (
$yV®ueCouÁ
 == 1) {

1915  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

1918 
$be¡F™Lš—r
 = 
Œ’dCÏss
::
	`ÿlcuÏ‹
Ñ»ndCÏss::
TREND_LINEAR
, 
$yV®ues
, 
$xV®ues
);

1919  
$be¡F™Lš—r
->
	`g‘IÁ”£ù
();

1920 
	}
}

1934 
public
 
funùiÚ
 
	$KURT
()

1936 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

1937 
$m—n
 = 
£lf
::
	`AVERAGE
(
$aArgs
);

1938 
$¡dDev
 = 
£lf
::
	`STDEV
(
$aArgs
);

1940 ià(
$¡dDev
 > 0) {

1941 
$couÁ
 = 
$summ”
 = 0;

1943 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

1944 ià((
	`is_boŞ
(
$¬g
)) &&

1945 (!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isM©rixV®ue
(
$k
))) {

1948 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

1949 
$summ”
 +ğ
	`pow
(((
$¬g
 - 
$m—n
è/ 
$¡dDev
), 4);

1950 ++
$couÁ
;

1956 ià(
$couÁ
 > 3) {

1957  
$summ”
 * (
$couÁ
 * ($couÁ+1è/ (($couÁ-1è* ($couÁ-2è* ($couÁ-3))è- (3 * 
	`pow
($count-1, 2) / (($count-2) * ($count-3)));

1960  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

1961 
	}
}

1980 
public
 
funùiÚ
 
	$LARGE
()

1982 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

1985 
$’Œy
 = 
	`æoÜ
(
	`¬¿y_pİ
(
$aArgs
));

1987 ià((
	`is_num”ic
(
$’Œy
)è&& (!
	`is_¡ršg
($entry))) {

1988 
$mArgs
 = 
	`¬¿y
();

1989 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

1991 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

1992 
$mArgs
[] = 
$¬g
;

1995 
$couÁ
 = 
£lf
::
	`COUNT
(
$mArgs
);

1996 
$’Œy
 = 
	`æoÜ
(--$entry);

1997 ià((
$’Œy
 < 0è|| ($’Œy >ğ
$couÁ
) || ($count == 0)) {

1998  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2000 
	`rsÜt
(
$mArgs
);

2001  
$mArgs
[
$’Œy
];

2003  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2004 
	}
}

2019 
public
 
funùiÚ
 
	$LINEST
(
$yV®ues
, 
$xV®ues
 = 
nuÎ
, 
$cÚ¡
 = 
Œue
, 
$¡©s
 = 
çl£
)

2021 
$cÚ¡
 = (
	`is_nuÎ
($cÚ¡)è? 
Œue
 : (
boŞ—n
è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($const);

2022 
$¡©s
 = (
	`is_nuÎ
($¡©s)è? 
çl£
 : (
boŞ—n
è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($stats);

2023 ià(
	`is_nuÎ
(
$xV®ues
)) {

2024 
$xV®ues
 = 
	`¿nge
(1, 
	`couÁ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$yV®ues
)));

2027 ià(!
£lf
::
	`checkT»ndA¼ays
(
$yV®ues
, 
$xV®ues
)) {

2028  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2030 
$yV®ueCouÁ
 = 
	`couÁ
(
$yV®ues
);

2031 
$xV®ueCouÁ
 = 
	`couÁ
(
$xV®ues
);

2034 ià((
$yV®ueCouÁ
 =ğ0è|| ($yV®ueCouÁ !ğ
$xV®ueCouÁ
)) {

2035  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2036 } 
	`–£if
 (
$yV®ueCouÁ
 == 1) {

2040 
$be¡F™Lš—r
 = 
Œ’dCÏss
::
	`ÿlcuÏ‹
Ñ»ndCÏss::
TREND_LINEAR
, 
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

2041 ià(
$¡©s
) {

2042  
	`¬¿y
(

2043 
	`¬¿y
(

2044 
$be¡F™Lš—r
->
	`g‘Slİe
(),

2045 
$be¡F™Lš—r
->
	`g‘SlİeSE
(),

2046 
$be¡F™Lš—r
->
	`g‘GoodÃssOfF™
(),

2047 
$be¡F™Lš—r
->
	`g‘F
(),

2048 
$be¡F™Lš—r
->
	`g‘SSReg»ssiÚ
(),

2050 
	`¬¿y
(

2051 
$be¡F™Lš—r
->
	`g‘IÁ”£ù
(),

2052 
$be¡F™Lš—r
->
	`g‘IÁ”£ùSE
(),

2053 
$be¡F™Lš—r
->
	`g‘StdevOfResidu®s
(),

2054 
$be¡F™Lš—r
->
	`g‘DFResidu®s
(),

2055 
$be¡F™Lš—r
->
	`g‘SSResidu®s
()

2059  
	`¬¿y
(

2060 
$be¡F™Lš—r
->
	`g‘Slİe
(),

2061 
$be¡F™Lš—r
->
	`g‘IÁ”£ù
()

2064 
	}
}

2079 
public
 
funùiÚ
 
	$LOGEST
(
$yV®ues
, 
$xV®ues
 = 
nuÎ
, 
$cÚ¡
 = 
Œue
, 
$¡©s
 = 
çl£
)

2081 
$cÚ¡
 = (
	`is_nuÎ
($cÚ¡)è? 
Œue
 : (
boŞ—n
è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($const);

2082 
$¡©s
 = (
	`is_nuÎ
($¡©s)è? 
çl£
 : (
boŞ—n
è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($stats);

2083 ià(
	`is_nuÎ
(
$xV®ues
)) {

2084 
$xV®ues
 = 
	`¿nge
(1, 
	`couÁ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$yV®ues
)));

2087 ià(!
£lf
::
	`checkT»ndA¼ays
(
$yV®ues
, 
$xV®ues
)) {

2088  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2090 
$yV®ueCouÁ
 = 
	`couÁ
(
$yV®ues
);

2091 
$xV®ueCouÁ
 = 
	`couÁ
(
$xV®ues
);

2093 
	`fÜ—ch
 (
$yV®ues
 
as
 
$v®ue
) {

2094 ià(
$v®ue
 <= 0.0) {

2095  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2100 ià((
$yV®ueCouÁ
 =ğ0è|| ($yV®ueCouÁ !ğ
$xV®ueCouÁ
)) {

2101  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2102 } 
	`–£if
 (
$yV®ueCouÁ
 == 1) {

2106 
$be¡F™ExpÚ’tŸl
 = 
Œ’dCÏss
::
	`ÿlcuÏ‹
Ñ»ndCÏss::
TREND_EXPONENTIAL
, 
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

2107 ià(
$¡©s
) {

2108  
	`¬¿y
(

2109 
	`¬¿y
(

2110 
$be¡F™ExpÚ’tŸl
->
	`g‘Slİe
(),

2111 
$be¡F™ExpÚ’tŸl
->
	`g‘SlİeSE
(),

2112 
$be¡F™ExpÚ’tŸl
->
	`g‘GoodÃssOfF™
(),

2113 
$be¡F™ExpÚ’tŸl
->
	`g‘F
(),

2114 
$be¡F™ExpÚ’tŸl
->
	`g‘SSReg»ssiÚ
(),

2116 
	`¬¿y
(

2117 
$be¡F™ExpÚ’tŸl
->
	`g‘IÁ”£ù
(),

2118 
$be¡F™ExpÚ’tŸl
->
	`g‘IÁ”£ùSE
(),

2119 
$be¡F™ExpÚ’tŸl
->
	`g‘StdevOfResidu®s
(),

2120 
$be¡F™ExpÚ’tŸl
->
	`g‘DFResidu®s
(),

2121 
$be¡F™ExpÚ’tŸl
->
	`g‘SSResidu®s
()

2125  
	`¬¿y
(

2126 
$be¡F™ExpÚ’tŸl
->
	`g‘Slİe
(),

2127 
$be¡F™ExpÚ’tŸl
->
	`g‘IÁ”£ù
()

2130 
	}
}

2147 
public
 
funùiÚ
 
	$LOGINV
(
$´obab™y
, 
$m—n
, 
$¡dDev
)

2149 
$´obab™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($probability);

2150 
$m—n
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($mean);

2151 
$¡dDev
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($stdDev);

2153 ià((
	`is_num”ic
(
$´obab™y
)è&& (is_num”ic(
$m—n
)è&& (is_num”ic(
$¡dDev
))) {

2154 ià((
$´obab™y
 < 0è|| ($´obab™y > 1è|| (
$¡dDev
 <= 0)) {

2155  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2157  
	`exp
(
$m—n
 + 
$¡dDev
 * 
£lf
::
	`NORMSINV
(
$´obab™y
));

2159  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2160 
	}
}

2174 
public
 
funùiÚ
 
	$LOGNORMDIST
(
$v®ue
, 
$m—n
, 
$¡dDev
)

2176 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

2177 
$m—n
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($mean);

2178 
$¡dDev
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($stdDev);

2180 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$m—n
)è&& (is_num”ic(
$¡dDev
))) {

2181 ià((
$v®ue
 <ğ0è|| (
$¡dDev
 <= 0)) {

2182  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2184  
£lf
::
	`NORMSDIST
((
	`log
(
$v®ue
è- 
$m—n
è/ 
$¡dDev
);

2186  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2187 
	}
}

2204 
public
 
funùiÚ
 
	$MAX
()

2206 
$»tuºV®ue
 = 
nuÎ
;

2209 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

2210 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

2212 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

2213 ià((
	`is_nuÎ
(
$»tuºV®ue
)è|| (
$¬g
 > $returnValue)) {

2214 
$»tuºV®ue
 = 
$¬g
;

2219 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

2222  
$»tuºV®ue
;

2223 
	}
}

2239 
public
 
funùiÚ
 
	$MAXA
()

2241 
$»tuºV®ue
 = 
nuÎ
;

2244 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

2245 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

2247 ià((
	`is_num”ic
(
$¬g
)è|| (
	`is_boŞ
($¬g)è|| ((
	`is_¡ršg
($arg) && ($arg != '')))) {

2248 ià(
	`is_boŞ
(
$¬g
)) {

2249 
$¬g
 = (
š‹g”
) $arg;

2250 } 
	`–£if
 (
	`is_¡ršg
(
$¬g
)) {

2251 
$¬g
 = 0;

2253 ià((
	`is_nuÎ
(
$»tuºV®ue
)è|| (
$¬g
 > $returnValue)) {

2254 
$»tuºV®ue
 = 
$¬g
;

2259 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

2262  
$»tuºV®ue
;

2263 
	}
}

2280 
public
 
funùiÚ
 
MAXIF
(
$aArgs
, 
$cÚd™iÚ
, 
$sumArgs
 = 
	$¬¿y
())

2282 
$»tuºV®ue
 = 
nuÎ
;

2284 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($aArgs);

2285 
$sumArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($sumArgs);

2286 ià(
	`em±y
(
$sumArgs
)) {

2287 
$sumArgs
 = 
$aArgs
;

2289 
$cÚd™iÚ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`ifCÚd™iÚ
($condition);

2291 
	`fÜ—ch
 (
$aArgs
 
as
 
$key
 => 
$¬g
) {

2292 ià(!
	`is_num”ic
(
$¬g
)) {

2293 
$¬g
 = 
PHPExûl_C®cuÏtiÚ
::
	`w¿pResuÉ
(
	`¡¹ouµ”
($arg));

2295 
$‹¡CÚd™iÚ
 = '='.
$¬g
.
$cÚd™iÚ
;

2296 ià(
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`_ÿlcuÏ‹FÜmuÏV®ue
(
$‹¡CÚd™iÚ
)) {

2297 ià((
	`is_nuÎ
(
$»tuºV®ue
)è|| (
$¬g
 > $returnValue)) {

2298 
$»tuºV®ue
 = 
$¬g
;

2303  
$»tuºV®ue
;

2304 
	}
}

2319 
public
 
funùiÚ
 
	$MEDIAN
()

2321 
$»tuºV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2323 
$mArgs
 = 
	`¬¿y
();

2325 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

2326 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

2328 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

2329 
$mArgs
[] = 
$¬g
;

2333 
$mV®ueCouÁ
 = 
	`couÁ
(
$mArgs
);

2334 ià(
$mV®ueCouÁ
 > 0) {

2335 
	`sÜt
(
$mArgs
, 
SORT_NUMERIC
);

2336 
$mV®ueCouÁ
 = $mValueCount / 2;

2337 ià(
$mV®ueCouÁ
 =ğ
	`æoÜ
($mValueCount)) {

2338 
$»tuºV®ue
 = (
$mArgs
[
$mV®ueCouÁ
--] + $mArgs[$mValueCount]) / 2;

2340 
$mV®ueCouÁ
 =ğ
	`æoÜ
($mValueCount);

2341 
$»tuºV®ue
 = 
$mArgs
[
$mV®ueCouÁ
];

2345  
$»tuºV®ue
;

2346 
	}
}

2363 
public
 
funùiÚ
 
	$MIN
()

2365 
$»tuºV®ue
 = 
nuÎ
;

2368 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

2369 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

2371 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

2372 ià((
	`is_nuÎ
(
$»tuºV®ue
)è|| (
$¬g
 < $returnValue)) {

2373 
$»tuºV®ue
 = 
$¬g
;

2378 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

2381  
$»tuºV®ue
;

2382 
	}
}

2398 
public
 
funùiÚ
 
	$MINA
()

2400 
$»tuºV®ue
 = 
nuÎ
;

2403 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

2404 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

2406 ià((
	`is_num”ic
(
$¬g
)è|| (
	`is_boŞ
($¬g)è|| ((
	`is_¡ršg
($arg) && ($arg != '')))) {

2407 ià(
	`is_boŞ
(
$¬g
)) {

2408 
$¬g
 = (
š‹g”
) $arg;

2409 } 
	`–£if
 (
	`is_¡ršg
(
$¬g
)) {

2410 
$¬g
 = 0;

2412 ià((
	`is_nuÎ
(
$»tuºV®ue
)è|| (
$¬g
 < $returnValue)) {

2413 
$»tuºV®ue
 = 
$¬g
;

2418 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

2421  
$»tuºV®ue
;

2422 
	}
}

2439 
public
 
funùiÚ
 
MINIF
(
$aArgs
, 
$cÚd™iÚ
, 
$sumArgs
 = 
	$¬¿y
())

2441 
$»tuºV®ue
 = 
nuÎ
;

2443 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($aArgs);

2444 
$sumArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($sumArgs);

2445 ià(
	`em±y
(
$sumArgs
)) {

2446 
$sumArgs
 = 
$aArgs
;

2448 
$cÚd™iÚ
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`ifCÚd™iÚ
($condition);

2450 
	`fÜ—ch
 (
$aArgs
 
as
 
$key
 => 
$¬g
) {

2451 ià(!
	`is_num”ic
(
$¬g
)) {

2452 
$¬g
 = 
PHPExûl_C®cuÏtiÚ
::
	`w¿pResuÉ
(
	`¡¹ouµ”
($arg));

2454 
$‹¡CÚd™iÚ
 = '='.
$¬g
.
$cÚd™iÚ
;

2455 ià(
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`_ÿlcuÏ‹FÜmuÏV®ue
(
$‹¡CÚd™iÚ
)) {

2456 ià((
	`is_nuÎ
(
$»tuºV®ue
)è|| (
$¬g
 < $returnValue)) {

2457 
$»tuºV®ue
 = 
$¬g
;

2462  
$»tuºV®ue
;

2463 
	}
}

2470 
´iv©e
 
funùiÚ
 
	$modeC®c
(
$d©a
)

2472 
$äequ’cyA¼ay
 = 
	`¬¿y
();

2473 
	`fÜ—ch
 (
$d©a
 
as
 
$d©um
) {

2474 
$found
 = 
çl£
;

2475 
	`fÜ—ch
 (
$äequ’cyA¼ay
 
as
 
$key
 => 
$v®ue
) {

2476 ià((
¡ršg
è
$v®ue
['v®ue'] =ğ(¡ršgè
$d©um
) {

2477 ++
$äequ’cyA¼ay
[
$key
]['frequency'];

2478 
$found
 = 
Œue
;

2482 ià(!
$found
) {

2483 
$äequ’cyA¼ay
[] = 
	`¬¿y
(

2484 'v®ue' => 
$d©um
,

2490 
	`fÜ—ch
 (
$äequ’cyA¼ay
 
as
 
$key
 => 
$v®ue
) {

2491 
$äequ’cyLi¡
[
$key
] = 
$v®ue
['frequency'];

2492 
$v®ueLi¡
[
$key
] = 
$v®ue
['value'];

2494 
	`¬¿y_muÉisÜt
(
$äequ’cyLi¡
, 
SORT_DESC
, 
$v®ueLi¡
, 
SORT_ASC
, 
SORT_NUMERIC
, 
$äequ’cyA¼ay
);

2496 ià(
$äequ’cyA¼ay
[0]['frequency'] == 1) {

2497  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2499  
$äequ’cyA¼ay
[0]['value'];

2500 
	}
}

2516 
public
 
funùiÚ
 
	$MODE
()

2518 
$»tuºV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2521 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

2523 
$mArgs
 = 
	`¬¿y
();

2524 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

2526 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

2527 
$mArgs
[] = 
$¬g
;

2531 ià(!
	`em±y
(
$mArgs
)) {

2532  
£lf
::
	`modeC®c
(
$mArgs
);

2535  
$»tuºV®ue
;

2536 
	}
}

2554 
public
 
funùiÚ
 
	$NEGBINOMDIST
(
$çu»s
, 
$sucûs£s
, 
$´obab™y
)

2556 
$çu»s
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($failures));

2557 
$sucûs£s
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($successes));

2558 
$´obab™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($probability);

2560 ià((
	`is_num”ic
(
$çu»s
)è&& (is_num”ic(
$sucûs£s
)è&& (is_num”ic(
$´obab™y
))) {

2561 ià((
$çu»s
 < 0è|| (
$sucûs£s
 < 1)) {

2562  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2563 } 
	`–£if
 ((
$´obab™y
 < 0) || ($probability > 1)) {

2564  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2566 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_GNUMERIC
) {

2567 ià((
$çu»s
 + 
$sucûs£s
 - 1) <= 0) {

2568  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2571  (
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`COMBIN
(
$çu»s
 + 
$sucûs£s
 - 1, $sucûs£ - 1)è* (
	`pow
(
$´obab™y
, $successes)) * (pow(1 - $probability, $failures));

2573  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2574 
	}
}

2591 
public
 
funùiÚ
 
	$NORMDIST
(
$v®ue
, 
$m—n
, 
$¡dDev
, 
$cumuÏtive
)

2593 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

2594 
$m—n
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($mean);

2595 
$¡dDev
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($stdDev);

2597 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$m—n
)è&& (is_num”ic(
$¡dDev
))) {

2598 ià(
$¡dDev
 < 0) {

2599  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2601 ià((
	`is_num”ic
(
$cumuÏtive
)è|| (
	`is_boŞ
($cumulative))) {

2602 ià(
$cumuÏtive
) {

2603  0.5 * (1 + 
PHPExûl_C®cuÏtiÚ_Engš“ršg
::
	`”fV®
((
$v®ue
 - 
$m—n
è/ (
$¡dDev
 * 
	`sq¹
(2))));

2605  (1 / (
SQRT2PI
 * 
$¡dDev
)è* 
	`exp
(0 - (
	`pow
(
$v®ue
 - 
$m—n
, 2) / (2 * ($stdDev * $stdDev))));

2609  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2610 
	}
}

2624 
public
 
funùiÚ
 
	$NORMINV
(
$´obab™y
, 
$m—n
, 
$¡dDev
)

2626 
$´obab™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($probability);

2627 
$m—n
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($mean);

2628 
$¡dDev
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($stdDev);

2630 ià((
	`is_num”ic
(
$´obab™y
)è&& (is_num”ic(
$m—n
)è&& (is_num”ic(
$¡dDev
))) {

2631 ià((
$´obab™y
 < 0) || ($probability > 1)) {

2632  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2634 ià(
$¡dDev
 < 0) {

2635  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2637  (
£lf
::
	`šv”£Ncdf
(
$´obab™y
è* 
$¡dDev
è+ 
$m—n
;

2639  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2640 
	}
}

2653 
public
 
funùiÚ
 
	$NORMSDIST
(
$v®ue
)

2655 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

2657  
£lf
::
	`NORMDIST
(
$v®ue
, 0, 1, 
Œue
);

2658 
	}
}

2669 
public
 
funùiÚ
 
	$NORMSINV
(
$v®ue
)

2671  
£lf
::
	`NORMINV
(
$v®ue
, 0, 1);

2672 
	}
}

2689 
public
 
funùiÚ
 
	$PERCENTILE
()

2691 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

2694 
$’Œy
 = 
	`¬¿y_pİ
(
$aArgs
);

2696 ià((
	`is_num”ic
(
$’Œy
)è&& (!
	`is_¡ršg
($entry))) {

2697 ià((
$’Œy
 < 0) || ($entry > 1)) {

2698  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2700 
$mArgs
 = 
	`¬¿y
();

2701 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

2703 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

2704 
$mArgs
[] = 
$¬g
;

2707 
$mV®ueCouÁ
 = 
	`couÁ
(
$mArgs
);

2708 ià(
$mV®ueCouÁ
 > 0) {

2709 
	`sÜt
(
$mArgs
);

2710 
$couÁ
 = 
£lf
::
	`COUNT
(
$mArgs
);

2711 
$šdex
 = 
$’Œy
 * (
$couÁ
-1);

2712 
$iBa£
 = 
	`æoÜ
(
$šdex
);

2713 ià(
$šdex
 =ğ
$iBa£
) {

2714  
$mArgs
[
$šdex
];

2716 
$iNext
 = 
$iBa£
 + 1;

2717 
$iPrİÜtiÚ
 = 
$šdex
 - 
$iBa£
;

2718  
$mArgs
[
$iBa£
] + (($mArgs[
$iNext
] - $mArgs[$iBa£]è* 
$iPrİÜtiÚ
) ;

2722  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2723 
	}
}

2736 
public
 
funùiÚ
 
	$PERCENTRANK
(
$v®ueS‘
, 
$v®ue
, 
$signifiÿnû
 = 3)

2738 
$v®ueS‘
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($valueSet);

2739 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

2740 
$signifiÿnû
 = (
	`is_nuÎ
($signifiÿnû)è? 3 : (
š‹g”
è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($significance);

2742 
	`fÜ—ch
 (
$v®ueS‘
 
as
 
$key
 => 
$v®ueEÁry
) {

2743 ià(!
	`is_num”ic
(
$v®ueEÁry
)) {

2744 
	`un£t
(
$v®ueS‘
[
$key
]);

2747 
	`sÜt
(
$v®ueS‘
, 
SORT_NUMERIC
);

2748 
$v®ueCouÁ
 = 
	`couÁ
(
$v®ueS‘
);

2749 ià(
$v®ueCouÁ
 == 0) {

2750  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2753 
$v®ueAdju¡Ü
 = 
$v®ueCouÁ
 - 1;

2754 ià((
$v®ue
 < 
$v®ueS‘
[0]è|| ($v®u> $v®ueS‘[
$v®ueAdju¡Ü
])) {

2755  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2758 
$pos
 = 
	`¬¿y_£¬ch
(
$v®ue
, 
$v®ueS‘
);

2759 ià(
$pos
 ==ğ
çl£
) {

2760 
$pos
 = 0;

2761 
$‹¡V®ue
 = 
$v®ueS‘
[0];

2762 
$‹¡V®ue
 < 
$v®ue
) {

2763 
$‹¡V®ue
 = 
$v®ueS‘
[++
$pos
];

2765 --
$pos
;

2766 
$pos
 +ğ((
$v®ue
 - 
$v®ueS‘
[$pos]è/ (
$‹¡V®ue
 - $valueSet[$pos]));

2769  
	`round
(
$pos
 / 
$v®ueAdju¡Ü
, 
$signifiÿnû
);

2770 
	}
}

2786 
public
 
funùiÚ
 
	$PERMUT
(
$numObjs
, 
$numInS‘
)

2788 
$numObjs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($numObjs);

2789 
$numInS‘
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($numInSet);

2791 ià((
	`is_num”ic
(
$numObjs
)è&& (is_num”ic(
$numInS‘
))) {

2792 
$numInS‘
 = 
	`æoÜ
($numInSet);

2793 ià(
$numObjs
 < 
$numInS‘
) {

2794  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2796  
	`round
(
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`FACT
(
$numObjs
è/ PHPExûl_C®cuÏtiÚ_M©hTrig::FACT($numObj - 
$numInS‘
));

2798  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2799 
	}
}

2815 
public
 
funùiÚ
 
	$POISSON
(
$v®ue
, 
$m—n
, 
$cumuÏtive
)

2817 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

2818 
$m—n
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($mean);

2820 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$m—n
))) {

2821 ià((
$v®ue
 < 0è|| (
$m—n
 <= 0)) {

2822  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2824 ià((
	`is_num”ic
(
$cumuÏtive
)è|| (
	`is_boŞ
($cumulative))) {

2825 ià(
$cumuÏtive
) {

2826 
$summ”
 = 0;

2827 
$i
 = 0; $˜<ğ
	`æoÜ
(
$v®ue
); ++$i) {

2828 
$summ”
 +ğ
	`pow
(
$m—n
, 
$i
è/ 
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`FACT
($i);

2830  
	`exp
(0-
$m—n
è* 
$summ”
;

2832  (
	`exp
(0-
$m—n
è* 
	`pow
($m—n, 
$v®ue
)è/ 
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`FACT
($value);

2836  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2837 
	}
}

2854 
public
 
funùiÚ
 
	$QUARTILE
()

2856 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

2859 
$’Œy
 = 
	`æoÜ
(
	`¬¿y_pİ
(
$aArgs
));

2861 ià((
	`is_num”ic
(
$’Œy
)è&& (!
	`is_¡ršg
($entry))) {

2862 
$’Œy
 /= 4;

2863 ià((
$’Œy
 < 0) || ($entry > 1)) {

2864  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

2866  
£lf
::
	`PERCENTILE
(
$aArgs
, 
$’Œy
);

2868  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2869 
	}
}

2882 
public
 
funùiÚ
 
	$RANK
(
$v®ue
, 
$v®ueS‘
, 
$Üd”
 = 0)

2884 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

2885 
$v®ueS‘
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
($valueSet);

2886 
$Üd”
 = (
	`is_nuÎ
($Üd”)è? 0 : (
š‹g”
è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($order);

2888 
	`fÜ—ch
 (
$v®ueS‘
 
as
 
$key
 => 
$v®ueEÁry
) {

2889 ià(!
	`is_num”ic
(
$v®ueEÁry
)) {

2890 
	`un£t
(
$v®ueS‘
[
$key
]);

2894 ià(
$Üd”
 == 0) {

2895 
	`rsÜt
(
$v®ueS‘
, 
SORT_NUMERIC
);

2897 
	`sÜt
(
$v®ueS‘
, 
SORT_NUMERIC
);

2899 
$pos
 = 
	`¬¿y_£¬ch
(
$v®ue
, 
$v®ueS‘
);

2900 ià(
$pos
 ==ğ
çl£
) {

2901  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2904  ++
$pos
;

2905 
	}
}

2917 
public
 
funùiÚ
 
	$RSQ
(
$yV®ues
, 
$xV®ues
)

2919 ià(!
£lf
::
	`checkT»ndA¼ays
(
$yV®ues
, 
$xV®ues
)) {

2920  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2922 
$yV®ueCouÁ
 = 
	`couÁ
(
$yV®ues
);

2923 
$xV®ueCouÁ
 = 
	`couÁ
(
$xV®ues
);

2925 ià((
$yV®ueCouÁ
 =ğ0è|| ($yV®ueCouÁ !ğ
$xV®ueCouÁ
)) {

2926  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2927 } 
	`–£if
 (
$yV®ueCouÁ
 == 1) {

2928  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

2931 
$be¡F™Lš—r
 = 
Œ’dCÏss
::
	`ÿlcuÏ‹
Ñ»ndCÏss::
TREND_LINEAR
, 
$yV®ues
, 
$xV®ues
);

2932  
$be¡F™Lš—r
->
	`g‘GoodÃssOfF™
();

2933 
	}
}

2947 
public
 
funùiÚ
 
	$SKEW
()

2949 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

2950 
$m—n
 = 
£lf
::
	`AVERAGE
(
$aArgs
);

2951 
$¡dDev
 = 
£lf
::
	`STDEV
(
$aArgs
);

2953 
$couÁ
 = 
$summ”
 = 0;

2955 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

2956 ià((
	`is_boŞ
(
$¬g
)) &&

2957 (!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isM©rixV®ue
(
$k
))) {

2960 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

2961 
$summ”
 +ğ
	`pow
(((
$¬g
 - 
$m—n
è/ 
$¡dDev
), 3);

2962 ++
$couÁ
;

2967 ià(
$couÁ
 > 2) {

2968  
$summ”
 * (
$couÁ
 / (($count-1) * ($count-2)));

2970  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

2971 
	}
}

2983 
public
 
funùiÚ
 
	$SLOPE
(
$yV®ues
, 
$xV®ues
)

2985 ià(!
£lf
::
	`checkT»ndA¼ays
(
$yV®ues
, 
$xV®ues
)) {

2986  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

2988 
$yV®ueCouÁ
 = 
	`couÁ
(
$yV®ues
);

2989 
$xV®ueCouÁ
 = 
	`couÁ
(
$xV®ues
);

2991 ià((
$yV®ueCouÁ
 =ğ0è|| ($yV®ueCouÁ !ğ
$xV®ueCouÁ
)) {

2992  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

2993 } 
	`–£if
 (
$yV®ueCouÁ
 == 1) {

2994  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

2997 
$be¡F™Lš—r
 = 
Œ’dCÏss
::
	`ÿlcuÏ‹
Ñ»ndCÏss::
TREND_LINEAR
, 
$yV®ues
, 
$xV®ues
);

2998  
$be¡F™Lš—r
->
	`g‘Slİe
();

2999 
	}
}

3017 
public
 
funùiÚ
 
	$SMALL
()

3019 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

3022 
$’Œy
 = 
	`¬¿y_pİ
(
$aArgs
);

3024 ià((
	`is_num”ic
(
$’Œy
)è&& (!
	`is_¡ršg
($entry))) {

3025 
$mArgs
 = 
	`¬¿y
();

3026 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

3028 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

3029 
$mArgs
[] = 
$¬g
;

3032 
$couÁ
 = 
£lf
::
	`COUNT
(
$mArgs
);

3033 
$’Œy
 = 
	`æoÜ
(--$entry);

3034 ià((
$’Œy
 < 0è|| ($’Œy >ğ
$couÁ
) || ($count == 0)) {

3035  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

3037 
	`sÜt
(
$mArgs
);

3038  
$mArgs
[
$’Œy
];

3040  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

3041 
	}
}

3054 
public
 
funùiÚ
 
	$STANDARDIZE
(
$v®ue
, 
$m—n
, 
$¡dDev
)

3056 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

3057 
$m—n
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($mean);

3058 
$¡dDev
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($stdDev);

3060 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$m—n
)è&& (is_num”ic(
$¡dDev
))) {

3061 ià(
$¡dDev
 <= 0) {

3062  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

3064  (
$v®ue
 - 
$m—n
è/ 
$¡dDev
 ;

3066  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

3067 
	}
}

3084 
public
 
funùiÚ
 
	$STDEV
()

3086 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

3089 
$»tuºV®ue
 = 
nuÎ
;

3091 
$aM—n
 = 
£lf
::
	`AVERAGE
(
$aArgs
);

3092 ià(!
	`is_nuÎ
(
$aM—n
)) {

3093 
$aCouÁ
 = -1;

3094 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

3095 ià((
	`is_boŞ
(
$¬g
)) &&

3096 ((!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isC–lV®ue
(
$k
)è|| (PHPExûl_C®cuÏtiÚ_FunùiÚs::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
))) {

3097 
$¬g
 = (
š‹g”
) $arg;

3100 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

3101 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

3102 
$»tuºV®ue
 = 
	`pow
((
$¬g
 - 
$aM—n
), 2);

3104 
$»tuºV®ue
 +ğ
	`pow
((
$¬g
 - 
$aM—n
), 2);

3106 ++
$aCouÁ
;

3111 ià((
$aCouÁ
 > 0è&& (
$»tuºV®ue
 >= 0)) {

3112  
	`sq¹
(
$»tuºV®ue
 / 
$aCouÁ
);

3115  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

3116 
	}
}

3132 
public
 
funùiÚ
 
	$STDEVA
()

3134 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

3136 
$»tuºV®ue
 = 
nuÎ
;

3138 
$aM—n
 = 
£lf
::
	`AVERAGEA
(
$aArgs
);

3139 ià(!
	`is_nuÎ
(
$aM—n
)) {

3140 
$aCouÁ
 = -1;

3141 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

3142 ià((
	`is_boŞ
(
$¬g
)) &&

3143 (!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isM©rixV®ue
(
$k
))) {

3146 ià((
	`is_num”ic
(
$¬g
)è|| (
	`is_boŞ
($¬g)è|| ((
	`is_¡ršg
($arg) & ($arg != '')))) {

3147 ià(
	`is_boŞ
(
$¬g
)) {

3148 
$¬g
 = (
š‹g”
) $arg;

3149 } 
	`–£if
 (
	`is_¡ršg
(
$¬g
)) {

3150 
$¬g
 = 0;

3152 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

3153 
$»tuºV®ue
 = 
	`pow
((
$¬g
 - 
$aM—n
), 2);

3155 
$»tuºV®ue
 +ğ
	`pow
((
$¬g
 - 
$aM—n
), 2);

3157 ++
$aCouÁ
;

3162 ià((
$aCouÁ
 > 0è&& (
$»tuºV®ue
 >= 0)) {

3163  
	`sq¹
(
$»tuºV®ue
 / 
$aCouÁ
);

3166  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

3167 
	}
}

3183 
public
 
funùiÚ
 
	$STDEVP
()

3185 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

3187 
$»tuºV®ue
 = 
nuÎ
;

3189 
$aM—n
 = 
£lf
::
	`AVERAGE
(
$aArgs
);

3190 ià(!
	`is_nuÎ
(
$aM—n
)) {

3191 
$aCouÁ
 = 0;

3192 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

3193 ià((
	`is_boŞ
(
$¬g
)) &&

3194 ((!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isC–lV®ue
(
$k
)è|| (PHPExûl_C®cuÏtiÚ_FunùiÚs::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
))) {

3195 
$¬g
 = (
š‹g”
) $arg;

3198 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

3199 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

3200 
$»tuºV®ue
 = 
	`pow
((
$¬g
 - 
$aM—n
), 2);

3202 
$»tuºV®ue
 +ğ
	`pow
((
$¬g
 - 
$aM—n
), 2);

3204 ++
$aCouÁ
;

3208 ià((
$aCouÁ
 > 0è&& (
$»tuºV®ue
 >= 0)) {

3209  
	`sq¹
(
$»tuºV®ue
 / 
$aCouÁ
);

3212  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

3213 
	}
}

3229 
public
 
funùiÚ
 
	$STDEVPA
()

3231 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

3233 
$»tuºV®ue
 = 
nuÎ
;

3235 
$aM—n
 = 
£lf
::
	`AVERAGEA
(
$aArgs
);

3236 ià(!
	`is_nuÎ
(
$aM—n
)) {

3237 
$aCouÁ
 = 0;

3238 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

3239 ià((
	`is_boŞ
(
$¬g
)) &&

3240 (!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isM©rixV®ue
(
$k
))) {

3243 ià((
	`is_num”ic
(
$¬g
)è|| (
	`is_boŞ
($¬g)è|| ((
	`is_¡ršg
($arg) & ($arg != '')))) {

3244 ià(
	`is_boŞ
(
$¬g
)) {

3245 
$¬g
 = (
š‹g”
) $arg;

3246 } 
	`–£if
 (
	`is_¡ršg
(
$¬g
)) {

3247 
$¬g
 = 0;

3249 ià(
	`is_nuÎ
(
$»tuºV®ue
)) {

3250 
$»tuºV®ue
 = 
	`pow
((
$¬g
 - 
$aM—n
), 2);

3252 
$»tuºV®ue
 +ğ
	`pow
((
$¬g
 - 
$aM—n
), 2);

3254 ++
$aCouÁ
;

3259 ià((
$aCouÁ
 > 0è&& (
$»tuºV®ue
 >= 0)) {

3260  
	`sq¹
(
$»tuºV®ue
 / 
$aCouÁ
);

3263  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

3264 
	}
}

3276 
public
 
funùiÚ
 
	$STEYX
(
$yV®ues
, 
$xV®ues
)

3278 ià(!
£lf
::
	`checkT»ndA¼ays
(
$yV®ues
, 
$xV®ues
)) {

3279  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

3281 
$yV®ueCouÁ
 = 
	`couÁ
(
$yV®ues
);

3282 
$xV®ueCouÁ
 = 
	`couÁ
(
$xV®ues
);

3284 ià((
$yV®ueCouÁ
 =ğ0è|| ($yV®ueCouÁ !ğ
$xV®ueCouÁ
)) {

3285  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

3286 } 
	`–£if
 (
$yV®ueCouÁ
 == 1) {

3287  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

3290 
$be¡F™Lš—r
 = 
Œ’dCÏss
::
	`ÿlcuÏ‹
Ñ»ndCÏss::
TREND_LINEAR
, 
$yV®ues
, 
$xV®ues
);

3291  
$be¡F™Lš—r
->
	`g‘StdevOfResidu®s
();

3292 
	}
}

3305 
public
 
funùiÚ
 
	$TDIST
(
$v®ue
, 
$deg»es
, 
$s
)

3307 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

3308 
$deg»es
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($degrees));

3309 
$s
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($tails));

3311 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$deg»es
)è&& (is_num”ic(
$s
))) {

3312 ià((
$v®ue
 < 0è|| (
$deg»es
 < 1è|| (
$s
 < 1) || ($tails > 2)) {

3313  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

3324 
$‰”m
 = 
$deg»es
;

3325 
$‰h‘a
 = 
	`©ª2
(
$v®ue
, 
	`sq¹
(
$‰”m
));

3326 
$tc
 = 
	`cos
(
$‰h‘a
);

3327 
$ts
 = 
	`sš
(
$‰h‘a
);

3328 
$tsum
 = 0;

3330 ià((
$deg»es
 % 2) == 1) {

3331 
$ti
 = 3;

3332 
$‰”m
 = 
$tc
;

3334 
$ti
 = 2;

3335 
$‰”m
 = 1;

3338 
$tsum
 = 
$‰”m
;

3339 
$ti
 < 
$deg»es
) {

3340 
$‰”m
 *ğ
$tc
 * $tø* (
$ti
 - 1) / $ti;

3341 
$tsum
 +ğ
$‰”m
;

3342 
$ti
 += 2;

3344 
$tsum
 *ğ
$ts
;

3345 ià((
$deg»es
 % 2) == 1) {

3346 
$tsum
 = 
M_2DIVPI
 * ($tsum + 
$‰h‘a
);

3348 
$tV®ue
 = 0.5 * (1 + 
$tsum
);

3349 ià(
$s
 == 1) {

3350  1 - 
	`abs
(
$tV®ue
);

3352  1 - 
	`abs
((1 - 
$tV®ue
) - $tValue);

3355  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

3356 
	}
}

3368 
public
 
funùiÚ
 
	$TINV
(
$´obab™y
, 
$deg»es
)

3370 
$´obab™y
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($probability);

3371 
$deg»es
 = 
	`æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($degrees));

3373 ià((
	`is_num”ic
(
$´obab™y
)è&& (is_num”ic(
$deg»es
))) {

3374 
$xLo
 = 100;

3375 
$xHi
 = 0;

3377 
$x
 = 
$xNew
 = 1;

3378 
$dx
 = 1;

3379 
$i
 = 0;

3381 (
	`abs
(
$dx
è> 
PRECISION
è&& (
$i
++ < 
MAX_ITERATIONS
)) {

3383 
$»suÉ
 = 
£lf
::
	`TDIST
(
$x
, 
$deg»es
, 2);

3384 
$”rÜ
 = 
$»suÉ
 - 
$´obab™y
;

3385 ià(
$”rÜ
 == 0.0) {

3386 
$dx
 = 0;

3387 } 
	`–£if
 (
$”rÜ
 < 0.0) {

3388 
$xLo
 = 
$x
;

3390 
$xHi
 = 
$x
;

3393 ià(
$»suÉ
 != 0.0) {

3394 
$dx
 = 
$”rÜ
 / 
$»suÉ
;

3395 
$xNew
 = 
$x
 - 
$dx
;

3400 ià((
$xNew
 < 
$xLo
è|| ($xNew > 
$xHi
è|| (
$»suÉ
 == 0.0)) {

3401 
$xNew
 = (
$xLo
 + 
$xHi
) / 2;

3402 
$dx
 = 
$xNew
 - 
$x
;

3404 
$x
 = 
$xNew
;

3406 ià(
$i
 =ğ
MAX_ITERATIONS
) {

3407  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NA
();

3409  
	`round
(
$x
, 12);

3411  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

3412 
	}
}

3426 
public
 
funùiÚ
 
TREND
(
$yV®ues
, 
$xV®ues
 = 
¬¿y
(), 
$ÃwV®ues
 =‡¼ay(), 
$cÚ¡
 = 
Œue
)

3428 
$yV®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nA¼ay
($yValues);

3429 
	g$xV®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nA¼ay
(
$xV®ues
);

3430 
	g$ÃwV®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nA¼ay
(
$ÃwV®ues
);

3431 
	g$cÚ¡
 = (
is_nuÎ
(
$cÚ¡
)è? 
Œue
 : (
boŞ—n
è
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($const);

3433 
	g$be¡F™Lš—r
 = 
Œ’dCÏss
::
ÿlcuÏ‹
Ñ»ndCÏss::
TREND_LINEAR
, 
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

3434 ià(
em±y
(
$ÃwV®ues
)) {

3435 
	g$ÃwV®ues
 = 
$be¡F™Lš—r
->
g‘XV®ues
();

3438 
	g$»tuºA¼ay
 = 
¬¿y
();

3439 
fÜ—ch
 (
$ÃwV®ues
 
as
 
$xV®ue
) {

3440 
	g$»tuºA¼ay
[0][] = 
$be¡F™Lš—r
->
g‘V®ueOfYFÜX
(
$xV®ue
);

3443  
	g$»tuºA¼ay
;

3463 
public
 
funùiÚ
 
	$TRIMMEAN
()

3465 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

3468 
$³rûÁ
 = 
	`¬¿y_pİ
(
$aArgs
);

3470 ià((
	`is_num”ic
(
$³rûÁ
)è&& (!
	`is_¡ršg
($percent))) {

3471 ià((
$³rûÁ
 < 0) || ($percent > 1)) {

3472  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

3474 
$mArgs
 = 
	`¬¿y
();

3475 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

3477 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

3478 
$mArgs
[] = 
$¬g
;

3481 
$disÿrd
 = 
	`æoÜ
(
£lf
::
	`COUNT
(
$mArgs
è* 
$³rûÁ
 / 2);

3482 
	`sÜt
(
$mArgs
);

3483 
$i
=0; $˜< 
$disÿrd
; ++$i) {

3484 
	`¬¿y_pİ
(
$mArgs
);

3485 
	`¬¿y_shiá
(
$mArgs
);

3487  
£lf
::
	`AVERAGE
(
$mArgs
);

3489  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

3490 
	}
}

3506 
public
 
funùiÚ
 
	$VARFunc
()

3508 
$»tuºV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

3510 
$summ”A
 = 
$summ”B
 = 0;

3513 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

3514 
$aCouÁ
 = 0;

3515 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

3516 ià(
	`is_boŞ
(
$¬g
)) {

3517 
$¬g
 = (
š‹g”
) $arg;

3520 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

3521 
$summ”A
 +ğ(
$¬g
 * $arg);

3522 
$summ”B
 +ğ
$¬g
;

3523 ++
$aCouÁ
;

3527 ià(
$aCouÁ
 > 1) {

3528 
$summ”A
 *ğ
$aCouÁ
;

3529 
$summ”B
 *= $summerB;

3530 
$»tuºV®ue
 = (
$summ”A
 - 
$summ”B
è/ (
$aCouÁ
 * ($aCount - 1));

3532  
$»tuºV®ue
;

3533 
	}
}

3549 
public
 
funùiÚ
 
	$VARA
()

3551 
$»tuºV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

3553 
$summ”A
 = 
$summ”B
 = 0;

3556 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

3557 
$aCouÁ
 = 0;

3558 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

3559 ià((
	`is_¡ršg
(
$¬g
)) &&

3560 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isV®ue
(
$k
))) {

3561  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

3562 } 
	`–£if
 ((
	`is_¡ršg
(
$¬g
)) &&

3563 (!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isM©rixV®ue
(
$k
))) {

3566 ià((
	`is_num”ic
(
$¬g
)è|| (
	`is_boŞ
($¬g)è|| ((
	`is_¡ršg
($arg) & ($arg != '')))) {

3567 ià(
	`is_boŞ
(
$¬g
)) {

3568 
$¬g
 = (
š‹g”
) $arg;

3569 } 
	`–£if
 (
	`is_¡ršg
(
$¬g
)) {

3570 
$¬g
 = 0;

3572 
$summ”A
 +ğ(
$¬g
 * $arg);

3573 
$summ”B
 +ğ
$¬g
;

3574 ++
$aCouÁ
;

3579 ià(
$aCouÁ
 > 1) {

3580 
$summ”A
 *ğ
$aCouÁ
;

3581 
$summ”B
 *= $summerB;

3582 
$»tuºV®ue
 = (
$summ”A
 - 
$summ”B
è/ (
$aCouÁ
 * ($aCount - 1));

3584  
$»tuºV®ue
;

3585 
	}
}

3601 
public
 
funùiÚ
 
	$VARP
()

3604 
$»tuºV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

3606 
$summ”A
 = 
$summ”B
 = 0;

3609 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

3610 
$aCouÁ
 = 0;

3611 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

3612 ià(
	`is_boŞ
(
$¬g
)) {

3613 
$¬g
 = (
š‹g”
) $arg;

3616 ià((
	`is_num”ic
(
$¬g
)è&& (!
	`is_¡ršg
($arg))) {

3617 
$summ”A
 +ğ(
$¬g
 * $arg);

3618 
$summ”B
 +ğ
$¬g
;

3619 ++
$aCouÁ
;

3623 ià(
$aCouÁ
 > 0) {

3624 
$summ”A
 *ğ
$aCouÁ
;

3625 
$summ”B
 *= $summerB;

3626 
$»tuºV®ue
 = (
$summ”A
 - 
$summ”B
è/ (
$aCouÁ
 * $aCount);

3628  
$»tuºV®ue
;

3629 
	}
}

3645 
public
 
funùiÚ
 
	$VARPA
()

3647 
$»tuºV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`DIV0
();

3649 
$summ”A
 = 
$summ”B
 = 0;

3652 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
(
	`func_g‘_¬gs
());

3653 
$aCouÁ
 = 0;

3654 
	`fÜ—ch
 (
$aArgs
 
as
 
$k
 => 
$¬g
) {

3655 ià((
	`is_¡ršg
(
$¬g
)) &&

3656 (
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isV®ue
(
$k
))) {

3657  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

3658 } 
	`–£if
 ((
	`is_¡ršg
(
$¬g
)) &&

3659 (!
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`isM©rixV®ue
(
$k
))) {

3662 ià((
	`is_num”ic
(
$¬g
)è|| (
	`is_boŞ
($¬g)è|| ((
	`is_¡ršg
($arg) & ($arg != '')))) {

3663 ià(
	`is_boŞ
(
$¬g
)) {

3664 
$¬g
 = (
š‹g”
) $arg;

3665 } 
	`–£if
 (
	`is_¡ršg
(
$¬g
)) {

3666 
$¬g
 = 0;

3668 
$summ”A
 +ğ(
$¬g
 * $arg);

3669 
$summ”B
 +ğ
$¬g
;

3670 ++
$aCouÁ
;

3675 ià(
$aCouÁ
 > 0) {

3676 
$summ”A
 *ğ
$aCouÁ
;

3677 
$summ”B
 *= $summerB;

3678 
$»tuºV®ue
 = (
$summ”A
 - 
$summ”B
è/ (
$aCouÁ
 * $aCount);

3680  
$»tuºV®ue
;

3681 
	}
}

3697 
public
 
funùiÚ
 
	$WEIBULL
(
$v®ue
, 
$®pha
, 
$b‘a
, 
$cumuÏtive
)

3699 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

3700 
$®pha
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($alpha);

3701 
$b‘a
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($beta);

3703 ià((
	`is_num”ic
(
$v®ue
)è&& (is_num”ic(
$®pha
)è&& (is_num”ic(
$b‘a
))) {

3704 ià((
$v®ue
 < 0è|| (
$®pha
 <ğ0è|| (
$b‘a
 <= 0)) {

3705  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

3707 ià((
	`is_num”ic
(
$cumuÏtive
)è|| (
	`is_boŞ
($cumulative))) {

3708 ià(
$cumuÏtive
) {

3709  1 - 
	`exp
(0 - 
	`pow
(
$v®ue
 / 
$b‘a
, 
$®pha
));

3711  (
$®pha
 / 
	`pow
(
$b‘a
, $®pha)è*…ow(
$v®ue
, $®ph¨- 1è* 
	`exp
(0 -…ow($value / $beta, $alpha));

3715  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

3716 
	}
}

3732 
public
 
funùiÚ
 
	$ZTEST
(
$d©aS‘
, 
$m0
, 
$sigma
 = 
nuÎ
)

3734 
$d©aS‘
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ayIndexed
($dataSet);

3735 
$m0
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($m0);

3736 
$sigma
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($sigma);

3738 ià(
	`is_nuÎ
(
$sigma
)) {

3739 
$sigma
 = 
£lf
::
	`STDEV
(
$d©aS‘
);

3741 
$n
 = 
	`couÁ
(
$d©aS‘
);

3743  1 - 
£lf
::
	`NORMSDIST
((£lf::
	`AVERAGE
(
$d©aS‘
è- 
$m0
è/ (
$sigma
 / 
	`SQRT
(
$n
)));

3744 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/TextData.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_C®cuÏtiÚ_TextD©a


39 
´iv©e
 
	m$šv®idCh¬s
;

41 
´iv©e
 
funùiÚ
 
	$unicodeToOrd
(
$c
)

43 ià(
	`Üd
(
$c
{0}) >=0 && ord($c{0}) <= 127) {

44  
	`Üd
(
$c
{0});

45 } 
	`–£if
 (
	`Üd
(
$c
{0}) >= 192 && ord($c{0}) <= 223) {

46  (
	`Üd
(
$c
{0})-192)*64 + (ord($c{1})-128);

47 } 
	`–£if
 (
	`Üd
(
$c
{0}) >= 224 && ord($c{0}) <= 239) {

48  (
	`Üd
(
$c
{0})-224)*4096 + (ord($c{1})-128)*64 + (ord($c{2})-128);

49 } 
	`–£if
 (
	`Üd
(
$c
{0}) >= 240 && ord($c{0}) <= 247) {

50  (
	`Üd
(
$c
{0})-240)*262144 + (ord($c{1})-128)*4096 + (ord($c{2})-128)*64 + (ord($c{3})-128);

51 } 
	`–£if
 (
	`Üd
(
$c
{0}) >= 248 && ord($c{0}) <= 251) {

52  (
	`Üd
(
$c
{0})-248)*16777216 + (ord($c{1})-128)*262144 + (ord($c{2})-128)*4096 + (ord($c{3})-128)*64 + (ord($c{4})-128);

53 } 
	`–£if
 (
	`Üd
(
$c
{0}) >= 252 && ord($c{0}) <= 253) {

54  (
	`Üd
(
$c
{0})-252)*1073741824 + (ord($c{1})-128)*16777216 + (ord($c{2})-128)*262144 + (ord($c{3})-128)*4096 + (ord($c{4})-128)*64 + (ord($c{5})-128);

55 } 
	`–£if
 (
	`Üd
(
$c
{0}) >= 254 && ord($c{0}) <= 255) {

57  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

68 
public
 
funùiÚ
 
	$CHARACTER
(
$ch¬aù”
)

70 
$ch¬aù”
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($character);

72 ià((!
	`is_num”ic
(
$ch¬aù”
)) || ($character < 0)) {

73  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

76 ià(
	`funùiÚ_exi¡s
('mb_convert_encoding')) {

77  
	`mb_cÚv”t_’codšg
('&#'.
	`štv®
(
$ch¬aù”
).';', 'UTF-8', 'HTML-ENTITIES');

79  
	`chr
(
	`štv®
(
$ch¬aù”
));

81 
	}
}

90 
public
 
funùiÚ
 
TRIMNONPRINTABLE
(
$¡ršgV®ue
 = '')

92 
$¡ršgV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($stringValue);

94 ià(
is_boŞ
(
$¡ršgV®ue
)) {

95  (
	g$¡ršgV®ue
è? 
	gPHPExûl_C®cuÏtiÚ
::
g‘TRUE
(è: 
PHPExûl_C®cuÏtiÚ
::
g‘FALSE
();

98 ià(
	g£lf
::
$šv®idCh¬s
 =ğ
nuÎ
) {

99 
£lf
::
$šv®idCh¬s
 = 
¿nge
(
chr
(0), chr(31));

102 ià(
is_¡ršg
(
$¡ršgV®ue
è|| 
is_num”ic
($stringValue)) {

103  
¡r_»¶aû
(
£lf
::
$šv®idCh¬s
, '', 
Œim
(
$¡ršgV®ue
, "\x00..\x1F"));

105  
	gnuÎ
;

115 
public
 
funùiÚ
 
TRIMSPACES
(
$¡ršgV®ue
 = '')

117 
$¡ršgV®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($stringValue);

118 ià(
is_boŞ
(
$¡ršgV®ue
)) {

119  (
	g$¡ršgV®ue
è? 
	gPHPExûl_C®cuÏtiÚ
::
g‘TRUE
(è: 
PHPExûl_C®cuÏtiÚ
::
g‘FALSE
();

122 ià(
is_¡ršg
(
$¡ršgV®ue
è|| 
is_num”ic
($stringValue)) {

123  
Œim
(
´eg_»¶aû
('/ +/', ' ',rim(
$¡ršgV®ue
, ' ')), ' ');

125  
	gnuÎ
;

135 
public
 
funùiÚ
 
	$ASCIICODE
(
$ch¬aù”s
)

137 ià((
$ch¬aù”s
 ==ğ
nuÎ
) || ($characters === '')) {

138  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

140 
$ch¬aù”s
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($characters);

141 ià(
	`is_boŞ
(
$ch¬aù”s
)) {

142 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

143 
$ch¬aù”s
 = () $characters;

145 
$ch¬aù”s
 = ($ch¬aù”sè? 
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
	`g‘FALSE
();

149 
$ch¬aù”
 = 
$ch¬aù”s
;

150 ià((
	`funùiÚ_exi¡s
('mb_strlen')) && (function_exists('mb_substr'))) {

151 ià(
	`mb_¡¾’
(
$ch¬aù”s
, 'UTF-8') > 1) {

152 
$ch¬aù”
 = 
	`mb_sub¡r
(
$ch¬aù”s
, 0, 1, 'UTF-8');

154  
£lf
::
	`unicodeToOrd
(
$ch¬aù”
);

156 ià(
	`¡¾’
(
$ch¬aù”s
) > 0) {

157 
$ch¬aù”
 = 
	`sub¡r
(
$ch¬aù”s
, 0, 1);

159  
	`Üd
(
$ch¬aù”
);

161 
	}
}

169 
public
 
funùiÚ
 
	$CONCATENATE
()

171 
$»tuºV®ue
 = '';

174 
$aArgs
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
	`func_g‘_¬gs
());

175 
	`fÜ—ch
 (
$aArgs
 
as
 
$¬g
) {

176 ià(
	`is_boŞ
(
$¬g
)) {

177 ià(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘Com·tib™yMode
(è=ğPHPExûl_C®cuÏtiÚ_FunùiÚs::
COMPATIBILITY_OPENOFFICE
) {

178 
$¬g
 = () $arg;

180 
$¬g
 = ($¬gè? 
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
	`g‘FALSE
();

183 
$»tuºV®ue
 .ğ
$¬g
;

186  
$»tuºV®ue
;

187 
	}
}

202 
public
 
funùiÚ
 
	$DOLLAR
(
$v®ue
 = 0, 
$decim®s
 = 2)

204 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

205 
$decim®s
 = 
	`is_nuÎ
($decim®sè? 0 : 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($decimals);

208 ià(!
	`is_num”ic
(
$v®ue
è|| !is_num”ic(
$decim®s
)) {

209  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

211 
$decim®s
 = 
	`æoÜ
($decimals);

213 
$mask
 = '$#,##0';

214 ià(
$decim®s
 > 0) {

215 
$mask
 .ğ'.' . 
	`¡r_»³©
('0', 
$decim®s
);

217 
$round
 = 
	`pow
(10, 
	`abs
(
$decim®s
));

218 ià(
$v®ue
 < 0) {

219 
$round
 = 0-$round;

221 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`MROUND
($v®ue, 
$round
);

224  
PHPExûl_StyË_Numb”FÜm©
::
	`toFÜm©‹dSŒšg
(
$v®ue
, 
$mask
);

226 
	}
}

237 
public
 
funùiÚ
 
	$SEARCHSENSITIVE
(
$ÃedË
, 
$hay¡ack
, 
$off£t
 = 1)

239 
$ÃedË
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($needle);

240 
$hay¡ack
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($haystack);

241 
$off£t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($offset);

243 ià(!
	`is_boŞ
(
$ÃedË
)) {

244 ià(
	`is_boŞ
(
$hay¡ack
)) {

245 
$hay¡ack
 = ($hay¡ackè? 
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
	`g‘FALSE
();

248 ià((
$off£t
 > 0è&& (
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$hay¡ack
) > $offset)) {

249 ià(
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$ÃedË
) == 0) {

250  
$off£t
;

252 ià(
	`funùiÚ_exi¡s
('mb_strpos')) {

253 
$pos
 = 
	`mb_¡½os
(
$hay¡ack
, 
$ÃedË
, --
$off£t
, 'UTF-8');

255 
$pos
 = 
	`¡½os
(
$hay¡ack
, 
$ÃedË
, --
$off£t
);

257 ià(
$pos
 !=ğ
çl£
) {

258  ++
$pos
;

262  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

263 
	}
}

274 
public
 
funùiÚ
 
	$SEARCHINSENSITIVE
(
$ÃedË
, 
$hay¡ack
, 
$off£t
 = 1)

276 
$ÃedË
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($needle);

277 
$hay¡ack
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($haystack);

278 
$off£t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($offset);

280 ià(!
	`is_boŞ
(
$ÃedË
)) {

281 ià(
	`is_boŞ
(
$hay¡ack
)) {

282 
$hay¡ack
 = ($hay¡ackè? 
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
	`g‘FALSE
();

285 ià((
$off£t
 > 0è&& (
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$hay¡ack
) > $offset)) {

286 ià(
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$ÃedË
) == 0) {

287  
$off£t
;

289 ià(
	`funùiÚ_exi¡s
('mb_stripos')) {

290 
$pos
 = 
	`mb_¡ros
(
$hay¡ack
, 
$ÃedË
, --
$off£t
, 'UTF-8');

292 
$pos
 = 
	`¡ros
(
$hay¡ack
, 
$ÃedË
, --
$off£t
);

294 ià(
$pos
 !=ğ
çl£
) {

295  ++
$pos
;

299  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`VALUE
();

300 
	}
}

311 
public
 
funùiÚ
 
	$FIXEDFORMAT
(
$v®ue
, 
$decim®s
 = 2, 
$no_commas
 = 
çl£
)

313 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

314 
$decim®s
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($decimals);

315 
$no_commas
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($no_commas);

318 ià(!
	`is_num”ic
(
$v®ue
è|| !is_num”ic(
$decim®s
)) {

319  
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

321 
$decim®s
 = 
	`æoÜ
($decimals);

323 
$v®ueResuÉ
 = 
	`round
(
$v®ue
, 
$decim®s
);

324 ià(
$decim®s
 < 0) {

325 
$decim®s
 = 0;

327 ià(!
$no_commas
) {

328 
$v®ueResuÉ
 = 
	`numb”_fÜm©
($v®ueResuÉ, 
$decim®s
);

331  (
¡ršg
è
$v®ueResuÉ
;

332 
	}
}

342 
public
 
funùiÚ
 
LEFT
(
$v®ue
 = '', 
$ch¬s
 = 1)

344 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($value);

345 
	g$ch¬s
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$ch¬s
);

347 ià(
	g$ch¬s
 < 0) {

348  
	gPHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
();

351 ià(
is_boŞ
(
$v®ue
)) {

352 
	g$v®ue
 = (
$v®ue
è? 
PHPExûl_C®cuÏtiÚ
::
g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
g‘FALSE
();

355 ià(
funùiÚ_exi¡s
('mb_substr')) {

356  
mb_sub¡r
(
$v®ue
, 0, 
$ch¬s
, 'UTF-8');

358  
sub¡r
(
$v®ue
, 0, 
$ch¬s
);

371 
public
 
funùiÚ
 
MID
(
$v®ue
 = '', 
$¡¬t
 = 1, 
$ch¬s
 = 
nuÎ
)

373 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($value);

374 
	g$¡¬t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$¡¬t
);

375 
	g$ch¬s
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$ch¬s
);

377 ià((
	g$¡¬t
 < 1è|| (
	g$ch¬s
 < 0)) {

378  
	gPHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
();

381 ià(
is_boŞ
(
$v®ue
)) {

382 
	g$v®ue
 = (
$v®ue
è? 
PHPExûl_C®cuÏtiÚ
::
g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
g‘FALSE
();

385 ià(
funùiÚ_exi¡s
('mb_substr')) {

386  
mb_sub¡r
(
$v®ue
, --
$¡¬t
, 
$ch¬s
, 'UTF-8');

388  
sub¡r
(
$v®ue
, --
$¡¬t
, 
$ch¬s
);

400 
public
 
funùiÚ
 
RIGHT
(
$v®ue
 = '', 
$ch¬s
 = 1)

402 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($value);

403 
	g$ch¬s
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$ch¬s
);

405 ià(
	g$ch¬s
 < 0) {

406  
	gPHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
();

409 ià(
is_boŞ
(
$v®ue
)) {

410 
	g$v®ue
 = (
$v®ue
è? 
PHPExûl_C®cuÏtiÚ
::
g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
g‘FALSE
();

413 ià((
funùiÚ_exi¡s
('mb_substr')) && (function_exists('mb_strlen'))) {

414  
mb_sub¡r
(
$v®ue
, 
mb_¡¾’
($v®ue, 'UTF-8'è- 
$ch¬s
, $chars, 'UTF-8');

416  
sub¡r
(
$v®ue
, 
¡¾’
($v®ueè- 
$ch¬s
);

427 
public
 
funùiÚ
 
STRINGLENGTH
(
$v®ue
 = '')

429 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($value);

431 ià(
is_boŞ
(
$v®ue
)) {

432 
	g$v®ue
 = (
$v®ue
è? 
PHPExûl_C®cuÏtiÚ
::
g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
g‘FALSE
();

435 ià(
funùiÚ_exi¡s
('mb_strlen')) {

436  
mb_¡¾’
(
$v®ue
, 'UTF-8');

438  
¡¾’
(
$v®ue
);

451 
public
 
funùiÚ
 
	$LOWERCASE
(
$mixedCa£SŒšg
)

453 
$mixedCa£SŒšg
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($mixedCaseString);

455 ià(
	`is_boŞ
(
$mixedCa£SŒšg
)) {

456 
$mixedCa£SŒšg
 = ($mixedCa£SŒšgè? 
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
	`g‘FALSE
();

459  
PHPExûl_Sh¬ed_SŒšg
::
	`SŒToLow”
(
$mixedCa£SŒšg
);

460 
	}
}

471 
public
 
funùiÚ
 
	$UPPERCASE
(
$mixedCa£SŒšg
)

473 
$mixedCa£SŒšg
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($mixedCaseString);

475 ià(
	`is_boŞ
(
$mixedCa£SŒšg
)) {

476 
$mixedCa£SŒšg
 = ($mixedCa£SŒšgè? 
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
	`g‘FALSE
();

479  
PHPExûl_Sh¬ed_SŒšg
::
	`SŒToUµ”
(
$mixedCa£SŒšg
);

480 
	}
}

491 
public
 
funùiÚ
 
	$PROPERCASE
(
$mixedCa£SŒšg
)

493 
$mixedCa£SŒšg
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($mixedCaseString);

495 ià(
	`is_boŞ
(
$mixedCa£SŒšg
)) {

496 
$mixedCa£SŒšg
 = ($mixedCa£SŒšgè? 
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
(è: PHPExûl_C®cuÏtiÚ::
	`g‘FALSE
();

499  
PHPExûl_Sh¬ed_SŒšg
::
	`SŒToT™Ë
(
$mixedCa£SŒšg
);

500 
	}
}

512 
public
 
funùiÚ
 
REPLACE
(
$ŞdText
 = '', 
$¡¬t
 = 1, 
$ch¬s
 = 
nuÎ
, 
$ÃwText
)

514 
	g$ŞdText
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$ŞdText
);

515 
	g$¡¬t
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$¡¬t
);

516 
	g$ch¬s
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$ch¬s
);

517 
	g$ÃwText
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$ÃwText
);

519 
	g$Ëá
 = 
£lf
::
LEFT
(
$ŞdText
, 
$¡¬t
-1);

520 
	g$right
 = 
£lf
::
RIGHT
(
$ŞdText
, s–f::
STRINGLENGTH
($ŞdText)-(
$¡¬t
+
$ch¬s
)+1);

522  
	g$Ëá
.
	g$ÃwText
.
	g$right
;

535 
public
 
funùiÚ
 
SUBSTITUTE
(
$‹xt
 = '', 
$äomText
 = '', 
$toText
 = '', 
$š¡ªû
 = 0)

537 
$‹xt
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($text);

538 
	g$äomText
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$äomText
);

539 
	g$toText
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$toText
);

540 
	g$š¡ªû
 = 
æoÜ
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
(
$š¡ªû
));

542 ià(
	g$š¡ªû
 == 0) {

543 ià(
funùiÚ_exi¡s
('mb_str_replace')) {

544  
mb_¡r_»¶aû
(
$äomText
, 
$toText
, 
$‹xt
);

546  
¡r_»¶aû
(
$äomText
, 
$toText
, 
$‹xt
);

549 
	g$pos
 = -1;

550 
	g$š¡ªû
 > 0) {

551 ià(
funùiÚ_exi¡s
('mb_strpos')) {

552 
	g$pos
 = 
mb_¡½os
(
$‹xt
, 
$äomText
, 
$pos
+1, 'UTF-8');

554 
	g$pos
 = 
¡½os
(
$‹xt
, 
$äomText
, 
$pos
+1);

556 ià(
	g$pos
 ==ğ
çl£
) {

559 --
	g$š¡ªû
;

561 ià(
	g$pos
 !=ğ
çl£
) {

562 ià(
funùiÚ_exi¡s
('mb_strlen')) {

563  
£lf
::
REPLACE
(
$‹xt
, ++
$pos
, 
mb_¡¾’
(
$äomText
, 'UTF-8'), 
$toText
);

565  
	g£lf
::
REPLACE
(
$‹xt
, ++
$pos
, 
¡¾’
(
$äomText
), 
$toText
);

570  
	g$‹xt
;

580 
public
 
funùiÚ
 
RETURNSTRING
(
$‹¡V®ue
 = '')

582 
$‹¡V®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($testValue);

584 ià(
is_¡ršg
(
$‹¡V®ue
)) {

585  
	g$‹¡V®ue
;

587  
	gnuÎ
;

598 
public
 
funùiÚ
 
	$TEXTFORMAT
(
$v®ue
, 
$fÜm©
)

600 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($value);

601 
$fÜm©
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nSšgËV®ue
($format);

603 ià((
	`is_¡ršg
(
$v®ue
)è&& (!
	`is_num”ic
($v®ue)è&& 
PHPExûl_Sh¬ed_D©e
::
	`isD©eTimeFÜm©Code
(
$fÜm©
)) {

604 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`DATEVALUE
($value);

607  (
¡ršg
è
PHPExûl_StyË_Numb”FÜm©
::
	`toFÜm©‹dSŒšg
(
$v®ue
, 
$fÜm©
);

608 
	}
}

616 
public
 
funùiÚ
 
VALUE
(
$v®ue
 = '')

618 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nSšgËV®ue
($value);

620 ià(!
is_num”ic
(
$v®ue
)) {

621 
	g$numb”V®ue
 = 
¡r_»¶aû
(

622 
PHPExûl_Sh¬ed_SŒšg
::
g‘Thou§ndsS•¬©Ü
(),

624 
Œim
(
$v®ue
, " \t\n\r\0\x0B" . 
PHPExûl_Sh¬ed_SŒšg
::
g‘Cu¼’cyCode
())

626 ià(
is_num”ic
(
$numb”V®ue
)) {

627  (è
	g$numb”V®ue
;

630 
	g$d©eS‘tšg
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
g‘R‘uºD©eTy³
();

631 
	gPHPExûl_C®cuÏtiÚ_FunùiÚs
::
£tR‘uºD©eTy³
(
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
RETURNDATE_EXCEL
);

633 ià(
¡½os
(
$v®ue
, ':'è!=ğ
çl£
) {

634 
$timeV®ue
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
TIMEVALUE
(
$v®ue
);

635 ià(
	g$timeV®ue
 !=ğ
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
()) {

636 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
£tR‘uºD©eTy³
(
$d©eS‘tšg
);

637  
	g$timeV®ue
;

640 
	g$d©eV®ue
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
DATEVALUE
(
$v®ue
);

641 ià(
	g$d©eV®ue
 !=ğ
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
()) {

642 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
£tR‘uºD©eTy³
(
$d©eS‘tšg
);

643  
	g$d©eV®ue
;

645 
	gPHPExûl_C®cuÏtiÚ_FunùiÚs
::
£tR‘uºD©eTy³
(
$d©eS‘tšg
);

647  
	gPHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
();

649  (è
	g$v®ue
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Token/Stack.php

1 <?
php


28 şas 
	cPHPExûl_C®cuÏtiÚ_Tok’_Sck


35 
´iv©e
 
	m$¡ack
 = 
¬¿y
();

42 
´iv©e
 
	m$couÁ
 = 0;

49 
public
 
funùiÚ
 
	$couÁ
()

51  
$this
->
couÁ
;

61 
public
 
funùiÚ
 
	$push
(
$ty³
, 
$v®ue
, 
$»ã»nû
 = 
nuÎ
)

63 
$this
->
¡ack
[$this->
couÁ
++] = 
	`¬¿y
(

64 'ty³' => 
$ty³
,

65 'v®ue' => 
$v®ue
,

66 '»ã»nû' => 
$»ã»nû


68 ià(
$ty³
 == 'Function') {

69 
$loÿËFunùiÚ
 = 
PHPExûl_C®cuÏtiÚ
::
	`loÿËFunc
(
$v®ue
);

70 ià(
$loÿËFunùiÚ
 !ğ
$v®ue
) {

71 
$this
->
¡ack
[($this->
couÁ
 - 1)]['loÿËV®ue'] = 
$loÿËFunùiÚ
;

74 
	}
}

81 
public
 
funùiÚ
 
	$pİ
()

83 ià(
$this
->
couÁ
 > 0) {

84  
$this
->
¡ack
[--$this->
couÁ
];

86  
nuÎ
;

87 
	}
}

95 
public
 
funùiÚ
 
	$Ï¡
(
$n
 = 1)

97 ià(
$this
->
couÁ
 - 
$n
 < 0) {

98  
nuÎ
;

100  
$this
->
¡ack
[$this->
couÁ
 - 
$n
];

101 
	}
}

106 
public
 
funùiÚ
 
	$ş—r
()

108 
$this
->
¡ack
 = 
	`¬¿y
();

109 
$this
->
couÁ
 = 0;

110 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell.php

1 <?
php


28 şas 
	cPHPExûl_C–l


35 cÚ¡ 
	mDEFAULT_RANGE
 = 'A1:A1';

42 
´iv©e
 
	m$v®ueBšd”
;

49 
´iv©e
 
	m$v®ue
;

61 
´iv©e
 
	m$ÿlcuÏ‹dV®ue
;

68 
´iv©e
 
	m$d©aTy³
;

75 
´iv©e
 
	m$·»Á
;

82 
´iv©e
 
	m$xfIndex
 = 0;

88 
´iv©e
 
	m$fÜmuÏA‰ribu‹s
;

96 
public
 
funùiÚ
 
	$nÙifyCacheCÚŒŞËr
()

98 
$this
->
·»Á
->
	`upd©eCacheD©a
($this);

100  
$this
;

103 
public
 
funùiÚ
 
	$d‘ach
()

105 
$this
->
·»Á
 = 
nuÎ
;

106 
	}
}

108 
public
 
funùiÚ
 
	$©ch
(
PHPExûl_CachedObjeùStÜage_CacheBa£
 
$·»Á
)

110 
$this
->
·»Á
 = 
$·»Á
;

111 
	}
}

122 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$pV®ue
 = 
nuÎ
, 
$pD©aTy³
 =‚uÎ, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

125 
$this
->
v®ue
 = 
$pV®ue
;

128 
$this
->
·»Á
 = 
$pSh“t
->
	`g‘C–lCacheCÚŒŞËr
();

131 ià(
$pD©aTy³
 !=ğ
nuÎ
) {

132 ià(
$pD©aTy³
 =ğ
PHPExûl_C–l_D©aTy³
::
TYPE_STRING2
) {

133 
$pD©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

135 
$this
->
d©aTy³
 = 
$pD©aTy³
;

136 } 
	`–£if
 (!
£lf
::
	`g‘V®ueBšd”
()->
	`bšdV®ue
(
$this
, 
$pV®ue
)) {

137 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Value could‚ot be boundo cell.");

139 
	}
}

146 
public
 
funùiÚ
 
	$g‘CŞumn
()

148  
$this
->
·»Á
->
	`g‘Cu¼’tCŞumn
();

149 
	}
}

156 
public
 
funùiÚ
 
	$g‘Row
()

158  
$this
->
·»Á
->
	`g‘Cu¼’tRow
();

159 
	}
}

166 
public
 
funùiÚ
 
	$g‘CoÜdš©e
()

168  
$this
->
·»Á
->
	`g‘Cu¼’tAdd»ss
();

169 
	}
}

176 
public
 
funùiÚ
 
	$g‘V®ue
()

178  
$this
->
v®ue
;

179 
	}
}

186 
public
 
funùiÚ
 
	$g‘FÜm©‹dV®ue
()

188  (
¡ršg
è
PHPExûl_StyË_Numb”FÜm©
::
	`toFÜm©‹dSŒšg
(

189 
$this
->
	`g‘C®cuÏ‹dV®ue
(),

190 
$this
->
	`g‘StyË
()

191 ->
	`g‘Numb”FÜm©
()->
	`g‘FÜm©Code
()

193 
	}
}

204 
public
 
funùiÚ
 
	$£tV®ue
(
$pV®ue
 = 
nuÎ
)

206 ià(!
£lf
::
	`g‘V®ueBšd”
()->
	`bšdV®ue
(
$this
, 
$pV®ue
)) {

207 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Value could‚ot be boundo cell.");

209  
$this
;

210 
	}
}

220 
public
 
funùiÚ
 
	$£tV®ueEx¶ic™
(
$pV®ue
 = 
nuÎ
, 
$pD©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
)

223 
$pD©aTy³
) {

224 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
:

225 
$this
->
v®ue
 = 
$pV®ue
;

227 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING2
:

228 
$pD©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

230 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
:

232 
PHPExûl_C–l_D©aTy³
::
TYPE_INLINE
:

234 
$this
->
v®ue
 = 
PHPExûl_C–l_D©aTy³
::
	`checkSŒšg
(
$pV®ue
);

236 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
:

237 
$this
->
v®ue
 = (è
$pV®ue
;

239 
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
:

240 
$this
->
v®ue
 = (
¡ršg
è
$pV®ue
;

242 
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
:

243 
$this
->
v®ue
 = (
boŞ
è
$pV®ue
;

245 
PHPExûl_C–l_D©aTy³
::
TYPE_ERROR
:

246 
$this
->
v®ue
 = 
PHPExûl_C–l_D©aTy³
::
	`checkE¼ÜCode
(
$pV®ue
);

249 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Inv®id d©©y³: ' . 
$pD©aTy³
);

254 
$this
->
d©aTy³
 = 
$pD©aTy³
;

256  
$this
->
	`nÙifyCacheCÚŒŞËr
();

257 
	}
}

268 
public
 
funùiÚ
 
	$g‘C®cuÏ‹dV®ue
(
$»£tLog
 = 
Œue
)

271 ià(
$this
->
d©aTy³
 =ğ
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
) {

272 
Œy
 {

274 
$»suÉ
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(

275 
$this
->
	`g‘WÜksh“t
()->
	`g‘P¬’t
()

276 )->
	`ÿlcuÏ‹C–lV®ue
(
$this
, 
$»£tLog
);

279 ià(
	`is_¬¿y
(
$»suÉ
)) {

280 
	`is_¬¿y
(
$»suÉ
)) {

281 
$»suÉ
 = 
	`¬¿y_pİ
($result);

284 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$ex
) {

285 ià((
$ex
->
	`g‘Mes§ge
(è==ğ'UÇbËØacûs Ex‹º® WÜkbook'è&& (
$this
->
ÿlcuÏ‹dV®ue
 !=ğ
nuÎ
)) {

287  
$this
->
ÿlcuÏ‹dV®ue
;

290 
$»suÉ
 = '#N/A';

291 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(

292 
$this
->
	`g‘WÜksh“t
()->
	`g‘T™Ë
().'!'.$this->
	`g‘CoÜdš©e
().' -> '.
$ex
->
	`g‘Mes§ge
()

296 ià(
$»suÉ
 === '#Not Yet Implemented') {

298  
$this
->
ÿlcuÏ‹dV®ue
;

301  
$»suÉ
;

302 } 
	`–£if
 (
$this
->
v®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

304  
$this
->
v®ue
->
	`g‘PÏšText
();

307  
$this
->
v®ue
;

308 
	}
}

316 
public
 
funùiÚ
 
	$£tC®cuÏ‹dV®ue
(
$pV®ue
 = 
nuÎ
)

318 ià(
$pV®ue
 !=ğ
nuÎ
) {

319 
$this
->
ÿlcuÏ‹dV®ue
 = (
	`is_num”ic
(
$pV®ue
)) ? () $pValue : $pValue;

322  
$this
->
	`nÙifyCacheCÚŒŞËr
();

323 
	}
}

335 
public
 
funùiÚ
 
	$g‘OldC®cuÏ‹dV®ue
()

337  
$this
->
ÿlcuÏ‹dV®ue
;

338 
	}
}

345 
public
 
funùiÚ
 
	$g‘D©aTy³
()

347  
$this
->
d©aTy³
;

348 
	}
}

356 
public
 
funùiÚ
 
	$£tD©aTy³
(
$pD©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
)

358 ià(
$pD©aTy³
 =ğ
PHPExûl_C–l_D©aTy³
::
TYPE_STRING2
) {

359 
$pD©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

361 
$this
->
d©aTy³
 = 
$pD©aTy³
;

363  
$this
->
	`nÙifyCacheCÚŒŞËr
();

364 
	}
}

371 
public
 
funùiÚ
 
	$isFÜmuÏ
()

373  
$this
->
d©aTy³
 =ğ
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
;

374 
	}
}

382 
public
 
funùiÚ
 
	$hasD©aV®id©iÚ
()

384 ià(!
	`is£t
(
$this
->
·»Á
)) {

385 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Cannot check for data validation when cell is‚ot boundo‡ worksheet');

388  
$this
->
	`g‘WÜksh“t
()->
	`d©aV®id©iÚExi¡s
($this->
	`g‘CoÜdš©e
());

389 
	}
}

397 
public
 
funùiÚ
 
	$g‘D©aV®id©iÚ
()

399 ià(!
	`is£t
(
$this
->
·»Á
)) {

400 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Cannot get data validation for cellhat is‚ot boundo‡ worksheet');

403  
$this
->
	`g‘WÜksh“t
()->
	`g‘D©aV®id©iÚ
($this->
	`g‘CoÜdš©e
());

404 
	}
}

413 
public
 
funùiÚ
 
	$£tD©aV®id©iÚ
(
PHPExûl_C–l_D©aV®id©iÚ
 
$pD©aV®id©iÚ
 = 
nuÎ
)

415 ià(!
	`is£t
(
$this
->
·»Á
)) {

416 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Cannot set data validation for cellhat is‚ot boundo‡ worksheet');

419 
$this
->
	`g‘WÜksh“t
()->
	`£tD©aV®id©iÚ
($this->
	`g‘CoÜdš©e
(), 
$pD©aV®id©iÚ
);

421  
$this
->
	`nÙifyCacheCÚŒŞËr
();

422 
	}
}

430 
public
 
funùiÚ
 
	$hasHy³¾šk
()

432 ià(!
	`is£t
(
$this
->
·»Á
)) {

433 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Cannot check for hyperlink when cell is‚ot boundo‡ worksheet');

436  
$this
->
	`g‘WÜksh“t
()->
	`hy³¾škExi¡s
($this->
	`g‘CoÜdš©e
());

437 
	}
}

445 
public
 
funùiÚ
 
	$g‘Hy³¾šk
()

447 ià(!
	`is£t
(
$this
->
·»Á
)) {

448 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Cannot get hyperlink for cellhat is‚ot boundo‡ worksheet');

451  
$this
->
	`g‘WÜksh“t
()->
	`g‘Hy³¾šk
($this->
	`g‘CoÜdš©e
());

452 
	}
}

461 
public
 
funùiÚ
 
	$£tHy³¾šk
(
PHPExûl_C–l_Hy³¾šk
 
$pHy³¾šk
 = 
nuÎ
)

463 ià(!
	`is£t
(
$this
->
·»Á
)) {

464 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Cannot set hyperlink for cellhat is‚ot boundo‡ worksheet');

467 
$this
->
	`g‘WÜksh“t
()->
	`£tHy³¾šk
($this->
	`g‘CoÜdš©e
(), 
$pHy³¾šk
);

469  
$this
->
	`nÙifyCacheCÚŒŞËr
();

470 
	}
}

477 
public
 
funùiÚ
 
	$g‘P¬’t
()

479  
$this
->
·»Á
;

480 
	}
}

487 
public
 
funùiÚ
 
	$g‘WÜksh“t
()

489  
$this
->
·»Á
->
	`g‘P¬’t
();

490 
	}
}

497 
public
 
funùiÚ
 
	$isInM”geRªge
()

499  (
boŞ—n
è
$this
->
	`g‘M”geRªge
();

500 
	}
}

507 
public
 
funùiÚ
 
	$isM”geRªgeV®ueC–l
()

509 ià(
$m”geRªge
 = 
$this
->
	`g‘M”geRªge
()) {

510 
$m”geRªge
 = 
PHPExûl_C–l
::
	`¥l™Rªge
($mergeRange);

511 
	`li¡
(
$¡¬tC–l
èğ
$m”geRªge
[0];

512 ià(
$this
->
	`g‘CoÜdš©e
(è==ğ
$¡¬tC–l
) {

513  
Œue
;

516  
çl£
;

517 
	}
}

524 
public
 
funùiÚ
 
	$g‘M”geRªge
()

526 
	`fÜ—ch
 (
$this
->
	`g‘WÜksh“t
()->
	`g‘M”geC–ls
(è
as
 
$m”geRªge
) {

527 ià(
$this
->
	`isInRªge
(
$m”geRªge
)) {

528  
$m”geRªge
;

531  
çl£
;

532 
	}
}

539 
public
 
funùiÚ
 
	$g‘StyË
()

541  
$this
->
	`g‘WÜksh“t
()->
	`g‘StyË
($this->
	`g‘CoÜdš©e
());

542 
	}
}

550 
public
 
funùiÚ
 
	$»bšdP¬’t
(
PHPExûl_WÜksh“t
 
$·»Á
)

552 
$this
->
·»Á
 = 
$·»Á
->
	`g‘C–lCacheCÚŒŞËr
();

554  
$this
->
	`nÙifyCacheCÚŒŞËr
();

555 
	}
}

563 
public
 
funùiÚ
 
isInRªge
(
$pRªge
 = 'A1:A1')

565 
li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
£lf
::
¿ngeBound¬›s
(
$pRªge
);

568 
	g$myCŞumn
 = 
£lf
::
cŞumnIndexFromSŒšg
(
$this
->
g‘CŞumn
());

569 
	g$myRow
 = 
$this
->
g‘Row
();

572  ((
	g$¿ngeS¹
[0] <ğ
$myCŞumn
è&& (
$¿ngeEnd
[0] >= $myColumn) &&

573 (
$¿ngeS¹
[1] <ğ
$myRow
è&& (
$¿ngeEnd
[1] >= $myRow)

584 
public
 
funùiÚ
 
coÜdš©eFromSŒšg
(
$pCoÜdš©eSŒšg
 = 'A1')

586 ià(
´eg_m©ch
("/^([$]?[A-Z]{1,3})([$]?\d{1,7})$/", 
$pCoÜdš©eSŒšg
, 
$m©ches
)) {

587  
¬¿y
(
$m©ches
[1],$matches[2]);

588 } 
–£if
 ((
¡½os
(
$pCoÜdš©eSŒšg
, ':'è!=ğ
çl£
) || (strpos($pCoordinateString, ',') !== false)) {

589 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate string can‚ot be‡„ange of cells');

590 } 
–£if
 (
$pCoÜdš©eSŒšg
 == '') {

591 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate can‚ot be zero-length string');

594 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Inv®id c–ÈcoÜdš©'.
$pCoÜdš©eSŒšg
);

605 
public
 
funùiÚ
 
absŞu‹Reã»nû
(
$pCoÜdš©eSŒšg
 = 'A1')

607 ià(
¡½os
(
$pCoÜdš©eSŒšg
, ':'è==ğ
çl£
 && strpos($pCoordinateString, ',') === false) {

609 
$wÜksh“t
 = '';

610 
	g$ûÎAdd»ss
 = 
ex¶ode
('!', 
$pCoÜdš©eSŒšg
);

611 ià(
couÁ
(
$ûÎAdd»ss
) > 1) {

612 
li¡
(
$wÜksh“t
, 
$pCoÜdš©eSŒšg
èğ
$ûÎAdd»ss
;

614 ià(
	g$wÜksh“t
 > '') {

615 
	g$wÜksh“t
 .= '!';

619 ià(
ùy³_dig™
(
$pCoÜdš©eSŒšg
)) {

620  
	g$wÜksh“t
 . '$' . 
	g$pCoÜdš©eSŒšg
;

621 } 
–£if
 (
ùy³_®pha
(
$pCoÜdš©eSŒšg
)) {

622  
	g$wÜksh“t
 . '$' . 
¡¹ouµ”
(
$pCoÜdš©eSŒšg
);

624  
	g$wÜksh“t
 . 
	g£lf
::
absŞu‹CoÜdš©e
(
$pCoÜdš©eSŒšg
);

627 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate string can‚ot be‡„ange of cells');

637 
public
 
funùiÚ
 
absŞu‹CoÜdš©e
(
$pCoÜdš©eSŒšg
 = 'A1')

639 ià(
¡½os
(
$pCoÜdš©eSŒšg
, ':'è==ğ
çl£
 && strpos($pCoordinateString, ',') === false) {

641 
$wÜksh“t
 = '';

642 
	g$ûÎAdd»ss
 = 
ex¶ode
('!', 
$pCoÜdš©eSŒšg
);

643 ià(
couÁ
(
$ûÎAdd»ss
) > 1) {

644 
li¡
(
$wÜksh“t
, 
$pCoÜdš©eSŒšg
èğ
$ûÎAdd»ss
;

646 ià(
	g$wÜksh“t
 > '') {

647 
	g$wÜksh“t
 .= '!';

651 
li¡
(
$cŞumn
, 
$row
èğ
£lf
::
coÜdš©eFromSŒšg
(
$pCoÜdš©eSŒšg
);

652 
	g$cŞumn
 = 
Érim
(
$cŞumn
, '$');

653 
	g$row
 = 
Érim
(
$row
, '$');

654  
	g$wÜksh“t
 . '$' . 
	g$cŞumn
 . '$' . 
	g$row
;

657 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate string can‚ot be‡„ange of cells');

668 
public
 
funùiÚ
 
¥l™Rªge
(
$pRªge
 = 'A1:A1')

671 ià(
em±y
(
$pRªge
)) {

672 
$pRªge
 = 
£lf
::
DEFAULT_RANGE
;

675 
	g$ex¶oded
 = 
ex¶ode
(',', 
$pRªge
);

676 
	g$couÁ”
 = 
couÁ
(
$ex¶oded
);

677 
	g$i
 = 0; $˜< 
	g$couÁ”
; ++$i) {

678 
	g$ex¶oded
[
$i
] = 
ex¶ode
(':', 
$ex¶oded
[$i]);

680  
	g$ex¶oded
;

690 
public
 
funùiÚ
 
	$budRªge
(
$pRªge
)

693 ià(!
	`is_¬¿y
(
$pRªge
è|| 
	`em±y
($pRange) || !is_array($pRange[0])) {

694 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Range does‚ot contain‡ny information');

698 
$im¶oded
 = 
	`¬¿y
();

699 
$couÁ”
 = 
	`couÁ
(
$pRªge
);

700 
$i
 = 0; $˜< 
$couÁ”
; ++$i) {

701 
$pRªge
[
$i
] = 
	`im¶ode
(':', $pRange[$i]);

703 
$im¶oded
 = 
	`im¶ode
(',', 
$pRªge
);

705  
$im¶oded
;

706 
	}
}

715 
public
 
funùiÚ
 
¿ngeBound¬›s
(
$pRªge
 = 'A1:A1')

718 ià(
em±y
(
$pRªge
)) {

719 
$pRªge
 = 
£lf
::
DEFAULT_RANGE
;

723 
	g$pRªge
 = 
¡¹ouµ”
(
$pRªge
);

726 ià(
¡½os
(
$pRªge
, ':'è==ğ
çl£
) {

727 
$¿ngeA
 = 
$¿ngeB
 = 
$pRªge
;

729 
li¡
(
$¿ngeA
, 
$¿ngeB
èğ
ex¶ode
(':', 
$pRªge
);

733 
	g$¿ngeS¹
 = 
£lf
::
coÜdš©eFromSŒšg
(
$¿ngeA
);

734 
	g$¿ngeEnd
 = 
£lf
::
coÜdš©eFromSŒšg
(
$¿ngeB
);

737 
	g$¿ngeS¹
[0] = 
£lf
::
cŞumnIndexFromSŒšg
(
$¿ngeS¹
[0]);

738 
	g$¿ngeEnd
[0] = 
£lf
::
cŞumnIndexFromSŒšg
(
$¿ngeEnd
[0]);

740  
¬¿y
(
$¿ngeS¹
, 
$¿ngeEnd
);

749 
public
 
funùiÚ
 
¿ngeDim’siÚ
(
$pRªge
 = 'A1:A1')

752 
li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
£lf
::
¿ngeBound¬›s
(
$pRªge
);

754  
¬¿y
Ğ(
$¿ngeEnd
[0] - 
$¿ngeS¹
[0] + 1), ($rangeEnd[1] - $rangeStart[1] + 1) );

764 
public
 
funùiÚ
 
g‘RªgeBound¬›s
(
$pRªge
 = 'A1:A1')

767 ià(
em±y
(
$pRªge
)) {

768 
$pRªge
 = 
£lf
::
DEFAULT_RANGE
;

772 
	g$pRªge
 = 
¡¹ouµ”
(
$pRªge
);

775 ià(
¡½os
(
$pRªge
, ':'è==ğ
çl£
) {

776 
$¿ngeA
 = 
$¿ngeB
 = 
$pRªge
;

778 
li¡
(
$¿ngeA
, 
$¿ngeB
èğ
ex¶ode
(':', 
$pRªge
);

781  
¬¿y
Ğ
£lf
::
coÜdš©eFromSŒšg
(
$¿ngeA
), s–f::coÜdš©eFromSŒšg(
$¿ngeB
));

790 
public
 
funùiÚ
 
cŞumnIndexFromSŒšg
(
$pSŒšg
 = 'A')

795 
$_šdexCache
 = 
¬¿y
();

797 ià(
is£t
(
$_šdexCache
[
$pSŒšg
])) {

798  
	g$_šdexCache
[
$pSŒšg
];

803 
	g$_cŞumnLookup
 = 
¬¿y
(

812 ià(
is£t
(
$pSŒšg
{0})) {

813 ià(!
is£t
(
$pSŒšg
{1})) {

814 
	g$_šdexCache
[
$pSŒšg
] = 
$_cŞumnLookup
[$pString];

815  
	g$_šdexCache
[
$pSŒšg
];

816 } 
–£if
 (!
is£t
(
$pSŒšg
{2})) {

817 
	g$_šdexCache
[
$pSŒšg
] = 
$_cŞumnLookup
[$pString{0}] * 26 + $_columnLookup[$pString{1}];

818  
	g$_šdexCache
[
$pSŒšg
];

819 } 
–£if
 (!
is£t
(
$pSŒšg
{3})) {

820 
	g$_šdexCache
[
$pSŒšg
] = 
$_cŞumnLookup
[$pString{0}] * 676 + $_columnLookup[$pString{1}] * 26 + $_columnLookup[$pString{2}];

821  
	g$_šdexCache
[
$pSŒšg
];

824 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
("CŞumÀ¡ršg index cª‚Ù b" . ((
is£t
(
$pSŒšg
{0})) ? "longerhan 3 characters" : "empty"));

833 
public
 
funùiÚ
 
	$¡ršgFromCŞumnIndex
(
$pCŞumnIndex
 = 0)

838 
$_šdexCache
 = 
	`¬¿y
();

840 ià(!
	`is£t
(
$_šdexCache
[
$pCŞumnIndex
])) {

842 ià(
$pCŞumnIndex
 < 26) {

843 
$_šdexCache
[
$pCŞumnIndex
] = 
	`chr
(65 + $pColumnIndex);

844 } 
	`–£if
 (
$pCŞumnIndex
 < 702) {

845 
$_šdexCache
[
$pCŞumnIndex
] = 
	`chr
(64 + ($pColumnIndex / 26)) .

846 
	`chr
(65 + 
$pCŞumnIndex
 % 26);

848 
$_šdexCache
[
$pCŞumnIndex
] = 
	`chr
(64 + (($pColumnIndex - 26) / 676)) .

849 
	`chr
(65 + (((
$pCŞumnIndex
 - 26) % 676) / 26)) .

850 
	`chr
(65 + 
$pCŞumnIndex
 % 26);

853  
$_šdexCache
[
$pCŞumnIndex
];

854 
	}
}

862 
public
 
funùiÚ
 
exŒaùAÎC–lReã»nûsInRªge
(
$pRªge
 = 'A1')

865 
$»tuºV®ue
 = 
¬¿y
();

868 
	g$ûÎBlocks
 = 
ex¶ode
(' ', 
¡r_»¶aû
('$', '', 
¡¹ouµ”
(
$pRªge
)));

869 
fÜ—ch
 (
$ûÎBlocks
 
as
 
$ûÎBlock
) {

871 ià(
¡½os
(
$ûÎBlock
, ':'è==ğ
çl£
 && strpos($cellBlock, ',') === false) {

872 
$»tuºV®ue
[] = 
$ûÎBlock
;

877 
	g$¿nges
 = 
£lf
::
¥l™Rªge
(
$ûÎBlock
);

878 
fÜ—ch
 (
$¿nges
 
as
 
$¿nge
) {

880 ià(!
is£t
(
$¿nge
[1])) {

881 
	g$»tuºV®ue
[] = 
$¿nge
[0];

886 
li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
$¿nge
;

887 
ssÿnf
(
$¿ngeS¹
, '%[A-Z]%d', 
$¡¬tCŞ
, 
$¡¬tRow
);

888 
ssÿnf
(
$¿ngeEnd
, '%[A-Z]%d', 
$’dCŞ
, 
$’dRow
);

889 ++
	g$’dCŞ
;

892 
	g$cu¼’tCŞ
 = 
$¡¬tCŞ
;

893 
	g$cu¼’tRow
 = 
$¡¬tRow
;

896 
	g$cu¼’tCŞ
 !ğ
$’dCŞ
) {

897 
$cu¼’tRow
 <ğ
$’dRow
) {

898 
$»tuºV®ue
[] = 
$cu¼’tCŞ
.
$cu¼’tRow
;

899 ++
	g$cu¼’tRow
;

901 ++
	g$cu¼’tCŞ
;

902 
	g$cu¼’tRow
 = 
$¡¬tRow
;

908 
	g$sÜtKeys
 = 
¬¿y
();

909 
fÜ—ch
 (
¬¿y_unique
(
$»tuºV®ue
è
as
 
$coÜd
) {

910 
ssÿnf
(
$coÜd
, '%[A-Z]%d', 
$cŞumn
, 
$row
);

911 
	g$sÜtKeys
[
¥rštf
('%3s%09d', 
$cŞumn
, 
$row
)] = 
$coÜd
;

913 
ksÜt
(
$sÜtKeys
);

916  
¬¿y_v®ues
(
$sÜtKeys
);

926 
public
 
funùiÚ
 
	$com·»C–ls
(
PHPExûl_C–l
 
$a
, PHPExûl_C–È
$b
)

928 ià(
$a
->
	`g‘Row
(è< 
$b
->getRow()) {

930 } 
	`–£if
 (
$a
->
	`g‘Row
(è> 
$b
->getRow()) {

932 } 
	`–£if
 (
£lf
::
	`cŞumnIndexFromSŒšg
(
$a
->
	`g‘CŞumn
()è< s–f::cŞumnIndexFromSŒšg(
$b
->getColumn())) {

937 
	}
}

944 
public
 
funùiÚ
 
	$g‘V®ueBšd”
()

946 ià(
£lf
::
$v®ueBšd”
 ==ğ
nuÎ
) {

947 
£lf
::
$v®ueBšd”
 = 
Ãw
 
	`PHPExûl_C–l_DeçuÉV®ueBšd”
();

950  
£lf
::
$v®ueBšd”
;

951 
	}
}

959 
public
 
funùiÚ
 
	$£tV®ueBšd”
(
PHPExûl_C–l_IV®ueBšd”
 
$bšd”
 = 
nuÎ
)

961 ià(
$bšd”
 ==ğ
nuÎ
) {

962 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("A PHPExcel_Cell_IValueBinder is„equired for PHPExcelo function correctly.");

965 
£lf
::
$v®ueBšd”
 = 
$bšd”
;

966 
	}
}

971 
public
 
funùiÚ
 
	$__şÚe
()

973 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

974 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

975 ià((
	`is_objeù
(
$v®ue
)è&& (
$key
 != 'parent')) {

976 
$this
->
$key
 = 
şÚe
 
$v®ue
;

978 
$this
->
$key
 = 
$v®ue
;

981 
	}
}

988 
public
 
funùiÚ
 
	$g‘XfIndex
()

990  
$this
->
xfIndex
;

991 
	}
}

999 
public
 
funùiÚ
 
	$£tXfIndex
(
$pV®ue
 = 0)

1001 
$this
->
xfIndex
 = 
$pV®ue
;

1003  
$this
->
	`nÙifyCacheCÚŒŞËr
();

1004 
	}
}

1009 
public
 
funùiÚ
 
	$£tFÜmuÏA‰ribu‹s
(
$pA‰ribu‹s
)

1011 
$this
->
fÜmuÏA‰ribu‹s
 = 
$pA‰ribu‹s
;

1012  
$this
;

1013 
	}
}

1018 
public
 
funùiÚ
 
	$g‘FÜmuÏA‰ribu‹s
()

1020  
$this
->
fÜmuÏA‰ribu‹s
;

1021 
	}
}

1028 
public
 
funùiÚ
 
	$__toSŒšg
()

1030  (
¡ršg
è
$this
->
	`g‘V®ue
();

1031 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/AdvancedValueBinder.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_C–l_AdvªûdV®ueBšd”
 
ex‹nds
 
PHPExûl_C–l_DeçuÉV®ueBšd”
 
im¶em’ts
 
	mPHPExûl_C–l_IV®ueBšd”


46 
public
 
funùiÚ
 
	$bšdV®ue
(
PHPExûl_C–l
 
$ûÎ
, 
$v®ue
 = 
nuÎ
)

49 ià(
	`is_¡ršg
(
$v®ue
)) {

50 
$v®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`Sª™izeUTF8
($value);

54 
$d©aTy³
 = 
·»Á
::
	`d©aTy³FÜV®ue
(
$v®ue
);

57 ià(
$d©aTy³
 ==ğ
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
 && !
$v®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

59 ià(
$v®ue
 =ğ
PHPExûl_C®cuÏtiÚ
::
	`g‘TRUE
()) {

60 
$ûÎ
->
	`£tV®ueEx¶ic™
(
Œue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
);

61  
Œue
;

62 } 
	`–£if
 (
$v®ue
 =ğ
PHPExûl_C®cuÏtiÚ
::
	`g‘FALSE
()) {

63 
$ûÎ
->
	`£tV®ueEx¶ic™
(
çl£
, 
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
);

64  
Œue
;

68 ià(
	`´eg_m©ch
('/^'.
PHPExûl_C®cuÏtiÚ
::
CALCULATION_REGEXP_NUMBER
.'$/', 
$v®ue
)) {

69 
$ûÎ
->
	`£tV®ueEx¶ic™
((è
$v®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

70  
Œue
;

74 ià(
	`´eg_m©ch
('/^([+-]?)\s*([0-9]+)\s?\/\s*([0-9]+)$/', 
$v®ue
, 
$m©ches
)) {

76 
$v®ue
 = 
$m©ches
[2] / $matches[3];

77 ià(
$m©ches
[1] == '-') {

78 
$v®ue
 = 0 - $value;

80 
$ûÎ
->
	`£tV®ueEx¶ic™
((è
$v®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

82 
$ûÎ
->
	`g‘WÜksh“t
()->
	`g‘StyË
($ûÎ->
	`g‘CoÜdš©e
())

83 ->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
('??/??');

84  
Œue
;

85 } 
	`–£if
 (
	`´eg_m©ch
('/^([+-]?)([0-9]*è+([0-9]*)\s?\/\s*([0-9]*)$/', 
$v®ue
, 
$m©ches
)) {

87 
$v®ue
 = 
$m©ches
[2] + ($matches[3] / $matches[4]);

88 ià(
$m©ches
[1] == '-') {

89 
$v®ue
 = 0 - $value;

91 
$ûÎ
->
	`£tV®ueEx¶ic™
((è
$v®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

93 
$ûÎ
->
	`g‘WÜksh“t
()->
	`g‘StyË
($ûÎ->
	`g‘CoÜdš©e
())

94 ->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
('# ??/??');

95  
Œue
;

99 ià(
	`´eg_m©ch
('/^\-?[0-9]*\.?[0-9]*\s?\%$/', 
$v®ue
)) {

101 
$v®ue
 = (è
	`¡r_»¶aû
('%', '', $value) / 100;

102 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

104 
$ûÎ
->
	`g‘WÜksh“t
()->
	`g‘StyË
($ûÎ->
	`g‘CoÜdš©e
())

105 ->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
(
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_PERCENTAGE_00
);

106  
Œue
;

110 
$cu¼’cyCode
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`g‘Cu¼’cyCode
();

111 
$decim®S•¬©Ü
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`g‘Decim®S•¬©Ü
();

112 
$thou§ndsS•¬©Ü
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`g‘Thou§ndsS•¬©Ü
();

113 ià(
	`´eg_m©ch
('/^'.
	`´eg_quÙe
(
$cu¼’cyCode
).' *(\d{1,3}('.´eg_quÙe(
$thou§ndsS•¬©Ü
).'\d{3})*|(\d+))('.´eg_quÙe(
$decim®S•¬©Ü
).'\d{2})?$/', 
$v®ue
)) {

115 
$v®ue
 = (è
	`Œim
(
	`¡r_»¶aû
(
	`¬¿y
(
$cu¼’cyCode
, 
$thou§ndsS•¬©Ü
, 
$decim®S•¬©Ü
),‡rray('', '', '.'), $value));

116 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

118 
$ûÎ
->
	`g‘WÜksh“t
()->
	`g‘StyË
($ûÎ->
	`g‘CoÜdš©e
())

119 ->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
(

120 
	`¡r_»¶aû
('$', 
$cu¼’cyCode
, 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_CURRENCY_USD_SIMPLE
)

122  
Œue
;

123 } 
	`–£if
 (
	`´eg_m©ch
('/^\$ *(\d{1,3}(\,\d{3})*|(\d+))(\.\d{2})?$/', 
$v®ue
)) {

125 
$v®ue
 = (è
	`Œim
(
	`¡r_»¶aû
(
	`¬¿y
('$',','), '', $value));

126 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

128 
$ûÎ
->
	`g‘WÜksh“t
()->
	`g‘StyË
($ûÎ->
	`g‘CoÜdš©e
())

129 ->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
(
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_CURRENCY_USD_SIMPLE
);

130  
Œue
;

134 ià(
	`´eg_m©ch
('/^(\d|[0-1]\d|2[0-3]):[0-5]\d$/', 
$v®ue
)) {

136 
	`li¡
(
$h
, 
$m
èğ
	`ex¶ode
(':', 
$v®ue
);

137 
$days
 = 
$h
 / 24 + 
$m
 / 1440;

138 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$days
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

140 
$ûÎ
->
	`g‘WÜksh“t
()->
	`g‘StyË
($ûÎ->
	`g‘CoÜdš©e
())

141 ->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
(
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME3
);

142  
Œue
;

146 ià(
	`´eg_m©ch
('/^(\d|[0-1]\d|2[0-3]):[0-5]\d:[0-5]\d$/', 
$v®ue
)) {

148 
	`li¡
(
$h
, 
$m
, 
$s
èğ
	`ex¶ode
(':', 
$v®ue
);

149 
$days
 = 
$h
 / 24 + 
$m
 / 1440 + 
$s
 / 86400;

151 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$days
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

153 
$ûÎ
->
	`g‘WÜksh“t
()->
	`g‘StyË
($ûÎ->
	`g‘CoÜdš©e
())

154 ->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
(
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME4
);

155  
Œue
;

159 ià((
$d
 = 
PHPExûl_Sh¬ed_D©e
::
	`¡ršgToExûl
(
$v®ue
)è!=ğ
çl£
) {

161 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$d
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

163 ià(
	`¡½os
(
$v®ue
, ':'è!=ğ
çl£
) {

164 
$fÜm©Code
 = 'yyyy-mm-dd h:mm';

166 
$fÜm©Code
 = 'yyyy-mm-dd';

168 
$ûÎ
->
	`g‘WÜksh“t
()->
	`g‘StyË
($ûÎ->
	`g‘CoÜdš©e
())

169 ->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
(
$fÜm©Code
);

170  
Œue
;

174 ià(
	`¡½os
(
$v®ue
, "\n"è!=ğ
çl£
) {

175 
$v®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`Sª™izeUTF8
($value);

176 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
);

178 
$ûÎ
->
	`g‘WÜksh“t
()->
	`g‘StyË
($ûÎ->
	`g‘CoÜdš©e
())

179 ->
	`g‘Alignm’t
()->
	`£tW¿pText
(
Œue
);

180  
Œue
;

185  
·»Á
::
	`bšdV®ue
(
$ûÎ
, 
$v®ue
);

187 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/DataType.php

1 <?
php


28 şas 
	cPHPExûl_C–l_D©aTy³


31 cÚ¡ 
	mTYPE_STRING2
 = 'str';

32 cÚ¡ 
	mTYPE_STRING
 = 's';

33 cÚ¡ 
	mTYPE_FORMULA
 = 'f';

34 cÚ¡ 
	mTYPE_NUMERIC
 = 'n';

35 cÚ¡ 
	mTYPE_BOOL
 = 'b';

36 cÚ¡ 
	mTYPE_NULL
 = 'null';

37 cÚ¡ 
	mTYPE_INLINE
 = 'inlineStr';

38 cÚ¡ 
	mTYPE_ERROR
 = 'e';

45 
´iv©e
 
	m$”rÜCodes
 = 
¬¿y
(

60 
public
 
funùiÚ
 
	$g‘E¼ÜCodes
()

62  
£lf
::
$”rÜCodes
;

72 
public
 
funùiÚ
 
	$d©aTy³FÜV®ue
(
$pV®ue
 = 
nuÎ
)

74  
PHPExûl_C–l_DeçuÉV®ueBšd”
::
	`d©aTy³FÜV®ue
(
$pV®ue
);

75 
	}
}

83 
public
 
funùiÚ
 
	$checkSŒšg
(
$pV®ue
 = 
nuÎ
)

85 ià(
$pV®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

87  
$pV®ue
;

91 
$pV®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`Sub¡ršg
($pValue, 0, 32767);

94 
$pV®ue
 = 
	`¡r_»¶aû
(
	`¬¿y
("\r\n", "\r"), "\n", $pValue);

96  
$pV®ue
;

97 
	}
}

105 
public
 
funùiÚ
 
	$checkE¼ÜCode
(
$pV®ue
 = 
nuÎ
)

107 
$pV®ue
 = (
¡ršg
) $pValue;

109 ià(!
	`¬¿y_key_exi¡s
(
$pV®ue
, 
£lf
::
$”rÜCodes
)) {

110 
$pV®ue
 = '#NULL!';

113  
$pV®ue
;

114 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/DataValidation.php

1 <?
php


28 şas 
	cPHPExûl_C–l_D©aV®id©iÚ


31 cÚ¡ 
	mTYPE_NONE
 = 'none';

32 cÚ¡ 
	mTYPE_CUSTOM
 = 'custom';

33 cÚ¡ 
	mTYPE_DATE
 = 'date';

34 cÚ¡ 
	mTYPE_DECIMAL
 = 'decimal';

35 cÚ¡ 
	mTYPE_LIST
 = 'list';

36 cÚ¡ 
	mTYPE_TEXTLENGTH
 = 'textLength';

37 cÚ¡ 
	mTYPE_TIME
 = 'time';

38 cÚ¡ 
	mTYPE_WHOLE
 = 'whole';

41 cÚ¡ 
	mSTYLE_STOP
 = 'stop';

42 cÚ¡ 
	mSTYLE_WARNING
 = 'warning';

43 cÚ¡ 
	mSTYLE_INFORMATION
 = 'information';

46 cÚ¡ 
	mOPERATOR_BETWEEN
 = 'between';

47 cÚ¡ 
	mOPERATOR_EQUAL
 = 'equal';

48 cÚ¡ 
	mOPERATOR_GREATERTHAN
 = 'greaterThan';

49 cÚ¡ 
	mOPERATOR_GREATERTHANOREQUAL
 = 'greaterThanOrEqual';

50 cÚ¡ 
	mOPERATOR_LESSTHAN
 = 'lessThan';

51 cÚ¡ 
	mOPERATOR_LESSTHANOREQUAL
 = 'lessThanOrEqual';

52 cÚ¡ 
	mOPERATOR_NOTBETWEEN
 = 'notBetween';

53 cÚ¡ 
	mOPERATOR_NOTEQUAL
 = 'notEqual';

60 
´iv©e
 
	m$fÜmuÏ1
;

67 
´iv©e
 
	m$fÜmuÏ2
;

74 
´iv©e
 
	m$ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_NONE
;

81 
´iv©e
 
	m$”rÜStyË
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
STYLE_STOP
;

88 
´iv©e
 
	m$İ”©Ü
;

95 
´iv©e
 
	m$®lowBÏnk
;

102 
´iv©e
 
	m$showDrİDown
;

109 
´iv©e
 
	m$showIÅutMes§ge
;

116 
´iv©e
 
	m$showE¼ÜMes§ge
;

123 
´iv©e
 
	m$”rÜT™Ë
;

130 
´iv©e
 
	m$”rÜ
;

137 
´iv©e
 
	m$´om±T™Ë
;

144 
´iv©e
 
	m$´om±
;

149 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

152 
$this
->
fÜmuÏ1
 = '';

153 
$this
->
fÜmuÏ2
 = '';

154 
$this
->
ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_NONE
;

155 
$this
->
”rÜStyË
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
STYLE_STOP
;

156 
$this
->
İ”©Ü
 = '';

157 
$this
->
®lowBÏnk
 = 
çl£
;

158 
$this
->
showDrİDown
 = 
çl£
;

159 
$this
->
showIÅutMes§ge
 = 
çl£
;

160 
$this
->
showE¼ÜMes§ge
 = 
çl£
;

161 
$this
->
”rÜT™Ë
 = '';

162 
$this
->
”rÜ
 = '';

163 
$this
->
´om±T™Ë
 = '';

164 
$this
->
´om±
 = '';

172 
public
 
funùiÚ
 
	$g‘FÜmuÏ1
()

174  
$this
->
fÜmuÏ1
;

175 
	}
}

183 
public
 
funùiÚ
 
£tFÜmuÏ1
(
$v®ue
 = '')

185 
$this
->
fÜmuÏ1
 = 
$v®ue
;

186  
	g$this
;

194 
public
 
funùiÚ
 
	$g‘FÜmuÏ2
()

196  
$this
->
fÜmuÏ2
;

197 
	}
}

205 
public
 
funùiÚ
 
£tFÜmuÏ2
(
$v®ue
 = '')

207 
$this
->
fÜmuÏ2
 = 
$v®ue
;

208  
	g$this
;

216 
public
 
funùiÚ
 
	$g‘Ty³
()

218  
$this
->
ty³
;

219 
	}
}

227 
public
 
funùiÚ
 
	$£tTy³
(
$v®ue
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_NONE
)

229 
$this
->
ty³
 = 
$v®ue
;

230  
$this
;

231 
	}
}

238 
public
 
funùiÚ
 
	$g‘E¼ÜStyË
()

240  
$this
->
”rÜStyË
;

241 
	}
}

249 
public
 
funùiÚ
 
	$£tE¼ÜStyË
(
$v®ue
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
STYLE_STOP
)

251 
$this
->
”rÜStyË
 = 
$v®ue
;

252  
$this
;

253 
	}
}

260 
public
 
funùiÚ
 
	$g‘O³¿tÜ
()

262  
$this
->
İ”©Ü
;

263 
	}
}

271 
public
 
funùiÚ
 
£tO³¿tÜ
(
$v®ue
 = '')

273 
$this
->
İ”©Ü
 = 
$v®ue
;

274  
	g$this
;

282 
public
 
funùiÚ
 
	$g‘AÎowBÏnk
()

284  
$this
->
®lowBÏnk
;

285 
	}
}

293 
public
 
funùiÚ
 
	$£tAÎowBÏnk
(
$v®ue
 = 
çl£
)

295 
$this
->
®lowBÏnk
 = 
$v®ue
;

296  
$this
;

297 
	}
}

304 
public
 
funùiÚ
 
	$g‘ShowDrİDown
()

306  
$this
->
showDrİDown
;

307 
	}
}

315 
public
 
funùiÚ
 
	$£tShowDrİDown
(
$v®ue
 = 
çl£
)

317 
$this
->
showDrİDown
 = 
$v®ue
;

318  
$this
;

319 
	}
}

326 
public
 
funùiÚ
 
	$g‘ShowIÅutMes§ge
()

328  
$this
->
showIÅutMes§ge
;

329 
	}
}

337 
public
 
funùiÚ
 
	$£tShowIÅutMes§ge
(
$v®ue
 = 
çl£
)

339 
$this
->
showIÅutMes§ge
 = 
$v®ue
;

340  
$this
;

341 
	}
}

348 
public
 
funùiÚ
 
	$g‘ShowE¼ÜMes§ge
()

350  
$this
->
showE¼ÜMes§ge
;

351 
	}
}

359 
public
 
funùiÚ
 
	$£tShowE¼ÜMes§ge
(
$v®ue
 = 
çl£
)

361 
$this
->
showE¼ÜMes§ge
 = 
$v®ue
;

362  
$this
;

363 
	}
}

370 
public
 
funùiÚ
 
	$g‘E¼ÜT™Ë
()

372  
$this
->
”rÜT™Ë
;

373 
	}
}

381 
public
 
funùiÚ
 
£tE¼ÜT™Ë
(
$v®ue
 = '')

383 
$this
->
”rÜT™Ë
 = 
$v®ue
;

384  
	g$this
;

392 
public
 
funùiÚ
 
	$g‘E¼Ü
()

394  
$this
->
”rÜ
;

395 
	}
}

403 
public
 
funùiÚ
 
£tE¼Ü
(
$v®ue
 = '')

405 
$this
->
”rÜ
 = 
$v®ue
;

406  
	g$this
;

414 
public
 
funùiÚ
 
	$g‘Prom±T™Ë
()

416  
$this
->
´om±T™Ë
;

417 
	}
}

425 
public
 
funùiÚ
 
£tProm±T™Ë
(
$v®ue
 = '')

427 
$this
->
´om±T™Ë
 = 
$v®ue
;

428  
	g$this
;

436 
public
 
funùiÚ
 
	$g‘Prom±
()

438  
$this
->
´om±
;

439 
	}
}

447 
public
 
funùiÚ
 
£tProm±
(
$v®ue
 = '')

449 
$this
->
´om±
 = 
$v®ue
;

450  
	g$this
;

458 
public
 
funùiÚ
 
	$g‘HashCode
()

460  
	`md5
(

461 
$this
->
fÜmuÏ1
 .

462 
$this
->
fÜmuÏ2
 .

463 
$this
->
ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_NONE
 .

464 
$this
->
”rÜStyË
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
STYLE_STOP
 .

465 
$this
->
İ”©Ü
 .

466 (
$this
->
®lowBÏnk
 ? 't' : 'f') .

467 (
$this
->
showDrİDown
 ? 't' : 'f') .

468 (
$this
->
showIÅutMes§ge
 ? 't' : 'f') .

469 (
$this
->
showE¼ÜMes§ge
 ? 't' : 'f') .

470 
$this
->
”rÜT™Ë
 .

471 
$this
->
”rÜ
 .

472 
$this
->
´om±T™Ë
 .

473 
$this
->
´om±
 .

474 
__CLASS__


476 
	}
}

481 
public
 
funùiÚ
 
	$__şÚe
()

483 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

484 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

485 ià(
	`is_objeù
(
$v®ue
)) {

486 
$this
->
$key
 = 
şÚe
 
$v®ue
;

488 
$this
->
$key
 = 
$v®ue
;

491 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/DefaultValueBinder.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_C–l_DeçuÉV®ueBšd”
 
im¶em’ts
 
	mPHPExûl_C–l_IV®ueBšd”


46 
public
 
funùiÚ
 
	$bšdV®ue
(
PHPExûl_C–l
 
$ûÎ
, 
$v®ue
 = 
nuÎ
)

49 ià(
	`is_¡ršg
(
$v®ue
)) {

50 
$v®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`Sª™izeUTF8
($value);

51 } 
	`–£if
 (
	`is_objeù
(
$v®ue
)) {

53 ià(
$v®ue
 
š¡ªûof
 
D©eTime
) {

54 
$v®ue
 = $v®ue->
	`fÜm©
('Y-m-d H:i:s');

55 } 
	`–£if
 (!(
$v®ue
 
š¡ªûof
 
PHPExûl_RichText
)) {

56 
$v®ue
 = (
¡ršg
) $value;

61 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
£lf
::
	`d©aTy³FÜV®ue
($value));

64  
Œue
;

73 
public
 
funùiÚ
 
	$d©aTy³FÜV®ue
(
$pV®ue
 = 
nuÎ
)

76 ià(
$pV®ue
 ==ğ
nuÎ
) {

77  
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
;

78 } 
	`–£if
 (
$pV®ue
 === '') {

79  
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

80 } 
	`–£if
 (
$pV®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

81  
PHPExûl_C–l_D©aTy³
::
TYPE_INLINE
;

82 } 
	`–£if
 (
$pV®ue
{0} ==ğ'=' && 
	`¡¾’
($pValue) > 1) {

83  
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
;

84 } 
	`–£if
 (
	`is_boŞ
(
$pV®ue
)) {

85  
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
;

86 } 
	`–£if
 (
	`is_æßt
(
$pV®ue
è|| 
	`is_št
($pValue)) {

87  
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

88 } 
	`–£if
 (
	`´eg_m©ch
('/^[\+\-]?([0-9]+\\.?[0-9]*|[0-9]*\\.?[0-9]+)([Ee][\-\+]?[0-2]?\d{1,3})?$/', 
$pV®ue
)) {

89 
$tV®ue
 = 
	`Érim
(
$pV®ue
, '+-');

90 ià(
	`is_¡ršg
(
$pV®ue
è&& 
$tV®ue
{0} ==ğ'0' && 
	`¡¾’
($tValue) > 1 && $tValue{1} !== '.') {

91  
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

92 } 
	`–£if
 ((
	`¡½os
(
$pV®ue
, '.'è==ğ
çl£
è&& ($pV®u> 
PHP_INT_MAX
)) {

93  
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

95  
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

96 } 
	`–£if
 (
	`is_¡ršg
(
$pV®ue
è&& 
	`¬¿y_key_exi¡s
($pV®ue, 
PHPExûl_C–l_D©aTy³
::
	`g‘E¼ÜCodes
())) {

97  
PHPExûl_C–l_D©aTy³
::
TYPE_ERROR
;

100  
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

101 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/Hyperlink.php

1 <?
php


28 şas 
	cPHPExûl_C–l_Hy³¾šk


35 
´iv©e
 
	m$u¾
;

42 
´iv©e
 
	m$toŞt
;

50 
public
 
funùiÚ
 
__cÚ¡ruù
(
$pU¾
 = '', 
$pToŞt
 = '')

53 
$this
->
u¾
 = 
$pU¾
;

54 
	m$this
->
	mtoŞt
 = 
$pToŞt
;

62 
public
 
funùiÚ
 
	$g‘U¾
()

64  
$this
->
u¾
;

65 
	}
}

73 
public
 
funùiÚ
 
£tU¾
(
$v®ue
 = '')

75 
$this
->
u¾
 = 
$v®ue
;

76  
	g$this
;

84 
public
 
funùiÚ
 
	$g‘ToŞt
()

86  
$this
->
toŞt
;

87 
	}
}

95 
public
 
funùiÚ
 
£tToŞt
(
$v®ue
 = '')

97 
$this
->
toŞt
 = 
$v®ue
;

98  
	g$this
;

106 
public
 
funùiÚ
 
	$isIÁ”Çl
()

108  
	`¡½os
(
$this
->
u¾
, 'sh“t://'è!=ğ
çl£
;

109 
	}
}

116 
public
 
funùiÚ
 
	$g‘HashCode
()

118  
	`md5
(

119 
$this
->
u¾
 .

120 
$this
->
toŞt
 .

121 
__CLASS__


123 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/IValueBinder.php

1 <?
php


37 
š‹rçû
 
	gPHPExûl_C–l_IV®ueBšd”


46 
public
 
funùiÚ
 
bšdV®ue
(
PHPExûl_C–l
 
$ûÎ
, 
$v®ue
 = 
nuÎ
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart.php

1 <?
php


28 şas 
	cPHPExûl_Ch¬t


35 
´iv©e
 
	m$Çme
 = '';

42 
´iv©e
 
	m$wÜksh“t
;

49 
´iv©e
 
	m$t™Ë
;

56 
´iv©e
 
	m$Ëg’d
;

63 
´iv©e
 
	m$xAxisLab–
;

70 
´iv©e
 
	m$yAxisLab–
;

77 
´iv©e
 
	m$¶ÙA»a
;

84 
´iv©e
 
	m$¶ÙVisibËOÆy
 = 
Œue
;

91 
´iv©e
 
	m$di¥ÏyBÏnksAs
 = '0';

98 
´iv©e
 
	m$yAxis
;

105 
´iv©e
 
	m$xAxis
;

112 
´iv©e
 
	m$majÜGridlšes
;

119 
´iv©e
 
	m$mšÜGridlšes
;

126 
´iv©e
 
	m$tİLeáC–lRef
 = 'A1';

134 
´iv©e
 
	m$tİLeáXOff£t
 = 0;

142 
´iv©e
 
	m$tİLeáYOff£t
 = 0;

150 
´iv©e
 
	m$bÙtomRightC–lRef
 = 'A1';

158 
´iv©e
 
	m$bÙtomRightXOff£t
 = 10;

166 
´iv©e
 
	m$bÙtomRightYOff£t
 = 10;

172 
public
 
funùiÚ
 
__cÚ¡ruù
(
$Çme
, 
PHPExûl_Ch¬t_T™Ë
 
$t™Ë
 = 
nuÎ
, 
PHPExûl_Ch¬t_Leg’d
 
$Ëg’d
 =‚uÎ, 
PHPExûl_Ch¬t_PlÙA»a
 
$¶ÙA»a
 =‚uÎ, 
$¶ÙVisibËOÆy
 = 
Œue
, 
$di¥ÏyBÏnksAs
 = '0', PHPExûl_Ch¬t_T™Ë 
$xAxisLab–
 =‚uÎ, PHPExûl_Ch¬t_T™Ë 
$yAxisLab–
 =‚uÎ, 
PHPExûl_Ch¬t_Axis
 
$xAxis
 =‚uÎ, PHPExûl_Ch¬t_Axi 
$yAxis
 =‚uÎ, 
PHPExûl_Ch¬t_GridLšes
 
$majÜGridlšes
 =‚uÎ, PHPExûl_Ch¬t_GridLše 
$mšÜGridlšes
 =‚ull)

174 
$this
->
Çme
 = 
$Çme
;

175 
	m$this
->
	mt™Ë
 = 
$t™Ë
;

176 
	m$this
->
	mËg’d
 = 
$Ëg’d
;

177 
	m$this
->
	mxAxisLab–
 = 
$xAxisLab–
;

178 
	m$this
->
	myAxisLab–
 = 
$yAxisLab–
;

179 
	m$this
->
	m¶ÙA»a
 = 
$¶ÙA»a
;

180 
	m$this
->
	m¶ÙVisibËOÆy
 = 
$¶ÙVisibËOÆy
;

181 
	m$this
->
	mdi¥ÏyBÏnksAs
 = 
$di¥ÏyBÏnksAs
;

182 
	m$this
->
	mxAxis
 = 
$xAxis
;

183 
	m$this
->
	myAxis
 = 
$yAxis
;

184 
	m$this
->
	mmajÜGridlšes
 = 
$majÜGridlšes
;

185 
	m$this
->
	mmšÜGridlšes
 = 
$mšÜGridlšes
;

193 
public
 
funùiÚ
 
	$g‘Name
()

195  
$this
->
Çme
;

196 
	}
}

203 
public
 
funùiÚ
 
	$g‘WÜksh“t
()

205  
$this
->
wÜksh“t
;

206 
	}
}

215 
public
 
funùiÚ
 
	$£tWÜksh“t
(
PHPExûl_WÜksh“t
 
$pV®ue
 = 
nuÎ
)

217 
$this
->
wÜksh“t
 = 
$pV®ue
;

219  
$this
;

220 
	}
}

227 
public
 
funùiÚ
 
	$g‘T™Ë
()

229  
$this
->
t™Ë
;

230 
	}
}

238 
public
 
funùiÚ
 
	$£tT™Ë
(
PHPExûl_Ch¬t_T™Ë
 
$t™Ë
)

240 
$this
->
t™Ë
 = 
$t™Ë
;

242  
$this
;

243 
	}
}

250 
public
 
funùiÚ
 
	$g‘Leg’d
()

252  
$this
->
Ëg’d
;

253 
	}
}

261 
public
 
funùiÚ
 
	$£tLeg’d
(
PHPExûl_Ch¬t_Leg’d
 
$Ëg’d
)

263 
$this
->
Ëg’d
 = 
$Ëg’d
;

265  
$this
;

266 
	}
}

273 
public
 
funùiÚ
 
	$g‘XAxisLab–
()

275  
$this
->
xAxisLab–
;

276 
	}
}

284 
public
 
funùiÚ
 
	$£tXAxisLab–
(
PHPExûl_Ch¬t_T™Ë
 
$Ïb–
)

286 
$this
->
xAxisLab–
 = 
$Ïb–
;

288  
$this
;

289 
	}
}

296 
public
 
funùiÚ
 
	$g‘YAxisLab–
()

298  
$this
->
yAxisLab–
;

299 
	}
}

307 
public
 
funùiÚ
 
	$£tYAxisLab–
(
PHPExûl_Ch¬t_T™Ë
 
$Ïb–
)

309 
$this
->
yAxisLab–
 = 
$Ïb–
;

311  
$this
;

312 
	}
}

319 
public
 
funùiÚ
 
	$g‘PlÙA»a
()

321  
$this
->
¶ÙA»a
;

322 
	}
}

329 
public
 
funùiÚ
 
	$g‘PlÙVisibËOÆy
()

331  
$this
->
¶ÙVisibËOÆy
;

332 
	}
}

340 
public
 
funùiÚ
 
	$£tPlÙVisibËOÆy
(
$¶ÙVisibËOÆy
 = 
Œue
)

342 
$this
->
¶ÙVisibËOÆy
 = 
$¶ÙVisibËOÆy
;

344  
$this
;

345 
	}
}

352 
public
 
funùiÚ
 
	$g‘Di¥ÏyBÏnksAs
()

354  
$this
->
di¥ÏyBÏnksAs
;

355 
	}
}

363 
public
 
funùiÚ
 
£tDi¥ÏyBÏnksAs
(
$di¥ÏyBÏnksAs
 = '0')

365 
$this
->
di¥ÏyBÏnksAs
 = 
$di¥ÏyBÏnksAs
;

374 
public
 
funùiÚ
 
	$g‘Ch¬tAxisY
()

376 ià(
$this
->
yAxis
 !=ğ
nuÎ
) {

377  
$this
->
yAxis
;

380  
Ãw
 
	`PHPExûl_Ch¬t_Axis
();

381 
	}
}

388 
public
 
funùiÚ
 
	$g‘Ch¬tAxisX
()

390 ià(
$this
->
xAxis
 !=ğ
nuÎ
) {

391  
$this
->
xAxis
;

394  
Ãw
 
	`PHPExûl_Ch¬t_Axis
();

395 
	}
}

402 
public
 
funùiÚ
 
	$g‘MajÜGridlšes
()

404 ià(
$this
->
majÜGridlšes
 !=ğ
nuÎ
) {

405  
$this
->
majÜGridlšes
;

408  
Ãw
 
	`PHPExûl_Ch¬t_GridLšes
();

409 
	}
}

416 
public
 
funùiÚ
 
	$g‘MšÜGridlšes
()

418 ià(
$this
->
mšÜGridlšes
 !=ğ
nuÎ
) {

419  
$this
->
mšÜGridlšes
;

422  
Ãw
 
	`PHPExûl_Ch¬t_GridLšes
();

423 
	}
}

434 
public
 
funùiÚ
 
	$£tTİLeáPos™iÚ
(
$ûÎ
, 
$xOff£t
 = 
nuÎ
, 
$yOff£t
 =‚ull)

436 
$this
->
tİLeáC–lRef
 = 
$ûÎ
;

437 ià(!
	`is_nuÎ
(
$xOff£t
)) {

438 
$this
->
	`£tTİLeáXOff£t
(
$xOff£t
);

440 ià(!
	`is_nuÎ
(
$yOff£t
)) {

441 
$this
->
	`£tTİLeáYOff£t
(
$yOff£t
);

444  
$this
;

445 
	}
}

452 
public
 
funùiÚ
 
	$g‘TİLeáPos™iÚ
()

454  
	`¬¿y
(

455 'ûÎ' => 
$this
->
tİLeáC–lRef
,

456 'xOff£t' => 
$this
->
tİLeáXOff£t
,

457 'yOff£t' => 
$this
->
tİLeáYOff£t


459 
	}
}

466 
public
 
funùiÚ
 
	$g‘TİLeáC–l
()

468  
$this
->
tİLeáC–lRef
;

469 
	}
}

477 
public
 
funùiÚ
 
	$£tTİLeáC–l
(
$ûÎ
)

479 
$this
->
tİLeáC–lRef
 = 
$ûÎ
;

481  
$this
;

482 
	}
}

491 
public
 
funùiÚ
 
	$£tTİLeáOff£t
(
$xOff£t
 = 
nuÎ
, 
$yOff£t
 =‚ull)

493 ià(!
	`is_nuÎ
(
$xOff£t
)) {

494 
$this
->
	`£tTİLeáXOff£t
(
$xOff£t
);

496 ià(!
	`is_nuÎ
(
$yOff£t
)) {

497 
$this
->
	`£tTİLeáYOff£t
(
$yOff£t
);

500  
$this
;

501 
	}
}

508 
public
 
funùiÚ
 
	$g‘TİLeáOff£t
()

510  
	`¬¿y
(

511 'X' => 
$this
->
tİLeáXOff£t
,

512 'Y' => 
$this
->
tİLeáYOff£t


514 
	}
}

516 
public
 
funùiÚ
 
	$£tTİLeáXOff£t
(
$xOff£t
)

518 
$this
->
tİLeáXOff£t
 = 
$xOff£t
;

520  
$this
;

521 
	}
}

523 
public
 
funùiÚ
 
	$g‘TİLeáXOff£t
()

525  
$this
->
tİLeáXOff£t
;

526 
	}
}

528 
public
 
funùiÚ
 
	$£tTİLeáYOff£t
(
$yOff£t
)

530 
$this
->
tİLeáYOff£t
 = 
$yOff£t
;

532  
$this
;

533 
	}
}

535 
public
 
funùiÚ
 
	$g‘TİLeáYOff£t
()

537  
$this
->
tİLeáYOff£t
;

538 
	}
}

548 
public
 
funùiÚ
 
	$£tBÙtomRightPos™iÚ
(
$ûÎ
, 
$xOff£t
 = 
nuÎ
, 
$yOff£t
 =‚ull)

550 
$this
->
bÙtomRightC–lRef
 = 
$ûÎ
;

551 ià(!
	`is_nuÎ
(
$xOff£t
)) {

552 
$this
->
	`£tBÙtomRightXOff£t
(
$xOff£t
);

554 ià(!
	`is_nuÎ
(
$yOff£t
)) {

555 
$this
->
	`£tBÙtomRightYOff£t
(
$yOff£t
);

558  
$this
;

559 
	}
}

566 
public
 
funùiÚ
 
	$g‘BÙtomRightPos™iÚ
()

568  
	`¬¿y
(

569 'ûÎ' => 
$this
->
bÙtomRightC–lRef
,

570 'xOff£t' => 
$this
->
bÙtomRightXOff£t
,

571 'yOff£t' => 
$this
->
bÙtomRightYOff£t


573 
	}
}

575 
public
 
funùiÚ
 
	$£tBÙtomRightC–l
(
$ûÎ
)

577 
$this
->
bÙtomRightC–lRef
 = 
$ûÎ
;

579  
$this
;

580 
	}
}

587 
public
 
funùiÚ
 
	$g‘BÙtomRightC–l
()

589  
$this
->
bÙtomRightC–lRef
;

590 
	}
}

599 
public
 
funùiÚ
 
	$£tBÙtomRightOff£t
(
$xOff£t
 = 
nuÎ
, 
$yOff£t
 =‚ull)

601 ià(!
	`is_nuÎ
(
$xOff£t
)) {

602 
$this
->
	`£tBÙtomRightXOff£t
(
$xOff£t
);

604 ià(!
	`is_nuÎ
(
$yOff£t
)) {

605 
$this
->
	`£tBÙtomRightYOff£t
(
$yOff£t
);

608  
$this
;

609 
	}
}

616 
public
 
funùiÚ
 
	$g‘BÙtomRightOff£t
()

618  
	`¬¿y
(

619 'X' => 
$this
->
bÙtomRightXOff£t
,

620 'Y' => 
$this
->
bÙtomRightYOff£t


622 
	}
}

624 
public
 
funùiÚ
 
	$£tBÙtomRightXOff£t
(
$xOff£t
)

626 
$this
->
bÙtomRightXOff£t
 = 
$xOff£t
;

628  
$this
;

629 
	}
}

631 
public
 
funùiÚ
 
	$g‘BÙtomRightXOff£t
()

633  
$this
->
bÙtomRightXOff£t
;

634 
	}
}

636 
public
 
funùiÚ
 
	$£tBÙtomRightYOff£t
(
$yOff£t
)

638 
$this
->
bÙtomRightYOff£t
 = 
$yOff£t
;

640  
$this
;

641 
	}
}

643 
public
 
funùiÚ
 
	$g‘BÙtomRightYOff£t
()

645  
$this
->
bÙtomRightYOff£t
;

646 
	}
}

649 
public
 
funùiÚ
 
	$»äesh
()

651 ià(
$this
->
wÜksh“t
 !=ğ
nuÎ
) {

652 
$this
->
¶ÙA»a
->
	`»äesh
($this->
wÜksh“t
);

654 
	}
}

656 
public
 
funùiÚ
 
	$»nd”
(
$ouutDe¡š©iÚ
 = 
nuÎ
)

658 
$lib¿ryName
 = 
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””Name
();

659 ià(
	`is_nuÎ
(
$lib¿ryName
)) {

660  
çl£
;

663 
$this
->
	`»äesh
();

665 
$lib¿ryP©h
 = 
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
();

666 
$šşudeP©h
 = 
	`¡r_»¶aû
('\\', '/', 
	`g‘_šşude_·th
());

667 
$»nd””P©h
 = 
	`¡r_»¶aû
('\\', '/', 
$lib¿ryP©h
);

668 ià(
	`¡½os
(
$»nd””P©h
, 
$šşudeP©h
è==ğ
çl£
) {

669 
	`£t_šşude_·th
(
	`g‘_šşude_·th
(è. 
PATH_SEPARATOR
 . 
$lib¿ryP©h
);

672 
$»nd””Name
 = 'PHPExûl_Ch¬t_R’d””_'.
$lib¿ryName
;

673 
$»nd””
 = 
Ãw
 
	`$»nd””Name
(
$this
);

675 ià(
$ouutDe¡š©iÚ
 == 'php://output') {

676 
$ouutDe¡š©iÚ
 = 
nuÎ
;

678  
$»nd””
->
	`»nd”
(
$ouutDe¡š©iÚ
);

679 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Axis.php

1 <?
php


10 şas 
	cPHPExûl_Ch¬t_Axis
 
ex‹nds
 
	mPHPExûl_Ch¬t_Prİ”t›s


17 
´iv©e
 
	m$axisNumb”
 = 
¬¿y
(

18 'fÜm©' => 
£lf
::
FORMAT_CODE_GENERAL
,

27 
´iv©e
 
	m$axisO±iÚs
 = 
¬¿y
(

28 'mšimum' => 
nuÎ
,

29 'maximum' => 
nuÎ
,

30 'majÜ_un™' => 
nuÎ
,

31 'mšÜ_un™' => 
nuÎ
,

32 'Ü›Á©iÚ' => 
£lf
::
ORIENTATION_NORMAL
,

33 'mšÜ_tick_m¬k' => 
£lf
::
TICK_MARK_NONE
,

34 'majÜ_tick_m¬k' => 
£lf
::
TICK_MARK_NONE
,

35 'axis_Ïb–s' => 
£lf
::
AXIS_LABELS_NEXT_TO
,

36 'hÜizÚl_üos£s' => 
£lf
::
HORIZONTAL_CROSSES_AUTOZERO
,

37 'hÜizÚl_üos£s_v®ue' => 
nuÎ


45 
´iv©e
 
	m$flPrİ”t›s
 = 
¬¿y
(

46 'ty³' => 
£lf
::
EXCEL_COLOR_TYPE_ARGB
,

47 'v®ue' => 
nuÎ
,

56 
´iv©e
 
	m$lšePrİ”t›s
 = 
¬¿y
(

57 'ty³' => 
£lf
::
EXCEL_COLOR_TYPE_ARGB
,

58 'v®ue' => 
nuÎ
,

67 
´iv©e
 
	m$lšeStyËPrİ”t›s
 = 
¬¿y
(

69 'compound' => 
£lf
::
LINE_STYLE_COMPOUND_SIMPLE
,

70 'dash' => 
£lf
::
LINE_STYLE_DASH_SOLID
,

71 'ÿp' => 
£lf
::
LINE_STYLE_CAP_FLAT
,

72 'još' => 
£lf
::
LINE_STYLE_JOIN_BEVEL
,

73 '¬row' => 
¬¿y
(

74 'h—d' => 
¬¿y
(

75 'ty³' => 
£lf
::
LINE_STYLE_ARROW_TYPE_NOARROW
,

76 'size' => 
£lf
::
LINE_STYLE_ARROW_SIZE_5


78 '’d' => 
¬¿y
(

79 'ty³' => 
£lf
::
LINE_STYLE_ARROW_TYPE_NOARROW
,

80 'size' => 
£lf
::
LINE_STYLE_ARROW_SIZE_8


90 
´iv©e
 
	m$shadowPrİ”t›s
 = 
¬¿y
(

91 '´e£ts' => 
£lf
::
SHADOW_PRESETS_NOSHADOW
,

92 'efãù' => 
nuÎ
,

93 'cŞÜ' => 
¬¿y
(

94 'ty³' => 
£lf
::
EXCEL_COLOR_TYPE_STANDARD
,

98 'size' => 
¬¿y
(

99 'sx' => 
nuÎ
,

100 'sy' => 
nuÎ
,

101 'kx' => 
nuÎ


103 'blur' => 
nuÎ
,

104 'dœeùiÚ' => 
nuÎ
,

105 'di¡ªû' => 
nuÎ
,

106 '®gn' => 
nuÎ
,

107 'rÙW™hSh­e' => 
nuÎ


115 
´iv©e
 
	m$glowPrİ”t›s
 = 
¬¿y
(

116 'size' => 
nuÎ
,

117 'cŞÜ' => 
¬¿y
(

118 'ty³' => 
£lf
::
EXCEL_COLOR_TYPE_STANDARD
,

129 
´iv©e
 
	m$soáEdges
 = 
¬¿y
(

130 'size' => 
nuÎ


138 
public
 
funùiÚ
 
	$£tAxisNumb”Prİ”t›s
(
$fÜm©_code
)

140 
$this
->
axisNumb”
['fÜm©'] = (
¡ršg
è
$fÜm©_code
;

141 
$this
->
axisNumb”
['source_linked'] = 0;

149 
public
 
funùiÚ
 
	$g‘AxisNumb”FÜm©
()

151  
$this
->
axisNumb”
['format'];

152 
	}
}

159 
public
 
funùiÚ
 
	$g‘AxisNumb”SourûLšked
()

161  (
¡ršg
è
$this
->
axisNumb”
['source_linked'];

162 
	}
}

179 
public
 
funùiÚ
 
	$£tAxisO±iÚsPrİ”t›s
(
$axis_Ïb–s
, 
$hÜizÚl_üos£s_v®ue
 = 
nuÎ
, 
$hÜizÚl_üos£s
 =‚uÎ, 
$axis_Ü›Á©iÚ
 =‚uÎ, 
$majÜ_tmt
 =‚uÎ, 
$mšÜ_tmt
 =‚uÎ, 
$mšimum
 =‚uÎ, 
$maximum
 =‚uÎ, 
$majÜ_un™
 =‚uÎ, 
$mšÜ_un™
 =‚ull)

181 
$this
->
axisO±iÚs
['axis_Ïb–s'] = (
¡ršg
è
$axis_Ïb–s
;

182 (
$hÜizÚl_üos£s_v®ue
 !=ğ
nuÎ
è? 
$this
->
axisO±iÚs
['hÜizÚl_üos£s_v®ue'] = (
¡ršg
) $horizontal_crosses_value :‚ull;

183 (
$hÜizÚl_üos£s
 !=ğ
nuÎ
è? 
$this
->
axisO±iÚs
['hÜizÚl_üos£s'] = (
¡ršg
) $horizontal_crosses :‚ull;

184 (
$axis_Ü›Á©iÚ
 !=ğ
nuÎ
è? 
$this
->
axisO±iÚs
['Ü›Á©iÚ'] = (
¡ršg
) $axis_orientation :‚ull;

185 (
$majÜ_tmt
 !=ğ
nuÎ
è? 
$this
->
axisO±iÚs
['majÜ_tick_m¬k'] = (
¡ršg
) $major_tmt :‚ull;

186 (
$mšÜ_tmt
 !=ğ
nuÎ
è? 
$this
->
axisO±iÚs
['mšÜ_tick_m¬k'] = (
¡ršg
) $minor_tmt :‚ull;

187 (
$mšÜ_tmt
 !=ğ
nuÎ
è? 
$this
->
axisO±iÚs
['mšÜ_tick_m¬k'] = (
¡ršg
) $minor_tmt :‚ull;

188 (
$mšimum
 !=ğ
nuÎ
è? 
$this
->
axisO±iÚs
['mšimum'] = (
¡ršg
) $minimum :‚ull;

189 (
$maximum
 !=ğ
nuÎ
è? 
$this
->
axisO±iÚs
['maximum'] = (
¡ršg
) $maximum :‚ull;

190 (
$majÜ_un™
 !=ğ
nuÎ
è? 
$this
->
axisO±iÚs
['majÜ_un™'] = (
¡ršg
) $major_unit :‚ull;

191 (
$mšÜ_un™
 !=ğ
nuÎ
è? 
$this
->
axisO±iÚs
['mšÜ_un™'] = (
¡ršg
) $minor_unit :‚ull;

192 
	}
}

201 
public
 
funùiÚ
 
	$g‘AxisO±iÚsPrİ”ty
(
$´İ”ty
)

203  
$this
->
axisO±iÚs
[
$´İ”ty
];

204 
	}
}

212 
public
 
funùiÚ
 
	$£tAxisOr›Á©iÚ
(
$Ü›Á©iÚ
)

214 
$this
->
Ü›Á©iÚ
 = (
¡ršg
è
$Ü›Á©iÚ
;

215 
	}
}

225 
public
 
funùiÚ
 
	$£tFlP¬am‘”s
(
$cŞÜ
, 
$®pha
 = 0, 
$ty³
 = 
£lf
::
EXCEL_COLOR_TYPE_ARGB
)

227 
$this
->
flPrİ”t›s
 = $this->
	`£tCŞÜPrİ”t›s
(
$cŞÜ
, 
$®pha
, 
$ty³
);

228 
	}
}

238 
public
 
funùiÚ
 
	$£tLšeP¬am‘”s
(
$cŞÜ
, 
$®pha
 = 0, 
$ty³
 = 
£lf
::
EXCEL_COLOR_TYPE_ARGB
)

240 
$this
->
lšePrİ”t›s
 = $this->
	`£tCŞÜPrİ”t›s
(
$cŞÜ
, 
$®pha
, 
$ty³
);

241 
	}
}

250 
public
 
funùiÚ
 
	$g‘FlPrİ”ty
(
$´İ”ty
)

252  
$this
->
flPrİ”t›s
[
$´İ”ty
];

253 
	}
}

262 
public
 
funùiÚ
 
	$g‘LšePrİ”ty
(
$´İ”ty
)

264  
$this
->
lšePrİ”t›s
[
$´İ”ty
];

265 
	}
}

281 
public
 
funùiÚ
 
	$£tLšeStyËPrİ”t›s
(
$lše_width
 = 
nuÎ
, 
$compound_ty³
 =‚uÎ, 
$dash_ty³
 =‚uÎ, 
$ÿp_ty³
 =‚uÎ, 
$još_ty³
 =‚uÎ, 
$h—d_¬row_ty³
 =‚uÎ, 
$h—d_¬row_size
 =‚uÎ, 
$’d_¬row_ty³
 =‚uÎ, 
$’d_¬row_size
 =‚ull)

283 (!
	`is_nuÎ
(
$lše_width
)è? 
$this
->
lšeStyËPrİ”t›s
['width'] = $this->
	`g‘ExûlPoštsWidth
((è$lše_widthè: 
nuÎ
;

284 (!
	`is_nuÎ
(
$compound_ty³
)è? 
$this
->
lšeStyËPrİ”t›s
['compound'] = (
¡ršg
è$compound_ty³ : 
nuÎ
;

285 (!
	`is_nuÎ
(
$dash_ty³
)è? 
$this
->
lšeStyËPrİ”t›s
['dash'] = (
¡ršg
è$dash_ty³ : 
nuÎ
;

286 (!
	`is_nuÎ
(
$ÿp_ty³
)è? 
$this
->
lšeStyËPrİ”t›s
['ÿp'] = (
¡ršg
è$ÿp_ty³ : 
nuÎ
;

287 (!
	`is_nuÎ
(
$još_ty³
)è? 
$this
->
lšeStyËPrİ”t›s
['još'] = (
¡ršg
è$još_ty³ : 
nuÎ
;

288 (!
	`is_nuÎ
(
$h—d_¬row_ty³
)è? 
$this
->
lšeStyËPrİ”t›s
['¬row']['h—d']['ty³'] = (
¡ršg
è$h—d_¬row_ty³ : 
nuÎ
;

289 (!
	`is_nuÎ
(
$h—d_¬row_size
)è? 
$this
->
lšeStyËPrİ”t›s
['¬row']['h—d']['size'] = (
¡ršg
è$h—d_¬row_siz: 
nuÎ
;

290 (!
	`is_nuÎ
(
$’d_¬row_ty³
)è? 
$this
->
lšeStyËPrİ”t›s
['¬row']['’d']['ty³'] = (
¡ršg
è$’d_¬row_ty³ : 
nuÎ
;

291 (!
	`is_nuÎ
(
$’d_¬row_size
)è? 
$this
->
lšeStyËPrİ”t›s
['¬row']['’d']['size'] = (
¡ršg
è$’d_¬row_siz: 
nuÎ
;

292 
	}
}

301 
public
 
funùiÚ
 
	$g‘LšeStyËPrİ”ty
(
$–em’ts
)

303  
$this
->
	`g‘A¼ayEËm’tsV®ue
($this->
lšeStyËPrİ”t›s
, 
$–em’ts
);

304 
	}
}

313 
public
 
funùiÚ
 
	$g‘LšeStyËA¼owWidth
(
$¬row
)

315  
$this
->
	`g‘LšeStyËA¼owSize
($this->
lšeStyËPrİ”t›s
['¬row'][
$¬row
]['size'], 'w');

316 
	}
}

325 
public
 
funùiÚ
 
	$g‘LšeStyËA¼owL’gth
(
$¬row
)

327  
$this
->
	`g‘LšeStyËA¼owSize
($this->
lšeStyËPrİ”t›s
['¬row'][
$¬row
]['size'], 'len');

328 
	}
}

342 
public
 
funùiÚ
 
	$£tShadowPrİ”t›s
(
$sh_´e£ts
, 
$sh_cŞÜ_v®ue
 = 
nuÎ
, 
$sh_cŞÜ_ty³
 =‚uÎ, 
$sh_cŞÜ_®pha
 =‚uÎ, 
$sh_blur
 =‚uÎ, 
$sh_ªgË
 =‚uÎ, 
$sh_di¡ªû
 =‚ull)

344 
$this
->
	`£tShadowP»£tsPrİ”t›s
((è
$sh_´e£ts
)

345 ->
	`£tShadowCŞÜ
(

346 
	`is_nuÎ
(
$sh_cŞÜ_v®ue
è? 
$this
->
shadowPrİ”t›s
['color']['value'] : $sh_color_value,

347 
	`is_nuÎ
(
$sh_cŞÜ_®pha
è? (è
$this
->
shadowPrİ”t›s
['color']['alpha'] : $sh_color_alpha,

348 
	`is_nuÎ
(
$sh_cŞÜ_ty³
è? 
$this
->
shadowPrİ”t›s
['color']['type'] : $sh_color_type

350 ->
	`£tShadowBlur
(
$sh_blur
)

351 ->
	`£tShadowAngË
(
$sh_ªgË
)

352 ->
	`£tShadowDi¡ªû
(
$sh_di¡ªû
);

353 
	}
}

362 
´iv©e
 
funùiÚ
 
	$£tShadowP»£tsPrİ”t›s
(
$shadow_´e£ts
)

364 
$this
->
shadowPrİ”t›s
['´e£ts'] = 
$shadow_´e£ts
;

365 
$this
->
	`£tShadowPrİ”›sM­V®ues
($this->
	`g‘ShadowP»£tsM­
(
$shadow_´e£ts
));

367  
$this
;

368 
	}
}

378 
´iv©e
 
funùiÚ
 
	$£tShadowPrİ”›sM­V®ues
(
¬¿y
 
$´İ”t›s_m­
, &
$»ã»nû
 = 
nuÎ
)

380 
$ba£_»ã»nû
 = 
$»ã»nû
;

381 
	`fÜ—ch
 (
$´İ”t›s_m­
 
as
 
$´İ”ty_key
 => 
$´İ”ty_v®
) {

382 ià(
	`is_¬¿y
(
$´İ”ty_v®
)) {

383 ià(
$»ã»nû
 ==ğ
nuÎ
) {

384 
$»ã»nû
 = & 
$this
->
shadowPrİ”t›s
[
$´İ”ty_key
];

386 
$»ã»nû
 = & $»ã»nû[
$´İ”ty_key
];

388 
$this
->
	`£tShadowPrİ”›sM­V®ues
(
$´İ”ty_v®
, 
$»ã»nû
);

390 ià(
$ba£_»ã»nû
 ==ğ
nuÎ
) {

391 
$this
->
shadowPrİ”t›s
[
$´İ”ty_key
] = 
$´İ”ty_v®
;

393 
$»ã»nû
[
$´İ”ty_key
] = 
$´İ”ty_v®
;

398  
$this
;

399 
	}
}

410 
´iv©e
 
funùiÚ
 
	$£tShadowCŞÜ
(
$cŞÜ
, 
$®pha
, 
$ty³
)

412 
$this
->
shadowPrİ”t›s
['cŞÜ'] = $this->
	`£tCŞÜPrİ”t›s
(
$cŞÜ
, 
$®pha
, 
$ty³
);

414  
$this
;

415 
	}
}

424 
´iv©e
 
funùiÚ
 
	$£tShadowBlur
(
$blur
)

426 ià(
$blur
 !=ğ
nuÎ
) {

427 
$this
->
shadowPrİ”t›s
['blur'] = (
¡ršg
è$this->
	`g‘ExûlPoštsWidth
(
$blur
);

430  
$this
;

431 
	}
}

440 
´iv©e
 
funùiÚ
 
	$£tShadowAngË
(
$ªgË
)

442 ià(
$ªgË
 !=ğ
nuÎ
) {

443 
$this
->
shadowPrİ”t›s
['dœeùiÚ'] = (
¡ršg
è$this->
	`g‘ExûlPoštsAngË
(
$ªgË
);

446  
$this
;

447 
	}
}

456 
´iv©e
 
funùiÚ
 
	$£tShadowDi¡ªû
(
$di¡ªû
)

458 ià(
$di¡ªû
 !=ğ
nuÎ
) {

459 
$this
->
shadowPrİ”t›s
['di¡ªû'] = (
¡ršg
è$this->
	`g‘ExûlPoštsWidth
(
$di¡ªû
);

462  
$this
;

463 
	}
}

473 
public
 
funùiÚ
 
	$g‘ShadowPrİ”ty
(
$–em’ts
)

475  
$this
->
	`g‘A¼ayEËm’tsV®ue
($this->
shadowPrİ”t›s
, 
$–em’ts
);

476 
	}
}

486 
public
 
funùiÚ
 
	$£tGlowPrİ”t›s
(
$size
, 
$cŞÜ_v®ue
 = 
nuÎ
, 
$cŞÜ_®pha
 =‚uÎ, 
$cŞÜ_ty³
 =‚ull)

488 
$this
->
	`£tGlowSize
(
$size
)

489 ->
	`£tGlowCŞÜ
(

490 
	`is_nuÎ
(
$cŞÜ_v®ue
è? 
$this
->
glowPrİ”t›s
['color']['value'] : $color_value,

491 
	`is_nuÎ
(
$cŞÜ_®pha
è? (è
$this
->
glowPrİ”t›s
['color']['alpha'] : $color_alpha,

492 
	`is_nuÎ
(
$cŞÜ_ty³
è? 
$this
->
glowPrİ”t›s
['color']['type'] : $color_type

494 
	}
}

503 
public
 
funùiÚ
 
	$g‘GlowPrİ”ty
(
$´İ”ty
)

505  
$this
->
	`g‘A¼ayEËm’tsV®ue
($this->
glowPrİ”t›s
, 
$´İ”ty
);

506 
	}
}

515 
´iv©e
 
funùiÚ
 
	$£tGlowSize
(
$size
)

517 ià(!
	`is_nuÎ
(
$size
)) {

518 
$this
->
glowPrİ”t›s
['size'] = $this->
	`g‘ExûlPoštsWidth
(
$size
);

521  
$this
;

522 
	}
}

533 
´iv©e
 
funùiÚ
 
	$£tGlowCŞÜ
(
$cŞÜ
, 
$®pha
, 
$ty³
)

535 
$this
->
glowPrİ”t›s
['cŞÜ'] = $this->
	`£tCŞÜPrİ”t›s
(
$cŞÜ
, 
$®pha
, 
$ty³
);

537  
$this
;

538 
	}
}

545 
public
 
funùiÚ
 
	$£tSoáEdges
(
$size
)

547 ià(!
	`is_nuÎ
(
$size
)) {

548 
$soáEdges
['size'] = (
¡ršg
è
$this
->
	`g‘ExûlPoštsWidth
(
$size
);

550 
	}
}

557 
public
 
funùiÚ
 
	$g‘SoáEdgesSize
()

559  
$this
->
soáEdges
['size'];

560 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/DataSeries.php

1 <?
php


36 şas 
	cPHPExûl_Ch¬t_D©aS”›s


38 cÚ¡ 
	mTYPE_BARCHART
 = 'barChart';

39 cÚ¡ 
	mTYPE_BARCHART_3D
 = 'bar3DChart';

40 cÚ¡ 
	mTYPE_LINECHART
 = 'lineChart';

41 cÚ¡ 
	mTYPE_LINECHART_3D
 = 'line3DChart';

42 cÚ¡ 
	mTYPE_AREACHART
 = 'areaChart';

43 cÚ¡ 
	mTYPE_AREACHART_3D
 = 'area3DChart';

44 cÚ¡ 
	mTYPE_PIECHART
 = 'pieChart';

45 cÚ¡ 
	mTYPE_PIECHART_3D
 = 'pie3DChart';

46 cÚ¡ 
	mTYPE_DOUGHTNUTCHART
 = 'doughnutChart';

47 cÚ¡ 
	mTYPE_DONUTCHART
 = 
£lf
::
TYPE_DOUGHTNUTCHART
;

48 cÚ¡ 
	mTYPE_SCATTERCHART
 = 'scatterChart';

49 cÚ¡ 
	mTYPE_SURFACECHART
 = 'surfaceChart';

50 cÚ¡ 
	mTYPE_SURFACECHART_3D
 = 'surface3DChart';

51 cÚ¡ 
	mTYPE_RADARCHART
 = 'radarChart';

52 cÚ¡ 
	mTYPE_BUBBLECHART
 = 'bubbleChart';

53 cÚ¡ 
	mTYPE_STOCKCHART
 = 'stockChart';

54 cÚ¡ 
	mTYPE_CANDLECHART
 = 
£lf
::
TYPE_STOCKCHART
;

56 cÚ¡ 
	mGROUPING_CLUSTERED
 = 'clustered';

57 cÚ¡ 
	mGROUPING_STACKED
 = 'stacked';

58 cÚ¡ 
	mGROUPING_PERCENT_STACKED
 = 'percentStacked';

59 cÚ¡ 
	mGROUPING_STANDARD
 = 'standard';

61 cÚ¡ 
	mDIRECTION_BAR
 = 'bar';

62 cÚ¡ 
	mDIRECTION_HORIZONTAL
 = 
£lf
::
DIRECTION_BAR
;

63 cÚ¡ 
	mDIRECTION_COL
 = 'col';

64 cÚ¡ 
	mDIRECTION_COLUMN
 = 
£lf
::
DIRECTION_COL
;

65 cÚ¡ 
	mDIRECTION_VERTICAL
 = 
£lf
::
DIRECTION_COL
;

67 cÚ¡ 
	mSTYLE_LINEMARKER
 = 'lineMarker';

68 cÚ¡ 
	mSTYLE_SMOOTHMARKER
 = 'smoothMarker';

69 cÚ¡ 
	mSTYLE_MARKER
 = 'marker';

70 cÚ¡ 
	mSTYLE_FILLED
 = 'filled';

78 
´iv©e
 
	m$¶ÙTy³
;

85 
´iv©e
 
	m$¶ÙGroupšg
;

92 
´iv©e
 
	m$¶ÙDœeùiÚ
;

99 
´iv©e
 
	m$¶ÙStyË
;

106 
´iv©e
 
	m$¶ÙOrd”
 = 
¬¿y
();

113 
´iv©e
 
	m$¶ÙLab–
 = 
¬¿y
();

120 
´iv©e
 
	m$¶ÙC©egÜy
 = 
¬¿y
();

127 
´iv©e
 
	m$smoÙhLše
;

134 
´iv©e
 
	m$¶ÙV®ues
 = 
¬¿y
();

139 
public
 
funùiÚ
 
__cÚ¡ruù
(
$¶ÙTy³
 = 
nuÎ
, 
$¶ÙGroupšg
 =‚uÎ, 
$¶ÙOrd”
 = 
¬¿y
(), 
$¶ÙLab–
 =‡¼ay(), 
$¶ÙC©egÜy
 =‡¼ay(), 
$¶ÙV®ues
 =‡¼ay(), 
$¶ÙDœeùiÚ
 =‚uÎ, 
$smoÙhLše
 =‚uÎ, 
$¶ÙStyË
 =‚ull)

141 
$this
->
¶ÙTy³
 = 
$¶ÙTy³
;

142 
	m$this
->
	m¶ÙGroupšg
 = 
$¶ÙGroupšg
;

143 
	m$this
->
	m¶ÙOrd”
 = 
$¶ÙOrd”
;

144 
	m$keys
 = 
¬¿y_keys
(
$¶ÙV®ues
);

145 
	m$this
->
	m¶ÙV®ues
 = 
$¶ÙV®ues
;

146 ià((
couÁ
(
$¶ÙLab–
è=ğ0è|| (
is_nuÎ
($¶ÙLab–[
$keys
[0]]))) {

147 
$¶ÙLab–
[
$keys
[0]] = 
Ãw
 
PHPExûl_Ch¬t_D©aS”›sV®ues
();

150 
	m$this
->
	m¶ÙLab–
 = 
$¶ÙLab–
;

151 ià((
couÁ
(
$¶ÙC©egÜy
è=ğ0è|| (
is_nuÎ
($¶ÙC©egÜy[
$keys
[0]]))) {

152 
$¶ÙC©egÜy
[
$keys
[0]] = 
Ãw
 
PHPExûl_Ch¬t_D©aS”›sV®ues
();

154 
	m$this
->
	m¶ÙC©egÜy
 = 
$¶ÙC©egÜy
;

155 
	m$this
->
	msmoÙhLše
 = 
$smoÙhLše
;

156 
	m$this
->
	m¶ÙStyË
 = 
$¶ÙStyË
;

158 ià(
is_nuÎ
(
$¶ÙDœeùiÚ
)) {

159 
	m$¶ÙDœeùiÚ
 = 
£lf
::
DIRECTION_COL
;

161 
	m$this
->
	m¶ÙDœeùiÚ
 = 
$¶ÙDœeùiÚ
;

169 
public
 
funùiÚ
 
	$g‘PlÙTy³
()

171  
$this
->
¶ÙTy³
;

172 
	}
}

180 
public
 
funùiÚ
 
£tPlÙTy³
(
$¶ÙTy³
 = '')

182 
$this
->
¶ÙTy³
 = 
$¶ÙTy³
;

183  
	g$this
;

191 
public
 
funùiÚ
 
	$g‘PlÙGroupšg
()

193  
$this
->
¶ÙGroupšg
;

194 
	}
}

202 
public
 
funùiÚ
 
	$£tPlÙGroupšg
(
$groupšgTy³
 = 
nuÎ
)

204 
$this
->
¶ÙGroupšg
 = 
$groupšgTy³
;

205  
$this
;

206 
	}
}

213 
public
 
funùiÚ
 
	$g‘PlÙDœeùiÚ
()

215  
$this
->
¶ÙDœeùiÚ
;

216 
	}
}

224 
public
 
funùiÚ
 
	$£tPlÙDœeùiÚ
(
$¶ÙDœeùiÚ
 = 
nuÎ
)

226 
$this
->
¶ÙDœeùiÚ
 = 
$¶ÙDœeùiÚ
;

227  
$this
;

228 
	}
}

235 
public
 
funùiÚ
 
	$g‘PlÙOrd”
()

237  
$this
->
¶ÙOrd”
;

238 
	}
}

245 
public
 
funùiÚ
 
	$g‘PlÙLab–s
()

247  
$this
->
¶ÙLab–
;

248 
	}
}

255 
public
 
funùiÚ
 
	$g‘PlÙLab–ByIndex
(
$šdex
)

257 
$keys
 = 
	`¬¿y_keys
(
$this
->
¶ÙLab–
);

258 ià(
	`š_¬¿y
(
$šdex
, 
$keys
)) {

259  
$this
->
¶ÙLab–
[
$šdex
];

260 } 
	`–£if
 (
	`is£t
(
$keys
[
$šdex
])) {

261  
$this
->
¶ÙLab–
[
$keys
[
$šdex
]];

263  
çl£
;

264 
	}
}

271 
public
 
funùiÚ
 
	$g‘PlÙC©egÜ›s
()

273  
$this
->
¶ÙC©egÜy
;

274 
	}
}

281 
public
 
funùiÚ
 
	$g‘PlÙC©egÜyByIndex
(
$šdex
)

283 
$keys
 = 
	`¬¿y_keys
(
$this
->
¶ÙC©egÜy
);

284 ià(
	`š_¬¿y
(
$šdex
, 
$keys
)) {

285  
$this
->
¶ÙC©egÜy
[
$šdex
];

286 } 
	`–£if
 (
	`is£t
(
$keys
[
$šdex
])) {

287  
$this
->
¶ÙC©egÜy
[
$keys
[
$šdex
]];

289  
çl£
;

290 
	}
}

297 
public
 
funùiÚ
 
	$g‘PlÙStyË
()

299  
$this
->
¶ÙStyË
;

300 
	}
}

308 
public
 
funùiÚ
 
	$£tPlÙStyË
(
$¶ÙStyË
 = 
nuÎ
)

310 
$this
->
¶ÙStyË
 = 
$¶ÙStyË
;

311  
$this
;

312 
	}
}

319 
public
 
funùiÚ
 
	$g‘PlÙV®ues
()

321  
$this
->
¶ÙV®ues
;

322 
	}
}

329 
public
 
funùiÚ
 
	$g‘PlÙV®uesByIndex
(
$šdex
)

331 
$keys
 = 
	`¬¿y_keys
(
$this
->
¶ÙV®ues
);

332 ià(
	`š_¬¿y
(
$šdex
, 
$keys
)) {

333  
$this
->
¶ÙV®ues
[
$šdex
];

334 } 
	`–£if
 (
	`is£t
(
$keys
[
$šdex
])) {

335  
$this
->
¶ÙV®ues
[
$keys
[
$šdex
]];

337  
çl£
;

338 
	}
}

345 
public
 
funùiÚ
 
	$g‘PlÙS”›sCouÁ
()

347  
	`couÁ
(
$this
->
¶ÙV®ues
);

348 
	}
}

355 
public
 
funùiÚ
 
	$g‘SmoÙhLše
()

357  
$this
->
smoÙhLše
;

358 
	}
}

366 
public
 
funùiÚ
 
	$£tSmoÙhLše
(
$smoÙhLše
 = 
Œue
)

368 
$this
->
smoÙhLše
 = 
$smoÙhLše
;

369  
$this
;

370 
	}
}

372 
public
 
funùiÚ
 
	$»äesh
(
PHPExûl_WÜksh“t
 
$wÜksh“t
)

374 
	`fÜ—ch
 (
$this
->
¶ÙV®ues
 
as
 
$¶ÙV®ues
) {

375 ià(
$¶ÙV®ues
 !=ğ
nuÎ
) {

376 
$¶ÙV®ues
->
	`»äesh
(
$wÜksh“t
, 
Œue
);

379 
	`fÜ—ch
 (
$this
->
¶ÙLab–
 
as
 
$¶ÙV®ues
) {

380 ià(
$¶ÙV®ues
 !=ğ
nuÎ
) {

381 
$¶ÙV®ues
->
	`»äesh
(
$wÜksh“t
, 
Œue
);

384 
	`fÜ—ch
 (
$this
->
¶ÙC©egÜy
 
as
 
$¶ÙV®ues
) {

385 ià(
$¶ÙV®ues
 !=ğ
nuÎ
) {

386 
$¶ÙV®ues
->
	`»äesh
(
$wÜksh“t
, 
çl£
);

389 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/DataSeriesValues.php

1 <?
php


28 şas 
	cPHPExûl_Ch¬t_D©aS”›sV®ues


31 cÚ¡ 
	mDATASERIES_TYPE_STRING
 = 'String';

32 cÚ¡ 
	mDATASERIES_TYPE_NUMBER
 = 'Number';

34 
´iv©e
 
	m$d©aTy³V®ues
 = 
¬¿y
(

35 
£lf
::
DATASERIES_TYPE_STRING
,

36 
£lf
::
DATASERIES_TYPE_NUMBER
,

44 
´iv©e
 
	m$d©aTy³
;

51 
´iv©e
 
	m$d©aSourû
;

58 
´iv©e
 
	m$fÜm©Code
;

65 
´iv©e
 
	m$poštM¬k”
;

72 
´iv©e
 
	m$poštCouÁ
 = 0;

79 
´iv©e
 
	m$d©aV®ues
 = 
¬¿y
();

84 
public
 
funùiÚ
 
__cÚ¡ruù
(
$d©aTy³
 = 
£lf
::
DATASERIES_TYPE_NUMBER
, 
$d©aSourû
 = 
nuÎ
, 
$fÜm©Code
 =‚uÎ, 
$poštCouÁ
 = 0, 
$d©aV®ues
 = 
¬¿y
(), 
$m¬k”
 =‚ull)

86 
$this
->
£tD©aTy³
(
$d©aTy³
);

87 
	m$this
->
	md©aSourû
 = 
$d©aSourû
;

88 
	m$this
->
	mfÜm©Code
 = 
$fÜm©Code
;

89 
	m$this
->
	mpoštCouÁ
 = 
$poštCouÁ
;

90 
	m$this
->
	md©aV®ues
 = 
$d©aV®ues
;

91 
	m$this
->
	mpoštM¬k”
 = 
$m¬k”
;

99 
public
 
funùiÚ
 
	$g‘D©aTy³
()

101  
$this
->
d©aTy³
;

102 
	}
}

115 
public
 
funùiÚ
 
	$£tD©aTy³
(
$d©aTy³
 = 
£lf
::
DATASERIES_TYPE_NUMBER
)

117 ià(!
	`š_¬¿y
(
$d©aTy³
, 
£lf
::
$d©aTy³V®ues
)) {

118 
throw
 
Ãw
 
	`PHPExûl_Ch¬t_Exû±iÚ
('Invalid datatype for chart data series values');

120 
$this
->
d©aTy³
 = 
$d©aTy³
;

122  
$this
;

123 
	}
}

130 
public
 
funùiÚ
 
	$g‘D©aSourû
()

132  
$this
->
d©aSourû
;

133 
	}
}

141 
public
 
funùiÚ
 
	$£tD©aSourû
(
$d©aSourû
 = 
nuÎ
, 
$»äeshD©aV®ues
 = 
Œue
)

143 
$this
->
d©aSourû
 = 
$d©aSourû
;

145 ià(
$»äeshD©aV®ues
) {

149  
$this
;

150 
	}
}

157 
public
 
funùiÚ
 
	$g‘PoštM¬k”
()

159  
$this
->
poštM¬k”
;

160 
	}
}

168 
public
 
funùiÚ
 
	$£tPoštM¬k”
(
$m¬k”
 = 
nuÎ
)

170 
$this
->
poštM¬k”
 = 
$m¬k”
;

172  
$this
;

173 
	}
}

180 
public
 
funùiÚ
 
	$g‘FÜm©Code
()

182  
$this
->
fÜm©Code
;

183 
	}
}

191 
public
 
funùiÚ
 
	$£tFÜm©Code
(
$fÜm©Code
 = 
nuÎ
)

193 
$this
->
fÜm©Code
 = 
$fÜm©Code
;

195  
$this
;

196 
	}
}

203 
public
 
funùiÚ
 
	$g‘PoštCouÁ
()

205  
$this
->
poštCouÁ
;

206 
	}
}

213 
public
 
funùiÚ
 
	$isMuÉiLev–S”›s
()

215 ià(
	`couÁ
(
$this
->
d©aV®ues
) > 0) {

216  
	`is_¬¿y
(
$this
->
d©aV®ues
[0]);

218  
nuÎ
;

219 
	}
}

226 
public
 
funùiÚ
 
	$muÉiLev–CouÁ
()

228 
$Ëv–CouÁ
 = 0;

229 
	`fÜ—ch
 (
$this
->
d©aV®ues
 
as
 
$d©aV®ueS‘
) {

230 
$Ëv–CouÁ
 = 
	`max
($Ëv–CouÁ, 
	`couÁ
(
$d©aV®ueS‘
));

232  
$Ëv–CouÁ
;

233 
	}
}

240 
public
 
funùiÚ
 
	$g‘D©aV®ues
()

242  
$this
->
d©aV®ues
;

243 
	}
}

250 
public
 
funùiÚ
 
	$g‘D©aV®ue
()

252 
$couÁ
 = 
	`couÁ
(
$this
->
d©aV®ues
);

253 ià(
$couÁ
 == 0) {

254  
nuÎ
;

255 } 
	`–£if
 (
$couÁ
 == 1) {

256  
$this
->
d©aV®ues
[0];

258  
$this
->
d©aV®ues
;

259 
	}
}

270 
public
 
funùiÚ
 
£tD©aV®ues
(
$d©aV®ues
 = 
¬¿y
(), 
$»äeshD©aSourû
 = 
Œue
)

272 
$this
->
d©aV®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
æ©‹nA¼ay
(
$d©aV®ues
);

273 
	g$this
->
	gpoštCouÁ
 = 
couÁ
(
$d©aV®ues
);

275 ià(
	g$»äeshD©aSourû
) {

279  
	g$this
;

282 
´iv©e
 
funùiÚ
 
	$¡rNuÎs
(
$v¬
)

284  
$v¬
 !=ğ
nuÎ
;

285 
	}
}

287 
public
 
funùiÚ
 
	$»äesh
(
PHPExûl_WÜksh“t
 
$wÜksh“t
, 
$æ©‹n
 = 
Œue
)

289 ià(
$this
->
d©aSourû
 !=ğ
nuÎ
) {

290 
$ÿlcEngše
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$wÜksh“t
->
	`g‘P¬’t
());

291 
$ÃwD©aV®ues
 = 
PHPExûl_C®cuÏtiÚ
::
	`unw¿pResuÉ
(

292 
$ÿlcEngše
->
	`_ÿlcuÏ‹FÜmuÏV®ue
(

293 '='.
$this
->
d©aSourû
,

294 
nuÎ
,

295 
$wÜksh“t
->
	`g‘C–l
('A1')

298 ià(
$æ©‹n
) {

299 
$this
->
d©aV®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$ÃwD©aV®ues
);

300 
	`fÜ—ch
 (
$this
->
d©aV®ues
 
as
 &
$d©aV®ue
) {

301 ià((!
	`em±y
(
$d©aV®ue
)) && ($dataValue[0] == '#')) {

302 
$d©aV®ue
 = 0.0;

305 
	`un£t
(
$d©aV®ue
);

307 
$ûÎRªge
 = 
	`ex¶ode
('!', 
$this
->
d©aSourû
);

308 ià(
	`couÁ
(
$ûÎRªge
) > 1) {

309 
	`li¡
(, 
$ûÎRªge
) = $cellRange;

312 
$dim’siÚs
 = 
PHPExûl_C–l
::
	`¿ngeDim’siÚ
(
	`¡r_»¶aû
('$', '', 
$ûÎRªge
));

313 ià((
$dim’siÚs
[0] == 1) || ($dimensions[1] == 1)) {

314 
$this
->
d©aV®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$ÃwD©aV®ues
);

316 
$ÃwA¼ay
 = 
	`¬¿y_v®ues
(
	`¬¿y_shiá
(
$ÃwD©aV®ues
));

317 
	`fÜ—ch
 (
$ÃwA¼ay
 
as
 
$i
 => 
$ÃwD©aS‘
) {

318 
$ÃwA¼ay
[
$i
] = 
	`¬¿y
(
$ÃwD©aS‘
);

321 
	`fÜ—ch
 (
$ÃwD©aV®ues
 
as
 
$ÃwD©aS‘
) {

322 
$i
 = 0;

323 
	`fÜ—ch
 (
$ÃwD©aS‘
 
as
 
$ÃwD©aV®
) {

324 
	`¬¿y_unshiá
(
$ÃwA¼ay
[
$i
++], 
$ÃwD©aV®
);

327 
$this
->
d©aV®ues
 = 
$ÃwA¼ay
;

330 
$this
->
poštCouÁ
 = 
	`couÁ
($this->
d©aV®ues
);

332 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Exception.php

1 <?
php


28 şas 
	cPHPExûl_Ch¬t_Exû±iÚ
 
ex‹nds
 
	mPHPExûl_Exû±iÚ


39 
public
 
funùiÚ
 
	$”rÜHªdËrC®lback
(
$code
, 
$¡ršg
, 
$fe
, 
$lše
, 
$cÚ‹xt
)

41 
$e
 = 
Ãw
 
	`£lf
(
$¡ršg
, 
$code
);

42 
$e
->
lše
 = 
$lše
;

43 
$e
->
fe
 = 
$fe
;

44 
throw
 
$e
;

46 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/GridLines.php

1 <?
php


10 şas 
	cPHPExûl_Ch¬t_GridLšes
 
ex‹nds
 
	mPHPExûl_Ch¬t_Prİ”t›s


23 
´iv©e
 
	m$objeùS‹
 = 
çl£
;

25 
´iv©e
 
	m$lšePrİ”t›s
 = 
¬¿y
(

26 'cŞÜ' => 
¬¿y
(

27 'ty³' => 
£lf
::
EXCEL_COLOR_TYPE_STANDARD
,

28 'v®ue' => 
nuÎ
,

31 '¡yË' => 
¬¿y
(

33 'compound' => 
£lf
::
LINE_STYLE_COMPOUND_SIMPLE
,

34 'dash' => 
£lf
::
LINE_STYLE_DASH_SOLID
,

35 'ÿp' => 
£lf
::
LINE_STYLE_CAP_FLAT
,

36 'još' => 
£lf
::
LINE_STYLE_JOIN_BEVEL
,

37 '¬row' => 
¬¿y
(

38 'h—d' => 
¬¿y
(

39 'ty³' => 
£lf
::
LINE_STYLE_ARROW_TYPE_NOARROW
,

40 'size' => 
£lf
::
LINE_STYLE_ARROW_SIZE_5


42 '’d' => 
¬¿y
(

43 'ty³' => 
£lf
::
LINE_STYLE_ARROW_TYPE_NOARROW
,

44 'size' => 
£lf
::
LINE_STYLE_ARROW_SIZE_8


50 
´iv©e
 
	m$shadowPrİ”t›s
 = 
¬¿y
(

51 '´e£ts' => 
£lf
::
SHADOW_PRESETS_NOSHADOW
,

52 'efãù' => 
nuÎ
,

53 'cŞÜ' => 
¬¿y
(

54 'ty³' => 
£lf
::
EXCEL_COLOR_TYPE_STANDARD
,

58 'size' => 
¬¿y
(

59 'sx' => 
nuÎ
,

60 'sy' => 
nuÎ
,

61 'kx' => 
nuÎ


63 'blur' => 
nuÎ
,

64 'dœeùiÚ' => 
nuÎ
,

65 'di¡ªû' => 
nuÎ
,

66 '®gn' => 
nuÎ
,

67 'rÙW™hSh­e' => 
nuÎ


70 
´iv©e
 
	m$glowPrİ”t›s
 = 
¬¿y
(

71 'size' => 
nuÎ
,

72 'cŞÜ' => 
¬¿y
(

73 'ty³' => 
£lf
::
EXCEL_COLOR_TYPE_STANDARD
,

79 
´iv©e
 
	m$soáEdges
 = 
¬¿y
(

80 'size' => 
nuÎ


89 
public
 
funùiÚ
 
	$g‘ObjeùS‹
()

91  
$this
->
objeùS‹
;

100 
´iv©e
 
funùiÚ
 
	$aùiv©eObjeù
()

102 
$this
->
objeùS‹
 = 
Œue
;

104  
$this
;

105 
	}
}

115 
public
 
funùiÚ
 
	$£tLšeCŞÜPrİ”t›s
(
$v®ue
, 
$®pha
 = 0, 
$ty³
 = 
£lf
::
EXCEL_COLOR_TYPE_STANDARD
)

117 
$this
->
	`aùiv©eObjeù
()

118 ->
lšePrİ”t›s
['cŞÜ'] = 
$this
->
	`£tCŞÜPrİ”t›s
(

119 
$v®ue
,

120 
$®pha
,

121 
$ty³


123 
	}
}

139 
public
 
funùiÚ
 
	$£tLšeStyËPrİ”t›s
(
$lše_width
 = 
nuÎ
, 
$compound_ty³
 =‚uÎ, 
$dash_ty³
 =‚uÎ, 
$ÿp_ty³
 =‚uÎ, 
$još_ty³
 =‚uÎ, 
$h—d_¬row_ty³
 =‚uÎ, 
$h—d_¬row_size
 =‚uÎ, 
$’d_¬row_ty³
 =‚uÎ, 
$’d_¬row_size
 =‚ull)

141 
$this
->
	`aùiv©eObjeù
();

142 (!
	`is_nuÎ
(
$lše_width
))

143 ? 
$this
->
lšePrİ”t›s
['¡yË']['width'] = $this->
	`g‘ExûlPoštsWidth
((è
$lše_width
)

144 : 
nuÎ
;

145 (!
	`is_nuÎ
(
$compound_ty³
))

146 ? 
$this
->
lšePrİ”t›s
['¡yË']['compound'] = (
¡ršg
è
$compound_ty³


147 : 
nuÎ
;

148 (!
	`is_nuÎ
(
$dash_ty³
))

149 ? 
$this
->
lšePrİ”t›s
['¡yË']['dash'] = (
¡ršg
è
$dash_ty³


150 : 
nuÎ
;

151 (!
	`is_nuÎ
(
$ÿp_ty³
))

152 ? 
$this
->
lšePrİ”t›s
['¡yË']['ÿp'] = (
¡ršg
è
$ÿp_ty³


153 : 
nuÎ
;

154 (!
	`is_nuÎ
(
$još_ty³
))

155 ? 
$this
->
lšePrİ”t›s
['¡yË']['još'] = (
¡ršg
è
$još_ty³


156 : 
nuÎ
;

157 (!
	`is_nuÎ
(
$h—d_¬row_ty³
))

158 ? 
$this
->
lšePrİ”t›s
['¡yË']['¬row']['h—d']['ty³'] = (
¡ršg
è
$h—d_¬row_ty³


159 : 
nuÎ
;

160 (!
	`is_nuÎ
(
$h—d_¬row_size
))

161 ? 
$this
->
lšePrİ”t›s
['¡yË']['¬row']['h—d']['size'] = (
¡ršg
è
$h—d_¬row_size


162 : 
nuÎ
;

163 (!
	`is_nuÎ
(
$’d_¬row_ty³
))

164 ? 
$this
->
lšePrİ”t›s
['¡yË']['¬row']['’d']['ty³'] = (
¡ršg
è
$’d_¬row_ty³


165 : 
nuÎ
;

166 (!
	`is_nuÎ
(
$’d_¬row_size
))

167 ? 
$this
->
lšePrİ”t›s
['¡yË']['¬row']['’d']['size'] = (
¡ršg
è
$’d_¬row_size


168 : 
nuÎ
;

169 
	}
}

179 
public
 
funùiÚ
 
	$g‘LšeCŞÜPrİ”ty
(
$·¿m‘”
)

181  
$this
->
lšePrİ”t›s
['cŞÜ'][
$·¿m‘”
];

182 
	}
}

192 
public
 
funùiÚ
 
	$g‘LšeStyËPrİ”ty
(
$–em’ts
)

194  
$this
->
	`g‘A¼ayEËm’tsV®ue
($this->
lšePrİ”t›s
['¡yË'], 
$–em’ts
);

195 
	}
}

207 
public
 
funùiÚ
 
	$£tGlowPrİ”t›s
(
$size
, 
$cŞÜ_v®ue
 = 
nuÎ
, 
$cŞÜ_®pha
 =‚uÎ, 
$cŞÜ_ty³
 =‚ull)

209 
$this


210 ->
	`aùiv©eObjeù
()

211 ->
	`£tGlowSize
(
$size
)

212 ->
	`£tGlowCŞÜ
(
$cŞÜ_v®ue
, 
$cŞÜ_®pha
, 
$cŞÜ_ty³
);

213 
	}
}

223 
public
 
funùiÚ
 
	$g‘GlowCŞÜ
(
$´İ”ty
)

225  
$this
->
glowPrİ”t›s
['cŞÜ'][
$´İ”ty
];

226 
	}
}

234 
public
 
funùiÚ
 
	$g‘GlowSize
()

236  
$this
->
glowPrİ”t›s
['size'];

237 
	}
}

247 
´iv©e
 
funùiÚ
 
	$£tGlowSize
(
$size
)

249 
$this
->
glowPrİ”t›s
['size'] = $this->
	`g‘ExûlPoštsWidth
((è
$size
);

251  
$this
;

252 
	}
}

264 
´iv©e
 
funùiÚ
 
	$£tGlowCŞÜ
(
$cŞÜ
, 
$®pha
, 
$ty³
)

266 ià(!
	`is_nuÎ
(
$cŞÜ
)) {

267 
$this
->
glowPrİ”t›s
['cŞÜ']['v®ue'] = (
¡ršg
è
$cŞÜ
;

269 ià(!
	`is_nuÎ
(
$®pha
)) {

270 
$this
->
glowPrİ”t›s
['cŞÜ']['®pha'] = $this->
	`g‘TrueAÍha
((è
$®pha
);

272 ià(!
	`is_nuÎ
(
$ty³
)) {

273 
$this
->
glowPrİ”t›s
['cŞÜ']['ty³'] = (
¡ršg
è
$ty³
;

276  
$this
;

277 
	}
}

288 
public
 
funùiÚ
 
	$g‘LšeStyËA¼owP¬am‘”s
(
$¬row_£ËùÜ
, 
$´İ”ty_£ËùÜ
)

290  
$this
->
	`g‘LšeStyËA¼owSize
($this->
lšePrİ”t›s
['¡yË']['¬row'][
$¬row_£ËùÜ
]['size'], 
$´İ”ty_£ËùÜ
);

291 
	}
}

306 
public
 
funùiÚ
 
	$£tShadowPrİ”t›s
(
$sh_´e£ts
, 
$sh_cŞÜ_v®ue
 = 
nuÎ
, 
$sh_cŞÜ_ty³
 =‚uÎ, 
$sh_cŞÜ_®pha
 =‚uÎ, 
$sh_blur
 =‚uÎ, 
$sh_ªgË
 =‚uÎ, 
$sh_di¡ªû
 =‚ull)

308 
$this
->
	`aùiv©eObjeù
()

309 ->
	`£tShadowP»£tsPrİ”t›s
((è
$sh_´e£ts
)

310 ->
	`£tShadowCŞÜ
(

311 
	`is_nuÎ
(
$sh_cŞÜ_v®ue
è? 
$this
->
shadowPrİ”t›s
['color']['value'] : $sh_color_value,

312 
	`is_nuÎ
(
$sh_cŞÜ_®pha
è? (è
$this
->
shadowPrİ”t›s
['cŞÜ']['®pha'] : $this->
	`g‘TrueAÍha
($sh_color_alpha),

313 
	`is_nuÎ
(
$sh_cŞÜ_ty³
è? 
$this
->
shadowPrİ”t›s
['color']['type'] : $sh_color_type

315 ->
	`£tShadowBlur
(
$sh_blur
)

316 ->
	`£tShadowAngË
(
$sh_ªgË
)

317 ->
	`£tShadowDi¡ªû
(
$sh_di¡ªû
);

318 
	}
}

328 
´iv©e
 
funùiÚ
 
	$£tShadowP»£tsPrİ”t›s
(
$shadow_´e£ts
)

330 
$this
->
shadowPrİ”t›s
['´e£ts'] = 
$shadow_´e£ts
;

331 
$this
->
	`£tShadowPrİ”›sM­V®ues
($this->
	`g‘ShadowP»£tsM­
(
$shadow_´e£ts
));

333  
$this
;

334 
	}
}

345 
´iv©e
 
funùiÚ
 
	$£tShadowPrİ”›sM­V®ues
(
¬¿y
 
$´İ”t›s_m­
, &
$»ã»nû
 = 
nuÎ
)

347 
$ba£_»ã»nû
 = 
$»ã»nû
;

348 
	`fÜ—ch
 (
$´İ”t›s_m­
 
as
 
$´İ”ty_key
 => 
$´İ”ty_v®
) {

349 ià(
	`is_¬¿y
(
$´İ”ty_v®
)) {

350 ià(
$»ã»nû
 ==ğ
nuÎ
) {

351 
$»ã»nû
 = & 
$this
->
shadowPrİ”t›s
[
$´İ”ty_key
];

353 
$»ã»nû
 = & $»ã»nû[
$´İ”ty_key
];

355 
$this
->
	`£tShadowPrİ”›sM­V®ues
(
$´İ”ty_v®
, 
$»ã»nû
);

357 ià(
$ba£_»ã»nû
 ==ğ
nuÎ
) {

358 
$this
->
shadowPrİ”t›s
[
$´İ”ty_key
] = 
$´İ”ty_v®
;

360 
$»ã»nû
[
$´İ”ty_key
] = 
$´İ”ty_v®
;

365  
$this
;

366 
	}
}

376 
´iv©e
 
funùiÚ
 
	$£tShadowCŞÜ
(
$cŞÜ
, 
$®pha
, 
$ty³
)

378 ià(!
	`is_nuÎ
(
$cŞÜ
)) {

379 
$this
->
shadowPrİ”t›s
['cŞÜ']['v®ue'] = (
¡ršg
è
$cŞÜ
;

381 ià(!
	`is_nuÎ
(
$®pha
)) {

382 
$this
->
shadowPrİ”t›s
['cŞÜ']['®pha'] = $this->
	`g‘TrueAÍha
((è
$®pha
);

384 ià(!
	`is_nuÎ
(
$ty³
)) {

385 
$this
->
shadowPrİ”t›s
['cŞÜ']['ty³'] = (
¡ršg
è
$ty³
;

388  
$this
;

389 
	}
}

398 
´iv©e
 
funùiÚ
 
	$£tShadowBlur
(
$blur
)

400 ià(
$blur
 !=ğ
nuÎ
) {

401 
$this
->
shadowPrİ”t›s
['blur'] = (
¡ršg
è$this->
	`g‘ExûlPoštsWidth
(
$blur
);

404  
$this
;

405 
	}
}

414 
´iv©e
 
funùiÚ
 
	$£tShadowAngË
(
$ªgË
)

416 ià(
$ªgË
 !=ğ
nuÎ
) {

417 
$this
->
shadowPrİ”t›s
['dœeùiÚ'] = (
¡ršg
è$this->
	`g‘ExûlPoštsAngË
(
$ªgË
);

420  
$this
;

421 
	}
}

429 
´iv©e
 
funùiÚ
 
	$£tShadowDi¡ªû
(
$di¡ªû
)

431 ià(
$di¡ªû
 !=ğ
nuÎ
) {

432 
$this
->
shadowPrİ”t›s
['di¡ªû'] = (
¡ršg
è$this->
	`g‘ExûlPoštsWidth
(
$di¡ªû
);

435  
$this
;

436 
	}
}

445 
public
 
funùiÚ
 
	$g‘ShadowPrİ”ty
(
$–em’ts
)

447  
$this
->
	`g‘A¼ayEËm’tsV®ue
($this->
shadowPrİ”t›s
, 
$–em’ts
);

448 
	}
}

455 
public
 
funùiÚ
 
	$£tSoáEdgesSize
(
$size
)

457 ià(!
	`is_nuÎ
(
$size
)) {

458 
$this
->
	`aùiv©eObjeù
();

459 
$soáEdges
['size'] = (
¡ršg
è
$this
->
	`g‘ExûlPoštsWidth
(
$size
);

461 
	}
}

468 
public
 
funùiÚ
 
	$g‘SoáEdgesSize
()

470  
$this
->
soáEdges
['size'];

471 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Layout.php

1 <?
php


36 şas 
	cPHPExûl_Ch¬t_Layout


43 
´iv©e
 
	m$ÏyoutT¬g‘
;

50 
´iv©e
 
	m$xMode
;

57 
´iv©e
 
	m$yMode
;

64 
´iv©e
 
	m$xPos
;

71 
´iv©e
 
	m$yPos
;

78 
´iv©e
 
	m$width
;

85 
´iv©e
 
	m$height
;

93 
´iv©e
 
	m$showLeg’dKey
;

101 
´iv©e
 
	m$showV®
;

109 
´iv©e
 
	m$showC©Name
;

117 
´iv©e
 
	m$showS”Name
;

125 
´iv©e
 
	m$showP”ûÁ
;

132 
´iv©e
 
	m$showBubbËSize
;

140 
´iv©e
 
	m$showL—d”Lšes
;

146 
public
 
funùiÚ
 
__cÚ¡ruù
(
$Ïyout
 = 
	$¬¿y
())

148 ià(
	`is£t
(
$Ïyout
['layoutTarget'])) {

149 
$this
->
ÏyoutT¬g‘
 = 
$Ïyout
['layoutTarget'];

151 ià(
	`is£t
(
$Ïyout
['xMode'])) {

152 
$this
->
xMode
 = 
$Ïyout
['xMode'];

154 ià(
	`is£t
(
$Ïyout
['yMode'])) {

155 
$this
->
yMode
 = 
$Ïyout
['yMode'];

157 ià(
	`is£t
(
$Ïyout
['x'])) {

158 
$this
->
xPos
 = (è
$Ïyout
['x'];

160 ià(
	`is£t
(
$Ïyout
['y'])) {

161 
$this
->
yPos
 = (è
$Ïyout
['y'];

163 ià(
	`is£t
(
$Ïyout
['w'])) {

164 
$this
->
width
 = (è
$Ïyout
['w'];

166 ià(
	`is£t
(
$Ïyout
['h'])) {

167 
$this
->
height
 = (è
$Ïyout
['h'];

176 
public
 
funùiÚ
 
	$g‘LayoutT¬g‘
()

178  
$this
->
ÏyoutT¬g‘
;

179 
	}
}

187 
public
 
funùiÚ
 
	$£tLayoutT¬g‘
(
$v®ue
)

189 
$this
->
ÏyoutT¬g‘
 = 
$v®ue
;

190  
$this
;

191 
	}
}

198 
public
 
funùiÚ
 
	$g‘XMode
()

200  
$this
->
xMode
;

201 
	}
}

209 
public
 
funùiÚ
 
	$£tXMode
(
$v®ue
)

211 
$this
->
xMode
 = 
$v®ue
;

212  
$this
;

213 
	}
}

220 
public
 
funùiÚ
 
	$g‘YMode
()

222  
$this
->
yMode
;

223 
	}
}

231 
public
 
funùiÚ
 
	$£tYMode
(
$v®ue
)

233 
$this
->
yMode
 = 
$v®ue
;

234  
$this
;

235 
	}
}

242 
public
 
funùiÚ
 
	$g‘XPos™iÚ
()

244  
$this
->
xPos
;

245 
	}
}

253 
public
 
funùiÚ
 
	$£tXPos™iÚ
(
$v®ue
)

255 
$this
->
xPos
 = 
$v®ue
;

256  
$this
;

257 
	}
}

264 
public
 
funùiÚ
 
	$g‘YPos™iÚ
()

266  
$this
->
yPos
;

267 
	}
}

275 
public
 
funùiÚ
 
	$£tYPos™iÚ
(
$v®ue
)

277 
$this
->
yPos
 = 
$v®ue
;

278  
$this
;

279 
	}
}

286 
public
 
funùiÚ
 
	$g‘Width
()

288  
$this
->
width
;

289 
	}
}

297 
public
 
funùiÚ
 
	$£tWidth
(
$v®ue
)

299 
$this
->
width
 = 
$v®ue
;

300  
$this
;

301 
	}
}

308 
public
 
funùiÚ
 
	$g‘Height
()

310  
$this
->
height
;

311 
	}
}

319 
public
 
funùiÚ
 
	$£tHeight
(
$v®ue
)

321 
$this
->
height
 = 
$v®ue
;

322  
$this
;

323 
	}
}

331 
public
 
funùiÚ
 
	$g‘ShowLeg’dKey
()

333  
$this
->
showLeg’dKey
;

334 
	}
}

343 
public
 
funùiÚ
 
	$£tShowLeg’dKey
(
$v®ue
)

345 
$this
->
showLeg’dKey
 = 
$v®ue
;

346  
$this
;

347 
	}
}

354 
public
 
funùiÚ
 
	$g‘ShowV®
()

356  
$this
->
showV®
;

357 
	}
}

366 
public
 
funùiÚ
 
	$£tShowV®
(
$v®ue
)

368 
$this
->
showV®
 = 
$v®ue
;

369  
$this
;

370 
	}
}

377 
public
 
funùiÚ
 
	$g‘ShowC©Name
()

379  
$this
->
showC©Name
;

380 
	}
}

389 
public
 
funùiÚ
 
	$£tShowC©Name
(
$v®ue
)

391 
$this
->
showC©Name
 = 
$v®ue
;

392  
$this
;

393 
	}
}

400 
public
 
funùiÚ
 
	$g‘ShowS”Name
()

402  
$this
->
showS”Name
;

403 
	}
}

412 
public
 
funùiÚ
 
	$£tShowS”Name
(
$v®ue
)

414 
$this
->
showS”Name
 = 
$v®ue
;

415  
$this
;

416 
	}
}

423 
public
 
funùiÚ
 
	$g‘ShowP”ûÁ
()

425  
$this
->
showP”ûÁ
;

426 
	}
}

435 
public
 
funùiÚ
 
	$£tShowP”ûÁ
(
$v®ue
)

437 
$this
->
showP”ûÁ
 = 
$v®ue
;

438  
$this
;

439 
	}
}

446 
public
 
funùiÚ
 
	$g‘ShowBubbËSize
()

448  
$this
->
showBubbËSize
;

449 
	}
}

458 
public
 
funùiÚ
 
	$£tShowBubbËSize
(
$v®ue
)

460 
$this
->
showBubbËSize
 = 
$v®ue
;

461  
$this
;

462 
	}
}

469 
public
 
funùiÚ
 
	$g‘ShowL—d”Lšes
()

471  
$this
->
showL—d”Lšes
;

472 
	}
}

481 
public
 
funùiÚ
 
	$£tShowL—d”Lšes
(
$v®ue
)

483 
$this
->
showL—d”Lšes
 = 
$v®ue
;

484  
$this
;

485 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Legend.php

1 <?
php


28 şas 
	cPHPExûl_Ch¬t_Leg’d


31 cÚ¡ 
	mxlLeg’dPos™iÚBÙtom
 = -4107;

32 cÚ¡ 
	mxlLeg’dPos™iÚCÜÃr
 = 2;

33 cÚ¡ 
	mxlLeg’dPos™iÚCu¡om
 = -4161;

34 cÚ¡ 
	mxlLeg’dPos™iÚLeá
 = -4131;

35 cÚ¡ 
	mxlLeg’dPos™iÚRight
 = -4152;

36 cÚ¡ 
	mxlLeg’dPos™iÚTİ
 = -4160;

38 cÚ¡ 
	mPOSITION_RIGHT
 = 'r';

39 cÚ¡ 
	mPOSITION_LEFT
 = 'l';

40 cÚ¡ 
	mPOSITION_BOTTOM
 = 'b';

41 cÚ¡ 
	mPOSITION_TOP
 = 't';

42 cÚ¡ 
	mPOSITION_TOPRIGHT
 = 'tr';

44 
´iv©e
 
	m$pos™iÚXL»f
 = 
¬¿y
(

45 
£lf
::
xlLeg’dPos™iÚBÙtom
 => s–f::
POSITION_BOTTOM
,

46 
£lf
::
xlLeg’dPos™iÚCÜÃr
 => s–f::
POSITION_TOPRIGHT
,

47 
£lf
::
xlLeg’dPos™iÚCu¡om
 => '??',

48 
£lf
::
xlLeg’dPos™iÚLeá
 => s–f::
POSITION_LEFT
,

49 
£lf
::
xlLeg’dPos™iÚRight
 => s–f::
POSITION_RIGHT
,

50 
£lf
::
xlLeg’dPos™iÚTİ
 => s–f::
POSITION_TOP


58 
´iv©e
 
	m$pos™iÚ
 = 
£lf
::
POSITION_RIGHT
;

65 
´iv©e
 
	m$ov”Ïy
 = 
Œue
;

72 
´iv©e
 
	m$Ïyout
 = 
nuÎ
;

78 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$pos™iÚ
 = 
£lf
::
POSITION_RIGHT
, 
PHPExûl_Ch¬t_Layout
 
$Ïyout
 = 
nuÎ
, 
$ov”Ïy
 = 
çl£
)

80 
$this
->
	`£tPos™iÚ
(
$pos™iÚ
);

81 
$this
->
Ïyout
 = 
$Ïyout
;

82 
$this
->
	`£tOv”Ïy
(
$ov”Ïy
);

90 
public
 
funùiÚ
 
	$g‘Pos™iÚ
()

92  
$this
->
pos™iÚ
;

93 
	}
}

100 
public
 
funùiÚ
 
	$£tPos™iÚ
(
$pos™iÚ
 = 
£lf
::
POSITION_RIGHT
)

102 ià(!
	`š_¬¿y
(
$pos™iÚ
, 
£lf
::
$pos™iÚXL»f
)) {

103  
çl£
;

106 
$this
->
pos™iÚ
 = 
$pos™iÚ
;

107  
Œue
;

108 
	}
}

115 
public
 
funùiÚ
 
	$g‘Pos™iÚXL
()

117  
	`¬¿y_£¬ch
(
$this
->
pos™iÚ
, 
£lf
::
$pos™iÚXL»f
);

118 
	}
}

125 
public
 
funùiÚ
 
	$£tPos™iÚXL
(
$pos™iÚXL
 = 
£lf
::
xlLeg’dPos™iÚRight
)

127 ià(!
	`¬¿y_key_exi¡s
(
$pos™iÚXL
, 
£lf
::
$pos™iÚXL»f
)) {

128  
çl£
;

131 
$this
->
pos™iÚ
 = 
£lf
::
$pos™iÚXL»f
[
$pos™iÚXL
];

132  
Œue
;

133 
	}
}

140 
public
 
funùiÚ
 
	$g‘Ov”Ïy
()

142  
$this
->
ov”Ïy
;

143 
	}
}

151 
public
 
funùiÚ
 
	$£tOv”Ïy
(
$ov”Ïy
 = 
çl£
)

153 ià(!
	`is_boŞ
(
$ov”Ïy
)) {

154  
çl£
;

157 
$this
->
ov”Ïy
 = 
$ov”Ïy
;

158  
Œue
;

159 
	}
}

166 
public
 
funùiÚ
 
	$g‘Layout
()

168  
$this
->
Ïyout
;

169 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/PlotArea.php

1 <?
php


28 şas 
	cPHPExûl_Ch¬t_PlÙA»a


35 
´iv©e
 
	m$Ïyout
 = 
nuÎ
;

42 
´iv©e
 
	m$¶ÙS”›s
 = 
¬¿y
();

47 
public
 
funùiÚ
 
__cÚ¡ruù
(
PHPExûl_Ch¬t_Layout
 
$Ïyout
 = 
nuÎ
, 
$¶ÙS”›s
 = 
	$¬¿y
())

49 
$this
->
Ïyout
 = 
$Ïyout
;

50 
$this
->
¶ÙS”›s
 = 
$¶ÙS”›s
;

58 
public
 
funùiÚ
 
	$g‘Layout
()

60  
$this
->
Ïyout
;

61 
	}
}

68 
public
 
funùiÚ
 
	$g‘PlÙGroupCouÁ
()

70  
	`couÁ
(
$this
->
¶ÙS”›s
);

71 
	}
}

78 
public
 
funùiÚ
 
	$g‘PlÙS”›sCouÁ
()

80 
$£r›sCouÁ
 = 0;

81 
	`fÜ—ch
 (
$this
->
¶ÙS”›s
 
as
 
$¶Ù
) {

82 
$£r›sCouÁ
 +ğ
$¶Ù
->
	`g‘PlÙS”›sCouÁ
();

84  
$£r›sCouÁ
;

85 
	}
}

92 
public
 
funùiÚ
 
	$g‘PlÙGroup
()

94  
$this
->
¶ÙS”›s
;

95 
	}
}

102 
public
 
funùiÚ
 
	$g‘PlÙGroupByIndex
(
$šdex
)

104  
$this
->
¶ÙS”›s
[
$šdex
];

105 
	}
}

113 
public
 
funùiÚ
 
£tPlÙS”›s
(
$¶ÙS”›s
 = 
	$¬¿y
())

115 
$this
->
¶ÙS”›s
 = 
$¶ÙS”›s
;

117  
$this
;

118 
	}
}

120 
public
 
funùiÚ
 
	$»äesh
(
PHPExûl_WÜksh“t
 
$wÜksh“t
)

122 
	`fÜ—ch
 (
$this
->
¶ÙS”›s
 
as
 
$¶ÙS”›s
) {

123 
$¶ÙS”›s
->
	`»äesh
(
$wÜksh“t
);

125 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Properties.php

1 <?
php


9 
ab¡¿ù
 cÏs 
	cPHPExûl_Ch¬t_Prİ”t›s


12 
	mEXCEL_COLOR_TYPE_STANDARD
 = 'prstClr',

13 
	mEXCEL_COLOR_TYPE_SCHEME
 = 'schemeClr',

14 
	mEXCEL_COLOR_TYPE_ARGB
 = 'srgbClr';

17 
	mAXIS_LABELS_LOW
 = 'low',

18 
	mAXIS_LABELS_HIGH
 = 'high',

19 
	mAXIS_LABELS_NEXT_TO
 = 'nextTo',

20 
	mAXIS_LABELS_NONE
 = 'none';

23 
	mTICK_MARK_NONE
 = 'none',

24 
	mTICK_MARK_INSIDE
 = 'in',

25 
	mTICK_MARK_OUTSIDE
 = 'out',

26 
	mTICK_MARK_CROSS
 = 'cross';

29 
	mHORIZONTAL_CROSSES_AUTOZERO
 = 'autoZero',

30 
	mHORIZONTAL_CROSSES_MAXIMUM
 = 'max';

33 
	mFORMAT_CODE_GENERAL
 = 'General',

34 
	mFORMAT_CODE_NUMBER
 = '#,##0.00',

35 
	mFORMAT_CODE_CURRENCY
 = '$#,##0.00',

36 
	mFORMAT_CODE_ACCOUNTING
 = '_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)',

37 
	mFORMAT_CODE_DATE
 = 'm/d/yyyy',

38 
	mFORMAT_CODE_TIME
 = '[$-F400]h:mm:ss AM/PM',

39 
	mFORMAT_CODE_PERCENTAGE
 = '0.00%',

40 
	mFORMAT_CODE_FRACTION
 = '# ?/?',

41 
	mFORMAT_CODE_SCIENTIFIC
 = '0.00E+00',

42 
	mFORMAT_CODE_TEXT
 = '@',

43 
	mFORMAT_CODE_SPECIAL
 = '00000';

46 
	mORIENTATION_NORMAL
 = 'minMax',

47 
	mORIENTATION_REVERSED
 = 'maxMin';

50 
	mLINE_STYLE_COMPOUND_SIMPLE
 = 'sng',

51 
	mLINE_STYLE_COMPOUND_DOUBLE
 = 'dbl',

52 
	mLINE_STYLE_COMPOUND_THICKTHIN
 = 'thickThin',

53 
	mLINE_STYLE_COMPOUND_THINTHICK
 = 'thinThick',

54 
	mLINE_STYLE_COMPOUND_TRIPLE
 = 'tri',

56 
	mLINE_STYLE_DASH_SOLID
 = 'solid',

57 
	mLINE_STYLE_DASH_ROUND_DOT
 = 'sysDot',

58 
	mLINE_STYLE_DASH_SQUERE_DOT
 = 'sysDash',

59 
	mLINE_STYPE_DASH_DASH
 = 'dash',

60 
	mLINE_STYLE_DASH_DASH_DOT
 = 'dashDot',

61 
	mLINE_STYLE_DASH_LONG_DASH
 = 'lgDash',

62 
	mLINE_STYLE_DASH_LONG_DASH_DOT
 = 'lgDashDot',

63 
	mLINE_STYLE_DASH_LONG_DASH_DOT_DOT
 = 'lgDashDotDot',

65 
	mLINE_STYLE_CAP_SQUARE
 = 'sq',

66 
	mLINE_STYLE_CAP_ROUND
 = 'rnd',

67 
	mLINE_STYLE_CAP_FLAT
 = 'flat',

69 
	mLINE_STYLE_JOIN_ROUND
 = 'bevel',

70 
	mLINE_STYLE_JOIN_MITER
 = 'miter',

71 
	mLINE_STYLE_JOIN_BEVEL
 = 'bevel',

73 
	mLINE_STYLE_ARROW_TYPE_NOARROW
 = 
nuÎ
,

74 
	mLINE_STYLE_ARROW_TYPE_ARROW
 = 'triangle',

75 
	mLINE_STYLE_ARROW_TYPE_OPEN
 = 'arrow',

76 
	mLINE_STYLE_ARROW_TYPE_STEALTH
 = 'stealth',

77 
	mLINE_STYLE_ARROW_TYPE_DIAMOND
 = 'diamond',

78 
	mLINE_STYLE_ARROW_TYPE_OVAL
 = 'oval',

80 
	mLINE_STYLE_ARROW_SIZE_1
 = 1,

81 
	mLINE_STYLE_ARROW_SIZE_2
 = 2,

82 
	mLINE_STYLE_ARROW_SIZE_3
 = 3,

83 
	mLINE_STYLE_ARROW_SIZE_4
 = 4,

84 
	mLINE_STYLE_ARROW_SIZE_5
 = 5,

85 
	mLINE_STYLE_ARROW_SIZE_6
 = 6,

86 
	mLINE_STYLE_ARROW_SIZE_7
 = 7,

87 
	mLINE_STYLE_ARROW_SIZE_8
 = 8,

88 
	mLINE_STYLE_ARROW_SIZE_9
 = 9;

91 
	mSHADOW_PRESETS_NOSHADOW
 = 
nuÎ
,

92 
	mSHADOW_PRESETS_OUTER_BOTTTOM_RIGHT
 = 1,

93 
	mSHADOW_PRESETS_OUTER_BOTTOM
 = 2,

94 
	mSHADOW_PRESETS_OUTER_BOTTOM_LEFT
 = 3,

95 
	mSHADOW_PRESETS_OUTER_RIGHT
 = 4,

96 
	mSHADOW_PRESETS_OUTER_CENTER
 = 5,

97 
	mSHADOW_PRESETS_OUTER_LEFT
 = 6,

98 
	mSHADOW_PRESETS_OUTER_TOP_RIGHT
 = 7,

99 
	mSHADOW_PRESETS_OUTER_TOP
 = 8,

100 
	mSHADOW_PRESETS_OUTER_TOP_LEFT
 = 9,

101 
	mSHADOW_PRESETS_INNER_BOTTTOM_RIGHT
 = 10,

102 
	mSHADOW_PRESETS_INNER_BOTTOM
 = 11,

103 
	mSHADOW_PRESETS_INNER_BOTTOM_LEFT
 = 12,

104 
	mSHADOW_PRESETS_INNER_RIGHT
 = 13,

105 
	mSHADOW_PRESETS_INNER_CENTER
 = 14,

106 
	mSHADOW_PRESETS_INNER_LEFT
 = 15,

107 
	mSHADOW_PRESETS_INNER_TOP_RIGHT
 = 16,

108 
	mSHADOW_PRESETS_INNER_TOP
 = 17,

109 
	mSHADOW_PRESETS_INNER_TOP_LEFT
 = 18,

110 
	mSHADOW_PRESETS_PERSPECTIVE_BELOW
 = 19,

111 
	mSHADOW_PRESETS_PERSPECTIVE_UPPER_RIGHT
 = 20,

112 
	mSHADOW_PRESETS_PERSPECTIVE_UPPER_LEFT
 = 21,

113 
	mSHADOW_PRESETS_PERSPECTIVE_LOWER_RIGHT
 = 22,

114 
	mSHADOW_PRESETS_PERSPECTIVE_LOWER_LEFT
 = 23;

116 
´Ùeùed
 
funùiÚ
 
	$g‘ExûlPoštsWidth
(
$width
)

118  
$width
 * 12700;

121 
´Ùeùed
 
funùiÚ
 
	$g‘ExûlPoštsAngË
(
$ªgË
)

123  
$ªgË
 * 60000;

124 
	}
}

126 
´Ùeùed
 
funùiÚ
 
	$g‘TrueAÍha
(
$®pha
)

128  (
¡ršg
è100 - 
$®pha
 . '000';

129 
	}
}

131 
´Ùeùed
 
funùiÚ
 
	$£tCŞÜPrİ”t›s
(
$cŞÜ
, 
$®pha
, 
$ty³
)

133  
	`¬¿y
(

134 'ty³' => (
¡ršg
è
$ty³
,

135 'v®ue' => (
¡ršg
è
$cŞÜ
,

136 '®pha' => (
¡ršg
è
$this
->
	`g‘TrueAÍha
(
$®pha
)

138 
	}
}

140 
´Ùeùed
 
funùiÚ
 
	$g‘LšeStyËA¼owSize
(
$¬¿y_£ËùÜ
, 
$¬¿y_kay_£ËùÜ
)

142 
$sizes
 = 
	`¬¿y
(

143 1 => 
	`¬¿y
('w' => 'sm', 'len' => 'sm'),

144 2 => 
	`¬¿y
('w' => 'sm', 'len' => 'med'),

145 3 => 
	`¬¿y
('w' => 'sm', 'len' => 'lg'),

146 4 => 
	`¬¿y
('w' => 'med', 'len' => 'sm'),

147 5 => 
	`¬¿y
('w' => 'med', 'len' => 'med'),

148 6 => 
	`¬¿y
('w' => 'med', 'len' => 'lg'),

149 7 => 
	`¬¿y
('w' => 'lg', 'len' => 'sm'),

150 8 => 
	`¬¿y
('w' => 'lg', 'len' => 'med'),

151 9 => 
	`¬¿y
('w' => 'lg', 'len' => 'lg')

154  
$sizes
[
$¬¿y_£ËùÜ
][
$¬¿y_kay_£ËùÜ
];

155 
	}
}

157 
´Ùeùed
 
funùiÚ
 
	$g‘ShadowP»£tsM­
(
$shadow_´e£ts_İtiÚ
)

159 
$´e£ts_İtiÚs
 = 
	`¬¿y
(

161 1 => 
	`¬¿y
(

169 2 => 
	`¬¿y
(

177 3 => 
	`¬¿y
(

185 4 => 
	`¬¿y
(

192 5 => 
	`¬¿y
(

194 'size' => 
	`¬¿y
(

204 6 => 
	`¬¿y
(

212 7 => 
	`¬¿y
(

220 8 => 
	`¬¿y
(

227 9 => 
	`¬¿y
(

236 10 => 
	`¬¿y
(

242 11 => 
	`¬¿y
(

248 12 => 
	`¬¿y
(

254 13 => 
	`¬¿y
(

259 14 => 
	`¬¿y
(

263 15 => 
	`¬¿y
(

269 16 => 
	`¬¿y
(

275 17 => 
	`¬¿y
(

281 18 => 
	`¬¿y
(

288 19 => 
	`¬¿y
(

292 'size' => 
	`¬¿y
(

299 20 => 
	`¬¿y
(

303 'size' => 
	`¬¿y
(

310 21 => 
	`¬¿y
(

314 'size' => 
	`¬¿y
(

321 22 => 
	`¬¿y
(

326 'size' => 
	`¬¿y
(

333 23 => 
	`¬¿y
(

338 'size' => 
	`¬¿y
(

347  
$´e£ts_İtiÚs
[
$shadow_´e£ts_İtiÚ
];

348 
	}
}

350 
´Ùeùed
 
funùiÚ
 
	$g‘A¼ayEËm’tsV®ue
(
$´İ”t›s
, 
$–em’ts
)

352 
$»ã»nû
 = & 
$´İ”t›s
;

353 ià(!
	`is_¬¿y
(
$–em’ts
)) {

354  
$»ã»nû
[
$–em’ts
];

356 
	`fÜ—ch
 (
$–em’ts
 
as
 
$keys
) {

357 
$»ã»nû
 = & $»ã»nû[
$keys
];

359  
$»ã»nû
;

361  
$this
;

362 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Renderer/jpgraph.php

1 <?
php


3 
»quœe_Úû
(
PHPExûl_S‘tšgs
::
g‘Ch¬tR’d””P©h
().'/jpgraph.php');

30 şas 
	cPHPExûl_Ch¬t_R’d””_jpg¿ph


32 
´iv©e
 
	m$width
 = 640;

34 
´iv©e
 
	m$height
 = 480;

36 
´iv©e
 
	m$cŞourS‘
 = 
¬¿y
(

44 
´iv©e
 
	m$m¬kS‘
 = 
¬¿y
(

45 'dŸmÚd' => 
MARK_DIAMOND
,

46 'squ¬e' => 
MARK_SQUARE
,

47 'ŒŸngË' => 
MARK_UTRIANGLE
,

48 'x' => 
MARK_X
,

49 '¡¬' => 
MARK_STAR
,

50 'dÙ' => 
MARK_FILLEDCIRCLE
,

51 'dash' => 
MARK_DTRIANGLE
,

52 'cœşe' => 
MARK_CIRCLE
,

53 '¶us' => 
MARK_CROSS


57 
´iv©e
 
	m$ch¬t
;

59 
´iv©e
 
	m$g¿ph
;

61 
´iv©e
 
	m$¶ÙCŞour
 = 0;

63 
´iv©e
 
	m$¶ÙM¬k
 = 0;

66 
´iv©e
 
funùiÚ
 
	$fÜm©PoštM¬k”
(
$£r›sPlÙ
, 
$m¬k”ID
)

68 
$¶ÙM¬kKeys
 = 
	`¬¿y_keys
(
£lf
::
$m¬kS‘
);

69 ià(
	`is_nuÎ
(
$m¬k”ID
)) {

71 
£lf
::
$¶ÙM¬k
 %ğ
	`couÁ
(£lf::
$m¬kS‘
);

72 
$£r›sPlÙ
->
m¬k
->
	`S‘Ty³
(
£lf
::
$m¬kS‘
[
$¶ÙM¬kKeys
[£lf::
$¶ÙM¬k
++]]);

73 } 
	`–£if
 (
$m¬k”ID
 !== 'none') {

75 ià(
	`is£t
(
£lf
::
$m¬kS‘
[
$m¬k”ID
])) {

76 
$£r›sPlÙ
->
m¬k
->
	`S‘Ty³
(
£lf
::
$m¬kS‘
[
$m¬k”ID
]);

79 
£lf
::
$¶ÙM¬k
 %ğ
	`couÁ
(£lf::
$m¬kS‘
);

80 
$£r›sPlÙ
->
m¬k
->
	`S‘Ty³
(
£lf
::
$m¬kS‘
[
$¶ÙM¬kKeys
[£lf::
$¶ÙM¬k
++]]);

84 
$£r›sPlÙ
->
m¬k
->
	`Hide
();

86 
$£r›sPlÙ
->
m¬k
->
	`S‘CŞÜ
(
£lf
::
$cŞourS‘
[£lf::
$¶ÙCŞour
]);

87 
$£r›sPlÙ
->
m¬k
->
	`S‘FlCŞÜ
(
£lf
::
$cŞourS‘
[£lf::
$¶ÙCŞour
]);

88 
$£r›sPlÙ
->
	`S‘CŞÜ
(
£lf
::
$cŞourS‘
[£lf::
$¶ÙCŞour
++]);

90  
$£r›sPlÙ
;

94 
´iv©e
 
funùiÚ
 
	`fÜm©D©aS‘Lab–s
(
$groupID
, 
$d©a£tLab–s
, 
$Ïb–CouÁ
, 
$rÙ©iÚ
 = '')

96 
$d©a£tLab–FÜm©Code
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙC©egÜyByIndex
(0)->
	`g‘FÜm©Code
();

97 ià(!
	`is_nuÎ
(
$d©a£tLab–FÜm©Code
)) {

99 
$d©a£tLab–FÜm©Code
 = 
	`¡r¦ashes
($datasetLabelFormatCode);

102 
$‹¡Cu¼’tIndex
 = 0;

103 
	`fÜ—ch
 (
$d©a£tLab–s
 
as
 
$i
 => 
$d©a£tLab–
) {

104 ià(
	`is_¬¿y
(
$d©a£tLab–
)) {

105 ià(
$rÙ©iÚ
 == 'bar') {

106 
$d©a£tLab–s
[
$i
] = 
	`im¶ode
(" ", 
$d©a£tLab–
);

108 
$d©a£tLab–
 = 
	`¬¿y_»v”£
($datasetLabel);

109 
$d©a£tLab–s
[
$i
] = 
	`im¶ode
("\n", 
$d©a£tLab–
);

113 ià(!
	`is_nuÎ
(
$d©a£tLab–FÜm©Code
)) {

114 
$d©a£tLab–s
[
$i
] = 
PHPExûl_StyË_Numb”FÜm©
::
	`toFÜm©‹dSŒšg
(
$d©a£tLab–
, 
$d©a£tLab–FÜm©Code
);

117 ++
$‹¡Cu¼’tIndex
;

120  
$d©a£tLab–s
;

121 
	}
}

124 
´iv©e
 
funùiÚ
 
	$³rûÁageSumC®cuÏtiÚ
(
$groupID
, 
$£r›sCouÁ
)

127 
$i
 = 0; $˜< 
$£r›sCouÁ
; ++$i) {

128 ià(
$i
 == 0) {

129 
$sumV®ues
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙV®uesByIndex
(
$i
)->
	`g‘D©aV®ues
();

131 
$ÃxtV®ues
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙV®uesByIndex
(
$i
)->
	`g‘D©aV®ues
();

132 
	`fÜ—ch
 (
$ÃxtV®ues
 
as
 
$k
 => 
$v®ue
) {

133 ià(
	`is£t
(
$sumV®ues
[
$k
])) {

134 
$sumV®ues
[
$k
] +ğ
$v®ue
;

136 
$sumV®ues
[
$k
] = 
$v®ue
;

142  
$sumV®ues
;

143 
	}
}

146 
´iv©e
 
funùiÚ
 
	$³rûÁageAdju¡V®ues
(
$d©aV®ues
, 
$sumV®ues
)

148 
	`fÜ—ch
 (
$d©aV®ues
 
as
 
$k
 => 
$d©aV®ue
) {

149 
$d©aV®ues
[
$k
] = 
$d©aV®ue
 / 
$sumV®ues
[$k] * 100;

152  
$d©aV®ues
;

153 
	}
}

156 
´iv©e
 
funùiÚ
 
	$g‘C­tiÚ
(
$ÿ±iÚEËm’t
)

159 
$ÿ±iÚ
 = (!
	`is_nuÎ
(
$ÿ±iÚEËm’t
)è? $ÿ±iÚEËm’t->
	`g‘C­tiÚ
(è: 
nuÎ
;

161 ià(!
	`is_nuÎ
(
$ÿ±iÚ
)) {

163 ià(
	`is_¬¿y
(
$ÿ±iÚ
)) {

165 
$ÿ±iÚ
 = 
	`im¶ode
('', $caption);

168  
$ÿ±iÚ
;

169 
	}
}

172 
´iv©e
 
funùiÚ
 
	$»nd”T™Ë
()

174 
$t™Ë
 = 
$this
->
	`g‘C­tiÚ
($this->
ch¬t
->
	`g‘T™Ë
());

175 ià(!
	`is_nuÎ
(
$t™Ë
)) {

176 
$this
->
g¿ph
->
t™Ë
->
	`S‘
(
$t™Ë
);

178 
	}
}

181 
´iv©e
 
funùiÚ
 
	$»nd”Leg’d
()

183 
$Ëg’d
 = 
$this
->
ch¬t
->
	`g‘Leg’d
();

184 ià(!
	`is_nuÎ
(
$Ëg’d
)) {

185 
$Ëg’dPos™iÚ
 = 
$Ëg’d
->
	`g‘Pos™iÚ
();

186 
$Ëg’dOv”Ïy
 = 
$Ëg’d
->
	`g‘Ov”Ïy
();

187 
$Ëg’dPos™iÚ
) {

189 
$this
->
g¿ph
->
Ëg’d
->
	`S‘Pos
(0.01, 0.5, 'right', 'center');

190 
$this
->
g¿ph
->
Ëg’d
->
	`S‘CŞumns
(1);

193 
$this
->
g¿ph
->
Ëg’d
->
	`S‘Pos
(0.01, 0.5, 'left', 'center');

194 
$this
->
g¿ph
->
Ëg’d
->
	`S‘CŞumns
(1);

197 
$this
->
g¿ph
->
Ëg’d
->
	`S‘Pos
(0.5, 0.01, 'center', 'top');

200 
$this
->
g¿ph
->
Ëg’d
->
	`S‘Pos
(0.5, 0.99, 'center', 'bottom');

203 
$this
->
g¿ph
->
Ëg’d
->
	`S‘Pos
(0.01, 0.01, 'right', 'top');

204 
$this
->
g¿ph
->
Ëg’d
->
	`S‘CŞumns
(1);

208 
$this
->
g¿ph
->
Ëg’d
->
	`Hide
();

210 
	}
}

213 
´iv©e
 
funùiÚ
 
»nd”C¬‹sŸnPlÙA»a
(
$ty³
 = 'textlin')

215 
$this
->
g¿ph
 = 
Ãw
 
G¿ph
(
£lf
::
$width
, s–f::
$height
);

216 
	g$this
->
	gg¿ph
->
S‘SÿË
(
$ty³
);

218 
	g$this
->
»nd”T™Ë
();

221 
	g$rÙ©iÚ
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(0)->
g‘PlÙDœeùiÚ
();

222 
	g$»v”£
 = (
$rÙ©iÚ
 =ğ'b¬'è? 
Œue
 : 
çl£
;

224 
	g$xAxisLab–
 = 
$this
->
ch¬t
->
g‘XAxisLab–
();

225 ià(!
is_nuÎ
(
$xAxisLab–
)) {

226 
	g$t™Ë
 = 
$this
->
g‘C­tiÚ
(
$xAxisLab–
);

227 ià(!
is_nuÎ
(
$t™Ë
)) {

228 
	g$this
->
	gg¿ph
->
	gxaxis
->
S‘T™Ë
(
$t™Ë
, 'center');

229 
	g$this
->
	gg¿ph
->
	gxaxis
->
	gt™Ë
->
S‘M¬gš
(35);

230 ià(
	g$»v”£
) {

231 
	g$this
->
	gg¿ph
->
	gxaxis
->
	gt™Ë
->
S‘AngË
(90);

232 
	g$this
->
	gg¿ph
->
	gxaxis
->
	gt™Ë
->
S‘M¬gš
(90);

237 
	g$yAxisLab–
 = 
$this
->
ch¬t
->
g‘YAxisLab–
();

238 ià(!
is_nuÎ
(
$yAxisLab–
)) {

239 
	g$t™Ë
 = 
$this
->
g‘C­tiÚ
(
$yAxisLab–
);

240 ià(!
is_nuÎ
(
$t™Ë
)) {

241 
	g$this
->
	gg¿ph
->
	gyaxis
->
S‘T™Ë
(
$t™Ë
, 'center');

242 ià(
	g$»v”£
) {

243 
	g$this
->
	gg¿ph
->
	gyaxis
->
	gt™Ë
->
S‘AngË
(0);

244 
	g$this
->
	gg¿ph
->
	gyaxis
->
	gt™Ë
->
S‘M¬gš
(-55);

251 
´iv©e
 
funùiÚ
 
	$»nd”P›PlÙA»a
(
$doughnut
 = 
çl£
)

253 
$this
->
g¿ph
 = 
Ãw
 
	`P›G¿ph
(
£lf
::
$width
, s–f::
$height
);

255 
$this
->
	`»nd”T™Ë
();

256 
	}
}

259 
´iv©e
 
funùiÚ
 
	$»nd”Rad¬PlÙA»a
()

261 
$this
->
g¿ph
 = 
Ãw
 
	`Rad¬G¿ph
(
£lf
::
$width
, s–f::
$height
);

262 
$this
->
g¿ph
->
	`S‘SÿË
('lin');

264 
$this
->
	`»nd”T™Ë
();

265 
	}
}

268 
´iv©e
 
funùiÚ
 
»nd”PlÙLše
(
$groupID
, 
$fËd
 = 
çl£
, 
$combš©iÚ
 = f®£, 
$dim’siÚs
 = '2d')

270 
$groupšg
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙGroupšg
();

272 
	g$Ïb–CouÁ
 = 
couÁ
(
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙV®uesByIndex
(0)->
g‘PoštCouÁ
());

273 ià(
	g$Ïb–CouÁ
 > 0) {

274 
	g$d©a£tLab–s
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙC©egÜyByIndex
(0)->
g‘D©aV®ues
();

275 
	g$d©a£tLab–s
 = 
$this
->
fÜm©D©aS‘Lab–s
(
$groupID
, 
$d©a£tLab–s
, 
$Ïb–CouÁ
);

276 
	g$this
->
	gg¿ph
->
	gxaxis
->
S‘TickLab–s
(
$d©a£tLab–s
);

279 
	g$£r›sCouÁ
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙS”›sCouÁ
();

280 
	g$£r›sPlÙs
 = 
¬¿y
();

281 ià(
	g$groupšg
 == 'percentStacked') {

282 
$sumV®ues
 = 
$this
->
³rûÁageSumC®cuÏtiÚ
(
$groupID
, 
$£r›sCouÁ
);

286 
	g$i
 = 0; $˜< 
	g$£r›sCouÁ
; ++$i) {

287 
	g$d©aV®ues
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙV®uesByIndex
(
$i
)->
g‘D©aV®ues
();

288 
	g$m¬k”
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙV®uesByIndex
(
$i
)->
g‘PoštM¬k”
();

290 ià(
	g$groupšg
 == 'percentStacked') {

291 
$d©aV®ues
 = 
$this
->
³rûÁageAdju¡V®ues
($d©aV®ues, 
$sumV®ues
);

295 
	g$‹¡Cu¼’tIndex
 = 0;

296 
fÜ—ch
 (
$d©aV®ues
 
as
 
$k
 => 
$d©aV®ue
) {

297 
$k
 !ğ
$‹¡Cu¼’tIndex
) {

298 
$d©aV®ues
[
$‹¡Cu¼’tIndex
] = 
nuÎ
;

299 ++
	g$‹¡Cu¼’tIndex
;

301 ++
	g$‹¡Cu¼’tIndex
;

304 
	g$£r›sPlÙ
 = 
Ãw
 
LšePlÙ
(
$d©aV®ues
);

305 ià(
	g$combš©iÚ
) {

306 
	g$£r›sPlÙ
->
S‘B¬C’‹r
();

309 ià(
	g$fËd
) {

310 
	g$£r›sPlÙ
->
S‘FËd
(
Œue
);

311 
	g$£r›sPlÙ
->
S‘CŞÜ
('black');

312 
	g$£r›sPlÙ
->
S‘FlCŞÜ
(
£lf
::
$cŞourS‘
[£lf::
$¶ÙCŞour
++]);

315 
	g$this
->
fÜm©PoštM¬k”
(
$£r›sPlÙ
, 
$m¬k”
);

317 
	g$d©aLab–
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙLab–ByIndex
(
$i
)->
g‘D©aV®ue
();

318 
	g$£r›sPlÙ
->
S‘Leg’d
(
$d©aLab–
);

320 
	g$£r›sPlÙs
[] = 
$£r›sPlÙ
;

323 ià(
	g$groupšg
 == 'standard') {

324 
$groupPlÙ
 = 
$£r›sPlÙs
;

326 
	g$groupPlÙ
 = 
Ãw
 
AccLšePlÙ
(
$£r›sPlÙs
);

328 
	g$this
->
	gg¿ph
->
Add
(
$groupPlÙ
);

332 
´iv©e
 
funùiÚ
 
»nd”PlÙB¬
(
$groupID
, 
$dim’siÚs
 = '2d')

334 
$rÙ©iÚ
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙDœeùiÚ
();

336 ià((
	g$groupID
 =ğ0è&& (
$rÙ©iÚ
 == 'bar')) {

337 
$this
->
g¿ph
->
S‘90AndM¬gš
();

339 
	g$groupšg
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙGroupšg
();

341 
	g$Ïb–CouÁ
 = 
couÁ
(
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙV®uesByIndex
(0)->
g‘PoštCouÁ
());

342 ià(
	g$Ïb–CouÁ
 > 0) {

343 
	g$d©a£tLab–s
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙC©egÜyByIndex
(0)->
g‘D©aV®ues
();

344 
	g$d©a£tLab–s
 = 
$this
->
fÜm©D©aS‘Lab–s
(
$groupID
, 
$d©a£tLab–s
, 
$Ïb–CouÁ
, 
$rÙ©iÚ
);

346 ià(
	g$rÙ©iÚ
 == 'bar') {

347 
$d©a£tLab–s
 = 
¬¿y_»v”£
($datasetLabels);

348 
	g$this
->
	gg¿ph
->
	gyaxis
->
S‘Pos
('max');

349 
	g$this
->
	gg¿ph
->
	gyaxis
->
S‘Lab–Align
('center', 'top');

350 
	g$this
->
	gg¿ph
->
	gyaxis
->
S‘Lab–Side
(
SIDE_RIGHT
);

352 
	g$this
->
	gg¿ph
->
	gxaxis
->
S‘TickLab–s
(
$d©a£tLab–s
);

356 
	g$£r›sCouÁ
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙS”›sCouÁ
();

357 
	g$£r›sPlÙs
 = 
¬¿y
();

358 ià(
	g$groupšg
 == 'percentStacked') {

359 
$sumV®ues
 = 
$this
->
³rûÁageSumC®cuÏtiÚ
(
$groupID
, 
$£r›sCouÁ
);

363 
	g$j
 = 0; $j < 
	g$£r›sCouÁ
; ++$j) {

364 
	g$d©aV®ues
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙV®uesByIndex
(
$j
)->
g‘D©aV®ues
();

365 ià(
	g$groupšg
 == 'percentStacked') {

366 
$d©aV®ues
 = 
$this
->
³rûÁageAdju¡V®ues
($d©aV®ues, 
$sumV®ues
);

370 
	g$‹¡Cu¼’tIndex
 = 0;

371 
fÜ—ch
 (
$d©aV®ues
 
as
 
$k
 => 
$d©aV®ue
) {

372 
$k
 !ğ
$‹¡Cu¼’tIndex
) {

373 
$d©aV®ues
[
$‹¡Cu¼’tIndex
] = 
nuÎ
;

374 ++
	g$‹¡Cu¼’tIndex
;

376 ++
	g$‹¡Cu¼’tIndex
;

380 ià(
	g$rÙ©iÚ
 == 'bar') {

381 
$d©aV®ues
 = 
¬¿y_»v”£
($dataValues);

383 
	g$£r›sPlÙ
 = 
Ãw
 
B¬PlÙ
(
$d©aV®ues
);

384 
	g$£r›sPlÙ
->
S‘CŞÜ
('black');

385 
	g$£r›sPlÙ
->
S‘FlCŞÜ
(
£lf
::
$cŞourS‘
[£lf::
$¶ÙCŞour
++]);

386 ià(
	g$dim’siÚs
 == '3d') {

387 
$£r›sPlÙ
->
S‘Shadow
();

389 ià(!
	g$this
->
	gch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙLab–ByIndex
(
$j
)) {

390 
	g$d©aLab–
 = '';

392 
	g$d©aLab–
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙLab–ByIndex
(
$j
)->
g‘D©aV®ue
();

394 
	g$£r›sPlÙ
->
S‘Leg’d
(
$d©aLab–
);

396 
	g$£r›sPlÙs
[] = 
$£r›sPlÙ
;

399 ià((
	g$rÙ©iÚ
 =ğ'b¬'è&& (!(
$groupšg
 == 'percentStacked'))) {

400 
$£r›sPlÙs
 = 
¬¿y_»v”£
($seriesPlots);

403 ià(
	g$groupšg
 == 'clustered') {

404 
$groupPlÙ
 = 
Ãw
 
GroupB¬PlÙ
(
$£r›sPlÙs
);

405 } 
–£if
 (
$groupšg
 == 'standard') {

406 
$groupPlÙ
 = 
Ãw
 
GroupB¬PlÙ
(
$£r›sPlÙs
);

408 
	g$groupPlÙ
 = 
Ãw
 
AccB¬PlÙ
(
$£r›sPlÙs
);

409 ià(
	g$dim’siÚs
 == '3d') {

410 
$groupPlÙ
->
S‘Shadow
();

414 
	g$this
->
	gg¿ph
->
Add
(
$groupPlÙ
);

418 
´iv©e
 
funùiÚ
 
	$»nd”PlÙSÿ‰”
(
$groupID
, 
$bubbË
)

420 
$groupšg
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙGroupšg
();

421 
$sÿ‰”StyË
 = 
$bubbËSize
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙStyË
();

423 
$£r›sCouÁ
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙS”›sCouÁ
();

424 
$£r›sPlÙs
 = 
	`¬¿y
();

427 
$i
 = 0; $˜< 
$£r›sCouÁ
; ++$i) {

428 
$d©aV®uesY
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙC©egÜyByIndex
(
$i
)->
	`g‘D©aV®ues
();

429 
$d©aV®uesX
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙV®uesByIndex
(
$i
)->
	`g‘D©aV®ues
();

431 
	`fÜ—ch
 (
$d©aV®uesY
 
as
 
$k
 => 
$d©aV®ueY
) {

432 
$d©aV®uesY
[
$k
] = $k;

435 
$£r›sPlÙ
 = 
Ãw
 
	`Sÿ‰”PlÙ
(
$d©aV®uesX
, 
$d©aV®uesY
);

436 ià(
$sÿ‰”StyË
 == 'lineMarker') {

437 
$£r›sPlÙ
->
	`S‘LškPošts
();

438 
$£r›sPlÙ
->
lšk
->
	`S‘CŞÜ
(
£lf
::
$cŞourS‘
[£lf::
$¶ÙCŞour
]);

439 } 
	`–£if
 (
$sÿ‰”StyË
 == 'smoothMarker') {

440 
$¥lše
 = 
Ãw
 
	`S¶še
(
$d©aV®uesY
, 
$d©aV®uesX
);

441 
	`li¡
(
$¥lšeD©aY
, 
$¥lšeD©aX
èğ
$¥lše
->
	`G‘
(
	`couÁ
(
$d©aV®uesX
è* 
£lf
::
$width
 / 20);

442 
$ÍlÙ
 = 
Ãw
 
	`LšePlÙ
(
$¥lšeD©aX
, 
$¥lšeD©aY
);

443 
$ÍlÙ
->
	`S‘CŞÜ
(
£lf
::
$cŞourS‘
[£lf::
$¶ÙCŞour
]);

445 
$this
->
g¿ph
->
	`Add
(
$ÍlÙ
);

448 ià(
$bubbË
) {

449 
$this
->
	`fÜm©PoštM¬k”
(
$£r›sPlÙ
, 'dot');

450 
$£r›sPlÙ
->
m¬k
->
	`S‘CŞÜ
('black');

451 
$£r›sPlÙ
->
m¬k
->
	`S‘Size
(
$bubbËSize
);

453 
$m¬k”
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙV®uesByIndex
(
$i
)->
	`g‘PoštM¬k”
();

454 
$this
->
	`fÜm©PoštM¬k”
(
$£r›sPlÙ
, 
$m¬k”
);

456 
$d©aLab–
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙLab–ByIndex
(
$i
)->
	`g‘D©aV®ue
();

457 
$£r›sPlÙ
->
	`S‘Leg’d
(
$d©aLab–
);

459 
$this
->
g¿ph
->
	`Add
(
$£r›sPlÙ
);

461 
	}
}

464 
´iv©e
 
funùiÚ
 
	$»nd”PlÙRad¬
(
$groupID
)

466 
$¿d¬StyË
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙStyË
();

468 
$£r›sCouÁ
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙS”›sCouÁ
();

469 
$£r›sPlÙs
 = 
	`¬¿y
();

472 
$i
 = 0; $˜< 
$£r›sCouÁ
; ++$i) {

473 
$d©aV®uesY
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙC©egÜyByIndex
(
$i
)->
	`g‘D©aV®ues
();

474 
$d©aV®uesX
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙV®uesByIndex
(
$i
)->
	`g‘D©aV®ues
();

475 
$m¬k”
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙV®uesByIndex
(
$i
)->
	`g‘PoštM¬k”
();

477 
$d©aV®ues
 = 
	`¬¿y
();

478 
	`fÜ—ch
 (
$d©aV®uesY
 
as
 
$k
 => 
$d©aV®ueY
) {

479 
$d©aV®ues
[
$k
] = 
	`im¶ode
(' ', 
	`¬¿y_»v”£
(
$d©aV®ueY
));

481 
$tmp
 = 
	`¬¿y_shiá
(
$d©aV®ues
);

482 
$d©aV®ues
[] = 
$tmp
;

483 
$tmp
 = 
	`¬¿y_shiá
(
$d©aV®uesX
);

484 
$d©aV®uesX
[] = 
$tmp
;

486 
$this
->
g¿ph
->
	`S‘T™Ës
(
	`¬¿y_»v”£
(
$d©aV®ues
));

488 
$£r›sPlÙ
 = 
Ãw
 
	`Rad¬PlÙ
(
	`¬¿y_»v”£
(
$d©aV®uesX
));

490 
$d©aLab–
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙLab–ByIndex
(
$i
)->
	`g‘D©aV®ue
();

491 
$£r›sPlÙ
->
	`S‘CŞÜ
(
£lf
::
$cŞourS‘
[£lf::
$¶ÙCŞour
++]);

492 ià(
$¿d¬StyË
 == 'filled') {

493 
$£r›sPlÙ
->
	`S‘FlCŞÜ
(
£lf
::
$cŞourS‘
[£lf::
$¶ÙCŞour
]);

495 
$this
->
	`fÜm©PoštM¬k”
(
$£r›sPlÙ
, 
$m¬k”
);

496 
$£r›sPlÙ
->
	`S‘Leg’d
(
$d©aLab–
);

498 
$this
->
g¿ph
->
	`Add
(
$£r›sPlÙ
);

500 
	}
}

503 
´iv©e
 
funùiÚ
 
	$»nd”PlÙCÚtour
(
$groupID
)

505 
$cÚtourStyË
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙStyË
();

507 
$£r›sCouÁ
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙS”›sCouÁ
();

508 
$£r›sPlÙs
 = 
	`¬¿y
();

510 
$d©aV®ues
 = 
	`¬¿y
();

512 
$i
 = 0; $˜< 
$£r›sCouÁ
; ++$i) {

513 
$d©aV®uesY
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙC©egÜyByIndex
(
$i
)->
	`g‘D©aV®ues
();

514 
$d©aV®uesX
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙV®uesByIndex
(
$i
)->
	`g‘D©aV®ues
();

516 
$d©aV®ues
[
$i
] = 
$d©aV®uesX
;

518 
$£r›sPlÙ
 = 
Ãw
 
	`CÚtourPlÙ
(
$d©aV®ues
);

520 
$this
->
g¿ph
->
	`Add
(
$£r›sPlÙ
);

521 
	}
}

524 
´iv©e
 
funùiÚ
 
	$»nd”PlÙStock
(
$groupID
)

526 
$£r›sCouÁ
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙS”›sCouÁ
();

527 
$¶ÙOrd”
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙOrd”
();

529 
$d©aV®ues
 = 
	`¬¿y
();

531 
	`fÜ—ch
 (
$¶ÙOrd”
 
as
 
$i
 => 
$v
) {

532 
$d©aV®uesX
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙV®uesByIndex
(
$v
)->
	`g‘D©aV®ues
();

533 
	`fÜ—ch
 (
$d©aV®uesX
 
as
 
$j
 => 
$d©aV®ueX
) {

534 
$d©aV®ues
[
$¶ÙOrd”
[
$i
]][
$j
] = 
$d©aV®ueX
;

537 ià(
	`em±y
(
$d©aV®ues
)) {

541 
$d©aV®uesPlÙ
 = 
	`¬¿y
();

543 
$j
 = 0; $j < 
	`couÁ
(
$d©aV®ues
[0]); ++$j) {

544 
$i
 = 0; $˜< 
$£r›sCouÁ
; ++$i) {

545 
$d©aV®uesPlÙ
[] = 
$d©aV®ues
[
$i
][
$j
];

550 
$Ïb–CouÁ
 = 
	`couÁ
(
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙV®uesByIndex
(0)->
	`g‘PoštCouÁ
());

551 ià(
$Ïb–CouÁ
 > 0) {

552 
$d©a£tLab–s
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$groupID
)->
	`g‘PlÙC©egÜyByIndex
(0)->
	`g‘D©aV®ues
();

553 
$d©a£tLab–s
 = 
$this
->
	`fÜm©D©aS‘Lab–s
(
$groupID
, $d©a£tLab–s, 
$Ïb–CouÁ
);

554 
$this
->
g¿ph
->
xaxis
->
	`S‘TickLab–s
(
$d©a£tLab–s
);

557 
$£r›sPlÙ
 = 
Ãw
 
	`StockPlÙ
(
$d©aV®uesPlÙ
);

558 
$£r›sPlÙ
->
	`S‘Width
(20);

560 
$this
->
g¿ph
->
	`Add
(
$£r›sPlÙ
);

561 
	}
}

564 
´iv©e
 
funùiÚ
 
»nd”A»aCh¬t
(
$groupCouÁ
, 
$dim’siÚs
 = '2d')

566 
»quœe_Úû
(
PHPExûl_S‘tšgs
::
g‘Ch¬tR’d””P©h
().'jpgraph_line.php');

568 
	g$this
->
»nd”C¬‹sŸnPlÙA»a
();

570 
	g$i
 = 0; $˜< 
	g$groupCouÁ
; ++$i) {

571 
	g$this
->
»nd”PlÙLše
(
$i
, 
Œue
, 
çl£
, 
$dim’siÚs
);

576 
´iv©e
 
funùiÚ
 
»nd”LšeCh¬t
(
$groupCouÁ
, 
$dim’siÚs
 = '2d')

578 
»quœe_Úû
(
PHPExûl_S‘tšgs
::
g‘Ch¬tR’d””P©h
().'jpgraph_line.php');

580 
	g$this
->
»nd”C¬‹sŸnPlÙA»a
();

582 
	g$i
 = 0; $˜< 
	g$groupCouÁ
; ++$i) {

583 
	g$this
->
»nd”PlÙLše
(
$i
, 
çl£
, f®£, 
$dim’siÚs
);

588 
´iv©e
 
funùiÚ
 
»nd”B¬Ch¬t
(
$groupCouÁ
, 
$dim’siÚs
 = '2d')

590 
»quœe_Úû
(
PHPExûl_S‘tšgs
::
g‘Ch¬tR’d””P©h
().'jpgraph_bar.php');

592 
	g$this
->
»nd”C¬‹sŸnPlÙA»a
();

594 
	g$i
 = 0; $˜< 
	g$groupCouÁ
; ++$i) {

595 
	g$this
->
»nd”PlÙB¬
(
$i
, 
$dim’siÚs
);

600 
´iv©e
 
funùiÚ
 
	$»nd”Sÿ‰”Ch¬t
(
$groupCouÁ
)

602 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_scatter.php');

603 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_regstat.php');

604 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_line.php');

606 
$this
->
	`»nd”C¬‹sŸnPlÙA»a
('linlin');

608 
$i
 = 0; $˜< 
$groupCouÁ
; ++$i) {

609 
$this
->
	`»nd”PlÙSÿ‰”
(
$i
, 
çl£
);

611 
	}
}

614 
´iv©e
 
funùiÚ
 
	$»nd”BubbËCh¬t
(
$groupCouÁ
)

616 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_scatter.php');

618 
$this
->
	`»nd”C¬‹sŸnPlÙA»a
('linlin');

620 
$i
 = 0; $˜< 
$groupCouÁ
; ++$i) {

621 
$this
->
	`»nd”PlÙSÿ‰”
(
$i
, 
Œue
);

623 
	}
}

626 
´iv©e
 
funùiÚ
 
»nd”P›Ch¬t
(
$groupCouÁ
, 
$dim’siÚs
 = '2d', 
$doughnut
 = 
çl£
, 
$muÉËPlÙs
 = false)

628 
»quœe_Úû
(
PHPExûl_S‘tšgs
::
g‘Ch¬tR’d””P©h
().'jpgraph_pie.php');

629 ià(
	g$dim’siÚs
 == '3d') {

630 
»quœe_Úû
(
PHPExûl_S‘tšgs
::
g‘Ch¬tR’d””P©h
().'jpgraph_pie3d.php');

633 
	g$this
->
»nd”P›PlÙA»a
(
$doughnut
);

635 
	g$iLim™
 = (
$muÉËPlÙs
è? 
$groupCouÁ
 : 1;

636 
	g$groupID
 = 0; $groupID < 
	g$iLim™
; ++$groupID) {

637 
	g$groupšg
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙGroupšg
();

638 
	g$ex¶oded
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙStyË
();

639 ià(
	g$groupID
 == 0) {

640 
$Ïb–CouÁ
 = 
couÁ
(
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙV®uesByIndex
(0)->
g‘PoštCouÁ
());

641 ià(
	g$Ïb–CouÁ
 > 0) {

642 
	g$d©a£tLab–s
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙC©egÜyByIndex
(0)->
g‘D©aV®ues
();

643 
	g$d©a£tLab–s
 = 
$this
->
fÜm©D©aS‘Lab–s
(
$groupID
, 
$d©a£tLab–s
, 
$Ïb–CouÁ
);

647 
	g$£r›sCouÁ
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙS”›sCouÁ
();

648 
	g$£r›sPlÙs
 = 
¬¿y
();

650 
	g$jLim™
 = (
$muÉËPlÙs
è? 
$£r›sCouÁ
 : 1;

652 
	g$j
 = 0; $j < 
	g$jLim™
; ++$j) {

653 
	g$d©aV®ues
 = 
$this
->
ch¬t
->
g‘PlÙA»a
()->
g‘PlÙGroupByIndex
(
$groupID
)->
g‘PlÙV®uesByIndex
(
$j
)->
g‘D©aV®ues
();

656 
	g$‹¡Cu¼’tIndex
 = 0;

657 
fÜ—ch
 (
$d©aV®ues
 
as
 
$k
 => 
$d©aV®ue
) {

658 
$k
 !ğ
$‹¡Cu¼’tIndex
) {

659 
$d©aV®ues
[
$‹¡Cu¼’tIndex
] = 
nuÎ
;

660 ++
	g$‹¡Cu¼’tIndex
;

662 ++
	g$‹¡Cu¼’tIndex
;

665 ià(
	g$dim’siÚs
 == '3d') {

666 
$£r›sPlÙ
 = 
Ãw
 
P›PlÙ3D
(
$d©aV®ues
);

668 ià(
	g$doughnut
) {

669 
	g$£r›sPlÙ
 = 
Ãw
 
P›PlÙC
(
$d©aV®ues
);

671 
	g$£r›sPlÙ
 = 
Ãw
 
P›PlÙ
(
$d©aV®ues
);

675 ià(
	g$muÉËPlÙs
) {

676 
	g$£r›sPlÙ
->
S‘Size
((
$jLim™
-
$j
) / ($jLimit * 4));

679 ià(
	g$doughnut
) {

680 
	g$£r›sPlÙ
->
S‘MidCŞÜ
('white');

683 
	g$£r›sPlÙ
->
S‘CŞÜ
(
£lf
::
$cŞourS‘
[£lf::
$¶ÙCŞour
++]);

684 ià(
couÁ
(
$d©a£tLab–s
) > 0) {

685 
	g$£r›sPlÙ
->
S‘Lab–s
(
¬¿y_fl
(0, 
couÁ
(
$d©a£tLab–s
), ''));

687 ià(
	g$dim’siÚs
 != '3d') {

688 
$£r›sPlÙ
->
S‘GuideLšes
(
çl£
);

690 ià(
	g$j
 == 0) {

691 ià(
$ex¶oded
) {

692 
$£r›sPlÙ
->
Ex¶odeAÎ
();

694 
	g$£r›sPlÙ
->
S‘Leg’ds
(
$d©a£tLab–s
);

697 
	g$this
->
	gg¿ph
->
Add
(
$£r›sPlÙ
);

703 
´iv©e
 
funùiÚ
 
	$»nd”Rad¬Ch¬t
(
$groupCouÁ
)

705 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_radar.php');

707 
$this
->
	`»nd”Rad¬PlÙA»a
();

709 
$groupID
 = 0; $groupID < 
$groupCouÁ
; ++$groupID) {

710 
$this
->
	`»nd”PlÙRad¬
(
$groupID
);

712 
	}
}

715 
´iv©e
 
funùiÚ
 
	$»nd”StockCh¬t
(
$groupCouÁ
)

717 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_stock.php');

719 
$this
->
	`»nd”C¬‹sŸnPlÙA»a
('intint');

721 
$groupID
 = 0; $groupID < 
$groupCouÁ
; ++$groupID) {

722 
$this
->
	`»nd”PlÙStock
(
$groupID
);

724 
	}
}

727 
´iv©e
 
funùiÚ
 
	$»nd”CÚtourCh¬t
(
$groupCouÁ
, 
$dim’siÚs
)

729 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_contour.php');

731 
$this
->
	`»nd”C¬‹sŸnPlÙA»a
('intint');

733 
$i
 = 0; $˜< 
$groupCouÁ
; ++$i) {

734 
$this
->
	`»nd”PlÙCÚtour
(
$i
);

736 
	}
}

739 
´iv©e
 
funùiÚ
 
	$»nd”Combš©iÚCh¬t
(
$groupCouÁ
, 
$dim’siÚs
, 
$ouutDe¡š©iÚ
)

741 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_line.php');

742 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_bar.php');

743 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_scatter.php');

744 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_regstat.php');

745 
	`»quœe_Úû
(
PHPExûl_S‘tšgs
::
	`g‘Ch¬tR’d””P©h
().'jpgraph_line.php');

747 
$this
->
	`»nd”C¬‹sŸnPlÙA»a
();

749 
$i
 = 0; $˜< 
$groupCouÁ
; ++$i) {

750 
$dim’siÚs
 = 
nuÎ
;

751 
$ch¬tTy³
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$i
)->
	`g‘PlÙTy³
();

752 
$ch¬tTy³
) {

754 
$dim’siÚs
 = '3d';

757 
$this
->
	`»nd”PlÙLše
(
$i
, 
Œue
,rue, 
$dim’siÚs
);

760 
$dim’siÚs
 = '3d';

763 
$this
->
	`»nd”PlÙB¬
(
$i
, 
$dim’siÚs
);

766 
$dim’siÚs
 = '3d';

769 
$this
->
	`»nd”PlÙLše
(
$i
, 
çl£
, 
Œue
, 
$dim’siÚs
);

772 
$this
->
	`»nd”PlÙSÿ‰”
(
$i
, 
çl£
);

775 
$this
->
	`»nd”PlÙSÿ‰”
(
$i
, 
Œue
);

778 
$this
->
g¿ph
 = 
nuÎ
;

779  
çl£
;

783 
$this
->
	`»nd”Leg’d
();

785 
$this
->
g¿ph
->
	`SŒoke
(
$ouutDe¡š©iÚ
);

786  
Œue
;

787 
	}
}

790 
public
 
funùiÚ
 
	$»nd”
(
$ouutDe¡š©iÚ
)

792 
£lf
::
$¶ÙCŞour
 = 0;

794 
$groupCouÁ
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupCouÁ
();

796 
$dim’siÚs
 = 
nuÎ
;

797 ià(
$groupCouÁ
 == 1) {

798 
$ch¬tTy³
 = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(0)->
	`g‘PlÙTy³
();

800 
$ch¬tTy³s
 = 
	`¬¿y
();

801 
$i
 = 0; $˜< 
$groupCouÁ
; ++$i) {

802 
$ch¬tTy³s
[] = 
$this
->
ch¬t
->
	`g‘PlÙA»a
()->
	`g‘PlÙGroupByIndex
(
$i
)->
	`g‘PlÙTy³
();

804 
$ch¬tTy³s
 = 
	`¬¿y_unique
($chartTypes);

805 ià(
	`couÁ
(
$ch¬tTy³s
) == 1) {

806 
$ch¬tTy³
 = 
	`¬¿y_pİ
(
$ch¬tTy³s
);

807 } 
	`–£if
 (
	`couÁ
(
$ch¬tTy³s
) == 0) {

808 
echo
 'Chart is‚ot yet implemented<br />';

809  
çl£
;

811  
$this
->
	`»nd”Combš©iÚCh¬t
(
$groupCouÁ
, 
$dim’siÚs
, 
$ouutDe¡š©iÚ
);

815 
$ch¬tTy³
) {

817 
$dim’siÚs
 = '3d';

820 
$this
->
	`»nd”A»aCh¬t
(
$groupCouÁ
, 
$dim’siÚs
);

823 
$dim’siÚs
 = '3d';

826 
$this
->
	`»nd”B¬Ch¬t
(
$groupCouÁ
, 
$dim’siÚs
);

829 
$dim’siÚs
 = '3d';

832 
$this
->
	`»nd”LšeCh¬t
(
$groupCouÁ
, 
$dim’siÚs
);

835 
$dim’siÚs
 = '3d';

838 
$this
->
	`»nd”P›Ch¬t
(
$groupCouÁ
, 
$dim’siÚs
, 
çl£
, false);

841 
$dim’siÚs
 = '3d';

844 
$this
->
	`»nd”P›Ch¬t
(
$groupCouÁ
, 
$dim’siÚs
, 
Œue
,rue);

847 
$this
->
	`»nd”Sÿ‰”Ch¬t
(
$groupCouÁ
);

850 
$this
->
	`»nd”BubbËCh¬t
(
$groupCouÁ
);

853 
$this
->
	`»nd”Rad¬Ch¬t
(
$groupCouÁ
);

856 
$dim’siÚs
 = '3d';

859 
$this
->
	`»nd”CÚtourCh¬t
(
$groupCouÁ
, 
$dim’siÚs
);

862 
$this
->
	`»nd”StockCh¬t
(
$groupCouÁ
, 
$dim’siÚs
);

865 
echo
 
$ch¬tTy³
.' is‚ot yet implemented<br />';

866  
çl£
;

868 
$this
->
	`»nd”Leg’d
();

870 
$this
->
g¿ph
->
	`SŒoke
(
$ouutDe¡š©iÚ
);

871  
Œue
;

872 
	}
}

878 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_Ch¬t
 
$ch¬t
)

880 
$this
->
g¿ph
 = 
nuÎ
;

881 
$this
->
ch¬t
 = 
$ch¬t
;

882 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Title.php

1 <?
php


28 şas 
	cPHPExûl_Ch¬t_T™Ë


36 
´iv©e
 
	m$ÿ±iÚ
 = 
nuÎ
;

43 
´iv©e
 
	m$Ïyout
 = 
nuÎ
;

48 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$ÿ±iÚ
 = 
nuÎ
, 
PHPExûl_Ch¬t_Layout
 
$Ïyout
 =‚ull)

50 
$this
->
ÿ±iÚ
 = 
$ÿ±iÚ
;

51 
$this
->
Ïyout
 = 
$Ïyout
;

59 
public
 
funùiÚ
 
	$g‘C­tiÚ
()

61  
$this
->
ÿ±iÚ
;

62 
	}
}

70 
public
 
funùiÚ
 
	$£tC­tiÚ
(
$ÿ±iÚ
 = 
nuÎ
)

72 
$this
->
ÿ±iÚ
 = 
$ÿ±iÚ
;

74  
$this
;

75 
	}
}

82 
public
 
funùiÚ
 
	$g‘Layout
()

84  
$this
->
Ïyout
;

85 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Comment.php

1 <?
php


28 şas 
	cPHPExûl_Comm’t
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


35 
´iv©e
 
	m$authÜ
;

42 
´iv©e
 
	m$‹xt
;

49 
´iv©e
 
	m$width
 = '96pt';

56 
´iv©e
 
	m$m¬gšLeá
 = '59.25pt';

63 
´iv©e
 
	m$m¬gšTİ
 = '1.5pt';

70 
´iv©e
 
	m$visibË
 = 
çl£
;

77 
´iv©e
 
	m$height
 = '55.5pt';

84 
´iv©e
 
	m$flCŞÜ
;

91 
´iv©e
 
	m$®ignm’t
;

98 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

101 
$this
->
authÜ
 = 'Author';

102 
$this
->
‹xt
 = 
Ãw
 
	`PHPExûl_RichText
();

103 
$this
->
flCŞÜ
 = 
Ãw
 
	`PHPExûl_StyË_CŞÜ
('FFFFFFE1');

104 
$this
->
®ignm’t
 = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
;

112 
public
 
funùiÚ
 
	$g‘AuthÜ
()

114  
$this
->
authÜ
;

115 
	}
}

123 
public
 
funùiÚ
 
£tAuthÜ
(
$pV®ue
 = '')

125 
$this
->
authÜ
 = 
$pV®ue
;

126  
	g$this
;

134 
public
 
funùiÚ
 
	$g‘Text
()

136  
$this
->
‹xt
;

137 
	}
}

145 
public
 
funùiÚ
 
	$£tText
(
PHPExûl_RichText
 
$pV®ue
)

147 
$this
->
‹xt
 = 
$pV®ue
;

148  
$this
;

149 
	}
}

156 
public
 
funùiÚ
 
	$g‘Width
()

158  
$this
->
width
;

159 
	}
}

167 
public
 
funùiÚ
 
£tWidth
(
$v®ue
 = '96pt')

169 
$this
->
width
 = 
$v®ue
;

170  
	g$this
;

178 
public
 
funùiÚ
 
	$g‘Height
()

180  
$this
->
height
;

181 
	}
}

189 
public
 
funùiÚ
 
£tHeight
(
$v®ue
 = '55.5pt')

191 
$this
->
height
 = 
$v®ue
;

192  
	g$this
;

200 
public
 
funùiÚ
 
	$g‘M¬gšLeá
()

202  
$this
->
m¬gšLeá
;

203 
	}
}

211 
public
 
funùiÚ
 
£tM¬gšLeá
(
$v®ue
 = '59.25pt')

213 
$this
->
m¬gšLeá
 = 
$v®ue
;

214  
	g$this
;

222 
public
 
funùiÚ
 
	$g‘M¬gšTİ
()

224  
$this
->
m¬gšTİ
;

225 
	}
}

233 
public
 
funùiÚ
 
£tM¬gšTİ
(
$v®ue
 = '1.5pt')

235 
$this
->
m¬gšTİ
 = 
$v®ue
;

236  
	g$this
;

244 
public
 
funùiÚ
 
	$g‘VisibË
()

246  
$this
->
visibË
;

247 
	}
}

255 
public
 
funùiÚ
 
	$£tVisibË
(
$v®ue
 = 
çl£
)

257 
$this
->
visibË
 = 
$v®ue
;

258  
$this
;

259 
	}
}

266 
public
 
funùiÚ
 
	$g‘FlCŞÜ
()

268  
$this
->
flCŞÜ
;

269 
	}
}

277 
public
 
funùiÚ
 
	$£tAlignm’t
(
$pV®ue
 = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
)

279 
$this
->
®ignm’t
 = 
$pV®ue
;

280  
$this
;

281 
	}
}

288 
public
 
funùiÚ
 
	$g‘Alignm’t
()

290  
$this
->
®ignm’t
;

291 
	}
}

298 
public
 
funùiÚ
 
	$g‘HashCode
()

300  
	`md5
(

301 
$this
->
authÜ
 .

302 
$this
->
‹xt
->
	`g‘HashCode
() .

303 
$this
->
width
 .

304 
$this
->
height
 .

305 
$this
->
m¬gšLeá
 .

306 
$this
->
m¬gšTİ
 .

307 (
$this
->
visibË
 ? 1 : 0) .

308 
$this
->
flCŞÜ
->
	`g‘HashCode
() .

309 
$this
->
®ignm’t
 .

310 
__CLASS__


312 
	}
}

317 
public
 
funùiÚ
 
	$__şÚe
()

319 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

320 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

321 ià(
	`is_objeù
(
$v®ue
)) {

322 
$this
->
$key
 = 
şÚe
 
$v®ue
;

324 
$this
->
$key
 = 
$v®ue
;

327 
	}
}

334 
public
 
funùiÚ
 
	$__toSŒšg
()

336  
$this
->
‹xt
->
	`g‘PÏšText
();

337 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/DocumentProperties.php

1 <?
php


28 şas 
	cPHPExûl_Docum’tPrİ”t›s


31 cÚ¡ 
	mPROPERTY_TYPE_BOOLEAN
 = 'b';

32 cÚ¡ 
	mPROPERTY_TYPE_INTEGER
 = 'i';

33 cÚ¡ 
	mPROPERTY_TYPE_FLOAT
 = 'f';

34 cÚ¡ 
	mPROPERTY_TYPE_DATE
 = 'd';

35 cÚ¡ 
	mPROPERTY_TYPE_STRING
 = 's';

36 cÚ¡ 
	mPROPERTY_TYPE_UNKNOWN
 = 'u';

43 
´iv©e
 
	m$ü—tÜ
 = 'Unknown Creator';

50 
´iv©e
 
	m$Ï¡Modif›dBy
;

57 
´iv©e
 
	m$ü—‹d
;

64 
´iv©e
 
	m$modif›d
;

71 
´iv©e
 
	m$t™Ë
 = 'Untitled Spreadsheet';

78 
´iv©e
 
	m$desütiÚ
 = '';

85 
´iv©e
 
	m$subjeù
 = '';

92 
´iv©e
 
	m$keywÜds
 = '';

99 
´iv©e
 
	m$ÿ‹gÜy
 = '';

106 
´iv©e
 
	m$mªag”
 = '';

113 
´iv©e
 
	m$com·ny
 = 'Microsoft Corporation';

120 
´iv©e
 
	m$cu¡omPrİ”t›s
 = 
¬¿y
();

126 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

129 
$this
->
Ï¡Modif›dBy
 = $this->
ü—tÜ
;

130 
$this
->
ü—‹d
 = 
	`time
();

131 
$this
->
modif›d
 = 
	`time
();

139 
public
 
funùiÚ
 
	$g‘C»©Ü
()

141  
$this
->
ü—tÜ
;

142 
	}
}

150 
public
 
funùiÚ
 
£tC»©Ü
(
$pV®ue
 = '')

152 
$this
->
ü—tÜ
 = 
$pV®ue
;

153  
	g$this
;

161 
public
 
funùiÚ
 
	$g‘La¡Modif›dBy
()

163  
$this
->
Ï¡Modif›dBy
;

164 
	}
}

172 
public
 
funùiÚ
 
£tLa¡Modif›dBy
(
$pV®ue
 = '')

174 
$this
->
Ï¡Modif›dBy
 = 
$pV®ue
;

175  
	g$this
;

183 
public
 
funùiÚ
 
	$g‘C»©ed
()

185  
$this
->
ü—‹d
;

186 
	}
}

194 
public
 
funùiÚ
 
	$£tC»©ed
(
$pV®ue
 = 
nuÎ
)

196 ià(
$pV®ue
 ==ğ
nuÎ
) {

197 
$pV®ue
 = 
	`time
();

198 } 
	`–£if
 (
	`is_¡ršg
(
$pV®ue
)) {

199 ià(
	`is_num”ic
(
$pV®ue
)) {

200 
$pV®ue
 = 
	`štv®
($pValue);

202 
$pV®ue
 = 
	`¡¹Ùime
($pValue);

206 
$this
->
ü—‹d
 = 
$pV®ue
;

207  
$this
;

208 
	}
}

215 
public
 
funùiÚ
 
	$g‘Modif›d
()

217  
$this
->
modif›d
;

218 
	}
}

226 
public
 
funùiÚ
 
	$£tModif›d
(
$pV®ue
 = 
nuÎ
)

228 ià(
$pV®ue
 ==ğ
nuÎ
) {

229 
$pV®ue
 = 
	`time
();

230 } 
	`–£if
 (
	`is_¡ršg
(
$pV®ue
)) {

231 ià(
	`is_num”ic
(
$pV®ue
)) {

232 
$pV®ue
 = 
	`štv®
($pValue);

234 
$pV®ue
 = 
	`¡¹Ùime
($pValue);

238 
$this
->
modif›d
 = 
$pV®ue
;

239  
$this
;

240 
	}
}

247 
public
 
funùiÚ
 
	$g‘T™Ë
()

249  
$this
->
t™Ë
;

250 
	}
}

258 
public
 
funùiÚ
 
£tT™Ë
(
$pV®ue
 = '')

260 
$this
->
t™Ë
 = 
$pV®ue
;

261  
	g$this
;

269 
public
 
funùiÚ
 
	$g‘DesütiÚ
()

271  
$this
->
desütiÚ
;

272 
	}
}

280 
public
 
funùiÚ
 
£tDesütiÚ
(
$pV®ue
 = '')

282 
$this
->
desütiÚ
 = 
$pV®ue
;

283  
	g$this
;

291 
public
 
funùiÚ
 
	$g‘Subjeù
()

293  
$this
->
subjeù
;

294 
	}
}

302 
public
 
funùiÚ
 
£tSubjeù
(
$pV®ue
 = '')

304 
$this
->
subjeù
 = 
$pV®ue
;

305  
	g$this
;

313 
public
 
funùiÚ
 
	$g‘KeywÜds
()

315  
$this
->
keywÜds
;

316 
	}
}

324 
public
 
funùiÚ
 
£tKeywÜds
(
$pV®ue
 = '')

326 
$this
->
keywÜds
 = 
$pV®ue
;

327  
	g$this
;

335 
public
 
funùiÚ
 
	$g‘C©egÜy
()

337  
$this
->
ÿ‹gÜy
;

338 
	}
}

346 
public
 
funùiÚ
 
£tC©egÜy
(
$pV®ue
 = '')

348 
$this
->
ÿ‹gÜy
 = 
$pV®ue
;

349  
	g$this
;

357 
public
 
funùiÚ
 
	$g‘Com·ny
()

359  
$this
->
com·ny
;

360 
	}
}

368 
public
 
funùiÚ
 
£tCom·ny
(
$pV®ue
 = '')

370 
$this
->
com·ny
 = 
$pV®ue
;

371  
	g$this
;

379 
public
 
funùiÚ
 
	$g‘Mªag”
()

381  
$this
->
mªag”
;

382 
	}
}

390 
public
 
funùiÚ
 
£tMªag”
(
$pV®ue
 = '')

392 
$this
->
mªag”
 = 
$pV®ue
;

393  
	g$this
;

401 
public
 
funùiÚ
 
	$g‘Cu¡omPrİ”t›s
()

403  
	`¬¿y_keys
(
$this
->
cu¡omPrİ”t›s
);

404 
	}
}

412 
public
 
funùiÚ
 
	$isCu¡omPrİ”tyS‘
(
$´İ”tyName
)

414  
	`is£t
(
$this
->
cu¡omPrİ”t›s
[
$´İ”tyName
]);

415 
	}
}

423 
public
 
funùiÚ
 
	$g‘Cu¡omPrİ”tyV®ue
(
$´İ”tyName
)

425 ià(
	`is£t
(
$this
->
cu¡omPrİ”t›s
[
$´İ”tyName
])) {

426  
$this
->
cu¡omPrİ”t›s
[
$´İ”tyName
]['value'];

429 
	}
}

437 
public
 
funùiÚ
 
	$g‘Cu¡omPrİ”tyTy³
(
$´İ”tyName
)

439 ià(
	`is£t
(
$this
->
cu¡omPrİ”t›s
[
$´İ”tyName
])) {

440  
$this
->
cu¡omPrİ”t›s
[
$´İ”tyName
]['type'];

443 
	}
}

458 
public
 
funùiÚ
 
£tCu¡omPrİ”ty
(
$´İ”tyName
, 
$´İ”tyV®ue
 = '', 
$´İ”tyTy³
 = 
nuÎ
)

460 ià((
$´İ”tyTy³
 ==ğ
nuÎ
è|| (!
š_¬¿y
($´İ”tyTy³, 
¬¿y
(
£lf
::
PROPERTY_TYPE_INTEGER
,

461 
£lf
::
PROPERTY_TYPE_FLOAT
,

462 
£lf
::
PROPERTY_TYPE_STRING
,

463 
£lf
::
PROPERTY_TYPE_DATE
,

464 
£lf
::
PROPERTY_TYPE_BOOLEAN
)))) {

465 ià(
$´İ”tyV®ue
 ==ğ
nuÎ
) {

466 
$´İ”tyTy³
 = 
£lf
::
PROPERTY_TYPE_STRING
;

467 } 
–£if
 (
is_æßt
(
$´İ”tyV®ue
)) {

468 
	g$´İ”tyTy³
 = 
£lf
::
PROPERTY_TYPE_FLOAT
;

469 } 
–£if
 (
is_št
(
$´İ”tyV®ue
)) {

470 
	g$´İ”tyTy³
 = 
£lf
::
PROPERTY_TYPE_INTEGER
;

471 } 
–£if
 (
is_boŞ
(
$´İ”tyV®ue
)) {

472 
	g$´İ”tyTy³
 = 
£lf
::
PROPERTY_TYPE_BOOLEAN
;

474 
	g$´İ”tyTy³
 = 
£lf
::
PROPERTY_TYPE_STRING
;

478 
	g$this
->
	gcu¡omPrİ”t›s
[
$´İ”tyName
] = 
¬¿y
(

479 'v®ue' => 
$´İ”tyV®ue
,

480 'ty³' => 
$´İ”tyTy³


482  
	g$this
;

488 
public
 
funùiÚ
 
	$__şÚe
()

490 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

491 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

492 ià(
	`is_objeù
(
$v®ue
)) {

493 
$this
->
$key
 = 
şÚe
 
$v®ue
;

495 
$this
->
$key
 = 
$v®ue
;

498 
	}
}

500 
public
 
funùiÚ
 
	$cÚv”tPrİ”ty
(
$´İ”tyV®ue
, 
$´İ”tyTy³
)

502 
$´İ”tyTy³
) {

507  
nuÎ
;

514  (è
$´İ”tyV®ue
;

521  
	`abs
((è
$´İ”tyV®ue
);

526  (è
$´İ”tyV®ue
;

531  
$´İ”tyV®ue
;

535  
	`¡¹Ùime
(
$´İ”tyV®ue
);

538  (
$´İ”tyV®ue
 =ğ'Œue'è? 
Œue
 : 
çl£
;

553  
$´İ”tyV®ue
;

556  
$´İ”tyV®ue
;

557 
	}
}

559 
public
 
funùiÚ
 
	$cÚv”tPrİ”tyTy³
(
$´İ”tyTy³
)

561 
$´İ”tyTy³
) {

572  
£lf
::
PROPERTY_TYPE_INTEGER
;

577  
£lf
::
PROPERTY_TYPE_FLOAT
;

584  
£lf
::
PROPERTY_TYPE_STRING
;

588  
£lf
::
PROPERTY_TYPE_DATE
;

591  
£lf
::
PROPERTY_TYPE_BOOLEAN
;

606  
£lf
::
PROPERTY_TYPE_UNKNOWN
;

609  
£lf
::
PROPERTY_TYPE_UNKNOWN
;

610 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/DocumentSecurity.php

1 <?
php


28 şas 
	cPHPExûl_Docum’tSecur™y


35 
´iv©e
 
	m$lockRevisiÚ
;

42 
´iv©e
 
	m$lockSŒuùu»
;

49 
´iv©e
 
	m$lockWšdows
;

56 
´iv©e
 
	m$»visiÚsPasswÜd
;

63 
´iv©e
 
	m$wÜkbookPasswÜd
;

68 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

71 
$this
->
lockRevisiÚ
 = 
çl£
;

72 
$this
->
lockSŒuùu»
 = 
çl£
;

73 
$this
->
lockWšdows
 = 
çl£
;

74 
$this
->
»visiÚsPasswÜd
 = '';

75 
$this
->
wÜkbookPasswÜd
 = '';

83 
public
 
funùiÚ
 
	$isSecur™yEÇbËd
()

85  
$this
->
lockRevisiÚ
 ||

86 
$this
->
lockSŒuùu»
 ||

87 
$this
->
lockWšdows
;

88 
	}
}

95 
public
 
funùiÚ
 
	$g‘LockRevisiÚ
()

97  
$this
->
lockRevisiÚ
;

98 
	}
}

106 
public
 
funùiÚ
 
	$£tLockRevisiÚ
(
$pV®ue
 = 
çl£
)

108 
$this
->
lockRevisiÚ
 = 
$pV®ue
;

109  
$this
;

110 
	}
}

117 
public
 
funùiÚ
 
	$g‘LockSŒuùu»
()

119  
$this
->
lockSŒuùu»
;

120 
	}
}

128 
public
 
funùiÚ
 
	$£tLockSŒuùu»
(
$pV®ue
 = 
çl£
)

130 
$this
->
lockSŒuùu»
 = 
$pV®ue
;

131  
$this
;

132 
	}
}

139 
public
 
funùiÚ
 
	$g‘LockWšdows
()

141  
$this
->
lockWšdows
;

142 
	}
}

150 
public
 
funùiÚ
 
	$£tLockWšdows
(
$pV®ue
 = 
çl£
)

152 
$this
->
lockWšdows
 = 
$pV®ue
;

153  
$this
;

154 
	}
}

161 
public
 
funùiÚ
 
	$g‘RevisiÚsPasswÜd
()

163  
$this
->
»visiÚsPasswÜd
;

164 
	}
}

173 
public
 
funùiÚ
 
£tRevisiÚsPasswÜd
(
$pV®ue
 = '', 
$pAÌ—dyHashed
 = 
çl£
)

175 ià(!
$pAÌ—dyHashed
) {

176 
$pV®ue
 = 
PHPExûl_Sh¬ed_PasswÜdHash”
::
hashPasswÜd
($pValue);

178 
	g$this
->
	g»visiÚsPasswÜd
 = 
$pV®ue
;

179  
	g$this
;

187 
public
 
funùiÚ
 
	$g‘WÜkbookPasswÜd
()

189  
$this
->
wÜkbookPasswÜd
;

190 
	}
}

199 
public
 
funùiÚ
 
£tWÜkbookPasswÜd
(
$pV®ue
 = '', 
$pAÌ—dyHashed
 = 
çl£
)

201 ià(!
$pAÌ—dyHashed
) {

202 
$pV®ue
 = 
PHPExûl_Sh¬ed_PasswÜdHash”
::
hashPasswÜd
($pValue);

204 
	g$this
->
	gwÜkbookPasswÜd
 = 
$pV®ue
;

205  
	g$this
;

211 
public
 
funùiÚ
 
	$__şÚe
()

213 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

214 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

215 ià(
	`is_objeù
(
$v®ue
)) {

216 
$this
->
$key
 = 
şÚe
 
$v®ue
;

218 
$this
->
$key
 = 
$v®ue
;

221 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Exception.php

1 <?
php


36 şas 
	cPHPExûl_Exû±iÚ
 
ex‹nds
 
	mExû±iÚ


47 
public
 
funùiÚ
 
	$”rÜHªdËrC®lback
(
$code
, 
$¡ršg
, 
$fe
, 
$lše
, 
$cÚ‹xt
)

49 
$e
 = 
Ãw
 
	`£lf
(
$¡ršg
, 
$code
);

50 
$e
->
lše
 = 
$lše
;

51 
$e
->
fe
 = 
$fe
;

52 
throw
 
$e
;

54 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/HashTable.php

1 <?
php


28 şas 
	cPHPExûl_HashTabË


35 
´Ùeùed
 
	m$™ems
 = 
¬¿y
();

42 
´Ùeùed
 
	m$keyM­
 = 
¬¿y
();

50 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$pSourû
 = 
nuÎ
)

52 ià(
$pSourû
 !=ğ
nuÎ
) {

54 
$this
->
	`addFromSourû
(
$pSourû
);

64 
public
 
funùiÚ
 
	$addFromSourû
(
$pSourû
 = 
nuÎ
)

67 ià(
$pSourû
 =ğ
nuÎ
) {

69 } 
	`–£if
 (!
	`is_¬¿y
(
$pSourû
)) {

70 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid‡rray…arameter…assed.');

73 
	`fÜ—ch
 (
$pSourû
 
as
 
$™em
) {

74 
$this
->
	`add
(
$™em
);

76 
	}
}

84 
public
 
funùiÚ
 
	$add
(
PHPExûl_ICom·¿bË
 
$pSourû
 = 
nuÎ
)

86 
$hash
 = 
$pSourû
->
	`g‘HashCode
();

87 ià(!
	`is£t
(
$this
->
™ems
[
$hash
])) {

88 
$this
->
™ems
[
$hash
] = 
$pSourû
;

89 
$this
->
keyM­
[
	`couÁ
($this->
™ems
è- 1] = 
$hash
;

91 
	}
}

99 
public
 
funùiÚ
 
	$»move
(
PHPExûl_ICom·¿bË
 
$pSourû
 = 
nuÎ
)

101 
$hash
 = 
$pSourû
->
	`g‘HashCode
();

102 ià(
	`is£t
(
$this
->
™ems
[
$hash
])) {

103 
	`un£t
(
$this
->
™ems
[
$hash
]);

105 
$d–‘eKey
 = -1;

106 
	`fÜ—ch
 (
$this
->
keyM­
 
as
 
$key
 => 
$v®ue
) {

107 ià(
$d–‘eKey
 >= 0) {

108 
$this
->
keyM­
[
$key
 - 1] = 
$v®ue
;

111 ià(
$v®ue
 =ğ
$hash
) {

112 
$d–‘eKey
 = 
$key
;

115 
	`un£t
(
$this
->
keyM­
[
	`couÁ
($this->keyMap) - 1]);

117 
	}
}

123 
public
 
funùiÚ
 
	$ş—r
()

125 
$this
->
™ems
 = 
	`¬¿y
();

126 
$this
->
keyM­
 = 
	`¬¿y
();

127 
	}
}

134 
public
 
funùiÚ
 
	$couÁ
()

136  
	`couÁ
(
$this
->
™ems
);

137 
	}
}

145 
public
 
funùiÚ
 
g‘IndexFÜHashCode
(
$pHashCode
 = '')

147  
¬¿y_£¬ch
(
$pHashCode
, 
$this
->
keyM­
);

157 
public
 
funùiÚ
 
	$g‘ByIndex
(
$pIndex
 = 0)

159 ià(
	`is£t
(
$this
->
keyM­
[
$pIndex
])) {

160  
$this
->
	`g‘ByHashCode
($this->
keyM­
[
$pIndex
]);

163  
nuÎ
;

164 
	}
}

173 
public
 
funùiÚ
 
g‘ByHashCode
(
$pHashCode
 = '')

175 ià(
is£t
(
$this
->
™ems
[
$pHashCode
])) {

176  
$this
->
™ems
[
$pHashCode
];

179  
	gnuÎ
;

187 
public
 
funùiÚ
 
	$toA¼ay
()

189  
$this
->
™ems
;

190 
	}
}

195 
public
 
funùiÚ
 
	$__şÚe
()

197 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

198 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

199 ià(
	`is_objeù
(
$v®ue
)) {

200 
$this
->
$key
 = 
şÚe
 
$v®ue
;

203 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Helper/HTML.php

1 <?
php


3 şas 
	cPHPExûl_H–³r_HTML


5 
´Ùeùed
 
	m$cŞourM­
 = 
¬¿y
(

525 
´Ùeùed
 
	m$çû
;

526 
´Ùeùed
 
	m$size
;

527 
´Ùeùed
 
	m$cŞÜ
;

529 
´Ùeùed
 
	m$bŞd
 = 
çl£
;

530 
´Ùeùed
 
	m$™®ic
 = 
çl£
;

531 
´Ùeùed
 
	m$und”lše
 = 
çl£
;

532 
´Ùeùed
 
	m$su³rsüt
 = 
çl£
;

533 
´Ùeùed
 
	m$subsüt
 = 
çl£
;

534 
´Ùeùed
 
	m$¡rik‘hrough
 = 
çl£
;

536 
´Ùeùed
 
	m$¡¬tTagC®lbacks
 = 
¬¿y
(

549 
´Ùeùed
 
	m$’dTagC®lbacks
 = 
¬¿y
(

570 
´Ùeùed
 
	m$¡ack
 = 
¬¿y
();

572 
´Ùeùed
 
	m$¡ršgD©a
 = '';

574 
´Ùeùed
 
	m$richTextObjeù
;

576 
´Ùeùed
 
funùiÚ
 
	$š™Ÿli£
()

578 
$this
->
çû
 = $this->
size
 = $this->
cŞÜ
 = 
nuÎ
;

579 
$this
->
bŞd
 = $this->
™®ic
 = $this->
und”lše
 = $this->
su³rsüt
 = $this->
subsüt
 = $this->
¡rik‘hrough
 = 
çl£
;

581 
$this
->
¡ack
 = 
	`¬¿y
();

583 
$this
->
¡ršgD©a
 = '';

586 
public
 
funùiÚ
 
	$toRichTextObjeù
(
$html
)

588 
$this
->
	`š™Ÿli£
();

591 
$dom
 = 
Ãw
 \
DOMDocum’t
;

594 
$lßded
 = @
$dom
->
	`lßdHTML
(
$html
);

597 
$dom
->
´e£rveWh™eS·û
 = 
çl£
;

599 
$this
->
richTextObjeù
 = 
Ãw
 
	`PHPExûl_RichText
();;

600 
$this
->
	`·r£EËm’ts
(
$dom
);

603 
$this
->
	`ş—nWh™e¥aû
();

605  
$this
->
richTextObjeù
;

606 
	}
}

608 
´Ùeùed
 
funùiÚ
 
	$ş—nWh™e¥aû
()

610 
	`fÜ—ch
 (
$this
->
richTextObjeù
->
	`g‘RichTextEËm’ts
(è
as
 
$key
 => 
$–em’t
) {

611 
$‹xt
 = 
$–em’t
->
	`g‘Text
();

613 ià(
$key
 == 0) {

614 
$‹xt
 = 
	`Érim
($text);

617 
$‹xt
 = 
	`´eg_»¶aû
('/\n */mu', "\n", $text);

618 
$–em’t
->
	`£tText
(
$‹xt
);

620 
	}
}

622 
´Ùeùed
 
funùiÚ
 
	$budTextRun
()

624 
$‹xt
 = 
$this
->
¡ršgD©a
;

625 ià(
	`Œim
(
$‹xt
) === '') {

629 
$rich‹xtRun
 = 
$this
->
richTextObjeù
->
	`ü—‹TextRun
($this->
¡ršgD©a
);

630 ià(
$this
->
çû
) {

631 
$rich‹xtRun
->
	`g‘FÚt
()->
	`£tName
(
$this
->
çû
);

633 ià(
$this
->
size
) {

634 
$rich‹xtRun
->
	`g‘FÚt
()->
	`£tSize
(
$this
->
size
);

636 ià(
$this
->
cŞÜ
) {

637 
$rich‹xtRun
->
	`g‘FÚt
()->
	`£tCŞÜ
(
Ãw
 
	`PHPExûl_StyË_CŞÜ
('ff' . 
$this
->
cŞÜ
));

639 ià(
$this
->
bŞd
) {

640 
$rich‹xtRun
->
	`g‘FÚt
()->
	`£tBŞd
(
Œue
);

642 ià(
$this
->
™®ic
) {

643 
$rich‹xtRun
->
	`g‘FÚt
()->
	`£tIlic
(
Œue
);

645 ià(
$this
->
und”lše
) {

646 
$rich‹xtRun
->
	`g‘FÚt
()->
	`£tUnd”lše
(
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLE
);

648 ià(
$this
->
su³rsüt
) {

649 
$rich‹xtRun
->
	`g‘FÚt
()->
	`£tSu³rSüt
(
Œue
);

651 ià(
$this
->
subsüt
) {

652 
$rich‹xtRun
->
	`g‘FÚt
()->
	`£tSubSüt
(
Œue
);

654 ià(
$this
->
¡rik‘hrough
) {

655 
$rich‹xtRun
->
	`g‘FÚt
()->
	`£tSŒik‘hrough
(
Œue
);

657 
$this
->
¡ršgD©a
 = '';

658 
	}
}

660 
´Ùeùed
 
funùiÚ
 
	$rgbToCŞour
(
$rgb
)

662 
	`´eg_m©ch_®l
('/\d+/', 
$rgb
, 
$v®ues
);

663 
	`fÜ—ch
 (
$v®ues
[0] 
as
 &
$v®ue
) {

664 
$v®ue
 = 
	`¡r_·d
(
	`dechex
($v®ue), 2, '0', 
STR_PAD_LEFT
);

666  
	`im¶ode
(
$v®ues
[0]);

667 
	}
}

669 
´Ùeùed
 
funùiÚ
 
	$cŞourNameLookup
(
$rgb
)

671  
£lf
::
$cŞourM­
[
$rgb
];

672 
	}
}

674 
´Ùeùed
 
funùiÚ
 
	$¡¬tFÚtTag
(
$g
)

676 
	`fÜ—ch
 (
$g
->
©Œibu‹s
 
as
 
$©Œibu‹
) {

677 
$©Œibu‹Name
 = 
	`¡¹Şow”
(
$©Œibu‹
->
Çme
);

678 
$©Œibu‹V®ue
 = 
$©Œibu‹
->
v®ue
;

680 ià(
$©Œibu‹Name
 == 'color') {

681 ià(
	`´eg_m©ch
('/rgb\s*\(/', 
$©Œibu‹V®ue
)) {

682 
$this
->
$©Œibu‹Name
 = $this->
	`rgbToCŞour
(
$©Œibu‹V®ue
);

683 } 
	`–£if
 (
	`¡½os
(
	`Œim
(
$©Œibu‹V®ue
), '#') === 0) {

684 
$this
->
$©Œibu‹Name
 = 
	`Érim
(
$©Œibu‹V®ue
, '#');

686 
$this
->
$©Œibu‹Name
 = $this->
	`cŞourNameLookup
(
$©Œibu‹V®ue
);

689 
$this
->
$©Œibu‹Name
 = 
$©Œibu‹V®ue
;

692 
	}
}

694 
´Ùeùed
 
funùiÚ
 
	$’dFÚtTag
()

696 
$this
->
çû
 = $this->
size
 = $this->
cŞÜ
 = 
nuÎ
;

697 
	}
}

699 
´Ùeùed
 
funùiÚ
 
	$¡¬tBŞdTag
()

701 
$this
->
bŞd
 = 
Œue
;

702 
	}
}

704 
´Ùeùed
 
funùiÚ
 
	$’dBŞdTag
()

706 
$this
->
bŞd
 = 
çl£
;

707 
	}
}

709 
´Ùeùed
 
funùiÚ
 
	$¡¬tIlicTag
()

711 
$this
->
™®ic
 = 
Œue
;

712 
	}
}

714 
´Ùeùed
 
funùiÚ
 
	$’dIlicTag
()

716 
$this
->
™®ic
 = 
çl£
;

717 
	}
}

719 
´Ùeùed
 
funùiÚ
 
	$¡¬tUnd”lšeTag
()

721 
$this
->
und”lše
 = 
Œue
;

722 
	}
}

724 
´Ùeùed
 
funùiÚ
 
	$’dUnd”lšeTag
()

726 
$this
->
und”lše
 = 
çl£
;

727 
	}
}

729 
´Ùeùed
 
funùiÚ
 
	$¡¬tSubsütTag
()

731 
$this
->
subsüt
 = 
Œue
;

732 
	}
}

734 
´Ùeùed
 
funùiÚ
 
	$’dSubsütTag
()

736 
$this
->
subsüt
 = 
çl£
;

737 
	}
}

739 
´Ùeùed
 
funùiÚ
 
	$¡¬tSu³rsütTag
()

741 
$this
->
su³rsüt
 = 
Œue
;

742 
	}
}

744 
´Ùeùed
 
funùiÚ
 
	$’dSu³rsütTag
()

746 
$this
->
su³rsüt
 = 
çl£
;

747 
	}
}

749 
´Ùeùed
 
funùiÚ
 
	$¡¬tSŒik‘hruTag
()

751 
$this
->
¡rik‘hrough
 = 
Œue
;

752 
	}
}

754 
´Ùeùed
 
funùiÚ
 
	$’dSŒik‘hruTag
()

756 
$this
->
¡rik‘hrough
 = 
çl£
;

757 
	}
}

759 
´Ùeùed
 
funùiÚ
 
	$b»akTag
()

761 
$this
->
¡ršgD©a
 .= "\n";

762 
	}
}

764 
´Ùeùed
 
funùiÚ
 
	$·r£TextNode
(
DOMText
 
$‹xtNode
)

766 
$domText
 = 
	`´eg_»¶aû
(

769 
	`¡r_»¶aû
(["\r", "\n"], ' ', 
$‹xtNode
->
nodeV®ue
)

771 
$this
->
¡ršgD©a
 .ğ
$domText
;

772 
$this
->
	`budTextRun
();

773 
	}
}

775 
´Ùeùed
 
funùiÚ
 
	$hªdËC®lback
(
$–em’t
, 
$ÿÎbackTag
, 
$ÿÎbacks
)

777 ià(
	`is£t
(
$ÿÎbacks
[
$ÿÎbackTag
])) {

778 
$–em’tHªdËr
 = 
$ÿÎbacks
[
$ÿÎbackTag
];

779 ià(
	`m‘hod_exi¡s
(
$this
, 
$–em’tHªdËr
)) {

780 
	`ÿÎ_u£r_func
(
	`¬¿y
(
$this
, 
$–em’tHªdËr
), 
$–em’t
);

783 
	}
}

785 
´Ùeùed
 
funùiÚ
 
	$·r£EËm’tNode
(
DOMEËm’t
 
$–em’t
)

787 
$ÿÎbackTag
 = 
	`¡¹Şow”
(
$–em’t
->
nodeName
);

788 
$this
->
¡ack
[] = 
$ÿÎbackTag
;

790 
$this
->
	`hªdËC®lback
(
$–em’t
, 
$ÿÎbackTag
, $this->
¡¬tTagC®lbacks
);

792 
$this
->
	`·r£EËm’ts
(
$–em’t
);

793 
	`¬¿y_pİ
(
$this
->
¡ack
);

795 
$this
->
	`hªdËC®lback
(
$–em’t
, 
$ÿÎbackTag
, $this->
’dTagC®lbacks
);

796 
	}
}

798 
´Ùeùed
 
funùiÚ
 
	$·r£EËm’ts
(
DOMNode
 
$–em’t
)

800 
	`fÜ—ch
 (
$–em’t
->
chdNodes
 
as
 
$chd
) {

801 ià(
$chd
 
š¡ªûof
 
DOMText
) {

802 
$this
->
	`·r£TextNode
(
$chd
);

803 } 
	`–£if
 (
$chd
 
š¡ªûof
 
DOMEËm’t
) {

804 
$this
->
	`·r£EËm’tNode
(
$chd
);

807 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/IComparable.php

1 <?
php


26 
š‹rçû
 
	gPHPExûl_ICom·¿bË


33 
public
 
funùiÚ
 
g‘HashCode
();

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/IOFactory.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_IOFaùÜy


46 
´iv©e
 
	m$£¬chLoÿtiÚs
 = 
¬¿y
(

47 
¬¿y
( 'type' => 'IWriter', 'path' => 'PHPExcel/Writer/{0}.php', 'class' => 'PHPExcel_Writer_{0}' ),

48 
¬¿y
( 'type' => 'IReader', 'path' => 'PHPExcel/Reader/{0}.php', 'class' => 'PHPExcel_Reader_{0}' )

58 
´iv©e
 
	m$autoResŞveCÏs£s
 = 
¬¿y
(

72 
´iv©e
 
funùiÚ
 
	$__cÚ¡ruù
()

83 
public
 
funùiÚ
 
	$g‘S—rchLoÿtiÚs
()

85  
£lf
::
$£¬chLoÿtiÚs
;

86 
	}
}

96 
public
 
funùiÚ
 
	$£tS—rchLoÿtiÚs
(
$v®ue
)

98 ià(
	`is_¬¿y
(
$v®ue
)) {

99 
£lf
::
$£¬chLoÿtiÚs
 = 
$v®ue
;

101 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Invalid…arameter…assed.');

103 
	}
}

114 
public
 
funùiÚ
 
addS—rchLoÿtiÚ
(
$ty³
 = '', 
$loÿtiÚ
 = '', 
$şas¢ame
 = '')

116 
£lf
::
$£¬chLoÿtiÚs
[] = 
¬¿y
Ğ'ty³' => 
$ty³
, '·th' => 
$loÿtiÚ
, 'şass' => 
$şas¢ame
 );

129 
public
 
funùiÚ
 
ü—‹Wr™”
(
PHPExûl
 
$phpExûl
, 
$wr™”Ty³
 = '')

132 
$£¬chTy³
 = 'IWriter';

135 
fÜ—ch
 (
£lf
::
$£¬chLoÿtiÚs
 
as
 
$£¬chLoÿtiÚ
) {

136 ià(
$£¬chLoÿtiÚ
['ty³'] =ğ
$£¬chTy³
) {

137 
$şassName
 = 
¡r_»¶aû
('{0}', 
$wr™”Ty³
, 
$£¬chLoÿtiÚ
['class']);

139 
	g$š¡ªû
 = 
Ãw
 
$şassName
(
$phpExûl
);

140 ià(
	g$š¡ªû
 !=ğ
nuÎ
) {

141  
$š¡ªû
;

147 
throw
 
Ãw
 
PHPExûl_R—d”_Exû±iÚ
("No $searchType found forype $writerType");

159 
public
 
funùiÚ
 
ü—‹R—d”
(
$»ad”Ty³
 = '')

162 
$£¬chTy³
 = 'IReader';

165 
fÜ—ch
 (
£lf
::
$£¬chLoÿtiÚs
 
as
 
$£¬chLoÿtiÚ
) {

166 ià(
$£¬chLoÿtiÚ
['ty³'] =ğ
$£¬chTy³
) {

167 
$şassName
 = 
¡r_»¶aû
('{0}', 
$»ad”Ty³
, 
$£¬chLoÿtiÚ
['class']);

169 
	g$š¡ªû
 = 
Ãw
 
$şassName
();

170 ià(
	g$š¡ªû
 !=ğ
nuÎ
) {

171  
$š¡ªû
;

177 
throw
 
Ãw
 
PHPExûl_R—d”_Exû±iÚ
("No $searchType found forype $readerType");

189 
public
 
funùiÚ
 
	$lßd
(
$pF’ame
)

191 
$»ad”
 = 
£lf
::
	`ü—‹R—d”FÜFe
(
$pF’ame
);

192  
$»ad”
->
	`lßd
(
$pF’ame
);

193 
	}
}

204 
public
 
funùiÚ
 
	$id’tify
(
$pF’ame
)

206 
$»ad”
 = 
£lf
::
	`ü—‹R—d”FÜFe
(
$pF’ame
);

207 
$şassName
 = 
	`g‘_şass
(
$»ad”
);

208 
$şassTy³
 = 
	`ex¶ode
('_', 
$şassName
);

209 
	`un£t
(
$»ad”
);

210  
	`¬¿y_pİ
(
$şassTy³
);

211 
	}
}

222 
public
 
funùiÚ
 
	$ü—‹R—d”FÜFe
(
$pF’ame
)

225 
$·thšfo
 = 
	`·thšfo
(
$pF’ame
);

227 
$ex‹nsiÚTy³
 = 
nuÎ
;

228 ià(
	`is£t
(
$·thšfo
['extension'])) {

229 
	`¡¹Şow”
(
$·thšfo
['extension'])) {

234 
$ex‹nsiÚTy³
 = 'Excel2007';

238 
$ex‹nsiÚTy³
 = 'Excel5';

242 
$ex‹nsiÚTy³
 = 'OOCalc';

245 
$ex‹nsiÚTy³
 = 'SYLK';

248 
$ex‹nsiÚTy³
 = 'Excel2003XML';

251 
$ex‹nsiÚTy³
 = 'Gnumeric';

255 
$ex‹nsiÚTy³
 = 'HTML';

266 ià(
$ex‹nsiÚTy³
 !=ğ
nuÎ
) {

267 
$»ad”
 = 
£lf
::
	`ü—‹R—d”
(
$ex‹nsiÚTy³
);

269 ià(
	`is£t
(
$»ad”
è&& $»ad”->
	`ÿnR—d
(
$pF’ame
)) {

270  
$»ad”
;

277 
	`fÜ—ch
 (
£lf
::
$autoResŞveCÏs£s
 
as
 
$autoResŞveCÏss
) {

279 ià(
$autoResŞveCÏss
 !=ğ
$ex‹nsiÚTy³
) {

280 
$»ad”
 = 
£lf
::
	`ü—‹R—d”
(
$autoResŞveCÏss
);

281 ià(
$»ad”
->
	`ÿnR—d
(
$pF’ame
)) {

282  
$»ad”
;

287 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Unableo identify‡„eader forhis file');

288 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/NamedRange.php

1 <?
php


28 şas 
	cPHPExûl_NamedRªge


35 
´iv©e
 
	m$Çme
;

42 
´iv©e
 
	m$wÜksh“t
;

49 
´iv©e
 
	m$¿nge
;

56 
´iv©e
 
	m$loÿlOÆy
;

63 
´iv©e
 
	m$scİe
;

75 
public
 
funùiÚ
 
__cÚ¡ruù
(
$pName
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pWÜksh“t
, 
$pRªge
 = 'A1', 
$pLoÿlOÆy
 = 
çl£
, 
$pScİe
 =‚ull)

78 ià((
$pName
 ==ğ
nuÎ
è|| (
$pWÜksh“t
 ==ğnuÎè|| (
$pRªge
 ===‚ull)) {

79 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Parameters can‚ot be‚ull.');

83 
	m$this
->
	mÇme
 = 
$pName
;

84 
	m$this
->
	mwÜksh“t
 = 
$pWÜksh“t
;

85 
	m$this
->
	m¿nge
 = 
$pRªge
;

86 
	m$this
->
	mloÿlOÆy
 = 
$pLoÿlOÆy
;

87 
	m$this
->
	mscİe
 = (
$pLoÿlOÆy
 =ğ
Œue
è? ((
$pScİe
 =ğ
nuÎ
è? 
$pWÜksh“t
 : $pScope) :‚ull;

95 
public
 
funùiÚ
 
	$g‘Name
()

97  
$this
->
Çme
;

98 
	}
}

106 
public
 
funùiÚ
 
	$£tName
(
$v®ue
 = 
nuÎ
)

108 ià(
$v®ue
 !=ğ
nuÎ
) {

110 
$ŞdT™Ë
 = 
$this
->
Çme
;

113 ià(
$this
->
wÜksh“t
 !=ğ
nuÎ
) {

114 
$this
->
wÜksh“t
->
	`g‘P¬’t
()->
	`»moveNamedRªge
($this->
Çme
, $this->worksheet);

116 
$this
->
Çme
 = 
$v®ue
;

118 ià(
$this
->
wÜksh“t
 !=ğ
nuÎ
) {

119 
$this
->
wÜksh“t
->
	`g‘P¬’t
()->
	`addNamedRªge
($this);

123 
$ÃwT™Ë
 = 
$this
->
Çme
;

124 
PHPExûl_Reã»nûH–³r
::
	`g‘In¡ªû
()->
	`upd©eNamedFÜmuÏs
(
$this
->
wÜksh“t
->
	`g‘P¬’t
(), 
$ŞdT™Ë
, 
$ÃwT™Ë
);

126  
$this
;

127 
	}
}

134 
public
 
funùiÚ
 
	$g‘WÜksh“t
()

136  
$this
->
wÜksh“t
;

137 
	}
}

145 
public
 
funùiÚ
 
	$£tWÜksh“t
(
PHPExûl_WÜksh“t
 
$v®ue
 = 
nuÎ
)

147 ià(
$v®ue
 !=ğ
nuÎ
) {

148 
$this
->
wÜksh“t
 = 
$v®ue
;

150  
$this
;

151 
	}
}

158 
public
 
funùiÚ
 
	$g‘Rªge
()

160  
$this
->
¿nge
;

161 
	}
}

169 
public
 
funùiÚ
 
	$£tRªge
(
$v®ue
 = 
nuÎ
)

171 ià(
$v®ue
 !=ğ
nuÎ
) {

172 
$this
->
¿nge
 = 
$v®ue
;

174  
$this
;

175 
	}
}

182 
public
 
funùiÚ
 
	$g‘LoÿlOÆy
()

184  
$this
->
loÿlOÆy
;

185 
	}
}

193 
public
 
funùiÚ
 
	$£tLoÿlOÆy
(
$v®ue
 = 
çl£
)

195 
$this
->
loÿlOÆy
 = 
$v®ue
;

196 
$this
->
scİe
 = 
$v®ue
 ? $this->
wÜksh“t
 : 
nuÎ
;

197  
$this
;

198 
	}
}

205 
public
 
funùiÚ
 
	$g‘Scİe
()

207  
$this
->
scİe
;

208 
	}
}

216 
public
 
funùiÚ
 
	$£tScİe
(
PHPExûl_WÜksh“t
 
$v®ue
 = 
nuÎ
)

218 
$this
->
scİe
 = 
$v®ue
;

219 
$this
->
loÿlOÆy
 = (
$v®ue
 =ğ
nuÎ
è? 
çl£
 : 
Œue
;

220  
$this
;

221 
	}
}

230 
public
 
funùiÚ
 
»sŞveRªge
(
$pNamedRªge
 = '', 
PHPExûl_WÜksh“t
 
$pSh“t
)

232  
	g$pSh“t
->
g‘P¬’t
()->
g‘NamedRªge
(
$pNamedRªge
, 
$pSh“t
);

238 
public
 
funùiÚ
 
	$__şÚe
()

240 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

241 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

242 ià(
	`is_objeù
(
$v®ue
)) {

243 
$this
->
$key
 = 
şÚe
 
$v®ue
;

245 
$this
->
$key
 = 
$v®ue
;

248 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Abstract.php

1 <?
php


28 
ab¡¿ù
 cÏs 
	cPHPExûl_R—d”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_R—d”_IR—d”


37 
´Ùeùed
 
	m$»adD©aOÆy
 = 
çl£
;

45 
´Ùeùed
 
	m$šşudeCh¬ts
 = 
çl£
;

53 
´Ùeùed
 
	m$lßdSh“tsOÆy
;

60 
´Ùeùed
 
	m$»adF‹r
;

62 
´Ùeùed
 
	m$feHªdË
 = 
nuÎ
;

72 
public
 
funùiÚ
 
	$g‘R—dD©aOÆy
()

74  
$this
->
»adD©aOÆy
;

86 
public
 
funùiÚ
 
	$£tR—dD©aOÆy
(
$pV®ue
 = 
çl£
)

88 
$this
->
»adD©aOÆy
 = 
$pV®ue
;

89  
$this
;

90 
	}
}

100 
public
 
funùiÚ
 
	$g‘InşudeCh¬ts
()

102  
$this
->
šşudeCh¬ts
;

103 
	}
}

115 
public
 
funùiÚ
 
	$£tInşudeCh¬ts
(
$pV®ue
 = 
çl£
)

117 
$this
->
šşudeCh¬ts
 = (
boŞ—n
è
$pV®ue
;

118  
$this
;

119 
	}
}

128 
public
 
funùiÚ
 
	$g‘LßdSh“tsOÆy
()

130  
$this
->
lßdSh“tsOÆy
;

131 
	}
}

142 
public
 
funùiÚ
 
	$£tLßdSh“tsOÆy
(
$v®ue
 = 
nuÎ
)

144 ià(
$v®ue
 ==ğ
nuÎ
) {

145  
$this
->
	`£tLßdAÎSh“ts
();

148 
$this
->
lßdSh“tsOÆy
 = 
	`is_¬¿y
(
$v®ue
è? $v®u: 
	`¬¿y
($value);

149  
$this
;

150 
	}
}

158 
public
 
funùiÚ
 
	$£tLßdAÎSh“ts
()

160 
$this
->
lßdSh“tsOÆy
 = 
nuÎ
;

161  
$this
;

162 
	}
}

169 
public
 
funùiÚ
 
	$g‘R—dF‹r
()

171  
$this
->
»adF‹r
;

172 
	}
}

180 
public
 
funùiÚ
 
	$£tR—dF‹r
(
PHPExûl_R—d”_IR—dF‹r
 
$pV®ue
)

182 
$this
->
»adF‹r
 = 
$pV®ue
;

183  
$this
;

184 
	}
}

193 
´Ùeùed
 
funùiÚ
 
	$İ’Fe
(
$pF’ame
)

196 ià(!
	`fe_exi¡s
(
$pF’ame
è|| !
	`is_»adabË
($pFilename)) {

197 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

201 
$this
->
feHªdË
 = 
	`fİ’
(
$pF’ame
, 'r');

202 ià(
$this
->
feHªdË
 ==ğ
çl£
) {

203 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³Àf" . 
$pF’ame
 . " for„eading.");

205 
	}
}

214 
public
 
funùiÚ
 
	$ÿnR—d
(
$pF’ame
)

217 
Œy
 {

218 
$this
->
	`İ’Fe
(
$pF’ame
);

219 } 
	`ÿtch
 (
Exû±iÚ
 
$e
) {

220  
çl£
;

223 
$»adabË
 = 
$this
->
	`isV®idFÜm©
();

224 
	`fşo£
(
$this
->
feHªdË
);

225  
$»adabË
;

226 
	}
}

234 
public
 
funùiÚ
 
	$£cur™ySÿn
(
$xml
)

236 
$·‰”n
 = '/\\0?' . 
	`im¶ode
('\\0?', 
	`¡r_¥l™
('<!DOCTYPE')) . '\\0?/';

237 ià(
	`´eg_m©ch
(
$·‰”n
, 
$xml
)) {

238 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Detected use of ENTITY in XML, spreadsheet file†oad()‡bortedo…revent XXE/XEE‡ttacks');

240  
$xml
;

241 
	}
}

249 
public
 
funùiÚ
 
	$£cur™ySÿnFe
(
$fe¡»am
)

251  
$this
->
	`£cur™ySÿn
(
	`fe_g‘_cÚ‹Ás
(
$fe¡»am
));

252 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/CSV.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_R—d”_CSV
 
ex‹nds
 
PHPExûl_R—d”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_R—d”_IR—d”


45 
´iv©e
 
	m$šputEncodšg
 = 'UTF-8';

53 
´iv©e
 
	m$d–im™”
 = ',';

61 
´iv©e
 
	m$’şosu»
 = '"';

69 
´iv©e
 
	m$sh“tIndex
 = 0;

77 
´iv©e
 
	m$cÚtiguous
 = 
çl£
;

84 
´iv©e
 
	m$cÚtiguousRow
 = -1;

90 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

92 
$this
->
»adF‹r
 = 
Ãw
 
	`PHPExûl_R—d”_DeçuÉR—dF‹r
();

100 
´Ùeùed
 
funùiÚ
 
	$isV®idFÜm©
()

102  
Œue
;

103 
	}
}

110 
public
 
funùiÚ
 
£tIÅutEncodšg
(
$pV®ue
 = 'UTF-8')

112 
$this
->
šputEncodšg
 = 
$pV®ue
;

113  
	g$this
;

121 
public
 
funùiÚ
 
	$g‘IÅutEncodšg
()

123  
$this
->
šputEncodšg
;

124 
	}
}

130 
´Ùeùed
 
funùiÚ
 
	$skBOM
()

132 
	`»wšd
(
$this
->
feHªdË
);

134 
$this
->
šputEncodšg
) {

136 
	`fg‘s
(
$this
->
feHªdË
, 4) == "\xEF\xBB\xBF" ?

137 
	`f£ek
(
$this
->
feHªdË
, 3) : fseek($this->fileHandle, 0);

140 
	`fg‘s
(
$this
->
feHªdË
, 3) == "\xFF\xFE" ?

141 
	`f£ek
(
$this
->
feHªdË
, 2) : fseek($this->fileHandle, 0);

144 
	`fg‘s
(
$this
->
feHªdË
, 3) == "\xFE\xFF" ?

145 
	`f£ek
(
$this
->
feHªdË
, 2) : fseek($this->fileHandle, 0);

148 
	`fg‘s
(
$this
->
feHªdË
, 5) == "\xFF\xFE\x00\x00" ?

149 
	`f£ek
(
$this
->
feHªdË
, 4) : fseek($this->fileHandle, 0);

152 
	`fg‘s
(
$this
->
feHªdË
, 5) == "\x00\x00\xFE\xFF" ?

153 
	`f£ek
(
$this
->
feHªdË
, 4) : fseek($this->fileHandle, 0);

158 
	}
}

166 
public
 
funùiÚ
 
	$li¡WÜksh“tInfo
(
$pF’ame
)

169 
$this
->
	`İ’Fe
(
$pF’ame
);

170 ià(!
$this
->
	`isV®idFÜm©
()) {

171 
	`fşo£
(
$this
->
feHªdË
);

172 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
(
$pF’ame
 . " is‡n Invalid Spreadsheet file.");

174 
$feHªdË
 = 
$this
->
feHªdË
;

177 
$this
->
	`skBOM
();

179 
$esÿ³Enşosu»s
 = 
	`¬¿y
Ğ"\\" . 
$this
->
’şosu»
, $this->enclosure . $this->enclosure );

181 
$wÜksh“tInfo
 = 
	`¬¿y
();

182 
$wÜksh“tInfo
[0]['worksheetName'] = 'Worksheet';

183 
$wÜksh“tInfo
[0]['lastColumnLetter'] = 'A';

184 
$wÜksh“tInfo
[0]['lastColumnIndex'] = 0;

185 
$wÜksh“tInfo
[0]['totalRows'] = 0;

186 
$wÜksh“tInfo
[0]['totalColumns'] = 0;

189 (
$rowD©a
 = 
	`fg‘csv
(
$feHªdË
, 0, 
$this
->
d–im™”
, $this->
’şosu»
)è!=ğ
çl£
) {

190 
$wÜksh“tInfo
[0]['totalRows']++;

191 
$wÜksh“tInfo
[0]['Ï¡CŞumnIndex'] = 
	`max
($wÜksh“tInfo[0]['Ï¡CŞumnIndex'], 
	`couÁ
(
$rowD©a
) - 1);

194 
$wÜksh“tInfo
[0]['Ï¡CŞumnL‘‹r'] = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($worksheetInfo[0]['lastColumnIndex']);

195 
$wÜksh“tInfo
[0]['totalColumns'] = $worksheetInfo[0]['lastColumnIndex'] + 1;

198 
	`fşo£
(
$feHªdË
);

200  
$wÜksh“tInfo
;

201 
	}
}

210 
public
 
funùiÚ
 
	$lßd
(
$pF’ame
)

213 
$objPHPExûl
 = 
Ãw
 
	`PHPExûl
();

216  
$this
->
	`lßdIÁoExi¡šg
(
$pF’ame
, 
$objPHPExûl
);

217 
	}
}

227 
public
 
funùiÚ
 
	$lßdIÁoExi¡šg
(
$pF’ame
, 
PHPExûl
 
$objPHPExûl
)

229 
$lšeEndšg
 = 
	`ši_g‘
('auto_detect_line_endings');

230 
	`ši_£t
('auto_d‘eù_lše_’dšgs', 
Œue
);

233 
$this
->
	`İ’Fe
(
$pF’ame
);

234 ià(!
$this
->
	`isV®idFÜm©
()) {

235 
	`fşo£
(
$this
->
feHªdË
);

236 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
(
$pF’ame
 . " is‡n Invalid Spreadsheet file.");

238 
$feHªdË
 = 
$this
->
feHªdË
;

241 
$this
->
	`skBOM
();

244 
$objPHPExûl
->
	`g‘Sh“tCouÁ
(è<ğ
$this
->
sh“tIndex
) {

245 
$objPHPExûl
->
	`ü—‹Sh“t
();

247 
$sh“t
 = 
$objPHPExûl
->
	`£tAùiveSh“tIndex
(
$this
->
sh“tIndex
);

249 
$esÿ³Enşosu»s
 = 
	`¬¿y
Ğ"\\" . 
$this
->
’şosu»
,

250 
$this
->
’şosu»
 . $this->enclosure

254 
$cu¼’tRow
 = 1;

255 ià(
$this
->
cÚtiguous
) {

256 
$cu¼’tRow
 = (
$this
->
cÚtiguousRow
 =ğ-1è? 
$sh“t
->
	`g‘Highe¡Row
(): $this->contiguousRow;

260 (
$rowD©a
 = 
	`fg‘csv
(
$feHªdË
, 0, 
$this
->
d–im™”
, $this->
’şosu»
)è!=ğ
çl£
) {

261 
$cŞumnL‘‹r
 = 'A';

262 
	`fÜ—ch
 (
$rowD©a
 
as
 
$rowD©um
) {

263 ià(
$rowD©um
 !ğ'' && 
$this
->
»adF‹r
->
	`»adC–l
(
$cŞumnL‘‹r
, 
$cu¼’tRow
)) {

265 
$rowD©um
 = 
	`¡r_»¶aû
(
$esÿ³Enşosu»s
, 
$this
->
’şosu»
, $rowDatum);

268 ià(
$this
->
šputEncodšg
 !== 'UTF-8') {

269 
$rowD©um
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`CÚv”tEncodšg
($rowD©um, 'UTF-8', 
$this
->
šputEncodšg
);

273 
$sh“t
->
	`g‘C–l
(
$cŞumnL‘‹r
 . 
$cu¼’tRow
)->
	`£tV®ue
(
$rowD©um
);

275 ++
$cŞumnL‘‹r
;

277 ++
$cu¼’tRow
;

281 
	`fşo£
(
$feHªdË
);

283 ià(
$this
->
cÚtiguous
) {

284 
$this
->
cÚtiguousRow
 = 
$cu¼’tRow
;

287 
	`ši_£t
('auto_d‘eù_lše_’dšgs', 
$lšeEndšg
);

290  
$objPHPExûl
;

291 
	}
}

298 
public
 
funùiÚ
 
	$g‘D–im™”
()

300  
$this
->
d–im™”
;

301 
	}
}

309 
public
 
funùiÚ
 
£tD–im™”
(
$pV®ue
 = ',')

311 
$this
->
d–im™”
 = 
$pV®ue
;

312  
	g$this
;

320 
public
 
funùiÚ
 
	$g‘Enşosu»
()

322  
$this
->
’şosu»
;

323 
	}
}

331 
public
 
funùiÚ
 
£tEnşosu»
(
$pV®ue
 = '"')

333 ià(
$pV®ue
 == '') {

334 
$pV®ue
 = '"';

336 
	g$this
->
	g’şosu»
 = 
$pV®ue
;

337  
	g$this
;

345 
public
 
funùiÚ
 
	$g‘Sh“tIndex
()

347  
$this
->
sh“tIndex
;

348 
	}
}

356 
public
 
funùiÚ
 
	$£tSh“tIndex
(
$pV®ue
 = 0)

358 
$this
->
sh“tIndex
 = 
$pV®ue
;

359  
$this
;

360 
	}
}

367 
public
 
funùiÚ
 
	$£tCÚtiguous
(
$cÚtiguous
 = 
çl£
)

369 
$this
->
cÚtiguous
 = (
boŞ
è
$cÚtiguous
;

370 ià(!
$cÚtiguous
) {

371 
$this
->
cÚtiguousRow
 = -1;

374  
$this
;

375 
	}
}

382 
public
 
funùiÚ
 
	$g‘CÚtiguous
()

384  
$this
->
cÚtiguous
;

385 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/DefaultReadFilter.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_R—d”_DeçuÉR—dF‹r
 
im¶em’ts
 
	mPHPExûl_R—d”_IR—dF‹r


47 
public
 
funùiÚ
 
»adC–l
(
$cŞumn
, 
$row
, 
$wÜksh“tName
 = '')

49  
Œue
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel2003XML.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_R—d”_Exûl2003XML
 
ex‹nds
 
PHPExûl_R—d”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_R—d”_IR—d”


44 
´Ùeùed
 
	m$¡yËs
 = 
¬¿y
();

51 
´Ùeùed
 
	m$ch¬S‘
 = 'UTF-8';

56 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

58 
$this
->
»adF‹r
 = 
Ãw
 
	`PHPExûl_R—d”_DeçuÉR—dF‹r
();

69 
public
 
funùiÚ
 
	$ÿnR—d
(
$pF’ame
)

82 
$sigÇtu»
 = 
	`¬¿y
(

88 
$this
->
	`İ’Fe
(
$pF’ame
);

89 
$feHªdË
 = 
$this
->
feHªdË
;

92 
$d©a
 = 
	`ä—d
(
$feHªdË
, 2048);

93 
	`fşo£
(
$feHªdË
);

95 
$v®id
 = 
Œue
;

96 
	`fÜ—ch
 (
$sigÇtu»
 
as
 
$m©ch
) {

98 ià(
	`¡½os
(
$d©a
, 
$m©ch
è==ğ
çl£
) {

99 
$v®id
 = 
çl£
;

105 ià(
	`´eg_m©ch
('/<?xml.*’codšg=[\'"](.*?)[\'"].*?>/um', 
$d©a
, 
$m©ches
)) {

106 
$this
->
ch¬S‘
 = 
	`¡¹ouµ”
(
$m©ches
[1]);

110  
$v®id
;

111 
	}
}

120 
public
 
funùiÚ
 
	$li¡WÜksh“tNames
(
$pF’ame
)

123 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

124 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

126 ià(!
$this
->
	`ÿnR—d
(
$pF’ame
)) {

127 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
(
$pF’ame
 . " is‡n Invalid Spreadsheet file.");

130 
$wÜksh“tNames
 = 
	`¬¿y
();

132 
$xml
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
(
	`fe_g‘_cÚ‹Ás
(
$pF’ame
)), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

133 
$Çme¥aûs
 = 
$xml
->
	`g‘Name¥aûs
(
Œue
);

135 
$xml_ss
 = 
$xml
->
	`chd»n
(
$Çme¥aûs
['ss']);

136 
	`fÜ—ch
 (
$xml_ss
->
WÜksh“t
 
as
 
$wÜksh“t
) {

137 
$wÜksh“t_ss
 = 
$wÜksh“t
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

138 
$wÜksh“tNames
[] = 
£lf
::
	`cÚv”tSŒšgEncodšg
((
¡ršg
è
$wÜksh“t_ss
['Name'], 
$this
->
ch¬S‘
);

141  
$wÜksh“tNames
;

142 
	}
}

151 
public
 
funùiÚ
 
	$li¡WÜksh“tInfo
(
$pF’ame
)

154 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

155 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

158 
$wÜksh“tInfo
 = 
	`¬¿y
();

160 
$xml
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
(
	`fe_g‘_cÚ‹Ás
(
$pF’ame
)), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

161 
$Çme¥aûs
 = 
$xml
->
	`g‘Name¥aûs
(
Œue
);

163 
$wÜksh“tID
 = 1;

164 
$xml_ss
 = 
$xml
->
	`chd»n
(
$Çme¥aûs
['ss']);

165 
	`fÜ—ch
 (
$xml_ss
->
WÜksh“t
 
as
 
$wÜksh“t
) {

166 
$wÜksh“t_ss
 = 
$wÜksh“t
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

168 
$tmpInfo
 = 
	`¬¿y
();

169 
$tmpInfo
['worksheetName'] = '';

170 
$tmpInfo
['lastColumnLetter'] = 'A';

171 
$tmpInfo
['lastColumnIndex'] = 0;

172 
$tmpInfo
['totalRows'] = 0;

173 
$tmpInfo
['totalColumns'] = 0;

175 ià(
	`is£t
(
$wÜksh“t_ss
['Name'])) {

176 
$tmpInfo
['wÜksh“tName'] = (
¡ršg
è
$wÜksh“t_ss
['Name'];

178 
$tmpInfo
['worksheetName'] = "Worksheet_{$worksheetID}";

181 ià(
	`is£t
(
$wÜksh“t
->
TabË
->
Row
)) {

182 
$rowIndex
 = 0;

184 
	`fÜ—ch
 (
$wÜksh“t
->
TabË
->
Row
 
as
 
$rowD©a
) {

185 
$cŞumnIndex
 = 0;

186 
$rowHasD©a
 = 
çl£
;

188 
	`fÜ—ch
 (
$rowD©a
->
C–l
 
as
 
$ûÎ
) {

189 ià(
	`is£t
(
$ûÎ
->
D©a
)) {

190 
$tmpInfo
['Ï¡CŞumnIndex'] = 
	`max
($tmpInfo['Ï¡CŞumnIndex'], 
$cŞumnIndex
);

191 
$rowHasD©a
 = 
Œue
;

194 ++
$cŞumnIndex
;

197 ++
$rowIndex
;

199 ià(
$rowHasD©a
) {

200 
$tmpInfo
['tÙ®Rows'] = 
	`max
($tmpInfo['tÙ®Rows'], 
$rowIndex
);

205 
$tmpInfo
['Ï¡CŞumnL‘‹r'] = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($tmpInfo['lastColumnIndex']);

206 
$tmpInfo
['totalColumns'] = $tmpInfo['lastColumnIndex'] + 1;

208 
$wÜksh“tInfo
[] = 
$tmpInfo
;

209 ++
$wÜksh“tID
;

212  
$wÜksh“tInfo
;

213 
	}
}

223 
public
 
funùiÚ
 
	$lßd
(
$pF’ame
)

226 
$objPHPExûl
 = 
Ãw
 
	`PHPExûl
();

227 
$objPHPExûl
->
	`»moveSh“tByIndex
(0);

230  
$this
->
	`lßdIÁoExi¡šg
(
$pF’ame
, 
$objPHPExûl
);

231 
	}
}

233 
´Ùeùed
 
funùiÚ
 
	$id’tifyFixedStyËV®ue
(
$¡yËLi¡
, &
$¡yËA‰ribu‹V®ue
)

235 
$¡yËA‰ribu‹V®ue
 = 
	`¡¹Şow”
($styleAttributeValue);

236 
	`fÜ—ch
 (
$¡yËLi¡
 
as
 
$¡yË
) {

237 ià(
$¡yËA‰ribu‹V®ue
 =ğ
	`¡¹Şow”
(
$¡yË
)) {

238 
$¡yËA‰ribu‹V®ue
 = 
$¡yË
;

239  
Œue
;

242  
çl£
;

243 
	}
}

250 
´Ùeùed
 
funùiÚ
 
	$pix–2WidthUn™s
(
$pxs
)

252 
$UNIT_OFFSET_MAP
 = 
	`¬¿y
(0, 36, 73, 109, 146, 182, 219);

254 
$widthUn™s
 = 256 * (
$pxs
 / 7);

255 
$widthUn™s
 +ğ
$UNIT_OFFSET_MAP
[(
$pxs
 % 7)];

256  
$widthUn™s
;

257 
	}
}

264 
´Ùeùed
 
funùiÚ
 
	$widthUn™s2Pix–
(
$widthUn™s
)

266 
$pix–s
 = (
$widthUn™s
 / 256) * 7;

267 
$off£tWidthUn™s
 = 
$widthUn™s
 % 256;

268 
$pix–s
 +ğ
	`round
(
$off£tWidthUn™s
 / (256 / 7));

269  
$pix–s
;

270 
	}
}

272 
´Ùeùed
 
funùiÚ
 
	$hex2¡r
(
$hex
)

274  
	`chr
(
	`hexdec
(
$hex
[1]));

275 
	}
}

285 
public
 
funùiÚ
 
	$lßdIÁoExi¡šg
(
$pF’ame
, 
PHPExûl
 
$objPHPExûl
)

287 
$äomFÜm©s
 = 
	`¬¿y
('\-', '\ ');

288 
$toFÜm©s
 = 
	`¬¿y
('-', ' ');

290 
$und”lšeStyËs
 = 
	`¬¿y
 (

291 
PHPExûl_StyË_FÚt
::
UNDERLINE_NONE
,

292 
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLE
,

293 
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLEACCOUNTING
,

294 
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLE
,

295 
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLEACCOUNTING


297 
$v”tiÿlAlignm’tStyËs
 = 
	`¬¿y
 (

298 
PHPExûl_StyË_Alignm’t
::
VERTICAL_BOTTOM
,

299 
PHPExûl_StyË_Alignm’t
::
VERTICAL_TOP
,

300 
PHPExûl_StyË_Alignm’t
::
VERTICAL_CENTER
,

301 
PHPExûl_StyË_Alignm’t
::
VERTICAL_JUSTIFY


303 
$hÜizÚlAlignm’tStyËs
 = 
	`¬¿y
 (

304 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
,

305 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_LEFT
,

306 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_RIGHT
,

307 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER
,

308 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER_CONTINUOUS
,

309 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_JUSTIFY


312 
$timezÚeObj
 = 
Ãw
 
	`D©eTimeZÚe
('Europe/London');

313 
$GMT
 = 
Ãw
 
	`D©eTimeZÚe
('UTC');

316 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

317 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

320 ià(!
$this
->
	`ÿnR—d
(
$pF’ame
)) {

321 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
(
$pF’ame
 . " is‡n Invalid Spreadsheet file.");

324 
$xml
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
(
	`fe_g‘_cÚ‹Ás
(
$pF’ame
)), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

325 
$Çme¥aûs
 = 
$xml
->
	`g‘Name¥aûs
(
Œue
);

327 
$docPrİs
 = 
$objPHPExûl
->
	`g‘Prİ”t›s
();

328 ià(
	`is£t
(
$xml
->
Docum’tPrİ”t›s
[0])) {

329 
	`fÜ—ch
 (
$xml
->
Docum’tPrİ”t›s
[0] 
as
 
$´İ”tyName
 => 
$´İ”tyV®ue
) {

330 
$´İ”tyName
) {

332 
$docPrİs
->
	`£tT™Ë
(
£lf
::
	`cÚv”tSŒšgEncodšg
(
$´İ”tyV®ue
, 
$this
->
ch¬S‘
));

335 
$docPrİs
->
	`£tSubjeù
(
£lf
::
	`cÚv”tSŒšgEncodšg
(
$´İ”tyV®ue
, 
$this
->
ch¬S‘
));

338 
$docPrİs
->
	`£tC»©Ü
(
£lf
::
	`cÚv”tSŒšgEncodšg
(
$´İ”tyV®ue
, 
$this
->
ch¬S‘
));

341 
$ü—tiÚD©e
 = 
	`¡¹Ùime
(
$´İ”tyV®ue
);

342 
$docPrİs
->
	`£tC»©ed
(
$ü—tiÚD©e
);

345 
$docPrİs
->
	`£tLa¡Modif›dBy
(
£lf
::
	`cÚv”tSŒšgEncodšg
(
$´İ”tyV®ue
, 
$this
->
ch¬S‘
));

348 
$Ï¡SaveD©e
 = 
	`¡¹Ùime
(
$´İ”tyV®ue
);

349 
$docPrİs
->
	`£tModif›d
(
$Ï¡SaveD©e
);

352 
$docPrİs
->
	`£tCom·ny
(
£lf
::
	`cÚv”tSŒšgEncodšg
(
$´İ”tyV®ue
, 
$this
->
ch¬S‘
));

355 
$docPrİs
->
	`£tC©egÜy
(
£lf
::
	`cÚv”tSŒšgEncodšg
(
$´İ”tyV®ue
, 
$this
->
ch¬S‘
));

358 
$docPrİs
->
	`£tMªag”
(
£lf
::
	`cÚv”tSŒšgEncodšg
(
$´İ”tyV®ue
, 
$this
->
ch¬S‘
));

361 
$docPrİs
->
	`£tKeywÜds
(
£lf
::
	`cÚv”tSŒšgEncodšg
(
$´İ”tyV®ue
, 
$this
->
ch¬S‘
));

364 
$docPrİs
->
	`£tDesütiÚ
(
£lf
::
	`cÚv”tSŒšgEncodšg
(
$´İ”tyV®ue
, 
$this
->
ch¬S‘
));

369 ià(
	`is£t
(
$xml
->
Cu¡omDocum’tPrİ”t›s
)) {

370 
	`fÜ—ch
 (
$xml
->
Cu¡omDocum’tPrİ”t›s
[0] 
as
 
$´İ”tyName
 => 
$´İ”tyV®ue
) {

371 
$´İ”tyA‰ribu‹s
 = 
$´İ”tyV®ue
->
	`©Œibu‹s
(
$Çme¥aûs
['dt']);

372 
$´İ”tyName
 = 
	`´eg_»¶aû_ÿÎback
('/_x([0-9a-z]{4})_/', 'PHPExcel_Reader_Excel2003XML::hex2str', $propertyName);

373 
$´İ”tyTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_UNKNOWN
;

374 (
¡ršg
è
$´İ”tyA‰ribu‹s
) {

376 
$´İ”tyTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_STRING
;

377 
$´İ”tyV®ue
 = 
	`Œim
($propertyValue);

380 
$´İ”tyTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_BOOLEAN
;

381 
$´İ”tyV®ue
 = (
boŞ
) $propertyValue;

384 
$´İ”tyTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_INTEGER
;

385 
$´İ”tyV®ue
 = 
	`štv®
($propertyValue);

388 
$´İ”tyTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_FLOAT
;

389 
$´İ”tyV®ue
 = 
	`æßtv®
($propertyValue);

392 
$´İ”tyTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_DATE
;

393 
$´İ”tyV®ue
 = 
	`¡¹Ùime
(
	`Œim
($propertyValue));

396 
$docPrİs
->
	`£tCu¡omPrİ”ty
(
$´İ”tyName
, 
$´İ”tyV®ue
, 
$´İ”tyTy³
);

400 
	`fÜ—ch
 (
$xml
->
StyËs
[0] 
as
 
$¡yË
) {

401 
$¡yË_ss
 = 
$¡yË
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

402 
$¡yËID
 = (
¡ršg
è
$¡yË_ss
['ID'];

404 ià(
$¡yËID
 == 'Default') {

405 
$this
->
¡yËs
['DeçuÉ'] = 
	`¬¿y
();

407 
$this
->
¡yËs
[
$¡yËID
] = $this->styles['Default'];

409 
	`fÜ—ch
 (
$¡yË
 
as
 
$¡yËTy³
 => 
$¡yËD©a
) {

410 
$¡yËA‰ribu‹s
 = 
$¡yËD©a
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

412 
$¡yËTy³
) {

414 
	`fÜ—ch
 (
$¡yËA‰ribu‹s
 
as
 
$¡yËA‰ribu‹Key
 => 
$¡yËA‰ribu‹V®ue
) {

416 
$¡yËA‰ribu‹V®ue
 = (
¡ršg
) $styleAttributeValue;

417 
$¡yËA‰ribu‹Key
) {

419 ià(
£lf
::
	`id’tifyFixedStyËV®ue
(
$v”tiÿlAlignm’tStyËs
, 
$¡yËA‰ribu‹V®ue
)) {

420 
$this
->
¡yËs
[
$¡yËID
]['®ignm’t']['v”tiÿl'] = 
$¡yËA‰ribu‹V®ue
;

424 ià(
£lf
::
	`id’tifyFixedStyËV®ue
(
$hÜizÚlAlignm’tStyËs
, 
$¡yËA‰ribu‹V®ue
)) {

425 
$this
->
¡yËs
[
$¡yËID
]['®ignm’t']['hÜizÚl'] = 
$¡yËA‰ribu‹V®ue
;

429 
$this
->
¡yËs
[
$¡yËID
]['®ignm’t']['w¿p'] = 
Œue
;

435 
	`fÜ—ch
 (
$¡yËD©a
->
BÜd”
 
as
 
$bÜd”StyË
) {

436 
$bÜd”A‰ribu‹s
 = 
$bÜd”StyË
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

437 
$thisBÜd”
 = 
	`¬¿y
();

438 
	`fÜ—ch
 (
$bÜd”A‰ribu‹s
 
as
 
$bÜd”StyËKey
 => 
$bÜd”StyËV®ue
) {

440 
$bÜd”StyËKey
) {

442 
$thisBÜd”
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
;

449 
$bÜd”Pos™iÚ
 = 
	`¡¹Şow”
(
$bÜd”StyËV®ue
);

452 
$bÜd”CŞour
 = 
	`sub¡r
(
$bÜd”StyËV®ue
, 1);

453 
$thisBÜd”
['cŞÜ']['rgb'] = 
$bÜd”CŞour
;

457 ià(!
	`em±y
(
$thisBÜd”
)) {

458 ià((
$bÜd”Pos™iÚ
 == 'left') || ($borderPosition == 'right') || ($borderPosition == 'top') || ($borderPosition == 'bottom')) {

459 
$this
->
¡yËs
[
$¡yËID
]['bÜd”s'][
$bÜd”Pos™iÚ
] = 
$thisBÜd”
;

465 
	`fÜ—ch
 (
$¡yËA‰ribu‹s
 
as
 
$¡yËA‰ribu‹Key
 => 
$¡yËA‰ribu‹V®ue
) {

467 
$¡yËA‰ribu‹V®ue
 = (
¡ršg
) $styleAttributeValue;

468 
$¡yËA‰ribu‹Key
) {

470 
$this
->
¡yËs
[
$¡yËID
]['fÚt']['Çme'] = 
$¡yËA‰ribu‹V®ue
;

473 
$this
->
¡yËs
[
$¡yËID
]['fÚt']['size'] = 
$¡yËA‰ribu‹V®ue
;

476 
$this
->
¡yËs
[
$¡yËID
]['fÚt']['cŞÜ']['rgb'] = 
	`sub¡r
(
$¡yËA‰ribu‹V®ue
, 1);

479 
$this
->
¡yËs
[
$¡yËID
]['fÚt']['bŞd'] = 
Œue
;

482 
$this
->
¡yËs
[
$¡yËID
]['fÚt']['™®ic'] = 
Œue
;

485 ià(
£lf
::
	`id’tifyFixedStyËV®ue
(
$und”lšeStyËs
, 
$¡yËA‰ribu‹V®ue
)) {

486 
$this
->
¡yËs
[
$¡yËID
]['fÚt']['und”lše'] = 
$¡yËA‰ribu‹V®ue
;

493 
	`fÜ—ch
 (
$¡yËA‰ribu‹s
 
as
 
$¡yËA‰ribu‹Key
 => 
$¡yËA‰ribu‹V®ue
) {

495 
$¡yËA‰ribu‹Key
) {

497 
$this
->
¡yËs
[
$¡yËID
]['fl']['cŞÜ']['rgb'] = 
	`sub¡r
(
$¡yËA‰ribu‹V®ue
, 1);

503 
	`fÜ—ch
 (
$¡yËA‰ribu‹s
 
as
 
$¡yËA‰ribu‹Key
 => 
$¡yËA‰ribu‹V®ue
) {

505 
$¡yËA‰ribu‹V®ue
 = 
	`¡r_»¶aû
(
$äomFÜm©s
, 
$toFÜm©s
, $styleAttributeValue);

506 
$¡yËA‰ribu‹V®ue
) {

508 
$¡yËA‰ribu‹V®ue
 = 'dd/mm/yyyy';

511 ià(
$¡yËA‰ribu‹V®ue
 > '') {

512 
$this
->
¡yËs
[
$¡yËID
]['numb”fÜm©']['code'] = 
$¡yËA‰ribu‹V®ue
;

517 
	`fÜ—ch
 (
$¡yËA‰ribu‹s
 
as
 
$¡yËA‰ribu‹Key
 => 
$¡yËA‰ribu‹V®ue
) {

528 
$wÜksh“tID
 = 0;

529 
$xml_ss
 = 
$xml
->
	`chd»n
(
$Çme¥aûs
['ss']);

531 
	`fÜ—ch
 (
$xml_ss
->
WÜksh“t
 
as
 
$wÜksh“t
) {

532 
$wÜksh“t_ss
 = 
$wÜksh“t
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

534 ià((
	`is£t
(
$this
->
lßdSh“tsOÆy
)è&& (is£t(
$wÜksh“t_ss
['Name'])) &&

535 (!
	`š_¬¿y
(
$wÜksh“t_ss
['Name'], 
$this
->
lßdSh“tsOÆy
))) {

542 
$objPHPExûl
->
	`ü—‹Sh“t
();

543 
$objPHPExûl
->
	`£tAùiveSh“tIndex
(
$wÜksh“tID
);

544 ià(
	`is£t
(
$wÜksh“t_ss
['Name'])) {

545 
$wÜksh“tName
 = 
£lf
::
	`cÚv”tSŒšgEncodšg
((
¡ršg
è
$wÜksh“t_ss
['Name'], 
$this
->
ch¬S‘
);

549 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`£tT™Ë
(
$wÜksh“tName
, 
çl£
);

552 
$cŞumnID
 = 'A';

553 ià(
	`is£t
(
$wÜksh“t
->
TabË
->
CŞumn
)) {

554 
	`fÜ—ch
 (
$wÜksh“t
->
TabË
->
CŞumn
 
as
 
$cŞumnD©a
) {

555 
$cŞumnD©a_ss
 = 
$cŞumnD©a
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

556 ià(
	`is£t
(
$cŞumnD©a_ss
['Index'])) {

557 
$cŞumnID
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumnD©a_ss
['Index']-1);

559 ià(
	`is£t
(
$cŞumnD©a_ss
['Width'])) {

560 
$cŞumnWidth
 = 
$cŞumnD©a_ss
['Width'];

562 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘CŞumnDim’siÚ
(
$cŞumnID
)->
	`£tWidth
(
$cŞumnWidth
 / 5.4);

564 ++
$cŞumnID
;

568 
$rowID
 = 1;

569 ià(
	`is£t
(
$wÜksh“t
->
TabË
->
Row
)) {

570 
$add™iÚ®M”gedC–ls
 = 0;

571 
	`fÜ—ch
 (
$wÜksh“t
->
TabË
->
Row
 
as
 
$rowD©a
) {

572 
$rowHasD©a
 = 
çl£
;

573 
$row_ss
 = 
$rowD©a
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

574 ià(
	`is£t
(
$row_ss
['Index'])) {

575 
$rowID
 = (
š‹g”
è
$row_ss
['Index'];

579 
$cŞumnID
 = 'A';

580 
	`fÜ—ch
 (
$rowD©a
->
C–l
 
as
 
$ûÎ
) {

581 
$ûÎ_ss
 = 
$ûÎ
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

582 ià(
	`is£t
(
$ûÎ_ss
['Index'])) {

583 
$cŞumnID
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$ûÎ_ss
['Index']-1);

585 
$ûÎRªge
 = 
$cŞumnID
.
$rowID
;

587 ià(
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
) {

588 ià(!
$this
->
	`g‘R—dF‹r
()->
	`»adC–l
(
$cŞumnID
, 
$rowID
, 
$wÜksh“tName
)) {

593 ià((
	`is£t
(
$ûÎ_ss
['MergeAcross'])) || (isset($cell_ss['MergeDown']))) {

594 
$cŞumnTo
 = 
$cŞumnID
;

595 ià(
	`is£t
(
$ûÎ_ss
['MergeAcross'])) {

596 
$add™iÚ®M”gedC–ls
 +ğ()
$ûÎ_ss
['MergeAcross'];

597 
$cŞumnTo
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(PHPExûl_C–l::
	`cŞumnIndexFromSŒšg
(
$cŞumnID
è+ 
$ûÎ_ss
['MergeAcross'] -1);

599 
$rowTo
 = 
$rowID
;

600 ià(
	`is£t
(
$ûÎ_ss
['MergeDown'])) {

601 
$rowTo
 = $rowTØ+ 
$ûÎ_ss
['MergeDown'];

603 
$ûÎRªge
 .ğ':'.
$cŞumnTo
.
$rowTo
;

604 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`m”geC–ls
(
$ûÎRªge
);

607 
$ûÎIsS‘
 = 
$hasC®cuÏ‹dV®ue
 = 
çl£
;

608 
$ûÎD©aFÜmuÏ
 = '';

609 ià(
	`is£t
(
$ûÎ_ss
['Formula'])) {

610 
$ûÎD©aFÜmuÏ
 = 
$ûÎ_ss
['Formula'];

612 ià(
	`is£t
(
$ûÎ_ss
['ArrayRange'])) {

613 
$ûÎD©aCSEFÜmuÏ
 = 
$ûÎ_ss
['ArrayRange'];

616 
$hasC®cuÏ‹dV®ue
 = 
Œue
;

618 ià(
	`is£t
(
$ûÎ
->
D©a
)) {

619 
$ûÎV®ue
 = 
$ûÎD©a
 = 
$ûÎ
->
D©a
;

620 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
;

621 
$ûÎD©a_ss
 = 
$ûÎD©a
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

622 ià(
	`is£t
(
$ûÎD©a_ss
['Type'])) {

623 
$ûÎD©aTy³
 = 
$ûÎD©a_ss
['Type'];

624 
$ûÎD©aTy³
) {

635 
$ûÎV®ue
 = 
£lf
::
	`cÚv”tSŒšgEncodšg
($ûÎV®ue, 
$this
->
ch¬S‘
);

636 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

639 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

640 
$ûÎV®ue
 = () $cellValue;

641 ià(
	`æoÜ
(
$ûÎV®ue
) == $cellValue) {

642 
$ûÎV®ue
 = (
š‹g”
) $cellValue;

646 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
;

647 
$ûÎV®ue
 = ($cellValue != 0);

650 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

651 
$ûÎV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
	`¡¹Ùime
($cellValue));

654 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_ERROR
;

659 ià(
$hasC®cuÏ‹dV®ue
) {

661 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
;

662 
$cŞumnNumb”
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞumnID
);

663 ià(
	`sub¡r
(
$ûÎD©aFÜmuÏ
, 0, 3) == 'of:') {

664 
$ûÎD©aFÜmuÏ
 = 
	`sub¡r
($cellDataFormula, 3);

666 
$‹mp
 = 
	`ex¶ode
('"', 
$ûÎD©aFÜmuÏ
);

667 
$key
 = 
çl£
;

668 
	`fÜ—ch
 (
$‹mp
 
as
 &
$v®ue
) {

670 ià(
$key
 = !$key) {

671 
$v®ue
 = 
	`¡r_»¶aû
(
	`¬¿y
('[.', '.', ']'), '', $value);

677 
$‹mp
 = 
	`ex¶ode
('"', 
$ûÎD©aFÜmuÏ
);

678 
$key
 = 
çl£
;

679 
	`fÜ—ch
 (
$‹mp
 
as
 &
$v®ue
) {

681 ià(
$key
 = !$key) {

682 
	`´eg_m©ch_®l
('/(R(\[?-?\d*\]?))(C(\[?-?\d*\]?))/', 
$v®ue
, 
$ûÎReã»nûs
, 
PREG_SET_ORDER
 + 
PREG_OFFSET_CAPTURE
);

686 
$ûÎReã»nûs
 = 
	`¬¿y_»v”£
($cellReferences);

689 
	`fÜ—ch
 (
$ûÎReã»nûs
 
as
 
$ûÎReã»nû
) {

690 
$rowReã»nû
 = 
$ûÎReã»nû
[2][0];

692 ià(
$rowReã»nû
 == '') {

693 
$rowReã»nû
 = 
$rowID
;

696 ià(
$rowReã»nû
{0} == '[') {

697 
$rowReã»nû
 = 
$rowID
 + 
	`Œim
($rowReference, '[]');

699 
$cŞumnReã»nû
 = 
$ûÎReã»nû
[4][0];

701 ià(
$cŞumnReã»nû
 == '') {

702 
$cŞumnReã»nû
 = 
$cŞumnNumb”
;

705 ià(
$cŞumnReã»nû
{0} == '[') {

706 
$cŞumnReã»nû
 = 
$cŞumnNumb”
 + 
	`Œim
($columnReference, '[]');

708 
$A1C–lReã»nû
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumnReã»nû
-1).
$rowReã»nû
;

709 
$v®ue
 = 
	`sub¡r_»¶aû
($v®ue, 
$A1C–lReã»nû
, 
$ûÎReã»nû
[0][1], 
	`¡¾’
($cellReference[0][0]));

714 
	`un£t
(
$v®ue
);

716 
$ûÎD©aFÜmuÏ
 = 
	`im¶ode
('"', 
$‹mp
);

722 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘C–l
(
$cŞumnID
.
$rowID
)->
	`£tV®ueEx¶ic™
(((
$hasC®cuÏ‹dV®ue
è? 
$ûÎD©aFÜmuÏ
 : 
$ûÎV®ue
), 
$ty³
);

723 ià(
$hasC®cuÏ‹dV®ue
) {

725 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘C–l
(
$cŞumnID
.
$rowID
)->
	`£tC®cuÏ‹dV®ue
(
$ûÎV®ue
);

727 
$ûÎIsS‘
 = 
$rowHasD©a
 = 
Œue
;

730 ià(
	`is£t
(
$ûÎ
->
Comm’t
)) {

732 
$comm’tA‰ribu‹s
 = 
$ûÎ
->
Comm’t
->
	`©Œibu‹s
(
$Çme¥aûs
['ss']);

733 
$authÜ
 = 'unknown';

734 ià(
	`is£t
(
$comm’tA‰ribu‹s
->
AuthÜ
)) {

735 
$authÜ
 = (
¡ršg
)
$comm’tA‰ribu‹s
->
AuthÜ
;

738 
$node
 = 
$ûÎ
->
Comm’t
->
D©a
->
	`asXML
();

741 
$ªnÙ©iÚ
 = 
	`¡r_gs
(
$node
);

743 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘Comm’t
(
$cŞumnID
.
$rowID
)->
	`£tAuthÜ
(
£lf
::
	`cÚv”tSŒšgEncodšg
(
$authÜ
, 
$this
->
ch¬S‘
))->
	`£tText
($this->
	`·r£RichText
(
$ªnÙ©iÚ
));

746 ià((
$ûÎIsS‘
è&& (
	`is£t
(
$ûÎ_ss
['StyleID']))) {

747 
$¡yË
 = (
¡ršg
è
$ûÎ_ss
['StyleID'];

749 ià((
	`is£t
(
$this
->
¡yËs
[
$¡yË
])è&& (!
	`em±y
($this->styles[$style]))) {

753 ià(!
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`ûÎExi¡s
(
$cŞumnID
.
$rowID
)) {

754 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘C–l
(
$cŞumnID
.
$rowID
)->
	`£tV®ue
(
nuÎ
);

756 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘StyË
(
$ûÎRªge
)->
	`­¶yFromA¼ay
(
$this
->
¡yËs
[
$¡yË
]);

759 ++
$cŞumnID
;

760 
$add™iÚ®M”gedC–ls
 > 0) {

761 ++
$cŞumnID
;

762 
$add™iÚ®M”gedC–ls
--;

766 ià(
$rowHasD©a
) {

767 ià(
	`is£t
(
$row_ss
['StyleID'])) {

768 
$rowStyË
 = 
$row_ss
['StyleID'];

770 ià(
	`is£t
(
$row_ss
['Height'])) {

771 
$rowHeight
 = 
$row_ss
['Height'];

773 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘RowDim’siÚ
(
$rowID
)->
	`£tRowHeight
(
$rowHeight
);

777 ++
$rowID
;

780 ++
$wÜksh“tID
;

784  
$objPHPExûl
;

785 
	}
}

788 
´Ùeùed
 
funùiÚ
 
	$cÚv”tSŒšgEncodšg
(
$¡ršg
, 
$ch¬£t
)

790 ià(
$ch¬£t
 != 'UTF-8') {

791  
PHPExûl_Sh¬ed_SŒšg
::
	`CÚv”tEncodšg
(
$¡ršg
, 'UTF-8', 
$ch¬£t
);

793  
$¡ršg
;

794 
	}
}

797 
´Ùeùed
 
funùiÚ
 
·r£RichText
(
$is
 = '')

799 
$v®ue
 = 
Ãw
 
PHPExûl_RichText
();

801 
	g$v®ue
->
ü—‹Text
(
£lf
::
cÚv”tSŒšgEncodšg
(
$is
, 
$this
->
ch¬S‘
));

803  
	g$v®ue
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel2007.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_R—d”_Exûl2007
 
ex‹nds
 
PHPExûl_R—d”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_R—d”_IR—d”


44 
´iv©e
 
	m$»ã»nûH–³r
 = 
nuÎ
;

51 
´iv©e
 
	m$theme
 = 
nuÎ
;

56 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

58 
$this
->
»adF‹r
 = 
Ãw
 
	`PHPExûl_R—d”_DeçuÉR—dF‹r
();

59 
$this
->
»ã»nûH–³r
 = 
PHPExûl_Reã»nûH–³r
::
	`g‘In¡ªû
();

69 
public
 
funùiÚ
 
	$ÿnR—d
(
$pF’ame
)

72 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

73 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

76 
$zCÏss
 = 
PHPExûl_S‘tšgs
::
	`g‘ZCÏss
();

83 
$xl
 = 
çl£
;

85 
$z
 = 
Ãw
 
$zCÏss
;

86 ià(
$z
->
	`İ’
(
$pF’ame
è==ğ
Œue
) {

88 
$»ls
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "_»ls/.»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

89 ià(
$»ls
 !=ğ
çl£
) {

90 
	`fÜ—ch
 (
$»ls
->
R–©iÚsh
 
as
 
$»l
) {

91 
$»l
["Type"]) {

93 ià(
	`ba£Çme
(
$»l
["Target"]) == 'workbook.xml') {

94 
$xl
 = 
Œue
;

101 
$z
->
	`şo£
();

104  
$xl
;

105 
	}
}

114 
public
 
funùiÚ
 
	$li¡WÜksh“tNames
(
$pF’ame
)

117 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

118 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

121 
$wÜksh“tNames
 = 
	`¬¿y
();

123 
$zCÏss
 = 
PHPExûl_S‘tšgs
::
	`g‘ZCÏss
();

125 
$z
 = 
Ãw
 
$zCÏss
;

126 
$z
->
	`İ’
(
$pF’ame
);

129 
$»ls
 = 
	`sim¶exml_lßd_¡ršg
(

130 
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "_»ls/.»ls"), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
())

132 
	`fÜ—ch
 (
$»ls
->
R–©iÚsh
 
as
 
$»l
) {

133 
$»l
["Type"]) {

135 
$xmlWÜkbook
 = 
	`sim¶exml_lßd_¡ršg
(

136 
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "{$»l['T¬g‘']}"), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
())

139 ià(
$xmlWÜkbook
->
sh“ts
) {

140 
	`fÜ—ch
 (
$xmlWÜkbook
->
sh“ts
->
sh“t
 
as
 
$–eSh“t
) {

142 
$wÜksh“tNames
[] = (
¡ršg
è
$–eSh“t
["name"];

148 
$z
->
	`şo£
();

150  
$wÜksh“tNames
;

151 
	}
}

160 
public
 
funùiÚ
 
	$li¡WÜksh“tInfo
(
$pF’ame
)

163 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

164 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

167 
$wÜksh“tInfo
 = 
	`¬¿y
();

169 
$zCÏss
 = 
PHPExûl_S‘tšgs
::
	`g‘ZCÏss
();

171 
$z
 = 
Ãw
 
$zCÏss
;

172 
$z
->
	`İ’
(
$pF’ame
);

174 
$»ls
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "_»ls/.»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

175 
	`fÜ—ch
 (
$»ls
->
R–©iÚsh
 
as
 
$»l
) {

176 ià(
$»l
["Type"] == "http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument") {

177 
$dœ
 = 
	`dœÇme
(
$»l
["Target"]);

178 
$»lsWÜkbook
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "$dœ/_»ls/" . 
	`ba£Çme
(
$»l
["T¬g‘"]è. ".»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

179 
$»lsWÜkbook
->
	`»gi¡”XP©hName¥aû
("rel", "http://schemas.openxmlformats.org/package/2006/relationships");

181 
$wÜksh“ts
 = 
	`¬¿y
();

182 
	`fÜ—ch
 (
$»lsWÜkbook
->
R–©iÚsh
 
as
 
$–e
) {

183 ià(
$–e
["Type"] == "http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet") {

184 
$wÜksh“ts
[(
¡ršg
è
$–e
["Id"]] = $ele["Target"];

188 
$xmlWÜkbook
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "{$»l['T¬g‘']}")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

189 ià(
$xmlWÜkbook
->
sh“ts
) {

190 
$dœ
 = 
	`dœÇme
(
$»l
["Target"]);

191 
	`fÜ—ch
 (
$xmlWÜkbook
->
sh“ts
->
sh“t
 
as
 
$–eSh“t
) {

192 
$tmpInfo
 = 
	`¬¿y
(

193 'wÜksh“tName' => (
¡ršg
è
$–eSh“t
["name"],

200 
$feWÜksh“t
 = 
$wÜksh“ts
[(
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$–eSh“t
->
	`©Œibu‹s
("http://schemas.openxmlformats.org/officeDocument/2006/relationships"), "id")];

202 
$xml
 = 
Ãw
 
	`XMLR—d”
();

203 
$»s
 = 
$xml
->
	`xml
(
$this
->
	`£cur™ySÿnFe
('z://'.
PHPExûl_Sh¬ed_Fe
::
	`»®·th
(
$pF’ame
).'#'."$dœ/$feWÜksh“t"), 
nuÎ
, 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

204 
$xml
->
	`£tP¬£rPrİ”ty
(2, 
Œue
);

206 
$cu¼C–ls
 = 0;

207 
$xml
->
	`»ad
()) {

208 ià(
$xml
->
Çme
 =ğ'row' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

209 
$row
 = 
$xml
->
	`g‘A‰ribu‹
('r');

210 
$tmpInfo
['tÙ®Rows'] = 
$row
;

211 
$tmpInfo
['tÙ®CŞumns'] = 
	`max
($tmpInfo['tÙ®CŞumns'], 
$cu¼C–ls
);

212 
$cu¼C–ls
 = 0;

213 } 
	`–£if
 (
$xml
->
Çme
 =ğ'c' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

214 
$cu¼C–ls
++;

217 
$tmpInfo
['tÙ®CŞumns'] = 
	`max
($tmpInfo['tÙ®CŞumns'], 
$cu¼C–ls
);

218 
$xml
->
	`şo£
();

220 
$tmpInfo
['lastColumnIndex'] = $tmpInfo['totalColumns'] - 1;

221 
$tmpInfo
['Ï¡CŞumnL‘‹r'] = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($tmpInfo['lastColumnIndex']);

223 
$wÜksh“tInfo
[] = 
$tmpInfo
;

229 
$z
->
	`şo£
();

231  
$wÜksh“tInfo
;

232 
	}
}

234 
´iv©e
 
funùiÚ
 
	$ÿ¡ToBoŞ—n
(
$c
)

237 
$v®ue
 = 
	`is£t
(
$c
->
v
è? (
¡ršg
è$c->v : 
nuÎ
;

238 ià(
$v®ue
 == '0') {

239  
çl£
;

240 } 
	`–£if
 (
$v®ue
 == '1') {

241  
Œue
;

243  (
boŞ
)
$c
->
v
;

245  
$v®ue
;

246 
	}
}

248 
´iv©e
 
funùiÚ
 
	$ÿ¡ToE¼Ü
(
$c
)

251  
	`is£t
(
$c
->
v
è? (
¡ršg
è$c->v : 
nuÎ
;

252 
	}
}

254 
´iv©e
 
funùiÚ
 
	$ÿ¡ToSŒšg
(
$c
)

257  
	`is£t
(
$c
->
v
è? (
¡ršg
è$c->v : 
nuÎ
;

258 
	}
}

260 
´iv©e
 
funùiÚ
 
	$ÿ¡ToFÜmuÏ
(
$c
, 
$r
, &
$ûÎD©aTy³
, &
$v®ue
, &
$ÿlcuÏ‹dV®ue
, &
$sh¬edFÜmuÏs
, 
$ÿ¡Ba£Ty³
)

264 
$ûÎD©aTy³
 = 'f';

265 
$v®ue
 = "={$c->f}";

266 
$ÿlcuÏ‹dV®ue
 = 
£lf
::
	`$ÿ¡Ba£Ty³
(
$c
);

269 ià(
	`is£t
(
$c
->
f
['t']è&& 
	`¡¹Şow”
((
¡ršg
)$c->f['t']) == 'shared') {

271 
$š¡ªû
 = (
¡ršg
)
$c
->
f
['si'];

277 ià(!
	`is£t
(
$sh¬edFÜmuÏs
[(
¡ršg
)
$c
->
f
['si']])) {

281 
$sh¬edFÜmuÏs
[
$š¡ªû
] = 
	`¬¿y
('ma¡”' => 
$r
, 'fÜmuÏ' => 
$v®ue
);

288 
$ma¡”
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$sh¬edFÜmuÏs
[
$š¡ªû
]['master']);

289 
$cu¼’t
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$r
);

291 
$difã»nû
 = 
	`¬¿y
(0, 0);

292 
$difã»nû
[0] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cu¼’t
[0]è- PHPExûl_C–l::cŞumnIndexFromSŒšg(
$ma¡”
[0]);

293 
$difã»nû
[1] = 
$cu¼’t
[1] - 
$ma¡”
[1];

295 
$v®ue
 = 
$this
->
»ã»nûH–³r
->
	`upd©eFÜmuÏReã»nûs
(
$sh¬edFÜmuÏs
[
$š¡ªû
]['fÜmuÏ'], 'A1', 
$difã»nû
[0], $difference[1]);

299 
	}
}

302 
´iv©e
 
funùiÚ
 
g‘FromZArchive
(
$¬chive
, 
$feName
 = '')

305 ià(
¡½os
(
$feName
, '//'è!=ğ
çl£
) {

306 
$feName
 = 
sub¡r
($feName, 
¡½os
($fileName, '//') + 1);

308 
	g$feName
 = 
PHPExûl_Sh¬ed_Fe
::
»®·th
(
$feName
);

311 
	g$cÚ‹Ás
 = 
$¬chive
->
g‘FromName
(
$feName
);

312 ià(
	g$cÚ‹Ás
 ==ğ
çl£
) {

313 
$cÚ‹Ás
 = 
$¬chive
->
g‘FromName
(
sub¡r
(
$feName
, 1));

316  
	g$cÚ‹Ás
;

327 
public
 
funùiÚ
 
	$lßd
(
$pF’ame
)

330 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

331 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

335 
$exûl
 = 
Ãw
 
PHPExûl
;

336 
$exûl
->
	`»moveSh“tByIndex
(0);

337 ià(!
$this
->
»adD©aOÆy
) {

338 
$exûl
->
	`»moveC–lStyËXfByIndex
(0);

339 
$exûl
->
	`»moveC–lXfByIndex
(0);

342 
$zCÏss
 = 
PHPExûl_S‘tšgs
::
	`g‘ZCÏss
();

344 
$z
 = 
Ãw
 
$zCÏss
;

345 
$z
->
	`İ’
(
$pF’ame
);

348 
$wbR–s
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "xl/_»ls/wÜkbook.xml.»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

349 
	`fÜ—ch
 (
$wbR–s
->
R–©iÚsh
 
as
 
$»l
) {

350 
$»l
["Type"]) {

352 
$themeOrd”A¼ay
 = 
	`¬¿y
('lt1', 'dk1', 'lt2', 'dk2');

353 
$themeOrd”Add™iÚ®
 = 
	`couÁ
(
$themeOrd”A¼ay
);

355 
$xmlTheme
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "xl/{$»l['T¬g‘']}")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

356 ià(
	`is_objeù
(
$xmlTheme
)) {

357 
$xmlThemeName
 = 
$xmlTheme
->
	`©Œibu‹s
();

358 
$xmlTheme
 = $xmlTheme->
	`chd»n
("http://schemas.openxmlformats.org/drawingml/2006/main");

359 
$themeName
 = (
¡ršg
)
$xmlThemeName
['name'];

361 
$cŞourScheme
 = 
$xmlTheme
->
themeEËm’ts
->
şrScheme
->
	`©Œibu‹s
();

362 
$cŞourSchemeName
 = (
¡ršg
)
$cŞourScheme
['name'];

363 
$cŞourScheme
 = 
$xmlTheme
->
themeEËm’ts
->
şrScheme
->
	`chd»n
("http://schemas.openxmlformats.org/drawingml/2006/main");

365 
$themeCŞours
 = 
	`¬¿y
();

366 
	`fÜ—ch
 (
$cŞourScheme
 
as
 
$k
 => 
$xmlCŞour
) {

367 
$themePos
 = 
	`¬¿y_£¬ch
(
$k
, 
$themeOrd”A¼ay
);

368 ià(
$themePos
 ==ğ
çl£
) {

369 
$themePos
 = 
$themeOrd”Add™iÚ®
++;

371 ià(
	`is£t
(
$xmlCŞour
->
sysCÌ
)) {

372 
$xmlCŞourD©a
 = 
$xmlCŞour
->
sysCÌ
->
	`©Œibu‹s
();

373 
$themeCŞours
[
$themePos
] = 
$xmlCŞourD©a
['lastClr'];

374 } 
	`–£if
 (
	`is£t
(
$xmlCŞour
->
¤gbCÌ
)) {

375 
$xmlCŞourD©a
 = 
$xmlCŞour
->
¤gbCÌ
->
	`©Œibu‹s
();

376 
$themeCŞours
[
$themePos
] = 
$xmlCŞourD©a
['val'];

379 
£lf
::
$theme
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl2007_Theme
(
$themeName
, 
$cŞourSchemeName
, 
$themeCŞours
);

385 
$»ls
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "_»ls/.»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

386 
	`fÜ—ch
 (
$»ls
->
R–©iÚsh
 
as
 
$»l
) {

387 
$»l
["Type"]) {

389 
$xmlCÜe
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "{$»l['T¬g‘']}")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

390 ià(
	`is_objeù
(
$xmlCÜe
)) {

391 
$xmlCÜe
->
	`»gi¡”XP©hName¥aû
("dc", "http://purl.org/dc/elements/1.1/");

392 
$xmlCÜe
->
	`»gi¡”XP©hName¥aû
("dcterms", "http://purl.org/dc/terms/");

393 
$xmlCÜe
->
	`»gi¡”XP©hName¥aû
("cp", "http://schemas.openxmlformats.org/package/2006/metadata/core-properties");

394 
$docPrİs
 = 
$exûl
->
	`g‘Prİ”t›s
();

395 
$docPrİs
->
	`£tC»©Ü
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$xmlCÜe
->
	`x·th
("dc:creator")));

396 
$docPrİs
->
	`£tLa¡Modif›dBy
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$xmlCÜe
->
	`x·th
("cp:lastModifiedBy")));

397 
$docPrİs
->
	`£tC»©ed
(
	`¡¹Ùime
(
£lf
::
	`g‘A¼ayI‹m
(
$xmlCÜe
->
	`x·th
("dcterms:created"))));

398 
$docPrİs
->
	`£tModif›d
(
	`¡¹Ùime
(
£lf
::
	`g‘A¼ayI‹m
(
$xmlCÜe
->
	`x·th
("dcterms:modified"))));

399 
$docPrİs
->
	`£tT™Ë
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$xmlCÜe
->
	`x·th
("dc:title")));

400 
$docPrİs
->
	`£tDesütiÚ
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$xmlCÜe
->
	`x·th
("dc:description")));

401 
$docPrİs
->
	`£tSubjeù
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$xmlCÜe
->
	`x·th
("dc:subject")));

402 
$docPrİs
->
	`£tKeywÜds
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$xmlCÜe
->
	`x·th
("cp:keywords")));

403 
$docPrİs
->
	`£tC©egÜy
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$xmlCÜe
->
	`x·th
("cp:category")));

407 
$xmlCÜe
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "{$»l['T¬g‘']}")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

408 ià(
	`is_objeù
(
$xmlCÜe
)) {

409 
$docPrİs
 = 
$exûl
->
	`g‘Prİ”t›s
();

410 ià(
	`is£t
(
$xmlCÜe
->
Com·ny
)) {

411 
$docPrİs
->
	`£tCom·ny
((
¡ršg
è
$xmlCÜe
->
Com·ny
);

413 ià(
	`is£t
(
$xmlCÜe
->
Mªag”
)) {

414 
$docPrİs
->
	`£tMªag”
((
¡ršg
è
$xmlCÜe
->
Mªag”
);

419 
$xmlCÜe
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "{$»l['T¬g‘']}")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

420 ià(
	`is_objeù
(
$xmlCÜe
)) {

421 
$docPrİs
 = 
$exûl
->
	`g‘Prİ”t›s
();

422 
	`fÜ—ch
 (
$xmlCÜe
 
as
 
$xmlPrİ”ty
) {

423 
$ûÎD©aOffiûA‰ribu‹s
 = 
$xmlPrİ”ty
->
	`©Œibu‹s
();

424 ià(
	`is£t
(
$ûÎD©aOffiûA‰ribu‹s
['name'])) {

425 
$´İ”tyName
 = (
¡ršg
è
$ûÎD©aOffiûA‰ribu‹s
['name'];

426 
$ûÎD©aOffiûChd»n
 = 
$xmlPrİ”ty
->
	`chd»n
('http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes');

427 
$©Œibu‹Ty³
 = 
$ûÎD©aOffiûChd»n
->
	`g‘Name
();

428 
$©Œibu‹V®ue
 = (
¡ršg
è
$ûÎD©aOffiûChd»n
->{
$©Œibu‹Ty³
};

429 
$©Œibu‹V®ue
 = 
PHPExûl_Docum’tPrİ”t›s
::
	`cÚv”tPrİ”ty
($©Œibu‹V®ue, 
$©Œibu‹Ty³
);

430 
$©Œibu‹Ty³
 = 
PHPExûl_Docum’tPrİ”t›s
::
	`cÚv”tPrİ”tyTy³
($attributeType);

431 
$docPrİs
->
	`£tCu¡omPrİ”ty
(
$´İ”tyName
, 
$©Œibu‹V®ue
, 
$©Œibu‹Ty³
);

438 
$cu¡omUI
 = 
$»l
['Target'];

439 ià(!
	`is_nuÎ
(
$cu¡omUI
)) {

440 
$this
->
	`»adRibbÚ
(
$exûl
, 
$cu¡omUI
, 
$z
);

444 
$dœ
 = 
	`dœÇme
(
$»l
["Target"]);

445 
$»lsWÜkbook
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "$dœ/_»ls/" . 
	`ba£Çme
(
$»l
["T¬g‘"]è. ".»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

446 
$»lsWÜkbook
->
	`»gi¡”XP©hName¥aû
("rel", "http://schemas.openxmlformats.org/package/2006/relationships");

448 
$sh¬edSŒšgs
 = 
	`¬¿y
();

449 
$x·th
 = 
£lf
::
	`g‘A¼ayI‹m
(
$»lsWÜkbook
->
	`x·th
("rel:Relationship[@Type='http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings']"));

450 
$xmlSŒšgs
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "$dœ/$x·th[T¬g‘]")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

451 ià(
	`is£t
(
$xmlSŒšgs
è&& is£t($xmlSŒšgs->
si
)) {

452 
	`fÜ—ch
 (
$xmlSŒšgs
->
si
 
as
 
$v®
) {

453 ià(
	`is£t
(
$v®
->
t
)) {

454 
$sh¬edSŒšgs
[] = 
PHPExûl_Sh¬ed_SŒšg
::
	`CÚŒŞCh¬aù”OOXML2PHP
((
¡ršg
è
$v®
->
t
);

455 } 
	`–£if
 (
	`is£t
(
$v®
->
r
)) {

456 
$sh¬edSŒšgs
[] = 
$this
->
	`·r£RichText
(
$v®
);

461 
$wÜksh“ts
 = 
	`¬¿y
();

462 
$maüos
 = 
$cu¡omUI
 = 
nuÎ
;

463 
	`fÜ—ch
 (
$»lsWÜkbook
->
R–©iÚsh
 
as
 
$–e
) {

464 
$–e
['Type']) {

466 
$wÜksh“ts
[(
¡ršg
è
$–e
["Id"]] = $ele["Target"];

470 
$maüos
 = 
$–e
["Target"];

475 ià(!
	`is_nuÎ
(
$maüos
)) {

476 
$maüosCode
 = 
$this
->
	`g‘FromZArchive
(
$z
, 'xl/vbaProject.bin');

477 ià(
$maüosCode
 !=ğ
çl£
) {

478 
$exûl
->
	`£tMaüosCode
(
$maüosCode
);

479 
$exûl
->
	`£tHasMaüos
(
Œue
);

481 
$C”tifiÿ‹
 = 
$this
->
	`g‘FromZArchive
(
$z
, 'xl/vbaProjectSignature.bin');

482 ià(
$C”tifiÿ‹
 !=ğ
çl£
) {

483 
$exûl
->
	`£tMaüosC”tifiÿ‹
(
$C”tifiÿ‹
);

487 
$¡yËs
 = 
	`¬¿y
();

488 
$ûÎStyËs
 = 
	`¬¿y
();

489 
$x·th
 = 
£lf
::
	`g‘A¼ayI‹m
(
$»lsWÜkbook
->
	`x·th
("rel:Relationship[@Type='http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles']"));

490 
$xmlStyËs
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "$dœ/$x·th[T¬g‘]")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

493 
$numFmts
 = 
nuÎ
;

494 ià(
$xmlStyËs
 && $xmlStyËs->
numFmts
[0]) {

495 
$numFmts
 = 
$xmlStyËs
->
numFmts
[0];

497 ià(
	`is£t
(
$numFmts
è&& ($numFmt !=ğ
nuÎ
)) {

498 
$numFmts
->
	`»gi¡”XP©hName¥aû
("sml", "http://schemas.openxmlformats.org/spreadsheetml/2006/main");

500 ià(!
$this
->
»adD©aOÆy
 && 
$xmlStyËs
) {

501 
	`fÜ—ch
 (
$xmlStyËs
->
ûÎXfs
->
xf
 
as
 
$xf
) {

502 
$numFmt
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL
;

504 ià(
$xf
["numFmtId"]) {

505 ià(
	`is£t
(
$numFmts
)) {

506 
$tmpNumFmt
 = 
£lf
::
	`g‘A¼ayI‹m
(
$numFmts
->
	`x·th
("sml:numFmt[@numFmtId=$xf[numFmtId]]"));

508 ià(
	`is£t
(
$tmpNumFmt
["formatCode"])) {

509 
$numFmt
 = (
¡ršg
è
$tmpNumFmt
["formatCode"];

516 ià(()
$xf
["numFmtId"] < 164 && 
PHPExûl_StyË_Numb”FÜm©
::
	`butInFÜm©CodeIndex
(()$xf["numFmtId"]è!=ğ
çl£
) {

517 
$numFmt
 = 
PHPExûl_StyË_Numb”FÜm©
::
	`butInFÜm©Code
(()
$xf
["numFmtId"]);

520 
$quÙeP»fix
 = 
çl£
;

521 ià(
	`is£t
(
$xf
["quotePrefix"])) {

522 
$quÙeP»fix
 = (
boŞ—n
è
$xf
["quotePrefix"];

525 
$¡yË
 = (
objeù
è
	`¬¿y
(

526 "numFmt" => 
$numFmt
,

527 "fÚt" => 
$xmlStyËs
->
fÚts
->
fÚt
[
	`štv®
(
$xf
["fontId"])],

528 "fl" => 
$xmlStyËs
->
fls
->
fl
[
	`štv®
(
$xf
["fillId"])],

529 "bÜd”" => 
$xmlStyËs
->
bÜd”s
->
bÜd”
[
	`štv®
(
$xf
["borderId"])],

530 "®ignm’t" => 
$xf
->
®ignm’t
,

531 "´ÙeùiÚ" => 
$xf
->
´ÙeùiÚ
,

532 "quÙeP»fix" => 
$quÙeP»fix
,

534 
$¡yËs
[] = 
$¡yË
;

537 
$objStyË
 = 
Ãw
 
PHPExûl_StyË
;

538 
£lf
::
	`»adStyË
(
$objStyË
, 
$¡yË
);

539 
$exûl
->
	`addC–lXf
(
$objStyË
);

542 
	`fÜ—ch
 (
$xmlStyËs
->
ûÎStyËXfs
->
xf
 
as
 
$xf
) {

543 
$numFmt
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL
;

544 ià(
$numFmts
 && 
$xf
["numFmtId"]) {

545 
$tmpNumFmt
 = 
£lf
::
	`g‘A¼ayI‹m
(
$numFmts
->
	`x·th
("sml:numFmt[@numFmtId=$xf[numFmtId]]"));

546 ià(
	`is£t
(
$tmpNumFmt
["formatCode"])) {

547 
$numFmt
 = (
¡ršg
è
$tmpNumFmt
["formatCode"];

548 } 
	`–£if
 (()
$xf
["numFmtId"] < 165) {

549 
$numFmt
 = 
PHPExûl_StyË_Numb”FÜm©
::
	`butInFÜm©Code
(()
$xf
["numFmtId"]);

553 
$ûÎStyË
 = (
objeù
è
	`¬¿y
(

554 "numFmt" => 
$numFmt
,

555 "fÚt" => 
$xmlStyËs
->
fÚts
->
fÚt
[
	`štv®
(
$xf
["fontId"])],

556 "fl" => 
$xmlStyËs
->
fls
->
fl
[
	`štv®
(
$xf
["fillId"])],

557 "bÜd”" => 
$xmlStyËs
->
bÜd”s
->
bÜd”
[
	`štv®
(
$xf
["borderId"])],

558 "®ignm’t" => 
$xf
->
®ignm’t
,

559 "´ÙeùiÚ" => 
$xf
->
´ÙeùiÚ
,

560 "quÙeP»fix" => 
$quÙeP»fix
,

562 
$ûÎStyËs
[] = 
$ûÎStyË
;

565 
$objStyË
 = 
Ãw
 
PHPExûl_StyË
;

566 
£lf
::
	`»adStyË
(
$objStyË
, 
$ûÎStyË
);

567 
$exûl
->
	`addC–lStyËXf
(
$objStyË
);

571 
$dxfs
 = 
	`¬¿y
();

572 ià(!
$this
->
»adD©aOÆy
 && 
$xmlStyËs
) {

574 ià(
$xmlStyËs
->
dxfs
) {

575 
	`fÜ—ch
 (
$xmlStyËs
->
dxfs
->
dxf
 
as
 
$dxf
) {

576 
$¡yË
 = 
Ãw
 
	`PHPExûl_StyË
(
çl£
, 
Œue
);

577 
£lf
::
	`»adStyË
(
$¡yË
, 
$dxf
);

578 
$dxfs
[] = 
$¡yË
;

582 ià(
$xmlStyËs
->
ûÎStyËs
) {

583 
	`fÜ—ch
 (
$xmlStyËs
->
ûÎStyËs
->
ûÎStyË
 
as
 
$ûÎStyË
) {

584 ià(
	`štv®
(
$ûÎStyË
['builtinId']) == 0) {

585 ià(
	`is£t
(
$ûÎStyËs
[
	`štv®
(
$ûÎStyË
['xfId'])])) {

587 
$¡yË
 = 
Ãw
 
PHPExûl_StyË
;

588 
£lf
::
	`»adStyË
(
$¡yË
, 
$ûÎStyËs
[
	`štv®
(
$ûÎStyË
['xfId'])]);

597 
$xmlWÜkbook
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "{$»l['T¬g‘']}")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

600 ià(
$xmlWÜkbook
->
wÜkbookPr
) {

601 
PHPExûl_Sh¬ed_D©e
::
	`£tExûlC®’d¬
(PHPExûl_Sh¬ed_D©e::
CALENDAR_WINDOWS_1900
);

602 ià(
	`is£t
(
$xmlWÜkbook
->
wÜkbookPr
['date1904'])) {

603 ià(
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlWÜkbook
->
wÜkbookPr
['date1904'])) {

604 
PHPExûl_Sh¬ed_D©e
::
	`£tExûlC®’d¬
(PHPExûl_Sh¬ed_D©e::
CALENDAR_MAC_1904
);

609 
$sh“tId
 = 0;

610 
$ŞdSh“tId
 = -1;

611 
$couÁSk³dSh“ts
 = 0;

612 
$m­Sh“tId
 = 
	`¬¿y
();

614 
$ch¬ts
 = 
$ch¬tD‘as
 = 
	`¬¿y
();

616 ià(
$xmlWÜkbook
->
sh“ts
) {

617 
	`fÜ—ch
 (
$xmlWÜkbook
->
sh“ts
->
sh“t
 
as
 
$–eSh“t
) {

618 ++
$ŞdSh“tId
;

621 ià(
	`is£t
(
$this
->
lßdSh“tsOÆy
è&& !
	`š_¬¿y
((
¡ršg
è
$–eSh“t
["name"], $this->loadSheetsOnly)) {

622 ++
$couÁSk³dSh“ts
;

623 
$m­Sh“tId
[
$ŞdSh“tId
] = 
nuÎ
;

629 
$m­Sh“tId
[
$ŞdSh“tId
] = $ŞdSh“tId - 
$couÁSk³dSh“ts
;

632 
$docSh“t
 = 
$exûl
->
	`ü—‹Sh“t
();

637 
$docSh“t
->
	`£tT™Ë
((
¡ršg
è
$–eSh“t
["Çme"], 
çl£
);

638 
$feWÜksh“t
 = 
$wÜksh“ts
[(
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$–eSh“t
->
	`©Œibu‹s
("http://schemas.openxmlformats.org/officeDocument/2006/relationships"), "id")];

639 
$xmlSh“t
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "$dœ/$feWÜksh“t")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

641 
$sh¬edFÜmuÏs
 = 
	`¬¿y
();

643 ià(
	`is£t
(
$–eSh“t
["¡©e"]è&& (
¡ršg
) $eleSheet["state"] != '') {

644 
$docSh“t
->
	`£tSh“tS‹
((
¡ršg
è
$–eSh“t
["state"]);

647 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
è&& is£t($xmlSh“t->sh“tV›ws->
sh“tV›w
)) {

648 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['zoomScale'])) {

649 
$docSh“t
->
	`g‘Sh“tV›w
()->
	`£tZoomSÿË
(
	`štv®
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['zoomScale']));

651 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['zoomScaleNormal'])) {

652 
$docSh“t
->
	`g‘Sh“tV›w
()->
	`£tZoomSÿËNÜm®
(
	`štv®
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['zoomScaleNormal']));

654 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['view'])) {

655 
$docSh“t
->
	`g‘Sh“tV›w
()->
	`£tV›w
((
¡ršg
è
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['view']);

657 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['showGridLines'])) {

658 
$docSh“t
->
	`£tShowGridLšes
(
£lf
::
	`boŞ—n
((
¡ršg
)
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['showGridLines']));

660 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['showRowColHeaders'])) {

661 
$docSh“t
->
	`£tShowRowCŞH—d”s
(
£lf
::
	`boŞ—n
((
¡ršg
)
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['showRowColHeaders']));

663 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['rightToLeft'])) {

664 
$docSh“t
->
	`£tRightToLeá
(
£lf
::
	`boŞ—n
((
¡ršg
)
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
['rightToLeft']));

666 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
->
·Ã
)) {

667 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
->
·Ã
['topLeftCell'])) {

668 
$docSh“t
->
	`ä“zePªe
((
¡ršg
)
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
->
·Ã
['topLeftCell']);

670 
$xS¶™
 = 0;

671 
$yS¶™
 = 0;

673 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
->
·Ã
['xSplit'])) {

674 
$xS¶™
 = 1 + 
	`štv®
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
->
·Ã
['xSplit']);

677 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
->
·Ã
['ySplit'])) {

678 
$yS¶™
 = 1 + 
	`štv®
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
->
·Ã
['ySplit']);

681 
$docSh“t
->
	`ä“zePªeByCŞumnAndRow
(
$xS¶™
, 
$yS¶™
);

685 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
->
£ËùiÚ
)) {

686 ià(
	`is£t
(
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
->
£ËùiÚ
['sqref'])) {

687 
$sq»f
 = (
¡ršg
)
$xmlSh“t
->
sh“tV›ws
->
sh“tV›w
->
£ËùiÚ
['sqref'];

688 
$sq»f
 = 
	`ex¶ode
(' ', $sqref);

689 
$sq»f
 = $sqref[0];

690 
$docSh“t
->
	`£tS–eùedC–ls
(
$sq»f
);

695 ià(
	`is£t
(
$xmlSh“t
->
sh“tPr
è&& is£t($xmlSh“t->sh“tPr->
bCŞÜ
)) {

696 ià(
	`is£t
(
$xmlSh“t
->
sh“tPr
->
bCŞÜ
['rgb'])) {

697 
$docSh“t
->
	`g‘TabCŞÜ
()->
	`£tARGB
((
¡ršg
)
$xmlSh“t
->
sh“tPr
->
bCŞÜ
['rgb']);

700 ià(
	`is£t
(
$xmlSh“t
->
sh“tPr
) && isset($xmlSheet->sheetPr['codeName'])) {

701 
$docSh“t
->
	`£tCodeName
((
¡ršg
è
$xmlSh“t
->
sh“tPr
['codeName']);

703 ià(
	`is£t
(
$xmlSh“t
->
sh“tPr
è&& is£t($xmlSh“t->sh“tPr->
oušePr
)) {

704 ià(
	`is£t
(
$xmlSh“t
->
sh“tPr
->
oušePr
['summaryRight']) &&

705 !
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlSh“t
->
sh“tPr
->
oušePr
['summaryRight'])) {

706 
$docSh“t
->
	`£tShowSumm¬yRight
(
çl£
);

708 
$docSh“t
->
	`£tShowSumm¬yRight
(
Œue
);

711 ià(
	`is£t
(
$xmlSh“t
->
sh“tPr
->
oušePr
['summaryBelow']) &&

712 !
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlSh“t
->
sh“tPr
->
oušePr
['summaryBelow'])) {

713 
$docSh“t
->
	`£tShowSumm¬yB–ow
(
çl£
);

715 
$docSh“t
->
	`£tShowSumm¬yB–ow
(
Œue
);

719 ià(
	`is£t
(
$xmlSh“t
->
sh“tPr
è&& is£t($xmlSh“t->sh“tPr->
·geS‘UpPr
)) {

720 ià(
	`is£t
(
$xmlSh“t
->
sh“tPr
->
·geS‘UpPr
['fitToPage']) &&

721 !
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlSh“t
->
sh“tPr
->
·geS‘UpPr
['fitToPage'])) {

722 
$docSh“t
->
	`g‘PageS‘up
()->
	`£tF™ToPage
(
çl£
);

724 
$docSh“t
->
	`g‘PageS‘up
()->
	`£tF™ToPage
(
Œue
);

728 ià(
	`is£t
(
$xmlSh“t
->
sh“tFÜm©Pr
)) {

729 ià(
	`is£t
(
$xmlSh“t
->
sh“tFÜm©Pr
['customHeight']) &&

730 
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlSh“t
->
sh“tFÜm©Pr
['customHeight']) &&

731 
	`is£t
(
$xmlSh“t
->
sh“tFÜm©Pr
['defaultRowHeight'])) {

732 
$docSh“t
->
	`g‘DeçuÉRowDim’siÚ
()->
	`£tRowHeight
(()
$xmlSh“t
->
sh“tFÜm©Pr
['defaultRowHeight']);

734 ià(
	`is£t
(
$xmlSh“t
->
sh“tFÜm©Pr
['defaultColWidth'])) {

735 
$docSh“t
->
	`g‘DeçuÉCŞumnDim’siÚ
()->
	`£tWidth
(()
$xmlSh“t
->
sh“tFÜm©Pr
['defaultColWidth']);

737 ià(
	`is£t
(
$xmlSh“t
->
sh“tFÜm©Pr
['zeroHeight']) &&

738 ((
¡ršg
)
$xmlSh“t
->
sh“tFÜm©Pr
['zeroHeight'] == '1')) {

739 
$docSh“t
->
	`g‘DeçuÉRowDim’siÚ
()->
	`£tZ”oHeight
(
Œue
);

743 ià(
	`is£t
(
$xmlSh“t
->
cŞs
è&& !
$this
->
»adD©aOÆy
) {

744 
	`fÜ—ch
 (
$xmlSh“t
->
cŞs
->
cŞ
 
as
 
$cŞ
) {

745 
$i
 = 
	`štv®
(
$cŞ
["min"]) - 1; $i < intval($col["max"]); ++$i) {

746 ià(
$cŞ
["¡yË"] && !
$this
->
»adD©aOÆy
) {

747 
$docSh“t
->
	`g‘CŞumnDim’siÚ
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$i
))->
	`£tXfIndex
(
	`štv®
(
$cŞ
["style"]));

749 ià(
£lf
::
	`boŞ—n
(
$cŞ
["bestFit"])) {

752 ià(
£lf
::
	`boŞ—n
(
$cŞ
["hidden"])) {

754 
$docSh“t
->
	`g‘CŞumnDim’siÚ
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$i
))->
	`£tVisibË
(
çl£
);

756 ià(
£lf
::
	`boŞ—n
(
$cŞ
["collapsed"])) {

757 
$docSh“t
->
	`g‘CŞumnDim’siÚ
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$i
))->
	`£tCŞÏp£d
(
Œue
);

759 ià(
$cŞ
["outlineLevel"] > 0) {

760 
$docSh“t
->
	`g‘CŞumnDim’siÚ
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$i
))->
	`£tOušeLev–
(
	`štv®
(
$cŞ
["outlineLevel"]));

762 
$docSh“t
->
	`g‘CŞumnDim’siÚ
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$i
))->
	`£tWidth
(
	`æßtv®
(
$cŞ
["width"]));

764 ià(
	`štv®
(
$cŞ
["max"]) == 16384) {

771 ià(
	`is£t
(
$xmlSh“t
->
´štO±iÚs
è&& !
$this
->
»adD©aOÆy
) {

772 ià(
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlSh“t
->
´štO±iÚs
['gridLinesSet'])) {

773 
$docSh“t
->
	`£tShowGridlšes
(
Œue
);

775 ià(
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlSh“t
->
´štO±iÚs
['gridLines'])) {

776 
$docSh“t
->
	`£tPrštGridlšes
(
Œue
);

778 ià(
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlSh“t
->
´štO±iÚs
['horizontalCentered'])) {

779 
$docSh“t
->
	`g‘PageS‘up
()->
	`£tHÜizÚlC’‹»d
(
Œue
);

781 ià(
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlSh“t
->
´štO±iÚs
['verticalCentered'])) {

782 
$docSh“t
->
	`g‘PageS‘up
()->
	`£tV”tiÿlC’‹»d
(
Œue
);

786 ià(
$xmlSh“t
 && $xmlSh“t->
sh“tD©a
 && $xmlSh“t->sh“tD©a->
row
) {

787 
	`fÜ—ch
 (
$xmlSh“t
->
sh“tD©a
->
row
 
as
 
$row
) {

788 ià(
$row
["ht"] && !
$this
->
»adD©aOÆy
) {

789 
$docSh“t
->
	`g‘RowDim’siÚ
(
	`štv®
(
$row
["r"]))->
	`£tRowHeight
(
	`æßtv®
($row["ht"]));

791 ià(
£lf
::
	`boŞ—n
(
$row
["hidd’"]è&& !
$this
->
»adD©aOÆy
) {

792 
$docSh“t
->
	`g‘RowDim’siÚ
(
	`štv®
(
$row
["r"]))->
	`£tVisibË
(
çl£
);

794 ià(
£lf
::
	`boŞ—n
(
$row
["collapsed"])) {

795 
$docSh“t
->
	`g‘RowDim’siÚ
(
	`štv®
(
$row
["r"]))->
	`£tCŞÏp£d
(
Œue
);

797 ià(
$row
["outlineLevel"] > 0) {

798 
$docSh“t
->
	`g‘RowDim’siÚ
(
	`štv®
(
$row
["r"]))->
	`£tOušeLev–
(intval($row["outlineLevel"]));

800 ià(
$row
["s"] && !
$this
->
»adD©aOÆy
) {

801 
$docSh“t
->
	`g‘RowDim’siÚ
(
	`štv®
(
$row
["r"]))->
	`£tXfIndex
(intval($row["s"]));

804 
	`fÜ—ch
 (
$row
->
c
 
as
 
$c
) {

805 
$r
 = (
¡ršg
è
$c
["r"];

806 
$ûÎD©aTy³
 = (
¡ršg
è
$c
["t"];

807 
$v®ue
 = 
nuÎ
;

808 
$ÿlcuÏ‹dV®ue
 = 
nuÎ
;

811 ià(
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
) {

812 
$coÜdš©es
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$r
);

814 ià(!
$this
->
	`g‘R—dF‹r
()->
	`»adC–l
(
$coÜdš©es
[0], $coÜdš©es[1], 
$docSh“t
->
	`g‘T™Ë
())) {

825 
$ûÎD©aTy³
) {

828 ià((
¡ršg
)
$c
->
v
 != '') {

829 
$v®ue
 = 
$sh¬edSŒšgs
[
	`štv®
(
$c
->
v
)];

831 ià(
$v®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

832 
$v®ue
 = 
şÚe
 $value;

835 
$v®ue
 = '';

840 ià(!
	`is£t
(
$c
->
f
)) {

841 
$v®ue
 = 
£lf
::
	`ÿ¡ToBoŞ—n
(
$c
);

844 
$this
->
	`ÿ¡ToFÜmuÏ
(
$c
, 
$r
, 
$ûÎD©aTy³
, 
$v®ue
, 
$ÿlcuÏ‹dV®ue
, 
$sh¬edFÜmuÏs
, 'castToBoolean');

845 ià(
	`is£t
(
$c
->
f
['t'])) {

846 
$©t
 = 
	`¬¿y
();

847 
$©t
 = 
$c
->
f
;

848 
$docSh“t
->
	`g‘C–l
(
$r
)->
	`£tFÜmuÏA‰ribu‹s
(
$©t
);

855 ià(
	`is£t
(
$c
->
f
)) {

856 
$this
->
	`ÿ¡ToFÜmuÏ
(
$c
, 
$r
, 
$ûÎD©aTy³
, 
$v®ue
, 
$ÿlcuÏ‹dV®ue
, 
$sh¬edFÜmuÏs
, 'castToError');

858 
$v®ue
 = 
$this
->
	`·r£RichText
(
$c
->
is
);

863 ià(!
	`is£t
(
$c
->
f
)) {

864 
$v®ue
 = 
£lf
::
	`ÿ¡ToE¼Ü
(
$c
);

867 
$this
->
	`ÿ¡ToFÜmuÏ
(
$c
, 
$r
, 
$ûÎD©aTy³
, 
$v®ue
, 
$ÿlcuÏ‹dV®ue
, 
$sh¬edFÜmuÏs
, 'castToError');

873 ià(!
	`is£t
(
$c
->
f
)) {

875 
$v®ue
 = 
£lf
::
	`ÿ¡ToSŒšg
(
$c
);

879 
$this
->
	`ÿ¡ToFÜmuÏ
(
$c
, 
$r
, 
$ûÎD©aTy³
, 
$v®ue
, 
$ÿlcuÏ‹dV®ue
, 
$sh¬edFÜmuÏs
, 'castToString');

887 ià(
	`is_num”ic
(
$v®ue
è&& 
$ûÎD©aTy³
 != 's') {

888 ià(
$v®ue
 == ()$value) {

889 
$v®ue
 = ()$value;

890 } 
	`–£if
 (
$v®ue
 == ()$value) {

891 
$v®ue
 = ()$value;

892 } 
	`–£if
 (
$v®ue
 == ()$value) {

893 
$v®ue
 = ()$value;

898 ià(
$v®ue
 
š¡ªûof
 
PHPExûl_RichText
 && 
$this
->
»adD©aOÆy
) {

899 
$v®ue
 = $v®ue->
	`g‘PÏšText
();

902 
$ûÎ
 = 
$docSh“t
->
	`g‘C–l
(
$r
);

904 ià(
$ûÎD©aTy³
 != '') {

905 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
$ûÎD©aTy³
);

907 
$ûÎ
->
	`£tV®ue
(
$v®ue
);

909 ià(
$ÿlcuÏ‹dV®ue
 !=ğ
nuÎ
) {

910 
$ûÎ
->
	`£tC®cuÏ‹dV®ue
(
$ÿlcuÏ‹dV®ue
);

914 ià(
$c
["s"] && !
$this
->
»adD©aOÆy
) {

916 
$ûÎ
->
	`£tXfIndex
(
	`is£t
(
$¡yËs
[
	`štv®
(
$c
["s"])]) ?

917 
	`štv®
(
$c
["s"]) : 0);

923 
$cÚd™iÚ®s
 = 
	`¬¿y
();

924 ià(!
$this
->
»adD©aOÆy
 && 
$xmlSh“t
 && $xmlSh“t->
cÚd™iÚ®FÜm©tšg
) {

925 
	`fÜ—ch
 (
$xmlSh“t
->
cÚd™iÚ®FÜm©tšg
 
as
 
$cÚd™iÚ®
) {

926 
	`fÜ—ch
 (
$cÚd™iÚ®
->
cfRuË
 
as
 
$cfRuË
) {

927 ià(((
¡ršg
)
$cfRuË
["ty³"] =ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_NONE
 || (¡ršg)$cfRuË["ty³"] =ğPHPExûl_StyË_CÚd™iÚ®::
CONDITION_CELLIS
 || (¡ršg)$cfRuË["ty³"] =ğPHPExûl_StyË_CÚd™iÚ®::
CONDITION_CONTAINSTEXT
 || (¡ršg)$cfRuË["ty³"] =ğPHPExûl_StyË_CÚd™iÚ®::
CONDITION_EXPRESSION
è&& 
	`is£t
(
$dxfs
[
	`štv®
($cfRule["dxfId"])])) {

928 
$cÚd™iÚ®s
[(
¡ršg
è
$cÚd™iÚ®
["sq»f"]][
	`štv®
(
$cfRuË
["priority"])] = $cfRule;

933 
	`fÜ—ch
 (
$cÚd™iÚ®s
 
as
 
$»f
 => 
$cfRuËs
) {

934 
	`ksÜt
(
$cfRuËs
);

935 
$cÚd™iÚ®StyËs
 = 
	`¬¿y
();

936 
	`fÜ—ch
 (
$cfRuËs
 
as
 
$cfRuË
) {

937 
$objCÚd™iÚ®
 = 
Ãw
 
	`PHPExûl_StyË_CÚd™iÚ®
();

938 
$objCÚd™iÚ®
->
	`£tCÚd™iÚTy³
((
¡ršg
)
$cfRuË
["type"]);

939 
$objCÚd™iÚ®
->
	`£tO³¿tÜTy³
((
¡ršg
)
$cfRuË
["operator"]);

941 ià((
¡ršg
)
$cfRuË
["text"] != '') {

942 
$objCÚd™iÚ®
->
	`£tText
((
¡ršg
)
$cfRuË
["text"]);

945 ià(
	`couÁ
(
$cfRuË
->
fÜmuÏ
) > 1) {

946 
	`fÜ—ch
 (
$cfRuË
->
fÜmuÏ
 
as
 
$fÜmuÏ
) {

947 
$objCÚd™iÚ®
->
	`addCÚd™iÚ
((
¡ršg
)
$fÜmuÏ
);

950 
$objCÚd™iÚ®
->
	`addCÚd™iÚ
((
¡ršg
)
$cfRuË
->
fÜmuÏ
);

952 
$objCÚd™iÚ®
->
	`£tStyË
(
şÚe
 
$dxfs
[
	`štv®
(
$cfRuË
["dxfId"])]);

953 
$cÚd™iÚ®StyËs
[] = 
$objCÚd™iÚ®
;

957 
	`fÜ—ch
 (
PHPExûl_C–l
::
	`exŒaùAÎC–lReã»nûsInRªge
(
$»f
è
as
 
$»ã»nû
) {

958 
$docSh“t
->
	`g‘StyË
(
$»ã»nû
)->
	`£tCÚd™iÚ®StyËs
(
$cÚd™iÚ®StyËs
);

963 
$aKeys
 = 
	`¬¿y
("sheet", "objects", "scenarios", "formatCells", "formatColumns", "formatRows", "insertColumns", "insertRows", "insertHyperlinks", "deleteColumns", "deleteRows", "selectLockedCells", "sort", "autoFilter", "pivotTables", "selectUnlockedCells");

964 ià(!
$this
->
»adD©aOÆy
 && 
$xmlSh“t
 && $xmlSh“t->
sh“tPrÙeùiÚ
) {

965 
	`fÜ—ch
 (
$aKeys
 
as
 
$key
) {

966 
$m‘hod
 = "£t" . 
	`ucfœ¡
(
$key
);

967 
$docSh“t
->
	`g‘PrÙeùiÚ
()->
	`$m‘hod
(
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlSh“t
->
sh“tPrÙeùiÚ
[
$key
]));

971 ià(!
$this
->
»adD©aOÆy
 && 
$xmlSh“t
 && $xmlSh“t->
sh“tPrÙeùiÚ
) {

972 
$docSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tPasswÜd
((
¡ršg
è
$xmlSh“t
->
sh“tPrÙeùiÚ
["·sswÜd"], 
Œue
);

973 ià(
$xmlSh“t
->
´ÙeùedRªges
->
´ÙeùedRªge
) {

974 
	`fÜ—ch
 (
$xmlSh“t
->
´ÙeùedRªges
->
´ÙeùedRªge
 
as
 
$´ÙeùedRªge
) {

975 
$docSh“t
->
	`´ÙeùC–ls
((
¡ršg
è
$´ÙeùedRªge
["sq»f"], (¡ršgè$´ÙeùedRªge["·sswÜd"], 
Œue
);

980 ià(
$xmlSh“t
 && $xmlSh“t->
autoF‹r
 && !
$this
->
»adD©aOÆy
) {

981 
$autoF‹rRªge
 = (
¡ršg
è
$xmlSh“t
->
autoF‹r
["ref"];

982 ià(
	`¡½os
(
$autoF‹rRªge
, ':'è!=ğ
çl£
) {

983 
$autoF‹r
 = 
$docSh“t
->
	`g‘AutoF‹r
();

984 
$autoF‹r
->
	`£tRªge
(
$autoF‹rRªge
);

986 
	`fÜ—ch
 (
$xmlSh“t
->
autoF‹r
->
f‹rCŞumn
 
as
 
$f‹rCŞumn
) {

987 
$cŞumn
 = 
$autoF‹r
->
	`g‘CŞumnByOff£t
((
š‹g”
è
$f‹rCŞumn
["colId"]);

989 ià(
$f‹rCŞumn
->
f‹rs
) {

990 
$cŞumn
->
	`£tF‹rTy³
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_FILTERTYPE_FILTER
);

991 
$f‹rs
 = 
$f‹rCŞumn
->
f‹rs
;

992 ià((
	`is£t
(
$f‹rs
["blank"])) && ($filters["blank"] == 1)) {

994 
$cŞumn
->
	`ü—‹RuË
()->
	`£tRuË
(
nuÎ
, '')->
	`£tRuËTy³
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_FILTER
);

998 
	`fÜ—ch
 (
$f‹rs
->
f‹r
 
as
 
$f‹rRuË
) {

1000 
$cŞumn
->
	`ü—‹RuË
()->
	`£tRuË
(
nuÎ
, (
¡ršg
è
$f‹rRuË
["v®"])->
	`£tRuËTy³
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_FILTER
);

1003 
	`fÜ—ch
 (
$f‹rs
->
d©eGroupI‹m
 
as
 
$d©eGroupI‹m
) {

1004 
$cŞumn
->
	`ü—‹RuË
()->
	`£tRuË
(

1006 
nuÎ
,

1007 
	`¬¿y
(

1008 'y—r' => (
¡ršg
è
$d©eGroupI‹m
["year"],

1009 'mÚth' => (
¡ršg
è
$d©eGroupI‹m
["month"],

1010 'day' => (
¡ršg
è
$d©eGroupI‹m
["day"],

1011 'hour' => (
¡ršg
è
$d©eGroupI‹m
["hour"],

1012 'mšu‹' => (
¡ršg
è
$d©eGroupI‹m
["minute"],

1013 '£cÚd' => (
¡ršg
è
$d©eGroupI‹m
["second"],

1015 (
¡ršg
è
$d©eGroupI‹m
["dateTimeGrouping"]

1017 ->
	`£tRuËTy³
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP
);

1021 ià(
$f‹rCŞumn
->
cu¡omF‹rs
) {

1022 
$cŞumn
->
	`£tF‹rTy³
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_FILTERTYPE_CUSTOMFILTER
);

1023 
$cu¡omF‹rs
 = 
$f‹rCŞumn
->
cu¡omF‹rs
;

1026 ià((
	`is£t
(
$cu¡omF‹rs
["and"])) && ($customFilters["and"] == 1)) {

1027 
$cŞumn
->
	`£tJoš
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_COLUMN_JOIN_AND
);

1029 
	`fÜ—ch
 (
$cu¡omF‹rs
->
cu¡omF‹r
 
as
 
$f‹rRuË
) {

1030 
$cŞumn
->
	`ü—‹RuË
()->
	`£tRuË
(

1031 (
¡ršg
è
$f‹rRuË
["operator"],

1032 (
¡ršg
è
$f‹rRuË
["val"]

1034 ->
	`£tRuËTy³
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_CUSTOMFILTER
);

1038 ià(
$f‹rCŞumn
->
dyÇmicF‹r
) {

1039 
$cŞumn
->
	`£tF‹rTy³
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_FILTERTYPE_DYNAMICFILTER
);

1041 
	`fÜ—ch
 (
$f‹rCŞumn
->
dyÇmicF‹r
 
as
 
$f‹rRuË
) {

1042 
$cŞumn
->
	`ü—‹RuË
()->
	`£tRuË
(

1044 
nuÎ
,

1045 (
¡ršg
è
$f‹rRuË
["val"],

1046 (
¡ršg
è
$f‹rRuË
["type"]

1048 ->
	`£tRuËTy³
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMICFILTER
);

1049 ià(
	`is£t
(
$f‹rRuË
["val"])) {

1050 
$cŞumn
->
	`£tA‰ribu‹
('v®', (
¡ršg
è
$f‹rRuË
["val"]);

1052 ià(
	`is£t
(
$f‹rRuË
["maxVal"])) {

1053 
$cŞumn
->
	`£tA‰ribu‹
('maxV®', (
¡ršg
è
$f‹rRuË
["maxVal"]);

1058 ià(
$f‹rCŞumn
->
tİ10
) {

1059 
$cŞumn
->
	`£tF‹rTy³
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_FILTERTYPE_TOPTENFILTER
);

1061 
	`fÜ—ch
 (
$f‹rCŞumn
->
tİ10
 
as
 
$f‹rRuË
) {

1062 
$cŞumn
->
	`ü—‹RuË
()->
	`£tRuË
(

1063 (((
	`is£t
(
$f‹rRuË
["percent"])) && ($filterRule["percent"] == 1))

1064 ? 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_TOPTEN_PERCENT


1065 : 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_TOPTEN_BY_VALUE


1067 (
¡ršg
è
$f‹rRuË
["val"],

1068 (((
	`is£t
(
$f‹rRuË
["top"])) && ($filterRule["top"] == 1))

1069 ? 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_TOPTEN_TOP


1070 : 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_TOPTEN_BOTTOM


1073 ->
	`£tRuËTy³
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_TOPTENFILTER
);

1080 ià(
$xmlSh“t
 && $xmlSh“t->
m”geC–ls
 && $xmlSh“t->m”geC–ls->
m”geC–l
 && !
$this
->
»adD©aOÆy
) {

1081 
	`fÜ—ch
 (
$xmlSh“t
->
m”geC–ls
->
m”geC–l
 
as
 
$m”geC–l
) {

1082 
$m”geRef
 = (
¡ršg
è
$m”geC–l
["ref"];

1083 ià(
	`¡½os
(
$m”geRef
, ':'è!=ğ
çl£
) {

1084 
$docSh“t
->
	`m”geC–ls
((
¡ršg
è
$m”geC–l
["ref"]);

1089 ià(
$xmlSh“t
 && $xmlSh“t->
·geM¬gšs
 && !
$this
->
»adD©aOÆy
) {

1090 
$docPageM¬gšs
 = 
$docSh“t
->
	`g‘PageM¬gšs
();

1091 
$docPageM¬gšs
->
	`£tLeá
(
	`æßtv®
(
$xmlSh“t
->
·geM¬gšs
["left"]));

1092 
$docPageM¬gšs
->
	`£tRight
(
	`æßtv®
(
$xmlSh“t
->
·geM¬gšs
["right"]));

1093 
$docPageM¬gšs
->
	`£tTİ
(
	`æßtv®
(
$xmlSh“t
->
·geM¬gšs
["top"]));

1094 
$docPageM¬gšs
->
	`£tBÙtom
(
	`æßtv®
(
$xmlSh“t
->
·geM¬gšs
["bottom"]));

1095 
$docPageM¬gšs
->
	`£tH—d”
(
	`æßtv®
(
$xmlSh“t
->
·geM¬gšs
["header"]));

1096 
$docPageM¬gšs
->
	`£tFoÙ”
(
	`æßtv®
(
$xmlSh“t
->
·geM¬gšs
["footer"]));

1099 ià(
$xmlSh“t
 && $xmlSh“t->
·geS‘up
 && !
$this
->
»adD©aOÆy
) {

1100 
$docPageS‘up
 = 
$docSh“t
->
	`g‘PageS‘up
();

1102 ià(
	`is£t
(
$xmlSh“t
->
·geS‘up
["orientation"])) {

1103 
$docPageS‘up
->
	`£tOr›Á©iÚ
((
¡ršg
è
$xmlSh“t
->
·geS‘up
["orientation"]);

1105 ià(
	`is£t
(
$xmlSh“t
->
·geS‘up
["paperSize"])) {

1106 
$docPageS‘up
->
	`£tP­”Size
(
	`štv®
(
$xmlSh“t
->
·geS‘up
["paperSize"]));

1108 ià(
	`is£t
(
$xmlSh“t
->
·geS‘up
["scale"])) {

1109 
$docPageS‘up
->
	`£tSÿË
(
	`štv®
(
$xmlSh“t
->
·geS‘up
["sÿË"]), 
çl£
);

1111 ià(
	`is£t
(
$xmlSh“t
->
·geS‘up
["f™ToHeight"]è&& 
	`štv®
($xmlSheet->pageSetup["fitToHeight"]) >= 0) {

1112 
$docPageS‘up
->
	`£tF™ToHeight
(
	`štv®
(
$xmlSh“t
->
·geS‘up
["f™ToHeight"]), 
çl£
);

1114 ià(
	`is£t
(
$xmlSh“t
->
·geS‘up
["f™ToWidth"]è&& 
	`štv®
($xmlSheet->pageSetup["fitToWidth"]) >= 0) {

1115 
$docPageS‘up
->
	`£tF™ToWidth
(
	`štv®
(
$xmlSh“t
->
·geS‘up
["f™ToWidth"]), 
çl£
);

1117 ià(
	`is£t
(
$xmlSh“t
->
·geS‘up
["firstPageNumber"]) && isset($xmlSheet->pageSetup["useFirstPageNumber"]) &&

1118 
£lf
::
	`boŞ—n
((
¡ršg
è
$xmlSh“t
->
·geS‘up
["useFirstPageNumber"])) {

1119 
$docPageS‘up
->
	`£tFœ¡PageNumb”
(
	`štv®
(
$xmlSh“t
->
·geS‘up
["firstPageNumber"]));

1123 ià(
$xmlSh“t
 && $xmlSh“t->
h—d”FoÙ”
 && !
$this
->
»adD©aOÆy
) {

1124 
$docH—d”FoÙ”
 = 
$docSh“t
->
	`g‘H—d”FoÙ”
();

1126 ià(
	`is£t
(
$xmlSh“t
->
h—d”FoÙ”
["differentOddEven"]) &&

1127 
£lf
::
	`boŞ—n
((
¡ršg
)
$xmlSh“t
->
h—d”FoÙ”
["differentOddEven"])) {

1128 
$docH—d”FoÙ”
->
	`£tDifã»ÁOddEv’
(
Œue
);

1130 
$docH—d”FoÙ”
->
	`£tDifã»ÁOddEv’
(
çl£
);

1132 ià(
	`is£t
(
$xmlSh“t
->
h—d”FoÙ”
["differentFirst"]) &&

1133 
£lf
::
	`boŞ—n
((
¡ršg
)
$xmlSh“t
->
h—d”FoÙ”
["differentFirst"])) {

1134 
$docH—d”FoÙ”
->
	`£tDifã»ÁFœ¡
(
Œue
);

1136 
$docH—d”FoÙ”
->
	`£tDifã»ÁFœ¡
(
çl£
);

1138 ià(
	`is£t
(
$xmlSh“t
->
h—d”FoÙ”
["scaleWithDoc"]) &&

1139 !
£lf
::
	`boŞ—n
((
¡ršg
)
$xmlSh“t
->
h—d”FoÙ”
["scaleWithDoc"])) {

1140 
$docH—d”FoÙ”
->
	`£tSÿËW™hDocum’t
(
çl£
);

1142 
$docH—d”FoÙ”
->
	`£tSÿËW™hDocum’t
(
Œue
);

1144 ià(
	`is£t
(
$xmlSh“t
->
h—d”FoÙ”
["alignWithMargins"]) &&

1145 !
£lf
::
	`boŞ—n
((
¡ršg
)
$xmlSh“t
->
h—d”FoÙ”
["alignWithMargins"])) {

1146 
$docH—d”FoÙ”
->
	`£tAlignW™hM¬gšs
(
çl£
);

1148 
$docH—d”FoÙ”
->
	`£tAlignW™hM¬gšs
(
Œue
);

1151 
$docH—d”FoÙ”
->
	`£tOddH—d”
((
¡ršg
è
$xmlSh“t
->
h—d”FoÙ”
->
oddH—d”
);

1152 
$docH—d”FoÙ”
->
	`£tOddFoÙ”
((
¡ršg
è
$xmlSh“t
->
h—d”FoÙ”
->
oddFoÙ”
);

1153 
$docH—d”FoÙ”
->
	`£tEv’H—d”
((
¡ršg
è
$xmlSh“t
->
h—d”FoÙ”
->
ev’H—d”
);

1154 
$docH—d”FoÙ”
->
	`£tEv’FoÙ”
((
¡ršg
è
$xmlSh“t
->
h—d”FoÙ”
->
ev’FoÙ”
);

1155 
$docH—d”FoÙ”
->
	`£tFœ¡H—d”
((
¡ršg
è
$xmlSh“t
->
h—d”FoÙ”
->
fœ¡H—d”
);

1156 
$docH—d”FoÙ”
->
	`£tFœ¡FoÙ”
((
¡ršg
è
$xmlSh“t
->
h—d”FoÙ”
->
fœ¡FoÙ”
);

1159 ià(
$xmlSh“t
 && $xmlSh“t->
rowB»aks
 && $xmlSh“t->rowB»aks->
brk
 && !
$this
->
»adD©aOÆy
) {

1160 
	`fÜ—ch
 (
$xmlSh“t
->
rowB»aks
->
brk
 
as
 
$brk
) {

1161 ià(
$brk
["man"]) {

1162 
$docSh“t
->
	`£tB»ak
("A$brk[id]", 
PHPExûl_WÜksh“t
::
BREAK_ROW
);

1166 ià(
$xmlSh“t
 && $xmlSh“t->
cŞB»aks
 && $xmlSh“t->cŞB»aks->
brk
 && !
$this
->
»adD©aOÆy
) {

1167 
	`fÜ—ch
 (
$xmlSh“t
->
cŞB»aks
->
brk
 
as
 
$brk
) {

1168 ià(
$brk
["man"]) {

1169 
$docSh“t
->
	`£tB»ak
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
((
¡ršg
è
$brk
["id"]è. "1", 
PHPExûl_WÜksh“t
::
BREAK_COLUMN
);

1174 ià(
$xmlSh“t
 && $xmlSh“t->
d©aV®id©iÚs
 && !
$this
->
»adD©aOÆy
) {

1175 
	`fÜ—ch
 (
$xmlSh“t
->
d©aV®id©iÚs
->
d©aV®id©iÚ
 
as
 
$d©aV®id©iÚ
) {

1177 
$¿nge
 = 
	`¡¹ouµ”
(
$d©aV®id©iÚ
["sqref"]);

1178 
$¿ngeS‘
 = 
	`ex¶ode
(' ', 
$¿nge
);

1179 
	`fÜ—ch
 (
$¿ngeS‘
 
as
 
$¿nge
) {

1180 
$¡Rªge
 = 
$docSh“t
->
	`shrškRªgeToF™
(
$¿nge
);

1183 
	`fÜ—ch
 (
PHPExûl_C–l
::
	`exŒaùAÎC–lReã»nûsInRªge
(
$¡Rªge
è
as
 
$»ã»nû
) {

1185 
$docV®id©iÚ
 = 
$docSh“t
->
	`g‘C–l
(
$»ã»nû
)->
	`g‘D©aV®id©iÚ
();

1186 
$docV®id©iÚ
->
	`£tTy³
((
¡ršg
è
$d©aV®id©iÚ
["type"]);

1187 
$docV®id©iÚ
->
	`£tE¼ÜStyË
((
¡ršg
è
$d©aV®id©iÚ
["errorStyle"]);

1188 
$docV®id©iÚ
->
	`£tO³¿tÜ
((
¡ršg
è
$d©aV®id©iÚ
["operator"]);

1189 
$docV®id©iÚ
->
	`£tAÎowBÏnk
(
$d©aV®id©iÚ
["allowBlank"] != 0);

1190 
$docV®id©iÚ
->
	`£tShowDrİDown
(
$d©aV®id©iÚ
["showDropDown"] == 0);

1191 
$docV®id©iÚ
->
	`£tShowIÅutMes§ge
(
$d©aV®id©iÚ
["showInputMessage"] != 0);

1192 
$docV®id©iÚ
->
	`£tShowE¼ÜMes§ge
(
$d©aV®id©iÚ
["showErrorMessage"] != 0);

1193 
$docV®id©iÚ
->
	`£tE¼ÜT™Ë
((
¡ršg
è
$d©aV®id©iÚ
["errorTitle"]);

1194 
$docV®id©iÚ
->
	`£tE¼Ü
((
¡ršg
è
$d©aV®id©iÚ
["error"]);

1195 
$docV®id©iÚ
->
	`£tProm±T™Ë
((
¡ršg
è
$d©aV®id©iÚ
["promptTitle"]);

1196 
$docV®id©iÚ
->
	`£tProm±
((
¡ršg
è
$d©aV®id©iÚ
["prompt"]);

1197 
$docV®id©iÚ
->
	`£tFÜmuÏ1
((
¡ršg
è
$d©aV®id©iÚ
->
fÜmuÏ1
);

1198 
$docV®id©iÚ
->
	`£tFÜmuÏ2
((
¡ršg
è
$d©aV®id©iÚ
->
fÜmuÏ2
);

1205 
$hy³¾šks
 = 
	`¬¿y
();

1206 ià(!
$this
->
»adD©aOÆy
) {

1208 ià(
$z
->
	`loÿ‹Name
(
	`dœÇme
("$dœ/$feWÜksh“t"è. "/_»ls/" . 
	`ba£Çme
(
$feWÜksh“t
) . ".rels")) {

1209 
$»lsWÜksh“t
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
	`dœÇme
("$dœ/$feWÜksh“t"è. "/_»ls/" . 
	`ba£Çme
(
$feWÜksh“t
è. ".»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1210 
	`fÜ—ch
 (
$»lsWÜksh“t
->
R–©iÚsh
 
as
 
$–e
) {

1211 ià(
$–e
["Type"] == "http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink") {

1212 
$hy³¾šks
[(
¡ršg
)
$–e
["Id"]] = (string)$ele["Target"];

1218 ià(
$xmlSh“t
 && $xmlSh“t->
hy³¾šks
) {

1219 
	`fÜ—ch
 (
$xmlSh“t
->
hy³¾šks
->
hy³¾šk
 
as
 
$hy³¾šk
) {

1221 
$lškR–
 = 
$hy³¾šk
->
	`©Œibu‹s
('http://schemas.openxmlformats.org/officeDocument/2006/relationships');

1223 
	`fÜ—ch
 (
PHPExûl_C–l
::
	`exŒaùAÎC–lReã»nûsInRªge
(
$hy³¾šk
['»f']è
as
 
$ûÎReã»nû
) {

1224 
$ûÎ
 = 
$docSh“t
->
	`g‘C–l
(
$ûÎReã»nû
);

1225 ià(
	`is£t
(
$lškR–
['id'])) {

1226 
$hy³¾škU¾
 = 
$hy³¾šks
[ (
¡ršg
)
$lškR–
['id'] ];

1227 ià(
	`is£t
(
$hy³¾šk
['location'])) {

1228 
$hy³¾škU¾
 .ğ'#' . (
¡ršg
è
$hy³¾šk
['location'];

1230 
$ûÎ
->
	`g‘Hy³¾šk
()->
	`£tU¾
(
$hy³¾škU¾
);

1231 } 
	`–£if
 (
	`is£t
(
$hy³¾šk
['location'])) {

1232 
$ûÎ
->
	`g‘Hy³¾šk
()->
	`£tU¾
('sh“t://' . (
¡ršg
)
$hy³¾šk
['location']);

1236 ià(
	`is£t
(
$hy³¾šk
['tooltip'])) {

1237 
$ûÎ
->
	`g‘Hy³¾šk
()->
	`£tToŞt
((
¡ršg
)
$hy³¾šk
['tooltip']);

1245 
$comm’ts
 = 
	`¬¿y
();

1246 
$vmlComm’ts
 = 
	`¬¿y
();

1247 ià(!
$this
->
»adD©aOÆy
) {

1249 ià(
$z
->
	`loÿ‹Name
(
	`dœÇme
("$dœ/$feWÜksh“t"è. "/_»ls/" . 
	`ba£Çme
(
$feWÜksh“t
) . ".rels")) {

1250 
$»lsWÜksh“t
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
	`dœÇme
("$dœ/$feWÜksh“t"è. "/_»ls/" . 
	`ba£Çme
(
$feWÜksh“t
è. ".»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1251 
	`fÜ—ch
 (
$»lsWÜksh“t
->
R–©iÚsh
 
as
 
$–e
) {

1252 ià(
$–e
["Type"] == "http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments") {

1253 
$comm’ts
[(
¡ršg
)
$–e
["Id"]] = (string)$ele["Target"];

1255 ià(
$–e
["Type"] == "http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing") {

1256 
$vmlComm’ts
[(
¡ršg
)
$–e
["Id"]] = (string)$ele["Target"];

1262 
	`fÜ—ch
 (
$comm’ts
 
as
 
$»lName
 => 
$»lP©h
) {

1264 
$»lP©h
 = 
PHPExûl_Sh¬ed_Fe
::
	`»®·th
(
	`dœÇme
("$dir/$fileWorksheet") . "/" . $relPath);

1265 
$comm’tsFe
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
$»lP©h
)), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1268 
$authÜs
 = 
	`¬¿y
();

1271 
	`fÜ—ch
 (
$comm’tsFe
->
authÜs
->
authÜ
 
as
 
$authÜ
) {

1272 
$authÜs
[] = (
¡ršg
)
$authÜ
;

1276 
	`fÜ—ch
 (
$comm’tsFe
->
comm’tLi¡
->
comm’t
 
as
 
$comm’t
) {

1277 ià(!
	`em±y
(
$comm’t
['authorId'])) {

1278 
$docSh“t
->
	`g‘Comm’t
((
¡ršg
)
$comm’t
['»f'])->
	`£tAuthÜ
(
$authÜs
[(string)$comment['authorId']]);

1280 
$docSh“t
->
	`g‘Comm’t
((
¡ršg
)
$comm’t
['»f'])->
	`£tText
(
$this
->
	`·r£RichText
($comm’t->
‹xt
));

1285 
	`fÜ—ch
 (
$vmlComm’ts
 
as
 
$»lName
 => 
$»lP©h
) {

1287 
$»lP©h
 = 
PHPExûl_Sh¬ed_Fe
::
	`»®·th
(
	`dœÇme
("$dir/$fileWorksheet") . "/" . $relPath);

1288 
$vmlComm’tsFe
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
$»lP©h
)), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1289 
$vmlComm’tsFe
->
	`»gi¡”XP©hName¥aû
('v', 'urn:schemas-microsoft-com:vml');

1291 
$sh­es
 = 
$vmlComm’tsFe
->
	`x·th
('//v:shape');

1292 
	`fÜ—ch
 (
$sh­es
 
as
 
$sh­e
) {

1293 
$sh­e
->
	`»gi¡”XP©hName¥aû
('v', 'urn:schemas-microsoft-com:vml');

1295 ià(
	`is£t
(
$sh­e
['style'])) {

1296 
$¡yË
 = (
¡ršg
)
$sh­e
['style'];

1297 
$flCŞÜ
 = 
	`¡¹ouµ”
(
	`sub¡r
((
¡ršg
)
$sh­e
['fillcolor'], 1));

1298 
$cŞumn
 = 
nuÎ
;

1299 
$row
 = 
nuÎ
;

1301 
$ş›ÁD©a
 = 
$sh­e
->
	`x·th
('.//x:ClientData');

1302 ià(
	`is_¬¿y
(
$ş›ÁD©a
è&& !
	`em±y
($clientData)) {

1303 
$ş›ÁD©a
 = $clientData[0];

1305 ià(
	`is£t
(
$ş›ÁD©a
['ObjeùTy³']è&& (
¡ršg
)$clientData['ObjectType'] == 'Note') {

1306 
$‹mp
 = 
$ş›ÁD©a
->
	`x·th
('.//x:Row');

1307 ià(
	`is_¬¿y
(
$‹mp
)) {

1308 
$row
 = 
$‹mp
[0];

1311 
$‹mp
 = 
$ş›ÁD©a
->
	`x·th
('.//x:Column');

1312 ià(
	`is_¬¿y
(
$‹mp
)) {

1313 
$cŞumn
 = 
$‹mp
[0];

1318 ià((
$cŞumn
 !=ğ
nuÎ
è&& (
$row
 !==‚ull)) {

1320 
$comm’t
 = 
$docSh“t
->
	`g‘Comm’tByCŞumnAndRow
((
¡ršg
è
$cŞumn
, 
$row
 + 1);

1321 
$comm’t
->
	`g‘FlCŞÜ
()->
	`£tRGB
(
$flCŞÜ
);

1324 
$¡yËA¼ay
 = 
	`ex¶ode
(';', 
	`¡r_»¶aû
(' ', '', 
$¡yË
));

1325 
	`fÜ—ch
 (
$¡yËA¼ay
 
as
 
$¡yËPaœ
) {

1326 
$¡yËPaœ
 = 
	`ex¶ode
(':', $stylePair);

1328 ià(
$¡yËPaœ
[0] == 'margin-left') {

1329 
$comm’t
->
	`£tM¬gšLeá
(
$¡yËPaœ
[1]);

1331 ià(
$¡yËPaœ
[0] == 'margin-top') {

1332 
$comm’t
->
	`£tM¬gšTİ
(
$¡yËPaœ
[1]);

1334 ià(
$¡yËPaœ
[0] == 'width') {

1335 
$comm’t
->
	`£tWidth
(
$¡yËPaœ
[1]);

1337 ià(
$¡yËPaœ
[0] == 'height') {

1338 
$comm’t
->
	`£tHeight
(
$¡yËPaœ
[1]);

1340 ià(
$¡yËPaœ
[0] == 'visibility') {

1341 
$comm’t
->
	`£tVisibË
(
$¡yËPaœ
[1] == 'visible');

1350 ià(
$xmlSh“t
 && $xmlSh“t->
ËgacyD¿wšgHF
 && !
$this
->
»adD©aOÆy
) {

1351 ià(
$z
->
	`loÿ‹Name
(
	`dœÇme
("$dœ/$feWÜksh“t"è. "/_»ls/" . 
	`ba£Çme
(
$feWÜksh“t
) . ".rels")) {

1352 
$»lsWÜksh“t
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
	`dœÇme
("$dœ/$feWÜksh“t"è. "/_»ls/" . 
	`ba£Çme
(
$feWÜksh“t
è. ".»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1353 
$vmlR–©iÚsh
 = '';

1355 
	`fÜ—ch
 (
$»lsWÜksh“t
->
R–©iÚsh
 
as
 
$–e
) {

1356 ià(
$–e
["Type"] == "http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing") {

1357 
$vmlR–©iÚsh
 = 
£lf
::
	`dœAdd
("$dœ/$feWÜksh“t", 
$–e
["Target"]);

1361 ià(
$vmlR–©iÚsh
 != '') {

1363 
$»lsVML
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
	`dœÇme
(
$vmlR–©iÚsh
è. '/_»ls/' . 
	`ba£Çme
($vmlR–©iÚshè. '.»ls')), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1364 
$d¿wšgs
 = 
	`¬¿y
();

1365 
	`fÜ—ch
 (
$»lsVML
->
R–©iÚsh
 
as
 
$–e
) {

1366 ià(
$–e
["Type"] == "http://schemas.openxmlformats.org/officeDocument/2006/relationships/image") {

1367 
$d¿wšgs
[(
¡ršg
è
$–e
["Id"]] = 
£lf
::
	`dœAdd
(
$vmlR–©iÚsh
, $ele["Target"]);

1372 
$vmlD¿wšg
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
$vmlR–©iÚsh
)), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1373 
$vmlD¿wšg
->
	`»gi¡”XP©hName¥aû
('v', 'urn:schemas-microsoft-com:vml');

1375 
$hfImages
 = 
	`¬¿y
();

1377 
$sh­es
 = 
$vmlD¿wšg
->
	`x·th
('//v:shape');

1378 
	`fÜ—ch
 (
$sh­es
 
as
 
$idx
 => 
$sh­e
) {

1379 
$sh­e
->
	`»gi¡”XP©hName¥aû
('v', 'urn:schemas-microsoft-com:vml');

1380 
$imageD©a
 = 
$sh­e
->
	`x·th
('//v:imagedata');

1381 
$imageD©a
 = $imageD©a[
$idx
];

1383 
$imageD©a
 = $imageD©a->
	`©Œibu‹s
('urn:schemas-microsoft-com:office:office');

1384 
$¡yË
 = 
£lf
::
	`toCSSA¼ay
((
¡ršg
)
$sh­e
['style']);

1386 
$hfImages
[ (
¡ršg
)
$sh­e
['id'] ] = 
Ãw
 
	`PHPExûl_WÜksh“t_H—d”FoÙ”D¿wšg
();

1387 ià(
	`is£t
(
$imageD©a
['title'])) {

1388 
$hfImages
[ (
¡ršg
)
$sh­e
['id'] ]->
	`£tName
((¡ršg)
$imageD©a
['title']);

1391 
$hfImages
[ (
¡ršg
)
$sh­e
['id'] ]->
	`£tP©h
("z://".
PHPExûl_Sh¬ed_Fe
::
	`»®·th
(
$pF’ame
)."#" . 
$d¿wšgs
[(¡ršg)
$imageD©a
['»lid']], 
çl£
);

1392 
$hfImages
[ (
¡ršg
)
$sh­e
['id'] ]->
	`£tResizePrİÜtiÚ®
(
çl£
);

1393 
$hfImages
[ (
¡ršg
)
$sh­e
['id'] ]->
	`£tWidth
(
$¡yË
['width']);

1394 
$hfImages
[ (
¡ršg
)
$sh­e
['id'] ]->
	`£tHeight
(
$¡yË
['height']);

1395 ià(
	`is£t
(
$¡yË
['margin-left'])) {

1396 
$hfImages
[ (
¡ršg
)
$sh­e
['id'] ]->
	`£tOff£tX
(
$¡yË
['margin-left']);

1398 
$hfImages
[ (
¡ršg
)
$sh­e
['id'] ]->
	`£tOff£tY
(
$¡yË
['margin-top']);

1399 
$hfImages
[ (
¡ršg
)
$sh­e
['id'] ]->
	`£tResizePrİÜtiÚ®
(
Œue
);

1402 
$docSh“t
->
	`g‘H—d”FoÙ”
()->
	`£tImages
(
$hfImages
);

1410 ià(
$z
->
	`loÿ‹Name
(
	`dœÇme
("$dœ/$feWÜksh“t"è. "/_»ls/" . 
	`ba£Çme
(
$feWÜksh“t
) . ".rels")) {

1411 
$»lsWÜksh“t
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
	`dœÇme
("$dœ/$feWÜksh“t"è. "/_»ls/" . 
	`ba£Çme
(
$feWÜksh“t
è. ".»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1412 
$d¿wšgs
 = 
	`¬¿y
();

1413 
	`fÜ—ch
 (
$»lsWÜksh“t
->
R–©iÚsh
 
as
 
$–e
) {

1414 ià(
$–e
["Type"] == "http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing") {

1415 
$d¿wšgs
[(
¡ršg
è
$–e
["Id"]] = 
£lf
::
	`dœAdd
("$dir/$fileWorksheet", $ele["Target"]);

1418 ià(
$xmlSh“t
->
d¿wšg
 && !
$this
->
»adD©aOÆy
) {

1419 
	`fÜ—ch
 (
$xmlSh“t
->
d¿wšg
 
as
 
$d¿wšg
) {

1420 
$feD¿wšg
 = 
$d¿wšgs
[(
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$d¿wšg
->
	`©Œibu‹s
("http://schemas.openxmlformats.org/officeDocument/2006/relationships"), "id")];

1421 
$»lsD¿wšg
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
	`dœÇme
(
$feD¿wšg
è. "/_»ls/" . 
	`ba£Çme
($feD¿wšgè. ".»ls")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1422 
$images
 = 
	`¬¿y
();

1424 ià(
$»lsD¿wšg
 && $»lsD¿wšg->
R–©iÚsh
) {

1425 
	`fÜ—ch
 (
$»lsD¿wšg
->
R–©iÚsh
 
as
 
$–e
) {

1426 ià(
$–e
["Type"] == "http://schemas.openxmlformats.org/officeDocument/2006/relationships/image") {

1427 
$images
[(
¡ršg
è
$–e
["Id"]] = 
£lf
::
	`dœAdd
(
$feD¿wšg
, $ele["Target"]);

1428 } 
	`–£if
 (
$–e
["Type"] == "http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart") {

1429 ià(
$this
->
šşudeCh¬ts
) {

1430 
$ch¬ts
[
£lf
::
	`dœAdd
(
$feD¿wšg
, 
$–e
["T¬g‘"])] = 
	`¬¿y
(

1431 'id' => (
¡ršg
è
$–e
["Id"],

1432 'sh“t' => 
$docSh“t
->
	`g‘T™Ë
()

1438 
$xmlD¿wšg
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
$feD¿wšg
)), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
())->
	`chd»n
("http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing");

1440 ià(
$xmlD¿wšg
->
ÚeC–lAnchÜ
) {

1441 
	`fÜ—ch
 (
$xmlD¿wšg
->
ÚeC–lAnchÜ
 
as
 
$ÚeC–lAnchÜ
) {

1442 ià(
$ÚeC–lAnchÜ
->
pic
->
blFl
) {

1443 
$bl
 = 
$ÚeC–lAnchÜ
->
pic
->
blFl
->
	`chd»n
("h‰p://schemas.İ’xmlfÜm©s.Üg/d¿wšgml/2006/maš")->
bl
;

1444 
$xäm
 = 
$ÚeC–lAnchÜ
->
pic
->
¥Pr
->
	`chd»n
("h‰p://schemas.İ’xmlfÜm©s.Üg/d¿wšgml/2006/maš")->
xäm
;

1445 
$ou‹rShdw
 = 
$ÚeC–lAnchÜ
->
pic
->
¥Pr
->
	`chd»n
("h‰p://schemas.İ’xmlfÜm©s.Üg/d¿wšgml/2006/maš")->
efãùL¡
->
ou‹rShdw
;

1446 
$objD¿wšg
 = 
Ãw
 
PHPExûl_WÜksh“t_D¿wšg
;

1447 
$objD¿wšg
->
	`£tName
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$ÚeC–lAnchÜ
->
pic
->
nvPicPr
->
cNvPr
->
	`©Œibu‹s
(), "name"));

1448 
$objD¿wšg
->
	`£tDesütiÚ
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$ÚeC–lAnchÜ
->
pic
->
nvPicPr
->
cNvPr
->
	`©Œibu‹s
(), "descr"));

1449 
$objD¿wšg
->
	`£tP©h
("z://".
PHPExûl_Sh¬ed_Fe
::
	`»®·th
(
$pF’ame
)."#" . 
$images
[(
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$bl
->
	`©Œibu‹s
("h‰p://schemas.İ’xmlfÜm©s.Üg/offiûDocum’t/2006/»ÏtiÚshs"), "embed")], 
çl£
);

1450 
$objD¿wšg
->
	`£tCoÜdš©es
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
((
¡ršg
è
$ÚeC–lAnchÜ
->
äom
->
cŞ
è. ($ÚeC–lAnchÜ->äom->
row
 + 1));

1451 
$objD¿wšg
->
	`£tOff£tX
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
$ÚeC–lAnchÜ
->
äom
->
cŞOff
));

1452 
$objD¿wšg
->
	`£tOff£tY
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
$ÚeC–lAnchÜ
->
äom
->
rowOff
));

1453 
$objD¿wšg
->
	`£tResizePrİÜtiÚ®
(
çl£
);

1454 
$objD¿wšg
->
	`£tWidth
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
£lf
::
	`g‘A¼ayI‹m
(
$ÚeC–lAnchÜ
->
ext
->
	`©Œibu‹s
(), "cx")));

1455 
$objD¿wšg
->
	`£tHeight
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
£lf
::
	`g‘A¼ayI‹m
(
$ÚeC–lAnchÜ
->
ext
->
	`©Œibu‹s
(), "cy")));

1456 ià(
$xäm
) {

1457 
$objD¿wšg
->
	`£tRÙ©iÚ
(
PHPExûl_Sh¬ed_D¿wšg
::
	`ªgËToDeg»es
(
£lf
::
	`g‘A¼ayI‹m
(
$xäm
->
	`©Œibu‹s
(), "rot")));

1459 ià(
$ou‹rShdw
) {

1460 
$shadow
 = 
$objD¿wšg
->
	`g‘Shadow
();

1461 
$shadow
->
	`£tVisibË
(
Œue
);

1462 
$shadow
->
	`£tBlurRadius
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUTİix–s
(
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
	`©Œibu‹s
(), "blurRad")));

1463 
$shadow
->
	`£tDi¡ªû
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUTİix–s
(
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
	`©Œibu‹s
(), "dist")));

1464 
$shadow
->
	`£tDœeùiÚ
(
PHPExûl_Sh¬ed_D¿wšg
::
	`ªgËToDeg»es
(
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
	`©Œibu‹s
(), "dir")));

1465 
$shadow
->
	`£tAlignm’t
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
	`©Œibu‹s
(), "algn"));

1466 
$shadow
->
	`g‘CŞÜ
()->
	`£tRGB
(
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
¤gbCÌ
->
	`©Œibu‹s
(), "val"));

1467 
$shadow
->
	`£tAÍha
(
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
¤gbCÌ
->
®pha
->
	`©Œibu‹s
(), "val") / 1000);

1469 
$objD¿wšg
->
	`£tWÜksh“t
(
$docSh“t
);

1472 
$coÜdš©es
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
((
¡ršg
è
$ÚeC–lAnchÜ
->
äom
->
cŞ
è. ($ÚeC–lAnchÜ->äom->
row
 + 1);

1473 
$off£tX
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
$ÚeC–lAnchÜ
->
äom
->
cŞOff
);

1474 
$off£tY
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
$ÚeC–lAnchÜ
->
äom
->
rowOff
);

1475 
$width
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
£lf
::
	`g‘A¼ayI‹m
(
$ÚeC–lAnchÜ
->
ext
->
	`©Œibu‹s
(), "cx"));

1476 
$height
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
£lf
::
	`g‘A¼ayI‹m
(
$ÚeC–lAnchÜ
->
ext
->
	`©Œibu‹s
(), "cy"));

1480 ià(
$xmlD¿wšg
->
twoC–lAnchÜ
) {

1481 
	`fÜ—ch
 (
$xmlD¿wšg
->
twoC–lAnchÜ
 
as
 
$twoC–lAnchÜ
) {

1482 ià(
$twoC–lAnchÜ
->
pic
->
blFl
) {

1483 
$bl
 = 
$twoC–lAnchÜ
->
pic
->
blFl
->
	`chd»n
("h‰p://schemas.İ’xmlfÜm©s.Üg/d¿wšgml/2006/maš")->
bl
;

1484 
$xäm
 = 
$twoC–lAnchÜ
->
pic
->
¥Pr
->
	`chd»n
("h‰p://schemas.İ’xmlfÜm©s.Üg/d¿wšgml/2006/maš")->
xäm
;

1485 
$ou‹rShdw
 = 
$twoC–lAnchÜ
->
pic
->
¥Pr
->
	`chd»n
("h‰p://schemas.İ’xmlfÜm©s.Üg/d¿wšgml/2006/maš")->
efãùL¡
->
ou‹rShdw
;

1486 
$objD¿wšg
 = 
Ãw
 
PHPExûl_WÜksh“t_D¿wšg
;

1487 
$objD¿wšg
->
	`£tName
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$twoC–lAnchÜ
->
pic
->
nvPicPr
->
cNvPr
->
	`©Œibu‹s
(), "name"));

1488 
$objD¿wšg
->
	`£tDesütiÚ
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$twoC–lAnchÜ
->
pic
->
nvPicPr
->
cNvPr
->
	`©Œibu‹s
(), "descr"));

1489 
$objD¿wšg
->
	`£tP©h
("z://".
PHPExûl_Sh¬ed_Fe
::
	`»®·th
(
$pF’ame
)."#" . 
$images
[(
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$bl
->
	`©Œibu‹s
("h‰p://schemas.İ’xmlfÜm©s.Üg/offiûDocum’t/2006/»ÏtiÚshs"), "embed")], 
çl£
);

1490 
$objD¿wšg
->
	`£tCoÜdš©es
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
((
¡ršg
è
$twoC–lAnchÜ
->
äom
->
cŞ
è. ($twoC–lAnchÜ->äom->
row
 + 1));

1491 
$objD¿wšg
->
	`£tOff£tX
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
$twoC–lAnchÜ
->
äom
->
cŞOff
));

1492 
$objD¿wšg
->
	`£tOff£tY
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
$twoC–lAnchÜ
->
äom
->
rowOff
));

1493 
$objD¿wšg
->
	`£tResizePrİÜtiÚ®
(
çl£
);

1495 ià(
$xäm
) {

1496 
$objD¿wšg
->
	`£tWidth
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
£lf
::
	`g‘A¼ayI‹m
(
$xäm
->
ext
->
	`©Œibu‹s
(), "cx")));

1497 
$objD¿wšg
->
	`£tHeight
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
£lf
::
	`g‘A¼ayI‹m
(
$xäm
->
ext
->
	`©Œibu‹s
(), "cy")));

1498 
$objD¿wšg
->
	`£tRÙ©iÚ
(
PHPExûl_Sh¬ed_D¿wšg
::
	`ªgËToDeg»es
(
£lf
::
	`g‘A¼ayI‹m
(
$xäm
->
	`©Œibu‹s
(), "rot")));

1500 ià(
$ou‹rShdw
) {

1501 
$shadow
 = 
$objD¿wšg
->
	`g‘Shadow
();

1502 
$shadow
->
	`£tVisibË
(
Œue
);

1503 
$shadow
->
	`£tBlurRadius
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUTİix–s
(
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
	`©Œibu‹s
(), "blurRad")));

1504 
$shadow
->
	`£tDi¡ªû
(
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUTİix–s
(
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
	`©Œibu‹s
(), "dist")));

1505 
$shadow
->
	`£tDœeùiÚ
(
PHPExûl_Sh¬ed_D¿wšg
::
	`ªgËToDeg»es
(
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
	`©Œibu‹s
(), "dir")));

1506 
$shadow
->
	`£tAlignm’t
((
¡ršg
è
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
	`©Œibu‹s
(), "algn"));

1507 
$shadow
->
	`g‘CŞÜ
()->
	`£tRGB
(
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
¤gbCÌ
->
	`©Œibu‹s
(), "val"));

1508 
$shadow
->
	`£tAÍha
(
£lf
::
	`g‘A¼ayI‹m
(
$ou‹rShdw
->
¤gbCÌ
->
®pha
->
	`©Œibu‹s
(), "val") / 1000);

1510 
$objD¿wšg
->
	`£tWÜksh“t
(
$docSh“t
);

1511 } 
	`–£if
 ((
$this
->
šşudeCh¬ts
è&& (
$twoC–lAnchÜ
->
g¿phicF¿me
)) {

1512 
$äomCoÜdš©e
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
((
¡ršg
è
$twoC–lAnchÜ
->
äom
->
cŞ
è. ($twoC–lAnchÜ->äom->
row
 + 1);

1513 
$äomOff£tX
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
$twoC–lAnchÜ
->
äom
->
cŞOff
);

1514 
$äomOff£tY
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
$twoC–lAnchÜ
->
äom
->
rowOff
);

1515 
$toCoÜdš©e
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
((
¡ršg
è
$twoC–lAnchÜ
->
to
->
cŞ
è. ($twoC–lAnchÜ->to->
row
 + 1);

1516 
$toOff£tX
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
$twoC–lAnchÜ
->
to
->
cŞOff
);

1517 
$toOff£tY
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`EMUToPix–s
(
$twoC–lAnchÜ
->
to
->
rowOff
);

1518 
$g¿phic
 = 
$twoC–lAnchÜ
->
g¿phicF¿me
->
	`chd»n
("h‰p://schemas.İ’xmlfÜm©s.Üg/d¿wšgml/2006/maš")->
g¿phic
;

1519 
$ch¬tRef
 = 
$g¿phic
->
g¿phicD©a
->
	`chd»n
("h‰p://schemas.İ’xmlfÜm©s.Üg/d¿wšgml/2006/ch¬t")->
ch¬t
;

1520 
$thisCh¬t
 = (
¡ršg
è
$ch¬tRef
->
	`©Œibu‹s
("http://schemas.openxmlformats.org/officeDocument/2006/relationships");

1522 
$ch¬tD‘as
[
$docSh“t
->
	`g‘T™Ë
().'!'.
$thisCh¬t
] = 
	`¬¿y
(

1523 'äomCoÜdš©e' => 
$äomCoÜdš©e
,

1524 'äomOff£tX' => 
$äomOff£tX
,

1525 'äomOff£tY' => 
$äomOff£tY
,

1526 'toCoÜdš©e' => 
$toCoÜdš©e
,

1527 'toOff£tX' => 
$toOff£tX
,

1528 'toOff£tY' => 
$toOff£tY
,

1529 'wÜksh“tT™Ë' => 
$docSh“t
->
	`g‘T™Ë
()

1539 ià(
$xmlWÜkbook
->
defšedNames
) {

1540 
	`fÜ—ch
 (
$xmlWÜkbook
->
defšedNames
->
defšedName
 
as
 
$defšedName
) {

1542 
$exŒaùedRªge
 = (
¡ršg
)
$defšedName
;

1543 
$exŒaùedRªge
 = 
	`´eg_»¶aû
('/\'(\w+)\'\!/', '', $extractedRange);

1544 ià((
$¥os
 = 
	`¡½os
(
$exŒaùedRªge
, '!')è!=ğ
çl£
) {

1545 
$exŒaùedRªge
 = 
	`sub¡r
($exŒaùedRªge, 0, 
$¥os
).
	`¡r_»¶aû
('$', '', substr($extractedRange, $spos));

1547 
$exŒaùedRªge
 = 
	`¡r_»¶aû
('$', '', $extractedRange);

1551 ià(
	`¡ros
((
¡ršg
)
$defšedName
, '#REF!'è!=ğ
çl£
 || 
$exŒaùedRªge
 == '') {

1556 ià((
¡ršg
)
$defšedName
['loÿlSh“tId'] !ğ'' && (¡ršg)$defšedName['loÿlSh“tId'] =ğ
$sh“tId
) {

1558 (
¡ršg
)
$defšedName
['name']) {

1560 ià((
¡ršg
)
$defšedName
['hidden'] !== '1') {

1561 
$exŒaùedRªge
 = 
	`ex¶ode
(',', $extractedRange);

1562 
	`fÜ—ch
 (
$exŒaùedRªge
 
as
 
$¿nge
) {

1563 
$autoF‹rRªge
 = 
$¿nge
;

1564 ià(
	`¡½os
(
$autoF‹rRªge
, ':'è!=ğ
çl£
) {

1565 
$docSh“t
->
	`g‘AutoF‹r
()->
	`£tRªge
(
$autoF‹rRªge
);

1572 
$exŒaùedRªge
 = 
	`ex¶ode
(',', $extractedRange);

1575 
	`fÜ—ch
 (
$exŒaùedRªge
 
as
 
$¿nge
) {

1576 
$m©ches
 = 
	`¬¿y
();

1577 
$¿nge
 = 
	`¡r_»¶aû
('$', '', $range);

1580 ià(
	`´eg_m©ch
('/!?([A-Z]+)\:([A-Z]+)$/', 
$¿nge
, 
$m©ches
)) {

1581 
$docSh“t
->
	`g‘PageS‘up
()->
	`£tCŞumnsToR•—tAtLeá
(
	`¬¿y
(
$m©ches
[1], $matches[2]));

1582 } 
	`–£if
 (
	`´eg_m©ch
('/!?(\d+)\:(\d+)$/', 
$¿nge
, 
$m©ches
)) {

1584 
$docSh“t
->
	`g‘PageS‘up
()->
	`£tRowsToR•—tAtTİ
(
	`¬¿y
(
$m©ches
[1], $matches[2]));

1589 
$¿ngeS‘s
 = 
	`ex¶ode
(',', 
$exŒaùedRªge
);

1590 
$ÃwRªgeS‘s
 = 
	`¬¿y
();

1591 
	`fÜ—ch
 (
$¿ngeS‘s
 
as
 
$¿ngeS‘
) {

1592 
$¿nge
 = 
	`ex¶ode
('!', 
$¿ngeS‘
);

1593 
$¿ngeS‘
 = 
	`is£t
(
$¿nge
[1]) ? $range[1] : $range[0];

1594 ià(
	`¡½os
(
$¿ngeS‘
, ':'è==ğ
çl£
) {

1595 
$¿ngeS‘
 = $rangeSet . ':' . $rangeSet;

1597 
$ÃwRªgeS‘s
[] = 
	`¡r_»¶aû
('$', '', 
$¿ngeS‘
);

1599 
$docSh“t
->
	`g‘PageS‘up
()->
	`£tPrštA»a
(
	`im¶ode
(',', 
$ÃwRªgeS‘s
));

1610 ++
$sh“tId
;

1614 ià(
$xmlWÜkbook
->
defšedNames
) {

1615 
	`fÜ—ch
 (
$xmlWÜkbook
->
defšedNames
->
defšedName
 
as
 
$defšedName
) {

1617 
$exŒaùedRªge
 = (
¡ršg
)
$defšedName
;

1618 
$exŒaùedRªge
 = 
	`´eg_»¶aû
('/\'(\w+)\'\!/', '', $extractedRange);

1619 ià((
$¥os
 = 
	`¡½os
(
$exŒaùedRªge
, '!')è!=ğ
çl£
) {

1620 
$exŒaùedRªge
 = 
	`sub¡r
($exŒaùedRªge, 0, 
$¥os
).
	`¡r_»¶aû
('$', '', substr($extractedRange, $spos));

1622 
$exŒaùedRªge
 = 
	`¡r_»¶aû
('$', '', $extractedRange);

1626 ià(
	`¡ros
((
¡ršg
)
$defšedName
, '#REF!'è!=ğ
çl£
 || 
$exŒaùedRªge
 == '') {

1631 ià((
¡ršg
)
$defšedName
['localSheetId'] != '') {

1634 (
¡ršg
)
$defšedName
['name']) {

1640 ià(
$m­Sh“tId
[(
š‹g”
è
$defšedName
['loÿlSh“tId']] !=ğ
nuÎ
) {

1641 
$¿nge
 = 
	`ex¶ode
('!', (
¡ršg
)
$defšedName
);

1642 ià(
	`couÁ
(
$¿nge
) == 2) {

1643 
$¿nge
[0] = 
	`¡r_»¶aû
("''", "'", $range[0]);

1644 
$¿nge
[0] = 
	`¡r_»¶aû
("'", "", $range[0]);

1645 ià(
$wÜksh“t
 = 
$docSh“t
->
	`g‘P¬’t
()->
	`g‘Sh“tByName
(
$¿nge
[0])) {

1646 
$exŒaùedRªge
 = 
	`¡r_»¶aû
('$', '', 
$¿nge
[1]);

1647 
$scİe
 = 
$docSh“t
->
	`g‘P¬’t
()->
	`g‘Sh“t
(
$m­Sh“tId
[(
š‹g”
è
$defšedName
['localSheetId']]);

1648 
$exûl
->
	`addNamedRªge
(
Ãw
 
	`PHPExûl_NamedRªge
((
¡ršg
)
$defšedName
['Çme'], 
$wÜksh“t
, 
$exŒaùedRªge
, 
Œue
, 
$scİe
));

1654 } 
	`–£if
 (!
	`is£t
(
$defšedName
['localSheetId'])) {

1656 
$loÿ‹dSh“t
 = 
nuÎ
;

1657 
$exŒaùedSh“tName
 = '';

1658 ià(
	`¡½os
((
¡ršg
)
$defšedName
, '!'è!=ğ
çl£
) {

1660 
$exŒaùedSh“tName
 = 
PHPExûl_WÜksh“t
::
	`exŒaùSh“tT™Ë
((
¡ršg
)
$defšedName
, 
Œue
);

1661 
$exŒaùedSh“tName
 = $extractedSheetName[0];

1664 
$loÿ‹dSh“t
 = 
$exûl
->
	`g‘Sh“tByName
(
$exŒaùedSh“tName
);

1667 
$¿nge
 = 
	`ex¶ode
('!', 
$exŒaùedRªge
);

1668 
$exŒaùedRªge
 = 
	`is£t
(
$¿nge
[1]) ? $range[1] : $range[0];

1671 ià(
$loÿ‹dSh“t
 !=ğ
nuÎ
) {

1672 
$exûl
->
	`addNamedRªge
(
Ãw
 
	`PHPExûl_NamedRªge
((
¡ršg
)
$defšedName
['Çme'], 
$loÿ‹dSh“t
, 
$exŒaùedRªge
, 
çl£
));

1679 ià((!
$this
->
»adD©aOÆy
è|| (!
	`em±y
($this->
lßdSh“tsOÆy
))) {

1681 
$aùiveTab
 = 
	`štv®
(
$xmlWÜkbook
->
bookV›ws
->
wÜkbookV›w
["activeTab"]);

1684 ià(
	`is£t
(
$m­Sh“tId
[
$aùiveTab
]è&& $m­Sh“tId[$aùiveTab] !=ğ
nuÎ
) {

1685 
$exûl
->
	`£tAùiveSh“tIndex
(
$m­Sh“tId
[
$aùiveTab
]);

1687 ià(
$exûl
->
	`g‘Sh“tCouÁ
() == 0) {

1688 
$exûl
->
	`ü—‹Sh“t
();

1690 
$exûl
->
	`£tAùiveSh“tIndex
(0);

1697 ià(!
$this
->
»adD©aOÆy
) {

1698 
$cÚ‹ÁTy³s
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, "[CÚ‹Á_Ty³s].xml")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1699 
	`fÜ—ch
 (
$cÚ‹ÁTy³s
->
Ov”ride
 
as
 
$cÚ‹ÁTy³
) {

1700 
$cÚ‹ÁTy³
["ContentType"]) {

1702 ià(
$this
->
šşudeCh¬ts
) {

1703 
$ch¬tEÁryRef
 = 
	`Érim
(
$cÚ‹ÁTy³
['PartName'], '/');

1704 
$ch¬tEËm’ts
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
($this->
	`g‘FromZArchive
(
$z
, 
$ch¬tEÁryRef
)), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1705 
$objCh¬t
 = 
PHPExûl_R—d”_Exûl2007_Ch¬t
::
	`»adCh¬t
(
$ch¬tEËm’ts
, 
	`ba£Çme
(
$ch¬tEÁryRef
, '.xml'));

1710 ià(
	`is£t
(
$ch¬ts
[
$ch¬tEÁryRef
])) {

1711 
$ch¬tPos™iÚRef
 = 
$ch¬ts
[
$ch¬tEÁryRef
]['sheet'].'!'.$charts[$chartEntryRef]['id'];

1713 ià(
	`is£t
(
$ch¬tD‘as
[
$ch¬tPos™iÚRef
])) {

1716 
$exûl
->
	`g‘Sh“tByName
(
$ch¬ts
[
$ch¬tEÁryRef
]['sh“t'])->
	`addCh¬t
(
$objCh¬t
);

1717 
$objCh¬t
->
	`£tWÜksh“t
(
$exûl
->
	`g‘Sh“tByName
(
$ch¬ts
[
$ch¬tEÁryRef
]['sheet']));

1718 
$objCh¬t
->
	`£tTİLeáPos™iÚ
(
$ch¬tD‘as
[
$ch¬tPos™iÚRef
]['fromCoordinate'], $chartDetails[$chartPositionRef]['fromOffsetX'], $chartDetails[$chartPositionRef]['fromOffsetY']);

1719 
$objCh¬t
->
	`£tBÙtomRightPos™iÚ
(
$ch¬tD‘as
[
$ch¬tPos™iÚRef
]['toCoordinate'], $chartDetails[$chartPositionRef]['toOffsetX'], $chartDetails[$chartPositionRef]['toOffsetY']);

1727 
$z
->
	`şo£
();

1729  
$exûl
;

1730 
	}
}

1732 
´iv©e
 
funùiÚ
 
	$»adCŞÜ
(
$cŞÜ
, 
$background
 = 
çl£
)

1734 ià(
	`is£t
(
$cŞÜ
["rgb"])) {

1735  (
¡ršg
)
$cŞÜ
["rgb"];

1736 } 
	`–£if
 (
	`is£t
(
$cŞÜ
["indexed"])) {

1737  
PHPExûl_StyË_CŞÜ
::
	`šdexedCŞÜ
(
$cŞÜ
["šdexed"]-7, 
$background
)->
	`g‘ARGB
();

1738 } 
	`–£if
 (
	`is£t
(
$cŞÜ
["theme"])) {

1739 ià(
£lf
::
$theme
 !=ğ
nuÎ
) {

1740 
$»tuºCŞour
 = 
£lf
::
$theme
->
	`g‘CŞourByIndex
(()
$cŞÜ
["theme"]);

1741 ià(
	`is£t
(
$cŞÜ
["tint"])) {

1742 
$tštAdju¡
 = (è
$cŞÜ
["tint"];

1743 
$»tuºCŞour
 = 
PHPExûl_StyË_CŞÜ
::
	`chªgeBrighŠess
($»tuºCŞour, 
$tštAdju¡
);

1745  'FF'.
$»tuºCŞour
;

1749 ià(
$background
) {

1753 
	}
}

1755 
´iv©e
 
funùiÚ
 
	$»adStyË
(
$docStyË
, 
$¡yË
)

1762 
$docStyË
->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
(
$¡yË
->
numFmt
);

1767 ià(
	`is£t
(
$¡yË
->
fÚt
)) {

1768 
$docStyË
->
	`g‘FÚt
()->
	`£tName
((
¡ršg
è
$¡yË
->
fÚt
->
Çme
["val"]);

1769 
$docStyË
->
	`g‘FÚt
()->
	`£tSize
((
¡ršg
è
$¡yË
->
fÚt
->
sz
["val"]);

1770 ià(
	`is£t
(
$¡yË
->
fÚt
->
b
)) {

1771 
$docStyË
->
	`g‘FÚt
()->
	`£tBŞd
(!
	`is£t
(
$¡yË
->
fÚt
->
b
["v®"]è|| 
£lf
::
	`boŞ—n
((
¡ršg
) $style->font->b["val"]));

1773 ià(
	`is£t
(
$¡yË
->
fÚt
->
i
)) {

1774 
$docStyË
->
	`g‘FÚt
()->
	`£tIlic
(!
	`is£t
(
$¡yË
->
fÚt
->
i
["v®"]è|| 
£lf
::
	`boŞ—n
((
¡ršg
) $style->font->i["val"]));

1776 ià(
	`is£t
(
$¡yË
->
fÚt
->
¡rike
)) {

1777 
$docStyË
->
	`g‘FÚt
()->
	`£tSŒik‘hrough
(!
	`is£t
(
$¡yË
->
fÚt
->
¡rike
["v®"]è|| 
£lf
::
	`boŞ—n
((
¡ršg
) $style->font->strike["val"]));

1779 
$docStyË
->
	`g‘FÚt
()->
	`g‘CŞÜ
()->
	`£tARGB
(
£lf
::
	`»adCŞÜ
(
$¡yË
->
fÚt
->
cŞÜ
));

1781 ià(
	`is£t
(
$¡yË
->
fÚt
->
u
) && !isset($style->font->u["val"])) {

1782 
$docStyË
->
	`g‘FÚt
()->
	`£tUnd”lše
(
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLE
);

1783 } 
	`–£if
 (
	`is£t
(
$¡yË
->
fÚt
->
u
) && isset($style->font->u["val"])) {

1784 
$docStyË
->
	`g‘FÚt
()->
	`£tUnd”lše
((
¡ršg
)
$¡yË
->
fÚt
->
u
["val"]);

1787 ià(
	`is£t
(
$¡yË
->
fÚt
->
v”tAlign
) && isset($style->font->vertAlign["val"])) {

1788 
$v”tAlign
 = 
	`¡¹Şow”
((
¡ršg
)
$¡yË
->
fÚt
->
v”tAlign
["val"]);

1789 ià(
$v”tAlign
 == 'superscript') {

1790 
$docStyË
->
	`g‘FÚt
()->
	`£tSu³rSüt
(
Œue
);

1792 ià(
$v”tAlign
 == 'subscript') {

1793 
$docStyË
->
	`g‘FÚt
()->
	`£tSubSüt
(
Œue
);

1799 ià(
	`is£t
(
$¡yË
->
fl
)) {

1800 ià(
$¡yË
->
fl
->
g¿d›ÁFl
) {

1801 
$g¿d›ÁFl
 = 
$¡yË
->
fl
->
g¿d›ÁFl
[0];

1802 ià(!
	`em±y
(
$g¿d›ÁFl
["type"])) {

1803 
$docStyË
->
	`g‘Fl
()->
	`£tFlTy³
((
¡ršg
è
$g¿d›ÁFl
["type"]);

1805 
$docStyË
->
	`g‘Fl
()->
	`£tRÙ©iÚ
(
	`æßtv®
(
$g¿d›ÁFl
["degree"]));

1806 
$g¿d›ÁFl
->
	`»gi¡”XP©hName¥aû
("sml", "http://schemas.openxmlformats.org/spreadsheetml/2006/main");

1807 
$docStyË
->
	`g‘Fl
()->
	`g‘S¹CŞÜ
()->
	`£tARGB
(
£lf
::
	`»adCŞÜ
(£lf::
	`g‘A¼ayI‹m
(
$g¿d›ÁFl
->
	`x·th
("sml:¡İ[@pos™iÚ=0]"))->
cŞÜ
));

1808 
$docStyË
->
	`g‘Fl
()->
	`g‘EndCŞÜ
()->
	`£tARGB
(
£lf
::
	`»adCŞÜ
(£lf::
	`g‘A¼ayI‹m
(
$g¿d›ÁFl
->
	`x·th
("sml:¡İ[@pos™iÚ=1]"))->
cŞÜ
));

1809 } 
	`–£if
 (
$¡yË
->
fl
->
·‰”nFl
) {

1810 
$·‰”nTy³
 = (
¡ršg
)
$¡yË
->
fl
->
·‰”nFl
["patternType"] != '' ? (string)$style->fill->patternFill["patternType"] : 'solid';

1811 
$docStyË
->
	`g‘Fl
()->
	`£tFlTy³
(
$·‰”nTy³
);

1812 ià(
$¡yË
->
fl
->
·‰”nFl
->
fgCŞÜ
) {

1813 
$docStyË
->
	`g‘Fl
()->
	`g‘S¹CŞÜ
()->
	`£tARGB
(
£lf
::
	`»adCŞÜ
(
$¡yË
->
fl
->
·‰”nFl
->
fgCŞÜ
, 
Œue
));

1815 
$docStyË
->
	`g‘Fl
()->
	`g‘S¹CŞÜ
()->
	`£tARGB
('FF000000');

1817 ià(
$¡yË
->
fl
->
·‰”nFl
->
bgCŞÜ
) {

1818 
$docStyË
->
	`g‘Fl
()->
	`g‘EndCŞÜ
()->
	`£tARGB
(
£lf
::
	`»adCŞÜ
(
$¡yË
->
fl
->
·‰”nFl
->
bgCŞÜ
, 
Œue
));

1824 ià(
	`is£t
(
$¡yË
->
bÜd”
)) {

1825 
$dŸgÚ®Up
 = 
£lf
::
	`boŞ—n
((
¡ršg
è
$¡yË
->
bÜd”
["diagonalUp"]);

1826 
$dŸgÚ®Down
 = 
£lf
::
	`boŞ—n
((
¡ršg
è
$¡yË
->
bÜd”
["diagonalDown"]);

1827 ià(!
$dŸgÚ®Up
 && !
$dŸgÚ®Down
) {

1828 
$docStyË
->
	`g‘BÜd”s
()->
	`£tDŸgÚ®DœeùiÚ
(
PHPExûl_StyË_BÜd”s
::
DIAGONAL_NONE
);

1829 } 
	`–£if
 (
$dŸgÚ®Up
 && !
$dŸgÚ®Down
) {

1830 
$docStyË
->
	`g‘BÜd”s
()->
	`£tDŸgÚ®DœeùiÚ
(
PHPExûl_StyË_BÜd”s
::
DIAGONAL_UP
);

1831 } 
	`–£if
 (!
$dŸgÚ®Up
 && 
$dŸgÚ®Down
) {

1832 
$docStyË
->
	`g‘BÜd”s
()->
	`£tDŸgÚ®DœeùiÚ
(
PHPExûl_StyË_BÜd”s
::
DIAGONAL_DOWN
);

1834 
$docStyË
->
	`g‘BÜd”s
()->
	`£tDŸgÚ®DœeùiÚ
(
PHPExûl_StyË_BÜd”s
::
DIAGONAL_BOTH
);

1836 
£lf
::
	`»adBÜd”
(
$docStyË
->
	`g‘BÜd”s
()->
	`g‘Leá
(), 
$¡yË
->
bÜd”
->
Ëá
);

1837 
£lf
::
	`»adBÜd”
(
$docStyË
->
	`g‘BÜd”s
()->
	`g‘Right
(), 
$¡yË
->
bÜd”
->
right
);

1838 
£lf
::
	`»adBÜd”
(
$docStyË
->
	`g‘BÜd”s
()->
	`g‘Tİ
(), 
$¡yË
->
bÜd”
->
tİ
);

1839 
£lf
::
	`»adBÜd”
(
$docStyË
->
	`g‘BÜd”s
()->
	`g‘BÙtom
(), 
$¡yË
->
bÜd”
->
bÙtom
);

1840 
£lf
::
	`»adBÜd”
(
$docStyË
->
	`g‘BÜd”s
()->
	`g‘DŸgÚ®
(), 
$¡yË
->
bÜd”
->
dŸgÚ®
);

1844 ià(
	`is£t
(
$¡yË
->
®ignm’t
)) {

1845 
$docStyË
->
	`g‘Alignm’t
()->
	`£tHÜizÚl
((
¡ršg
è
$¡yË
->
®ignm’t
["horizontal"]);

1846 
$docStyË
->
	`g‘Alignm’t
()->
	`£tV”tiÿl
((
¡ršg
è
$¡yË
->
®ignm’t
["vertical"]);

1848 
$‹xtRÙ©iÚ
 = 0;

1849 ià(()
$¡yË
->
®ignm’t
["textRotation"] <= 90) {

1850 
$‹xtRÙ©iÚ
 = ()
$¡yË
->
®ignm’t
["textRotation"];

1851 } 
	`–£if
 (()
$¡yË
->
®ignm’t
["textRotation"] > 90) {

1852 
$‹xtRÙ©iÚ
 = 90 - ()
$¡yË
->
®ignm’t
["textRotation"];

1855 
$docStyË
->
	`g‘Alignm’t
()->
	`£tTextRÙ©iÚ
(
	`štv®
(
$‹xtRÙ©iÚ
));

1856 
$docStyË
->
	`g‘Alignm’t
()->
	`£tW¿pText
(
£lf
::
	`boŞ—n
((
¡ršg
è
$¡yË
->
®ignm’t
["wrapText"]));

1857 
$docStyË
->
	`g‘Alignm’t
()->
	`£tShrškToF™
(
£lf
::
	`boŞ—n
((
¡ršg
è
$¡yË
->
®ignm’t
["shrinkToFit"]));

1858 
$docStyË
->
	`g‘Alignm’t
()->
	`£tInd’t
(
	`štv®
((
¡ršg
)
$¡yË
->
®ignm’t
["indent"]) > 0 ? intval((string)$style->alignment["indent"]) : 0);

1859 
$docStyË
->
	`g‘Alignm’t
()->
	`£tR—dÜd”
(
	`štv®
((
¡ršg
)
$¡yË
->
®ignm’t
["readingOrder"]) > 0 ? intval((string)$style->alignment["readingOrder"]) : 0);

1863 ià(
	`is£t
(
$¡yË
->
´ÙeùiÚ
)) {

1864 ià(
	`is£t
(
$¡yË
->
´ÙeùiÚ
['locked'])) {

1865 ià(
£lf
::
	`boŞ—n
((
¡ršg
è
$¡yË
->
´ÙeùiÚ
['locked'])) {

1866 
$docStyË
->
	`g‘PrÙeùiÚ
()->
	`£tLocked
(
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
);

1868 
$docStyË
->
	`g‘PrÙeùiÚ
()->
	`£tLocked
(
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_UNPROTECTED
);

1872 ià(
	`is£t
(
$¡yË
->
´ÙeùiÚ
['hidden'])) {

1873 ià(
£lf
::
	`boŞ—n
((
¡ršg
è
$¡yË
->
´ÙeùiÚ
['hidden'])) {

1874 
$docStyË
->
	`g‘PrÙeùiÚ
()->
	`£tHidd’
(
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
);

1876 
$docStyË
->
	`g‘PrÙeùiÚ
()->
	`£tHidd’
(
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_UNPROTECTED
);

1882 ià(
	`is£t
(
$¡yË
->
quÙeP»fix
)) {

1883 
$docStyË
->
	`£tQuÙeP»fix
(
$¡yË
->
quÙeP»fix
);

1885 
	}
}

1887 
´iv©e
 
funùiÚ
 
	$»adBÜd”
(
$docBÜd”
, 
$–eBÜd”
)

1889 ià(
	`is£t
(
$–eBÜd”
["style"])) {

1890 
$docBÜd”
->
	`£tBÜd”StyË
((
¡ršg
è
$–eBÜd”
["style"]);

1892 ià(
	`is£t
(
$–eBÜd”
->
cŞÜ
)) {

1893 
$docBÜd”
->
	`g‘CŞÜ
()->
	`£tARGB
(
£lf
::
	`»adCŞÜ
(
$–eBÜd”
->
cŞÜ
));

1895 
	}
}

1897 
´iv©e
 
funùiÚ
 
	$·r£RichText
(
$is
 = 
nuÎ
)

1899 
$v®ue
 = 
Ãw
 
	`PHPExûl_RichText
();

1901 ià(
	`is£t
(
$is
->
t
)) {

1902 
$v®ue
->
	`ü—‹Text
(
PHPExûl_Sh¬ed_SŒšg
::
	`CÚŒŞCh¬aù”OOXML2PHP
((
¡ršg
è
$is
->
t
));

1904 ià(
	`is_objeù
(
$is
->
r
)) {

1905 
	`fÜ—ch
 (
$is
->
r
 
as
 
$run
) {

1906 ià(!
	`is£t
(
$run
->
rPr
)) {

1907 
$objText
 = 
$v®ue
->
	`ü—‹Text
(
PHPExûl_Sh¬ed_SŒšg
::
	`CÚŒŞCh¬aù”OOXML2PHP
((
¡ršg
è
$run
->
t
));

1910 
$objText
 = 
$v®ue
->
	`ü—‹TextRun
(
PHPExûl_Sh¬ed_SŒšg
::
	`CÚŒŞCh¬aù”OOXML2PHP
((
¡ršg
è
$run
->
t
));

1912 ià(
	`is£t
(
$run
->
rPr
->
rFÚt
["val"])) {

1913 
$objText
->
	`g‘FÚt
()->
	`£tName
((
¡ršg
è
$run
->
rPr
->
rFÚt
["val"]);

1915 ià(
	`is£t
(
$run
->
rPr
->
sz
["val"])) {

1916 
$objText
->
	`g‘FÚt
()->
	`£tSize
((
¡ršg
è
$run
->
rPr
->
sz
["val"]);

1918 ià(
	`is£t
(
$run
->
rPr
->
cŞÜ
)) {

1919 
$objText
->
	`g‘FÚt
()->
	`£tCŞÜ
(
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
£lf
::
	`»adCŞÜ
(
$run
->
rPr
->
cŞÜ
)));

1921 ià((
	`is£t
(
$run
->
rPr
->
b
["v®"]è&& 
£lf
::
	`boŞ—n
((
¡ršg
) $run->rPr->b["val"])) ||

1922 (
	`is£t
(
$run
->
rPr
->
b
) && !isset($run->rPr->b["val"]))) {

1923 
$objText
->
	`g‘FÚt
()->
	`£tBŞd
(
Œue
);

1925 ià((
	`is£t
(
$run
->
rPr
->
i
["v®"]è&& 
£lf
::
	`boŞ—n
((
¡ršg
) $run->rPr->i["val"])) ||

1926 (
	`is£t
(
$run
->
rPr
->
i
) && !isset($run->rPr->i["val"]))) {

1927 
$objText
->
	`g‘FÚt
()->
	`£tIlic
(
Œue
);

1929 ià(
	`is£t
(
$run
->
rPr
->
v”tAlign
) && isset($run->rPr->vertAlign["val"])) {

1930 
$v”tAlign
 = 
	`¡¹Şow”
((
¡ršg
)
$run
->
rPr
->
v”tAlign
["val"]);

1931 ià(
$v”tAlign
 == 'superscript') {

1932 
$objText
->
	`g‘FÚt
()->
	`£tSu³rSüt
(
Œue
);

1934 ià(
$v”tAlign
 == 'subscript') {

1935 
$objText
->
	`g‘FÚt
()->
	`£tSubSüt
(
Œue
);

1938 ià(
	`is£t
(
$run
->
rPr
->
u
) && !isset($run->rPr->u["val"])) {

1939 
$objText
->
	`g‘FÚt
()->
	`£tUnd”lše
(
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLE
);

1940 } 
	`–£if
 (
	`is£t
(
$run
->
rPr
->
u
) && isset($run->rPr->u["val"])) {

1941 
$objText
->
	`g‘FÚt
()->
	`£tUnd”lše
((
¡ršg
)
$run
->
rPr
->
u
["val"]);

1943 ià((
	`is£t
(
$run
->
rPr
->
¡rike
["v®"]è&& 
£lf
::
	`boŞ—n
((
¡ršg
) $run->rPr->strike["val"])) ||

1944 (
	`is£t
(
$run
->
rPr
->
¡rike
) && !isset($run->rPr->strike["val"]))) {

1945 
$objText
->
	`g‘FÚt
()->
	`£tSŒik‘hrough
(
Œue
);

1952  
$v®ue
;

1953 
	}
}

1955 
´iv©e
 
funùiÚ
 
	$»adRibbÚ
(
$exûl
, 
$cu¡omUIT¬g‘
, 
$z
)

1957 
$ba£Dœ
 = 
	`dœÇme
(
$cu¡omUIT¬g‘
);

1958 
$ÇmeCu¡omUI
 = 
	`ba£Çme
(
$cu¡omUIT¬g‘
);

1960 
$loÿlRibbÚ
 = 
$this
->
	`g‘FromZArchive
(
$z
, 
$cu¡omUIT¬g‘
);

1961 
$cu¡omUIImagesNames
 = 
	`¬¿y
();

1962 
$cu¡omUIImagesBš¬›s
 = 
	`¬¿y
();

1964 
$·thR–s
 = 
$ba£Dœ
 . '/_»ls/' . 
$ÇmeCu¡omUI
 . '.rels';

1965 
$d©aR–s
 = 
$this
->
	`g‘FromZArchive
(
$z
, 
$·thR–s
);

1966 ià(
$d©aR–s
) {

1968 
$UIR–s
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
(
$d©aR–s
), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

1969 ià(
$UIR–s
) {

1971 
	`fÜ—ch
 (
$UIR–s
->
R–©iÚsh
 
as
 
$–e
) {

1972 ià(
$–e
["Type"] == 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image') {

1974 
$cu¡omUIImagesNames
[(
¡ršg
è
$–e
['Id']] = (string)$ele['Target'];

1975 
$cu¡omUIImagesBš¬›s
[(
¡ršg
)
$–e
['T¬g‘']] = 
$this
->
	`g‘FromZArchive
(
$z
, 
$ba£Dœ
 . '/' . (string) $ele['Target']);

1980 ià(
$loÿlRibbÚ
) {

1981 
$exûl
->
	`£tRibbÚXMLD©a
(
$cu¡omUIT¬g‘
, 
$loÿlRibbÚ
);

1982 ià(
	`couÁ
(
$cu¡omUIImagesNames
è> 0 && couÁ(
$cu¡omUIImagesBš¬›s
) > 0) {

1983 
$exûl
->
	`£tRibbÚBšObjeùs
(
$cu¡omUIImagesNames
, 
$cu¡omUIImagesBš¬›s
);

1985 
$exûl
->
	`£tRibbÚBšObjeùs
(
nuÎ
);

1988 
$exûl
->
	`£tRibbÚXMLD©a
(
nuÎ
);

1989 
$exûl
->
	`£tRibbÚBšObjeùs
(
nuÎ
);

1991 
	}
}

1993 
´iv©e
 
funùiÚ
 
	$g‘A¼ayI‹m
(
$¬¿y
, 
$key
 = 0)

1995  (
	`is£t
(
$¬¿y
[
$key
]è? $¬¿y[$key] : 
nuÎ
);

1996 
	}
}

1998 
´iv©e
 
funùiÚ
 
	$dœAdd
(
$ba£
, 
$add
)

2000  
	`´eg_»¶aû
('~[^/]+/\.\./~', '', 
	`dœÇme
(
$ba£
) . "/$add");

2001 
	}
}

2003 
´iv©e
 
funùiÚ
 
	$toCSSA¼ay
(
$¡yË
)

2005 
$¡yË
 = 
	`¡r_»¶aû
(
	`¬¿y
("\r","\n"), "", $style);

2007 
$‹mp
 = 
	`ex¶ode
(';', 
$¡yË
);

2008 
$¡yË
 = 
	`¬¿y
();

2009 
	`fÜ—ch
 (
$‹mp
 
as
 
$™em
) {

2010 
$™em
 = 
	`ex¶ode
(':', $item);

2012 ià(
	`¡½os
(
$™em
[1], 'px'è!=ğ
çl£
) {

2013 
$™em
[1] = 
	`¡r_»¶aû
('px', '', $item[1]);

2015 ià(
	`¡½os
(
$™em
[1], '±'è!=ğ
çl£
) {

2016 
$™em
[1] = 
	`¡r_»¶aû
('pt', '', $item[1]);

2017 
$™em
[1] = 
PHPExûl_Sh¬ed_FÚt
::
	`fÚtSizeToPix–s
($item[1]);

2019 ià(
	`¡½os
(
$™em
[1], 'š'è!=ğ
çl£
) {

2020 
$™em
[1] = 
	`¡r_»¶aû
('in', '', $item[1]);

2021 
$™em
[1] = 
PHPExûl_Sh¬ed_FÚt
::
	`šchSizeToPix–s
($item[1]);

2023 ià(
	`¡½os
(
$™em
[1], 'cm'è!=ğ
çl£
) {

2024 
$™em
[1] = 
	`¡r_»¶aû
('cm', '', $item[1]);

2025 
$™em
[1] = 
PHPExûl_Sh¬ed_FÚt
::
	`ûÁim‘”SizeToPix–s
($item[1]);

2028 
$¡yË
[
$™em
[0]] = $item[1];

2031  
$¡yË
;

2032 
	}
}

2034 
´iv©e
 
funùiÚ
 
	$boŞ—n
(
$v®ue
 = 
nuÎ
)

2036 ià(
	`is_objeù
(
$v®ue
)) {

2037 
$v®ue
 = (
¡ršg
) $value;

2039 ià(
	`is_num”ic
(
$v®ue
)) {

2040  (
boŞ
è
$v®ue
;

2042  (
$v®ue
 === 'true' || $value === 'TRUE');

2043 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel2007/Chart.php

1 <?
php


35 şas 
	cPHPExûl_R—d”_Exûl2007_Ch¬t


37 
´iv©e
 
funùiÚ
 
	$g‘A‰ribu‹
(
$compÚ’t
, 
$Çme
, 
$fÜm©
)

39 
$©Œibu‹s
 = 
$compÚ’t
->
	`©Œibu‹s
();

40 ià(
	`is£t
(
$©Œibu‹s
[
$Çme
])) {

41 ià(
$fÜm©
 == 'string') {

42  (
¡ršg
è
$©Œibu‹s
[
$Çme
];

43 } 
	`–£if
 (
$fÜm©
 == 'integer') {

44  (
š‹g”
è
$©Œibu‹s
[
$Çme
];

45 } 
	`–£if
 (
$fÜm©
 == 'boolean') {

46  (
boŞ—n
è(
$©Œibu‹s
[
$Çme
] ==ğ'0' || $©Œibu‹s[$Çme] !=ğ'Œue'è? 
çl£
 : 
Œue
;

48  (è
$©Œibu‹s
[
$Çme
];

51  
nuÎ
;

55 
´iv©e
 
funùiÚ
 
	$»adCŞÜ
(
$cŞÜ
, 
$background
 = 
çl£
)

57 ià(
	`is£t
(
$cŞÜ
["rgb"])) {

58  (
¡ršg
)
$cŞÜ
["rgb"];

59 } 
	`–£if
 (
	`is£t
(
$cŞÜ
["indexed"])) {

60  
PHPExûl_StyË_CŞÜ
::
	`šdexedCŞÜ
(
$cŞÜ
["šdexed"]-7, 
$background
)->
	`g‘ARGB
();

62 
	}
}

64 
public
 
funùiÚ
 
	$»adCh¬t
(
$ch¬tEËm’ts
, 
$ch¬tName
)

66 
$Çme¥aûsCh¬tM‘a
 = 
$ch¬tEËm’ts
->
	`g‘Name¥aûs
(
Œue
);

67 
$ch¬tEËm’tsC
 = 
$ch¬tEËm’ts
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']);

69 
$XaxisLab–
 = 
$YaxisLab–
 = 
$Ëg’d
 = 
$t™Ë
 = 
nuÎ
;

70 
$di¥BÏnksAs
 = 
$¶ÙVisOÆy
 = 
nuÎ
;

72 
	`fÜ—ch
 (
$ch¬tEËm’tsC
 
as
 
$ch¬tEËm’tKey
 => 
$ch¬tEËm’t
) {

73 
$ch¬tEËm’tKey
) {

75 
	`fÜ—ch
 (
$ch¬tEËm’t
 
as
 
$ch¬tD‘asKey
 => 
$ch¬tD‘as
) {

76 
$ch¬tD‘asC
 = 
$ch¬tD‘as
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']);

77 
$ch¬tD‘asKey
) {

79 
$¶ÙA»aLayout
 = 
$XaxisLabË
 = 
$YaxisLabË
 = 
nuÎ
;

80 
$¶ÙS”›s
 = 
$¶ÙA‰ribu‹s
 = 
	`¬¿y
();

81 
	`fÜ—ch
 (
$ch¬tD‘as
 
as
 
$ch¬tD‘aKey
 => 
$ch¬tD‘a
) {

82 
$ch¬tD‘aKey
) {

84 
$¶ÙA»aLayout
 = 
£lf
::
	`ch¬tLayoutD‘as
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 'plotArea');

87 ià(
	`is£t
(
$ch¬tD‘a
->
t™Ë
)) {

88 
$XaxisLab–
 = 
£lf
::
	`ch¬tT™Ë
(
$ch¬tD‘a
->
t™Ë
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']), $namespacesChartMeta, 'cat');

92 ià(
	`is£t
(
$ch¬tD‘a
->
t™Ë
)) {

93 
$XaxisLab–
 = 
£lf
::
	`ch¬tT™Ë
(
$ch¬tD‘a
->
t™Ë
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']), $namespacesChartMeta, 'cat');

97 ià(
	`is£t
(
$ch¬tD‘a
->
t™Ë
)) {

98 
$YaxisLab–
 = 
£lf
::
	`ch¬tT™Ë
(
$ch¬tD‘a
->
t™Ë
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']), $namespacesChartMeta, 'cat');

103 
$b¬DœeùiÚ
 = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
b¬Dœ
, 'val', 'string');

104 
$¶ÙS”
 = 
£lf
::
	`ch¬tD©aS”›s
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$ch¬tD‘aKey
);

105 
$¶ÙS”
->
	`£tPlÙDœeùiÚ
(
$b¬DœeùiÚ
);

106 
$¶ÙS”›s
[] = 
$¶ÙS”
;

107 
$¶ÙA‰ribu‹s
 = 
£lf
::
	`»adCh¬tA‰ribu‹s
(
$ch¬tD‘a
);

111 
$¶ÙS”›s
[] = 
£lf
::
	`ch¬tD©aS”›s
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$ch¬tD‘aKey
);

112 
$¶ÙA‰ribu‹s
 = 
£lf
::
	`»adCh¬tA‰ribu‹s
(
$ch¬tD‘a
);

116 
$¶ÙS”›s
[] = 
£lf
::
	`ch¬tD©aS”›s
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$ch¬tD‘aKey
);

117 
$¶ÙA‰ribu‹s
 = 
£lf
::
	`»adCh¬tA‰ribu‹s
(
$ch¬tD‘a
);

122 
$ex¶osiÚ
 = 
	`is£t
(
$ch¬tD‘a
->
£r
->
ex¶osiÚ
);

123 
$¶ÙS”
 = 
£lf
::
	`ch¬tD©aS”›s
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$ch¬tD‘aKey
);

124 
$¶ÙS”
->
	`£tPlÙStyË
(
$ex¶osiÚ
);

125 
$¶ÙS”›s
[] = 
$¶ÙS”
;

126 
$¶ÙA‰ribu‹s
 = 
£lf
::
	`»adCh¬tA‰ribu‹s
(
$ch¬tD‘a
);

129 
$sÿ‰”StyË
 = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
sÿ‰”StyË
, 'val', 'string');

130 
$¶ÙS”
 = 
£lf
::
	`ch¬tD©aS”›s
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$ch¬tD‘aKey
);

131 
$¶ÙS”
->
	`£tPlÙStyË
(
$sÿ‰”StyË
);

132 
$¶ÙS”›s
[] = 
$¶ÙS”
;

133 
$¶ÙA‰ribu‹s
 = 
£lf
::
	`»adCh¬tA‰ribu‹s
(
$ch¬tD‘a
);

136 
$bubbËSÿË
 = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
bubbËSÿË
, 'val', 'integer');

137 
$¶ÙS”
 = 
£lf
::
	`ch¬tD©aS”›s
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$ch¬tD‘aKey
);

138 
$¶ÙS”
->
	`£tPlÙStyË
(
$bubbËSÿË
);

139 
$¶ÙS”›s
[] = 
$¶ÙS”
;

140 
$¶ÙA‰ribu‹s
 = 
£lf
::
	`»adCh¬tA‰ribu‹s
(
$ch¬tD‘a
);

143 
$¿d¬StyË
 = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
¿d¬StyË
, 'val', 'string');

144 
$¶ÙS”
 = 
£lf
::
	`ch¬tD©aS”›s
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$ch¬tD‘aKey
);

145 
$¶ÙS”
->
	`£tPlÙStyË
(
$¿d¬StyË
);

146 
$¶ÙS”›s
[] = 
$¶ÙS”
;

147 
$¶ÙA‰ribu‹s
 = 
£lf
::
	`»adCh¬tA‰ribu‹s
(
$ch¬tD‘a
);

151 
$wœeF¿me
 = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
wœeäame
, 'val', 'boolean');

152 
$¶ÙS”
 = 
£lf
::
	`ch¬tD©aS”›s
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$ch¬tD‘aKey
);

153 
$¶ÙS”
->
	`£tPlÙStyË
(
$wœeF¿me
);

154 
$¶ÙS”›s
[] = 
$¶ÙS”
;

155 
$¶ÙA‰ribu‹s
 = 
£lf
::
	`»adCh¬tA‰ribu‹s
(
$ch¬tD‘a
);

158 
$¶ÙS”›s
[] = 
£lf
::
	`ch¬tD©aS”›s
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$ch¬tD‘aKey
);

159 
$¶ÙA‰ribu‹s
 = 
£lf
::
	`»adCh¬tA‰ribu‹s
(
$¶ÙA»aLayout
);

163 ià(
$¶ÙA»aLayout
 =ğ
nuÎ
) {

164 
$¶ÙA»aLayout
 = 
Ãw
 
	`PHPExûl_Ch¬t_Layout
();

166 
$¶ÙA»a
 = 
Ãw
 
	`PHPExûl_Ch¬t_PlÙA»a
(
$¶ÙA»aLayout
, 
$¶ÙS”›s
);

167 
£lf
::
	`£tCh¬tA‰ribu‹s
(
$¶ÙA»aLayout
, 
$¶ÙA‰ribu‹s
);

170 
$¶ÙVisOÆy
 = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘as
, 'val', 'string');

173 
$di¥BÏnksAs
 = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘as
, 'val', 'string');

176 
$t™Ë
 = 
£lf
::
	`ch¬tT™Ë
(
$ch¬tD‘as
, 
$Çme¥aûsCh¬tM‘a
, 'title');

179 
$Ëg’dPos
 = 'r';

180 
$Ëg’dLayout
 = 
nuÎ
;

181 
$Ëg’dOv”Ïy
 = 
çl£
;

182 
	`fÜ—ch
 (
$ch¬tD‘as
 
as
 
$ch¬tD‘aKey
 => 
$ch¬tD‘a
) {

183 
$ch¬tD‘aKey
) {

185 
$Ëg’dPos
 = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
, 'val', 'string');

188 
$Ëg’dOv”Ïy
 = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
, 'val', 'boolean');

191 
$Ëg’dLayout
 = 
£lf
::
	`ch¬tLayoutD‘as
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 'legend');

195 
$Ëg’d
 = 
Ãw
 
	`PHPExûl_Ch¬t_Leg’d
(
$Ëg’dPos
, 
$Ëg’dLayout
, 
$Ëg’dOv”Ïy
);

201 
$ch¬t
 = 
Ãw
 
	`PHPExûl_Ch¬t
(
$ch¬tName
, 
$t™Ë
, 
$Ëg’d
, 
$¶ÙA»a
, 
$¶ÙVisOÆy
, 
$di¥BÏnksAs
, 
$XaxisLab–
, 
$YaxisLab–
);

203  
$ch¬t
;

204 
	}
}

206 
´iv©e
 
funùiÚ
 
	$ch¬tT™Ë
(
$t™ËD‘as
, 
$Çme¥aûsCh¬tM‘a
, 
$ty³
)

208 
$ÿ±iÚ
 = 
	`¬¿y
();

209 
$t™ËLayout
 = 
nuÎ
;

210 
	`fÜ—ch
 (
$t™ËD‘as
 
as
 
$t™ËD‘aKey
 => 
$ch¬tD‘a
) {

211 
$t™ËD‘aKey
) {

213 
$t™ËD‘as
 = 
$ch¬tD‘a
->
rich
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['a']);

214 
	`fÜ—ch
 (
$t™ËD‘as
 
as
 
$t™ËKey
 => 
$t™ËD‘a
) {

215 
$t™ËKey
) {

217 
$t™ËD‘aP¬t
 = 
$t™ËD‘a
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['a']);

218 
$ÿ±iÚ
[] = 
£lf
::
	`·r£RichText
(
$t™ËD‘aP¬t
);

223 
$t™ËLayout
 = 
£lf
::
	`ch¬tLayoutD‘as
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
);

228  
Ãw
 
	`PHPExûl_Ch¬t_T™Ë
(
$ÿ±iÚ
, 
$t™ËLayout
);

229 
	}
}

231 
´iv©e
 
funùiÚ
 
	$ch¬tLayoutD‘as
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
)

233 ià(!
	`is£t
(
$ch¬tD‘a
->
mªu®Layout
)) {

234  
nuÎ
;

236 
$d‘as
 = 
$ch¬tD‘a
->
mªu®Layout
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']);

237 ià(
	`is_nuÎ
(
$d‘as
)) {

238  
nuÎ
;

240 
$Ïyout
 = 
	`¬¿y
();

241 
	`fÜ—ch
 (
$d‘as
 
as
 
$d‘aKey
 => 
$d‘a
) {

243 
$Ïyout
[
$d‘aKey
] = 
£lf
::
	`g‘A‰ribu‹
(
$d‘a
, 'val', 'string');

245  
Ãw
 
	`PHPExûl_Ch¬t_Layout
(
$Ïyout
);

246 
	}
}

248 
´iv©e
 
funùiÚ
 
	$ch¬tD©aS”›s
(
$ch¬tD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$¶ÙTy³
)

250 
$muÉiS”›sTy³
 = 
nuÎ
;

251 
$smoÙhLše
 = 
çl£
;

252 
$£r›sLab–
 = 
$£r›sC©egÜy
 = 
$£r›sV®ues
 = 
$¶ÙOrd”
 = 
	`¬¿y
();

254 
$£r›sD‘aS‘
 = 
$ch¬tD‘a
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']);

255 
	`fÜ—ch
 (
$£r›sD‘aS‘
 
as
 
$£r›sD‘aKey
 => 
$£r›sD‘as
) {

256 
$£r›sD‘aKey
) {

258 
$muÉiS”›sTy³
 = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
groupšg
, 'val', 'string');

261 
$m¬k”
 = 
nuÎ
;

262 
	`fÜ—ch
 (
$£r›sD‘as
 
as
 
$£r›sKey
 => 
$£r›sD‘a
) {

263 
$£r›sKey
) {

265 
$£r›sIndex
 = 
£lf
::
	`g‘A‰ribu‹
(
$£r›sD‘a
, 'val', 'integer');

268 
$£r›sOrd”
 = 
£lf
::
	`g‘A‰ribu‹
(
$£r›sD‘a
, 'val', 'integer');

269 
$¶ÙOrd”
[
$£r›sIndex
] = 
$£r›sOrd”
;

272 
$£r›sLab–
[
$£r›sIndex
] = 
£lf
::
	`ch¬tD©aS”›sV®ueS‘
(
$£r›sD‘a
, 
$Çme¥aûsCh¬tM‘a
);

275 
$m¬k”
 = 
£lf
::
	`g‘A‰ribu‹
(
$£r›sD‘a
->
symbŞ
, 'val', 'string');

278 
$smoÙhLše
 = 
£lf
::
	`g‘A‰ribu‹
(
$£r›sD‘a
, 'val', 'boolean');

281 
$£r›sC©egÜy
[
$£r›sIndex
] = 
£lf
::
	`ch¬tD©aS”›sV®ueS‘
(
$£r›sD‘a
, 
$Çme¥aûsCh¬tM‘a
);

284 
$£r›sV®ues
[
$£r›sIndex
] = 
£lf
::
	`ch¬tD©aS”›sV®ueS‘
(
$£r›sD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$m¬k”
);

287 
$£r›sC©egÜy
[
$£r›sIndex
] = 
£lf
::
	`ch¬tD©aS”›sV®ueS‘
(
$£r›sD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$m¬k”
);

290 
$£r›sV®ues
[
$£r›sIndex
] = 
£lf
::
	`ch¬tD©aS”›sV®ueS‘
(
$£r›sD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$m¬k”
);

296  
Ãw
 
	`PHPExûl_Ch¬t_D©aS”›s
(
$¶ÙTy³
, 
$muÉiS”›sTy³
, 
$¶ÙOrd”
, 
$£r›sLab–
, 
$£r›sC©egÜy
, 
$£r›sV®ues
, 
$smoÙhLše
);

297 
	}
}

300 
´iv©e
 
funùiÚ
 
	$ch¬tD©aS”›sV®ueS‘
(
$£r›sD‘a
, 
$Çme¥aûsCh¬tM‘a
, 
$m¬k”
 = 
nuÎ
, 
$smoÙhLše
 = 
çl£
)

302 ià(
	`is£t
(
$£r›sD‘a
->
¡rRef
)) {

303 
$£r›sSourû
 = (
¡ršg
è
$£r›sD‘a
->
¡rRef
->
f
;

304 
$£r›sD©a
 = 
£lf
::
	`ch¬tD©aS”›sV®ues
(
$£r›sD‘a
->
¡rRef
->
¡rCache
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']), 's');

306  
Ãw
 
	`PHPExûl_Ch¬t_D©aS”›sV®ues
('SŒšg', 
$£r›sSourû
, 
$£r›sD©a
['fÜm©Code'], $£r›sD©a['poštCouÁ'], $£r›sD©a['d©aV®ues'], 
$m¬k”
, 
$smoÙhLše
);

307 } 
	`–£if
 (
	`is£t
(
$£r›sD‘a
->
numRef
)) {

308 
$£r›sSourû
 = (
¡ršg
è
$£r›sD‘a
->
numRef
->
f
;

309 
$£r›sD©a
 = 
£lf
::
	`ch¬tD©aS”›sV®ues
(
$£r›sD‘a
->
numRef
->
numCache
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']));

311  
Ãw
 
	`PHPExûl_Ch¬t_D©aS”›sV®ues
('Numb”', 
$£r›sSourû
, 
$£r›sD©a
['fÜm©Code'], $£r›sD©a['poštCouÁ'], $£r›sD©a['d©aV®ues'], 
$m¬k”
, 
$smoÙhLše
);

312 } 
	`–£if
 (
	`is£t
(
$£r›sD‘a
->
muÉiLvlSŒRef
)) {

313 
$£r›sSourû
 = (
¡ršg
è
$£r›sD‘a
->
muÉiLvlSŒRef
->
f
;

314 
$£r›sD©a
 = 
£lf
::
	`ch¬tD©aS”›sV®uesMuÉiLev–
(
$£r›sD‘a
->
muÉiLvlSŒRef
->
muÉiLvlSŒCache
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']), 's');

315 
$£r›sD©a
['poštCouÁ'] = 
	`couÁ
($seriesData['dataValues']);

317  
Ãw
 
	`PHPExûl_Ch¬t_D©aS”›sV®ues
('SŒšg', 
$£r›sSourû
, 
$£r›sD©a
['fÜm©Code'], $£r›sD©a['poštCouÁ'], $£r›sD©a['d©aV®ues'], 
$m¬k”
, 
$smoÙhLše
);

318 } 
	`–£if
 (
	`is£t
(
$£r›sD‘a
->
muÉiLvlNumRef
)) {

319 
$£r›sSourû
 = (
¡ršg
è
$£r›sD‘a
->
muÉiLvlNumRef
->
f
;

320 
$£r›sD©a
 = 
£lf
::
	`ch¬tD©aS”›sV®uesMuÉiLev–
(
$£r›sD‘a
->
muÉiLvlNumRef
->
muÉiLvlNumCache
->
	`chd»n
(
$Çme¥aûsCh¬tM‘a
['c']), 's');

321 
$£r›sD©a
['poštCouÁ'] = 
	`couÁ
($seriesData['dataValues']);

323  
Ãw
 
	`PHPExûl_Ch¬t_D©aS”›sV®ues
('SŒšg', 
$£r›sSourû
, 
$£r›sD©a
['fÜm©Code'], $£r›sD©a['poštCouÁ'], $£r›sD©a['d©aV®ues'], 
$m¬k”
, 
$smoÙhLše
);

325  
nuÎ
;

326 
	}
}

329 
´iv©e
 
funùiÚ
 
ch¬tD©aS”›sV®ues
(
$£r›sV®ueS‘
, 
$d©aTy³
 = 'n')

331 
$£r›sV®
 = 
¬¿y
();

332 
	g$fÜm©Code
 = '';

333 
	g$poštCouÁ
 = 0;

335 
fÜ—ch
 (
$£r›sV®ueS‘
 
as
 
$£r›sV®ueIdx
 => 
$£r›sV®ue
) {

336 
$£r›sV®ueIdx
) {

338 
$poštCouÁ
 = 
£lf
::
g‘A‰ribu‹
(
$£r›sV®ue
, 'val', 'integer');

341 
$fÜm©Code
 = (
¡ršg
è
$£r›sV®ue
;

344 
$poštV®
 = 
£lf
::
g‘A‰ribu‹
(
$£r›sV®ue
, 'idx', 'integer');

345 ià(
	g$d©aTy³
 == 's') {

346 
$£r›sV®
[
$poštV®
] = (
¡ršg
è
$£r›sV®ue
->
v
;

348 
	g$£r›sV®
[
$poštV®
] = (è
$£r›sV®ue
->
v
;

354 ià(
em±y
(
$£r›sV®
)) {

355 
	g$£r›sV®
 = 
nuÎ
;

358  
¬¿y
(

359 'fÜm©Code' => 
$fÜm©Code
,

360 'poštCouÁ' => 
$poštCouÁ
,

361 'd©aV®ues' => 
$£r›sV®


365 
´iv©e
 
funùiÚ
 
ch¬tD©aS”›sV®uesMuÉiLev–
(
$£r›sV®ueS‘
, 
$d©aTy³
 = 'n')

367 
$£r›sV®
 = 
¬¿y
();

368 
	g$fÜm©Code
 = '';

369 
	g$poštCouÁ
 = 0;

371 
fÜ—ch
 (
$£r›sV®ueS‘
->
lvl
 
as
 
$£r›sLev–Idx
 => 
$£r›sLev–
) {

372 
fÜ—ch
 (
$£r›sLev–
 
as
 
$£r›sV®ueIdx
 => 
$£r›sV®ue
) {

373 
$£r›sV®ueIdx
) {

375 
$poštCouÁ
 = 
£lf
::
g‘A‰ribu‹
(
$£r›sV®ue
, 'val', 'integer');

378 
$fÜm©Code
 = (
¡ršg
è
$£r›sV®ue
;

381 
$poštV®
 = 
£lf
::
g‘A‰ribu‹
(
$£r›sV®ue
, 'idx', 'integer');

382 ià(
	g$d©aTy³
 == 's') {

383 
$£r›sV®
[
$poštV®
][] = (
¡ršg
è
$£r›sV®ue
->
v
;

385 
	g$£r›sV®
[
$poštV®
][] = (è
$£r›sV®ue
->
v
;

392  
¬¿y
(

393 'fÜm©Code' => 
$fÜm©Code
,

394 'poštCouÁ' => 
$poštCouÁ
,

395 'd©aV®ues' => 
$£r›sV®


399 
´iv©e
 
funùiÚ
 
	$·r£RichText
(
$t™ËD‘aP¬t
 = 
nuÎ
)

401 
$v®ue
 = 
Ãw
 
	`PHPExûl_RichText
();

403 
	`fÜ—ch
 (
$t™ËD‘aP¬t
 
as
 
$t™ËD‘aEËm’tKey
 => 
$t™ËD‘aEËm’t
) {

404 ià(
	`is£t
(
$t™ËD‘aEËm’t
->
t
)) {

405 
$objText
 = 
$v®ue
->
	`ü—‹TextRun
((
¡ršg
è
$t™ËD‘aEËm’t
->
t
);

407 ià(
	`is£t
(
$t™ËD‘aEËm’t
->
rPr
)) {

408 ià(
	`is£t
(
$t™ËD‘aEËm’t
->
rPr
->
rFÚt
["val"])) {

409 
$objText
->
	`g‘FÚt
()->
	`£tName
((
¡ršg
è
$t™ËD‘aEËm’t
->
rPr
->
rFÚt
["val"]);

412 
$fÚtSize
 = (
£lf
::
	`g‘A‰ribu‹
(
$t™ËD‘aEËm’t
->
rPr
, 'sz', 'integer'));

413 ià(!
	`is_nuÎ
(
$fÚtSize
)) {

414 
$objText
->
	`g‘FÚt
()->
	`£tSize
(
	`æoÜ
(
$fÚtSize
 / 100));

417 
$fÚtCŞÜ
 = (
£lf
::
	`g‘A‰ribu‹
(
$t™ËD‘aEËm’t
->
rPr
, 'color', 'string'));

418 ià(!
	`is_nuÎ
(
$fÚtCŞÜ
)) {

419 
$objText
->
	`g‘FÚt
()->
	`£tCŞÜ
(
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
£lf
::
	`»adCŞÜ
(
$fÚtCŞÜ
)));

422 
$bŞd
 = 
£lf
::
	`g‘A‰ribu‹
(
$t™ËD‘aEËm’t
->
rPr
, 'b', 'boolean');

423 ià(!
	`is_nuÎ
(
$bŞd
)) {

424 
$objText
->
	`g‘FÚt
()->
	`£tBŞd
(
$bŞd
);

427 
$™®ic
 = 
£lf
::
	`g‘A‰ribu‹
(
$t™ËD‘aEËm’t
->
rPr
, 'i', 'boolean');

428 ià(!
	`is_nuÎ
(
$™®ic
)) {

429 
$objText
->
	`g‘FÚt
()->
	`£tIlic
(
$™®ic
);

432 
$ba£lše
 = 
£lf
::
	`g‘A‰ribu‹
(
$t™ËD‘aEËm’t
->
rPr
, 'baseline', 'integer');

433 ià(!
	`is_nuÎ
(
$ba£lše
)) {

434 ià(
$ba£lše
 > 0) {

435 
$objText
->
	`g‘FÚt
()->
	`£tSu³rSüt
(
Œue
);

436 } 
	`–£if
 (
$ba£lše
 < 0) {

437 
$objText
->
	`g‘FÚt
()->
	`£tSubSüt
(
Œue
);

441 
$und”scÜe
 = (
£lf
::
	`g‘A‰ribu‹
(
$t™ËD‘aEËm’t
->
rPr
, 'u', 'string'));

442 ià(!
	`is_nuÎ
(
$und”scÜe
)) {

443 ià(
$und”scÜe
 == 'sng') {

444 
$objText
->
	`g‘FÚt
()->
	`£tUnd”lše
(
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLE
);

445 } 
	`–£if
 (
$und”scÜe
 == 'dbl') {

446 
$objText
->
	`g‘FÚt
()->
	`£tUnd”lše
(
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLE
);

448 
$objText
->
	`g‘FÚt
()->
	`£tUnd”lše
(
PHPExûl_StyË_FÚt
::
UNDERLINE_NONE
);

452 
$¡rik‘hrough
 = (
£lf
::
	`g‘A‰ribu‹
(
$t™ËD‘aEËm’t
->
rPr
, 's', 'string'));

453 ià(!
	`is_nuÎ
(
$¡rik‘hrough
)) {

454 ià(
$¡rik‘hrough
 == 'noStrike') {

455 
$objText
->
	`g‘FÚt
()->
	`£tSŒik‘hrough
(
çl£
);

457 
$objText
->
	`g‘FÚt
()->
	`£tSŒik‘hrough
(
Œue
);

463  
$v®ue
;

464 
	}
}

466 
´iv©e
 
funùiÚ
 
	$»adCh¬tA‰ribu‹s
(
$ch¬tD‘a
)

468 
$¶ÙA‰ribu‹s
 = 
	`¬¿y
();

469 ià(
	`is£t
(
$ch¬tD‘a
->
dLbls
)) {

470 ià(
	`is£t
(
$ch¬tD‘a
->
dLbls
->
howLeg’dKey
)) {

471 
$¶ÙA‰ribu‹s
['showLeg’dKey'] = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
dLbls
->
showLeg’dKey
, 'val', 'string');

473 ià(
	`is£t
(
$ch¬tD‘a
->
dLbls
->
showV®
)) {

474 
$¶ÙA‰ribu‹s
['showV®'] = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
dLbls
->
showV®
, 'val', 'string');

476 ià(
	`is£t
(
$ch¬tD‘a
->
dLbls
->
showC©Name
)) {

477 
$¶ÙA‰ribu‹s
['showC©Name'] = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
dLbls
->
showC©Name
, 'val', 'string');

479 ià(
	`is£t
(
$ch¬tD‘a
->
dLbls
->
showS”Name
)) {

480 
$¶ÙA‰ribu‹s
['showS”Name'] = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
dLbls
->
showS”Name
, 'val', 'string');

482 ià(
	`is£t
(
$ch¬tD‘a
->
dLbls
->
showP”ûÁ
)) {

483 
$¶ÙA‰ribu‹s
['showP”ûÁ'] = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
dLbls
->
showP”ûÁ
, 'val', 'string');

485 ià(
	`is£t
(
$ch¬tD‘a
->
dLbls
->
showBubbËSize
)) {

486 
$¶ÙA‰ribu‹s
['showBubbËSize'] = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
dLbls
->
showBubbËSize
, 'val', 'string');

488 ià(
	`is£t
(
$ch¬tD‘a
->
dLbls
->
showL—d”Lšes
)) {

489 
$¶ÙA‰ribu‹s
['showL—d”Lšes'] = 
£lf
::
	`g‘A‰ribu‹
(
$ch¬tD‘a
->
dLbls
->
showL—d”Lšes
, 'val', 'string');

493  
$¶ÙA‰ribu‹s
;

494 
	}
}

496 
´iv©e
 
funùiÚ
 
	$£tCh¬tA‰ribu‹s
(
$¶ÙA»a
, 
$¶ÙA‰ribu‹s
)

498 
	`fÜ—ch
 (
$¶ÙA‰ribu‹s
 
as
 
$¶ÙA‰ribu‹Key
 => 
$¶ÙA‰ribu‹V®ue
) {

499 
$¶ÙA‰ribu‹Key
) {

501 
$¶ÙA»a
->
	`£tShowLeg’dKey
(
$¶ÙA‰ribu‹V®ue
);

504 
$¶ÙA»a
->
	`£tShowV®
(
$¶ÙA‰ribu‹V®ue
);

507 
$¶ÙA»a
->
	`£tShowC©Name
(
$¶ÙA‰ribu‹V®ue
);

510 
$¶ÙA»a
->
	`£tShowS”Name
(
$¶ÙA‰ribu‹V®ue
);

513 
$¶ÙA»a
->
	`£tShowP”ûÁ
(
$¶ÙA‰ribu‹V®ue
);

516 
$¶ÙA»a
->
	`£tShowBubbËSize
(
$¶ÙA‰ribu‹V®ue
);

519 
$¶ÙA»a
->
	`£tShowL—d”Lšes
(
$¶ÙA‰ribu‹V®ue
);

523 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel2007/Theme.php

1 <?
php


36 şas 
	cPHPExûl_R—d”_Exûl2007_Theme


43 
´iv©e
 
	m$themeName
;

50 
´iv©e
 
	m$cŞourSchemeName
;

57 
´iv©e
 
	m$cŞourM­V®ues
;

65 
´iv©e
 
	m$cŞourM­
;

72 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$themeName
, 
$cŞourSchemeName
, 
$cŞourM­
)

75 
$this
->
themeName
 = 
$themeName
;

76 
$this
->
cŞourSchemeName
 = 
$cŞourSchemeName
;

77 
$this
->
cŞourM­
 = 
$cŞourM­
;

85 
public
 
funùiÚ
 
	$g‘ThemeName
()

87  
$this
->
themeName
;

88 
	}
}

95 
public
 
funùiÚ
 
	$g‘CŞourSchemeName
()

97  
$this
->
cŞourSchemeName
;

98 
	}
}

105 
public
 
funùiÚ
 
	$g‘CŞourByIndex
(
$šdex
 = 0)

107 ià(
	`is£t
(
$this
->
cŞourM­
[
$šdex
])) {

108  
$this
->
cŞourM­
[
$šdex
];

110  
nuÎ
;

111 
	}
}

116 
public
 
funùiÚ
 
	$__şÚe
()

118 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

119 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

120 ià((
	`is_objeù
(
$v®ue
)è&& (
$key
 != '_parent')) {

121 
$this
->
$key
 = 
şÚe
 
$v®ue
;

123 
$this
->
$key
 = 
$v®ue
;

126 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel5.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

68 şas 
	cPHPExûl_R—d”_Exûl5
 
ex‹nds
 
PHPExûl_R—d”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_R—d”_IR—d”


71 cÚ¡ 
	mXLS_BIFF8
 = 0x0600;

72 cÚ¡ 
	mXLS_BIFF7
 = 0x0500;

73 cÚ¡ 
	mXLS_WÜkbookGlob®s
 = 0x0005;

74 cÚ¡ 
	mXLS_WÜksh“t
 = 0x0010;

77 cÚ¡ 
	mXLS_TYPE_FORMULA
 = 0x0006;

78 cÚ¡ 
	mXLS_TYPE_EOF
 = 0x000a;

79 cÚ¡ 
	mXLS_TYPE_PROTECT
 = 0x0012;

80 cÚ¡ 
	mXLS_TYPE_OBJECTPROTECT
 = 0x0063;

81 cÚ¡ 
	mXLS_TYPE_SCENPROTECT
 = 0x00dd;

82 cÚ¡ 
	mXLS_TYPE_PASSWORD
 = 0x0013;

83 cÚ¡ 
	mXLS_TYPE_HEADER
 = 0x0014;

84 cÚ¡ 
	mXLS_TYPE_FOOTER
 = 0x0015;

85 cÚ¡ 
	mXLS_TYPE_EXTERNSHEET
 = 0x0017;

86 cÚ¡ 
	mXLS_TYPE_DEFINEDNAME
 = 0x0018;

87 cÚ¡ 
	mXLS_TYPE_VERTICALPAGEBREAKS
 = 0x001a;

88 cÚ¡ 
	mXLS_TYPE_HORIZONTALPAGEBREAKS
 = 0x001b;

89 cÚ¡ 
	mXLS_TYPE_NOTE
 = 0x001c;

90 cÚ¡ 
	mXLS_TYPE_SELECTION
 = 0x001d;

91 cÚ¡ 
	mXLS_TYPE_DATEMODE
 = 0x0022;

92 cÚ¡ 
	mXLS_TYPE_EXTERNNAME
 = 0x0023;

93 cÚ¡ 
	mXLS_TYPE_LEFTMARGIN
 = 0x0026;

94 cÚ¡ 
	mXLS_TYPE_RIGHTMARGIN
 = 0x0027;

95 cÚ¡ 
	mXLS_TYPE_TOPMARGIN
 = 0x0028;

96 cÚ¡ 
	mXLS_TYPE_BOTTOMMARGIN
 = 0x0029;

97 cÚ¡ 
	mXLS_TYPE_PRINTGRIDLINES
 = 0x002b;

98 cÚ¡ 
	mXLS_TYPE_FILEPASS
 = 0x002f;

99 cÚ¡ 
	mXLS_TYPE_FONT
 = 0x0031;

100 cÚ¡ 
	mXLS_TYPE_CONTINUE
 = 0x003c;

101 cÚ¡ 
	mXLS_TYPE_PANE
 = 0x0041;

102 cÚ¡ 
	mXLS_TYPE_CODEPAGE
 = 0x0042;

103 cÚ¡ 
	mXLS_TYPE_DEFCOLWIDTH
 = 0x0055;

104 cÚ¡ 
	mXLS_TYPE_OBJ
 = 0x005d;

105 cÚ¡ 
	mXLS_TYPE_COLINFO
 = 0x007d;

106 cÚ¡ 
	mXLS_TYPE_IMDATA
 = 0x007f;

107 cÚ¡ 
	mXLS_TYPE_SHEETPR
 = 0x0081;

108 cÚ¡ 
	mXLS_TYPE_HCENTER
 = 0x0083;

109 cÚ¡ 
	mXLS_TYPE_VCENTER
 = 0x0084;

110 cÚ¡ 
	mXLS_TYPE_SHEET
 = 0x0085;

111 cÚ¡ 
	mXLS_TYPE_PALETTE
 = 0x0092;

112 cÚ¡ 
	mXLS_TYPE_SCL
 = 0x00a0;

113 cÚ¡ 
	mXLS_TYPE_PAGESETUP
 = 0x00a1;

114 cÚ¡ 
	mXLS_TYPE_MULRK
 = 0x00bd;

115 cÚ¡ 
	mXLS_TYPE_MULBLANK
 = 0x00be;

116 cÚ¡ 
	mXLS_TYPE_DBCELL
 = 0x00d7;

117 cÚ¡ 
	mXLS_TYPE_XF
 = 0x00e0;

118 cÚ¡ 
	mXLS_TYPE_MERGEDCELLS
 = 0x00e5;

119 cÚ¡ 
	mXLS_TYPE_MSODRAWINGGROUP
 = 0x00eb;

120 cÚ¡ 
	mXLS_TYPE_MSODRAWING
 = 0x00ec;

121 cÚ¡ 
	mXLS_TYPE_SST
 = 0x00fc;

122 cÚ¡ 
	mXLS_TYPE_LABELSST
 = 0x00fd;

123 cÚ¡ 
	mXLS_TYPE_EXTSST
 = 0x00ff;

124 cÚ¡ 
	mXLS_TYPE_EXTERNALBOOK
 = 0x01ae;

125 cÚ¡ 
	mXLS_TYPE_DATAVALIDATIONS
 = 0x01b2;

126 cÚ¡ 
	mXLS_TYPE_TXO
 = 0x01b6;

127 cÚ¡ 
	mXLS_TYPE_HYPERLINK
 = 0x01b8;

128 cÚ¡ 
	mXLS_TYPE_DATAVALIDATION
 = 0x01be;

129 cÚ¡ 
	mXLS_TYPE_DIMENSION
 = 0x0200;

130 cÚ¡ 
	mXLS_TYPE_BLANK
 = 0x0201;

131 cÚ¡ 
	mXLS_TYPE_NUMBER
 = 0x0203;

132 cÚ¡ 
	mXLS_TYPE_LABEL
 = 0x0204;

133 cÚ¡ 
	mXLS_TYPE_BOOLERR
 = 0x0205;

134 cÚ¡ 
	mXLS_TYPE_STRING
 = 0x0207;

135 cÚ¡ 
	mXLS_TYPE_ROW
 = 0x0208;

136 cÚ¡ 
	mXLS_TYPE_INDEX
 = 0x020b;

137 cÚ¡ 
	mXLS_TYPE_ARRAY
 = 0x0221;

138 cÚ¡ 
	mXLS_TYPE_DEFAULTROWHEIGHT
 = 0x0225;

139 cÚ¡ 
	mXLS_TYPE_WINDOW2
 = 0x023e;

140 cÚ¡ 
	mXLS_TYPE_RK
 = 0x027e;

141 cÚ¡ 
	mXLS_TYPE_STYLE
 = 0x0293;

142 cÚ¡ 
	mXLS_TYPE_FORMAT
 = 0x041e;

143 cÚ¡ 
	mXLS_TYPE_SHAREDFMLA
 = 0x04bc;

144 cÚ¡ 
	mXLS_TYPE_BOF
 = 0x0809;

145 cÚ¡ 
	mXLS_TYPE_SHEETPROTECTION
 = 0x0867;

146 cÚ¡ 
	mXLS_TYPE_RANGEPROTECTION
 = 0x0868;

147 cÚ¡ 
	mXLS_TYPE_SHEETLAYOUT
 = 0x0862;

148 cÚ¡ 
	mXLS_TYPE_XFEXT
 = 0x087d;

149 cÚ¡ 
	mXLS_TYPE_PAGELAYOUTVIEW
 = 0x088b;

150 cÚ¡ 
	mXLS_TYPE_UNKNOWN
 = 0xffff;

153 cÚ¡ 
	mMS_BIFF_CRYPTO_NONE
 = 0;

154 cÚ¡ 
	mMS_BIFF_CRYPTO_XOR
 = 1;

155 cÚ¡ 
	mMS_BIFF_CRYPTO_RC4
 = 2;

158 cÚ¡ 
	mREKEY_BLOCK
 = 0x400;

165 
´iv©e
 
	m$summ¬yInfÜm©iÚ
;

172 
´iv©e
 
	m$docum’tSumm¬yInfÜm©iÚ
;

179 
´iv©e
 
	m$u£rDefšedPrİ”t›s
;

186 
´iv©e
 
	m$d©a
;

193 
´iv©e
 
	m$d©aSize
;

200 
´iv©e
 
	m$pos
;

207 
´iv©e
 
	m$phpExûl
;

214 
´iv©e
 
	m$phpSh“t
;

221 
´iv©e
 
	m$v”siÚ
;

229 
´iv©e
 
	m$cod•age
;

236 
´iv©e
 
	m$fÜm©s
;

243 
´iv©e
 
	m$objFÚts
;

250 
´iv©e
 
	m$·Ë‰e
;

257 
´iv©e
 
	m$sh“ts
;

264 
´iv©e
 
	m$ex‹º®Books
;

271 
´iv©e
 
	m$»f
;

278 
´iv©e
 
	m$ex‹º®Names
;

285 
´iv©e
 
	m$defšedÇme
;

292 
´iv©e
 
	m$s¡
;

299 
´iv©e
 
	m$äoz’
;

306 
´iv©e
 
	m$isF™ToPages
;

313 
´iv©e
 
	m$objs
;

320 
´iv©e
 
	m$‹xtObjeùs
;

327 
´iv©e
 
	m$ûÎNÙes
;

334 
´iv©e
 
	m$d¿wšgGroupD©a
;

341 
´iv©e
 
	m$d¿wšgD©a
;

348 
´iv©e
 
	m$xfIndex
;

355 
´iv©e
 
	m$m­C–lXfIndex
;

362 
´iv©e
 
	m$m­C–lStyËXfIndex
;

369 
´iv©e
 
	m$sh¬edFÜmuÏs
;

377 
´iv©e
 
	m$sh¬edFÜmuÏP¬ts
;

384 
´iv©e
 
	m$’üy±iÚ
 = 0;

391 
´iv©e
 
	m$’üy±iÚS¹Pos
 = 
çl£
;

398 
´iv©e
 
	m$rc4Key
 = 
nuÎ
;

405 
´iv©e
 
	m$rc4Pos
 = 0;

412 
´iv©e
 
	m$md5Ctxt
 = 
nuÎ
;

417 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

419 
$this
->
»adF‹r
 = 
Ãw
 
	`PHPExûl_R—d”_DeçuÉR—dF‹r
();

429 
public
 
funùiÚ
 
	$ÿnR—d
(
$pF’ame
)

432 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

433 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

436 
Œy
 {

438 
$Şe
 = 
Ãw
 
	`PHPExûl_Sh¬ed_OLER—d
();

441 
$»s
 = 
$Şe
->
	`»ad
(
$pF’ame
);

442  
Œue
;

443 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

444  
çl£
;

446 
	}
}

454 
public
 
funùiÚ
 
	$li¡WÜksh“tNames
(
$pF’ame
)

457 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

458 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

461 
$wÜksh“tNames
 = 
	`¬¿y
();

464 
$this
->
	`lßdOLE
(
$pF’ame
);

467 
$this
->
d©aSize
 = 
	`¡¾’
($this->
d©a
);

469 
$this
->
pos
 = 0;

470 
$this
->
sh“ts
 = 
	`¬¿y
();

473 
$this
->
pos
 < $this->
d©aSize
) {

474 
$code
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
);

476 
$code
) {

477 
£lf
::
XLS_TYPE_BOF
:

478 
$this
->
	`»adBof
();

480 
£lf
::
XLS_TYPE_SHEET
:

481 
$this
->
	`»adSh“t
();

483 
£lf
::
XLS_TYPE_EOF
:

484 
$this
->
	`»adDeçuÉ
();

487 
$this
->
	`»adDeçuÉ
();

492 
	`fÜ—ch
 (
$this
->
sh“ts
 
as
 
$sh“t
) {

493 ià(
$sh“t
['sheetType'] != 0x00) {

498 
$wÜksh“tNames
[] = 
$sh“t
['name'];

501  
$wÜksh“tNames
;

502 
	}
}

511 
public
 
funùiÚ
 
	$li¡WÜksh“tInfo
(
$pF’ame
)

514 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

515 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

518 
$wÜksh“tInfo
 = 
	`¬¿y
();

521 
$this
->
	`lßdOLE
(
$pF’ame
);

524 
$this
->
d©aSize
 = 
	`¡¾’
($this->
d©a
);

527 
$this
->
pos
 = 0;

528 
$this
->
sh“ts
 = 
	`¬¿y
();

531 
$this
->
pos
 < $this->
d©aSize
) {

532 
$code
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
);

534 
$code
) {

535 
£lf
::
XLS_TYPE_BOF
:

536 
$this
->
	`»adBof
();

538 
£lf
::
XLS_TYPE_SHEET
:

539 
$this
->
	`»adSh“t
();

541 
£lf
::
XLS_TYPE_EOF
:

542 
$this
->
	`»adDeçuÉ
();

545 
$this
->
	`»adDeçuÉ
();

551 
	`fÜ—ch
 (
$this
->
sh“ts
 
as
 
$sh“t
) {

552 ià(
$sh“t
['sheetType'] != 0x00) {

559 
$tmpInfo
 = 
	`¬¿y
();

560 
$tmpInfo
['wÜksh“tName'] = 
$sh“t
['name'];

561 
$tmpInfo
['lastColumnLetter'] = 'A';

562 
$tmpInfo
['lastColumnIndex'] = 0;

563 
$tmpInfo
['totalRows'] = 0;

564 
$tmpInfo
['totalColumns'] = 0;

566 
$this
->
pos
 = 
$sh“t
['offset'];

568 
$this
->
pos
 <ğ$this->
d©aSize
 - 4) {

569 
$code
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
);

571 
$code
) {

572 
£lf
::
XLS_TYPE_RK
:

573 
£lf
::
XLS_TYPE_LABELSST
:

574 
£lf
::
XLS_TYPE_NUMBER
:

575 
£lf
::
XLS_TYPE_FORMULA
:

576 
£lf
::
XLS_TYPE_BOOLERR
:

577 
£lf
::
XLS_TYPE_LABEL
:

578 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

579 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

582 
$this
->
pos
 +ğ4 + 
$Ëngth
;

584 
$rowIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0) + 1;

585 
$cŞumnIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

587 
$tmpInfo
['tÙ®Rows'] = 
	`max
($tmpInfo['tÙ®Rows'], 
$rowIndex
);

588 
$tmpInfo
['Ï¡CŞumnIndex'] = 
	`max
($tmpInfo['Ï¡CŞumnIndex'], 
$cŞumnIndex
);

590 
£lf
::
XLS_TYPE_BOF
:

591 
$this
->
	`»adBof
();

593 
£lf
::
XLS_TYPE_EOF
:

594 
$this
->
	`»adDeçuÉ
();

597 
$this
->
	`»adDeçuÉ
();

602 
$tmpInfo
['Ï¡CŞumnL‘‹r'] = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($tmpInfo['lastColumnIndex']);

603 
$tmpInfo
['totalColumns'] = $tmpInfo['lastColumnIndex'] + 1;

605 
$wÜksh“tInfo
[] = 
$tmpInfo
;

608  
$wÜksh“tInfo
;

609 
	}
}

619 
public
 
funùiÚ
 
	$lßd
(
$pF’ame
)

622 
$this
->
	`lßdOLE
(
$pF’ame
);

625 
$this
->
phpExûl
 = 
Ãw
 
PHPExûl
;

626 
$this
->
phpExûl
->
	`»moveSh“tByIndex
(0);

627 ià(!
$this
->
»adD©aOÆy
) {

628 
$this
->
phpExûl
->
	`»moveC–lStyËXfByIndex
(0);

629 
$this
->
phpExûl
->
	`»moveC–lXfByIndex
(0);

633 
$this
->
	`»adSumm¬yInfÜm©iÚ
();

636 
$this
->
	`»adDocum’tSumm¬yInfÜm©iÚ
();

639 
$this
->
d©aSize
 = 
	`¡¾’
($this->
d©a
);

642 
$this
->
pos
 = 0;

643 
$this
->
cod•age
 = 'CP1252';

644 
$this
->
fÜm©s
 = 
	`¬¿y
();

645 
$this
->
objFÚts
 = 
	`¬¿y
();

646 
$this
->
·Ë‰e
 = 
	`¬¿y
();

647 
$this
->
sh“ts
 = 
	`¬¿y
();

648 
$this
->
ex‹º®Books
 = 
	`¬¿y
();

649 
$this
->
»f
 = 
	`¬¿y
();

650 
$this
->
defšedÇme
 = 
	`¬¿y
();

651 
$this
->
s¡
 = 
	`¬¿y
();

652 
$this
->
d¿wšgGroupD©a
 = '';

653 
$this
->
xfIndex
 = '';

654 
$this
->
m­C–lXfIndex
 = 
	`¬¿y
();

655 
$this
->
m­C–lStyËXfIndex
 = 
	`¬¿y
();

658 
$this
->
pos
 < $this->
d©aSize
) {

659 
$code
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
);

661 
$code
) {

662 
£lf
::
XLS_TYPE_BOF
:

663 
$this
->
	`»adBof
();

665 
£lf
::
XLS_TYPE_FILEPASS
:

666 
$this
->
	`»adF•ass
();

668 
£lf
::
XLS_TYPE_CODEPAGE
:

669 
$this
->
	`»adCod•age
();

671 
£lf
::
XLS_TYPE_DATEMODE
:

672 
$this
->
	`»adD©eMode
();

674 
£lf
::
XLS_TYPE_FONT
:

675 
$this
->
	`»adFÚt
();

677 
£lf
::
XLS_TYPE_FORMAT
:

678 
$this
->
	`»adFÜm©
();

680 
£lf
::
XLS_TYPE_XF
:

681 
$this
->
	`»adXf
();

683 
£lf
::
XLS_TYPE_XFEXT
:

684 
$this
->
	`»adXfExt
();

686 
£lf
::
XLS_TYPE_STYLE
:

687 
$this
->
	`»adStyË
();

689 
£lf
::
XLS_TYPE_PALETTE
:

690 
$this
->
	`»adP®‘‹
();

692 
£lf
::
XLS_TYPE_SHEET
:

693 
$this
->
	`»adSh“t
();

695 
£lf
::
XLS_TYPE_EXTERNALBOOK
:

696 
$this
->
	`»adEx‹º®Book
();

698 
£lf
::
XLS_TYPE_EXTERNNAME
:

699 
$this
->
	`»adEx‹ºName
();

701 
£lf
::
XLS_TYPE_EXTERNSHEET
:

702 
$this
->
	`»adEx‹ºSh“t
();

704 
£lf
::
XLS_TYPE_DEFINEDNAME
:

705 
$this
->
	`»adDefšedName
();

707 
£lf
::
XLS_TYPE_MSODRAWINGGROUP
:

708 
$this
->
	`»adMsoD¿wšgGroup
();

710 
£lf
::
XLS_TYPE_SST
:

711 
$this
->
	`»adS¡
();

713 
£lf
::
XLS_TYPE_EOF
:

714 
$this
->
	`»adDeçuÉ
();

717 
$this
->
	`»adDeçuÉ
();

724 ià(!
$this
->
»adD©aOÆy
) {

725 
	`fÜ—ch
 (
$this
->
objFÚts
 
as
 
$objFÚt
) {

726 ià(
	`is£t
(
$objFÚt
->
cŞÜIndex
)) {

727 
$cŞÜ
 = 
£lf
::
	`»adCŞÜ
(
$objFÚt
->
cŞÜIndex
, 
$this
->
·Ë‰e
, $this->
v”siÚ
);

728 
$objFÚt
->
	`g‘CŞÜ
()->
	`£tRGB
(
$cŞÜ
['rgb']);

732 
	`fÜ—ch
 (
$this
->
phpExûl
->
	`g‘C–lXfCŞËùiÚ
(è
as
 
$objStyË
) {

734 
$fl
 = 
$objStyË
->
	`g‘Fl
();

736 ià(
	`is£t
(
$fl
->
¡¬tcŞÜIndex
)) {

737 
$¡¬tCŞÜ
 = 
£lf
::
	`»adCŞÜ
(
$fl
->
¡¬tcŞÜIndex
, 
$this
->
·Ë‰e
, $this->
v”siÚ
);

738 
$fl
->
	`g‘S¹CŞÜ
()->
	`£tRGB
(
$¡¬tCŞÜ
['rgb']);

740 ià(
	`is£t
(
$fl
->
’dcŞÜIndex
)) {

741 
$’dCŞÜ
 = 
£lf
::
	`»adCŞÜ
(
$fl
->
’dcŞÜIndex
, 
$this
->
·Ë‰e
, $this->
v”siÚ
);

742 
$fl
->
	`g‘EndCŞÜ
()->
	`£tRGB
(
$’dCŞÜ
['rgb']);

746 
$tİ
 = 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Tİ
();

747 
$right
 = 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Right
();

748 
$bÙtom
 = 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘BÙtom
();

749 
$Ëá
 = 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Leá
();

750 
$dŸgÚ®
 = 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘DŸgÚ®
();

752 ià(
	`is£t
(
$tİ
->
cŞÜIndex
)) {

753 
$bÜd”TİCŞÜ
 = 
£lf
::
	`»adCŞÜ
(
$tİ
->
cŞÜIndex
, 
$this
->
·Ë‰e
, $this->
v”siÚ
);

754 
$tİ
->
	`g‘CŞÜ
()->
	`£tRGB
(
$bÜd”TİCŞÜ
['rgb']);

756 ià(
	`is£t
(
$right
->
cŞÜIndex
)) {

757 
$bÜd”RightCŞÜ
 = 
£lf
::
	`»adCŞÜ
(
$right
->
cŞÜIndex
, 
$this
->
·Ë‰e
, $this->
v”siÚ
);

758 
$right
->
	`g‘CŞÜ
()->
	`£tRGB
(
$bÜd”RightCŞÜ
['rgb']);

760 ià(
	`is£t
(
$bÙtom
->
cŞÜIndex
)) {

761 
$bÜd”BÙtomCŞÜ
 = 
£lf
::
	`»adCŞÜ
(
$bÙtom
->
cŞÜIndex
, 
$this
->
·Ë‰e
, $this->
v”siÚ
);

762 
$bÙtom
->
	`g‘CŞÜ
()->
	`£tRGB
(
$bÜd”BÙtomCŞÜ
['rgb']);

764 ià(
	`is£t
(
$Ëá
->
cŞÜIndex
)) {

765 
$bÜd”LeáCŞÜ
 = 
£lf
::
	`»adCŞÜ
(
$Ëá
->
cŞÜIndex
, 
$this
->
·Ë‰e
, $this->
v”siÚ
);

766 
$Ëá
->
	`g‘CŞÜ
()->
	`£tRGB
(
$bÜd”LeáCŞÜ
['rgb']);

768 ià(
	`is£t
(
$dŸgÚ®
->
cŞÜIndex
)) {

769 
$bÜd”DŸgÚ®CŞÜ
 = 
£lf
::
	`»adCŞÜ
(
$dŸgÚ®
->
cŞÜIndex
, 
$this
->
·Ë‰e
, $this->
v”siÚ
);

770 
$dŸgÚ®
->
	`g‘CŞÜ
()->
	`£tRGB
(
$bÜd”DŸgÚ®CŞÜ
['rgb']);

776 ià(!
$this
->
»adD©aOÆy
 && $this->
d¿wšgGroupD©a
) {

777 
$esch”WÜkbook
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”
();

778 
$»ad”
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl5_Esch”
(
$esch”WÜkbook
);

779 
$esch”WÜkbook
 = 
$»ad”
->
	`lßd
(
$this
->
d¿wšgGroupD©a
);

787 
	`fÜ—ch
 (
$this
->
sh“ts
 
as
 
$sh“t
) {

788 ià(
$sh“t
['sheetType'] != 0x00) {

794 ià(
	`is£t
(
$this
->
lßdSh“tsOÆy
è&& !
	`š_¬¿y
(
$sh“t
['name'], $this->loadSheetsOnly)) {

799 
$this
->
phpSh“t
 = $this->
phpExûl
->
	`ü—‹Sh“t
();

803 
$this
->
phpSh“t
->
	`£tT™Ë
(
$sh“t
['Çme'], 
çl£
);

804 
$this
->
phpSh“t
->
	`£tSh“tS‹
(
$sh“t
['sheetState']);

806 
$this
->
pos
 = 
$sh“t
['offset'];

809 
$this
->
isF™ToPages
 = 
çl£
;

812 
$this
->
d¿wšgD©a
 = '';

815 
$this
->
objs
 = 
	`¬¿y
();

818 
$this
->
sh¬edFÜmuÏP¬ts
 = 
	`¬¿y
();

821 
$this
->
sh¬edFÜmuÏs
 = 
	`¬¿y
();

824 
$this
->
‹xtObjeùs
 = 
	`¬¿y
();

827 
$this
->
ûÎNÙes
 = 
	`¬¿y
();

828 
$this
->
‹xtObjRef
 = -1;

830 
$this
->
pos
 <ğ$this->
d©aSize
 - 4) {

831 
$code
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
);

833 
$code
) {

834 
£lf
::
XLS_TYPE_BOF
:

835 
$this
->
	`»adBof
();

837 
£lf
::
XLS_TYPE_PRINTGRIDLINES
:

838 
$this
->
	`»adPrštGridlšes
();

840 
£lf
::
XLS_TYPE_DEFAULTROWHEIGHT
:

841 
$this
->
	`»adDeçuÉRowHeight
();

843 
£lf
::
XLS_TYPE_SHEETPR
:

844 
$this
->
	`»adSh“tPr
();

846 
£lf
::
XLS_TYPE_HORIZONTALPAGEBREAKS
:

847 
$this
->
	`»adHÜizÚlPageB»aks
();

849 
£lf
::
XLS_TYPE_VERTICALPAGEBREAKS
:

850 
$this
->
	`»adV”tiÿlPageB»aks
();

852 
£lf
::
XLS_TYPE_HEADER
:

853 
$this
->
	`»adH—d”
();

855 
£lf
::
XLS_TYPE_FOOTER
:

856 
$this
->
	`»adFoÙ”
();

858 
£lf
::
XLS_TYPE_HCENTER
:

859 
$this
->
	`»adHûÁ”
();

861 
£lf
::
XLS_TYPE_VCENTER
:

862 
$this
->
	`»adVûÁ”
();

864 
£lf
::
XLS_TYPE_LEFTMARGIN
:

865 
$this
->
	`»adLeáM¬gš
();

867 
£lf
::
XLS_TYPE_RIGHTMARGIN
:

868 
$this
->
	`»adRightM¬gš
();

870 
£lf
::
XLS_TYPE_TOPMARGIN
:

871 
$this
->
	`»adTİM¬gš
();

873 
£lf
::
XLS_TYPE_BOTTOMMARGIN
:

874 
$this
->
	`»adBÙtomM¬gš
();

876 
£lf
::
XLS_TYPE_PAGESETUP
:

877 
$this
->
	`»adPageS‘up
();

879 
£lf
::
XLS_TYPE_PROTECT
:

880 
$this
->
	`»adPrÙeù
();

882 
£lf
::
XLS_TYPE_SCENPROTECT
:

883 
$this
->
	`»adSûnPrÙeù
();

885 
£lf
::
XLS_TYPE_OBJECTPROTECT
:

886 
$this
->
	`»adObjeùPrÙeù
();

888 
£lf
::
XLS_TYPE_PASSWORD
:

889 
$this
->
	`»adPasswÜd
();

891 
£lf
::
XLS_TYPE_DEFCOLWIDTH
:

892 
$this
->
	`»adDefCŞWidth
();

894 
£lf
::
XLS_TYPE_COLINFO
:

895 
$this
->
	`»adCŞInfo
();

897 
£lf
::
XLS_TYPE_DIMENSION
:

898 
$this
->
	`»adDeçuÉ
();

900 
£lf
::
XLS_TYPE_ROW
:

901 
$this
->
	`»adRow
();

903 
£lf
::
XLS_TYPE_DBCELL
:

904 
$this
->
	`»adDeçuÉ
();

906 
£lf
::
XLS_TYPE_RK
:

907 
$this
->
	`»adRk
();

909 
£lf
::
XLS_TYPE_LABELSST
:

910 
$this
->
	`»adLab–S¡
();

912 
£lf
::
XLS_TYPE_MULRK
:

913 
$this
->
	`»adMulRk
();

915 
£lf
::
XLS_TYPE_NUMBER
:

916 
$this
->
	`»adNumb”
();

918 
£lf
::
XLS_TYPE_FORMULA
:

919 
$this
->
	`»adFÜmuÏ
();

921 
£lf
::
XLS_TYPE_SHAREDFMLA
:

922 
$this
->
	`»adSh¬edFmÏ
();

924 
£lf
::
XLS_TYPE_BOOLERR
:

925 
$this
->
	`»adBoŞE¼
();

927 
£lf
::
XLS_TYPE_MULBLANK
:

928 
$this
->
	`»adMulBÏnk
();

930 
£lf
::
XLS_TYPE_LABEL
:

931 
$this
->
	`»adLab–
();

933 
£lf
::
XLS_TYPE_BLANK
:

934 
$this
->
	`»adBÏnk
();

936 
£lf
::
XLS_TYPE_MSODRAWING
:

937 
$this
->
	`»adMsoD¿wšg
();

939 
£lf
::
XLS_TYPE_OBJ
:

940 
$this
->
	`»adObj
();

942 
£lf
::
XLS_TYPE_WINDOW2
:

943 
$this
->
	`»adWšdow2
();

945 
£lf
::
XLS_TYPE_PAGELAYOUTVIEW
:

946 
$this
->
	`»adPageLayoutV›w
();

948 
£lf
::
XLS_TYPE_SCL
:

949 
$this
->
	`»adSş
();

951 
£lf
::
XLS_TYPE_PANE
:

952 
$this
->
	`»adPªe
();

954 
£lf
::
XLS_TYPE_SELECTION
:

955 
$this
->
	`»adS–eùiÚ
();

957 
£lf
::
XLS_TYPE_MERGEDCELLS
:

958 
$this
->
	`»adM”gedC–ls
();

960 
£lf
::
XLS_TYPE_HYPERLINK
:

961 
$this
->
	`»adHy³rLšk
();

963 
£lf
::
XLS_TYPE_DATAVALIDATIONS
:

964 
$this
->
	`»adD©aV®id©iÚs
();

966 
£lf
::
XLS_TYPE_DATAVALIDATION
:

967 
$this
->
	`»adD©aV®id©iÚ
();

969 
£lf
::
XLS_TYPE_SHEETLAYOUT
:

970 
$this
->
	`»adSh“tLayout
();

972 
£lf
::
XLS_TYPE_SHEETPROTECTION
:

973 
$this
->
	`»adSh“tPrÙeùiÚ
();

975 
£lf
::
XLS_TYPE_RANGEPROTECTION
:

976 
$this
->
	`»adRªgePrÙeùiÚ
();

978 
£lf
::
XLS_TYPE_NOTE
:

979 
$this
->
	`»adNÙe
();

982 
£lf
::
XLS_TYPE_TXO
:

983 
$this
->
	`»adTextObjeù
();

985 
£lf
::
XLS_TYPE_CONTINUE
:

986 
$this
->
	`»adCÚtšue
();

988 
£lf
::
XLS_TYPE_EOF
:

989 
$this
->
	`»adDeçuÉ
();

992 
$this
->
	`»adDeçuÉ
();

999 ià(!
$this
->
»adD©aOÆy
 && $this->
d¿wšgD©a
) {

1000 
$esch”WÜksh“t
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”
();

1001 
$»ad”
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl5_Esch”
(
$esch”WÜksh“t
);

1002 
$esch”WÜksh“t
 = 
$»ad”
->
	`lßd
(
$this
->
d¿wšgD©a
);

1009 
$®lSpCÚš”s
 = 
$esch”WÜksh“t
->
	`g‘DgCÚš”
()->
	`g‘SpgrCÚš”
()->
	`g‘AÎSpCÚš”s
();

1013 
	`fÜ—ch
 (
$this
->
objs
 
as
 
$n
 => 
$obj
) {

1019 ià(
	`is£t
(
$®lSpCÚš”s
[
$n
 + 1]è&& 
	`is_objeù
($allSpContainers[$n + 1])) {

1020 
$¥CÚš”
 = 
$®lSpCÚš”s
[
$n
 + 1];

1023 ià(
$¥CÚš”
->
	`g‘Ne¡šgLev–
() > 1) {

1028 
	`li¡
(
$¡¬tCŞumn
, 
$¡¬tRow
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$¥CÚš”
->
	`g‘S¹CoÜdš©es
());

1029 
	`li¡
(
$’dCŞumn
, 
$’dRow
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$¥CÚš”
->
	`g‘EndCoÜdš©es
());

1031 
$¡¬tOff£tX
 = 
$¥CÚš”
->
	`g‘S¹Off£tX
();

1032 
$¡¬tOff£tY
 = 
$¥CÚš”
->
	`g‘S¹Off£tY
();

1033 
$’dOff£tX
 = 
$¥CÚš”
->
	`g‘EndOff£tX
();

1034 
$’dOff£tY
 = 
$¥CÚš”
->
	`g‘EndOff£tY
();

1036 
$width
 = 
PHPExûl_Sh¬ed_Exûl5
::
	`g‘Di¡ªûX
(
$this
->
phpSh“t
, 
$¡¬tCŞumn
, 
$¡¬tOff£tX
, 
$’dCŞumn
, 
$’dOff£tX
);

1037 
$height
 = 
PHPExûl_Sh¬ed_Exûl5
::
	`g‘Di¡ªûY
(
$this
->
phpSh“t
, 
$¡¬tRow
, 
$¡¬tOff£tY
, 
$’dRow
, 
$’dOff£tY
);

1040 
$off£tX
 = 
$¡¬tOff£tX
 * 
PHPExûl_Sh¬ed_Exûl5
::
	`sizeCŞ
(
$this
->
phpSh“t
, 
$¡¬tCŞumn
) / 1024;

1041 
$off£tY
 = 
$¡¬tOff£tY
 * 
PHPExûl_Sh¬ed_Exûl5
::
	`sizeRow
(
$this
->
phpSh“t
, 
$¡¬tRow
) / 256;

1043 
$obj
['otObjType']) {

1048 ià(
	`is£t
(
$this
->
ûÎNÙes
[
$obj
['idObjID']])) {

1049 
$ûÎNÙe
 = 
$this
->
ûÎNÙes
[
$obj
['idObjID']];

1051 ià(
	`is£t
(
$this
->
‹xtObjeùs
[
$obj
['idObjID']])) {

1052 
$‹xtObjeù
 = 
$this
->
‹xtObjeùs
[
$obj
['idObjID']];

1053 
$this
->
ûÎNÙes
[
$obj
['idObjID']]['objTextD©a'] = 
$‹xtObjeù
;

1061 
$BSEšdex
 = 
$¥CÚš”
->
	`g‘OPT
(0x0104);

1062 
$BSECŞËùiÚ
 = 
$esch”WÜkbook
->
	`g‘DggCÚš”
()->
	`g‘B¡ÜeCÚš”
()->
	`g‘BSECŞËùiÚ
();

1063 
$BSE
 = 
$BSECŞËùiÚ
[
$BSEšdex
 - 1];

1064 
$blTy³
 = 
$BSE
->
	`g‘BlTy³
();

1067 ià(
$bl
 = 
$BSE
->
	`g‘Bl
()) {

1068 
$ih
 = 
	`imageü—‹äom¡ršg
(
$bl
->
	`g‘D©a
());

1069 
$d¿wšg
 = 
Ãw
 
	`PHPExûl_WÜksh“t_MemÜyD¿wšg
();

1070 
$d¿wšg
->
	`£tImageResourû
(
$ih
);

1073 
$d¿wšg
->
	`£tResizePrİÜtiÚ®
(
çl£
);

1074 
$d¿wšg
->
	`£tWidth
(
$width
);

1075 
$d¿wšg
->
	`£tHeight
(
$height
);

1076 
$d¿wšg
->
	`£tOff£tX
(
$off£tX
);

1077 
$d¿wšg
->
	`£tOff£tY
(
$off£tY
);

1079 
$blTy³
) {

1080 
PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
::
BLIPTYPE_JPEG
:

1081 
$d¿wšg
->
	`£tR’d”šgFunùiÚ
(
PHPExûl_WÜksh“t_MemÜyD¿wšg
::
RENDERING_JPEG
);

1082 
$d¿wšg
->
	`£tMimeTy³
(
PHPExûl_WÜksh“t_MemÜyD¿wšg
::
MIMETYPE_JPEG
);

1084 
PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
::
BLIPTYPE_PNG
:

1085 
$d¿wšg
->
	`£tR’d”šgFunùiÚ
(
PHPExûl_WÜksh“t_MemÜyD¿wšg
::
RENDERING_PNG
);

1086 
$d¿wšg
->
	`£tMimeTy³
(
PHPExûl_WÜksh“t_MemÜyD¿wšg
::
MIMETYPE_PNG
);

1090 
$d¿wšg
->
	`£tWÜksh“t
(
$this
->
phpSh“t
);

1091 
$d¿wšg
->
	`£tCoÜdš©es
(
$¥CÚš”
->
	`g‘S¹CoÜdš©es
());

1102 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

1103 
	`fÜ—ch
 (
$this
->
sh¬edFÜmuÏP¬ts
 
as
 
$ûÎ
 => 
$ba£C–l
) {

1104 
	`li¡
(
$cŞumn
, 
$row
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$ûÎ
);

1105 ià((
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
è&& $this->g‘R—dF‹r()->
	`»adC–l
(
$cŞumn
, 
$row
, $this->
phpSh“t
->
	`g‘T™Ë
())) {

1106 
$fÜmuÏ
 = 
$this
->
	`g‘FÜmuÏFromSŒuùu»
($this->
sh¬edFÜmuÏs
[
$ba£C–l
], 
$ûÎ
);

1107 
$this
->
phpSh“t
->
	`g‘C–l
(
$ûÎ
)->
	`£tV®ueEx¶ic™
('=' . 
$fÜmuÏ
, 
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
);

1112 ià(!
	`em±y
(
$this
->
ûÎNÙes
)) {

1113 
	`fÜ—ch
 (
$this
->
ûÎNÙes
 
as
 
$nÙe
 => 
$nÙeD‘as
) {

1114 ià(!
	`is£t
(
$nÙeD‘as
['objTextData'])) {

1115 ià(
	`is£t
(
$this
->
‹xtObjeùs
[
$nÙe
])) {

1116 
$‹xtObjeù
 = 
$this
->
‹xtObjeùs
[
$nÙe
];

1117 
$nÙeD‘as
['objTextD©a'] = 
$‹xtObjeù
;

1119 
$nÙeD‘as
['objTextData']['text'] = '';

1125 
$ûÎAdd»ss
 = 
	`¡r_»¶aû
('$', '', 
$nÙeD‘as
['cellRef']);

1126 
$this
->
phpSh“t
->
	`g‘Comm’t
(
$ûÎAdd»ss
)->
	`£tAuthÜ
(
$nÙeD‘as
['authÜ'])->
	`£tText
($this->
	`·r£RichText
($noteDetails['objTextData']['text']));

1132 
	`fÜ—ch
 (
$this
->
defšedÇme
 
as
 
$defšedName
) {

1133 ià(
$defšedName
['isBuiltInName']) {

1134 
$defšedName
['name']) {

1135 
	`·ck
('C', 0x06):

1138 
$¿nges
 = 
	`ex¶ode
(',', 
$defšedName
['formula']);

1140 
$exŒaùedRªges
 = 
	`¬¿y
();

1141 
	`fÜ—ch
 (
$¿nges
 
as
 
$¿nge
) {

1145 
$ex¶odes
 = 
	`ex¶ode
('!', 
$¿nge
);

1146 
$sh“tName
 = 
	`Œim
(
$ex¶odes
[0], "'");

1147 ià(
	`couÁ
(
$ex¶odes
) == 2) {

1148 ià(
	`¡½os
(
$ex¶odes
[1], ':'è==ğ
çl£
) {

1149 
$ex¶odes
[1] = $explodes[1] . ':' . $explodes[1];

1151 
$exŒaùedRªges
[] = 
	`¡r_»¶aû
('$', '', 
$ex¶odes
[1]);

1154 ià(
$docSh“t
 = 
$this
->
phpExûl
->
	`g‘Sh“tByName
(
$sh“tName
)) {

1155 
$docSh“t
->
	`g‘PageS‘up
()->
	`£tPrštA»a
(
	`im¶ode
(',', 
$exŒaùedRªges
));

1158 
	`·ck
('C', 0x07):

1169 
$¿nges
 = 
	`ex¶ode
(',', 
$defšedName
['formula']);

1170 
	`fÜ—ch
 (
$¿nges
 
as
 
$¿nge
) {

1174 
$ex¶odes
 = 
	`ex¶ode
('!', 
$¿nge
);

1175 ià(
	`couÁ
(
$ex¶odes
) == 2) {

1176 ià(
$docSh“t
 = 
$this
->
phpExûl
->
	`g‘Sh“tByName
(
$ex¶odes
[0])) {

1177 
$exŒaùedRªge
 = 
$ex¶odes
[1];

1178 
$exŒaùedRªge
 = 
	`¡r_»¶aû
('$', '', $extractedRange);

1180 
$coÜdš©eSŒšgs
 = 
	`ex¶ode
(':', 
$exŒaùedRªge
);

1181 ià(
	`couÁ
(
$coÜdš©eSŒšgs
) == 2) {

1182 
	`li¡
(
$fœ¡CŞumn
, 
$fœ¡Row
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$coÜdš©eSŒšgs
[0]);

1183 
	`li¡
(
$Ï¡CŞumn
, 
$Ï¡Row
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$coÜdš©eSŒšgs
[1]);

1185 ià(
$fœ¡CŞumn
 =ğ'A' 
ªd
 
$Ï¡CŞumn
 == 'IV') {

1187 
$docSh“t
->
	`g‘PageS‘up
()->
	`£tRowsToR•—tAtTİ
(
	`¬¿y
(
$fœ¡Row
, 
$Ï¡Row
));

1188 } 
	`–£if
 (
$fœ¡Row
 =ğ1 
ªd
 
$Ï¡Row
 == 65536) {

1190 
$docSh“t
->
	`g‘PageS‘up
()->
	`£tCŞumnsToR•—tAtLeá
(
	`¬¿y
(
$fœ¡CŞumn
, 
$Ï¡CŞumn
));

1200 
$ex¶odes
 = 
	`ex¶ode
('!', 
$defšedName
['formula']);

1202 ià(
	`couÁ
(
$ex¶odes
) == 2) {

1203 ià((
$docSh“t
 = 
$this
->
phpExûl
->
	`g‘Sh“tByName
(
$ex¶odes
[0])) ||

1204 (
$docSh“t
 = 
$this
->
phpExûl
->
	`g‘Sh“tByName
(
	`Œim
(
$ex¶odes
[0], "'")))) {

1205 
$exŒaùedRªge
 = 
$ex¶odes
[1];

1206 
$exŒaùedRªge
 = 
	`¡r_»¶aû
('$', '', $extractedRange);

1208 
$loÿlOÆy
 = (
$defšedName
['scİe'] =ğ0è? 
çl£
 : 
Œue
;

1210 
$scİe
 = (
$defšedName
['scİe'] =ğ0è? 
nuÎ
 : 
$this
->
phpExûl
->
	`g‘Sh“tByName
($this->
sh“ts
[$definedName['scope'] - 1]['name']);

1212 
$this
->
phpExûl
->
	`addNamedRªge
(
Ãw
 
	`PHPExûl_NamedRªge
((
¡ršg
)
$defšedName
['Çme'], 
$docSh“t
, 
$exŒaùedRªge
, 
$loÿlOÆy
, 
$scİe
));

1220 
$this
->
d©a
 = 
nuÎ
;

1222  
$this
->
phpExûl
;

1223 
	}
}

1234 
´iv©e
 
funùiÚ
 
	$»adRecÜdD©a
(
$d©a
, 
$pos
, 
$Ën
)

1236 
$d©a
 = 
	`sub¡r
($d©a, 
$pos
, 
$Ën
);

1239 ià(
$this
->
’üy±iÚ
 =ğ
£lf
::
MS_BIFF_CRYPTO_NONE
 || 
$pos
 < $this->
’üy±iÚS¹Pos
) {

1240  
$d©a
;

1243 
$»cÜdD©a
 = '';

1244 ià(
$this
->
’üy±iÚ
 =ğ
£lf
::
MS_BIFF_CRYPTO_RC4
) {

1245 
$ŞdBlock
 = 
	`æoÜ
(
$this
->
rc4Pos
 / 
£lf
::
REKEY_BLOCK
);

1246 
$block
 = 
	`æoÜ
(
$pos
 / 
£lf
::
REKEY_BLOCK
);

1247 
$’dBlock
 = 
	`æoÜ
((
$pos
 + 
$Ën
è/ 
£lf
::
REKEY_BLOCK
);

1251 ià(
$block
 !ğ
$ŞdBlock
 || 
$pos
 < 
$this
->
rc4Pos
 || !$this->
rc4Key
) {

1252 
$this
->
rc4Key
 = $this->
	`makeKey
(
$block
, $this->
md5Ctxt
);

1253 
$¡•
 = 
$pos
 % 
£lf
::
REKEY_BLOCK
;

1255 
$¡•
 = 
$pos
 - 
$this
->
rc4Pos
;

1257 
$this
->
rc4Key
->
	`RC4
(
	`¡r_»³©
("\0", 
$¡•
));

1260 
$block
 !ğ
$’dBlock
) {

1261 
$¡•
 = 
£lf
::
REKEY_BLOCK
 - (
$pos
 % self::REKEY_BLOCK);

1262 
$»cÜdD©a
 .ğ
$this
->
rc4Key
->
	`RC4
(
	`sub¡r
(
$d©a
, 0, 
$¡•
));

1263 
$d©a
 = 
	`sub¡r
($d©a, 
$¡•
);

1264 
$pos
 +ğ
$¡•
;

1265 
$Ën
 -ğ
$¡•
;

1266 
$block
++;

1267 
$this
->
rc4Key
 = $this->
	`makeKey
(
$block
, $this->
md5Ctxt
);

1269 
$»cÜdD©a
 .ğ
$this
->
rc4Key
->
	`RC4
(
	`sub¡r
(
$d©a
, 0, 
$Ën
));

1273 
$this
->
rc4Pos
 = 
$pos
 + 
$Ën
;

1274 } 
	`–£if
 (
$this
->
’üy±iÚ
 =ğ
£lf
::
MS_BIFF_CRYPTO_XOR
) {

1275 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('XOrƒncryption‚ot supported');

1277  
$»cÜdD©a
;

1278 
	}
}

1285 
´iv©e
 
funùiÚ
 
	$lßdOLE
(
$pF’ame
)

1288 
$Şe
 = 
Ãw
 
	`PHPExûl_Sh¬ed_OLER—d
();

1290 
$»s
 = 
$Şe
->
	`»ad
(
$pF’ame
);

1292 
$this
->
d©a
 = 
$Şe
->
	`g‘SŒ—m
($Şe->
wrkbook
);

1294 
$this
->
summ¬yInfÜm©iÚ
 = 
$Şe
->
	`g‘SŒ—m
($ole->summaryInformation);

1296 
$this
->
docum’tSumm¬yInfÜm©iÚ
 = 
$Şe
->
	`g‘SŒ—m
($ole->documentSummaryInformation);

1299 
	}
}

1305 
´iv©e
 
funùiÚ
 
	$»adSumm¬yInfÜm©iÚ
()

1307 ià(!
	`is£t
(
$this
->
summ¬yInfÜm©iÚ
)) {

1317 
$£cCouÁ
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
summ¬yInfÜm©iÚ
, 24);

1321 
$£cOff£t
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
summ¬yInfÜm©iÚ
, 44);

1325 
$£cL’gth
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
summ¬yInfÜm©iÚ
, 
$£cOff£t
);

1328 
$couÁPrİ”t›s
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
summ¬yInfÜm©iÚ
, 
$£cOff£t
+4);

1331 
$codePage
 = 'CP1252';

1335 
$i
 = 0; $˜< 
$couÁPrİ”t›s
; ++$i) {

1337 
$id
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
summ¬yInfÜm©iÚ
, (
$£cOff£t
+8è+ (8 * 
$i
));

1341 
$off£t
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
summ¬yInfÜm©iÚ
, (
$£cOff£t
+12è+ (8 * 
$i
));

1343 
$ty³
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
summ¬yInfÜm©iÚ
, 
$£cOff£t
 + 
$off£t
);

1346 
$v®ue
 = 
nuÎ
;

1349 
$ty³
) {

1351 
$v®ue
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
summ¬yInfÜm©iÚ
, 
$£cOff£t
 + 4 + 
$off£t
);

1354 
$v®ue
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
summ¬yInfÜm©iÚ
, 
$£cOff£t
 + 4 + 
$off£t
);

1360 
$by‹L’gth
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
summ¬yInfÜm©iÚ
, 
$£cOff£t
 + 4 + 
$off£t
);

1361 
$v®ue
 = 
	`sub¡r
(
$this
->
summ¬yInfÜm©iÚ
, 
$£cOff£t
 + 8 + 
$off£t
, 
$by‹L’gth
);

1362 
$v®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`CÚv”tEncodšg
($v®ue, 'UTF-8', 
$codePage
);

1363 
$v®ue
 = 
	`¹rim
($value);

1367 
$v®ue
 = 
PHPExûl_Sh¬ed_OLE
::
	`OLE2LoÿlD©e
(
	`sub¡r
(
$this
->
summ¬yInfÜm©iÚ
, 
$£cOff£t
 + 4 + 
$off£t
, 8));

1374 
$id
) {

1376 
$codePage
 = 
PHPExûl_Sh¬ed_CodePage
::
	`Numb”ToName
(
$v®ue
);

1379 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tT™Ë
(
$v®ue
);

1382 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tSubjeù
(
$v®ue
);

1385 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tC»©Ü
(
$v®ue
);

1388 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tKeywÜds
(
$v®ue
);

1391 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tDesütiÚ
(
$v®ue
);

1397 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tLa¡Modif›dBy
(
$v®ue
);

1409 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tC»©ed
(
$v®ue
);

1412 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tModif›d
(
$v®ue
);

1434 
	}
}

1440 
´iv©e
 
funùiÚ
 
	$»adDocum’tSumm¬yInfÜm©iÚ
()

1442 ià(!
	`is£t
(
$this
->
docum’tSumm¬yInfÜm©iÚ
)) {

1452 
$£cCouÁ
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 24);

1457 
$£cOff£t
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 44);

1462 
$£cL’gth
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 
$£cOff£t
);

1466 
$couÁPrİ”t›s
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 
$£cOff£t
+4);

1470 
$codePage
 = 'CP1252';

1474 
$i
 = 0; $˜< 
$couÁPrİ”t›s
; ++$i) {

1477 
$id
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, (
$£cOff£t
+8è+ (8 * 
$i
));

1482 
$off£t
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, (
$£cOff£t
+12è+ (8 * 
$i
));

1484 
$ty³
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 
$£cOff£t
 + 
$off£t
);

1488 
$v®ue
 = 
nuÎ
;

1491 
$ty³
) {

1493 
$v®ue
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 
$£cOff£t
 + 4 + 
$off£t
);

1496 
$v®ue
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 
$£cOff£t
 + 4 + 
$off£t
);

1499 
$v®ue
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 
$£cOff£t
 + 4 + 
$off£t
);

1500 
$v®ue
 = ($v®u=ğ0 ? 
çl£
 : 
Œue
);

1506 
$by‹L’gth
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 
$£cOff£t
 + 4 + 
$off£t
);

1507 
$v®ue
 = 
	`sub¡r
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 
$£cOff£t
 + 8 + 
$off£t
, 
$by‹L’gth
);

1508 
$v®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`CÚv”tEncodšg
($v®ue, 'UTF-8', 
$codePage
);

1509 
$v®ue
 = 
	`¹rim
($value);

1513 
$v®ue
 = 
PHPExûl_Sh¬ed_OLE
::
	`OLE2LoÿlD©e
(
	`sub¡r
(
$this
->
docum’tSumm¬yInfÜm©iÚ
, 
$£cOff£t
 + 4 + 
$off£t
, 8));

1520 
$id
) {

1522 
$codePage
 = 
PHPExûl_Sh¬ed_CodePage
::
	`Numb”ToName
(
$v®ue
);

1525 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tC©egÜy
(
$v®ue
);

1561 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tMªag”
(
$v®ue
);

1564 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`£tCom·ny
(
$v®ue
);

1571 
	}
}

1577 
´iv©e
 
funùiÚ
 
	$»adDeçuÉ
()

1579 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

1583 
$this
->
pos
 +ğ4 + 
$Ëngth
;

1584 
	}
}

1591 
´iv©e
 
funùiÚ
 
	$»adNÙe
()

1594 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

1595 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

1598 
$this
->
pos
 +ğ4 + 
$Ëngth
;

1600 ià(
$this
->
»adD©aOÆy
) {

1604 
$ûÎAdd»ss
 = 
$this
->
	`»adBIFF8C–lAdd»ss
(
	`sub¡r
(
$»cÜdD©a
, 0, 4));

1605 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

1606 
$nÙeObjID
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 6);

1607 
$nÙeAuthÜ
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
	`sub¡r
(
$»cÜdD©a
, 8));

1608 
$nÙeAuthÜ
 = $noteAuthor['value'];

1613 
$this
->
ûÎNÙes
[
$nÙeObjID
] = 
	`¬¿y
(

1614 'ûÎRef' => 
$ûÎAdd»ss
,

1615 'objeùID' => 
$nÙeObjID
,

1616 'authÜ' => 
$nÙeAuthÜ


1619 
$ex‹nsiÚ
 = 
çl£
;

1620 ià(
$ûÎAdd»ss
 == '$B$65536') {

1624 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

1625 
$ex‹nsiÚ
 = 
Œue
;

1626 
$ûÎAdd»ss
 = 
	`¬¿y_pİ
(
	`¬¿y_keys
(
$this
->
phpSh“t
->
	`g‘Comm’ts
()));

1630 
$ûÎAdd»ss
 = 
	`¡r_»¶aû
('$', '', $cellAddress);

1631 
$nÙeL’gth
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

1632 
$nÙeText
 = 
	`Œim
(
	`sub¡r
(
$»cÜdD©a
, 6));

1636 ià(
$ex‹nsiÚ
) {

1638 
$comm’t
 = 
$this
->
phpSh“t
->
	`g‘Comm’t
(
$ûÎAdd»ss
);

1639 
$comm’tText
 = 
$comm’t
->
	`g‘Text
()->
	`g‘PÏšText
();

1640 
$comm’t
->
	`£tText
(
$this
->
	`·r£RichText
(
$comm’tText
.
$nÙeText
));

1643 
$this
->
phpSh“t
->
	`g‘Comm’t
(
$ûÎAdd»ss
)->
	`£tText
($this->
	`·r£RichText
(
$nÙeText
));

1648 
	}
}

1654 
´iv©e
 
funùiÚ
 
	$»adTextObjeù
()

1656 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

1657 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

1660 
$this
->
pos
 +ğ4 + 
$Ëngth
;

1662 ià(
$this
->
»adD©aOÆy
) {

1672 
$grb™O±s
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

1673 
$rÙ
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

1674 
$cchText
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 10);

1675 
$cbRuns
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 12);

1676 
$‹xt
 = 
$this
->
	`g‘S¶iûdRecÜdD©a
();

1678 
$this
->
‹xtObjeùs
[$this->
‹xtObjRef
] = 
	`¬¿y
(

1679 '‹xt' => 
	`sub¡r
(
$‹xt
["»cÜdD©a"], $‹xt["¥liûOff£ts"][0]+1, 
$cchText
),

1680 'fÜm©' => 
	`sub¡r
(
$‹xt
["»cÜdD©a"], $‹xt["¥liûOff£ts"][1], 
$cbRuns
),

1681 '®ignm’t' => 
$grb™O±s
,

1682 'rÙ©iÚ' => 
$rÙ


1688 
	}
}

1694 
´iv©e
 
funùiÚ
 
	$»adBof
()

1696 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

1697 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

1700 
$this
->
pos
 +ğ4 + 
$Ëngth
;

1703 
$sub¡»amTy³
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

1705 
$sub¡»amTy³
) {

1706 
£lf
::
XLS_WÜkbookGlob®s
:

1707 
$v”siÚ
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

1708 ià((
$v”siÚ
 !ğ
£lf
::
XLS_BIFF8
è&& ($v”siÚ !ğ£lf::
XLS_BIFF7
)) {

1709 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Cannot„eadhis Excel file. Version isoo old.');

1711 
$this
->
v”siÚ
 = 
$v”siÚ
;

1713 
£lf
::
XLS_WÜksh“t
:

1721 
$code
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
);

1722 
$this
->
	`»adDeçuÉ
();

1723 } 
$code
 !ğ
£lf
::
XLS_TYPE_EOF
 && 
$this
->
pos
 < $this->
d©aSize
);

1726 
	}
}

1744 
´iv©e
 
funùiÚ
 
	$»adF•ass
()

1746 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

1748 ià(
$Ëngth
 != 54) {

1749 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Unexpected file…ass„ecord†ength');

1752 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

1755 
$this
->
pos
 +ğ4 + 
$Ëngth
;

1757 ià(!
$this
->
	`v”ifyPasswÜd
('V–v‘Sw—tshİ', 
	`sub¡r
(
$»cÜdD©a
, 6, 16), sub¡r($»cÜdD©a, 22, 16), sub¡r($»cÜdD©a, 38, 16), $this->
md5Ctxt
)) {

1758 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Decryption…assword incorrect');

1761 
$this
->
’üy±iÚ
 = 
£lf
::
MS_BIFF_CRYPTO_RC4
;

1764 
$this
->
’üy±iÚS¹Pos
 = $this->
pos
 + 
£lf
::
	`g‘IÁ2d
($this->
d©a
, $this->pos + 2);

1765 
	}
}

1775 
´iv©e
 
funùiÚ
 
	$makeKey
(
$block
, 
$v®CÚ‹xt
)

1777 
$pw¬¿y
 = 
	`¡r_»³©
("\0", 64);

1779 
$i
 = 0; $i < 5; $i++) {

1780 
$pw¬¿y
[
$i
] = 
$v®CÚ‹xt
[$i];

1783 
$pw¬¿y
[5] = 
	`chr
(
$block
 & 0xff);

1784 
$pw¬¿y
[6] = 
	`chr
((
$block
 >> 8) & 0xff);

1785 
$pw¬¿y
[7] = 
	`chr
((
$block
 >> 16) & 0xff);

1786 
$pw¬¿y
[8] = 
	`chr
((
$block
 >> 24) & 0xff);

1788 
$pw¬¿y
[9] = "\x80";

1789 
$pw¬¿y
[56] = "\x48";

1791 
$md5
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl5_MD5
();

1792 
$md5
->
	`add
(
$pw¬¿y
);

1794 
$s
 = 
$md5
->
	`g‘CÚ‹xt
();

1795  
Ãw
 
	`PHPExûl_R—d”_Exûl5_RC4
(
$s
);

1796 
	}
}

1809 
´iv©e
 
funùiÚ
 
	$v”ifyPasswÜd
(
$·sswÜd
, 
$docid
, 
$§É_d©a
, 
$hashed§É_d©a
, &
$v®CÚ‹xt
)

1811 
$pw¬¿y
 = 
	`¡r_»³©
("\0", 64);

1813 
$i
 = 0; $˜< 
	`¡¾’
(
$·sswÜd
); $i++) {

1814 
$o
 = 
	`Üd
(
	`sub¡r
(
$·sswÜd
, 
$i
, 1));

1815 
$pw¬¿y
[2 * 
$i
] = 
	`chr
(
$o
 & 0xff);

1816 
$pw¬¿y
[2 * 
$i
 + 1] = 
	`chr
((
$o
 >> 8) & 0xff);

1818 
$pw¬¿y
[2 * 
$i
] = 
	`chr
(0x80);

1819 
$pw¬¿y
[56] = 
	`chr
((
$i
 << 4) & 0xff);

1821 
$md5
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl5_MD5
();

1822 
$md5
->
	`add
(
$pw¬¿y
);

1824 
$mdCÚ‹xt1
 = 
$md5
->
	`g‘CÚ‹xt
();

1826 
$off£t
 = 0;

1827 
$keyoff£t
 = 0;

1828 
$tocİy
 = 5;

1830 
$md5
->
	`»£t
();

1832 
$off£t
 != 16) {

1833 ià((64 - 
$off£t
) < 5) {

1834 
$tocİy
 = 64 - 
$off£t
;

1836 
$i
 = 0; $˜<ğ
$tocİy
; $i++) {

1837 
$pw¬¿y
[
$off£t
 + 
$i
] = 
$mdCÚ‹xt1
[
$keyoff£t
 + $i];

1839 
$off£t
 +ğ
$tocİy
;

1841 ià(
$off£t
 == 64) {

1842 
$md5
->
	`add
(
$pw¬¿y
);

1843 
$keyoff£t
 = 
$tocİy
;

1844 
$tocİy
 = 5 - $tocopy;

1845 
$off£t
 = 0;

1849 
$keyoff£t
 = 0;

1850 
$tocİy
 = 5;

1851 
$i
 = 0; $i < 16; $i++) {

1852 
$pw¬¿y
[
$off£t
 + 
$i
] = 
$docid
[$i];

1854 
$off£t
 += 16;

1857 
$pw¬¿y
[16] = "\x80";

1858 
$i
 = 0; $i < 47; $i++) {

1859 
$pw¬¿y
[17 + 
$i
] = "\0";

1861 
$pw¬¿y
[56] = "\x80";

1862 
$pw¬¿y
[57] = "\x0a";

1864 
$md5
->
	`add
(
$pw¬¿y
);

1865 
$v®CÚ‹xt
 = 
$md5
->
	`g‘CÚ‹xt
();

1867 
$key
 = 
$this
->
	`makeKey
(0, 
$v®CÚ‹xt
);

1869 
$§É
 = 
$key
->
	`RC4
(
$§É_d©a
);

1870 
$hashed§É
 = 
$key
->
	`RC4
(
$hashed§É_d©a
);

1872 
$§É
 .ğ"\x80" . 
	`¡r_»³©
("\0", 47);

1873 
$§É
[56] = "\x80";

1875 
$md5
->
	`»£t
();

1876 
$md5
->
	`add
(
$§É
);

1877 
$mdCÚ‹xt2
 = 
$md5
->
	`g‘CÚ‹xt
();

1879  
$mdCÚ‹xt2
 =ğ
$hashed§É
;

1880 
	}
}

1891 
´iv©e
 
funùiÚ
 
	$»adCod•age
()

1893 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

1894 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

1897 
$this
->
pos
 +ğ4 + 
$Ëngth
;

1900 
$cod•age
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

1902 
$this
->
cod•age
 = 
PHPExûl_Sh¬ed_CodePage
::
	`Numb”ToName
(
$cod•age
);

1903 
	}
}

1918 
´iv©e
 
funùiÚ
 
	$»adD©eMode
()

1920 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

1921 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

1924 
$this
->
pos
 +ğ4 + 
$Ëngth
;

1927 
PHPExûl_Sh¬ed_D©e
::
	`£tExûlC®’d¬
(PHPExûl_Sh¬ed_D©e::
CALENDAR_WINDOWS_1900
);

1928 ià(
	`Üd
(
$»cÜdD©a
{0}) == 1) {

1929 
PHPExûl_Sh¬ed_D©e
::
	`£tExûlC®’d¬
(PHPExûl_Sh¬ed_D©e::
CALENDAR_MAC_1904
);

1931 
	}
}

1937 
´iv©e
 
funùiÚ
 
	$»adFÚt
()

1939 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

1940 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

1943 
$this
->
pos
 +ğ4 + 
$Ëngth
;

1945 ià(!
$this
->
»adD©aOÆy
) {

1946 
$objFÚt
 = 
Ãw
 
	`PHPExûl_StyË_FÚt
();

1949 
$size
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

1950 
$objFÚt
->
	`£tSize
(
$size
 / 20);

1955 
$isIlic
 = (0x0002 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2)) >> 1;

1956 ià(
$isIlic
) {

1957 
$objFÚt
->
	`£tIlic
(
Œue
);

1962 
$isSŒike
 = (0x0008 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2)) >> 3;

1963 ià(
$isSŒike
) {

1964 
$objFÚt
->
	`£tSŒik‘hrough
(
Œue
);

1968 
$cŞÜIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

1969 
$objFÚt
->
cŞÜIndex
 = 
$cŞÜIndex
;

1972 
$weight
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 6);

1973 
$weight
) {

1975 
$objFÚt
->
	`£tBŞd
(
Œue
);

1980 
$esÿ³m’t
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 8);

1981 
$esÿ³m’t
) {

1983 
$objFÚt
->
	`£tSu³rSüt
(
Œue
);

1986 
$objFÚt
->
	`£tSubSüt
(
Œue
);

1991 
$und”lšeTy³
 = 
	`Üd
(
$»cÜdD©a
{10});

1992 
$und”lšeTy³
) {

1996 
$objFÚt
->
	`£tUnd”lše
(
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLE
);

1999 
$objFÚt
->
	`£tUnd”lše
(
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLE
);

2002 
$objFÚt
->
	`£tUnd”lše
(
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLEACCOUNTING
);

2005 
$objFÚt
->
	`£tUnd”lše
(
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLEACCOUNTING
);

2013 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

2014 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgShÜt
(
	`sub¡r
(
$»cÜdD©a
, 14));

2016 
$¡ršg
 = 
$this
->
	`»adBy‹SŒšgShÜt
(
	`sub¡r
(
$»cÜdD©a
, 14));

2018 
$objFÚt
->
	`£tName
(
$¡ršg
['value']);

2020 
$this
->
objFÚts
[] = 
$objFÚt
;

2022 
	}
}

2039 
´iv©e
 
funùiÚ
 
	$»adFÜm©
()

2041 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2042 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

2045 
$this
->
pos
 +ğ4 + 
$Ëngth
;

2047 ià(!
$this
->
»adD©aOÆy
) {

2048 
$šdexCode
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

2050 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

2051 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
	`sub¡r
(
$»cÜdD©a
, 2));

2054 
$¡ršg
 = 
$this
->
	`»adBy‹SŒšgShÜt
(
	`sub¡r
(
$»cÜdD©a
, 2));

2057 
$fÜm©SŒšg
 = 
$¡ršg
['value'];

2058 
$this
->
fÜm©s
[
$šdexCode
] = 
$fÜm©SŒšg
;

2060 
	}
}

2077 
´iv©e
 
funùiÚ
 
	$»adXf
()

2079 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2080 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

2083 
$this
->
pos
 +ğ4 + 
$Ëngth
;

2085 
$objStyË
 = 
Ãw
 
	`PHPExûl_StyË
();

2087 ià(!
$this
->
»adD©aOÆy
) {

2089 ià(
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0) < 4) {

2090 
$fÚtIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

2094 
$fÚtIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0) - 1;

2096 
$objStyË
->
	`£tFÚt
(
$this
->
objFÚts
[
$fÚtIndex
]);

2099 
$numb”FÜm©Index
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

2100 ià(
	`is£t
(
$this
->
fÜm©s
[
$numb”FÜm©Index
])) {

2102 
$numb”fÜm©
 = 
	`¬¿y
('code' => 
$this
->
fÜm©s
[
$numb”FÜm©Index
]);

2103 } 
	`–£if
 ((
$code
 = 
PHPExûl_StyË_Numb”FÜm©
::
	`butInFÜm©Code
(
$numb”FÜm©Index
)) !== '') {

2105 
$numb”fÜm©
 = 
	`¬¿y
('code' => 
$code
);

2108 
$numb”fÜm©
 = 
	`¬¿y
('code' => 'General');

2110 
$objStyË
->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
(
$numb”fÜm©
['code']);

2114 
$xfTy³PrÙ
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

2116 
$isLocked
 = (0x01 & 
$xfTy³PrÙ
) >> 0;

2117 
$objStyË
->
	`g‘PrÙeùiÚ
()->
	`£tLocked
(
$isLocked
 ? 
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
 : PHPExûl_StyË_PrÙeùiÚ::
PROTECTION_UNPROTECTED
);

2120 
$isHidd’
 = (0x02 & 
$xfTy³PrÙ
) >> 1;

2121 
$objStyË
->
	`g‘PrÙeùiÚ
()->
	`£tHidd’
(
$isHidd’
 ? 
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
 : PHPExûl_StyË_PrÙeùiÚ::
PROTECTION_UNPROTECTED
);

2124 
$isC–lStyËXf
 = (0x04 & 
$xfTy³PrÙ
) >> 2;

2128 
$hÜAlign
 = (0x07 & 
	`Üd
(
$»cÜdD©a
{6})) >> 0;

2129 
$hÜAlign
) {

2131 
$objStyË
->
	`g‘Alignm’t
()->
	`£tHÜizÚl
(
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
);

2134 
$objStyË
->
	`g‘Alignm’t
()->
	`£tHÜizÚl
(
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_LEFT
);

2137 
$objStyË
->
	`g‘Alignm’t
()->
	`£tHÜizÚl
(
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER
);

2140 
$objStyË
->
	`g‘Alignm’t
()->
	`£tHÜizÚl
(
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_RIGHT
);

2143 
$objStyË
->
	`g‘Alignm’t
()->
	`£tHÜizÚl
(
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_FILL
);

2146 
$objStyË
->
	`g‘Alignm’t
()->
	`£tHÜizÚl
(
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_JUSTIFY
);

2149 
$objStyË
->
	`g‘Alignm’t
()->
	`£tHÜizÚl
(
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER_CONTINUOUS
);

2153 
$w¿pText
 = (0x08 & 
	`Üd
(
$»cÜdD©a
{6})) >> 3;

2154 
$w¿pText
) {

2156 
$objStyË
->
	`g‘Alignm’t
()->
	`£tW¿pText
(
çl£
);

2159 
$objStyË
->
	`g‘Alignm’t
()->
	`£tW¿pText
(
Œue
);

2163 
$v”tAlign
 = (0x70 & 
	`Üd
(
$»cÜdD©a
{6})) >> 4;

2164 
$v”tAlign
) {

2166 
$objStyË
->
	`g‘Alignm’t
()->
	`£tV”tiÿl
(
PHPExûl_StyË_Alignm’t
::
VERTICAL_TOP
);

2169 
$objStyË
->
	`g‘Alignm’t
()->
	`£tV”tiÿl
(
PHPExûl_StyË_Alignm’t
::
VERTICAL_CENTER
);

2172 
$objStyË
->
	`g‘Alignm’t
()->
	`£tV”tiÿl
(
PHPExûl_StyË_Alignm’t
::
VERTICAL_BOTTOM
);

2175 
$objStyË
->
	`g‘Alignm’t
()->
	`£tV”tiÿl
(
PHPExûl_StyË_Alignm’t
::
VERTICAL_JUSTIFY
);

2179 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

2181 
$ªgË
 = 
	`Üd
(
$»cÜdD©a
{7});

2182 
$rÙ©iÚ
 = 0;

2183 ià(
$ªgË
 <= 90) {

2184 
$rÙ©iÚ
 = 
$ªgË
;

2185 } 
	`–£if
 (
$ªgË
 <= 180) {

2186 
$rÙ©iÚ
 = 90 - 
$ªgË
;

2187 } 
	`–£if
 (
$ªgË
 == 255) {

2188 
$rÙ©iÚ
 = -165;

2190 
$objStyË
->
	`g‘Alignm’t
()->
	`£tTextRÙ©iÚ
(
$rÙ©iÚ
);

2194 
$šd’t
 = (0x0F & 
	`Üd
(
$»cÜdD©a
{8})) >> 0;

2195 
$objStyË
->
	`g‘Alignm’t
()->
	`£tInd’t
(
$šd’t
);

2198 
$shrškToF™
 = (0x10 & 
	`Üd
(
$»cÜdD©a
{8})) >> 4;

2199 
$shrškToF™
) {

2201 
$objStyË
->
	`g‘Alignm’t
()->
	`£tShrškToF™
(
çl£
);

2204 
$objStyË
->
	`g‘Alignm’t
()->
	`£tShrškToF™
(
Œue
);

2212 ià(
$bÜd”sLeáStyË
 = 
£lf
::
	`m­BÜd”StyË
((0x0000000F & s–f::
	`g‘IÁ4d
(
$»cÜdD©a
, 10)) >> 0)) {

2213 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Leá
()->
	`£tBÜd”StyË
(
$bÜd”sLeáStyË
);

2216 ià(
$bÜd”sRightStyË
 = 
£lf
::
	`m­BÜd”StyË
((0x000000F0 & s–f::
	`g‘IÁ4d
(
$»cÜdD©a
, 10)) >> 4)) {

2217 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Right
()->
	`£tBÜd”StyË
(
$bÜd”sRightStyË
);

2220 ià(
$bÜd”sTİStyË
 = 
£lf
::
	`m­BÜd”StyË
((0x00000F00 & s–f::
	`g‘IÁ4d
(
$»cÜdD©a
, 10)) >> 8)) {

2221 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
	`£tBÜd”StyË
(
$bÜd”sTİStyË
);

2224 ià(
$bÜd”sBÙtomStyË
 = 
£lf
::
	`m­BÜd”StyË
((0x0000F000 & s–f::
	`g‘IÁ4d
(
$»cÜdD©a
, 10)) >> 12)) {

2225 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
	`£tBÜd”StyË
(
$bÜd”sBÙtomStyË
);

2228 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Leá
()->
cŞÜIndex
 = (0x007F0000 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 10)) >> 16;

2231 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Right
()->
cŞÜIndex
 = (0x3F800000 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 10)) >> 23;

2234 
$dŸgÚ®Down
 = (0x40000000 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 10)è>> 30 ? 
Œue
 : 
çl£
;

2237 
$dŸgÚ®Up
 = (0x80000000 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 10)è>> 31 ? 
Œue
 : 
çl£
;

2239 ià(
$dŸgÚ®Up
 =ğ
çl£
 && 
$dŸgÚ®Down
 == false) {

2240 
$objStyË
->
	`g‘BÜd”s
()->
	`£tDŸgÚ®DœeùiÚ
(
PHPExûl_StyË_BÜd”s
::
DIAGONAL_NONE
);

2241 } 
	`–£if
 (
$dŸgÚ®Up
 =ğ
Œue
 && 
$dŸgÚ®Down
 =ğ
çl£
) {

2242 
$objStyË
->
	`g‘BÜd”s
()->
	`£tDŸgÚ®DœeùiÚ
(
PHPExûl_StyË_BÜd”s
::
DIAGONAL_UP
);

2243 } 
	`–£if
 (
$dŸgÚ®Up
 =ğ
çl£
 && 
$dŸgÚ®Down
 =ğ
Œue
) {

2244 
$objStyË
->
	`g‘BÜd”s
()->
	`£tDŸgÚ®DœeùiÚ
(
PHPExûl_StyË_BÜd”s
::
DIAGONAL_DOWN
);

2245 } 
	`–£if
 (
$dŸgÚ®Up
 =ğ
Œue
 && 
$dŸgÚ®Down
 ==rue) {

2246 
$objStyË
->
	`g‘BÜd”s
()->
	`£tDŸgÚ®DœeùiÚ
(
PHPExûl_StyË_BÜd”s
::
DIAGONAL_BOTH
);

2251 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
cŞÜIndex
 = (0x0000007F & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 14)) >> 0;

2254 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
cŞÜIndex
 = (0x00003F80 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 14)) >> 7;

2257 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘DŸgÚ®
()->
cŞÜIndex
 = (0x001FC000 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 14)) >> 14;

2260 ià(
$bÜd”sDŸgÚ®StyË
 = 
£lf
::
	`m­BÜd”StyË
((0x01E00000 & s–f::
	`g‘IÁ4d
(
$»cÜdD©a
, 14)) >> 21)) {

2261 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘DŸgÚ®
()->
	`£tBÜd”StyË
(
$bÜd”sDŸgÚ®StyË
);

2265 ià(
$flTy³
 = 
£lf
::
	`m­FlP©‹º
((0xFC000000 & s–f::
	`g‘IÁ4d
(
$»cÜdD©a
, 14)) >> 26)) {

2266 
$objStyË
->
	`g‘Fl
()->
	`£tFlTy³
(
$flTy³
);

2270 
$objStyË
->
	`g‘Fl
()->
¡¬tcŞÜIndex
 = (0x007F & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 18)) >> 0;

2273 
$objStyË
->
	`g‘Fl
()->
’dcŞÜIndex
 = (0x3F80 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 18)) >> 7;

2278 
$Ü›Á©iÚAndFÏgs
 = 
	`Üd
(
$»cÜdD©a
{7});

2281 
$xfOr›Á©iÚ
 = (0x03 & 
$Ü›Á©iÚAndFÏgs
) >> 0;

2282 
$xfOr›Á©iÚ
) {

2284 
$objStyË
->
	`g‘Alignm’t
()->
	`£tTextRÙ©iÚ
(0);

2287 
$objStyË
->
	`g‘Alignm’t
()->
	`£tTextRÙ©iÚ
(-165);

2290 
$objStyË
->
	`g‘Alignm’t
()->
	`£tTextRÙ©iÚ
(90);

2293 
$objStyË
->
	`g‘Alignm’t
()->
	`£tTextRÙ©iÚ
(-90);

2298 
$bÜd”AndBackground
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 8);

2301 
$objStyË
->
	`g‘Fl
()->
¡¬tcŞÜIndex
 = (0x0000007F & 
$bÜd”AndBackground
) >> 0;

2304 
$objStyË
->
	`g‘Fl
()->
’dcŞÜIndex
 = (0x00003F80 & 
$bÜd”AndBackground
) >> 7;

2307 
$objStyË
->
	`g‘Fl
()->
	`£tFlTy³
(
£lf
::
	`m­FlP©‹º
((0x003F0000 & 
$bÜd”AndBackground
) >> 16));

2310 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
	`£tBÜd”StyË
(
£lf
::
	`m­BÜd”StyË
((0x01C00000 & 
$bÜd”AndBackground
) >> 22));

2313 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
cŞÜIndex
 = (0xFE000000 & 
$bÜd”AndBackground
) >> 25;

2316 
$bÜd”Lšes
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 12);

2319 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
	`£tBÜd”StyË
(
£lf
::
	`m­BÜd”StyË
((0x00000007 & 
$bÜd”Lšes
) >> 0));

2322 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Leá
()->
	`£tBÜd”StyË
(
£lf
::
	`m­BÜd”StyË
((0x00000038 & 
$bÜd”Lšes
) >> 3));

2325 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Right
()->
	`£tBÜd”StyË
(
£lf
::
	`m­BÜd”StyË
((0x000001C0 & 
$bÜd”Lšes
) >> 6));

2328 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
cŞÜIndex
 = (0x0000FE00 & 
$bÜd”Lšes
) >> 9;

2331 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Leá
()->
cŞÜIndex
 = (0x007F0000 & 
$bÜd”Lšes
) >> 16;

2334 
$objStyË
->
	`g‘BÜd”s
()->
	`g‘Right
()->
cŞÜIndex
 = (0x3F800000 & 
$bÜd”Lšes
) >> 23;

2338 ià(
$isC–lStyËXf
) {

2340 ià(
$this
->
xfIndex
 == 0) {

2341 
$this
->
phpExûl
->
	`addC–lStyËXf
(
$objStyË
);

2342 
$this
->
m­C–lStyËXfIndex
[$this->
xfIndex
] = 0;

2346 
$this
->
phpExûl
->
	`addC–lXf
(
$objStyË
);

2347 
$this
->
m­C–lXfIndex
[$this->
xfIndex
] = 
	`couÁ
($this->
phpExûl
->
	`g‘C–lXfCŞËùiÚ
()) - 1;

2351 ++
$this
->
xfIndex
;

2353 
	}
}

2359 
´iv©e
 
funùiÚ
 
	$»adXfExt
()

2361 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2362 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

2365 
$this
->
pos
 +ğ4 + 
$Ëngth
;

2367 ià(!
$this
->
»adD©aOÆy
) {

2377 
$ixã
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 14);

2382 
$ûxts
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 18);

2385 
$off£t
 = 20;

2386 
$off£t
 < 
$Ëngth
) {

2388 
$extTy³
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$off£t
);

2391 
$cb
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$off£t
 + 2);

2394 
$extD©a
 = 
	`sub¡r
(
$»cÜdD©a
, 
$off£t
 + 4, 
$cb
);

2396 
$extTy³
) {

2398 
$xşfTy³
 = 
£lf
::
	`g‘IÁ2d
(
$extD©a
, 0);

2399 
$xşrV®ue
 = 
	`sub¡r
(
$extD©a
, 4, 4);

2401 ià(
$xşfTy³
 == 2) {

2402 
$rgb
 = 
	`¥rštf
('%02X%02X%02X', 
	`Üd
(
$xşrV®ue
{0}), ord($xclrValue{1}), ord($xclrValue{2}));

2405 ià(
	`is£t
(
$this
->
m­C–lXfIndex
[
$ixã
])) {

2406 
$fl
 = 
$this
->
phpExûl
->
	`g‘C–lXfByIndex
($this->
m­C–lXfIndex
[
$ixã
])->
	`g‘Fl
();

2407 
$fl
->
	`g‘S¹CŞÜ
()->
	`£tRGB
(
$rgb
);

2408 
	`un£t
(
$fl
->
¡¬tcŞÜIndex
);

2413 
$xşfTy³
 = 
£lf
::
	`g‘IÁ2d
(
$extD©a
, 0);

2414 
$xşrV®ue
 = 
	`sub¡r
(
$extD©a
, 4, 4);

2416 ià(
$xşfTy³
 == 2) {

2417 
$rgb
 = 
	`¥rštf
('%02X%02X%02X', 
	`Üd
(
$xşrV®ue
{0}), ord($xclrValue{1}), ord($xclrValue{2}));

2420 ià(
	`is£t
(
$this
->
m­C–lXfIndex
[
$ixã
])) {

2421 
$fl
 = 
$this
->
phpExûl
->
	`g‘C–lXfByIndex
($this->
m­C–lXfIndex
[
$ixã
])->
	`g‘Fl
();

2422 
$fl
->
	`g‘EndCŞÜ
()->
	`£tRGB
(
$rgb
);

2423 
	`un£t
(
$fl
->
’dcŞÜIndex
);

2428 
$xşfTy³
 = 
£lf
::
	`g‘IÁ2d
(
$extD©a
, 0);

2429 
$xşrV®ue
 = 
	`sub¡r
(
$extD©a
, 4, 4);

2431 ià(
$xşfTy³
 == 2) {

2432 
$rgb
 = 
	`¥rštf
('%02X%02X%02X', 
	`Üd
(
$xşrV®ue
{0}), ord($xclrValue{1}), ord($xclrValue{2}));

2435 ià(
	`is£t
(
$this
->
m­C–lXfIndex
[
$ixã
])) {

2436 
$tİ
 = 
$this
->
phpExûl
->
	`g‘C–lXfByIndex
($this->
m­C–lXfIndex
[
$ixã
])->
	`g‘BÜd”s
()->
	`g‘Tİ
();

2437 
$tİ
->
	`g‘CŞÜ
()->
	`£tRGB
(
$rgb
);

2438 
	`un£t
(
$tİ
->
cŞÜIndex
);

2443 
$xşfTy³
 = 
£lf
::
	`g‘IÁ2d
(
$extD©a
, 0);

2444 
$xşrV®ue
 = 
	`sub¡r
(
$extD©a
, 4, 4);

2446 ià(
$xşfTy³
 == 2) {

2447 
$rgb
 = 
	`¥rštf
('%02X%02X%02X', 
	`Üd
(
$xşrV®ue
{0}), ord($xclrValue{1}), ord($xclrValue{2}));

2450 ià(
	`is£t
(
$this
->
m­C–lXfIndex
[
$ixã
])) {

2451 
$bÙtom
 = 
$this
->
phpExûl
->
	`g‘C–lXfByIndex
($this->
m­C–lXfIndex
[
$ixã
])->
	`g‘BÜd”s
()->
	`g‘BÙtom
();

2452 
$bÙtom
->
	`g‘CŞÜ
()->
	`£tRGB
(
$rgb
);

2453 
	`un£t
(
$bÙtom
->
cŞÜIndex
);

2458 
$xşfTy³
 = 
£lf
::
	`g‘IÁ2d
(
$extD©a
, 0);

2459 
$xşrV®ue
 = 
	`sub¡r
(
$extD©a
, 4, 4);

2461 ià(
$xşfTy³
 == 2) {

2462 
$rgb
 = 
	`¥rštf
('%02X%02X%02X', 
	`Üd
(
$xşrV®ue
{0}), ord($xclrValue{1}), ord($xclrValue{2}));

2465 ià(
	`is£t
(
$this
->
m­C–lXfIndex
[
$ixã
])) {

2466 
$Ëá
 = 
$this
->
phpExûl
->
	`g‘C–lXfByIndex
($this->
m­C–lXfIndex
[
$ixã
])->
	`g‘BÜd”s
()->
	`g‘Leá
();

2467 
$Ëá
->
	`g‘CŞÜ
()->
	`£tRGB
(
$rgb
);

2468 
	`un£t
(
$Ëá
->
cŞÜIndex
);

2473 
$xşfTy³
 = 
£lf
::
	`g‘IÁ2d
(
$extD©a
, 0);

2474 
$xşrV®ue
 = 
	`sub¡r
(
$extD©a
, 4, 4);

2476 ià(
$xşfTy³
 == 2) {

2477 
$rgb
 = 
	`¥rštf
('%02X%02X%02X', 
	`Üd
(
$xşrV®ue
{0}), ord($xclrValue{1}), ord($xclrValue{2}));

2480 ià(
	`is£t
(
$this
->
m­C–lXfIndex
[
$ixã
])) {

2481 
$right
 = 
$this
->
phpExûl
->
	`g‘C–lXfByIndex
($this->
m­C–lXfIndex
[
$ixã
])->
	`g‘BÜd”s
()->
	`g‘Right
();

2482 
$right
->
	`g‘CŞÜ
()->
	`£tRGB
(
$rgb
);

2483 
	`un£t
(
$right
->
cŞÜIndex
);

2488 
$xşfTy³
 = 
£lf
::
	`g‘IÁ2d
(
$extD©a
, 0);

2489 
$xşrV®ue
 = 
	`sub¡r
(
$extD©a
, 4, 4);

2491 ià(
$xşfTy³
 == 2) {

2492 
$rgb
 = 
	`¥rštf
('%02X%02X%02X', 
	`Üd
(
$xşrV®ue
{0}), ord($xclrValue{1}), ord($xclrValue{2}));

2495 ià(
	`is£t
(
$this
->
m­C–lXfIndex
[
$ixã
])) {

2496 
$dŸgÚ®
 = 
$this
->
phpExûl
->
	`g‘C–lXfByIndex
($this->
m­C–lXfIndex
[
$ixã
])->
	`g‘BÜd”s
()->
	`g‘DŸgÚ®
();

2497 
$dŸgÚ®
->
	`g‘CŞÜ
()->
	`£tRGB
(
$rgb
);

2498 
	`un£t
(
$dŸgÚ®
->
cŞÜIndex
);

2503 
$xşfTy³
 = 
£lf
::
	`g‘IÁ2d
(
$extD©a
, 0);

2504 
$xşrV®ue
 = 
	`sub¡r
(
$extD©a
, 4, 4);

2506 ià(
$xşfTy³
 == 2) {

2507 
$rgb
 = 
	`¥rštf
('%02X%02X%02X', 
	`Üd
(
$xşrV®ue
{0}), ord($xclrValue{1}), ord($xclrValue{2}));

2510 ià(
	`is£t
(
$this
->
m­C–lXfIndex
[
$ixã
])) {

2511 
$fÚt
 = 
$this
->
phpExûl
->
	`g‘C–lXfByIndex
($this->
m­C–lXfIndex
[
$ixã
])->
	`g‘FÚt
();

2512 
$fÚt
->
	`g‘CŞÜ
()->
	`£tRGB
(
$rgb
);

2513 
	`un£t
(
$fÚt
->
cŞÜIndex
);

2519 
$off£t
 +ğ
$cb
;

2523 
	}
}

2529 
´iv©e
 
funùiÚ
 
	$»adStyË
()

2531 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2532 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

2535 
$this
->
pos
 +ğ4 + 
$Ëngth
;

2537 ià(!
$this
->
»adD©aOÆy
) {

2539 
$ixã
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

2542 
$xfIndex
 = (0x0FFF & 
$ixã
) >> 0;

2545 
$isButIn
 = (
boŞ
è((0x8000 & 
$ixã
) >> 15);

2547 ià(
$isButIn
) {

2549 
$butInId
 = 
	`Üd
(
$»cÜdD©a
{2});

2551 
$butInId
) {

2562 
	}
}

2568 
´iv©e
 
funùiÚ
 
	$»adP®‘‹
()

2570 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2571 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

2574 
$this
->
pos
 +ğ4 + 
$Ëngth
;

2576 ià(!
$this
->
»adD©aOÆy
) {

2578 
$nm
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

2581 
$i
 = 0; $˜< 
$nm
; ++$i) {

2582 
$rgb
 = 
	`sub¡r
(
$»cÜdD©a
, 2 + 4 * 
$i
, 4);

2583 
$this
->
·Ë‰e
[] = 
£lf
::
	`»adRGB
(
$rgb
);

2586 
	}
}

2601 
´iv©e
 
funùiÚ
 
	$»adSh“t
()

2603 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2604 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

2608 
$»c_off£t
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

2611 
$this
->
pos
 +ğ4 + 
$Ëngth
;

2614 
	`Üd
(
$»cÜdD©a
{4})) {

2616 
$sh“tS‹
 = 
PHPExûl_WÜksh“t
::
SHEETSTATE_VISIBLE
;

2619 
$sh“tS‹
 = 
PHPExûl_WÜksh“t
::
SHEETSTATE_HIDDEN
;

2622 
$sh“tS‹
 = 
PHPExûl_WÜksh“t
::
SHEETSTATE_VERYHIDDEN
;

2625 
$sh“tS‹
 = 
PHPExûl_WÜksh“t
::
SHEETSTATE_VISIBLE
;

2630 
$sh“tTy³
 = 
	`Üd
(
$»cÜdD©a
{5});

2633 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

2634 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgShÜt
(
	`sub¡r
(
$»cÜdD©a
, 6));

2635 
$»c_Çme
 = 
$¡ršg
['value'];

2636 } 
	`–£if
 (
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF7
) {

2637 
$¡ršg
 = 
$this
->
	`»adBy‹SŒšgShÜt
(
	`sub¡r
(
$»cÜdD©a
, 6));

2638 
$»c_Çme
 = 
$¡ršg
['value'];

2641 
$this
->
sh“ts
[] = 
	`¬¿y
(

2642 'Çme' => 
$»c_Çme
,

2643 'off£t' => 
$»c_off£t
,

2644 'sh“tS‹' => 
$sh“tS‹
,

2645 'sh“tTy³' => 
$sh“tTy³
,

2647 
	}
}

2653 
´iv©e
 
funùiÚ
 
	$»adEx‹º®Book
()

2655 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2656 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

2659 
$this
->
pos
 +ğ4 + 
$Ëngth
;

2662 
$off£t
 = 0;

2665 ià(
	`¡¾’
(
$»cÜdD©a
) > 4) {

2668 
$nm
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

2669 
$off£t
 += 2;

2672 
$’codedU¾SŒšg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
	`sub¡r
(
$»cÜdD©a
, 2));

2673 
$off£t
 +ğ
$’codedU¾SŒšg
['size'];

2676 
$ex‹º®Sh“tNames
 = 
	`¬¿y
();

2677 
$i
 = 0; $˜< 
$nm
; ++$i) {

2678 
$ex‹º®Sh“tNameSŒšg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
	`sub¡r
(
$»cÜdD©a
, 
$off£t
));

2679 
$ex‹º®Sh“tNames
[] = 
$ex‹º®Sh“tNameSŒšg
['value'];

2680 
$off£t
 +ğ
$ex‹º®Sh“tNameSŒšg
['size'];

2684 
$this
->
ex‹º®Books
[] = 
	`¬¿y
(

2686 '’codedU¾' => 
$’codedU¾SŒšg
['value'],

2687 'ex‹º®Sh“tNames' => 
$ex‹º®Sh“tNames
,

2689 } 
	`–£if
 (
	`sub¡r
(
$»cÜdD©a
, 2, 2è=ğ
	`·ck
('CC', 0x01, 0x04)) {

2693 
$this
->
ex‹º®Books
[] = 
	`¬¿y
(

2696 } 
	`–£if
 (
	`sub¡r
(
$»cÜdD©a
, 0, 4è=ğ
	`·ck
('vCC', 0x0001, 0x01, 0x3A)) {

2699 
$this
->
ex‹º®Books
[] = 
	`¬¿y
(

2702 } 
	`–£if
 (
	`sub¡r
(
$»cÜdD©a
, 0, 2è=ğ
	`·ck
('v', 0x0000)) {

2706 
$this
->
ex‹º®Books
[] = 
	`¬¿y
(

2710 
	}
}

2716 
´iv©e
 
funùiÚ
 
	$»adEx‹ºName
()

2718 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2719 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

2722 
$this
->
pos
 +ğ4 + 
$Ëngth
;

2725 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

2727 
$İtiÚs
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

2734 
$ÇmeSŒšg
 = 
£lf
::
	`»adUnicodeSŒšgShÜt
(
	`sub¡r
(
$»cÜdD©a
, 6));

2737 
$off£t
 = 6 + 
$ÇmeSŒšg
['size'];

2738 
$fÜmuÏ
 = 
$this
->
	`g‘FÜmuÏFromSŒuùu»
(
	`sub¡r
(
$»cÜdD©a
, 
$off£t
));

2740 
$this
->
ex‹º®Names
[] = 
	`¬¿y
(

2741 'Çme' => 
$ÇmeSŒšg
['value'],

2742 'fÜmuÏ' => 
$fÜmuÏ
,

2745 
	}
}

2751 
´iv©e
 
funùiÚ
 
	$»adEx‹ºSh“t
()

2753 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2754 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

2757 
$this
->
pos
 +ğ4 + 
$Ëngth
;

2760 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

2762 
$nm
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

2763 
$i
 = 0; $˜< 
$nm
; ++$i) {

2764 
$this
->
»f
[] = 
	`¬¿y
(

2766 'ex‹º®BookIndex' => 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2 + 6 * 
$i
),

2768 'fœ¡Sh“tIndex' => 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4 + 6 * 
$i
),

2770 'Ï¡Sh“tIndex' => 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 6 + 6 * 
$i
),

2774 
	}
}

2788 
´iv©e
 
funùiÚ
 
	$»adDefšedName
()

2790 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2791 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

2794 
$this
->
pos
 +ğ4 + 
$Ëngth
;

2796 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

2800 
$İts
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

2803 
$isButInName
 = (0x0020 & 
$İts
) >> 5;

2808 
$Æ’
 = 
	`Üd
(
$»cÜdD©a
{3});

2812 
$æ’
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

2815 
$scİe
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 8);

2818 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšg
(
	`sub¡r
(
$»cÜdD©a
, 14), 
$Æ’
);

2821 
$off£t
 = 14 + 
$¡ršg
['size'];

2822 
$fÜmuÏSŒuùu»
 = 
	`·ck
('v', 
$æ’
è. 
	`sub¡r
(
$»cÜdD©a
, 
$off£t
);

2824 
Œy
 {

2825 
$fÜmuÏ
 = 
$this
->
	`g‘FÜmuÏFromSŒuùu»
(
$fÜmuÏSŒuùu»
);

2826 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

2827 
$fÜmuÏ
 = '';

2830 
$this
->
defšedÇme
[] = 
	`¬¿y
(

2831 'isButInName' => 
$isButInName
,

2832 'Çme' => 
$¡ršg
['value'],

2833 'fÜmuÏ' => 
$fÜmuÏ
,

2834 'scİe' => 
$scİe
,

2837 
	}
}

2843 
´iv©e
 
funùiÚ
 
	$»adMsoD¿wšgGroup
()

2845 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

2848 
$¥liûdRecÜdD©a
 = 
$this
->
	`g‘S¶iûdRecÜdD©a
();

2849 
$»cÜdD©a
 = 
$¥liûdRecÜdD©a
['recordData'];

2851 
$this
->
d¿wšgGroupD©a
 .ğ
$»cÜdD©a
;

2852 
	}
}

2866 
´iv©e
 
funùiÚ
 
	$»adS¡
()

2869 
$pos
 = 0;

2872 
$¥liûdRecÜdD©a
 = 
$this
->
	`g‘S¶iûdRecÜdD©a
();

2874 
$»cÜdD©a
 = 
$¥liûdRecÜdD©a
['recordData'];

2875 
$¥liûOff£ts
 = 
$¥liûdRecÜdD©a
['spliceOffsets'];

2878 
$pos
 += 4;

2881 
$nm
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 4);

2882 
$pos
 += 4;

2885 
$i
 = 0; $˜< 
$nm
; ++$i) {

2887 
$numCh¬s
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$pos
);

2888 
$pos
 += 2;

2891 
$İtiÚFÏgs
 = 
	`Üd
(
$»cÜdD©a
{
$pos
});

2892 ++
$pos
;

2895 
$isCom´es£d
 = ((
$İtiÚFÏgs
 & 0x01) == 0) ;

2898 
$hasAsŸn
 = ((
$İtiÚFÏgs
 & 0x04) != 0);

2901 
$hasRichText
 = ((
$İtiÚFÏgs
 & 0x08) != 0);

2903 ià(
$hasRichText
) {

2905 
$fÜm©tšgRuns
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$pos
);

2906 
$pos
 += 2;

2909 ià(
$hasAsŸn
) {

2911 
$ex‹ndedRunL’gth
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 
$pos
);

2912 
$pos
 += 4;

2916 
$Ën
 = (
$isCom´es£d
è? 
$numCh¬s
 : $numChars * 2;

2919 
	`fÜ—ch
 (
$¥liûOff£ts
 
as
 
$¥liûOff£t
) {

2922 ià(
$pos
 <ğ
$¥liûOff£t
) {

2923 
$lim™pos
 = 
$¥liûOff£t
;

2928 ià(
$pos
 + 
$Ën
 <ğ
$lim™pos
) {

2931 
$»t¡r
 = 
	`sub¡r
(
$»cÜdD©a
, 
$pos
, 
$Ën
);

2932 
$pos
 +ğ
$Ën
;

2937 
$»t¡r
 = 
	`sub¡r
(
$»cÜdD©a
, 
$pos
, 
$lim™pos
 - $pos);

2939 
$by‹sR—d
 = 
$lim™pos
 - 
$pos
;

2942 
$ch¬sLeá
 = 
$numCh¬s
 - ((
$isCom´es£d
è? 
$by‹sR—d
 : ($bytesRead / 2));

2944 
$pos
 = 
$lim™pos
;

2947 
$ch¬sLeá
 > 0) {

2949 
	`fÜ—ch
 (
$¥liûOff£ts
 
as
 
$¥liûOff£t
) {

2950 ià(
$pos
 < 
$¥liûOff£t
) {

2951 
$lim™pos
 = 
$¥liûOff£t
;

2958 
$İtiÚ
 = 
	`Üd
(
$»cÜdD©a
{
$pos
});

2959 ++
$pos
;

2961 ià(
$isCom´es£d
 && (
$İtiÚ
 == 0)) {

2964 
$Ën
 = 
	`mš
(
$ch¬sLeá
, 
$lim™pos
 - 
$pos
);

2965 
$»t¡r
 .ğ
	`sub¡r
(
$»cÜdD©a
, 
$pos
, 
$Ën
);

2966 
$ch¬sLeá
 -ğ
$Ën
;

2967 
$isCom´es£d
 = 
Œue
;

2968 } 
	`–£if
 (!
$isCom´es£d
 && (
$İtiÚ
 != 0)) {

2971 
$Ën
 = 
	`mš
(
$ch¬sLeá
 * 2, 
$lim™pos
 - 
$pos
);

2972 
$»t¡r
 .ğ
	`sub¡r
(
$»cÜdD©a
, 
$pos
, 
$Ën
);

2973 
$ch¬sLeá
 -ğ
$Ën
 / 2;

2974 
$isCom´es£d
 = 
çl£
;

2975 } 
	`–£if
 (!
$isCom´es£d
 && (
$İtiÚ
 == 0)) {

2978 
$Ën
 = 
	`mš
(
$ch¬sLeá
, 
$lim™pos
 - 
$pos
);

2979 
$j
 = 0; $j < 
$Ën
; ++$j) {

2980 
$»t¡r
 .ğ
$»cÜdD©a
{
$pos
 + 
$j
} . 
	`chr
(0);

2982 
$ch¬sLeá
 -ğ
$Ën
;

2983 
$isCom´es£d
 = 
çl£
;

2987 
$Ãw¡r
 = '';

2988 
$j
 = 0; $j < 
	`¡¾’
(
$»t¡r
); ++$j) {

2989 
$Ãw¡r
 .ğ
$»t¡r
[
$j
] . 
	`chr
(0);

2991 
$»t¡r
 = 
$Ãw¡r
;

2992 
$Ën
 = 
	`mš
(
$ch¬sLeá
 * 2, 
$lim™pos
 - 
$pos
);

2993 
$»t¡r
 .ğ
	`sub¡r
(
$»cÜdD©a
, 
$pos
, 
$Ën
);

2994 
$ch¬sLeá
 -ğ
$Ën
 / 2;

2995 
$isCom´es£d
 = 
çl£
;

2998 
$pos
 +ğ
$Ën
;

3003 
$»t¡r
 = 
£lf
::
	`’codeUTF16
($»t¡r, 
$isCom´es£d
);

3006 
$fmtRuns
 = 
	`¬¿y
();

3007 ià(
$hasRichText
) {

3009 
$j
 = 0; $j < 
$fÜm©tšgRuns
; ++$j) {

3011 
$ch¬Pos
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$pos
 + 
$j
 * 4);

3014 
$fÚtIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$pos
 + 2 + 
$j
 * 4);

3016 
$fmtRuns
[] = 
	`¬¿y
(

3017 'ch¬Pos' => 
$ch¬Pos
,

3018 'fÚtIndex' => 
$fÚtIndex
,

3021 
$pos
 +ğ4 * 
$fÜm©tšgRuns
;

3025 ià(
$hasAsŸn
) {

3027 
$pos
 +ğ
$ex‹ndedRunL’gth
;

3031 
$this
->
s¡
[] = 
	`¬¿y
(

3032 'v®ue' => 
$»t¡r
,

3033 'fmtRuns' => 
$fmtRuns
,

3038 
	}
}

3044 
´iv©e
 
funùiÚ
 
	$»adPrštGridlšes
()

3046 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3047 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3050 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3052 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
 && !$this->
»adD©aOÆy
) {

3054 
$´štGridlšes
 = (
boŞ
è
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3055 
$this
->
phpSh“t
->
	`£tPrštGridlšes
(
$´štGridlšes
);

3057 
	}
}

3063 
´iv©e
 
funùiÚ
 
	$»adDeçuÉRowHeight
()

3065 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3066 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3069 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3073 
$height
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

3074 
$this
->
phpSh“t
->
	`g‘DeçuÉRowDim’siÚ
()->
	`£tRowHeight
(
$height
 / 20);

3075 
	}
}

3081 
´iv©e
 
funùiÚ
 
	$»adSh“tPr
()

3083 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3084 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3087 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3092 
$isSumm¬yB–ow
 = (0x0040 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0)) >> 6;

3093 
$this
->
phpSh“t
->
	`£tShowSumm¬yB–ow
(
$isSumm¬yB–ow
);

3096 
$isSumm¬yRight
 = (0x0080 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0)) >> 7;

3097 
$this
->
phpSh“t
->
	`£tShowSumm¬yRight
(
$isSumm¬yRight
);

3101 
$this
->
isF™ToPages
 = (
boŞ
è((0x0100 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0)) >> 8);

3102 
	}
}

3108 
´iv©e
 
funùiÚ
 
	$»adHÜizÚlPageB»aks
()

3110 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3111 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3114 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3116 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
 && !$this->
»adD©aOÆy
) {

3118 
$nm
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3121 
$i
 = 0; $˜< 
$nm
; ++$i) {

3122 
$r
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2 + 6 * 
$i
);

3123 
$cf
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2 + 6 * 
$i
 + 2);

3124 
$ş
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2 + 6 * 
$i
 + 4);

3127 
$this
->
phpSh“t
->
	`£tB»akByCŞumnAndRow
(
$cf
, 
$r
, 
PHPExûl_WÜksh“t
::
BREAK_ROW
);

3130 
	}
}

3136 
´iv©e
 
funùiÚ
 
	$»adV”tiÿlPageB»aks
()

3138 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3139 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3142 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3144 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
 && !$this->
»adD©aOÆy
) {

3146 
$nm
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3149 
$i
 = 0; $˜< 
$nm
; ++$i) {

3150 
$c
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2 + 6 * 
$i
);

3151 
$rf
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2 + 6 * 
$i
 + 2);

3152 
$¾
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2 + 6 * 
$i
 + 4);

3155 
$this
->
phpSh“t
->
	`£tB»akByCŞumnAndRow
(
$c
, 
$rf
, 
PHPExûl_WÜksh“t
::
BREAK_COLUMN
);

3158 
	}
}

3164 
´iv©e
 
funùiÚ
 
	$»adH—d”
()

3166 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3167 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3170 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3172 ià(!
$this
->
»adD©aOÆy
) {

3175 ià(
$»cÜdD©a
) {

3176 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

3177 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
$»cÜdD©a
);

3179 
$¡ršg
 = 
$this
->
	`»adBy‹SŒšgShÜt
(
$»cÜdD©a
);

3182 
$this
->
phpSh“t
->
	`g‘H—d”FoÙ”
()->
	`£tOddH—d”
(
$¡ršg
['value']);

3183 
$this
->
phpSh“t
->
	`g‘H—d”FoÙ”
()->
	`£tEv’H—d”
(
$¡ršg
['value']);

3186 
	}
}

3192 
´iv©e
 
funùiÚ
 
	$»adFoÙ”
()

3194 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3195 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3198 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3200 ià(!
$this
->
»adD©aOÆy
) {

3203 ià(
$»cÜdD©a
) {

3204 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

3205 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
$»cÜdD©a
);

3207 
$¡ršg
 = 
$this
->
	`»adBy‹SŒšgShÜt
(
$»cÜdD©a
);

3209 
$this
->
phpSh“t
->
	`g‘H—d”FoÙ”
()->
	`£tOddFoÙ”
(
$¡ršg
['value']);

3210 
$this
->
phpSh“t
->
	`g‘H—d”FoÙ”
()->
	`£tEv’FoÙ”
(
$¡ršg
['value']);

3213 
	}
}

3219 
´iv©e
 
funùiÚ
 
	$»adHûÁ”
()

3221 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3222 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3225 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3227 ià(!
$this
->
»adD©aOÆy
) {

3229 
$isHÜizÚlC’‹»d
 = (
boŞ
è
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3231 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`£tHÜizÚlC’‹»d
(
$isHÜizÚlC’‹»d
);

3233 
	}
}

3239 
´iv©e
 
funùiÚ
 
	$»adVûÁ”
()

3241 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3242 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3245 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3247 ià(!
$this
->
»adD©aOÆy
) {

3249 
$isV”tiÿlC’‹»d
 = (
boŞ
è
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3251 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`£tV”tiÿlC’‹»d
(
$isV”tiÿlC’‹»d
);

3253 
	}
}

3259 
´iv©e
 
funùiÚ
 
	$»adLeáM¬gš
()

3261 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3262 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3265 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3267 ià(!
$this
->
»adD©aOÆy
) {

3269 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`£tLeá
(
£lf
::
	`exŒaùNumb”
(
$»cÜdD©a
));

3271 
	}
}

3277 
´iv©e
 
funùiÚ
 
	$»adRightM¬gš
()

3279 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3280 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3283 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3285 ià(!
$this
->
»adD©aOÆy
) {

3287 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`£tRight
(
£lf
::
	`exŒaùNumb”
(
$»cÜdD©a
));

3289 
	}
}

3295 
´iv©e
 
funùiÚ
 
	$»adTİM¬gš
()

3297 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3298 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3301 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3303 ià(!
$this
->
»adD©aOÆy
) {

3305 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`£tTİ
(
£lf
::
	`exŒaùNumb”
(
$»cÜdD©a
));

3307 
	}
}

3313 
´iv©e
 
funùiÚ
 
	$»adBÙtomM¬gš
()

3315 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3316 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3319 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3321 ià(!
$this
->
»adD©aOÆy
) {

3323 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`£tBÙtom
(
£lf
::
	`exŒaùNumb”
(
$»cÜdD©a
));

3325 
	}
}

3331 
´iv©e
 
funùiÚ
 
	$»adPageS‘up
()

3333 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3334 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3337 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3339 ià(!
$this
->
»adD©aOÆy
) {

3341 
$·³rSize
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3344 
$sÿË
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

3347 
$f™ToWidth
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 6);

3350 
$f™ToHeight
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 8);

3355 
$isPÜŒa™
 = (0x0002 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 10)) >> 1;

3359 
$isNÙIn™
 = (0x0004 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 10)) >> 2;

3361 ià(!
$isNÙIn™
) {

3362 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`£tP­”Size
(
$·³rSize
);

3363 
$isPÜŒa™
) {

3365 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`£tOr›Á©iÚ
(
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_LANDSCAPE
);

3368 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`£tOr›Á©iÚ
(
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_PORTRAIT
);

3372 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`£tSÿË
(
$sÿË
, 
çl£
);

3373 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`£tF™ToPage
((
boŞ
è$this->
isF™ToPages
);

3374 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`£tF™ToWidth
(
$f™ToWidth
, 
çl£
);

3375 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`£tF™ToHeight
(
$f™ToHeight
, 
çl£
);

3379 
$m¬gšH—d”
 = 
£lf
::
	`exŒaùNumb”
(
	`sub¡r
(
$»cÜdD©a
, 16, 8));

3380 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`£tH—d”
(
$m¬gšH—d”
);

3383 
$m¬gšFoÙ”
 = 
£lf
::
	`exŒaùNumb”
(
	`sub¡r
(
$»cÜdD©a
, 24, 8));

3384 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`£tFoÙ”
(
$m¬gšFoÙ”
);

3386 
	}
}

3393 
´iv©e
 
funùiÚ
 
	$»adPrÙeù
()

3395 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3396 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3399 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3401 ià(
$this
->
»adD©aOÆy
) {

3408 
$boŞ
 = (0x01 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0)) >> 0;

3409 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tSh“t
((
boŞ
)
$boŞ
);

3410 
	}
}

3416 
´iv©e
 
funùiÚ
 
	$»adSûnPrÙeù
()

3418 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3419 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3422 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3424 ià(
$this
->
»adD©aOÆy
) {

3431 
$boŞ
 = (0x01 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0)) >> 0;

3433 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tSûÇrios
((
boŞ
)
$boŞ
);

3434 
	}
}

3440 
´iv©e
 
funùiÚ
 
	$»adObjeùPrÙeù
()

3442 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3443 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3446 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3448 ià(
$this
->
»adD©aOÆy
) {

3455 
$boŞ
 = (0x01 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0)) >> 0;

3457 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tObjeùs
((
boŞ
)
$boŞ
);

3458 
	}
}

3464 
´iv©e
 
funùiÚ
 
	$»adPasswÜd
()

3466 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3467 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3470 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3472 ià(!
$this
->
»adD©aOÆy
) {

3474 
$·sswÜd
 = 
	`¡¹ouµ”
(
	`dechex
(
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0)));

3475 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tPasswÜd
(
$·sswÜd
, 
Œue
);

3477 
	}
}

3483 
´iv©e
 
funùiÚ
 
	$»adDefCŞWidth
()

3485 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3486 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3489 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3492 
$width
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3493 ià(
$width
 != 8) {

3494 
$this
->
phpSh“t
->
	`g‘DeçuÉCŞumnDim’siÚ
()->
	`£tWidth
(
$width
);

3496 
	}
}

3502 
´iv©e
 
funùiÚ
 
	$»adCŞInfo
()

3504 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3505 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3508 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3510 ià(!
$this
->
»adD©aOÆy
) {

3512 
$fc
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3515 
$lc
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

3518 
$width
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

3521 
$xfIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 6);

3525 
$isHidd’
 = (0x0001 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 8)) >> 0;

3528 
$Ëv–
 = (0x0700 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 8)) >> 8;

3531 
$isCŞÏp£d
 = (0x1000 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 8)) >> 12;

3535 
$i
 = 
$fc
; $˜<ğ
$lc
; ++$i) {

3536 ià(
$lc
 == 255 || $lc == 256) {

3537 
$this
->
phpSh“t
->
	`g‘DeçuÉCŞumnDim’siÚ
()->
	`£tWidth
(
$width
 / 256);

3540 
$this
->
phpSh“t
->
	`g‘CŞumnDim’siÚByCŞumn
(
$i
)->
	`£tWidth
(
$width
 / 256);

3541 
$this
->
phpSh“t
->
	`g‘CŞumnDim’siÚByCŞumn
(
$i
)->
	`£tVisibË
(!
$isHidd’
);

3542 
$this
->
phpSh“t
->
	`g‘CŞumnDim’siÚByCŞumn
(
$i
)->
	`£tOušeLev–
(
$Ëv–
);

3543 
$this
->
phpSh“t
->
	`g‘CŞumnDim’siÚByCŞumn
(
$i
)->
	`£tCŞÏp£d
(
$isCŞÏp£d
);

3544 
$this
->
phpSh“t
->
	`g‘CŞumnDim’siÚByCŞumn
(
$i
)->
	`£tXfIndex
($this->
m­C–lXfIndex
[
$xfIndex
]);

3547 
	}
}

3560 
´iv©e
 
funùiÚ
 
	$»adRow
()

3562 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3563 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3566 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3568 ià(!
$this
->
»adD©aOÆy
) {

3570 
$r
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3579 
$height
 = (0x7FFF & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 6)) >> 0;

3582 
$u£DeçuÉHeight
 = (0x8000 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 6)) >> 15;

3584 ià(!
$u£DeçuÉHeight
) {

3585 
$this
->
phpSh“t
->
	`g‘RowDim’siÚ
(
$r
 + 1)->
	`£tRowHeight
(
$height
 / 20);

3595 
$Ëv–
 = (0x00000007 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 12)) >> 0;

3596 
$this
->
phpSh“t
->
	`g‘RowDim’siÚ
(
$r
 + 1)->
	`£tOušeLev–
(
$Ëv–
);

3599 
$isCŞÏp£d
 = (0x00000010 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 12)) >> 4;

3600 
$this
->
phpSh“t
->
	`g‘RowDim’siÚ
(
$r
 + 1)->
	`£tCŞÏp£d
(
$isCŞÏp£d
);

3603 
$isHidd’
 = (0x00000020 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 12)) >> 5;

3604 
$this
->
phpSh“t
->
	`g‘RowDim’siÚ
(
$r
 + 1)->
	`£tVisibË
(!
$isHidd’
);

3607 
$hasEx¶ic™FÜm©
 = (0x00000080 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 12)) >> 7;

3610 
$xfIndex
 = (0x0FFF0000 & 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 12)) >> 16;

3612 ià(
$hasEx¶ic™FÜm©
) {

3613 
$this
->
phpSh“t
->
	`g‘RowDim’siÚ
(
$r
 + 1)->
	`£tXfIndex
($this->
m­C–lXfIndex
[
$xfIndex
]);

3616 
	}
}

3630 
´iv©e
 
funùiÚ
 
	$»adRk
()

3632 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3633 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3636 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3639 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3642 
$cŞumn
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

3643 
$cŞumnSŒšg
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumn
);

3646 ià((
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
è&& $this->g‘R—dF‹r()->
	`»adC–l
(
$cŞumnSŒšg
, 
$row
 + 1, $this->
phpSh“t
->
	`g‘T™Ë
())) {

3648 
$xfIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

3651 
$rknum
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 6);

3652 
$numV®ue
 = 
£lf
::
	`g‘IEEE754
(
$rknum
);

3654 
$ûÎ
 = 
$this
->
phpSh“t
->
	`g‘C–l
(
$cŞumnSŒšg
 . (
$row
 + 1));

3655 ià(!
$this
->
»adD©aOÆy
) {

3657 
$ûÎ
->
	`£tXfIndex
(
$this
->
m­C–lXfIndex
[
$xfIndex
]);

3661 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$numV®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

3663 
	}
}

3675 
´iv©e
 
funùiÚ
 
	$»adLab–S¡
()

3677 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3678 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3681 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3684 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3687 
$cŞumn
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

3688 
$cŞumnSŒšg
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumn
);

3691 ià((
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
è&& $this->g‘R—dF‹r()->
	`»adC–l
(
$cŞumnSŒšg
, 
$row
 + 1, $this->
phpSh“t
->
	`g‘T™Ë
())) {

3693 
$xfIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

3696 
$šdex
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 6);

3699 ià((
$fmtRuns
 = 
$this
->
s¡
[
$šdex
]['fmtRuns']è&& !$this->
»adD©aOÆy
) {

3701 
$richText
 = 
Ãw
 
	`PHPExûl_RichText
();

3702 
$ch¬Pos
 = 0;

3703 
$s¡CouÁ
 = 
	`couÁ
(
$this
->
s¡
[
$šdex
]['fmtRuns']);

3704 
$i
 = 0; $˜<ğ
$s¡CouÁ
; ++$i) {

3705 ià(
	`is£t
(
$fmtRuns
[
$i
])) {

3706 
$‹xt
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`Sub¡ršg
(
$this
->
s¡
[
$šdex
]['v®ue'], 
$ch¬Pos
, 
$fmtRuns
[
$i
]['charPos'] - $charPos);

3707 
$ch¬Pos
 = 
$fmtRuns
[
$i
]['charPos'];

3709 
$‹xt
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`Sub¡ršg
(
$this
->
s¡
[
$šdex
]['v®ue'], 
$ch¬Pos
, PHPExûl_Sh¬ed_SŒšg::
	`CouÁCh¬aù”s
($this->sst[$index]['value']));

3712 ià(
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$‹xt
) > 0) {

3713 ià(
$i
 == 0) {

3714 
$richText
->
	`ü—‹Text
(
$‹xt
);

3716 
$‹xtRun
 = 
$richText
->
	`ü—‹TextRun
(
$‹xt
);

3717 ià(
	`is£t
(
$fmtRuns
[
$i
 - 1])) {

3718 ià(
$fmtRuns
[
$i
 - 1]['fontIndex'] < 4) {

3719 
$fÚtIndex
 = 
$fmtRuns
[
$i
 - 1]['fontIndex'];

3723 
$fÚtIndex
 = 
$fmtRuns
[
$i
 - 1]['fontIndex'] - 1;

3725 
$‹xtRun
->
	`£tFÚt
(
şÚe
 
$this
->
objFÚts
[
$fÚtIndex
]);

3730 
$ûÎ
 = 
$this
->
phpSh“t
->
	`g‘C–l
(
$cŞumnSŒšg
 . (
$row
 + 1));

3731 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$richText
, 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
);

3733 
$ûÎ
 = 
$this
->
phpSh“t
->
	`g‘C–l
(
$cŞumnSŒšg
 . (
$row
 + 1));

3734 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$this
->
s¡
[
$šdex
]['v®ue'], 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
);

3737 ià(!
$this
->
»adD©aOÆy
) {

3739 
$ûÎ
->
	`£tXfIndex
(
$this
->
m­C–lXfIndex
[
$xfIndex
]);

3742 
	}
}

3753 
´iv©e
 
funùiÚ
 
	$»adMulRk
()

3755 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3756 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3759 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3762 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3765 
$cŞFœ¡
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

3768 
$cŞLa¡
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$Ëngth
 - 2);

3769 
$cŞumns
 = 
$cŞLa¡
 - 
$cŞFœ¡
 + 1;

3772 
$off£t
 = 4;

3774 
$i
 = 0; $˜< 
$cŞumns
; ++$i) {

3775 
$cŞumnSŒšg
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞFœ¡
 + 
$i
);

3778 ià((
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
è&& $this->g‘R—dF‹r()->
	`»adC–l
(
$cŞumnSŒšg
, 
$row
 + 1, $this->
phpSh“t
->
	`g‘T™Ë
())) {

3780 
$xfIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$off£t
);

3783 
$numV®ue
 = 
£lf
::
	`g‘IEEE754
(£lf::
	`g‘IÁ4d
(
$»cÜdD©a
, 
$off£t
 + 2));

3784 
$ûÎ
 = 
$this
->
phpSh“t
->
	`g‘C–l
(
$cŞumnSŒšg
 . (
$row
 + 1));

3785 ià(!
$this
->
»adD©aOÆy
) {

3787 
$ûÎ
->
	`£tXfIndex
(
$this
->
m­C–lXfIndex
[
$xfIndex
]);

3791 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$numV®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

3794 
$off£t
 += 6;

3796 
	}
}

3807 
´iv©e
 
funùiÚ
 
	$»adNumb”
()

3809 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3810 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3813 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3816 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3819 
$cŞumn
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

3820 
$cŞumnSŒšg
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumn
);

3823 ià((
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
è&& $this->g‘R—dF‹r()->
	`»adC–l
(
$cŞumnSŒšg
, 
$row
 + 1, $this->
phpSh“t
->
	`g‘T™Ë
())) {

3825 
$xfIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

3827 
$numV®ue
 = 
£lf
::
	`exŒaùNumb”
(
	`sub¡r
(
$»cÜdD©a
, 6, 8));

3829 
$ûÎ
 = 
$this
->
phpSh“t
->
	`g‘C–l
(
$cŞumnSŒšg
 . (
$row
 + 1));

3830 ià(!
$this
->
»adD©aOÆy
) {

3832 
$ûÎ
->
	`£tXfIndex
(
$this
->
m­C–lXfIndex
[
$xfIndex
]);

3836 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$numV®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
);

3838 
	}
}

3849 
´iv©e
 
funùiÚ
 
	$»adFÜmuÏ
()

3851 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3852 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3855 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3858 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

3861 
$cŞumn
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

3862 
$cŞumnSŒšg
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumn
);

3865 
$fÜmuÏSŒuùu»
 = 
	`sub¡r
(
$»cÜdD©a
, 20);

3868 
$İtiÚs
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 14);

3873 
$isP¬tOfSh¬edFÜmuÏ
 = (
boŞ
è(0x0008 & 
$İtiÚs
);

3879 
$isP¬tOfSh¬edFÜmuÏ
 = $isP¬tOfSh¬edFÜmuÏ && 
	`Üd
(
$fÜmuÏSŒuùu»
{2}) == 0x01;

3881 ià(
$isP¬tOfSh¬edFÜmuÏ
) {

3884 
$ba£Row
 = 
£lf
::
	`g‘IÁ2d
(
$fÜmuÏSŒuùu»
, 3);

3885 
$ba£CŞ
 = 
£lf
::
	`g‘IÁ2d
(
$fÜmuÏSŒuùu»
, 5);

3886 
$this
->
_ba£C–l
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$ba£CŞ
). (
$ba£Row
 + 1);

3890 ià((
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
è&& $this->g‘R—dF‹r()->
	`»adC–l
(
$cŞumnSŒšg
, 
$row
 + 1, $this->
phpSh“t
->
	`g‘T™Ë
())) {

3891 ià(
$isP¬tOfSh¬edFÜmuÏ
) {

3893 
$this
->
sh¬edFÜmuÏP¬ts
[
$cŞumnSŒšg
 . (
$row
 + 1)] = $this->
_ba£C–l
;

3899 
$xfIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

3902 ià((
	`Üd
(
$»cÜdD©a
{6}) == 0) && (ord($recordData{12}) == 255) && (ord($recordData{13}) == 255)) {

3904 
$d©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

3907 
$code
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
);

3908 ià(
$code
 =ğ
£lf
::
XLS_TYPE_SHAREDFMLA
) {

3909 
$this
->
	`»adSh¬edFmÏ
();

3913 
$v®ue
 = 
$this
->
	`»adSŒšg
();

3914 } 
	`–£if
 ((
	`Üd
(
$»cÜdD©a
{6}) == 1)

3915 && (
	`Üd
(
$»cÜdD©a
{12}) == 255)

3916 && (
	`Üd
(
$»cÜdD©a
{13}) == 255)) {

3918 
$d©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
;

3919 
$v®ue
 = (
boŞ
è
	`Üd
(
$»cÜdD©a
{8});

3920 } 
	`–£if
 ((
	`Üd
(
$»cÜdD©a
{6}) == 2)

3921 && (
	`Üd
(
$»cÜdD©a
{12}) == 255)

3922 && (
	`Üd
(
$»cÜdD©a
{13}) == 255)) {

3924 
$d©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_ERROR
;

3925 
$v®ue
 = 
£lf
::
	`m­E¼ÜCode
(
	`Üd
(
$»cÜdD©a
{8}));

3926 } 
	`–£if
 ((
	`Üd
(
$»cÜdD©a
{6}) == 3)

3927 && (
	`Üd
(
$»cÜdD©a
{12}) == 255)

3928 && (
	`Üd
(
$»cÜdD©a
{13}) == 255)) {

3930 
$d©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
;

3931 
$v®ue
 = '';

3934 
$d©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

3935 
$v®ue
 = 
£lf
::
	`exŒaùNumb”
(
	`sub¡r
(
$»cÜdD©a
, 6, 8));

3938 
$ûÎ
 = 
$this
->
phpSh“t
->
	`g‘C–l
(
$cŞumnSŒšg
 . (
$row
 + 1));

3939 ià(!
$this
->
»adD©aOÆy
) {

3941 
$ûÎ
->
	`£tXfIndex
(
$this
->
m­C–lXfIndex
[
$xfIndex
]);

3945 ià(!
$isP¬tOfSh¬edFÜmuÏ
) {

3948 
Œy
 {

3949 ià(
$this
->
v”siÚ
 !ğ
£lf
::
XLS_BIFF8
) {

3950 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Not BIFF8. Can only„ead BIFF8 formulas');

3952 
$fÜmuÏ
 = 
$this
->
	`g‘FÜmuÏFromSŒuùu»
(
$fÜmuÏSŒuùu»
);

3953 
$ûÎ
->
	`£tV®ueEx¶ic™
('=' . 
$fÜmuÏ
, 
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
);

3955 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

3956 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
$d©aTy³
);

3959 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

3962 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
$d©aTy³
);

3967 
$ûÎ
->
	`£tC®cuÏ‹dV®ue
(
$v®ue
);

3969 
	}
}

3977 
´iv©e
 
funùiÚ
 
	$»adSh¬edFmÏ
()

3979 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

3980 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

3983 
$this
->
pos
 +ğ4 + 
$Ëngth
;

3986 
$ûÎRªge
 = 
	`sub¡r
(
$»cÜdD©a
, 0, 6);

3987 
$ûÎRªge
 = 
$this
->
	`»adBIFF5C–lRªgeAdd»ssFixed
($cellRange);

3992 
$no
 = 
	`Üd
(
$»cÜdD©a
{7});

3995 
$fÜmuÏ
 = 
	`sub¡r
(
$»cÜdD©a
, 8);

3998 
$this
->
sh¬edFÜmuÏs
[$this->
_ba£C–l
] = 
$fÜmuÏ
;

3999 
	}
}

4009 
´iv©e
 
funùiÚ
 
	$»adSŒšg
()

4011 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4012 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4015 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4017 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

4018 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
$»cÜdD©a
);

4019 
$v®ue
 = 
$¡ršg
['value'];

4021 
$¡ršg
 = 
$this
->
	`»adBy‹SŒšgLÚg
(
$»cÜdD©a
);

4022 
$v®ue
 = 
$¡ršg
['value'];

4025  
$v®ue
;

4026 
	}
}

4037 
´iv©e
 
funùiÚ
 
	$»adBoŞE¼
()

4039 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4040 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4043 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4046 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

4049 
$cŞumn
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

4050 
$cŞumnSŒšg
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumn
);

4053 ià((
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
è&& $this->g‘R—dF‹r()->
	`»adC–l
(
$cŞumnSŒšg
, 
$row
 + 1, $this->
phpSh“t
->
	`g‘T™Ë
())) {

4055 
$xfIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

4058 
$boŞE¼
 = 
	`Üd
(
$»cÜdD©a
{6});

4061 
$isE¼Ü
 = 
	`Üd
(
$»cÜdD©a
{7});

4063 
$ûÎ
 = 
$this
->
phpSh“t
->
	`g‘C–l
(
$cŞumnSŒšg
 . (
$row
 + 1));

4064 
$isE¼Ü
) {

4066 
$v®ue
 = (
boŞ
è
$boŞE¼
;

4069 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
);

4072 
$v®ue
 = 
£lf
::
	`m­E¼ÜCode
(
$boŞE¼
);

4075 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_ERROR
);

4079 ià(!
$this
->
»adD©aOÆy
) {

4081 
$ûÎ
->
	`£tXfIndex
(
$this
->
m­C–lXfIndex
[
$xfIndex
]);

4084 
	}
}

4095 
´iv©e
 
funùiÚ
 
	$»adMulBÏnk
()

4097 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4098 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4101 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4104 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

4107 
$fc
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

4111 ià(!
$this
->
»adD©aOÆy
) {

4112 
$i
 = 0; $˜< 
$Ëngth
 / 2 - 3; ++$i) {

4113 
$cŞumnSŒšg
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$fc
 + 
$i
);

4116 ià((
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
è&& $this->g‘R—dF‹r()->
	`»adC–l
(
$cŞumnSŒšg
, 
$row
 + 1, $this->
phpSh“t
->
	`g‘T™Ë
())) {

4117 
$xfIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4 + 2 * 
$i
);

4118 
$this
->
phpSh“t
->
	`g‘C–l
(
$cŞumnSŒšg
 . (
$row
 + 1))->
	`£tXfIndex
($this->
m­C–lXfIndex
[
$xfIndex
]);

4124 
	}
}

4137 
´iv©e
 
funùiÚ
 
	$»adLab–
()

4139 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4140 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4143 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4146 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

4149 
$cŞumn
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

4150 
$cŞumnSŒšg
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumn
);

4153 ià((
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
è&& $this->g‘R—dF‹r()->
	`»adC–l
(
$cŞumnSŒšg
, 
$row
 + 1, $this->
phpSh“t
->
	`g‘T™Ë
())) {

4155 
$xfIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

4159 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

4160 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
	`sub¡r
(
$»cÜdD©a
, 6));

4161 
$v®ue
 = 
$¡ršg
['value'];

4163 
$¡ršg
 = 
$this
->
	`»adBy‹SŒšgLÚg
(
	`sub¡r
(
$»cÜdD©a
, 6));

4164 
$v®ue
 = 
$¡ršg
['value'];

4166 
$ûÎ
 = 
$this
->
phpSh“t
->
	`g‘C–l
(
$cŞumnSŒšg
 . (
$row
 + 1));

4167 
$ûÎ
->
	`£tV®ueEx¶ic™
(
$v®ue
, 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
);

4169 ià(!
$this
->
»adD©aOÆy
) {

4171 
$ûÎ
->
	`£tXfIndex
(
$this
->
m­C–lXfIndex
[
$xfIndex
]);

4174 
	}
}

4180 
´iv©e
 
funùiÚ
 
	$»adBÏnk
()

4182 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4183 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4186 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4189 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

4192 
$cŞ
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

4193 
$cŞumnSŒšg
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ
);

4196 ià((
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
è&& $this->g‘R—dF‹r()->
	`»adC–l
(
$cŞumnSŒšg
, 
$row
 + 1, $this->
phpSh“t
->
	`g‘T™Ë
())) {

4198 
$xfIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

4201 ià(!
$this
->
»adD©aOÆy
) {

4202 
$this
->
phpSh“t
->
	`g‘C–l
(
$cŞumnSŒšg
 . (
$row
 + 1))->
	`£tXfIndex
($this->
m­C–lXfIndex
[
$xfIndex
]);

4206 
	}
}

4212 
´iv©e
 
funùiÚ
 
	$»adMsoD¿wšg
()

4214 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4217 
$¥liûdRecÜdD©a
 = 
$this
->
	`g‘S¶iûdRecÜdD©a
();

4218 
$»cÜdD©a
 = 
$¥liûdRecÜdD©a
['recordData'];

4220 
$this
->
d¿wšgD©a
 .ğ
$»cÜdD©a
;

4221 
	}
}

4227 
´iv©e
 
funùiÚ
 
	$»adObj
()

4229 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4230 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4233 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4235 ià(
$this
->
»adD©aOÆy
 || $this->
v”siÚ
 !ğ
£lf
::
XLS_BIFF8
) {

4248 
$áCmoTy³
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

4249 
$cbCmoSize
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

4250 
$ÙObjTy³
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

4251 
$idObjID
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 6);

4252 
$grb™O±s
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 6);

4254 
$this
->
objs
[] = 
	`¬¿y
(

4255 'áCmoTy³' => 
$áCmoTy³
,

4256 'cbCmoSize' => 
$cbCmoSize
,

4257 'ÙObjTy³' => 
$ÙObjTy³
,

4258 'idObjID' => 
$idObjID
,

4259 'grb™O±s' => 
$grb™O±s


4261 
$this
->
‹xtObjRef
 = 
$idObjID
;

4266 
	}
}

4272 
´iv©e
 
funùiÚ
 
	$»adWšdow2
()

4274 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4275 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4278 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4281 
$İtiÚs
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

4284 
$fœ¡VisibËRow
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

4287 
$fœ¡VisibËCŞumn
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

4288 ià(
$this
->
v”siÚ
 ==ğ
£lf
::
XLS_BIFF8
) {

4293 
$zoomsÿËInPageB»akP»v›w
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 10);

4294 ià(
$zoomsÿËInPageB»akP»v›w
 === 0) {

4295 
$zoomsÿËInPageB»akP»v›w
 = 60;

4297 
$zoomsÿËInNÜm®V›w
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 12);

4298 ià(
$zoomsÿËInNÜm®V›w
 === 0) {

4299 
$zoomsÿËInNÜm®V›w
 = 100;

4304 
$showGridlšes
 = (
boŞ
è((0x0002 & 
$İtiÚs
) >> 1);

4305 
$this
->
phpSh“t
->
	`£tShowGridlšes
(
$showGridlšes
);

4308 
$showRowCŞH—d”s
 = (
boŞ
è((0x0004 & 
$İtiÚs
) >> 2);

4309 
$this
->
phpSh“t
->
	`£tShowRowCŞH—d”s
(
$showRowCŞH—d”s
);

4312 
$this
->
äoz’
 = (
boŞ
è((0x0008 & 
$İtiÚs
) >> 3);

4315 
$this
->
phpSh“t
->
	`£tRightToLeá
((
boŞ
)((0x0040 & 
$İtiÚs
) >> 6));

4318 
$isAùive
 = (
boŞ
è((0x0400 & 
$İtiÚs
) >> 10);

4319 ià(
$isAùive
) {

4320 
$this
->
phpExûl
->
	`£tAùiveSh“tIndex
($this->phpExûl->
	`g‘Index
($this->
phpSh“t
));

4324 
$isPageB»akP»v›w
 = (
boŞ
è((0x0800 & 
$İtiÚs
) >> 11);

4328 ià(
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`g‘V›w
(è!=ğ
PHPExûl_WÜksh“t_Sh“tV›w
::
SHEETVIEW_PAGE_LAYOUT
) {

4330 
$v›w
 = 
$isPageB»akP»v›w
 ? 
PHPExûl_WÜksh“t_Sh“tV›w
::
SHEETVIEW_PAGE_BREAK_PREVIEW
 : PHPExûl_WÜksh“t_Sh“tV›w::
SHEETVIEW_NORMAL
;

4331 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`£tV›w
(
$v›w
);

4332 ià(
$this
->
v”siÚ
 ==ğ
£lf
::
XLS_BIFF8
) {

4333 
$zoomSÿË
 = 
$isPageB»akP»v›w
 ? 
$zoomsÿËInPageB»akP»v›w
 : 
$zoomsÿËInNÜm®V›w
;

4334 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`£tZoomSÿË
(
$zoomSÿË
);

4335 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`£tZoomSÿËNÜm®
(
$zoomsÿËInNÜm®V›w
);

4338 
	}
}

4343 
´iv©e
 
funùiÚ
 
	$»adPageLayoutV›w
()

4345 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4346 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4349 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4355 
$¹
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

4358 
$grb™F¹
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

4363 
$wSÿËPLV
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 12);

4365 
$grb™
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 14);

4368 
$fPageLayoutV›w
 = 
$grb™
 & 0x01;

4369 
$fRuËrVisibË
 = (
$grb™
 >> 1) & 0x01;

4370 
$fWh™e¥aûHidd’
 = (
$grb™
 >> 3) & 0x01;

4372 ià(
$fPageLayoutV›w
 === 1) {

4373 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`£tV›w
(
PHPExûl_WÜksh“t_Sh“tV›w
::
SHEETVIEW_PAGE_LAYOUT
);

4374 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`£tZoomSÿË
(
$wSÿËPLV
);

4377 
	}
}

4382 
´iv©e
 
funùiÚ
 
	$»adSş
()

4384 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4385 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4388 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4391 
$num”©Ü
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

4394 
$d’um”©Ü
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

4397 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`£tZoomSÿË
(
$num”©Ü
 * 100 / 
$d’um”©Ü
);

4398 
	}
}

4404 
´iv©e
 
funùiÚ
 
	$»adPªe
()

4406 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4407 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4410 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4412 ià(!
$this
->
»adD©aOÆy
) {

4414 
$px
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

4417 
$py
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

4419 ià(
$this
->
äoz’
) {

4421 
$this
->
phpSh“t
->
	`ä“zePªe
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$px
è. (
$py
 + 1));

4426 
	}
}

4432 
´iv©e
 
funùiÚ
 
	$»adS–eùiÚ
()

4434 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4435 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4438 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4440 ià(!
$this
->
»adD©aOÆy
) {

4442 
$·ÃId
 = 
	`Üd
(
$»cÜdD©a
{0});

4445 
$r
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 1);

4448 
$c
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 3);

4452 
$šdex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 5);

4455 
$d©a
 = 
	`sub¡r
(
$»cÜdD©a
, 7);

4456 
$ûÎRªgeAdd»ssLi¡
 = 
$this
->
	`»adBIFF5C–lRªgeAdd»ssLi¡
(
$d©a
);

4458 
$£ËùedC–ls
 = 
$ûÎRªgeAdd»ssLi¡
['cellRangeAddresses'][0];

4461 ià(
	`´eg_m©ch
('/^([A-Z]+1\:[A-Z]+)16384$/', 
$£ËùedC–ls
)) {

4462 
$£ËùedC–ls
 = 
	`´eg_»¶aû
('/^([A-Z]+1\:[A-Z]+)16384$/', '${1}1048576', $selectedCells);

4466 ià(
	`´eg_m©ch
('/^([A-Z]+1\:[A-Z]+)65536$/', 
$£ËùedC–ls
)) {

4467 
$£ËùedC–ls
 = 
	`´eg_»¶aû
('/^([A-Z]+1\:[A-Z]+)65536$/', '${1}1048576', $selectedCells);

4471 ià(
	`´eg_m©ch
('/^(A[0-9]+\:)IV([0-9]+)$/', 
$£ËùedC–ls
)) {

4472 
$£ËùedC–ls
 = 
	`´eg_»¶aû
('/^(A[0-9]+\:)IV([0-9]+)$/', '${1}XFD${2}', $selectedCells);

4475 
$this
->
phpSh“t
->
	`£tS–eùedC–ls
(
$£ËùedC–ls
);

4477 
	}
}

4480 
´iv©e
 
funùiÚ
 
	$šşudeC–lRªgeF‹»d
(
$ûÎRªgeAdd»ss
)

4482 
$šşudeC–lRªge
 = 
Œue
;

4483 ià(
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
) {

4484 
$šşudeC–lRªge
 = 
çl£
;

4485 
$¿ngeBound¬›s
 = 
PHPExûl_C–l
::
	`g‘RªgeBound¬›s
(
$ûÎRªgeAdd»ss
);

4486 
$¿ngeBound¬›s
[1][0]++;

4487 
$row
 = 
$¿ngeBound¬›s
[0][1]; $row <= $rangeBoundaries[1][1]; $row++) {

4488 
$cŞumn
 = 
$¿ngeBound¬›s
[0][0]; $column != $rangeBoundaries[1][0]; $column++) {

4489 ià(
$this
->
	`g‘R—dF‹r
()->
	`»adC–l
(
$cŞumn
, 
$row
, $this->
phpSh“t
->
	`g‘T™Ë
())) {

4490 
$šşudeC–lRªge
 = 
Œue
;

4496  
$šşudeC–lRªge
;

4497 
	}
}

4509 
´iv©e
 
funùiÚ
 
	$»adM”gedC–ls
()

4511 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4512 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4515 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4517 ià(
$this
->
v”siÚ
 =ğ
£lf
::
XLS_BIFF8
 && !$this->
»adD©aOÆy
) {

4518 
$ûÎRªgeAdd»ssLi¡
 = 
$this
->
	`»adBIFF8C–lRªgeAdd»ssLi¡
(
$»cÜdD©a
);

4519 
	`fÜ—ch
 (
$ûÎRªgeAdd»ssLi¡
['ûÎRªgeAdd»s£s'] 
as
 
$ûÎRªgeAdd»ss
) {

4520 ià((
	`¡½os
(
$ûÎRªgeAdd»ss
, ':'è!=ğ
çl£
) &&

4521 (
$this
->
	`šşudeC–lRªgeF‹»d
(
$ûÎRªgeAdd»ss
))) {

4522 
$this
->
phpSh“t
->
	`m”geC–ls
(
$ûÎRªgeAdd»ss
);

4526 
	}
}

4532 
´iv©e
 
funùiÚ
 
	$»adHy³rLšk
()

4534 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4535 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4538 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4540 ià(!
$this
->
»adD©aOÆy
) {

4542 
Œy
 {

4543 
$ûÎRªge
 = 
$this
->
	`»adBIFF8C–lRªgeAdd»ssFixed
(
$»cÜdD©a
, 0, 8);

4544 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

4554 
$isFeLškOrU¾
 = (0x00000001 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 28)) >> 0;

4557 
$isAbsP©hOrU¾
 = (0x00000001 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 28)) >> 1;

4560 
$hasDesc
 = (0x00000014 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 28)) >> 2;

4563 
$hasText
 = (0x00000008 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 28)) >> 3;

4566 
$hasF¿me
 = (0x00000080 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 28)) >> 7;

4569 
$isUNC
 = (0x00000100 & 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 28)) >> 8;

4572 
$off£t
 = 32;

4574 ià(
$hasDesc
) {

4576 
$dl
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 32);

4578 
$desc
 = 
£lf
::
	`’codeUTF16
(
	`sub¡r
(
$»cÜdD©a
, 36, 2 * (
$dl
 - 1)), 
çl£
);

4579 
$off£t
 +ğ4 + 2 * 
$dl
;

4581 ià(
$hasF¿me
) {

4582 
$æ
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 
$off£t
);

4583 
$off£t
 +ğ4 + 2 * 
$æ
;

4587 
$hy³¾škTy³
 = 
nuÎ
;

4589 ià(
$isUNC
) {

4590 
$hy³¾škTy³
 = 'UNC';

4591 } 
	`–£if
 (!
$isFeLškOrU¾
) {

4592 
$hy³¾škTy³
 = 'workbook';

4593 } 
	`–£if
 (
	`Üd
(
$»cÜdD©a
{
$off£t
}) == 0x03) {

4594 
$hy³¾škTy³
 = 'local';

4595 } 
	`–£if
 (
	`Üd
(
$»cÜdD©a
{
$off£t
}) == 0xE0) {

4596 
$hy³¾škTy³
 = 'URL';

4599 
$hy³¾škTy³
) {

4605 
$off£t
 += 16;

4607 
$us
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 
$off£t
);

4608 
$off£t
 += 4;

4610 
$u¾
 = 
£lf
::
	`’codeUTF16
(
	`sub¡r
(
$»cÜdD©a
, 
$off£t
, 
$us
 - 2), 
çl£
);

4611 
$nuÎOff£t
 = 
	`¡½os
(
$u¾
, 0x00);

4612 ià(
$nuÎOff£t
) {

4613 
$u¾
 = 
	`sub¡r
($u¾, 0, 
$nuÎOff£t
);

4615 
$u¾
 .ğ
$hasText
 ? '#' : '';

4616 
$off£t
 +ğ
$us
;

4625 
$off£t
 += 16;

4628 
$upLev–CouÁ
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$off£t
);

4629 
$off£t
 += 2;

4632 
$¦
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 
$off£t
);

4633 
$off£t
 += 4;

4636 
$shÜ‹ÃdFeP©h
 = 
	`sub¡r
(
$»cÜdD©a
, 
$off£t
, 
$¦
);

4637 
$shÜ‹ÃdFeP©h
 = 
£lf
::
	`’codeUTF16
($shÜ‹ÃdFeP©h, 
Œue
);

4638 
$shÜ‹ÃdFeP©h
 = 
	`sub¡r
($shortenedFilePath, 0, -1);

4640 
$off£t
 +ğ
$¦
;

4643 
$off£t
 += 24;

4647 
$sz
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 
$off£t
);

4648 
$off£t
 += 4;

4651 ià(
$sz
 > 0) {

4653 
$xl
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 
$off£t
);

4654 
$off£t
 += 4;

4657 
$off£t
 += 2;

4660 
$ex‹ndedFeP©h
 = 
	`sub¡r
(
$»cÜdD©a
, 
$off£t
, 
$xl
);

4661 
$ex‹ndedFeP©h
 = 
£lf
::
	`’codeUTF16
($ex‹ndedFeP©h, 
çl£
);

4662 
$off£t
 +ğ
$xl
;

4666 
$u¾
 = 
	`¡r_»³©
('..\\', 
$upLev–CouÁ
);

4667 
$u¾
 .ğ(
$sz
 > 0è? 
$ex‹ndedFeP©h
 : 
$shÜ‹ÃdFeP©h
;

4668 
$u¾
 .ğ
$hasText
 ? '#' : '';

4678 
$u¾
 = 'sheet://';

4684 ià(
$hasText
) {

4686 
$
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 
$off£t
);

4687 
$off£t
 += 4;

4689 
$‹xt
 = 
£lf
::
	`’codeUTF16
(
	`sub¡r
(
$»cÜdD©a
, 
$off£t
, 2 * (
$
 - 1)), 
çl£
);

4690 
$u¾
 .ğ
$‹xt
;

4694 
	`fÜ—ch
 (
PHPExûl_C–l
::
	`exŒaùAÎC–lReã»nûsInRªge
(
$ûÎRªge
è
as
 
$coÜdš©e
) {

4695 
$this
->
phpSh“t
->
	`g‘C–l
(
$coÜdš©e
)->
	`g‘Hy³rLšk
()->
	`£tU¾
(
$u¾
);

4698 
	}
}

4704 
´iv©e
 
funùiÚ
 
	$»adD©aV®id©iÚs
()

4706 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4707 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4710 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4711 
	}
}

4717 
´iv©e
 
funùiÚ
 
	$»adD©aV®id©iÚ
()

4719 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4720 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4723 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4725 ià(
$this
->
»adD©aOÆy
) {

4730 
$İtiÚs
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 0);

4733 
$ty³
 = (0x0000000F & 
$İtiÚs
) >> 0;

4734 
$ty³
) {

4736 
$ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_NONE
;

4739 
$ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_WHOLE
;

4742 
$ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_DECIMAL
;

4745 
$ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_LIST
;

4748 
$ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_DATE
;

4751 
$ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_TIME
;

4754 
$ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_TEXTLENGTH
;

4757 
$ty³
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_CUSTOM
;

4762 
$”rÜStyË
 = (0x00000070 & 
$İtiÚs
) >> 4;

4763 
$”rÜStyË
) {

4765 
$”rÜStyË
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
STYLE_STOP
;

4768 
$”rÜStyË
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
STYLE_WARNING
;

4771 
$”rÜStyË
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
STYLE_INFORMATION
;

4777 
$ex¶ic™FÜmuÏ
 = (0x00000080 & 
$İtiÚs
) >> 7;

4780 
$®lowBÏnk
 = (0x00000100 & 
$İtiÚs
) >> 8;

4783 
$suµ»ssDrİDown
 = (0x00000200 & 
$İtiÚs
) >> 9;

4786 
$showIÅutMes§ge
 = (0x00040000 & 
$İtiÚs
) >> 18;

4789 
$showE¼ÜMes§ge
 = (0x00080000 & 
$İtiÚs
) >> 19;

4792 
$İ”©Ü
 = (0x00F00000 & 
$İtiÚs
) >> 20;

4793 
$İ”©Ü
) {

4795 
$İ”©Ü
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_BETWEEN
;

4798 
$İ”©Ü
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_NOTBETWEEN
;

4801 
$İ”©Ü
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_EQUAL
;

4804 
$İ”©Ü
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_NOTEQUAL
;

4807 
$İ”©Ü
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_GREATERTHAN
;

4810 
$İ”©Ü
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_LESSTHAN
;

4813 
$İ”©Ü
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_GREATERTHANOREQUAL
;

4816 
$İ”©Ü
 = 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_LESSTHANOREQUAL
;

4821 
$off£t
 = 4;

4822 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
	`sub¡r
(
$»cÜdD©a
, 
$off£t
));

4823 
$´om±T™Ë
 = 
$¡ršg
['v®ue'] !=ğ
	`chr
(0) ? $string['value'] : '';

4824 
$off£t
 +ğ
$¡ršg
['size'];

4827 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
	`sub¡r
(
$»cÜdD©a
, 
$off£t
));

4828 
$”rÜT™Ë
 = 
$¡ršg
['v®ue'] !=ğ
	`chr
(0) ? $string['value'] : '';

4829 
$off£t
 +ğ
$¡ršg
['size'];

4832 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
	`sub¡r
(
$»cÜdD©a
, 
$off£t
));

4833 
$´om±
 = 
$¡ršg
['v®ue'] !=ğ
	`chr
(0) ? $string['value'] : '';

4834 
$off£t
 +ğ
$¡ršg
['size'];

4837 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
	`sub¡r
(
$»cÜdD©a
, 
$off£t
));

4838 
$”rÜ
 = 
$¡ršg
['v®ue'] !=ğ
	`chr
(0) ? $string['value'] : '';

4839 
$off£t
 +ğ
$¡ršg
['size'];

4842 
$sz1
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$off£t
);

4843 
$off£t
 += 2;

4846 
$off£t
 += 2;

4849 
$fÜmuÏ1
 = 
	`sub¡r
(
$»cÜdD©a
, 
$off£t
, 
$sz1
);

4850 
$fÜmuÏ1
 = 
	`·ck
('v', 
$sz1
) . $formula1;

4851 
Œy
 {

4852 
$fÜmuÏ1
 = 
$this
->
	`g‘FÜmuÏFromSŒuùu»
($formula1);

4855 ià(
$ty³
 =ğ
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_LIST
) {

4856 
$fÜmuÏ1
 = 
	`¡r_»¶aû
(
	`chr
(0), ',', $formula1);

4858 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

4861 
$off£t
 +ğ
$sz1
;

4864 
$sz2
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 
$off£t
);

4865 
$off£t
 += 2;

4868 
$off£t
 += 2;

4871 
$fÜmuÏ2
 = 
	`sub¡r
(
$»cÜdD©a
, 
$off£t
, 
$sz2
);

4872 
$fÜmuÏ2
 = 
	`·ck
('v', 
$sz2
) . $formula2;

4873 
Œy
 {

4874 
$fÜmuÏ2
 = 
$this
->
	`g‘FÜmuÏFromSŒuùu»
($formula2);

4875 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

4878 
$off£t
 +ğ
$sz2
;

4881 
$ûÎRªgeAdd»ssLi¡
 = 
$this
->
	`»adBIFF8C–lRªgeAdd»ssLi¡
(
	`sub¡r
(
$»cÜdD©a
, 
$off£t
));

4882 
$ûÎRªgeAdd»s£s
 = 
$ûÎRªgeAdd»ssLi¡
['cellRangeAddresses'];

4884 
	`fÜ—ch
 (
$ûÎRªgeAdd»s£s
 
as
 
$ûÎRªge
) {

4885 
$¡Rªge
 = 
$this
->
phpSh“t
->
	`shrškRªgeToF™
(
$ûÎRªge
);

4886 
	`fÜ—ch
 (
PHPExûl_C–l
::
	`exŒaùAÎC–lReã»nûsInRªge
(
$¡Rªge
è
as
 
$coÜdš©e
) {

4887 
$objV®id©iÚ
 = 
$this
->
phpSh“t
->
	`g‘C–l
(
$coÜdš©e
)->
	`g‘D©aV®id©iÚ
();

4888 
$objV®id©iÚ
->
	`£tTy³
(
$ty³
);

4889 
$objV®id©iÚ
->
	`£tE¼ÜStyË
(
$”rÜStyË
);

4890 
$objV®id©iÚ
->
	`£tAÎowBÏnk
((
boŞ
)
$®lowBÏnk
);

4891 
$objV®id©iÚ
->
	`£tShowIÅutMes§ge
((
boŞ
)
$showIÅutMes§ge
);

4892 
$objV®id©iÚ
->
	`£tShowE¼ÜMes§ge
((
boŞ
)
$showE¼ÜMes§ge
);

4893 
$objV®id©iÚ
->
	`£tShowDrİDown
(!
$suµ»ssDrİDown
);

4894 
$objV®id©iÚ
->
	`£tO³¿tÜ
(
$İ”©Ü
);

4895 
$objV®id©iÚ
->
	`£tE¼ÜT™Ë
(
$”rÜT™Ë
);

4896 
$objV®id©iÚ
->
	`£tE¼Ü
(
$”rÜ
);

4897 
$objV®id©iÚ
->
	`£tProm±T™Ë
(
$´om±T™Ë
);

4898 
$objV®id©iÚ
->
	`£tProm±
(
$´om±
);

4899 
$objV®id©iÚ
->
	`£tFÜmuÏ1
(
$fÜmuÏ1
);

4900 
$objV®id©iÚ
->
	`£tFÜmuÏ2
(
$fÜmuÏ2
);

4903 
	}
}

4908 
´iv©e
 
funùiÚ
 
	$»adSh“tLayout
()

4910 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4911 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4914 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4917 
$off£t
 = 0;

4919 ià(!
$this
->
»adD©aOÆy
) {

4926 
$sz
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 12);

4928 
$sz
) {

4931 
$cŞÜIndex
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 16);

4932 
$cŞÜ
 = 
£lf
::
	`»adCŞÜ
(
$cŞÜIndex
, 
$this
->
·Ë‰e
, $this->
v”siÚ
);

4933 
$this
->
phpSh“t
->
	`g‘TabCŞÜ
()->
	`£tRGB
(
$cŞÜ
['rgb']);

4941 
	}
}

4947 
´iv©e
 
funùiÚ
 
	$»adSh“tPrÙeùiÚ
()

4949 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

4950 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

4953 
$this
->
pos
 +ğ4 + 
$Ëngth
;

4955 ià(
$this
->
»adD©aOÆy
) {

4966 
$isf
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 12);

4967 ià(
$isf
 != 2) {

4977 
$İtiÚs
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 19);

4980 
$boŞ
 = (0x0001 & 
$İtiÚs
) >> 0;

4981 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tObjeùs
(!
$boŞ
);

4984 
$boŞ
 = (0x0002 & 
$İtiÚs
) >> 1;

4985 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tSûÇrios
(!
$boŞ
);

4988 
$boŞ
 = (0x0004 & 
$İtiÚs
) >> 2;

4989 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tFÜm©C–ls
(!
$boŞ
);

4992 
$boŞ
 = (0x0008 & 
$İtiÚs
) >> 3;

4993 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tFÜm©CŞumns
(!
$boŞ
);

4996 
$boŞ
 = (0x0010 & 
$İtiÚs
) >> 4;

4997 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tFÜm©Rows
(!
$boŞ
);

5000 
$boŞ
 = (0x0020 & 
$İtiÚs
) >> 5;

5001 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tIn£¹CŞumns
(!
$boŞ
);

5004 
$boŞ
 = (0x0040 & 
$İtiÚs
) >> 6;

5005 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tIn£¹Rows
(!
$boŞ
);

5008 
$boŞ
 = (0x0080 & 
$İtiÚs
) >> 7;

5009 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tIn£¹Hy³¾šks
(!
$boŞ
);

5012 
$boŞ
 = (0x0100 & 
$İtiÚs
) >> 8;

5013 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tD–‘eCŞumns
(!
$boŞ
);

5016 
$boŞ
 = (0x0200 & 
$İtiÚs
) >> 9;

5017 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tD–‘eRows
(!
$boŞ
);

5020 
$boŞ
 = (0x0400 & 
$İtiÚs
) >> 10;

5021 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tS–eùLockedC–ls
(!
$boŞ
);

5024 
$boŞ
 = (0x0800 & 
$İtiÚs
) >> 11;

5025 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tSÜt
(!
$boŞ
);

5028 
$boŞ
 = (0x1000 & 
$İtiÚs
) >> 12;

5029 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tAutoF‹r
(!
$boŞ
);

5032 
$boŞ
 = (0x2000 & 
$İtiÚs
) >> 13;

5033 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tPivÙTabËs
(!
$boŞ
);

5036 
$boŞ
 = (0x4000 & 
$İtiÚs
) >> 14;

5037 
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`£tS–eùUÆockedC–ls
(!
$boŞ
);

5040 
	}
}

5048 
´iv©e
 
funùiÚ
 
	$»adRªgePrÙeùiÚ
()

5050 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

5051 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

5054 
$this
->
pos
 +ğ4 + 
$Ëngth
;

5057 
$off£t
 = 0;

5059 ià(!
$this
->
»adD©aOÆy
) {

5060 
$off£t
 += 12;

5063 
$isf
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 12);

5064 ià(
$isf
 != 2) {

5068 
$off£t
 += 2;

5070 
$off£t
 += 5;

5073 
$üef
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 19);

5074 
$off£t
 += 2;

5076 
$off£t
 += 6;

5079 
$ûÎRªges
 = 
	`¬¿y
();

5080 
$i
 = 0; $˜< 
$üef
; ++$i) {

5081 
Œy
 {

5082 
$ûÎRªge
 = 
$this
->
	`»adBIFF8C–lRªgeAdd»ssFixed
(
	`sub¡r
(
$»cÜdD©a
, 27 + 8 * 
$i
, 8));

5083 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

5086 
$ûÎRªges
[] = 
$ûÎRªge
;

5087 
$off£t
 += 8;

5091 
$rgbF—t
 = 
	`sub¡r
(
$»cÜdD©a
, 
$off£t
);

5092 
$off£t
 += 4;

5095 
$wPasswÜd
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 
$off£t
);

5096 
$off£t
 += 4;

5099 ià(
$ûÎRªges
) {

5100 
$this
->
phpSh“t
->
	`´ÙeùC–ls
(
	`im¶ode
(' ', 
$ûÎRªges
), 
	`¡¹ouµ”
(
	`dechex
(
$wPasswÜd
)), 
Œue
);

5103 
	}
}

5109 
´iv©e
 
funùiÚ
 
	$»adImD©a
()

5111 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

5114 
$¥liûdRecÜdD©a
 = 
$this
->
	`g‘S¶iûdRecÜdD©a
();

5115 
$»cÜdD©a
 = 
$¥liûdRecÜdD©a
['recordData'];

5120 
$cf
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 0);

5123 
$’v
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

5126 
$lcb
 = 
£lf
::
	`g‘IÁ4d
(
$»cÜdD©a
, 4);

5129 
$iD©a
 = 
	`sub¡r
(
$»cÜdD©a
, 8);

5131 
$cf
) {

5136 
$bcSize
 = 
£lf
::
	`g‘IÁ4d
(
$iD©a
, 0);

5140 
$bcWidth
 = 
£lf
::
	`g‘IÁ2d
(
$iD©a
, 4);

5144 
$bcHeight
 = 
£lf
::
	`g‘IÁ2d
(
$iD©a
, 6);

5146 
$ih
 = 
	`imageü—‹ŒuecŞÜ
(
$bcWidth
, 
$bcHeight
);

5151 
$bcB™CouÁ
 = 
£lf
::
	`g‘IÁ2d
(
$iD©a
, 10);

5154 
$rgbSŒšg
 = 
	`sub¡r
(
$iD©a
, 12);

5155 
$rgbTrËs
 = 
	`¬¿y
();

5156 
	`¡¾’
(
$rgbSŒšg
) > 0) {

5157 
$rgbTrËs
[] = 
	`uÅack
('Cb/Cg/Cr', 
$rgbSŒšg
);

5158 
$rgbSŒšg
 = 
	`sub¡r
($rgbString, 3);

5160 
$x
 = 0;

5161 
$y
 = 0;

5162 
	`fÜ—ch
 (
$rgbTrËs
 
as
 
$i
 => 
$rgbTrË
) {

5163 
$cŞÜ
 = 
	`imagecŞÜ®loÿ‹
(
$ih
, 
$rgbTrË
['r'], $rgbTriple['g'], $rgbTriple['b']);

5164 
	`image£ix–
(
$ih
, 
$x
, 
$bcHeight
 - 1 - 
$y
, 
$cŞÜ
);

5165 
$x
 = ($x + 1è% 
$bcWidth
;

5166 
$y
 = $y + 
	`æoÜ
((
$x
 + 1è/ 
$bcWidth
);

5170 
$d¿wšg
 = 
Ãw
 
	`PHPExûl_WÜksh“t_D¿wšg
();

5171 
$d¿wšg
->
	`£tP©h
(
$f’ame
);

5172 
$d¿wšg
->
	`£tWÜksh“t
(
$this
->
phpSh“t
);

5181 
	}
}

5189 
´iv©e
 
funùiÚ
 
	$»adCÚtšue
()

5191 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

5192 
$»cÜdD©a
 = 
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

5196 ià(
$this
->
d¿wšgD©a
 == '') {

5198 
$this
->
pos
 +ğ4 + 
$Ëngth
;

5204 ià(
$Ëngth
 < 4) {

5206 
$this
->
pos
 +ğ4 + 
$Ëngth
;

5217 
$v®idS¶™Pošts
 = 
	`¬¿y
(0xF003, 0xF004, 0xF00D);

5219 
$¥l™Pošt
 = 
£lf
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

5220 ià(
	`š_¬¿y
(
$¥l™Pošt
, 
$v®idS¶™Pošts
)) {

5222 
$¥liûdRecÜdD©a
 = 
$this
->
	`g‘S¶iûdRecÜdD©a
();

5223 
$this
->
d¿wšgD©a
 .ğ
$¥liûdRecÜdD©a
['recordData'];

5229 
$this
->
pos
 +ğ4 + 
$Ëngth
;

5230 
	}
}

5241 
´iv©e
 
funùiÚ
 
	$g‘S¶iûdRecÜdD©a
()

5243 
$d©a
 = '';

5244 
$¥liûOff£ts
 = 
	`¬¿y
();

5246 
$i
 = 0;

5247 
$¥liûOff£ts
[0] = 0;

5250 ++
$i
;

5253 
$id’tif›r
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
);

5255 
$Ëngth
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

5256 
$d©a
 .ğ
$this
->
	`»adRecÜdD©a
($this->
d©a
, $this->
pos
 + 4, 
$Ëngth
);

5258 
$¥liûOff£ts
[
$i
] = $¥liûOff£ts[$˜- 1] + 
$Ëngth
;

5260 
$this
->
pos
 +ğ4 + 
$Ëngth
;

5261 
$ÃxtId’tif›r
 = 
£lf
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
);

5262 } 
$ÃxtId’tif›r
 =ğ
£lf
::
XLS_TYPE_CONTINUE
);

5264 
$¥liûdD©a
 = 
	`¬¿y
(

5265 '»cÜdD©a' => 
$d©a
,

5266 '¥liûOff£ts' => 
$¥liûOff£ts
,

5269  
$¥liûdD©a
;

5271 
	}
}

5281 
´iv©e
 
funùiÚ
 
g‘FÜmuÏFromSŒuùu»
(
$fÜmuÏSŒuùu»
, 
$ba£C–l
 = 'A1')

5284 
$sz
 = 
£lf
::
g‘IÁ2d
(
$fÜmuÏSŒuùu»
, 0);

5287 
	g$fÜmuÏD©a
 = 
sub¡r
(
$fÜmuÏSŒuùu»
, 2, 
$sz
);

5297 ià(
¡¾’
(
$fÜmuÏSŒuùu»
è> 2 + 
	g$sz
) {

5298 
	g$add™iÚ®D©a
 = 
sub¡r
(
$fÜmuÏSŒuùu»
, 2 + 
$sz
);

5305 
	g$add™iÚ®D©a
 = '';

5308  
	g$this
->
g‘FÜmuÏFromD©a
(
$fÜmuÏD©a
, 
$add™iÚ®D©a
, 
$ba£C–l
);

5320 
´iv©e
 
funùiÚ
 
g‘FÜmuÏFromD©a
(
$fÜmuÏD©a
, 
$add™iÚ®D©a
 = '', 
$ba£C–l
 = 'A1')

5323 
$tok’s
 = 
¬¿y
();

5325 
¡¾’
(
$fÜmuÏD©a
è> 0 
ªd
 
	g$tok’
 = 
$this
->
g‘NextTok’
($fÜmuÏD©a, 
$ba£C–l
)) {

5326 
	g$tok’s
[] = 
$tok’
;

5327 
	g$fÜmuÏD©a
 = 
sub¡r
(
$fÜmuÏD©a
, 
$tok’
['size']);

5333 
	g$fÜmuÏSŒšg
 = 
$this
->
ü—‹FÜmuÏFromTok’s
(
$tok’s
, 
$add™iÚ®D©a
);

5335  
	g$fÜmuÏSŒšg
;

5347 
´iv©e
 
funùiÚ
 
	$ü—‹FÜmuÏFromTok’s
(
$tok’s
, 
$add™iÚ®D©a
)

5350 ià(
	`em±y
(
$tok’s
)) {

5354 
$fÜmuÏSŒšgs
 = 
	`¬¿y
();

5355 
	`fÜ—ch
 (
$tok’s
 
as
 
$tok’
) {

5357 
$¥aû0
 = 
	`is£t
($space0) ? $space0 : '';

5358 
$¥aû1
 = 
	`is£t
($space1) ? $space1 : '';

5359 
$¥aû2
 = 
	`is£t
($space2) ? $space2 : '';

5360 
$¥aû3
 = 
	`is£t
($space3) ? $space3 : '';

5361 
$¥aû4
 = 
	`is£t
($space4) ? $space4 : '';

5362 
$¥aû5
 = 
	`is£t
($space5) ? $space5 : '';

5364 
$tok’
['name']) {

5380 
$İ2
 = 
	`¬¿y_pİ
(
$fÜmuÏSŒšgs
);

5381 
$İ1
 = 
	`¬¿y_pİ
(
$fÜmuÏSŒšgs
);

5382 
$fÜmuÏSŒšgs
[] = "$op1$space1$space0{$token['data']}$op2";

5383 
	`un£t
(
$¥aû0
, 
$¥aû1
);

5387 
$İ
 = 
	`¬¿y_pİ
(
$fÜmuÏSŒšgs
);

5388 
$fÜmuÏSŒšgs
[] = "$space1$space0{$token['data']}$op";

5389 
	`un£t
(
$¥aû0
, 
$¥aû1
);

5392 
$İ
 = 
	`¬¿y_pİ
(
$fÜmuÏSŒšgs
);

5393 
$fÜmuÏSŒšgs
[] = "$op$space1$space0{$token['data']}";

5394 
	`un£t
(
$¥aû0
, 
$¥aû1
);

5405 
$tok’
['data']['spacetype']) {

5407 
$¥aû0
 = 
	`¡r_»³©
(' ', 
$tok’
['data']['spacecount']);

5410 
$¥aû1
 = 
	`¡r_»³©
("\n", 
$tok’
['data']['spacecount']);

5413 
$¥aû2
 = 
	`¡r_»³©
(' ', 
$tok’
['data']['spacecount']);

5416 
$¥aû3
 = 
	`¡r_»³©
("\n", 
$tok’
['data']['spacecount']);

5419 
$¥aû4
 = 
	`¡r_»³©
(' ', 
$tok’
['data']['spacecount']);

5422 
$¥aû5
 = 
	`¡r_»³©
("\n", 
$tok’
['data']['spacecount']);

5427 
$İ
 = 
	`¬¿y_pİ
(
$fÜmuÏSŒšgs
);

5428 
$fÜmuÏSŒšgs
[] = "{$space1}{$space0}SUM($op)";

5429 
	`un£t
(
$¥aû0
, 
$¥aû1
);

5433 ià(
$tok’
['data']['function'] != '') {

5435 
$İs
 = 
	`¬¿y
();

5436 
$i
 = 0; $˜< 
$tok’
['data']['args']; ++$i) {

5437 
$İs
[] = 
	`¬¿y_pİ
(
$fÜmuÏSŒšgs
);

5439 
$İs
 = 
	`¬¿y_»v”£
($ops);

5440 
$fÜmuÏSŒšgs
[] = "$¥aû1$¥aû0{$tok’['d©a']['funùiÚ']}(" . 
	`im¶ode
(',', 
$İs
) . ")";

5441 
	`un£t
(
$¥aû0
, 
$¥aû1
);

5444 
$İs
 = 
	`¬¿y
();

5445 
$i
 = 0; $˜< 
$tok’
['data']['args'] - 1; ++$i) {

5446 
$İs
[] = 
	`¬¿y_pİ
(
$fÜmuÏSŒšgs
);

5448 
$İs
 = 
	`¬¿y_»v”£
($ops);

5449 
$funùiÚ
 = 
	`¬¿y_pİ
(
$fÜmuÏSŒšgs
);

5450 
$fÜmuÏSŒšgs
[] = "$¥aû1$¥aû0$funùiÚ(" . 
	`im¶ode
(',', 
$İs
) . ")";

5451 
	`un£t
(
$¥aû0
, 
$¥aû1
);

5455 
$ex´essiÚ
 = 
	`¬¿y_pİ
(
$fÜmuÏSŒšgs
);

5456 
$fÜmuÏSŒšgs
[] = "$space3$space2($expression$space5$space4)";

5457 
	`un£t
(
$¥aû2
, 
$¥aû3
, 
$¥aû4
, 
$¥aû5
);

5460 
$cÚ¡ªtA¼ay
 = 
£lf
::
	`_»adBIFF8CÚ¡ªtA¼ay
(
$add™iÚ®D©a
);

5461 
$fÜmuÏSŒšgs
[] = 
$¥aû1
 . 
$¥aû0
 . 
$cÚ¡ªtA¼ay
['value'];

5462 
$add™iÚ®D©a
 = 
	`sub¡r
($add™iÚ®D©a, 
$cÚ¡ªtA¼ay
['size']);

5463 
	`un£t
(
$¥aû0
, 
$¥aû1
);

5467 
$ûÎRªgeAdd»ssLi¡
 = 
$this
->
	`»adBIFF8C–lRªgeAdd»ssLi¡
(
$add™iÚ®D©a
);

5468 
$add™iÚ®D©a
 = 
	`sub¡r
($add™iÚ®D©a, 
$ûÎRªgeAdd»ssLi¡
['size']);

5469 
$fÜmuÏSŒšgs
[] = "$space1$space0{$token['data']}";

5470 
	`un£t
(
$¥aû0
, 
$¥aû1
);

5488 
$fÜmuÏSŒšgs
[] = "$space1$space0{$token['data']}";

5489 
	`un£t
(
$¥aû0
, 
$¥aû1
);

5493 
$fÜmuÏSŒšg
 = 
$fÜmuÏSŒšgs
[0];

5499  
$fÜmuÏSŒšg
;

5500 
	}
}

5511 
´iv©e
 
funùiÚ
 
g‘NextTok’
(
$fÜmuÏD©a
, 
$ba£C–l
 = 'A1')

5514 
$id
 = 
Üd
(
$fÜmuÏD©a
[0]);

5515 
	g$Çme
 = 
çl£
;

5517 
	g$id
) {

5519 
$Çme
 = 'tAdd';

5520 
	g$size
 = 1;

5521 
	g$d©a
 = '+';

5524 
$Çme
 = 'tSub';

5525 
	g$size
 = 1;

5526 
	g$d©a
 = '-';

5529 
$Çme
 = 'tMul';

5530 
	g$size
 = 1;

5531 
	g$d©a
 = '*';

5534 
$Çme
 = 'tDiv';

5535 
	g$size
 = 1;

5536 
	g$d©a
 = '/';

5539 
$Çme
 = 'tPower';

5540 
	g$size
 = 1;

5541 
	g$d©a
 = '^';

5544 
$Çme
 = 'tConcat';

5545 
	g$size
 = 1;

5546 
	g$d©a
 = '&';

5549 
$Çme
 = 'tLT';

5550 
	g$size
 = 1;

5551 
	g$d©a
 = '<';

5554 
$Çme
 = 'tLE';

5555 
	g$size
 = 1;

5556 
	g$d©a
 = '<=';

5559 
$Çme
 = 'tEQ';

5560 
	g$size
 = 1;

5561 
	g$d©a
 = '=';

5564 
$Çme
 = 'tGE';

5565 
	g$size
 = 1;

5566 
	g$d©a
 = '>=';

5569 
$Çme
 = 'tGT';

5570 
	g$size
 = 1;

5571 
	g$d©a
 = '>';

5574 
$Çme
 = 'tNE';

5575 
	g$size
 = 1;

5576 
	g$d©a
 = '<>';

5579 
$Çme
 = 'tIsect';

5580 
	g$size
 = 1;

5581 
	g$d©a
 = ' ';

5584 
$Çme
 = 'tList';

5585 
	g$size
 = 1;

5586 
	g$d©a
 = ',';

5589 
$Çme
 = 'tRange';

5590 
	g$size
 = 1;

5591 
	g$d©a
 = ':';

5594 
$Çme
 = 'tUplus';

5595 
	g$size
 = 1;

5596 
	g$d©a
 = '+';

5599 
$Çme
 = 'tUminus';

5600 
	g$size
 = 1;

5601 
	g$d©a
 = '-';

5604 
$Çme
 = 'tPercent';

5605 
	g$size
 = 1;

5606 
	g$d©a
 = '%';

5609 
$Çme
 = 'tParen';

5610 
	g$size
 = 1;

5611 
	g$d©a
 = 
nuÎ
;

5614 
$Çme
 = 'tMissArg';

5615 
	g$size
 = 1;

5616 
	g$d©a
 = '';

5619 
$Çme
 = 'tStr';

5621 
	g$¡ršg
 = 
£lf
::
»adUnicodeSŒšgShÜt
(
sub¡r
(
$fÜmuÏD©a
, 1));

5622 
	g$size
 = 1 + 
$¡ršg
['size'];

5623 
	g$d©a
 = 
£lf
::
UTF8toExûlDoubËQuÙed
(
$¡ršg
['value']);

5627 
Üd
(
$fÜmuÏD©a
[1])) {

5629 
$Çme
 = 'tAttrVolatile';

5630 
	g$size
 = 4;

5631 
	g$d©a
 = 
nuÎ
;

5634 
$Çme
 = 'tAttrIf';

5635 
	g$size
 = 4;

5636 
	g$d©a
 = 
nuÎ
;

5639 
$Çme
 = 'tAttrChoose';

5641 
	g$nc
 = 
£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 2);

5644 
	g$size
 = 2 * 
$nc
 + 6;

5645 
	g$d©a
 = 
nuÎ
;

5648 
$Çme
 = 'tAttrSkip';

5649 
	g$size
 = 4;

5650 
	g$d©a
 = 
nuÎ
;

5653 
$Çme
 = 'tAttrSum';

5654 
	g$size
 = 4;

5655 
	g$d©a
 = 
nuÎ
;

5659 
$Çme
 = 'tAttrSpace';

5660 
	g$size
 = 4;

5662 
Üd
(
$fÜmuÏD©a
[2])) {

5664 
$¥aûty³
 = 'type0';

5667 
$¥aûty³
 = 'type1';

5670 
$¥aûty³
 = 'type2';

5673 
$¥aûty³
 = 'type3';

5676 
$¥aûty³
 = 'type4';

5679 
$¥aûty³
 = 'type5';

5682 
throw
 
Ãw
 
PHPExûl_R—d”_Exû±iÚ
('Unrecognized spaceype inAttrSpaceoken');

5686 
	g$¥aûcouÁ
 = 
Üd
(
$fÜmuÏD©a
[3]);

5688 
	g$d©a
 = 
¬¿y
('¥aûty³' => 
$¥aûty³
, '¥aûcouÁ' => 
$¥aûcouÁ
);

5691 
throw
 
Ãw
 
PHPExûl_R—d”_Exû±iÚ
('Unrecognized‡ttribute flag inAttroken');

5697 
$Çme
 = 'tErr';

5698 
	g$size
 = 2;

5699 
	g$d©a
 = 
£lf
::
m­E¼ÜCode
(
Üd
(
$fÜmuÏD©a
[1]));

5703 
$Çme
 = 'tBool';

5704 
	g$size
 = 2;

5705 
	g$d©a
 = 
Üd
(
$fÜmuÏD©a
[1]) ? 'TRUE' : 'FALSE';

5709 
$Çme
 = 'tInt';

5710 
	g$size
 = 3;

5711 
	g$d©a
 = 
£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 1);

5715 
$Çme
 = 'tNum';

5716 
	g$size
 = 9;

5717 
	g$d©a
 = 
£lf
::
exŒaùNumb”
(
sub¡r
(
$fÜmuÏD©a
, 1));

5718 
	g$d©a
 = 
¡r_»¶aû
(',', '.', (
¡ršg
)
$d©a
);

5724 
$Çme
 = 'tArray';

5725 
	g$size
 = 8;

5726 
	g$d©a
 = 
nuÎ
;

5731 
$Çme
 = 'tFunc';

5732 
	g$size
 = 3;

5734 
	g£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 1)) {

5736 
$funùiÚ
 = 'ISNA';

5737 
	g$¬gs
 = 1;

5740 
$funùiÚ
 = 'ISERROR';

5741 
	g$¬gs
 = 1;

5744 
$funùiÚ
 = 'NA';

5745 
	g$¬gs
 = 0;

5748 
$funùiÚ
 = 'SIN';

5749 
	g$¬gs
 = 1;

5752 
$funùiÚ
 = 'COS';

5753 
	g$¬gs
 = 1;

5756 
$funùiÚ
 = 'TAN';

5757 
	g$¬gs
 = 1;

5760 
$funùiÚ
 = 'ATAN';

5761 
	g$¬gs
 = 1;

5764 
$funùiÚ
 = 'PI';

5765 
	g$¬gs
 = 0;

5768 
$funùiÚ
 = 'SQRT';

5769 
	g$¬gs
 = 1;

5772 
$funùiÚ
 = 'EXP';

5773 
	g$¬gs
 = 1;

5776 
$funùiÚ
 = 'LN';

5777 
	g$¬gs
 = 1;

5780 
$funùiÚ
 = 'LOG10';

5781 
	g$¬gs
 = 1;

5784 
$funùiÚ
 = 'ABS';

5785 
	g$¬gs
 = 1;

5788 
$funùiÚ
 = 'INT';

5789 
	g$¬gs
 = 1;

5792 
$funùiÚ
 = 'SIGN';

5793 
	g$¬gs
 = 1;

5796 
$funùiÚ
 = 'ROUND';

5797 
	g$¬gs
 = 2;

5800 
$funùiÚ
 = 'REPT';

5801 
	g$¬gs
 = 2;

5804 
$funùiÚ
 = 'MID';

5805 
	g$¬gs
 = 3;

5808 
$funùiÚ
 = 'LEN';

5809 
	g$¬gs
 = 1;

5812 
$funùiÚ
 = 'VALUE';

5813 
	g$¬gs
 = 1;

5816 
$funùiÚ
 = 'TRUE';

5817 
	g$¬gs
 = 0;

5820 
$funùiÚ
 = 'FALSE';

5821 
	g$¬gs
 = 0;

5824 
$funùiÚ
 = 'NOT';

5825 
	g$¬gs
 = 1;

5828 
$funùiÚ
 = 'MOD';

5829 
	g$¬gs
 = 2;

5832 
$funùiÚ
 = 'DCOUNT';

5833 
	g$¬gs
 = 3;

5836 
$funùiÚ
 = 'DSUM';

5837 
	g$¬gs
 = 3;

5840 
$funùiÚ
 = 'DAVERAGE';

5841 
	g$¬gs
 = 3;

5844 
$funùiÚ
 = 'DMIN';

5845 
	g$¬gs
 = 3;

5848 
$funùiÚ
 = 'DMAX';

5849 
	g$¬gs
 = 3;

5852 
$funùiÚ
 = 'DSTDEV';

5853 
	g$¬gs
 = 3;

5856 
$funùiÚ
 = 'TEXT';

5857 
	g$¬gs
 = 2;

5860 
$funùiÚ
 = 'MIRR';

5861 
	g$¬gs
 = 3;

5864 
$funùiÚ
 = 'RAND';

5865 
	g$¬gs
 = 0;

5868 
$funùiÚ
 = 'DATE';

5869 
	g$¬gs
 = 3;

5872 
$funùiÚ
 = 'TIME';

5873 
	g$¬gs
 = 3;

5876 
$funùiÚ
 = 'DAY';

5877 
	g$¬gs
 = 1;

5880 
$funùiÚ
 = 'MONTH';

5881 
	g$¬gs
 = 1;

5884 
$funùiÚ
 = 'YEAR';

5885 
	g$¬gs
 = 1;

5888 
$funùiÚ
 = 'HOUR';

5889 
	g$¬gs
 = 1;

5892 
$funùiÚ
 = 'MINUTE';

5893 
	g$¬gs
 = 1;

5896 
$funùiÚ
 = 'SECOND';

5897 
	g$¬gs
 = 1;

5900 
$funùiÚ
 = 'NOW';

5901 
	g$¬gs
 = 0;

5904 
$funùiÚ
 = 'AREAS';

5905 
	g$¬gs
 = 1;

5908 
$funùiÚ
 = 'ROWS';

5909 
	g$¬gs
 = 1;

5912 
$funùiÚ
 = 'COLUMNS';

5913 
	g$¬gs
 = 1;

5916 
$funùiÚ
 = 'TRANSPOSE';

5917 
	g$¬gs
 = 1;

5920 
$funùiÚ
 = 'TYPE';

5921 
	g$¬gs
 = 1;

5924 
$funùiÚ
 = 'ATAN2';

5925 
	g$¬gs
 = 2;

5928 
$funùiÚ
 = 'ASIN';

5929 
	g$¬gs
 = 1;

5932 
$funùiÚ
 = 'ACOS';

5933 
	g$¬gs
 = 1;

5936 
$funùiÚ
 = 'ISREF';

5937 
	g$¬gs
 = 1;

5940 
$funùiÚ
 = 'CHAR';

5941 
	g$¬gs
 = 1;

5944 
$funùiÚ
 = 'LOWER';

5945 
	g$¬gs
 = 1;

5948 
$funùiÚ
 = 'UPPER';

5949 
	g$¬gs
 = 1;

5952 
$funùiÚ
 = 'PROPER';

5953 
	g$¬gs
 = 1;

5956 
$funùiÚ
 = 'EXACT';

5957 
	g$¬gs
 = 2;

5960 
$funùiÚ
 = 'TRIM';

5961 
	g$¬gs
 = 1;

5964 
$funùiÚ
 = 'REPLACE';

5965 
	g$¬gs
 = 4;

5968 
$funùiÚ
 = 'CODE';

5969 
	g$¬gs
 = 1;

5972 
$funùiÚ
 = 'ISERR';

5973 
	g$¬gs
 = 1;

5976 
$funùiÚ
 = 'ISTEXT';

5977 
	g$¬gs
 = 1;

5980 
$funùiÚ
 = 'ISNUMBER';

5981 
	g$¬gs
 = 1;

5984 
$funùiÚ
 = 'ISBLANK';

5985 
	g$¬gs
 = 1;

5988 
$funùiÚ
 = 'T';

5989 
	g$¬gs
 = 1;

5992 
$funùiÚ
 = 'N';

5993 
	g$¬gs
 = 1;

5996 
$funùiÚ
 = 'DATEVALUE';

5997 
	g$¬gs
 = 1;

6000 
$funùiÚ
 = 'TIMEVALUE';

6001 
	g$¬gs
 = 1;

6004 
$funùiÚ
 = 'SLN';

6005 
	g$¬gs
 = 3;

6008 
$funùiÚ
 = 'SYD';

6009 
	g$¬gs
 = 4;

6012 
$funùiÚ
 = 'CLEAN';

6013 
	g$¬gs
 = 1;

6016 
$funùiÚ
 = 'MDETERM';

6017 
	g$¬gs
 = 1;

6020 
$funùiÚ
 = 'MINVERSE';

6021 
	g$¬gs
 = 1;

6024 
$funùiÚ
 = 'MMULT';

6025 
	g$¬gs
 = 2;

6028 
$funùiÚ
 = 'FACT';

6029 
	g$¬gs
 = 1;

6032 
$funùiÚ
 = 'DPRODUCT';

6033 
	g$¬gs
 = 3;

6036 
$funùiÚ
 = 'ISNONTEXT';

6037 
	g$¬gs
 = 1;

6040 
$funùiÚ
 = 'DSTDEVP';

6041 
	g$¬gs
 = 3;

6044 
$funùiÚ
 = 'DVARP';

6045 
	g$¬gs
 = 3;

6048 
$funùiÚ
 = 'ISLOGICAL';

6049 
	g$¬gs
 = 1;

6052 
$funùiÚ
 = 'DCOUNTA';

6053 
	g$¬gs
 = 3;

6056 
$funùiÚ
 = 'REPLACEB';

6057 
	g$¬gs
 = 4;

6060 
$funùiÚ
 = 'MIDB';

6061 
	g$¬gs
 = 3;

6064 
$funùiÚ
 = 'LENB';

6065 
	g$¬gs
 = 1;

6068 
$funùiÚ
 = 'ROUNDUP';

6069 
	g$¬gs
 = 2;

6072 
$funùiÚ
 = 'ROUNDDOWN';

6073 
	g$¬gs
 = 2;

6076 
$funùiÚ
 = 'ASC';

6077 
	g$¬gs
 = 1;

6080 
$funùiÚ
 = 'DBCS';

6081 
	g$¬gs
 = 1;

6084 
$funùiÚ
 = 'TODAY';

6085 
	g$¬gs
 = 0;

6088 
$funùiÚ
 = 'SINH';

6089 
	g$¬gs
 = 1;

6092 
$funùiÚ
 = 'COSH';

6093 
	g$¬gs
 = 1;

6096 
$funùiÚ
 = 'TANH';

6097 
	g$¬gs
 = 1;

6100 
$funùiÚ
 = 'ASINH';

6101 
	g$¬gs
 = 1;

6104 
$funùiÚ
 = 'ACOSH';

6105 
	g$¬gs
 = 1;

6108 
$funùiÚ
 = 'ATANH';

6109 
	g$¬gs
 = 1;

6112 
$funùiÚ
 = 'DGET';

6113 
	g$¬gs
 = 3;

6116 
$funùiÚ
 = 'INFO';

6117 
	g$¬gs
 = 1;

6120 
$funùiÚ
 = 'FREQUENCY';

6121 
	g$¬gs
 = 2;

6124 
$funùiÚ
 = 'ERROR.TYPE';

6125 
	g$¬gs
 = 1;

6128 
$funùiÚ
 = 'GAMMALN';

6129 
	g$¬gs
 = 1;

6132 
$funùiÚ
 = 'BINOMDIST';

6133 
	g$¬gs
 = 4;

6136 
$funùiÚ
 = 'CHIDIST';

6137 
	g$¬gs
 = 2;

6140 
$funùiÚ
 = 'CHIINV';

6141 
	g$¬gs
 = 2;

6144 
$funùiÚ
 = 'COMBIN';

6145 
	g$¬gs
 = 2;

6148 
$funùiÚ
 = 'CONFIDENCE';

6149 
	g$¬gs
 = 3;

6152 
$funùiÚ
 = 'CRITBINOM';

6153 
	g$¬gs
 = 3;

6156 
$funùiÚ
 = 'EVEN';

6157 
	g$¬gs
 = 1;

6160 
$funùiÚ
 = 'EXPONDIST';

6161 
	g$¬gs
 = 3;

6164 
$funùiÚ
 = 'FDIST';

6165 
	g$¬gs
 = 3;

6168 
$funùiÚ
 = 'FINV';

6169 
	g$¬gs
 = 3;

6172 
$funùiÚ
 = 'FISHER';

6173 
	g$¬gs
 = 1;

6176 
$funùiÚ
 = 'FISHERINV';

6177 
	g$¬gs
 = 1;

6180 
$funùiÚ
 = 'FLOOR';

6181 
	g$¬gs
 = 2;

6184 
$funùiÚ
 = 'GAMMADIST';

6185 
	g$¬gs
 = 4;

6188 
$funùiÚ
 = 'GAMMAINV';

6189 
	g$¬gs
 = 3;

6192 
$funùiÚ
 = 'CEILING';

6193 
	g$¬gs
 = 2;

6196 
$funùiÚ
 = 'HYPGEOMDIST';

6197 
	g$¬gs
 = 4;

6200 
$funùiÚ
 = 'LOGNORMDIST';

6201 
	g$¬gs
 = 3;

6204 
$funùiÚ
 = 'LOGINV';

6205 
	g$¬gs
 = 3;

6208 
$funùiÚ
 = 'NEGBINOMDIST';

6209 
	g$¬gs
 = 3;

6212 
$funùiÚ
 = 'NORMDIST';

6213 
	g$¬gs
 = 4;

6216 
$funùiÚ
 = 'NORMSDIST';

6217 
	g$¬gs
 = 1;

6220 
$funùiÚ
 = 'NORMINV';

6221 
	g$¬gs
 = 3;

6224 
$funùiÚ
 = 'NORMSINV';

6225 
	g$¬gs
 = 1;

6228 
$funùiÚ
 = 'STANDARDIZE';

6229 
	g$¬gs
 = 3;

6232 
$funùiÚ
 = 'ODD';

6233 
	g$¬gs
 = 1;

6236 
$funùiÚ
 = 'PERMUT';

6237 
	g$¬gs
 = 2;

6240 
$funùiÚ
 = 'POISSON';

6241 
	g$¬gs
 = 3;

6244 
$funùiÚ
 = 'TDIST';

6245 
	g$¬gs
 = 3;

6248 
$funùiÚ
 = 'WEIBULL';

6249 
	g$¬gs
 = 4;

6252 
$funùiÚ
 = 'SUMXMY2';

6253 
	g$¬gs
 = 2;

6256 
$funùiÚ
 = 'SUMX2MY2';

6257 
	g$¬gs
 = 2;

6260 
$funùiÚ
 = 'SUMX2PY2';

6261 
	g$¬gs
 = 2;

6264 
$funùiÚ
 = 'CHITEST';

6265 
	g$¬gs
 = 2;

6268 
$funùiÚ
 = 'CORREL';

6269 
	g$¬gs
 = 2;

6272 
$funùiÚ
 = 'COVAR';

6273 
	g$¬gs
 = 2;

6276 
$funùiÚ
 = 'FORECAST';

6277 
	g$¬gs
 = 3;

6280 
$funùiÚ
 = 'FTEST';

6281 
	g$¬gs
 = 2;

6284 
$funùiÚ
 = 'INTERCEPT';

6285 
	g$¬gs
 = 2;

6288 
$funùiÚ
 = 'PEARSON';

6289 
	g$¬gs
 = 2;

6292 
$funùiÚ
 = 'RSQ';

6293 
	g$¬gs
 = 2;

6296 
$funùiÚ
 = 'STEYX';

6297 
	g$¬gs
 = 2;

6300 
$funùiÚ
 = 'SLOPE';

6301 
	g$¬gs
 = 2;

6304 
$funùiÚ
 = 'TTEST';

6305 
	g$¬gs
 = 4;

6308 
$funùiÚ
 = 'LARGE';

6309 
	g$¬gs
 = 2;

6312 
$funùiÚ
 = 'SMALL';

6313 
	g$¬gs
 = 2;

6316 
$funùiÚ
 = 'QUARTILE';

6317 
	g$¬gs
 = 2;

6320 
$funùiÚ
 = 'PERCENTILE';

6321 
	g$¬gs
 = 2;

6324 
$funùiÚ
 = 'TRIMMEAN';

6325 
	g$¬gs
 = 2;

6328 
$funùiÚ
 = 'TINV';

6329 
	g$¬gs
 = 2;

6332 
$funùiÚ
 = 'POWER';

6333 
	g$¬gs
 = 2;

6336 
$funùiÚ
 = 'RADIANS';

6337 
	g$¬gs
 = 1;

6340 
$funùiÚ
 = 'DEGREES';

6341 
	g$¬gs
 = 1;

6344 
$funùiÚ
 = 'COUNTIF';

6345 
	g$¬gs
 = 2;

6348 
$funùiÚ
 = 'COUNTBLANK';

6349 
	g$¬gs
 = 1;

6352 
$funùiÚ
 = 'ISPMT';

6353 
	g$¬gs
 = 4;

6356 
$funùiÚ
 = 'DATEDIF';

6357 
	g$¬gs
 = 3;

6360 
$funùiÚ
 = 'DATESTRING';

6361 
	g$¬gs
 = 1;

6364 
$funùiÚ
 = 'NUMBERSTRING';

6365 
	g$¬gs
 = 2;

6368 
$funùiÚ
 = 'PHONETIC';

6369 
	g$¬gs
 = 1;

6372 
$funùiÚ
 = 'BAHTTEXT';

6373 
	g$¬gs
 = 1;

6376 
throw
 
Ãw
 
PHPExûl_R—d”_Exû±iÚ
('Unrecognized function in formula');

6379 
	g$d©a
 = 
¬¿y
('funùiÚ' => 
$funùiÚ
, '¬gs' => 
$¬gs
);

6384 
$Çme
 = 'tFuncV';

6385 
	g$size
 = 4;

6387 
	g$¬gs
 = 
Üd
(
$fÜmuÏD©a
[1]);

6389 
	g$šdex
 = 
£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 2);

6390 
	g$šdex
) {

6392 
$funùiÚ
 = 'COUNT';

6395 
$funùiÚ
 = 'IF';

6398 
$funùiÚ
 = 'SUM';

6401 
$funùiÚ
 = 'AVERAGE';

6404 
$funùiÚ
 = 'MIN';

6407 
$funùiÚ
 = 'MAX';

6410 
$funùiÚ
 = 'ROW';

6413 
$funùiÚ
 = 'COLUMN';

6416 
$funùiÚ
 = 'NPV';

6419 
$funùiÚ
 = 'STDEV';

6422 
$funùiÚ
 = 'DOLLAR';

6425 
$funùiÚ
 = 'FIXED';

6428 
$funùiÚ
 = 'LOOKUP';

6431 
$funùiÚ
 = 'INDEX';

6434 
$funùiÚ
 = 'AND';

6437 
$funùiÚ
 = 'OR';

6440 
$funùiÚ
 = 'VAR';

6443 
$funùiÚ
 = 'LINEST';

6446 
$funùiÚ
 = 'TREND';

6449 
$funùiÚ
 = 'LOGEST';

6452 
$funùiÚ
 = 'GROWTH';

6455 
$funùiÚ
 = 'PV';

6458 
$funùiÚ
 = 'FV';

6461 
$funùiÚ
 = 'NPER';

6464 
$funùiÚ
 = 'PMT';

6467 
$funùiÚ
 = 'RATE';

6470 
$funùiÚ
 = 'IRR';

6473 
$funùiÚ
 = 'MATCH';

6476 
$funùiÚ
 = 'WEEKDAY';

6479 
$funùiÚ
 = 'OFFSET';

6482 
$funùiÚ
 = 'SEARCH';

6485 
$funùiÚ
 = 'CHOOSE';

6488 
$funùiÚ
 = 'HLOOKUP';

6491 
$funùiÚ
 = 'VLOOKUP';

6494 
$funùiÚ
 = 'LOG';

6497 
$funùiÚ
 = 'LEFT';

6500 
$funùiÚ
 = 'RIGHT';

6503 
$funùiÚ
 = 'SUBSTITUTE';

6506 
$funùiÚ
 = 'FIND';

6509 
$funùiÚ
 = 'CELL';

6512 
$funùiÚ
 = 'DDB';

6515 
$funùiÚ
 = 'INDIRECT';

6518 
$funùiÚ
 = 'IPMT';

6521 
$funùiÚ
 = 'PPMT';

6524 
$funùiÚ
 = 'COUNTA';

6527 
$funùiÚ
 = 'PRODUCT';

6530 
$funùiÚ
 = 'STDEVP';

6533 
$funùiÚ
 = 'VARP';

6536 
$funùiÚ
 = 'TRUNC';

6539 
$funùiÚ
 = 'USDOLLAR';

6542 
$funùiÚ
 = 'FINDB';

6545 
$funùiÚ
 = 'SEARCHB';

6548 
$funùiÚ
 = 'LEFTB';

6551 
$funùiÚ
 = 'RIGHTB';

6554 
$funùiÚ
 = 'RANK';

6557 
$funùiÚ
 = 'ADDRESS';

6560 
$funùiÚ
 = 'DAYS360';

6563 
$funùiÚ
 = 'VDB';

6566 
$funùiÚ
 = 'MEDIAN';

6569 
$funùiÚ
 = 'SUMPRODUCT';

6572 
$funùiÚ
 = 'DB';

6575 
$funùiÚ
 = '';

6578 
$funùiÚ
 = 'AVEDEV';

6581 
$funùiÚ
 = 'BETADIST';

6584 
$funùiÚ
 = 'BETAINV';

6587 
$funùiÚ
 = 'PROB';

6590 
$funùiÚ
 = 'DEVSQ';

6593 
$funùiÚ
 = 'GEOMEAN';

6596 
$funùiÚ
 = 'HARMEAN';

6599 
$funùiÚ
 = 'SUMSQ';

6602 
$funùiÚ
 = 'KURT';

6605 
$funùiÚ
 = 'SKEW';

6608 
$funùiÚ
 = 'ZTEST';

6611 
$funùiÚ
 = 'PERCENTRANK';

6614 
$funùiÚ
 = 'MODE';

6617 
$funùiÚ
 = 'CONCATENATE';

6620 
$funùiÚ
 = 'SUBTOTAL';

6623 
$funùiÚ
 = 'SUMIF';

6626 
$funùiÚ
 = 'ROMAN';

6629 
$funùiÚ
 = 'GETPIVOTDATA';

6632 
$funùiÚ
 = 'HYPERLINK';

6635 
$funùiÚ
 = 'AVERAGEA';

6638 
$funùiÚ
 = 'MAXA';

6641 
$funùiÚ
 = 'MINA';

6644 
$funùiÚ
 = 'STDEVPA';

6647 
$funùiÚ
 = 'VARPA';

6650 
$funùiÚ
 = 'STDEVA';

6653 
$funùiÚ
 = 'VARA';

6656 
throw
 
Ãw
 
PHPExûl_R—d”_Exû±iÚ
('Unrecognized function in formula');

6659 
	g$d©a
 = 
¬¿y
('funùiÚ' => 
$funùiÚ
, '¬gs' => 
$¬gs
);

6664 
$Çme
 = 'tName';

6665 
	g$size
 = 5;

6667 
	g$defšedNameIndex
 = 
£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 1) - 1;

6669 
	g$d©a
 = 
$this
->
defšedÇme
[
$defšedNameIndex
]['name'];

6674 
$Çme
 = 'tRef';

6675 
	g$size
 = 5;

6676 
	g$d©a
 = 
$this
->
»adBIFF8C–lAdd»ss
(
sub¡r
(
$fÜmuÏD©a
, 1, 4));

6681 
$Çme
 = 'tArea';

6682 
	g$size
 = 9;

6683 
	g$d©a
 = 
$this
->
»adBIFF8C–lRªgeAdd»ss
(
sub¡r
(
$fÜmuÏD©a
, 1, 8));

6688 
$Çme
 = 'tMemArea';

6691 
	g$subSize
 = 
£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 5);

6692 
	g$size
 = 7 + 
$subSize
;

6693 
	g$d©a
 = 
$this
->
g‘FÜmuÏFromD©a
(
sub¡r
(
$fÜmuÏD©a
, 7, 
$subSize
));

6698 
$Çme
 = 'tMemErr';

6701 
	g$subSize
 = 
£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 5);

6702 
	g$size
 = 7 + 
$subSize
;

6703 
	g$d©a
 = 
$this
->
g‘FÜmuÏFromD©a
(
sub¡r
(
$fÜmuÏD©a
, 7, 
$subSize
));

6708 
$Çme
 = 'tMemFunc';

6710 
	g$subSize
 = 
£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 1);

6711 
	g$size
 = 3 + 
$subSize
;

6712 
	g$d©a
 = 
$this
->
g‘FÜmuÏFromD©a
(
sub¡r
(
$fÜmuÏD©a
, 3, 
$subSize
));

6717 
$Çme
 = 'tRefN';

6718 
	g$size
 = 5;

6719 
	g$d©a
 = 
$this
->
»adBIFF8C–lAdd»ssB
(
sub¡r
(
$fÜmuÏD©a
, 1, 4), 
$ba£C–l
);

6724 
$Çme
 = 'tAreaN';

6725 
	g$size
 = 9;

6726 
	g$d©a
 = 
$this
->
»adBIFF8C–lRªgeAdd»ssB
(
sub¡r
(
$fÜmuÏD©a
, 1, 8), 
$ba£C–l
);

6731 
$Çme
 = 'tNameX';

6732 
	g$size
 = 7;

6735 
	g$šdex
 = 
£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 3);

6737 
	g$d©a
 = 
$this
->
ex‹º®Names
[
$šdex
 - 1]['name'];

6743 
$Çme
 = 'tRef3d';

6744 
	g$size
 = 7;

6746 
	gŒy
 {

6748 
	g$sh“tRªge
 = 
$this
->
»adSh“tRªgeByRefIndex
(
£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 1));

6750 
	g$ûÎAdd»ss
 = 
$this
->
»adBIFF8C–lAdd»ss
(
sub¡r
(
$fÜmuÏD©a
, 3, 4));

6752 
	g$d©a
 = "$sheetRange!$cellAddress";

6753 } 
ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

6755 
	g$d©a
 = '#REF!';

6761 
$Çme
 = 'tArea3d';

6762 
	g$size
 = 11;

6764 
	gŒy
 {

6766 
	g$sh“tRªge
 = 
$this
->
»adSh“tRªgeByRefIndex
(
£lf
::
g‘IÁ2d
(
$fÜmuÏD©a
, 1));

6768 
	g$ûÎRªgeAdd»ss
 = 
$this
->
»adBIFF8C–lRªgeAdd»ss
(
sub¡r
(
$fÜmuÏD©a
, 3, 8));

6770 
	g$d©a
 = "$sheetRange!$cellRangeAddress";

6771 } 
ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

6773 
	g$d©a
 = '#REF!';

6778 
throw
 
Ãw
 
PHPExûl_R—d”_Exû±iÚ
('UÄecognizedok’ ' . 
¥rštf
('%02X', 
$id
) . ' in formula');

6782  
¬¿y
(

6783 'id' => 
$id
,

6784 'Çme' => 
$Çme
,

6785 'size' => 
$size
,

6786 'd©a' => 
$d©a
,

6798 
´iv©e
 
funùiÚ
 
	$»adBIFF8C–lAdd»ss
(
$ûÎAdd»ssSŒuùu»
)

6801 
$row
 = 
£lf
::
	`g‘IÁ2d
(
$ûÎAdd»ssSŒuùu»
, 0) + 1;

6805 
$cŞumn
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(0x00FF & 
£lf
::
	`g‘IÁ2d
(
$ûÎAdd»ssSŒuùu»
, 2));

6808 ià(!(0x4000 & 
£lf
::
	`g‘IÁ2d
(
$ûÎAdd»ssSŒuùu»
, 2))) {

6809 
$cŞumn
 = '$' . $column;

6812 ià(!(0x8000 & 
£lf
::
	`g‘IÁ2d
(
$ûÎAdd»ssSŒuùu»
, 2))) {

6813 
$row
 = '$' . $row;

6816  
$cŞumn
 . 
$row
;

6817 
	}
}

6829 
´iv©e
 
funùiÚ
 
»adBIFF8C–lAdd»ssB
(
$ûÎAdd»ssSŒuùu»
, 
$ba£C–l
 = 'A1')

6831 
li¡
(
$ba£CŞ
, 
$ba£Row
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$ba£C–l
);

6832 
	g$ba£CŞ
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$ba£CŞ
) - 1;

6835 
	g$rowIndex
 = 
£lf
::
g‘IÁ2d
(
$ûÎAdd»ssSŒuùu»
, 0);

6836 
	g$row
 = 
£lf
::
g‘IÁ2d
(
$ûÎAdd»ssSŒuùu»
, 0) + 1;

6840 
	g$cŞIndex
 = 0x00FF & 
£lf
::
g‘IÁ2d
(
$ûÎAdd»ssSŒuùu»
, 2);

6843 ià(!(0x4000 & 
	g£lf
::
g‘IÁ2d
(
$ûÎAdd»ssSŒuùu»
, 2))) {

6844 
	g$cŞumn
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$cŞIndex
);

6845 
	g$cŞumn
 = '$' . 
$cŞumn
;

6847 
	g$cŞIndex
 = (
$cŞIndex
 <= 127) ? $colIndex : $colIndex - 256;

6848 
	g$cŞumn
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$ba£CŞ
 + 
$cŞIndex
);

6852 ià(!(0x8000 & 
	g£lf
::
g‘IÁ2d
(
$ûÎAdd»ssSŒuùu»
, 2))) {

6853 
	g$row
 = '$' . 
$row
;

6855 
	g$rowIndex
 = (
$rowIndex
 <= 32767) ? $rowIndex : $rowIndex - 65536;

6856 
	g$row
 = 
$ba£Row
 + 
$rowIndex
;

6859  
	g$cŞumn
 . 
	g$row
;

6872 
´iv©e
 
funùiÚ
 
	$»adBIFF5C–lRªgeAdd»ssFixed
(
$subD©a
)

6875 
$ä
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 0) + 1;

6878 
$Ì
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 2) + 1;

6881 
$fc
 = 
	`Üd
(
$subD©a
{4});

6884 
$lc
 = 
	`Üd
(
$subD©a
{5});

6887 ià(
$ä
 > 
$Ì
 || 
$fc
 > 
$lc
) {

6888 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Not‡ cell„ange‡ddress');

6892 
$fc
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($fc);

6893 
$lc
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($lc);

6895 ià(
$ä
 =ğ
$Ì
 
ªd
 
$fc
 =ğ
$lc
) {

6899 
	}
}

6911 
´iv©e
 
funùiÚ
 
	$»adBIFF8C–lRªgeAdd»ssFixed
(
$subD©a
)

6914 
$ä
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 0) + 1;

6917 
$Ì
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 2) + 1;

6920 
$fc
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 4);

6923 
$lc
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 6);

6926 ià(
$ä
 > 
$Ì
 || 
$fc
 > 
$lc
) {

6927 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Not‡ cell„ange‡ddress');

6931 
$fc
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($fc);

6932 
$lc
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($lc);

6934 ià(
$ä
 =ğ
$Ì
 
ªd
 
$fc
 =ğ
$lc
) {

6938 
	}
}

6949 
´iv©e
 
funùiÚ
 
	$»adBIFF8C–lRªgeAdd»ss
(
$subD©a
)

6955 
$ä
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 0) + 1;

6958 
$Ì
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 2) + 1;

6963 
$fc
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(0x00FF & 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 4));

6966 ià(!(0x4000 & 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 4))) {

6967 
$fc
 = '$' . $fc;

6971 ià(!(0x8000 & 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 4))) {

6972 
$ä
 = '$' . $fr;

6978 
$lc
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(0x00FF & 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 6));

6981 ià(!(0x4000 & 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 6))) {

6982 
$lc
 = '$' . $lc;

6986 ià(!(0x8000 & 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 6))) {

6987 
$Ì
 = '$' . $lr;

6991 
	}
}

7003 
´iv©e
 
funùiÚ
 
»adBIFF8C–lRªgeAdd»ssB
(
$subD©a
, 
$ba£C–l
 = 'A1')

7005 
li¡
(
$ba£CŞ
, 
$ba£Row
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$ba£C–l
);

7006 
	g$ba£CŞ
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$ba£CŞ
) - 1;

7012 
	g$äIndex
 = 
£lf
::
g‘IÁ2d
(
$subD©a
, 0);

7015 
	g$ÌIndex
 = 
£lf
::
g‘IÁ2d
(
$subD©a
, 2);

7020 
	g$fcIndex
 = 0x00FF & 
£lf
::
g‘IÁ2d
(
$subD©a
, 4);

7023 ià(!(0x4000 & 
	g£lf
::
g‘IÁ2d
(
$subD©a
, 4))) {

7025 
	g$fc
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$fcIndex
);

7026 
	g$fc
 = '$' . 
$fc
;

7029 
	g$fcIndex
 = (
$fcIndex
 <= 127) ? $fcIndex : $fcIndex - 256;

7030 
	g$fc
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$ba£CŞ
 + 
$fcIndex
);

7034 ià(!(0x8000 & 
	g£lf
::
g‘IÁ2d
(
$subD©a
, 4))) {

7036 
	g$ä
 = 
$äIndex
 + 1;

7037 
	g$ä
 = '$' . 
$ä
;

7040 
	g$äIndex
 = (
$äIndex
 <= 32767) ? $frIndex : $frIndex - 65536;

7041 
	g$ä
 = 
$ba£Row
 + 
$äIndex
;

7047 
	g$lcIndex
 = 0x00FF & 
£lf
::
g‘IÁ2d
(
$subD©a
, 6);

7048 
	g$lcIndex
 = (
$lcIndex
 <= 127) ? $lcIndex : $lcIndex - 256;

7049 
	g$lc
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$ba£CŞ
 + 
$lcIndex
);

7052 ià(!(0x4000 & 
	g£lf
::
g‘IÁ2d
(
$subD©a
, 6))) {

7054 
	g$lc
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$lcIndex
);

7055 
	g$lc
 = '$' . 
$lc
;

7058 
	g$lcIndex
 = (
$lcIndex
 <= 127) ? $lcIndex : $lcIndex - 256;

7059 
	g$lc
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$ba£CŞ
 + 
$lcIndex
);

7063 ià(!(0x8000 & 
	g£lf
::
g‘IÁ2d
(
$subD©a
, 6))) {

7065 
	g$Ì
 = 
$ÌIndex
 + 1;

7066 
	g$Ì
 = '$' . 
$Ì
;

7069 
	g$ÌIndex
 = (
$ÌIndex
 <= 32767) ? $lrIndex : $lrIndex - 65536;

7070 
	g$Ì
 = 
$ba£Row
 + 
$ÌIndex
;

7084 
´iv©e
 
funùiÚ
 
	$»adBIFF8C–lRªgeAdd»ssLi¡
(
$subD©a
)

7086 
$ûÎRªgeAdd»s£s
 = 
	`¬¿y
();

7089 
$nm
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 0);

7091 
$off£t
 = 2;

7093 
$i
 = 0; $˜< 
$nm
; ++$i) {

7094 
$ûÎRªgeAdd»s£s
[] = 
$this
->
	`»adBIFF8C–lRªgeAdd»ssFixed
(
	`sub¡r
(
$subD©a
, 
$off£t
, 8));

7095 
$off£t
 += 8;

7098  
	`¬¿y
(

7099 'size' => 2 + 8 * 
$nm
,

7100 'ûÎRªgeAdd»s£s' => 
$ûÎRªgeAdd»s£s
,

7102 
	}
}

7112 
´iv©e
 
funùiÚ
 
	$»adBIFF5C–lRªgeAdd»ssLi¡
(
$subD©a
)

7114 
$ûÎRªgeAdd»s£s
 = 
	`¬¿y
();

7117 
$nm
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 0);

7119 
$off£t
 = 2;

7121 
$i
 = 0; $˜< 
$nm
; ++$i) {

7122 
$ûÎRªgeAdd»s£s
[] = 
$this
->
	`»adBIFF5C–lRªgeAdd»ssFixed
(
	`sub¡r
(
$subD©a
, 
$off£t
, 6));

7123 
$off£t
 += 6;

7126  
	`¬¿y
(

7127 'size' => 2 + 6 * 
$nm
,

7128 'ûÎRªgeAdd»s£s' => 
$ûÎRªgeAdd»s£s
,

7130 
	}
}

7143 
´iv©e
 
funùiÚ
 
	$»adSh“tRªgeByRefIndex
(
$šdex
)

7145 ià(
	`is£t
(
$this
->
»f
[
$šdex
])) {

7146 
$ty³
 = 
$this
->
ex‹º®Books
[$this->
»f
[
$šdex
]['externalBookIndex']]['type'];

7148 
$ty³
) {

7151 ià(
$this
->
»f
[
$šdex
]['fœ¡Sh“tIndex'] =ğ0xFFFF 
Ü
 $this->ref[$index]['lastSheetIndex'] == 0xFFFF) {

7152 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Deleted sheet„eference');

7156 
$fœ¡Sh“tName
 = 
$this
->
sh“ts
[$this->
»f
[
$šdex
]['firstSheetIndex']]['name'];

7157 
$Ï¡Sh“tName
 = 
$this
->
sh“ts
[$this->
»f
[
$šdex
]['lastSheetIndex']]['name'];

7159 ià(
$fœ¡Sh“tName
 =ğ
$Ï¡Sh“tName
) {

7161 
$sh“tRªge
 = 
$fœ¡Sh“tName
;

7163 
$sh“tRªge
 = "$firstSheetName:$lastSheetName";

7167 
$sh“tRªge
 = 
	`¡r_»¶aû
("'", "''", $sheetRange);

7173 ià(
	`´eg_m©ch
("/[ !\"@#Â£$%&{()}<>=+'|^,;-]/", 
$sh“tRªge
)) {

7174 
$sh“tRªge
 = "'$sheetRange'";

7177  
$sh“tRªge
;

7181 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Excel5„eader only supports internal sheets in fomulas');

7185  
çl£
;

7186 
	}
}

7197 
´iv©e
 
funùiÚ
 
	$»adBIFF8CÚ¡ªtA¼ay
(
$¬¿yD©a
)

7200 
$nc
 = 
	`Üd
(
$¬¿yD©a
[0]);

7203 
$Ä
 = 
£lf
::
	`g‘IÁ2d
(
$¬¿yD©a
, 1);

7204 
$size
 = 3;

7205 
$¬¿yD©a
 = 
	`sub¡r
($arrayData, 3);

7208 
$m©rixChunks
 = 
	`¬¿y
();

7209 
$r
 = 1; $¸<ğ
$Ä
 + 1; ++$r) {

7210 
$™ems
 = 
	`¬¿y
();

7211 
$c
 = 1; $ø<ğ
$nc
 + 1; ++$c) {

7212 
$cÚ¡ªt
 = 
£lf
::
	`_»adBIFF8CÚ¡ªt
(
$¬¿yD©a
);

7213 
$™ems
[] = 
$cÚ¡ªt
['value'];

7214 
$¬¿yD©a
 = 
	`sub¡r
($¬¿yD©a, 
$cÚ¡ªt
['size']);

7215 
$size
 +ğ
$cÚ¡ªt
['size'];

7217 
$m©rixChunks
[] = 
	`im¶ode
(',', 
$™ems
);

7219 
$m©rix
 = '{' . 
	`im¶ode
(';', 
$m©rixChunks
) . '}';

7221  
	`¬¿y
(

7222 'v®ue' => 
$m©rix
,

7223 'size' => 
$size
,

7225 
	}
}

7236 
´iv©e
 
funùiÚ
 
	$»adBIFF8CÚ¡ªt
(
$v®ueD©a
)

7239 
$id’tif›r
 = 
	`Üd
(
$v®ueD©a
[0]);

7241 
$id’tif›r
) {

7243 
$v®ue
 = '';

7244 
$size
 = 9;

7248 
$v®ue
 = 
£lf
::
	`exŒaùNumb”
(
	`sub¡r
(
$v®ueD©a
, 1, 8));

7249 
$size
 = 9;

7253 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšgLÚg
(
	`sub¡r
(
$v®ueD©a
, 1));

7254 
$v®ue
 = '"' . 
$¡ršg
['value'] . '"';

7255 
$size
 = 1 + 
$¡ršg
['size'];

7259 ià(
	`Üd
(
$v®ueD©a
[1])) {

7260 
$v®ue
 = 'TRUE';

7262 
$v®ue
 = 'FALSE';

7264 
$size
 = 9;

7268 
$v®ue
 = 
£lf
::
	`m­E¼ÜCode
(
	`Üd
(
$v®ueD©a
[1]));

7269 
$size
 = 9;

7272  
	`¬¿y
(

7273 'v®ue' => 
$v®ue
,

7274 'size' => 
$size
,

7276 
	}
}

7286 
´iv©e
 
funùiÚ
 
	$»adRGB
(
$rgb
)

7289 
$r
 = 
	`Üd
(
$rgb
{0});

7292 
$g
 = 
	`Üd
(
$rgb
{1});

7295 
$b
 = 
	`Üd
(
$rgb
{2});

7298 
$rgb
 = 
	`¥rštf
('%02X%02X%02X', 
$r
, 
$g
, 
$b
);

7300  
	`¬¿y
('rgb' => 
$rgb
);

7301 
	}
}

7311 
´iv©e
 
funùiÚ
 
	$»adBy‹SŒšgShÜt
(
$subD©a
)

7314 
$Ê
 = 
	`Üd
(
$subD©a
[0]);

7317 
$v®ue
 = 
$this
->
	`decodeCod•age
(
	`sub¡r
(
$subD©a
, 1, 
$Ê
));

7319  
	`¬¿y
(

7320 'v®ue' => 
$v®ue
,

7321 'size' => 1 + 
$Ê
,

7323 
	}
}

7333 
´iv©e
 
funùiÚ
 
	$»adBy‹SŒšgLÚg
(
$subD©a
)

7336 
$Ê
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 0);

7339 
$v®ue
 = 
$this
->
	`decodeCod•age
(
	`sub¡r
(
$subD©a
, 2));

7342  
	`¬¿y
(

7343 'v®ue' => 
$v®ue
,

7344 'size' => 2 + 
$Ê
,

7346 
	}
}

7357 
´iv©e
 
funùiÚ
 
	$»adUnicodeSŒšgShÜt
(
$subD©a
)

7359 
$v®ue
 = '';

7362 
$ch¬aù”CouÁ
 = 
	`Üd
(
$subD©a
[0]);

7364 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšg
(
	`sub¡r
(
$subD©a
, 1), 
$ch¬aù”CouÁ
);

7367 
$¡ršg
['size'] += 1;

7369  
$¡ršg
;

7370 
	}
}

7381 
´iv©e
 
funùiÚ
 
	$»adUnicodeSŒšgLÚg
(
$subD©a
)

7383 
$v®ue
 = '';

7386 
$ch¬aù”CouÁ
 = 
£lf
::
	`g‘IÁ2d
(
$subD©a
, 0);

7388 
$¡ršg
 = 
£lf
::
	`»adUnicodeSŒšg
(
	`sub¡r
(
$subD©a
, 2), 
$ch¬aù”CouÁ
);

7391 
$¡ršg
['size'] += 2;

7393  
$¡ršg
;

7394 
	}
}

7406 
´iv©e
 
funùiÚ
 
	$»adUnicodeSŒšg
(
$subD©a
, 
$ch¬aù”CouÁ
)

7408 
$v®ue
 = '';

7412 
$isCom´es£d
 = !((0x01 & 
	`Üd
(
$subD©a
[0])) >> 0);

7415 
$hasAsŸn
 = (0x04è& 
	`Üd
(
$subD©a
[0]) >> 2;

7418 
$hasRichText
 = (0x08è& 
	`Üd
(
$subD©a
[0]) >> 3;

7423 
$v®ue
 = 
£lf
::
	`’codeUTF16
(
	`sub¡r
(
$subD©a
, 1, 
$isCom´es£d
 ? 
$ch¬aù”CouÁ
 : 2 * $characterCount), $isCompressed);

7425  
	`¬¿y
(

7426 'v®ue' => 
$v®ue
,

7427 'size' => 
$isCom´es£d
 ? 1 + 
$ch¬aù”CouÁ
 : 1 + 2 * $characterCount,

7429 
	}
}

7439 
´iv©e
 
funùiÚ
 
	$UTF8toExûlDoubËQuÙed
(
$v®ue
)

7441  '"' . 
	`¡r_»¶aû
('"', '""', 
$v®ue
) . '"';

7442 
	}
}

7451 
´iv©e
 
funùiÚ
 
	$exŒaùNumb”
(
$d©a
)

7453 
$rknumhigh
 = 
£lf
::
	`g‘IÁ4d
(
$d©a
, 4);

7454 
$rknumlow
 = 
£lf
::
	`g‘IÁ4d
(
$d©a
, 0);

7455 
$sign
 = (
$rknumhigh
 & 0x80000000) >> 31;

7456 
$exp
 = ((
$rknumhigh
 & 0x7ff00000) >> 20) - 1023;

7457 
$mªtis§
 = (0x100000 | (
$rknumhigh
 & 0x000fffff));

7458 
$mªtis§low1
 = (
$rknumlow
 & 0x80000000) >> 31;

7459 
$mªtis§low2
 = (
$rknumlow
 & 0x7fffffff);

7460 
$v®ue
 = 
$mªtis§
 / 
	`pow
(2, (20 - 
$exp
));

7462 ià(
$mªtis§low1
 != 0) {

7463 
$v®ue
 +ğ1 / 
	`pow
(2, (21 - 
$exp
));

7466 
$v®ue
 +ğ
$mªtis§low2
 / 
	`pow
(2, (52 - 
$exp
));

7467 ià(
$sign
) {

7468 
$v®ue
 *= -1;

7471  
$v®ue
;

7472 
	}
}

7475 
´iv©e
 
funùiÚ
 
	$g‘IEEE754
(
$rknum
)

7477 ià((
$rknum
 & 0x02) != 0) {

7478 
$v®ue
 = 
$rknum
 >> 2;

7485 
$sign
 = (
$rknum
 & 0x80000000) >> 31;

7486 
$exp
 = (
$rknum
 & 0x7ff00000) >> 20;

7487 
$mªtis§
 = (0x100000 | (
$rknum
 & 0x000ffffc));

7488 
$v®ue
 = 
$mªtis§
 / 
	`pow
(2, (20- (
$exp
 - 1023)));

7489 ià(
$sign
) {

7490 
$v®ue
 = -1 * $value;

7494 ià((
$rknum
 & 0x01) != 0) {

7495 
$v®ue
 /= 100;

7497  
$v®ue
;

7498 
	}
}

7508 
´iv©e
 
funùiÚ
 
’codeUTF16
(
$¡ršg
, 
$com´es£d
 = '')

7510 ià(
$com´es£d
) {

7511 
$¡ršg
 = 
£lf
::
uncom´essBy‹SŒšg
($string);

7514  
	gPHPExûl_Sh¬ed_SŒšg
::
CÚv”tEncodšg
(
$¡ršg
, 'UTF-8', 'UTF-16LE');

7524 
´iv©e
 
funùiÚ
 
	$uncom´essBy‹SŒšg
(
$¡ršg
)

7526 
$uncom´es£dSŒšg
 = '';

7527 
$¡rL’
 = 
	`¡¾’
(
$¡ršg
);

7528 
$i
 = 0; $˜< 
$¡rL’
; ++$i) {

7529 
$uncom´es£dSŒšg
 .ğ
$¡ršg
[
$i
] . "\0";

7532  
$uncom´es£dSŒšg
;

7533 
	}
}

7542 
´iv©e
 
funùiÚ
 
	$decodeCod•age
(
$¡ršg
)

7544  
PHPExûl_Sh¬ed_SŒšg
::
	`CÚv”tEncodšg
(
$¡ršg
, 'UTF-8', 
$this
->
cod•age
);

7545 
	}
}

7555 
public
 
funùiÚ
 
	$g‘IÁ2d
(
$d©a
, 
$pos
)

7557  
	`Üd
(
$d©a
[
$pos
]) | (ord($data[$pos+1]) << 8);

7558 
	}
}

7568 
public
 
funùiÚ
 
	$g‘IÁ4d
(
$d©a
, 
$pos
)

7573 
$_Ü_24
 = 
	`Üd
(
$d©a
[
$pos
 + 3]);

7574 ià(
$_Ü_24
 >= 128) {

7576 
$_Üd_24
 = -
	`abs
((256 - 
$_Ü_24
) << 24);

7578 
$_Üd_24
 = (
$_Ü_24
 & 127) << 24;

7580  
	`Üd
(
$d©a
[
$pos
]è| (Üd($d©a[$pos+1]è<< 8è| (Üd($d©a[$pos+2]è<< 16è| 
$_Üd_24
;

7581 
	}
}

7591 
´iv©e
 
funùiÚ
 
	$»adCŞÜ
(
$cŞÜ
, 
$·Ë‰e
, 
$v”siÚ
)

7593 ià(
$cŞÜ
 <= 0x07 || $color >= 0x40) {

7595  
£lf
::
	`m­ButInCŞÜ
(
$cŞÜ
);

7596 } 
	`–£if
 (
	`is£t
(
$·Ë‰e
è&& is£t($·Ë‰e[
$cŞÜ
 - 8])) {

7598  
$·Ë‰e
[
$cŞÜ
 - 8];

7601 ià(
$v”siÚ
 =ğ
£lf
::
XLS_BIFF8
) {

7602  
£lf
::
	`m­CŞÜ
(
$cŞÜ
);

7605  
£lf
::
	`m­CŞÜBIFF5
(
$cŞÜ
);

7609  
$cŞÜ
;

7610 
	}
}

7620 
´iv©e
 
funùiÚ
 
	$m­BÜd”StyË
(
$šdex
)

7622 
$šdex
) {

7624  
PHPExûl_StyË_BÜd”
::
BORDER_NONE
;

7626  
PHPExûl_StyË_BÜd”
::
BORDER_THIN
;

7628  
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
;

7630  
PHPExûl_StyË_BÜd”
::
BORDER_DASHED
;

7632  
PHPExûl_StyË_BÜd”
::
BORDER_DOTTED
;

7634  
PHPExûl_StyË_BÜd”
::
BORDER_THICK
;

7636  
PHPExûl_StyË_BÜd”
::
BORDER_DOUBLE
;

7638  
PHPExûl_StyË_BÜd”
::
BORDER_HAIR
;

7640  
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHED
;

7642  
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOT
;

7644  
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOT
;

7646  
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOTDOT
;

7648  
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOTDOT
;

7650  
PHPExûl_StyË_BÜd”
::
BORDER_SLANTDASHDOT
;

7652  
PHPExûl_StyË_BÜd”
::
BORDER_NONE
;

7654 
	}
}

7664 
´iv©e
 
funùiÚ
 
	$m­FlP©‹º
(
$šdex
)

7666 
$šdex
) {

7668  
PHPExûl_StyË_Fl
::
FILL_NONE
;

7670  
PHPExûl_StyË_Fl
::
FILL_SOLID
;

7672  
PHPExûl_StyË_Fl
::
FILL_PATTERN_MEDIUMGRAY
;

7674  
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKGRAY
;

7676  
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTGRAY
;

7678  
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKHORIZONTAL
;

7680  
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKVERTICAL
;

7682  
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKDOWN
;

7684  
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKUP
;

7686  
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKGRID
;

7688  
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKTRELLIS
;

7690  
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTHORIZONTAL
;

7692  
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTVERTICAL
;

7694  
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTDOWN
;

7696  
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTUP
;

7698  
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTGRID
;

7700  
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTTRELLIS
;

7702  
PHPExûl_StyË_Fl
::
FILL_PATTERN_GRAY125
;

7704  
PHPExûl_StyË_Fl
::
FILL_PATTERN_GRAY0625
;

7706  
PHPExûl_StyË_Fl
::
FILL_NONE
;

7708 
	}
}

7717 
´iv©e
 
funùiÚ
 
	$m­E¼ÜCode
(
$subD©a
)

7719 
$subD©a
) {

7742  
çl£
;

7744 
	}
}

7753 
´iv©e
 
funùiÚ
 
	$m­ButInCŞÜ
(
$cŞÜ
)

7755 
$cŞÜ
) {

7757  
	`¬¿y
('rgb' => '000000');

7759  
	`¬¿y
('rgb' => 'FFFFFF');

7761  
	`¬¿y
('rgb' => 'FF0000');

7763  
	`¬¿y
('rgb' => '00FF00');

7765  
	`¬¿y
('rgb' => '0000FF');

7767  
	`¬¿y
('rgb' => 'FFFF00');

7769  
	`¬¿y
('rgb' => 'FF00FF');

7771  
	`¬¿y
('rgb' => '00FFFF');

7773  
	`¬¿y
('rgb' => '000000');

7775  
	`¬¿y
('rgb' => 'FFFFFF');

7777  
	`¬¿y
('rgb' => '000000');

7779 
	}
}

7788 
´iv©e
 
funùiÚ
 
	$m­CŞÜBIFF5
(
$subD©a
)

7790 
$subD©a
) {

7792  
	`¬¿y
('rgb' => '000000');

7794  
	`¬¿y
('rgb' => 'FFFFFF');

7796  
	`¬¿y
('rgb' => 'FF0000');

7798  
	`¬¿y
('rgb' => '00FF00');

7800  
	`¬¿y
('rgb' => '0000FF');

7802  
	`¬¿y
('rgb' => 'FFFF00');

7804  
	`¬¿y
('rgb' => 'FF00FF');

7806  
	`¬¿y
('rgb' => '00FFFF');

7808  
	`¬¿y
('rgb' => '800000');

7810  
	`¬¿y
('rgb' => '008000');

7812  
	`¬¿y
('rgb' => '000080');

7814  
	`¬¿y
('rgb' => '808000');

7816  
	`¬¿y
('rgb' => '800080');

7818  
	`¬¿y
('rgb' => '008080');

7820  
	`¬¿y
('rgb' => 'C0C0C0');

7822  
	`¬¿y
('rgb' => '808080');

7824  
	`¬¿y
('rgb' => '8080FF');

7826  
	`¬¿y
('rgb' => '802060');

7828  
	`¬¿y
('rgb' => 'FFFFC0');

7830  
	`¬¿y
('rgb' => 'A0E0F0');

7832  
	`¬¿y
('rgb' => '600080');

7834  
	`¬¿y
('rgb' => 'FF8080');

7836  
	`¬¿y
('rgb' => '0080C0');

7838  
	`¬¿y
('rgb' => 'C0C0FF');

7840  
	`¬¿y
('rgb' => '000080');

7842  
	`¬¿y
('rgb' => 'FF00FF');

7844  
	`¬¿y
('rgb' => 'FFFF00');

7846  
	`¬¿y
('rgb' => '00FFFF');

7848  
	`¬¿y
('rgb' => '800080');

7850  
	`¬¿y
('rgb' => '800000');

7852  
	`¬¿y
('rgb' => '008080');

7854  
	`¬¿y
('rgb' => '0000FF');

7856  
	`¬¿y
('rgb' => '00CFFF');

7858  
	`¬¿y
('rgb' => '69FFFF');

7860  
	`¬¿y
('rgb' => 'E0FFE0');

7862  
	`¬¿y
('rgb' => 'FFFF80');

7864  
	`¬¿y
('rgb' => 'A6CAF0');

7866  
	`¬¿y
('rgb' => 'DD9CB3');

7868  
	`¬¿y
('rgb' => 'B38FEE');

7870  
	`¬¿y
('rgb' => 'E3E3E3');

7872  
	`¬¿y
('rgb' => '2A6FF9');

7874  
	`¬¿y
('rgb' => '3FB8CD');

7876  
	`¬¿y
('rgb' => '488436');

7878  
	`¬¿y
('rgb' => '958C41');

7880  
	`¬¿y
('rgb' => '8E5E42');

7882  
	`¬¿y
('rgb' => 'A0627A');

7884  
	`¬¿y
('rgb' => '624FAC');

7886  
	`¬¿y
('rgb' => '969696');

7888  
	`¬¿y
('rgb' => '1D2FBE');

7890  
	`¬¿y
('rgb' => '286676');

7892  
	`¬¿y
('rgb' => '004500');

7894  
	`¬¿y
('rgb' => '453E01');

7896  
	`¬¿y
('rgb' => '6A2813');

7898  
	`¬¿y
('rgb' => '85396A');

7900  
	`¬¿y
('rgb' => '4A3285');

7902  
	`¬¿y
('rgb' => '424242');

7904  
	`¬¿y
('rgb' => '000000');

7906 
	}
}

7915 
´iv©e
 
funùiÚ
 
	$m­CŞÜ
(
$subD©a
)

7917 
$subD©a
) {

7919  
	`¬¿y
('rgb' => '000000');

7921  
	`¬¿y
('rgb' => 'FFFFFF');

7923  
	`¬¿y
('rgb' => 'FF0000');

7925  
	`¬¿y
('rgb' => '00FF00');

7927  
	`¬¿y
('rgb' => '0000FF');

7929  
	`¬¿y
('rgb' => 'FFFF00');

7931  
	`¬¿y
('rgb' => 'FF00FF');

7933  
	`¬¿y
('rgb' => '00FFFF');

7935  
	`¬¿y
('rgb' => '800000');

7937  
	`¬¿y
('rgb' => '008000');

7939  
	`¬¿y
('rgb' => '000080');

7941  
	`¬¿y
('rgb' => '808000');

7943  
	`¬¿y
('rgb' => '800080');

7945  
	`¬¿y
('rgb' => '008080');

7947  
	`¬¿y
('rgb' => 'C0C0C0');

7949  
	`¬¿y
('rgb' => '808080');

7951  
	`¬¿y
('rgb' => '9999FF');

7953  
	`¬¿y
('rgb' => '993366');

7955  
	`¬¿y
('rgb' => 'FFFFCC');

7957  
	`¬¿y
('rgb' => 'CCFFFF');

7959  
	`¬¿y
('rgb' => '660066');

7961  
	`¬¿y
('rgb' => 'FF8080');

7963  
	`¬¿y
('rgb' => '0066CC');

7965  
	`¬¿y
('rgb' => 'CCCCFF');

7967  
	`¬¿y
('rgb' => '000080');

7969  
	`¬¿y
('rgb' => 'FF00FF');

7971  
	`¬¿y
('rgb' => 'FFFF00');

7973  
	`¬¿y
('rgb' => '00FFFF');

7975  
	`¬¿y
('rgb' => '800080');

7977  
	`¬¿y
('rgb' => '800000');

7979  
	`¬¿y
('rgb' => '008080');

7981  
	`¬¿y
('rgb' => '0000FF');

7983  
	`¬¿y
('rgb' => '00CCFF');

7985  
	`¬¿y
('rgb' => 'CCFFFF');

7987  
	`¬¿y
('rgb' => 'CCFFCC');

7989  
	`¬¿y
('rgb' => 'FFFF99');

7991  
	`¬¿y
('rgb' => '99CCFF');

7993  
	`¬¿y
('rgb' => 'FF99CC');

7995  
	`¬¿y
('rgb' => 'CC99FF');

7997  
	`¬¿y
('rgb' => 'FFCC99');

7999  
	`¬¿y
('rgb' => '3366FF');

8001  
	`¬¿y
('rgb' => '33CCCC');

8003  
	`¬¿y
('rgb' => '99CC00');

8005  
	`¬¿y
('rgb' => 'FFCC00');

8007  
	`¬¿y
('rgb' => 'FF9900');

8009  
	`¬¿y
('rgb' => 'FF6600');

8011  
	`¬¿y
('rgb' => '666699');

8013  
	`¬¿y
('rgb' => '969696');

8015  
	`¬¿y
('rgb' => '003366');

8017  
	`¬¿y
('rgb' => '339966');

8019  
	`¬¿y
('rgb' => '003300');

8021  
	`¬¿y
('rgb' => '333300');

8023  
	`¬¿y
('rgb' => '993300');

8025  
	`¬¿y
('rgb' => '993366');

8027  
	`¬¿y
('rgb' => '333399');

8029  
	`¬¿y
('rgb' => '333333');

8031  
	`¬¿y
('rgb' => '000000');

8033 
	}
}

8035 
´iv©e
 
funùiÚ
 
·r£RichText
(
$is
 = '')

8037 
$v®ue
 = 
Ãw
 
PHPExûl_RichText
();

8038 
	g$v®ue
->
ü—‹Text
(
$is
);

8040  
	g$v®ue
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel5/Escher.php

1 <?
php


28 şas 
	cPHPExûl_R—d”_Exûl5_Esch”


30 cÚ¡ 
	mDGGCONTAINER
 = 0xF000;

31 cÚ¡ 
	mBSTORECONTAINER
 = 0xF001;

32 cÚ¡ 
	mDGCONTAINER
 = 0xF002;

33 cÚ¡ 
	mSPGRCONTAINER
 = 0xF003;

34 cÚ¡ 
	mSPCONTAINER
 = 0xF004;

35 cÚ¡ 
	mDGG
 = 0xF006;

36 cÚ¡ 
	mBSE
 = 0xF007;

37 cÚ¡ 
	mDG
 = 0xF008;

38 cÚ¡ 
	mSPGR
 = 0xF009;

39 cÚ¡ 
	mSP
 = 0xF00A;

40 cÚ¡ 
	mOPT
 = 0xF00B;

41 cÚ¡ 
	mCLIENTTEXTBOX
 = 0xF00D;

42 cÚ¡ 
	mCLIENTANCHOR
 = 0xF010;

43 cÚ¡ 
	mCLIENTDATA
 = 0xF011;

44 cÚ¡ 
	mBLIPJPEG
 = 0xF01D;

45 cÚ¡ 
	mBLIPPNG
 = 0xF01E;

46 cÚ¡ 
	mSPLITMENUCOLORS
 = 0xF11E;

47 cÚ¡ 
	mTERTIARYOPT
 = 0xF122;

54 
´iv©e
 
	m$d©a
;

61 
´iv©e
 
	m$d©aSize
;

68 
´iv©e
 
	m$pos
;

75 
´iv©e
 
	m$objeù
;

82 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$objeù
)

84 
$this
->
objeù
 = 
$objeù
;

92 
public
 
funùiÚ
 
	$lßd
(
$d©a
)

94 
$this
->
d©a
 = 
$d©a
;

97 
$this
->
d©aSize
 = 
	`¡¾’
($this->
d©a
);

99 
$this
->
pos
 = 0;

102 
$this
->
pos
 < $this->
d©aSize
) {

104 
$fbt
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

106 
$fbt
) {

107 
£lf
::
DGGCONTAINER
:

108 
$this
->
	`»adDggCÚš”
();

110 
£lf
::
DGG
:

111 
$this
->
	`»adDgg
();

113 
£lf
::
BSTORECONTAINER
:

114 
$this
->
	`»adB¡ÜeCÚš”
();

116 
£lf
::
BSE
:

117 
$this
->
	`»adBSE
();

119 
£lf
::
BLIPJPEG
:

120 
$this
->
	`»adBlJPEG
();

122 
£lf
::
BLIPPNG
:

123 
$this
->
	`»adBlPNG
();

125 
£lf
::
OPT
:

126 
$this
->
	`»adOPT
();

128 
£lf
::
TERTIARYOPT
:

129 
$this
->
	`»adT”tŸryOPT
();

131 
£lf
::
SPLITMENUCOLORS
:

132 
$this
->
	`»adS¶™M’uCŞÜs
();

134 
£lf
::
DGCONTAINER
:

135 
$this
->
	`»adDgCÚš”
();

137 
£lf
::
DG
:

138 
$this
->
	`»adDg
();

140 
£lf
::
SPGRCONTAINER
:

141 
$this
->
	`»adSpgrCÚš”
();

143 
£lf
::
SPCONTAINER
:

144 
$this
->
	`»adSpCÚš”
();

146 
£lf
::
SPGR
:

147 
$this
->
	`»adSpgr
();

149 
£lf
::
SP
:

150 
$this
->
	`»adSp
();

152 
£lf
::
CLIENTTEXTBOX
:

153 
$this
->
	`»adCl›ÁTextbox
();

155 
£lf
::
CLIENTANCHOR
:

156 
$this
->
	`»adCl›ÁAnchÜ
();

158 
£lf
::
CLIENTDATA
:

159 
$this
->
	`»adCl›ÁD©a
();

162 
$this
->
	`»adDeçuÉ
();

167  
$this
->
objeù
;

168 
	}
}

173 
´iv©e
 
funùiÚ
 
	$»adDeçuÉ
()

176 
$v”In¡ªû
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
);

179 
$fbt
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
 + 2);

182 
$»cV”
 = (0x000F & 
$v”In¡ªû
) >> 0;

184 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

185 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

188 
$this
->
pos
 +ğ8 + 
$Ëngth
;

189 
	}
}

194 
´iv©e
 
funùiÚ
 
	$»adDggCÚš”
()

196 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

197 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

200 
$this
->
pos
 +ğ8 + 
$Ëngth
;

203 
$dggCÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”
();

204 
$this
->
objeù
->
	`£tDggCÚš”
(
$dggCÚš”
);

205 
$»ad”
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl5_Esch”
(
$dggCÚš”
);

206 
$»ad”
->
	`lßd
(
$»cÜdD©a
);

207 
	}
}

212 
´iv©e
 
funùiÚ
 
	$»adDgg
()

214 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

215 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

218 
$this
->
pos
 +ğ8 + 
$Ëngth
;

219 
	}
}

224 
´iv©e
 
funùiÚ
 
	$»adB¡ÜeCÚš”
()

226 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

227 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

230 
$this
->
pos
 +ğ8 + 
$Ëngth
;

233 
$b¡ÜeCÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”
();

234 
$this
->
objeù
->
	`£tB¡ÜeCÚš”
(
$b¡ÜeCÚš”
);

235 
$»ad”
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl5_Esch”
(
$b¡ÜeCÚš”
);

236 
$»ad”
->
	`lßd
(
$»cÜdD©a
);

237 
	}
}

242 
´iv©e
 
funùiÚ
 
	$»adBSE
()

247 
$»cIn¡ªû
 = (0xFFF0 & 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
)) >> 4;

249 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

250 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

253 
$this
->
pos
 +ğ8 + 
$Ëngth
;

256 
$BSE
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
();

257 
$this
->
objeù
->
	`addBSE
(
$BSE
);

259 
$BSE
->
	`£tBLIPTy³
(
$»cIn¡ªû
);

262 
$btWš32
 = 
	`Üd
(
$»cÜdD©a
[0]);

265 
$btMacOS
 = 
	`Üd
(
$»cÜdD©a
[1]);

268 
$rgbUid
 = 
	`sub¡r
(
$»cÜdD©a
, 2, 16);

271 
$g
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$»cÜdD©a
, 18);

274 
$size
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$»cÜdD©a
, 20);

277 
$cRef
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$»cÜdD©a
, 24);

280 
$foD–ay
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$»cÜdD©a
, 28);

283 
$unu£d1
 = 
	`Üd
(
$»cÜdD©a
{32});

286 
$cbName
 = 
	`Üd
(
$»cÜdD©a
{33});

289 
$unu£d2
 = 
	`Üd
(
$»cÜdD©a
{34});

292 
$unu£d3
 = 
	`Üd
(
$»cÜdD©a
{35});

295 
$ÇmeD©a
 = 
	`sub¡r
(
$»cÜdD©a
, 36, 
$cbName
);

298 
$blD©a
 = 
	`sub¡r
(
$»cÜdD©a
, 36 + 
$cbName
);

301 
$»ad”
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl5_Esch”
(
$BSE
);

302 
$»ad”
->
	`lßd
(
$blD©a
);

303 
	}
}

308 
´iv©e
 
funùiÚ
 
	$»adBlJPEG
()

313 
$»cIn¡ªû
 = (0xFFF0 & 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
)) >> 4;

315 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

316 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

319 
$this
->
pos
 +ğ8 + 
$Ëngth
;

321 
$pos
 = 0;

324 
$rgbUid1
 = 
	`sub¡r
(
$»cÜdD©a
, 0, 16);

325 
$pos
 += 16;

328 ià(
	`š_¬¿y
(
$»cIn¡ªû
, 
	`¬¿y
(0x046B, 0x06E3))) {

329 
$rgbUid2
 = 
	`sub¡r
(
$»cÜdD©a
, 16, 16);

330 
$pos
 += 16;

334 
$g
 = 
	`Üd
(
$»cÜdD©a
{
$pos
});

335 
$pos
 += 1;

338 
$d©a
 = 
	`sub¡r
(
$»cÜdD©a
, 
$pos
);

340 
$bl
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE_Bl
();

341 
$bl
->
	`£tD©a
(
$d©a
);

343 
$this
->
objeù
->
	`£tBl
(
$bl
);

344 
	}
}

349 
´iv©e
 
funùiÚ
 
	$»adBlPNG
()

354 
$»cIn¡ªû
 = (0xFFF0 & 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
)) >> 4;

356 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

357 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

360 
$this
->
pos
 +ğ8 + 
$Ëngth
;

362 
$pos
 = 0;

365 
$rgbUid1
 = 
	`sub¡r
(
$»cÜdD©a
, 0, 16);

366 
$pos
 += 16;

369 ià(
$»cIn¡ªû
 == 0x06E1) {

370 
$rgbUid2
 = 
	`sub¡r
(
$»cÜdD©a
, 16, 16);

371 
$pos
 += 16;

375 
$g
 = 
	`Üd
(
$»cÜdD©a
{
$pos
});

376 
$pos
 += 1;

379 
$d©a
 = 
	`sub¡r
(
$»cÜdD©a
, 
$pos
);

381 
$bl
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE_Bl
();

382 
$bl
->
	`£tD©a
(
$d©a
);

384 
$this
->
objeù
->
	`£tBl
(
$bl
);

385 
	}
}

390 
´iv©e
 
funùiÚ
 
	$»adOPT
()

395 
$»cIn¡ªû
 = (0xFFF0 & 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
)) >> 4;

397 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

398 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

401 
$this
->
pos
 +ğ8 + 
$Ëngth
;

403 
$this
->
	`»adOffiûA¹RGFOPTE
(
$»cÜdD©a
, 
$»cIn¡ªû
);

404 
	}
}

409 
´iv©e
 
funùiÚ
 
	$»adT”tŸryOPT
()

414 
$»cIn¡ªû
 = (0xFFF0 & 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
)) >> 4;

416 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

417 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

420 
$this
->
pos
 +ğ8 + 
$Ëngth
;

421 
	}
}

426 
´iv©e
 
funùiÚ
 
	$»adS¶™M’uCŞÜs
()

428 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

429 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

432 
$this
->
pos
 +ğ8 + 
$Ëngth
;

433 
	}
}

438 
´iv©e
 
funùiÚ
 
	$»adDgCÚš”
()

440 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

441 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

444 
$this
->
pos
 +ğ8 + 
$Ëngth
;

447 
$dgCÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DgCÚš”
();

448 
$this
->
objeù
->
	`£tDgCÚš”
(
$dgCÚš”
);

449 
$»ad”
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl5_Esch”
(
$dgCÚš”
);

450 
$esch”
 = 
$»ad”
->
	`lßd
(
$»cÜdD©a
);

451 
	}
}

456 
´iv©e
 
funùiÚ
 
	$»adDg
()

458 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

459 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

462 
$this
->
pos
 +ğ8 + 
$Ëngth
;

463 
	}
}

468 
´iv©e
 
funùiÚ
 
	$»adSpgrCÚš”
()

472 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

473 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

476 
$this
->
pos
 +ğ8 + 
$Ëngth
;

479 
$¥grCÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DgCÚš”_SpgrCÚš”
();

481 ià(
$this
->
objeù
 
š¡ªûof
 
PHPExûl_Sh¬ed_Esch”_DgCÚš”
) {

483 
$this
->
objeù
->
	`£tSpgrCÚš”
(
$¥grCÚš”
);

486 
$this
->
objeù
->
	`addChd
(
$¥grCÚš”
);

489 
$»ad”
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl5_Esch”
(
$¥grCÚš”
);

490 
$esch”
 = 
$»ad”
->
	`lßd
(
$»cÜdD©a
);

491 
	}
}

496 
´iv©e
 
funùiÚ
 
	$»adSpCÚš”
()

498 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

499 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

502 
$¥CÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DgCÚš”_SpgrCÚš”_SpCÚš”
();

503 
$this
->
objeù
->
	`addChd
(
$¥CÚš”
);

506 
$this
->
pos
 +ğ8 + 
$Ëngth
;

509 
$»ad”
 = 
Ãw
 
	`PHPExûl_R—d”_Exûl5_Esch”
(
$¥CÚš”
);

510 
$esch”
 = 
$»ad”
->
	`lßd
(
$»cÜdD©a
);

511 
	}
}

516 
´iv©e
 
funùiÚ
 
	$»adSpgr
()

518 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

519 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

522 
$this
->
pos
 +ğ8 + 
$Ëngth
;

523 
	}
}

528 
´iv©e
 
funùiÚ
 
	$»adSp
()

533 
$»cIn¡ªû
 = (0xFFF0 & 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
)) >> 4;

535 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

536 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

539 
$this
->
pos
 +ğ8 + 
$Ëngth
;

540 
	}
}

545 
´iv©e
 
funùiÚ
 
	$»adCl›ÁTextbox
()

550 
$»cIn¡ªû
 = (0xFFF0 & 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$this
->
d©a
, $this->
pos
)) >> 4;

552 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

553 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

556 
$this
->
pos
 +ğ8 + 
$Ëngth
;

557 
	}
}

562 
´iv©e
 
funùiÚ
 
	$»adCl›ÁAnchÜ
()

564 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

565 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

568 
$this
->
pos
 +ğ8 + 
$Ëngth
;

571 
$c1
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$»cÜdD©a
, 2);

574 
$¡¬tOff£tX
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$»cÜdD©a
, 4);

577 
$r1
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$»cÜdD©a
, 6);

580 
$¡¬tOff£tY
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$»cÜdD©a
, 8);

583 
$c2
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$»cÜdD©a
, 10);

586 
$’dOff£tX
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$»cÜdD©a
, 12);

589 
$r2
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$»cÜdD©a
, 14);

592 
$’dOff£tY
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$»cÜdD©a
, 16);

595 
$this
->
objeù
->
	`£tS¹CoÜdš©es
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$c1
è. (
$r1
 + 1));

598 
$this
->
objeù
->
	`£tS¹Off£tX
(
$¡¬tOff£tX
);

601 
$this
->
objeù
->
	`£tS¹Off£tY
(
$¡¬tOff£tY
);

604 
$this
->
objeù
->
	`£tEndCoÜdš©es
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$c2
è. (
$r2
 + 1));

607 
$this
->
objeù
->
	`£tEndOff£tX
(
$’dOff£tX
);

610 
$this
->
objeù
->
	`£tEndOff£tY
(
$’dOff£tY
);

611 
	}
}

616 
´iv©e
 
funùiÚ
 
	$»adCl›ÁD©a
()

618 
$Ëngth
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$this
->
d©a
, $this->
pos
 + 4);

619 
$»cÜdD©a
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
 + 8, 
$Ëngth
);

622 
$this
->
pos
 +ğ8 + 
$Ëngth
;

623 
	}
}

631 
´iv©e
 
funùiÚ
 
	$»adOffiûA¹RGFOPTE
(
$d©a
, 
$n
)

633 
$¥liûdCom¶exD©a
 = 
	`sub¡r
(
$d©a
, 6 * 
$n
);

636 
$i
 = 0; $˜< 
$n
; ++$i) {

638 
$fİ‹
 = 
	`sub¡r
(
$d©a
, 6 * 
$i
, 6);

641 
$İid
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ2d
(
$fİ‹
, 0);

644 
$İidOpid
 = (0x3FFF & 
$İid
) >> 0;

647 
$İidFBid
 = (0x4000 & 
$İid
) >> 14;

650 
$İidFCom¶ex
 = (0x8000 & 
$İid
) >> 15;

653 
$İ
 = 
PHPExûl_R—d”_Exûl5
::
	`g‘IÁ4d
(
$fİ‹
, 2);

655 ià(
$İidFCom¶ex
) {

656 
$com¶exD©a
 = 
	`sub¡r
(
$¥liûdCom¶exD©a
, 0, 
$İ
);

657 
$¥liûdCom¶exD©a
 = 
	`sub¡r
($¥liûdCom¶exD©a, 
$İ
);

660 
$v®ue
 = 
$com¶exD©a
;

663 
$v®ue
 = 
$İ
;

666 
$this
->
objeù
->
	`£tOPT
(
$İidOpid
, 
$v®ue
);

668 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel5/MD5.php

1 <?
php


28 şas 
	cPHPExûl_R—d”_Exûl5_MD5


31 
´iv©e
 
	m$a
;

32 
´iv©e
 
	m$b
;

33 
´iv©e
 
	m$c
;

34 
´iv©e
 
	m$d
;

39 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

41 
$this
->
	`»£t
();

47 
public
 
funùiÚ
 
	$»£t
()

49 
$this
->
a
 = 0x67452301;

50 
$this
->
b
 = 0xEFCDAB89;

51 
$this
->
c
 = 0x98BADCFE;

52 
$this
->
d
 = 0x10325476;

53 
	}
}

60 
public
 
funùiÚ
 
	$g‘CÚ‹xt
()

62 
$s
 = '';

63 
	`fÜ—ch
 (
	`¬¿y
('a', 'b', 'c', 'd'è
as
 
$i
) {

64 
$v
 = 
$this
->{
$i
};

65 
$s
 .ğ
	`chr
(
$v
 & 0xff);

66 
$s
 .ğ
	`chr
((
$v
 >> 8) & 0xff);

67 
$s
 .ğ
	`chr
((
$v
 >> 16) & 0xff);

68 
$s
 .ğ
	`chr
((
$v
 >> 24) & 0xff);

71  
$s
;

72 
	}
}

79 
public
 
funùiÚ
 
	$add
(
$d©a
)

81 
$wÜds
 = 
	`¬¿y_v®ues
(
	`uÅack
('V16', 
$d©a
));

83 
$A
 = 
$this
->
a
;

84 
$B
 = 
$this
->
b
;

85 
$C
 = 
$this
->
c
;

86 
$D
 = 
$this
->
d
;

88 
$F
 = 
	`¬¿y
('PHPExcel_Reader_Excel5_MD5','f');

89 
$G
 = 
	`¬¿y
('PHPExcel_Reader_Excel5_MD5','g');

90 
$H
 = 
	`¬¿y
('PHPExcel_Reader_Excel5_MD5','h');

91 
$I
 = 
	`¬¿y
('PHPExcel_Reader_Excel5_MD5','i');

94 
£lf
::
	`¡•
(
$F
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[0], 7, 0xd76aa478);

95 
£lf
::
	`¡•
(
$F
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[1], 12, 0xe8c7b756);

96 
£lf
::
	`¡•
(
$F
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[2], 17, 0x242070db);

97 
£lf
::
	`¡•
(
$F
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[3], 22, 0xc1bdceee);

98 
£lf
::
	`¡•
(
$F
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[4], 7, 0xf57c0faf);

99 
£lf
::
	`¡•
(
$F
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[5], 12, 0x4787c62a);

100 
£lf
::
	`¡•
(
$F
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[6], 17, 0xa8304613);

101 
£lf
::
	`¡•
(
$F
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[7], 22, 0xfd469501);

102 
£lf
::
	`¡•
(
$F
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[8], 7, 0x698098d8);

103 
£lf
::
	`¡•
(
$F
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[9], 12, 0x8b44f7af);

104 
£lf
::
	`¡•
(
$F
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[10], 17, 0xffff5bb1);

105 
£lf
::
	`¡•
(
$F
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[11], 22, 0x895cd7be);

106 
£lf
::
	`¡•
(
$F
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[12], 7, 0x6b901122);

107 
£lf
::
	`¡•
(
$F
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[13], 12, 0xfd987193);

108 
£lf
::
	`¡•
(
$F
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[14], 17, 0xa679438e);

109 
£lf
::
	`¡•
(
$F
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[15], 22, 0x49b40821);

112 
£lf
::
	`¡•
(
$G
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[1], 5, 0xf61e2562);

113 
£lf
::
	`¡•
(
$G
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[6], 9, 0xc040b340);

114 
£lf
::
	`¡•
(
$G
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[11], 14, 0x265e5a51);

115 
£lf
::
	`¡•
(
$G
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[0], 20, 0xe9b6c7aa);

116 
£lf
::
	`¡•
(
$G
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[5], 5, 0xd62f105d);

117 
£lf
::
	`¡•
(
$G
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[10], 9, 0x02441453);

118 
£lf
::
	`¡•
(
$G
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[15], 14, 0xd8a1e681);

119 
£lf
::
	`¡•
(
$G
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[4], 20, 0xe7d3fbc8);

120 
£lf
::
	`¡•
(
$G
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[9], 5, 0x21e1cde6);

121 
£lf
::
	`¡•
(
$G
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[14], 9, 0xc33707d6);

122 
£lf
::
	`¡•
(
$G
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[3], 14, 0xf4d50d87);

123 
£lf
::
	`¡•
(
$G
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[8], 20, 0x455a14ed);

124 
£lf
::
	`¡•
(
$G
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[13], 5, 0xa9e3e905);

125 
£lf
::
	`¡•
(
$G
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[2], 9, 0xfcefa3f8);

126 
£lf
::
	`¡•
(
$G
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[7], 14, 0x676f02d9);

127 
£lf
::
	`¡•
(
$G
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[12], 20, 0x8d2a4c8a);

130 
£lf
::
	`¡•
(
$H
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[5], 4, 0xfffa3942);

131 
£lf
::
	`¡•
(
$H
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[8], 11, 0x8771f681);

132 
£lf
::
	`¡•
(
$H
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[11], 16, 0x6d9d6122);

133 
£lf
::
	`¡•
(
$H
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[14], 23, 0xfde5380c);

134 
£lf
::
	`¡•
(
$H
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[1], 4, 0xa4beea44);

135 
£lf
::
	`¡•
(
$H
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[4], 11, 0x4bdecfa9);

136 
£lf
::
	`¡•
(
$H
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[7], 16, 0xf6bb4b60);

137 
£lf
::
	`¡•
(
$H
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[10], 23, 0xbebfbc70);

138 
£lf
::
	`¡•
(
$H
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[13], 4, 0x289b7ec6);

139 
£lf
::
	`¡•
(
$H
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[0], 11, 0xeaa127fa);

140 
£lf
::
	`¡•
(
$H
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[3], 16, 0xd4ef3085);

141 
£lf
::
	`¡•
(
$H
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[6], 23, 0x04881d05);

142 
£lf
::
	`¡•
(
$H
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[9], 4, 0xd9d4d039);

143 
£lf
::
	`¡•
(
$H
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[12], 11, 0xe6db99e5);

144 
£lf
::
	`¡•
(
$H
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[15], 16, 0x1fa27cf8);

145 
£lf
::
	`¡•
(
$H
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[2], 23, 0xc4ac5665);

148 
£lf
::
	`¡•
(
$I
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[0], 6, 0xf4292244);

149 
£lf
::
	`¡•
(
$I
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[7], 10, 0x432aff97);

150 
£lf
::
	`¡•
(
$I
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[14], 15, 0xab9423a7);

151 
£lf
::
	`¡•
(
$I
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[5], 21, 0xfc93a039);

152 
£lf
::
	`¡•
(
$I
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[12], 6, 0x655b59c3);

153 
£lf
::
	`¡•
(
$I
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[3], 10, 0x8f0ccc92);

154 
£lf
::
	`¡•
(
$I
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[10], 15, 0xffeff47d);

155 
£lf
::
	`¡•
(
$I
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[1], 21, 0x85845dd1);

156 
£lf
::
	`¡•
(
$I
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[8], 6, 0x6fa87e4f);

157 
£lf
::
	`¡•
(
$I
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[15], 10, 0xfe2ce6e0);

158 
£lf
::
	`¡•
(
$I
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[6], 15, 0xa3014314);

159 
£lf
::
	`¡•
(
$I
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[13], 21, 0x4e0811a1);

160 
£lf
::
	`¡•
(
$I
, 
$A
, 
$B
, 
$C
, 
$D
, 
$wÜds
[4], 6, 0xf7537e82);

161 
£lf
::
	`¡•
(
$I
, 
$D
, 
$A
, 
$B
, 
$C
, 
$wÜds
[11], 10, 0xbd3af235);

162 
£lf
::
	`¡•
(
$I
, 
$C
, 
$D
, 
$A
, 
$B
, 
$wÜds
[2], 15, 0x2ad7d2bb);

163 
£lf
::
	`¡•
(
$I
, 
$B
, 
$C
, 
$D
, 
$A
, 
$wÜds
[9], 21, 0xeb86d391);

165 
$this
->
a
 = ($this->¨+ 
$A
) & 0xffffffff;

166 
$this
->
b
 = ($this->b + 
$B
) & 0xffffffff;

167 
$this
->
c
 = ($this->ø+ 
$C
) & 0xffffffff;

168 
$this
->
d
 = ($this->d + 
$D
) & 0xffffffff;

169 
	}
}

171 
´iv©e
 
funùiÚ
 
	$f
(
$X
, 
$Y
, 
$Z
)

173  ((
$X
 & 
$Y
è| ((~ $Xè& 
$Z
));

174 
	}
}

176 
´iv©e
 
funùiÚ
 
	$g
(
$X
, 
$Y
, 
$Z
)

178  ((
$X
 & 
$Z
è| (
$Y
 & (~ $Z)));

179 
	}
}

181 
´iv©e
 
funùiÚ
 
	$h
(
$X
, 
$Y
, 
$Z
)

183  (
$X
 ^ 
$Y
 ^ 
$Z
);

184 
	}
}

186 
´iv©e
 
funùiÚ
 
	$i
(
$X
, 
$Y
, 
$Z
)

188  (
$Y
 ^ (
$X
 | (~ 
$Z
))) ;

189 
	}
}

191 
´iv©e
 
funùiÚ
 
	$¡•
(
$func
, &
$A
, 
$B
, 
$C
, 
$D
, 
$M
, 
$s
, 
$t
)

193 
$A
 = ($A + 
	`ÿÎ_u£r_func
(
$func
, 
$B
, 
$C
, 
$D
è+ 
$M
 + 
$t
) & 0xffffffff;

194 
$A
 = 
£lf
::
	`rÙ©e
($A, 
$s
);

195 
$A
 = (
$B
 + $A) & 0xffffffff;

196 
	}
}

198 
´iv©e
 
funùiÚ
 
	$rÙ©e
(
$decim®
, 
$b™s
)

200 
$bš¬y
 = 
	`¡r_·d
(
	`decbš
(
$decim®
), 32, "0", 
STR_PAD_LEFT
);

201  
	`bšdec
(
	`sub¡r
(
$bš¬y
, 
$b™s
).substr($binary, 0, $bits));

202 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel5/RC4.php

1 <?
php


28 şas 
	cPHPExûl_R—d”_Exûl5_RC4


31 
´Ùeùed
 
	m$s
 = 
¬¿y
();

32 
´Ùeùed
 
	m$i
 = 0;

33 
´Ùeùed
 
	m$j
 = 0;

40 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$key
)

42 
$Ën
 = 
	`¡¾’
(
$key
);

44 
$this
->
i
 = 0; $this->i < 256; $this->i++) {

45 
$this
->
s
[$this->
i
] = $this->i;

48 
$this
->
j
 = 0;

49 
$this
->
i
 = 0; $this->i < 256; $this->i++) {

50 
$this
->
j
 = ($this->j + $this->
s
[$this->
i
] + 
	`Üd
(
$key
[$this->˜% 
$Ën
])) % 256;

51 
$t
 = 
$this
->
s
[$this->
i
];

52 
$this
->
s
[$this->
i
] = $this->s[$this->
j
];

53 
$this
->
s
[$this->
j
] = 
$t
;

55 
$this
->
i
 = $this->
j
 = 0;

65 
public
 
funùiÚ
 
	$RC4
(
$d©a
)

67 
$Ën
 = 
	`¡¾’
(
$d©a
);

68 
$c
 = 0; $ø< 
$Ën
; $c++) {

69 
$this
->
i
 = ($this->i + 1) % 256;

70 
$this
->
j
 = ($this->j + $this->
s
[$this->
i
]) % 256;

71 
$t
 = 
$this
->
s
[$this->
i
];

72 
$this
->
s
[$this->
i
] = $this->s[$this->
j
];

73 
$this
->
s
[$this->
j
] = 
$t
;

75 
$t
 = (
$this
->
s
[$this->
i
] + $this->s[$this->
j
]) % 256;

77 
$d©a
[
$c
] = 
	`chr
(
	`Üd
($d©a[$c]è^ 
$this
->
s
[
$t
]);

79  
$d©a
;

80 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Exception.php

1 <?
php


28 şas 
	cPHPExûl_R—d”_Exû±iÚ
 
ex‹nds
 
	mPHPExûl_Exû±iÚ


39 
public
 
funùiÚ
 
	$”rÜHªdËrC®lback
(
$code
, 
$¡ršg
, 
$fe
, 
$lše
, 
$cÚ‹xt
)

41 
$e
 = 
Ãw
 
	`£lf
(
$¡ršg
, 
$code
);

42 
$e
->
lše
 = 
$lše
;

43 
$e
->
fe
 = 
$fe
;

44 
throw
 
$e
;

46 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Gnumeric.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_R—d”_Gnum”ic
 
ex‹nds
 
PHPExûl_R—d”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_R—d”_IR—d”


44 
´iv©e
 
	m$¡yËs
 = 
¬¿y
();

51 
´iv©e
 
	m$ex´essiÚs
 = 
¬¿y
();

53 
´iv©e
 
	m$»ã»nûH–³r
 = 
nuÎ
;

58 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

60 
$this
->
»adF‹r
 = 
Ãw
 
	`PHPExûl_R—d”_DeçuÉR—dF‹r
();

61 
$this
->
»ã»nûH–³r
 = 
PHPExûl_Reã»nûH–³r
::
	`g‘In¡ªû
();

71 
public
 
funùiÚ
 
	$ÿnR—d
(
$pF’ame
)

74 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

75 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

79 ià(!
	`funùiÚ_exi¡s
('gzread')) {

80 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("gzlib†ibrary is‚otƒnabled");

84 
$fh
 = 
	`fİ’
(
$pF’ame
, 'r');

85 
$d©a
 = 
	`ä—d
(
$fh
, 2);

86 
	`fşo£
(
$fh
);

88 ià(
$d©a
 !ğ
	`chr
(0x1F).chr(0x8B)) {

89  
çl£
;

92  
Œue
;

93 
	}
}

101 
public
 
funùiÚ
 
	$li¡WÜksh“tNames
(
$pF’ame
)

104 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

105 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

108 
$xml
 = 
Ãw
 
	`XMLR—d”
();

109 
$xml
->
	`xml
(
$this
->
	`£cur™ySÿnFe
('com´ess.zlib://'.
	`»®·th
(
$pF’ame
)), 
nuÎ
, 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

110 
$xml
->
	`£tP¬£rPrİ”ty
(2, 
Œue
);

112 
$wÜksh“tNames
 = 
	`¬¿y
();

113 
$xml
->
	`»ad
()) {

114 ià(
$xml
->
Çme
 =ğ'gnm:Sh“tName' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

115 
$xml
->
	`»ad
();

116 
$wÜksh“tNames
[] = (
¡ršg
è
$xml
->
v®ue
;

117 } 
	`–£if
 (
$xml
->
Çme
 == 'gnm:Sheets') {

123  
$wÜksh“tNames
;

124 
	}
}

132 
public
 
funùiÚ
 
	$li¡WÜksh“tInfo
(
$pF’ame
)

135 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

136 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

139 
$xml
 = 
Ãw
 
	`XMLR—d”
();

140 
$xml
->
	`xml
(
$this
->
	`£cur™ySÿnFe
('com´ess.zlib://'.
	`»®·th
(
$pF’ame
)), 
nuÎ
, 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

141 
$xml
->
	`£tP¬£rPrİ”ty
(2, 
Œue
);

143 
$wÜksh“tInfo
 = 
	`¬¿y
();

144 
$xml
->
	`»ad
()) {

145 ià(
$xml
->
Çme
 =ğ'gnm:Sh“t' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

146 
$tmpInfo
 = 
	`¬¿y
(

154 
$xml
->
	`»ad
()) {

155 ià(
$xml
->
Çme
 =ğ'gnm:Name' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

156 
$xml
->
	`»ad
();

157 
$tmpInfo
['wÜksh“tName'] = (
¡ršg
è
$xml
->
v®ue
;

158 } 
	`–£if
 (
$xml
->
Çme
 =ğ'gnm:MaxCŞ' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

159 
$xml
->
	`»ad
();

160 
$tmpInfo
['Ï¡CŞumnIndex'] = (è
$xml
->
v®ue
;

161 
$tmpInfo
['tÙ®CŞumns'] = (è
$xml
->
v®ue
 + 1;

162 } 
	`–£if
 (
$xml
->
Çme
 =ğ'gnm:MaxRow' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

163 
$xml
->
	`»ad
();

164 
$tmpInfo
['tÙ®Rows'] = (è
$xml
->
v®ue
 + 1;

168 
$tmpInfo
['Ï¡CŞumnL‘‹r'] = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($tmpInfo['lastColumnIndex']);

169 
$wÜksh“tInfo
[] = 
$tmpInfo
;

173  
$wÜksh“tInfo
;

174 
	}
}

176 
´iv©e
 
funùiÚ
 
	$gzfeG‘CÚ‹Ás
(
$f’ame
)

178 
$fe
 = @
	`gzİ’
(
$f’ame
, 'rb');

179 ià(
$fe
 !=ğ
çl£
) {

180 
$d©a
 = '';

181 !
	`gzeof
(
$fe
)) {

182 
$d©a
 .ğ
	`gz»ad
(
$fe
, 1024);

184 
	`gzşo£
(
$fe
);

186  
$d©a
;

187 
	}
}

196 
public
 
funùiÚ
 
	$lßd
(
$pF’ame
)

199 
$objPHPExûl
 = 
Ãw
 
	`PHPExûl
();

202  
$this
->
	`lßdIÁoExi¡šg
(
$pF’ame
, 
$objPHPExûl
);

203 
	}
}

213 
public
 
funùiÚ
 
	$lßdIÁoExi¡šg
(
$pF’ame
, 
PHPExûl
 
$objPHPExûl
)

216 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

217 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

220 
$timezÚeObj
 = 
Ãw
 
	`D©eTimeZÚe
('Europe/London');

221 
$GMT
 = 
Ãw
 
	`D©eTimeZÚe
('UTC');

223 
$gFeD©a
 = 
$this
->
	`gzfeG‘CÚ‹Ás
(
$pF’ame
);

229 
$xml
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
(
$gFeD©a
), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

230 
$Çme¥aûsM‘a
 = 
$xml
->
	`g‘Name¥aûs
(
Œue
);

234 
$gnmXML
 = 
$xml
->
	`chd»n
(
$Çme¥aûsM‘a
['gnm']);

236 
$docPrİs
 = 
$objPHPExûl
->
	`g‘Prİ”t›s
();

238 ià(
	`is£t
(
$Çme¥aûsM‘a
['office'])) {

239 
$offiûXML
 = 
$xml
->
	`chd»n
(
$Çme¥aûsM‘a
['office']);

240 
$offiûDocXML
 = 
$offiûXML
->{'document-meta'};

241 
$offiûDocM‘aXML
 = 
$offiûDocXML
->
m‘a
;

243 
	`fÜ—ch
 (
$offiûDocM‘aXML
 
as
 
$offiûPrİ”tyD©a
) {

244 
$offiûPrİ”tyDC
 = 
	`¬¿y
();

245 ià(
	`is£t
(
$Çme¥aûsM‘a
['dc'])) {

246 
$offiûPrİ”tyDC
 = 
$offiûPrİ”tyD©a
->
	`chd»n
(
$Çme¥aûsM‘a
['dc']);

248 
	`fÜ—ch
 (
$offiûPrİ”tyDC
 
as
 
$´İ”tyName
 => 
$´İ”tyV®ue
) {

249 
$´İ”tyV®ue
 = (
¡ršg
) $propertyValue;

250 
$´İ”tyName
) {

252 
$docPrİs
->
	`£tT™Ë
(
	`Œim
(
$´İ”tyV®ue
));

255 
$docPrİs
->
	`£tSubjeù
(
	`Œim
(
$´İ”tyV®ue
));

258 
$docPrİs
->
	`£tC»©Ü
(
	`Œim
(
$´İ”tyV®ue
));

259 
$docPrİs
->
	`£tLa¡Modif›dBy
(
	`Œim
(
$´İ”tyV®ue
));

262 
$ü—tiÚD©e
 = 
	`¡¹Ùime
(
	`Œim
(
$´İ”tyV®ue
));

263 
$docPrİs
->
	`£tC»©ed
(
$ü—tiÚD©e
);

264 
$docPrİs
->
	`£tModif›d
(
$ü—tiÚD©e
);

267 
$docPrİs
->
	`£tDesütiÚ
(
	`Œim
(
$´İ”tyV®ue
));

271 
$offiûPrİ”tyM‘a
 = 
	`¬¿y
();

272 ià(
	`is£t
(
$Çme¥aûsM‘a
['meta'])) {

273 
$offiûPrİ”tyM‘a
 = 
$offiûPrİ”tyD©a
->
	`chd»n
(
$Çme¥aûsM‘a
['meta']);

275 
	`fÜ—ch
 (
$offiûPrİ”tyM‘a
 
as
 
$´İ”tyName
 => 
$´İ”tyV®ue
) {

276 
$©Œibu‹s
 = 
$´İ”tyV®ue
->
	`©Œibu‹s
(
$Çme¥aûsM‘a
['meta']);

277 
$´İ”tyV®ue
 = (
¡ršg
) $propertyValue;

278 
$´İ”tyName
) {

280 
$docPrİs
->
	`£tKeywÜds
(
	`Œim
(
$´İ”tyV®ue
));

283 
$docPrİs
->
	`£tC»©Ü
(
	`Œim
(
$´İ”tyV®ue
));

284 
$docPrİs
->
	`£tLa¡Modif›dBy
(
	`Œim
(
$´İ”tyV®ue
));

287 
$ü—tiÚD©e
 = 
	`¡¹Ùime
(
	`Œim
(
$´İ”tyV®ue
));

288 
$docPrİs
->
	`£tC»©ed
(
$ü—tiÚD©e
);

289 
$docPrİs
->
	`£tModif›d
(
$ü—tiÚD©e
);

292 
	`li¡
(, 
$©ŒName
èğ
	`ex¶ode
(':', 
$©Œibu‹s
['name']);

293 
$©ŒName
) {

295 
$docPrİs
->
	`£tCom·ny
(
	`Œim
(
$´İ”tyV®ue
));

298 
$docPrİs
->
	`£tC©egÜy
(
	`Œim
(
$´İ”tyV®ue
));

301 
$docPrİs
->
	`£tMªag”
(
	`Œim
(
$´İ”tyV®ue
));

308 } 
	`–£if
 (
	`is£t
(
$gnmXML
->
Summ¬y
)) {

309 
	`fÜ—ch
 (
$gnmXML
->
Summ¬y
->
I‹m
 
as
 
$summ¬yI‹m
) {

310 
$´İ”tyName
 = 
$summ¬yI‹m
->
Çme
;

311 
$´İ”tyV®ue
 = 
$summ¬yI‹m
->{'val-string'};

312 
$´İ”tyName
) {

314 
$docPrİs
->
	`£tT™Ë
(
	`Œim
(
$´İ”tyV®ue
));

317 
$docPrİs
->
	`£tDesütiÚ
(
	`Œim
(
$´İ”tyV®ue
));

320 
$docPrİs
->
	`£tKeywÜds
(
	`Œim
(
$´İ”tyV®ue
));

323 
$docPrİs
->
	`£tC©egÜy
(
	`Œim
(
$´İ”tyV®ue
));

326 
$docPrİs
->
	`£tMªag”
(
	`Œim
(
$´İ”tyV®ue
));

329 
$docPrİs
->
	`£tC»©Ü
(
	`Œim
(
$´İ”tyV®ue
));

330 
$docPrİs
->
	`£tLa¡Modif›dBy
(
	`Œim
(
$´İ”tyV®ue
));

333 
$docPrİs
->
	`£tCom·ny
(
	`Œim
(
$´İ”tyV®ue
));

339 
$wÜksh“tID
 = 0;

340 
	`fÜ—ch
 (
$gnmXML
->
Sh“ts
->
Sh“t
 
as
 
$sh“t
) {

341 
$wÜksh“tName
 = (
¡ršg
è
$sh“t
->
Name
;

343 ià((
	`is£t
(
$this
->
lßdSh“tsOÆy
)è&& (!
	`š_¬¿y
(
$wÜksh“tName
, $this->loadSheetsOnly))) {

347 
$maxRow
 = 
$maxCŞ
 = 0;

350 
$objPHPExûl
->
	`ü—‹Sh“t
();

351 
$objPHPExûl
->
	`£tAùiveSh“tIndex
(
$wÜksh“tID
);

355 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`£tT™Ë
(
$wÜksh“tName
, 
çl£
);

357 ià((!
$this
->
»adD©aOÆy
è&& (
	`is£t
(
$sh“t
->
PrštInfÜm©iÚ
))) {

358 ià(
	`is£t
(
$sh“t
->
PrštInfÜm©iÚ
->
M¬gšs
)) {

359 
	`fÜ—ch
 (
$sh“t
->
PrštInfÜm©iÚ
->
M¬gšs
->
	`chd»n
('gnm', 
Œue
è
as
 
$key
 => 
$m¬gš
) {

360 
$m¬gšA‰ribu‹s
 = 
$m¬gš
->
	`©Œibu‹s
();

361 
$m¬gšSize
 = 72 / 100;

362 
$m¬gšA‰ribu‹s
['PrefUnit']) {

364 
$m¬gšSize
 = 
	`štv®
(
$m¬gšA‰ribu‹s
['Points']) / 100;

367 
$key
) {

369 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘PageM¬gšs
()->
	`£tTİ
(
$m¬gšSize
);

372 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘PageM¬gšs
()->
	`£tBÙtom
(
$m¬gšSize
);

375 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘PageM¬gšs
()->
	`£tLeá
(
$m¬gšSize
);

378 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘PageM¬gšs
()->
	`£tRight
(
$m¬gšSize
);

381 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘PageM¬gšs
()->
	`£tH—d”
(
$m¬gšSize
);

384 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘PageM¬gšs
()->
	`£tFoÙ”
(
$m¬gšSize
);

391 
	`fÜ—ch
 (
$sh“t
->
C–ls
->
C–l
 
as
 
$ûÎ
) {

392 
$ûÎA‰ribu‹s
 = 
$ûÎ
->
	`©Œibu‹s
();

393 
$row
 = (è
$ûÎA‰ribu‹s
->
Row
 + 1;

394 
$cŞumn
 = (è
$ûÎA‰ribu‹s
->
CŞ
;

396 ià(
$row
 > 
$maxRow
) {

397 
$maxRow
 = 
$row
;

399 ià(
$cŞumn
 > 
$maxCŞ
) {

400 
$maxCŞ
 = 
$cŞumn
;

403 
$cŞumn
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($column);

406 ià(
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
) {

407 ià(!
$this
->
	`g‘R—dF‹r
()->
	`»adC–l
(
$cŞumn
, 
$row
, 
$wÜksh“tName
)) {

412 
$V®ueTy³
 = 
$ûÎA‰ribu‹s
->
V®ueTy³
;

413 
$Ex´ID
 = (
¡ršg
è
$ûÎA‰ribu‹s
->
Ex´ID
;

417 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
;

418 ià(
$Ex´ID
 > '') {

419 ià(((
¡ršg
è
$ûÎ
) > '') {

420 
$this
->
ex´essiÚs
[
$Ex´ID
] = 
	`¬¿y
(

421 'cŞumn' => 
$ûÎA‰ribu‹s
->
CŞ
,

422 'row' => 
$ûÎA‰ribu‹s
->
Row
,

423 'fÜmuÏ' => (
¡ršg
è
$ûÎ


427 
$ex´essiÚ
 = 
$this
->
ex´essiÚs
[
$Ex´ID
];

429 
$ûÎ
 = 
$this
->
»ã»nûH–³r
->
	`upd©eFÜmuÏReã»nûs
(

430 
$ex´essiÚ
['formula'],

432 
$ûÎA‰ribu‹s
->
CŞ
 - 
$ex´essiÚ
['column'],

433 
$ûÎA‰ribu‹s
->
Row
 - 
$ex´essiÚ
['row'],

434 
$wÜksh“tName


439 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
;

441 
$V®ueTy³
) {

443 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
;

446 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
;

447 
$ûÎ
 = ($ûÎ =ğ'TRUE'è? 
Œue
: 
çl£
;

450 
$ûÎ
 = 
	`štv®
($cell);

453 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

456 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_ERROR
;

459 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

465 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘C–l
(
$cŞumn
.
$row
)->
	`£tV®ueEx¶ic™
(
$ûÎ
, 
$ty³
);

468 ià((!
$this
->
»adD©aOÆy
è&& (
	`is£t
(
$sh“t
->
Objeùs
))) {

469 
	`fÜ—ch
 (
$sh“t
->
Objeùs
->
	`chd»n
('gnm', 
Œue
è
as
 
$key
 => 
$comm’t
) {

470 
$comm’tA‰ribu‹s
 = 
$comm’t
->
	`©Œibu‹s
();

472 ià(
$comm’tA‰ribu‹s
->
Text
) {

473 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘Comm’t
((
¡ršg
)
$comm’tA‰ribu‹s
->
ObjeùBound
)->
	`£tAuthÜ
((¡ršg)$comm’tA‰ribu‹s->
AuthÜ
)->
	`£tText
(
$this
->
	`·r£RichText
((¡ršg)$comm’tA‰ribu‹s->
Text
));

479 
	`fÜ—ch
 (
$sh“t
->
StyËs
->
StyËRegiÚ
 
as
 
$¡yËRegiÚ
) {

480 
$¡yËA‰ribu‹s
 = 
$¡yËRegiÚ
->
	`©Œibu‹s
();

481 ià((
$¡yËA‰ribu‹s
['¡¬tRow'] <ğ
$maxRow
) &&

482 (
$¡yËA‰ribu‹s
['¡¬tCŞ'] <ğ
$maxCŞ
)) {

483 
$¡¬tCŞumn
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
((è
$¡yËA‰ribu‹s
['startCol']);

484 
$¡¬tRow
 = 
$¡yËA‰ribu‹s
['startRow'] + 1;

486 
$’dCŞumn
 = (
$¡yËA‰ribu‹s
['’dCŞ'] > 
$maxCŞ
) ? $maxCol : () $styleAttributes['endCol'];

487 
$’dCŞumn
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($endColumn);

488 
$’dRow
 = (
$¡yËA‰ribu‹s
['’dRow'] > 
$maxRow
) ? $maxRow : $styleAttributes['endRow'];

489 
$’dRow
 += 1;

490 
$ûÎRªge
 = 
$¡¬tCŞumn
.
$¡¬tRow
.':'.
$’dCŞumn
.
$’dRow
;

493 
$¡yËA‰ribu‹s
 = 
$¡yËRegiÚ
->
StyË
->
	`©Œibu‹s
();

498 ià((!
$this
->
»adD©aOÆy
) ||

499 (
PHPExûl_Sh¬ed_D©e
::
	`isD©eTimeFÜm©Code
((
¡ršg
è
$¡yËA‰ribu‹s
['Format']))) {

500 
$¡yËA¼ay
 = 
	`¬¿y
();

501 
$¡yËA¼ay
['numb”fÜm©']['code'] = (
¡ršg
è
$¡yËA‰ribu‹s
['Format'];

503 ià(!
$this
->
»adD©aOÆy
) {

504 
$¡yËA‰ribu‹s
['HAlign']) {

506 
$¡yËA¼ay
['®ignm’t']['hÜizÚl'] = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
;

509 
$¡yËA¼ay
['®ignm’t']['hÜizÚl'] = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_LEFT
;

512 
$¡yËA¼ay
['®ignm’t']['hÜizÚl'] = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_RIGHT
;

515 
$¡yËA¼ay
['®ignm’t']['hÜizÚl'] = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER
;

519 
$¡yËA¼ay
['®ignm’t']['hÜizÚl'] = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER_CONTINUOUS
;

522 
$¡yËA¼ay
['®ignm’t']['hÜizÚl'] = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_JUSTIFY
;

526 
$¡yËA‰ribu‹s
['VAlign']) {

528 
$¡yËA¼ay
['®ignm’t']['v”tiÿl'] = 
PHPExûl_StyË_Alignm’t
::
VERTICAL_TOP
;

531 
$¡yËA¼ay
['®ignm’t']['v”tiÿl'] = 
PHPExûl_StyË_Alignm’t
::
VERTICAL_BOTTOM
;

534 
$¡yËA¼ay
['®ignm’t']['v”tiÿl'] = 
PHPExûl_StyË_Alignm’t
::
VERTICAL_CENTER
;

537 
$¡yËA¼ay
['®ignm’t']['v”tiÿl'] = 
PHPExûl_StyË_Alignm’t
::
VERTICAL_JUSTIFY
;

541 
$¡yËA¼ay
['®ignm’t']['w¿p'] = (
$¡yËA‰ribu‹s
['W¿pText'] =ğ'1'è? 
Œue
 : 
çl£
;

542 
$¡yËA¼ay
['®ignm’t']['shrškToF™'] = (
$¡yËA‰ribu‹s
['ShrškToF™'] =ğ'1'è? 
Œue
 : 
çl£
;

543 
$¡yËA¼ay
['®ignm’t']['šd’t'] = (
	`štv®
(
$¡yËA‰ribu‹s
["Indent"]) > 0) ? $styleAttributes["indent"] : 0;

545 
$RGB
 = 
£lf
::
	`·r£Gnum”icCŞour
(
$¡yËA‰ribu‹s
["Fore"]);

546 
$¡yËA¼ay
['fÚt']['cŞÜ']['rgb'] = 
$RGB
;

547 
$RGB
 = 
£lf
::
	`·r£Gnum”icCŞour
(
$¡yËA‰ribu‹s
["Back"]);

548 
$shade
 = 
$¡yËA‰ribu‹s
["Shade"];

549 ià((
$RGB
 !ğ'000000'è|| (
$shade
 != '0')) {

550 
$¡yËA¼ay
['fl']['cŞÜ']['rgb'] = $¡yËA¼ay['fl']['¡¬tcŞÜ']['rgb'] = 
$RGB
;

551 
$RGB2
 = 
£lf
::
	`·r£Gnum”icCŞour
(
$¡yËA‰ribu‹s
["PatternColor"]);

552 
$¡yËA¼ay
['fl']['’dcŞÜ']['rgb'] = 
$RGB2
;

553 
$shade
) {

555 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_SOLID
;

558 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_GRADIENT_LINEAR
;

561 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_GRADIENT_PATH
;

564 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKDOWN
;

567 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKGRAY
;

570 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKGRID
;

573 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKHORIZONTAL
;

576 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKTRELLIS
;

579 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKUP
;

582 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKVERTICAL
;

585 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_GRAY0625
;

588 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_GRAY125
;

591 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTDOWN
;

594 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTGRAY
;

597 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTGRID
;

600 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTHORIZONTAL
;

603 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTTRELLIS
;

606 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTUP
;

609 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTVERTICAL
;

612 
$¡yËA¼ay
['fl']['ty³'] = 
PHPExûl_StyË_Fl
::
FILL_PATTERN_MEDIUMGRAY
;

617 
$fÚtA‰ribu‹s
 = 
$¡yËRegiÚ
->
StyË
->
FÚt
->
	`©Œibu‹s
();

620 
$¡yËA¼ay
['fÚt']['Çme'] = (
¡ršg
è
$¡yËRegiÚ
->
StyË
->
FÚt
;

621 
$¡yËA¼ay
['fÚt']['size'] = 
	`štv®
(
$fÚtA‰ribu‹s
['Unit']);

622 
$¡yËA¼ay
['fÚt']['bŞd'] = (
$fÚtA‰ribu‹s
['BŞd'] =ğ'1'è? 
Œue
 : 
çl£
;

623 
$¡yËA¼ay
['fÚt']['™®ic'] = (
$fÚtA‰ribu‹s
['Ilic'] =ğ'1'è? 
Œue
 : 
çl£
;

624 
$¡yËA¼ay
['fÚt']['¡rike'] = (
$fÚtA‰ribu‹s
['SŒikeThrough'] =ğ'1'è? 
Œue
 : 
çl£
;

625 
$fÚtA‰ribu‹s
['Underline']) {

627 
$¡yËA¼ay
['fÚt']['und”lše'] = 
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLE
;

630 
$¡yËA¼ay
['fÚt']['und”lše'] = 
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLE
;

633 
$¡yËA¼ay
['fÚt']['und”lše'] = 
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLEACCOUNTING
;

636 
$¡yËA¼ay
['fÚt']['und”lše'] = 
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLEACCOUNTING
;

639 
$¡yËA¼ay
['fÚt']['und”lše'] = 
PHPExûl_StyË_FÚt
::
UNDERLINE_NONE
;

642 
$fÚtA‰ribu‹s
['Script']) {

644 
$¡yËA¼ay
['fÚt']['su³rSüt'] = 
Œue
;

647 
$¡yËA¼ay
['fÚt']['subSüt'] = 
Œue
;

651 ià(
	`is£t
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
)) {

652 ià(
	`is£t
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
Tİ
)) {

653 
$¡yËA¼ay
['bÜd”s']['tİ'] = 
£lf
::
	`·r£BÜd”A‰ribu‹s
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
Tİ
->
	`©Œibu‹s
());

655 ià(
	`is£t
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
BÙtom
)) {

656 
$¡yËA¼ay
['bÜd”s']['bÙtom'] = 
£lf
::
	`·r£BÜd”A‰ribu‹s
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
BÙtom
->
	`©Œibu‹s
());

658 ià(
	`is£t
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
Leá
)) {

659 
$¡yËA¼ay
['bÜd”s']['Ëá'] = 
£lf
::
	`·r£BÜd”A‰ribu‹s
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
Leá
->
	`©Œibu‹s
());

661 ià(
	`is£t
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
Right
)) {

662 
$¡yËA¼ay
['bÜd”s']['right'] = 
£lf
::
	`·r£BÜd”A‰ribu‹s
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
Right
->
	`©Œibu‹s
());

664 ià((
	`is£t
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
DŸgÚ®
)) && (isset($styleRegion->Style->StyleBorder->{'Rev-Diagonal'}))) {

665 
$¡yËA¼ay
['bÜd”s']['dŸgÚ®'] = 
£lf
::
	`·r£BÜd”A‰ribu‹s
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
DŸgÚ®
->
	`©Œibu‹s
());

666 
$¡yËA¼ay
['bÜd”s']['dŸgÚ®dœeùiÚ'] = 
PHPExûl_StyË_BÜd”s
::
DIAGONAL_BOTH
;

667 } 
	`–£if
 (
	`is£t
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
DŸgÚ®
)) {

668 
$¡yËA¼ay
['bÜd”s']['dŸgÚ®'] = 
£lf
::
	`·r£BÜd”A‰ribu‹s
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->
DŸgÚ®
->
	`©Œibu‹s
());

669 
$¡yËA¼ay
['bÜd”s']['dŸgÚ®dœeùiÚ'] = 
PHPExûl_StyË_BÜd”s
::
DIAGONAL_UP
;

670 } 
	`–£if
 (
	`is£t
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->{'Rev-Diagonal'})) {

671 
$¡yËA¼ay
['bÜd”s']['dŸgÚ®'] = 
£lf
::
	`·r£BÜd”A‰ribu‹s
(
$¡yËRegiÚ
->
StyË
->
StyËBÜd”
->{'Rev-DŸgÚ®'}->
	`©Œibu‹s
());

672 
$¡yËA¼ay
['bÜd”s']['dŸgÚ®dœeùiÚ'] = 
PHPExûl_StyË_BÜd”s
::
DIAGONAL_DOWN
;

675 ià(
	`is£t
(
$¡yËRegiÚ
->
StyË
->
Hy³rLšk
)) {

677 
$hy³¾šk
 = 
$¡yËRegiÚ
->
StyË
->
Hy³rLšk
->
	`©Œibu‹s
();

682 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘StyË
(
$ûÎRªge
)->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

687 ià((!
$this
->
»adD©aOÆy
è&& (
	`is£t
(
$sh“t
->
CŞs
))) {

689 
$cŞumnA‰ribu‹s
 = 
$sh“t
->
CŞs
->
	`©Œibu‹s
();

690 
$deçuÉWidth
 = 
$cŞumnA‰ribu‹s
['DefaultSizePts'] / 5.4;

691 
$c
 = 0;

692 
	`fÜ—ch
 (
$sh“t
->
CŞs
->
CŞInfo
 
as
 
$cŞumnOv”ride
) {

693 
$cŞumnA‰ribu‹s
 = 
$cŞumnOv”ride
->
	`©Œibu‹s
();

694 
$cŞumn
 = 
$cŞumnA‰ribu‹s
['No'];

695 
$cŞumnWidth
 = 
$cŞumnA‰ribu‹s
['Unit'] / 5.4;

696 
$hidd’
 = ((
	`is£t
(
$cŞumnA‰ribu‹s
['Hidd’'])è&& ($cŞumnA‰ribu‹s['Hidd’'] =ğ'1')è? 
Œue
 : 
çl£
;

697 
$cŞumnCouÁ
 = (
	`is£t
(
$cŞumnA‰ribu‹s
['Count'])) ? $columnAttributes['Count'] : 1;

698 
$c
 < 
$cŞumn
) {

699 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘CŞumnDim’siÚ
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$c
))->
	`£tWidth
(
$deçuÉWidth
);

700 ++
$c
;

702 (
$c
 < (
$cŞumn
+
$cŞumnCouÁ
)è&& ($ø<ğ
$maxCŞ
)) {

703 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘CŞumnDim’siÚ
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$c
))->
	`£tWidth
(
$cŞumnWidth
);

704 ià(
$hidd’
) {

705 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘CŞumnDim’siÚ
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$c
))->
	`£tVisibË
(
çl£
);

707 ++
$c
;

710 
$c
 <ğ
$maxCŞ
) {

711 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘CŞumnDim’siÚ
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$c
))->
	`£tWidth
(
$deçuÉWidth
);

712 ++
$c
;

716 ià((!
$this
->
»adD©aOÆy
è&& (
	`is£t
(
$sh“t
->
Rows
))) {

718 
$rowA‰ribu‹s
 = 
$sh“t
->
Rows
->
	`©Œibu‹s
();

719 
$deçuÉHeight
 = 
$rowA‰ribu‹s
['DefaultSizePts'];

720 
$r
 = 0;

722 
	`fÜ—ch
 (
$sh“t
->
Rows
->
RowInfo
 
as
 
$rowOv”ride
) {

723 
$rowA‰ribu‹s
 = 
$rowOv”ride
->
	`©Œibu‹s
();

724 
$row
 = 
$rowA‰ribu‹s
['No'];

725 
$rowHeight
 = 
$rowA‰ribu‹s
['Unit'];

726 
$hidd’
 = ((
	`is£t
(
$rowA‰ribu‹s
['Hidd’'])è&& ($rowA‰ribu‹s['Hidd’'] =ğ'1')è? 
Œue
 : 
çl£
;

727 
$rowCouÁ
 = (
	`is£t
(
$rowA‰ribu‹s
['Count'])) ? $rowAttributes['Count'] : 1;

728 
$r
 < 
$row
) {

729 ++
$r
;

730 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘RowDim’siÚ
(
$r
)->
	`£tRowHeight
(
$deçuÉHeight
);

732 (
$r
 < (
$row
+
$rowCouÁ
)è&& ($¸< 
$maxRow
)) {

733 ++
$r
;

734 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘RowDim’siÚ
(
$r
)->
	`£tRowHeight
(
$rowHeight
);

735 ià(
$hidd’
) {

736 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘RowDim’siÚ
(
$r
)->
	`£tVisibË
(
çl£
);

740 
$r
 < 
$maxRow
) {

741 ++
$r
;

742 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘RowDim’siÚ
(
$r
)->
	`£tRowHeight
(
$deçuÉHeight
);

747 ià(
	`is£t
(
$sh“t
->
M”gedRegiÚs
)) {

748 
	`fÜ—ch
 (
$sh“t
->
M”gedRegiÚs
->
M”ge
 
as
 
$m”geC–ls
) {

749 ià(
	`¡½os
(
$m”geC–ls
, ':'è!=ğ
çl£
) {

750 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`m”geC–ls
(
$m”geC–ls
);

755 
$wÜksh“tID
++;

759 ià(
	`is£t
(
$gnmXML
->
Names
)) {

760 
	`fÜ—ch
 (
$gnmXML
->
Names
->
Name
 
as
 
$ÇmedRªge
) {

761 
$Çme
 = (
¡ršg
è
$ÇmedRªge
->
Çme
;

762 
$¿nge
 = (
¡ršg
è
$ÇmedRªge
->
v®ue
;

763 ià(
	`¡ros
(
$¿nge
, '#REF!'è!=ğ
çl£
) {

767 
$¿nge
 = 
	`ex¶ode
('!', $range);

768 
$¿nge
[0] = 
	`Œim
($range[0], "'");

769 ià(
$wÜksh“t
 = 
$objPHPExûl
->
	`g‘Sh“tByName
(
$¿nge
[0])) {

770 
$exŒaùedRªge
 = 
	`¡r_»¶aû
('$', '', 
$¿nge
[1]);

771 
$objPHPExûl
->
	`addNamedRªge
(
Ãw
 
	`PHPExûl_NamedRªge
(
$Çme
, 
$wÜksh“t
, 
$exŒaùedRªge
));

777  
$objPHPExûl
;

778 
	}
}

780 
´iv©e
 
funùiÚ
 
	$·r£BÜd”A‰ribu‹s
(
$bÜd”A‰ribu‹s
)

782 
$¡yËA¼ay
 = 
	`¬¿y
();

783 ià(
	`is£t
(
$bÜd”A‰ribu‹s
["Color"])) {

784 
$¡yËA¼ay
['cŞÜ']['rgb'] = 
£lf
::
	`·r£Gnum”icCŞour
(
$bÜd”A‰ribu‹s
["Color"]);

787 
$bÜd”A‰ribu‹s
["Style"]) {

789 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
;

792 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
;

795 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
;

798 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_SLANTDASHDOT
;

801 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_DASHED
;

804 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_THICK
;

807 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_DOUBLE
;

810 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_DOTTED
;

813 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHED
;

816 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOT
;

819 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOT
;

822 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOTDOT
;

825 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOTDOT
;

828 
$¡yËA¼ay
['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOTDOT
;

831  
$¡yËA¼ay
;

832 
	}
}

834 
´iv©e
 
funùiÚ
 
·r£RichText
(
$is
 = '')

836 
$v®ue
 = 
Ãw
 
PHPExûl_RichText
();

837 
	g$v®ue
->
ü—‹Text
(
$is
);

839  
	g$v®ue
;

842 
´iv©e
 
funùiÚ
 
	$·r£Gnum”icCŞour
(
$gnmCŞour
)

844 
	`li¡
(
$gnmR
, 
$gnmG
, 
$gnmB
èğ
	`ex¶ode
(':', 
$gnmCŞour
);

845 
$gnmR
 = 
	`sub¡r
(
	`¡r_·d
($gnmR, 4, '0', 
STR_PAD_RIGHT
), 0, 2);

846 
$gnmG
 = 
	`sub¡r
(
	`¡r_·d
($gnmG, 4, '0', 
STR_PAD_RIGHT
), 0, 2);

847 
$gnmB
 = 
	`sub¡r
(
	`¡r_·d
($gnmB, 4, '0', 
STR_PAD_RIGHT
), 0, 2);

848  
$gnmR
 . 
$gnmG
 . 
$gnmB
;

849 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/HTML.php

1 <?
php


3 ià(!
defšed
('PHPEXCEL_ROOT')) {

7 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

8 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_R—d”_HTML
 
ex‹nds
 
PHPExûl_R—d”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_R—d”_IR—d”


45 
´Ùeùed
 
	m$šputEncodšg
 = 'ANSI';

52 
´Ùeùed
 
	m$sh“tIndex
 = 0;

59 
´Ùeùed
 
	m$fÜm©s
 = 
¬¿y
(

60 'h1' => 
¬¿y
(

61 'fÚt' => 
¬¿y
(

62 'bŞd' => 
Œue
,

66 'h2' => 
¬¿y
(

67 'fÚt' => 
¬¿y
(

68 'bŞd' => 
Œue
,

72 'h3' => 
¬¿y
(

73 'fÚt' => 
¬¿y
(

74 'bŞd' => 
Œue
,

78 'h4' => 
¬¿y
(

79 'fÚt' => 
¬¿y
(

80 'bŞd' => 
Œue
,

84 'h5' => 
¬¿y
(

85 'fÚt' => 
¬¿y
(

86 'bŞd' => 
Œue
,

90 'h6' => 
¬¿y
(

91 'fÚt' => 
¬¿y
(

92 'bŞd' => 
Œue
,

96 'a' => 
¬¿y
(

97 'fÚt' => 
¬¿y
(

98 'und”lše' => 
Œue
,

99 'cŞÜ' => 
¬¿y
(

100 '¬gb' => 
PHPExûl_StyË_CŞÜ
::
COLOR_BLUE
,

104 'hr' => 
¬¿y
(

105 'bÜd”s' => 
¬¿y
(

106 'bÙtom' => 
¬¿y
(

107 '¡yË' => 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
,

108 'cŞÜ' => 
¬¿y
(

109 
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK
,

116 
´Ùeùed
 
	m$row¥ª
 = 
¬¿y
();

121 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

123 
$this
->
»adF‹r
 = 
Ãw
 
	`PHPExûl_R—d”_DeçuÉR—dF‹r
();

131 
´Ùeùed
 
funùiÚ
 
	$isV®idFÜm©
()

134 
$d©a
 = 
	`ä—d
(
$this
->
feHªdË
, 2048);

135 ià((
	`¡½os
(
$d©a
, '<'è!=ğ
çl£
) &&

136 (
	`¡¾’
(
$d©a
è!=ğ¡¾’(
	`¡r_gs
($data)))) {

137  
Œue
;

140  
çl£
;

141 
	}
}

150 
public
 
funùiÚ
 
	$lßd
(
$pF’ame
)

153 
$objPHPExûl
 = 
Ãw
 
	`PHPExûl
();

156  
$this
->
	`lßdIÁoExi¡šg
(
$pF’ame
, 
$objPHPExûl
);

157 
	}
}

164 
public
 
funùiÚ
 
£tIÅutEncodšg
(
$pV®ue
 = 'ANSI')

166 
$this
->
šputEncodšg
 = 
$pV®ue
;

168  
	g$this
;

176 
public
 
funùiÚ
 
	$g‘IÅutEncodšg
()

178  
$this
->
šputEncodšg
;

179 
	}
}

182 
´Ùeùed
 
	g$d©aA¼ay
 = 
¬¿y
();

183 
´Ùeùed
 
	g$bËLev–
 = 0;

184 
´Ùeùed
 
	g$Ã¡edCŞumn
 = 
¬¿y
('A');

186 
´Ùeùed
 
funùiÚ
 
	$£tTabËS¹CŞumn
(
$cŞumn
)

188 ià(
$this
->
bËLev–
 == 0) {

189 
$cŞumn
 = 'A';

191 ++
$this
->
bËLev–
;

192 
$this
->
Ã¡edCŞumn
[$this->
bËLev–
] = 
$cŞumn
;

194  
$this
->
Ã¡edCŞumn
[$this->
bËLev–
];

195 
	}
}

197 
´Ùeùed
 
funùiÚ
 
	$g‘TabËS¹CŞumn
()

199  
$this
->
Ã¡edCŞumn
[$this->
bËLev–
];

200 
	}
}

202 
´Ùeùed
 
funùiÚ
 
	$»Ëa£TabËS¹CŞumn
()

204 --
$this
->
bËLev–
;

206  
	`¬¿y_pİ
(
$this
->
Ã¡edCŞumn
);

207 
	}
}

209 
´Ùeùed
 
funùiÚ
 
	$æushC–l
(
$sh“t
, 
$cŞumn
, 
$row
, &
$ûÎCÚ‹Á
)

211 ià(
	`is_¡ršg
(
$ûÎCÚ‹Á
)) {

213 ià(
	`Œim
(
$ûÎCÚ‹Á
) > '') {

218 
$sh“t
->
	`£tC–lV®ue
(
$cŞumn
 . 
$row
, 
$ûÎCÚ‹Á
, 
Œue
);

219 
$this
->
d©aA¼ay
[
$row
][
$cŞumn
] = 
$ûÎCÚ‹Á
;

224 
$this
->
d©aA¼ay
[
$row
][
$cŞumn
] = 'RICH TEXT: ' . 
$ûÎCÚ‹Á
;

226 
$ûÎCÚ‹Á
 = (
¡ršg
) '';

227 
	}
}

229 
´Ùeùed
 
funùiÚ
 
	$´oûssDomEËm’t
(
DOMNode
 
$–em’t
, 
$sh“t
, &
$row
, &
$cŞumn
, &
$ûÎCÚ‹Á
, 
$fÜm©
 = 
nuÎ
)

231 
	`fÜ—ch
 (
$–em’t
->
chdNodes
 
as
 
$chd
) {

232 ià(
$chd
 
š¡ªûof
 
DOMText
) {

233 
$domText
 = 
	`´eg_»¶aû
('/\s+/u', ' ', 
	`Œim
(
$chd
->
nodeV®ue
));

234 ià(
	`is_¡ršg
(
$ûÎCÚ‹Á
)) {

236 
$ûÎCÚ‹Á
 .ğ
$domText
;

241 } 
	`–£if
 (
$chd
 
š¡ªûof
 
DOMEËm’t
) {

244 
$©Œibu‹A¼ay
 = 
	`¬¿y
();

245 
	`fÜ—ch
 (
$chd
->
©Œibu‹s
 
as
 
$©Œibu‹
) {

247 
$©Œibu‹A¼ay
[
$©Œibu‹
->
Çme
] = $©Œibu‹->
v®ue
;

250 
$chd
->
nodeName
) {

252 
	`fÜ—ch
 (
$©Œibu‹A¼ay
 
as
 
$©Œibu‹Name
 => 
$©Œibu‹V®ue
) {

253 
$©Œibu‹Name
) {

260 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

263 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

264 
$sh“t
->
	`£tT™Ë
(
$ûÎCÚ‹Á
);

265 
$ûÎCÚ‹Á
 = '';

275 ià(
$ûÎCÚ‹Á
 > '') {

276 
$ûÎCÚ‹Á
 .= ' ';

278 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

279 ià(
$ûÎCÚ‹Á
 > '') {

280 
$ûÎCÚ‹Á
 .= ' ';

285 
$this
->
	`æushC–l
(
$sh“t
, 
$cŞumn
, 
$row
, 
$ûÎCÚ‹Á
);

286 ++
$row
;

287 ià(
	`is£t
(
$this
->
fÜm©s
[
$chd
->
nodeName
])) {

288 
$sh“t
->
	`g‘StyË
(
$cŞumn
 . 
$row
)->
	`­¶yFromA¼ay
(
$this
->
fÜm©s
[
$chd
->
nodeName
]);

290 
$ûÎCÚ‹Á
 = '----------';

291 
$this
->
	`æushC–l
(
$sh“t
, 
$cŞumn
, 
$row
, 
$ûÎCÚ‹Á
);

293 ++
$row
;

296 ià(
$this
->
bËLev–
 > 0) {

298 
$ûÎCÚ‹Á
 .= "\n";

301 
$this
->
	`æushC–l
(
$sh“t
, 
$cŞumn
, 
$row
, 
$ûÎCÚ‹Á
);

302 ++
$row
;

308 
	`fÜ—ch
 (
$©Œibu‹A¼ay
 
as
 
$©Œibu‹Name
 => 
$©Œibu‹V®ue
) {

309 
$©Œibu‹Name
) {

312 
$sh“t
->
	`g‘C–l
(
$cŞumn
 . 
$row
)->
	`g‘Hy³¾šk
()->
	`£tU¾
(
$©Œibu‹V®ue
);

313 ià(
	`is£t
(
$this
->
fÜm©s
[
$chd
->
nodeName
])) {

314 
$sh“t
->
	`g‘StyË
(
$cŞumn
 . 
$row
)->
	`­¶yFromA¼ay
(
$this
->
fÜm©s
[
$chd
->
nodeName
]);

319 
$ûÎCÚ‹Á
 .= ' ';

320 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

332 ià(
$this
->
bËLev–
 > 0) {

334 
$ûÎCÚ‹Á
 .= "\n";

336 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

339 ià(
$ûÎCÚ‹Á
 > '') {

340 
$this
->
	`æushC–l
(
$sh“t
, 
$cŞumn
, 
$row
, 
$ûÎCÚ‹Á
);

341 
$row
++;

344 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

346 
$this
->
	`æushC–l
(
$sh“t
, 
$cŞumn
, 
$row
, 
$ûÎCÚ‹Á
);

348 ià(
	`is£t
(
$this
->
fÜm©s
[
$chd
->
nodeName
])) {

349 
$sh“t
->
	`g‘StyË
(
$cŞumn
 . 
$row
)->
	`­¶yFromA¼ay
(
$this
->
fÜm©s
[
$chd
->
nodeName
]);

352 
$row
++;

353 
$cŞumn
 = 'A';

357 ià(
$this
->
bËLev–
 > 0) {

359 
$ûÎCÚ‹Á
 .= "\n";

361 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

364 ià(
$ûÎCÚ‹Á
 > '') {

365 
$this
->
	`æushC–l
(
$sh“t
, 
$cŞumn
, 
$row
, 
$ûÎCÚ‹Á
);

367 ++
$row
;

369 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

371 
$this
->
	`æushC–l
(
$sh“t
, 
$cŞumn
, 
$row
, 
$ûÎCÚ‹Á
);

372 
$cŞumn
 = 'A';

376 
$this
->
	`æushC–l
(
$sh“t
, 
$cŞumn
, 
$row
, 
$ûÎCÚ‹Á
);

377 
$cŞumn
 = 
$this
->
	`£tTabËS¹CŞumn
($column);

379 ià(
$this
->
bËLev–
 > 1) {

380 --
$row
;

382 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

384 
$cŞumn
 = 
$this
->
	`»Ëa£TabËS¹CŞumn
();

385 ià(
$this
->
bËLev–
 > 1) {

386 ++
$cŞumn
;

388 ++
$row
;

393 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

396 
$cŞumn
 = 
$this
->
	`g‘TabËS¹CŞumn
();

397 
$ûÎCÚ‹Á
 = '';

399 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

400 ++
$row
;

406 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

409 
	`is£t
(
$this
->
row¥ª
[
$cŞumn
 . 
$row
])) {

410 ++
$cŞumn
;

413 
$this
->
	`æushC–l
(
$sh“t
, 
$cŞumn
, 
$row
, 
$ûÎCÚ‹Á
);

423 ià(
	`is£t
(
$©Œibu‹A¼ay
['rowspan']) && isset($attributeArray['colspan'])) {

425 
$cŞumnTo
 = 
$cŞumn
;

426 
$i
 = 0; $˜< 
$©Œibu‹A¼ay
['colspan'] - 1; $i++) {

427 ++
$cŞumnTo
;

429 
$¿nge
 = 
$cŞumn
 . 
$row
 . ':' . 
$cŞumnTo
 . ($row + 
$©Œibu‹A¼ay
['rowspan'] - 1);

430 
	`fÜ—ch
 (\
PHPExûl_C–l
::
	`exŒaùAÎC–lReã»nûsInRªge
(
$¿nge
è
as
 
$v®ue
) {

431 
$this
->
row¥ª
[
$v®ue
] = 
Œue
;

433 
$sh“t
->
	`m”geC–ls
(
$¿nge
);

434 
$cŞumn
 = 
$cŞumnTo
;

435 } 
	`–£if
 (
	`is£t
(
$©Œibu‹A¼ay
['rowspan'])) {

437 
$¿nge
 = 
$cŞumn
 . 
$row
 . ':' . $cŞumÀ. ($row + 
$©Œibu‹A¼ay
['rowspan'] - 1);

438 
	`fÜ—ch
 (\
PHPExûl_C–l
::
	`exŒaùAÎC–lReã»nûsInRªge
(
$¿nge
è
as
 
$v®ue
) {

439 
$this
->
row¥ª
[
$v®ue
] = 
Œue
;

441 
$sh“t
->
	`m”geC–ls
(
$¿nge
);

442 } 
	`–£if
 (
	`is£t
(
$©Œibu‹A¼ay
['colspan'])) {

444 
$cŞumnTo
 = 
$cŞumn
;

445 
$i
 = 0; $˜< 
$©Œibu‹A¼ay
['colspan'] - 1; $i++) {

446 ++
$cŞumnTo
;

448 
$sh“t
->
	`m”geC–ls
(
$cŞumn
 . 
$row
 . ':' . 
$cŞumnTo
 . $row);

449 
$cŞumn
 = 
$cŞumnTo
;

451 ++
$cŞumn
;

454 
$row
 = 1;

455 
$cŞumn
 = 'A';

456 
$cÚ‹Á
 = '';

457 
$this
->
bËLev–
 = 0;

458 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

461 
$this
->
	`´oûssDomEËm’t
(
$chd
, 
$sh“t
, 
$row
, 
$cŞumn
, 
$ûÎCÚ‹Á
);

465 
	}
}

475 
public
 
funùiÚ
 
	$lßdIÁoExi¡šg
(
$pF’ame
, 
PHPExûl
 
$objPHPExûl
)

478 
$this
->
	`İ’Fe
(
$pF’ame
);

479 ià(!
$this
->
	`isV®idFÜm©
()) {

480 
	`fşo£
(
$this
->
feHªdË
);

481 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
(
$pF’ame
 . " is‡n Invalid HTML file.");

484 
	`fşo£
(
$this
->
feHªdË
);

487 
$objPHPExûl
->
	`g‘Sh“tCouÁ
(è<ğ
$this
->
sh“tIndex
) {

488 
$objPHPExûl
->
	`ü—‹Sh“t
();

490 
$objPHPExûl
->
	`£tAùiveSh“tIndex
(
$this
->
sh“tIndex
);

493 
$dom
 = 
Ãw
 
domDocum’t
;

495 
$lßded
 = 
$dom
->
	`lßdHTML
(
$this
->
	`£cur™ySÿnFe
(
$pF’ame
));

496 ià(
$lßded
 ==ğ
çl£
) {

497 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('FaedØlßd ', 
$pF’ame
, '‡s‡ DOM Document');

501 
$dom
->
´e£rveWh™eS·û
 = 
çl£
;

503 
$row
 = 0;

504 
$cŞumn
 = 'A';

505 
$cÚ‹Á
 = '';

506 
$this
->
	`´oûssDomEËm’t
(
$dom
, 
$objPHPExûl
->
	`g‘AùiveSh“t
(), 
$row
, 
$cŞumn
, 
$cÚ‹Á
);

509  
$objPHPExûl
;

510 
	}
}

517 
public
 
funùiÚ
 
	$g‘Sh“tIndex
()

519  
$this
->
sh“tIndex
;

520 
	}
}

528 
public
 
funùiÚ
 
	$£tSh“tIndex
(
$pV®ue
 = 0)

530 
$this
->
sh“tIndex
 = 
$pV®ue
;

532  
$this
;

533 
	}
}

541 
public
 
funùiÚ
 
	$£cur™ySÿn
(
$xml
)

543 
$·‰”n
 = '/\\0?' . 
	`im¶ode
('\\0?', 
	`¡r_¥l™
('<!ENTITY')) . '\\0?/';

544 ià(
	`´eg_m©ch
(
$·‰”n
, 
$xml
)) {

545 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Detected use of ENTITY in XML, spreadsheet file†oad()‡bortedo…revent XXE/XEE‡ttacks');

547  
$xml
;

548 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/IReadFilter.php

1 <?
php


28 
š‹rçû
 
	gPHPExûl_R—d”_IR—dF‹r


38 
public
 
funùiÚ
 
»adC–l
(
$cŞumn
, 
$row
, 
$wÜksh“tName
 = '');

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/IReader.php

1 <?
php


28 
š‹rçû
 
	gPHPExûl_R—d”_IR—d”


36 
public
 
funùiÚ
 
ÿnR—d
(
$pF’ame
);

45 
public
 
funùiÚ
 
lßd
(
$pF’ame
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/OOCalc.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_R—d”_OOC®c
 
ex‹nds
 
PHPExûl_R—d”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_R—d”_IR—d”


44 
´iv©e
 
	m$¡yËs
 = 
¬¿y
();

49 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

51 
$this
->
»adF‹r
 = 
Ãw
 
	`PHPExûl_R—d”_DeçuÉR—dF‹r
();

61 
public
 
funùiÚ
 
	$ÿnR—d
(
$pF’ame
)

64 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

65 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

68 
$zCÏss
 = 
PHPExûl_S‘tšgs
::
	`g‘ZCÏss
();

75 
$mimeTy³
 = 'UNKNOWN';

77 
$z
 = 
Ãw
 
$zCÏss
;

78 ià(
$z
->
	`İ’
(
$pF’ame
è==ğ
Œue
) {

80 
$¡©
 = 
$z
->
	`¡©Name
('mimetype');

81 ià(
$¡©
 && ($stat['size'] <= 255)) {

82 
$mimeTy³
 = 
$z
->
	`g‘FromName
(
$¡©
['name']);

83 } 
	`–£if
 (
$¡©
 = 
$z
->
	`¡©Name
('META-INF/manifest.xml')) {

84 
$xml
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
(
$z
->
	`g‘FromName
('META-INF/mªiã¡.xml')), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

85 
$Çme¥aûsCÚ‹Á
 = 
$xml
->
	`g‘Name¥aûs
(
Œue
);

86 ià(
	`is£t
(
$Çme¥aûsCÚ‹Á
['manifest'])) {

87 
$mªiã¡
 = 
$xml
->
	`chd»n
(
$Çme¥aûsCÚ‹Á
['manifest']);

88 
	`fÜ—ch
 (
$mªiã¡
 
as
 
$mªiã¡D©aS‘
) {

89 
$mªiã¡A‰ribu‹s
 = 
$mªiã¡D©aS‘
->
	`©Œibu‹s
(
$Çme¥aûsCÚ‹Á
['manifest']);

90 ià(
$mªiã¡A‰ribu‹s
->{'full-path'} == '/') {

91 
$mimeTy³
 = (
¡ršg
è
$mªiã¡A‰ribu‹s
->{'media-type'};

98 
$z
->
	`şo£
();

100  (
$mimeTy³
 === 'application/vnd.oasis.opendocument.spreadsheet');

103  
çl£
;

104 
	}
}

113 
public
 
funùiÚ
 
	$li¡WÜksh“tNames
(
$pF’ame
)

116 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

117 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

120 
$zCÏss
 = 
PHPExûl_S‘tšgs
::
	`g‘ZCÏss
();

122 
$z
 = 
Ãw
 
$zCÏss
;

123 ià(!
$z
->
	`İ’
(
$pF’ame
)) {

124 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! Error opening file.");

127 
$wÜksh“tNames
 = 
	`¬¿y
();

129 
$xml
 = 
Ãw
 
	`XMLR—d”
();

130 
$»s
 = 
$xml
->
	`xml
(
$this
->
	`£cur™ySÿnFe
('z://'.
	`»®·th
(
$pF’ame
).'#cÚ‹Á.xml'), 
nuÎ
, 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

131 
$xml
->
	`£tP¬£rPrİ”ty
(2, 
Œue
);

134 
$xml
->
	`»ad
();

135 
$xml
->
	`»ad
()) {

137 
$xml
->
Çme
 !== 'office:body') {

138 ià(
$xml
->
isEm±yEËm’t
) {

139 
$xml
->
	`»ad
();

141 
$xml
->
	`Ãxt
();

145 
$xml
->
	`»ad
()) {

146 ià(
$xml
->
Çme
 =ğ'bË:bË' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

149 
$wÜksh“tNames
[] = 
$xml
->
	`g‘A‰ribu‹
('table:name');

150 
$xml
->
	`Ãxt
();

151 } 
$xml
->
Çme
 =ğ'bË:bË' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
);

156  
$wÜksh“tNames
;

157 
	}
}

165 
public
 
funùiÚ
 
	$li¡WÜksh“tInfo
(
$pF’ame
)

168 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

169 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

172 
$wÜksh“tInfo
 = 
	`¬¿y
();

174 
$zCÏss
 = 
PHPExûl_S‘tšgs
::
	`g‘ZCÏss
();

176 
$z
 = 
Ãw
 
$zCÏss
;

177 ià(!
$z
->
	`İ’
(
$pF’ame
)) {

178 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! Error opening file.");

181 
$xml
 = 
Ãw
 
	`XMLR—d”
();

182 
$»s
 = 
$xml
->
	`xml
(
$this
->
	`£cur™ySÿnFe
('z://'.
	`»®·th
(
$pF’ame
).'#cÚ‹Á.xml'), 
nuÎ
, 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

183 
$xml
->
	`£tP¬£rPrİ”ty
(2, 
Œue
);

186 
$xml
->
	`»ad
();

187 
$xml
->
	`»ad
()) {

189 
$xml
->
Çme
 !== 'office:body') {

190 ià(
$xml
->
isEm±yEËm’t
) {

191 
$xml
->
	`»ad
();

193 
$xml
->
	`Ãxt
();

197 
$xml
->
	`»ad
()) {

198 ià(
$xml
->
Çme
 =ğ'bË:bË' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

199 
$wÜksh“tNames
[] = 
$xml
->
	`g‘A‰ribu‹
('table:name');

201 
$tmpInfo
 = 
	`¬¿y
(

202 'wÜksh“tName' => 
$xml
->
	`g‘A‰ribu‹
('table:name'),

210 
$cu¼C–ls
 = 0;

212 
$xml
->
	`»ad
();

213 ià(
$xml
->
Çme
 =ğ'bË:bË-row' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

214 
$row¥ª
 = 
$xml
->
	`g‘A‰ribu‹
('table:number-rows-repeated');

215 
$row¥ª
 = 
	`em±y
($rowspan) ? 1 : $rowspan;

216 
$tmpInfo
['tÙ®Rows'] +ğ
$row¥ª
;

217 
$tmpInfo
['tÙ®CŞumns'] = 
	`max
($tmpInfo['tÙ®CŞumns'], 
$cu¼C–ls
);

218 
$cu¼C–ls
 = 0;

220 
$xml
->
	`»ad
();

222 ià(
$xml
->
Çme
 =ğ'bË:bË-ûÎ' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

223 ià(!
$xml
->
isEm±yEËm’t
) {

224 
$cu¼C–ls
++;

225 
$xml
->
	`Ãxt
();

227 
$xml
->
	`»ad
();

229 } 
	`–£if
 (
$xml
->
Çme
 =ğ'bË:cov”ed-bË-ûÎ' && $xml->
nodeTy³
 =ğ
XMLR—d”
::
ELEMENT
) {

230 
$m”geSize
 = 
$xml
->
	`g‘A‰ribu‹
('table:number-columns-repeated');

231 
$cu¼C–ls
 +ğ
$m”geSize
;

232 
$xml
->
	`»ad
();

234 } 
$xml
->
Çme
 != 'table:table-row');

236 } 
$xml
->
Çme
 != 'table:table');

238 
$tmpInfo
['tÙ®CŞumns'] = 
	`max
($tmpInfo['tÙ®CŞumns'], 
$cu¼C–ls
);

239 
$tmpInfo
['lastColumnIndex'] = $tmpInfo['totalColumns'] - 1;

240 
$tmpInfo
['Ï¡CŞumnL‘‹r'] = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($tmpInfo['lastColumnIndex']);

241 
$wÜksh“tInfo
[] = 
$tmpInfo
;

281  
$wÜksh“tInfo
;

282 
	}
}

291 
public
 
funùiÚ
 
	$lßd
(
$pF’ame
)

294 
$objPHPExûl
 = 
Ãw
 
	`PHPExûl
();

297  
$this
->
	`lßdIÁoExi¡šg
(
$pF’ame
, 
$objPHPExûl
);

298 
	}
}

300 
´iv©e
 
funùiÚ
 
	$id’tifyFixedStyËV®ue
(
$¡yËLi¡
, &
$¡yËA‰ribu‹V®ue
)

302 
$¡yËA‰ribu‹V®ue
 = 
	`¡¹Şow”
($styleAttributeValue);

303 
	`fÜ—ch
 (
$¡yËLi¡
 
as
 
$¡yË
) {

304 ià(
$¡yËA‰ribu‹V®ue
 =ğ
	`¡¹Şow”
(
$¡yË
)) {

305 
$¡yËA‰ribu‹V®ue
 = 
$¡yË
;

306  
Œue
;

309  
çl£
;

310 
	}
}

320 
public
 
funùiÚ
 
	$lßdIÁoExi¡šg
(
$pF’ame
, 
PHPExûl
 
$objPHPExûl
)

323 ià(!
	`fe_exi¡s
(
$pF’ame
)) {

324 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! File does‚otƒxist.");

327 
$timezÚeObj
 = 
Ãw
 
	`D©eTimeZÚe
('Europe/London');

328 
$GMT
 = 
Ãw
 
	`D©eTimeZÚe
('UTC');

330 
$zCÏss
 = 
PHPExûl_S‘tšgs
::
	`g‘ZCÏss
();

332 
$z
 = 
Ãw
 
$zCÏss
;

333 ià(!
$z
->
	`İ’
(
$pF’ame
)) {

334 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for„eading! Error opening file.");

338 
$xml
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
(
$z
->
	`g‘FromName
("m‘a.xml")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

339 
$Çme¥aûsM‘a
 = 
$xml
->
	`g‘Name¥aûs
(
Œue
);

344 
$docPrİs
 = 
$objPHPExûl
->
	`g‘Prİ”t›s
();

345 
$offiûPrİ”ty
 = 
$xml
->
	`chd»n
(
$Çme¥aûsM‘a
['office']);

346 
	`fÜ—ch
 (
$offiûPrİ”ty
 
as
 
$offiûPrİ”tyD©a
) {

347 
$offiûPrİ”tyDC
 = 
	`¬¿y
();

348 ià(
	`is£t
(
$Çme¥aûsM‘a
['dc'])) {

349 
$offiûPrİ”tyDC
 = 
$offiûPrİ”tyD©a
->
	`chd»n
(
$Çme¥aûsM‘a
['dc']);

351 
	`fÜ—ch
 (
$offiûPrİ”tyDC
 
as
 
$´İ”tyName
 => 
$´İ”tyV®ue
) {

352 
$´İ”tyV®ue
 = (
¡ršg
) $propertyValue;

353 
$´İ”tyName
) {

355 
$docPrİs
->
	`£tT™Ë
(
$´İ”tyV®ue
);

358 
$docPrİs
->
	`£tSubjeù
(
$´İ”tyV®ue
);

361 
$docPrİs
->
	`£tC»©Ü
(
$´İ”tyV®ue
);

362 
$docPrİs
->
	`£tLa¡Modif›dBy
(
$´İ”tyV®ue
);

365 
$ü—tiÚD©e
 = 
	`¡¹Ùime
(
$´İ”tyV®ue
);

366 
$docPrİs
->
	`£tC»©ed
(
$ü—tiÚD©e
);

367 
$docPrİs
->
	`£tModif›d
(
$ü—tiÚD©e
);

370 
$docPrİs
->
	`£tDesütiÚ
(
$´İ”tyV®ue
);

374 
$offiûPrİ”tyM‘a
 = 
	`¬¿y
();

375 ià(
	`is£t
(
$Çme¥aûsM‘a
['dc'])) {

376 
$offiûPrİ”tyM‘a
 = 
$offiûPrİ”tyD©a
->
	`chd»n
(
$Çme¥aûsM‘a
['meta']);

378 
	`fÜ—ch
 (
$offiûPrİ”tyM‘a
 
as
 
$´İ”tyName
 => 
$´İ”tyV®ue
) {

379 
$´İ”tyV®ueA‰ribu‹s
 = 
$´İ”tyV®ue
->
	`©Œibu‹s
(
$Çme¥aûsM‘a
['meta']);

380 
$´İ”tyV®ue
 = (
¡ršg
) $propertyValue;

381 
$´İ”tyName
) {

383 
$docPrİs
->
	`£tC»©Ü
(
$´İ”tyV®ue
);

386 
$docPrİs
->
	`£tKeywÜds
(
$´İ”tyV®ue
);

389 
$ü—tiÚD©e
 = 
	`¡¹Ùime
(
$´İ”tyV®ue
);

390 
$docPrİs
->
	`£tC»©ed
(
$ü—tiÚD©e
);

393 
$´İ”tyV®ueTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_STRING
;

394 
	`fÜ—ch
 (
$´İ”tyV®ueA‰ribu‹s
 
as
 
$key
 => 
$v®ue
) {

395 ià(
$key
 == 'name') {

396 
$´İ”tyV®ueName
 = (
¡ršg
è
$v®ue
;

397 } 
	`–£if
 (
$key
 == 'value-type') {

398 
$v®ue
) {

400 
$´İ”tyV®ue
 = 
PHPExûl_Docum’tPrİ”t›s
::
	`cÚv”tPrİ”ty
($propertyValue, 'date');

401 
$´İ”tyV®ueTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_DATE
;

404 
$´İ”tyV®ue
 = 
PHPExûl_Docum’tPrİ”t›s
::
	`cÚv”tPrİ”ty
($propertyValue, 'bool');

405 
$´İ”tyV®ueTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_BOOLEAN
;

408 
$´İ”tyV®ue
 = 
PHPExûl_Docum’tPrİ”t›s
::
	`cÚv”tPrİ”ty
($propertyValue, 'r4');

409 
$´İ”tyV®ueTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_FLOAT
;

412 
$´İ”tyV®ueTy³
 = 
PHPExûl_Docum’tPrİ”t›s
::
PROPERTY_TYPE_STRING
;

416 
$docPrİs
->
	`£tCu¡omPrİ”ty
(
$´İ”tyV®ueName
, 
$´İ”tyV®ue
, 
$´İ”tyV®ueTy³
);

424 
$xml
 = 
	`sim¶exml_lßd_¡ršg
(
$this
->
	`£cur™ySÿn
(
$z
->
	`g‘FromName
("cÚ‹Á.xml")), 'Sim¶eXMLEËm’t', 
PHPExûl_S‘tšgs
::
	`g‘LibXmlLßd”O±iÚs
());

425 
$Çme¥aûsCÚ‹Á
 = 
$xml
->
	`g‘Name¥aûs
(
Œue
);

430 
$wÜkbook
 = 
$xml
->
	`chd»n
(
$Çme¥aûsCÚ‹Á
['office']);

431 
	`fÜ—ch
 (
$wÜkbook
->
body
->
¥»adsh“t
 
as
 
$wÜkbookD©a
) {

432 
$wÜkbookD©a
 = $wÜkbookD©a->
	`chd»n
(
$Çme¥aûsCÚ‹Á
['table']);

433 
$wÜksh“tID
 = 0;

434 
	`fÜ—ch
 (
$wÜkbookD©a
->
bË
 
as
 
$wÜksh“tD©aS‘
) {

435 
$wÜksh“tD©a
 = 
$wÜksh“tD©aS‘
->
	`chd»n
(
$Çme¥aûsCÚ‹Á
['table']);

438 
$wÜksh“tD©aA‰ribu‹s
 = 
$wÜksh“tD©aS‘
->
	`©Œibu‹s
(
$Çme¥aûsCÚ‹Á
['table']);

441 ià((
	`is£t
(
$this
->
lßdSh“tsOÆy
)è&& (is£t(
$wÜksh“tD©aA‰ribu‹s
['name'])) &&

442 (!
	`š_¬¿y
(
$wÜksh“tD©aA‰ribu‹s
['Çme'], 
$this
->
lßdSh“tsOÆy
))) {

448 
$objPHPExûl
->
	`ü—‹Sh“t
();

449 
$objPHPExûl
->
	`£tAùiveSh“tIndex
(
$wÜksh“tID
);

450 ià(
	`is£t
(
$wÜksh“tD©aA‰ribu‹s
['name'])) {

451 
$wÜksh“tName
 = (
¡ršg
è
$wÜksh“tD©aA‰ribu‹s
['name'];

455 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`£tT™Ë
(
$wÜksh“tName
, 
çl£
);

458 
$rowID
 = 1;

459 
	`fÜ—ch
 (
$wÜksh“tD©a
 
as
 
$key
 => 
$rowD©a
) {

461 
$key
) {

463 
	`fÜ—ch
 (
$rowD©a
 
as
 
$key
 => 
$ûÎD©a
) {

464 
$rowD©a
 = 
$ûÎD©a
;

468 
$rowD©aTabËA‰ribu‹s
 = 
$rowD©a
->
	`©Œibu‹s
(
$Çme¥aûsCÚ‹Á
['table']);

469 
$rowR•—ts
 = (
	`is£t
(
$rowD©aTabËA‰ribu‹s
['number-rows-repeated'])) ? $rowDataTableAttributes['number-rows-repeated'] : 1;

470 
$cŞumnID
 = 'A';

471 
	`fÜ—ch
 (
$rowD©a
 
as
 
$key
 => 
$ûÎD©a
) {

472 ià(
$this
->
	`g‘R—dF‹r
(è!=ğ
nuÎ
) {

473 ià(!
$this
->
	`g‘R—dF‹r
()->
	`»adC–l
(
$cŞumnID
, 
$rowID
, 
$wÜksh“tName
)) {

479 
$ûÎD©aText
 = (
	`is£t
(
$Çme¥aûsCÚ‹Á
['‹xt'])è? 
$ûÎD©a
->
	`chd»n
($namespacesContent['text']) : '';

480 
$ûÎD©aOffiû
 = 
$ûÎD©a
->
	`chd»n
(
$Çme¥aûsCÚ‹Á
['office']);

481 
$ûÎD©aOffiûA‰ribu‹s
 = 
$ûÎD©a
->
	`©Œibu‹s
(
$Çme¥aûsCÚ‹Á
['office']);

482 
$ûÎD©aTabËA‰ribu‹s
 = 
$ûÎD©a
->
	`©Œibu‹s
(
$Çme¥aûsCÚ‹Á
['table']);

492 
$ty³
 = 
$fÜm©tšg
 = 
$hy³¾šk
 = 
nuÎ
;

493 
$hasC®cuÏ‹dV®ue
 = 
çl£
;

494 
$ûÎD©aFÜmuÏ
 = '';

495 ià(
	`is£t
(
$ûÎD©aTabËA‰ribu‹s
['formula'])) {

496 
$ûÎD©aFÜmuÏ
 = 
$ûÎD©aTabËA‰ribu‹s
['formula'];

497 
$hasC®cuÏ‹dV®ue
 = 
Œue
;

500 ià(
	`is£t
(
$ûÎD©aOffiû
->
ªnÙ©iÚ
)) {

502 
$ªnÙ©iÚText
 = 
$ûÎD©aOffiû
->
ªnÙ©iÚ
->
	`chd»n
(
$Çme¥aûsCÚ‹Á
['text']);

503 
$‹xtA¼ay
 = 
	`¬¿y
();

504 
	`fÜ—ch
 (
$ªnÙ©iÚText
 
as
 
$t
) {

505 ià(
	`is£t
(
$t
->
¥ª
)) {

506 
	`fÜ—ch
 (
$t
->
¥ª
 
as
 
$‹xt
) {

507 
$‹xtA¼ay
[] = (
¡ršg
)
$‹xt
;

510 
$‹xtA¼ay
[] = (
¡ršg
è
$t
;

513 
$‹xt
 = 
	`im¶ode
("\n", 
$‹xtA¼ay
);

515 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘Comm’t
(
$cŞumnID
.
$rowID
)->
	`£tText
(
$this
->
	`·r£RichText
(
$‹xt
));

519 ià(
	`is£t
(
$ûÎD©aText
->
p
)) {

521 
$d©aA¼ay
 = 
	`¬¿y
();

526 
	`fÜ—ch
 (
$ûÎD©aText
->
p
 
as
 
$pD©a
) {

527 ià(
	`is£t
(
$pD©a
->
¥ª
)) {

529 
$¥ªSeùiÚ
 = "";

530 
	`fÜ—ch
 (
$pD©a
->
¥ª
 
as
 
$¥ªD©a
) {

531 
$¥ªSeùiÚ
 .ğ
$¥ªD©a
;

533 
	`¬¿y_push
(
$d©aA¼ay
, 
$¥ªSeùiÚ
);

535 
	`¬¿y_push
(
$d©aA¼ay
, 
$pD©a
);

538 
$®lC–lD©aText
 = 
	`im¶ode
(
$d©aA¼ay
, "\n");

541 
$ûÎD©aOffiûA‰ribu‹s
['value-type']) {

543 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
;

544 
$d©aV®ue
 = 
$®lC–lD©aText
;

545 ià(
	`is£t
(
$d©aV®ue
->
a
)) {

546 
$d©aV®ue
 = $d©aV®ue->
a
;

547 
$ûÎXLškA‰ribu‹s
 = 
$d©aV®ue
->
	`©Œibu‹s
(
$Çme¥aûsCÚ‹Á
['xlink']);

548 
$hy³¾šk
 = 
$ûÎXLškA‰ribu‹s
['href'];

552 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
;

553 
$d©aV®ue
 = (
$®lC–lD©aText
 =ğ'TRUE'è? 
Œue
 : 
çl£
;

556 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

557 
$d©aV®ue
 = (è
$ûÎD©aOffiûA‰ribu‹s
['value'];

558 ià(
	`æoÜ
(
$d©aV®ue
) == $dataValue) {

559 
$d©aV®ue
 = (
š‹g”
) $dataValue;

561 
$fÜm©tšg
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_PERCENTAGE_00
;

564 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

565 
$d©aV®ue
 = (è
$ûÎD©aOffiûA‰ribu‹s
['value'];

566 ià(
	`æoÜ
(
$d©aV®ue
) == $dataValue) {

567 
$d©aV®ue
 = (
š‹g”
) $dataValue;

569 
$fÜm©tšg
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_CURRENCY_USD_SIMPLE
;

572 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

573 
$d©aV®ue
 = (è
$ûÎD©aOffiûA‰ribu‹s
['value'];

574 ià(
	`æoÜ
(
$d©aV®ue
) == $dataValue) {

575 ià(
$d©aV®ue
 =ğ(
š‹g”
) $dataValue) {

576 
$d©aV®ue
 = (
š‹g”
) $dataValue;

578 
$d©aV®ue
 = () $dataValue;

583 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

584 
$d©eObj
 = 
Ãw
 
	`D©eTime
(
$ûÎD©aOffiûA‰ribu‹s
['d©e-v®ue'], 
$GMT
);

585 
$d©eObj
->
	`£tTimeZÚe
(
$timezÚeObj
);

586 
	`li¡
(
$y—r
, 
$mÚth
, 
$day
, 
$hour
, 
$mšu‹
, 
$£cÚd
èğ
	`ex¶ode
(' ', 
$d©eObj
->
	`fÜm©
('Y m d H i s'));

587 
$d©aV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`FÜm©‹dPHPToExûl
(
$y—r
, 
$mÚth
, 
$day
, 
$hour
, 
$mšu‹
, 
$£cÚd
);

588 ià(
$d©aV®ue
 !ğ
	`æoÜ
($dataValue)) {

589 
$fÜm©tšg
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_XLSX15
.' '.PHPExûl_StyË_Numb”FÜm©::
FORMAT_DATE_TIME4
;

591 
$fÜm©tšg
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_XLSX15
;

595 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
;

596 
$d©aV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
	`¡¹Ùime
('01-01-1970 '.
	`im¶ode
(':', 
	`ssÿnf
(
$ûÎD©aOffiûA‰ribu‹s
['time-value'], 'PT%dH%dM%dS'))));

597 
$fÜm©tšg
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME4
;

605 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
;

606 
$d©aV®ue
 = 
nuÎ
;

609 ià(
$hasC®cuÏ‹dV®ue
) {

610 
$ty³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
;

612 
$ûÎD©aFÜmuÏ
 = 
	`sub¡r
($ûÎD©aFÜmuÏ, 
	`¡½os
($cellDataFormula, ':=')+1);

613 
$‹mp
 = 
	`ex¶ode
('"', 
$ûÎD©aFÜmuÏ
);

614 
$tKey
 = 
çl£
;

615 
	`fÜ—ch
 (
$‹mp
 
as
 &
$v®ue
) {

617 ià(
$tKey
 = !$tKey) {

618 
$v®ue
 = 
	`´eg_»¶aû
('/\[([^\.]+)\.([^\.]+):\.([^\.]+)\]/Ui', '$1!$2:$3', $value);

619 
$v®ue
 = 
	`´eg_»¶aû
('/\[([^\.]+)\.([^\.]+)\]/Ui', '$1!$2', $value);

620 
$v®ue
 = 
	`´eg_»¶aû
('/\[\.([^\.]+):\.([^\.]+)\]/Ui', '$1:$2', $value);

621 
$v®ue
 = 
	`´eg_»¶aû
('/\[\.([^\.]+)\]/Ui', '$1', $value);

622 
$v®ue
 = 
PHPExûl_C®cuÏtiÚ
::
	`Œª¦©eS•¬©Ü
(';', ',', $v®ue, 
$šB¿ûs
);

625 
	`un£t
(
$v®ue
);

627 
$ûÎD©aFÜmuÏ
 = 
	`im¶ode
('"', 
$‹mp
);

631 
$cŞR•—ts
 = (
	`is£t
(
$ûÎD©aTabËA‰ribu‹s
['number-columns-repeated'])) ? $cellDataTableAttributes['number-columns-repeated'] : 1;

632 ià(
$ty³
 !=ğ
nuÎ
) {

633 
$i
 = 0; $˜< 
$cŞR•—ts
; ++$i) {

634 ià(
$i
 > 0) {

635 ++
$cŞumnID
;

637 ià(
$ty³
 !=ğ
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
) {

638 
$rowAdju¡
 = 0; $rowAdju¡ < 
$rowR•—ts
; ++$rowAdjust) {

639 
$rID
 = 
$rowID
 + 
$rowAdju¡
;

640 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘C–l
(
$cŞumnID
.
$rID
)->
	`£tV®ueEx¶ic™
(((
$hasC®cuÏ‹dV®ue
è? 
$ûÎD©aFÜmuÏ
 : 
$d©aV®ue
), 
$ty³
);

641 ià(
$hasC®cuÏ‹dV®ue
) {

643 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘C–l
(
$cŞumnID
.
$rID
)->
	`£tC®cuÏ‹dV®ue
(
$d©aV®ue
);

645 ià(
$fÜm©tšg
 !=ğ
nuÎ
) {

646 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘StyË
(
$cŞumnID
.
$rID
)->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
(
$fÜm©tšg
);

648 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘StyË
(
$cŞumnID
.
$rID
)->
	`g‘Numb”FÜm©
()->
	`£tFÜm©Code
(
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL
);

650 ià(
$hy³¾šk
 !=ğ
nuÎ
) {

651 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘C–l
(
$cŞumnID
.
$rID
)->
	`g‘Hy³¾šk
()->
	`£tU¾
(
$hy³¾šk
);

659 ià((
	`is£t
(
$ûÎD©aTabËA‰ribu‹s
['number-columns-spanned'])) || (isset($cellDataTableAttributes['number-rows-spanned']))) {

660 ià((
$ty³
 !=ğ
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
è|| (!
$this
->
»adD©aOÆy
)) {

661 
$cŞumnTo
 = 
$cŞumnID
;

662 ià(
	`is£t
(
$ûÎD©aTabËA‰ribu‹s
['number-columns-spanned'])) {

663 
$cŞumnTo
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(PHPExûl_C–l::
	`cŞumnIndexFromSŒšg
(
$cŞumnID
è+ 
$ûÎD©aTabËA‰ribu‹s
['number-columns-spanned'] -2);

665 
$rowTo
 = 
$rowID
;

666 ià(
	`is£t
(
$ûÎD©aTabËA‰ribu‹s
['number-rows-spanned'])) {

667 
$rowTo
 = $rowTØ+ 
$ûÎD©aTabËA‰ribu‹s
['number-rows-spanned'] - 1;

669 
$ûÎRªge
 = 
$cŞumnID
.
$rowID
.':'.
$cŞumnTo
.
$rowTo
;

670 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`m”geC–ls
(
$ûÎRªge
);

674 ++
$cŞumnID
;

676 
$rowID
 +ğ
$rowR•—ts
;

680 ++
$wÜksh“tID
;

685  
$objPHPExûl
;

686 
	}
}

688 
´iv©e
 
funùiÚ
 
·r£RichText
(
$is
 = '')

690 
$v®ue
 = 
Ãw
 
PHPExûl_RichText
();

692 
	g$v®ue
->
ü—‹Text
(
$is
);

694  
	g$v®ue
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/SYLK.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_R—d”_SYLK
 
ex‹nds
 
PHPExûl_R—d”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_R—d”_IR—d”


44 
´iv©e
 
	m$šputEncodšg
 = 'ANSI';

51 
´iv©e
 
	m$sh“tIndex
 = 0;

58 
´iv©e
 
	m$fÜm©s
 = 
¬¿y
();

65 
´iv©e
 
	m$fÜm©
 = 0;

70 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

72 
$this
->
»adF‹r
 = 
Ãw
 
	`PHPExûl_R—d”_DeçuÉR—dF‹r
();

80 
´Ùeùed
 
funùiÚ
 
	$isV®idFÜm©
()

83 
$d©a
 = 
	`ä—d
(
$this
->
feHªdË
, 2048);

86 
$d–im™”CouÁ
 = 
	`sub¡r_couÁ
(
$d©a
, ';');

87 ià(
$d–im™”CouÁ
 < 1) {

88  
çl£
;

92 
$lšes
 = 
	`ex¶ode
("\n", 
$d©a
);

93 ià(
	`sub¡r
(
$lšes
[0], 0, 4) != 'ID;P') {

94  
çl£
;

97  
Œue
;

98 
	}
}

105 
public
 
funùiÚ
 
£tIÅutEncodšg
(
$pV®ue
 = 'ANSI')

107 
$this
->
šputEncodšg
 = 
$pV®ue
;

108  
	g$this
;

116 
public
 
funùiÚ
 
	$g‘IÅutEncodšg
()

118  
$this
->
šputEncodšg
;

119 
	}
}

127 
public
 
funùiÚ
 
	$li¡WÜksh“tInfo
(
$pF’ame
)

130 
$this
->
	`İ’Fe
(
$pF’ame
);

131 ià(!
$this
->
	`isV®idFÜm©
()) {

132 
	`fşo£
(
$this
->
feHªdË
);

133 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
(
$pF’ame
 . " is‡n Invalid Spreadsheet file.");

135 
$feHªdË
 = 
$this
->
feHªdË
;

136 
	`»wšd
(
$feHªdË
);

138 
$wÜksh“tInfo
 = 
	`¬¿y
();

139 
$wÜksh“tInfo
[0]['worksheetName'] = 'Worksheet';

140 
$wÜksh“tInfo
[0]['lastColumnLetter'] = 'A';

141 
$wÜksh“tInfo
[0]['lastColumnIndex'] = 0;

142 
$wÜksh“tInfo
[0]['totalRows'] = 0;

143 
$wÜksh“tInfo
[0]['totalColumns'] = 0;

146 
$rowD©a
 = 
	`¬¿y
();

149 
$rowIndex
 = 0;

150 (
$rowD©a
 = 
	`fg‘s
(
$feHªdË
)è!=ğ
çl£
) {

151 
$cŞumnIndex
 = 0;

154 
$rowD©a
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`SYLKtoUTF8
($rowData);

158 
$rowD©a
 = 
	`ex¶ode
("\t", 
	`¡r_»¶aû
('Â¤', ';', sŒ_»¶aû(';', "\t", sŒ_»¶aû(';;', 'Â¤', 
	`¹rim
($rowData)))));

160 
$d©aTy³
 = 
	`¬¿y_shiá
(
$rowD©a
);

161 ià(
$d©aTy³
 == 'C') {

163 
	`fÜ—ch
 (
$rowD©a
 
as
 
$rowD©um
) {

164 
$rowD©um
{0}) {

167 
$cŞumnIndex
 = 
	`sub¡r
(
$rowD©um
, 1) - 1;

171 
$rowIndex
 = 
	`sub¡r
(
$rowD©um
, 1);

175 
$wÜksh“tInfo
[0]['tÙ®Rows'] = 
	`max
($wÜksh“tInfo[0]['tÙ®Rows'], 
$rowIndex
);

176 
$wÜksh“tInfo
[0]['Ï¡CŞumnIndex'] = 
	`max
($wÜksh“tInfo[0]['Ï¡CŞumnIndex'], 
$cŞumnIndex
);

181 
$wÜksh“tInfo
[0]['Ï¡CŞumnL‘‹r'] = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($worksheetInfo[0]['lastColumnIndex']);

182 
$wÜksh“tInfo
[0]['totalColumns'] = $worksheetInfo[0]['lastColumnIndex'] + 1;

185 
	`fşo£
(
$feHªdË
);

187  
$wÜksh“tInfo
;

188 
	}
}

197 
public
 
funùiÚ
 
	$lßd
(
$pF’ame
)

200 
$objPHPExûl
 = 
Ãw
 
	`PHPExûl
();

203  
$this
->
	`lßdIÁoExi¡šg
(
$pF’ame
, 
$objPHPExûl
);

204 
	}
}

214 
public
 
funùiÚ
 
	$lßdIÁoExi¡šg
(
$pF’ame
, 
PHPExûl
 
$objPHPExûl
)

217 
$this
->
	`İ’Fe
(
$pF’ame
);

218 ià(!
$this
->
	`isV®idFÜm©
()) {

219 
	`fşo£
(
$this
->
feHªdË
);

220 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
(
$pF’ame
 . " is‡n Invalid Spreadsheet file.");

222 
$feHªdË
 = 
$this
->
feHªdË
;

223 
	`»wšd
(
$feHªdË
);

226 
$objPHPExûl
->
	`g‘Sh“tCouÁ
(è<ğ
$this
->
sh“tIndex
) {

227 
$objPHPExûl
->
	`ü—‹Sh“t
();

229 
$objPHPExûl
->
	`£tAùiveSh“tIndex
(
$this
->
sh“tIndex
);

231 
$äomFÜm©s
 = 
	`¬¿y
('\-', '\ ');

232 
$toFÜm©s
 = 
	`¬¿y
('-', ' ');

235 
$rowD©a
 = 
	`¬¿y
();

236 
$cŞumn
 = 
$row
 = '';

239 (
$rowD©a
 = 
	`fg‘s
(
$feHªdË
)è!=ğ
çl£
) {

241 
$rowD©a
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`SYLKtoUTF8
($rowData);

245 
$rowD©a
 = 
	`ex¶ode
("\t", 
	`¡r_»¶aû
('Â¤', ';', sŒ_»¶aû(';', "\t", sŒ_»¶aû(';;', 'Â¤', 
	`¹rim
($rowData)))));

247 
$d©aTy³
 = 
	`¬¿y_shiá
(
$rowD©a
);

249 ià(
$d©aTy³
 == 'P') {

250 
$fÜm©A¼ay
 = 
	`¬¿y
();

251 
	`fÜ—ch
 (
$rowD©a
 
as
 
$rowD©um
) {

252 
$rowD©um
{0}) {

254 
$fÜm©A¼ay
['numb”fÜm©']['code'] = 
	`¡r_»¶aû
(
$äomFÜm©s
, 
$toFÜm©s
, 
	`sub¡r
(
$rowD©um
, 1));

258 
$fÜm©A¼ay
['fÚt']['Çme'] = 
	`sub¡r
(
$rowD©um
, 1);

261 
$fÜm©A¼ay
['fÚt']['size'] = 
	`sub¡r
(
$rowD©um
, 1);

264 
$¡yËS‘tšgs
 = 
	`sub¡r
(
$rowD©um
, 1);

265 
$i
=0; $i<
	`¡¾’
(
$¡yËS‘tšgs
); ++$i) {

266 
$¡yËS‘tšgs
{
$i
}) {

268 
$fÜm©A¼ay
['fÚt']['™®ic'] = 
Œue
;

271 
$fÜm©A¼ay
['fÚt']['bŞd'] = 
Œue
;

274 
$fÜm©A¼ay
['bÜd”s']['tİ']['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
;

277 
$fÜm©A¼ay
['bÜd”s']['bÙtom']['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
;

280 
$fÜm©A¼ay
['bÜd”s']['Ëá']['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
;

283 
$fÜm©A¼ay
['bÜd”s']['right']['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
;

290 
$this
->
fÜm©s
['P'.$this->
fÜm©
++] = 
$fÜm©A¼ay
;

292 } 
	`–£if
 (
$d©aTy³
 == 'C') {

293 
$hasC®cuÏ‹dV®ue
 = 
çl£
;

294 
$ûÎD©a
 = 
$ûÎD©aFÜmuÏ
 = '';

295 
	`fÜ—ch
 (
$rowD©a
 
as
 
$rowD©um
) {

296 
$rowD©um
{0}) {

299 
$cŞumn
 = 
	`sub¡r
(
$rowD©um
, 1);

303 
$row
 = 
	`sub¡r
(
$rowD©um
, 1);

306 
$ûÎD©a
 = 
	`sub¡r
(
$rowD©um
, 1);

309 
$ûÎD©aFÜmuÏ
 = '='.
	`sub¡r
(
$rowD©um
, 1);

311 
$‹mp
 = 
	`ex¶ode
('"', 
$ûÎD©aFÜmuÏ
);

312 
$key
 = 
çl£
;

313 
	`fÜ—ch
 (
$‹mp
 
as
 &
$v®ue
) {

315 ià(
$key
 = !$key) {

316 
	`´eg_m©ch_®l
('/(R(\[?-?\d*\]?))(C(\[?-?\d*\]?))/', 
$v®ue
, 
$ûÎReã»nûs
, 
PREG_SET_ORDER
+
PREG_OFFSET_CAPTURE
);

320 
$ûÎReã»nûs
 = 
	`¬¿y_»v”£
($cellReferences);

323 
	`fÜ—ch
 (
$ûÎReã»nûs
 
as
 
$ûÎReã»nû
) {

324 
$rowReã»nû
 = 
$ûÎReã»nû
[2][0];

326 ià(
$rowReã»nû
 == '') {

327 
$rowReã»nû
 = 
$row
;

330 ià(
$rowReã»nû
{0} == '[') {

331 
$rowReã»nû
 = 
$row
 + 
	`Œim
($rowReference, '[]');

333 
$cŞumnReã»nû
 = 
$ûÎReã»nû
[4][0];

335 ià(
$cŞumnReã»nû
 == '') {

336 
$cŞumnReã»nû
 = 
$cŞumn
;

339 ià(
$cŞumnReã»nû
{0} == '[') {

340 
$cŞumnReã»nû
 = 
$cŞumn
 + 
	`Œim
($columnReference, '[]');

342 
$A1C–lReã»nû
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumnReã»nû
-1).
$rowReã»nû
;

344 
$v®ue
 = 
	`sub¡r_»¶aû
($v®ue, 
$A1C–lReã»nû
, 
$ûÎReã»nû
[0][1], 
	`¡¾’
($cellReference[0][0]));

348 
	`un£t
(
$v®ue
);

350 
$ûÎD©aFÜmuÏ
 = 
	`im¶ode
('"', 
$‹mp
);

351 
$hasC®cuÏ‹dV®ue
 = 
Œue
;

355 
$cŞumnL‘‹r
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumn
-1);

356 
$ûÎD©a
 = 
PHPExûl_C®cuÏtiÚ
::
	`unw¿pResuÉ
($cellData);

359 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘C–l
(
$cŞumnL‘‹r
.
$row
)->
	`£tV®ue
((
$hasC®cuÏ‹dV®ue
è? 
$ûÎD©aFÜmuÏ
 : 
$ûÎD©a
);

360 ià(
$hasC®cuÏ‹dV®ue
) {

361 
$ûÎD©a
 = 
PHPExûl_C®cuÏtiÚ
::
	`unw¿pResuÉ
($cellData);

362 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘C–l
(
$cŞumnL‘‹r
.
$row
)->
	`£tC®cuÏ‹dV®ue
(
$ûÎD©a
);

365 } 
	`–£if
 (
$d©aTy³
 == 'F') {

366 
$fÜm©StyË
 = 
$cŞumnWidth
 = 
$¡yËS‘tšgs
 = '';

367 
$¡yËD©a
 = 
	`¬¿y
();

368 
	`fÜ—ch
 (
$rowD©a
 
as
 
$rowD©um
) {

369 
$rowD©um
{0}) {

372 
$cŞumn
 = 
	`sub¡r
(
$rowD©um
, 1);

376 
$row
 = 
	`sub¡r
(
$rowD©um
, 1);

379 
$fÜm©StyË
 = 
$rowD©um
;

382 
	`li¡
(
$¡¬tCŞ
, 
$’dCŞ
, 
$cŞumnWidth
èğ
	`ex¶ode
(' ', 
	`sub¡r
(
$rowD©um
, 1));

385 
$¡yËS‘tšgs
 = 
	`sub¡r
(
$rowD©um
, 1);

386 
$i
=0; $i<
	`¡¾’
(
$¡yËS‘tšgs
); ++$i) {

387 
$¡yËS‘tšgs
{
$i
}) {

389 
$¡yËD©a
['fÚt']['™®ic'] = 
Œue
;

392 
$¡yËD©a
['fÚt']['bŞd'] = 
Œue
;

395 
$¡yËD©a
['bÜd”s']['tİ']['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
;

398 
$¡yËD©a
['bÜd”s']['bÙtom']['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
;

401 
$¡yËD©a
['bÜd”s']['Ëá']['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
;

404 
$¡yËD©a
['bÜd”s']['right']['¡yË'] = 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
;

411 ià((
$fÜm©StyË
 > ''è&& (
$cŞumn
 > ''è&& (
$row
 > '')) {

412 
$cŞumnL‘‹r
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumn
-1);

413 ià(
	`is£t
(
$this
->
fÜm©s
[
$fÜm©StyË
])) {

414 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘StyË
(
$cŞumnL‘‹r
.
$row
)->
	`­¶yFromA¼ay
(
$this
->
fÜm©s
[
$fÜm©StyË
]);

417 ià((!
	`em±y
(
$¡yËD©a
)è&& (
$cŞumn
 > ''è&& (
$row
 > '')) {

418 
$cŞumnL‘‹r
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumn
-1);

419 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘StyË
(
$cŞumnL‘‹r
.
$row
)->
	`­¶yFromA¼ay
(
$¡yËD©a
);

421 ià(
$cŞumnWidth
 > '') {

422 ià(
$¡¬tCŞ
 =ğ
$’dCŞ
) {

423 
$¡¬tCŞ
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($startCol-1);

424 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘CŞumnDim’siÚ
(
$¡¬tCŞ
)->
	`£tWidth
(
$cŞumnWidth
);

426 
$¡¬tCŞ
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($startCol-1);

427 
$’dCŞ
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($endCol-1);

428 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘CŞumnDim’siÚ
(
$¡¬tCŞ
)->
	`£tWidth
(
$cŞumnWidth
);

430 
$objPHPExûl
->
	`g‘AùiveSh“t
()->
	`g‘CŞumnDim’siÚ
(++
$¡¬tCŞ
)->
	`£tWidth
(
$cŞumnWidth
);

431 } 
$¡¬tCŞ
 !ğ
$’dCŞ
);

435 
	`fÜ—ch
 (
$rowD©a
 
as
 
$rowD©um
) {

436 
$rowD©um
{0}) {

439 
$cŞumn
 = 
	`sub¡r
(
$rowD©um
, 1);

443 
$row
 = 
	`sub¡r
(
$rowD©um
, 1);

451 
	`fşo£
(
$feHªdË
);

454  
$objPHPExûl
;

455 
	}
}

462 
public
 
funùiÚ
 
	$g‘Sh“tIndex
()

464  
$this
->
sh“tIndex
;

465 
	}
}

473 
public
 
funùiÚ
 
	$£tSh“tIndex
(
$pV®ue
 = 0)

475 
$this
->
sh“tIndex
 = 
$pV®ue
;

476  
$this
;

477 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/ReferenceHelper.php

1 <?
php


28 şas 
	cPHPExûl_Reã»nûH–³r


32 cÚ¡ 
	mREFHELPER_REGEXP_CELLREF
 = '((\w*|\'[^!]*\')!)?(?<![:a-z\$])(\$?[a-z]{1,3}\$?\d+)(?=[^:!\d\'])';

33 cÚ¡ 
	mREFHELPER_REGEXP_CELLRANGE
 = '((\w*|\'[^!]*\')!)?(\$?[a-z]{1,3}\$?\d+):(\$?[a-z]{1,3}\$?\d+)';

34 cÚ¡ 
	mREFHELPER_REGEXP_ROWRANGE
 = '((\w*|\'[^!]*\')!)?(\$?\d+):(\$?\d+)';

35 cÚ¡ 
	mREFHELPER_REGEXP_COLRANGE
 = '((\w*|\'[^!]*\')!)?(\$?[a-z]{1,3}):(\$?[a-z]{1,3})';

42 
´iv©e
 
	m$š¡ªû
;

49 
public
 
funùiÚ
 
	$g‘In¡ªû
()

51 ià(!
	`is£t
(
£lf
::
$š¡ªû
è|| (£lf::$š¡ªû ==ğ
nuÎ
)) {

52 
£lf
::
$š¡ªû
 = 
Ãw
 
	`PHPExûl_Reã»nûH–³r
();

55  
£lf
::
$š¡ªû
;

61 
´Ùeùed
 
funùiÚ
 
	$__cÚ¡ruù
()

63 
	}
}

73 
public
 
funùiÚ
 
	$cŞumnSÜt
(
$a
, 
$b
)

75  
	`¡rÿ£cmp
(
	`¡¾’
(
$a
è. $a, sŒËn(
$b
) . $b);

76 
	}
}

86 
public
 
funùiÚ
 
	$cŞumnRev”£SÜt
(
$a
, 
$b
)

88  1 - 
	`¡rÿ£cmp
(
	`¡¾’
(
$a
è. $a, sŒËn(
$b
) . $b);

89 
	}
}

99 
public
 
funùiÚ
 
	$ûÎSÜt
(
$a
, 
$b
)

101 
	`ssÿnf
(
$a
, '%[A-Z]%d', 
$ac
, 
$¬
);

102 
	`ssÿnf
(
$b
, '%[A-Z]%d', 
$bc
, 
$br
);

104 ià(
$¬
 =ğ
$br
) {

105  
	`¡rÿ£cmp
(
	`¡¾’
(
$ac
è. $ac, sŒËn(
$bc
) . $bc);

107  (
$¬
 < 
$br
) ? -1 : 1;

108 
	}
}

118 
public
 
funùiÚ
 
	$ûÎRev”£SÜt
(
$a
, 
$b
)

120 
	`ssÿnf
(
$a
, '%[A-Z]%d', 
$ac
, 
$¬
);

121 
	`ssÿnf
(
$b
, '%[A-Z]%d', 
$bc
, 
$br
);

123 ià(
$¬
 =ğ
$br
) {

124  1 - 
	`¡rÿ£cmp
(
	`¡¾’
(
$ac
è. $ac, sŒËn(
$bc
) . $bc);

126  (
$¬
 < 
$br
) ? 1 : -1;

127 
	}
}

139 
´iv©e
 
funùiÚ
 
	$ûÎAdd»ssInD–‘eRªge
(
$ûÎAdd»ss
, 
$befÜeRow
, 
$pNumRows
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
)

141 
	`li¡
(
$ûÎCŞumn
, 
$ûÎRow
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$ûÎAdd»ss
);

142 
$ûÎCŞumnIndex
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$ûÎCŞumn
);

144 ià(
$pNumRows
 < 0 &&

145 (
$ûÎRow
 >ğ(
$befÜeRow
 + 
$pNumRows
)) &&

146 (
$ûÎRow
 < 
$befÜeRow
)) {

147  
Œue
;

148 } 
	`–£if
 (
$pNumCŞs
 < 0 &&

149 (
$ûÎCŞumnIndex
 >ğ(
$befÜeCŞumnIndex
 + 
$pNumCŞs
)) &&

150 (
$ûÎCŞumnIndex
 < 
$befÜeCŞumnIndex
)) {

151  
Œue
;

153  
çl£
;

154 
	}
}

166 
´Ùeùed
 
funùiÚ
 
	$adju¡PageB»aks
(
PHPExûl_WÜksh“t
 
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
)

168 
$aB»aks
 = 
$pSh“t
->
	`g‘B»aks
();

169 (
$pNumCŞs
 > 0 || 
$pNumRows
 > 0) ?

170 
	`uksÜt
(
$aB»aks
, 
	`¬¿y
('PHPExcel_ReferenceHelper','cellReverseSort')) :

171 
	`uksÜt
(
$aB»aks
, 
	`¬¿y
('PHPExcel_ReferenceHelper','cellSort'));

173 
	`fÜ—ch
 (
$aB»aks
 
as
 
$key
 => 
$v®ue
) {

174 ià(
£lf
::
	`ûÎAdd»ssInD–‘eRªge
(
$key
, 
$befÜeRow
, 
$pNumRows
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
)) {

177 
$pSh“t
->
	`£tB»ak
(
$key
, 
PHPExûl_WÜksh“t
::
BREAK_NONE
);

181 
$ÃwReã»nû
 = 
$this
->
	`upd©eC–lReã»nû
(
$key
, 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

182 ià(
$key
 !ğ
$ÃwReã»nû
) {

183 
$pSh“t
->
	`£tB»ak
(
$ÃwReã»nû
, 
$v®ue
)

184 ->
	`£tB»ak
(
$key
, 
PHPExûl_WÜksh“t
::
BREAK_NONE
);

188 
	}
}

200 
´Ùeùed
 
funùiÚ
 
	$adju¡Comm’ts
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
)

202 
$aComm’ts
 = 
$pSh“t
->
	`g‘Comm’ts
();

203 
$aNewComm’ts
 = 
	`¬¿y
();

205 
	`fÜ—ch
 (
$aComm’ts
 
as
 
$key
 => &
$v®ue
) {

207 ià(!
£lf
::
	`ûÎAdd»ssInD–‘eRªge
(
$key
, 
$befÜeRow
, 
$pNumRows
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
)) {

209 
$ÃwReã»nû
 = 
$this
->
	`upd©eC–lReã»nû
(
$key
, 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

210 
$aNewComm’ts
[
$ÃwReã»nû
] = 
$v®ue
;

214 
$pSh“t
->
	`£tComm’ts
(
$aNewComm’ts
);

215 
	}
}

227 
´Ùeùed
 
funùiÚ
 
	$adju¡Hy³¾šks
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
)

229 
$aHy³¾škCŞËùiÚ
 = 
$pSh“t
->
	`g‘Hy³¾škCŞËùiÚ
();

230 (
$pNumCŞs
 > 0 || 
$pNumRows
 > 0è? 
	`uksÜt
(
$aHy³¾škCŞËùiÚ
, 
	`¬¿y
('PHPExcel_ReferenceHelper','cellReverseSort')) : uksort($aHyperlinkCollection,‡rray('PHPExcel_ReferenceHelper','cellSort'));

232 
	`fÜ—ch
 (
$aHy³¾škCŞËùiÚ
 
as
 
$key
 => 
$v®ue
) {

233 
$ÃwReã»nû
 = 
$this
->
	`upd©eC–lReã»nû
(
$key
, 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

234 ià(
$key
 !ğ
$ÃwReã»nû
) {

235 
$pSh“t
->
	`£tHy³¾šk
(
$ÃwReã»nû
, 
$v®ue
);

236 
$pSh“t
->
	`£tHy³¾šk
(
$key
, 
nuÎ
);

239 
	}
}

251 
´Ùeùed
 
funùiÚ
 
	$adju¡D©aV®id©iÚs
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
)

253 
$aD©aV®id©iÚCŞËùiÚ
 = 
$pSh“t
->
	`g‘D©aV®id©iÚCŞËùiÚ
();

254 (
$pNumCŞs
 > 0 || 
$pNumRows
 > 0è? 
	`uksÜt
(
$aD©aV®id©iÚCŞËùiÚ
, 
	`¬¿y
('PHPExcel_ReferenceHelper','cellReverseSort')) : uksort($aDataValidationCollection,‡rray('PHPExcel_ReferenceHelper','cellSort'));

256 
	`fÜ—ch
 (
$aD©aV®id©iÚCŞËùiÚ
 
as
 
$key
 => 
$v®ue
) {

257 
$ÃwReã»nû
 = 
$this
->
	`upd©eC–lReã»nû
(
$key
, 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

258 ià(
$key
 !ğ
$ÃwReã»nû
) {

259 
$pSh“t
->
	`£tD©aV®id©iÚ
(
$ÃwReã»nû
, 
$v®ue
);

260 
$pSh“t
->
	`£tD©aV®id©iÚ
(
$key
, 
nuÎ
);

263 
	}
}

275 
´Ùeùed
 
funùiÚ
 
	$adju¡M”geC–ls
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
)

277 
$aM”geC–ls
 = 
$pSh“t
->
	`g‘M”geC–ls
();

278 
$aNewM”geC–ls
 = 
	`¬¿y
();

279 
	`fÜ—ch
 (
$aM”geC–ls
 
as
 
$key
 => &
$v®ue
) {

280 
$ÃwReã»nû
 = 
$this
->
	`upd©eC–lReã»nû
(
$key
, 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

281 
$aNewM”geC–ls
[
$ÃwReã»nû
] = $newReference;

283 
$pSh“t
->
	`£tM”geC–ls
(
$aNewM”geC–ls
);

284 
	}
}

296 
´Ùeùed
 
funùiÚ
 
	$adju¡PrÙeùedC–ls
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
)

298 
$aPrÙeùedC–ls
 = 
$pSh“t
->
	`g‘PrÙeùedC–ls
();

299 (
$pNumCŞs
 > 0 || 
$pNumRows
 > 0) ?

300 
	`uksÜt
(
$aPrÙeùedC–ls
, 
	`¬¿y
('PHPExcel_ReferenceHelper','cellReverseSort')) :

301 
	`uksÜt
(
$aPrÙeùedC–ls
, 
	`¬¿y
('PHPExcel_ReferenceHelper','cellSort'));

302 
	`fÜ—ch
 (
$aPrÙeùedC–ls
 
as
 
$key
 => 
$v®ue
) {

303 
$ÃwReã»nû
 = 
$this
->
	`upd©eC–lReã»nû
(
$key
, 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

304 ià(
$key
 !ğ
$ÃwReã»nû
) {

305 
$pSh“t
->
	`´ÙeùC–ls
(
$ÃwReã»nû
, 
$v®ue
, 
Œue
);

306 
$pSh“t
->
	`uÅrÙeùC–ls
(
$key
);

309 
	}
}

321 
´Ùeùed
 
funùiÚ
 
	$adju¡CŞumnDim’siÚs
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
)

323 
$aCŞumnDim’siÚs
 = 
	`¬¿y_»v”£
(
$pSh“t
->
	`g‘CŞumnDim’siÚs
(), 
Œue
);

324 ià(!
	`em±y
(
$aCŞumnDim’siÚs
)) {

325 
	`fÜ—ch
 (
$aCŞumnDim’siÚs
 
as
 
$objCŞumnDim’siÚ
) {

326 
$ÃwReã»nû
 = 
$this
->
	`upd©eC–lReã»nû
(
$objCŞumnDim’siÚ
->
	`g‘CŞumnIndex
(è. '1', 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

327 
	`li¡
(
$ÃwReã»nû
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
($newReference);

328 ià(
$objCŞumnDim’siÚ
->
	`g‘CŞumnIndex
(è!ğ
$ÃwReã»nû
) {

329 
$objCŞumnDim’siÚ
->
	`£tCŞumnIndex
(
$ÃwReã»nû
);

332 
$pSh“t
->
	`»äeshCŞumnDim’siÚs
();

334 
	}
}

346 
´Ùeùed
 
funùiÚ
 
	$adju¡RowDim’siÚs
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
)

348 
$aRowDim’siÚs
 = 
	`¬¿y_»v”£
(
$pSh“t
->
	`g‘RowDim’siÚs
(), 
Œue
);

349 ià(!
	`em±y
(
$aRowDim’siÚs
)) {

350 
	`fÜ—ch
 (
$aRowDim’siÚs
 
as
 
$objRowDim’siÚ
) {

351 
$ÃwReã»nû
 = 
$this
->
	`upd©eC–lReã»nû
('A' . 
$objRowDim’siÚ
->
	`g‘RowIndex
(), 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

352 
	`li¡
(, 
$ÃwReã»nû
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
($newReference);

353 ià(
$objRowDim’siÚ
->
	`g‘RowIndex
(è!ğ
$ÃwReã»nû
) {

354 
$objRowDim’siÚ
->
	`£tRowIndex
(
$ÃwReã»nû
);

357 
$pSh“t
->
	`»äeshRowDim’siÚs
();

359 
$cİyDim’siÚ
 = 
$pSh“t
->
	`g‘RowDim’siÚ
(
$befÜeRow
 - 1);

360 
$i
 = 
$befÜeRow
; $˜<ğ$befÜeRow - 1 + 
$pNumRows
; ++$i) {

361 
$ÃwDim’siÚ
 = 
$pSh“t
->
	`g‘RowDim’siÚ
(
$i
);

362 
$ÃwDim’siÚ
->
	`£tRowHeight
(
$cİyDim’siÚ
->
	`g‘RowHeight
());

363 
$ÃwDim’siÚ
->
	`£tVisibË
(
$cİyDim’siÚ
->
	`g‘VisibË
());

364 
$ÃwDim’siÚ
->
	`£tOušeLev–
(
$cİyDim’siÚ
->
	`g‘OušeLev–
());

365 
$ÃwDim’siÚ
->
	`£tCŞÏp£d
(
$cİyDim’siÚ
->
	`g‘CŞÏp£d
());

368 
	}
}

379 
public
 
funùiÚ
 
š£¹NewBefÜe
(
$pBefÜe
 = 'A1', 
$pNumCŞs
 = 0, 
$pNumRows
 = 0, 
PHPExûl_WÜksh“t
 
$pSh“t
 = 
nuÎ
)

381 
$»move
 = (
$pNumCŞs
 < 0 || 
$pNumRows
 < 0);

382 
	g$aC–lCŞËùiÚ
 = 
$pSh“t
->
g‘C–lCŞËùiÚ
();

385 
	g$befÜeCŞumn
 = 'A';

386 
	g$befÜeRow
 = 1;

387 
li¡
(
$befÜeCŞumn
, 
$befÜeRow
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$pBefÜe
);

388 
	g$befÜeCŞumnIndex
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$befÜeCŞumn
);

391 
	g$highe¡CŞumn
 = 
$pSh“t
->
g‘Highe¡CŞumn
();

392 
	g$highe¡Row
 = 
$pSh“t
->
g‘Highe¡Row
();

395 ià(
	g$pNumCŞs
 < 0 && 
	g$befÜeCŞumnIndex
 - 2 + $pNumCols > 0) {

396 
	g$i
 = 1; $˜<ğ
$highe¡Row
 - 1; ++$i) {

397 
	g$j
 = 
$befÜeCŞumnIndex
 - 1 + 
$pNumCŞs
; $j <= $beforeColumnIndex - 2; ++$j) {

398 
	g$coÜdš©e
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$j
è. 
$i
;

399 
	g$pSh“t
->
»moveCÚd™iÚ®StyËs
(
$coÜdš©e
);

400 ià(
	g$pSh“t
->
ûÎExi¡s
(
$coÜdš©e
)) {

401 
	g$pSh“t
->
g‘C–l
(
$coÜdš©e
)->
£tV®ueEx¶ic™
('', 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
);

402 
	g$pSh“t
->
g‘C–l
(
$coÜdš©e
)->
£tXfIndex
(0);

409 ià(
	g$pNumRows
 < 0 && 
	g$befÜeRow
 - 1 + $pNumRows > 0) {

410 
	g$i
 = 
$befÜeCŞumnIndex
 - 1; $˜<ğ
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$highe¡CŞumn
) - 1; ++$i) {

411 
	g$j
 = 
$befÜeRow
 + 
$pNumRows
; $j <= $beforeRow - 1; ++$j) {

412 
	g$coÜdš©e
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$i
è. 
$j
;

413 
	g$pSh“t
->
»moveCÚd™iÚ®StyËs
(
$coÜdš©e
);

414 ià(
	g$pSh“t
->
ûÎExi¡s
(
$coÜdš©e
)) {

415 
	g$pSh“t
->
g‘C–l
(
$coÜdš©e
)->
£tV®ueEx¶ic™
('', 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
);

416 
	g$pSh“t
->
g‘C–l
(
$coÜdš©e
)->
£tXfIndex
(0);

423 ià(
	g$»move
) {

425 
	g$aC–lCŞËùiÚ
 = 
¬¿y_»v”£
(
$aC–lCŞËùiÚ
);

427 
	g$ûÎID
 = 
¬¿y_pİ
(
$aC–lCŞËùiÚ
)) {

428 
$ûÎ
 = 
$pSh“t
->
g‘C–l
(
$ûÎID
);

429 
	g$ûÎIndex
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$ûÎ
->
g‘CŞumn
());

431 ià(
	g$ûÎIndex
-1 + 
	g$pNumCŞs
 < 0) {

436 
	g$ÃwCoÜdš©es
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$ûÎIndex
-1 + 
$pNumCŞs
è. (
$ûÎ
->
g‘Row
(è+ 
$pNumRows
);

439 ià((
	g$ûÎIndex
 >ğ
$befÜeCŞumnIndex
è&& (
$ûÎ
->
g‘Row
(è>ğ
$befÜeRow
)) {

441 
$pSh“t
->
g‘C–l
(
$ÃwCoÜdš©es
)->
£tXfIndex
(
$ûÎ
->
g‘XfIndex
());

444 ià(
	g$ûÎ
->
g‘D©aTy³
(è=ğ
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
) {

446 
$pSh“t
->
g‘C–l
(
$ÃwCoÜdš©es
)

447 ->
£tV®ue
(
$this
->
upd©eFÜmuÏReã»nûs
(
$ûÎ
->
g‘V®ue
(), 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
, 
$pSh“t
->
g‘T™Ë
()));

450 
	g$pSh“t
->
g‘C–l
(
$ÃwCoÜdš©es
)->
£tV®ue
(
$ûÎ
->
g‘V®ue
());

454 
	g$pSh“t
->
g‘C–lCacheCÚŒŞËr
()->
d–‘eCacheD©a
(
$ûÎID
);

458 ià(
	g$ûÎ
->
g‘D©aTy³
(è=ğ
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
) {

460 
$ûÎ
->
£tV®ue
(
$this
->
upd©eFÜmuÏReã»nûs
($ûÎ->
g‘V®ue
(), 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
, 
$pSh“t
->
g‘T™Ë
()));

467 
	g$highe¡CŞumn
 = 
$pSh“t
->
g‘Highe¡CŞumn
();

468 
	g$highe¡Row
 = 
$pSh“t
->
g‘Highe¡Row
();

470 ià(
	g$pNumCŞs
 > 0 && 
	g$befÜeCŞumnIndex
 - 2 > 0) {

471 
	g$i
 = 
$befÜeRow
; $˜<ğ
$highe¡Row
 - 1; ++$i) {

473 
	g$coÜdš©e
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$befÜeCŞumnIndex
 - 2è. 
$i
;

474 ià(
	g$pSh“t
->
ûÎExi¡s
(
$coÜdš©e
)) {

475 
	g$xfIndex
 = 
$pSh“t
->
g‘C–l
(
$coÜdš©e
)->
g‘XfIndex
();

476 
	g$cÚd™iÚ®StyËs
 = 
$pSh“t
->
cÚd™iÚ®StyËsExi¡s
(
$coÜdš©e
) ?

477 
$pSh“t
->
g‘CÚd™iÚ®StyËs
(
$coÜdš©e
è: 
çl£
;

478 
	g$j
 = 
$befÜeCŞumnIndex
 - 1; $j <ğ$befÜeCŞumnIndex - 2 + 
$pNumCŞs
; ++$j) {

479 
	g$pSh“t
->
g‘C–lByCŞumnAndRow
(
$j
, 
$i
)->
£tXfIndex
(
$xfIndex
);

480 ià(
	g$cÚd™iÚ®StyËs
) {

481 
	g$şÚed
 = 
¬¿y
();

482 
fÜ—ch
 (
$cÚd™iÚ®StyËs
 
as
 
$cÚd™iÚ®StyË
) {

483 
	g$şÚed
[] = 
şÚe
 
$cÚd™iÚ®StyË
;

485 
	g$pSh“t
->
£tCÚd™iÚ®StyËs
(
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$j
è. 
$i
, 
$şÚed
);

493 ià(
	g$pNumRows
 > 0 && 
	g$befÜeRow
 - 1 > 0) {

494 
	g$i
 = 
$befÜeCŞumnIndex
 - 1; $˜<ğ
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$highe¡CŞumn
) - 1; ++$i) {

496 
	g$coÜdš©e
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$i
è. (
$befÜeRow
 - 1);

497 ià(
	g$pSh“t
->
ûÎExi¡s
(
$coÜdš©e
)) {

498 
	g$xfIndex
 = 
$pSh“t
->
g‘C–l
(
$coÜdš©e
)->
g‘XfIndex
();

499 
	g$cÚd™iÚ®StyËs
 = 
$pSh“t
->
cÚd™iÚ®StyËsExi¡s
(
$coÜdš©e
) ?

500 
$pSh“t
->
g‘CÚd™iÚ®StyËs
(
$coÜdš©e
è: 
çl£
;

501 
	g$j
 = 
$befÜeRow
; $j <ğ$befÜeRow - 1 + 
$pNumRows
; ++$j) {

502 
	g$pSh“t
->
g‘C–l
(
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$i
è. 
$j
)->
£tXfIndex
(
$xfIndex
);

503 ià(
	g$cÚd™iÚ®StyËs
) {

504 
	g$şÚed
 = 
¬¿y
();

505 
fÜ—ch
 (
$cÚd™iÚ®StyËs
 
as
 
$cÚd™iÚ®StyË
) {

506 
	g$şÚed
[] = 
şÚe
 
$cÚd™iÚ®StyË
;

508 
	g$pSh“t
->
£tCÚd™iÚ®StyËs
(
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$i
è. 
$j
, 
$şÚed
);

516 
	g$this
->
adju¡CŞumnDim’siÚs
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
);

519 
	g$this
->
adju¡RowDim’siÚs
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
);

522 
	g$this
->
adju¡PageB»aks
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
);

525 
	g$this
->
adju¡Comm’ts
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
);

528 
	g$this
->
adju¡Hy³¾šks
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
);

531 
	g$this
->
adju¡D©aV®id©iÚs
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
);

534 
	g$this
->
adju¡M”geC–ls
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
);

537 
	g$this
->
adju¡PrÙeùedC–ls
(
$pSh“t
, 
$pBefÜe
, 
$befÜeCŞumnIndex
, 
$pNumCŞs
, 
$befÜeRow
, 
$pNumRows
);

540 
	g$autoF‹r
 = 
$pSh“t
->
g‘AutoF‹r
();

541 
	g$autoF‹rRªge
 = 
$autoF‹r
->
g‘Rªge
();

542 ià(!
em±y
(
$autoF‹rRªge
)) {

543 ià(
	g$pNumCŞs
 != 0) {

544 
$autoF‹rCŞumns
 = 
¬¿y_keys
(
$autoF‹r
->
g‘CŞumns
());

545 ià(
couÁ
(
$autoF‹rCŞumns
) > 0) {

546 
ssÿnf
(
$pBefÜe
, '%[A-Z]%d', 
$cŞumn
, 
$row
);

547 
	g$cŞumnIndex
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$cŞumn
);

548 
li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
PHPExûl_C–l
::
¿ngeBound¬›s
(
$autoF‹rRªge
);

549 ià(
	g$cŞumnIndex
 <ğ
$¿ngeEnd
[0]) {

550 ià(
$pNumCŞs
 < 0) {

553 
$d–‘eCŞumn
 = 
$cŞumnIndex
 + 
$pNumCŞs
 - 1;

554 
	g$d–‘eCouÁ
 = 
abs
(
$pNumCŞs
);

555 
	g$i
 = 1; $˜<ğ
$d–‘eCouÁ
; ++$i) {

556 ià(
š_¬¿y
(
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$d–‘eCŞumn
), 
$autoF‹rCŞumns
)) {

557 
	g$autoF‹r
->
ş—rCŞumn
(
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$d–‘eCŞumn
));

559 ++
	g$d–‘eCŞumn
;

562 
	g$¡¬tCŞ
 = (
$cŞumnIndex
 > 
$¿ngeS¹
[0]) ? $columnIndex : $rangeStart[0];

565 ià(
	g$pNumCŞs
 > 0) {

567 
	g$¡¬tCŞID
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$¡¬tCŞ
-1);

568 
	g$toCŞID
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$¡¬tCŞ
+
$pNumCŞs
-1);

569 
	g$’dCŞID
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$¿ngeEnd
[0]);

571 
	g$¡¬tCŞRef
 = 
$¡¬tCŞ
;

572 
	g$’dCŞRef
 = 
$¿ngeEnd
[0];

573 
	g$toCŞRef
 = 
$¿ngeEnd
[0]+
$pNumCŞs
;

576 
	g$autoF‹r
->
shiáCŞumn
(
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$’dCŞRef
-1), PHPExûl_C–l::¡ršgFromCŞumnIndex(
$toCŞRef
-1));

577 --
	g$’dCŞRef
;

578 --
	g$toCŞRef
;

579 } 
	g$¡¬tCŞRef
 <ğ
$’dCŞRef
);

582 
	g$¡¬tCŞID
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$¡¬tCŞ
-1);

583 
	g$toCŞID
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$¡¬tCŞ
+
$pNumCŞs
-1);

584 
	g$’dCŞID
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$¿ngeEnd
[0]);

586 
	g$autoF‹r
->
shiáCŞumn
(
$¡¬tCŞID
, 
$toCŞID
);

587 ++
	g$¡¬tCŞID
;

588 ++
	g$toCŞID
;

589 } 
	g$¡¬tCŞID
 !ğ
$’dCŞID
);

594 
	g$pSh“t
->
£tAutoF‹r
(
$this
->
upd©eC–lReã»nû
(
$autoF‹rRªge
, 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
));

598 ià(
	g$pSh“t
->
g‘F»ezePªe
() != '') {

599 
$pSh“t
->
ä“zePªe
(
$this
->
upd©eC–lReã»nû
($pSh“t->
g‘F»ezePªe
(), 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
));

603 ià(
	g$pSh“t
->
g‘PageS‘up
()->
isPrštA»aS‘
()) {

604 
	g$pSh“t
->
g‘PageS‘up
()->
£tPrštA»a
(
$this
->
upd©eC–lReã»nû
(
$pSh“t
->g‘PageS‘up()->
g‘PrštA»a
(), 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
));

608 
	g$aD¿wšgs
 = 
$pSh“t
->
g‘D¿wšgCŞËùiÚ
();

609 
fÜ—ch
 (
$aD¿wšgs
 
as
 
$objD¿wšg
) {

610 
	g$ÃwReã»nû
 = 
$this
->
upd©eC–lReã»nû
(
$objD¿wšg
->
g‘CoÜdš©es
(), 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

611 ià(
	g$objD¿wšg
->
g‘CoÜdš©es
(è!ğ
$ÃwReã»nû
) {

612 
$objD¿wšg
->
£tCoÜdš©es
(
$ÃwReã»nû
);

617 ià(
couÁ
(
$pSh“t
->
g‘P¬’t
()->
g‘NamedRªges
()) > 0) {

618 
fÜ—ch
 (
$pSh“t
->
g‘P¬’t
()->
g‘NamedRªges
(è
as
 
$ÇmedRªge
) {

619 ià(
	g$ÇmedRªge
->
g‘WÜksh“t
()->
g‘HashCode
(è=ğ
$pSh“t
->getHashCode()) {

620 
$ÇmedRªge
->
£tRªge
(
$this
->
upd©eC–lReã»nû
($ÇmedRªge->
g‘Rªge
(), 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
));

626 
	g$pSh“t
->
g¬bageCŞËù
();

640 
public
 
funùiÚ
 
upd©eFÜmuÏReã»nûs
(
$pFÜmuÏ
 = '', 
$pBefÜe
 = 'A1', 
$pNumCŞs
 = 0, 
$pNumRows
 = 0, 
$sh“tName
 = '')

643 
$fÜmuÏBlocks
 = 
ex¶ode
('"', 
$pFÜmuÏ
);

644 
	g$i
 = 
çl£
;

645 
fÜ—ch
 (
$fÜmuÏBlocks
 
as
 &
$fÜmuÏBlock
) {

647 ià(
	g$i
 = !
$i
) {

648 
$adju¡CouÁ
 = 0;

649 
	g$ÃwC–lTok’s
 = 
$ûÎTok’s
 = 
¬¿y
();

651 
	g$m©chCouÁ
 = 
´eg_m©ch_®l
('/'.
£lf
::
REFHELPER_REGEXP_ROWRANGE
.'/i', ' '.
$fÜmuÏBlock
.' ', 
$m©ches
, 
PREG_SET_ORDER
);

652 ià(
	g$m©chCouÁ
 > 0) {

653 
fÜ—ch
 (
$m©ches
 
as
 
$m©ch
) {

654 
	g$äomSŒšg
 = (
$m©ch
[2] > '') ? $match[2].'!' : '';

655 
	g$äomSŒšg
 .ğ
$m©ch
[3].':'.$match[4];

656 
	g$modif›d3
 = 
sub¡r
(
$this
->
upd©eC–lReã»nû
('$A'.
$m©ch
[3], 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
), 2);

657 
	g$modif›d4
 = 
sub¡r
(
$this
->
upd©eC–lReã»nû
('$A'.
$m©ch
[4], 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
), 2);

659 ià(
	g$m©ch
[3].':'.$m©ch[4] !=ğ
$modif›d3
.':'.
$modif›d4
) {

660 ià((
$m©ch
[2] =ğ''è|| (
Œim
($m©ch[2], "'"è=ğ
$sh“tName
)) {

661 
$toSŒšg
 = (
$m©ch
[2] > '') ? $match[2].'!' : '';

662 
	g$toSŒšg
 .ğ
$modif›d3
.':'.
$modif›d4
;

664 
	g$cŞumn
 = 100000;

665 
	g$row
 = 10000000 + 
Œim
(
$m©ch
[3], '$');

666 
	g$ûÎIndex
 = 
$cŞumn
.
$row
;

668 
	g$ÃwC–lTok’s
[
$ûÎIndex
] = 
´eg_quÙe
(
$toSŒšg
);

669 
	g$ûÎTok’s
[
$ûÎIndex
] = '/(?<!\d\$\!)'.
´eg_quÙe
(
$äomSŒšg
).'(?!\d)/i';

670 ++
	g$adju¡CouÁ
;

676 
	g$m©chCouÁ
 = 
´eg_m©ch_®l
('/'.
£lf
::
REFHELPER_REGEXP_COLRANGE
.'/i', ' '.
$fÜmuÏBlock
.' ', 
$m©ches
, 
PREG_SET_ORDER
);

677 ià(
	g$m©chCouÁ
 > 0) {

678 
fÜ—ch
 (
$m©ches
 
as
 
$m©ch
) {

679 
	g$äomSŒšg
 = (
$m©ch
[2] > '') ? $match[2].'!' : '';

680 
	g$äomSŒšg
 .ğ
$m©ch
[3].':'.$match[4];

681 
	g$modif›d3
 = 
sub¡r
(
$this
->
upd©eC–lReã»nû
(
$m©ch
[3].'$1', 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
), 0, -2);

682 
	g$modif›d4
 = 
sub¡r
(
$this
->
upd©eC–lReã»nû
(
$m©ch
[4].'$1', 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
), 0, -2);

684 ià(
	g$m©ch
[3].':'.$m©ch[4] !=ğ
$modif›d3
.':'.
$modif›d4
) {

685 ià((
$m©ch
[2] =ğ''è|| (
Œim
($m©ch[2], "'"è=ğ
$sh“tName
)) {

686 
$toSŒšg
 = (
$m©ch
[2] > '') ? $match[2].'!' : '';

687 
	g$toSŒšg
 .ğ
$modif›d3
.':'.
$modif›d4
;

689 
	g$cŞumn
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
Œim
(
$m©ch
[3], '$')) + 100000;

690 
	g$row
 = 10000000;

691 
	g$ûÎIndex
 = 
$cŞumn
.
$row
;

693 
	g$ÃwC–lTok’s
[
$ûÎIndex
] = 
´eg_quÙe
(
$toSŒšg
);

694 
	g$ûÎTok’s
[
$ûÎIndex
] = '/(?<![A-Z\$\!])'.
´eg_quÙe
(
$äomSŒšg
).'(?![A-Z])/i';

695 ++
	g$adju¡CouÁ
;

701 
	g$m©chCouÁ
 = 
´eg_m©ch_®l
('/'.
£lf
::
REFHELPER_REGEXP_CELLRANGE
.'/i', ' '.
$fÜmuÏBlock
.' ', 
$m©ches
, 
PREG_SET_ORDER
);

702 ià(
	g$m©chCouÁ
 > 0) {

703 
fÜ—ch
 (
$m©ches
 
as
 
$m©ch
) {

704 
	g$äomSŒšg
 = (
$m©ch
[2] > '') ? $match[2].'!' : '';

705 
	g$äomSŒšg
 .ğ
$m©ch
[3].':'.$match[4];

706 
	g$modif›d3
 = 
$this
->
upd©eC–lReã»nû
(
$m©ch
[3], 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

707 
	g$modif›d4
 = 
$this
->
upd©eC–lReã»nû
(
$m©ch
[4], 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

709 ià(
	g$m©ch
[3].$m©ch[4] !=ğ
$modif›d3
.
$modif›d4
) {

710 ià((
$m©ch
[2] =ğ''è|| (
Œim
($m©ch[2], "'"è=ğ
$sh“tName
)) {

711 
$toSŒšg
 = (
$m©ch
[2] > '') ? $match[2].'!' : '';

712 
	g$toSŒšg
 .ğ
$modif›d3
.':'.
$modif›d4
;

713 
li¡
(
$cŞumn
, 
$row
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$m©ch
[3]);

715 
	g$cŞumn
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
Œim
(
$cŞumn
, '$')) + 100000;

716 
	g$row
 = 
Œim
(
$row
, '$') + 10000000;

717 
	g$ûÎIndex
 = 
$cŞumn
.
$row
;

719 
	g$ÃwC–lTok’s
[
$ûÎIndex
] = 
´eg_quÙe
(
$toSŒšg
);

720 
	g$ûÎTok’s
[
$ûÎIndex
] = '/(?<![A-Z]\$\!)'.
´eg_quÙe
(
$äomSŒšg
).'(?!\d)/i';

721 ++
	g$adju¡CouÁ
;

727 
	g$m©chCouÁ
 = 
´eg_m©ch_®l
('/'.
£lf
::
REFHELPER_REGEXP_CELLREF
.'/i', ' '.
$fÜmuÏBlock
.' ', 
$m©ches
, 
PREG_SET_ORDER
);

729 ià(
	g$m©chCouÁ
 > 0) {

730 
fÜ—ch
 (
$m©ches
 
as
 
$m©ch
) {

731 
	g$äomSŒšg
 = (
$m©ch
[2] > '') ? $match[2].'!' : '';

732 
	g$äomSŒšg
 .ğ
$m©ch
[3];

734 
	g$modif›d3
 = 
$this
->
upd©eC–lReã»nû
(
$m©ch
[3], 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

735 ià(
	g$m©ch
[3] !=ğ
$modif›d3
) {

736 ià((
$m©ch
[2] =ğ''è|| (
Œim
($m©ch[2], "'"è=ğ
$sh“tName
)) {

737 
$toSŒšg
 = (
$m©ch
[2] > '') ? $match[2].'!' : '';

738 
	g$toSŒšg
 .ğ
$modif›d3
;

739 
li¡
(
$cŞumn
, 
$row
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$m©ch
[3]);

741 
	g$cŞumn
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
Œim
(
$cŞumn
, '$')) + 100000;

742 
	g$row
 = 
Œim
(
$row
, '$') + 10000000;

743 
	g$ûÎIndex
 = 
$row
 . 
$cŞumn
;

745 
	g$ÃwC–lTok’s
[
$ûÎIndex
] = 
´eg_quÙe
(
$toSŒšg
);

746 
	g$ûÎTok’s
[
$ûÎIndex
] = '/(?<![A-Z\$\!])'.
´eg_quÙe
(
$äomSŒšg
).'(?!\d)/i';

747 ++
	g$adju¡CouÁ
;

752 ià(
	g$adju¡CouÁ
 > 0) {

753 ià(
	g$pNumCŞs
 > 0 || 
	g$pNumRows
 > 0) {

754 
krsÜt
(
$ûÎTok’s
);

755 
krsÜt
(
$ÃwC–lTok’s
);

757 
ksÜt
(
$ûÎTok’s
);

758 
ksÜt
(
$ÃwC–lTok’s
);

760 
	g$fÜmuÏBlock
 = 
¡r_»¶aû
('\\', '', 
´eg_»¶aû
(
$ûÎTok’s
, 
$ÃwC–lTok’s
, 
$fÜmuÏBlock
));

764 
un£t
(
$fÜmuÏBlock
);

767  
im¶ode
('"', 
$fÜmuÏBlocks
);

780 
public
 
funùiÚ
 
upd©eC–lReã»nû
(
$pC–lRªge
 = 'A1', 
$pBefÜe
 = 'A1', 
$pNumCŞs
 = 0, 
$pNumRows
 = 0)

783 ià(
¡½os
(
$pC–lRªge
, "!"è!=ğ
çl£
) {

784  
$pC–lRªge
;

786 } 
–£if
 (
¡½os
(
$pC–lRªge
, ':'è==ğ
çl£
 && strpos($pCellRange, ',') === false) {

788  
$this
->
upd©eSšgËC–lReã»nû
(
$pC–lRªge
, 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

789 } 
–£if
 (
¡½os
(
$pC–lRªge
, ':'è!=ğ
çl£
 || strpos($pCellRange, ',') !== false) {

791  
$this
->
upd©eC–lRªge
(
$pC–lRªge
, 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

794  
	g$pC–lRªge
;

805 
public
 
funùiÚ
 
upd©eNamedFÜmuÏs
(
PHPExûl
 
$pPhpExûl
, 
$ŞdName
 = '', 
$ÃwName
 = '')

807 ià(
$ŞdName
 == '') {

811 
fÜ—ch
 (
$pPhpExûl
->
g‘WÜksh“tI‹¿tÜ
(è
as
 
$sh“t
) {

812 
fÜ—ch
 (
$sh“t
->
g‘C–lCŞËùiÚ
(
çl£
è
as
 
$ûÎID
) {

813 
	g$ûÎ
 = 
$sh“t
->
g‘C–l
(
$ûÎID
);

814 ià((
	g$ûÎ
 !=ğ
nuÎ
è&& (
$ûÎ
->
g‘D©aTy³
(è=ğ
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
)) {

815 
$fÜmuÏ
 = 
$ûÎ
->
g‘V®ue
();

816 ià(
¡½os
(
$fÜmuÏ
, 
$ŞdName
è!=ğ
çl£
) {

817 
$fÜmuÏ
 = 
¡r_»¶aû
("'" . 
$ŞdName
 . "'!", "'" . 
$ÃwName
 . "'!", $formula);

818 
	g$fÜmuÏ
 = 
¡r_»¶aû
(
$ŞdName
 . "!", 
$ÃwName
 . "!", 
$fÜmuÏ
);

819 
	g$ûÎ
->
£tV®ueEx¶ic™
(
$fÜmuÏ
, 
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
);

836 
´iv©e
 
funùiÚ
 
upd©eC–lRªge
(
$pC–lRªge
 = 'A1:A1', 
$pBefÜe
 = 'A1', 
$pNumCŞs
 = 0, 
$pNumRows
 = 0)

838 ià(
¡½os
(
$pC–lRªge
, ':'è!=ğ
çl£
 || strpos($pCellRange, ',') !== false) {

840 
$¿nge
 = 
PHPExûl_C–l
::
¥l™Rªge
(
$pC–lRªge
);

841 
	g$ic
 = 
couÁ
(
$¿nge
);

842 
	g$i
 = 0; $˜< 
	g$ic
; ++$i) {

843 
	g$jc
 = 
couÁ
(
$¿nge
[
$i
]);

844 
	g$j
 = 0; $j < 
	g$jc
; ++$j) {

845 ià(
ùy³_®pha
(
$¿nge
[
$i
][
$j
])) {

846 
	g$r
 = 
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$this
->
upd©eSšgËC–lReã»nû
(
$¿nge
[
$i
][
$j
].'1', 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
));

847 
	g$¿nge
[
$i
][
$j
] = 
$r
[0];

848 } 
–£if
 (
ùy³_dig™
(
$¿nge
[
$i
][
$j
])) {

849 
	g$r
 = 
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$this
->
upd©eSšgËC–lReã»nû
('A'.
$¿nge
[
$i
][
$j
], 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
));

850 
	g$¿nge
[
$i
][
$j
] = 
$r
[1];

852 
	g$¿nge
[
$i
][
$j
] = 
$this
->
upd©eSšgËC–lReã»nû
(
$¿nge
[$i][$j], 
$pBefÜe
, 
$pNumCŞs
, 
$pNumRows
);

858  
	gPHPExûl_C–l
::
budRªge
(
$¿nge
);

860 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
("Only cell„anges may be…assedohis method.");

874 
´iv©e
 
funùiÚ
 
upd©eSšgËC–lReã»nû
(
$pC–lReã»nû
 = 'A1', 
$pBefÜe
 = 'A1', 
$pNumCŞs
 = 0, 
$pNumRows
 = 0)

876 ià(
¡½os
(
$pC–lReã»nû
, ':'è==ğ
çl£
 && strpos($pCellReference, ',') === false) {

878 
li¡
(
$befÜeCŞumn
, 
$befÜeRow
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$pBefÜe
);

881 
li¡
(
$ÃwCŞumn
, 
$ÃwRow
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$pC–lReã»nû
);

884 
	g$upd©eCŞumn
 = ((
$ÃwCŞumn
{0} !ğ'$'è&& (
$befÜeCŞumn
{0} !ğ'$'è&& (
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
($newColumn) >= PHPExcel_Cell::columnIndexFromString($beforeColumn)));

885 
	g$upd©eRow
 = ((
$ÃwRow
{0} !ğ'$'è&& (
$befÜeRow
{0} != '$') && $newRow >= $beforeRow);

888 ià(
	g$upd©eCŞumn
) {

889 
	g$ÃwCŞumn
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(PHPExûl_C–l::
cŞumnIndexFromSŒšg
(
$ÃwCŞumn
è- 1 + 
$pNumCŞs
);

893 ià(
	g$upd©eRow
) {

894 
	g$ÃwRow
 = 
$ÃwRow
 + 
$pNumRows
;

898  
	g$ÃwCŞumn
 . 
	g$ÃwRow
;

900 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
("Only single cell„eferences may be…assedohis method.");

909 
fš®
 
public
 
funùiÚ
 
	$__şÚe
()

911 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Cloning‡ Singleton is‚ot‡llowed!");

912 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/RichText.php

1 <?
php


28 şas 
	cPHPExûl_RichText
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


35 
´iv©e
 
	m$richTextEËm’ts
;

43 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_C–l
 
$pC–l
 = 
nuÎ
)

46 
$this
->
richTextEËm’ts
 = 
	`¬¿y
();

49 ià(
$pC–l
 !=ğ
nuÎ
) {

51 ià(
$pC–l
->
	`g‘V®ue
() != "") {

52 
$objRun
 = 
Ãw
 
	`PHPExûl_RichText_Run
(
$pC–l
->
	`g‘V®ue
());

53 
$objRun
->
	`£tFÚt
(
şÚe
 
$pC–l
->
	`g‘P¬’t
()->
	`g‘StyË
($pC–l->
	`g‘CoÜdš©e
())->
	`g‘FÚt
());

54 
$this
->
	`addText
(
$objRun
);

58 
$pC–l
->
	`£tV®ueEx¶ic™
(
$this
, 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
);

69 
public
 
funùiÚ
 
	$addText
(
PHPExûl_RichText_ITextEËm’t
 
$pText
 = 
nuÎ
)

71 
$this
->
richTextEËm’ts
[] = 
$pText
;

72  
$this
;

73 
	}
}

82 
public
 
funùiÚ
 
ü—‹Text
(
$pText
 = '')

84 
$objText
 = 
Ãw
 
PHPExûl_RichText_TextEËm’t
(
$pText
);

85 
	g$this
->
addText
(
$objText
);

86  
	g$objText
;

96 
public
 
funùiÚ
 
ü—‹TextRun
(
$pText
 = '')

98 
$objText
 = 
Ãw
 
PHPExûl_RichText_Run
(
$pText
);

99 
	g$this
->
addText
(
$objText
);

100  
	g$objText
;

108 
public
 
funùiÚ
 
	$g‘PÏšText
()

111 
$»tuºV®ue
 = '';

114 
	`fÜ—ch
 (
$this
->
richTextEËm’ts
 
as
 
$‹xt
) {

115 
$»tuºV®ue
 .ğ
$‹xt
->
	`g‘Text
();

119  
$»tuºV®ue
;

120 
	}
}

127 
public
 
funùiÚ
 
	$__toSŒšg
()

129  
$this
->
	`g‘PÏšText
();

130 
	}
}

137 
public
 
funùiÚ
 
	$g‘RichTextEËm’ts
()

139  
$this
->
richTextEËm’ts
;

140 
	}
}

149 
public
 
funùiÚ
 
	$£tRichTextEËm’ts
(
$pEËm’ts
 = 
nuÎ
)

151 ià(
	`is_¬¿y
(
$pEËm’ts
)) {

152 
$this
->
richTextEËm’ts
 = 
$pEËm’ts
;

154 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid PHPExcel_RichText_ITextElement[]‡rray…assed.");

156  
$this
;

157 
	}
}

164 
public
 
funùiÚ
 
	$g‘HashCode
()

166 
$hashEËm’ts
 = '';

167 
	`fÜ—ch
 (
$this
->
richTextEËm’ts
 
as
 
$–em’t
) {

168 
$hashEËm’ts
 .ğ
$–em’t
->
	`g‘HashCode
();

171  
	`md5
(

172 
$hashEËm’ts
 .

173 
__CLASS__


175 
	}
}

180 
public
 
funùiÚ
 
	$__şÚe
()

182 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

183 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

184 ià(
	`is_objeù
(
$v®ue
)) {

185 
$this
->
$key
 = 
şÚe
 
$v®ue
;

187 
$this
->
$key
 = 
$v®ue
;

190 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/RichText/ITextElement.php

1 <?
php


26 
š‹rçû
 
	gPHPExûl_RichText_ITextEËm’t


33 
public
 
funùiÚ
 
g‘Text
();

41 
public
 
funùiÚ
 
£tText
(
$pText
 = '');

48 
public
 
funùiÚ
 
g‘FÚt
();

55 
public
 
funùiÚ
 
g‘HashCode
();

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/RichText/Run.php

1 <?
php


26 şas 
	cPHPExûl_RichText_Run
 
ex‹nds
 
PHPExûl_RichText_TextEËm’t
 
im¶em’ts
 
	mPHPExûl_RichText_ITextEËm’t


33 
´iv©e
 
	m$fÚt
;

40 
public
 
funùiÚ
 
__cÚ¡ruù
(
$pText
 = '')

43 
$this
->
£tText
(
$pText
);

44 
	m$this
->
	mfÚt
 = 
Ãw
 
PHPExûl_StyË_FÚt
();

52 
public
 
funùiÚ
 
	$g‘FÚt
()

54  
$this
->
fÚt
;

55 
	}
}

64 
public
 
funùiÚ
 
	$£tFÚt
(
PHPExûl_StyË_FÚt
 
$pFÚt
 = 
nuÎ
)

66 
$this
->
fÚt
 = 
$pFÚt
;

67  
$this
;

68 
	}
}

75 
public
 
funùiÚ
 
	$g‘HashCode
()

77  
	`md5
(

78 
$this
->
	`g‘Text
() .

79 
$this
->
fÚt
->
	`g‘HashCode
() .

80 
__CLASS__


82 
	}
}

87 
public
 
funùiÚ
 
	$__şÚe
()

89 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

90 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

91 ià(
	`is_objeù
(
$v®ue
)) {

92 
$this
->
$key
 = 
şÚe
 
$v®ue
;

94 
$this
->
$key
 = 
$v®ue
;

97 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/RichText/TextElement.php

1 <?
php


26 şas 
	cPHPExûl_RichText_TextEËm’t
 
im¶em’ts
 
	mPHPExûl_RichText_ITextEËm’t


33 
´iv©e
 
	m$‹xt
;

40 
public
 
funùiÚ
 
__cÚ¡ruù
(
$pText
 = '')

43 
$this
->
‹xt
 = 
$pText
;

51 
public
 
funùiÚ
 
	$g‘Text
()

53  
$this
->
‹xt
;

54 
	}
}

62 
public
 
funùiÚ
 
£tText
(
$pText
 = '')

64 
$this
->
‹xt
 = 
$pText
;

65  
	g$this
;

73 
public
 
funùiÚ
 
	$g‘FÚt
()

75  
nuÎ
;

76 
	}
}

83 
public
 
funùiÚ
 
	$g‘HashCode
()

85  
	`md5
(

86 
$this
->
‹xt
 .

87 
__CLASS__


89 
	}
}

94 
public
 
funùiÚ
 
	$__şÚe
()

96 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

97 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

98 ià(
	`is_objeù
(
$v®ue
)) {

99 
$this
->
$key
 = 
şÚe
 
$v®ue
;

101 
$this
->
$key
 = 
$v®ue
;

104 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Settings.php

1 <?
php


4 ià(!
defšed
('PHPEXCEL_ROOT')) {

8 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../');

9 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

37 şas 
	cPHPExûl_S‘tšgs


41 cÚ¡ 
	mPCLZIP
 = 'PHPExcel_Shared_ZipArchive';

42 cÚ¡ 
	mZIPARCHIVE
 = 'ZipArchive';

45 cÚ¡ 
	mCHART_RENDERER_JPGRAPH
 = 'jpgraph';

48 cÚ¡ 
	mPDF_RENDERER_TCPDF
 = 'tcPDF';

49 cÚ¡ 
	mPDF_RENDERER_DOMPDF
 = 'DomPDF';

50 cÚ¡ 
	mPDF_RENDERER_MPDF
 = 'mPDF';

53 
´iv©e
 
	m$ch¬tR’d””s
 = 
¬¿y
(

54 
£lf
::
CHART_RENDERER_JPGRAPH
,

57 
´iv©e
 
	m$pdfR’d””s
 = 
¬¿y
(

58 
£lf
::
PDF_RENDERER_TCPDF
,

59 
£lf
::
PDF_RENDERER_DOMPDF
,

60 
£lf
::
PDF_RENDERER_MPDF
,

71 
´iv©e
 
	m$zCÏss
 = 
£lf
::
ZIPARCHIVE
;

81 
´iv©e
 
	m$ch¬tR’d””Name
;

88 
´iv©e
 
	m$ch¬tR’d””P©h
;

98 
´iv©e
 
	m$pdfR’d””Name
;

105 
´iv©e
 
	m$pdfR’d””P©h
;

112 
´iv©e
 
	m$libXmlLßd”O±iÚs
 = 
nuÎ
;

121 
public
 
funùiÚ
 
	$£tZCÏss
(
$zCÏss
)

123 ià((
$zCÏss
 ==ğ
£lf
::
PCLZIP
) ||

124 (
$zCÏss
 ==ğ
£lf
::
ZIPARCHIVE
)) {

125 
£lf
::
$zCÏss
 = $zipClass;

126  
Œue
;

128  
çl£
;

140 
public
 
funùiÚ
 
	$g‘ZCÏss
()

142  
£lf
::
$zCÏss
;

143 
	}
}

151 
public
 
funùiÚ
 
	$g‘CacheStÜageM‘hod
()

153  
PHPExûl_CachedObjeùStÜageFaùÜy
::
	`g‘CacheStÜageM‘hod
();

154 
	}
}

162 
public
 
funùiÚ
 
	$g‘CacheStÜageCÏss
()

164  
PHPExûl_CachedObjeùStÜageFaùÜy
::
	`g‘CacheStÜageCÏss
();

165 
	}
}

175 
public
 
funùiÚ
 
£tCacheStÜageM‘hod
(
$m‘hod
 = 
PHPExûl_CachedObjeùStÜageFaùÜy
::
ÿche_š_memÜy
, 
$¬gum’ts
 = 
	$¬¿y
())

177  
PHPExûl_CachedObjeùStÜageFaùÜy
::
	`š™Ÿlize
(
$m‘hod
, 
$¬gum’ts
);

178 
	}
}

187 
public
 
funùiÚ
 
£tLoÿË
(
$loÿË
 = 'en_us')

189  
PHPExûl_C®cuÏtiÚ
::
g‘In¡ªû
()->
£tLoÿË
(
$loÿË
);

202 
public
 
funùiÚ
 
	$£tCh¬tR’d””
(
$lib¿ryName
, 
$lib¿ryBa£Dœ
)

204 ià(!
£lf
::
	`£tCh¬tR’d””Name
(
$lib¿ryName
)) {

205  
çl£
;

207  
£lf
::
	`£tCh¬tR’d””P©h
(
$lib¿ryBa£Dœ
);

208 
	}
}

219 
public
 
funùiÚ
 
	$£tCh¬tR’d””Name
(
$lib¿ryName
)

221 ià(!
	`š_¬¿y
(
$lib¿ryName
, 
£lf
::
$ch¬tR’d””s
)) {

222  
çl£
;

224 
£lf
::
$ch¬tR’d””Name
 = 
$lib¿ryName
;

226  
Œue
;

227 
	}
}

236 
public
 
funùiÚ
 
	$£tCh¬tR’d””P©h
(
$lib¿ryBa£Dœ
)

238 ià((
	`fe_exi¡s
(
$lib¿ryBa£Dœ
è==ğ
çl£
è|| (
	`is_»adabË
($libraryBaseDir) === false)) {

239  
çl£
;

241 
£lf
::
$ch¬tR’d””P©h
 = 
$lib¿ryBa£Dœ
;

243  
Œue
;

244 
	}
}

254 
public
 
funùiÚ
 
	$g‘Ch¬tR’d””Name
()

256  
£lf
::
$ch¬tR’d””Name
;

257 
	}
}

266 
public
 
funùiÚ
 
	$g‘Ch¬tR’d””P©h
()

268  
£lf
::
$ch¬tR’d””P©h
;

269 
	}
}

283 
public
 
funùiÚ
 
	$£tPdfR’d””
(
$lib¿ryName
, 
$lib¿ryBa£Dœ
)

285 ià(!
£lf
::
	`£tPdfR’d””Name
(
$lib¿ryName
)) {

286  
çl£
;

288  
£lf
::
	`£tPdfR’d””P©h
(
$lib¿ryBa£Dœ
);

289 
	}
}

302 
public
 
funùiÚ
 
	$£tPdfR’d””Name
(
$lib¿ryName
)

304 ià(!
	`š_¬¿y
(
$lib¿ryName
, 
£lf
::
$pdfR’d””s
)) {

305  
çl£
;

307 
£lf
::
$pdfR’d””Name
 = 
$lib¿ryName
;

309  
Œue
;

310 
	}
}

319 
public
 
funùiÚ
 
	$£tPdfR’d””P©h
(
$lib¿ryBa£Dœ
)

321 ià((
	`fe_exi¡s
(
$lib¿ryBa£Dœ
è==ğ
çl£
è|| (
	`is_»adabË
($libraryBaseDir) === false)) {

322  
çl£
;

324 
£lf
::
$pdfR’d””P©h
 = 
$lib¿ryBa£Dœ
;

326  
Œue
;

327 
	}
}

339 
public
 
funùiÚ
 
	$g‘PdfR’d””Name
()

341  
£lf
::
$pdfR’d””Name
;

342 
	}
}

350 
public
 
funùiÚ
 
	$g‘PdfR’d””P©h
()

352  
£lf
::
$pdfR’d””P©h
;

353 
	}
}

360 
public
 
funùiÚ
 
	$£tLibXmlLßd”O±iÚs
(
$İtiÚs
 = 
nuÎ
)

362 ià(
	`is_nuÎ
(
$İtiÚs
è&& 
	`defšed
(
LIBXML_DTDLOAD
)) {

363 
$İtiÚs
 = 
LIBXML_DTDLOAD
 | 
LIBXML_DTDATTR
;

365 ià(
	`v”siÚ_com·»
(
PHP_VERSION
, '5.2.11') >= 0) {

366 @
	`libxml_di§bË_’t™y_lßd”
(
$İtiÚs
 =ğ(
LIBXML_DTDLOAD
 | 
LIBXML_DTDATTR
));

368 
£lf
::
$libXmlLßd”O±iÚs
 = 
$İtiÚs
;

369 
	}
}

377 
public
 
funùiÚ
 
	$g‘LibXmlLßd”O±iÚs
()

379 ià(
	`is_nuÎ
(
£lf
::
$libXmlLßd”O±iÚs
è&& 
	`defšed
(
LIBXML_DTDLOAD
)) {

380 
£lf
::
	`£tLibXmlLßd”O±iÚs
(
LIBXML_DTDLOAD
 | 
LIBXML_DTDATTR
);

382 ià(
	`v”siÚ_com·»
(
PHP_VERSION
, '5.2.11') >= 0) {

383 @
	`libxml_di§bË_’t™y_lßd”
(
£lf
::
$libXmlLßd”O±iÚs
 =ğ(
LIBXML_DTDLOAD
 | 
LIBXML_DTDATTR
));

385  
£lf
::
$libXmlLßd”O±iÚs
;

386 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/CodePage.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_CodePage


38 
public
 
funùiÚ
 
	$Numb”ToName
(
$codePage
 = 1252)

40 
$codePage
) {

46 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Code…age 720‚ot supported.');

136 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Code…age 32769‚ot supported.');

142 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('UnknowÀcod•age: ' . 
$codePage
);

144 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Date.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_D©e


31 cÚ¡ 
	mCALENDAR_WINDOWS_1900
 = 1900;

32 cÚ¡ 
	mCALENDAR_MAC_1904
 = 1904;

41 
public
 
	m$mÚthNames
 = 
¬¿y
(

63 
public
 
	m$numb”Suffixes
 = 
¬¿y
(

76 
´Ùeùed
 
	m$exûlBa£D©e
 = 
£lf
::
CALENDAR_WINDOWS_1900
;

84 
public
 
funùiÚ
 
	$£tExûlC®’d¬
(
$ba£D©e
)

86 ià((
$ba£D©e
 =ğ
£lf
::
CALENDAR_WINDOWS_1900
) ||

87 (
$ba£D©e
 =ğ
£lf
::
CALENDAR_MAC_1904
)) {

88 
£lf
::
$exûlBa£D©e
 = 
$ba£D©e
;

89  
Œue
;

91  
çl£
;

100 
public
 
funùiÚ
 
	$g‘ExûlC®’d¬
()

102  
£lf
::
$exûlBa£D©e
;

103 
	}
}

115 
public
 
funùiÚ
 
	$ExûlToPHP
(
$d©eV®ue
 = 0, 
$adju¡ToTimezÚe
 = 
çl£
, 
$timezÚe
 = 
nuÎ
)

117 ià(
£lf
::
$exûlBa£D©e
 =ğ£lf::
CALENDAR_WINDOWS_1900
) {

118 
$myexûlBa£D©e
 = 25569;

120 ià(
$d©eV®ue
 < 60) {

121 --
$myexûlBa£D©e
;

124 
$myexûlBa£D©e
 = 24107;

128 ià(
$d©eV®ue
 >= 1) {

129 
$utcDays
 = 
$d©eV®ue
 - 
$myexûlBa£D©e
;

130 
$»tuºV®ue
 = 
	`round
(
$utcDays
 * 86400);

131 ià((
$»tuºV®ue
 <ğ
PHP_INT_MAX
) && ($returnValue >= -PHP_INT_MAX)) {

132 
$»tuºV®ue
 = (
š‹g”
) $returnValue;

135 
$hours
 = 
	`round
(
$d©eV®ue
 * 24);

136 
$mšs
 = 
	`round
(
$d©eV®ue
 * 1440è-„ound(
$hours
 * 60);

137 
$£cs
 = 
	`round
(
$d©eV®ue
 * 86400è-„ound(
$hours
 * 3600è-„ound(
$mšs
 * 60);

138 
$»tuºV®ue
 = (
š‹g”
è
	`gmmktime
(
$hours
, 
$mšs
, 
$£cs
);

141 
$timezÚeAdju¡m’t
 = (
$adju¡ToTimezÚe
) ?

142 
PHPExûl_Sh¬ed_TimeZÚe
::
	`g‘TimezÚeAdju¡m’t
(
$timezÚe
, 
$»tuºV®ue
) :

145  
$»tuºV®ue
 + 
$timezÚeAdju¡m’t
;

146 
	}
}

155 
public
 
funùiÚ
 
	$ExûlToPHPObjeù
(
$d©eV®ue
 = 0)

157 
$d©eTime
 = 
£lf
::
	`ExûlToPHP
(
$d©eV®ue
);

158 
$days
 = 
	`æoÜ
(
$d©eTime
 / 86400);

159 
$time
 = 
	`round
(((
$d©eTime
 / 86400è- 
$days
) * 86400);

160 
$hours
 = 
	`round
(
$time
 / 3600);

161 
$mšu‹s
 = 
	`round
(
$time
 / 60è- (
$hours
 * 60);

162 
$£cÚds
 = 
	`round
(
$time
è- (
$hours
 * 3600è- (
$mšu‹s
 * 60);

164 
$d©eObj
 = 
	`d©e_ü—‹
('1-Jª-1970+'.
$days
.' days');

165 
$d©eObj
->
	`£tTime
(
$hours
, 
$mšu‹s
, 
$£cÚds
);

167  
$d©eObj
;

168 
	}
}

181 
public
 
funùiÚ
 
	$PHPToExûl
(
$d©eV®ue
 = 0, 
$adju¡ToTimezÚe
 = 
çl£
, 
$timezÚe
 = 
nuÎ
)

183 
$§veTimeZÚe
 = 
	`d©e_deçuÉ_timezÚe_g‘
();

184 
	`d©e_deçuÉ_timezÚe_£t
('UTC');

185 
$»tV®ue
 = 
çl£
;

186 ià((
	`is_objeù
(
$d©eV®ue
)è&& ($d©eV®u
š¡ªûof
 
D©eTime
)) {

187 
$»tV®ue
 = 
£lf
::
	`FÜm©‹dPHPToExûl
(
$d©eV®ue
->
	`fÜm©
('Y'), $dateValue->format('m'), $dateValue->format('d'), $dateValue->format('H'), $dateValue->format('i'), $dateValue->format('s'));

188 } 
	`–£if
 (
	`is_num”ic
(
$d©eV®ue
)) {

189 
$»tV®ue
 = 
£lf
::
	`FÜm©‹dPHPToExûl
(
	`d©e
('Y', 
$d©eV®ue
), date('m', $dateValue), date('d', $dateValue), date('H', $dateValue), date('i', $dateValue), date('s', $dateValue));

191 
	`d©e_deçuÉ_timezÚe_£t
(
$§veTimeZÚe
);

193  
$»tV®ue
;

194 
	}
}

208 
public
 
funùiÚ
 
	$FÜm©‹dPHPToExûl
(
$y—r
, 
$mÚth
, 
$day
, 
$hours
 = 0, 
$mšu‹s
 = 0, 
$£cÚds
 = 0)

210 ià(
£lf
::
$exûlBa£D©e
 =ğ£lf::
CALENDAR_WINDOWS_1900
) {

215 
$exûl1900isL—pY—r
 = 
Œue
;

216 ià((
$y—r
 =ğ1900è&& (
$mÚth
 <= 2)) {

217 
$exûl1900isL—pY—r
 = 
çl£
;

219 
$myexûlBa£D©e
 = 2415020;

221 
$myexûlBa£D©e
 = 2416481;

222 
$exûl1900isL—pY—r
 = 
çl£
;

226 ià(
$mÚth
 > 2) {

227 
$mÚth
 -= 3;

229 
$mÚth
 += 9;

230 --
$y—r
;

234 
$ûÁury
 = 
	`sub¡r
(
$y—r
, 0, 2);

235 
$deÿde
 = 
	`sub¡r
(
$y—r
, 2, 2);

236 
$exûlD©e
 = 
	`æoÜ
((146097 * 
$ûÁury
è/ 4è+ floÜ((1461 * 
$deÿde
è/ 4è+ floÜ((153 * 
$mÚth
 + 2è/ 5è+ 
$day
 + 1721119 - 
$myexûlBa£D©e
 + 
$exûl1900isL—pY—r
;

238 
$exûlTime
 = ((
$hours
 * 3600è+ (
$mšu‹s
 * 60è+ 
$£cÚds
) / 86400;

240  (è
$exûlD©e
 + 
$exûlTime
;

241 
	}
}

250 
public
 
funùiÚ
 
	$isD©eTime
(
PHPExûl_C–l
 
$pC–l
)

252  
£lf
::
	`isD©eTimeFÜm©
(

253 
$pC–l
->
	`g‘WÜksh“t
()->
	`g‘StyË
(

254 
$pC–l
->
	`g‘CoÜdš©e
()

255 )->
	`g‘Numb”FÜm©
()

257 
	}
}

266 
public
 
funùiÚ
 
	$isD©eTimeFÜm©
(
PHPExûl_StyË_Numb”FÜm©
 
$pFÜm©
)

268  
£lf
::
	`isD©eTimeFÜm©Code
(
$pFÜm©
->
	`g‘FÜm©Code
());

269 
	}
}

272 
´iv©e
 
	g$possibËD©eFÜm©Ch¬aù”s
 = 'eymdHs';

280 
public
 
funùiÚ
 
isD©eTimeFÜm©Code
(
$pFÜm©Code
 = '')

282 ià(
¡¹Şow”
(
$pFÜm©Code
è==ğ¡¹Şow”(
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL
)) {

284  
çl£
;

286 ià(
´eg_m©ch
('/[0#]E[+-]0/i', 
$pFÜm©Code
)) {

288  
	gçl£
;

292 
	g$pFÜm©Code
) {

294 
	gPHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_YYYYMMDD
:

295 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_YYYYMMDD2
:

296 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_DDMMYYYY
:

297 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_DMYSLASH
:

298 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_DMYMINUS
:

299 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_DMMINUS
:

300 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_MYMINUS
:

301 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_DATETIME
:

302 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME1
:

303 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME2
:

304 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME3
:

305 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME4
:

306 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME5
:

307 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME6
:

308 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME7
:

309 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_TIME8
:

310 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_YYYYMMDDSLASH
:

311 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_XLSX14
:

312 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_XLSX15
:

313 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_XLSX16
:

314 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_XLSX17
:

315 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_DATE_XLSX22
:

316  
Œue
;

320 ià((
sub¡r
(
$pFÜm©Code
, 0, 1) == '_') || (substr($pFormatCode, 0, 2) == '0 ')) {

321  
çl£
;

324 ià(
´eg_m©ch
('/(^|\])[^\[]*['.
£lf
::
$possibËD©eFÜm©Ch¬aù”s
.']/i', 
$pFÜm©Code
)) {

327 ià(
¡½os
(
$pFÜm©Code
, '"'è!=ğ
çl£
) {

328 
$£gM©ch”
 = 
çl£
;

329 
fÜ—ch
 (
ex¶ode
('"', 
$pFÜm©Code
è
as
 
$subV®
) {

331 ià((
	g$£gM©ch”
 = !
$£gM©ch”
) &&

332 (
´eg_m©ch
('/(^|\])[^\[]*['.
£lf
::
$possibËD©eFÜm©Ch¬aù”s
.']/i', 
$subV®
))) {

333  
	gŒue
;

336  
	gçl£
;

338  
	gŒue
;

342  
	gçl£
;

352 
public
 
funùiÚ
 
¡ršgToExûl
(
$d©eV®ue
 = '')

354 ià(
¡¾’
(
$d©eV®ue
) < 2) {

355  
çl£
;

357 ià(!
´eg_m©ch
('/^(\d{1,4}[ \.\/\-][A-Z]{3,9}([ \.\/\-]\d{1,4})?|[A-Z]{3,9}[ \.\/\-]\d{1,4}([ \.\/\-]\d{1,4})?|\d{1,4}[ \.\/\-]\d{1,4}([ \.\/\-]\d{1,4})?)Ğ\d{1,2}:\d{1,2}(:\d{1,2})?)?$/iu', 
$d©eV®ue
)) {

358  
	gçl£
;

361 
	g$d©eV®ueNew
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
DATEVALUE
(
$d©eV®ue
);

363 ià(
	g$d©eV®ueNew
 ==ğ
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
()) {

364  
çl£
;

367 ià(
¡½os
(
$d©eV®ue
, ':'è!=ğ
çl£
) {

368 
$timeV®ue
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
TIMEVALUE
(
$d©eV®ue
);

369 ià(
	g$timeV®ue
 ==ğ
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
VALUE
()) {

370  
çl£
;

372 
	g$d©eV®ueNew
 +ğ
$timeV®ue
;

374  
	g$d©eV®ueNew
;

383 
public
 
funùiÚ
 
	$mÚthSŒšgToNumb”
(
$mÚth
)

385 
$mÚthIndex
 = 1;

386 
	`fÜ—ch
 (
£lf
::
$mÚthNames
 
as
 
$shÜtMÚthName
 => 
$lÚgMÚthName
) {

387 ià((
$mÚth
 ==ğ
$lÚgMÚthName
è|| ($mÚth ==ğ
$shÜtMÚthName
)) {

388  
$mÚthIndex
;

390 ++
$mÚthIndex
;

392  
$mÚth
;

393 
	}
}

401 
public
 
funùiÚ
 
	$daySŒšgToNumb”
(
$day
)

403 
$¡r³dDayV®ue
 = (
	`¡r_»¶aû
(
£lf
::
$numb”Suffixes
, '', 
$day
));

404 ià(
	`is_num”ic
(
$¡r³dDayV®ue
)) {

405  (
š‹g”
è
$¡r³dDayV®ue
;

407  
$day
;

408 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Drawing.php

1 <?
php


36 şas 
	cPHPExûl_Sh¬ed_D¿wšg


44 
public
 
funùiÚ
 
	$pix–sToEMU
(
$pV®ue
 = 0)

46  
	`round
(
$pV®ue
 * 9525);

55 
public
 
funùiÚ
 
	$EMUToPix–s
(
$pV®ue
 = 0)

57 ià(
$pV®ue
 != 0) {

58  
	`round
(
$pV®ue
 / 9525);

62 
	}
}

73 
public
 
funùiÚ
 
	$pix–sToC–lDim’siÚ
(
$pV®ue
 = 0, 
PHPExûl_StyË_FÚt
 
$pDeçuÉFÚt
)

76 
$Çme
 = 
$pDeçuÉFÚt
->
	`g‘Name
();

77 
$size
 = 
$pDeçuÉFÚt
->
	`g‘Size
();

79 ià(
	`is£t
(
PHPExûl_Sh¬ed_FÚt
::
$deçuÉCŞumnWidths
[
$Çme
][
$size
])) {

81 
$cŞWidth
 = 
$pV®ue
 * 
PHPExûl_Sh¬ed_FÚt
::
$deçuÉCŞumnWidths
[
$Çme
][
$size
]['width'] / PHPExcel_Shared_Font::$defaultColumnWidths[$name][$size]['px'];

85 
$cŞWidth
 = 
$pV®ue
 * 11 * 
PHPExûl_Sh¬ed_FÚt
::
$deçuÉCŞumnWidths
['C®ibri'][11]['width'] / PHPExûl_Sh¬ed_FÚt::$deçuÉCŞumnWidths['C®ibri'][11]['px'] / 
$size
;

88  
$cŞWidth
;

89 
	}
}

98 
public
 
funùiÚ
 
	$ûÎDim’siÚToPix–s
(
$pV®ue
 = 0, 
PHPExûl_StyË_FÚt
 
$pDeçuÉFÚt
)

101 
$Çme
 = 
$pDeçuÉFÚt
->
	`g‘Name
();

102 
$size
 = 
$pDeçuÉFÚt
->
	`g‘Size
();

104 ià(
	`is£t
(
PHPExûl_Sh¬ed_FÚt
::
$deçuÉCŞumnWidths
[
$Çme
][
$size
])) {

106 
$cŞWidth
 = 
$pV®ue
 * 
PHPExûl_Sh¬ed_FÚt
::
$deçuÉCŞumnWidths
[
$Çme
][
$size
]['px'] / PHPExcel_Shared_Font::$defaultColumnWidths[$name][$size]['width'];

110 
$cŞWidth
 = 
$pV®ue
 * 
$size
 * 
PHPExûl_Sh¬ed_FÚt
::
$deçuÉCŞumnWidths
['Calibri'][11]['px'] / PHPExcel_Shared_Font::$defaultColumnWidths['Calibri'][11]['width'] / 11;

114 
$cŞWidth
 = (è
	`round
($colWidth);

116  
$cŞWidth
;

117 
	}
}

125 
public
 
funùiÚ
 
	$pix–sToPošts
(
$pV®ue
 = 0)

127  
$pV®ue
 * 0.67777777;

128 
	}
}

136 
public
 
funùiÚ
 
	$poštsToPix–s
(
$pV®ue
 = 0)

138 ià(
$pV®ue
 != 0) {

139  (è
	`û
(
$pV®ue
 * 1.333333333);

143 
	}
}

151 
public
 
funùiÚ
 
	$deg»esToAngË
(
$pV®ue
 = 0)

153  ()
	`round
(
$pV®ue
 * 60000);

154 
	}
}

162 
public
 
funùiÚ
 
	$ªgËToDeg»es
(
$pV®ue
 = 0)

164 ià(
$pV®ue
 != 0) {

165  
	`round
(
$pV®ue
 / 60000);

169 
	}
}

178 
public
 
funùiÚ
 
	$imageü—‹äombmp
(
$p_sFe
)

181 
$fe
 = 
	`fİ’
(
$p_sFe
, "rb");

182 
$»ad
 = 
	`ä—d
(
$fe
, 10);

183 !
	`ãof
(
$fe
è&& (
$»ad
<>"")) {

184 
$»ad
 .ğ
	`ä—d
(
$fe
, 1024);

187 
$‹mp
 = 
	`uÅack
("H*", 
$»ad
);

188 
$hex
 = 
$‹mp
[1];

189 
$h—d”
 = 
	`sub¡r
(
$hex
, 0, 108);

193 ià(
	`sub¡r
(
$h—d”
, 0, 4)=="424d") {

195 
$h—d”_·¹s
 = 
	`¡r_¥l™
(
$h—d”
, 2);

198 
$width
 = 
	`hexdec
(
$h—d”_·¹s
[19].$header_parts[18]);

201 
$height
 = 
	`hexdec
(
$h—d”_·¹s
[23].$header_parts[22]);

204 
	`un£t
(
$h—d”_·¹s
);

208 
$x
 = 0;

209 
$y
 = 1;

212 
$image
 = 
	`imageü—‹ŒuecŞÜ
(
$width
, 
$height
);

215 
$body
 = 
	`sub¡r
(
$hex
, 108);

220 
$body_size
 = (
	`¡¾’
(
$body
)/2);

221 
$h—d”_size
 = (
$width
*
$height
);

224 
$u£Paddšg
 = (
$body_size
>(
$h—d”_size
*3)+4);

228 
$i
 = 0; $˜< 
$body_size
; $i += 3) {

230 ià(
$x
 >ğ
$width
) {

233 ià(
$u£Paddšg
) {

234 
$i
 +ğ
$width
%4;

238 
$x
 = 0;

241 
$y
++;

244 ià(
$y
 > 
$height
) {

251 
$i_pos
 = 
$i
 * 2;

252 
$r
 = 
	`hexdec
(
$body
[
$i_pos
+4].$body[$i_pos+5]);

253 
$g
 = 
	`hexdec
(
$body
[
$i_pos
+2].$body[$i_pos+3]);

254 
$b
 = 
	`hexdec
(
$body
[
$i_pos
].$body[$i_pos+1]);

257 
$cŞÜ
 = 
	`imagecŞÜ®loÿ‹
(
$image
, 
$r
, 
$g
, 
$b
);

258 
	`image£ix–
(
$image
, 
$x
, 
$height
-
$y
, 
$cŞÜ
);

261 
$x
++;

265 
	`un£t
(
$body
);

268  
$image
;

269 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_Esch”


35 
´iv©e
 
	m$dggCÚš”
;

42 
´iv©e
 
	m$dgCÚš”
;

49 
public
 
funùiÚ
 
	$g‘DggCÚš”
()

51  
$this
->
dggCÚš”
;

59 
public
 
funùiÚ
 
	$£tDggCÚš”
(
$dggCÚš”
)

61  
$this
->
dggCÚš”
 = 
$dggCÚš”
;

62 
	}
}

69 
public
 
funùiÚ
 
	$g‘DgCÚš”
()

71  
$this
->
dgCÚš”
;

72 
	}
}

79 
public
 
funùiÚ
 
	$£tDgCÚš”
(
$dgCÚš”
)

81  
$this
->
dgCÚš”
 = 
$dgCÚš”
;

82 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DgContainer.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_Esch”_DgCÚš”


35 
´iv©e
 
	m$dgId
;

42 
´iv©e
 
	m$Ï¡SpId
;

44 
´iv©e
 
	m$¥grCÚš”
 = 
nuÎ
;

46 
public
 
funùiÚ
 
	$g‘DgId
()

48  
$this
->
dgId
;

51 
public
 
funùiÚ
 
	$£tDgId
(
$v®ue
)

53 
$this
->
dgId
 = 
$v®ue
;

54 
	}
}

56 
public
 
funùiÚ
 
	$g‘La¡SpId
()

58  
$this
->
Ï¡SpId
;

59 
	}
}

61 
public
 
funùiÚ
 
	$£tLa¡SpId
(
$v®ue
)

63 
$this
->
Ï¡SpId
 = 
$v®ue
;

64 
	}
}

66 
public
 
funùiÚ
 
	$g‘SpgrCÚš”
()

68  
$this
->
¥grCÚš”
;

69 
	}
}

71 
public
 
funùiÚ
 
	$£tSpgrCÚš”
(
$¥grCÚš”
)

73  
$this
->
¥grCÚš”
 = 
$¥grCÚš”
;

74 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DgContainer/SpgrContainer.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_Esch”_DgCÚš”_SpgrCÚš”


35 
´iv©e
 
	m$·»Á
;

42 
´iv©e
 
	m$chd»n
 = 
¬¿y
();

49 
public
 
funùiÚ
 
	$£tP¬’t
(
$·»Á
)

51 
$this
->
·»Á
 = 
$·»Á
;

59 
public
 
funùiÚ
 
	$g‘P¬’t
()

61  
$this
->
·»Á
;

62 
	}
}

69 
public
 
funùiÚ
 
	$addChd
(
$chd
)

71 
$this
->
chd»n
[] = 
$chd
;

72 
$chd
->
	`£tP¬’t
(
$this
);

73 
	}
}

78 
public
 
funùiÚ
 
	$g‘Chd»n
()

80  
$this
->
chd»n
;

81 
	}
}

88 
public
 
funùiÚ
 
	$g‘AÎSpCÚš”s
()

90 
$®lSpCÚš”s
 = 
	`¬¿y
();

92 
	`fÜ—ch
 (
$this
->
chd»n
 
as
 
$chd
) {

93 ià(
$chd
 
š¡ªûof
 
PHPExûl_Sh¬ed_Esch”_DgCÚš”_SpgrCÚš”
) {

94 
$®lSpCÚš”s
 = 
	`¬¿y_m”ge
($®lSpCÚš”s, 
$chd
->
	`g‘AÎSpCÚš”s
());

96 
$®lSpCÚš”s
[] = 
$chd
;

100  
$®lSpCÚš”s
;

101 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DgContainer/SpgrContainer/SpContainer.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_Esch”_DgCÚš”_SpgrCÚš”_SpCÚš”


35 
´iv©e
 
	m$·»Á
;

42 
´iv©e
 
	m$¥gr
 = 
çl£
;

49 
´iv©e
 
	m$¥Ty³
;

56 
´iv©e
 
	m$¥FÏg
;

63 
´iv©e
 
	m$¥Id
;

70 
´iv©e
 
	m$OPT
;

77 
´iv©e
 
	m$¡¬tCoÜdš©es
;

84 
´iv©e
 
	m$¡¬tOff£tX
;

91 
´iv©e
 
	m$¡¬tOff£tY
;

98 
´iv©e
 
	m$’dCoÜdš©es
;

105 
´iv©e
 
	m$’dOff£tX
;

112 
´iv©e
 
	m$’dOff£tY
;

119 
public
 
funùiÚ
 
	$£tP¬’t
(
$·»Á
)

121 
$this
->
·»Á
 = 
$·»Á
;

129 
public
 
funùiÚ
 
	$g‘P¬’t
()

131  
$this
->
·»Á
;

132 
	}
}

139 
public
 
funùiÚ
 
	$£tSpgr
(
$v®ue
 = 
çl£
)

141 
$this
->
¥gr
 = 
$v®ue
;

142 
	}
}

149 
public
 
funùiÚ
 
	$g‘Spgr
()

151  
$this
->
¥gr
;

152 
	}
}

159 
public
 
funùiÚ
 
	$£tSpTy³
(
$v®ue
)

161 
$this
->
¥Ty³
 = 
$v®ue
;

162 
	}
}

169 
public
 
funùiÚ
 
	$g‘SpTy³
()

171  
$this
->
¥Ty³
;

172 
	}
}

179 
public
 
funùiÚ
 
	$£tSpFÏg
(
$v®ue
)

181 
$this
->
¥FÏg
 = 
$v®ue
;

182 
	}
}

189 
public
 
funùiÚ
 
	$g‘SpFÏg
()

191  
$this
->
¥FÏg
;

192 
	}
}

199 
public
 
funùiÚ
 
	$£tSpId
(
$v®ue
)

201 
$this
->
¥Id
 = 
$v®ue
;

202 
	}
}

209 
public
 
funùiÚ
 
	$g‘SpId
()

211  
$this
->
¥Id
;

212 
	}
}

220 
public
 
funùiÚ
 
	$£tOPT
(
$´İ”ty
, 
$v®ue
)

222 
$this
->
OPT
[
$´İ”ty
] = 
$v®ue
;

223 
	}
}

231 
public
 
funùiÚ
 
	$g‘OPT
(
$´İ”ty
)

233 ià(
	`is£t
(
$this
->
OPT
[
$´İ”ty
])) {

234  
$this
->
OPT
[
$´İ”ty
];

236  
nuÎ
;

237 
	}
}

244 
public
 
funùiÚ
 
	$g‘OPTCŞËùiÚ
()

246  
$this
->
OPT
;

247 
	}
}

254 
public
 
funùiÚ
 
£tS¹CoÜdš©es
(
$v®ue
 = 'A1')

256 
$this
->
¡¬tCoÜdš©es
 = 
$v®ue
;

264 
public
 
funùiÚ
 
	$g‘S¹CoÜdš©es
()

266  
$this
->
¡¬tCoÜdš©es
;

267 
	}
}

274 
public
 
funùiÚ
 
	$£tS¹Off£tX
(
$¡¬tOff£tX
 = 0)

276 
$this
->
¡¬tOff£tX
 = 
$¡¬tOff£tX
;

277 
	}
}

284 
public
 
funùiÚ
 
	$g‘S¹Off£tX
()

286  
$this
->
¡¬tOff£tX
;

287 
	}
}

294 
public
 
funùiÚ
 
	$£tS¹Off£tY
(
$¡¬tOff£tY
 = 0)

296 
$this
->
¡¬tOff£tY
 = 
$¡¬tOff£tY
;

297 
	}
}

304 
public
 
funùiÚ
 
	$g‘S¹Off£tY
()

306  
$this
->
¡¬tOff£tY
;

307 
	}
}

314 
public
 
funùiÚ
 
£tEndCoÜdš©es
(
$v®ue
 = 'A1')

316 
$this
->
’dCoÜdš©es
 = 
$v®ue
;

324 
public
 
funùiÚ
 
	$g‘EndCoÜdš©es
()

326  
$this
->
’dCoÜdš©es
;

327 
	}
}

334 
public
 
funùiÚ
 
	$£tEndOff£tX
(
$’dOff£tX
 = 0)

336 
$this
->
’dOff£tX
 = 
$’dOff£tX
;

337 
	}
}

344 
public
 
funùiÚ
 
	$g‘EndOff£tX
()

346  
$this
->
’dOff£tX
;

347 
	}
}

354 
public
 
funùiÚ
 
	$£tEndOff£tY
(
$’dOff£tY
 = 0)

356 
$this
->
’dOff£tY
 = 
$’dOff£tY
;

357 
	}
}

364 
public
 
funùiÚ
 
	$g‘EndOff£tY
()

366  
$this
->
’dOff£tY
;

367 
	}
}

376 
public
 
funùiÚ
 
	$g‘Ne¡šgLev–
()

378 
$Ã¡šgLev–
 = 0;

380 
$·»Á
 = 
$this
->
	`g‘P¬’t
();

381 
$·»Á
 
š¡ªûof
 
PHPExûl_Sh¬ed_Esch”_DgCÚš”_SpgrCÚš”
) {

382 ++
$Ã¡šgLev–
;

383 
$·»Á
 = $·»Á->
	`g‘P¬’t
();

386  
$Ã¡šgLev–
;

387 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DggContainer.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_Esch”_DggCÚš”


35 
´iv©e
 
	m$¥IdMax
;

42 
´iv©e
 
	m$cDgSaved
;

49 
´iv©e
 
	m$cSpSaved
;

56 
´iv©e
 
	m$b¡ÜeCÚš”
;

63 
´iv©e
 
	m$OPT
 = 
¬¿y
();

70 
´iv©e
 
	m$IDCLs
 = 
¬¿y
();

77 
public
 
funùiÚ
 
	$g‘SpIdMax
()

79  
$this
->
¥IdMax
;

87 
public
 
funùiÚ
 
	$£tSpIdMax
(
$v®ue
)

89 
$this
->
¥IdMax
 = 
$v®ue
;

90 
	}
}

97 
public
 
funùiÚ
 
	$g‘CDgSaved
()

99  
$this
->
cDgSaved
;

100 
	}
}

107 
public
 
funùiÚ
 
	$£tCDgSaved
(
$v®ue
)

109 
$this
->
cDgSaved
 = 
$v®ue
;

110 
	}
}

117 
public
 
funùiÚ
 
	$g‘CSpSaved
()

119  
$this
->
cSpSaved
;

120 
	}
}

127 
public
 
funùiÚ
 
	$£tCSpSaved
(
$v®ue
)

129 
$this
->
cSpSaved
 = 
$v®ue
;

130 
	}
}

137 
public
 
funùiÚ
 
	$g‘B¡ÜeCÚš”
()

139  
$this
->
b¡ÜeCÚš”
;

140 
	}
}

147 
public
 
funùiÚ
 
	$£tB¡ÜeCÚš”
(
$b¡ÜeCÚš”
)

149 
$this
->
b¡ÜeCÚš”
 = 
$b¡ÜeCÚš”
;

150 
	}
}

158 
public
 
funùiÚ
 
	$£tOPT
(
$´İ”ty
, 
$v®ue
)

160 
$this
->
OPT
[
$´İ”ty
] = 
$v®ue
;

161 
	}
}

169 
public
 
funùiÚ
 
	$g‘OPT
(
$´İ”ty
)

171 ià(
	`is£t
(
$this
->
OPT
[
$´İ”ty
])) {

172  
$this
->
OPT
[
$´İ”ty
];

174  
nuÎ
;

175 
	}
}

182 
public
 
funùiÚ
 
	$g‘IDCLs
()

184  
$this
->
IDCLs
;

185 
	}
}

192 
public
 
funùiÚ
 
	$£tIDCLs
(
$pV®ue
)

194 
$this
->
IDCLs
 = 
$pV®ue
;

195 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DggContainer/BstoreContainer.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”


35 
´iv©e
 
	m$BSECŞËùiÚ
 = 
¬¿y
();

42 
public
 
funùiÚ
 
	$addBSE
(
$BSE
)

44 
$this
->
BSECŞËùiÚ
[] = 
$BSE
;

45 
$BSE
->
	`£tP¬’t
(
$this
);

53 
public
 
funùiÚ
 
	$g‘BSECŞËùiÚ
()

55  
$this
->
BSECŞËùiÚ
;

56 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DggContainer/BstoreContainer/BSE.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE


30 cÚ¡ 
	mBLIPTYPE_ERROR
 = 0x00;

31 cÚ¡ 
	mBLIPTYPE_UNKNOWN
 = 0x01;

32 cÚ¡ 
	mBLIPTYPE_EMF
 = 0x02;

33 cÚ¡ 
	mBLIPTYPE_WMF
 = 0x03;

34 cÚ¡ 
	mBLIPTYPE_PICT
 = 0x04;

35 cÚ¡ 
	mBLIPTYPE_JPEG
 = 0x05;

36 cÚ¡ 
	mBLIPTYPE_PNG
 = 0x06;

37 cÚ¡ 
	mBLIPTYPE_DIB
 = 0x07;

38 cÚ¡ 
	mBLIPTYPE_TIFF
 = 0x11;

39 cÚ¡ 
	mBLIPTYPE_CMYKJPEG
 = 0x12;

46 
´iv©e
 
	m$·»Á
;

53 
´iv©e
 
	m$bl
;

60 
´iv©e
 
	m$blTy³
;

67 
public
 
funùiÚ
 
	$£tP¬’t
(
$·»Á
)

69 
$this
->
·»Á
 = 
$·»Á
;

77 
public
 
funùiÚ
 
	$g‘Bl
()

79  
$this
->
bl
;

80 
	}
}

87 
public
 
funùiÚ
 
	$£tBl
(
$bl
)

89 
$this
->
bl
 = 
$bl
;

90 
$bl
->
	`£tP¬’t
(
$this
);

91 
	}
}

98 
public
 
funùiÚ
 
	$g‘BlTy³
()

100  
$this
->
blTy³
;

101 
	}
}

108 
public
 
funùiÚ
 
	$£tBlTy³
(
$blTy³
)

110 
$this
->
blTy³
 = 
$blTy³
;

111 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DggContainer/BstoreContainer/BSE/Blip.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE_Bl


35 
´iv©e
 
	m$·»Á
;

42 
´iv©e
 
	m$d©a
;

49 
public
 
funùiÚ
 
	$g‘D©a
()

51  
$this
->
d©a
;

59 
public
 
funùiÚ
 
	$£tD©a
(
$d©a
)

61 
$this
->
d©a
 = 
$d©a
;

62 
	}
}

69 
public
 
funùiÚ
 
	$£tP¬’t
(
$·»Á
)

71 
$this
->
·»Á
 = 
$·»Á
;

72 
	}
}

79 
public
 
funùiÚ
 
	$g‘P¬’t
()

81  
$this
->
·»Á
;

82 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Excel5.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_Exûl5


39 
public
 
funùiÚ
 
sizeCŞ
(
$sh“t
, 
$cŞ
 = 'A')

42 
$fÚt
 = 
$sh“t
->
g‘P¬’t
()->
g‘DeçuÉStyË
()->
g‘FÚt
();

44 
	m$cŞumnDim’siÚs
 = 
$sh“t
->
g‘CŞumnDim’siÚs
();

47 ià(
is£t
(
$cŞumnDim’siÚs
[
$cŞ
]è
ªd
 
	m$cŞumnDim’siÚs
[$cŞ]->
g‘Width
() != -1) {

49 
$cŞumnDim’siÚ
 = 
$cŞumnDim’siÚs
[
$cŞ
];

50 
	m$width
 = 
$cŞumnDim’siÚ
->
g‘Width
();

51 
	m$pix–Width
 = 
PHPExûl_Sh¬ed_D¿wšg
::
ûÎDim’siÚToPix–s
(
$width
, 
$fÚt
);

52 } 
–£if
 (
$sh“t
->
g‘DeçuÉCŞumnDim’siÚ
()->
g‘Width
() != -1) {

54 
$deçuÉCŞumnDim’siÚ
 = 
$sh“t
->
g‘DeçuÉCŞumnDim’siÚ
();

55 
	m$width
 = 
$deçuÉCŞumnDim’siÚ
->
g‘Width
();

56 
	m$pix–Width
 = 
PHPExûl_Sh¬ed_D¿wšg
::
ûÎDim’siÚToPix–s
(
$width
, 
$fÚt
);

59 
	m$pix–Width
 = 
PHPExûl_Sh¬ed_FÚt
::
g‘DeçuÉCŞumnWidthByFÚt
(
$fÚt
, 
Œue
);

63 ià(
is£t
(
$cŞumnDim’siÚs
[
$cŞ
]è
	mªd
 !
	m$cŞumnDim’siÚs
[$cŞ]->
g‘VisibË
()) {

64 
	m$efãùivePix–Width
 = 0;

66 
	m$efãùivePix–Width
 = 
$pix–Width
;

69  
	m$efãùivePix–Width
;

81 
public
 
funùiÚ
 
	$sizeRow
(
$sh“t
, 
$row
 = 1)

84 
$fÚt
 = 
$sh“t
->
	`g‘P¬’t
()->
	`g‘DeçuÉStyË
()->
	`g‘FÚt
();

86 
$rowDim’siÚs
 = 
$sh“t
->
	`g‘RowDim’siÚs
();

89 ià(
	`is£t
(
$rowDim’siÚs
[
$row
]è
ªd
 $rowDim’siÚs[$row]->
	`g‘RowHeight
() != -1) {

91 
$rowDim’siÚ
 = 
$rowDim’siÚs
[
$row
];

92 
$rowHeight
 = 
$rowDim’siÚ
->
	`g‘RowHeight
();

93 
$pix–RowHeight
 = (è
	`û
(4 * 
$rowHeight
 / 3);

94 } 
	`–£if
 (
$sh“t
->
	`g‘DeçuÉRowDim’siÚ
()->
	`g‘RowHeight
() != -1) {

96 
$deçuÉRowDim’siÚ
 = 
$sh“t
->
	`g‘DeçuÉRowDim’siÚ
();

97 
$rowHeight
 = 
$deçuÉRowDim’siÚ
->
	`g‘RowHeight
();

98 
$pix–RowHeight
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`poštsToPix–s
(
$rowHeight
);

101 
$poštRowHeight
 = 
PHPExûl_Sh¬ed_FÚt
::
	`g‘DeçuÉRowHeightByFÚt
(
$fÚt
);

102 
$pix–RowHeight
 = 
PHPExûl_Sh¬ed_FÚt
::
	`fÚtSizeToPix–s
(
$poštRowHeight
);

106 ià(
	`is£t
(
$rowDim’siÚs
[
$row
]è
ªd
 !$rowDim’siÚs[$row]->
	`g‘VisibË
()) {

107 
$efãùivePix–RowHeight
 = 0;

109 
$efãùivePix–RowHeight
 = 
$pix–RowHeight
;

112  
$efãùivePix–RowHeight
;

113 
	}
}

126 
public
 
funùiÚ
 
g‘Di¡ªûX
(
PHPExûl_WÜksh“t
 
$sh“t
, 
$¡¬tCŞumn
 = 'A', 
$¡¬tOff£tX
 = 0, 
$’dCŞumn
 = 'A', 
$’dOff£tX
 = 0)

128 
$di¡ªûX
 = 0;

131 
	g$¡¬tCŞumnIndex
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$¡¬tCŞumn
) - 1;

132 
	g$’dCŞumnIndex
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$’dCŞumn
) - 1;

133 
	g$i
 = 
$¡¬tCŞumnIndex
; $˜<ğ
$’dCŞumnIndex
; ++$i) {

134 
	g$di¡ªûX
 +ğ
£lf
::
sizeCŞ
(
$sh“t
, 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$i
));

138 
	g$di¡ªûX
 -ğ(è
æoÜ
(
£lf
::
sizeCŞ
(
$sh“t
, 
$¡¬tCŞumn
è* 
$¡¬tOff£tX
 / 1024);

141 
	g$di¡ªûX
 -ğ(è
æoÜ
(
£lf
::
sizeCŞ
(
$sh“t
, 
$’dCŞumn
è* (1 - 
$’dOff£tX
 / 1024));

143  
	g$di¡ªûX
;

157 
public
 
funùiÚ
 
	$g‘Di¡ªûY
(
PHPExûl_WÜksh“t
 
$sh“t
, 
$¡¬tRow
 = 1, 
$¡¬tOff£tY
 = 0, 
$’dRow
 = 1, 
$’dOff£tY
 = 0)

159 
$di¡ªûY
 = 0;

162 
$row
 = 
$¡¬tRow
; $row <ğ
$’dRow
; ++$row) {

163 
$di¡ªûY
 +ğ
£lf
::
	`sizeRow
(
$sh“t
, 
$row
);

167 
$di¡ªûY
 -ğ(è
	`æoÜ
(
£lf
::
	`sizeRow
(
$sh“t
, 
$¡¬tRow
è* 
$¡¬tOff£tY
 / 256);

170 
$di¡ªûY
 -ğ(è
	`æoÜ
(
£lf
::
	`sizeRow
(
$sh“t
, 
$’dRow
è* (1 - 
$’dOff£tY
 / 256));

172  
$di¡ªûY
;

173 
	}
}

227 
public
 
funùiÚ
 
	$ÚeAnchÜ2twoAnchÜ
(
$sh“t
, 
$coÜdš©es
, 
$off£tX
, 
$off£tY
, 
$width
, 
$height
)

229 
	`li¡
(
$cŞumn
, 
$row
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$coÜdš©es
);

230 
$cŞ_¡¬t
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞumn
) - 1;

231 
$row_¡¬t
 = 
$row
 - 1;

233 
$x1
 = 
$off£tX
;

234 
$y1
 = 
$off£tY
;

237 
$cŞ_’d
 = 
$cŞ_¡¬t
;

238 
$row_’d
 = 
$row_¡¬t
;

241 ià(
$x1
 >ğ
£lf
::
	`sizeCŞ
(
$sh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_¡¬t
))) {

242 
$x1
 = 0;

244 ià(
$y1
 >ğ
£lf
::
	`sizeRow
(
$sh“t
, 
$row_¡¬t
 + 1)) {

245 
$y1
 = 0;

248 
$width
 = $width + 
$x1
 -1;

249 
$height
 = $heighˆ+ 
$y1
 -1;

252 
$width
 >ğ
£lf
::
	`sizeCŞ
(
$sh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_’d
))) {

253 
$width
 -ğ
£lf
::
	`sizeCŞ
(
$sh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_’d
));

254 ++
$cŞ_’d
;

258 
$height
 >ğ
£lf
::
	`sizeRow
(
$sh“t
, 
$row_’d
 + 1)) {

259 
$height
 -ğ
£lf
::
	`sizeRow
(
$sh“t
, 
$row_’d
 + 1);

260 ++
$row_’d
;

265 ià(
£lf
::
	`sizeCŞ
(
$sh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_¡¬t
)) == 0) {

268 ià(
£lf
::
	`sizeCŞ
(
$sh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_’d
)) == 0) {

271 ià(
£lf
::
	`sizeRow
(
$sh“t
, 
$row_¡¬t
 + 1) == 0) {

274 ià(
£lf
::
	`sizeRow
(
$sh“t
, 
$row_’d
 + 1) == 0) {

279 
$x1
 = $x1 / 
£lf
::
	`sizeCŞ
(
$sh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_¡¬t
)) * 1024;

280 
$y1
 = $y1 / 
£lf
::
	`sizeRow
(
$sh“t
, 
$row_¡¬t
 + 1) * 256;

281 
$x2
 = (
$width
 + 1è/ 
£lf
::
	`sizeCŞ
(
$sh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_’d
)) * 1024;

282 
$y2
 = (
$height
 + 1è/ 
£lf
::
	`sizeRow
(
$sh“t
, 
$row_’d
 + 1) * 256;

284 
$¡¬tCoÜdš©es
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_¡¬t
è. (
$row_¡¬t
 + 1);

285 
$’dCoÜdš©es
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_’d
è. (
$row_’d
 + 1);

287 
$twoAnchÜ
 = 
	`¬¿y
(

288 '¡¬tCoÜdš©es' => 
$¡¬tCoÜdš©es
,

289 '¡¬tOff£tX' => 
$x1
,

290 '¡¬tOff£tY' => 
$y1
,

291 '’dCoÜdš©es' => 
$’dCoÜdš©es
,

292 '’dOff£tX' => 
$x2
,

293 '’dOff£tY' => 
$y2
,

296  
$twoAnchÜ
;

297 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/File.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_Fe


36 
´Ùeùed
 
	m$u£U¶ßdTempDœeùÜy
 = 
çl£
;

44 
public
 
funùiÚ
 
	$£tU£U¶ßdTempDœeùÜy
(
$u£U¶ßdTempDœ
 = 
çl£
)

46 
£lf
::
$u£U¶ßdTempDœeùÜy
 = (
boŞ—n
è
$u£U¶ßdTempDœ
;

55 
public
 
funùiÚ
 
	$g‘U£U¶ßdTempDœeùÜy
()

57  
£lf
::
$u£U¶ßdTempDœeùÜy
;

58 
	}
}

67 
public
 
funùiÚ
 
	$fe_exi¡s
(
$pF’ame
)

72 ià(
	`¡¹Şow”
(
	`sub¡r
(
$pF’ame
, 0, 3)) == 'zip') {

74 
$zFe
 = 
	`sub¡r
(
$pF’ame
, 6, 
	`¡½os
($pFilename, '#') - 6);

75 
$¬chiveFe
 = 
	`sub¡r
(
$pF’ame
, 
	`¡½os
($pFilename, '#') + 1);

77 
$z
 = 
Ãw
 
	`ZArchive
();

78 ià(
$z
->
	`İ’
(
$zFe
è==ğ
Œue
) {

79 
$»tuºV®ue
 = (
$z
->
	`g‘FromName
(
$¬chiveFe
è!=ğ
çl£
);

80 
$z
->
	`şo£
();

81  
$»tuºV®ue
;

83  
çl£
;

87  
	`fe_exi¡s
(
$pF’ame
);

89 
	}
}

97 
public
 
funùiÚ
 
	$»®·th
(
$pF’ame
)

100 
$»tuºV®ue
 = '';

103 ià(
	`fe_exi¡s
(
$pF’ame
)) {

104 
$»tuºV®ue
 = 
	`»®·th
(
$pF’ame
);

108 ià(
$»tuºV®ue
 =ğ'' || ($»tuºV®u==ğ
nuÎ
)) {

109 
$·thA¼ay
 = 
	`ex¶ode
('/', 
$pF’ame
);

110 
	`š_¬¿y
('..', 
$·thA¼ay
) && $pathArray[0] != '..') {

111 
$i
 = 0; $˜< 
	`couÁ
(
$·thA¼ay
); ++$i) {

112 ià(
$·thA¼ay
[
$i
] == '..' && $i > 0) {

113 
	`un£t
(
$·thA¼ay
[
$i
]);

114 
	`un£t
(
$·thA¼ay
[
$i
 - 1]);

119 
$»tuºV®ue
 = 
	`im¶ode
('/', 
$·thA¼ay
);

123  
$»tuºV®ue
;

124 
	}
}

131 
public
 
funùiÚ
 
	$sys_g‘_‹mp_dœ
()

133 ià(
£lf
::
$u£U¶ßdTempDœeùÜy
) {

136 ià(
	`ši_g‘
('u¶ßd_tmp_dœ'è!=ğ
çl£
) {

137 ià(
$‹mp
 = 
	`ši_g‘
('upload_tmp_dir')) {

138 ià(
	`fe_exi¡s
(
$‹mp
)) {

139  
	`»®·th
(
$‹mp
);

147 ià(!
	`funùiÚ_exi¡s
('sys_get_temp_dir')) {

148 ià(
$‹mp
 = 
	`g‘’v
('TMP')) {

149 ià((!
	`em±y
(
$‹mp
)è&& (
	`fe_exi¡s
($temp))) {

150  
	`»®·th
(
$‹mp
);

153 ià(
$‹mp
 = 
	`g‘’v
('TEMP')) {

154 ià((!
	`em±y
(
$‹mp
)è&& (
	`fe_exi¡s
($temp))) {

155  
	`»®·th
(
$‹mp
);

158 ià(
$‹mp
 = 
	`g‘’v
('TMPDIR')) {

159 ià((!
	`em±y
(
$‹mp
)è&& (
	`fe_exi¡s
($temp))) {

160  
	`»®·th
(
$‹mp
);

166 
$‹mp
 = 
	`‹m²am
(
__FILE__
, '');

167 ià(
	`fe_exi¡s
(
$‹mp
)) {

168 
	`uÆšk
(
$‹mp
);

169  
	`»®·th
(
	`dœÇme
(
$‹mp
));

172  
nuÎ
;

178  
	`»®·th
(
	`sys_g‘_‹mp_dœ
());

179 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Font.php

1 <?
php


36 şas 
	cPHPExûl_Sh¬ed_FÚt


39 cÚ¡ 
	mAUTOSIZE_METHOD_APPROX
 = 'approx';

40 cÚ¡ 
	mAUTOSIZE_METHOD_EXACT
 = 'exact';

42 
´iv©e
 
	m$autoSizeM‘hods
 = 
¬¿y
(

43 
£lf
::
AUTOSIZE_METHOD_APPROX
,

44 
£lf
::
AUTOSIZE_METHOD_EXACT
,

48 cÚ¡ 
	mCHARSET_ANSI_LATIN
 = 0x00;

49 cÚ¡ 
	mCHARSET_SYSTEM_DEFAULT
 = 0x01;

50 cÚ¡ 
	mCHARSET_SYMBOL
 = 0x02;

51 cÚ¡ 
	mCHARSET_APPLE_ROMAN
 = 0x4D;

52 cÚ¡ 
	mCHARSET_ANSI_JAPANESE_SHIFTJIS
 = 0x80;

53 cÚ¡ 
	mCHARSET_ANSI_KOREAN_HANGUL
 = 0x81;

54 cÚ¡ 
	mCHARSET_ANSI_KOREAN_JOHAB
 = 0x82;

55 cÚ¡ 
	mCHARSET_ANSI_CHINESE_SIMIPLIFIED
 = 0x86;

56 cÚ¡ 
	mCHARSET_ANSI_CHINESE_TRADITIONAL
 = 0x88;

57 cÚ¡ 
	mCHARSET_ANSI_GREEK
 = 0xA1;

58 cÚ¡ 
	mCHARSET_ANSI_TURKISH
 = 0xA2;

59 cÚ¡ 
	mCHARSET_ANSI_VIETNAMESE
 = 0xA3;

60 cÚ¡ 
	mCHARSET_ANSI_HEBREW
 = 0xB1;

61 cÚ¡ 
	mCHARSET_ANSI_ARABIC
 = 0xB2;

62 cÚ¡ 
	mCHARSET_ANSI_BALTIC
 = 0xBA;

63 cÚ¡ 
	mCHARSET_ANSI_CYRILLIC
 = 0xCC;

64 cÚ¡ 
	mCHARSET_ANSI_THAI
 = 0xDD;

65 cÚ¡ 
	mCHARSET_ANSI_LATIN_II
 = 0xEE;

66 cÚ¡ 
	mCHARSET_OEM_LATIN_I
 = 0xFF;

70 cÚ¡ 
	mARIAL
 = 'arial.ttf';

71 cÚ¡ 
	mARIAL_BOLD
 = 'arialbd.ttf';

72 cÚ¡ 
	mARIAL_ITALIC
 = 'ariali.ttf';

73 cÚ¡ 
	mARIAL_BOLD_ITALIC
 = 'arialbi.ttf';

75 cÚ¡ 
	mCALIBRI
 = 'CALIBRI.TTF';

76 cÚ¡ 
	mCALIBRI_BOLD
 = 'CALIBRIB.TTF';

77 cÚ¡ 
	mCALIBRI_ITALIC
 = 'CALIBRII.TTF';

78 cÚ¡ 
	mCALIBRI_BOLD_ITALIC
 = 'CALIBRIZ.TTF';

80 cÚ¡ 
	mCOMIC_SANS_MS
 = 'comic.ttf';

81 cÚ¡ 
	mCOMIC_SANS_MS_BOLD
 = 'comicbd.ttf';

83 cÚ¡ 
	mCOURIER_NEW
 = 'cour.ttf';

84 cÚ¡ 
	mCOURIER_NEW_BOLD
 = 'courbd.ttf';

85 cÚ¡ 
	mCOURIER_NEW_ITALIC
 = 'couri.ttf';

86 cÚ¡ 
	mCOURIER_NEW_BOLD_ITALIC
 = 'courbi.ttf';

88 cÚ¡ 
	mGEORGIA
 = 'georgia.ttf';

89 cÚ¡ 
	mGEORGIA_BOLD
 = 'georgiab.ttf';

90 cÚ¡ 
	mGEORGIA_ITALIC
 = 'georgiai.ttf';

91 cÚ¡ 
	mGEORGIA_BOLD_ITALIC
 = 'georgiaz.ttf';

93 cÚ¡ 
	mIMPACT
 = 'impact.ttf';

95 cÚ¡ 
	mLIBERATION_SANS
 = 'LiberationSans-Regular.ttf';

96 cÚ¡ 
	mLIBERATION_SANS_BOLD
 = 'LiberationSans-Bold.ttf';

97 cÚ¡ 
	mLIBERATION_SANS_ITALIC
 = 'LiberationSans-Italic.ttf';

98 cÚ¡ 
	mLIBERATION_SANS_BOLD_ITALIC
 = 'LiberationSans-BoldItalic.ttf';

100 cÚ¡ 
	mLUCIDA_CONSOLE
 = 'lucon.ttf';

101 cÚ¡ 
	mLUCIDA_SANS_UNICODE
 = 'l_10646.ttf';

103 cÚ¡ 
	mMICROSOFT_SANS_SERIF
 = 'micross.ttf';

105 cÚ¡ 
	mPALATINO_LINOTYPE
 = 'pala.ttf';

106 cÚ¡ 
	mPALATINO_LINOTYPE_BOLD
 = 'palab.ttf';

107 cÚ¡ 
	mPALATINO_LINOTYPE_ITALIC
 = 'palai.ttf';

108 cÚ¡ 
	mPALATINO_LINOTYPE_BOLD_ITALIC
 = 'palabi.ttf';

110 cÚ¡ 
	mSYMBOL
 = 'symbol.ttf';

112 cÚ¡ 
	mTAHOMA
 = 'tahoma.ttf';

113 cÚ¡ 
	mTAHOMA_BOLD
 = 'tahomabd.ttf';

115 cÚ¡ 
	mTIMES_NEW_ROMAN
 = 'times.ttf';

116 cÚ¡ 
	mTIMES_NEW_ROMAN_BOLD
 = 'timesbd.ttf';

117 cÚ¡ 
	mTIMES_NEW_ROMAN_ITALIC
 = 'timesi.ttf';

118 cÚ¡ 
	mTIMES_NEW_ROMAN_BOLD_ITALIC
 = 'timesbi.ttf';

120 cÚ¡ 
	mTREBUCHET_MS
 = 'trebuc.ttf';

121 cÚ¡ 
	mTREBUCHET_MS_BOLD
 = 'trebucbd.ttf';

122 cÚ¡ 
	mTREBUCHET_MS_ITALIC
 = 'trebucit.ttf';

123 cÚ¡ 
	mTREBUCHET_MS_BOLD_ITALIC
 = 'trebucbi.ttf';

125 cÚ¡ 
	mVERDANA
 = 'verdana.ttf';

126 cÚ¡ 
	mVERDANA_BOLD
 = 'verdanab.ttf';

127 cÚ¡ 
	mVERDANA_ITALIC
 = 'verdanai.ttf';

128 cÚ¡ 
	mVERDANA_BOLD_ITALIC
 = 'verdanaz.ttf';

135 
´iv©e
 
	m$autoSizeM‘hod
 = 
£lf
::
AUTOSIZE_METHOD_APPROX
;

142 
´iv©e
 
	m$ŒueTy³FÚtP©h
 = 
nuÎ
;

151 
public
 
	m$deçuÉCŞumnWidths
 = 
¬¿y
(

152 'ArŸl' => 
¬¿y
(

153 1 => 
¬¿y
('px' => 24, 'width' => 12.00000000),

154 2 => 
¬¿y
('px' => 24, 'width' => 12.00000000),

155 3 => 
¬¿y
('px' => 32, 'width' => 10.66406250),

156 4 => 
¬¿y
('px' => 32, 'width' => 10.66406250),

157 5 => 
¬¿y
('px' => 40, 'width' => 10.00000000),

158 6 => 
¬¿y
('px' => 48, 'width' => 9.59765625),

159 7 => 
¬¿y
('px' => 48, 'width' => 9.59765625),

160 8 => 
¬¿y
('px' => 56, 'width' => 9.33203125),

161 9 => 
¬¿y
('px' => 64, 'width' => 9.14062500),

162 10 => 
¬¿y
('px' => 64, 'width' => 9.14062500),

164 'C®ibri' => 
¬¿y
(

165 1 => 
¬¿y
('px' => 24, 'width' => 12.00000000),

166 2 => 
¬¿y
('px' => 24, 'width' => 12.00000000),

167 3 => 
¬¿y
('px' => 32, 'width' => 10.66406250),

168 4 => 
¬¿y
('px' => 32, 'width' => 10.66406250),

169 5 => 
¬¿y
('px' => 40, 'width' => 10.00000000),

170 6 => 
¬¿y
('px' => 48, 'width' => 9.59765625),

171 7 => 
¬¿y
('px' => 48, 'width' => 9.59765625),

172 8 => 
¬¿y
('px' => 56, 'width' => 9.33203125),

173 9 => 
¬¿y
('px' => 56, 'width' => 9.33203125),

174 10 => 
¬¿y
('px' => 64, 'width' => 9.14062500),

175 11 => 
¬¿y
('px' => 64, 'width' => 9.14062500),

177 'V”dªa' => 
¬¿y
(

178 1 => 
¬¿y
('px' => 24, 'width' => 12.00000000),

179 2 => 
¬¿y
('px' => 24, 'width' => 12.00000000),

180 3 => 
¬¿y
('px' => 32, 'width' => 10.66406250),

181 4 => 
¬¿y
('px' => 32, 'width' => 10.66406250),

182 5 => 
¬¿y
('px' => 40, 'width' => 10.00000000),

183 6 => 
¬¿y
('px' => 48, 'width' => 9.59765625),

184 7 => 
¬¿y
('px' => 48, 'width' => 9.59765625),

185 8 => 
¬¿y
('px' => 64, 'width' => 9.14062500),

186 9 => 
¬¿y
('px' => 72, 'width' => 9.00000000),

187 10 => 
¬¿y
('px' => 72, 'width' => 9.00000000),

197 
public
 
funùiÚ
 
	$£tAutoSizeM‘hod
(
$pV®ue
 = 
£lf
::
AUTOSIZE_METHOD_APPROX
)

199 ià(!
	`š_¬¿y
(
$pV®ue
, 
£lf
::
$autoSizeM‘hods
)) {

200  
çl£
;

202 
£lf
::
$autoSizeM‘hod
 = 
$pV®ue
;

204  
Œue
;

212 
public
 
funùiÚ
 
	$g‘AutoSizeM‘hod
()

214  
£lf
::
$autoSizeM‘hod
;

215 
	}
}

228 
public
 
funùiÚ
 
£tTrueTy³FÚtP©h
(
$pV®ue
 = '')

230 
£lf
::
$ŒueTy³FÚtP©h
 = 
$pV®ue
;

238 
public
 
funùiÚ
 
	$g‘TrueTy³FÚtP©h
()

240  
£lf
::
$ŒueTy³FÚtP©h
;

241 
	}
}

252 
public
 
funùiÚ
 
ÿlcuÏ‹CŞumnWidth
(
PHPExûl_StyË_FÚt
 
$fÚt
, 
$ûÎText
 = '', 
$rÙ©iÚ
 = 0, PHPExûl_StyË_FÚˆ
$deçuÉFÚt
 = 
nuÎ
)

255 ià(
$ûÎText
 
š¡ªûof
 
PHPExûl_RichText
) {

256 
$ûÎText
 = $ûÎText->
g‘PÏšText
();

260 ià(
¡½os
(
$ûÎText
, "\n"è!=ğ
çl£
) {

261 
$lšeTexts
 = 
ex¶ode
("\n", 
$ûÎText
);

262 
	g$lšeWidths
 = 
¬¿y
();

263 
fÜ—ch
 (
$lšeTexts
 
as
 
$lšeText
) {

264 
	g$lšeWidths
[] = 
£lf
::
ÿlcuÏ‹CŞumnWidth
(
$fÚt
, 
$lšeText
, 
$rÙ©iÚ
 = 0, 
$deçuÉFÚt
);

266  
max
(
$lšeWidths
);

270 
	g$­´oxim©e
 = 
£lf
::
$autoSizeM‘hod
 =ğ£lf::
AUTOSIZE_METHOD_APPROX
;

271 ià(!
	g$­´oxim©e
) {

272 
	g$cŞumnWidthAdju¡
 = 
û
(
£lf
::
g‘TextWidthPix–sExaù
('n', 
$fÚt
, 0) * 1.07);

273 
	gŒy
 {

276 
	g$cŞumnWidth
 = 
£lf
::
g‘TextWidthPix–sExaù
(
$ûÎText
, 
$fÚt
, 
$rÙ©iÚ
è+ 
	g$cŞumnWidthAdju¡
;

277 } 
ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

278 
	g$­´oxim©e
 = 
Œue
;

282 ià(
	g$­´oxim©e
) {

283 
	g$cŞumnWidthAdju¡
 = 
£lf
::
g‘TextWidthPix–sAµrox
('n', 
$fÚt
, 0);

286 
	g$cŞumnWidth
 = 
£lf
::
g‘TextWidthPix–sAµrox
(
$ûÎText
, 
$fÚt
, 
$rÙ©iÚ
è+ 
	g$cŞumnWidthAdju¡
;

290 
	g$cŞumnWidth
 = 
PHPExûl_Sh¬ed_D¿wšg
::
pix–sToC–lDim’siÚ
(
$cŞumnWidth
, 
$deçuÉFÚt
);

293  
round
(
$cŞumnWidth
, 6);

305 
public
 
funùiÚ
 
	$g‘TextWidthPix–sExaù
(
$‹xt
, 
PHPExûl_StyË_FÚt
 
$fÚt
, 
$rÙ©iÚ
 = 0)

307 ià(!
	`funùiÚ_exi¡s
('imagettfbbox')) {

308 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('GD†ibrary‚eedso beƒnabled');

313 
$fÚtFe
 = 
£lf
::
	`g‘TrueTy³FÚtFeFromFÚt
(
$fÚt
);

314 
$‹xtBox
 = 
	`imag‘tfbbox
(
$fÚt
->
	`g‘Size
(), 
$rÙ©iÚ
, 
$fÚtFe
, 
$‹xt
);

317 
$low”LeáCÜÃrX
 = 
$‹xtBox
[0];

319 
$low”RightCÜÃrX
 = 
$‹xtBox
[2];

321 
$uµ”RightCÜÃrX
 = 
$‹xtBox
[4];

323 
$uµ”LeáCÜÃrX
 = 
$‹xtBox
[6];

327 
$‹xtWidth
 = 
	`max
(
$low”RightCÜÃrX
 - 
$uµ”LeáCÜÃrX
, 
$uµ”RightCÜÃrX
 - 
$low”LeáCÜÃrX
);

329  
$‹xtWidth
;

330 
	}
}

340 
public
 
funùiÚ
 
	$g‘TextWidthPix–sAµrox
(
$cŞumnText
, 
PHPExûl_StyË_FÚt
 
$fÚt
 = 
nuÎ
, 
$rÙ©iÚ
 = 0)

342 
$fÚtName
 = 
$fÚt
->
	`g‘Name
();

343 
$fÚtSize
 = 
$fÚt
->
	`g‘Size
();

346 
$fÚtName
) {

349 
$cŞumnWidth
 = (è(8.26 * 
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$cŞumnText
));

350 
$cŞumnWidth
 = $cŞumnWidth * 
$fÚtSize
 / 11;

357 
$cŞumnWidth
 = (è(8 * 
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$cŞumnText
));

358 
$cŞumnWidth
 = $cŞumnWidth * 
$fÚtSize
 / 10;

363 
$cŞumnWidth
 = (è(8 * 
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$cŞumnText
));

364 
$cŞumnWidth
 = $cŞumnWidth * 
$fÚtSize
 / 10;

369 
$cŞumnWidth
 = (è(8.26 * 
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$cŞumnText
));

370 
$cŞumnWidth
 = $cŞumnWidth * 
$fÚtSize
 / 11;

375 ià(
$rÙ©iÚ
 !== 0) {

376 ià(
$rÙ©iÚ
 == -165) {

378 
$cŞumnWidth
 = 4;

381 
$cŞumnWidth
 = $cŞumnWidth * 
	`cos
(
	`deg2¿d
(
$rÙ©iÚ
))

382 + 
$fÚtSize
 * 
	`abs
(
	`sš
(
	`deg2¿d
(
$rÙ©iÚ
))) / 5;

387  (è
$cŞumnWidth
;

388 
	}
}

396 
public
 
funùiÚ
 
	$fÚtSizeToPix–s
(
$fÚtSizeInPošts
 = 11)

398  (è((4 / 3è* 
$fÚtSizeInPošts
);

399 
	}
}

407 
public
 
funùiÚ
 
	$šchSizeToPix–s
(
$sizeInInch
 = 1)

409  (
$sizeInInch
 * 96);

410 
	}
}

418 
public
 
funùiÚ
 
	$ûÁim‘”SizeToPix–s
(
$sizeInCm
 = 1)

420  (
$sizeInCm
 * 37.795275591);

421 
	}
}

429 
public
 
funùiÚ
 
	$g‘TrueTy³FÚtFeFromFÚt
(
$fÚt
)

431 ià(!
	`fe_exi¡s
(
£lf
::
$ŒueTy³FÚtP©h
è|| !
	`is_dœ
(self::$trueTypeFontPath)) {

432 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Valid directoryo TrueType Font files‚ot specified');

435 
$Çme
 = 
$fÚt
->
	`g‘Name
();

436 
$bŞd
 = 
$fÚt
->
	`g‘BŞd
();

437 
$™®ic
 = 
$fÚt
->
	`g‘Ilic
();

440 
$Çme
) {

442 
$fÚtFe
 = (

443 
$bŞd
 ? (
$™®ic
 ? 
£lf
::
ARIAL_BOLD_ITALIC
 : s–f::
ARIAL_BOLD
)

444 : (
$™®ic
 ? 
£lf
::
ARIAL_ITALIC
 : s–f::
ARIAL
)

448 
$fÚtFe
 = (

449 
$bŞd
 ? (
$™®ic
 ? 
£lf
::
CALIBRI_BOLD_ITALIC
 : s–f::
CALIBRI_BOLD
)

450 : (
$™®ic
 ? 
£lf
::
CALIBRI_ITALIC
 : s–f::
CALIBRI
)

454 
$fÚtFe
 = (

455 
$bŞd
 ? (
$™®ic
 ? 
£lf
::
COURIER_NEW_BOLD_ITALIC
 : s–f::
COURIER_NEW_BOLD
)

456 : (
$™®ic
 ? 
£lf
::
COURIER_NEW_ITALIC
 : s–f::
COURIER_NEW
)

460 
$fÚtFe
 = (

461 
$bŞd
 ? 
£lf
::
COMIC_SANS_MS_BOLD
 : s–f::
COMIC_SANS_MS


465 
$fÚtFe
 = (

466 
$bŞd
 ? (
$™®ic
 ? 
£lf
::
GEORGIA_BOLD_ITALIC
 : s–f::
GEORGIA_BOLD
)

467 : (
$™®ic
 ? 
£lf
::
GEORGIA_ITALIC
 : s–f::
GEORGIA
)

471 
$fÚtFe
 = 
£lf
::
IMPACT
;

474 
$fÚtFe
 = (

475 
$bŞd
 ? (
$™®ic
 ? 
£lf
::
LIBERATION_SANS_BOLD_ITALIC
 : s–f::
LIBERATION_SANS_BOLD
)

476 : (
$™®ic
 ? 
£lf
::
LIBERATION_SANS_ITALIC
 : s–f::
LIBERATION_SANS
)

480 
$fÚtFe
 = 
£lf
::
LUCIDA_CONSOLE
;

483 
$fÚtFe
 = 
£lf
::
LUCIDA_SANS_UNICODE
;

486 
$fÚtFe
 = 
£lf
::
MICROSOFT_SANS_SERIF
;

489 
$fÚtFe
 = (

490 
$bŞd
 ? (
$™®ic
 ? 
£lf
::
PALATINO_LINOTYPE_BOLD_ITALIC
 : s–f::
PALATINO_LINOTYPE_BOLD
)

491 : (
$™®ic
 ? 
£lf
::
PALATINO_LINOTYPE_ITALIC
 : s–f::
PALATINO_LINOTYPE
)

495 
$fÚtFe
 = 
£lf
::
SYMBOL
;

498 
$fÚtFe
 = (

499 
$bŞd
 ? 
£lf
::
TAHOMA_BOLD
 : s–f::
TAHOMA


503 
$fÚtFe
 = (

504 
$bŞd
 ? (
$™®ic
 ? 
£lf
::
TIMES_NEW_ROMAN_BOLD_ITALIC
 : s–f::
TIMES_NEW_ROMAN_BOLD
)

505 : (
$™®ic
 ? 
£lf
::
TIMES_NEW_ROMAN_ITALIC
 : s–f::
TIMES_NEW_ROMAN
)

509 
$fÚtFe
 = (

510 
$bŞd
 ? (
$™®ic
 ? 
£lf
::
TREBUCHET_MS_BOLD_ITALIC
 : s–f::
TREBUCHET_MS_BOLD
)

511 : (
$™®ic
 ? 
£lf
::
TREBUCHET_MS_ITALIC
 : s–f::
TREBUCHET_MS
)

515 
$fÚtFe
 = (

516 
$bŞd
 ? (
$™®ic
 ? 
£lf
::
VERDANA_BOLD_ITALIC
 : s–f::
VERDANA_BOLD
)

517 : (
$™®ic
 ? 
£lf
::
VERDANA_ITALIC
 : s–f::
VERDANA
)

521 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('UnknowÀfÚˆÇm"'. 
$Çme
 .'". Cannot mapo TrueType font file');

525 
$fÚtFe
 = 
£lf
::
$ŒueTy³FÚtP©h
 . $fontFile;

528 ià(!
	`fe_exi¡s
(
$fÚtFe
)) {

529 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('TrueType Font file‚ot found');

532  
$fÚtFe
;

533 
	}
}

541 
public
 
funùiÚ
 
	$g‘Ch¬£tFromFÚtName
(
$Çme
)

543 
$Çme
) {

546  
£lf
::
CHARSET_ANSI_THAI
;

548  
£lf
::
CHARSET_SYMBOL
;

550  
£lf
::
CHARSET_SYMBOL
;

552  
£lf
::
CHARSET_SYMBOL
;

554  
£lf
::
CHARSET_ANSI_LATIN
;

556 
	}
}

566 
public
 
funùiÚ
 
	$g‘DeçuÉCŞumnWidthByFÚt
(
PHPExûl_StyË_FÚt
 
$fÚt
, 
$pPix–s
 = 
çl£
)

568 ià(
	`is£t
(
£lf
::
$deçuÉCŞumnWidths
[
$fÚt
->
	`g‘Name
()][$fÚt->
	`g‘Size
()])) {

570 
$cŞumnWidth
 = 
$pPix–s
 ?

571 
£lf
::
$deçuÉCŞumnWidths
[
$fÚt
->
	`g‘Name
()][$fÚt->
	`g‘Size
()]['px']

572 : 
£lf
::
$deçuÉCŞumnWidths
[
$fÚt
->
	`g‘Name
()][$fÚt->
	`g‘Size
()]['width'];

577 
$cŞumnWidth
 = 
$pPix–s
 ?

578 
£lf
::
$deçuÉCŞumnWidths
['Calibri'][11]['px']

579 : 
£lf
::
$deçuÉCŞumnWidths
['Calibri'][11]['width'];

580 
$cŞumnWidth
 = $cŞumnWidth * 
$fÚt
->
	`g‘Size
() / 11;

583 ià(
$pPix–s
) {

584 
$cŞumnWidth
 = (è
	`round
($columnWidth);

588  
$cŞumnWidth
;

589 
	}
}

598 
public
 
funùiÚ
 
	$g‘DeçuÉRowHeightByFÚt
(
PHPExûl_StyË_FÚt
 
$fÚt
)

600 
$fÚt
->
	`g‘Name
()) {

602 
$fÚt
->
	`g‘Size
()) {

605 
$rowHeight
 = 12.75;

609 
$rowHeight
 = 12;

613 
$rowHeight
 = 11.25;

617 
$rowHeight
 = 9;

622 
$rowHeight
 = 8.25;

626 
$rowHeight
 = 6.75;

630 
$rowHeight
 = 6;

635 
$rowHeight
 = 5.25;

639 
$rowHeight
 = 12.75 * 
$fÚt
->
	`g‘Size
() / 10;

645 
$fÚt
->
	`g‘Size
()) {

648 
$rowHeight
 = 15;

652 
$rowHeight
 = 12.75;

656 
$rowHeight
 = 12;

660 
$rowHeight
 = 11.25;

664 
$rowHeight
 = 9;

669 
$rowHeight
 = 8.25;

673 
$rowHeight
 = 6.75;

677 
$rowHeight
 = 6.00;

682 
$rowHeight
 = 5.25;

686 
$rowHeight
 = 15 * 
$fÚt
->
	`g‘Size
() / 11;

692 
$fÚt
->
	`g‘Size
()) {

695 
$rowHeight
 = 12.75;

699 
$rowHeight
 = 11.25;

703 
$rowHeight
 = 10.50;

707 
$rowHeight
 = 9.00;

712 
$rowHeight
 = 8.25;

716 
$rowHeight
 = 6.75;

720 
$rowHeight
 = 6;

725 
$rowHeight
 = 5.25;

729 
$rowHeight
 = 12.75 * 
$fÚt
->
	`g‘Size
() / 10;

735 
$rowHeight
 = 15 * 
$fÚt
->
	`g‘Size
() / 11;

739  
$rowHeight
;

740 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/CholeskyDecomposition.php

1 <?
php


18 şas 
	cChŞeskyDecompos™iÚ


25 
´iv©e
 
	m$L
 = 
¬¿y
();

32 
´iv©e
 
	m$m
;

39 
´iv©e
 
	m$is¥d
 = 
Œue
;

47 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$A
 = 
nuÎ
)

49 ià(
$A
 
š¡ªûof
 
M©rix
) {

50 
$this
->
L
 = 
$A
->
	`g‘A¼ay
();

51 
$this
->
m
 = 
$A
->
	`g‘RowDim’siÚ
();

53 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

54 
$j
 = 
$i
; $j < 
$this
->
m
; ++$j) {

55 
$sum
 = 
$this
->
L
[
$i
][
$j
], 
$k
 = $i - 1; $k >= 0; --$k) {

56 
$sum
 -ğ
$this
->
L
[
$i
][
$k
] * $this->L[
$j
][$k];

58 ià(
$i
 =ğ
$j
) {

59 ià(
$sum
 >= 0) {

60 
$this
->
L
[
$i
][$i] = 
	`sq¹
(
$sum
);

62 
$this
->
is¥d
 = 
çl£
;

65 ià(
$this
->
L
[
$i
][$i] != 0) {

66 
$this
->
L
[
$j
][
$i
] = 
$sum
 / $this->L[$i][$i];

71 
$k
 = 
$i
+1; $k < 
$this
->
m
; ++$k) {

72 
$this
->
L
[
$i
][
$k
] = 0.0;

76 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
	`JAMAE¼Ü
(
ARGUMENT_TYPE_EXCEPTION
));

85 
public
 
funùiÚ
 
	$isSPD
()

87  
$this
->
is¥d
;

88 
	}
}

96 
public
 
funùiÚ
 
	$g‘L
()

98  
Ãw
 
	`M©rix
(
$this
->
L
);

99 
	}
}

107 
public
 
funùiÚ
 
	$sŞve
(
$B
 = 
nuÎ
)

109 ià(
$B
 
š¡ªûof
 
M©rix
) {

110 ià(
$B
->
	`g‘RowDim’siÚ
(è=ğ
$this
->
m
) {

111 ià(
$this
->
is¥d
) {

112 
$X
 = 
$B
->
	`g‘A¼ayCİy
();

113 
$nx
 = 
$B
->
	`g‘CŞumnDim’siÚ
();

115 
$k
 = 0; $k < 
$this
->
m
; ++$k) {

116 
$i
 = 
$k
 + 1; $˜< 
$this
->
m
; ++$i) {

117 
$j
 = 0; $j < 
$nx
; ++$j) {

118 
$X
[
$i
][
$j
] -ğ$X[
$k
][$j] * 
$this
->
L
[$i][$k];

121 
$j
 = 0; $j < 
$nx
; ++$j) {

122 
$X
[
$k
][
$j
] /ğ
$this
->
L
[$k][$k];

126 
$k
 = 
$this
->
m
 - 1; $k >= 0; --$k) {

127 
$j
 = 0; $j < 
$nx
; ++$j) {

128 
$X
[
$k
][
$j
] /ğ
$this
->
L
[$k][$k];

130 
$i
 = 0; $˜< 
$k
; ++$i) {

131 
$j
 = 0; $j < 
$nx
; ++$j) {

132 
$X
[
$i
][
$j
] -ğ$X[
$k
][$j] * 
$this
->
L
[$k][$i];

137  
Ãw
 
	`M©rix
(
$X
, 
$this
->
m
, 
$nx
);

139 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
	`JAMAE¼Ü
(
M©rixSPDExû±iÚ
));

142 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
	`JAMAE¼Ü
(
MATRIX_DIMENSION_EXCEPTION
));

145 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
	`JAMAE¼Ü
(
ARGUMENT_TYPE_EXCEPTION
));

147 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/EigenvalueDecomposition.php

1 <?
php


24 şas 
	cEig’v®ueDecompos™iÚ


30 
´iv©e
 
	m$n
;

36 
´iv©e
 
	m$issymm‘ric
;

42 
´iv©e
 
	m$d
 = 
¬¿y
();

43 
´iv©e
 
	m$e
 = 
¬¿y
();

49 
´iv©e
 
	m$V
 = 
¬¿y
();

55 
´iv©e
 
	m$H
 = 
¬¿y
();

61 
´iv©e
 
	m$Üt
;

67 
´iv©e
 
	m$cdivr
;

68 
´iv©e
 
	m$cdivi
;

75 
´iv©e
 
funùiÚ
 
	$Œed2
()

81 
$this
->
d
 = $this->
V
[$this->
n
-1];

83 
$i
 = 
$this
->
n
-1; $i > 0; --$i) {

84 
$i_
 = 
$i
 -1;

86 
$h
 = 
$sÿË
 = 0.0;

87 
$sÿË
 +ğ
	`¬¿y_sum
(
	`¬¿y_m­
(
abs
, 
$this
->
d
));

88 ià(
$sÿË
 == 0.0) {

89 
$this
->
e
[
$i
] = $this->
d
[
$i_
];

90 
$this
->
d
 = 
	`¬¿y_¦iû
($this->
V
[
$i_
], 0, $i_);

91 
$j
 = 0; $j < 
$i
; ++$j) {

92 
$this
->
V
[
$j
][
$i
] = $this->V[$i][$j] = 0.0;

96 
$k
 = 0; $k < 
$i
; ++$k) {

97 
$this
->
d
[
$k
] /ğ
$sÿË
;

98 
$h
 +ğ
	`pow
(
$this
->
d
[
$k
], 2);

100 
$f
 = 
$this
->
d
[
$i_
];

101 
$g
 = 
	`sq¹
(
$h
);

102 ià(
$f
 > 0) {

103 
$g
 = -$g;

105 
$this
->
e
[
$i
] = 
$sÿË
 * 
$g
;

106 
$h
 = $h - 
$f
 * 
$g
;

107 
$this
->
d
[
$i_
] = 
$f
 - 
$g
;

108 
$j
 = 0; $j < 
$i
; ++$j) {

109 
$this
->
e
[
$j
] = 0.0;

112 
$j
 = 0; $j < 
$i
; ++$j) {

113 
$f
 = 
$this
->
d
[
$j
];

114 
$this
->
V
[
$j
][
$i
] = 
$f
;

115 
$g
 = 
$this
->
e
[
$j
] + $this->
V
[$j][$j] * 
$f
;

116 
$k
 = 
$j
+1; $k <ğ
$i_
; ++$k) {

117 
$g
 +ğ
$this
->
V
[
$k
][
$j
] * $this->
d
[$k];

118 
$this
->
e
[
$k
] +ğ$this->
V
[$k][
$j
] * 
$f
;

120 
$this
->
e
[
$j
] = 
$g
;

122 
$f
 = 0.0;

123 
$j
 = 0; $j < 
$i
; ++$j) {

124 
$this
->
e
[
$j
] /ğ
$h
;

125 
$f
 +ğ
$this
->
e
[
$j
] * $this->
d
[$j];

127 
$hh
 = 
$f
 / (2 * 
$h
);

128 
$j
=0; $j < 
$i
; ++$j) {

129 
$this
->
e
[
$j
] -ğ
$hh
 * $this->
d
[$j];

131 
$j
 = 0; $j < 
$i
; ++$j) {

132 
$f
 = 
$this
->
d
[
$j
];

133 
$g
 = 
$this
->
e
[
$j
];

134 
$k
 = 
$j
; $k <ğ
$i_
; ++$k) {

135 
$this
->
V
[
$k
][
$j
] -ğ(
$f
 * $this->
e
[$k] + 
$g
 * $this->
d
[$k]);

137 
$this
->
d
[
$j
] = $this->
V
[
$i
-1][$j];

138 
$this
->
V
[
$i
][
$j
] = 0.0;

141 
$this
->
d
[
$i
] = 
$h
;

145 
$i
 = 0; $˜< 
$this
->
n
-1; ++$i) {

146 
$this
->
V
[$this->
n
-1][
$i
] = $this->V[$i][$i];

147 
$this
->
V
[
$i
][$i] = 1.0;

148 
$h
 = 
$this
->
d
[
$i
+1];

149 ià(
$h
 != 0.0) {

150 
$k
 = 0; $k <ğ
$i
; ++$k) {

151 
$this
->
d
[
$k
] = $this->
V
[$k][
$i
+1] / 
$h
;

153 
$j
 = 0; $j <ğ
$i
; ++$j) {

154 
$g
 = 0.0;

155 
$k
 = 0; $k <ğ
$i
; ++$k) {

156 
$g
 +ğ
$this
->
V
[
$k
][
$i
+1] * $this->V[$k][
$j
];

158 
$k
 = 0; $k <ğ
$i
; ++$k) {

159 
$this
->
V
[
$k
][
$j
] -ğ
$g
 * $this->
d
[$k];

163 
$k
 = 0; $k <ğ
$i
; ++$k) {

164 
$this
->
V
[
$k
][
$i
+1] = 0.0;

168 
$this
->
d
 = $this->
V
[$this->
n
-1];

169 
$this
->
V
[$this->
n
-1] = 
	`¬¿y_fl
(0, 
$j
, 0.0);

170 
$this
->
V
[$this->
n
-1][$this->n-1] = 1.0;

171 
$this
->
e
[0] = 0.0;

184 
´iv©e
 
funùiÚ
 
	$tql2
()

186 
$i
 = 1; $˜< 
$this
->
n
; ++$i) {

187 
$this
->
e
[
$i
-1] = $this->e[$i];

189 
$this
->
e
[$this->
n
-1] = 0.0;

190 
$f
 = 0.0;

191 
$t¡1
 = 0.0;

192 
$•s
 = 
	`pow
(2.0, -52.0);

194 
$l
 = 0; $È< 
$this
->
n
; ++$l) {

196 
$t¡1
 = 
	`max
($t¡1, 
	`abs
(
$this
->
d
[
$l
]è+‡bs($this->
e
[$l]));

197 
$m
 = 
$l
;

198 
$m
 < 
$this
->
n
) {

199 ià(
	`abs
(
$this
->
e
[
$m
]è<ğ
$•s
 * 
$t¡1
) {

202 ++
$m
;

206 ià(
$m
 > 
$l
) {

207 
$™”
 = 0;

210 
$™”
 += 1;

212 
$g
 = 
$this
->
d
[
$l
];

213 
$p
 = (
$this
->
d
[
$l
+1] - 
$g
è/ (2.0 * $this->
e
[$l]);

214 
$r
 = 
	`hypo
(
$p
, 1.0);

215 ià(
$p
 < 0) {

216 
$r
 *= -1;

218 
$this
->
d
[
$l
] = $this->
e
[$l] / (
$p
 + 
$r
);

219 
$this
->
d
[
$l
+1] = $this->
e
[$l] * (
$p
 + 
$r
);

220 
$dl1
 = 
$this
->
d
[
$l
+1];

221 
$h
 = 
$g
 - 
$this
->
d
[
$l
];

222 
$i
 = 
$l
 + 2; $˜< 
$this
->
n
; ++$i) {

223 
$this
->
d
[
$i
] -ğ
$h
;

225 
$f
 +ğ
$h
;

227 
$p
 = 
$this
->
d
[
$m
];

228 
$c
 = 1.0;

229 
$c2
 = 
$c3
 = 
$c
;

230 
$–1
 = 
$this
->
e
[
$l
 + 1];

231 
$s
 = 
$s2
 = 0.0;

232 
$i
 = 
$m
-1; $˜>ğ
$l
; --$i) {

233 
$c3
 = 
$c2
;

234 
$c2
 = 
$c
;

235 
$s2
 = 
$s
;

236 
$g
 = 
$c
 * 
$this
->
e
[
$i
];

237 
$h
 = 
$c
 * 
$p
;

238 
$r
 = 
	`hypo
(
$p
, 
$this
->
e
[
$i
]);

239 
$this
->
e
[
$i
+1] = 
$s
 * 
$r
;

240 
$s
 = 
$this
->
e
[
$i
] / 
$r
;

241 
$c
 = 
$p
 / 
$r
;

242 
$p
 = 
$c
 * 
$this
->
d
[
$i
] - 
$s
 * 
$g
;

243 
$this
->
d
[
$i
+1] = 
$h
 + 
$s
 * (
$c
 * 
$g
 + $s * $this->d[$i]);

245 
$k
 = 0; $k < 
$this
->
n
; ++$k) {

246 
$h
 = 
$this
->
V
[
$k
][
$i
+1];

247 
$this
->
V
[
$k
][
$i
+1] = 
$s
 * $this->V[$k][$i] + 
$c
 * 
$h
;

248 
$this
->
V
[
$k
][
$i
] = 
$c
 * $this->V[$k][$i] - 
$s
 * 
$h
;

251 
$p
 = -
$s
 * 
$s2
 * 
$c3
 * 
$–1
 * 
$this
->
e
[
$l
] / 
$dl1
;

252 
$this
->
e
[
$l
] = 
$s
 * 
$p
;

253 
$this
->
d
[
$l
] = 
$c
 * 
$p
;

255 } 
	`abs
(
$this
->
e
[
$l
]è> 
$•s
 * 
$t¡1
);

257 
$this
->
d
[
$l
] = $this->d[$l] + 
$f
;

258 
$this
->
e
[
$l
] = 0.0;

262 
$i
 = 0; $˜< 
$this
->
n
 - 1; ++$i) {

263 
$k
 = 
$i
;

264 
$p
 = 
$this
->
d
[
$i
];

265 
$j
 = 
$i
+1; $j < 
$this
->
n
; ++$j) {

266 ià(
$this
->
d
[
$j
] < 
$p
) {

267 
$k
 = 
$j
;

268 
$p
 = 
$this
->
d
[
$j
];

271 ià(
$k
 !ğ
$i
) {

272 
$this
->
d
[
$k
] = $this->d[
$i
];

273 
$this
->
d
[
$i
] = 
$p
;

274 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

275 
$p
 = 
$this
->
V
[
$j
][
$i
];

276 
$this
->
V
[
$j
][
$i
] = $this->V[$j][
$k
];

277 
$this
->
V
[
$j
][
$k
] = 
$p
;

281 
	}
}

293 
´iv©e
 
funùiÚ
 
	$Üthes
()

295 
$low
 = 0;

296 
$high
 = 
$this
->
n
-1;

298 
$m
 = 
$low
+1; $m <ğ
$high
-1; ++$m) {

300 
$sÿË
 = 0.0;

301 
$i
 = 
$m
; $˜<ğ
$high
; ++$i) {

302 
$sÿË
 = $sÿË + 
	`abs
(
$this
->
H
[
$i
][
$m
-1]);

304 ià(
$sÿË
 != 0.0) {

306 
$h
 = 0.0;

307 
$i
 = 
$high
; $˜>ğ
$m
; --$i) {

308 
$this
->
Üt
[
$i
] = $this->
H
[$i][
$m
-1] / 
$sÿË
;

309 
$h
 +ğ
$this
->
Üt
[
$i
] * $this->ort[$i];

311 
$g
 = 
	`sq¹
(
$h
);

312 ià(
$this
->
Üt
[
$m
] > 0) {

313 
$g
 *= -1;

315 
$h
 -ğ
$this
->
Üt
[
$m
] * 
$g
;

316 
$this
->
Üt
[
$m
] -ğ
$g
;

319 
$j
 = 
$m
; $j < 
$this
->
n
; ++$j) {

320 
$f
 = 0.0;

321 
$i
 = 
$high
; $˜>ğ
$m
; --$i) {

322 
$f
 +ğ
$this
->
Üt
[
$i
] * $this->
H
[$i][
$j
];

324 
$f
 /ğ
$h
;

325 
$i
 = 
$m
; $˜<ğ
$high
; ++$i) {

326 
$this
->
H
[
$i
][
$j
] -ğ
$f
 * $this->
Üt
[$i];

329 
$i
 = 0; $˜<ğ
$high
; ++$i) {

330 
$f
 = 0.0;

331 
$j
 = 
$high
; $j >ğ
$m
; --$j) {

332 
$f
 +ğ
$this
->
Üt
[
$j
] * $this->
H
[
$i
][$j];

334 
$f
 = $à/ 
$h
;

335 
$j
 = 
$m
; $j <ğ
$high
; ++$j) {

336 
$this
->
H
[
$i
][
$j
] -ğ
$f
 * $this->
Üt
[$j];

339 
$this
->
Üt
[
$m
] = 
$sÿË
 * $this->ort[$m];

340 
$this
->
H
[
$m
][$m-1] = 
$sÿË
 * 
$g
;

345 
$i
 = 0; $˜< 
$this
->
n
; ++$i) {

346 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

347 
$this
->
V
[
$i
][
$j
] = ($i == $j ? 1.0 : 0.0);

350 
$m
 = 
$high
-1; $m >ğ
$low
+1; --$m) {

351 ià(
$this
->
H
[
$m
][$m-1] != 0.0) {

352 
$i
 = 
$m
+1; $˜<ğ
$high
; ++$i) {

353 
$this
->
Üt
[
$i
] = $this->
H
[$i][
$m
-1];

355 
$j
 = 
$m
; $j <ğ
$high
; ++$j) {

356 
$g
 = 0.0;

357 
$i
 = 
$m
; $˜<ğ
$high
; ++$i) {

358 
$g
 +ğ
$this
->
Üt
[
$i
] * $this->
V
[$i][
$j
];

361 
$g
 = ($g / 
$this
->
Üt
[
$m
]è/ $this->
H
[$m][$m-1];

362 
$i
 = 
$m
; $˜<ğ
$high
; ++$i) {

363 
$this
->
V
[
$i
][
$j
] +ğ
$g
 * $this->
Üt
[$i];

368 
	}
}

375 
´iv©e
 
funùiÚ
 
	$cdiv
(
$xr
, 
$xi
, 
$yr
, 
$yi
)

377 ià(
	`abs
(
$yr
è>‡bs(
$yi
)) {

378 
$r
 = 
$yi
 / 
$yr
;

379 
$d
 = 
$yr
 + 
$r
 * 
$yi
;

380 
$this
->
cdivr
 = (
$xr
 + 
$r
 * 
$xi
è/ 
$d
;

381 
$this
->
cdivi
 = (
$xi
 - 
$r
 * 
$xr
è/ 
$d
;

383 
$r
 = 
$yr
 / 
$yi
;

384 
$d
 = 
$yi
 + 
$r
 * 
$yr
;

385 
$this
->
cdivr
 = (
$r
 * 
$xr
 + 
$xi
è/ 
$d
;

386 
$this
->
cdivi
 = (
$r
 * 
$xi
 - 
$xr
è/ 
$d
;

388 
	}
}

400 
´iv©e
 
funùiÚ
 
	$hqr2
()

403 
$Â
 = 
$this
->
n
;

404 
$n
 = 
$Â
 - 1;

405 
$low
 = 0;

406 
$high
 = 
$Â
 - 1;

407 
$•s
 = 
	`pow
(2.0, -52.0);

408 
$exshiá
 = 0.0;

409 
$p
 = 
$q
 = 
$r
 = 
$s
 = 
$z
 = 0;

411 
$nÜm
 = 0.0;

413 
$i
 = 0; $˜< 
$Â
; ++$i) {

414 ià((
$i
 < 
$low
è
	`Ü
 ($˜> 
$high
)) {

415 
$this
->
d
[
$i
] = $this->
H
[$i][$i];

416 
$this
->
e
[
$i
] = 0.0;

418 
$j
 = 
	`max
(
$i
-1, 0); $j < 
$Â
; ++$j) {

419 
$nÜm
 = $nÜm + 
	`abs
(
$this
->
H
[
$i
][
$j
]);

424 
$™”
 = 0;

425 
$n
 >ğ
$low
) {

427 
$l
 = 
$n
;

428 
$l
 > 
$low
) {

429 
$s
 = 
	`abs
(
$this
->
H
[
$l
-1][$l-1]) +‡bs($this->H[$l][$l]);

430 ià(
$s
 == 0.0) {

431 
$s
 = 
$nÜm
;

433 ià(
	`abs
(
$this
->
H
[
$l
][$l-1]è< 
$•s
 * 
$s
) {

436 --
$l
;

440 ià(
$l
 =ğ
$n
) {

441 
$this
->
H
[
$n
][$n] = $this->H[$n][$n] + 
$exshiá
;

442 
$this
->
d
[
$n
] = $this->
H
[$n][$n];

443 
$this
->
e
[
$n
] = 0.0;

444 --
$n
;

445 
$™”
 = 0;

447 } 
	`–£if
 (
$l
 =ğ
$n
-1) {

448 
$w
 = 
$this
->
H
[
$n
][$n-1] * $this->H[$n-1][$n];

449 
$p
 = (
$this
->
H
[
$n
-1][$n-1] - $this->H[$n][$n]) / 2.0;

450 
$q
 = 
$p
 * $°+ 
$w
;

451 
$z
 = 
	`sq¹
(
	`abs
(
$q
));

452 
$this
->
H
[
$n
][$n] = $this->H[$n][$n] + 
$exshiá
;

453 
$this
->
H
[
$n
-1][$n-1] = $this->H[$n-1][$n-1] + 
$exshiá
;

454 
$x
 = 
$this
->
H
[
$n
][$n];

456 ià(
$q
 >= 0) {

457 ià(
$p
 >= 0) {

458 
$z
 = 
$p
 + $z;

460 
$z
 = 
$p
 - $z;

462 
$this
->
d
[
$n
-1] = 
$x
 + 
$z
;

463 
$this
->
d
[
$n
] = $this->d[$n-1];

464 ià(
$z
 != 0.0) {

465 
$this
->
d
[
$n
] = 
$x
 - 
$w
 / 
$z
;

467 
$this
->
e
[
$n
-1] = 0.0;

468 
$this
->
e
[
$n
] = 0.0;

469 
$x
 = 
$this
->
H
[
$n
][$n-1];

470 
$s
 = 
	`abs
(
$x
è+‡bs(
$z
);

471 
$p
 = 
$x
 / 
$s
;

472 
$q
 = 
$z
 / 
$s
;

473 
$r
 = 
	`sq¹
(
$p
 * $°+ 
$q
 * $q);

474 
$p
 = $°/ 
$r
;

475 
$q
 = $q / 
$r
;

477 
$j
 = 
$n
-1; $j < 
$Â
; ++$j) {

478 
$z
 = 
$this
->
H
[
$n
-1][
$j
];

479 
$this
->
H
[
$n
-1][
$j
] = 
$q
 * 
$z
 + 
$p
 * $this->H[$n][$j];

480 
$this
->
H
[
$n
][
$j
] = 
$q
 * $this->H[$n][$j] - 
$p
 * 
$z
;

483 
$i
 = 0; $˜<ğ
$n
; ++$i) {

484 
$z
 = 
$this
->
H
[
$i
][
$n
-1];

485 
$this
->
H
[
$i
][
$n
-1] = 
$q
 * 
$z
 + 
$p
 * $this->H[$i][$n];

486 
$this
->
H
[
$i
][
$n
] = 
$q
 * $this->H[$i][$n] - 
$p
 * 
$z
;

489 
$i
 = 
$low
; $˜<ğ
$high
; ++$i) {

490 
$z
 = 
$this
->
V
[
$i
][
$n
-1];

491 
$this
->
V
[
$i
][
$n
-1] = 
$q
 * 
$z
 + 
$p
 * $this->V[$i][$n];

492 
$this
->
V
[
$i
][
$n
] = 
$q
 * $this->V[$i][$n] - 
$p
 * 
$z
;

496 
$this
->
d
[
$n
-1] = 
$x
 + 
$p
;

497 
$this
->
d
[
$n
] = 
$x
 + 
$p
;

498 
$this
->
e
[
$n
-1] = 
$z
;

499 
$this
->
e
[
$n
] = -
$z
;

501 
$n
 = $n - 2;

502 
$™”
 = 0;

506 
$x
 = 
$this
->
H
[
$n
][$n];

507 
$y
 = 0.0;

508 
$w
 = 0.0;

509 ià(
$l
 < 
$n
) {

510 
$y
 = 
$this
->
H
[
$n
-1][$n-1];

511 
$w
 = 
$this
->
H
[
$n
][$n-1] * $this->H[$n-1][$n];

514 ià(
$™”
 == 10) {

515 
$exshiá
 +ğ
$x
;

516 
$i
 = 
$low
; $˜<ğ
$n
; ++$i) {

517 
$this
->
H
[
$i
][$i] -ğ
$x
;

519 
$s
 = 
	`abs
(
$this
->
H
[
$n
][$n-1]) +‡bs($this->H[$n-1][$n-2]);

520 
$x
 = 
$y
 = 0.75 * 
$s
;

521 
$w
 = -0.4375 * 
$s
 * $s;

524 ià(
$™”
 == 30) {

525 
$s
 = (
$y
 - 
$x
) / 2.0;

526 
$s
 = $ * $ + 
$w
;

527 ià(
$s
 > 0) {

528 
$s
 = 
	`sq¹
($s);

529 ià(
$y
 < 
$x
) {

530 
$s
 = -$s;

532 
$s
 = 
$x
 - 
$w
 / ((
$y
 - $x) / 2.0 + $s);

533 
$i
 = 
$low
; $˜<ğ
$n
; ++$i) {

534 
$this
->
H
[
$i
][$i] -ğ
$s
;

536 
$exshiá
 +ğ
$s
;

537 
$x
 = 
$y
 = 
$w
 = 0.964;

541 
$™”
 = $iter + 1;

543 
$m
 = 
$n
 - 2;

544 
$m
 >ğ
$l
) {

545 
$z
 = 
$this
->
H
[
$m
][$m];

546 
$r
 = 
$x
 - 
$z
;

547 
$s
 = 
$y
 - 
$z
;

548 
$p
 = (
$r
 * 
$s
 - 
$w
è/ 
$this
->
H
[
$m
+1][$m] + $this->H[$m][$m+1];

549 
$q
 = 
$this
->
H
[
$m
+1][$m+1] - 
$z
 - 
$r
 - 
$s
;

550 
$r
 = 
$this
->
H
[
$m
+2][$m+1];

551 
$s
 = 
	`abs
(
$p
è+‡bs(
$q
è+‡bs(
$r
);

552 
$p
 = $°/ 
$s
;

553 
$q
 = $q / 
$s
;

554 
$r
 = $¸/ 
$s
;

555 ià(
$m
 =ğ
$l
) {

558 ià(
	`abs
(
$this
->
H
[
$m
][$m-1]è* (abs(
$q
è+‡bs(
$r
)) <

559 
$•s
 * (
	`abs
(
$p
è* (abs(
$this
->
H
[
$m
-1][$m-1]è+‡bs(
$z
) +‡bs($this->H[$m+1][$m+1])))) {

562 --
$m
;

564 
$i
 = 
$m
 + 2; $˜<ğ
$n
; ++$i) {

565 
$this
->
H
[
$i
][$i-2] = 0.0;

566 ià(
$i
 > 
$m
+2) {

567 
$this
->
H
[
$i
][$i-3] = 0.0;

571 
$k
 = 
$m
; $k <ğ
$n
-1; ++$k) {

572 
$nÙÏ¡
 = (
$k
 !ğ
$n
-1);

573 ià(
$k
 !ğ
$m
) {

574 
$p
 = 
$this
->
H
[
$k
][$k-1];

575 
$q
 = 
$this
->
H
[
$k
+1][$k-1];

576 
$r
 = (
$nÙÏ¡
 ? 
$this
->
H
[
$k
+2][$k-1] : 0.0);

577 
$x
 = 
	`abs
(
$p
è+‡bs(
$q
è+‡bs(
$r
);

578 ià(
$x
 != 0.0) {

579 
$p
 = $°/ 
$x
;

580 
$q
 = $q / 
$x
;

581 
$r
 = $¸/ 
$x
;

584 ià(
$x
 == 0.0) {

587 
$s
 = 
	`sq¹
(
$p
 * $°+ 
$q
 * $q + 
$r
 * $r);

588 ià(
$p
 < 0) {

589 
$s
 = -$s;

591 ià(
$s
 != 0) {

592 ià(
$k
 !ğ
$m
) {

593 
$this
->
H
[
$k
][$k-1] = -
$s
 * 
$x
;

594 } 
	`–£if
 (
$l
 !ğ
$m
) {

595 
$this
->
H
[
$k
][$k-1] = -$this->H[$k][$k-1];

597 
$p
 = $°+ 
$s
;

598 
$x
 = 
$p
 / 
$s
;

599 
$y
 = 
$q
 / 
$s
;

600 
$z
 = 
$r
 / 
$s
;

601 
$q
 = $q / 
$p
;

602 
$r
 = $¸/ 
$p
;

604 
$j
 = 
$k
; $j < 
$Â
; ++$j) {

605 
$p
 = 
$this
->
H
[
$k
][
$j
] + 
$q
 * $this->H[$k+1][$j];

606 ià(
$nÙÏ¡
) {

607 
$p
 = $°+ 
$r
 * 
$this
->
H
[
$k
+2][
$j
];

608 
$this
->
H
[
$k
+2][
$j
] = $this->H[$k+2][$j] - 
$p
 * 
$z
;

610 
$this
->
H
[
$k
][
$j
] = $this->H[$k][$j] - 
$p
 * 
$x
;

611 
$this
->
H
[
$k
+1][
$j
] = $this->H[$k+1][$j] - 
$p
 * 
$y
;

614 
$i
 = 0; $˜<ğ
	`mš
(
$n
, 
$k
+3); ++$i) {

615 
$p
 = 
$x
 * 
$this
->
H
[
$i
][
$k
] + 
$y
 * $this->H[$i][$k+1];

616 ià(
$nÙÏ¡
) {

617 
$p
 = $°+ 
$z
 * 
$this
->
H
[
$i
][
$k
+2];

618 
$this
->
H
[
$i
][
$k
+2] = $this->H[$i][$k+2] - 
$p
 * 
$r
;

620 
$this
->
H
[
$i
][
$k
] = $this->H[$i][$k] - 
$p
;

621 
$this
->
H
[
$i
][
$k
+1] = $this->H[$i][$k+1] - 
$p
 * 
$q
;

624 
$i
 = 
$low
; $˜<ğ
$high
; ++$i) {

625 
$p
 = 
$x
 * 
$this
->
V
[
$i
][
$k
] + 
$y
 * $this->V[$i][$k+1];

626 ià(
$nÙÏ¡
) {

627 
$p
 = $°+ 
$z
 * 
$this
->
V
[
$i
][
$k
+2];

628 
$this
->
V
[
$i
][
$k
+2] = $this->V[$i][$k+2] - 
$p
 * 
$r
;

630 
$this
->
V
[
$i
][
$k
] = $this->V[$i][$k] - 
$p
;

631 
$this
->
V
[
$i
][
$k
+1] = $this->V[$i][$k+1] - 
$p
 * 
$q
;

639 ià(
$nÜm
 == 0.0) {

643 
$n
 = 
$Â
-1; $n >= 0; --$n) {

644 
$p
 = 
$this
->
d
[
$n
];

645 
$q
 = 
$this
->
e
[
$n
];

647 ià(
$q
 == 0) {

648 
$l
 = 
$n
;

649 
$this
->
H
[
$n
][$n] = 1.0;

650 
$i
 = 
$n
-1; $i >= 0; --$i) {

651 
$w
 = 
$this
->
H
[
$i
][$i] - 
$p
;

652 
$r
 = 0.0;

653 
$j
 = 
$l
; $j <ğ
$n
; ++$j) {

654 
$r
 = $¸+ 
$this
->
H
[
$i
][
$j
] * $this->H[$j][
$n
];

656 ià(
$this
->
e
[
$i
] < 0.0) {

657 
$z
 = 
$w
;

658 
$s
 = 
$r
;

660 
$l
 = 
$i
;

661 ià(
$this
->
e
[
$i
] == 0.0) {

662 ià(
$w
 != 0.0) {

663 
$this
->
H
[
$i
][
$n
] = -
$r
 / 
$w
;

665 
$this
->
H
[
$i
][
$n
] = -
$r
 / (
$•s
 * 
$nÜm
);

669 
$x
 = 
$this
->
H
[
$i
][$i+1];

670 
$y
 = 
$this
->
H
[
$i
+1][$i];

671 
$q
 = (
$this
->
d
[
$i
] - 
$p
è* ($this->d[$i] - $pè+ $this->
e
[$i] * $this->e[$i];

672 
$t
 = (
$x
 * 
$s
 - 
$z
 * 
$r
è/ 
$q
;

673 
$this
->
H
[
$i
][
$n
] = 
$t
;

674 ià(
	`abs
(
$x
è>‡bs(
$z
)) {

675 
$this
->
H
[
$i
+1][
$n
] = (-
$r
 - 
$w
 * 
$t
è/ 
$x
;

677 
$this
->
H
[
$i
+1][
$n
] = (-
$s
 - 
$y
 * 
$t
è/ 
$z
;

681 
$t
 = 
	`abs
(
$this
->
H
[
$i
][
$n
]);

682 ià((
$•s
 * 
$t
) * $t > 1) {

683 
$j
 = 
$i
; $j <ğ
$n
; ++$j) {

684 
$this
->
H
[
$j
][
$n
] = $this->H[$j][$n] / 
$t
;

690 } 
	`–£if
 (
$q
 < 0) {

691 
$l
 = 
$n
-1;

693 ià(
	`abs
(
$this
->
H
[
$n
][$n-1]) >‡bs($this->H[$n-1][$n])) {

694 
$this
->
H
[
$n
-1][$n-1] = 
$q
 / $this->H[$n][$n-1];

695 
$this
->
H
[
$n
-1][$n] = -($this->H[$n][$n] - 
$p
) / $this->H[$n][$n-1];

697 
$this
->
	`cdiv
(0.0, -$this->
H
[
$n
-1][$n], $this->H[$n-1][$n-1] - 
$p
, 
$q
);

698 
$this
->
H
[
$n
-1][$n-1] = $this->
cdivr
;

699 
$this
->
H
[
$n
-1][$n] = $this->
cdivi
;

701 
$this
->
H
[
$n
][$n-1] = 0.0;

702 
$this
->
H
[
$n
][$n] = 1.0;

703 
$i
 = 
$n
-2; $i >= 0; --$i) {

705 
$¿
 = 0.0;

706 
$§
 = 0.0;

707 
$j
 = 
$l
; $j <ğ
$n
; ++$j) {

708 
$¿
 = $¿ + 
$this
->
H
[
$i
][
$j
] * $this->H[$j][
$n
-1];

709 
$§
 = $§ + 
$this
->
H
[
$i
][
$j
] * $this->H[$j][
$n
];

711 
$w
 = 
$this
->
H
[
$i
][$i] - 
$p
;

712 ià(
$this
->
e
[
$i
] < 0.0) {

713 
$z
 = 
$w
;

714 
$r
 = 
$¿
;

715 
$s
 = 
$§
;

717 
$l
 = 
$i
;

718 ià(
$this
->
e
[
$i
] == 0) {

719 
$this
->
	`cdiv
(-
$¿
, -
$§
, 
$w
, 
$q
);

720 
$this
->
H
[
$i
][
$n
-1] = $this->
cdivr
;

721 
$this
->
H
[
$i
][
$n
] = $this->
cdivi
;

724 
$x
 = 
$this
->
H
[
$i
][$i+1];

725 
$y
 = 
$this
->
H
[
$i
+1][$i];

726 
$vr
 = (
$this
->
d
[
$i
] - 
$p
è* ($this->d[$i] - $pè+ $this->
e
[$i] * $this->e[$i] - 
$q
 * $q;

727 
$vi
 = (
$this
->
d
[
$i
] - 
$p
è* 2.0 * 
$q
;

728 ià(
$vr
 =ğ0.0 & 
$vi
 == 0.0) {

729 
$vr
 = 
$•s
 * 
$nÜm
 * (
	`abs
(
$w
è+‡bs(
$q
è+‡bs(
$x
è+‡bs(
$y
è+‡bs(
$z
));

731 
$this
->
	`cdiv
(
$x
 * 
$r
 - 
$z
 * 
$¿
 + 
$q
 * 
$§
, $x * 
$s
 - $z * $§ - $q * $¿, 
$vr
, 
$vi
);

732 
$this
->
H
[
$i
][
$n
-1] = $this->
cdivr
;

733 
$this
->
H
[
$i
][
$n
] = $this->
cdivi
;

734 ià(
	`abs
(
$x
è> (abs(
$z
è+‡bs(
$q
))) {

735 
$this
->
H
[
$i
+1][
$n
-1] = (-
$¿
 - 
$w
 * $this->H[$i][$n-1] + 
$q
 * $this->H[$i][$n]è/ 
$x
;

736 
$this
->
H
[
$i
+1][
$n
] = (-
$§
 - 
$w
 * $this->H[$i][$n] - 
$q
 * $this->H[$i][$n-1]è/ 
$x
;

738 
$this
->
	`cdiv
(-
$r
 - 
$y
 * $this->
H
[
$i
][
$n
-1], -
$s
 - $y * $this->H[$i][$n], 
$z
, 
$q
);

739 
$this
->
H
[
$i
+1][
$n
-1] = $this->
cdivr
;

740 
$this
->
H
[
$i
+1][
$n
] = $this->
cdivi
;

744 
$t
 = 
	`max
(
	`abs
(
$this
->
H
[
$i
][
$n
-1]),‡bs($this->H[$i][$n]));

745 ià((
$•s
 * 
$t
) * $t > 1) {

746 
$j
 = 
$i
; $j <ğ
$n
; ++$j) {

747 
$this
->
H
[
$j
][
$n
-1] = $this->H[$j][$n-1] / 
$t
;

748 
$this
->
H
[
$j
][
$n
] = $this->H[$j][$n] / 
$t
;

757 
$i
 = 0; $˜< 
$Â
; ++$i) {

758 ià(
$i
 < 
$low
 | $˜> 
$high
) {

759 
$j
 = 
$i
; $j < 
$Â
; ++$j) {

760 
$this
->
V
[
$i
][
$j
] = $this->
H
[$i][$j];

766 
$j
 = 
$Â
-1; $j >ğ
$low
; --$j) {

767 
$i
 = 
$low
; $˜<ğ
$high
; ++$i) {

768 
$z
 = 0.0;

769 
$k
 = 
$low
; $k <ğ
	`mš
(
$j
, 
$high
); ++$k) {

770 
$z
 = $z + 
$this
->
V
[
$i
][
$k
] * $this->
H
[$k][
$j
];

772 
$this
->
V
[
$i
][
$j
] = 
$z
;

775 
	}
}

784 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$Arg
)

786 
$this
->
A
 = 
$Arg
->
	`g‘A¼ay
();

787 
$this
->
n
 = 
$Arg
->
	`g‘CŞumnDim’siÚ
();

789 
$issymm‘ric
 = 
Œue
;

790 
$j
 = 0; ($j < 
$this
->
n
è& 
$issymm‘ric
; ++$j) {

791 
$i
 = 0; ($˜< 
$this
->
n
è& 
$issymm‘ric
; ++$i) {

792 
$issymm‘ric
 = (
$this
->
A
[
$i
][
$j
] == $this->A[$j][$i]);

796 ià(
$issymm‘ric
) {

797 
$this
->
V
 = $this->
A
;

799 
$this
->
	`Œed2
();

801 
$this
->
	`tql2
();

803 
$this
->
H
 = $this->
A
;

804 
$this
->
Üt
 = 
	`¬¿y
();

806 
$this
->
	`Üthes
();

808 
$this
->
	`hqr2
();

810 
	}
}

818 
public
 
funùiÚ
 
	$g‘V
()

820  
Ãw
 
	`M©rix
(
$this
->
V
, $this->
n
, $this->n);

821 
	}
}

829 
public
 
funùiÚ
 
	$g‘R—lEig’v®ues
()

831  
$this
->
d
;

832 
	}
}

840 
public
 
funùiÚ
 
	$g‘ImagEig’v®ues
()

842  
$this
->
e
;

843 
	}
}

851 
public
 
funùiÚ
 
	$g‘D
()

853 
$i
 = 0; $˜< 
$this
->
n
; ++$i) {

854 
$D
[
$i
] = 
	`¬¿y_fl
(0, 
$this
->
n
, 0.0);

855 
$D
[
$i
][$i] = 
$this
->
d
[$i];

856 ià(
$this
->
e
[
$i
] == 0) {

859 
$o
 = (
$this
->
e
[
$i
] > 0) ? $i + 1 : $i - 1;

860 
$D
[
$i
][
$o
] = 
$this
->
e
[$i];

862  
Ãw
 
	`M©rix
(
$D
);

863 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/LUDecomposition.php

1 <?
php


21 şas 
	cPHPExûl_Sh¬ed_JAMA_LUDecompos™iÚ


23 cÚ¡ 
	mMATRIX_SINGULAR_EXCEPTION
 = "Can only…erform operation on singular matrix.";

24 cÚ¡ 
	mMATRIX_SQUARE_EXCEPTION
 = "Mismatched Row dimension";

30 
´iv©e
 
	m$LU
 = 
¬¿y
();

36 
´iv©e
 
	m$m
;

42 
´iv©e
 
	m$n
;

48 
´iv©e
 
	m$pivsign
;

54 
´iv©e
 
	m$piv
 = 
¬¿y
();

62 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$A
)

64 ià(
$A
 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

66 
$this
->
LU
 = 
$A
->
	`g‘A¼ay
();

67 
$this
->
m
 = 
$A
->
	`g‘RowDim’siÚ
();

68 
$this
->
n
 = 
$A
->
	`g‘CŞumnDim’siÚ
();

69 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

70 
$this
->
piv
[
$i
] = $i;

72 
$this
->
pivsign
 = 1;

73 
$LUrowi
 = 
$LUcŞj
 = 
	`¬¿y
();

76 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

78 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

79 
$LUcŞj
[
$i
] = &
$this
->
LU
[$i][
$j
];

82 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

83 
$LUrowi
 = 
$this
->
LU
[
$i
];

85 
$kmax
 = 
	`mš
(
$i
, 
$j
);

86 
$s
 = 0.0;

87 
$k
 = 0; $k < 
$kmax
; ++$k) {

88 
$s
 +ğ
$LUrowi
[
$k
] * 
$LUcŞj
[$k];

90 
$LUrowi
[
$j
] = 
$LUcŞj
[
$i
] -ğ
$s
;

93 
$p
 = 
$j
;

94 
$i
 = 
$j
+1; $˜< 
$this
->
m
; ++$i) {

95 ià(
	`abs
(
$LUcŞj
[
$i
]è>‡bs($LUcŞj[
$p
])) {

96 
$p
 = 
$i
;

99 ià(
$p
 !ğ
$j
) {

100 
$k
 = 0; $k < 
$this
->
n
; ++$k) {

101 
$t
 = 
$this
->
LU
[
$p
][
$k
];

102 
$this
->
LU
[
$p
][
$k
] = $this->LU[
$j
][$k];

103 
$this
->
LU
[
$j
][
$k
] = 
$t
;

105 
$k
 = 
$this
->
piv
[
$p
];

106 
$this
->
piv
[
$p
] = $this->piv[
$j
];

107 
$this
->
piv
[
$j
] = 
$k
;

108 
$this
->
pivsign
 = $this->pivsign * -1;

111 ià((
$j
 < 
$this
->
m
è&& ($this->
LU
[$j][$j] != 0.0)) {

112 
$i
 = 
$j
+1; $˜< 
$this
->
m
; ++$i) {

113 
$this
->
LU
[
$i
][
$j
] /= $this->LU[$j][$j];

118 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
PHPExûl_Sh¬ed_JAMA_M©rix
::
ARGUMENT_TYPE_EXCEPTION
);

127 
public
 
funùiÚ
 
	$g‘L
()

129 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

130 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

131 ià(
$i
 > 
$j
) {

132 
$L
[
$i
][
$j
] = 
$this
->
LU
[$i][$j];

133 } 
	`–£if
 (
$i
 =ğ
$j
) {

134 
$L
[
$i
][
$j
] = 1.0;

136 
$L
[
$i
][
$j
] = 0.0;

140  
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$L
);

141 
	}
}

148 
public
 
funùiÚ
 
	$g‘U
()

150 
$i
 = 0; $˜< 
$this
->
n
; ++$i) {

151 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

152 ià(
$i
 <ğ
$j
) {

153 
$U
[
$i
][
$j
] = 
$this
->
LU
[$i][$j];

155 
$U
[
$i
][
$j
] = 0.0;

159  
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$U
);

160 
	}
}

167 
public
 
funùiÚ
 
	$g‘PivÙ
()

169  
$this
->
piv
;

170 
	}
}

177 
public
 
funùiÚ
 
	$g‘DoubËPivÙ
()

179  
$this
->
	`g‘PivÙ
();

180 
	}
}

187 
public
 
funùiÚ
 
	$isNÚsšguÏr
()

189 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

190 ià(
$this
->
LU
[
$j
][$j] == 0) {

191  
çl£
;

194  
Œue
;

195 
	}
}

202 
public
 
funùiÚ
 
	$d‘
()

204 ià(
$this
->
m
 =ğ$this->
n
) {

205 
$d
 = 
$this
->
pivsign
;

206 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

207 
$d
 *ğ
$this
->
LU
[
$j
][$j];

209  
$d
;

211 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
PHPExûl_Sh¬ed_JAMA_M©rix
::
MATRIX_DIMENSION_EXCEPTION
);

213 
	}
}

223 
public
 
funùiÚ
 
	$sŞve
(
$B
)

225 ià(
$B
->
	`g‘RowDim’siÚ
(è=ğ
$this
->
m
) {

226 ià(
$this
->
	`isNÚsšguÏr
()) {

228 
$nx
 = 
$B
->
	`g‘CŞumnDim’siÚ
();

229 
$X
 = 
$B
->
	`g‘M©rix
(
$this
->
piv
, 0, 
$nx
-1);

231 
$k
 = 0; $k < 
$this
->
n
; ++$k) {

232 
$i
 = 
$k
+1; $˜< 
$this
->
n
; ++$i) {

233 
$j
 = 0; $j < 
$nx
; ++$j) {

234 
$X
->
A
[
$i
][
$j
] -ğ$X->A[
$k
][$j] * 
$this
->
LU
[$i][$k];

239 
$k
 = 
$this
->
n
-1; $k >= 0; --$k) {

240 
$j
 = 0; $j < 
$nx
; ++$j) {

241 
$X
->
A
[
$k
][
$j
] /ğ
$this
->
LU
[$k][$k];

243 
$i
 = 0; $˜< 
$k
; ++$i) {

244 
$j
 = 0; $j < 
$nx
; ++$j) {

245 
$X
->
A
[
$i
][
$j
] -ğ$X->A[
$k
][$j] * 
$this
->
LU
[$i][$k];

249  
$X
;

251 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
MATRIX_SINGULAR_EXCEPTION
);

254 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
MATRIX_SQUARE_EXCEPTION
);

256 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/Matrix.php

1 <?
php


7 ià(!
defšed
('PHPEXCEL_ROOT')) {

11 
defše
('PHPEXCEL_ROOT', 
dœÇme
(
__FILE__
) . '/../../../');

12 
»quœe
(
PHPEXCEL_ROOT
 . 'PHPExcel/Autoloader.php');

27 şas 
	cPHPExûl_Sh¬ed_JAMA_M©rix


29 cÚ¡ 
	mPOLYMORPHIC_ARGUMENT_EXCEPTION
 = "Invalid‡rgument…attern for…olymorphic function.";

30 cÚ¡ 
	mARGUMENT_TYPE_EXCEPTION
 = "Invalid‡rgumentype.";

31 cÚ¡ 
	mARGUMENT_BOUNDS_EXCEPTION
 = "Invalid‡rgument„ange.";

32 cÚ¡ 
	mMATRIX_DIMENSION_EXCEPTION
 = "Matrix dimensions‡re‚otƒqual.";

33 cÚ¡ 
	mARRAY_LENGTH_EXCEPTION
 = "Array†ength must be‡ multiple of m.";

41 
public
 
	m$A
 = 
¬¿y
();

49 
´iv©e
 
	m$m
;

57 
´iv©e
 
	m$n
;

64 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

66 ià(
	`func_num_¬gs
() > 0) {

67 
$¬gs
 = 
	`func_g‘_¬gs
();

68 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

70 
$m©ch
) {

73 
$this
->
m
 = 
	`couÁ
(
$¬gs
[0]);

74 
$this
->
n
 = 
	`couÁ
(
$¬gs
[0][0]);

75 
$this
->
A
 = 
$¬gs
[0];

79 
$this
->
m
 = 
$¬gs
[0];

80 
$this
->
n
 = 
$¬gs
[0];

81 
$this
->
A
 = 
	`¬¿y_fl
(0, $this->
m
,‡¼ay_fl(0, $this->
n
, 0));

85 
$this
->
m
 = 
$¬gs
[0];

86 
$this
->
n
 = 
$¬gs
[1];

87 
$this
->
A
 = 
	`¬¿y_fl
(0, $this->
m
,‡¼ay_fl(0, $this->
n
, 0));

91 
$this
->
m
 = 
$¬gs
[1];

92 ià(
$this
->
m
 != 0) {

93 
$this
->
n
 = 
	`couÁ
(
$¬gs
[0]è/ $this->
m
;

95 
$this
->
n
 = 0;

97 ià((
$this
->
m
 * $this->
n
è=ğ
	`couÁ
(
$¬gs
[0])) {

98 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

99 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

100 
$this
->
A
[
$i
][
$j
] = 
$¬gs
[0][$˜+ $j * $this->
m
];

104 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARRAY_LENGTH_EXCEPTION
);

108 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

112 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

121 
public
 
funùiÚ
 
	$g‘A¼ay
()

123  
$this
->
A
;

124 
	}
}

131 
public
 
funùiÚ
 
	$g‘RowDim’siÚ
()

133  
$this
->
m
;

134 
	}
}

141 
public
 
funùiÚ
 
	$g‘CŞumnDim’siÚ
()

143  
$this
->
n
;

144 
	}
}

154 
public
 
funùiÚ
 
	$g‘
(
$i
 = 
nuÎ
, 
$j
 =‚ull)

156  
$this
->
A
[
$i
][
$j
];

157 
	}
}

169 
public
 
funùiÚ
 
	$g‘M©rix
()

171 ià(
	`func_num_¬gs
() > 0) {

172 
$¬gs
 = 
	`func_g‘_¬gs
();

173 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

175 
$m©ch
) {

178 
	`li¡
(
$i0
, 
$j0
èğ
$¬gs
;

179 ià(
$i0
 >= 0) {

180 
$m
 = 
$this
->
m
 - 
$i0
;

182 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

184 ià(
$j0
 >= 0) {

185 
$n
 = 
$this
->
n
 - 
$j0
;

187 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

189 
$R
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m
, 
$n
);

190 
$i
 = 
$i0
; $˜< 
$this
->
m
; ++$i) {

191 
$j
 = 
$j0
; $j < 
$this
->
n
; ++$j) {

192 
$R
->
	`£t
(
$i
, 
$j
, 
$this
->
A
[$i][$j]);

195  
$R
;

199 
	`li¡
(
$i0
, 
$iF
, 
$j0
, 
$jF
èğ
$¬gs
;

200 ià((
$iF
 > 
$i0
è&& (
$this
->
m
 >= $iF) && ($i0 >= 0)) {

201 
$m
 = 
$iF
 - 
$i0
;

203 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

205 ià((
$jF
 > 
$j0
è&& (
$this
->
n
 >= $jF) && ($j0 >= 0)) {

206 
$n
 = 
$jF
 - 
$j0
;

208 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

210 
$R
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m
+1, 
$n
+1);

211 
$i
 = 
$i0
; $˜<ğ
$iF
; ++$i) {

212 
$j
 = 
$j0
; $j <ğ
$jF
; ++$j) {

213 
$R
->
	`£t
(
$i
 - 
$i0
, 
$j
 - 
$j0
, 
$this
->
A
[$i][$j]);

216  
$R
;

220 
	`li¡
(
$RL
, 
$CL
èğ
$¬gs
;

221 ià(
	`couÁ
(
$RL
) > 0) {

222 
$m
 = 
	`couÁ
(
$RL
);

224 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

226 ià(
	`couÁ
(
$CL
) > 0) {

227 
$n
 = 
	`couÁ
(
$CL
);

229 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

231 
$R
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m
, 
$n
);

232 
$i
 = 0; $˜< 
$m
; ++$i) {

233 
$j
 = 0; $j < 
$n
; ++$j) {

234 
$R
->
	`£t
(
$i
 - 
$i0
, 
$j
 - 
$j0
, 
$this
->
A
[
$RL
[$i]][
$CL
[$j]]);

237  
$R
;

241 
	`li¡
(
$RL
, 
$CL
èğ
$¬gs
;

242 ià(
	`couÁ
(
$RL
) > 0) {

243 
$m
 = 
	`couÁ
(
$RL
);

245 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

247 ià(
	`couÁ
(
$CL
) > 0) {

248 
$n
 = 
	`couÁ
(
$CL
);

250 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

252 
$R
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m
, 
$n
);

253 
$i
 = 0; $˜< 
$m
; ++$i) {

254 
$j
 = 0; $j < 
$n
; ++$j) {

255 
$R
->
	`£t
(
$i
, 
$j
, 
$this
->
A
[
$RL
[$i]][
$CL
[$j]]);

258  
$R
;

262 
	`li¡
(
$i0
, 
$iF
, 
$CL
èğ
$¬gs
;

263 ià((
$iF
 > 
$i0
è&& (
$this
->
m
 >= $iF) && ($i0 >= 0)) {

264 
$m
 = 
$iF
 - 
$i0
;

266 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

268 ià(
	`couÁ
(
$CL
) > 0) {

269 
$n
 = 
	`couÁ
(
$CL
);

271 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

273 
$R
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m
, 
$n
);

274 
$i
 = 
$i0
; $˜< 
$iF
; ++$i) {

275 
$j
 = 0; $j < 
$n
; ++$j) {

276 
$R
->
	`£t
(
$i
 - 
$i0
, 
$j
, 
$this
->
A
[
$RL
[$i]][$j]);

279  
$R
;

283 
	`li¡
(
$RL
, 
$j0
, 
$jF
èğ
$¬gs
;

284 ià(
	`couÁ
(
$RL
) > 0) {

285 
$m
 = 
	`couÁ
(
$RL
);

287 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

289 ià((
$jF
 >ğ
$j0
è&& (
$this
->
n
 >= $jF) && ($j0 >= 0)) {

290 
$n
 = 
$jF
 - 
$j0
;

292 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_BOUNDS_EXCEPTION
);

294 
$R
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m
, 
$n
+1);

295 
$i
 = 0; $˜< 
$m
; ++$i) {

296 
$j
 = 
$j0
; $j <ğ
$jF
; ++$j) {

297 
$R
->
	`£t
(
$i
, 
$j
 - 
$j0
, 
$this
->
A
[
$RL
[$i]][$j]);

300  
$R
;

303 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

307 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

309 
	}
}

318 
public
 
funùiÚ
 
	$checkM©rixDim’siÚs
(
$B
 = 
nuÎ
)

320 ià(
$B
 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

321 ià((
$this
->
m
 =ğ
$B
->
	`g‘RowDim’siÚ
()è&& ($this->
n
 =ğ$B->
	`g‘CŞumnDim’siÚ
())) {

322  
Œue
;

324 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
MATRIX_DIMENSION_EXCEPTION
);

327 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

329 
	}
}

340 
public
 
funùiÚ
 
	$£t
(
$i
 = 
nuÎ
, 
$j
 =‚uÎ, 
$c
 =‚ull)

343 
$this
->
A
[
$i
][
$j
] = 
$c
;

344 
	}
}

354 
public
 
funùiÚ
 
	$id’t™y
(
$m
 = 
nuÎ
, 
$n
 =‚ull)

356  
$this
->
	`dŸgÚ®
(
$m
, 
$n
, 1);

357 
	}
}

368 
public
 
funùiÚ
 
	$dŸgÚ®
(
$m
 = 
nuÎ
, 
$n
 =‚uÎ, 
$c
 = 1)

370 
$R
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$m
, 
$n
);

371 
$i
 = 0; $˜< 
$m
; ++$i) {

372 
$R
->
	`£t
(
$i
, $i, 
$c
);

374  
$R
;

375 
	}
}

385 
public
 
funùiÚ
 
	$g‘M©rixByRow
(
$i0
 = 
nuÎ
, 
$iF
 =‚ull)

387 ià(
	`is_št
(
$i0
)) {

388 ià(
	`is_št
(
$iF
)) {

389  
$this
->
	`g‘M©rix
(
$i0
, 0, 
$iF
 + 1, $this->
n
);

391  
$this
->
	`g‘M©rix
(
$i0
, 0, $i0 + 1, $this->
n
);

394 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

396 
	}
}

406 
public
 
funùiÚ
 
	$g‘M©rixByCŞ
(
$j0
 = 
nuÎ
, 
$jF
 =‚ull)

408 ià(
	`is_št
(
$j0
)) {

409 ià(
	`is_št
(
$jF
)) {

410  
$this
->
	`g‘M©rix
(0, 
$j0
, $this->
m
, 
$jF
 + 1);

412  
$this
->
	`g‘M©rix
(0, 
$j0
, $this->
m
, $j0 + 1);

415 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

417 
	}
}

425 
public
 
funùiÚ
 
	$Œª¥o£
()

427 
$R
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$this
->
n
, $this->
m
);

428 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

429 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

430 
$R
->
	`£t
(
$j
, 
$i
, 
$this
->
A
[$i][$j]);

433  
$R
;

434 
	}
}

442 
public
 
funùiÚ
 
	$Œaû
()

444 
$s
 = 0;

445 
$n
 = 
	`mš
(
$this
->
m
, $this->
n
);

446 
$i
 = 0; $˜< 
$n
; ++$i) {

447 
$s
 +ğ
$this
->
A
[
$i
][$i];

449  
$s
;

450 
	}
}

458 
public
 
funùiÚ
 
	$umšus
()

460 
	}
}

469 
public
 
funùiÚ
 
	$¶us
()

471 ià(
	`func_num_¬gs
() > 0) {

472 
$¬gs
 = 
	`func_g‘_¬gs
();

473 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

475 
$m©ch
) {

477 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

478 
$M
 = 
$¬gs
[0];

480 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

484 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

487 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

490 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

491 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

492 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

493 
$M
->
	`£t
(
$i
, 
$j
, $M->
	`g‘
($i, $jè+ 
$this
->
A
[$i][$j]);

496  
$M
;

498 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

500 
	}
}

509 
public
 
funùiÚ
 
	$¶usEqu®s
()

511 ià(
	`func_num_¬gs
() > 0) {

512 
$¬gs
 = 
	`func_g‘_¬gs
();

513 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

515 
$m©ch
) {

517 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

518 
$M
 = 
$¬gs
[0];

520 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

524 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

527 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

530 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

531 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

532 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

533 
$v®idV®ues
 = 
Œue
;

534 
$v®ue
 = 
$M
->
	`g‘
(
$i
, 
$j
);

535 ià((
	`is_¡ršg
(
$this
->
A
[
$i
][
$j
])è&& (
	`¡¾’
($this->A[$i][$j]è> 0è&& (!
	`is_num”ic
($this->A[$i][$j]))) {

536 
$this
->
A
[
$i
][
$j
] = 
	`Œim
($this->A[$i][$j], '"');

537 
$v®idV®ues
 &ğ
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$this
->
A
[
$i
][
$j
]);

539 ià((
	`is_¡ršg
(
$v®ue
)è&& (
	`¡¾’
($v®ueè> 0è&& (!
	`is_num”ic
($value))) {

540 
$v®ue
 = 
	`Œim
($value, '"');

541 
$v®idV®ues
 &ğ
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$v®ue
);

543 ià(
$v®idV®ues
) {

544 
$this
->
A
[
$i
][
$j
] +ğ
$v®ue
;

546 
$this
->
A
[
$i
][
$j
] = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

550  
$this
;

552 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

554 
	}
}

563 
public
 
funùiÚ
 
	$mšus
()

565 ià(
	`func_num_¬gs
() > 0) {

566 
$¬gs
 = 
	`func_g‘_¬gs
();

567 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

569 
$m©ch
) {

571 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

572 
$M
 = 
$¬gs
[0];

574 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

578 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

581 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

584 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

585 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

586 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

587 
$M
->
	`£t
(
$i
, 
$j
, $M->
	`g‘
($i, $jè- 
$this
->
A
[$i][$j]);

590  
$M
;

592 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

594 
	}
}

603 
public
 
funùiÚ
 
	$mšusEqu®s
()

605 ià(
	`func_num_¬gs
() > 0) {

606 
$¬gs
 = 
	`func_g‘_¬gs
();

607 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

609 
$m©ch
) {

611 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

612 
$M
 = 
$¬gs
[0];

614 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

618 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

621 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

624 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

625 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

626 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

627 
$v®idV®ues
 = 
Œue
;

628 
$v®ue
 = 
$M
->
	`g‘
(
$i
, 
$j
);

629 ià((
	`is_¡ršg
(
$this
->
A
[
$i
][
$j
])è&& (
	`¡¾’
($this->A[$i][$j]è> 0è&& (!
	`is_num”ic
($this->A[$i][$j]))) {

630 
$this
->
A
[
$i
][
$j
] = 
	`Œim
($this->A[$i][$j], '"');

631 
$v®idV®ues
 &ğ
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$this
->
A
[
$i
][
$j
]);

633 ià((
	`is_¡ršg
(
$v®ue
)è&& (
	`¡¾’
($v®ueè> 0è&& (!
	`is_num”ic
($value))) {

634 
$v®ue
 = 
	`Œim
($value, '"');

635 
$v®idV®ues
 &ğ
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$v®ue
);

637 ià(
$v®idV®ues
) {

638 
$this
->
A
[
$i
][
$j
] -ğ
$v®ue
;

640 
$this
->
A
[
$i
][
$j
] = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

644  
$this
;

646 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

648 
	}
}

658 
public
 
funùiÚ
 
	$¬¿yTimes
()

660 ià(
	`func_num_¬gs
() > 0) {

661 
$¬gs
 = 
	`func_g‘_¬gs
();

662 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

664 
$m©ch
) {

666 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

667 
$M
 = 
$¬gs
[0];

669 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

673 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

676 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

679 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

680 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

681 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

682 
$M
->
	`£t
(
$i
, 
$j
, $M->
	`g‘
($i, $jè* 
$this
->
A
[$i][$j]);

685  
$M
;

687 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

689 
	}
}

699 
public
 
funùiÚ
 
	$¬¿yTimesEqu®s
()

701 ià(
	`func_num_¬gs
() > 0) {

702 
$¬gs
 = 
	`func_g‘_¬gs
();

703 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

705 
$m©ch
) {

707 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

708 
$M
 = 
$¬gs
[0];

710 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

714 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

717 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

720 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

721 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

722 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

723 
$v®idV®ues
 = 
Œue
;

724 
$v®ue
 = 
$M
->
	`g‘
(
$i
, 
$j
);

725 ià((
	`is_¡ršg
(
$this
->
A
[
$i
][
$j
])è&& (
	`¡¾’
($this->A[$i][$j]è> 0è&& (!
	`is_num”ic
($this->A[$i][$j]))) {

726 
$this
->
A
[
$i
][
$j
] = 
	`Œim
($this->A[$i][$j], '"');

727 
$v®idV®ues
 &ğ
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$this
->
A
[
$i
][
$j
]);

729 ià((
	`is_¡ršg
(
$v®ue
)è&& (
	`¡¾’
($v®ueè> 0è&& (!
	`is_num”ic
($value))) {

730 
$v®ue
 = 
	`Œim
($value, '"');

731 
$v®idV®ues
 &ğ
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$v®ue
);

733 ià(
$v®idV®ues
) {

734 
$this
->
A
[
$i
][
$j
] *ğ
$v®ue
;

736 
$this
->
A
[
$i
][
$j
] = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

740  
$this
;

742 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

744 
	}
}

754 
public
 
funùiÚ
 
	$¬¿yRightDivide
()

756 ià(
	`func_num_¬gs
() > 0) {

757 
$¬gs
 = 
	`func_g‘_¬gs
();

758 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

760 
$m©ch
) {

762 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

763 
$M
 = 
$¬gs
[0];

765 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

769 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

772 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

775 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

776 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

777 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

778 
$v®idV®ues
 = 
Œue
;

779 
$v®ue
 = 
$M
->
	`g‘
(
$i
, 
$j
);

780 ià((
	`is_¡ršg
(
$this
->
A
[
$i
][
$j
])è&& (
	`¡¾’
($this->A[$i][$j]è> 0è&& (!
	`is_num”ic
($this->A[$i][$j]))) {

781 
$this
->
A
[
$i
][
$j
] = 
	`Œim
($this->A[$i][$j], '"');

782 
$v®idV®ues
 &ğ
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$this
->
A
[
$i
][
$j
]);

784 ià((
	`is_¡ršg
(
$v®ue
)è&& (
	`¡¾’
($v®ueè> 0è&& (!
	`is_num”ic
($value))) {

785 
$v®ue
 = 
	`Œim
($value, '"');

786 
$v®idV®ues
 &ğ
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$v®ue
);

788 ià(
$v®idV®ues
) {

789 ià(
$v®ue
 == 0) {

791 
$M
->
	`£t
(
$i
, 
$j
, '#DIV/0!');

793 
$M
->
	`£t
(
$i
, 
$j
, 
$this
->
A
[$i][$j] / 
$v®ue
);

796 
$M
->
	`£t
(
$i
, 
$j
, 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
());

800  
$M
;

802 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

804 
	}
}

815 
public
 
funùiÚ
 
	$¬¿yRightDivideEqu®s
()

817 ià(
	`func_num_¬gs
() > 0) {

818 
$¬gs
 = 
	`func_g‘_¬gs
();

819 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

821 
$m©ch
) {

823 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

824 
$M
 = 
$¬gs
[0];

826 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

830 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

833 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

836 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

837 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

838 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

839 
$this
->
A
[
$i
][
$j
] = $this->A[$i][$j] / 
$M
->
	`g‘
($i, $j);

842  
$M
;

844 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

846 
	}
}

857 
public
 
funùiÚ
 
	$¬¿yLeáDivide
()

859 ià(
	`func_num_¬gs
() > 0) {

860 
$¬gs
 = 
	`func_g‘_¬gs
();

861 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

863 
$m©ch
) {

865 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

866 
$M
 = 
$¬gs
[0];

868 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

872 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

875 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

878 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

879 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

880 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

881 
$M
->
	`£t
(
$i
, 
$j
, $M->
	`g‘
($i, $jè/ 
$this
->
A
[$i][$j]);

884  
$M
;

886 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

888 
	}
}

899 
public
 
funùiÚ
 
	$¬¿yLeáDivideEqu®s
()

901 ià(
	`func_num_¬gs
() > 0) {

902 
$¬gs
 = 
	`func_g‘_¬gs
();

903 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

905 
$m©ch
) {

907 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

908 
$M
 = 
$¬gs
[0];

910 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

914 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

917 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

920 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

921 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

922 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

923 
$this
->
A
[
$i
][
$j
] = 
$M
->
	`g‘
($i, $j) / $this->A[$i][$j];

926  
$M
;

928 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

930 
	}
}

940 
public
 
funùiÚ
 
	$times
()

942 ià(
	`func_num_¬gs
() > 0) {

943 
$¬gs
 = 
	`func_g‘_¬gs
();

944 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

946 
$m©ch
) {

948 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

949 
$B
 = 
$¬gs
[0];

951 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

953 ià(
$this
->
n
 =ğ
$B
->
m
) {

954 
$C
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$this
->
m
, 
$B
->
n
);

955 
$j
 = 0; $j < 
$B
->
n
; ++$j) {

956 
$k
 = 0; $k < 
$this
->
n
; ++$k) {

957 
$BcŞj
[
$k
] = 
$B
->
A
[$k][
$j
];

959 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

960 
$Arowi
 = 
$this
->
A
[
$i
];

961 
$s
 = 0;

962 
$k
 = 0; $k < 
$this
->
n
; ++$k) {

963 
$s
 +ğ
$Arowi
[
$k
] * 
$BcŞj
[$k];

965 
$C
->
A
[
$i
][
$j
] = 
$s
;

968  
$C
;

970 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
	`JAMAE¼Ü
(
M©rixDim’siÚMism©ch
));

974 
$B
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

975 ià(
$this
->
n
 =ğ
$B
->
m
) {

976 
$C
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$this
->
m
, 
$B
->
n
);

977 
$i
 = 0; $˜< 
$C
->
m
; ++$i) {

978 
$j
 = 0; $j < 
$C
->
n
; ++$j) {

979 
$s
 = "0";

980 
$k
 = 0; $k < 
$C
->
n
; ++$k) {

981 
$s
 +ğ
$this
->
A
[
$i
][
$k
] * 
$B
->A[$k][
$j
];

983 
$C
->
A
[
$i
][
$j
] = 
$s
;

986  
$C
;

988 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
	`JAMAE¼Ü
(
M©rixDim’siÚMism©ch
));

990  
$M
;

993 
$C
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$this
->
A
);

994 
$i
 = 0; $˜< 
$C
->
m
; ++$i) {

995 
$j
 = 0; $j < 
$C
->
n
; ++$j) {

996 
$C
->
A
[
$i
][
$j
] *ğ
$¬gs
[0];

999  
$C
;

1002 
$C
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$this
->
m
, $this->
n
);

1003 
$i
 = 0; $˜< 
$C
->
m
; ++$i) {

1004 
$j
 = 0; $j < 
$C
->
n
; ++$j) {

1005 
$C
->
A
[
$i
][
$j
] = 
$¬gs
[0] * 
$this
->A[$i][$j];

1008  
$C
;

1011 
$C
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$this
->
A
);

1012 
$i
 = 0; $˜< 
$C
->
m
; ++$i) {

1013 
$j
 = 0; $j < 
$C
->
n
; ++$j) {

1014 
$C
->
A
[
$i
][
$j
] *ğ
$¬gs
[0];

1017  
$C
;

1020 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

1024 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

1026 
	}
}

1035 
public
 
funùiÚ
 
	$pow”
()

1037 ià(
	`func_num_¬gs
() > 0) {

1038 
$¬gs
 = 
	`func_g‘_¬gs
();

1039 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

1041 
$m©ch
) {

1043 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

1044 
$M
 = 
$¬gs
[0];

1046 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

1050 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

1053 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

1056 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

1057 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

1058 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

1059 
$v®idV®ues
 = 
Œue
;

1060 
$v®ue
 = 
$M
->
	`g‘
(
$i
, 
$j
);

1061 ià((
	`is_¡ršg
(
$this
->
A
[
$i
][
$j
])è&& (
	`¡¾’
($this->A[$i][$j]è> 0è&& (!
	`is_num”ic
($this->A[$i][$j]))) {

1062 
$this
->
A
[
$i
][
$j
] = 
	`Œim
($this->A[$i][$j], '"');

1063 
$v®idV®ues
 &ğ
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$this
->
A
[
$i
][
$j
]);

1065 ià((
	`is_¡ršg
(
$v®ue
)è&& (
	`¡¾’
($v®ueè> 0è&& (!
	`is_num”ic
($value))) {

1066 
$v®ue
 = 
	`Œim
($value, '"');

1067 
$v®idV®ues
 &ğ
PHPExûl_Sh¬ed_SŒšg
::
	`cÚv”tToNumb”IfF¿ùiÚ
(
$v®ue
);

1069 ià(
$v®idV®ues
) {

1070 
$this
->
A
[
$i
][
$j
] = 
	`pow
($this->A[$i][$j], 
$v®ue
);

1072 
$this
->
A
[
$i
][
$j
] = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`NaN
();

1076  
$this
;

1078 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

1080 
	}
}

1089 
public
 
funùiÚ
 
	$cÚÿt
()

1091 ià(
	`func_num_¬gs
() > 0) {

1092 
$¬gs
 = 
	`func_g‘_¬gs
();

1093 
$m©ch
 = 
	`im¶ode
(",", 
	`¬¿y_m­
('g‘ty³', 
$¬gs
));

1095 
$m©ch
) {

1097 ià(
$¬gs
[0] 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

1098 
$M
 = 
$¬gs
[0];

1100 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
ARGUMENT_TYPE_EXCEPTION
);

1103 
$M
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$¬gs
[0]);

1106 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

1109 
$this
->
	`checkM©rixDim’siÚs
(
$M
);

1110 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

1111 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

1112 
$this
->
A
[
$i
][
$j
] = 
	`Œim
($this->A[$i][$j], '"').Œim(
$M
->
	`g‘
($i, $j), '"');

1115  
$this
;

1117 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
POLYMORPHIC_ARGUMENT_EXCEPTION
);

1119 
	}
}

1127 
public
 
funùiÚ
 
	$sŞve
(
$B
)

1129 ià(
$this
->
m
 =ğ$this->
n
) {

1130 
$LU
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_LUDecompos™iÚ
(
$this
);

1131  
$LU
->
	`sŞve
(
$B
);

1133 
$QR
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_QRDecompos™iÚ
(
$this
);

1134  
$QR
->
	`sŞve
(
$B
);

1136 
	}
}

1143 
public
 
funùiÚ
 
	$šv”£
()

1145  
$this
->
	`sŞve
($this->
	`id’t™y
($this->
m
, $this->m));

1146 
	}
}

1154 
public
 
funùiÚ
 
	$d‘
()

1156 
$L
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_LUDecompos™iÚ
(
$this
);

1157  
$L
->
	`d‘
();

1158 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/QRDecomposition.php

1 <?
php


19 şas 
	cPHPExûl_Sh¬ed_JAMA_QRDecompos™iÚ


21 cÚ¡ 
	mMATRIX_RANK_EXCEPTION
 = "Can only…erform operation on full-rank matrix.";

27 
´iv©e
 
	m$QR
 = 
¬¿y
();

33 
´iv©e
 
	m$m
;

39 
´iv©e
 
	m$n
;

45 
´iv©e
 
	m$RdŸg
 = 
¬¿y
();

54 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$A
)

56 ià(
$A
 
š¡ªûof
 
PHPExûl_Sh¬ed_JAMA_M©rix
) {

58 
$this
->
QR
 = 
$A
->
	`g‘A¼ayCİy
();

59 
$this
->
m
 = 
$A
->
	`g‘RowDim’siÚ
();

60 
$this
->
n
 = 
$A
->
	`g‘CŞumnDim’siÚ
();

62 
$k
 = 0; $k < 
$this
->
n
; ++$k) {

64 
$Äm
 = 0.0;

65 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

66 
$Äm
 = 
	`hypo
($Äm, 
$this
->
QR
[
$i
][
$k
]);

68 ià(
$Äm
 != 0.0) {

70 ià(
$this
->
QR
[
$k
][$k] < 0) {

71 
$Äm
 = -$nrm;

73 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

74 
$this
->
QR
[
$i
][
$k
] /ğ
$Äm
;

76 
$this
->
QR
[
$k
][$k] += 1.0;

78 
$j
 = 
$k
+1; $j < 
$this
->
n
; ++$j) {

79 
$s
 = 0.0;

80 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

81 
$s
 +ğ
$this
->
QR
[
$i
][
$k
] * $this->QR[$i][
$j
];

83 
$s
 = -$s/
$this
->
QR
[
$k
][$k];

84 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

85 
$this
->
QR
[
$i
][
$j
] +ğ
$s
 * $this->QR[$i][
$k
];

89 
$this
->
RdŸg
[
$k
] = -
$Äm
;

92 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
PHPExûl_Sh¬ed_JAMA_M©rix
::
ARGUMENT_TYPE_EXCEPTION
);

102 
public
 
funùiÚ
 
	$isFuÎRªk
()

104 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

105 ià(
$this
->
RdŸg
[
$j
] == 0) {

106  
çl£
;

109  
Œue
;

110 
	}
}

117 
public
 
funùiÚ
 
	$g‘H
()

119 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

120 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

121 ià(
$i
 >ğ
$j
) {

122 
$H
[
$i
][
$j
] = 
$this
->
QR
[$i][$j];

124 
$H
[
$i
][
$j
] = 0.0;

128  
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$H
);

129 
	}
}

136 
public
 
funùiÚ
 
	$g‘R
()

138 
$i
 = 0; $˜< 
$this
->
n
; ++$i) {

139 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

140 ià(
$i
 < 
$j
) {

141 
$R
[
$i
][
$j
] = 
$this
->
QR
[$i][$j];

142 } 
	`–£if
 (
$i
 =ğ
$j
) {

143 
$R
[
$i
][
$j
] = 
$this
->
RdŸg
[$i];

145 
$R
[
$i
][
$j
] = 0.0;

149  
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$R
);

150 
	}
}

157 
public
 
funùiÚ
 
	$g‘Q
()

159 
$k
 = 
$this
->
n
-1; $k >= 0; --$k) {

160 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

161 
$Q
[
$i
][
$k
] = 0.0;

163 
$Q
[
$k
][$k] = 1.0;

164 
$j
 = 
$k
; $j < 
$this
->
n
; ++$j) {

165 ià(
$this
->
QR
[
$k
][$k] != 0) {

166 
$s
 = 0.0;

167 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

168 
$s
 +ğ
$this
->
QR
[
$i
][
$k
] * 
$Q
[$i][
$j
];

170 
$s
 = -$s/
$this
->
QR
[
$k
][$k];

171 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

172 
$Q
[
$i
][
$j
] +ğ
$s
 * 
$this
->
QR
[$i][
$k
];

186  
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
(
$Q
);

187 
	}
}

195 
public
 
funùiÚ
 
	$sŞve
(
$B
)

197 ià(
$B
->
	`g‘RowDim’siÚ
(è=ğ
$this
->
m
) {

198 ià(
$this
->
	`isFuÎRªk
()) {

200 
$nx
 = 
$B
->
	`g‘CŞumnDim’siÚ
();

201 
$X
 = 
$B
->
	`g‘A¼ayCİy
();

203 
$k
 = 0; $k < 
$this
->
n
; ++$k) {

204 
$j
 = 0; $j < 
$nx
; ++$j) {

205 
$s
 = 0.0;

206 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

207 
$s
 +ğ
$this
->
QR
[
$i
][
$k
] * 
$X
[$i][
$j
];

209 
$s
 = -$s/
$this
->
QR
[
$k
][$k];

210 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

211 
$X
[
$i
][
$j
] +ğ
$s
 * 
$this
->
QR
[$i][
$k
];

216 
$k
 = 
$this
->
n
-1; $k >= 0; --$k) {

217 
$j
 = 0; $j < 
$nx
; ++$j) {

218 
$X
[
$k
][
$j
] /ğ
$this
->
RdŸg
[$k];

220 
$i
 = 0; $˜< 
$k
; ++$i) {

221 
$j
 = 0; $j < 
$nx
; ++$j) {

222 
$X
[
$i
][
$j
] -ğ$X[
$k
][$j]* 
$this
->
QR
[$i][$k];

226 
$X
 = 
Ãw
 
	`PHPExûl_Sh¬ed_JAMA_M©rix
($X);

227  (
$X
->
	`g‘M©rix
(0, 
$this
->
n
-1, 0, 
$nx
));

229 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
£lf
::
MATRIX_RANK_EXCEPTION
);

232 
throw
 
Ãw
 
	`PHPExûl_C®cuÏtiÚ_Exû±iÚ
(
PHPExûl_Sh¬ed_JAMA_M©rix
::
MATRIX_DIMENSION_EXCEPTION
);

234 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/SingularValueDecomposition.php

1 <?
php


20 şas 
	cSšguÏrV®ueDecompos™iÚ


26 
´iv©e
 
	m$U
 = 
¬¿y
();

32 
´iv©e
 
	m$V
 = 
¬¿y
();

38 
´iv©e
 
	m$s
 = 
¬¿y
();

44 
´iv©e
 
	m$m
;

50 
´iv©e
 
	m$n
;

60 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$Arg
)

63 
$A
 = 
$Arg
->
	`g‘A¼ayCİy
();

64 
$this
->
m
 = 
$Arg
->
	`g‘RowDim’siÚ
();

65 
$this
->
n
 = 
$Arg
->
	`g‘CŞumnDim’siÚ
();

66 
$nu
 = 
	`mš
(
$this
->
m
, $this->
n
);

67 
$e
 = 
	`¬¿y
();

68 
$wÜk
 = 
	`¬¿y
();

69 
$wªtu
 = 
Œue
;

70 
$wªtv
 = 
Œue
;

71 
$nù
 = 
	`mš
(
$this
->
m
 - 1, $this->
n
);

72 
$Ät
 = 
	`max
(0, 
	`mš
(
$this
->
n
 - 2, $this->
m
));

76 
$k
 = 0; $k < 
	`max
(
$nù
, 
$Ät
); ++$k) {

77 ià(
$k
 < 
$nù
) {

81 
$this
->
s
[
$k
] = 0;

82 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

83 
$this
->
s
[
$k
] = 
	`hypo
($this->s[$k], 
$A
[
$i
][$k]);

85 ià(
$this
->
s
[
$k
] != 0.0) {

86 ià(
$A
[
$k
][$k] < 0.0) {

87 
$this
->
s
[
$k
] = -$this->s[$k];

89 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

90 
$A
[
$i
][
$k
] /ğ
$this
->
s
[$k];

92 
$A
[
$k
][$k] += 1.0;

94 
$this
->
s
[
$k
] = -$this->s[$k];

97 
$j
 = 
$k
 + 1; $j < 
$this
->
n
; ++$j) {

98 ià((
$k
 < 
$nù
è& (
$this
->
s
[$k] != 0.0)) {

100 
$t
 = 0;

101 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

102 
$t
 +ğ
$A
[
$i
][
$k
] * $A[$i][
$j
];

104 
$t
 = -$ˆ/ 
$A
[
$k
][$k];

105 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

106 
$A
[
$i
][
$j
] +ğ
$t
 * $A[$i][
$k
];

110 
$e
[
$j
] = 
$A
[
$k
][$j];

114 ià(
$wªtu
 
	`ªd
 (
$k
 < 
$nù
)) {

117 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

118 
$this
->
U
[
$i
][
$k
] = 
$A
[$i][$k];

122 ià(
$k
 < 
$Ät
) {

126 
$e
[
$k
] = 0;

127 
$i
 = 
$k
 + 1; $˜< 
$this
->
n
; ++$i) {

128 
$e
[
$k
] = 
	`hypo
($e[$k], $e[
$i
]);

130 ià(
$e
[
$k
] != 0.0) {

131 ià(
$e
[
$k
+1] < 0.0) {

132 
$e
[
$k
] = -$e[$k];

134 
$i
 = 
$k
 + 1; $˜< 
$this
->
n
; ++$i) {

135 
$e
[
$i
] /ğ$e[
$k
];

137 
$e
[
$k
+1] += 1.0;

139 
$e
[
$k
] = -$e[$k];

140 ià((
$k
+1 < 
$this
->
m
è
	`ªd
 (
$e
[$k] != 0.0)) {

142 
$i
 = 
$k
+1; $˜< 
$this
->
m
; ++$i) {

143 
$wÜk
[
$i
] = 0.0;

145 
$j
 = 
$k
+1; $j < 
$this
->
n
; ++$j) {

146 
$i
 = 
$k
+1; $˜< 
$this
->
m
; ++$i) {

147 
$wÜk
[
$i
] +ğ
$e
[
$j
] * 
$A
[$i][$j];

150 
$j
 = 
$k
 + 1; $j < 
$this
->
n
; ++$j) {

151 
$t
 = -
$e
[
$j
] / $e[
$k
+1];

152 
$i
 = 
$k
 + 1; $˜< 
$this
->
m
; ++$i) {

153 
$A
[
$i
][
$j
] +ğ
$t
 * 
$wÜk
[$i];

157 ià(
$wªtv
) {

160 
$i
 = 
$k
 + 1; $˜< 
$this
->
n
; ++$i) {

161 
$this
->
V
[
$i
][
$k
] = 
$e
[$i];

168 
$p
 = 
	`mš
(
$this
->
n
, $this->
m
 + 1);

169 ià(
$nù
 < 
$this
->
n
) {

170 
$this
->
s
[
$nù
] = 
$A
[$nct][$nct];

172 ià(
$this
->
m
 < 
$p
) {

173 
$this
->
s
[
$p
-1] = 0.0;

175 ià(
$Ät
 + 1 < 
$p
) {

176 
$e
[
$Ät
] = 
$A
[$Ät][
$p
-1];

178 
$e
[
$p
-1] = 0.0;

180 ià(
$wªtu
) {

181 
$j
 = 
$nù
; $j < 
$nu
; ++$j) {

182 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

183 
$this
->
U
[
$i
][
$j
] = 0.0;

185 
$this
->
U
[
$j
][$j] = 1.0;

187 
$k
 = 
$nù
 - 1; $k >= 0; --$k) {

188 ià(
$this
->
s
[
$k
] != 0.0) {

189 
$j
 = 
$k
 + 1; $j < 
$nu
; ++$j) {

190 
$t
 = 0;

191 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

192 
$t
 +ğ
$this
->
U
[
$i
][
$k
] * $this->U[$i][
$j
];

194 
$t
 = -$ˆ/ 
$this
->
U
[
$k
][$k];

195 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

196 
$this
->
U
[
$i
][
$j
] +ğ
$t
 * $this->U[$i][
$k
];

199 
$i
 = 
$k
; $˜< 
$this
->
m
; ++$i) {

200 
$this
->
U
[
$i
][
$k
] = -$this->U[$i][$k];

202 
$this
->
U
[
$k
][$k] = 1.0 + $this->U[$k][$k];

203 
$i
 = 0; $˜< 
$k
 - 1; ++$i) {

204 
$this
->
U
[
$i
][
$k
] = 0.0;

207 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

208 
$this
->
U
[
$i
][
$k
] = 0.0;

210 
$this
->
U
[
$k
][$k] = 1.0;

216 ià(
$wªtv
) {

217 
$k
 = 
$this
->
n
 - 1; $k >= 0; --$k) {

218 ià((
$k
 < 
$Ät
è
	`ªd
 (
$e
[$k] != 0.0)) {

219 
$j
 = 
$k
 + 1; $j < 
$nu
; ++$j) {

220 
$t
 = 0;

221 
$i
 = 
$k
 + 1; $˜< 
$this
->
n
; ++$i) {

222 
$t
 +ğ
$this
->
V
[
$i
][
$k
]* $this->V[$i][
$j
];

224 
$t
 = -$ˆ/ 
$this
->
V
[
$k
+1][$k];

225 
$i
 = 
$k
 + 1; $˜< 
$this
->
n
; ++$i) {

226 
$this
->
V
[
$i
][
$j
] +ğ
$t
 * $this->V[$i][
$k
];

230 
$i
 = 0; $˜< 
$this
->
n
; ++$i) {

231 
$this
->
V
[
$i
][
$k
] = 0.0;

233 
$this
->
V
[
$k
][$k] = 1.0;

238 
$µ
 = 
$p
 - 1;

239 
$™”
 = 0;

240 
$•s
 = 
	`pow
(2.0, -52.0);

242 
$p
 > 0) {

252 
$k
 = 
$p
 - 2; $k >= -1; --$k) {

253 ià(
$k
 == -1) {

256 ià(
	`abs
(
$e
[
$k
]è<ğ
$•s
 * (abs(
$this
->
s
[$k]) +‡bs($this->s[$k+1]))) {

257 
$e
[
$k
] = 0.0;

261 ià(
$k
 =ğ
$p
 - 2) {

262 
$ka£
 = 4;

264 
$ks
 = 
$p
 - 1; $k >ğ
$k
; --$ks) {

265 ià(
$ks
 =ğ
$k
) {

268 
$t
 = (
$ks
 !ğ
$p
 ? 
	`abs
(
$e
[$ks]è: 0.è+ ($k !ğ
$k
 + 1 ?‡bs($e[$ks-1]) : 0.);

269 ià(
	`abs
(
$this
->
s
[
$ks
]è<ğ
$•s
 * 
$t
) {

270 
$this
->
s
[
$ks
] = 0.0;

274 ià(
$ks
 =ğ
$k
) {

275 
$ka£
 = 3;

276 } 
	`–£if
 (
$ks
 =ğ
$p
-1) {

277 
$ka£
 = 1;

279 
$ka£
 = 2;

280 
$k
 = 
$ks
;

283 ++
$k
;

286 
$ka£
) {

289 
$f
 = 
$e
[
$p
-2];

290 
$e
[
$p
-2] = 0.0;

291 
$j
 = 
$p
 - 2; $j >ğ
$k
; --$j) {

292 
$t
 = 
	`hypo
(
$this
->
s
[
$j
], 
$f
);

293 
$cs
 = 
$this
->
s
[
$j
] / 
$t
;

294 
$¢
 = 
$f
 / 
$t
;

295 
$this
->
s
[
$j
] = 
$t
;

296 ià(
$j
 !ğ
$k
) {

297 
$f
 = -
$¢
 * 
$e
[
$j
-1];

298 
$e
[
$j
-1] = 
$cs
 * $e[$j-1];

300 ià(
$wªtv
) {

301 
$i
 = 0; $˜< 
$this
->
n
; ++$i) {

302 
$t
 = 
$cs
 * 
$this
->
V
[
$i
][
$j
] + 
$¢
 * $this->V[$i][
$p
-1];

303 
$this
->
V
[
$i
][
$p
-1] = -
$¢
 * $this->V[$i][
$j
] + 
$cs
 * $this->V[$i][$p-1];

304 
$this
->
V
[
$i
][
$j
] = 
$t
;

311 
$f
 = 
$e
[
$k
-1];

312 
$e
[
$k
-1] = 0.0;

313 
$j
 = 
$k
; $j < 
$p
; ++$j) {

314 
$t
 = 
	`hypo
(
$this
->
s
[
$j
], 
$f
);

315 
$cs
 = 
$this
->
s
[
$j
] / 
$t
;

316 
$¢
 = 
$f
 / 
$t
;

317 
$this
->
s
[
$j
] = 
$t
;

318 
$f
 = -
$¢
 * 
$e
[
$j
];

319 
$e
[
$j
] = 
$cs
 * $e[$j];

320 ià(
$wªtu
) {

321 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

322 
$t
 = 
$cs
 * 
$this
->
U
[
$i
][
$j
] + 
$¢
 * $this->U[$i][
$k
-1];

323 
$this
->
U
[
$i
][
$k
-1] = -
$¢
 * $this->U[$i][
$j
] + 
$cs
 * $this->U[$i][$k-1];

324 
$this
->
U
[
$i
][
$j
] = 
$t
;

332 
$sÿË
 = 
	`max
(max(max(max(
	`abs
(
$this
->
s
[
$p
-1]),‡bs($this->s[$p-2])),‡bs(
$e
[$p-2])),‡bs($this->s[
$k
])),‡bs($e[$k]));

333 
$¥
 = 
$this
->
s
[
$p
-1] / 
$sÿË
;

334 
$¥m1
 = 
$this
->
s
[
$p
-2] / 
$sÿË
;

335 
$•m1
 = 
$e
[
$p
-2] / 
$sÿË
;

336 
$sk
 = 
$this
->
s
[
$k
] / 
$sÿË
;

337 
$ek
 = 
$e
[
$k
] / 
$sÿË
;

338 
$b
 = ((
$¥m1
 + 
$¥
è* ($¥m1 - $¥è+ 
$•m1
 * $epm1) / 2.0;

339 
$c
 = (
$¥
 * 
$•m1
) * ($sp * $epm1);

340 
$shiá
 = 0.0;

341 ià((
$b
 !ğ0.0è|| (
$c
 != 0.0)) {

342 
$shiá
 = 
	`sq¹
(
$b
 * $b + 
$c
);

343 ià(
$b
 < 0.0) {

344 
$shiá
 = -$shift;

346 
$shiá
 = 
$c
 / (
$b
 + $shift);

348 
$f
 = (
$sk
 + 
$¥
è* ($sk - $¥è+ 
$shiá
;

349 
$g
 = 
$sk
 * 
$ek
;

351 
$j
 = 
$k
; $j < 
$p
-1; ++$j) {

352 
$t
 = 
	`hypo
(
$f
, 
$g
);

353 
$cs
 = 
$f
/
$t
;

354 
$¢
 = 
$g
/
$t
;

355 ià(
$j
 !ğ
$k
) {

356 
$e
[
$j
-1] = 
$t
;

358 
$f
 = 
$cs
 * 
$this
->
s
[
$j
] + 
$¢
 * 
$e
[$j];

359 
$e
[
$j
] = 
$cs
 * $e[$j] - 
$¢
 * 
$this
->
s
[$j];

360 
$g
 = 
$¢
 * 
$this
->
s
[
$j
+1];

361 
$this
->
s
[
$j
+1] = 
$cs
 * $this->s[$j+1];

362 ià(
$wªtv
) {

363 
$i
 = 0; $˜< 
$this
->
n
; ++$i) {

364 
$t
 = 
$cs
 * 
$this
->
V
[
$i
][
$j
] + 
$¢
 * $this->V[$i][$j+1];

365 
$this
->
V
[
$i
][
$j
+1] = -
$¢
 * $this->V[$i][$j] + 
$cs
 * $this->V[$i][$j+1];

366 
$this
->
V
[
$i
][
$j
] = 
$t
;

369 
$t
 = 
	`hypo
(
$f
, 
$g
);

370 
$cs
 = 
$f
/
$t
;

371 
$¢
 = 
$g
/
$t
;

372 
$this
->
s
[
$j
] = 
$t
;

373 
$f
 = 
$cs
 * 
$e
[
$j
] + 
$¢
 * 
$this
->
s
[$j+1];

374 
$this
->
s
[
$j
+1] = -
$¢
 * 
$e
[$j] + 
$cs
 * $this->s[$j+1];

375 
$g
 = 
$¢
 * 
$e
[
$j
+1];

376 
$e
[
$j
+1] = 
$cs
 * $e[$j+1];

377 ià(
$wªtu
 && (
$j
 < 
$this
->
m
 - 1)) {

378 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

379 
$t
 = 
$cs
 * 
$this
->
U
[
$i
][
$j
] + 
$¢
 * $this->U[$i][$j+1];

380 
$this
->
U
[
$i
][
$j
+1] = -
$¢
 * $this->U[$i][$j] + 
$cs
 * $this->U[$i][$j+1];

381 
$this
->
U
[
$i
][
$j
] = 
$t
;

385 
$e
[
$p
-2] = 
$f
;

386 
$™”
 = $iter + 1;

391 ià(
$this
->
s
[
$k
] <= 0.0) {

392 
$this
->
s
[
$k
] = ($this->s[$k] < 0.0 ? -$this->s[$k] : 0.0);

393 ià(
$wªtv
) {

394 
$i
 = 0; $˜<ğ
$µ
; ++$i) {

395 
$this
->
V
[
$i
][
$k
] = -$this->V[$i][$k];

400 
$k
 < 
$µ
) {

401 ià(
$this
->
s
[
$k
] >= $this->s[$k+1]) {

404 
$t
 = 
$this
->
s
[
$k
];

405 
$this
->
s
[
$k
] = $this->s[$k+1];

406 
$this
->
s
[
$k
+1] = 
$t
;

407 ià(
$wªtv
 
	`ªd
 (
$k
 < 
$this
->
n
 - 1)) {

408 
$i
 = 0; $˜< 
$this
->
n
; ++$i) {

409 
$t
 = 
$this
->
V
[
$i
][
$k
+1];

410 
$this
->
V
[
$i
][
$k
+1] = $this->V[$i][$k];

411 
$this
->
V
[
$i
][
$k
] = 
$t
;

414 ià(
$wªtu
 
	`ªd
 (
$k
 < 
$this
->
m
-1)) {

415 
$i
 = 0; $˜< 
$this
->
m
; ++$i) {

416 
$t
 = 
$this
->
U
[
$i
][
$k
+1];

417 
$this
->
U
[
$i
][
$k
+1] = $this->U[$i][$k];

418 
$this
->
U
[
$i
][
$k
] = 
$t
;

421 ++
$k
;

423 
$™”
 = 0;

424 --
$p
;

438 
public
 
funùiÚ
 
	$g‘U
()

440  
Ãw
 
	`M©rix
(
$this
->
U
, $this->
m
, 
	`mš
($this->m + 1, $this->
n
));

441 
	}
}

450 
public
 
funùiÚ
 
	$g‘V
()

452  
Ãw
 
	`M©rix
(
$this
->
V
);

453 
	}
}

462 
public
 
funùiÚ
 
	$g‘SšguÏrV®ues
()

464  
$this
->
s
;

465 
	}
}

474 
public
 
funùiÚ
 
	$g‘S
()

476 
$i
 = 0; $˜< 
$this
->
n
; ++$i) {

477 
$j
 = 0; $j < 
$this
->
n
; ++$j) {

478 
$S
[
$i
][
$j
] = 0.0;

480 
$S
[
$i
][$i] = 
$this
->
s
[$i];

482  
Ãw
 
	`M©rix
(
$S
);

483 
	}
}

492 
public
 
funùiÚ
 
	$nÜm2
()

494  
$this
->
s
[0];

495 
	}
}

504 
public
 
funùiÚ
 
	$cÚd
()

506  
$this
->
s
[0] / $this->s[
	`mš
($this->
m
, $this->
n
) - 1];

507 
	}
}

516 
public
 
funùiÚ
 
	$¿nk
()

518 
$•s
 = 
	`pow
(2.0, -52.0);

519 
$tŞ
 = 
	`max
(
$this
->
m
, $this->
n
è* $this->
s
[0] * 
$•s
;

520 
$r
 = 0;

521 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
s
); ++$i) {

522 ià(
$this
->
s
[
$i
] > 
$tŞ
) {

523 ++
$r
;

526  
$r
;

527 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/utils/Error.php

1 <?
php


11 
defše
('JAMALANG', 'EN');

17 
	g$”rÜ
 = 
¬¿y
();

24 
defše
('POLYMORPHIC_ARGUMENT_EXCEPTION', -1);

25 
	g$”rÜ
['EN'][
POLYMORPHIC_ARGUMENT_EXCEPTION
] = "Invalid‡rgument…attern for…olymorphic function.";

26 
	g$”rÜ
['FR'][
POLYMORPHIC_ARGUMENT_EXCEPTION
] = "ModÃ¨le inadmissible d'argument…our†a fonction…olymorphe.".

27 
$”rÜ
['DE'][
POLYMORPHIC_ARGUMENT_EXCEPTION
] = "UnzulÃ¤ssiges Argumentmuster fÃ¼r…olymorphe Funktion.";

29 
defše
('ARGUMENT_TYPE_EXCEPTION', -2);

30 
	g$”rÜ
['EN'][
ARGUMENT_TYPE_EXCEPTION
] = "Invalid‡rgumentype.";

31 
	g$”rÜ
['FR'][
ARGUMENT_TYPE_EXCEPTION
] = "Type inadmissible d'argument.";

32 
	g$”rÜ
['DE'][
ARGUMENT_TYPE_EXCEPTION
] = "UnzulÃ¤ssige Argumentart.";

34 
defše
('ARGUMENT_BOUNDS_EXCEPTION', -3);

35 
	g$”rÜ
['EN'][
ARGUMENT_BOUNDS_EXCEPTION
] = "Invalid‡rgument„ange.";

36 
	g$”rÜ
['FR'][
ARGUMENT_BOUNDS_EXCEPTION
] = "Gamme inadmissible d'argument.";

37 
	g$”rÜ
['DE'][
ARGUMENT_BOUNDS_EXCEPTION
] = "UnzulÃ¤ssige Argumentstrecke.";

39 
defše
('MATRIX_DIMENSION_EXCEPTION', -4);

40 
	g$”rÜ
['EN'][
MATRIX_DIMENSION_EXCEPTION
] = "Matrix dimensions‡re‚otƒqual.";

41 
	g$”rÜ
['FR'][
MATRIX_DIMENSION_EXCEPTION
] = "Les dimensions de Matrix‚e sont…as Ã©gales.";

42 
	g$”rÜ
['DE'][
MATRIX_DIMENSION_EXCEPTION
] = "MatrixmaÃŸe sind‚icht gleich.";

44 
defše
('PRECISION_LOSS_EXCEPTION', -5);

45 
	g$”rÜ
['EN'][
PRECISION_LOSS_EXCEPTION
] = "Significant…recision†oss detected.";

46 
	g$”rÜ
['FR'][
PRECISION_LOSS_EXCEPTION
] = "Perte significative de…rÃ©cision dÃ©tectÃ©e.";

47 
	g$”rÜ
['DE'][
PRECISION_LOSS_EXCEPTION
] = "Bedeutender PrÃ¤zision Verlustƒrmittelte.";

49 
defše
('MATRIX_SPD_EXCEPTION', -6);

50 
	g$”rÜ
['EN'][
MATRIX_SPD_EXCEPTION
] = "Can only…erform operation on symmetric…ositive definite matrix.";

51 
	g$”rÜ
['FR'][
MATRIX_SPD_EXCEPTION
] = "Perte significative de…rÃ©cision dÃ©tectÃ©e.";

52 
	g$”rÜ
['DE'][
MATRIX_SPD_EXCEPTION
] = "Bedeutender PrÃ¤zision Verlustƒrmittelte.";

54 
defše
('MATRIX_SINGULAR_EXCEPTION', -7);

55 
	g$”rÜ
['EN'][
MATRIX_SINGULAR_EXCEPTION
] = "Can only…erform operation on singular matrix.";

57 
defše
('MATRIX_RANK_EXCEPTION', -8);

58 
	g$”rÜ
['EN'][
MATRIX_RANK_EXCEPTION
] = "Can only…erform operation on full-rank matrix.";

60 
defše
('ARRAY_LENGTH_EXCEPTION', -9);

61 
	g$”rÜ
['EN'][
ARRAY_LENGTH_EXCEPTION
] = "Array†ength must be‡ multiple of m.";

63 
defše
('ROW_LENGTH_EXCEPTION', -10);

64 
	g$”rÜ
['EN'][
ROW_LENGTH_EXCEPTION
] = "All„ows must havehe same†ength.";

70 
funùiÚ
 
	$JAMAE¼Ü
(
$”rÜNumb”
 = 
nuÎ
)

72 
glob®
 
$”rÜ
;

74 ià(
	`is£t
(
$”rÜNumb”
)) {

75 ià(
	`is£t
(
$”rÜ
[
JAMALANG
][
$”rÜNumb”
])) {

76  
$”rÜ
[
JAMALANG
][
$”rÜNumb”
];

78  
$”rÜ
['EN'][
$”rÜNumb”
];

83 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/utils/Maths.php

1 <?
php


14 
funùiÚ
 
	$hypo
(
$a
, 
$b
)

16 ià(
	`abs
(
$a
è>‡bs(
$b
)) {

17 
$r
 = 
$b
 / 
$a
;

18 
$r
 = 
	`abs
(
$a
è* 
	`sq¹
(1 + $r * $r);

19 } 
	`–£if
 (
$b
 != 0) {

20 
$r
 = 
$a
 / 
$b
;

21 
$r
 = 
	`abs
(
$b
è* 
	`sq¹
(1 + $r * $r);

23 
$r
 = 0.0;

25  
$r
;

26 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLE.php

1 <?
php


28 
	g$GLOBALS
['_OLE_INSTANCES'] = 
¬¿y
();

38 şas 
	cPHPExûl_Sh¬ed_OLE


40 cÚ¡ 
	mOLE_PPS_TYPE_ROOT
 = 5;

41 cÚ¡ 
	mOLE_PPS_TYPE_DIR
 = 1;

42 cÚ¡ 
	mOLE_PPS_TYPE_FILE
 = 2;

43 cÚ¡ 
	mOLE_DATA_SIZE_SMALL
 = 0x1000;

44 cÚ¡ 
	mOLE_LONG_INT_SIZE
 = 4;

45 cÚ¡ 
	mOLE_PPS_SIZE
 = 0x80;

51 
public
 
	m$_fe_hªdË
;

57 
public
 
	m$_li¡
 = 
¬¿y
();

63 
public
 
	m$roÙ
;

69 
public
 
	m$bb©
;

75 
public
 
	m$sb©
;

81 
public
 
	m$bigBlockSize
;

87 
public
 
	m$sm®lBlockSize
;

96 
public
 
funùiÚ
 
	$»ad
(
$fe
)

98 
$fh
 = 
	`fİ’
(
$fe
, "r");

99 ià(!
$fh
) {

100 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Can't open file $file");

102 
$this
->
_fe_hªdË
 = 
$fh
;

104 
$sigÇtu»
 = 
	`ä—d
(
$fh
, 8);

105 ià("\xD0\xCF\x11\xE0\xA1\xB1\x1A\xE1" !ğ
$sigÇtu»
) {

106 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("File doesn't seemo be‡n OLE container.");

108 
	`f£ek
(
$fh
, 28);

109 ià(
	`ä—d
(
$fh
, 2) != "\xFE\xFF") {

111 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Only Little-Endianƒncoding is supported.");

114 
$this
->
bigBlockSize
 = 
	`pow
(2, 
£lf
::
	`_»adIÁ2
(
$fh
));

115 
$this
->
sm®lBlockSize
 = 
	`pow
(2, 
£lf
::
	`_»adIÁ2
(
$fh
));

118 
	`f£ek
(
$fh
, 44);

120 
$bb©BlockCouÁ
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

123 
$dœeùÜyFœ¡BlockId
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

126 
	`f£ek
(
$fh
, 56);

128 
$this
->
bigBlockTh»shŞd
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

130 
$sb©Fœ¡BlockId
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

132 
$sbb©BlockCouÁ
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

134 
$mb©Fœ¡BlockId
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

136 
$mbb©BlockCouÁ
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

137 
$this
->
bb©
 = 
	`¬¿y
();

141 
$mb©Blocks
 = 
	`¬¿y
();

142 
$i
 = 0; $i < 109; ++$i) {

143 
$mb©Blocks
[] = 
£lf
::
	`_»adIÁ4
(
$fh
);

147 
$pos
 = 
$this
->
	`_g‘BlockOff£t
(
$mb©Fœ¡BlockId
);

148 
$i
 = 0; $˜< 
$mbb©BlockCouÁ
; ++$i) {

149 
	`f£ek
(
$fh
, 
$pos
);

150 
$j
 = 0; $j < 
$this
->
bigBlockSize
 / 4 - 1; ++$j) {

151 
$mb©Blocks
[] = 
£lf
::
	`_»adIÁ4
(
$fh
);

154 
$pos
 = 
$this
->
	`_g‘BlockOff£t
(
£lf
::
	`_»adIÁ4
(
$fh
));

159 
$i
 = 0; $˜< 
$bb©BlockCouÁ
; ++$i) {

160 
$pos
 = 
$this
->
	`_g‘BlockOff£t
(
$mb©Blocks
[
$i
]);

161 
	`f£ek
(
$fh
, 
$pos
);

162 
$j
 = 0; $j < 
$this
->
bigBlockSize
 / 4; ++$j) {

163 
$this
->
bb©
[] = 
£lf
::
	`_»adIÁ4
(
$fh
);

168 
$this
->
sb©
 = 
	`¬¿y
();

169 
$shÜtBlockCouÁ
 = 
$sbb©BlockCouÁ
 * 
$this
->
bigBlockSize
 / 4;

170 
$sb©Fh
 = 
$this
->
	`g‘SŒ—m
(
$sb©Fœ¡BlockId
);

171 
$blockId
 = 0; $blockId < 
$shÜtBlockCouÁ
; ++$blockId) {

172 
$this
->
sb©
[
$blockId
] = 
£lf
::
	`_»adIÁ4
(
$sb©Fh
);

174 
	`fşo£
(
$sb©Fh
);

176 
$this
->
	`_»adPpsWks
(
$dœeùÜyFœ¡BlockId
);

178  
Œue
;

186 
public
 
funùiÚ
 
	$_g‘BlockOff£t
(
$blockId
)

188  512 + 
$blockId
 * 
$this
->
bigBlockSize
;

189 
	}
}

197 
public
 
funùiÚ
 
	$g‘SŒ—m
(
$blockIdOrPps
)

199 
$isRegi¡”ed
 = 
çl£
;

200 ià(!
$isRegi¡”ed
) {

201 
	`¡»am_w¿µ”_»gi¡”
('ole-chainedblockstream', 'PHPExcel_Shared_OLE_ChainedBlockStream');

202 
$isRegi¡”ed
 = 
Œue
;

208 
$GLOBALS
['_OLE_INSTANCES'][] = 
$this
;

209 
$š¡ªûId
 = 
	`’d
(
	`¬¿y_keys
(
$GLOBALS
['_OLE_INSTANCES']));

211 
$·th
 = 'Şe-chašedblock¡»am://ŞeIn¡ªûId=' . 
$š¡ªûId
;

212 ià(
$blockIdOrPps
 
š¡ªûof
 
PHPExûl_Sh¬ed_OLE_PPS
) {

213 
$·th
 .ğ'&blockId=' . 
$blockIdOrPps
->
_S¹Block
;

214 
$·th
 .ğ'&size=' . 
$blockIdOrPps
->
Size
;

216 
$·th
 .ğ'&blockId=' . 
$blockIdOrPps
;

218  
	`fİ’
(
$·th
, 'r');

219 
	}
}

227 
´iv©e
 
funùiÚ
 
	$_»adIÁ1
(
$fh
)

229 
	`li¡
(, 
$tmp
èğ
	`uÅack
("c", 
	`ä—d
(
$fh
, 1));

230  
$tmp
;

231 
	}
}

239 
´iv©e
 
funùiÚ
 
	$_»adIÁ2
(
$fh
)

241 
	`li¡
(, 
$tmp
èğ
	`uÅack
("v", 
	`ä—d
(
$fh
, 2));

242  
$tmp
;

243 
	}
}

251 
´iv©e
 
funùiÚ
 
	$_»adIÁ4
(
$fh
)

253 
	`li¡
(, 
$tmp
èğ
	`uÅack
("V", 
	`ä—d
(
$fh
, 4));

254  
$tmp
;

255 
	}
}

265 
public
 
funùiÚ
 
	$_»adPpsWks
(
$blockId
)

267 
$fh
 = 
$this
->
	`g‘SŒ—m
(
$blockId
);

268 
$pos
 = 0;; $pos += 128) {

269 
	`f£ek
(
$fh
, 
$pos
, 
SEEK_SET
);

270 
$ÇmeUtf16
 = 
	`ä—d
(
$fh
, 64);

271 
$ÇmeL’gth
 = 
£lf
::
	`_»adIÁ2
(
$fh
);

272 
$ÇmeUtf16
 = 
	`sub¡r
($ÇmeUtf16, 0, 
$ÇmeL’gth
 - 2);

274 
$Çme
 = 
	`¡r_»¶aû
("\x00", "", 
$ÇmeUtf16
);

275 
$ty³
 = 
£lf
::
	`_»adIÁ1
(
$fh
);

276 
$ty³
) {

277 
£lf
::
OLE_PPS_TYPE_ROOT
:

278 
$µs
 = 
Ãw
 
	`PHPExûl_Sh¬ed_OLE_PPS_RoÙ
(
nuÎ
,‚uÎ, 
	`¬¿y
());

279 
$this
->
roÙ
 = 
$µs
;

281 
£lf
::
OLE_PPS_TYPE_DIR
:

282 
$µs
 = 
Ãw
 
	`PHPExûl_Sh¬ed_OLE_PPS
(
nuÎ
,‚uÎ,‚uÎ,‚uÎ,‚uÎ,‚uÎ,‚uÎ,‚uÎ,‚uÎ, 
	`¬¿y
());

284 
£lf
::
OLE_PPS_TYPE_FILE
:

285 
$µs
 = 
Ãw
 
	`PHPExûl_Sh¬ed_OLE_PPS_Fe
(
$Çme
);

290 
	`f£ek
(
$fh
, 1, 
SEEK_CUR
);

291 
$µs
->
Ty³
 = 
$ty³
;

292 
$µs
->
Name
 = 
$Çme
;

293 
$µs
->
P»vPps
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

294 
$µs
->
NextPps
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

295 
$µs
->
DœPps
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

296 
	`f£ek
(
$fh
, 20, 
SEEK_CUR
);

297 
$µs
->
Time1¡
 = 
£lf
::
	`OLE2LoÿlD©e
(
	`ä—d
(
$fh
, 8));

298 
$µs
->
Time2nd
 = 
£lf
::
	`OLE2LoÿlD©e
(
	`ä—d
(
$fh
, 8));

299 
$µs
->
_S¹Block
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

300 
$µs
->
Size
 = 
£lf
::
	`_»adIÁ4
(
$fh
);

301 
$µs
->
No
 = 
	`couÁ
(
$this
->
_li¡
);

302 
$this
->
_li¡
[] = 
$µs
;

305 ià(
	`is£t
(
$this
->
roÙ
è&& $this->
	`_µsT»eCom¶‘e
($this->roÙ->
No
)) {

309 
	`fşo£
(
$fh
);

312 
	`fÜ—ch
 (
$this
->
_li¡
 
as
 
$µs
) {

313 ià(
$µs
->
Ty³
 =ğ
£lf
::
OLE_PPS_TYPE_DIR
 || $µs->Ty³ =ğ£lf::
OLE_PPS_TYPE_ROOT
) {

314 
$nos
 = 
	`¬¿y
(
$µs
->
DœPps
);

315 
$µs
->
chd»n
 = 
	`¬¿y
();

316 
$nos
) {

317 
$no
 = 
	`¬¿y_pİ
(
$nos
);

318 ià(
$no
 != -1) {

319 
$chdPps
 = 
$this
->
_li¡
[
$no
];

320 
$nos
[] = 
$chdPps
->
P»vPps
;

321 
$nos
[] = 
$chdPps
->
NextPps
;

322 
$µs
->
chd»n
[] = 
$chdPps
;

328  
Œue
;

329 
	}
}

339 
public
 
funùiÚ
 
	$_µsT»eCom¶‘e
(
$šdex
)

341  
	`is£t
(
$this
->
_li¡
[
$šdex
]) &&

342 (
$µs
 = 
$this
->
_li¡
[
$šdex
]) &&

343 (
$µs
->
P»vPps
 == -1 ||

344 
$this
->
	`_µsT»eCom¶‘e
(
$µs
->
P»vPps
)) &&

345 (
$µs
->
NextPps
 == -1 ||

346 
$this
->
	`_µsT»eCom¶‘e
(
$µs
->
NextPps
)) &&

347 (
$µs
->
DœPps
 == -1 ||

348 
$this
->
	`_µsT»eCom¶‘e
(
$µs
->
DœPps
));

349 
	}
}

359 
public
 
funùiÚ
 
	$isFe
(
$šdex
)

361 ià(
	`is£t
(
$this
->
_li¡
[
$šdex
])) {

362  (
$this
->
_li¡
[
$šdex
]->
Ty³
 =ğ
£lf
::
OLE_PPS_TYPE_FILE
);

364  
çl£
;

365 
	}
}

375 
public
 
funùiÚ
 
	$isRoÙ
(
$šdex
)

377 ià(
	`is£t
(
$this
->
_li¡
[
$šdex
])) {

378  (
$this
->
_li¡
[
$šdex
]->
Ty³
 =ğ
£lf
::
OLE_PPS_TYPE_ROOT
);

380  
çl£
;

381 
	}
}

389 
public
 
funùiÚ
 
	$µsTÙ®
()

391  
	`couÁ
(
$this
->
_li¡
);

392 
	}
}

406 
public
 
funùiÚ
 
	$g‘D©a
(
$šdex
, 
$pos™iÚ
, 
$Ëngth
)

409 ià(!
	`is£t
(
$this
->
_li¡
[
$šdex
]è|| (
$pos™iÚ
 >ğ$this->_li¡[$šdex]->
Size
) || ($position < 0)) {

412 
$fh
 = 
$this
->
	`g‘SŒ—m
($this->
_li¡
[
$šdex
]);

413 
$d©a
 = 
	`¡»am_g‘_cÚ‹Ás
(
$fh
, 
$Ëngth
, 
$pos™iÚ
);

414 
	`fşo£
(
$fh
);

415  
$d©a
;

416 
	}
}

426 
public
 
funùiÚ
 
	$g‘D©aL’gth
(
$šdex
)

428 ià(
	`is£t
(
$this
->
_li¡
[
$šdex
])) {

429  
$this
->
_li¡
[
$šdex
]->
Size
;

432 
	}
}

442 
public
 
funùiÚ
 
	$Asc2Ucs
(
$ascii
)

444 
$¿wÇme
 = '';

445 
$i
 = 0; $˜< 
	`¡¾’
(
$ascii
); ++$i) {

446 
$¿wÇme
 .ğ
$ascii
{
$i
} . "\x00";

448  
$¿wÇme
;

449 
	}
}

460 
public
 
funùiÚ
 
	$LoÿlD©e2OLE
(
$d©e
 = 
nuÎ
)

462 ià(!
	`is£t
(
$d©e
)) {

467 
$çùÜ
 = 
	`pow
(2, 32);

470 
$days
 = 134774;

472 
$big_d©e
 = 
$days
*24*3600 + 
	`gmmktime
(
	`d©e
("H", 
$d©e
), date("i", $date), date("s", $date), date("m", $date), date("d", $date), date("Y", $date));

474 
$big_d©e
 *= 10000000;

476 
$high_·¹
 = 
	`æoÜ
(
$big_d©e
 / 
$çùÜ
);

478 
$low_·¹
 = 
	`æoÜ
(((
$big_d©e
 / 
$çùÜ
è- 
$high_·¹
) * $factor);

481 
$»s
 = '';

483 
$i
 = 0; $i < 4; ++$i) {

484 
$hex
 = 
$low_·¹
 % 0x100;

485 
$»s
 .ğ
	`·ck
('c', 
$hex
);

486 
$low_·¹
 /= 0x100;

488 
$i
 = 0; $i < 4; ++$i) {

489 
$hex
 = 
$high_·¹
 % 0x100;

490 
$»s
 .ğ
	`·ck
('c', 
$hex
);

491 
$high_·¹
 /= 0x100;

493  
$»s
;

494 
	}
}

504 
public
 
funùiÚ
 
	$OLE2LoÿlD©e
(
$¡ršg
)

506 ià(
	`¡¾’
(
$¡ršg
) != 8) {

507  
Ãw
 
	`PEAR_E¼Ü
("Expecting 8 byte string");

511 
$çùÜ
 = 
	`pow
(2, 32);

512 
	`li¡
(, 
$high_·¹
èğ
	`uÅack
('V', 
	`sub¡r
(
$¡ršg
, 4, 4));

513 
	`li¡
(, 
$low_·¹
èğ
	`uÅack
('V', 
	`sub¡r
(
$¡ršg
, 0, 4));

515 
$big_d©e
 = (
$high_·¹
 * 
$çùÜ
è+ 
$low_·¹
;

517 
$big_d©e
 /= 10000000;

520 
$days
 = 134774;

523 
$big_d©e
 -ğ
$days
 * 24 * 3600;

524  
	`æoÜ
(
$big_d©e
);

525 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLE/ChainedBlockStream.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_OLE_ChašedBlockSŒ—m


34 
public
 
	m$Şe
;

40 
public
 
	m$·¿ms
;

46 
public
 
	m$d©a
;

52 
public
 
	m$pos
;

65 
public
 
funùiÚ
 
	$¡»am_İ’
(
$·th
, 
$mode
, 
$İtiÚs
, &
$İ’edP©h
)

67 ià(
$mode
 != 'r') {

68 ià(
$İtiÚs
 & 
STREAM_REPORT_ERRORS
) {

69 
	`Œigg”_”rÜ
('OÆy„—dšg i suµÜ‹d', 
E_USER_WARNING
);

71  
çl£
;

75 
	`·r£_¡r
(
	`sub¡r
(
$·th
, 25), 
$this
->
·¿ms
);

76 ià(!
	`is£t
(
$this
->
·¿ms
['ŞeIn¡ªûId'], $this->·¿ms['blockId'], 
$GLOBALS
['_OLE_INSTANCES'][$this->params['oleInstanceId']])) {

77 ià(
$İtiÚs
 & 
STREAM_REPORT_ERRORS
) {

78 
	`Œigg”_”rÜ
('OLE sŒ—m‚Ù found', 
E_USER_WARNING
);

80  
çl£
;

82 
$this
->
Şe
 = 
$GLOBALS
['_OLE_INSTANCES'][$this->
·¿ms
['oleInstanceId']];

84 
$blockId
 = 
$this
->
·¿ms
['blockId'];

85 
$this
->
d©a
 = '';

86 ià(
	`is£t
(
$this
->
·¿ms
['size']è&& $this->·¿ms['size'] < $this->
Şe
->
bigBlockTh»shŞd
 && 
$blockId
 !ğ$this->Şe->
roÙ
->
_S¹Block
) {

88 
$roÙPos
 = 
$this
->
Şe
->
	`_g‘BlockOff£t
($this->Şe->
roÙ
->
_S¹Block
);

89 
$blockId
 != -2) {

90 
$pos
 = 
$roÙPos
 + 
$blockId
 * 
$this
->
Şe
->
bigBlockSize
;

91 
$blockId
 = 
$this
->
Şe
->
sb©
[$blockId];

92 
	`f£ek
(
$this
->
Şe
->
_fe_hªdË
, 
$pos
);

93 
$this
->
d©a
 .ğ
	`ä—d
($this->
Şe
->
_fe_hªdË
, $this->Şe->
bigBlockSize
);

97 
$blockId
 != -2) {

98 
$pos
 = 
$this
->
Şe
->
	`_g‘BlockOff£t
(
$blockId
);

99 
	`f£ek
(
$this
->
Şe
->
_fe_hªdË
, 
$pos
);

100 
$this
->
d©a
 .ğ
	`ä—d
($this->
Şe
->
_fe_hªdË
, $this->Şe->
bigBlockSize
);

101 
$blockId
 = 
$this
->
Şe
->
bb©
[$blockId];

104 ià(
	`is£t
(
$this
->
·¿ms
['size'])) {

105 
$this
->
d©a
 = 
	`sub¡r
($this->d©a, 0, $this->
·¿ms
['size']);

108 ià(
$İtiÚs
 & 
STREAM_USE_PATH
) {

109 
$İ’edP©h
 = 
$·th
;

112  
Œue
;

119 
public
 
funùiÚ
 
	$¡»am_şo£
()

121 
$this
->
Şe
 = 
nuÎ
;

122 
	`un£t
(
$GLOBALS
['_OLE_INSTANCES']);

123 
	}
}

131 
public
 
funùiÚ
 
	$¡»am_»ad
(
$couÁ
)

133 ià(
$this
->
	`¡»am_eof
()) {

134  
çl£
;

136 
$s
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos
, 
$couÁ
);

137 
$this
->
pos
 +ğ
$couÁ
;

138  
$s
;

139 
	}
}

146 
public
 
funùiÚ
 
	$¡»am_eof
()

148  
$this
->
pos
 >ğ
	`¡¾’
($this->
d©a
);

149 
	}
}

157 
public
 
funùiÚ
 
	$¡»am_‹Î
()

159  
$this
->
pos
;

160 
	}
}

169 
public
 
funùiÚ
 
	$¡»am_£ek
(
$off£t
, 
$wh’û
)

171 ià(
$wh’û
 =ğ
SEEK_SET
 && 
$off£t
 >= 0) {

172 
$this
->
pos
 = 
$off£t
;

173 } 
	`–£if
 (
$wh’û
 =ğ
SEEK_CUR
 && -
$off£t
 <ğ
$this
->
pos
) {

174 
$this
->
pos
 +ğ
$off£t
;

175 } 
	`–£if
 (
$wh’û
 =ğ
SEEK_END
 && -
$off£t
 <ğ(
$this
->
d©a
)) {

176 
$this
->
pos
 = 
	`¡¾’
($this->
d©a
è+ 
$off£t
;

178  
çl£
;

180  
Œue
;

181 
	}
}

188 
public
 
funùiÚ
 
	$¡»am_¡©
()

190  
	`¬¿y
(

191 'size' => 
	`¡¾’
(
$this
->
d©a
),

193 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLE/PPS.php

1 <?
php


30 şas 
	cPHPExûl_Sh¬ed_OLE_PPS


36 
public
 
	m$No
;

42 
public
 
	m$Name
;

48 
public
 
	m$Ty³
;

54 
public
 
	m$P»vPps
;

60 
public
 
	m$NextPps
;

66 
public
 
	m$DœPps
;

72 
public
 
	m$Time1¡
;

78 
public
 
	m$Time2nd
;

84 
public
 
	m$_S¹Block
;

90 
public
 
	m$Size
;

96 
public
 
	m$_d©a
;

102 
public
 
	m$chd»n
 = 
¬¿y
();

108 
public
 
	m$Şe
;

125 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$No
, 
$Çme
, 
$ty³
, 
$´ev
, 
$Ãxt
, 
$dœ
, 
$time_1¡
, 
$time_2nd
, 
$d©a
, 
$chd»n
)

127 
$this
->
No
 = 
$No
;

128 
$this
->
Name
 = 
$Çme
;

129 
$this
->
Ty³
 = 
$ty³
;

130 
$this
->
P»vPps
 = 
$´ev
;

131 
$this
->
NextPps
 = 
$Ãxt
;

132 
$this
->
DœPps
 = 
$dœ
;

133 
$this
->
Time1¡
 = 
$time_1¡
;

134 
$this
->
Time2nd
 = 
$time_2nd
;

135 
$this
->
_d©a
 = 
$d©a
;

136 
$this
->
chd»n
 = 
$chd»n
;

137 ià(
$d©a
 != '') {

138 
$this
->
Size
 = 
	`¡¾’
(
$d©a
);

140 
$this
->
Size
 = 0;

150 
public
 
funùiÚ
 
	$_D©aL’
()

152 ià(!
	`is£t
(
$this
->
_d©a
)) {

160  
	`¡¾’
(
$this
->
_d©a
);

162 
	}
}

170 
public
 
funùiÚ
 
	$_g‘PpsWk
()

172 
$»t
 = 
	`¡r_·d
(
$this
->
Name
, 64, "\x00");

174 
$»t
 .ğ
	`·ck
("v", 
	`¡¾’
(
$this
->
Name
) + 2)

175 . 
	`·ck
("c", 
$this
->
Ty³
)

176 . 
	`·ck
("c", 0x00)

177 . 
	`·ck
("V", 
$this
->
P»vPps
)

178 . 
	`·ck
("V", 
$this
->
NextPps
)

179 . 
	`·ck
("V", 
$this
->
DœPps
)

185 . 
PHPExûl_Sh¬ed_OLE
::
	`LoÿlD©e2OLE
(
$this
->
Time1¡
)

186 . 
PHPExûl_Sh¬ed_OLE
::
	`LoÿlD©e2OLE
(
$this
->
Time2nd
)

187 . 
	`·ck
("V", 
	`is£t
(
$this
->
_S¹Block
)?

188 
$this
->
_S¹Block
:0)

189 . 
	`·ck
("V", 
$this
->
Size
)

190 . 
	`·ck
("V", 0);

191  
$»t
;

192 
	}
}

203 
public
 
funùiÚ
 
	$_§vePpsS‘PÁ
(&
$¿Li¡
, 
$to_§ve
, 
$d•th
 = 0)

205 ià(!
	`is_¬¿y
(
$to_§ve
è|| (
	`em±y
($to_save))) {

207 } 
	`–£if
 (
	`couÁ
(
$to_§ve
) == 1) {

208 
$út
 = 
	`couÁ
(
$¿Li¡
);

210 
$¿Li¡
[
$út
] = ( 
$d•th
 =ğ0 ) ? 
$to_§ve
[0] : 
şÚe
 $to_save[0];

211 
$¿Li¡
[
$út
]->
No
 = $cnt;

212 
$¿Li¡
[
$út
]->
P»vPps
 = 0xFFFFFFFF;

213 
$¿Li¡
[
$út
]->
NextPps
 = 0xFFFFFFFF;

214 
$¿Li¡
[
$út
]->
DœPps
 = 
£lf
::
	`_§vePpsS‘PÁ
($¿Li¡, @$¿Li¡[$út]->
chd»n
, 
$d•th
++);

216 
$iPos
 = 
	`æoÜ
(
	`couÁ
(
$to_§ve
) / 2);

217 
$aP»v
 = 
	`¬¿y_¦iû
(
$to_§ve
, 0, 
$iPos
);

218 
$aNext
 = 
	`¬¿y_¦iû
(
$to_§ve
, 
$iPos
 + 1);

219 
$út
 = 
	`couÁ
(
$¿Li¡
);

221 
$¿Li¡
[
$út
] = ( 
$d•th
 =ğ0 ) ? 
$to_§ve
[
$iPos
] : 
şÚe
 $to_save[$iPos];

222 
$¿Li¡
[
$út
]->
No
 = $cnt;

223 
$¿Li¡
[
$út
]->
P»vPps
 = 
£lf
::
	`_§vePpsS‘PÁ
($¿Li¡, 
$aP»v
, 
$d•th
++);

224 
$¿Li¡
[
$út
]->
NextPps
 = 
£lf
::
	`_§vePpsS‘PÁ
($¿Li¡, 
$aNext
, 
$d•th
++);

225 
$¿Li¡
[
$út
]->
DœPps
 = 
£lf
::
	`_§vePpsS‘PÁ
($¿Li¡, @$¿Li¡[$út]->
chd»n
, 
$d•th
++);

228  
$út
;

229 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLE/PPS/File.php

1 <?
php


30 şas 
	cPHPExûl_Sh¬ed_OLE_PPS_Fe
 
ex‹nds
 
	mPHPExûl_Sh¬ed_OLE_PPS


39 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$Çme
)

41 
·»Á
::
	`__cÚ¡ruù
(
nuÎ
, 
$Çme
, 
PHPExûl_Sh¬ed_OLE
::
OLE_PPS_TYPE_FILE
,‚uÎ,‚uÎ,‚uÎ,‚uÎ,‚uÎ, '', 
	`¬¿y
());

50 
public
 
funùiÚ
 
	$š™
()

52  
Œue
;

53 
	}
}

61 
public
 
funùiÚ
 
	$­³nd
(
$d©a
)

63 
$this
->
_d©a
 .ğ
$d©a
;

64 
	}
}

70 
public
 
funùiÚ
 
	$g‘SŒ—m
()

72 
$this
->
Şe
->
	`g‘SŒ—m
($this);

73 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLE/PPS/Root.php

1 <?
php


30 şas 
	cPHPExûl_Sh¬ed_OLE_PPS_RoÙ
 
ex‹nds
 
	mPHPExûl_Sh¬ed_OLE_PPS


37 
´Ùeùed
 
	m$‹mpDœeùÜy
 = 
nuÎ
;

43 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$time_1¡
, 
$time_2nd
, 
$¿Chd
)

45 
$this
->
_‹mpDœ
 = 
PHPExûl_Sh¬ed_Fe
::
	`sys_g‘_‹mp_dœ
();

47 
·»Á
::
	`__cÚ¡ruù
(
nuÎ
, 
PHPExûl_Sh¬ed_OLE
::
	`Asc2Ucs
('RoÙ EÁry'), PHPExûl_Sh¬ed_OLE::
OLE_PPS_TYPE_ROOT
,‚uÎ,‚uÎ,‚uÎ, 
$time_1¡
, 
$time_2nd
,‚uÎ, 
$¿Chd
);

61 
public
 
funùiÚ
 
	$§ve
(
$f’ame
)

64 
$this
->
_BIG_BLOCK_SIZE
 = 
	`pow
(

66 (
	`is£t
(
$this
->
_BIG_BLOCK_SIZE
))? 
£lf
::
	`adju¡2
($this->_BIG_BLOCK_SIZE) : 9

68 
$this
->
_SMALL_BLOCK_SIZE
ğ
	`pow
(

70 (
	`is£t
(
$this
->
_SMALL_BLOCK_SIZE
))? 
£lf
::
	`adju¡2
($this->_SMALL_BLOCK_SIZE) : 6

73 ià(
	`is_»sourû
(
$f’ame
)) {

74 
$this
->
_FILEH_
 = 
$f’ame
;

75 } 
	`–£if
 (
$f’ame
 == '-' || $filename == '') {

76 ià(
$this
->
‹mpDœeùÜy
 ==ğ
nuÎ
) {

77 
$this
->
‹mpDœeùÜy
 = 
PHPExûl_Sh¬ed_Fe
::
	`sys_g‘_‹mp_dœ
();

79 
$this
->
_tmp_f’ame
 = 
	`‹m²am
($this->
‹mpDœeùÜy
, "OLE_PPS_Root");

80 
$this
->
_FILEH_
 = 
	`fİ’
($this->
_tmp_f’ame
, "w+b");

81 ià(
$this
->
_FILEH_
 =ğ
çl£
) {

82 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Can't createemporary file.");

85 
$this
->
_FILEH_
 = 
	`fİ’
(
$f’ame
, "wb");

87 ià(
$this
->
_FILEH_
 =ğ
çl£
) {

88 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Can't open $filename. It may be in use or…rotected.");

91 
$aLi¡
 = 
	`¬¿y
();

92 
PHPExûl_Sh¬ed_OLE_PPS
::
	`_§vePpsS‘PÁ
(
$aLi¡
, 
	`¬¿y
(
$this
));

94 
	`li¡
(
$iSBDút
, 
$iBBút
, 
$iPPSút
èğ
$this
->
	`_ÿlcSize
(
$aLi¡
);

96 
$this
->
	`_§veH—d”
(
$iSBDút
, 
$iBBút
, 
$iPPSút
);

99 
$this
->
_d©a
 = $this->
	`_makeSm®lD©a
(
$aLi¡
);

102 
$this
->
	`_§veBigD©a
(
$iSBDút
, 
$aLi¡
);

104 
$this
->
	`_§vePps
(
$aLi¡
);

106 
$this
->
	`_§veBbd
(
$iSBDút
, 
$iBBút
, 
$iPPSút
);

108 ià(!
	`is_»sourû
(
$f’ame
)) {

109 
	`fşo£
(
$this
->
_FILEH_
);

112  
Œue
;

113 
	}
}

122 
public
 
funùiÚ
 
	$_ÿlcSize
(&
$¿Li¡
)

125 
	`li¡
(
$iSBDút
, 
$iBBút
, 
$iPPSút
èğ
	`¬¿y
(0,0,0);

126 
$iSm®lL’
 = 0;

127 
$iSBút
 = 0;

128 
$iCouÁ
 = 
	`couÁ
(
$¿Li¡
);

129 
$i
 = 0; $˜< 
$iCouÁ
; ++$i) {

130 ià(
$¿Li¡
[
$i
]->
Ty³
 =ğ
PHPExûl_Sh¬ed_OLE
::
OLE_PPS_TYPE_FILE
) {

131 
$¿Li¡
[
$i
]->
Size
 = $¿Li¡[$i]->
	`_D©aL’
();

132 ià(
$¿Li¡
[
$i
]->
Size
 < 
PHPExûl_Sh¬ed_OLE
::
OLE_DATA_SIZE_SMALL
) {

133 
$iSBút
 +ğ
	`æoÜ
(
$¿Li¡
[
$i
]->
Size
 / 
$this
->
_SMALL_BLOCK_SIZE
)

134 + ((
$¿Li¡
[
$i
]->
Size
 % 
$this
->
_SMALL_BLOCK_SIZE
)? 1: 0);

136 
$iBBút
 +ğ(
	`æoÜ
(
$¿Li¡
[
$i
]->
Size
 / 
$this
->
_BIG_BLOCK_SIZE
) +

137 ((
$¿Li¡
[
$i
]->
Size
 % 
$this
->
_BIG_BLOCK_SIZE
)? 1: 0));

141 
$iSm®lL’
 = 
$iSBút
 * 
$this
->
_SMALL_BLOCK_SIZE
;

142 
$iSlCÁ
 = 
	`æoÜ
(
$this
->
_BIG_BLOCK_SIZE
 / 
PHPExûl_Sh¬ed_OLE
::
OLE_LONG_INT_SIZE
);

143 
$iSBDút
 = 
	`æoÜ
(
$iSBút
 / 
$iSlCÁ
) + (($iSBcnt % $iSlCnt)? 1:0);

144 
$iBBút
 +ğ(
	`æoÜ
(
$iSm®lL’
 / 
$this
->
_BIG_BLOCK_SIZE
) +

145 (Ğ
$iSm®lL’
 % 
$this
->
_BIG_BLOCK_SIZE
)? 1: 0));

146 
$iCÁ
 = 
	`couÁ
(
$¿Li¡
);

147 
$iBdCÁ
 = 
$this
->
_BIG_BLOCK_SIZE
 / 
PHPExûl_Sh¬ed_OLE
::
OLE_PPS_SIZE
;

148 
$iPPSút
 = (
	`æoÜ
(
$iCÁ
/
$iBdCÁ
) + (($iCnt % $iBdCnt)? 1: 0));

150  
	`¬¿y
(
$iSBDút
, 
$iBBút
, 
$iPPSút
);

151 
	}
}

161 
´iv©e
 
funùiÚ
 
	$adju¡2
(
$i2
)

163 
$iWk
 = 
	`log
(
$i2
)/log(2);

164  (
$iWk
 > 
	`æoÜ
($iWk))? floor($iWk)+1:$iWk;

165 
	}
}

175 
public
 
funùiÚ
 
	$_§veH—d”
(
$iSBDút
, 
$iBBút
, 
$iPPSút
)

177 
$FILE
 = 
$this
->
_FILEH_
;

180 
$iBlCÁ
 = 
$this
->
_BIG_BLOCK_SIZE
 / 
PHPExûl_Sh¬ed_OLE
::
OLE_LONG_INT_SIZE
;

181 
$i1¡BdL
 = (
$this
->
_BIG_BLOCK_SIZE
 - 0x4Cè/ 
PHPExûl_Sh¬ed_OLE
::
OLE_LONG_INT_SIZE
;

183 
$iBdExL
 = 0;

184 
$iAÎ
 = 
$iBBút
 + 
$iPPSút
 + 
$iSBDút
;

185 
$iAÎW
 = 
$iAÎ
;

186 
$iBdCÁW
 = 
	`æoÜ
(
$iAÎW
 / 
$iBlCÁ
) + (($iAllW % $iBlCnt)? 1: 0);

187 
$iBdCÁ
 = 
	`æoÜ
((
$iAÎ
 + 
$iBdCÁW
è/ 
$iBlCÁ
è+ (((
$iAÎW
+$iBdCntW) % $iBlCnt)? 1: 0);

190 ià(
$iBdCÁ
 > 
$i1¡BdL
) {

192 ++
$iBdExL
;

193 ++
$iAÎW
;

194 
$iBdCÁW
 = 
	`æoÜ
(
$iAÎW
 / 
$iBlCÁ
) + (($iAllW % $iBlCnt)? 1: 0);

195 
$iBdCÁ
 = 
	`æoÜ
((
$iAÎW
 + 
$iBdCÁW
è/ 
$iBlCÁ
) + ((($iAllW+$iBdCntW) % $iBlCnt)? 1: 0);

196 ià(
$iBdCÁ
 <ğ(
$iBdExL
*
$iBlCÁ
+ 
$i1¡BdL
)) {

203 
	`fwr™e
(

204 
$FILE
,

210 . 
	`·ck
("v", 0x3b)

211 . 
	`·ck
("v", 0x03)

212 . 
	`·ck
("v", -2)

213 . 
	`·ck
("v", 9)

214 . 
	`·ck
("v", 6)

215 . 
	`·ck
("v", 0)

218 . 
	`·ck
("V", 
$iBdCÁ
)

219 . 
	`·ck
("V", 
$iBBút
+
$iSBDút
)

220 . 
	`·ck
("V", 0)

221 . 
	`·ck
("V", 0x1000)

222 . 
	`·ck
("V", 
$iSBDút
 ? 0 : -2)

223 . 
	`·ck
("V", 
$iSBDút
)

226 ià(
$iBdCÁ
 < 
$i1¡BdL
) {

227 
	`fwr™e
(

228 
$FILE
,

229 
	`·ck
("V", -2)

230 . 
	`·ck
("V", 0)

233 
	`fwr™e
(
$FILE
, 
	`·ck
("V", 
$iAÎ
+
$iBdCÁ
è.…ack("V", 
$iBdExL
));

237 
$i
 = 0; $˜< 
$i1¡BdL
 && $˜< 
$iBdCÁ
; ++$i) {

238 
	`fwr™e
(
$FILE
, 
	`·ck
("V", 
$iAÎ
+
$i
));

240 ià(
$i
 < 
$i1¡BdL
) {

241 
$jB
 = 
$i1¡BdL
 - 
$i
;

242 
$j
 = 0; $j < 
$jB
; ++$j) {

243 
	`fwr™e
(
$FILE
, (
	`·ck
("V", -1)));

246 
	}
}

255 
public
 
funùiÚ
 
	$_§veBigD©a
(
$iStBlk
, &
$¿Li¡
)

257 
$FILE
 = 
$this
->
_FILEH_
;

260 
$iCouÁ
 = 
	`couÁ
(
$¿Li¡
);

261 
$i
 = 0; $˜< 
$iCouÁ
; ++$i) {

262 ià(
$¿Li¡
[
$i
]->
Ty³
 !ğ
PHPExûl_Sh¬ed_OLE
::
OLE_PPS_TYPE_DIR
) {

263 
$¿Li¡
[
$i
]->
Size
 = $¿Li¡[$i]->
	`_D©aL’
();

264 ià((
$¿Li¡
[
$i
]->
Size
 >ğ
PHPExûl_Sh¬ed_OLE
::
OLE_DATA_SIZE_SMALL
è|| (($¿Li¡[$i]->
Ty³
 =ğPHPExûl_Sh¬ed_OLE::
OLE_PPS_TYPE_ROOT
è&& 
	`is£t
($¿Li¡[$i]->
_d©a
))) {

274 
	`fwr™e
(
$FILE
, 
$¿Li¡
[
$i
]->
_d©a
);

277 ià(
$¿Li¡
[
$i
]->
Size
 % 
$this
->
_BIG_BLOCK_SIZE
) {

278 
	`fwr™e
(
$FILE
, 
	`¡r_»³©
("\x00", 
$this
->
_BIG_BLOCK_SIZE
 - (
$¿Li¡
[
$i
]->
Size
 % $this->_BIG_BLOCK_SIZE)));

281 
$¿Li¡
[
$i
]->
_S¹Block
 = 
$iStBlk
;

282 
$iStBlk
 +=

283 (
	`æoÜ
(
$¿Li¡
[
$i
]->
Size
 / 
$this
->
_BIG_BLOCK_SIZE
) +

284 ((
$¿Li¡
[
$i
]->
Size
 % 
$this
->
_BIG_BLOCK_SIZE
)? 1: 0));

294 
	}
}

302 
public
 
funùiÚ
 
	$_makeSm®lD©a
(&
$¿Li¡
)

304 
$sRes
 = '';

305 
$FILE
 = 
$this
->
_FILEH_
;

306 
$iSmBlk
 = 0;

308 
$iCouÁ
 = 
	`couÁ
(
$¿Li¡
);

309 
$i
 = 0; $˜< 
$iCouÁ
; ++$i) {

311 ià(
$¿Li¡
[
$i
]->
Ty³
 =ğ
PHPExûl_Sh¬ed_OLE
::
OLE_PPS_TYPE_FILE
) {

312 ià(
$¿Li¡
[
$i
]->
Size
 <= 0) {

315 ià(
$¿Li¡
[
$i
]->
Size
 < 
PHPExûl_Sh¬ed_OLE
::
OLE_DATA_SIZE_SMALL
) {

316 
$iSmbCÁ
 = 
	`æoÜ
(
$¿Li¡
[
$i
]->
Size
 / 
$this
->
_SMALL_BLOCK_SIZE
)

317 + ((
$¿Li¡
[
$i
]->
Size
 % 
$this
->
_SMALL_BLOCK_SIZE
)? 1: 0);

319 
$jB
 = 
$iSmbCÁ
 - 1;

320 
$j
 = 0; $j < 
$jB
; ++$j) {

321 
	`fwr™e
(
$FILE
, 
	`·ck
("V", 
$j
+
$iSmBlk
+1));

323 
	`fwr™e
(
$FILE
, 
	`·ck
("V", -2));

332 
$sRes
 .ğ
$¿Li¡
[
$i
]->
_d©a
;

334 ià(
$¿Li¡
[
$i
]->
Size
 % 
$this
->
_SMALL_BLOCK_SIZE
) {

335 
$sRes
 .ğ
	`¡r_»³©
("\x00", 
$this
->
_SMALL_BLOCK_SIZE
 - (
$¿Li¡
[
$i
]->
Size
 % $this->_SMALL_BLOCK_SIZE));

338 
$¿Li¡
[
$i
]->
_S¹Block
 = 
$iSmBlk
;

339 
$iSmBlk
 +ğ
$iSmbCÁ
;

343 
$iSbCÁ
 = 
	`æoÜ
(
$this
->
_BIG_BLOCK_SIZE
 / 
PHPExûl_Sh¬ed_OLE
::
OLE_LONG_INT_SIZE
);

344 ià(
$iSmBlk
 % 
$iSbCÁ
) {

345 
$iB
 = 
$iSbCÁ
 - (
$iSmBlk
 % $iSbCnt);

346 
$i
 = 0; $˜< 
$iB
; ++$i) {

347 
	`fwr™e
(
$FILE
, 
	`·ck
("V", -1));

350  
$sRes
;

351 
	}
}

359 
public
 
funùiÚ
 
	$_§vePps
(&
$¿Li¡
)

362 
$iC
 = 
	`couÁ
(
$¿Li¡
);

363 
$i
 = 0; $˜< 
$iC
; ++$i) {

364 
	`fwr™e
(
$this
->
_FILEH_
, 
$¿Li¡
[
$i
]->
	`_g‘PpsWk
());

367 
$iCÁ
 = 
	`couÁ
(
$¿Li¡
);

368 
$iBCÁ
 = 
$this
->
_BIG_BLOCK_SIZE
 / 
PHPExûl_Sh¬ed_OLE
::
OLE_PPS_SIZE
;

369 ià(
$iCÁ
 % 
$iBCÁ
) {

370 
	`fwr™e
(
$this
->
_FILEH_
, 
	`¡r_»³©
("\x00", (
$iBCÁ
 - (
$iCÁ
 % $iBCÁ)è* 
PHPExûl_Sh¬ed_OLE
::
OLE_PPS_SIZE
));

372 
	}
}

382 
public
 
funùiÚ
 
	$_§veBbd
(
$iSbdSize
, 
$iBsize
, 
$iPpsCÁ
)

384 
$FILE
 = 
$this
->
_FILEH_
;

386 
$iBbCÁ
 = 
$this
->
_BIG_BLOCK_SIZE
 / 
PHPExûl_Sh¬ed_OLE
::
OLE_LONG_INT_SIZE
;

387 
$i1¡BdL
 = (
$this
->
_BIG_BLOCK_SIZE
 - 0x4Cè/ 
PHPExûl_Sh¬ed_OLE
::
OLE_LONG_INT_SIZE
;

389 
$iBdExL
 = 0;

390 
$iAÎ
 = 
$iBsize
 + 
$iPpsCÁ
 + 
$iSbdSize
;

391 
$iAÎW
 = 
$iAÎ
;

392 
$iBdCÁW
 = 
	`æoÜ
(
$iAÎW
 / 
$iBbCÁ
) + (($iAllW % $iBbCnt)? 1: 0);

393 
$iBdCÁ
 = 
	`æoÜ
((
$iAÎ
 + 
$iBdCÁW
è/ 
$iBbCÁ
è+ (((
$iAÎW
+$iBdCntW) % $iBbCnt)? 1: 0);

395 ià(
$iBdCÁ
 >
$i1¡BdL
) {

397 ++
$iBdExL
;

398 ++
$iAÎW
;

399 
$iBdCÁW
 = 
	`æoÜ
(
$iAÎW
 / 
$iBbCÁ
) + (($iAllW % $iBbCnt)? 1: 0);

400 
$iBdCÁ
 = 
	`æoÜ
((
$iAÎW
 + 
$iBdCÁW
è/ 
$iBbCÁ
) + ((($iAllW+$iBdCntW) % $iBbCnt)? 1: 0);

401 ià(
$iBdCÁ
 <ğ(
$iBdExL
*
$iBbCÁ
+ 
$i1¡BdL
)) {

409 ià(
$iSbdSize
 > 0) {

410 
$i
 = 0; $˜< (
$iSbdSize
 - 1); ++$i) {

411 
	`fwr™e
(
$FILE
, 
	`·ck
("V", 
$i
+1));

413 
	`fwr™e
(
$FILE
, 
	`·ck
("V", -2));

416 
$i
 = 0; $˜< (
$iBsize
 - 1); ++$i) {

417 
	`fwr™e
(
$FILE
, 
	`·ck
("V", 
$i
+
$iSbdSize
+1));

419 
	`fwr™e
(
$FILE
, 
	`·ck
("V", -2));

422 
$i
 = 0; $˜< (
$iPpsCÁ
 - 1); ++$i) {

423 
	`fwr™e
(
$FILE
, 
	`·ck
("V", 
$i
+
$iSbdSize
+
$iBsize
+1));

425 
	`fwr™e
(
$FILE
, 
	`·ck
("V", -2));

427 
$i
 = 0; $˜< 
$iBdCÁ
; ++$i) {

428 
	`fwr™e
(
$FILE
, 
	`·ck
("V", 0xFFFFFFFD));

431 
$i
 = 0; $˜< 
$iBdExL
; ++$i) {

432 
	`fwr™e
(
$FILE
, 
	`·ck
("V", 0xFFFFFFFC));

435 ià((
$iAÎW
 + 
$iBdCÁ
è% 
$iBbCÁ
) {

436 
$iBlock
 = (
$iBbCÁ
 - ((
$iAÎW
 + 
$iBdCÁ
) % $iBbCnt));

437 
$i
 = 0; $˜< 
$iBlock
; ++$i) {

438 
	`fwr™e
(
$FILE
, 
	`·ck
("V", -1));

442 ià(
$iBdCÁ
 > 
$i1¡BdL
) {

443 
$iN
=0;

444 
$iNb
=0;

445 
$i
 = 
$i1¡BdL
; $˜< 
$iBdCÁ
; $i++, ++
$iN
) {

446 ià(
$iN
 >ğ(
$iBbCÁ
 - 1)) {

447 
$iN
 = 0;

448 ++
$iNb
;

449 
	`fwr™e
(
$FILE
, 
	`·ck
("V", 
$iAÎ
+
$iBdCÁ
+
$iNb
));

451 
	`fwr™e
(
$FILE
, 
	`·ck
("V", 
$iBsize
+
$iSbdSize
+
$iPpsCÁ
+
$i
));

453 ià((
$iBdCÁ
-
$i1¡BdL
è% (
$iBbCÁ
-1)) {

454 
$iB
 = (
$iBbCÁ
 - 1è- ((
$iBdCÁ
 - 
$i1¡BdL
) % ($iBbCnt - 1));

455 
$i
 = 0; $˜< 
$iB
; ++$i) {

456 
	`fwr™e
(
$FILE
, 
	`·ck
("V", -1));

459 
	`fwr™e
(
$FILE
, 
	`·ck
("V", -2));

461 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLERead.php

1 <?
php


28 
defšed
('IDENTIFIER_OLE') ||

29 
defše
('IDENTIFIER_OLE', 
·ck
('CCCCCCCC', 0xd0, 0xcf, 0x11, 0xe0, 0xa1, 0xb1, 0x1a, 0xe1));

31 şas 
	cPHPExûl_Sh¬ed_OLER—d


33 
´iv©e
 
	m$d©a
 = '';

36 cÚ¡ 
	mIDENTIFIER_OLE
 = 
IDENTIFIER_OLE
;

39 cÚ¡ 
	mBIG_BLOCK_SIZE
 = 0x200;

42 cÚ¡ 
	mSMALL_BLOCK_SIZE
 = 0x40;

45 cÚ¡ 
	mPROPERTY_STORAGE_BLOCK_SIZE
 = 0x80;

48 cÚ¡ 
	mSMALL_BLOCK_THRESHOLD
 = 0x1000;

51 cÚ¡ 
	mNUM_BIG_BLOCK_DEPOT_BLOCKS_POS
 = 0x2c;

52 cÚ¡ 
	mROOT_START_BLOCK_POS
 = 0x30;

53 cÚ¡ 
	mSMALL_BLOCK_DEPOT_BLOCK_POS
 = 0x3c;

54 cÚ¡ 
	mEXTENSION_BLOCK_POS
 = 0x44;

55 cÚ¡ 
	mNUM_EXTENSION_BLOCK_POS
 = 0x48;

56 cÚ¡ 
	mBIG_BLOCK_DEPOT_BLOCKS_POS
 = 0x4c;

59 cÚ¡ 
	mSIZE_OF_NAME_POS
 = 0x40;

60 cÚ¡ 
	mTYPE_POS
 = 0x42;

61 cÚ¡ 
	mSTART_BLOCK_POS
 = 0x74;

62 cÚ¡ 
	mSIZE_POS
 = 0x78;

66 
public
 
	m$wrkbook
 = 
nuÎ
;

67 
public
 
	m$summ¬yInfÜm©iÚ
 = 
nuÎ
;

68 
public
 
	m$docum’tSumm¬yInfÜm©iÚ
 = 
nuÎ
;

77 
public
 
funùiÚ
 
	$»ad
(
$sFeName
)

80 ià(!
	`is_»adabË
(
$sFeName
)) {

81 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
("Could‚Ù o³À" . 
$sFeName
 . " for„eading! File does‚otƒxist, or it is‚ot„eadable.");

86 
$this
->
d©a
 = 
	`fe_g‘_cÚ‹Ás
(
$sFeName
, 
çl£
, 
nuÎ
, 0, 8);

89 ià(
$this
->
d©a
 !ğ
£lf
::
IDENTIFIER_OLE
) {

90 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Thf’am' . 
$sFeName
 . ' is‚ot„ecognised‡s‡n OLE file');

94 
$this
->
d©a
 = 
	`fe_g‘_cÚ‹Ás
(
$sFeName
);

97 
$this
->
numBigBlockD•ÙBlocks
 = 
£lf
::
	`g‘IÁ4d
($this->
d©a
, s–f::
NUM_BIG_BLOCK_DEPOT_BLOCKS_POS
);

100 
$this
->
roÙS¹Block
 = 
£lf
::
	`g‘IÁ4d
($this->
d©a
, s–f::
ROOT_START_BLOCK_POS
);

103 
$this
->
sbdS¹Block
 = 
£lf
::
	`g‘IÁ4d
($this->
d©a
, s–f::
SMALL_BLOCK_DEPOT_BLOCK_POS
);

106 
$this
->
ex‹nsiÚBlock
 = 
£lf
::
	`g‘IÁ4d
($this->
d©a
, s–f::
EXTENSION_BLOCK_POS
);

109 
$this
->
numEx‹nsiÚBlocks
 = 
£lf
::
	`g‘IÁ4d
($this->
d©a
, s–f::
NUM_EXTENSION_BLOCK_POS
);

111 
$bigBlockD•ÙBlocks
 = 
	`¬¿y
();

112 
$pos
 = 
£lf
::
BIG_BLOCK_DEPOT_BLOCKS_POS
;

114 
$bbdBlocks
 = 
$this
->
numBigBlockD•ÙBlocks
;

116 ià(
$this
->
numEx‹nsiÚBlocks
 != 0) {

117 
$bbdBlocks
 = (
£lf
::
BIG_BLOCK_SIZE
 - s–f::
BIG_BLOCK_DEPOT_BLOCKS_POS
)/4;

120 
$i
 = 0; $˜< 
$bbdBlocks
; ++$i) {

121 
$bigBlockD•ÙBlocks
[
$i
] = 
£lf
::
	`g‘IÁ4d
(
$this
->
d©a
, 
$pos
);

122 
$pos
 += 4;

125 
$j
 = 0; $j < 
$this
->
numEx‹nsiÚBlocks
; ++$j) {

126 
$pos
 = (
$this
->
ex‹nsiÚBlock
 + 1è* 
£lf
::
BIG_BLOCK_SIZE
;

127 
$blocksToR—d
 = 
	`mš
(
$this
->
numBigBlockD•ÙBlocks
 - 
$bbdBlocks
, 
£lf
::
BIG_BLOCK_SIZE
 / 4 - 1);

129 
$i
 = 
$bbdBlocks
; $˜< $bbdBlock + 
$blocksToR—d
; ++$i) {

130 
$bigBlockD•ÙBlocks
[
$i
] = 
£lf
::
	`g‘IÁ4d
(
$this
->
d©a
, 
$pos
);

131 
$pos
 += 4;

134 
$bbdBlocks
 +ğ
$blocksToR—d
;

135 ià(
$bbdBlocks
 < 
$this
->
numBigBlockD•ÙBlocks
) {

136 
$this
->
ex‹nsiÚBlock
 = 
£lf
::
	`g‘IÁ4d
($this->
d©a
, 
$pos
);

140 
$pos
 = 0;

141 
$this
->
bigBlockChaš
 = '';

142 
$bbs
 = 
£lf
::
BIG_BLOCK_SIZE
 / 4;

143 
$i
 = 0; $˜< 
$this
->
numBigBlockD•ÙBlocks
; ++$i) {

144 
$pos
 = (
$bigBlockD•ÙBlocks
[
$i
] + 1è* 
£lf
::
BIG_BLOCK_SIZE
;

146 
$this
->
bigBlockChaš
 .ğ
	`sub¡r
($this->
d©a
, 
$pos
, 4*
$bbs
);

147 
$pos
 +ğ4*
$bbs
;

150 
$pos
 = 0;

151 
$sbdBlock
 = 
$this
->
sbdS¹Block
;

152 
$this
->
sm®lBlockChaš
 = '';

153 
$sbdBlock
 != -2) {

154 
$pos
 = (
$sbdBlock
 + 1è* 
£lf
::
BIG_BLOCK_SIZE
;

156 
$this
->
sm®lBlockChaš
 .ğ
	`sub¡r
($this->
d©a
, 
$pos
, 4*
$bbs
);

157 
$pos
 +ğ4*
$bbs
;

159 
$sbdBlock
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
bigBlockChaš
, $sbdBlock*4);

163 
$block
 = 
$this
->
roÙS¹Block
;

164 
$this
->
’Œy
 = $this->
	`_»adD©a
(
$block
);

166 
$this
->
	`»adPrİ”tyS‘s
();

174 
public
 
funùiÚ
 
	$g‘SŒ—m
(
$¡»am
)

176 ià(
$¡»am
 ==ğ
nuÎ
) {

177  
nuÎ
;

180 
$¡»amD©a
 = '';

182 ià(
$this
->
´İs
[
$¡»am
]['size'] < 
£lf
::
SMALL_BLOCK_THRESHOLD
) {

183 
$roÙd©a
 = 
$this
->
	`_»adD©a
($this->
´İs
[$this->
roÙ’Œy
]['startBlock']);

185 
$block
 = 
$this
->
´İs
[
$¡»am
]['startBlock'];

187 
$block
 != -2) {

188 
$pos
 = 
$block
 * 
£lf
::
SMALL_BLOCK_SIZE
;

189 
$¡»amD©a
 .ğ
	`sub¡r
(
$roÙd©a
, 
$pos
, 
£lf
::
SMALL_BLOCK_SIZE
);

191 
$block
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
sm®lBlockChaš
, $block*4);

194  
$¡»amD©a
;

196 
$numBlocks
 = 
$this
->
´İs
[
$¡»am
]['size'] / 
£lf
::
BIG_BLOCK_SIZE
;

197 ià(
$this
->
´İs
[
$¡»am
]['size'] % 
£lf
::
BIG_BLOCK_SIZE
 != 0) {

198 ++
$numBlocks
;

201 ià(
$numBlocks
 == 0) {

205 
$block
 = 
$this
->
´İs
[
$¡»am
]['startBlock'];

207 
$block
 != -2) {

208 
$pos
 = (
$block
 + 1è* 
£lf
::
BIG_BLOCK_SIZE
;

209 
$¡»amD©a
 .ğ
	`sub¡r
(
$this
->
d©a
, 
$pos
, 
£lf
::
BIG_BLOCK_SIZE
);

210 
$block
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
bigBlockChaš
, $block*4);

213  
$¡»amD©a
;

215 
	}
}

223 
´iv©e
 
funùiÚ
 
	$_»adD©a
(
$bl
)

225 
$block
 = 
$bl
;

226 
$d©a
 = '';

228 
$block
 != -2) {

229 
$pos
 = (
$block
 + 1è* 
£lf
::
BIG_BLOCK_SIZE
;

230 
$d©a
 .ğ
	`sub¡r
(
$this
->
d©a
, 
$pos
, 
£lf
::
BIG_BLOCK_SIZE
);

231 
$block
 = 
£lf
::
	`g‘IÁ4d
(
$this
->
bigBlockChaš
, $block*4);

233  
$d©a
;

234 
	}
}

239 
´iv©e
 
funùiÚ
 
	$»adPrİ”tyS‘s
()

241 
$off£t
 = 0;

244 
$’ŒyL’
 = 
	`¡¾’
(
$this
->
’Œy
);

245 
$off£t
 < 
$’ŒyL’
) {

247 
$d
 = 
	`sub¡r
(
$this
->
’Œy
, 
$off£t
, 
£lf
::
PROPERTY_STORAGE_BLOCK_SIZE
);

250 
$ÇmeSize
 = 
	`Üd
(
$d
[
£lf
::
SIZE_OF_NAME_POS
]) | (ord($d[self::SIZE_OF_NAME_POS+1]) << 8);

253 
$ty³
 = 
	`Üd
(
$d
[
£lf
::
TYPE_POS
]);

257 
$¡¬tBlock
 = 
£lf
::
	`g‘IÁ4d
(
$d
, s–f::
START_BLOCK_POS
);

259 
$size
 = 
£lf
::
	`g‘IÁ4d
(
$d
, s–f::
SIZE_POS
);

261 
$Çme
 = 
	`¡r_»¶aû
("\x00", "", 
	`sub¡r
(
$d
, 0, 
$ÇmeSize
));

263 
$this
->
´İs
[] = 
	`¬¿y
(

264 'Çme' => 
$Çme
,

265 'ty³' => 
$ty³
,

266 '¡¬tBlock' => 
$¡¬tBlock
,

267 'size' => 
$size


271 
$upName
 = 
	`¡¹ouµ”
(
$Çme
);

274 ià((
$upName
 === 'WORKBOOK') || ($upName === 'BOOK')) {

275 
$this
->
wrkbook
 = 
	`couÁ
($this->
´İs
) - 1;

276 } 
	`–£if
 (
$upName
 === 'ROOT ENTRY' || $upName === 'R') {

278 
$this
->
roÙ’Œy
 = 
	`couÁ
($this->
´İs
) - 1;

282 ià(
$Çme
 =ğ
	`chr
(5) . 'SummaryInformation') {

284 
$this
->
summ¬yInfÜm©iÚ
 = 
	`couÁ
($this->
´İs
) - 1;

288 ià(
$Çme
 =ğ
	`chr
(5) . 'DocumentSummaryInformation') {

290 
$this
->
docum’tSumm¬yInfÜm©iÚ
 = 
	`couÁ
($this->
´İs
) - 1;

293 
$off£t
 +ğ
£lf
::
PROPERTY_STORAGE_BLOCK_SIZE
;

295 
	}
}

304 
´iv©e
 
funùiÚ
 
	$g‘IÁ4d
(
$d©a
, 
$pos
)

309 
$_Ü_24
 = 
	`Üd
(
$d©a
[
$pos
 + 3]);

310 ià(
$_Ü_24
 >= 128) {

312 
$_Üd_24
 = -
	`abs
((256 - 
$_Ü_24
) << 24);

314 
$_Üd_24
 = (
$_Ü_24
 & 127) << 24;

316  
	`Üd
(
$d©a
[
$pos
]è| (Üd($d©a[$po + 1]è<< 8è| (Üd($d©a[$po + 2]è<< 16è| 
$_Üd_24
;

317 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/PCLZip/pclzip.lib.php

1 <?
php


29 ià(!
defšed
('PCLZIP_READ_BLOCK_SIZE')) {

30 
defše
('PCLZIP_READ_BLOCK_SIZE', 2048);

43 ià(!
defšed
('PCLZIP_SEPARATOR')) {

44 
defše
('PCLZIP_SEPARATOR', ',');

52 ià(!
defšed
('PCLZIP_ERROR_EXTERNAL')) {

53 
defše
('PCLZIP_ERROR_EXTERNAL', 0);

65 ià(!
defšed
('PCLZIP_TEMPORARY_DIR')) {

66 
defše
('PCLZIP_TEMPORARY_DIR', '');

77 ià(!
defšed
('PCLZIP_TEMPORARY_FILE_RATIO')) {

78 
defše
('PCLZIP_TEMPORARY_FILE_RATIO', 0.47);

86 
	g$g_pşz_v”siÚ
 = "2.8.2";

103 
defše
('PCLZIP_ERR_USER_ABORTED', 2);

104 
defše
('PCLZIP_ERR_NO_ERROR', 0);

105 
defše
('PCLZIP_ERR_WRITE_OPEN_FAIL', -1);

106 
defše
('PCLZIP_ERR_READ_OPEN_FAIL', -2);

107 
defše
('PCLZIP_ERR_INVALID_PARAMETER', -3);

108 
defše
('PCLZIP_ERR_MISSING_FILE', -4);

109 
defše
('PCLZIP_ERR_FILENAME_TOO_LONG', -5);

110 
defše
('PCLZIP_ERR_INVALID_ZIP', -6);

111 
defše
('PCLZIP_ERR_BAD_EXTRACTED_FILE', -7);

112 
defše
('PCLZIP_ERR_DIR_CREATE_FAIL', -8);

113 
defše
('PCLZIP_ERR_BAD_EXTENSION', -9);

114 
defše
('PCLZIP_ERR_BAD_FORMAT', -10);

115 
defše
('PCLZIP_ERR_DELETE_FILE_FAIL', -11);

116 
defše
('PCLZIP_ERR_RENAME_FILE_FAIL', -12);

117 
defše
('PCLZIP_ERR_BAD_CHECKSUM', -13);

118 
defše
('PCLZIP_ERR_INVALID_ARCHIVE_ZIP', -14);

119 
defše
('PCLZIP_ERR_MISSING_OPTION_VALUE', -15);

120 
defše
('PCLZIP_ERR_INVALID_OPTION_VALUE', -16);

121 
defše
('PCLZIP_ERR_ALREADY_A_DIRECTORY', -17);

122 
defše
('PCLZIP_ERR_UNSUPPORTED_COMPRESSION', -18);

123 
defše
('PCLZIP_ERR_UNSUPPORTED_ENCRYPTION', -19);

124 
defše
('PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE', -20);

125 
defše
('PCLZIP_ERR_DIRECTORY_RESTRICTION', -21);

128 
defše
('PCLZIP_OPT_PATH', 77001);

129 
defše
('PCLZIP_OPT_ADD_PATH', 77002);

130 
defše
('PCLZIP_OPT_REMOVE_PATH', 77003);

131 
defše
('PCLZIP_OPT_REMOVE_ALL_PATH', 77004);

132 
defše
('PCLZIP_OPT_SET_CHMOD', 77005);

133 
defše
('PCLZIP_OPT_EXTRACT_AS_STRING', 77006);

134 
defše
('PCLZIP_OPT_NO_COMPRESSION', 77007);

135 
defše
('PCLZIP_OPT_BY_NAME', 77008);

136 
defše
('PCLZIP_OPT_BY_INDEX', 77009);

137 
defše
('PCLZIP_OPT_BY_EREG', 77010);

138 
defše
('PCLZIP_OPT_BY_PREG', 77011);

139 
defše
('PCLZIP_OPT_COMMENT', 77012);

140 
defše
('PCLZIP_OPT_ADD_COMMENT', 77013);

141 
defše
('PCLZIP_OPT_PREPEND_COMMENT', 77014);

142 
defše
('PCLZIP_OPT_EXTRACT_IN_OUTPUT', 77015);

143 
defše
('PCLZIP_OPT_REPLACE_NEWER', 77016);

144 
defše
('PCLZIP_OPT_STOP_ON_ERROR', 77017);

148 
defše
('PCLZIP_OPT_EXTRACT_DIR_RESTRICTION', 77019);

149 
defše
('PCLZIP_OPT_TEMP_FILE_THRESHOLD', 77020);

150 
defše
('PCLZIP_OPT_ADD_TEMP_FILE_THRESHOLD', 77020);

151 
defše
('PCLZIP_OPT_TEMP_FILE_ON', 77021);

152 
defše
('PCLZIP_OPT_ADD_TEMP_FILE_ON', 77021);

153 
defše
('PCLZIP_OPT_TEMP_FILE_OFF', 77022);

154 
defše
('PCLZIP_OPT_ADD_TEMP_FILE_OFF', 77022);

157 
defše
('PCLZIP_ATT_FILE_NAME', 79001);

158 
defše
('PCLZIP_ATT_FILE_NEW_SHORT_NAME', 79002);

159 
defše
('PCLZIP_ATT_FILE_NEW_FULL_NAME', 79003);

160 
defše
('PCLZIP_ATT_FILE_MTIME', 79004);

161 
defše
('PCLZIP_ATT_FILE_CONTENT', 79005);

162 
defše
('PCLZIP_ATT_FILE_COMMENT', 79006);

165 
defše
('PCLZIP_CB_PRE_EXTRACT', 78001);

166 
defše
('PCLZIP_CB_POST_EXTRACT', 78002);

167 
defše
('PCLZIP_CB_PRE_ADD', 78003);

168 
defše
('PCLZIP_CB_POST_ADD', 78004);

190 şas 
	cPşZ


193 
public
 
	m$zÇme
 = '';

196 
public
 
	m$z_fd
 = 0;

199 
public
 
	m$”rÜ_code
 = 1;

200 
public
 
	m$”rÜ_¡ršg
 = '';

205 
public
 
	m$magic_quÙes_¡©us
;

215 
public
 
funùiÚ
 
	$PşZ
(
$p_zÇme
)

219 ià(!
	`funùiÚ_exi¡s
('gzopen')) {

220 
	`d›
('AbÜˆ'.
	`ba£Çme
(
__FILE__
).' : Missing zlibƒxtensions');

224 
$this
->
zÇme
 = 
$p_zÇme
;

225 
$this
->
z_fd
 = 0;

226 
$this
->
magic_quÙes_¡©us
 = -1;

270 
public
 
funùiÚ
 
	$ü—‹
(
$p_f–i¡
)

272 
$v_»suÉ
=1;

275 
$this
->
	`´ivE¼ÜRe£t
();

278 
$v_İtiÚs
 = 
	`¬¿y
();

279 
$v_İtiÚs
[
PCLZIP_OPT_NO_COMPRESSION
] = 
çl£
;

282 
$v_size
 = 
	`func_num_¬gs
();

285 ià(
$v_size
 > 1) {

287 
$v_¬g_li¡
 = 
	`func_g‘_¬gs
();

290 
	`¬¿y_shiá
(
$v_¬g_li¡
);

291 
$v_size
--;

294 ià((
	`is_š‹g”
(
$v_¬g_li¡
[0])) && ($v_arg_list[0] > 77000)) {

296 
$v_»suÉ
 = 
$this
->
	`´ivP¬£O±iÚs
(
$v_¬g_li¡
, 
$v_size
, 
$v_İtiÚs
, 
	`¬¿y
 (

297 
PCLZIP_OPT_REMOVE_PATH
 => 'optional',

298 
PCLZIP_OPT_REMOVE_ALL_PATH
 => 'optional',

299 
PCLZIP_OPT_ADD_PATH
 => 'optional',

300 
PCLZIP_CB_PRE_ADD
 => 'optional',

301 
PCLZIP_CB_POST_ADD
 => 'optional',

302 
PCLZIP_OPT_NO_COMPRESSION
 => 'optional',

303 
PCLZIP_OPT_COMMENT
 => 'optional',

304 
PCLZIP_OPT_TEMP_FILE_THRESHOLD
 => 'optional',

305 
PCLZIP_OPT_TEMP_FILE_ON
 => 'optional',

306 
PCLZIP_OPT_TEMP_FILE_OFF
 => 'optional'

309 ià(
$v_»suÉ
 != 1) {

317 
$v_İtiÚs
[
PCLZIP_OPT_ADD_PATH
] = 
$v_¬g_li¡
[0];

320 ià(
$v_size
 == 2) {

321 
$v_İtiÚs
[
PCLZIP_OPT_REMOVE_PATH
] = 
$v_¬g_li¡
[1];

322 } 
	`–£if
 (
$v_size
 > 2) {

323 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Invalid‚umber /ype of‡rguments");

330 
$this
->
	`´ivO±iÚDeçuÉTh»shŞd
(
$v_İtiÚs
);

333 
$v_¡ršg_li¡
 = 
	`¬¿y
();

334 
$v_©t_li¡
 = 
	`¬¿y
();

335 
$v_fedesü_li¡
 = 
	`¬¿y
();

336 
$p_»suÉ_li¡
 = 
	`¬¿y
();

339 ià(
	`is_¬¿y
(
$p_f–i¡
)) {

342 ià(
	`is£t
(
$p_f–i¡
[0]è&& 
	`is_¬¿y
($p_filelist[0])) {

343 
$v_©t_li¡
 = 
$p_f–i¡
;

346 
$v_¡ršg_li¡
 = 
$p_f–i¡
;

348 } 
	`–£if
 (
	`is_¡ršg
(
$p_f–i¡
)) {

351 
$v_¡ršg_li¡
 = 
	`ex¶ode
(
PCLZIP_SEPARATOR
, 
$p_f–i¡
);

354 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Invalid variableype…_filelist");

359 ià((
$v_¡ršg_li¡
) != 0) {

360 
	`fÜ—ch
 (
$v_¡ršg_li¡
 
as
 
$v_¡ršg
) {

361 ià(
$v_¡ršg
 != '') {

362 
$v_©t_li¡
[][
PCLZIP_ATT_FILE_NAME
] = 
$v_¡ršg
;

369 
$v_suµÜ‹d_©Œibu‹s
 = 
	`¬¿y
(

370 
PCLZIP_ATT_FILE_NAME
 => 'mandatory',

371 
PCLZIP_ATT_FILE_NEW_SHORT_NAME
 => 'optional',

372 
PCLZIP_ATT_FILE_NEW_FULL_NAME
 => 'optional',

373 
PCLZIP_ATT_FILE_MTIME
 => 'optional',

374 
PCLZIP_ATT_FILE_CONTENT
 => 'optional',

375 
PCLZIP_ATT_FILE_COMMENT
 => 'optional'

377 
	`fÜ—ch
 (
$v_©t_li¡
 
as
 
$v_’Œy
) {

378 
$v_»suÉ
 = 
$this
->
	`´ivFeDesüP¬£A‰
(
$v_’Œy
, 
$v_fedesü_li¡
[], 
$v_İtiÚs
, 
$v_suµÜ‹d_©Œibu‹s
);

379 ià(
$v_»suÉ
 != 1) {

385 
$v_»suÉ
 = 
$this
->
	`´ivFeDesüEx·nd
(
$v_fedesü_li¡
, 
$v_İtiÚs
);

386 ià(
$v_»suÉ
 != 1) {

391 
$v_»suÉ
 = 
$this
->
	`´ivC»©e
(
$v_fedesü_li¡
, 
$p_»suÉ_li¡
, 
$v_İtiÚs
);

392 ià(
$v_»suÉ
 != 1) {

397  
$p_»suÉ_li¡
;

398 
	}
}

436 
public
 
funùiÚ
 
	$add
(
$p_f–i¡
)

438 
$v_»suÉ
=1;

441 
$this
->
	`´ivE¼ÜRe£t
();

444 
$v_İtiÚs
 = 
	`¬¿y
();

445 
$v_İtiÚs
[
PCLZIP_OPT_NO_COMPRESSION
] = 
çl£
;

448 
$v_size
 = 
	`func_num_¬gs
();

451 ià(
$v_size
 > 1) {

453 
$v_¬g_li¡
 = 
	`func_g‘_¬gs
();

456 
	`¬¿y_shiá
(
$v_¬g_li¡
);

457 
$v_size
--;

460 ià((
	`is_š‹g”
(
$v_¬g_li¡
[0])) && ($v_arg_list[0] > 77000)) {

462 
$v_»suÉ
 = 
$this
->
	`´ivP¬£O±iÚs
(
$v_¬g_li¡
, 
$v_size
, 
$v_İtiÚs
, 
	`¬¿y
 (

463 
PCLZIP_OPT_REMOVE_PATH
 => 'optional',

464 
PCLZIP_OPT_REMOVE_ALL_PATH
 => 'optional',

465 
PCLZIP_OPT_ADD_PATH
 => 'optional',

466 
PCLZIP_CB_PRE_ADD
 => 'optional',

467 
PCLZIP_CB_POST_ADD
 => 'optional',

468 
PCLZIP_OPT_NO_COMPRESSION
 => 'optional',

469 
PCLZIP_OPT_COMMENT
 => 'optional',

470 
PCLZIP_OPT_ADD_COMMENT
 => 'optional',

471 
PCLZIP_OPT_PREPEND_COMMENT
 => 'optional',

472 
PCLZIP_OPT_TEMP_FILE_THRESHOLD
 => 'optional',

473 
PCLZIP_OPT_TEMP_FILE_ON
 => 'optional',

474 
PCLZIP_OPT_TEMP_FILE_OFF
 => 'optional'

477 ià(
$v_»suÉ
 != 1) {

485 
$v_İtiÚs
[
PCLZIP_OPT_ADD_PATH
] = 
$v_add_·th
 = 
$v_¬g_li¡
[0];

488 ià(
$v_size
 == 2) {

489 
$v_İtiÚs
[
PCLZIP_OPT_REMOVE_PATH
] = 
$v_¬g_li¡
[1];

490 } 
	`–£if
 (
$v_size
 > 2) {

492 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Invalid‚umber /ype of‡rguments");

501 
$this
->
	`´ivO±iÚDeçuÉTh»shŞd
(
$v_İtiÚs
);

504 
$v_¡ršg_li¡
 = 
	`¬¿y
();

505 
$v_©t_li¡
 = 
	`¬¿y
();

506 
$v_fedesü_li¡
 = 
	`¬¿y
();

507 
$p_»suÉ_li¡
 = 
	`¬¿y
();

510 ià(
	`is_¬¿y
(
$p_f–i¡
)) {

513 ià(
	`is£t
(
$p_f–i¡
[0]è&& 
	`is_¬¿y
($p_filelist[0])) {

514 
$v_©t_li¡
 = 
$p_f–i¡
;

517 
$v_¡ršg_li¡
 = 
$p_f–i¡
;

519 } 
	`–£if
 (
	`is_¡ršg
(
$p_f–i¡
)) {

522 
$v_¡ršg_li¡
 = 
	`ex¶ode
(
PCLZIP_SEPARATOR
, 
$p_f–i¡
);

525 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Inv®id v¬ŸbËy³ '".
	`g‘ty³
(
$p_f–i¡
)."' for…_filelist");

530 ià((
$v_¡ršg_li¡
) != 0) {

531 
	`fÜ—ch
 (
$v_¡ršg_li¡
 
as
 
$v_¡ršg
) {

532 
$v_©t_li¡
[][
PCLZIP_ATT_FILE_NAME
] = 
$v_¡ršg
;

537 
$v_suµÜ‹d_©Œibu‹s
 = 
	`¬¿y
(

538 
PCLZIP_ATT_FILE_NAME
 => 'mandatory',

539 
PCLZIP_ATT_FILE_NEW_SHORT_NAME
 => 'optional',

540 
PCLZIP_ATT_FILE_NEW_FULL_NAME
 => 'optional',

541 
PCLZIP_ATT_FILE_MTIME
 => 'optional',

542 
PCLZIP_ATT_FILE_CONTENT
 => 'optional',

543 
PCLZIP_ATT_FILE_COMMENT
 => 'optional',

545 
	`fÜ—ch
 (
$v_©t_li¡
 
as
 
$v_’Œy
) {

546 
$v_»suÉ
 = 
$this
->
	`´ivFeDesüP¬£A‰
(
$v_’Œy
, 
$v_fedesü_li¡
[], 
$v_İtiÚs
, 
$v_suµÜ‹d_©Œibu‹s
);

547 ià(
$v_»suÉ
 != 1) {

553 
$v_»suÉ
 = 
$this
->
	`´ivFeDesüEx·nd
(
$v_fedesü_li¡
, 
$v_İtiÚs
);

554 ià(
$v_»suÉ
 != 1) {

559 
$v_»suÉ
 = 
$this
->
	`´ivAdd
(
$v_fedesü_li¡
, 
$p_»suÉ_li¡
, 
$v_İtiÚs
);

560 ià(
$v_»suÉ
 != 1) {

565  
$p_»suÉ_li¡
;

566 
	}
}

610 
public
 
funùiÚ
 
	$li¡CÚ‹Á
()

612 
$v_»suÉ
=1;

615 
$this
->
	`´ivE¼ÜRe£t
();

618 ià(!
$this
->
	`´ivCheckFÜm©
()) {

623 
$p_li¡
 = 
	`¬¿y
();

624 ià((
$v_»suÉ
 = 
$this
->
	`´ivLi¡
(
$p_li¡
)) != 1) {

625 
	`un£t
(
$p_li¡
);

630  
$p_li¡
;

631 
	}
}

666 
public
 
funùiÚ
 
	$exŒaù
()

668 
$v_»suÉ
=1;

671 
$this
->
	`´ivE¼ÜRe£t
();

674 ià(!
$this
->
	`´ivCheckFÜm©
()) {

679 
$v_İtiÚs
 = 
	`¬¿y
();

681 
$v_·th
 = '';

682 
$v_»move_·th
 = "";

683 
$v_»move_®l_·th
 = 
çl£
;

686 
$v_size
 = 
	`func_num_¬gs
();

689 
$v_İtiÚs
[
PCLZIP_OPT_EXTRACT_AS_STRING
] = 
çl£
;

692 ià(
$v_size
 > 0) {

694 
$v_¬g_li¡
 = 
	`func_g‘_¬gs
();

697 ià((
	`is_š‹g”
(
$v_¬g_li¡
[0])) && ($v_arg_list[0] > 77000)) {

699 
$v_»suÉ
 = 
$this
->
	`´ivP¬£O±iÚs
(
$v_¬g_li¡
, 
$v_size
, 
$v_İtiÚs
, 
	`¬¿y
 (

700 
PCLZIP_OPT_PATH
 => 'optional',

701 
PCLZIP_OPT_REMOVE_PATH
 => 'optional',

702 
PCLZIP_OPT_REMOVE_ALL_PATH
 => 'optional',

703 
PCLZIP_OPT_ADD_PATH
 => 'optional',

704 
PCLZIP_CB_PRE_EXTRACT
 => 'optional',

705 
PCLZIP_CB_POST_EXTRACT
 => 'optional',

706 
PCLZIP_OPT_SET_CHMOD
 => 'optional',

707 
PCLZIP_OPT_BY_NAME
 => 'optional',

708 
PCLZIP_OPT_BY_EREG
 => 'optional',

709 
PCLZIP_OPT_BY_PREG
 => 'optional',

710 
PCLZIP_OPT_BY_INDEX
 => 'optional',

711 
PCLZIP_OPT_EXTRACT_AS_STRING
 => 'optional',

712 
PCLZIP_OPT_EXTRACT_IN_OUTPUT
 => 'optional',

713 
PCLZIP_OPT_REPLACE_NEWER
 => 'optional',

714 
PCLZIP_OPT_STOP_ON_ERROR
 => 'optional',

715 
PCLZIP_OPT_EXTRACT_DIR_RESTRICTION
 => 'optional',

716 
PCLZIP_OPT_TEMP_FILE_THRESHOLD
 => 'optional',

717 
PCLZIP_OPT_TEMP_FILE_ON
 => 'optional',

718 
PCLZIP_OPT_TEMP_FILE_OFF
 => 'optional'

720 ià(
$v_»suÉ
 != 1) {

725 ià(
	`is£t
(
$v_İtiÚs
[
PCLZIP_OPT_PATH
])) {

726 
$v_·th
 = 
$v_İtiÚs
[
PCLZIP_OPT_PATH
];

728 ià(
	`is£t
(
$v_İtiÚs
[
PCLZIP_OPT_REMOVE_PATH
])) {

729 
$v_»move_·th
 = 
$v_İtiÚs
[
PCLZIP_OPT_REMOVE_PATH
];

731 ià(
	`is£t
(
$v_İtiÚs
[
PCLZIP_OPT_REMOVE_ALL_PATH
])) {

732 
$v_»move_®l_·th
 = 
$v_İtiÚs
[
PCLZIP_OPT_REMOVE_ALL_PATH
];

734 ià(
	`is£t
(
$v_İtiÚs
[
PCLZIP_OPT_ADD_PATH
])) {

736 ià((
	`¡¾’
(
$v_·th
è> 0è&& (
	`sub¡r
($v_path, -1) != '/')) {

737 
$v_·th
 .= '/';

739 
$v_·th
 .ğ
$v_İtiÚs
[
PCLZIP_OPT_ADD_PATH
];

746 
$v_·th
 = 
$v_¬g_li¡
[0];

749 ià(
$v_size
 == 2) {

750 
$v_»move_·th
 = 
$v_¬g_li¡
[1];

751 } 
	`–£if
 (
$v_size
 > 2) {

753 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Invalid‚umber /ype of‡rguments");

762 
$this
->
	`´ivO±iÚDeçuÉTh»shŞd
(
$v_İtiÚs
);

767 
$p_li¡
 = 
	`¬¿y
();

768 
$v_»suÉ
 = 
$this
->
	`´ivExŒaùByRuË
(
$p_li¡
, 
$v_·th
, 
$v_»move_·th
, 
$v_»move_®l_·th
, 
$v_İtiÚs
);

769 ià(
$v_»suÉ
 < 1) {

770 
	`un£t
(
$p_li¡
);

775  
$p_li¡
;

776 
	}
}

817 
public
 
funùiÚ
 
	$exŒaùByIndex
(
$p_šdex
)

819 
$v_»suÉ
=1;

822 
$this
->
	`´ivE¼ÜRe£t
();

825 ià(!
$this
->
	`´ivCheckFÜm©
()) {

830 
$v_İtiÚs
 = 
	`¬¿y
();

832 
$v_·th
 = '';

833 
$v_»move_·th
 = "";

834 
$v_»move_®l_·th
 = 
çl£
;

837 
$v_size
 = 
	`func_num_¬gs
();

840 
$v_İtiÚs
[
PCLZIP_OPT_EXTRACT_AS_STRING
] = 
çl£
;

843 ià(
$v_size
 > 1) {

845 
$v_¬g_li¡
 = 
	`func_g‘_¬gs
();

848 
	`¬¿y_shiá
(
$v_¬g_li¡
);

849 
$v_size
--;

852 ià((
	`is_š‹g”
(
$v_¬g_li¡
[0])) && ($v_arg_list[0] > 77000)) {

854 
$v_»suÉ
 = 
$this
->
	`´ivP¬£O±iÚs
(
$v_¬g_li¡
, 
$v_size
, 
$v_İtiÚs
, 
	`¬¿y
(

855 
PCLZIP_OPT_PATH
 => 'optional',

856 
PCLZIP_OPT_REMOVE_PATH
 => 'optional',

857 
PCLZIP_OPT_REMOVE_ALL_PATH
 => 'optional',

858 
PCLZIP_OPT_EXTRACT_AS_STRING
 => 'optional',

859 
PCLZIP_OPT_ADD_PATH
 => 'optional',

860 
PCLZIP_CB_PRE_EXTRACT
 => 'optional',

861 
PCLZIP_CB_POST_EXTRACT
 => 'optional',

862 
PCLZIP_OPT_SET_CHMOD
 => 'optional',

863 
PCLZIP_OPT_REPLACE_NEWER
 => 'optional',

864 
PCLZIP_OPT_STOP_ON_ERROR
 => 'optional',

865 
PCLZIP_OPT_EXTRACT_DIR_RESTRICTION
 => 'optional',

866 
PCLZIP_OPT_TEMP_FILE_THRESHOLD
 => 'optional',

867 
PCLZIP_OPT_TEMP_FILE_ON
 => 'optional',

868 
PCLZIP_OPT_TEMP_FILE_OFF
 => 'optional'

870 ià(
$v_»suÉ
 != 1) {

875 ià(
	`is£t
(
$v_İtiÚs
[
PCLZIP_OPT_PATH
])) {

876 
$v_·th
 = 
$v_İtiÚs
[
PCLZIP_OPT_PATH
];

878 ià(
	`is£t
(
$v_İtiÚs
[
PCLZIP_OPT_REMOVE_PATH
])) {

879 
$v_»move_·th
 = 
$v_İtiÚs
[
PCLZIP_OPT_REMOVE_PATH
];

881 ià(
	`is£t
(
$v_İtiÚs
[
PCLZIP_OPT_REMOVE_ALL_PATH
])) {

882 
$v_»move_®l_·th
 = 
$v_İtiÚs
[
PCLZIP_OPT_REMOVE_ALL_PATH
];

884 ià(
	`is£t
(
$v_İtiÚs
[
PCLZIP_OPT_ADD_PATH
])) {

886 ià((
	`¡¾’
(
$v_·th
è> 0è&& (
	`sub¡r
($v_path, -1) != '/')) {

887 
$v_·th
 .= '/';

889 
$v_·th
 .ğ
$v_İtiÚs
[
PCLZIP_OPT_ADD_PATH
];

891 ià(!
	`is£t
(
$v_İtiÚs
[
PCLZIP_OPT_EXTRACT_AS_STRING
])) {

892 
$v_İtiÚs
[
PCLZIP_OPT_EXTRACT_AS_STRING
] = 
çl£
;

901 
$v_·th
 = 
$v_¬g_li¡
[0];

904 ià(
$v_size
 == 2) {

905 
$v_»move_·th
 = 
$v_¬g_li¡
[1];

906 } 
	`–£if
 (
$v_size
 > 2) {

908 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Invalid‚umber /ype of‡rguments");

921 
$v_¬g_Œick
 = 
	`¬¿y
 (
PCLZIP_OPT_BY_INDEX
, 
$p_šdex
);

922 
$v_İtiÚs_Œick
 = 
	`¬¿y
();

923 
$v_»suÉ
 = 
$this
->
	`´ivP¬£O±iÚs
(
$v_¬g_Œick
, ($v_¬g_Œick), 
$v_İtiÚs_Œick
, 
	`¬¿y
 (
PCLZIP_OPT_BY_INDEX
 => 'optional'));

924 ià(
$v_»suÉ
 != 1) {

927 
$v_İtiÚs
[
PCLZIP_OPT_BY_INDEX
] = 
$v_İtiÚs_Œick
[PCLZIP_OPT_BY_INDEX];

930 
$this
->
	`´ivO±iÚDeçuÉTh»shŞd
(
$v_İtiÚs
);

933 ià((
$v_»suÉ
 = 
$this
->
	`´ivExŒaùByRuË
(
$p_li¡
, 
$v_·th
, 
$v_»move_·th
, 
$v_»move_®l_·th
, 
$v_İtiÚs
)) < 1) {

938  
$p_li¡
;

939 
	}
}

960 
public
 
funùiÚ
 
	$d–‘e
()

962 
$v_»suÉ
=1;

965 
$this
->
	`´ivE¼ÜRe£t
();

968 ià(!
$this
->
	`´ivCheckFÜm©
()) {

973 
$v_İtiÚs
 = 
	`¬¿y
();

976 
$v_size
 = 
	`func_num_¬gs
();

979 ià(
$v_size
 > 0) {

981 
$v_¬g_li¡
 = 
	`func_g‘_¬gs
();

984 
$v_»suÉ
 = 
$this
->
	`´ivP¬£O±iÚs
(
$v_¬g_li¡
, 
$v_size
, 
$v_İtiÚs
, 
	`¬¿y
 (

985 
PCLZIP_OPT_BY_NAME
 => 'optional',

986 
PCLZIP_OPT_BY_EREG
 => 'optional',

987 
PCLZIP_OPT_BY_PREG
 => 'optional',

988 
PCLZIP_OPT_BY_INDEX
 => 'optional'

990 ià(
$v_»suÉ
 != 1) {

996 
$this
->
	`´ivDi§bËMagicQuÙes
();

999 
$v_li¡
 = 
	`¬¿y
();

1000 ià((
$v_»suÉ
 = 
$this
->
	`´ivD–‘eByRuË
(
$v_li¡
, 
$v_İtiÚs
)) != 1) {

1001 
$this
->
	`´ivSw­BackMagicQuÙes
();

1002 
	`un£t
(
$v_li¡
);

1007 
$this
->
	`´ivSw­BackMagicQuÙes
();

1010  
$v_li¡
;

1011 
	}
}

1020 
public
 
funùiÚ
 
	$d–‘eByIndex
(
$p_šdex
)

1023 
$p_li¡
 = 
$this
->
	`d–‘e
(
PCLZIP_OPT_BY_INDEX
, 
$p_šdex
);

1026  
$p_li¡
;

1027 
	}
}

1044 
public
 
funùiÚ
 
	$´İ”t›s
()

1048 
$this
->
	`´ivE¼ÜRe£t
();

1051 
$this
->
	`´ivDi§bËMagicQuÙes
();

1054 ià(!
$this
->
	`´ivCheckFÜm©
()) {

1055 
$this
->
	`´ivSw­BackMagicQuÙes
();

1060 
$v_´İ
 = 
	`¬¿y
();

1061 
$v_´İ
['comment'] = '';

1062 
$v_´İ
['nb'] = 0;

1063 
$v_´İ
['status'] = 'not_exist';

1066 ià(@
	`is_fe
(
$this
->
zÇme
)) {

1068 ià((
$this
->
z_fd
 = @
	`fİ’
($this->
zÇme
, 'rb')) == 0) {

1069 
$this
->
	`´ivSw­BackMagicQuÙes
();

1072 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, 'UÇbËØİ’‡rchiv\''.
$this
->
zÇme
.'\' in binary„ead mode');

1079 
$v_ûÁ¿l_dœ
 = 
	`¬¿y
();

1080 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dEndC’Œ®Dœ
(
$v_ûÁ¿l_dœ
)) != 1) {

1081 
$this
->
	`´ivSw­BackMagicQuÙes
();

1086 
$this
->
	`´ivClo£Fd
();

1089 
$v_´İ
['comm’t'] = 
$v_ûÁ¿l_dœ
['comment'];

1090 
$v_´İ
['nb'] = 
$v_ûÁ¿l_dœ
['entries'];

1091 
$v_´İ
['status'] = 'ok';

1095 
$this
->
	`´ivSw­BackMagicQuÙes
();

1098  
$v_´İ
;

1099 
	}
}

1114 
public
 
funùiÚ
 
	$du¶iÿ‹
(
$p_¬chive
)

1116 
$v_»suÉ
 = 1;

1119 
$this
->
	`´ivE¼ÜRe£t
();

1122 ià((
	`is_objeù
(
$p_¬chive
)è&& (
	`g‘_şass
($p_archive) == 'pclzip')) {

1124 
$v_»suÉ
 = 
$this
->
	`´ivDu¶iÿ‹
(
$p_¬chive
->
zÇme
);

1125 } 
	`–£if
 (
	`is_¡ršg
(
$p_¬chive
)) {

1129 ià(!
	`is_fe
(
$p_¬chive
)) {

1131 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_FILE
, "NØfw™h f’am'".
$p_¬chive
."'");

1132 
$v_»suÉ
 = 
PCLZIP_ERR_MISSING_FILE
;

1135 
$v_»suÉ
 = 
$this
->
	`´ivDu¶iÿ‹
(
$p_¬chive
);

1140 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Invalid variableype…_archive_to_add");

1141 
$v_»suÉ
 = 
PCLZIP_ERR_INVALID_PARAMETER
;

1145  
$v_»suÉ
;

1146 
	}
}

1163 
public
 
funùiÚ
 
	$m”ge
(
$p_¬chive_to_add
)

1165 
$v_»suÉ
 = 1;

1168 
$this
->
	`´ivE¼ÜRe£t
();

1171 ià(!
$this
->
	`´ivCheckFÜm©
()) {

1176 ià((
	`is_objeù
(
$p_¬chive_to_add
)è&& (
	`g‘_şass
($p_archive_to_add) == 'pclzip')) {

1178 
$v_»suÉ
 = 
$this
->
	`´ivM”ge
(
$p_¬chive_to_add
);

1179 } 
	`–£if
 (
	`is_¡ršg
(
$p_¬chive_to_add
)) {

1182 
$v_objeù_¬chive
 = 
Ãw
 
	`PşZ
(
$p_¬chive_to_add
);

1185 
$v_»suÉ
 = 
$this
->
	`´ivM”ge
(
$v_objeù_¬chive
);

1189 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Invalid variableype…_archive_to_add");

1190 
$v_»suÉ
 = 
PCLZIP_ERR_INVALID_PARAMETER
;

1194  
$v_»suÉ
;

1195 
	}
}

1205 
public
 
funùiÚ
 
	$”rÜCode
()

1207 ià(
PCLZIP_ERROR_EXTERNAL
 == 1) {

1208 (
	`PşE¼ÜCode
());

1210 (
$this
->
”rÜ_code
);

1212 
	}
}

1220 
public
 
funùiÚ
 
	$”rÜName
(
$p_w™h_code
 = 
çl£
)

1222 
$v_Çme
 = 
	`¬¿y
(

1223 
PCLZIP_ERR_NO_ERROR
 => 'PCLZIP_ERR_NO_ERROR',

1224 
PCLZIP_ERR_WRITE_OPEN_FAIL
 => 'PCLZIP_ERR_WRITE_OPEN_FAIL',

1225 
PCLZIP_ERR_READ_OPEN_FAIL
 => 'PCLZIP_ERR_READ_OPEN_FAIL',

1226 
PCLZIP_ERR_INVALID_PARAMETER
 => 'PCLZIP_ERR_INVALID_PARAMETER',

1227 
PCLZIP_ERR_MISSING_FILE
 => 'PCLZIP_ERR_MISSING_FILE',

1228 
PCLZIP_ERR_FILENAME_TOO_LONG
 => 'PCLZIP_ERR_FILENAME_TOO_LONG',

1229 
PCLZIP_ERR_INVALID_ZIP
 => 'PCLZIP_ERR_INVALID_ZIP',

1230 
PCLZIP_ERR_BAD_EXTRACTED_FILE
 => 'PCLZIP_ERR_BAD_EXTRACTED_FILE',

1231 
PCLZIP_ERR_DIR_CREATE_FAIL
 => 'PCLZIP_ERR_DIR_CREATE_FAIL',

1232 
PCLZIP_ERR_BAD_EXTENSION
 => 'PCLZIP_ERR_BAD_EXTENSION',

1233 
PCLZIP_ERR_BAD_FORMAT
 => 'PCLZIP_ERR_BAD_FORMAT',

1234 
PCLZIP_ERR_DELETE_FILE_FAIL
 => 'PCLZIP_ERR_DELETE_FILE_FAIL',

1235 
PCLZIP_ERR_RENAME_FILE_FAIL
 => 'PCLZIP_ERR_RENAME_FILE_FAIL',

1236 
PCLZIP_ERR_BAD_CHECKSUM
 => 'PCLZIP_ERR_BAD_CHECKSUM',

1237 
PCLZIP_ERR_INVALID_ARCHIVE_ZIP
 => 'PCLZIP_ERR_INVALID_ARCHIVE_ZIP',

1238 
PCLZIP_ERR_MISSING_OPTION_VALUE
 => 'PCLZIP_ERR_MISSING_OPTION_VALUE',

1239 
PCLZIP_ERR_INVALID_OPTION_VALUE
 => 'PCLZIP_ERR_INVALID_OPTION_VALUE',

1240 
PCLZIP_ERR_UNSUPPORTED_COMPRESSION
 => 'PCLZIP_ERR_UNSUPPORTED_COMPRESSION',

1241 
PCLZIP_ERR_UNSUPPORTED_ENCRYPTION
 => 'PCLZIP_ERR_UNSUPPORTED_ENCRYPTION',

1242 
PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE
 => 'PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE',

1243 
PCLZIP_ERR_DIRECTORY_RESTRICTION
 => 'PCLZIP_ERR_DIRECTORY_RESTRICTION',

1246 ià(
	`is£t
(
$v_Çme
[
$this
->
”rÜ_code
])) {

1247 
$v_v®ue
 = 
$v_Çme
[
$this
->
”rÜ_code
];

1249 
$v_v®ue
 = 'NoName';

1252 ià(
$p_w™h_code
) {

1253 (
$v_v®ue
.' ('.
$this
->
”rÜ_code
.')');

1255 (
$v_v®ue
);

1257 
	}
}

1265 
public
 
funùiÚ
 
	$”rÜInfo
(
$p_fuÎ
 = 
çl£
)

1267 ià(
PCLZIP_ERROR_EXTERNAL
 == 1) {

1268 (
	`PşE¼ÜSŒšg
());

1270 ià(
$p_fuÎ
) {

1271 (
$this
->
	`”rÜName
(
Œue
)." : ".$this->
”rÜ_¡ršg
);

1273 (
$this
->
”rÜ_¡ršg
." [cod".$this->
”rÜ_code
."]");

1276 
	}
}

1302 
public
 
funùiÚ
 
	$´ivCheckFÜm©
(
$p_Ëv–
 = 0)

1304 
$v_»suÉ
 = 
Œue
;

1307 
	`ş—r¡©ÿche
();

1310 
$this
->
	`´ivE¼ÜRe£t
();

1313 ià(!
	`is_fe
(
$this
->
zÇme
)) {

1315 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_FILE
, "Missšg‡rchivf'".
$this
->
zÇme
."'");

1316 (
çl£
);

1320 ià(!
	`is_»adabË
(
$this
->
zÇme
)) {

1322 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, "UÇbËØ»ad‡rchiv'".
$this
->
zÇme
."'");

1323 (
çl£
);

1336  
$v_»suÉ
;

1337 
	}
}

1355 
public
 
funùiÚ
 
	$´ivP¬£O±iÚs
(&
$p_İtiÚs_li¡
, 
$p_size
, &
$v_»suÉ_li¡
, 
$v_»que¡ed_İtiÚs
 = 
çl£
)

1357 
$v_»suÉ
=1;

1360 
$i
=0;

1361 
$i
<
$p_size
) {

1363 ià(!
	`is£t
(
$v_»que¡ed_İtiÚs
[
$p_İtiÚs_li¡
[
$i
]])) {

1365 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Inv®id o±iÚ®…¬am‘” '".
$p_İtiÚs_li¡
[
$i
]."' forhis method");

1368  
PşZ
::
	`”rÜCode
();

1372 
$p_İtiÚs_li¡
[
$i
]) {

1374 
PCLZIP_OPT_PATH
:

1375 
PCLZIP_OPT_REMOVE_PATH
:

1376 
PCLZIP_OPT_ADD_PATH
:

1378 ià((
$i
+1è>ğ
$p_size
) {

1380 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_OPTION_VALUE
, "Missšg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1383  
PşZ
::
	`”rÜCode
();

1387 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = 
	`PşZUtT¿n¦©eWšP©h
($p_İtiÚs_li¡[$i+1], 
çl£
);

1388 
$i
++;

1391 
PCLZIP_OPT_TEMP_FILE_THRESHOLD
:

1393 ià((
$i
+1è>ğ
$p_size
) {

1394 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_OPTION_VALUE
, "Missšg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1395  
PşZ
::
	`”rÜCode
();

1399 ià(
	`is£t
(
$v_»suÉ_li¡
[
PCLZIP_OPT_TEMP_FILE_OFF
])) {

1400 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "O±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."' can‚ot be used with option 'PCLZIP_OPT_TEMP_FILE_OFF'");

1401  
PşZ
::
	`”rÜCode
();

1405 
$v_v®ue
 = 
$p_İtiÚs_li¡
[
$i
+1];

1406 ià((!
	`is_š‹g”
(
$v_v®ue
)) || ($v_value<0)) {

1407 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_OPTION_VALUE
, "IÁeg”ƒx³ùed fÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1408  
PşZ
::
	`”rÜCode
();

1412 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = 
$v_v®ue
*1048576;

1413 
$i
++;

1416 
PCLZIP_OPT_TEMP_FILE_ON
:

1418 ià(
	`is£t
(
$v_»suÉ_li¡
[
PCLZIP_OPT_TEMP_FILE_OFF
])) {

1419 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "O±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."' can‚ot be used with option 'PCLZIP_OPT_TEMP_FILE_OFF'");

1420  
PşZ
::
	`”rÜCode
();

1423 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = 
Œue
;

1426 
PCLZIP_OPT_TEMP_FILE_OFF
:

1428 ià(
	`is£t
(
$v_»suÉ_li¡
[
PCLZIP_OPT_TEMP_FILE_ON
])) {

1429 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "O±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."' can‚ot be used with option 'PCLZIP_OPT_TEMP_FILE_ON'");

1430  
PşZ
::
	`”rÜCode
();

1433 ià(
	`is£t
(
$v_»suÉ_li¡
[
PCLZIP_OPT_TEMP_FILE_THRESHOLD
])) {

1434 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "O±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."' can‚ot be used with option 'PCLZIP_OPT_TEMP_FILE_THRESHOLD'");

1435  
PşZ
::
	`”rÜCode
();

1437 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = 
Œue
;

1440 
PCLZIP_OPT_EXTRACT_DIR_RESTRICTION
:

1442 ià((
$i
+1è>ğ
$p_size
) {

1444 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_OPTION_VALUE
, "Missšg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1446  
PşZ
::
	`”rÜCode
();

1450 ià(
	`is_¡ršg
(
$p_İtiÚs_li¡
[
$i
+1]) && ($p_options_list[$i+1] != '')) {

1451 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = 
	`PşZUtT¿n¦©eWšP©h
($p_İtiÚs_li¡[$i+1], 
çl£
);

1452 
$i
++;

1457 
PCLZIP_OPT_BY_NAME
:

1459 ià((
$i
+1è>ğ
$p_size
) {

1461 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_OPTION_VALUE
, "Missšg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1463  
PşZ
::
	`”rÜCode
();

1467 ià(
	`is_¡ršg
(
$p_İtiÚs_li¡
[
$i
+1])) {

1468 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]][0] = $p_options_list[$i+1];

1469 } 
	`–£if
 (
	`is_¬¿y
(
$p_İtiÚs_li¡
[
$i
+1])) {

1470 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = $p_options_list[$i+1];

1473 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_OPTION_VALUE
, "WrÚg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1475  
PşZ
::
	`”rÜCode
();

1477 
$i
++;

1480 
PCLZIP_OPT_BY_EREG
:

1483 
$p_İtiÚs_li¡
[
$i
] = 
PCLZIP_OPT_BY_PREG
;

1484 
PCLZIP_OPT_BY_PREG
:

1487 ià((
$i
+1è>ğ
$p_size
) {

1489 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_OPTION_VALUE
, "Missšg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1491  
PşZ
::
	`”rÜCode
();

1495 ià(
	`is_¡ršg
(
$p_İtiÚs_li¡
[
$i
+1])) {

1496 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = $p_options_list[$i+1];

1499 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_OPTION_VALUE
, "WrÚg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1501  
PşZ
::
	`”rÜCode
();

1503 
$i
++;

1507 
PCLZIP_OPT_COMMENT
:

1508 
PCLZIP_OPT_ADD_COMMENT
:

1509 
PCLZIP_OPT_PREPEND_COMMENT
:

1511 ià((
$i
+1è>ğ
$p_size
) {

1513 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_OPTION_VALUE
, "Missšg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1516  
PşZ
::
	`”rÜCode
();

1520 ià(
	`is_¡ršg
(
$p_İtiÚs_li¡
[
$i
+1])) {

1521 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = $p_options_list[$i+1];

1524 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_OPTION_VALUE
, "WrÚg…¬am‘” v®ufÜ o±iÚ '" .
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
]) ."'");

1527  
PşZ
::
	`”rÜCode
();

1529 
$i
++;

1533 
PCLZIP_OPT_BY_INDEX
:

1535 ià((
$i
+1è>ğ
$p_size
) {

1537 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_OPTION_VALUE
, "Missšg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1540  
PşZ
::
	`”rÜCode
();

1544 
$v_wÜk_li¡
 = 
	`¬¿y
();

1545 ià(
	`is_¡ršg
(
$p_İtiÚs_li¡
[
$i
+1])) {

1547 
$p_İtiÚs_li¡
[
$i
+1] = 
	`¡¹r
($p_options_list[$i+1], ' ', '');

1550 
$v_wÜk_li¡
 = 
	`ex¶ode
(",", 
$p_İtiÚs_li¡
[
$i
+1]);

1551 } 
	`–£if
 (
	`is_š‹g”
(
$p_İtiÚs_li¡
[
$i
+1])) {

1552 
$v_wÜk_li¡
[0] = 
$p_İtiÚs_li¡
[
$i
+1].'-'.$p_options_list[$i+1];

1553 } 
	`–£if
 (
	`is_¬¿y
(
$p_İtiÚs_li¡
[
$i
+1])) {

1554 
$v_wÜk_li¡
 = 
$p_İtiÚs_li¡
[
$i
+1];

1557 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_OPTION_VALUE
, "V®umu¡ bš‹g”, sŒšg o¸¬¿y fÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1560  
PşZ
::
	`”rÜCode
();

1567 
$v_sÜt_æag
=
çl£
;

1568 
$v_sÜt_v®ue
=0;

1569 
$j
=0; $j<(
$v_wÜk_li¡
); $j++) {

1571 
$v_™em_li¡
 = 
	`ex¶ode
("-", 
$v_wÜk_li¡
[
$j
]);

1572 
$v_size_™em_li¡
 = (
$v_™em_li¡
);

1578 ià(
$v_size_™em_li¡
 == 1) {

1580 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]][
$j
]['¡¬t'] = 
$v_™em_li¡
[0];

1581 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]][
$j
]['’d'] = 
$v_™em_li¡
[0];

1582 } 
	`–£if
 (
$v_size_™em_li¡
 == 2) {

1584 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]][
$j
]['¡¬t'] = 
$v_™em_li¡
[0];

1585 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]][
$j
]['’d'] = 
$v_™em_li¡
[1];

1588 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_OPTION_VALUE
, "ToØmªy v®ue š index„ªgfÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1591  
PşZ
::
	`”rÜCode
();

1596 ià(
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]][
$j
]['¡¬t'] < 
$v_sÜt_v®ue
) {

1597 
$v_sÜt_æag
=
Œue
;

1601 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_OPTION_VALUE
, "Inv®id ord” oàšdex„ªgfÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1604  
PşZ
::
	`”rÜCode
();

1606 
$v_sÜt_v®ue
 = 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]][
$j
]['start'];

1610 ià(
$v_sÜt_æag
) {

1614 
$i
++;

1617 
PCLZIP_OPT_REMOVE_ALL_PATH
:

1618 
PCLZIP_OPT_EXTRACT_AS_STRING
:

1619 
PCLZIP_OPT_NO_COMPRESSION
:

1620 
PCLZIP_OPT_EXTRACT_IN_OUTPUT
:

1621 
PCLZIP_OPT_REPLACE_NEWER
:

1622 
PCLZIP_OPT_STOP_ON_ERROR
:

1623 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = 
Œue
;

1626 
PCLZIP_OPT_SET_CHMOD
:

1628 ià((
$i
+1è>ğ
$p_size
) {

1630 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_OPTION_VALUE
, "Missšg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1632  
PşZ
::
	`”rÜCode
();

1635 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = $p_options_list[$i+1];

1636 
$i
++;

1640 
PCLZIP_CB_PRE_EXTRACT
:

1641 
PCLZIP_CB_POST_EXTRACT
:

1642 
PCLZIP_CB_PRE_ADD
:

1643 
PCLZIP_CB_POST_ADD
:

1651 ià((
$i
+1è>ğ
$p_size
) {

1653 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_OPTION_VALUE
, "Missšg…¬am‘” v®ufÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1655  
PşZ
::
	`”rÜCode
();

1659 
$v_funùiÚ_Çme
 = 
$p_İtiÚs_li¡
[
$i
+1];

1662 ià(!
	`funùiÚ_exi¡s
(
$v_funùiÚ_Çme
)) {

1664 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_OPTION_VALUE
, "FunùiÚ '".
$v_funùiÚ_Çme
."()' i nÙ‡Àexi¡šg funùiÚ fÜ o±iÚ '".
	`PşZUtO±iÚText
(
$p_İtiÚs_li¡
[
$i
])."'");

1666  
PşZ
::
	`”rÜCode
();

1670 
$v_»suÉ_li¡
[
$p_İtiÚs_li¡
[
$i
]] = 
$v_funùiÚ_Çme
;

1671 
$i
++;

1675 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "UnknowÀ·¿m‘” '" .
$p_İtiÚs_li¡
[
$i
]."'");

1678  
PşZ
::
	`”rÜCode
();

1682 
$i
++;

1686 ià(
$v_»que¡ed_İtiÚs
 !=ğ
çl£
) {

1687 
$key
=
	`»£t
(
$v_»que¡ed_İtiÚs
); $key=
	`key
($v_»que¡ed_İtiÚs); $key=
	`Ãxt
($v_requested_options)) {

1689 ià(
$v_»que¡ed_İtiÚs
[
$key
] == 'mandatory') {

1691 ià(!
	`is£t
(
$v_»suÉ_li¡
[
$key
])) {

1693 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Missšg mªd©Üy…¬am‘” ".
	`PşZUtO±iÚText
(
$key
)."(".$key.")");

1696  
PşZ
::
	`”rÜCode
();

1703 ià(!
	`is£t
(
$v_»suÉ_li¡
[
PCLZIP_OPT_TEMP_FILE_THRESHOLD
])) {

1707  
$v_»suÉ
;

1708 
	}
}

1717 
public
 
funùiÚ
 
	$´ivO±iÚDeçuÉTh»shŞd
(&
$p_İtiÚs
)

1719 
$v_»suÉ
=1;

1721 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_TEMP_FILE_THRESHOLD
]è|| is£t($p_İtiÚs[
PCLZIP_OPT_TEMP_FILE_OFF
])) {

1722  
$v_»suÉ
;

1726 
$v_memÜy_lim™
 = 
	`ši_g‘
('memory_limit');

1727 
$v_memÜy_lim™
 = 
	`Œim
($v_memory_limit);

1728 
$Ï¡
 = 
	`¡¹Şow”
(
	`sub¡r
(
$v_memÜy_lim™
, -1));

1730 ià(
$Ï¡
 == 'g') {

1732 
$v_memÜy_lim™
 = $v_memory_limit*1073741824;

1734 ià(
$Ï¡
 == 'm') {

1736 
$v_memÜy_lim™
 = $v_memory_limit*1048576;

1738 ià(
$Ï¡
 == 'k') {

1739 
$v_memÜy_lim™
 = $v_memory_limit*1024;

1742 
$p_İtiÚs
[
PCLZIP_OPT_TEMP_FILE_THRESHOLD
] = 
	`æoÜ
(
$v_memÜy_lim™
*
PCLZIP_TEMPORARY_FILE_RATIO
);

1745 ià(
$p_İtiÚs
[
PCLZIP_OPT_TEMP_FILE_THRESHOLD
] < 1048576) {

1746 
	`un£t
(
$p_İtiÚs
[
PCLZIP_OPT_TEMP_FILE_THRESHOLD
]);

1750  
$v_»suÉ
;

1751 
	}
}

1762 
public
 
funùiÚ
 
	$´ivFeDesüP¬£A‰
(&
$p_fe_li¡
, &
$p_fedesü
, 
$v_İtiÚs
, 
$v_»que¡ed_İtiÚs
 = 
çl£
)

1764 
$v_»suÉ
=1;

1767 
	`fÜ—ch
 (
$p_fe_li¡
 
as
 
$v_key
 => 
$v_v®ue
) {

1769 ià(!
	`is£t
(
$v_»que¡ed_İtiÚs
[
$v_key
])) {

1771 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Inv®id f©Œibu‹ '".
$v_key
."' forhis file");

1774  
PşZ
::
	`”rÜCode
();

1778 
$v_key
) {

1779 
PCLZIP_ATT_FILE_NAME
:

1780 ià(!
	`is_¡ršg
(
$v_v®ue
)) {

1781 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE
, "Inv®idy³ ".
	`g‘ty³
(
$v_v®ue
).". SŒšgƒx³ùed fÜ‡‰ribu‹ '".
	`PşZUtO±iÚText
(
$v_key
)."'");

1782  
PşZ
::
	`”rÜCode
();

1785 
$p_fedesü
['f’ame'] = 
	`PşZUtP©hReduùiÚ
(
$v_v®ue
);

1787 ià(
$p_fedesü
['filename'] == '') {

1788 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE
, "Inv®idƒm±y f’amfÜ‡‰ribu‹ '".
	`PşZUtO±iÚText
(
$v_key
)."'");

1789  
PşZ
::
	`”rÜCode
();

1792 
PCLZIP_ATT_FILE_NEW_SHORT_NAME
:

1793 ià(!
	`is_¡ršg
(
$v_v®ue
)) {

1794 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE
, "Inv®idy³ ".
	`g‘ty³
(
$v_v®ue
).". SŒšgƒx³ùed fÜ‡‰ribu‹ '".
	`PşZUtO±iÚText
(
$v_key
)."'");

1795  
PşZ
::
	`”rÜCode
();

1798 
$p_fedesü
['Ãw_shÜt_Çme'] = 
	`PşZUtP©hReduùiÚ
(
$v_v®ue
);

1800 ià(
$p_fedesü
['new_short_name'] == '') {

1801 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE
, "Inv®idƒm±y shÜˆf’amfÜ‡‰ribu‹ '".
	`PşZUtO±iÚText
(
$v_key
)."'");

1802  
PşZ
::
	`”rÜCode
();

1805 
PCLZIP_ATT_FILE_NEW_FULL_NAME
:

1806 ià(!
	`is_¡ršg
(
$v_v®ue
)) {

1807 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE
, "Inv®idy³ ".
	`g‘ty³
(
$v_v®ue
).". SŒšgƒx³ùed fÜ‡‰ribu‹ '".
	`PşZUtO±iÚText
(
$v_key
)."'");

1808  
PşZ
::
	`”rÜCode
();

1811 
$p_fedesü
['Ãw_fuÎ_Çme'] = 
	`PşZUtP©hReduùiÚ
(
$v_v®ue
);

1813 ià(
$p_fedesü
['new_full_name'] == '') {

1814 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE
, "Inv®idƒm±y fuÎ f’amfÜ‡‰ribu‹ '".
	`PşZUtO±iÚText
(
$v_key
)."'");

1815  
PşZ
::
	`”rÜCode
();

1819 
PCLZIP_ATT_FILE_COMMENT
:

1820 ià(!
	`is_¡ršg
(
$v_v®ue
)) {

1821 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE
, "Inv®idy³ ".
	`g‘ty³
(
$v_v®ue
).". SŒšgƒx³ùed fÜ‡‰ribu‹ '".
	`PşZUtO±iÚText
(
$v_key
)."'");

1822  
PşZ
::
	`”rÜCode
();

1824 
$p_fedesü
['comm’t'] = 
$v_v®ue
;

1826 
PCLZIP_ATT_FILE_MTIME
:

1827 ià(!
	`is_š‹g”
(
$v_v®ue
)) {

1828 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE
, "Inv®idy³ ".
	`g‘ty³
(
$v_v®ue
).". IÁeg”ƒx³ùed fÜ‡‰ribu‹ '".
	`PşZUtO±iÚText
(
$v_key
)."'");

1829  
PşZ
::
	`”rÜCode
();

1831 
$p_fedesü
['mtime'] = 
$v_v®ue
;

1833 
PCLZIP_ATT_FILE_CONTENT
:

1834 
$p_fedesü
['cÚ‹Á'] = 
$v_v®ue
;

1838 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "UnknowÀ·¿m‘” '".
$v_key
."'");

1841  
PşZ
::
	`”rÜCode
();

1845 ià(
$v_»que¡ed_İtiÚs
 !=ğ
çl£
) {

1846 
$key
 = 
	`»£t
(
$v_»que¡ed_İtiÚs
); $key = 
	`key
($v_»que¡ed_İtiÚs); $key = 
	`Ãxt
($v_requested_options)) {

1848 ià(
$v_»que¡ed_İtiÚs
[
$key
] == 'mandatory') {

1850 ià(!
	`is£t
(
$p_fe_li¡
[
$key
])) {

1851 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Missšg mªd©Üy…¬am‘” ".
	`PşZUtO±iÚText
(
$key
)."(".$key.")");

1852  
PşZ
::
	`”rÜCode
();

1860  
$v_»suÉ
;

1861 
	}
}

1878 
public
 
funùiÚ
 
	$´ivFeDesüEx·nd
(&
$p_fedesü_li¡
, &
$p_İtiÚs
)

1880 
$v_»suÉ
=1;

1883 
$v_»suÉ_li¡
 = 
	`¬¿y
();

1886 
$i
=0; $i<(
$p_fedesü_li¡
); $i++) {

1888 
$v_desü
 = 
$p_fedesü_li¡
[
$i
];

1891 
$v_desü
['f’ame'] = 
	`PşZUtT¿n¦©eWšP©h
($v_desü['f’ame'], 
çl£
);

1892 
$v_desü
['f’ame'] = 
	`PşZUtP©hReduùiÚ
($v_descr['filename']);

1895 ià(
	`fe_exi¡s
(
$v_desü
['filename'])) {

1896 ià(@
	`is_fe
(
$v_desü
['filename'])) {

1897 
$v_desü
['type'] = 'file';

1898 } 
	`–£if
 (@
	`is_dœ
(
$v_desü
['filename'])) {

1899 
$v_desü
['type'] = 'folder';

1900 } 
	`–£if
 (@
	`is_lšk
(
$v_desü
['filename'])) {

1907 } 
	`–£if
 (
	`is£t
(
$v_desü
['content'])) {

1909 
$v_desü
['type'] = 'virtual_file';

1913 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_FILE
, "F'".
$v_desü
['filename']."' does‚otƒxist");

1916  
PşZ
::
	`”rÜCode
();

1920 
$this
->
	`´ivC®cuÏ‹StÜedF’ame
(
$v_desü
, 
$p_İtiÚs
);

1923 
$v_»suÉ_li¡
[($v_»suÉ_li¡)] = 
$v_desü
;

1926 ià(
$v_desü
['type'] == 'folder') {

1928 
$v_dœli¡_desü
 = 
	`¬¿y
();

1929 
$v_dœli¡_nb
 = 0;

1930 ià(
$v_fŞd”_hªdËr
 = @
	`İ’dœ
(
$v_desü
['filename'])) {

1931 (
$v_™em_hªdËr
 = @
	`»addœ
(
$v_fŞd”_hªdËr
)è!=ğ
çl£
) {

1933 ià((
$v_™em_hªdËr
 == '.') || ($v_item_handler == '..')) {

1938 
$v_dœli¡_desü
[
$v_dœli¡_nb
]['f’ame'] = 
$v_desü
['f’ame'].'/'.
$v_™em_hªdËr
;

1943 ià((
$v_desü
['stored_filename'] != $v_descr['filename'])

1944 && (!
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_REMOVE_ALL_PATH
]))) {

1945 ià(
$v_desü
['stored_filename'] != '') {

1946 
$v_dœli¡_desü
[
$v_dœli¡_nb
]['Ãw_fuÎ_Çme'] = 
$v_desü
['¡Üed_f’ame'].'/'.
$v_™em_hªdËr
;

1948 
$v_dœli¡_desü
[
$v_dœli¡_nb
]['Ãw_fuÎ_Çme'] = 
$v_™em_hªdËr
;

1951 
$v_dœli¡_nb
++;

1954 @
	`şo£dœ
(
$v_fŞd”_hªdËr
);

1960 ià(
$v_dœli¡_nb
 != 0) {

1962 ià((
$v_»suÉ
 = 
$this
->
	`´ivFeDesüEx·nd
(
$v_dœli¡_desü
, 
$p_İtiÚs
)) != 1) {

1963  
$v_»suÉ
;

1967 
$v_»suÉ_li¡
 = 
	`¬¿y_m”ge
($v_»suÉ_li¡, 
$v_dœli¡_desü
);

1971 
	`un£t
(
$v_dœli¡_desü
);

1976 
$p_fedesü_li¡
 = 
$v_»suÉ_li¡
;

1979  
$v_»suÉ
;

1980 
	}
}

1989 
public
 
funùiÚ
 
	$´ivC»©e
(
$p_fedesü_li¡
, &
$p_»suÉ_li¡
, &
$p_İtiÚs
)

1991 
$v_»suÉ
=1;

1992 
$v_li¡_d‘a
 = 
	`¬¿y
();

1995 
$this
->
	`´ivDi§bËMagicQuÙes
();

1998 ià((
$v_»suÉ
 = 
$this
->
	`´ivO³nFd
('wb')) != 1) {

2000  
$v_»suÉ
;

2004 
$v_»suÉ
 = 
$this
->
	`´ivAddLi¡
(
$p_fedesü_li¡
, 
$p_»suÉ_li¡
, 
$p_İtiÚs
);

2007 
$this
->
	`´ivClo£Fd
();

2010 
$this
->
	`´ivSw­BackMagicQuÙes
();

2013  
$v_»suÉ
;

2014 
	}
}

2023 
public
 
funùiÚ
 
	$´ivAdd
(
$p_fedesü_li¡
, &
$p_»suÉ_li¡
, &
$p_İtiÚs
)

2025 
$v_»suÉ
=1;

2026 
$v_li¡_d‘a
 = 
	`¬¿y
();

2029 ià((!
	`is_fe
(
$this
->
zÇme
)è|| (
	`fesize
($this->zipname) == 0)) {

2031 
$v_»suÉ
 = 
$this
->
	`´ivC»©e
(
$p_fedesü_li¡
, 
$p_»suÉ_li¡
, 
$p_İtiÚs
);

2034  
$v_»suÉ
;

2037 
$this
->
	`´ivDi§bËMagicQuÙes
();

2040 ià((
$v_»suÉ
=
$this
->
	`´ivO³nFd
('rb')) != 1) {

2042 
$this
->
	`´ivSw­BackMagicQuÙes
();

2045  
$v_»suÉ
;

2049 
$v_ûÁ¿l_dœ
 = 
	`¬¿y
();

2050 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dEndC’Œ®Dœ
(
$v_ûÁ¿l_dœ
)) != 1) {

2051 
$this
->
	`´ivClo£Fd
();

2052 
$this
->
	`´ivSw­BackMagicQuÙes
();

2053  
$v_»suÉ
;

2057 @
	`»wšd
(
$this
->
z_fd
);

2060 
$v_z_‹mp_Çme
 = 
PCLZIP_TEMPORARY_DIR
.
	`uniqid
('pclzip-').'.tmp';

2063 ià((
$v_z_‹mp_fd
 = @
	`fİ’
(
$v_z_‹mp_Çme
, 'wb')) == 0) {

2064 
$this
->
	`´ivClo£Fd
();

2065 
$this
->
	`´ivSw­BackMagicQuÙes
();

2067 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, 'UÇbËØİ’empÜ¬y f\''.
$v_z_‹mp_Çme
.'\' in binary write mode');

2070  
PşZ
::
	`”rÜCode
();

2075 
$v_size
 = 
$v_ûÁ¿l_dœ
['offset'];

2076 
$v_size
 != 0) {

2077 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

2078 
$v_bufãr
 = 
	`ä—d
(
$this
->
z_fd
, 
$v_»ad_size
);

2079 @
	`fwr™e
(
$v_z_‹mp_fd
, 
$v_bufãr
, 
$v_»ad_size
);

2080 
$v_size
 -ğ
$v_»ad_size
;

2086 
$v_sw­
 = 
$this
->
z_fd
;

2087 
$this
->
z_fd
 = 
$v_z_‹mp_fd
;

2088 
$v_z_‹mp_fd
 = 
$v_sw­
;

2091 
$v_h—d”_li¡
 = 
	`¬¿y
();

2092 ià((
$v_»suÉ
 = 
$this
->
	`´ivAddFeLi¡
(
$p_fedesü_li¡
, 
$v_h—d”_li¡
, 
$p_İtiÚs
)) != 1) {

2093 
	`fşo£
(
$v_z_‹mp_fd
);

2094 
$this
->
	`´ivClo£Fd
();

2095 @
	`uÆšk
(
$v_z_‹mp_Çme
);

2096 
$this
->
	`´ivSw­BackMagicQuÙes
();

2099  
$v_»suÉ
;

2103 
$v_off£t
 = @
	`á–l
(
$this
->
z_fd
);

2106 
$v_size
 = 
$v_ûÁ¿l_dœ
['size'];

2107 
$v_size
 != 0) {

2108 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

2109 
$v_bufãr
 = @
	`ä—d
(
$v_z_‹mp_fd
, 
$v_»ad_size
);

2110 @
	`fwr™e
(
$this
->
z_fd
, 
$v_bufãr
, 
$v_»ad_size
);

2111 
$v_size
 -ğ
$v_»ad_size
;

2115 
$i
=0, 
$v_couÁ
=0; $i<(
$v_h—d”_li¡
); $i++) {

2117 ià(
$v_h—d”_li¡
[
$i
]['status'] == 'ok') {

2118 ià((
$v_»suÉ
 = 
$this
->
	`´ivWr™eC’Œ®FeH—d”
(
$v_h—d”_li¡
[
$i
])) != 1) {

2119 
	`fşo£
(
$v_z_‹mp_fd
);

2120 
$this
->
	`´ivClo£Fd
();

2121 @
	`uÆšk
(
$v_z_‹mp_Çme
);

2122 
$this
->
	`´ivSw­BackMagicQuÙes
();

2125  
$v_»suÉ
;

2127 
$v_couÁ
++;

2131 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$v_h—d”_li¡
[
$i
], 
$p_»suÉ_li¡
[$i]);

2135 
$v_comm’t
 = 
$v_ûÁ¿l_dœ
['comment'];

2136 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_COMMENT
])) {

2137 
$v_comm’t
 = 
$p_İtiÚs
[
PCLZIP_OPT_COMMENT
];

2139 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_ADD_COMMENT
])) {

2140 
$v_comm’t
 = $v_comm’t.
$p_İtiÚs
[
PCLZIP_OPT_ADD_COMMENT
];

2142 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_PREPEND_COMMENT
])) {

2143 
$v_comm’t
 = 
$p_İtiÚs
[
PCLZIP_OPT_PREPEND_COMMENT
].$v_comment;

2147 
$v_size
 = @
	`á–l
(
$this
->
z_fd
)-
$v_off£t
;

2150 ià((
$v_»suÉ
 = 
$this
->
	`´ivWr™eC’Œ®H—d”
(
$v_couÁ
+
$v_ûÁ¿l_dœ
['’Œ›s'], 
$v_size
, 
$v_off£t
, 
$v_comm’t
)) != 1) {

2152 
	`un£t
(
$v_h—d”_li¡
);

2153 
$this
->
	`´ivSw­BackMagicQuÙes
();

2156  
$v_»suÉ
;

2160 
$v_sw­
 = 
$this
->
z_fd
;

2161 
$this
->
z_fd
 = 
$v_z_‹mp_fd
;

2162 
$v_z_‹mp_fd
 = 
$v_sw­
;

2165 
$this
->
	`´ivClo£Fd
();

2168 @
	`fşo£
(
$v_z_‹mp_fd
);

2171 
$this
->
	`´ivSw­BackMagicQuÙes
();

2175 @
	`uÆšk
(
$this
->
zÇme
);

2180 
	`PşZUtR’ame
(
$v_z_‹mp_Çme
, 
$this
->
zÇme
);

2183  
$v_»suÉ
;

2184 
	}
}

2192 
public
 
funùiÚ
 
	$´ivO³nFd
(
$p_mode
)

2194 
$v_»suÉ
=1;

2197 ià(
$this
->
z_fd
 != 0) {

2199 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, 'Z f\''.
$this
->
zÇme
.'\'‡lready open');

2202  
PşZ
::
	`”rÜCode
();

2206 ià((
$this
->
z_fd
 = @
	`fİ’
($this->
zÇme
, 
$p_mode
)) == 0) {

2208 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, 'UÇbËØİ’‡rchiv\''.
$this
->
zÇme
.'\' iÀ'.
$p_mode
.' mode');

2211  
PşZ
::
	`”rÜCode
();

2215  
$v_»suÉ
;

2216 
	}
}

2224 
public
 
funùiÚ
 
	$´ivClo£Fd
()

2226 
$v_»suÉ
=1;

2228 ià(
$this
->
z_fd
 != 0) {

2229 @
	`fşo£
(
$this
->
z_fd
);

2231 
$this
->
z_fd
 = 0;

2234  
$v_»suÉ
;

2235 
	}
}

2252 
public
 
funùiÚ
 
	$´ivAddLi¡
(
$p_fedesü_li¡
, &
$p_»suÉ_li¡
, &
$p_İtiÚs
)

2254 
$v_»suÉ
=1;

2257 
$v_h—d”_li¡
 = 
	`¬¿y
();

2258 ià((
$v_»suÉ
 = 
$this
->
	`´ivAddFeLi¡
(
$p_fedesü_li¡
, 
$v_h—d”_li¡
, 
$p_İtiÚs
)) != 1) {

2260  
$v_»suÉ
;

2264 
$v_off£t
 = @
	`á–l
(
$this
->
z_fd
);

2267 
$i
=0, 
$v_couÁ
=0; $i<(
$v_h—d”_li¡
); $i++) {

2269 ià(
$v_h—d”_li¡
[
$i
]['status'] == 'ok') {

2270 ià((
$v_»suÉ
 = 
$this
->
	`´ivWr™eC’Œ®FeH—d”
(
$v_h—d”_li¡
[
$i
])) != 1) {

2272  
$v_»suÉ
;

2274 
$v_couÁ
++;

2278 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$v_h—d”_li¡
[
$i
], 
$p_»suÉ_li¡
[$i]);

2282 
$v_comm’t
 = '';

2283 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_COMMENT
])) {

2284 
$v_comm’t
 = 
$p_İtiÚs
[
PCLZIP_OPT_COMMENT
];

2288 
$v_size
 = @
	`á–l
(
$this
->
z_fd
)-
$v_off£t
;

2291 ià((
$v_»suÉ
 = 
$this
->
	`´ivWr™eC’Œ®H—d”
(
$v_couÁ
, 
$v_size
, 
$v_off£t
, 
$v_comm’t
)) != 1) {

2293 
	`un£t
(
$v_h—d”_li¡
);

2296  
$v_»suÉ
;

2300  
$v_»suÉ
;

2301 
	}
}

2313 
public
 
funùiÚ
 
	$´ivAddFeLi¡
(
$p_fedesü_li¡
, &
$p_»suÉ_li¡
, &
$p_İtiÚs
)

2315 
$v_»suÉ
=1;

2316 
$v_h—d”
 = 
	`¬¿y
();

2319 
$v_nb
 = (
$p_»suÉ_li¡
);

2322 
$j
=0; ($j<(
$p_fedesü_li¡
)è&& (
$v_»suÉ
==1); $j++) {

2324 
$p_fedesü_li¡
[
$j
]['f’ame'] = 
	`PşZUtT¿n¦©eWšP©h
($p_fedesü_li¡[$j]['f’ame'], 
çl£
);

2328 ià(
$p_fedesü_li¡
[
$j
]['filename'] == "") {

2333 ià((
$p_fedesü_li¡
[
$j
]['ty³'] !ğ'vœtu®_fe'è&& (!
	`fe_exi¡s
($p_filedescr_list[$j]['filename']))) {

2334 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_MISSING_FILE
, "F'".
$p_fedesü_li¡
[
$j
]['filename']."' does‚otƒxist");

2335  
PşZ
::
	`”rÜCode
();

2342 ià((
$p_fedesü_li¡
[
$j
]['ty³'] =ğ'fe'è|| ($p_fedesü_li¡[$j]['ty³'] =ğ'vœtu®_fe'è|| (($p_fedesü_li¡[$j]['ty³'] =ğ'fŞd”'è&& (!
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_REMOVE_ALL_PATH
]) || !$p_options[PCLZIP_OPT_REMOVE_ALL_PATH]))) {

2344 
$v_»suÉ
 = 
$this
->
	`´ivAddFe
(
$p_fedesü_li¡
[
$j
], 
$v_h—d”
, 
$p_İtiÚs
);

2345 ià(
$v_»suÉ
 != 1) {

2346  
$v_»suÉ
;

2350 
$p_»suÉ_li¡
[
$v_nb
++] = 
$v_h—d”
;

2355  
$v_»suÉ
;

2356 
	}
}

2365 
public
 
funùiÚ
 
	$´ivAddFe
(
$p_fedesü
, &
$p_h—d”
, &
$p_İtiÚs
)

2367 
$v_»suÉ
=1;

2370 
$p_f’ame
 = 
$p_fedesü
['filename'];

2373 ià(
$p_f’ame
 == "") {

2375 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_PARAMETER
, "Invalid file†ist…arameter (invalid orƒmpty†ist)");

2378  
PşZ
::
	`”rÜCode
();

2392 
	`ş—r¡©ÿche
();

2393 
$p_h—d”
['version'] = 20;

2394 
$p_h—d”
['version_extracted'] = 10;

2395 
$p_h—d”
['flag'] = 0;

2396 
$p_h—d”
['compression'] = 0;

2397 
$p_h—d”
['crc'] = 0;

2398 
$p_h—d”
['compressed_size'] = 0;

2399 
$p_h—d”
['f’ame_Ën'] = 
	`¡¾’
(
$p_f’ame
);

2400 
$p_h—d”
['extra_len'] = 0;

2401 
$p_h—d”
['disk'] = 0;

2402 
$p_h—d”
['internal'] = 0;

2403 
$p_h—d”
['offset'] = 0;

2404 
$p_h—d”
['f’ame'] = 
$p_f’ame
;

2406 
$p_h—d”
['¡Üed_f’ame'] = 
$p_fedesü
['stored_filename'];

2407 
$p_h—d”
['extra'] = '';

2408 
$p_h—d”
['status'] = 'ok';

2409 
$p_h—d”
['index'] = -1;

2412 ià(
$p_fedesü
['type']=='file') {

2413 
$p_h—d”
['external'] = 0x00000000;

2414 
$p_h—d”
['size'] = 
	`fesize
(
$p_f’ame
);

2415 } 
	`–£if
 (
$p_fedesü
['type']=='folder') {

2417 
$p_h—d”
['external'] = 0x00000010;

2418 
$p_h—d”
['mtime'] = 
	`femtime
(
$p_f’ame
);

2419 
$p_h—d”
['size'] = 
	`fesize
(
$p_f’ame
);

2420 } 
	`–£if
 (
$p_fedesü
['type'] == 'virtual_file') {

2422 
$p_h—d”
['external'] = 0x00000000;

2423 
$p_h—d”
['size'] = 
	`¡¾’
(
$p_fedesü
['content']);

2427 ià(
	`is£t
(
$p_fedesü
['mtime'])) {

2428 
$p_h—d”
['mtime'] = 
$p_fedesü
['mtime'];

2429 } 
	`–£if
 (
$p_fedesü
['type'] == 'virtual_file') {

2430 
$p_h—d”
['mtime'] = 
	`time
();

2432 
$p_h—d”
['mtime'] = 
	`femtime
(
$p_f’ame
);

2436 ià(
	`is£t
(
$p_fedesü
['comment'])) {

2437 
$p_h—d”
['comm’t_Ën'] = 
	`¡¾’
(
$p_fedesü
['comment']);

2438 
$p_h—d”
['comm’t'] = 
$p_fedesü
['comment'];

2440 
$p_h—d”
['comment_len'] = 0;

2441 
$p_h—d”
['comment'] = '';

2445 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_CB_PRE_ADD
])) {

2447 
$v_loÿl_h—d”
 = 
	`¬¿y
();

2448 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$p_h—d”
, 
$v_loÿl_h—d”
);

2454 
$v_»suÉ
 = 
$p_İtiÚs
[
PCLZIP_CB_PRE_ADD
](PCLZIP_CB_PRE_ADD, 
$v_loÿl_h—d”
);

2455 ià(
$v_»suÉ
 == 0) {

2457 
$p_h—d”
['status'] = "skipped";

2458 
$v_»suÉ
 = 1;

2463 ià(
$p_h—d”
['¡Üed_f’ame'] !ğ
$v_loÿl_h—d”
['stored_filename']) {

2464 
$p_h—d”
['¡Üed_f’ame'] = 
	`PşZUtP©hReduùiÚ
(
$v_loÿl_h—d”
['stored_filename']);

2469 ià(
$p_h—d”
['stored_filename'] == "") {

2470 
$p_h—d”
['status'] = "filtered";

2474 ià(
	`¡¾’
(
$p_h—d”
['stored_filename']) > 0xFF) {

2475 
$p_h—d”
['status'] = 'filename_too_long';

2479 ià(
$p_h—d”
['status'] == 'ok') {

2481 ià(
$p_fedesü
['type'] == 'file') {

2483 ià((!
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_TEMP_FILE_OFF
])è&& (is£t($p_İtiÚs[
PCLZIP_OPT_TEMP_FILE_ON
]è|| (is£t($p_İtiÚs[
PCLZIP_OPT_TEMP_FILE_THRESHOLD
]è&& ($p_İtiÚs[PCLZIP_OPT_TEMP_FILE_THRESHOLD] <ğ
$p_h—d”
['size'])))) {

2484 
$v_»suÉ
 = 
$this
->
	`´ivAddFeUsšgTempFe
(
$p_fedesü
, 
$p_h—d”
, 
$p_İtiÚs
);

2485 ià(
$v_»suÉ
 < 
PCLZIP_ERR_NO_ERROR
) {

2486  
$v_»suÉ
;

2491 ià((
$v_fe
 = @
	`fİ’
(
$p_f’ame
, "rb")) == 0) {

2492 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, "Unableo open file '$p_filename' in binary„ead mode");

2493  
PşZ
::
	`”rÜCode
();

2497 
$v_cÚ‹Á
 = @
	`ä—d
(
$v_fe
, 
$p_h—d”
['size']);

2500 @
	`fşo£
(
$v_fe
);

2503 
$p_h—d”
['üc'] = @
	`üc32
(
$v_cÚ‹Á
);

2506 ià(
$p_İtiÚs
[
PCLZIP_OPT_NO_COMPRESSION
]) {

2508 
$p_h—d”
['compressed_size'] = $p_header['size'];

2509 
$p_h—d”
['compression'] = 0;

2513 
$v_cÚ‹Á
 = @
	`gzdeæ©e
($v_content);

2516 
$p_h—d”
['com´es£d_size'] = 
	`¡¾’
(
$v_cÚ‹Á
);

2517 
$p_h—d”
['compression'] = 8;

2521 ià((
$v_»suÉ
 = 
$this
->
	`´ivWr™eFeH—d”
(
$p_h—d”
)) != 1) {

2522 @
	`fşo£
(
$v_fe
);

2523  
$v_»suÉ
;

2527 @
	`fwr™e
(
$this
->
z_fd
, 
$v_cÚ‹Á
, 
$p_h—d”
['compressed_size']);

2529 } 
	`–£if
 (
$p_fedesü
['type'] == 'virtual_file') {

2531 
$v_cÚ‹Á
 = 
$p_fedesü
['content'];

2534 
$p_h—d”
['üc'] = @
	`üc32
(
$v_cÚ‹Á
);

2537 ià(
$p_İtiÚs
[
PCLZIP_OPT_NO_COMPRESSION
]) {

2539 
$p_h—d”
['compressed_size'] = $p_header['size'];

2540 
$p_h—d”
['compression'] = 0;

2544 
$v_cÚ‹Á
 = @
	`gzdeæ©e
($v_content);

2547 
$p_h—d”
['com´es£d_size'] = 
	`¡¾’
(
$v_cÚ‹Á
);

2548 
$p_h—d”
['compression'] = 8;

2552 ià((
$v_»suÉ
 = 
$this
->
	`´ivWr™eFeH—d”
(
$p_h—d”
)) != 1) {

2553 @
	`fşo£
(
$v_fe
);

2554  
$v_»suÉ
;

2558 @
	`fwr™e
(
$this
->
z_fd
, 
$v_cÚ‹Á
, 
$p_h—d”
['compressed_size']);

2559 } 
	`–£if
 (
$p_fedesü
['type'] == 'folder') {

2562 ià(@
	`sub¡r
(
$p_h—d”
['stored_filename'], -1) != '/') {

2563 
$p_h—d”
['stored_filename'] .= '/';

2567 
$p_h—d”
['size'] = 0;

2569 
$p_h—d”
['external'] = 0x00000010;

2572 ià((
$v_»suÉ
 = 
$this
->
	`´ivWr™eFeH—d”
(
$p_h—d”
)) != 1) {

2573  
$v_»suÉ
;

2579 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_CB_POST_ADD
])) {

2581 
$v_loÿl_h—d”
 = 
	`¬¿y
();

2582 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$p_h—d”
, 
$v_loÿl_h—d”
);

2588 
$v_»suÉ
 = 
$p_İtiÚs
[
PCLZIP_CB_POST_ADD
](PCLZIP_CB_POST_ADD, 
$v_loÿl_h—d”
);

2589 ià(
$v_»suÉ
 == 0) {

2591 
$v_»suÉ
 = 1;

2599  
$v_»suÉ
;

2600 
	}
}

2609 
public
 
funùiÚ
 
	$´ivAddFeUsšgTempFe
(
$p_fedesü
, &
$p_h—d”
, &
$p_İtiÚs
)

2611 
$v_»suÉ
=
PCLZIP_ERR_NO_ERROR
;

2614 
$p_f’ame
 = 
$p_fedesü
['filename'];

2618 ià((
$v_fe
 = @
	`fİ’
(
$p_f’ame
, "rb")) == 0) {

2619 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, "Unableo open file '$p_filename' in binary„ead mode");

2620  
PşZ
::
	`”rÜCode
();

2624 
$v_gz_‹mp_Çme
 = 
PCLZIP_TEMPORARY_DIR
.
	`uniqid
('pclzip-').'.gz';

2625 ià((
$v_fe_com´es£d
 = @
	`gzİ’
(
$v_gz_‹mp_Çme
, "wb")) == 0) {

2626 
	`fşo£
(
$v_fe
);

2627 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_WRITE_OPEN_FAIL
, 'UÇbËØİ’empÜ¬y f\''.
$v_gz_‹mp_Çme
.'\' in binary write mode');

2628  
PşZ
::
	`”rÜCode
();

2632 
$v_size
 = 
	`fesize
(
$p_f’ame
);

2633 
$v_size
 != 0) {

2634 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

2635 
$v_bufãr
 = @
	`ä—d
(
$v_fe
, 
$v_»ad_size
);

2637 @
	`gzputs
(
$v_fe_com´es£d
, 
$v_bufãr
, 
$v_»ad_size
);

2638 
$v_size
 -ğ
$v_»ad_size
;

2642 @
	`fşo£
(
$v_fe
);

2643 @
	`gzşo£
(
$v_fe_com´es£d
);

2646 ià(
	`fesize
(
$v_gz_‹mp_Çme
) < 18) {

2647 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, 'gzempÜ¬y f\''.
$v_gz_‹mp_Çme
.'\' has invalid filesize - should be minimum 18 bytes');

2648  
PşZ
::
	`”rÜCode
();

2652 ià((
$v_fe_com´es£d
 = @
	`fİ’
(
$v_gz_‹mp_Çme
, "rb")) == 0) {

2653 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, 'UÇbËØİ’empÜ¬y f\''.
$v_gz_‹mp_Çme
.'\' in binary„ead mode');

2654  
PşZ
::
	`”rÜCode
();

2658 
$v_bš¬y_d©a
 = @
	`ä—d
(
$v_fe_com´es£d
, 10);

2659 
$v_d©a_h—d”
 = 
	`uÅack
('a1id1/a1id2/a1cm/a1æag/Vmtime/a1xæ/a1os', 
$v_bš¬y_d©a
);

2662 
$v_d©a_h—d”
['os'] = 
	`bš2hex
($v_data_header['os']);

2665 @
	`f£ek
(
$v_fe_com´es£d
, 
	`fesize
(
$v_gz_‹mp_Çme
)-8);

2666 
$v_bš¬y_d©a
 = @
	`ä—d
(
$v_fe_com´es£d
, 8);

2667 
$v_d©a_foÙ”
 = 
	`uÅack
('Vüc/Vcom´es£d_size', 
$v_bš¬y_d©a
);

2670 
$p_h—d”
['com´essiÚ'] = 
	`Üd
(
$v_d©a_h—d”
['cm']);

2672 
$p_h—d”
['üc'] = 
$v_d©a_foÙ”
['crc'];

2673 
$p_h—d”
['com´es£d_size'] = 
	`fesize
(
$v_gz_‹mp_Çme
)-18;

2676 @
	`fşo£
(
$v_fe_com´es£d
);

2679 ià((
$v_»suÉ
 = 
$this
->
	`´ivWr™eFeH—d”
(
$p_h—d”
)) != 1) {

2680  
$v_»suÉ
;

2684 ià((
$v_fe_com´es£d
 = @
	`fİ’
(
$v_gz_‹mp_Çme
, "rb")) == 0) {

2685 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, 'UÇbËØİ’empÜ¬y f\''.
$v_gz_‹mp_Çme
.'\' in binary„ead mode');

2686  
PşZ
::
	`”rÜCode
();

2690 
	`f£ek
(
$v_fe_com´es£d
, 10);

2691 
$v_size
 = 
$p_h—d”
['compressed_size'];

2692 
$v_size
 != 0) {

2693 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

2694 
$v_bufãr
 = @
	`ä—d
(
$v_fe_com´es£d
, 
$v_»ad_size
);

2696 @
	`fwr™e
(
$this
->
z_fd
, 
$v_bufãr
, 
$v_»ad_size
);

2697 
$v_size
 -ğ
$v_»ad_size
;

2701 @
	`fşo£
(
$v_fe_com´es£d
);

2704 @
	`uÆšk
(
$v_gz_‹mp_Çme
);

2707  
$v_»suÉ
;

2708 
	}
}

2719 
public
 
funùiÚ
 
	$´ivC®cuÏ‹StÜedF’ame
(&
$p_fedesü
, &
$p_İtiÚs
)

2721 
$v_»suÉ
=1;

2724 
$p_f’ame
 = 
$p_fedesü
['filename'];

2725 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_ADD_PATH
])) {

2726 
$p_add_dœ
 = 
$p_İtiÚs
[
PCLZIP_OPT_ADD_PATH
];

2728 
$p_add_dœ
 = '';

2730 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_REMOVE_PATH
])) {

2731 
$p_»move_dœ
 = 
$p_İtiÚs
[
PCLZIP_OPT_REMOVE_PATH
];

2733 
$p_»move_dœ
 = '';

2735 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_REMOVE_ALL_PATH
])) {

2736 
$p_»move_®l_dœ
 = 
$p_İtiÚs
[
PCLZIP_OPT_REMOVE_ALL_PATH
];

2738 
$p_»move_®l_dœ
 = 0;

2742 ià(
	`is£t
(
$p_fedesü
['new_full_name'])) {

2744 
$v_¡Üed_f’ame
 = 
	`PşZUtT¿n¦©eWšP©h
(
$p_fedesü
['new_full_name']);

2749 ià(
	`is£t
(
$p_fedesü
['new_short_name'])) {

2750 
$v_·th_šfo
 = 
	`·thšfo
(
$p_f’ame
);

2751 
$v_dœ
 = '';

2752 ià(
$v_·th_šfo
['dirname'] != '') {

2753 
$v_dœ
 = 
$v_·th_šfo
['dirname'].'/';

2755 
$v_¡Üed_f’ame
 = 
$v_dœ
.
$p_fedesü
['new_short_name'];

2758 
$v_¡Üed_f’ame
 = 
$p_f’ame
;

2762 ià(
$p_»move_®l_dœ
) {

2763 
$v_¡Üed_f’ame
 = 
	`ba£Çme
(
$p_f’ame
);

2764 } 
	`–£if
 (
$p_»move_dœ
 != "") {

2766 ià(
	`sub¡r
(
$p_»move_dœ
, -1) != '/') {

2767 
$p_»move_dœ
 .= "/";

2770 ià((
	`sub¡r
(
$p_f’ame
, 0, 2è=ğ"./"è|| (sub¡r(
$p_»move_dœ
, 0, 2) == "./")) {

2771 ià((
	`sub¡r
(
$p_f’ame
, 0, 2è=ğ"./"è&& (sub¡r(
$p_»move_dœ
, 0, 2) != "./")) {

2772 
$p_»move_dœ
 = "./".$p_remove_dir;

2774 ià((
	`sub¡r
(
$p_f’ame
, 0, 2è!ğ"./"è&& (sub¡r(
$p_»move_dœ
, 0, 2) == "./")) {

2775 
$p_»move_dœ
 = 
	`sub¡r
($p_remove_dir, 2);

2779 
$v_com·»
 = 
	`PşZUtP©hInşusiÚ
(
$p_»move_dœ
, 
$v_¡Üed_f’ame
);

2780 ià(
$v_com·»
 > 0) {

2781 ià(
$v_com·»
 == 2) {

2782 
$v_¡Üed_f’ame
 = "";

2784 
$v_¡Üed_f’ame
 = 
	`sub¡r
($v_¡Üed_f’ame, 
	`¡¾’
(
$p_»move_dœ
));

2790 
$v_¡Üed_f’ame
 = 
	`PşZUtT¿n¦©eWšP©h
($v_stored_filename);

2793 ià(
$p_add_dœ
 != "") {

2794 ià(
	`sub¡r
(
$p_add_dœ
, -1) == "/") {

2795 
$v_¡Üed_f’ame
 = 
$p_add_dœ
.$v_stored_filename;

2797 
$v_¡Üed_f’ame
 = 
$p_add_dœ
."/".$v_stored_filename;

2803 
$v_¡Üed_f’ame
 = 
	`PşZUtP©hReduùiÚ
($v_stored_filename);

2804 
$p_fedesü
['¡Üed_f’ame'] = 
$v_¡Üed_f’ame
;

2807  
$v_»suÉ
;

2808 
	}
}

2817 
public
 
funùiÚ
 
	$´ivWr™eFeH—d”
(&
$p_h—d”
)

2819 
$v_»suÉ
=1;

2822 
$p_h—d”
['off£t'] = 
	`á–l
(
$this
->
z_fd
);

2825 
$v_d©e
 = 
	`g‘d©e
(
$p_h—d”
['mtime']);

2826 
$v_mtime
 = (
$v_d©e
['hours']<<11) + ($v_date['minutes']<<5) + $v_date['seconds']/2;

2827 
$v_md©e
 = ((
$v_d©e
['year']-1980)<<9) + ($v_date['mon']<<5) + $v_date['mday'];

2830 
$v_bš¬y_d©a
 = 
	`·ck
("VvvvvvVVVvv", 0x04034b50, 
$p_h—d”
['v”siÚ_exŒaùed'], $p_h—d”['æag'], $p_h—d”['com´essiÚ'], 
$v_mtime
, 
$v_md©e
, $p_h—d”['üc'], $p_h—d”['com´es£d_size'], $p_h—d”['size'], 
	`¡¾’
($p_header['stored_filename']), $p_header['extra_len']);

2833 
	`åuts
(
$this
->
z_fd
, 
$v_bš¬y_d©a
, 30);

2836 ià(
	`¡¾’
(
$p_h—d”
['stored_filename']) != 0) {

2837 
	`åuts
(
$this
->
z_fd
, 
$p_h—d”
['¡Üed_f’ame'], 
	`¡¾’
($p_header['stored_filename']));

2839 ià(
$p_h—d”
['extra_len'] != 0) {

2840 
	`åuts
(
$this
->
z_fd
, 
$p_h—d”
['extra'], $p_header['extra_len']);

2844  
$v_»suÉ
;

2845 
	}
}

2854 
public
 
funùiÚ
 
	$´ivWr™eC’Œ®FeH—d”
(&
$p_h—d”
)

2856 
$v_»suÉ
=1;

2863 
$v_d©e
 = 
	`g‘d©e
(
$p_h—d”
['mtime']);

2864 
$v_mtime
 = (
$v_d©e
['hours']<<11) + ($v_date['minutes']<<5) + $v_date['seconds']/2;

2865 
$v_md©e
 = ((
$v_d©e
['year']-1980)<<9) + ($v_date['mon']<<5) + $v_date['mday'];

2869 
$v_bš¬y_d©a
 = 
	`·ck
("VvvvvvvVVVvvvvvVV", 0x02014b50, 
$p_h—d”
['v”siÚ'], $p_h—d”['v”siÚ_exŒaùed'], $p_h—d”['æag'], $p_h—d”['com´essiÚ'], 
$v_mtime
, 
$v_md©e
, $p_h—d”['üc'], $p_h—d”['com´es£d_size'], $p_h—d”['size'], 
	`¡¾’
($p_header['stored_filename']), $p_header['extra_len'], $p_header['comment_len'], $p_header['disk'], $p_header['internal'], $p_header['external'], $p_header['offset']);

2872 
	`åuts
(
$this
->
z_fd
, 
$v_bš¬y_d©a
, 46);

2875 ià(
	`¡¾’
(
$p_h—d”
['stored_filename']) != 0) {

2876 
	`åuts
(
$this
->
z_fd
, 
$p_h—d”
['¡Üed_f’ame'], 
	`¡¾’
($p_header['stored_filename']));

2878 ià(
$p_h—d”
['extra_len'] != 0) {

2879 
	`åuts
(
$this
->
z_fd
, 
$p_h—d”
['extra'], $p_header['extra_len']);

2881 ià(
$p_h—d”
['comment_len'] != 0) {

2882 
	`åuts
(
$this
->
z_fd
, 
$p_h—d”
['comment'], $p_header['comment_len']);

2886  
$v_»suÉ
;

2887 
	}
}

2896 
public
 
funùiÚ
 
	$´ivWr™eC’Œ®H—d”
(
$p_nb_’Œ›s
, 
$p_size
, 
$p_off£t
, 
$p_comm’t
)

2898 
$v_»suÉ
 = 1;

2901 
$v_bš¬y_d©a
 = 
	`·ck
("VvvvvVVv", 0x06054b50, 0, 0, 
$p_nb_’Œ›s
, $p_nb_’Œ›s, 
$p_size
, 
$p_off£t
, 
	`¡¾’
(
$p_comm’t
));

2904 
	`åuts
(
$this
->
z_fd
, 
$v_bš¬y_d©a
, 22);

2907 ià(
	`¡¾’
(
$p_comm’t
) != 0) {

2908 
	`åuts
(
$this
->
z_fd
, 
$p_comm’t
, 
	`¡¾’
($p_comment));

2912  
$v_»suÉ
;

2913 
	}
}

2922 
public
 
funùiÚ
 
	$´ivLi¡
(&
$p_li¡
)

2924 
$v_»suÉ
 = 1;

2927 
$this
->
	`´ivDi§bËMagicQuÙes
();

2930 ià((
$this
->
z_fd
 = @
	`fİ’
($this->
zÇme
, 'rb')) == 0) {

2932 
$this
->
	`´ivSw­BackMagicQuÙes
();

2935 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, 'UÇbËØİ’‡rchiv\''.
$this
->
zÇme
.'\' in binary„ead mode');

2938  
PşZ
::
	`”rÜCode
();

2942 
$v_ûÁ¿l_dœ
 = 
	`¬¿y
();

2943 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dEndC’Œ®Dœ
(
$v_ûÁ¿l_dœ
)) != 1) {

2944 
$this
->
	`´ivSw­BackMagicQuÙes
();

2945  
$v_»suÉ
;

2949 @
	`»wšd
(
$this
->
z_fd
);

2950 ià(@
	`f£ek
(
$this
->
z_fd
, 
$v_ûÁ¿l_dœ
['offset'])) {

2951 
$this
->
	`´ivSw­BackMagicQuÙes
();

2954 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ARCHIVE_ZIP
, 'Invalid‡rchive size');

2957  
PşZ
::
	`”rÜCode
();

2961 
$i
=0; $i<
$v_ûÁ¿l_dœ
['entries']; $i++) {

2963 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dC’Œ®FeH—d”
(
$v_h—d”
)) != 1) {

2964 
$this
->
	`´ivSw­BackMagicQuÙes
();

2965  
$v_»suÉ
;

2967 
$v_h—d”
['šdex'] = 
$i
;

2970 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$v_h—d”
, 
$p_li¡
[
$i
]);

2971 
	`un£t
(
$v_h—d”
);

2975 
$this
->
	`´ivClo£Fd
();

2978 
$this
->
	`´ivSw­BackMagicQuÙes
();

2981  
$v_»suÉ
;

2982 
	}
}

3004 
public
 
funùiÚ
 
	$´ivCÚv”tH—d”2FeInfo
(
$p_h—d”
, &
$p_šfo
)

3006 
$v_»suÉ
=1;

3009 
$v_‹mp_·th
 = 
	`PşZUtP©hReduùiÚ
(
$p_h—d”
['filename']);

3010 
$p_šfo
['f’ame'] = 
$v_‹mp_·th
;

3011 
$v_‹mp_·th
 = 
	`PşZUtP©hReduùiÚ
(
$p_h—d”
['stored_filename']);

3012 
$p_šfo
['¡Üed_f’ame'] = 
$v_‹mp_·th
;

3013 
$p_šfo
['size'] = 
$p_h—d”
['size'];

3014 
$p_šfo
['com´es£d_size'] = 
$p_h—d”
['compressed_size'];

3015 
$p_šfo
['mtime'] = 
$p_h—d”
['mtime'];

3016 
$p_šfo
['comm’t'] = 
$p_h—d”
['comment'];

3017 
$p_šfo
['fŞd”'] = ((
$p_h—d”
['external']&0x00000010)==0x00000010);

3018 
$p_šfo
['šdex'] = 
$p_h—d”
['index'];

3019 
$p_šfo
['¡©us'] = 
$p_h—d”
['status'];

3020 
$p_šfo
['üc'] = 
$p_h—d”
['crc'];

3023  
$v_»suÉ
;

3024 
	}
}

3043 
public
 
funùiÚ
 
	$´ivExŒaùByRuË
(&
$p_fe_li¡
, 
$p_·th
, 
$p_»move_·th
, 
$p_»move_®l_·th
, &
$p_İtiÚs
)

3045 
$v_»suÉ
=1;

3048 
$this
->
	`´ivDi§bËMagicQuÙes
();

3051 ià((
$p_·th
 =ğ""è|| ((
	`sub¡r
($p_path, 0, 1) != "/") && (substr($p_path, 0, 3) != "../") && (substr($p_path, 1, 2)!=":/"))) {

3052 
$p_·th
 = "./".$p_path;

3056 ià((
$p_·th
 != "./") && ($p_path != "/")) {

3058 
	`sub¡r
(
$p_·th
, -1) == "/") {

3059 
$p_·th
 = 
	`sub¡r
($p_·th, 0, 
	`¡¾’
($p_path)-1);

3064 ià((
$p_»move_·th
 !ğ""è&& (
	`sub¡r
($p_remove_path, -1) != '/')) {

3065 
$p_»move_·th
 .= '/';

3067 
$p_»move_·th_size
 = 
	`¡¾’
(
$p_»move_·th
);

3070 ià((
$v_»suÉ
 = 
$this
->
	`´ivO³nFd
('rb')) != 1) {

3071 
$this
->
	`´ivSw­BackMagicQuÙes
();

3072  
$v_»suÉ
;

3076 
$v_ûÁ¿l_dœ
 = 
	`¬¿y
();

3077 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dEndC’Œ®Dœ
(
$v_ûÁ¿l_dœ
)) != 1) {

3079 
$this
->
	`´ivClo£Fd
();

3080 
$this
->
	`´ivSw­BackMagicQuÙes
();

3082  
$v_»suÉ
;

3086 
$v_pos_’Œy
 = 
$v_ûÁ¿l_dœ
['offset'];

3089 
$j_¡¬t
 = 0;

3090 
$i
=0, 
$v_nb_exŒaùed
=0; $i<
$v_ûÁ¿l_dœ
['entries']; $i++) {

3092 @
	`»wšd
(
$this
->
z_fd
);

3093 ià(@
	`f£ek
(
$this
->
z_fd
, 
$v_pos_’Œy
)) {

3095 
$this
->
	`´ivClo£Fd
();

3096 
$this
->
	`´ivSw­BackMagicQuÙes
();

3099 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ARCHIVE_ZIP
, 'Invalid‡rchive size');

3102  
PşZ
::
	`”rÜCode
();

3106 
$v_h—d”
 = 
	`¬¿y
();

3107 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dC’Œ®FeH—d”
(
$v_h—d”
)) != 1) {

3109 
$this
->
	`´ivClo£Fd
();

3110 
$this
->
	`´ivSw­BackMagicQuÙes
();

3112  
$v_»suÉ
;

3116 
$v_h—d”
['šdex'] = 
$i
;

3119 
$v_pos_’Œy
 = 
	`á–l
(
$this
->
z_fd
);

3122 
$v_exŒaù
 = 
çl£
;

3125 ià((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
])) && ($p_options[PCLZIP_OPT_BY_NAME] != 0)) {

3127 
$j
=0; ($j<(
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
])è&& (!
$v_exŒaù
); $j++) {

3129 ià(
	`sub¡r
(
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
][
$j
], -1) == "/") {

3131 ià((
	`¡¾’
(
$v_h—d”
['¡Üed_f’ame']è> sŒËn(
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
][
$j
])è&& (
	`sub¡r
($v_header['stored_filename'], 0, strlen($p_options[PCLZIP_OPT_BY_NAME][$j])) == $p_options[PCLZIP_OPT_BY_NAME][$j])) {

3132 
$v_exŒaù
 = 
Œue
;

3134 } 
	`–£if
 (
$v_h—d”
['¡Üed_f’ame'] =ğ
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
][
$j
]) {

3136 
$v_exŒaù
 = 
Œue
;

3139 } 
	`–£if
 ((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_BY_PREG
])) && ($p_options[PCLZIP_OPT_BY_PREG] != "")) {

3141 ià(
	`´eg_m©ch
(
$p_İtiÚs
[
PCLZIP_OPT_BY_PREG
], 
$v_h—d”
['stored_filename'])) {

3142 
$v_exŒaù
 = 
Œue
;

3144 } 
	`–£if
 ((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_BY_INDEX
])) && ($p_options[PCLZIP_OPT_BY_INDEX] != 0)) {

3147 
$j
=
$j_¡¬t
; ($j<(
$p_İtiÚs
[
PCLZIP_OPT_BY_INDEX
])è&& (!
$v_exŒaù
); $j++) {

3148 ià((
$i
>=
$p_İtiÚs
[
PCLZIP_OPT_BY_INDEX
][
$j
]['start']) && ($i<=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end'])) {

3149 
$v_exŒaù
 = 
Œue
;

3151 ià(
$i
>=
$p_İtiÚs
[
PCLZIP_OPT_BY_INDEX
][
$j
]['end']) {

3152 
$j_¡¬t
 = 
$j
+1;

3155 ià(
$p_İtiÚs
[
PCLZIP_OPT_BY_INDEX
][
$j
]['¡¬t']>
$i
) {

3161 
$v_exŒaù
 = 
Œue
;

3165 ià((
$v_exŒaù
è&& ((
$v_h—d”
['compression'] != 8) && ($v_header['compression'] != 0))) {

3166 
$v_h—d”
['status'] = 'unsupported_compression';

3169 ià((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_STOP_ON_ERROR
])è&& ($p_İtiÚs[PCLZIP_OPT_STOP_ON_ERROR] ==ğ
Œue
)) {

3170 
$this
->
	`´ivSw­BackMagicQuÙes
();

3172 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_UNSUPPORTED_COMPRESSION
, "F’am'".
$v_h—d”
['stored_filename']."' is compressed by‡n unsupported compression method (".$v_header['compression'].") ");

3174  
PşZ
::
	`”rÜCode
();

3179 ià((
$v_exŒaù
è&& ((
$v_h—d”
['flag'] & 1) == 1)) {

3180 
$v_h—d”
['status'] = 'unsupported_encryption';

3182 ià((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_STOP_ON_ERROR
])è&& ($p_İtiÚs[PCLZIP_OPT_STOP_ON_ERROR] ==ğ
Œue
)) {

3183 
$this
->
	`´ivSw­BackMagicQuÙes
();

3185 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_UNSUPPORTED_ENCRYPTION
, "UnsuµÜ‹dƒnüy±iÚ fÜ f’am'".
$v_h—d”
['stored_filename']."'");

3187  
PşZ
::
	`”rÜCode
();

3192 ià((
$v_exŒaù
è&& (
$v_h—d”
['status'] != 'ok')) {

3193 
$v_»suÉ
 = 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$v_h—d”
, 
$p_fe_li¡
[
$v_nb_exŒaùed
++]);

3194 ià(
$v_»suÉ
 != 1) {

3195 
$this
->
	`´ivClo£Fd
();

3196 
$this
->
	`´ivSw­BackMagicQuÙes
();

3197  
$v_»suÉ
;

3200 
$v_exŒaù
 = 
çl£
;

3204 ià(
$v_exŒaù
) {

3206 @
	`»wšd
(
$this
->
z_fd
);

3207 ià(@
	`f£ek
(
$this
->
z_fd
, 
$v_h—d”
['offset'])) {

3209 
$this
->
	`´ivClo£Fd
();

3211 
$this
->
	`´ivSw­BackMagicQuÙes
();

3214 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ARCHIVE_ZIP
, 'Invalid‡rchive size');

3217  
PşZ
::
	`”rÜCode
();

3221 ià(
$p_İtiÚs
[
PCLZIP_OPT_EXTRACT_AS_STRING
]) {

3222 
$v_¡ršg
 = '';

3225 
$v_»suÉ1
 = 
$this
->
	`´ivExŒaùFeAsSŒšg
(
$v_h—d”
, 
$v_¡ršg
, 
$p_İtiÚs
);

3226 ià(
$v_»suÉ1
 < 1) {

3227 
$this
->
	`´ivClo£Fd
();

3228 
$this
->
	`´ivSw­BackMagicQuÙes
();

3229  
$v_»suÉ1
;

3233 ià((
$v_»suÉ
 = 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$v_h—d”
, 
$p_fe_li¡
[
$v_nb_exŒaùed
])) != 1) {

3235 
$this
->
	`´ivClo£Fd
();

3236 
$this
->
	`´ivSw­BackMagicQuÙes
();

3238  
$v_»suÉ
;

3242 
$p_fe_li¡
[
$v_nb_exŒaùed
]['cÚ‹Á'] = 
$v_¡ršg
;

3245 
$v_nb_exŒaùed
++;

3248 ià(
$v_»suÉ1
 == 2) {

3251 } 
	`–£if
 ((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_EXTRACT_IN_OUTPUT
])) && ($p_options[PCLZIP_OPT_EXTRACT_IN_OUTPUT])) {

3254 
$v_»suÉ1
 = 
$this
->
	`´ivExŒaùFeInOuut
(
$v_h—d”
, 
$p_İtiÚs
);

3255 ià(
$v_»suÉ1
 < 1) {

3256 
$this
->
	`´ivClo£Fd
();

3257 
$this
->
	`´ivSw­BackMagicQuÙes
();

3258  
$v_»suÉ1
;

3262 ià((
$v_»suÉ
 = 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$v_h—d”
, 
$p_fe_li¡
[
$v_nb_exŒaùed
++])) != 1) {

3263 
$this
->
	`´ivClo£Fd
();

3264 
$this
->
	`´ivSw­BackMagicQuÙes
();

3265  
$v_»suÉ
;

3269 ià(
$v_»suÉ1
 == 2) {

3275 
$v_»suÉ1
 = 
$this
->
	`´ivExŒaùFe
(
$v_h—d”
, 
$p_·th
, 
$p_»move_·th
, 
$p_»move_®l_·th
, 
$p_İtiÚs
);

3276 ià(
$v_»suÉ1
 < 1) {

3277 
$this
->
	`´ivClo£Fd
();

3278 
$this
->
	`´ivSw­BackMagicQuÙes
();

3279  
$v_»suÉ1
;

3283 ià((
$v_»suÉ
 = 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$v_h—d”
, 
$p_fe_li¡
[
$v_nb_exŒaùed
++])) != 1) {

3285 
$this
->
	`´ivClo£Fd
();

3286 
$this
->
	`´ivSw­BackMagicQuÙes
();

3288  
$v_»suÉ
;

3292 ià(
$v_»suÉ1
 == 2) {

3300 
$this
->
	`´ivClo£Fd
();

3301 
$this
->
	`´ivSw­BackMagicQuÙes
();

3304  
$v_»suÉ
;

3305 
	}
}

3317 
public
 
funùiÚ
 
	$´ivExŒaùFe
(&
$p_’Œy
, 
$p_·th
, 
$p_»move_·th
, 
$p_»move_®l_·th
, &
$p_İtiÚs
)

3319 
$v_»suÉ
=1;

3322 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dFeH—d”
(
$v_h—d”
)) != 1) {

3324  
$v_»suÉ
;

3329 ià(
$this
->
	`´ivCheckFeH—d”s
(
$v_h—d”
, 
$p_’Œy
) != 1) {

3334 ià(
$p_»move_®l_·th
 =ğ
Œue
) {

3336 ià((
$p_’Œy
['external']&0x00000010)==0x00000010) {

3337 
$p_’Œy
['status'] = "filtered";

3339  
$v_»suÉ
;

3343 
$p_’Œy
['f’ame'] = 
	`ba£Çme
($p_entry['filename']);

3344 } 
	`–£if
 (
$p_»move_·th
 != "") {

3346 ià(
	`PşZUtP©hInşusiÚ
(
$p_»move_·th
, 
$p_’Œy
['filename']) == 2) {

3348 
$p_’Œy
['status'] = "filtered";

3351  
$v_»suÉ
;

3354 
$p_»move_·th_size
 = 
	`¡¾’
(
$p_»move_·th
);

3355 ià(
	`sub¡r
(
$p_’Œy
['f’ame'], 0, 
$p_»move_·th_size
è=ğ
$p_»move_·th
) {

3357 
$p_’Œy
['f’ame'] = 
	`sub¡r
($p_’Œy['f’ame'], 
$p_»move_·th_size
);

3362 ià(
$p_·th
 != '') {

3363 
$p_’Œy
['f’ame'] = 
$p_·th
."/".$p_entry['filename'];

3367 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_EXTRACT_DIR_RESTRICTION
])) {

3368 
$v_šşusiÚ
 = 
	`PşZUtP©hInşusiÚ
(
$p_İtiÚs
[
PCLZIP_OPT_EXTRACT_DIR_RESTRICTION
], 
$p_’Œy
['filename']);

3369 ià(
$v_šşusiÚ
 == 0) {

3370 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_DIRECTORY_RESTRICTION
, "F’am'".
$p_’Œy
['filename']."' is outside PCLZIP_OPT_EXTRACT_DIR_RESTRICTION");

3372  
PşZ
::
	`”rÜCode
();

3377 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_CB_PRE_EXTRACT
])) {

3379 
$v_loÿl_h—d”
 = 
	`¬¿y
();

3380 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$p_’Œy
, 
$v_loÿl_h—d”
);

3386 
$v_»suÉ
 = 
$p_İtiÚs
[
PCLZIP_CB_PRE_EXTRACT
](PCLZIP_CB_PRE_EXTRACT, 
$v_loÿl_h—d”
);

3387 ià(
$v_»suÉ
 == 0) {

3389 
$p_’Œy
['status'] = "skipped";

3390 
$v_»suÉ
 = 1;

3394 ià(
$v_»suÉ
 == 2) {

3396 
$p_’Œy
['status'] = "aborted";

3397 
$v_»suÉ
 = 
PCLZIP_ERR_USER_ABORTED
;

3402 
$p_’Œy
['f’ame'] = 
$v_loÿl_h—d”
['filename'];

3406 ià(
$p_’Œy
['status'] == 'ok') {

3408 ià(
	`fe_exi¡s
(
$p_’Œy
['filename'])) {

3410 ià(
	`is_dœ
(
$p_’Œy
['filename'])) {

3412 
$p_’Œy
['status'] = "already_a_directory";

3417 ià((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_STOP_ON_ERROR
])è&& ($p_İtiÚs[PCLZIP_OPT_STOP_ON_ERROR]===
Œue
)) {

3418 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_ALREADY_A_DIRECTORY
, "F’am'".
$p_’Œy
['filename']."' is‡lready used by‡nƒxisting directory");

3419  
PşZ
::
	`”rÜCode
();

3421 } 
	`–£if
 (!
	`is_wr™—bË
(
$p_’Œy
['filename'])) {

3424 
$p_’Œy
['status'] = "write_protected";

3429 ià((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_STOP_ON_ERROR
])è&& ($p_İtiÚs[PCLZIP_OPT_STOP_ON_ERROR] ==ğ
Œue
)) {

3430 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_WRITE_OPEN_FAIL
, "F’am'".
$p_’Œy
['filename']."'ƒxists‡nd is write…rotected");

3431  
PşZ
::
	`”rÜCode
();

3433 } 
	`–£if
 (
	`femtime
(
$p_’Œy
['filename']) > $p_entry['mtime']) {

3436 ià((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_REPLACE_NEWER
])è&& ($p_İtiÚs[PCLZIP_OPT_REPLACE_NEWER] ==ğ
Œue
)) {

3438 
$p_’Œy
['status'] = "newer_exist";

3443 ià((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_STOP_ON_ERROR
])è&& ($p_İtiÚs[PCLZIP_OPT_STOP_ON_ERROR] ==ğ
Œue
)) {

3444 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_WRITE_OPEN_FAIL
, "New” v”siÚ oà'".
$p_’Œy
['filename']."'ƒxists‡nd option PCLZIP_OPT_REPLACE_NEWER is‚ot selected");

3445  
PşZ
::
	`”rÜCode
();

3452 ià(((
$p_’Œy
['ex‹º®']&0x00000010)==0x00000010è|| (
	`sub¡r
($p_entry['filename'], -1) == '/')) {

3453 
$v_dœ_to_check
 = 
$p_’Œy
['filename'];

3454 } 
	`–£if
 (!
	`¡r¡r
(
$p_’Œy
['filename'], "/")) {

3455 
$v_dœ_to_check
 = "";

3457 
$v_dœ_to_check
 = 
	`dœÇme
(
$p_’Œy
['filename']);

3460 ià((
$v_»suÉ
 = 
$this
->
	`´ivDœCheck
(
$v_dœ_to_check
, ((
$p_’Œy
['external']&0x00000010)==0x00000010))) != 1) {

3462 
$p_’Œy
['status'] = "path_creation_fail";

3466 
$v_»suÉ
 = 1;

3472 ià(
$p_’Œy
['status'] == 'ok') {

3474 ià(!((
$p_’Œy
['external']&0x00000010) == 0x00000010)) {

3476 ià(
$p_’Œy
['compression'] == 0) {

3478 ià((
$v_de¡_fe
 = @
	`fİ’
(
$p_’Œy
['filename'], 'wb')) == 0) {

3480 
$p_’Œy
['status'] = "write_error";

3483  
$v_»suÉ
;

3487 
$v_size
 = 
$p_’Œy
['compressed_size'];

3488 
$v_size
 != 0) {

3489 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

3490 
$v_bufãr
 = @
	`ä—d
(
$this
->
z_fd
, 
$v_»ad_size
);

3495 @
	`fwr™e
(
$v_de¡_fe
, 
$v_bufãr
, 
$v_»ad_size
);

3496 
$v_size
 -ğ
$v_»ad_size
;

3500 
	`fşo£
(
$v_de¡_fe
);

3503 
	`touch
(
$p_’Œy
['filename'], $p_entry['mtime']);

3507 ià((
$p_’Œy
['flag'] & 1) == 1) {

3508 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_UNSUPPORTED_ENCRYPTION
, 'F\''.
$p_’Œy
['filename'].'\' isƒncrypted. Encrypted files‡re‚ot supported.');

3509  
PşZ
::
	`”rÜCode
();

3513 ià((!
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_TEMP_FILE_OFF
])è&& (is£t($p_İtiÚs[
PCLZIP_OPT_TEMP_FILE_ON
]è|| (is£t($p_İtiÚs[
PCLZIP_OPT_TEMP_FILE_THRESHOLD
]è&& ($p_İtiÚs[PCLZIP_OPT_TEMP_FILE_THRESHOLD] <ğ
$p_’Œy
['size'])))) {

3514 
$v_»suÉ
 = 
$this
->
	`´ivExŒaùFeUsšgTempFe
(
$p_’Œy
, 
$p_İtiÚs
);

3515 ià(
$v_»suÉ
 < 
PCLZIP_ERR_NO_ERROR
) {

3516  
$v_»suÉ
;

3521 
$v_bufãr
 = @
	`ä—d
(
$this
->
z_fd
, 
$p_’Œy
['compressed_size']);

3524 
$v_fe_cÚ‹Á
 = @
	`gzšæ©e
(
$v_bufãr
);

3525 
	`un£t
(
$v_bufãr
);

3526 ià(
$v_fe_cÚ‹Á
 ==ğ
çl£
) {

3529 
$p_’Œy
['status'] = "error";

3531  
$v_»suÉ
;

3535 ià((
$v_de¡_fe
 = @
	`fİ’
(
$p_’Œy
['filename'], 'wb')) == 0) {

3537 
$p_’Œy
['status'] = "write_error";

3539  
$v_»suÉ
;

3543 @
	`fwr™e
(
$v_de¡_fe
, 
$v_fe_cÚ‹Á
, 
$p_’Œy
['size']);

3544 
	`un£t
(
$v_fe_cÚ‹Á
);

3547 @
	`fşo£
(
$v_de¡_fe
);

3551 @
	`touch
(
$p_’Œy
['filename'], $p_entry['mtime']);

3555 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_SET_CHMOD
])) {

3557 @
	`chmod
(
$p_’Œy
['f’ame'], 
$p_İtiÚs
[
PCLZIP_OPT_SET_CHMOD
]);

3563 ià(
$p_’Œy
['status'] == "aborted") {

3564 
$p_’Œy
['status'] = "skipped";

3565 } 
	`–£if
 (
	`is£t
(
$p_İtiÚs
[
PCLZIP_CB_POST_EXTRACT
])) {

3568 
$v_loÿl_h—d”
 = 
	`¬¿y
();

3569 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$p_’Œy
, 
$v_loÿl_h—d”
);

3575 
$v_»suÉ
 = 
$p_İtiÚs
[
PCLZIP_CB_POST_EXTRACT
](PCLZIP_CB_POST_EXTRACT, 
$v_loÿl_h—d”
);

3578 ià(
$v_»suÉ
 == 2) {

3579 
$v_»suÉ
 = 
PCLZIP_ERR_USER_ABORTED
;

3584  
$v_»suÉ
;

3585 
	}
}

3594 
public
 
funùiÚ
 
	$´ivExŒaùFeUsšgTempFe
(&
$p_’Œy
, &
$p_İtiÚs
)

3596 
$v_»suÉ
=1;

3599 
$v_gz_‹mp_Çme
 = 
PCLZIP_TEMPORARY_DIR
.
	`uniqid
('pclzip-').'.gz';

3600 ià((
$v_de¡_fe
 = @
	`fİ’
(
$v_gz_‹mp_Çme
, "wb")) == 0) {

3601 
	`fşo£
(
$v_fe
);

3602 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_WRITE_OPEN_FAIL
, 'UÇbËØİ’empÜ¬y f\''.
$v_gz_‹mp_Çme
.'\' in binary write mode');

3603  
PşZ
::
	`”rÜCode
();

3607 
$v_bš¬y_d©a
 = 
	`·ck
('va1a1Va1a1', 0x8b1f, 
	`Chr
(
$p_’Œy
['com´essiÚ']), Chr(0x00), 
	`time
(), Chr(0x00), Chr(3));

3608 @
	`fwr™e
(
$v_de¡_fe
, 
$v_bš¬y_d©a
, 10);

3611 
$v_size
 = 
$p_’Œy
['compressed_size'];

3612 
$v_size
 != 0) {

3613 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

3614 
$v_bufãr
 = @
	`ä—d
(
$this
->
z_fd
, 
$v_»ad_size
);

3616 @
	`fwr™e
(
$v_de¡_fe
, 
$v_bufãr
, 
$v_»ad_size
);

3617 
$v_size
 -ğ
$v_»ad_size
;

3621 
$v_bš¬y_d©a
 = 
	`·ck
('VV', 
$p_’Œy
['crc'], $p_entry['size']);

3622 @
	`fwr™e
(
$v_de¡_fe
, 
$v_bš¬y_d©a
, 8);

3625 @
	`fşo£
(
$v_de¡_fe
);

3628 ià((
$v_de¡_fe
 = @
	`fİ’
(
$p_’Œy
['filename'], 'wb')) == 0) {

3629 
$p_’Œy
['status'] = "write_error";

3630  
$v_»suÉ
;

3634 ià((
$v_¤c_fe
 = @
	`gzİ’
(
$v_gz_‹mp_Çme
, 'rb')) == 0) {

3635 @
	`fşo£
(
$v_de¡_fe
);

3636 
$p_’Œy
['status'] = "read_error";

3637 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, 'UÇbËØİ’empÜ¬y f\''.
$v_gz_‹mp_Çme
.'\' in binary„ead mode');

3638  
PşZ
::
	`”rÜCode
();

3642 
$v_size
 = 
$p_’Œy
['size'];

3643 
$v_size
 != 0) {

3644 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

3645 
$v_bufãr
 = @
	`gz»ad
(
$v_¤c_fe
, 
$v_»ad_size
);

3647 @
	`fwr™e
(
$v_de¡_fe
, 
$v_bufãr
, 
$v_»ad_size
);

3648 
$v_size
 -ğ
$v_»ad_size
;

3650 @
	`fşo£
(
$v_de¡_fe
);

3651 @
	`gzşo£
(
$v_¤c_fe
);

3654 @
	`uÆšk
(
$v_gz_‹mp_Çme
);

3657  
$v_»suÉ
;

3658 
	}
}

3667 
public
 
funùiÚ
 
	$´ivExŒaùFeInOuut
(&
$p_’Œy
, &
$p_İtiÚs
)

3669 
$v_»suÉ
=1;

3672 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dFeH—d”
(
$v_h—d”
)) != 1) {

3673  
$v_»suÉ
;

3677 ià(
$this
->
	`´ivCheckFeH—d”s
(
$v_h—d”
, 
$p_’Œy
) != 1) {

3682 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_CB_PRE_EXTRACT
])) {

3684 
$v_loÿl_h—d”
 = 
	`¬¿y
();

3685 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$p_’Œy
, 
$v_loÿl_h—d”
);

3691 
$v_»suÉ
 = 
$p_İtiÚs
[
PCLZIP_CB_PRE_EXTRACT
](PCLZIP_CB_PRE_EXTRACT, 
$v_loÿl_h—d”
);

3692 ià(
$v_»suÉ
 == 0) {

3694 
$p_’Œy
['status'] = "skipped";

3695 
$v_»suÉ
 = 1;

3699 ià(
$v_»suÉ
 == 2) {

3701 
$p_’Œy
['status'] = "aborted";

3702 
$v_»suÉ
 = 
PCLZIP_ERR_USER_ABORTED
;

3707 
$p_’Œy
['f’ame'] = 
$v_loÿl_h—d”
['filename'];

3713 ià(
$p_’Œy
['status'] == 'ok') {

3715 ià(!((
$p_’Œy
['external']&0x00000010)==0x00000010)) {

3717 ià(
$p_’Œy
['compressed_size'] == $p_entry['size']) {

3719 
$v_bufãr
 = @
	`ä—d
(
$this
->
z_fd
, 
$p_’Œy
['compressed_size']);

3722 
echo
 
$v_bufãr
;

3723 
	`un£t
(
$v_bufãr
);

3726 
$v_bufãr
 = @
	`ä—d
(
$this
->
z_fd
, 
$p_’Œy
['compressed_size']);

3729 
$v_fe_cÚ‹Á
 = 
	`gzšæ©e
(
$v_bufãr
);

3730 
	`un£t
(
$v_bufãr
);

3733 
echo
 
$v_fe_cÚ‹Á
;

3734 
	`un£t
(
$v_fe_cÚ‹Á
);

3740 ià(
$p_’Œy
['status'] == "aborted") {

3741 
$p_’Œy
['status'] = "skipped";

3742 } 
	`–£if
 (
	`is£t
(
$p_İtiÚs
[
PCLZIP_CB_POST_EXTRACT
])) {

3746 
$v_loÿl_h—d”
 = 
	`¬¿y
();

3747 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$p_’Œy
, 
$v_loÿl_h—d”
);

3753 
$v_»suÉ
 = 
$p_İtiÚs
[
PCLZIP_CB_POST_EXTRACT
](PCLZIP_CB_POST_EXTRACT, 
$v_loÿl_h—d”
);

3756 ià(
$v_»suÉ
 == 2) {

3757 
$v_»suÉ
 = 
PCLZIP_ERR_USER_ABORTED
;

3761  
$v_»suÉ
;

3762 
	}
}

3771 
public
 
funùiÚ
 
	$´ivExŒaùFeAsSŒšg
(&
$p_’Œy
, &
$p_¡ršg
, &
$p_İtiÚs
)

3773 
$v_»suÉ
=1;

3776 
$v_h—d”
 = 
	`¬¿y
();

3777 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dFeH—d”
(
$v_h—d”
)) != 1) {

3779  
$v_»suÉ
;

3783 ià(
$this
->
	`´ivCheckFeH—d”s
(
$v_h—d”
, 
$p_’Œy
) != 1) {

3788 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_CB_PRE_EXTRACT
])) {

3790 
$v_loÿl_h—d”
 = 
	`¬¿y
();

3791 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$p_’Œy
, 
$v_loÿl_h—d”
);

3797 
$v_»suÉ
 = 
$p_İtiÚs
[
PCLZIP_CB_PRE_EXTRACT
](PCLZIP_CB_PRE_EXTRACT, 
$v_loÿl_h—d”
);

3798 ià(
$v_»suÉ
 == 0) {

3800 
$p_’Œy
['status'] = "skipped";

3801 
$v_»suÉ
 = 1;

3805 ià(
$v_»suÉ
 == 2) {

3807 
$p_’Œy
['status'] = "aborted";

3808 
$v_»suÉ
 = 
PCLZIP_ERR_USER_ABORTED
;

3813 
$p_’Œy
['f’ame'] = 
$v_loÿl_h—d”
['filename'];

3817 ià(
$p_’Œy
['status'] == 'ok') {

3819 ià(!((
$p_’Œy
['external']&0x00000010)==0x00000010)) {

3822 ià(
$p_’Œy
['compression'] == 0) {

3824 
$p_¡ršg
 = @
	`ä—d
(
$this
->
z_fd
, 
$p_’Œy
['compressed_size']);

3827 
$v_d©a
 = @
	`ä—d
(
$this
->
z_fd
, 
$p_’Œy
['compressed_size']);

3830 ià((
$p_¡ršg
 = @
	`gzšæ©e
(
$v_d©a
)è==ğ
çl£
) {

3841 ià(
$p_’Œy
['status'] == "aborted") {

3842 
$p_’Œy
['status'] = "skipped";

3843 } 
	`–£if
 (
	`is£t
(
$p_İtiÚs
[
PCLZIP_CB_POST_EXTRACT
])) {

3846 
$v_loÿl_h—d”
 = 
	`¬¿y
();

3847 
$this
->
	`´ivCÚv”tH—d”2FeInfo
(
$p_’Œy
, 
$v_loÿl_h—d”
);

3850 
$v_loÿl_h—d”
['cÚ‹Á'] = 
$p_¡ršg
;

3851 
$p_¡ršg
 = '';

3857 
$v_»suÉ
 = 
$p_İtiÚs
[
PCLZIP_CB_POST_EXTRACT
](PCLZIP_CB_POST_EXTRACT, 
$v_loÿl_h—d”
);

3860 
$p_¡ršg
 = 
$v_loÿl_h—d”
['content'];

3861 
	`un£t
(
$v_loÿl_h—d”
['content']);

3864 ià(
$v_»suÉ
 == 2) {

3865 
$v_»suÉ
 = 
PCLZIP_ERR_USER_ABORTED
;

3870  
$v_»suÉ
;

3871 
	}
}

3880 
public
 
funùiÚ
 
	$´ivR—dFeH—d”
(&
$p_h—d”
)

3882 
$v_»suÉ
=1;

3885 
$v_bš¬y_d©a
 = @
	`ä—d
(
$this
->
z_fd
, 4);

3886 
$v_d©a
 = 
	`uÅack
('Vid', 
$v_bš¬y_d©a
);

3889 ià(
$v_d©a
['id'] != 0x04034b50) {

3891 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, 'Invalid‡rchive structure');

3894  
PşZ
::
	`”rÜCode
();

3898 
$v_bš¬y_d©a
 = 
	`ä—d
(
$this
->
z_fd
, 26);

3901 ià(
	`¡¾’
(
$v_bš¬y_d©a
) != 26) {

3902 
$p_h—d”
['filename'] = "";

3903 
$p_h—d”
['status'] = "invalid_header";

3906 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, "Inv®id block siz: ".
	`¡¾’
(
$v_bš¬y_d©a
));

3909  
PşZ
::
	`”rÜCode
();

3913 
$v_d©a
 = 
	`uÅack
('vv”siÚ/væag/vcom´essiÚ/vmtime/vmd©e/Vüc/Vcom´es£d_size/Vsize/vf’ame_Ën/vexŒa_Ën', 
$v_bš¬y_d©a
);

3916 
$p_h—d”
['f’ame'] = 
	`ä—d
(
$this
->
z_fd
, 
$v_d©a
['filename_len']);

3919 ià(
$v_d©a
['extra_len'] != 0) {

3920 
$p_h—d”
['exŒa'] = 
	`ä—d
(
$this
->
z_fd
, 
$v_d©a
['extra_len']);

3922 
$p_h—d”
['extra'] = '';

3926 
$p_h—d”
['v”siÚ_exŒaùed'] = 
$v_d©a
['version'];

3927 
$p_h—d”
['com´essiÚ'] = 
$v_d©a
['compression'];

3928 
$p_h—d”
['size'] = 
$v_d©a
['size'];

3929 
$p_h—d”
['com´es£d_size'] = 
$v_d©a
['compressed_size'];

3930 
$p_h—d”
['üc'] = 
$v_d©a
['crc'];

3931 
$p_h—d”
['æag'] = 
$v_d©a
['flag'];

3932 
$p_h—d”
['f’ame_Ën'] = 
$v_d©a
['filename_len'];

3935 
$p_h—d”
['md©e'] = 
$v_d©a
['mdate'];

3936 
$p_h—d”
['mtime'] = 
$v_d©a
['mtime'];

3937 ià(
$p_h—d”
['mdate'] && $p_header['mtime']) {

3939 
$v_hour
 = (
$p_h—d”
['mtime'] & 0xF800) >> 11;

3940 
$v_mšu‹
 = (
$p_h—d”
['mtime'] & 0x07E0) >> 5;

3941 
$v_£cÚde
 = (
$p_h—d”
['mtime'] & 0x001F)*2;

3944 
$v_y—r
 = ((
$p_h—d”
['mdate'] & 0xFE00) >> 9) + 1980;

3945 
$v_mÚth
 = (
$p_h—d”
['mdate'] & 0x01E0) >> 5;

3946 
$v_day
 = 
$p_h—d”
['mdate'] & 0x001F;

3949 
$p_h—d”
['mtime'] = @
	`mktime
(
$v_hour
, 
$v_mšu‹
, 
$v_£cÚde
, 
$v_mÚth
, 
$v_day
, 
$v_y—r
);

3952 
$p_h—d”
['mtime'] = 
	`time
();

3960 
$p_h—d”
['stored_filename'] = $p_header['filename'];

3963 
$p_h—d”
['status'] = "ok";

3966  
$v_»suÉ
;

3967 
	}
}

3976 
public
 
funùiÚ
 
	$´ivR—dC’Œ®FeH—d”
(&
$p_h—d”
)

3978 
$v_»suÉ
 = 1;

3981 
$v_bš¬y_d©a
 = @
	`ä—d
(
$this
->
z_fd
, 4);

3982 
$v_d©a
 = 
	`uÅack
('Vid', 
$v_bš¬y_d©a
);

3985 ià(
$v_d©a
['id'] != 0x02014b50) {

3987 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, 'Invalid‡rchive structure');

3990  
PşZ
::
	`”rÜCode
();

3994 
$v_bš¬y_d©a
 = 
	`ä—d
(
$this
->
z_fd
, 42);

3997 ià(
	`¡¾’
(
$v_bš¬y_d©a
) != 42) {

3998 
$p_h—d”
['filename'] = "";

3999 
$p_h—d”
['status'] = "invalid_header";

4002 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, "Inv®id block siz: ".
	`¡¾’
(
$v_bš¬y_d©a
));

4005  
PşZ
::
	`”rÜCode
();

4009 
$p_h—d”
 = 
	`uÅack
('vv”siÚ/vv”siÚ_exŒaùed/væag/vcom´essiÚ/vmtime/vmd©e/Vüc/Vcom´es£d_size/Vsize/vf’ame_Ën/vexŒa_Ën/vcomm’t_Ën/vdisk/vš‹º®/Vex‹º®/Voff£t', 
$v_bš¬y_d©a
);

4012 ià(
$p_h—d”
['filename_len'] != 0) {

4013 
$p_h—d”
['f’ame'] = 
	`ä—d
(
$this
->
z_fd
, $p_header['filename_len']);

4015 
$p_h—d”
['filename'] = '';

4019 ià(
$p_h—d”
['extra_len'] != 0) {

4020 
$p_h—d”
['exŒa'] = 
	`ä—d
(
$this
->
z_fd
, $p_header['extra_len']);

4022 
$p_h—d”
['extra'] = '';

4026 ià(
$p_h—d”
['comment_len'] != 0) {

4027 
$p_h—d”
['comm’t'] = 
	`ä—d
(
$this
->
z_fd
, $p_header['comment_len']);

4029 
$p_h—d”
['comment'] = '';

4039 
$v_hour
 = (
$p_h—d”
['mtime'] & 0xF800) >> 11;

4040 
$v_mšu‹
 = (
$p_h—d”
['mtime'] & 0x07E0) >> 5;

4041 
$v_£cÚde
 = (
$p_h—d”
['mtime'] & 0x001F)*2;

4044 
$v_y—r
 = ((
$p_h—d”
['mdate'] & 0xFE00) >> 9) + 1980;

4045 
$v_mÚth
 = (
$p_h—d”
['mdate'] & 0x01E0) >> 5;

4046 
$v_day
 = 
$p_h—d”
['mdate'] & 0x001F;

4049 
$p_h—d”
['mtime'] = @
	`mktime
(
$v_hour
, 
$v_mšu‹
, 
$v_£cÚde
, 
$v_mÚth
, 
$v_day
, 
$v_y—r
);

4052 
$p_h—d”
['mtime'] = 
	`time
();

4056 
$p_h—d”
['stored_filename'] = $p_header['filename'];

4059 
$p_h—d”
['status'] = 'ok';

4062 ià(
	`sub¡r
(
$p_h—d”
['filename'], -1) == '/') {

4064 
$p_h—d”
['external'] = 0x00000010;

4069  
$v_»suÉ
;

4070 
	}
}

4081 
public
 
funùiÚ
 
	$´ivCheckFeH—d”s
(&
$p_loÿl_h—d”
, &
$p_ûÁ¿l_h—d”
)

4083 
$v_»suÉ
=1;

4087 ià(
$p_loÿl_h—d”
['f’ame'] !ğ
$p_ûÁ¿l_h—d”
['filename']) {

4089 ià(
$p_loÿl_h—d”
['v”siÚ_exŒaùed'] !ğ
$p_ûÁ¿l_h—d”
['version_extracted']) {

4091 ià(
$p_loÿl_h—d”
['æag'] !ğ
$p_ûÁ¿l_h—d”
['flag']) {

4093 ià(
$p_loÿl_h—d”
['com´essiÚ'] !ğ
$p_ûÁ¿l_h—d”
['compression']) {

4095 ià(
$p_loÿl_h—d”
['mtime'] !ğ
$p_ûÁ¿l_h—d”
['mtime']) {

4097 ià(
$p_loÿl_h—d”
['f’ame_Ën'] !ğ
$p_ûÁ¿l_h—d”
['filename_len']) {

4101 ià((
$p_loÿl_h—d”
['flag'] & 8) == 8) {

4102 
$p_loÿl_h—d”
['size'] = 
$p_ûÁ¿l_h—d”
['size'];

4103 
$p_loÿl_h—d”
['com´es£d_size'] = 
$p_ûÁ¿l_h—d”
['compressed_size'];

4104 
$p_loÿl_h—d”
['üc'] = 
$p_ûÁ¿l_h—d”
['crc'];

4108  
$v_»suÉ
;

4109 
	}
}

4118 
public
 
funùiÚ
 
	$´ivR—dEndC’Œ®Dœ
(&
$p_ûÁ¿l_dœ
)

4120 
$v_»suÉ
=1;

4123 
$v_size
 = 
	`fesize
(
$this
->
zÇme
);

4124 @
	`f£ek
(
$this
->
z_fd
, 
$v_size
);

4125 ià(@
	`á–l
(
$this
->
z_fd
è!ğ
$v_size
) {

4127 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, 'UÇbËØgØtØth’d oàth¬chiv\''.
$this
->
zÇme
.'\'');

4130  
PşZ
::
	`”rÜCode
();

4135 
$v_found
 = 0;

4136 ià(
$v_size
 > 26) {

4137 @
	`f£ek
(
$this
->
z_fd
, 
$v_size
-22);

4138 ià((
$v_pos
 = @
	`á–l
(
$this
->
z_fd
)è!ğ(
$v_size
-22)) {

4140 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, 'UÇbËØ£ek backØthmiddË oàth¬chiv\''.
$this
->
zÇme
.'\'');

4143  
PşZ
::
	`”rÜCode
();

4147 
$v_bš¬y_d©a
 = @
	`ä—d
(
$this
->
z_fd
, 4);

4148 
$v_d©a
 = @
	`uÅack
('Vid', 
$v_bš¬y_d©a
);

4151 ià(
$v_d©a
['id'] == 0x06054b50) {

4152 
$v_found
 = 1;

4155 
$v_pos
 = 
	`á–l
(
$this
->
z_fd
);

4159 ià(!
$v_found
) {

4160 
$v_maximum_size
 = 65557;

4161 ià(
$v_maximum_size
 > 
$v_size
) {

4162 
$v_maximum_size
 = 
$v_size
;

4164 @
	`f£ek
(
$this
->
z_fd
, 
$v_size
-
$v_maximum_size
);

4165 ià(@
	`á–l
(
$this
->
z_fd
è!ğ(
$v_size
-
$v_maximum_size
)) {

4167 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, 'UÇbËØ£ek backØthmiddË oàth¬chiv\''.
$this
->
zÇme
.'\'');

4170  
PşZ
::
	`”rÜCode
();

4174 
$v_pos
 = 
	`á–l
(
$this
->
z_fd
);

4175 
$v_by‹s
 = 0x00000000;

4176 
$v_pos
 < 
$v_size
) {

4178 
$v_by‹
 = @
	`ä—d
(
$this
->
z_fd
, 1);

4184 
$v_by‹s
 = (($v_by‹ & 0xFFFFFFè<< 8è| 
	`Ord
(
$v_by‹
);

4187 ià(
$v_by‹s
 == 0x504b0506) {

4188 
$v_pos
++;

4192 
$v_pos
++;

4196 ià(
$v_pos
 =ğ
$v_size
) {

4198 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, "Unableo find End of Central Dir Record signature");

4201  
PşZ
::
	`”rÜCode
();

4206 
$v_bš¬y_d©a
 = 
	`ä—d
(
$this
->
z_fd
, 18);

4209 ià(
	`¡¾’
(
$v_bš¬y_d©a
) != 18) {

4211 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, "Inv®id End oàC’Œ® Dœ RecÜd siz: ".
	`¡¾’
(
$v_bš¬y_d©a
));

4214  
PşZ
::
	`”rÜCode
();

4218 
$v_d©a
 = 
	`uÅack
('vdisk/vdisk_¡¬t/vdisk_’Œ›s/v’Œ›s/Vsize/Voff£t/vcomm’t_size', 
$v_bš¬y_d©a
);

4221 ià((
$v_pos
 + 
$v_d©a
['comm’t_size'] + 18è!ğ
$v_size
) {

4228 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_BAD_FORMAT
, 'The central dir is‚ot‡theƒnd ofhe‡rchive. Somerailing bytesƒxists‡fterhe‡rchive.');

4231  
PşZ
::
	`”rÜCode
();

4236 ià(
$v_d©a
['comment_size'] != 0) {

4237 
$p_ûÁ¿l_dœ
['comm’t'] = 
	`ä—d
(
$this
->
z_fd
, 
$v_d©a
['comment_size']);

4239 
$p_ûÁ¿l_dœ
['comment'] = '';

4242 
$p_ûÁ¿l_dœ
['’Œ›s'] = 
$v_d©a
['entries'];

4243 
$p_ûÁ¿l_dœ
['disk_’Œ›s'] = 
$v_d©a
['disk_entries'];

4244 
$p_ûÁ¿l_dœ
['off£t'] = 
$v_d©a
['offset'];

4245 
$p_ûÁ¿l_dœ
['size'] = 
$v_d©a
['size'];

4246 
$p_ûÁ¿l_dœ
['disk'] = 
$v_d©a
['disk'];

4247 
$p_ûÁ¿l_dœ
['disk_¡¬t'] = 
$v_d©a
['disk_start'];

4254  
$v_»suÉ
;

4255 
	}
}

4264 
public
 
funùiÚ
 
	$´ivD–‘eByRuË
(&
$p_»suÉ_li¡
, &
$p_İtiÚs
)

4266 
$v_»suÉ
=1;

4267 
$v_li¡_d‘a
 = 
	`¬¿y
();

4270 ià((
$v_»suÉ
=
$this
->
	`´ivO³nFd
('rb')) != 1) {

4272  
$v_»suÉ
;

4276 
$v_ûÁ¿l_dœ
 = 
	`¬¿y
();

4277 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dEndC’Œ®Dœ
(
$v_ûÁ¿l_dœ
)) != 1) {

4278 
$this
->
	`´ivClo£Fd
();

4279  
$v_»suÉ
;

4283 @
	`»wšd
(
$this
->
z_fd
);

4287 
$v_pos_’Œy
 = 
$v_ûÁ¿l_dœ
['offset'];

4288 @
	`»wšd
(
$this
->
z_fd
);

4289 ià(@
	`f£ek
(
$this
->
z_fd
, 
$v_pos_’Œy
)) {

4291 
$this
->
	`´ivClo£Fd
();

4294 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ARCHIVE_ZIP
, 'Invalid‡rchive size');

4297  
PşZ
::
	`”rÜCode
();

4301 
$v_h—d”_li¡
 = 
	`¬¿y
();

4302 
$j_¡¬t
 = 0;

4303 
$i
=0, 
$v_nb_exŒaùed
=0; $i<
$v_ûÁ¿l_dœ
['entries']; $i++) {

4305 
$v_h—d”_li¡
[
$v_nb_exŒaùed
] = 
	`¬¿y
();

4306 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dC’Œ®FeH—d”
(
$v_h—d”_li¡
[
$v_nb_exŒaùed
])) != 1) {

4308 
$this
->
	`´ivClo£Fd
();

4310  
$v_»suÉ
;

4315 
$v_h—d”_li¡
[
$v_nb_exŒaùed
]['šdex'] = 
$i
;

4318 
$v_found
 = 
çl£
;

4321 ià((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
])) && ($p_options[PCLZIP_OPT_BY_NAME] != 0)) {

4323 
$j
=0; ($j<(
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
])è&& (!
$v_found
); $j++) {

4325 ià(
	`sub¡r
(
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
][
$j
], -1) == "/") {

4327 ià((
	`¡¾’
(
$v_h—d”_li¡
[
$v_nb_exŒaùed
]['¡Üed_f’ame']è> sŒËn(
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
][
$j
])è&& (
	`sub¡r
($v_header_list[$v_nb_extracted]['stored_filename'], 0, strlen($p_options[PCLZIP_OPT_BY_NAME][$j])) == $p_options[PCLZIP_OPT_BY_NAME][$j])) {

4328 
$v_found
 = 
Œue
;

4329 } 
	`–£if
 (((
$v_h—d”_li¡
[
$v_nb_exŒaùed
]['ex‹º®']&0x00000010)==0x00000010è && ($v_h—d”_li¡[$v_nb_exŒaùed]['¡Üed_f’ame'].'/' =ğ
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
][
$j
])) {

4330 
$v_found
 = 
Œue
;

4332 } 
	`–£if
 (
$v_h—d”_li¡
[
$v_nb_exŒaùed
]['¡Üed_f’ame'] =ğ
$p_İtiÚs
[
PCLZIP_OPT_BY_NAME
][
$j
]) {

4334 
$v_found
 = 
Œue
;

4337 } 
	`–£if
 ((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_BY_PREG
])) && ($p_options[PCLZIP_OPT_BY_PREG] != "")) {

4339 ià(
	`´eg_m©ch
(
$p_İtiÚs
[
PCLZIP_OPT_BY_PREG
], 
$v_h—d”_li¡
[
$v_nb_exŒaùed
]['stored_filename'])) {

4340 
$v_found
 = 
Œue
;

4342 } 
	`–£if
 ((
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_BY_INDEX
])) && ($p_options[PCLZIP_OPT_BY_INDEX] != 0)) {

4345 
$j
=
$j_¡¬t
; ($j<(
$p_İtiÚs
[
PCLZIP_OPT_BY_INDEX
])è&& (!
$v_found
); $j++) {

4346 ià((
$i
>=
$p_İtiÚs
[
PCLZIP_OPT_BY_INDEX
][
$j
]['start']) && ($i<=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end'])) {

4347 
$v_found
 = 
Œue
;

4349 ià(
$i
>=
$p_İtiÚs
[
PCLZIP_OPT_BY_INDEX
][
$j
]['end']) {

4350 
$j_¡¬t
 = 
$j
+1;

4352 ià(
$p_İtiÚs
[
PCLZIP_OPT_BY_INDEX
][
$j
]['¡¬t']>
$i
) {

4357 
$v_found
 = 
Œue
;

4361 ià(
$v_found
) {

4362 
	`un£t
(
$v_h—d”_li¡
[
$v_nb_exŒaùed
]);

4364 
$v_nb_exŒaùed
++;

4369 ià(
$v_nb_exŒaùed
 > 0) {

4371 
$v_z_‹mp_Çme
 = 
PCLZIP_TEMPORARY_DIR
.
	`uniqid
('pclzip-').'.tmp';

4374 
$v_‹mp_z
 = 
Ãw
 
	`PşZ
(
$v_z_‹mp_Çme
);

4377 ià((
$v_»suÉ
 = 
$v_‹mp_z
->
	`´ivO³nFd
('wb')) != 1) {

4378 
$this
->
	`´ivClo£Fd
();

4381  
$v_»suÉ
;

4385 
$i
=0; $i<(
$v_h—d”_li¡
); $i++) {

4387 @
	`»wšd
(
$this
->
z_fd
);

4388 ià(@
	`f£ek
(
$this
->
z_fd
, 
$v_h—d”_li¡
[
$i
]['offset'])) {

4390 
$this
->
	`´ivClo£Fd
();

4391 
$v_‹mp_z
->
	`´ivClo£Fd
();

4392 @
	`uÆšk
(
$v_z_‹mp_Çme
);

4395 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_INVALID_ARCHIVE_ZIP
, 'Invalid‡rchive size');

4398  
PşZ
::
	`”rÜCode
();

4402 
$v_loÿl_h—d”
 = 
	`¬¿y
();

4403 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dFeH—d”
(
$v_loÿl_h—d”
)) != 1) {

4405 
$this
->
	`´ivClo£Fd
();

4406 
$v_‹mp_z
->
	`´ivClo£Fd
();

4407 @
	`uÆšk
(
$v_z_‹mp_Çme
);

4410  
$v_»suÉ
;

4414 ià(
$this
->
	`´ivCheckFeH—d”s
(
$v_loÿl_h—d”
, 
$v_h—d”_li¡
[
$i
]) != 1) {

4417 
	`un£t
(
$v_loÿl_h—d”
);

4420 ià((
$v_»suÉ
 = 
$v_‹mp_z
->
	`´ivWr™eFeH—d”
(
$v_h—d”_li¡
[
$i
])) != 1) {

4422 
$this
->
	`´ivClo£Fd
();

4423 
$v_‹mp_z
->
	`´ivClo£Fd
();

4424 @
	`uÆšk
(
$v_z_‹mp_Çme
);

4427  
$v_»suÉ
;

4431 ià((
$v_»suÉ
 = 
	`PşZUtCİyBlock
(
$this
->
z_fd
, 
$v_‹mp_z
->z_fd, 
$v_h—d”_li¡
[
$i
]['compressed_size'])) != 1) {

4433 
$this
->
	`´ivClo£Fd
();

4434 
$v_‹mp_z
->
	`´ivClo£Fd
();

4435 @
	`uÆšk
(
$v_z_‹mp_Çme
);

4438  
$v_»suÉ
;

4443 
$v_off£t
 = @
	`á–l
(
$v_‹mp_z
->
z_fd
);

4446 
$i
=0; $i<(
$v_h—d”_li¡
); $i++) {

4448 ià((
$v_»suÉ
 = 
$v_‹mp_z
->
	`´ivWr™eC’Œ®FeH—d”
(
$v_h—d”_li¡
[
$i
])) != 1) {

4449 
$v_‹mp_z
->
	`´ivClo£Fd
();

4450 
$this
->
	`´ivClo£Fd
();

4451 @
	`uÆšk
(
$v_z_‹mp_Çme
);

4454  
$v_»suÉ
;

4458 
$v_‹mp_z
->
	`´ivCÚv”tH—d”2FeInfo
(
$v_h—d”_li¡
[
$i
], 
$p_»suÉ_li¡
[$i]);

4463 
$v_comm’t
 = '';

4464 ià(
	`is£t
(
$p_İtiÚs
[
PCLZIP_OPT_COMMENT
])) {

4465 
$v_comm’t
 = 
$p_İtiÚs
[
PCLZIP_OPT_COMMENT
];

4469 
$v_size
 = @
	`á–l
(
$v_‹mp_z
->
z_fd
)-
$v_off£t
;

4472 ià((
$v_»suÉ
 = 
$v_‹mp_z
->
	`´ivWr™eC’Œ®H—d”
((
$v_h—d”_li¡
), 
$v_size
, 
$v_off£t
, 
$v_comm’t
)) != 1) {

4474 
	`un£t
(
$v_h—d”_li¡
);

4475 
$v_‹mp_z
->
	`´ivClo£Fd
();

4476 
$this
->
	`´ivClo£Fd
();

4477 @
	`uÆšk
(
$v_z_‹mp_Çme
);

4480  
$v_»suÉ
;

4484 
$v_‹mp_z
->
	`´ivClo£Fd
();

4485 
$this
->
	`´ivClo£Fd
();

4489 @
	`uÆšk
(
$this
->
zÇme
);

4494 
	`PşZUtR’ame
(
$v_z_‹mp_Çme
, 
$this
->
zÇme
);

4497 
	`un£t
(
$v_‹mp_z
);

4498 } 
	`–£if
 (
$v_ûÁ¿l_dœ
['entries'] != 0) {

4500 
$this
->
	`´ivClo£Fd
();

4502 ià((
$v_»suÉ
 = 
$this
->
	`´ivO³nFd
('wb')) != 1) {

4503  
$v_»suÉ
;

4506 ià((
$v_»suÉ
 = 
$this
->
	`´ivWr™eC’Œ®H—d”
(0, 0, 0, '')) != 1) {

4507  
$v_»suÉ
;

4510 
$this
->
	`´ivClo£Fd
();

4514  
$v_»suÉ
;

4515 
	}
}

4529 
public
 
funùiÚ
 
	$´ivDœCheck
(
$p_dœ
, 
$p_is_dœ
 = 
çl£
)

4531 
$v_»suÉ
 = 1;

4534 ià((
$p_is_dœ
è&& (
	`sub¡r
(
$p_dœ
, -1)=='/')) {

4535 
$p_dœ
 = 
	`sub¡r
($p_dœ, 0, 
	`¡¾’
($p_dir)-1);

4539 ià((
	`is_dœ
(
$p_dœ
)) || ($p_dir == "")) {

4544 
$p_·»Á_dœ
 = 
	`dœÇme
(
$p_dœ
);

4547 ià(
$p_·»Á_dœ
 !ğ
$p_dœ
) {

4549 ià(
$p_·»Á_dœ
 != "") {

4550 ià((
$v_»suÉ
 = 
$this
->
	`´ivDœCheck
(
$p_·»Á_dœ
)) != 1) {

4551  
$v_»suÉ
;

4557 ià(!@
	`mkdœ
(
$p_dœ
, 0777)) {

4559 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_DIR_CREATE_FAIL
, "Unableo create directory '$p_dir'");

4562  
PşZ
::
	`”rÜCode
();

4566  
$v_»suÉ
;

4567 
	}
}

4577 
public
 
funùiÚ
 
	$´ivM”ge
(&
$p_¬chive_to_add
)

4579 
$v_»suÉ
=1;

4582 ià(!
	`is_fe
(
$p_¬chive_to_add
->
zÇme
)) {

4584 
$v_»suÉ
 = 1;

4587  
$v_»suÉ
;

4591 ià(!
	`is_fe
(
$this
->
zÇme
)) {

4593 
$v_»suÉ
 = 
$this
->
	`´ivDu¶iÿ‹
(
$p_¬chive_to_add
->
zÇme
);

4596  
$v_»suÉ
;

4600 ià((
$v_»suÉ
=
$this
->
	`´ivO³nFd
('rb')) != 1) {

4602  
$v_»suÉ
;

4606 
$v_ûÁ¿l_dœ
 = 
	`¬¿y
();

4607 ià((
$v_»suÉ
 = 
$this
->
	`´ivR—dEndC’Œ®Dœ
(
$v_ûÁ¿l_dœ
)) != 1) {

4608 
$this
->
	`´ivClo£Fd
();

4609  
$v_»suÉ
;

4613 @
	`»wšd
(
$this
->
z_fd
);

4616 ià((
$v_»suÉ
=
$p_¬chive_to_add
->
	`´ivO³nFd
('rb')) != 1) {

4617 
$this
->
	`´ivClo£Fd
();

4620  
$v_»suÉ
;

4624 
$v_ûÁ¿l_dœ_to_add
 = 
	`¬¿y
();

4625 ià((
$v_»suÉ
 = 
$p_¬chive_to_add
->
	`´ivR—dEndC’Œ®Dœ
(
$v_ûÁ¿l_dœ_to_add
)) != 1) {

4626 
$this
->
	`´ivClo£Fd
();

4627 
$p_¬chive_to_add
->
	`´ivClo£Fd
();

4629  
$v_»suÉ
;

4633 @
	`»wšd
(
$p_¬chive_to_add
->
z_fd
);

4636 
$v_z_‹mp_Çme
 = 
PCLZIP_TEMPORARY_DIR
.
	`uniqid
('pclzip-').'.tmp';

4639 ià((
$v_z_‹mp_fd
 = @
	`fİ’
(
$v_z_‹mp_Çme
, 'wb')) == 0) {

4640 
$this
->
	`´ivClo£Fd
();

4641 
$p_¬chive_to_add
->
	`´ivClo£Fd
();

4643 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, 'UÇbËØİ’empÜ¬y f\''.
$v_z_‹mp_Çme
.'\' in binary write mode');

4646  
PşZ
::
	`”rÜCode
();

4651 
$v_size
 = 
$v_ûÁ¿l_dœ
['offset'];

4652 
$v_size
 != 0) {

4653 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

4654 
$v_bufãr
 = 
	`ä—d
(
$this
->
z_fd
, 
$v_»ad_size
);

4655 @
	`fwr™e
(
$v_z_‹mp_fd
, 
$v_bufãr
, 
$v_»ad_size
);

4656 
$v_size
 -ğ
$v_»ad_size
;

4660 
$v_size
 = 
$v_ûÁ¿l_dœ_to_add
['offset'];

4661 
$v_size
 != 0) {

4662 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

4663 
$v_bufãr
 = 
	`ä—d
(
$p_¬chive_to_add
->
z_fd
, 
$v_»ad_size
);

4664 @
	`fwr™e
(
$v_z_‹mp_fd
, 
$v_bufãr
, 
$v_»ad_size
);

4665 
$v_size
 -ğ
$v_»ad_size
;

4669 
$v_off£t
 = @
	`á–l
(
$v_z_‹mp_fd
);

4672 
$v_size
 = 
$v_ûÁ¿l_dœ
['size'];

4673 
$v_size
 != 0) {

4674 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

4675 
$v_bufãr
 = @
	`ä—d
(
$this
->
z_fd
, 
$v_»ad_size
);

4676 @
	`fwr™e
(
$v_z_‹mp_fd
, 
$v_bufãr
, 
$v_»ad_size
);

4677 
$v_size
 -ğ
$v_»ad_size
;

4681 
$v_size
 = 
$v_ûÁ¿l_dœ_to_add
['size'];

4682 
$v_size
 != 0) {

4683 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

4684 
$v_bufãr
 = @
	`ä—d
(
$p_¬chive_to_add
->
z_fd
, 
$v_»ad_size
);

4685 @
	`fwr™e
(
$v_z_‹mp_fd
, 
$v_bufãr
, 
$v_»ad_size
);

4686 
$v_size
 -ğ
$v_»ad_size
;

4690 
$v_comm’t
 = 
$v_ûÁ¿l_dœ
['comm’t'].' '.
$v_ûÁ¿l_dœ_to_add
['comment'];

4693 
$v_size
 = @
	`á–l
(
$v_z_‹mp_fd
)-
$v_off£t
;

4698 
$v_sw­
 = 
$this
->
z_fd
;

4699 
$this
->
z_fd
 = 
$v_z_‹mp_fd
;

4700 
$v_z_‹mp_fd
 = 
$v_sw­
;

4703 ià((
$v_»suÉ
 = 
$this
->
	`´ivWr™eC’Œ®H—d”
(
$v_ûÁ¿l_dœ
['’Œ›s']+
$v_ûÁ¿l_dœ_to_add
['’Œ›s'], 
$v_size
, 
$v_off£t
, 
$v_comm’t
)) != 1) {

4704 
$this
->
	`´ivClo£Fd
();

4705 
$p_¬chive_to_add
->
	`´ivClo£Fd
();

4706 @
	`fşo£
(
$v_z_‹mp_fd
);

4707 
$this
->
z_fd
 = 
nuÎ
;

4710 
	`un£t
(
$v_h—d”_li¡
);

4713  
$v_»suÉ
;

4717 
$v_sw­
 = 
$this
->
z_fd
;

4718 
$this
->
z_fd
 = 
$v_z_‹mp_fd
;

4719 
$v_z_‹mp_fd
 = 
$v_sw­
;

4722 
$this
->
	`´ivClo£Fd
();

4723 
$p_¬chive_to_add
->
	`´ivClo£Fd
();

4726 @
	`fşo£
(
$v_z_‹mp_fd
);

4730 @
	`uÆšk
(
$this
->
zÇme
);

4735 
	`PşZUtR’ame
(
$v_z_‹mp_Çme
, 
$this
->
zÇme
);

4738  
$v_»suÉ
;

4739 
	}
}

4748 
public
 
funùiÚ
 
	$´ivDu¶iÿ‹
(
$p_¬chive_f’ame
)

4750 
$v_»suÉ
=1;

4753 ià(!
	`is_fe
(
$p_¬chive_f’ame
)) {

4755 
$v_»suÉ
 = 1;

4758  
$v_»suÉ
;

4762 ià((
$v_»suÉ
=
$this
->
	`´ivO³nFd
('wb')) != 1) {

4764  
$v_»suÉ
;

4768 ià((
$v_z_‹mp_fd
 = @
	`fİ’
(
$p_¬chive_f’ame
, 'rb')) == 0) {

4769 
$this
->
	`´ivClo£Fd
();

4771 
PşZ
::
	`´ivE¼ÜLog
(
PCLZIP_ERR_READ_OPEN_FAIL
, 'UÇbËØİ’‡rchivf\''.
$p_¬chive_f’ame
.'\' in binary write mode');

4774  
PşZ
::
	`”rÜCode
();

4779 
$v_size
 = 
	`fesize
(
$p_¬chive_f’ame
);

4780 
$v_size
 != 0) {

4781 
$v_»ad_size
 = (
$v_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $v_size : PCLZIP_READ_BLOCK_SIZE);

4782 
$v_bufãr
 = 
	`ä—d
(
$v_z_‹mp_fd
, 
$v_»ad_size
);

4783 @
	`fwr™e
(
$this
->
z_fd
, 
$v_bufãr
, 
$v_»ad_size
);

4784 
$v_size
 -ğ
$v_»ad_size
;

4788 
$this
->
	`´ivClo£Fd
();

4791 @
	`fşo£
(
$v_z_‹mp_fd
);

4794  
$v_»suÉ
;

4795 
	}
}

4803 
public
 
funùiÚ
 
´ivE¼ÜLog
(
$p_”rÜ_code
 = 0, 
$p_”rÜ_¡ršg
 = '')

4805 ià(
PCLZIP_ERROR_EXTERNAL
 == 1) {

4806 
PşE¼Ü
(
$p_”rÜ_code
, 
$p_”rÜ_¡ršg
);

4808 
	g$this
->
	g”rÜ_code
 = 
$p_”rÜ_code
;

4809 
	g$this
->
	g”rÜ_¡ršg
 = 
$p_”rÜ_¡ršg
;

4819 
public
 
funùiÚ
 
	$´ivE¼ÜRe£t
()

4821 ià(
PCLZIP_ERROR_EXTERNAL
 == 1) {

4822 
	`PşE¼ÜRe£t
();

4824 
$this
->
”rÜ_code
 = 0;

4825 
$this
->
”rÜ_¡ršg
 = '';

4827 
	}
}

4836 
public
 
funùiÚ
 
	$´ivDi§bËMagicQuÙes
()

4838 
$v_»suÉ
=1;

4841 ià((!
	`funùiÚ_exi¡s
("get_magic_quotes_runtime")) || (!function_exists("set_magic_quotes_runtime"))) {

4842  
$v_»suÉ
;

4846 ià(
$this
->
magic_quÙes_¡©us
 != -1) {

4847  
$v_»suÉ
;

4851 
$this
->
magic_quÙes_¡©us
 = @
	`g‘_magic_quÙes_ruÁime
();

4854 ià(
$this
->
magic_quÙes_¡©us
 == 1) {

4855 @
	`£t_magic_quÙes_ruÁime
(0);

4859  
$v_»suÉ
;

4860 
	}
}

4869 
public
 
funùiÚ
 
	$´ivSw­BackMagicQuÙes
()

4871 
$v_»suÉ
=1;

4874 ià((!
	`funùiÚ_exi¡s
("get_magic_quotes_runtime")) || (!function_exists("set_magic_quotes_runtime"))) {

4875  
$v_»suÉ
;

4879 ià(
$this
->
magic_quÙes_¡©us
 != -1) {

4880  
$v_»suÉ
;

4884 ià(
$this
->
magic_quÙes_¡©us
 == 1) {

4885 @
	`£t_magic_quÙes_ruÁime
(
$this
->
magic_quÙes_¡©us
);

4889  
$v_»suÉ
;

4890 
	}
}

4902 
funùiÚ
 
	$PşZUtP©hReduùiÚ
(
$p_dœ
)

4904 
$v_»suÉ
 = "";

4907 ià(
$p_dœ
 != "") {

4909 
$v_li¡
 = 
	`ex¶ode
("/", 
$p_dœ
);

4912 
$v_sk
 = 0;

4913 
$i
=(
$v_li¡
)-1; $i>=0; $i--) {

4915 ià(
$v_li¡
[
$i
] == ".") {

4918 } 
	`–£if
 (
$v_li¡
[
$i
] == "..") {

4919 
$v_sk
++;

4920 } 
	`–£if
 (
$v_li¡
[
$i
] == "") {

4922 ià(
$i
 == 0) {

4923 
$v_»suÉ
 = "/".$v_result;

4924 ià(
$v_sk
 > 0) {

4927 
$v_»suÉ
 = 
$p_dœ
;

4928 
$v_sk
 = 0;

4930 } 
	`–£if
 (
$i
 =ğ((
$v_li¡
)-1)) {

4932 
$v_»suÉ
 = 
$v_li¡
[
$i
];

4940 ià(
$v_sk
 > 0) {

4941 
$v_sk
--;

4943 
$v_»suÉ
 = 
$v_li¡
[
$i
].($i!=(($v_list)-1)?"/".$v_result:"");

4949 ià(
$v_sk
 > 0) {

4950 
$v_sk
 > 0) {

4951 
$v_»suÉ
 = '../'.$v_result;

4952 
$v_sk
--;

4958  
$v_»suÉ
;

4959 
	}
}

4977 
funùiÚ
 
	$PşZUtP©hInşusiÚ
(
$p_dœ
, 
$p_·th
)

4979 
$v_»suÉ
 = 1;

4982 ià((
$p_dœ
 =ğ'.'è|| ((
	`¡¾’
($p_dœè>=2è&& (
	`sub¡r
($p_dir, 0, 2) == './'))) {

4983 
$p_dœ
 = 
	`PşZUtT¿n¦©eWšP©h
(
	`g‘cwd
(), 
çl£
).'/'.
	`sub¡r
($p_dir, 1);

4985 ià((
$p_·th
 =ğ'.'è|| ((
	`¡¾’
($p_·thè>=2è&& (
	`sub¡r
($p_path, 0, 2) == './'))) {

4986 
$p_·th
 = 
	`PşZUtT¿n¦©eWšP©h
(
	`g‘cwd
(), 
çl£
).'/'.
	`sub¡r
($p_path, 1);

4990 
$v_li¡_dœ
 = 
	`ex¶ode
("/", 
$p_dœ
);

4991 
$v_li¡_dœ_size
 = (
$v_li¡_dœ
);

4992 
$v_li¡_·th
 = 
	`ex¶ode
("/", 
$p_·th
);

4993 
$v_li¡_·th_size
 = (
$v_li¡_·th
);

4996 
$i
 = 0;

4997 
$j
 = 0;

4998 (
$i
 < 
$v_li¡_dœ_size
è&& (
$j
 < 
$v_li¡_·th_size
è&& (
$v_»suÉ
)) {

5000 ià(
$v_li¡_dœ
[
$i
] == '') {

5001 
$i
++;

5004 ià(
$v_li¡_·th
[
$j
] == '') {

5005 
$j
++;

5010 ià((
$v_li¡_dœ
[
$i
] !ğ
$v_li¡_·th
[
$j
]) && ($v_list_dir[$i] != '') && ($v_list_path[$j] != '')) {

5011 
$v_»suÉ
 = 0;

5015 
$i
++;

5016 
$j
++;

5020 ià(
$v_»suÉ
) {

5022 (
$j
 < 
$v_li¡_·th_size
è&& (
$v_li¡_·th
[$j] == '')) {

5023 
$j
++;

5025 (
$i
 < 
$v_li¡_dœ_size
è&& (
$v_li¡_dœ
[$i] == '')) {

5026 
$i
++;

5029 ià((
$i
 >ğ
$v_li¡_dœ_size
è&& (
$j
 >ğ
$v_li¡_·th_size
)) {

5031 
$v_»suÉ
 = 2;

5032 } 
	`–£if
 (
$i
 < 
$v_li¡_dœ_size
) {

5034 
$v_»suÉ
 = 0;

5039  
$v_»suÉ
;

5040 
	}
}

5054 
funùiÚ
 
	$PşZUtCİyBlock
(
$p_¤c
, 
$p_de¡
, 
$p_size
, 
$p_mode
 = 0)

5056 
$v_»suÉ
 = 1;

5058 ià(
$p_mode
==0) {

5059 
$p_size
 != 0) {

5060 
$v_»ad_size
 = (
$p_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $p_size : PCLZIP_READ_BLOCK_SIZE);

5061 
$v_bufãr
 = @
	`ä—d
(
$p_¤c
, 
$v_»ad_size
);

5062 @
	`fwr™e
(
$p_de¡
, 
$v_bufãr
, 
$v_»ad_size
);

5063 
$p_size
 -ğ
$v_»ad_size
;

5065 } 
	`–£if
 (
$p_mode
==1) {

5066 
$p_size
 != 0) {

5067 
$v_»ad_size
 = (
$p_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $p_size : PCLZIP_READ_BLOCK_SIZE);

5068 
$v_bufãr
 = @
	`gz»ad
(
$p_¤c
, 
$v_»ad_size
);

5069 @
	`fwr™e
(
$p_de¡
, 
$v_bufãr
, 
$v_»ad_size
);

5070 
$p_size
 -ğ
$v_»ad_size
;

5072 } 
	`–£if
 (
$p_mode
==2) {

5073 
$p_size
 != 0) {

5074 
$v_»ad_size
 = (
$p_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $p_size : PCLZIP_READ_BLOCK_SIZE);

5075 
$v_bufãr
 = @
	`ä—d
(
$p_¤c
, 
$v_»ad_size
);

5076 @
	`gzwr™e
(
$p_de¡
, 
$v_bufãr
, 
$v_»ad_size
);

5077 
$p_size
 -ğ
$v_»ad_size
;

5079 } 
	`–£if
 (
$p_mode
==3) {

5080 
$p_size
 != 0) {

5081 
$v_»ad_size
 = (
$p_size
 < 
PCLZIP_READ_BLOCK_SIZE
 ? $p_size : PCLZIP_READ_BLOCK_SIZE);

5082 
$v_bufãr
 = @
	`gz»ad
(
$p_¤c
, 
$v_»ad_size
);

5083 @
	`gzwr™e
(
$p_de¡
, 
$v_bufãr
, 
$v_»ad_size
);

5084 
$p_size
 -ğ
$v_»ad_size
;

5089  
$v_»suÉ
;

5090 
	}
}

5105 
funùiÚ
 
	$PşZUtR’ame
(
$p_¤c
, 
$p_de¡
)

5107 
$v_»suÉ
 = 1;

5110 ià(!@
	`»Çme
(
$p_¤c
, 
$p_de¡
)) {

5112 ià(!@
	`cİy
(
$p_¤c
, 
$p_de¡
)) {

5113 
$v_»suÉ
 = 0;

5114 } 
	`–£if
 (!@
	`uÆšk
(
$p_¤c
)) {

5115 
$v_»suÉ
 = 0;

5120  
$v_»suÉ
;

5121 
	}
}

5133 
funùiÚ
 
	$PşZUtO±iÚText
(
$p_İtiÚ
)

5135 
$v_li¡
 = 
	`g‘_defšed_cÚ¡ªts
();

5136 
	`»£t
(
$v_li¡
); 
$v_key
 = 
	`key
($v_li¡); 
	`Ãxt
($v_list)) {

5137 
$v_´efix
 = 
	`sub¡r
(
$v_key
, 0, 10);

5138 ià(((
$v_´efix
 =ğ'PCLZIP_OPT'è|| ($v_´efix =ğ'PCLZIP_CB_'è|| ($v_´efix =ğ'PCLZIP_ATT')è&& (
$v_li¡
[
$v_key
] =ğ
$p_İtiÚ
)) {

5139  
$v_key
;

5143 
$v_»suÉ
 = 'Unknown';

5145  
$v_»suÉ
;

5146 
	}
}

5160 
funùiÚ
 
	$PşZUtT¿n¦©eWšP©h
(
$p_·th
, 
$p_»move_disk_Ë‰”
 = 
Œue
)

5162 ià(
	`¡ri¡r
(
	`php_uÇme
(), 'windows')) {

5164 ià((
$p_»move_disk_Ë‰”
è&& ((
$v_pos™iÚ
 = 
	`¡½os
(
$p_·th
, ':')è!ğ
çl£
)) {

5165 
$p_·th
 = 
	`sub¡r
($p_·th, 
$v_pos™iÚ
+1);

5168 ià((
	`¡½os
(
$p_·th
, '\\'è> 0è|| (
	`sub¡r
($p_path, 0, 1) == '\\')) {

5169 
$p_·th
 = 
	`¡¹r
($p_path, '\\', '/');

5172  
$p_·th
;

5173 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/PasswordHasher.php

1 <?
php


36 şas 
	cPHPExûl_Sh¬ed_PasswÜdHash”


48 
public
 
funùiÚ
 
hashPasswÜd
(
$pPasswÜd
 = '')

50 
$·sswÜd
 = 0x0000;

51 
	m$ch¬Pos
 = 1;

54 
	m$ch¬s
 = 
´eg_¥l™
('//', 
$pPasswÜd
, -1, 
PREG_SPLIT_NO_EMPTY
);

55 
fÜ—ch
 (
$ch¬s
 
as
 
$ch¬
) {

56 
	m$v®ue
 = 
Üd
(
$ch¬
è<< 
$ch¬Pos
++;

57 
	m$rÙ©ed_b™s
 = 
$v®ue
 >> 15;

58 
	m$v®ue
 &= 0x7fff;

59 
	m$·sswÜd
 ^ğ(
$v®ue
 | 
$rÙ©ed_b™s
);

62 
	m$·sswÜd
 ^ğ
¡¾’
(
$pPasswÜd
);

63 
	m$·sswÜd
 ^= 0xCE4B;

65 (
¡¹ouµ”
(
dechex
(
$·sswÜd
)));

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/String.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_SŒšg


33 cÚ¡ 
	mSTRING_REGEXP_FRACTION
 = '(-?)(\d+)\s+(\d+\/\d+)';

41 
´iv©e
 
	m$cÚŒŞCh¬aù”s
 = 
¬¿y
();

48 
´iv©e
 
	m$SYLKCh¬aù”s
 = 
¬¿y
();

55 
´iv©e
 
	m$decim®S•¬©Ü
;

62 
´iv©e
 
	m$thou§ndsS•¬©Ü
;

69 
´iv©e
 
	m$cu¼’cyCode
;

76 
´iv©e
 
	m$isMb¡ršgEÇbËd
;

83 
´iv©e
 
	m$isIcÚvEÇbËd
;

88 
´iv©e
 
funùiÚ
 
	$budCÚŒŞCh¬aù”s
()

90 
$i
 = 0; $i <= 31; ++$i) {

91 ià(
$i
 != 9 && $i != 10 && $i != 13) {

92 
$fšd
 = '_x' . 
	`¥rštf
('%04s', 
	`¡¹ouµ”
(
	`dechex
(
$i
))) . '_';

93 
$»¶aû
 = 
	`chr
(
$i
);

94 
£lf
::
$cÚŒŞCh¬aù”s
[
$fšd
] = 
$»¶aû
;

102 
´iv©e
 
funùiÚ
 
	$budSYLKCh¬aù”s
()

104 
£lf
::
$SYLKCh¬aù”s
 = 
	`¬¿y
(

105 "\x1B 0" => 
	`chr
(0),

106 "\x1B 1" => 
	`chr
(1),

107 "\x1B 2" => 
	`chr
(2),

108 "\x1B 3" => 
	`chr
(3),

109 "\x1B 4" => 
	`chr
(4),

110 "\x1B 5" => 
	`chr
(5),

111 "\x1B 6" => 
	`chr
(6),

112 "\x1B 7" => 
	`chr
(7),

113 "\x1B 8" => 
	`chr
(8),

114 "\x1B 9" => 
	`chr
(9),

115 "\x1B :" => 
	`chr
(10),

116 "\x1B ;" => 
	`chr
(11),

117 "\x1B <" => 
	`chr
(12),

118 "\x1B :" => 
	`chr
(13),

119 "\x1B >" => 
	`chr
(14),

120 "\x1B ?" => 
	`chr
(15),

121 "\x1B!0" => 
	`chr
(16),

122 "\x1B!1" => 
	`chr
(17),

123 "\x1B!2" => 
	`chr
(18),

124 "\x1B!3" => 
	`chr
(19),

125 "\x1B!4" => 
	`chr
(20),

126 "\x1B!5" => 
	`chr
(21),

127 "\x1B!6" => 
	`chr
(22),

128 "\x1B!7" => 
	`chr
(23),

129 "\x1B!8" => 
	`chr
(24),

130 "\x1B!9" => 
	`chr
(25),

131 "\x1B!:" => 
	`chr
(26),

132 "\x1B!;" => 
	`chr
(27),

133 "\x1B!<" => 
	`chr
(28),

134 "\x1B!=" => 
	`chr
(29),

135 "\x1B!>" => 
	`chr
(30),

136 "\x1B!?" => 
	`chr
(31),

137 "\x1B'?" => 
	`chr
(127),

262 
	}
}

269 
public
 
funùiÚ
 
	$g‘IsMb¡ršgEÇbËd
()

271 ià(
	`is£t
(
£lf
::
$isMb¡ršgEÇbËd
)) {

272  
£lf
::
$isMb¡ršgEÇbËd
;

275 
£lf
::
$isMb¡ršgEÇbËd
 = 
	`funùiÚ_exi¡s
('mb_convert_encoding') ?

276 
Œue
 : 
çl£
;

278  
£lf
::
$isMb¡ršgEÇbËd
;

279 
	}
}

286 
public
 
funùiÚ
 
	$g‘IsIcÚvEÇbËd
()

288 ià(
	`is£t
(
£lf
::
$isIcÚvEÇbËd
)) {

289  
£lf
::
$isIcÚvEÇbËd
;

293 ià(!
	`funùiÚ_exi¡s
('iconv')) {

294 
£lf
::
$isIcÚvEÇbËd
 = 
çl£
;

295  
çl£
;

299 ià(!@
	`icÚv
('UTF-8', 'UTF-16LE', 'x')) {

300 
£lf
::
$isIcÚvEÇbËd
 = 
çl£
;

301  
çl£
;

306 ià(!@
	`icÚv_sub¡r
('A', 0, 1, 'UTF-8')) {

307 
£lf
::
$isIcÚvEÇbËd
 = 
çl£
;

308  
çl£
;

312 ià(
	`defšed
('PHP_OS'è&& @
	`¡ri¡r
(
PHP_OS
, 'AIX'è&& defšed('ICONV_IMPL'è&& (@
	`¡rÿ£cmp
(
ICONV_IMPL
, 'unknown'è=ğ0è&& defšed('ICONV_VERSION'è&& (@¡rÿ£cmp(
ICONV_VERSION
, 'unknown') == 0)) {

313 
£lf
::
$isIcÚvEÇbËd
 = 
çl£
;

314  
çl£
;

318 
£lf
::
$isIcÚvEÇbËd
 = 
Œue
;

319  
Œue
;

320 
	}
}

322 
public
 
funùiÚ
 
	$budCh¬aù”S‘s
()

324 ià(
	`em±y
(
£lf
::
$cÚŒŞCh¬aù”s
)) {

325 
£lf
::
	`budCÚŒŞCh¬aù”s
();

327 ià(
	`em±y
(
£lf
::
$SYLKCh¬aù”s
)) {

328 
£lf
::
	`budSYLKCh¬aù”s
();

330 
	}
}

346 
public
 
funùiÚ
 
CÚŒŞCh¬aù”OOXML2PHP
(
$v®ue
 = '')

348  
¡r_»¶aû
(
¬¿y_keys
(
£lf
::
$cÚŒŞCh¬aù”s
), 
¬¿y_v®ues
(£lf::$cÚŒŞCh¬aù”s), 
$v®ue
);

365 
public
 
funùiÚ
 
CÚŒŞCh¬aù”PHP2OOXML
(
$v®ue
 = '')

367  
¡r_»¶aû
(
¬¿y_v®ues
(
£lf
::
$cÚŒŞCh¬aù”s
), 
¬¿y_keys
(£lf::$cÚŒŞCh¬aù”s), 
$v®ue
);

376 
public
 
funùiÚ
 
	$Sª™izeUTF8
(
$v®ue
)

378 ià(
£lf
::
	`g‘IsIcÚvEÇbËd
()) {

379 
$v®ue
 = @
	`icÚv
('UTF-8', 'UTF-8', $value);

380  
$v®ue
;

383 ià(
£lf
::
	`g‘IsMb¡ršgEÇbËd
()) {

384 
$v®ue
 = 
	`mb_cÚv”t_’codšg
($value, 'UTF-8', 'UTF-8');

385  
$v®ue
;

389  
$v®ue
;

390 
	}
}

398 
public
 
funùiÚ
 
IsUTF8
(
$v®ue
 = '')

400  
$v®ue
 ==ğ'' || 
´eg_m©ch
('/^./su', $value) === 1;

410 
public
 
funùiÚ
 
	$FÜm©Numb”
(
$v®ue
)

412 ià(
	`is_æßt
(
$v®ue
)) {

413  
	`¡r_»¶aû
(',', '.', 
$v®ue
);

415  (
¡ršg
è
$v®ue
;

416 
	}
}

429 
public
 
funùiÚ
 
UTF8toBIFF8UnicodeShÜt
(
$v®ue
, 
$¬rcRuns
 = 
	$¬¿y
())

432 
$Ê
 = 
£lf
::
	`CouÁCh¬aù”s
(
$v®ue
, 'UTF-8');

434 ià(
	`em±y
(
$¬rcRuns
)) {

435 
$İt
 = (
£lf
::
	`g‘IsIcÚvEÇbËd
(è|| s–f::
	`g‘IsMb¡ršgEÇbËd
()) ?

437 
$d©a
 = 
	`·ck
('CC', 
$Ê
, 
$İt
);

439 
$d©a
 .ğ
£lf
::
	`CÚv”tEncodšg
(
$v®ue
, 'UTF-16LE', 'UTF-8');

441 
$d©a
 = 
	`·ck
('vC', 
$Ê
, 0x09);

442 
$d©a
 .ğ
	`·ck
('v', 
	`couÁ
(
$¬rcRuns
));

444 
$d©a
 .ğ
£lf
::
	`CÚv”tEncodšg
(
$v®ue
, 'UTF-16LE', 'UTF-8');

445 
	`fÜ—ch
 (
$¬rcRuns
 
as
 
$cRun
) {

446 
$d©a
 .ğ
	`·ck
('v', 
$cRun
['strlen']);

447 
$d©a
 .ğ
	`·ck
('v', 
$cRun
['fontidx']);

450  
$d©a
;

451 
	}
}

463 
public
 
funùiÚ
 
	$UTF8toBIFF8UnicodeLÚg
(
$v®ue
)

466 
$Ê
 = 
£lf
::
	`CouÁCh¬aù”s
(
$v®ue
, 'UTF-8');

469 
$İt
 = (
£lf
::
	`g‘IsIcÚvEÇbËd
(è|| s–f::
	`g‘IsMb¡ršgEÇbËd
()) ?

473 
$ch¬s
 = 
£lf
::
	`CÚv”tEncodšg
(
$v®ue
, 'UTF-16LE', 'UTF-8');

475 
$d©a
 = 
	`·ck
('vC', 
$Ê
, 
$İt
è. 
$ch¬s
;

476  
$d©a
;

477 
	}
}

487 
public
 
funùiÚ
 
	$CÚv”tEncodšg
(
$v®ue
, 
$to
, 
$äom
)

489 ià(
£lf
::
	`g‘IsIcÚvEÇbËd
()) {

490  
	`icÚv
(
$äom
, 
$to
, 
$v®ue
);

493 ià(
£lf
::
	`g‘IsMb¡ršgEÇbËd
()) {

494  
	`mb_cÚv”t_’codšg
(
$v®ue
, 
$to
, 
$äom
);

497 ià(
$äom
 == 'UTF-16LE') {

498  
£lf
::
	`utf16_decode
(
$v®ue
, 
çl£
);

499 } 
	`–£if
 (
$äom
 == 'UTF-16BE') {

500  
£lf
::
	`utf16_decode
(
$v®ue
);

503  
$v®ue
;

504 
	}
}

521 
public
 
funùiÚ
 
	$utf16_decode
(
$¡r
, 
$bom_be
 = 
Œue
)

523 ià(
	`¡¾’
(
$¡r
) < 2) {

524  
$¡r
;

526 
$c0
 = 
	`Üd
(
$¡r
{0});

527 
$c1
 = 
	`Üd
(
$¡r
{1});

528 ià(
$c0
 =ğ0xã && 
$c1
 == 0xff) {

529 
$¡r
 = 
	`sub¡r
($str, 2);

530 } 
	`–£if
 (
$c0
 =ğ0xfà&& 
$c1
 == 0xfe) {

531 
$¡r
 = 
	`sub¡r
($str, 2);

532 
$bom_be
 = 
çl£
;

534 
$Ën
 = 
	`¡¾’
(
$¡r
);

535 
$Ãw¡r
 = '';

536 
$i
=0; $i<
$Ën
; $i+=2) {

537 ià(
$bom_be
) {

538 
$v®
 = 
	`Üd
(
$¡r
{
$i
}) << 4;

539 
$v®
 +ğ
	`Üd
(
$¡r
{
$i
+1});

541 
$v®
 = 
	`Üd
(
$¡r
{
$i
+1}) << 4;

542 
$v®
 +ğ
	`Üd
(
$¡r
{
$i
});

544 
$Ãw¡r
 .ğ(
$v®
 =ğ0x228è? "\n" : 
	`chr
($val);

546  
$Ãw¡r
;

547 
	}
}

556 
public
 
funùiÚ
 
CouÁCh¬aù”s
(
$v®ue
, 
$’c
 = 'UTF-8')

558 ià(
£lf
::
g‘IsMb¡ršgEÇbËd
()) {

559  
mb_¡¾’
(
$v®ue
, 
$’c
);

562 ià(
	g£lf
::
g‘IsIcÚvEÇbËd
()) {

563  
icÚv_¡¾’
(
$v®ue
, 
$’c
);

567  
¡¾’
(
$v®ue
);

578 
public
 
funùiÚ
 
Sub¡ršg
(
$pV®ue
 = '', 
$pS¹
 = 0, 
$pL’gth
 = 0)

580 ià(
£lf
::
g‘IsMb¡ršgEÇbËd
()) {

581  
mb_sub¡r
(
$pV®ue
, 
$pS¹
, 
$pL’gth
, 'UTF-8');

584 ià(
	g£lf
::
g‘IsIcÚvEÇbËd
()) {

585  
icÚv_sub¡r
(
$pV®ue
, 
$pS¹
, 
$pL’gth
, 'UTF-8');

589  
sub¡r
(
$pV®ue
, 
$pS¹
, 
$pL’gth
);

598 
public
 
funùiÚ
 
SŒToUµ”
(
$pV®ue
 = '')

600 ià(
funùiÚ_exi¡s
('mb_convert_case')) {

601  
mb_cÚv”t_ÿ£
(
$pV®ue
, 
MB_CASE_UPPER
, "UTF-8");

603  
¡¹ouµ”
(
$pV®ue
);

612 
public
 
funùiÚ
 
SŒToLow”
(
$pV®ue
 = '')

614 ià(
funùiÚ_exi¡s
('mb_convert_case')) {

615  
mb_cÚv”t_ÿ£
(
$pV®ue
, 
MB_CASE_LOWER
, "UTF-8");

617  
¡¹Şow”
(
$pV®ue
);

627 
public
 
funùiÚ
 
SŒToT™Ë
(
$pV®ue
 = '')

629 ià(
funùiÚ_exi¡s
('mb_convert_case')) {

630  
mb_cÚv”t_ÿ£
(
$pV®ue
, 
MB_CASE_TITLE
, "UTF-8");

632  
ucwÜds
(
$pV®ue
);

635 
public
 
funùiÚ
 
	$mb_is_uµ”
(
$ch¬
)

637  
	`mb_¡¹Şow”
(
$ch¬
, "UTF-8") != $char;

638 
	}
}

640 
public
 
funùiÚ
 
	$mb_¡r_¥l™
(
$¡ršg
)

642 #S¶™ 
©
 
®l
 
pos™iÚ
 
nÙ
 
aá”
 
the
 
¡¬t
: ^

643 #ªd 
nÙ
 
befÜe
 
the
 
’d
: 
$


644  
	`´eg_¥l™
('/(?<!^)(?!$)/u', 
$¡ršg
);

645 
	}
}

654 
public
 
funùiÚ
 
SŒCa£Rev”£
(
$pV®ue
 = '')

656 ià(
£lf
::
g‘IsMb¡ršgEÇbËd
()) {

657 
$ch¬aù”s
 = 
£lf
::
mb_¡r_¥l™
(
$pV®ue
);

658 
fÜ—ch
 (
$ch¬aù”s
 
as
 &
$ch¬aù”
) {

659 ià(
	g£lf
::
mb_is_uµ”
(
$ch¬aù”
)) {

660 
$ch¬aù”
 = 
mb_¡¹Şow”
($character, 'UTF-8');

662 
	g$ch¬aù”
 = 
mb_¡¹ouµ”
(
$ch¬aù”
, 'UTF-8');

665  
im¶ode
('', 
$ch¬aù”s
);

667  
¡¹Şow”
(
$pV®ue
è^ 
¡¹ouµ”
($pV®ueè^ 
	g$pV®ue
;

677 
public
 
funùiÚ
 
	$cÚv”tToNumb”IfF¿ùiÚ
(&
$İ”ªd
)

679 ià(
	`´eg_m©ch
('/^'.
£lf
::
STRING_REGEXP_FRACTION
.'$/i', 
$İ”ªd
, 
$m©ch
)) {

680 
$sign
 = (
$m©ch
[1] == '-') ? '-' : '+';

681 
$äaùiÚFÜmuÏ
 = '='.
$sign
.
$m©ch
[2].$sign.$match[3];

682 
$İ”ªd
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`_ÿlcuÏ‹FÜmuÏV®ue
(
$äaùiÚFÜmuÏ
);

683  
Œue
;

685  
çl£
;

686 
	}
}

694 
public
 
funùiÚ
 
	$g‘Decim®S•¬©Ü
()

696 ià(!
	`is£t
(
£lf
::
$decim®S•¬©Ü
)) {

697 
$loÿËcÚv
 = 
	`loÿËcÚv
();

698 
£lf
::
$decim®S•¬©Ü
 = (
$loÿËcÚv
['decimal_point'] != '')

699 ? 
$loÿËcÚv
['decimal_point'] : $localeconv['mon_decimal_point'];

701 ià(
£lf
::
$decim®S•¬©Ü
 == '') {

703 
£lf
::
$decim®S•¬©Ü
 = '.';

706  
£lf
::
$decim®S•¬©Ü
;

707 
	}
}

715 
public
 
funùiÚ
 
£tDecim®S•¬©Ü
(
$pV®ue
 = '.')

717 
£lf
::
$decim®S•¬©Ü
 = 
$pV®ue
;

726 
public
 
funùiÚ
 
	$g‘Thou§ndsS•¬©Ü
()

728 ià(!
	`is£t
(
£lf
::
$thou§ndsS•¬©Ü
)) {

729 
$loÿËcÚv
 = 
	`loÿËcÚv
();

730 
£lf
::
$thou§ndsS•¬©Ü
 = (
$loÿËcÚv
['thousands_sep'] != '')

731 ? 
$loÿËcÚv
['thousands_sep'] : $localeconv['mon_thousands_sep'];

733 ià(
£lf
::
$thou§ndsS•¬©Ü
 == '') {

735 
£lf
::
$thou§ndsS•¬©Ü
 = ',';

738  
£lf
::
$thou§ndsS•¬©Ü
;

739 
	}
}

747 
public
 
funùiÚ
 
£tThou§ndsS•¬©Ü
(
$pV®ue
 = ',')

749 
£lf
::
$thou§ndsS•¬©Ü
 = 
$pV®ue
;

758 
public
 
funùiÚ
 
	$g‘Cu¼’cyCode
()

760 ià(!
	`is£t
(
£lf
::
$cu¼’cyCode
)) {

761 
$loÿËcÚv
 = 
	`loÿËcÚv
();

762 
£lf
::
$cu¼’cyCode
 = (
$loÿËcÚv
['currency_symbol'] != '')

763 ? 
$loÿËcÚv
['currency_symbol'] : $localeconv['int_curr_symbol'];

765 ià(
£lf
::
$cu¼’cyCode
 == '') {

767 
£lf
::
$cu¼’cyCode
 = '$';

770  
£lf
::
$cu¼’cyCode
;

771 
	}
}

779 
public
 
funùiÚ
 
£tCu¼’cyCode
(
$pV®ue
 = '$')

781 
£lf
::
$cu¼’cyCode
 = 
$pV®ue
;

790 
public
 
funùiÚ
 
SYLKtoUTF8
(
$pV®ue
 = '')

793 ià(
¡½os
(
$pV®ue
, ''è==ğ
çl£
) {

794  
$pV®ue
;

797 
fÜ—ch
 (
£lf
::
$SYLKCh¬aù”s
 
as
 
$k
 => 
$v
) {

798 
$pV®ue
 = 
¡r_»¶aû
(
$k
, 
$v
, $pValue);

801  
	g$pV®ue
;

811 
public
 
funùiÚ
 
	$‹¡SŒšgAsNum”ic
(
$v®ue
)

813 ià(
	`is_num”ic
(
$v®ue
)) {

814  
$v®ue
;

816 
$v
 = 
	`æßtv®
(
$v®ue
);

817  (
	`is_num”ic
(
	`sub¡r
(
$v®ue
, 0, 
	`¡¾’
(
$v
)))) ? $v : $value;

818 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/TimeZone.php

1 <?
php


37 şas 
	cPHPExûl_Sh¬ed_TimeZÚe


45 
´Ùeùed
 
	m$timezÚe
 = 'UTC';

53 
public
 
funùiÚ
 
	$_v®id©eTimeZÚe
(
$timezÚe
)

55 ià(
	`š_¬¿y
(
$timezÚe
, 
D©eTimeZÚe
::
	`li¡Id’tif›rs
())) {

56  
Œue
;

58  
çl£
;

67 
public
 
funùiÚ
 
	$£tTimeZÚe
(
$timezÚe
)

69 ià(
£lf
::
	`_v®id©eTimezÚe
(
$timezÚe
)) {

70 
£lf
::
$timezÚe
 = $timezone;

71  
Œue
;

73  
çl£
;

74 
	}
}

82 
public
 
funùiÚ
 
	$g‘TimeZÚe
()

84  
£lf
::
$timezÚe
;

85 
	}
}

95 
´iv©e
 
funùiÚ
 
	$g‘TimezÚeT¿ns™iÚs
(
$objTimezÚe
, 
$time¡amp
)

97 
$®lT¿ns™iÚs
 = 
$objTimezÚe
->
	`g‘T¿ns™iÚs
();

98 
$Œªs™iÚs
 = 
	`¬¿y
();

99 
	`fÜ—ch
 (
$®lT¿ns™iÚs
 
as
 
$key
 => 
$Œªs™iÚ
) {

100 ià(
$Œªs™iÚ
['ts'] > 
$time¡amp
) {

101 
$Œªs™iÚs
[] = (
$key
 > 0è? 
$®lT¿ns™iÚs
[$key - 1] : 
$Œªs™iÚ
;

104 ià(
	`em±y
(
$Œªs™iÚs
)) {

105 
$Œªs™iÚs
[] = 
	`’d
(
$®lT¿ns™iÚs
);

109  
$Œªs™iÚs
;

110 
	}
}

121 
public
 
funùiÚ
 
	$g‘TimeZÚeAdju¡m’t
(
$timezÚe
, 
$time¡amp
)

123 ià(
$timezÚe
 !=ğ
nuÎ
) {

124 ià(!
£lf
::
	`_v®id©eTimezÚe
(
$timezÚe
)) {

125 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Inv®idimezÚ" . 
$timezÚe
);

128 
$timezÚe
 = 
£lf
::$timezone;

131 ià(
$timezÚe
 == 'UST') {

135 
$objTimezÚe
 = 
Ãw
 
	`D©eTimeZÚe
(
$timezÚe
);

136 ià(
	`v”siÚ_com·»
(
PHP_VERSION
, '5.3.0') >= 0) {

137 
$Œªs™iÚs
 = 
$objTimezÚe
->
	`g‘T¿ns™iÚs
(
$time¡amp
, $timestamp);

139 
$Œªs™iÚs
 = 
£lf
::
	`g‘TimezÚeT¿ns™iÚs
(
$objTimezÚe
, 
$time¡amp
);

142  (
	`couÁ
(
$Œªs™iÚs
) > 0) ? $transitions[0]['offset'] : 0;

143 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/XMLWriter.php

1 <?
php


3 ià(!
defšed
('DATE_W3C')) {

4 
defše
('DATE_W3C', 'Y-m-d\TH:i:sP');

7 ià(!
defšed
('DEBUGMODE_ENABLED')) {

8 
defše
('DEBUGMODE_ENABLED', 
çl£
);

36 şas 
	cPHPExûl_Sh¬ed_XMLWr™”
 
ex‹nds
 
	mXMLWr™”


39 cÚ¡ 
	mSTORAGE_MEMORY
 = 1;

40 cÚ¡ 
	mSTORAGE_DISK
 = 2;

47 
´iv©e
 
	m$‹mpFeName
 = '';

55 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$pTempÜ¬yStÜage
 = 
£lf
::
STORAGE_MEMORY
, 
$pTempÜ¬yStÜageFŞd”
 = 
nuÎ
)

58 ià(
$pTempÜ¬yStÜage
 =ğ
£lf
::
STORAGE_MEMORY
) {

59 
$this
->
	`İ’MemÜy
();

62 ià(
$pTempÜ¬yStÜageFŞd”
 ==ğ
nuÎ
) {

63 
$pTempÜ¬yStÜageFŞd”
 = 
PHPExûl_Sh¬ed_Fe
::
	`sys_g‘_‹mp_dœ
();

65 
$this
->
‹mpFeName
 = @
	`‹m²am
(
$pTempÜ¬yStÜageFŞd”
, 'xml');

68 ià(
$this
->
	`İ’Uri
($this->
‹mpFeName
è==ğ
çl£
) {

70 
$this
->
	`İ’MemÜy
();

75 ià(
DEBUGMODE_ENABLED
) {

76 
$this
->
	`£tInd’t
(
Œue
);

83 
public
 
funùiÚ
 
	$__de¡ruù
()

86 ià(
$this
->
‹mpFeName
 != '') {

87 @
	`uÆšk
(
$this
->
‹mpFeName
);

89 
	}
}

96 
public
 
funùiÚ
 
	$g‘D©a
()

98 ià(
$this
->
‹mpFeName
 == '') {

99  
$this
->
	`ouutMemÜy
(
Œue
);

101 
$this
->
	`æush
();

102  
	`fe_g‘_cÚ‹Ás
(
$this
->
‹mpFeName
);

104 
	}
}

112 
public
 
funùiÚ
 
	$wr™eRawD©a
(
$‹xt
)

114 ià(
	`is_¬¿y
(
$‹xt
)) {

115 
$‹xt
 = 
	`im¶ode
("\n", $text);

118 ià(
	`m‘hod_exi¡s
(
$this
, 'writeRaw')) {

119  
$this
->
	`wr™eRaw
(
	`html¥ecŸlch¬s
(
$‹xt
));

122  
$this
->
	`‹xt
(
$‹xt
);

123 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/ZipArchive.php

1 <?
php


3 ià(!
defšed
('PCLZIP_TEMPORARY_DIR')) {

4 
defše
('PCLZIP_TEMPORARY_DIR', 
PHPExûl_Sh¬ed_Fe
::
sys_g‘_‹mp_dœ
(è. 
DIRECTORY_SEPARATOR
);

6 
»quœe_Úû
 
	gPHPEXCEL_ROOT
 . 'PHPExcel/Shared/PCLZip/pclzip.lib.php';

33 şas 
	cPHPExûl_Sh¬ed_ZArchive


37 cÚ¡ 
	mOVERWRITE
 = 'OVERWRITE';

38 cÚ¡ 
	mCREATE
 = 'CREATE';

46 
´iv©e
 
	m$‹mpDœ
;

53 
´iv©e
 
	m$z
;

62 
public
 
funùiÚ
 
	$İ’
(
$feName
)

64 
$this
->
‹mpDœ
 = 
PHPExûl_Sh¬ed_Fe
::
	`sys_g‘_‹mp_dœ
();

65 
$this
->
z
 = 
Ãw
 
	`PşZ
(
$feName
);

67  
Œue
;

75 
public
 
funùiÚ
 
	$şo£
()

77 
	}
}

86 
public
 
funùiÚ
 
	$addFromSŒšg
(
$loÿÊame
, 
$cÚ‹Ás
)

88 
$f’ameP¬ts
 = 
	`·thšfo
(
$loÿÊame
);

90 
$hªdË
 = 
	`fİ’
(
$this
->
‹mpDœ
.'/'.
$f’ameP¬ts
["basename"], "wb");

91 
	`fwr™e
(
$hªdË
, 
$cÚ‹Ás
);

92 
	`fşo£
(
$hªdË
);

94 
$»s
 = 
$this
->
z
->
	`add
($this->
‹mpDœ
.'/'.
$f’ameP¬ts
["ba£Çme"], 
PCLZIP_OPT_REMOVE_PATH
, $this->‹mpDœ, 
PCLZIP_OPT_ADD_PATH
, $filenameParts["dirname"]);

95 ià(
$»s
 == 0) {

96 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("E¼Ü zpšg fe : " . 
$this
->
z
->
	`”rÜInfo
(
Œue
));

99 
	`uÆšk
(
$this
->
‹mpDœ
.'/'.
$f’ameP¬ts
["basename"]);

100 
	}
}

108 
public
 
funùiÚ
 
	$loÿ‹Name
(
$feName
)

110 
$li¡
 = 
$this
->
z
->
	`li¡CÚ‹Á
();

111 
$li¡CouÁ
 = 
	`couÁ
(
$li¡
);

112 
$li¡_šdex
 = -1;

113 
$i
 = 0; $˜< 
$li¡CouÁ
; ++$i) {

114 ià(
	`¡¹Şow”
(
$li¡
[
$i
]["f’ame"]è=ğ¡¹Şow”(
$feName
) ||

115 
	`¡¹Şow”
(
$li¡
[
$i
]["¡Üed_f’ame"]è=ğ¡¹Şow”(
$feName
)) {

116 
$li¡_šdex
 = 
$i
;

120  (
$li¡_šdex
 > -1);

121 
	}
}

129 
public
 
funùiÚ
 
	$g‘FromName
(
$feName
)

131 
$li¡
 = 
$this
->
z
->
	`li¡CÚ‹Á
();

132 
$li¡CouÁ
 = 
	`couÁ
(
$li¡
);

133 
$li¡_šdex
 = -1;

134 
$i
 = 0; $˜< 
$li¡CouÁ
; ++$i) {

135 ià(
	`¡¹Şow”
(
$li¡
[
$i
]["f’ame"]è=ğ¡¹Şow”(
$feName
) ||

136 
	`¡¹Şow”
(
$li¡
[
$i
]["¡Üed_f’ame"]è=ğ¡¹Şow”(
$feName
)) {

137 
$li¡_šdex
 = 
$i
;

142 
$exŒaùed
 = "";

143 ià(
$li¡_šdex
 != -1) {

144 
$exŒaùed
 = 
$this
->
z
->
	`exŒaùByIndex
(
$li¡_šdex
, 
PCLZIP_OPT_EXTRACT_AS_STRING
);

146 
$f’ame
 = 
	`sub¡r
(
$feName
, 1);

147 
$li¡_šdex
 = -1;

148 
$i
 = 0; $˜< 
$li¡CouÁ
; ++$i) {

149 ià(
	`¡¹Şow”
(
$li¡
[
$i
]["f’ame"]è=ğ¡¹Şow”(
$feName
) ||

150 
	`¡¹Şow”
(
$li¡
[
$i
]["¡Üed_f’ame"]è=ğ¡¹Şow”(
$feName
)) {

151 
$li¡_šdex
 = 
$i
;

155 
$exŒaùed
 = 
$this
->
z
->
	`exŒaùByIndex
(
$li¡_šdex
, 
PCLZIP_OPT_EXTRACT_AS_STRING
);

157 ià((
	`is_¬¿y
(
$exŒaùed
)) && ($extracted != 0)) {

158 
$cÚ‹Ás
 = 
$exŒaùed
[0]["content"];

161  
$cÚ‹Ás
;

162 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/ZipStreamWrapper.php

1 <?
php


28 şas 
	cPHPExûl_Sh¬ed_ZSŒ—mW¿µ”


35 
´iv©e
 
	m$¬chive
;

42 
´iv©e
 
	m$feNameInArchive
 = '';

49 
´iv©e
 
	m$pos™iÚ
 = 0;

56 
´iv©e
 
	m$d©a
 = '';

61 
public
 
funùiÚ
 ()

63 @
	`¡»am_w¿µ”_uÄegi¡”
('zip');

64 @
	`¡»am_w¿µ”_»gi¡”
('z', 
__CLASS__
);

76 
public
 
funùiÚ
 
	$¡»am_İ’
(
$·th
, 
$mode
, 
$İtiÚs
, &
$İ’ed_·th
)

79 ià(
$mode
{0} != 'r') {

80 
throw
 
Ãw
 
	`PHPExûl_R—d”_Exû±iÚ
('Mod' . 
$mode
 . ' is‚ot supported. Only„ead mode is supported.');

83 
$pos
 = 
	`¡¼pos
(
$·th
, '#');

84 
$u¾
['ho¡'] = 
	`sub¡r
(
$·th
, 6, 
$pos
 - 6);

85 
$u¾
['äagm’t'] = 
	`sub¡r
(
$·th
, 
$pos
 + 1);

88 
$this
->
¬chive
 = 
Ãw
 
	`ZArchive
();

89 
$this
->
¬chive
->
	`İ’
(
$u¾
['host']);

91 
$this
->
feNameInArchive
 = 
$u¾
['fragment'];

92 
$this
->
pos™iÚ
 = 0;

93 
$this
->
d©a
 = $this->
¬chive
->
	`g‘FromName
($this->
feNameInArchive
);

95  
Œue
;

96 
	}
}

103 
public
 
funùiÚ
 
	$¡©Name
()

105  
$this
->
feNameInArchive
;

106 
	}
}

113 
public
 
funùiÚ
 
	$u¾_¡©
()

115  
$this
->
	`¡©Name
($this->
feNameInArchive
);

116 
	}
}

123 
public
 
funùiÚ
 
	$¡»am_¡©
()

125  
$this
->
¬chive
->
	`¡©Name
($this->
feNameInArchive
);

126 
	}
}

134 
public
 
funùiÚ
 
	$¡»am_»ad
(
$couÁ
)

136 
$»t
 = 
	`sub¡r
(
$this
->
d©a
, $this->
pos™iÚ
, 
$couÁ
);

137 
$this
->
pos™iÚ
 +ğ
	`¡¾’
(
$»t
);

138  
$»t
;

139 
	}
}

147 
public
 
funùiÚ
 
	$¡»am_‹Î
()

149  
$this
->
pos™iÚ
;

150 
	}
}

157 
public
 
funùiÚ
 
	$¡»am_eof
()

159  
$this
->
pos™iÚ
 >ğ
	`¡¾’
($this->
d©a
);

160 
	}
}

169 
public
 
funùiÚ
 
	$¡»am_£ek
(
$off£t
, 
$wh’û
)

171 
$wh’û
) {

172 
SEEK_SET
:

173 ià(
$off£t
 < 
	`¡¾’
(
$this
->
d©a
) && $offset >= 0) {

174 
$this
->
pos™iÚ
 = 
$off£t
;

175  
Œue
;

177  
çl£
;

180 
SEEK_CUR
:

181 ià(
$off£t
 >= 0) {

182 
$this
->
pos™iÚ
 +ğ
$off£t
;

183  
Œue
;

185  
çl£
;

188 
SEEK_END
:

189 ià(
	`¡¾’
(
$this
->
d©a
è+ 
$off£t
 >= 0) {

190 
$this
->
pos™iÚ
 = 
	`¡¾’
($this->
d©a
è+ 
$off£t
;

191  
Œue
;

193  
çl£
;

197  
çl£
;

199 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/bestFitClass.php

1 <?
php


28 şas 
	cPHPExûl_Be¡_F™


35 
´Ùeùed
 
	m$”rÜ
 = 
çl£
;

42 
´Ùeùed
 
	m$be¡F™Ty³
 = 'undetermined';

49 
´Ùeùed
 
	m$v®ueCouÁ
 = 0;

56 
´Ùeùed
 
	m$xV®ues
 = 
¬¿y
();

63 
´Ùeùed
 
	m$yV®ues
 = 
¬¿y
();

70 
´Ùeùed
 
	m$adju¡ToZ”o
 = 
çl£
;

77 
´Ùeùed
 
	m$yBe¡F™V®ues
 = 
¬¿y
();

79 
´Ùeùed
 
	m$goodÃssOfF™
 = 1;

81 
´Ùeùed
 
	m$¡devOfResidu®s
 = 0;

83 
´Ùeùed
 
	m$cov¬Ÿnû
 = 0;

85 
´Ùeùed
 
	m$cÜ»ÏtiÚ
 = 0;

87 
´Ùeùed
 
	m$SSReg»ssiÚ
 = 0;

89 
´Ùeùed
 
	m$SSResidu®s
 = 0;

91 
´Ùeùed
 
	m$DFResidu®s
 = 0;

93 
´Ùeùed
 
	m$f
 = 0;

95 
´Ùeùed
 
	m$¦İe
 = 0;

97 
´Ùeùed
 
	m$¦İeSE
 = 0;

99 
´Ùeùed
 
	m$š‹r£ù
 = 0;

101 
´Ùeùed
 
	m$š‹r£ùSE
 = 0;

103 
´Ùeùed
 
	m$xOff£t
 = 0;

105 
´Ùeùed
 
	m$yOff£t
 = 0;

108 
public
 
funùiÚ
 
	$g‘E¼Ü
()

110  
$this
->
”rÜ
;

114 
public
 
funùiÚ
 
	$g‘Be¡F™Ty³
()

116  
$this
->
be¡F™Ty³
;

117 
	}
}

125 
public
 
funùiÚ
 
	$g‘V®ueOfYFÜX
(
$xV®ue
)

127  
çl£
;

128 
	}
}

136 
public
 
funùiÚ
 
	$g‘V®ueOfXFÜY
(
$yV®ue
)

138  
çl£
;

139 
	}
}

146 
public
 
funùiÚ
 
	$g‘XV®ues
()

148  
$this
->
xV®ues
;

149 
	}
}

157 
public
 
funùiÚ
 
	$g‘Equ©iÚ
(
$dp
 = 0)

159  
çl£
;

160 
	}
}

168 
public
 
funùiÚ
 
	$g‘Slİe
(
$dp
 = 0)

170 ià(
$dp
 != 0) {

171  
	`round
(
$this
->
¦İe
, 
$dp
);

173  
$this
->
¦İe
;

174 
	}
}

182 
public
 
funùiÚ
 
	$g‘SlİeSE
(
$dp
 = 0)

184 ià(
$dp
 != 0) {

185  
	`round
(
$this
->
¦İeSE
, 
$dp
);

187  
$this
->
¦İeSE
;

188 
	}
}

196 
public
 
funùiÚ
 
	$g‘IÁ”£ù
(
$dp
 = 0)

198 ià(
$dp
 != 0) {

199  
	`round
(
$this
->
š‹r£ù
, 
$dp
);

201  
$this
->
š‹r£ù
;

202 
	}
}

210 
public
 
funùiÚ
 
	$g‘IÁ”£ùSE
(
$dp
 = 0)

212 ià(
$dp
 != 0) {

213  
	`round
(
$this
->
š‹r£ùSE
, 
$dp
);

215  
$this
->
š‹r£ùSE
;

216 
	}
}

224 
public
 
funùiÚ
 
	$g‘GoodÃssOfF™
(
$dp
 = 0)

226 ià(
$dp
 != 0) {

227  
	`round
(
$this
->
goodÃssOfF™
, 
$dp
);

229  
$this
->
goodÃssOfF™
;

230 
	}
}

232 
public
 
funùiÚ
 
	$g‘GoodÃssOfF™P”ûÁ
(
$dp
 = 0)

234 ià(
$dp
 != 0) {

235  
	`round
(
$this
->
goodÃssOfF™
 * 100, 
$dp
);

237  
$this
->
goodÃssOfF™
 * 100;

238 
	}
}

246 
public
 
funùiÚ
 
	$g‘StdevOfResidu®s
(
$dp
 = 0)

248 ià(
$dp
 != 0) {

249  
	`round
(
$this
->
¡devOfResidu®s
, 
$dp
);

251  
$this
->
¡devOfResidu®s
;

252 
	}
}

254 
public
 
funùiÚ
 
	$g‘SSReg»ssiÚ
(
$dp
 = 0)

256 ià(
$dp
 != 0) {

257  
	`round
(
$this
->
SSReg»ssiÚ
, 
$dp
);

259  
$this
->
SSReg»ssiÚ
;

260 
	}
}

262 
public
 
funùiÚ
 
	$g‘SSResidu®s
(
$dp
 = 0)

264 ià(
$dp
 != 0) {

265  
	`round
(
$this
->
SSResidu®s
, 
$dp
);

267  
$this
->
SSResidu®s
;

268 
	}
}

270 
public
 
funùiÚ
 
	$g‘DFResidu®s
(
$dp
 = 0)

272 ià(
$dp
 != 0) {

273  
	`round
(
$this
->
DFResidu®s
, 
$dp
);

275  
$this
->
DFResidu®s
;

276 
	}
}

278 
public
 
funùiÚ
 
	$g‘F
(
$dp
 = 0)

280 ià(
$dp
 != 0) {

281  
	`round
(
$this
->
f
, 
$dp
);

283  
$this
->
f
;

284 
	}
}

286 
public
 
funùiÚ
 
	$g‘Cov¬Ÿnû
(
$dp
 = 0)

288 ià(
$dp
 != 0) {

289  
	`round
(
$this
->
cov¬Ÿnû
, 
$dp
);

291  
$this
->
cov¬Ÿnû
;

292 
	}
}

294 
public
 
funùiÚ
 
	$g‘CÜ»ÏtiÚ
(
$dp
 = 0)

296 ià(
$dp
 != 0) {

297  
	`round
(
$this
->
cÜ»ÏtiÚ
, 
$dp
);

299  
$this
->
cÜ»ÏtiÚ
;

300 
	}
}

302 
public
 
funùiÚ
 
	$g‘YBe¡F™V®ues
()

304  
$this
->
yBe¡F™V®ues
;

305 
	}
}

307 
´Ùeùed
 
funùiÚ
 
	$ÿlcuÏ‹GoodÃssOfF™
(
$sumX
, 
$sumY
, 
$sumX2
, 
$sumY2
, 
$sumXY
, 
$m—nX
, 
$m—nY
, 
$cÚ¡
)

309 
$SS»s
 = 
$SScov
 = 
$SScÜ
 = 
$SStÙ
 = 
$SS£x
 = 0.0;

310 
	`fÜ—ch
 (
$this
->
xV®ues
 
as
 
$xKey
 => 
$xV®ue
) {

311 
$be¡F™Y
 = 
$this
->
yBe¡F™V®ues
[
$xKey
] = $this->
	`g‘V®ueOfYFÜX
(
$xV®ue
);

313 
$SS»s
 +ğ(
$this
->
yV®ues
[
$xKey
] - 
$be¡F™Y
) * ($this->yValues[$xKey] - $bestFitY);

314 ià(
$cÚ¡
) {

315 
$SStÙ
 +ğ(
$this
->
yV®ues
[
$xKey
] - 
$m—nY
) * ($this->yValues[$xKey] - $meanY);

317 
$SStÙ
 +ğ
$this
->
yV®ues
[
$xKey
] * $this->yValues[$xKey];

319 
$SScov
 +ğ(
$this
->
xV®ues
[
$xKey
] - 
$m—nX
è* ($this->
yV®ues
[$xKey] - 
$m—nY
);

320 ià(
$cÚ¡
) {

321 
$SS£x
 +ğ(
$this
->
xV®ues
[
$xKey
] - 
$m—nX
) * ($this->xValues[$xKey] - $meanX);

323 
$SS£x
 +ğ
$this
->
xV®ues
[
$xKey
] * $this->xValues[$xKey];

327 
$this
->
SSResidu®s
 = 
$SS»s
;

328 
$this
->
DFResidu®s
 = $this->
v®ueCouÁ
 - 1 - 
$cÚ¡
;

330 ià(
$this
->
DFResidu®s
 == 0.0) {

331 
$this
->
¡devOfResidu®s
 = 0.0;

333 
$this
->
¡devOfResidu®s
 = 
	`sq¹
(
$SS»s
 / $this->
DFResidu®s
);

335 ià((
$SStÙ
 =ğ0.0è|| (
$SS»s
 == $SStot)) {

336 
$this
->
goodÃssOfF™
 = 1;

338 
$this
->
goodÃssOfF™
 = 1 - (
$SS»s
 / 
$SStÙ
);

341 
$this
->
SSReg»ssiÚ
 = $this->
goodÃssOfF™
 * 
$SStÙ
;

342 
$this
->
cov¬Ÿnû
 = 
$SScov
 / $this->
v®ueCouÁ
;

343 
$this
->
cÜ»ÏtiÚ
 = ($this->
v®ueCouÁ
 * 
$sumXY
 - 
$sumX
 * 
$sumY
è/ 
	`sq¹
(($this->v®ueCouÁ * 
$sumX2
 - 
	`pow
($sumX, 2)è* ($this->v®ueCouÁ * 
$sumY2
 -…ow($sumY, 2)));

344 
$this
->
¦İeSE
 = $this->
¡devOfResidu®s
 / 
	`sq¹
(
$SS£x
);

345 
$this
->
š‹r£ùSE
 = $this->
¡devOfResidu®s
 * 
	`sq¹
(1 / ($this->
v®ueCouÁ
 - (
$sumX
 * $sumXè/ 
$sumX2
));

346 ià(
$this
->
SSResidu®s
 != 0.0) {

347 ià(
$this
->
DFResidu®s
 == 0.0) {

348 
$this
->
f
 = 0.0;

350 
$this
->
f
 = $this->
SSReg»ssiÚ
 / ($this->
SSResidu®s
 / $this->
DFResidu®s
);

353 ià(
$this
->
DFResidu®s
 == 0.0) {

354 
$this
->
f
 = 0.0;

356 
$this
->
f
 = $this->
SSReg»ssiÚ
 / $this->
DFResidu®s
;

359 
	}
}

361 
´Ùeùed
 
funùiÚ
 
	$Ëa¡Squ¬eF™
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
)

364 
$x_sum
 = 
	`¬¿y_sum
(
$xV®ues
);

365 
$y_sum
 = 
	`¬¿y_sum
(
$yV®ues
);

366 
$m—nX
 = 
$x_sum
 / 
$this
->
v®ueCouÁ
;

367 
$m—nY
 = 
$y_sum
 / 
$this
->
v®ueCouÁ
;

368 
$mBa£
 = 
$mDivisÜ
 = 
$xx_sum
 = 
$xy_sum
 = 
$yy_sum
 = 0.0;

369 
$i
 = 0; $˜< 
$this
->
v®ueCouÁ
; ++$i) {

370 
$xy_sum
 +ğ
$xV®ues
[
$i
] * 
$yV®ues
[$i];

371 
$xx_sum
 +ğ
$xV®ues
[
$i
] * $xValues[$i];

372 
$yy_sum
 +ğ
$yV®ues
[
$i
] * $yValues[$i];

374 ià(
$cÚ¡
) {

375 
$mBa£
 +ğ(
$xV®ues
[
$i
] - 
$m—nX
è* (
$yV®ues
[$i] - 
$m—nY
);

376 
$mDivisÜ
 +ğ(
$xV®ues
[
$i
] - 
$m—nX
) * ($xValues[$i] - $meanX);

378 
$mBa£
 +ğ
$xV®ues
[
$i
] * 
$yV®ues
[$i];

379 
$mDivisÜ
 +ğ
$xV®ues
[
$i
] * $xValues[$i];

385 
$this
->
¦İe
 = 
$mBa£
 / 
$mDivisÜ
;

389 ià(
$cÚ¡
) {

390 
$this
->
š‹r£ù
 = 
$m—nY
 - ($this->
¦İe
 * 
$m—nX
);

392 
$this
->
š‹r£ù
 = 0;

395 
$this
->
	`ÿlcuÏ‹GoodÃssOfF™
(
$x_sum
, 
$y_sum
, 
$xx_sum
, 
$yy_sum
, 
$xy_sum
, 
$m—nX
, 
$m—nY
, 
$cÚ¡
);

396 
	}
}

405 
public
 
funùiÚ
 
__cÚ¡ruù
(
$yV®ues
, 
$xV®ues
 = 
¬¿y
(), 
$cÚ¡
 = 
Œue
)

408 
$nY
 = 
couÁ
(
$yV®ues
);

409 
	g$nX
 = 
couÁ
(
$xV®ues
);

412 ià(
	g$nX
 == 0) {

413 
$xV®ues
 = 
¿nge
(1, 
$nY
);

414 
	g$nX
 = 
$nY
;

415 } 
–£if
 (
$nY
 !ğ
$nX
) {

417 
$this
->
”rÜ
 = 
Œue
;

418  
	gçl£
;

421 
	g$this
->
	gv®ueCouÁ
 = 
$nY
;

422 
	g$this
->
	gxV®ues
 = 
$xV®ues
;

423 
	g$this
->
	gyV®ues
 = 
$yV®ues
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/exponentialBestFitClass.php

1 <?
php


3 
»quœe_Úû
(
PHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/bestFitClass.php');

30 şas 
	cPHPExûl_ExpÚ’tŸl_Be¡_F™
 
ex‹nds
 
	mPHPExûl_Be¡_F™


38 
´Ùeùed
 
	m$be¡F™Ty³
 = 'exponential';

46 
public
 
funùiÚ
 
	$g‘V®ueOfYFÜX
(
$xV®ue
)

48  
$this
->
	`g‘IÁ”£ù
(è* 
	`pow
($this->
	`g‘Slİe
(), (
$xV®ue
 - $this->
xOff£t
));

57 
public
 
funùiÚ
 
	$g‘V®ueOfXFÜY
(
$yV®ue
)

59  
	`log
((
$yV®ue
 + 
$this
->
yOff£t
è/ $this->
	`g‘IÁ”£ù
()è/†og($this->
	`g‘Slİe
());

60 
	}
}

68 
public
 
funùiÚ
 
	$g‘Equ©iÚ
(
$dp
 = 0)

70 
$¦İe
 = 
$this
->
	`g‘Slİe
(
$dp
);

71 
$š‹r£ù
 = 
$this
->
	`g‘IÁ”£ù
(
$dp
);

73  'Y = ' . 
$š‹r£ù
 . ' * ' . 
$¦İe
 . '^X';

74 
	}
}

82 
public
 
funùiÚ
 
	$g‘Slİe
(
$dp
 = 0)

84 ià(
$dp
 != 0) {

85  
	`round
(
	`exp
(
$this
->
_¦İe
), 
$dp
);

87  
	`exp
(
$this
->
_¦İe
);

88 
	}
}

96 
public
 
funùiÚ
 
	$g‘IÁ”£ù
(
$dp
 = 0)

98 ià(
$dp
 != 0) {

99  
	`round
(
	`exp
(
$this
->
š‹r£ù
), 
$dp
);

101  
	`exp
(
$this
->
š‹r£ù
);

102 
	}
}

111 
´iv©e
 
funùiÚ
 
	$expÚ’tŸlReg»ssiÚ
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
)

113 
	`fÜ—ch
 (
$yV®ues
 
as
 &
$v®ue
) {

114 ià(
$v®ue
 < 0.0) {

115 
$v®ue
 = 0 - 
	`log
(
	`abs
($value));

116 } 
	`–£if
 (
$v®ue
 > 0.0) {

117 
$v®ue
 = 
	`log
($value);

120 
	`un£t
(
$v®ue
);

122 
$this
->
	`Ëa¡Squ¬eF™
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

123 
	}
}

132 
public
 
funùiÚ
 
__cÚ¡ruù
(
$yV®ues
, 
$xV®ues
 = 
¬¿y
(), 
$cÚ¡
 = 
Œue
)

134 ià(
·»Á
::
__cÚ¡ruù
(
$yV®ues
, 
$xV®ues
è!=ğ
çl£
) {

135 
$this
->
expÚ’tŸlReg»ssiÚ
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/linearBestFitClass.php

1 <?
php


3 
»quœe_Úû
(
PHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/bestFitClass.php');

30 şas 
	cPHPExûl_Lš—r_Be¡_F™
 
ex‹nds
 
	mPHPExûl_Be¡_F™


38 
´Ùeùed
 
	m$be¡F™Ty³
 = 'linear';

46 
public
 
funùiÚ
 
	$g‘V®ueOfYFÜX
(
$xV®ue
)

48  
$this
->
	`g‘IÁ”£ù
(è+ $this->
	`g‘Slİe
(è* 
$xV®ue
;

57 
public
 
funùiÚ
 
	$g‘V®ueOfXFÜY
(
$yV®ue
)

59  (
$yV®ue
 - 
$this
->
	`g‘IÁ”£ù
()è/ $this->
	`g‘Slİe
();

60 
	}
}

69 
public
 
funùiÚ
 
	$g‘Equ©iÚ
(
$dp
 = 0)

71 
$¦İe
 = 
$this
->
	`g‘Slİe
(
$dp
);

72 
$š‹r£ù
 = 
$this
->
	`g‘IÁ”£ù
(
$dp
);

74  'Y = ' . 
$š‹r£ù
 . ' + ' . 
$¦İe
 . ' * X';

75 
	}
}

84 
´iv©e
 
funùiÚ
 
	$lš—rReg»ssiÚ
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
)

86 
$this
->
	`Ëa¡Squ¬eF™
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

87 
	}
}

96 
public
 
funùiÚ
 
__cÚ¡ruù
(
$yV®ues
, 
$xV®ues
 = 
¬¿y
(), 
$cÚ¡
 = 
Œue
)

98 ià(
·»Á
::
__cÚ¡ruù
(
$yV®ues
, 
$xV®ues
è!=ğ
çl£
) {

99 
$this
->
lš—rReg»ssiÚ
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/logarithmicBestFitClass.php

1 <?
php


3 
»quœe_Úû
(
PHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/bestFitClass.php');

30 şas 
	cPHPExûl_Log¬™hmic_Be¡_F™
 
ex‹nds
 
	mPHPExûl_Be¡_F™


38 
´Ùeùed
 
	m$be¡F™Ty³
 = 'logarithmic';

46 
public
 
funùiÚ
 
	$g‘V®ueOfYFÜX
(
$xV®ue
)

48  
$this
->
	`g‘IÁ”£ù
(è+ $this->
	`g‘Slİe
(è* 
	`log
(
$xV®ue
 - $this->
xOff£t
);

57 
public
 
funùiÚ
 
	$g‘V®ueOfXFÜY
(
$yV®ue
)

59  
	`exp
((
$yV®ue
 - 
$this
->
	`g‘IÁ”£ù
()è/ $this->
	`g‘Slİe
());

60 
	}
}

68 
public
 
funùiÚ
 
	$g‘Equ©iÚ
(
$dp
 = 0)

70 
$¦İe
 = 
$this
->
	`g‘Slİe
(
$dp
);

71 
$š‹r£ù
 = 
$this
->
	`g‘IÁ”£ù
(
$dp
);

73  'Y = '.
$š‹r£ù
.' + '.
$¦İe
.' *†og(X)';

74 
	}
}

83 
´iv©e
 
funùiÚ
 
	$log¬™hmicReg»ssiÚ
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
)

85 
	`fÜ—ch
 (
$xV®ues
 
as
 &
$v®ue
) {

86 ià(
$v®ue
 < 0.0) {

87 
$v®ue
 = 0 - 
	`log
(
	`abs
($value));

88 } 
	`–£if
 (
$v®ue
 > 0.0) {

89 
$v®ue
 = 
	`log
($value);

92 
	`un£t
(
$v®ue
);

94 
$this
->
	`Ëa¡Squ¬eF™
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

95 
	}
}

104 
public
 
funùiÚ
 
__cÚ¡ruù
(
$yV®ues
, 
$xV®ues
 = 
¬¿y
(), 
$cÚ¡
 = 
Œue
)

106 ià(
·»Á
::
__cÚ¡ruù
(
$yV®ues
, 
$xV®ues
è!=ğ
çl£
) {

107 
$this
->
log¬™hmicReg»ssiÚ
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/polynomialBestFitClass.php

1 <?
php


3 
»quœe_Úû
 
	gPHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/bestFitClass.php';

4 
»quœe_Úû
 
	gPHPEXCEL_ROOT
 . 'PHPExcel/Shared/JAMA/Matrix.php';

31 şas 
	cPHPExûl_PŞynomŸl_Be¡_F™
 
ex‹nds
 
	mPHPExûl_Be¡_F™


39 
´Ùeùed
 
	m$be¡F™Ty³
 = 'polynomial';

47 
´Ùeùed
 
	m$Üd”
 = 0;

55 
public
 
funùiÚ
 
	$g‘Ord”
()

57  
$this
->
Üd”
;

67 
public
 
funùiÚ
 
	$g‘V®ueOfYFÜX
(
$xV®ue
)

69 
$»tV®
 = 
$this
->
	`g‘IÁ”£ù
();

70 
$¦İe
 = 
$this
->
	`g‘Slİe
();

71 
	`fÜ—ch
 (
$¦İe
 
as
 
$key
 => 
$v®ue
) {

72 ià(
$v®ue
 != 0.0) {

73 
$»tV®
 +ğ
$v®ue
 * 
	`pow
(
$xV®ue
, 
$key
 + 1);

76  
$»tV®
;

77 
	}
}

86 
public
 
funùiÚ
 
	$g‘V®ueOfXFÜY
(
$yV®ue
)

88  (
$yV®ue
 - 
$this
->
	`g‘IÁ”£ù
()è/ $this->
	`g‘Slİe
();

89 
	}
}

98 
public
 
funùiÚ
 
	$g‘Equ©iÚ
(
$dp
 = 0)

100 
$¦İe
 = 
$this
->
	`g‘Slİe
(
$dp
);

101 
$š‹r£ù
 = 
$this
->
	`g‘IÁ”£ù
(
$dp
);

103 
$equ©iÚ
 = 'Y = ' . 
$š‹r£ù
;

104 
	`fÜ—ch
 (
$¦İe
 
as
 
$key
 => 
$v®ue
) {

105 ià(
$v®ue
 != 0.0) {

106 
$equ©iÚ
 .ğ' + ' . 
$v®ue
 . ' * X';

107 ià(
$key
 > 0) {

108 
$equ©iÚ
 .ğ'^' . (
$key
 + 1);

112  
$equ©iÚ
;

113 
	}
}

122 
public
 
funùiÚ
 
	$g‘Slİe
(
$dp
 = 0)

124 ià(
$dp
 != 0) {

125 
$cÛffic›Ás
 = 
	`¬¿y
();

126 
	`fÜ—ch
 (
$this
->
_¦İe
 
as
 
$cÛffic›Á
) {

127 
$cÛffic›Ás
[] = 
	`round
(
$cÛffic›Á
, 
$dp
);

129  
$cÛffic›Ás
;

131  
$this
->
_¦İe
;

132 
	}
}

135 
public
 
funùiÚ
 
	$g‘CÛffic›Ás
(
$dp
 = 0)

137  
	`¬¿y_m”ge
(
	`¬¿y
(
$this
->
	`g‘IÁ”£ù
(
$dp
)), $this->
	`g‘Slİe
($dp));

138 
	}
}

149 
´iv©e
 
funùiÚ
 
	$pŞynomŸlReg»ssiÚ
(
$Üd”
, 
$yV®ues
, 
$xV®ues
, 
$cÚ¡
)

152 
$x_sum
 = 
	`¬¿y_sum
(
$xV®ues
);

153 
$y_sum
 = 
	`¬¿y_sum
(
$yV®ues
);

154 
$xx_sum
 = 
$xy_sum
 = 0;

155 
$i
 = 0; $˜< 
$this
->
v®ueCouÁ
; ++$i) {

156 
$xy_sum
 +ğ
$xV®ues
[
$i
] * 
$yV®ues
[$i];

157 
$xx_sum
 +ğ
$xV®ues
[
$i
] * $xValues[$i];

158 
$yy_sum
 +ğ
$yV®ues
[
$i
] * $yValues[$i];

168 
$i
 = 0; $˜< 
$this
->
v®ueCouÁ
; ++$i) {

169 
$j
 = 0; $j <ğ
$Üd”
; ++$j) {

170 
$A
[
$i
][
$j
] = 
	`pow
(
$xV®ues
[$i], $j);

173 
$i
=0; $˜< 
$this
->
v®ueCouÁ
; ++$i) {

174 
$B
[
$i
] = 
	`¬¿y
(
$yV®ues
[$i]);

176 
$m©rixA
 = 
Ãw
 
	`M©rix
(
$A
);

177 
$m©rixB
 = 
Ãw
 
	`M©rix
(
$B
);

178 
$C
 = 
$m©rixA
->
	`sŞve
(
$m©rixB
);

180 
$cÛffic›Ás
 = 
	`¬¿y
();

181 
$i
 = 0; $˜< 
$C
->
m
; ++$i) {

182 
$r
 = 
$C
->
	`g‘
(
$i
, 0);

183 ià(
	`abs
(
$r
è<ğ
	`pow
(10, -9)) {

184 
$r
 = 0;

186 
$cÛffic›Ás
[] = 
$r
;

189 
$this
->
š‹r£ù
 = 
	`¬¿y_shiá
(
$cÛffic›Ás
);

190 
$this
->
_¦İe
 = 
$cÛffic›Ás
;

192 
$this
->
	`ÿlcuÏ‹GoodÃssOfF™
(
$x_sum
, 
$y_sum
, 
$xx_sum
, 
$yy_sum
, 
$xy_sum
);

193 
	`fÜ—ch
 (
$this
->
xV®ues
 
as
 
$xKey
 => 
$xV®ue
) {

194 
$this
->
yBe¡F™V®ues
[
$xKey
] = $this->
	`g‘V®ueOfYFÜX
(
$xV®ue
);

196 
	}
}

207 
public
 
funùiÚ
 
__cÚ¡ruù
(
$Üd”
, 
$yV®ues
, 
$xV®ues
 = 
¬¿y
(), 
$cÚ¡
 = 
Œue
)

209 ià(
·»Á
::
__cÚ¡ruù
(
$yV®ues
, 
$xV®ues
è!=ğ
çl£
) {

210 ià(
$Üd”
 < 
$this
->
v®ueCouÁ
) {

211 
$this
->
be¡F™Ty³
 .ğ'_'.
$Üd”
;

212 
	g$this
->
	gÜd”
 = 
$Üd”
;

213 
	g$this
->
pŞynomŸlReg»ssiÚ
(
$Üd”
, 
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

214 ià((
	g$this
->
g‘GoodÃssOfF™
() < 0.0) || ($this->getGoodnessOfFit() > 1.0)) {

215 
	g$this
->
	g_”rÜ
 = 
Œue
;

218 
	g$this
->
	g_”rÜ
 = 
Œue
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/powerBestFitClass.php

1 <?
php


3 
»quœe_Úû
 
	gPHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/bestFitClass.php';

30 şas 
	cPHPExûl_Pow”_Be¡_F™
 
ex‹nds
 
	mPHPExûl_Be¡_F™


38 
´Ùeùed
 
	m$be¡F™Ty³
 = 'power';

47 
public
 
funùiÚ
 
	$g‘V®ueOfYFÜX
(
$xV®ue
)

49  
$this
->
	`g‘IÁ”£ù
(è* 
	`pow
((
$xV®ue
 - $this->
xOff£t
), $this->
	`g‘Slİe
());

59 
public
 
funùiÚ
 
	$g‘V®ueOfXFÜY
(
$yV®ue
)

61  
	`pow
(((
$yV®ue
 + 
$this
->
yOff£t
è/ $this->
	`g‘IÁ”£ù
()), (1 / $this->
	`g‘Slİe
()));

62 
	}
}

71 
public
 
funùiÚ
 
	$g‘Equ©iÚ
(
$dp
 = 0)

73 
$¦İe
 = 
$this
->
	`g‘Slİe
(
$dp
);

74 
$š‹r£ù
 = 
$this
->
	`g‘IÁ”£ù
(
$dp
);

76  'Y = ' . 
$š‹r£ù
 . ' * X^' . 
$¦İe
;

77 
	}
}

86 
public
 
funùiÚ
 
	$g‘IÁ”£ù
(
$dp
 = 0)

88 ià(
$dp
 != 0) {

89  
	`round
(
	`exp
(
$this
->
š‹r£ù
), 
$dp
);

91  
	`exp
(
$this
->
š‹r£ù
);

92 
	}
}

102 
´iv©e
 
funùiÚ
 
	$pow”Reg»ssiÚ
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
)

104 
	`fÜ—ch
 (
$xV®ues
 
as
 &
$v®ue
) {

105 ià(
$v®ue
 < 0.0) {

106 
$v®ue
 = 0 - 
	`log
(
	`abs
($value));

107 } 
	`–£if
 (
$v®ue
 > 0.0) {

108 
$v®ue
 = 
	`log
($value);

111 
	`un£t
(
$v®ue
);

112 
	`fÜ—ch
 (
$yV®ues
 
as
 &
$v®ue
) {

113 ià(
$v®ue
 < 0.0) {

114 
$v®ue
 = 0 - 
	`log
(
	`abs
($value));

115 } 
	`–£if
 (
$v®ue
 > 0.0) {

116 
$v®ue
 = 
	`log
($value);

119 
	`un£t
(
$v®ue
);

121 
$this
->
	`Ëa¡Squ¬eF™
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

122 
	}
}

132 
public
 
funùiÚ
 
__cÚ¡ruù
(
$yV®ues
, 
$xV®ues
 = 
¬¿y
(), 
$cÚ¡
 = 
Œue
)

134 ià(
·»Á
::
__cÚ¡ruù
(
$yV®ues
, 
$xV®ues
è!=ğ
çl£
) {

135 
$this
->
pow”Reg»ssiÚ
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/trendClass.php

1 <?
php


3 
»quœe_Úû
 
	gPHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/linearBestFitClass.php';

4 
»quœe_Úû
 
	gPHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/logarithmicBestFitClass.php';

5 
»quœe_Úû
 
	gPHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/exponentialBestFitClass.php';

6 
»quœe_Úû
 
	gPHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/powerBestFitClass.php';

7 
»quœe_Úû
 
	gPHPEXCEL_ROOT
 . 'PHPExcel/Shared/trend/polynomialBestFitClass.php';

34 şas 
	cŒ’dCÏss


36 cÚ¡ 
	mTREND_LINEAR
 = 'Linear';

37 cÚ¡ 
	mTREND_LOGARITHMIC
 = 'Logarithmic';

38 cÚ¡ 
	mTREND_EXPONENTIAL
 = 'Exponential';

39 cÚ¡ 
	mTREND_POWER
 = 'Power';

40 cÚ¡ 
	mTREND_POLYNOMIAL_2
 = 'Polynomial_2';

41 cÚ¡ 
	mTREND_POLYNOMIAL_3
 = 'Polynomial_3';

42 cÚ¡ 
	mTREND_POLYNOMIAL_4
 = 'Polynomial_4';

43 cÚ¡ 
	mTREND_POLYNOMIAL_5
 = 'Polynomial_5';

44 cÚ¡ 
	mTREND_POLYNOMIAL_6
 = 'Polynomial_6';

45 cÚ¡ 
	mTREND_BEST_FIT
 = 'Bestfit';

46 cÚ¡ 
	mTREND_BEST_FIT_NO_POLY
 = 'Bestfit_no_Polynomials';

53 
´iv©e
 
	m$Œ’dTy³s
 = 
¬¿y
(

54 
£lf
::
TREND_LINEAR
,

55 
£lf
::
TREND_LOGARITHMIC
,

56 
£lf
::
TREND_EXPONENTIAL
,

57 
£lf
::
TREND_POWER


65 
´iv©e
 
	m$Œ’dTy³PŞynomŸlOrd”s
 = 
¬¿y
(

66 
£lf
::
TREND_POLYNOMIAL_2
,

67 
£lf
::
TREND_POLYNOMIAL_3
,

68 
£lf
::
TREND_POLYNOMIAL_4
,

69 
£lf
::
TREND_POLYNOMIAL_5
,

70 
£lf
::
TREND_POLYNOMIAL_6


78 
´iv©e
 
	m$Œ’dCache
 = 
¬¿y
();

81 
public
 
funùiÚ
 
ÿlcuÏ‹
(
$Œ’dTy³
 = 
£lf
::
TREND_BEST_FIT
, 
$yV®ues
, 
$xV®ues
 = 
¬¿y
(), 
$cÚ¡
 = 
Œue
)

84 
$nY
 = 
couÁ
(
$yV®ues
);

85 
	m$nX
 = 
couÁ
(
$xV®ues
);

88 ià(
	m$nX
 == 0) {

89 
$xV®ues
 = 
¿nge
(1, 
$nY
);

90 
	m$nX
 = 
$nY
;

91 } 
–£if
 (
$nY
 !ğ
$nX
) {

93 
Œigg”_”rÜ
("Œ’d(): Numb” oà–em’t š coÜdš©¬¿y dØnÙ m©ch.", 
E_USER_ERROR
);

96 
	m$key
 = 
md5
(
$Œ’dTy³
.
$cÚ¡
.
£rŸlize
(
$yV®ues
).£rŸlize(
$xV®ues
));

98 
	m$Œ’dTy³
) {

100 
	m£lf
::
TREND_LINEAR
:

101 
£lf
::
TREND_LOGARITHMIC
:

102 
£lf
::
TREND_EXPONENTIAL
:

103 
£lf
::
TREND_POWER
:

104 ià(!
is£t
(
£lf
::
$Œ’dCache
[
$key
])) {

105 
$şassName
 = 'PHPExûl_'.
$Œ’dTy³
.'_Best_Fit';

106 
	m£lf
::
$Œ’dCache
[
$key
] = 
Ãw
 
$şassName
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

108  
	m£lf
::
$Œ’dCache
[
$key
];

109 
	m£lf
::
TREND_POLYNOMIAL_2
:

110 
£lf
::
TREND_POLYNOMIAL_3
:

111 
£lf
::
TREND_POLYNOMIAL_4
:

112 
£lf
::
TREND_POLYNOMIAL_5
:

113 
£lf
::
TREND_POLYNOMIAL_6
:

114 ià(!
is£t
(
£lf
::
$Œ’dCache
[
$key
])) {

115 
$Üd”
 = 
sub¡r
(
$Œ’dTy³
, -1);

116 
	m£lf
::
$Œ’dCache
[
$key
] = 
Ãw
 
PHPExûl_PŞynomŸl_Be¡_F™
(
$Üd”
, 
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

118  
	m£lf
::
$Œ’dCache
[
$key
];

119 
	m£lf
::
TREND_BEST_FIT
:

120 
£lf
::
TREND_BEST_FIT_NO_POLY
:

123 
fÜ—ch
 (
£lf
::
$Œ’dTy³s
 
as
 
$Œ’dM‘hod
) {

124 
$şassName
 = 'PHPExûl_'.
$Œ’dM‘hod
.'BestFit';

125 
	m$be¡F™
[
$Œ’dM‘hod
] = 
Ãw
 
$şassName
(
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

126 
	m$be¡F™V®ue
[
$Œ’dM‘hod
] = 
$be¡F™
[$Œ’dM‘hod]->
g‘GoodÃssOfF™
();

128 ià(
	m$Œ’dTy³
 !ğ
£lf
::
TREND_BEST_FIT_NO_POLY
) {

129 
fÜ—ch
 (
£lf
::
$Œ’dTy³PŞynomŸlOrd”s
 
as
 
$Œ’dM‘hod
) {

130 
$Üd”
 = 
sub¡r
(
$Œ’dM‘hod
, -1);

131 
	m$be¡F™
[
$Œ’dM‘hod
] = 
Ãw
 
PHPExûl_PŞynomŸl_Be¡_F™
(
$Üd”
, 
$yV®ues
, 
$xV®ues
, 
$cÚ¡
);

132 ià(
	m$be¡F™
[
$Œ’dM‘hod
]->
g‘E¼Ü
()) {

133 
un£t
(
$be¡F™
[
$Œ’dM‘hod
]);

135 
	m$be¡F™V®ue
[
$Œ’dM‘hod
] = 
$be¡F™
[$Œ’dM‘hod]->
g‘GoodÃssOfF™
();

140 
¬sÜt
(
$be¡F™V®ue
);

141 
	m$be¡F™Ty³
 = 
key
(
$be¡F™V®ue
);

142  
	m$be¡F™
[
$be¡F™Ty³
];

144  
çl£
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style.php

1 <?
php


28 şas 
	cPHPExûl_StyË
 
ex‹nds
 
PHPExûl_StyË_Su³rvisÜ
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


35 
´Ùeùed
 
	m$fÚt
;

42 
´Ùeùed
 
	m$fl
;

49 
´Ùeùed
 
	m$bÜd”s
;

56 
´Ùeùed
 
	m$®ignm’t
;

63 
´Ùeùed
 
	m$numb”FÜm©
;

70 
´Ùeùed
 
	m$cÚd™iÚ®StyËs
;

77 
´Ùeùed
 
	m$´ÙeùiÚ
;

84 
´Ùeùed
 
	m$šdex
;

91 
´Ùeùed
 
	m$quÙeP»fix
 = 
çl£
;

103 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$isSu³rvisÜ
 = 
çl£
, 
$isCÚd™iÚ®
 = false)

106 
$this
->
isSu³rvisÜ
 = 
$isSu³rvisÜ
;

109 
$this
->
cÚd™iÚ®StyËs
 = 
	`¬¿y
();

110 
$this
->
fÚt
 = 
Ãw
 
	`PHPExûl_StyË_FÚt
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

111 
$this
->
fl
 = 
Ãw
 
	`PHPExûl_StyË_Fl
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

112 
$this
->
bÜd”s
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”s
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

113 
$this
->
®ignm’t
 = 
Ãw
 
	`PHPExûl_StyË_Alignm’t
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

114 
$this
->
numb”FÜm©
 = 
Ãw
 
	`PHPExûl_StyË_Numb”FÜm©
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

115 
$this
->
´ÙeùiÚ
 = 
Ãw
 
	`PHPExûl_StyË_PrÙeùiÚ
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

118 ià(
$isSu³rvisÜ
) {

119 
$this
->
fÚt
->
	`bšdP¬’t
($this);

120 
$this
->
fl
->
	`bšdP¬’t
($this);

121 
$this
->
bÜd”s
->
	`bšdP¬’t
($this);

122 
$this
->
®ignm’t
->
	`bšdP¬’t
($this);

123 
$this
->
numb”FÜm©
->
	`bšdP¬’t
($this);

124 
$this
->
´ÙeùiÚ
->
	`bšdP¬’t
($this);

134 
public
 
funùiÚ
 
	$g‘Sh¬edCompÚ’t
()

136 
$aùiveSh“t
 = 
$this
->
	`g‘AùiveSh“t
();

137 
$£ËùedC–l
 = 
$this
->
	`g‘AùiveC–l
();

139 ià(
$aùiveSh“t
->
	`ûÎExi¡s
(
$£ËùedC–l
)) {

140 
$xfIndex
 = 
$aùiveSh“t
->
	`g‘C–l
(
$£ËùedC–l
)->
	`g‘XfIndex
();

142 
$xfIndex
 = 0;

145  
$this
->
·»Á
->
	`g‘C–lXfByIndex
(
$xfIndex
);

146 
	}
}

153 
public
 
funùiÚ
 
	$g‘P¬’t
()

155  
$this
->
·»Á
;

156 
	}
}

164 
public
 
funùiÚ
 
	$g‘StyËA¼ay
(
$¬¿y
)

166  
	`¬¿y
('quÙeP»fix' => 
$¬¿y
);

167 
	}
}

209 
public
 
funùiÚ
 
	$­¶yFromA¼ay
(
$pStyËs
 = 
nuÎ
, 
$pAdvªûd
 = 
Œue
)

211 ià(
	`is_¬¿y
(
$pStyËs
)) {

212 ià(
$this
->
isSu³rvisÜ
) {

213 
$pRªge
 = 
$this
->
	`g‘S–eùedC–ls
();

216 
$pRªge
 = 
	`¡¹ouµ”
($pRange);

219 ià(
	`¡½os
(
$pRªge
, ':'è==ğ
çl£
) {

220 
$¿ngeA
 = 
$pRªge
;

221 
$¿ngeB
 = 
$pRªge
;

223 
	`li¡
(
$¿ngeA
, 
$¿ngeB
èğ
	`ex¶ode
(':', 
$pRªge
);

227 
$¿ngeS¹
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$¿ngeA
);

228 
$¿ngeEnd
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$¿ngeB
);

231 
$¿ngeS¹
[0] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($rangeStart[0]) - 1;

232 
$¿ngeEnd
[0] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($rangeEnd[0]) - 1;

235 ià(
$¿ngeS¹
[0] > 
$¿ngeEnd
[0] && $rangeStart[1] > $rangeEnd[1]) {

236 
$tmp
 = 
$¿ngeS¹
;

237 
$¿ngeS¹
 = 
$¿ngeEnd
;

238 
$¿ngeEnd
 = 
$tmp
;

242 ià(
$pAdvªûd
 && 
	`is£t
(
$pStyËs
['borders'])) {

245 ià(
	`is£t
(
$pStyËs
['borders']['allborders'])) {

246 
	`fÜ—ch
 (
	`¬¿y
('ouše', 'šside'è
as
 
$compÚ’t
) {

247 ià(!
	`is£t
(
$pStyËs
['bÜd”s'][
$compÚ’t
])) {

248 
$pStyËs
['bÜd”s'][
$compÚ’t
] = $pStyles['borders']['allborders'];

251 
	`un£t
(
$pStyËs
['borders']['allborders']);

255 ià(
	`is£t
(
$pStyËs
['borders']['outline'])) {

256 
	`fÜ—ch
 (
	`¬¿y
('tİ', 'right', 'bÙtom', 'Ëá'è
as
 
$compÚ’t
) {

257 ià(!
	`is£t
(
$pStyËs
['bÜd”s'][
$compÚ’t
])) {

258 
$pStyËs
['bÜd”s'][
$compÚ’t
] = $pStyles['borders']['outline'];

261 
	`un£t
(
$pStyËs
['borders']['outline']);

265 ià(
	`is£t
(
$pStyËs
['borders']['inside'])) {

266 
	`fÜ—ch
 (
	`¬¿y
('v”tiÿl', 'hÜizÚl'è
as
 
$compÚ’t
) {

267 ià(!
	`is£t
(
$pStyËs
['bÜd”s'][
$compÚ’t
])) {

268 
$pStyËs
['bÜd”s'][
$compÚ’t
] = $pStyles['borders']['inside'];

271 
	`un£t
(
$pStyËs
['borders']['inside']);

274 
$xMax
 = 
	`mš
(
$¿ngeEnd
[0] - 
$¿ngeS¹
[0] + 1, 3);

275 
$yMax
 = 
	`mš
(
$¿ngeEnd
[1] - 
$¿ngeS¹
[1] + 1, 3);

278 
$x
 = 1; $x <ğ
$xMax
; ++$x) {

280 
$cŞS¹
 = (
$x
 == 3) ?

281 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$¿ngeEnd
[0])

282 : 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$¿ngeS¹
[0] + 
$x
 - 1);

284 
$cŞEnd
 = (
$x
 == 1) ?

285 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$¿ngeS¹
[0])

286 : 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$¿ngeEnd
[0] - 
$xMax
 + 
$x
);

288 
$y
 = 1; $y <ğ
$yMax
; ++$y) {

290 
$edges
 = 
	`¬¿y
();

291 ià(
$x
 == 1) {

293 
$edges
[] = 'left';

295 ià(
$x
 =ğ
$xMax
) {

297 
$edges
[] = 'right';

299 ià(
$y
 == 1) {

301 
$edges
[] = 'top';

303 ià(
$y
 =ğ
$yMax
) {

305 
$edges
[] = 'bottom';

309 
$rowS¹
 = (
$y
 == 3) ?

310 
$¿ngeEnd
[1] : 
$¿ngeS¹
[1] + 
$y
 - 1;

313 
$rowEnd
 = (
$y
 == 1) ?

314 
$¿ngeS¹
[1] : 
$¿ngeEnd
[1] - 
$yMax
 + 
$y
;

317 
$¿nge
 = 
$cŞS¹
 . 
$rowS¹
 . ':' . 
$cŞEnd
 . 
$rowEnd
;

320 
$»giÚStyËs
 = 
$pStyËs
;

321 
	`un£t
(
$»giÚStyËs
['borders']['inside']);

324 
$šÃrEdges
 = 
	`¬¿y_diff
(
	`¬¿y
('tİ', 'right', 'bÙtom', 'Ëá'), 
$edges
);

327 
	`fÜ—ch
 (
$šÃrEdges
 
as
 
$šÃrEdge
) {

328 
$šÃrEdge
) {

332 ià(
	`is£t
(
$pStyËs
['borders']['horizontal'])) {

333 
$»giÚStyËs
['bÜd”s'][
$šÃrEdge
] = 
$pStyËs
['borders']['horizontal'];

335 
	`un£t
(
$»giÚStyËs
['bÜd”s'][
$šÃrEdge
]);

341 ià(
	`is£t
(
$pStyËs
['borders']['vertical'])) {

342 
$»giÚStyËs
['bÜd”s'][
$šÃrEdge
] = 
$pStyËs
['borders']['vertical'];

344 
	`un£t
(
$»giÚStyËs
['bÜd”s'][
$šÃrEdge
]);

351 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
(
$¿nge
)->
	`­¶yFromA¼ay
(
$»giÚStyËs
, 
çl£
);

354  
$this
;

359 ià(
	`´eg_m©ch
('/^[A-Z]+1:[A-Z]+1048576$/', 
$pRªge
)) {

360 
$£ËùiÚTy³
 = 'COLUMN';

361 } 
	`–£if
 (
	`´eg_m©ch
('/^A[0-9]+:XFD[0-9]+$/', 
$pRªge
)) {

362 
$£ËùiÚTy³
 = 'ROW';

364 
$£ËùiÚTy³
 = 'CELL';

368 
$£ËùiÚTy³
) {

370 
$ŞdXfIndexes
 = 
	`¬¿y
();

371 
$cŞ
 = 
$¿ngeS¹
[0]; $cŞ <ğ
$¿ngeEnd
[0]; ++$col) {

372 
$ŞdXfIndexes
[
$this
->
	`g‘AùiveSh“t
()->
	`g‘CŞumnDim’siÚByCŞumn
(
$cŞ
)->
	`g‘XfIndex
()] = 
Œue
;

376 
$ŞdXfIndexes
 = 
	`¬¿y
();

377 
$row
 = 
$¿ngeS¹
[1]; $row <ğ
$¿ngeEnd
[1]; ++$row) {

378 ià(
$this
->
	`g‘AùiveSh“t
()->
	`g‘RowDim’siÚ
(
$row
)->
	`g‘XfIndex
(è=ğ
nuÎ
) {

379 
$ŞdXfIndexes
[0] = 
Œue
;

381 
$ŞdXfIndexes
[
$this
->
	`g‘AùiveSh“t
()->
	`g‘RowDim’siÚ
(
$row
)->
	`g‘XfIndex
()] = 
Œue
;

386 
$ŞdXfIndexes
 = 
	`¬¿y
();

387 
$cŞ
 = 
$¿ngeS¹
[0]; $cŞ <ğ
$¿ngeEnd
[0]; ++$col) {

388 
$row
 = 
$¿ngeS¹
[1]; $row <ğ
$¿ngeEnd
[1]; ++$row) {

389 
$ŞdXfIndexes
[
$this
->
	`g‘AùiveSh“t
()->
	`g‘C–lByCŞumnAndRow
(
$cŞ
, 
$row
)->
	`g‘XfIndex
()] = 
Œue
;

396 
$wÜkbook
 = 
$this
->
	`g‘AùiveSh“t
()->
	`g‘P¬’t
();

397 
	`fÜ—ch
 (
$ŞdXfIndexes
 
as
 
$ŞdXfIndex
 => 
$dummy
) {

398 
$¡yË
 = 
$wÜkbook
->
	`g‘C–lXfByIndex
(
$ŞdXfIndex
);

399 
$ÃwStyË
 = 
şÚe
 
$¡yË
;

400 
$ÃwStyË
->
	`­¶yFromA¼ay
(
$pStyËs
);

402 ià(
$exi¡šgStyË
 = 
$wÜkbook
->
	`g‘C–lXfByHashCode
(
$ÃwStyË
->
	`g‘HashCode
())) {

404 
$ÃwXfIndexes
[
$ŞdXfIndex
] = 
$exi¡šgStyË
->
	`g‘Index
();

407 
$wÜkbook
->
	`addC–lXf
(
$ÃwStyË
);

408 
$ÃwXfIndexes
[
$ŞdXfIndex
] = 
$ÃwStyË
->
	`g‘Index
();

413 
$£ËùiÚTy³
) {

415 
$cŞ
 = 
$¿ngeS¹
[0]; $cŞ <ğ
$¿ngeEnd
[0]; ++$col) {

416 
$cŞumnDim’siÚ
 = 
$this
->
	`g‘AùiveSh“t
()->
	`g‘CŞumnDim’siÚByCŞumn
(
$cŞ
);

417 
$ŞdXfIndex
 = 
$cŞumnDim’siÚ
->
	`g‘XfIndex
();

418 
$cŞumnDim’siÚ
->
	`£tXfIndex
(
$ÃwXfIndexes
[
$ŞdXfIndex
]);

423 
$row
 = 
$¿ngeS¹
[1]; $row <ğ
$¿ngeEnd
[1]; ++$row) {

424 
$rowDim’siÚ
 = 
$this
->
	`g‘AùiveSh“t
()->
	`g‘RowDim’siÚ
(
$row
);

425 
$ŞdXfIndex
 = 
$rowDim’siÚ
->
	`g‘XfIndex
(è==ğ
nuÎ
 ?

426 0 : 
$rowDim’siÚ
->
	`g‘XfIndex
();

427 
$rowDim’siÚ
->
	`£tXfIndex
(
$ÃwXfIndexes
[
$ŞdXfIndex
]);

432 
$cŞ
 = 
$¿ngeS¹
[0]; $cŞ <ğ
$¿ngeEnd
[0]; ++$col) {

433 
$row
 = 
$¿ngeS¹
[1]; $row <ğ
$¿ngeEnd
[1]; ++$row) {

434 
$ûÎ
 = 
$this
->
	`g‘AùiveSh“t
()->
	`g‘C–lByCŞumnAndRow
(
$cŞ
, 
$row
);

435 
$ŞdXfIndex
 = 
$ûÎ
->
	`g‘XfIndex
();

436 
$ûÎ
->
	`£tXfIndex
(
$ÃwXfIndexes
[
$ŞdXfIndex
]);

444 ià(
	`¬¿y_key_exi¡s
('fl', 
$pStyËs
)) {

445 
$this
->
	`g‘Fl
()->
	`­¶yFromA¼ay
(
$pStyËs
['fill']);

447 ià(
	`¬¿y_key_exi¡s
('fÚt', 
$pStyËs
)) {

448 
$this
->
	`g‘FÚt
()->
	`­¶yFromA¼ay
(
$pStyËs
['font']);

450 ià(
	`¬¿y_key_exi¡s
('bÜd”s', 
$pStyËs
)) {

451 
$this
->
	`g‘BÜd”s
()->
	`­¶yFromA¼ay
(
$pStyËs
['borders']);

453 ià(
	`¬¿y_key_exi¡s
('®ignm’t', 
$pStyËs
)) {

454 
$this
->
	`g‘Alignm’t
()->
	`­¶yFromA¼ay
(
$pStyËs
['alignment']);

456 ià(
	`¬¿y_key_exi¡s
('numb”fÜm©', 
$pStyËs
)) {

457 
$this
->
	`g‘Numb”FÜm©
()->
	`­¶yFromA¼ay
(
$pStyËs
['numberformat']);

459 ià(
	`¬¿y_key_exi¡s
('´ÙeùiÚ', 
$pStyËs
)) {

460 
$this
->
	`g‘PrÙeùiÚ
()->
	`­¶yFromA¼ay
(
$pStyËs
['protection']);

462 ià(
	`¬¿y_key_exi¡s
('quÙeP»fix', 
$pStyËs
)) {

463 
$this
->
quÙeP»fix
 = 
$pStyËs
['quotePrefix'];

467 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid style‡rray…assed.");

469  
$this
;

470 
	}
}

477 
public
 
funùiÚ
 
	$g‘Fl
()

479  
$this
->
fl
;

480 
	}
}

487 
public
 
funùiÚ
 
	$g‘FÚt
()

489  
$this
->
fÚt
;

490 
	}
}

498 
public
 
funùiÚ
 
	$£tFÚt
(
PHPExûl_StyË_FÚt
 
$fÚt
)

500 
$this
->
fÚt
 = 
$fÚt
;

501  
$this
;

502 
	}
}

509 
public
 
funùiÚ
 
	$g‘BÜd”s
()

511  
$this
->
bÜd”s
;

512 
	}
}

519 
public
 
funùiÚ
 
	$g‘Alignm’t
()

521  
$this
->
®ignm’t
;

522 
	}
}

529 
public
 
funùiÚ
 
	$g‘Numb”FÜm©
()

531  
$this
->
numb”FÜm©
;

532 
	}
}

539 
public
 
funùiÚ
 
	$g‘CÚd™iÚ®StyËs
()

541  
$this
->
	`g‘AùiveSh“t
()->
	`g‘CÚd™iÚ®StyËs
($this->
	`g‘AùiveC–l
());

542 
	}
}

550 
public
 
funùiÚ
 
	$£tCÚd™iÚ®StyËs
(
$pV®ue
 = 
nuÎ
)

552 ià(
	`is_¬¿y
(
$pV®ue
)) {

553 
$this
->
	`g‘AùiveSh“t
()->
	`£tCÚd™iÚ®StyËs
($this->
	`g‘S–eùedC–ls
(), 
$pV®ue
);

555  
$this
;

556 
	}
}

563 
public
 
funùiÚ
 
	$g‘PrÙeùiÚ
()

565  
$this
->
´ÙeùiÚ
;

566 
	}
}

573 
public
 
funùiÚ
 
	$g‘QuÙeP»fix
()

575 ià(
$this
->
isSu³rvisÜ
) {

576  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘QuÙeP»fix
();

578  
$this
->
quÙeP»fix
;

579 
	}
}

586 
public
 
funùiÚ
 
	$£tQuÙeP»fix
(
$pV®ue
)

588 ià(
$pV®ue
 == '') {

589 
$pV®ue
 = 
çl£
;

591 ià(
$this
->
isSu³rvisÜ
) {

592 
$¡yËA¼ay
 = 
	`¬¿y
('quÙeP»fix' => 
$pV®ue
);

593 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

595 
$this
->
quÙeP»fix
 = (
boŞ—n
è
$pV®ue
;

597  
$this
;

598 
	}
}

605 
public
 
funùiÚ
 
	$g‘HashCode
()

607 
$hashCÚd™iÚ®s
 = '';

608 
	`fÜ—ch
 (
$this
->
cÚd™iÚ®StyËs
 
as
 
$cÚd™iÚ®
) {

609 
$hashCÚd™iÚ®s
 .ğ
$cÚd™iÚ®
->
	`g‘HashCode
();

612  
	`md5
(

613 
$this
->
fl
->
	`g‘HashCode
() .

614 
$this
->
fÚt
->
	`g‘HashCode
() .

615 
$this
->
bÜd”s
->
	`g‘HashCode
() .

616 
$this
->
®ignm’t
->
	`g‘HashCode
() .

617 
$this
->
numb”FÜm©
->
	`g‘HashCode
() .

618 
$hashCÚd™iÚ®s
 .

619 
$this
->
´ÙeùiÚ
->
	`g‘HashCode
() .

620 (
$this
->
quÙeP»fix
 ? 't' : 'f') .

621 
__CLASS__


623 
	}
}

630 
public
 
funùiÚ
 
	$g‘Index
()

632  
$this
->
šdex
;

633 
	}
}

640 
public
 
funùiÚ
 
	$£tIndex
(
$pV®ue
)

642 
$this
->
šdex
 = 
$pV®ue
;

643 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Alignment.php

1 <?
php


27 şas 
	cPHPExûl_StyË_Alignm’t
 
ex‹nds
 
PHPExûl_StyË_Su³rvisÜ
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


30 cÚ¡ 
	mHORIZONTAL_GENERAL
 = 'general';

31 cÚ¡ 
	mHORIZONTAL_LEFT
 = 'left';

32 cÚ¡ 
	mHORIZONTAL_RIGHT
 = 'right';

33 cÚ¡ 
	mHORIZONTAL_CENTER
 = 'center';

34 cÚ¡ 
	mHORIZONTAL_CENTER_CONTINUOUS
 = 'centerContinuous';

35 cÚ¡ 
	mHORIZONTAL_JUSTIFY
 = 'justify';

36 cÚ¡ 
	mHORIZONTAL_FILL
 = 'fill';

37 cÚ¡ 
	mHORIZONTAL_DISTRIBUTED
 = 'distributed';

40 cÚ¡ 
	mVERTICAL_BOTTOM
 = 'bottom';

41 cÚ¡ 
	mVERTICAL_TOP
 = 'top';

42 cÚ¡ 
	mVERTICAL_CENTER
 = 'center';

43 cÚ¡ 
	mVERTICAL_JUSTIFY
 = 'justify';

44 cÚ¡ 
	mVERTICAL_DISTRIBUTED
 = 'distributed';

47 cÚ¡ 
	mREADORDER_CONTEXT
 = 0;

48 cÚ¡ 
	mREADORDER_LTR
 = 1;

49 cÚ¡ 
	mREADORDER_RTL
 = 2;

56 
´Ùeùed
 
	m$hÜizÚl
 = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
;

63 
´Ùeùed
 
	m$v”tiÿl
 = 
PHPExûl_StyË_Alignm’t
::
VERTICAL_BOTTOM
;

70 
´Ùeùed
 
	m$‹xtRÙ©iÚ
 = 0;

77 
´Ùeùed
 
	m$w¿pText
 = 
çl£
;

84 
´Ùeùed
 
	m$shrškToF™
 = 
çl£
;

91 
´Ùeùed
 
	m$šd’t
 = 0;

98 
´Ùeùed
 
	m$»adÜd”
 = 0;

110 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$isSu³rvisÜ
 = 
çl£
, 
$isCÚd™iÚ®
 = false)

113 
·»Á
::
	`__cÚ¡ruù
(
$isSu³rvisÜ
);

115 ià(
$isCÚd™iÚ®
) {

116 
$this
->
hÜizÚl
 = 
nuÎ
;

117 
$this
->
v”tiÿl
 = 
nuÎ
;

118 
$this
->
‹xtRÙ©iÚ
 = 
nuÎ
;

128 
public
 
funùiÚ
 
	$g‘Sh¬edCompÚ’t
()

130  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Alignm’t
();

131 
	}
}

139 
public
 
funùiÚ
 
	$g‘StyËA¼ay
(
$¬¿y
)

141  
	`¬¿y
('®ignm’t' => 
$¬¿y
);

142 
	}
}

162 
public
 
funùiÚ
 
	$­¶yFromA¼ay
(
$pStyËs
 = 
nuÎ
)

164 ià(
	`is_¬¿y
(
$pStyËs
)) {

165 ià(
$this
->
isSu³rvisÜ
) {

166 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())

167 ->
	`­¶yFromA¼ay
(
$this
->
	`g‘StyËA¼ay
(
$pStyËs
));

169 ià(
	`is£t
(
$pStyËs
['horizontal'])) {

170 
$this
->
	`£tHÜizÚl
(
$pStyËs
['horizontal']);

172 ià(
	`is£t
(
$pStyËs
['vertical'])) {

173 
$this
->
	`£tV”tiÿl
(
$pStyËs
['vertical']);

175 ià(
	`is£t
(
$pStyËs
['rotation'])) {

176 
$this
->
	`£tTextRÙ©iÚ
(
$pStyËs
['rotation']);

178 ià(
	`is£t
(
$pStyËs
['wrap'])) {

179 
$this
->
	`£tW¿pText
(
$pStyËs
['wrap']);

181 ià(
	`is£t
(
$pStyËs
['shrinkToFit'])) {

182 
$this
->
	`£tShrškToF™
(
$pStyËs
['shrinkToFit']);

184 ià(
	`is£t
(
$pStyËs
['indent'])) {

185 
$this
->
	`£tInd’t
(
$pStyËs
['indent']);

187 ià(
	`is£t
(
$pStyËs
['readorder'])) {

188 
$this
->
	`£tR—dÜd”
(
$pStyËs
['readorder']);

192 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid style‡rray…assed.");

194  
$this
;

195 
	}
}

202 
public
 
funùiÚ
 
	$g‘HÜizÚl
()

204 ià(
$this
->
isSu³rvisÜ
) {

205  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘HÜizÚl
();

207  
$this
->
hÜizÚl
;

208 
	}
}

216 
public
 
funùiÚ
 
	$£tHÜizÚl
(
$pV®ue
 = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
)

218 ià(
$pV®ue
 == '') {

219 
$pV®ue
 = 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
;

222 ià(
$this
->
isSu³rvisÜ
) {

223 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('hÜizÚl' => 
$pV®ue
));

224 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

226 
$this
->
hÜizÚl
 = 
$pV®ue
;

228  
$this
;

229 
	}
}

236 
public
 
funùiÚ
 
	$g‘V”tiÿl
()

238 ià(
$this
->
isSu³rvisÜ
) {

239  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘V”tiÿl
();

241  
$this
->
v”tiÿl
;

242 
	}
}

250 
public
 
funùiÚ
 
	$£tV”tiÿl
(
$pV®ue
 = 
PHPExûl_StyË_Alignm’t
::
VERTICAL_BOTTOM
)

252 ià(
$pV®ue
 == '') {

253 
$pV®ue
 = 
PHPExûl_StyË_Alignm’t
::
VERTICAL_BOTTOM
;

256 ià(
$this
->
isSu³rvisÜ
) {

257 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('v”tiÿl' => 
$pV®ue
));

258 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

260 
$this
->
v”tiÿl
 = 
$pV®ue
;

262  
$this
;

263 
	}
}

270 
public
 
funùiÚ
 
	$g‘TextRÙ©iÚ
()

272 ià(
$this
->
isSu³rvisÜ
) {

273  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘TextRÙ©iÚ
();

275  
$this
->
‹xtRÙ©iÚ
;

276 
	}
}

285 
public
 
funùiÚ
 
	$£tTextRÙ©iÚ
(
$pV®ue
 = 0)

288 ià(
$pV®ue
 == 255) {

289 
$pV®ue
 = -165;

293 ià((
$pV®ue
 >= -90 && $pValue <= 90) || $pValue == -165) {

294 ià(
$this
->
isSu³rvisÜ
) {

295 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('rÙ©iÚ' => 
$pV®ue
));

296 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

298 
$this
->
‹xtRÙ©iÚ
 = 
$pV®ue
;

301 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Text„otation should be‡ value between -90‡nd 90.");

304  
$this
;

305 
	}
}

312 
public
 
funùiÚ
 
	$g‘W¿pText
()

314 ià(
$this
->
isSu³rvisÜ
) {

315  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘W¿pText
();

317  
$this
->
w¿pText
;

318 
	}
}

326 
public
 
funùiÚ
 
	$£tW¿pText
(
$pV®ue
 = 
çl£
)

328 ià(
$pV®ue
 == '') {

329 
$pV®ue
 = 
çl£
;

331 ià(
$this
->
isSu³rvisÜ
) {

332 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('w¿p' => 
$pV®ue
));

333 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

335 
$this
->
w¿pText
 = 
$pV®ue
;

337  
$this
;

338 
	}
}

345 
public
 
funùiÚ
 
	$g‘ShrškToF™
()

347 ià(
$this
->
isSu³rvisÜ
) {

348  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘ShrškToF™
();

350  
$this
->
shrškToF™
;

351 
	}
}

359 
public
 
funùiÚ
 
	$£tShrškToF™
(
$pV®ue
 = 
çl£
)

361 ià(
$pV®ue
 == '') {

362 
$pV®ue
 = 
çl£
;

364 ià(
$this
->
isSu³rvisÜ
) {

365 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('shrškToF™' => 
$pV®ue
));

366 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

368 
$this
->
shrškToF™
 = 
$pV®ue
;

370  
$this
;

371 
	}
}

378 
public
 
funùiÚ
 
	$g‘Ind’t
()

380 ià(
$this
->
isSu³rvisÜ
) {

381  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Ind’t
();

383  
$this
->
šd’t
;

384 
	}
}

392 
public
 
funùiÚ
 
	$£tInd’t
(
$pV®ue
 = 0)

394 ià(
$pV®ue
 > 0) {

395 ià(
$this
->
	`g‘HÜizÚl
(è!ğ
£lf
::
HORIZONTAL_GENERAL
 &&

396 
$this
->
	`g‘HÜizÚl
(è!ğ
£lf
::
HORIZONTAL_LEFT
 &&

397 
$this
->
	`g‘HÜizÚl
(è!ğ
£lf
::
HORIZONTAL_RIGHT
) {

398 
$pV®ue
 = 0;

401 ià(
$this
->
isSu³rvisÜ
) {

402 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('šd’t' => 
$pV®ue
));

403 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

405 
$this
->
šd’t
 = 
$pV®ue
;

407  
$this
;

408 
	}
}

415 
public
 
funùiÚ
 
	$g‘R—dÜd”
()

417 ià(
$this
->
isSu³rvisÜ
) {

418  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘R—dÜd”
();

420  
$this
->
»adÜd”
;

421 
	}
}

429 
public
 
funùiÚ
 
	$£tR—dÜd”
(
$pV®ue
 = 0)

431 ià(
$pV®ue
 < 0 || $pValue > 2) {

432 
$pV®ue
 = 0;

434 ià(
$this
->
isSu³rvisÜ
) {

435 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('»adÜd”' => 
$pV®ue
));

436 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

438 
$this
->
»adÜd”
 = 
$pV®ue
;

440  
$this
;

441 
	}
}

448 
public
 
funùiÚ
 
	$g‘HashCode
()

450 ià(
$this
->
isSu³rvisÜ
) {

451  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘HashCode
();

453  
	`md5
(

454 
$this
->
hÜizÚl
 .

455 
$this
->
v”tiÿl
 .

456 
$this
->
‹xtRÙ©iÚ
 .

457 (
$this
->
w¿pText
 ? 't' : 'f') .

458 (
$this
->
shrškToF™
 ? 't' : 'f') .

459 
$this
->
šd’t
 .

460 
$this
->
»adÜd”
 .

461 
__CLASS__


463 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Border.php

1 <?
php


28 şas 
	cPHPExûl_StyË_BÜd”
 
ex‹nds
 
PHPExûl_StyË_Su³rvisÜ
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


31 cÚ¡ 
	mBORDER_NONE
 = 'none';

32 cÚ¡ 
	mBORDER_DASHDOT
 = 'dashDot';

33 cÚ¡ 
	mBORDER_DASHDOTDOT
 = 'dashDotDot';

34 cÚ¡ 
	mBORDER_DASHED
 = 'dashed';

35 cÚ¡ 
	mBORDER_DOTTED
 = 'dotted';

36 cÚ¡ 
	mBORDER_DOUBLE
 = 'double';

37 cÚ¡ 
	mBORDER_HAIR
 = 'hair';

38 cÚ¡ 
	mBORDER_MEDIUM
 = 'medium';

39 cÚ¡ 
	mBORDER_MEDIUMDASHDOT
 = 'mediumDashDot';

40 cÚ¡ 
	mBORDER_MEDIUMDASHDOTDOT
 = 'mediumDashDotDot';

41 cÚ¡ 
	mBORDER_MEDIUMDASHED
 = 'mediumDashed';

42 cÚ¡ 
	mBORDER_SLANTDASHDOT
 = 'slantDashDot';

43 cÚ¡ 
	mBORDER_THICK
 = 'thick';

44 cÚ¡ 
	mBORDER_THIN
 = 'thin';

51 
´Ùeùed
 
	m$bÜd”StyË
 = 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
;

58 
´Ùeùed
 
	m$cŞÜ
;

65 
´Ùeùed
 
	m$·»ÁPrİ”tyName
;

77 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$isSu³rvisÜ
 = 
çl£
, 
$isCÚd™iÚ®
 = false)

80 
·»Á
::
	`__cÚ¡ruù
(
$isSu³rvisÜ
);

83 
$this
->
cŞÜ
 = 
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK
, 
$isSu³rvisÜ
);

86 ià(
$isSu³rvisÜ
) {

87 
$this
->
cŞÜ
->
	`bšdP¬’t
($this, 'color');

98 
public
 
funùiÚ
 
	$bšdP¬’t
(
$·»Á
, 
$·»ÁPrİ”tyName
 = 
nuÎ
)

100 
$this
->
·»Á
 = 
$·»Á
;

101 
$this
->
·»ÁPrİ”tyName
 = 
$·»ÁPrİ”tyName
;

102  
$this
;

103 
	}
}

112 
public
 
funùiÚ
 
	$g‘Sh¬edCompÚ’t
()

114 
$this
->
·»ÁPrİ”tyName
) {

120 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Cannot get shared component for‡…seudo-border.');

123  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘BÙtom
();

125  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘DŸgÚ®
();

127  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Leá
();

129  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Right
();

131  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Tİ
();

133 
	}
}

141 
public
 
funùiÚ
 
	$g‘StyËA¼ay
(
$¬¿y
)

143 
$this
->
·»ÁPrİ”tyName
) {

154 
$key
 = 
	`¡¹Şow”
('vertical');

157  
$this
->
·»Á
->
	`g‘StyËA¼ay
(
	`¬¿y
(
$key
 => 
$¬¿y
));

158 
	}
}

178 
public
 
funùiÚ
 
	$­¶yFromA¼ay
(
$pStyËs
 = 
nuÎ
)

180 ià(
	`is_¬¿y
(
$pStyËs
)) {

181 ià(
$this
->
isSu³rvisÜ
) {

182 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
($this->
	`g‘StyËA¼ay
(
$pStyËs
));

184 ià(
	`is£t
(
$pStyËs
['style'])) {

185 
$this
->
	`£tBÜd”StyË
(
$pStyËs
['style']);

187 ià(
	`is£t
(
$pStyËs
['color'])) {

188 
$this
->
	`g‘CŞÜ
()->
	`­¶yFromA¼ay
(
$pStyËs
['color']);

192 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid style‡rray…assed.");

194  
$this
;

195 
	}
}

202 
public
 
funùiÚ
 
	$g‘BÜd”StyË
()

204 ià(
$this
->
isSu³rvisÜ
) {

205  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘BÜd”StyË
();

207  
$this
->
bÜd”StyË
;

208 
	}
}

218 
public
 
funùiÚ
 
	$£tBÜd”StyË
(
$pV®ue
 = 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
)

221 ià(
	`em±y
(
$pV®ue
)) {

222 
$pV®ue
 = 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
;

223 } 
	`–£if
 (
	`is_boŞ
(
$pV®ue
) && $pValue) {

224 
$pV®ue
 = 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
;

226 ià(
$this
->
isSu³rvisÜ
) {

227 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('¡yË' => 
$pV®ue
));

228 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

230 
$this
->
bÜd”StyË
 = 
$pV®ue
;

232  
$this
;

233 
	}
}

240 
public
 
funùiÚ
 
	$g‘CŞÜ
()

242  
$this
->
cŞÜ
;

243 
	}
}

252 
public
 
funùiÚ
 
	$£tCŞÜ
(
PHPExûl_StyË_CŞÜ
 
$pV®ue
 = 
nuÎ
)

255 
$cŞÜ
 = 
$pV®ue
->
	`g‘IsSu³rvisÜ
(è? $pV®ue->
	`g‘Sh¬edCompÚ’t
() : $pValue;

257 ià(
$this
->
isSu³rvisÜ
) {

258 
$¡yËA¼ay
 = 
$this
->
	`g‘CŞÜ
()->
	`g‘StyËA¼ay
(
	`¬¿y
('¬gb' => 
$cŞÜ
->
	`g‘ARGB
()));

259 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

261 
$this
->
cŞÜ
 = 
$cŞÜ
;

263  
$this
;

264 
	}
}

271 
public
 
funùiÚ
 
	$g‘HashCode
()

273 ià(
$this
->
isSu³rvisÜ
) {

274  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘HashCode
();

276  
	`md5
(

277 
$this
->
bÜd”StyË
 .

278 
$this
->
cŞÜ
->
	`g‘HashCode
() .

279 
__CLASS__


281 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Borders.php

1 <?
php


28 şas 
	cPHPExûl_StyË_BÜd”s
 
ex‹nds
 
PHPExûl_StyË_Su³rvisÜ
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


31 cÚ¡ 
	mDIAGONAL_NONE
 = 0;

32 cÚ¡ 
	mDIAGONAL_UP
 = 1;

33 cÚ¡ 
	mDIAGONAL_DOWN
 = 2;

34 cÚ¡ 
	mDIAGONAL_BOTH
 = 3;

41 
´Ùeùed
 
	m$Ëá
;

48 
´Ùeùed
 
	m$right
;

55 
´Ùeùed
 
	m$tİ
;

62 
´Ùeùed
 
	m$bÙtom
;

69 
´Ùeùed
 
	m$dŸgÚ®
;

76 
´Ùeùed
 
	m$dŸgÚ®DœeùiÚ
;

83 
´Ùeùed
 
	m$®lBÜd”s
;

90 
´Ùeùed
 
	m$ouše
;

97 
´Ùeùed
 
	m$šside
;

104 
´Ùeùed
 
	m$v”tiÿl
;

111 
´Ùeùed
 
	m$hÜizÚl
;

123 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$isSu³rvisÜ
 = 
çl£
, 
$isCÚd™iÚ®
 = false)

126 
·»Á
::
	`__cÚ¡ruù
(
$isSu³rvisÜ
);

129 
$this
->
Ëá
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

130 
$this
->
right
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

131 
$this
->
tİ
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

132 
$this
->
bÙtom
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

133 
$this
->
dŸgÚ®
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”
(
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

134 
$this
->
dŸgÚ®DœeùiÚ
 = 
PHPExûl_StyË_BÜd”s
::
DIAGONAL_NONE
;

137 ià(
$isSu³rvisÜ
) {

139 
$this
->
®lBÜd”s
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”
(
Œue
);

140 
$this
->
ouše
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”
(
Œue
);

141 
$this
->
šside
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”
(
Œue
);

142 
$this
->
v”tiÿl
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”
(
Œue
);

143 
$this
->
hÜizÚl
 = 
Ãw
 
	`PHPExûl_StyË_BÜd”
(
Œue
);

146 
$this
->
Ëá
->
	`bšdP¬’t
($this, 'left');

147 
$this
->
right
->
	`bšdP¬’t
($this, 'right');

148 
$this
->
tİ
->
	`bšdP¬’t
($this, 'top');

149 
$this
->
bÙtom
->
	`bšdP¬’t
($this, 'bottom');

150 
$this
->
dŸgÚ®
->
	`bšdP¬’t
($this, 'diagonal');

151 
$this
->
®lBÜd”s
->
	`bšdP¬’t
($this, 'allBorders');

152 
$this
->
ouše
->
	`bšdP¬’t
($this, 'outline');

153 
$this
->
šside
->
	`bšdP¬’t
($this, 'inside');

154 
$this
->
v”tiÿl
->
	`bšdP¬’t
($this, 'vertical');

155 
$this
->
hÜizÚl
->
	`bšdP¬’t
($this, 'horizontal');

165 
public
 
funùiÚ
 
	$g‘Sh¬edCompÚ’t
()

167  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘BÜd”s
();

168 
	}
}

176 
public
 
funùiÚ
 
	$g‘StyËA¼ay
(
$¬¿y
)

178  
	`¬¿y
('bÜd”s' => 
$¬¿y
);

179 
	}
}

219 
public
 
funùiÚ
 
	$­¶yFromA¼ay
(
$pStyËs
 = 
nuÎ
)

221 ià(
	`is_¬¿y
(
$pStyËs
)) {

222 ià(
$this
->
isSu³rvisÜ
) {

223 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
($this->
	`g‘StyËA¼ay
(
$pStyËs
));

225 ià(
	`¬¿y_key_exi¡s
('Ëá', 
$pStyËs
)) {

226 
$this
->
	`g‘Leá
()->
	`­¶yFromA¼ay
(
$pStyËs
['left']);

228 ià(
	`¬¿y_key_exi¡s
('right', 
$pStyËs
)) {

229 
$this
->
	`g‘Right
()->
	`­¶yFromA¼ay
(
$pStyËs
['right']);

231 ià(
	`¬¿y_key_exi¡s
('tİ', 
$pStyËs
)) {

232 
$this
->
	`g‘Tİ
()->
	`­¶yFromA¼ay
(
$pStyËs
['top']);

234 ià(
	`¬¿y_key_exi¡s
('bÙtom', 
$pStyËs
)) {

235 
$this
->
	`g‘BÙtom
()->
	`­¶yFromA¼ay
(
$pStyËs
['bottom']);

237 ià(
	`¬¿y_key_exi¡s
('dŸgÚ®', 
$pStyËs
)) {

238 
$this
->
	`g‘DŸgÚ®
()->
	`­¶yFromA¼ay
(
$pStyËs
['diagonal']);

240 ià(
	`¬¿y_key_exi¡s
('dŸgÚ®dœeùiÚ', 
$pStyËs
)) {

241 
$this
->
	`£tDŸgÚ®DœeùiÚ
(
$pStyËs
['diagonaldirection']);

243 ià(
	`¬¿y_key_exi¡s
('®lbÜd”s', 
$pStyËs
)) {

244 
$this
->
	`g‘Leá
()->
	`­¶yFromA¼ay
(
$pStyËs
['allborders']);

245 
$this
->
	`g‘Right
()->
	`­¶yFromA¼ay
(
$pStyËs
['allborders']);

246 
$this
->
	`g‘Tİ
()->
	`­¶yFromA¼ay
(
$pStyËs
['allborders']);

247 
$this
->
	`g‘BÙtom
()->
	`­¶yFromA¼ay
(
$pStyËs
['allborders']);

251 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid style‡rray…assed.");

253  
$this
;

254 
	}
}

261 
public
 
funùiÚ
 
	$g‘Leá
()

263  
$this
->
Ëá
;

264 
	}
}

271 
public
 
funùiÚ
 
	$g‘Right
()

273  
$this
->
right
;

274 
	}
}

281 
public
 
funùiÚ
 
	$g‘Tİ
()

283  
$this
->
tİ
;

284 
	}
}

291 
public
 
funùiÚ
 
	$g‘BÙtom
()

293  
$this
->
bÙtom
;

294 
	}
}

301 
public
 
funùiÚ
 
	$g‘DŸgÚ®
()

303  
$this
->
dŸgÚ®
;

304 
	}
}

312 
public
 
funùiÚ
 
	$g‘AÎBÜd”s
()

314 ià(!
$this
->
isSu³rvisÜ
) {

315 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Can only get…seudo-border for supervisor.');

317  
$this
->
®lBÜd”s
;

318 
	}
}

326 
public
 
funùiÚ
 
	$g‘Ouše
()

328 ià(!
$this
->
isSu³rvisÜ
) {

329 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Can only get…seudo-border for supervisor.');

331  
$this
->
ouše
;

332 
	}
}

340 
public
 
funùiÚ
 
	$g‘Inside
()

342 ià(!
$this
->
isSu³rvisÜ
) {

343 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Can only get…seudo-border for supervisor.');

345  
$this
->
šside
;

346 
	}
}

354 
public
 
funùiÚ
 
	$g‘V”tiÿl
()

356 ià(!
$this
->
isSu³rvisÜ
) {

357 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Can only get…seudo-border for supervisor.');

359  
$this
->
v”tiÿl
;

360 
	}
}

368 
public
 
funùiÚ
 
	$g‘HÜizÚl
()

370 ià(!
$this
->
isSu³rvisÜ
) {

371 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Can only get…seudo-border for supervisor.');

373  
$this
->
hÜizÚl
;

374 
	}
}

381 
public
 
funùiÚ
 
	$g‘DŸgÚ®DœeùiÚ
()

383 ià(
$this
->
isSu³rvisÜ
) {

384  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘DŸgÚ®DœeùiÚ
();

386  
$this
->
dŸgÚ®DœeùiÚ
;

387 
	}
}

395 
public
 
funùiÚ
 
	$£tDŸgÚ®DœeùiÚ
(
$pV®ue
 = 
PHPExûl_StyË_BÜd”s
::
DIAGONAL_NONE
)

397 ià(
$pV®ue
 == '') {

398 
$pV®ue
 = 
PHPExûl_StyË_BÜd”s
::
DIAGONAL_NONE
;

400 ià(
$this
->
isSu³rvisÜ
) {

401 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('dŸgÚ®dœeùiÚ' => 
$pV®ue
));

402 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

404 
$this
->
dŸgÚ®DœeùiÚ
 = 
$pV®ue
;

406  
$this
;

407 
	}
}

414 
public
 
funùiÚ
 
	$g‘HashCode
()

416 ià(
$this
->
isSu³rvisÜ
) {

417  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Hashcode
();

419  
	`md5
(

420 
$this
->
	`g‘Leá
()->
	`g‘HashCode
() .

421 
$this
->
	`g‘Right
()->
	`g‘HashCode
() .

422 
$this
->
	`g‘Tİ
()->
	`g‘HashCode
() .

423 
$this
->
	`g‘BÙtom
()->
	`g‘HashCode
() .

424 
$this
->
	`g‘DŸgÚ®
()->
	`g‘HashCode
() .

425 
$this
->
	`g‘DŸgÚ®DœeùiÚ
() .

426 
__CLASS__


428 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Color.php

1 <?
php


28 şas 
	cPHPExûl_StyË_CŞÜ
 
ex‹nds
 
PHPExûl_StyË_Su³rvisÜ
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


31 cÚ¡ 
	mCOLOR_BLACK
 = 'FF000000';

32 cÚ¡ 
	mCOLOR_WHITE
 = 'FFFFFFFF';

33 cÚ¡ 
	mCOLOR_RED
 = 'FFFF0000';

34 cÚ¡ 
	mCOLOR_DARKRED
 = 'FF800000';

35 cÚ¡ 
	mCOLOR_BLUE
 = 'FF0000FF';

36 cÚ¡ 
	mCOLOR_DARKBLUE
 = 'FF000080';

37 cÚ¡ 
	mCOLOR_GREEN
 = 'FF00FF00';

38 cÚ¡ 
	mCOLOR_DARKGREEN
 = 'FF008000';

39 cÚ¡ 
	mCOLOR_YELLOW
 = 'FFFFFF00';

40 cÚ¡ 
	mCOLOR_DARKYELLOW
 = 'FF808000';

47 
´Ùeùed
 
	m$šdexedCŞÜs
;

54 
´Ùeùed
 
	m$¬gb
 = 
nuÎ
;

61 
´Ùeùed
 
	m$·»ÁPrİ”tyName
;

75 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$pARGB
 = 
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK
, 
$isSu³rvisÜ
 = 
çl£
, 
$isCÚd™iÚ®
 = false)

78 
·»Á
::
	`__cÚ¡ruù
(
$isSu³rvisÜ
);

81 ià(!
$isCÚd™iÚ®
) {

82 
$this
->
¬gb
 = 
$pARGB
;

93 
public
 
funùiÚ
 
	$bšdP¬’t
(
$·»Á
, 
$·»ÁPrİ”tyName
 = 
nuÎ
)

95 
$this
->
·»Á
 = 
$·»Á
;

96 
$this
->
·»ÁPrİ”tyName
 = 
$·»ÁPrİ”tyName
;

97  
$this
;

98 
	}
}

106 
public
 
funùiÚ
 
	$g‘Sh¬edCompÚ’t
()

108 
$this
->
·»ÁPrİ”tyName
) {

110  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘EndCŞÜ
();

112  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘CŞÜ
();

114  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘S¹CŞÜ
();

116 
	}
}

124 
public
 
funùiÚ
 
	$g‘StyËA¼ay
(
$¬¿y
)

126 
$this
->
·»ÁPrİ”tyName
) {

128 
$key
 = 'endcolor';

131 
$key
 = 'color';

134 
$key
 = 'startcolor';

138  
$this
->
·»Á
->
	`g‘StyËA¼ay
(
	`¬¿y
(
$key
 => 
$¬¿y
));

139 
	}
}

152 
public
 
funùiÚ
 
	$­¶yFromA¼ay
(
$pStyËs
 = 
nuÎ
)

154 ià(
	`is_¬¿y
(
$pStyËs
)) {

155 ià(
$this
->
isSu³rvisÜ
) {

156 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
($this->
	`g‘StyËA¼ay
(
$pStyËs
));

158 ià(
	`¬¿y_key_exi¡s
('rgb', 
$pStyËs
)) {

159 
$this
->
	`£tRGB
(
$pStyËs
['rgb']);

161 ià(
	`¬¿y_key_exi¡s
('¬gb', 
$pStyËs
)) {

162 
$this
->
	`£tARGB
(
$pStyËs
['argb']);

166 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid style‡rray…assed.");

168  
$this
;

169 
	}
}

176 
public
 
funùiÚ
 
	$g‘ARGB
()

178 ià(
$this
->
isSu³rvisÜ
) {

179  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘ARGB
();

181  
$this
->
¬gb
;

182 
	}
}

190 
public
 
funùiÚ
 
	$£tARGB
(
$pV®ue
 = 
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK
)

192 ià(
$pV®ue
 == '') {

193 
$pV®ue
 = 
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK
;

195 ià(
$this
->
isSu³rvisÜ
) {

196 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('¬gb' => 
$pV®ue
));

197 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

199 
$this
->
¬gb
 = 
$pV®ue
;

201  
$this
;

202 
	}
}

209 
public
 
funùiÚ
 
	$g‘RGB
()

211 ià(
$this
->
isSu³rvisÜ
) {

212  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘RGB
();

214  
	`sub¡r
(
$this
->
¬gb
, 2);

215 
	}
}

223 
public
 
funùiÚ
 
£tRGB
(
$pV®ue
 = '000000')

225 ià(
$pV®ue
 == '') {

226 
$pV®ue
 = '000000';

228 ià(
	g$this
->
	gisSu³rvisÜ
) {

229 
	g$¡yËA¼ay
 = 
$this
->
g‘StyËA¼ay
(
¬¿y
('¬gb' => 'FF' . 
$pV®ue
));

230 
	g$this
->
g‘AùiveSh“t
()->
g‘StyË
(
$this
->
g‘S–eùedC–ls
())->
­¶yFromA¼ay
(
$¡yËA¼ay
);

232 
	g$this
->
	g¬gb
 = 'FF' . 
$pV®ue
;

234  
	g$this
;

247 
´iv©e
 
funùiÚ
 
	$g‘CŞourCompÚ’t
(
$RGB
, 
$off£t
, 
$hex
 = 
Œue
)

249 
$cŞour
 = 
	`sub¡r
(
$RGB
, 
$off£t
, 2);

250 ià(!
$hex
) {

251 
$cŞour
 = 
	`hexdec
($colour);

253  
$cŞour
;

254 
	}
}

264 
public
 
funùiÚ
 
	$g‘Red
(
$RGB
, 
$hex
 = 
Œue
)

266  
£lf
::
	`g‘CŞourCompÚ’t
(
$RGB
, 
	`¡¾’
($RGBè- 6, 
$hex
);

267 
	}
}

277 
public
 
funùiÚ
 
	$g‘G»’
(
$RGB
, 
$hex
 = 
Œue
)

279  
£lf
::
	`g‘CŞourCompÚ’t
(
$RGB
, 
	`¡¾’
($RGBè- 4, 
$hex
);

280 
	}
}

290 
public
 
funùiÚ
 
	$g‘Blue
(
$RGB
, 
$hex
 = 
Œue
)

292  
£lf
::
	`g‘CŞourCompÚ’t
(
$RGB
, 
	`¡¾’
($RGBè- 2, 
$hex
);

293 
	}
}

302 
public
 
funùiÚ
 
	$chªgeBrighŠess
(
$hex
, 
$adju¡P”ûÁage
)

304 
$rgba
 = (
	`¡¾’
(
$hex
) == 8);

306 
$»d
 = 
£lf
::
	`g‘Red
(
$hex
, 
çl£
);

307 
$g»’
 = 
£lf
::
	`g‘G»’
(
$hex
, 
çl£
);

308 
$blue
 = 
£lf
::
	`g‘Blue
(
$hex
, 
çl£
);

309 ià(
$adju¡P”ûÁage
 > 0) {

310 
$»d
 +ğ(255 - $»dè* 
$adju¡P”ûÁage
;

311 
$g»’
 +ğ(255 - $g»’è* 
$adju¡P”ûÁage
;

312 
$blue
 +ğ(255 - $blueè* 
$adju¡P”ûÁage
;

314 
$»d
 +ğ$»d * 
$adju¡P”ûÁage
;

315 
$g»’
 +ğ$g»’ * 
$adju¡P”ûÁage
;

316 
$blue
 +ğ$blu* 
$adju¡P”ûÁage
;

319 ià(
$»d
 < 0) {

320 
$»d
 = 0;

321 } 
	`–£if
 (
$»d
 > 255) {

322 
$»d
 = 255;

324 ià(
$g»’
 < 0) {

325 
$g»’
 = 0;

326 } 
	`–£if
 (
$g»’
 > 255) {

327 
$g»’
 = 255;

329 ià(
$blue
 < 0) {

330 
$blue
 = 0;

331 } 
	`–£if
 (
$blue
 > 255) {

332 
$blue
 = 255;

335 
$rgb
 = 
	`¡¹ouµ”
(

336 
	`¡r_·d
(
	`dechex
(
$»d
), 2, '0', 0) .

337 
	`¡r_·d
(
	`dechex
(
$g»’
), 2, '0', 0) .

338 
	`¡r_·d
(
	`dechex
(
$blue
), 2, '0', 0)

340  ((
$rgba
è? 'FF' : ''è. 
$rgb
;

341 
	}
}

351 
public
 
funùiÚ
 
	$šdexedCŞÜ
(
$pIndex
, 
$background
 = 
çl£
)

354 
$pIndex
 = 
	`štv®
($pIndex);

357 ià(
	`is_nuÎ
(
£lf
::
$šdexedCŞÜs
)) {

358 
£lf
::
$šdexedCŞÜs
 = 
	`¬¿y
(

418 ià(
	`¬¿y_key_exi¡s
(
$pIndex
, 
£lf
::
$šdexedCŞÜs
)) {

419  
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
£lf
::
$šdexedCŞÜs
[
$pIndex
]);

422 ià(
$background
) {

423  
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
£lf
::
COLOR_WHITE
);

425  
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
£lf
::
COLOR_BLACK
);

426 
	}
}

433 
public
 
funùiÚ
 
	$g‘HashCode
()

435 ià(
$this
->
isSu³rvisÜ
) {

436  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘HashCode
();

438  
	`md5
(

439 
$this
->
¬gb
 .

440 
__CLASS__


442 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Conditional.php

1 <?
php


36 şas 
	cPHPExûl_StyË_CÚd™iÚ®
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


39 cÚ¡ 
	mCONDITION_NONE
 = 'none';

40 cÚ¡ 
	mCONDITION_CELLIS
 = 'cellIs';

41 cÚ¡ 
	mCONDITION_CONTAINSTEXT
 = 'containsText';

42 cÚ¡ 
	mCONDITION_EXPRESSION
 = 'expression';

45 cÚ¡ 
	mOPERATOR_NONE
 = '';

46 cÚ¡ 
	mOPERATOR_BEGINSWITH
 = 'beginsWith';

47 cÚ¡ 
	mOPERATOR_ENDSWITH
 = 'endsWith';

48 cÚ¡ 
	mOPERATOR_EQUAL
 = 'equal';

49 cÚ¡ 
	mOPERATOR_GREATERTHAN
 = 'greaterThan';

50 cÚ¡ 
	mOPERATOR_GREATERTHANOREQUAL
 = 'greaterThanOrEqual';

51 cÚ¡ 
	mOPERATOR_LESSTHAN
 = 'lessThan';

52 cÚ¡ 
	mOPERATOR_LESSTHANOREQUAL
 = 'lessThanOrEqual';

53 cÚ¡ 
	mOPERATOR_NOTEQUAL
 = 'notEqual';

54 cÚ¡ 
	mOPERATOR_CONTAINSTEXT
 = 'containsText';

55 cÚ¡ 
	mOPERATOR_NOTCONTAINS
 = 'notContains';

56 cÚ¡ 
	mOPERATOR_BETWEEN
 = 'between';

63 
´iv©e
 
	m$cÚd™iÚTy³
;

70 
´iv©e
 
	m$İ”©ÜTy³
;

77 
´iv©e
 
	m$‹xt
;

84 
´iv©e
 
	m$cÚd™iÚ
 = 
¬¿y
();

91 
´iv©e
 
	m$¡yË
;

96 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

99 
$this
->
cÚd™iÚTy³
 = 
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_NONE
;

100 
$this
->
İ”©ÜTy³
 = 
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_NONE
;

101 
$this
->
‹xt
 = 
nuÎ
;

102 
$this
->
cÚd™iÚ
 = 
	`¬¿y
();

103 
$this
->
¡yË
 = 
Ãw
 
	`PHPExûl_StyË
(
çl£
, 
Œue
);

111 
public
 
funùiÚ
 
	$g‘CÚd™iÚTy³
()

113  
$this
->
cÚd™iÚTy³
;

114 
	}
}

122 
public
 
funùiÚ
 
	$£tCÚd™iÚTy³
(
$pV®ue
 = 
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_NONE
)

124 
$this
->
cÚd™iÚTy³
 = 
$pV®ue
;

125  
$this
;

126 
	}
}

133 
public
 
funùiÚ
 
	$g‘O³¿tÜTy³
()

135  
$this
->
İ”©ÜTy³
;

136 
	}
}

144 
public
 
funùiÚ
 
	$£tO³¿tÜTy³
(
$pV®ue
 = 
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_NONE
)

146 
$this
->
İ”©ÜTy³
 = 
$pV®ue
;

147  
$this
;

148 
	}
}

155 
public
 
funùiÚ
 
	$g‘Text
()

157  
$this
->
‹xt
;

158 
	}
}

166 
public
 
funùiÚ
 
	$£tText
(
$v®ue
 = 
nuÎ
)

168 
$this
->
‹xt
 = 
$v®ue
;

169  
$this
;

170 
	}
}

178 
public
 
funùiÚ
 
	$g‘CÚd™iÚ
()

180 ià(
	`is£t
(
$this
->
cÚd™iÚ
[0])) {

181  
$this
->
cÚd™iÚ
[0];

185 
	}
}

194 
public
 
funùiÚ
 
£tCÚd™iÚ
(
$pV®ue
 = '')

196 ià(!
is_¬¿y
(
$pV®ue
)) {

197 
$pV®ue
 = 
¬¿y
($pValue);

200  
	g$this
->
£tCÚd™iÚs
(
$pV®ue
);

208 
public
 
funùiÚ
 
	$g‘CÚd™iÚs
()

210  
$this
->
cÚd™iÚ
;

211 
	}
}

219 
public
 
funùiÚ
 
	$£tCÚd™iÚs
(
$pV®ue
)

221 ià(!
	`is_¬¿y
(
$pV®ue
)) {

222 
$pV®ue
 = 
	`¬¿y
($pValue);

224 
$this
->
cÚd™iÚ
 = 
$pV®ue
;

225  
$this
;

226 
	}
}

234 
public
 
funùiÚ
 
addCÚd™iÚ
(
$pV®ue
 = '')

236 
$this
->
cÚd™iÚ
[] = 
$pV®ue
;

237  
	g$this
;

245 
public
 
funùiÚ
 
	$g‘StyË
()

247  
$this
->
¡yË
;

248 
	}
}

257 
public
 
funùiÚ
 
	$£tStyË
(
PHPExûl_StyË
 
$pV®ue
 = 
nuÎ
)

259 
$this
->
¡yË
 = 
$pV®ue
;

260  
$this
;

261 
	}
}

268 
public
 
funùiÚ
 
	$g‘HashCode
()

270  
	`md5
(

271 
$this
->
cÚd™iÚTy³
 .

272 
$this
->
İ”©ÜTy³
 .

273 
	`im¶ode
(';', 
$this
->
cÚd™iÚ
) .

274 
$this
->
¡yË
->
	`g‘HashCode
() .

275 
__CLASS__


277 
	}
}

282 
public
 
funùiÚ
 
	$__şÚe
()

284 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

285 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

286 ià(
	`is_objeù
(
$v®ue
)) {

287 
$this
->
$key
 = 
şÚe
 
$v®ue
;

289 
$this
->
$key
 = 
$v®ue
;

292 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Fill.php

1 <?
php


28 şas 
	cPHPExûl_StyË_Fl
 
ex‹nds
 
PHPExûl_StyË_Su³rvisÜ
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


31 cÚ¡ 
	mFILL_NONE
 = 'none';

32 cÚ¡ 
	mFILL_SOLID
 = 'solid';

33 cÚ¡ 
	mFILL_GRADIENT_LINEAR
 = 'linear';

34 cÚ¡ 
	mFILL_GRADIENT_PATH
 = 'path';

35 cÚ¡ 
	mFILL_PATTERN_DARKDOWN
 = 'darkDown';

36 cÚ¡ 
	mFILL_PATTERN_DARKGRAY
 = 'darkGray';

37 cÚ¡ 
	mFILL_PATTERN_DARKGRID
 = 'darkGrid';

38 cÚ¡ 
	mFILL_PATTERN_DARKHORIZONTAL
 = 'darkHorizontal';

39 cÚ¡ 
	mFILL_PATTERN_DARKTRELLIS
 = 'darkTrellis';

40 cÚ¡ 
	mFILL_PATTERN_DARKUP
 = 'darkUp';

41 cÚ¡ 
	mFILL_PATTERN_DARKVERTICAL
 = 'darkVertical';

42 cÚ¡ 
	mFILL_PATTERN_GRAY0625
 = 'gray0625';

43 cÚ¡ 
	mFILL_PATTERN_GRAY125
 = 'gray125';

44 cÚ¡ 
	mFILL_PATTERN_LIGHTDOWN
 = 'lightDown';

45 cÚ¡ 
	mFILL_PATTERN_LIGHTGRAY
 = 'lightGray';

46 cÚ¡ 
	mFILL_PATTERN_LIGHTGRID
 = 'lightGrid';

47 cÚ¡ 
	mFILL_PATTERN_LIGHTHORIZONTAL
 = 'lightHorizontal';

48 cÚ¡ 
	mFILL_PATTERN_LIGHTTRELLIS
 = 'lightTrellis';

49 cÚ¡ 
	mFILL_PATTERN_LIGHTUP
 = 'lightUp';

50 cÚ¡ 
	mFILL_PATTERN_LIGHTVERTICAL
 = 'lightVertical';

51 cÚ¡ 
	mFILL_PATTERN_MEDIUMGRAY
 = 'mediumGray';

58 
´Ùeùed
 
	m$flTy³
 = 
PHPExûl_StyË_Fl
::
FILL_NONE
;

65 
´Ùeùed
 
	m$rÙ©iÚ
 = 0;

72 
´Ùeùed
 
	m$¡¬tCŞÜ
;

79 
´Ùeùed
 
	m$’dCŞÜ
;

91 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$isSu³rvisÜ
 = 
çl£
, 
$isCÚd™iÚ®
 = false)

94 
·»Á
::
	`__cÚ¡ruù
(
$isSu³rvisÜ
);

97 ià(
$isCÚd™iÚ®
) {

98 
$this
->
flTy³
 = 
nuÎ
;

100 
$this
->
¡¬tCŞÜ
 = 
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
PHPExûl_StyË_CŞÜ
::
COLOR_WHITE
, 
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

101 
$this
->
’dCŞÜ
 = 
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK
, 
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

104 ià(
$isSu³rvisÜ
) {

105 
$this
->
¡¬tCŞÜ
->
	`bšdP¬’t
($this, 'startColor');

106 
$this
->
’dCŞÜ
->
	`bšdP¬’t
($this, 'endColor');

116 
public
 
funùiÚ
 
	$g‘Sh¬edCompÚ’t
()

118  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Fl
();

119 
	}
}

127 
public
 
funùiÚ
 
	$g‘StyËA¼ay
(
$¬¿y
)

129  
	`¬¿y
('fl' => 
$¬¿y
);

130 
	}
}

154 
public
 
funùiÚ
 
	$­¶yFromA¼ay
(
$pStyËs
 = 
nuÎ
)

156 ià(
	`is_¬¿y
(
$pStyËs
)) {

157 ià(
$this
->
isSu³rvisÜ
) {

158 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
($this->
	`g‘StyËA¼ay
(
$pStyËs
));

160 ià(
	`¬¿y_key_exi¡s
('ty³', 
$pStyËs
)) {

161 
$this
->
	`£tFlTy³
(
$pStyËs
['type']);

163 ià(
	`¬¿y_key_exi¡s
('rÙ©iÚ', 
$pStyËs
)) {

164 
$this
->
	`£tRÙ©iÚ
(
$pStyËs
['rotation']);

166 ià(
	`¬¿y_key_exi¡s
('¡¬tcŞÜ', 
$pStyËs
)) {

167 
$this
->
	`g‘S¹CŞÜ
()->
	`­¶yFromA¼ay
(
$pStyËs
['startcolor']);

169 ià(
	`¬¿y_key_exi¡s
('’dcŞÜ', 
$pStyËs
)) {

170 
$this
->
	`g‘EndCŞÜ
()->
	`­¶yFromA¼ay
(
$pStyËs
['endcolor']);

172 ià(
	`¬¿y_key_exi¡s
('cŞÜ', 
$pStyËs
)) {

173 
$this
->
	`g‘S¹CŞÜ
()->
	`­¶yFromA¼ay
(
$pStyËs
['color']);

177 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid style‡rray…assed.");

179  
$this
;

180 
	}
}

187 
public
 
funùiÚ
 
	$g‘FlTy³
()

189 ià(
$this
->
isSu³rvisÜ
) {

190  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘FlTy³
();

192  
$this
->
flTy³
;

193 
	}
}

201 
public
 
funùiÚ
 
	$£tFlTy³
(
$pV®ue
 = 
PHPExûl_StyË_Fl
::
FILL_NONE
)

203 ià(
$this
->
isSu³rvisÜ
) {

204 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('ty³' => 
$pV®ue
));

205 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

207 
$this
->
flTy³
 = 
$pV®ue
;

209  
$this
;

210 
	}
}

217 
public
 
funùiÚ
 
	$g‘RÙ©iÚ
()

219 ià(
$this
->
isSu³rvisÜ
) {

220  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘RÙ©iÚ
();

222  
$this
->
rÙ©iÚ
;

223 
	}
}

231 
public
 
funùiÚ
 
	$£tRÙ©iÚ
(
$pV®ue
 = 0)

233 ià(
$this
->
isSu³rvisÜ
) {

234 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('rÙ©iÚ' => 
$pV®ue
));

235 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

237 
$this
->
rÙ©iÚ
 = 
$pV®ue
;

239  
$this
;

240 
	}
}

247 
public
 
funùiÚ
 
	$g‘S¹CŞÜ
()

249  
$this
->
¡¬tCŞÜ
;

250 
	}
}

259 
public
 
funùiÚ
 
	$£tS¹CŞÜ
(
PHPExûl_StyË_CŞÜ
 
$pV®ue
 = 
nuÎ
)

262 
$cŞÜ
 = 
$pV®ue
->
	`g‘IsSu³rvisÜ
(è? $pV®ue->
	`g‘Sh¬edCompÚ’t
() : $pValue;

264 ià(
$this
->
isSu³rvisÜ
) {

265 
$¡yËA¼ay
 = 
$this
->
	`g‘S¹CŞÜ
()->
	`g‘StyËA¼ay
(
	`¬¿y
('¬gb' => 
$cŞÜ
->
	`g‘ARGB
()));

266 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

268 
$this
->
¡¬tCŞÜ
 = 
$cŞÜ
;

270  
$this
;

271 
	}
}

278 
public
 
funùiÚ
 
	$g‘EndCŞÜ
()

280  
$this
->
’dCŞÜ
;

281 
	}
}

290 
public
 
funùiÚ
 
	$£tEndCŞÜ
(
PHPExûl_StyË_CŞÜ
 
$pV®ue
 = 
nuÎ
)

293 
$cŞÜ
 = 
$pV®ue
->
	`g‘IsSu³rvisÜ
(è? $pV®ue->
	`g‘Sh¬edCompÚ’t
() : $pValue;

295 ià(
$this
->
isSu³rvisÜ
) {

296 
$¡yËA¼ay
 = 
$this
->
	`g‘EndCŞÜ
()->
	`g‘StyËA¼ay
(
	`¬¿y
('¬gb' => 
$cŞÜ
->
	`g‘ARGB
()));

297 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

299 
$this
->
’dCŞÜ
 = 
$cŞÜ
;

301  
$this
;

302 
	}
}

309 
public
 
funùiÚ
 
	$g‘HashCode
()

311 ià(
$this
->
isSu³rvisÜ
) {

312  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘HashCode
();

314  
	`md5
(

315 
$this
->
	`g‘FlTy³
() .

316 
$this
->
	`g‘RÙ©iÚ
() .

317 
$this
->
	`g‘S¹CŞÜ
()->
	`g‘HashCode
() .

318 
$this
->
	`g‘EndCŞÜ
()->
	`g‘HashCode
() .

319 
__CLASS__


321 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Font.php

1 <?
php


28 şas 
	cPHPExûl_StyË_FÚt
 
ex‹nds
 
PHPExûl_StyË_Su³rvisÜ
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


31 cÚ¡ 
	mUNDERLINE_NONE
 = 'none';

32 cÚ¡ 
	mUNDERLINE_DOUBLE
 = 'double';

33 cÚ¡ 
	mUNDERLINE_DOUBLEACCOUNTING
 = 'doubleAccounting';

34 cÚ¡ 
	mUNDERLINE_SINGLE
 = 'single';

35 cÚ¡ 
	mUNDERLINE_SINGLEACCOUNTING
 = 'singleAccounting';

42 
´Ùeùed
 
	m$Çme
 = 'Calibri';

49 
´Ùeùed
 
	m$size
 = 11;

56 
´Ùeùed
 
	m$bŞd
 = 
çl£
;

63 
´Ùeùed
 
	m$™®ic
 = 
çl£
;

70 
´Ùeùed
 
	m$su³rSüt
 = 
çl£
;

77 
´Ùeùed
 
	m$subSüt
 = 
çl£
;

84 
´Ùeùed
 
	m$und”lše
 = 
£lf
::
UNDERLINE_NONE
;

91 
´Ùeùed
 
	m$¡rik‘hrough
 = 
çl£
;

98 
´Ùeùed
 
	m$cŞÜ
;

110 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$isSu³rvisÜ
 = 
çl£
, 
$isCÚd™iÚ®
 = false)

113 
·»Á
::
	`__cÚ¡ruù
(
$isSu³rvisÜ
);

116 ià(
$isCÚd™iÚ®
) {

117 
$this
->
Çme
 = 
nuÎ
;

118 
$this
->
size
 = 
nuÎ
;

119 
$this
->
bŞd
 = 
nuÎ
;

120 
$this
->
™®ic
 = 
nuÎ
;

121 
$this
->
su³rSüt
 = 
nuÎ
;

122 
$this
->
subSüt
 = 
nuÎ
;

123 
$this
->
und”lše
 = 
nuÎ
;

124 
$this
->
¡rik‘hrough
 = 
nuÎ
;

125 
$this
->
cŞÜ
 = 
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK
, 
$isSu³rvisÜ
, 
$isCÚd™iÚ®
);

127 
$this
->
cŞÜ
 = 
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK
, 
$isSu³rvisÜ
);

130 ià(
$isSu³rvisÜ
) {

131 
$this
->
cŞÜ
->
	`bšdP¬’t
($this, 'color');

141 
public
 
funùiÚ
 
	$g‘Sh¬edCompÚ’t
()

143  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘FÚt
();

144 
	}
}

152 
public
 
funùiÚ
 
	$g‘StyËA¼ay
(
$¬¿y
)

154  
	`¬¿y
('fÚt' => 
$¬¿y
);

155 
	}
}

179 
public
 
funùiÚ
 
	$­¶yFromA¼ay
(
$pStyËs
 = 
nuÎ
)

181 ià(
	`is_¬¿y
(
$pStyËs
)) {

182 ià(
$this
->
isSu³rvisÜ
) {

183 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
($this->
	`g‘StyËA¼ay
(
$pStyËs
));

185 ià(
	`¬¿y_key_exi¡s
('Çme', 
$pStyËs
)) {

186 
$this
->
	`£tName
(
$pStyËs
['name']);

188 ià(
	`¬¿y_key_exi¡s
('bŞd', 
$pStyËs
)) {

189 
$this
->
	`£tBŞd
(
$pStyËs
['bold']);

191 ià(
	`¬¿y_key_exi¡s
('™®ic', 
$pStyËs
)) {

192 
$this
->
	`£tIlic
(
$pStyËs
['italic']);

194 ià(
	`¬¿y_key_exi¡s
('su³rSüt', 
$pStyËs
)) {

195 
$this
->
	`£tSu³rSüt
(
$pStyËs
['superScript']);

197 ià(
	`¬¿y_key_exi¡s
('subSüt', 
$pStyËs
)) {

198 
$this
->
	`£tSubSüt
(
$pStyËs
['subScript']);

200 ià(
	`¬¿y_key_exi¡s
('und”lše', 
$pStyËs
)) {

201 
$this
->
	`£tUnd”lše
(
$pStyËs
['underline']);

203 ià(
	`¬¿y_key_exi¡s
('¡rike', 
$pStyËs
)) {

204 
$this
->
	`£tSŒik‘hrough
(
$pStyËs
['strike']);

206 ià(
	`¬¿y_key_exi¡s
('cŞÜ', 
$pStyËs
)) {

207 
$this
->
	`g‘CŞÜ
()->
	`­¶yFromA¼ay
(
$pStyËs
['color']);

209 ià(
	`¬¿y_key_exi¡s
('size', 
$pStyËs
)) {

210 
$this
->
	`£tSize
(
$pStyËs
['size']);

214 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid style‡rray…assed.");

216  
$this
;

217 
	}
}

224 
public
 
funùiÚ
 
	$g‘Name
()

226 ià(
$this
->
isSu³rvisÜ
) {

227  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Name
();

229  
$this
->
Çme
;

230 
	}
}

238 
public
 
funùiÚ
 
£tName
(
$pV®ue
 = 'Calibri')

240 ià(
$pV®ue
 == '') {

241 
$pV®ue
 = 'Calibri';

243 ià(
	g$this
->
	gisSu³rvisÜ
) {

244 
	g$¡yËA¼ay
 = 
$this
->
g‘StyËA¼ay
(
¬¿y
('Çme' => 
$pV®ue
));

245 
	g$this
->
g‘AùiveSh“t
()->
g‘StyË
(
$this
->
g‘S–eùedC–ls
())->
­¶yFromA¼ay
(
$¡yËA¼ay
);

247 
	g$this
->
	gÇme
 = 
$pV®ue
;

249  
	g$this
;

257 
public
 
funùiÚ
 
	$g‘Size
()

259 ià(
$this
->
isSu³rvisÜ
) {

260  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Size
();

262  
$this
->
size
;

263 
	}
}

271 
public
 
funùiÚ
 
	$£tSize
(
$pV®ue
 = 10)

273 ià(
$pV®ue
 == '') {

274 
$pV®ue
 = 10;

276 ià(
$this
->
isSu³rvisÜ
) {

277 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('size' => 
$pV®ue
));

278 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

280 
$this
->
size
 = 
$pV®ue
;

282  
$this
;

283 
	}
}

290 
public
 
funùiÚ
 
	$g‘BŞd
()

292 ià(
$this
->
isSu³rvisÜ
) {

293  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘BŞd
();

295  
$this
->
bŞd
;

296 
	}
}

304 
public
 
funùiÚ
 
	$£tBŞd
(
$pV®ue
 = 
çl£
)

306 ià(
$pV®ue
 == '') {

307 
$pV®ue
 = 
çl£
;

309 ià(
$this
->
isSu³rvisÜ
) {

310 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('bŞd' => 
$pV®ue
));

311 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

313 
$this
->
bŞd
 = 
$pV®ue
;

315  
$this
;

316 
	}
}

323 
public
 
funùiÚ
 
	$g‘Ilic
()

325 ià(
$this
->
isSu³rvisÜ
) {

326  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Ilic
();

328  
$this
->
™®ic
;

329 
	}
}

337 
public
 
funùiÚ
 
	$£tIlic
(
$pV®ue
 = 
çl£
)

339 ià(
$pV®ue
 == '') {

340 
$pV®ue
 = 
çl£
;

342 ià(
$this
->
isSu³rvisÜ
) {

343 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('™®ic' => 
$pV®ue
));

344 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

346 
$this
->
™®ic
 = 
$pV®ue
;

348  
$this
;

349 
	}
}

356 
public
 
funùiÚ
 
	$g‘Su³rSüt
()

358 ià(
$this
->
isSu³rvisÜ
) {

359  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Su³rSüt
();

361  
$this
->
su³rSüt
;

362 
	}
}

370 
public
 
funùiÚ
 
	$£tSu³rSüt
(
$pV®ue
 = 
çl£
)

372 ià(
$pV®ue
 == '') {

373 
$pV®ue
 = 
çl£
;

375 ià(
$this
->
isSu³rvisÜ
) {

376 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('su³rSüt' => 
$pV®ue
));

377 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

379 
$this
->
su³rSüt
 = 
$pV®ue
;

380 
$this
->
subSüt
 = !
$pV®ue
;

382  
$this
;

383 
	}
}

390 
public
 
funùiÚ
 
	$g‘SubSüt
()

392 ià(
$this
->
isSu³rvisÜ
) {

393  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘SubSüt
();

395  
$this
->
subSüt
;

396 
	}
}

404 
public
 
funùiÚ
 
	$£tSubSüt
(
$pV®ue
 = 
çl£
)

406 ià(
$pV®ue
 == '') {

407 
$pV®ue
 = 
çl£
;

409 ià(
$this
->
isSu³rvisÜ
) {

410 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('subSüt' => 
$pV®ue
));

411 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

413 
$this
->
subSüt
 = 
$pV®ue
;

414 
$this
->
su³rSüt
 = !
$pV®ue
;

416  
$this
;

417 
	}
}

424 
public
 
funùiÚ
 
	$g‘Und”lše
()

426 ià(
$this
->
isSu³rvisÜ
) {

427  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Und”lše
();

429  
$this
->
und”lše
;

430 
	}
}

440 
public
 
funùiÚ
 
	$£tUnd”lše
(
$pV®ue
 = 
£lf
::
UNDERLINE_NONE
)

442 ià(
	`is_boŞ
(
$pV®ue
)) {

443 
$pV®ue
 = ($pV®ueè? 
£lf
::
UNDERLINE_SINGLE
 : s–f::
UNDERLINE_NONE
;

444 } 
	`–£if
 (
$pV®ue
 == '') {

445 
$pV®ue
 = 
£lf
::
UNDERLINE_NONE
;

447 ià(
$this
->
isSu³rvisÜ
) {

448 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('und”lše' => 
$pV®ue
));

449 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

451 
$this
->
und”lše
 = 
$pV®ue
;

453  
$this
;

454 
	}
}

461 
public
 
funùiÚ
 
	$g‘SŒik‘hrough
()

463 ià(
$this
->
isSu³rvisÜ
) {

464  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘SŒik‘hrough
();

466  
$this
->
¡rik‘hrough
;

467 
	}
}

475 
public
 
funùiÚ
 
	$£tSŒik‘hrough
(
$pV®ue
 = 
çl£
)

477 ià(
$pV®ue
 == '') {

478 
$pV®ue
 = 
çl£
;

480 ià(
$this
->
isSu³rvisÜ
) {

481 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('¡rike' => 
$pV®ue
));

482 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

484 
$this
->
¡rik‘hrough
 = 
$pV®ue
;

486  
$this
;

487 
	}
}

494 
public
 
funùiÚ
 
	$g‘CŞÜ
()

496  
$this
->
cŞÜ
;

497 
	}
}

506 
public
 
funùiÚ
 
	$£tCŞÜ
(
PHPExûl_StyË_CŞÜ
 
$pV®ue
 = 
nuÎ
)

509 
$cŞÜ
 = 
$pV®ue
->
	`g‘IsSu³rvisÜ
(è? $pV®ue->
	`g‘Sh¬edCompÚ’t
() : $pValue;

511 ià(
$this
->
isSu³rvisÜ
) {

512 
$¡yËA¼ay
 = 
$this
->
	`g‘CŞÜ
()->
	`g‘StyËA¼ay
(
	`¬¿y
('¬gb' => 
$cŞÜ
->
	`g‘ARGB
()));

513 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

515 
$this
->
cŞÜ
 = 
$cŞÜ
;

517  
$this
;

518 
	}
}

525 
public
 
funùiÚ
 
	$g‘HashCode
()

527 ià(
$this
->
isSu³rvisÜ
) {

528  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘HashCode
();

530  
	`md5
(

531 
$this
->
Çme
 .

532 
$this
->
size
 .

533 (
$this
->
bŞd
 ? 't' : 'f') .

534 (
$this
->
™®ic
 ? 't' : 'f') .

535 (
$this
->
su³rSüt
 ? 't' : 'f') .

536 (
$this
->
subSüt
 ? 't' : 'f') .

537 
$this
->
und”lše
 .

538 (
$this
->
¡rik‘hrough
 ? 't' : 'f') .

539 
$this
->
cŞÜ
->
	`g‘HashCode
() .

540 
__CLASS__


542 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/NumberFormat.php

1 <?
php


28 şas 
	cPHPExûl_StyË_Numb”FÜm©
 
ex‹nds
 
PHPExûl_StyË_Su³rvisÜ
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


31 cÚ¡ 
	mFORMAT_GENERAL
 = 'General';

33 cÚ¡ 
	mFORMAT_TEXT
 = '@';

35 cÚ¡ 
	mFORMAT_NUMBER
 = '0';

36 cÚ¡ 
	mFORMAT_NUMBER_00
 = '0.00';

37 cÚ¡ 
	mFORMAT_NUMBER_COMMA_SEPARATED1
 = '#,##0.00';

38 cÚ¡ 
	mFORMAT_NUMBER_COMMA_SEPARATED2
 = '#,##0.00_-';

40 cÚ¡ 
	mFORMAT_PERCENTAGE
 = '0%';

41 cÚ¡ 
	mFORMAT_PERCENTAGE_00
 = '0.00%';

43 cÚ¡ 
	mFORMAT_DATE_YYYYMMDD2
 = 'yyyy-mm-dd';

44 cÚ¡ 
	mFORMAT_DATE_YYYYMMDD
 = 'yy-mm-dd';

45 cÚ¡ 
	mFORMAT_DATE_DDMMYYYY
 = 'dd/mm/yy';

46 cÚ¡ 
	mFORMAT_DATE_DMYSLASH
 = 'd/m/y';

47 cÚ¡ 
	mFORMAT_DATE_DMYMINUS
 = 'd-m-y';

48 cÚ¡ 
	mFORMAT_DATE_DMMINUS
 = 'd-m';

49 cÚ¡ 
	mFORMAT_DATE_MYMINUS
 = 'm-y';

50 cÚ¡ 
	mFORMAT_DATE_XLSX14
 = 'mm-dd-yy';

51 cÚ¡ 
	mFORMAT_DATE_XLSX15
 = 'd-mmm-yy';

52 cÚ¡ 
	mFORMAT_DATE_XLSX16
 = 'd-mmm';

53 cÚ¡ 
	mFORMAT_DATE_XLSX17
 = 'mmm-yy';

54 cÚ¡ 
	mFORMAT_DATE_XLSX22
 = 'm/d/yy h:mm';

55 cÚ¡ 
	mFORMAT_DATE_DATETIME
 = 'd/m/y h:mm';

56 cÚ¡ 
	mFORMAT_DATE_TIME1
 = 'h:mm AM/PM';

57 cÚ¡ 
	mFORMAT_DATE_TIME2
 = 'h:mm:ss AM/PM';

58 cÚ¡ 
	mFORMAT_DATE_TIME3
 = 'h:mm';

59 cÚ¡ 
	mFORMAT_DATE_TIME4
 = 'h:mm:ss';

60 cÚ¡ 
	mFORMAT_DATE_TIME5
 = 'mm:ss';

61 cÚ¡ 
	mFORMAT_DATE_TIME6
 = 'h:mm:ss';

62 cÚ¡ 
	mFORMAT_DATE_TIME7
 = 'i:s.S';

63 cÚ¡ 
	mFORMAT_DATE_TIME8
 = 'h:mm:ss;@';

64 cÚ¡ 
	mFORMAT_DATE_YYYYMMDDSLASH
 = 'yy/mm/dd;@';

66 cÚ¡ 
	mFORMAT_CURRENCY_USD_SIMPLE
 = '"$"#,##0.00_-';

67 cÚ¡ 
	mFORMAT_CURRENCY_USD
 = '$#,##0_-';

68 cÚ¡ 
	mFORMAT_CURRENCY_EUR_SIMPLE
 = '[$EUR ]#,##0.00_-';

75 
´Ùeùed
 
	m$butInFÜm©s
;

82 
´Ùeùed
 
	m$æ³dButInFÜm©s
;

89 
´Ùeùed
 
	m$fÜm©Code
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL
;

96 
´Ùeùed
 
	m$butInFÜm©Code
 = 0;

108 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$isSu³rvisÜ
 = 
çl£
, 
$isCÚd™iÚ®
 = false)

111 
·»Á
::
	`__cÚ¡ruù
(
$isSu³rvisÜ
);

113 ià(
$isCÚd™iÚ®
) {

114 
$this
->
fÜm©Code
 = 
nuÎ
;

115 
$this
->
butInFÜm©Code
 = 
çl£
;

125 
public
 
funùiÚ
 
	$g‘Sh¬edCompÚ’t
()

127  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Numb”FÜm©
();

128 
	}
}

136 
public
 
funùiÚ
 
	$g‘StyËA¼ay
(
$¬¿y
)

138  
	`¬¿y
('numb”fÜm©' => 
$¬¿y
);

139 
	}
}

156 
public
 
funùiÚ
 
	$­¶yFromA¼ay
(
$pStyËs
 = 
nuÎ
)

158 ià(
	`is_¬¿y
(
$pStyËs
)) {

159 ià(
$this
->
isSu³rvisÜ
) {

160 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
($this->
	`g‘StyËA¼ay
(
$pStyËs
));

162 ià(
	`¬¿y_key_exi¡s
('code', 
$pStyËs
)) {

163 
$this
->
	`£tFÜm©Code
(
$pStyËs
['code']);

167 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid style‡rray…assed.");

169  
$this
;

170 
	}
}

177 
public
 
funùiÚ
 
	$g‘FÜm©Code
()

179 ià(
$this
->
isSu³rvisÜ
) {

180  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘FÜm©Code
();

182 ià(
$this
->
butInFÜm©Code
 !=ğ
çl£
) {

183  
£lf
::
	`butInFÜm©Code
(
$this
->
butInFÜm©Code
);

185  
$this
->
fÜm©Code
;

186 
	}
}

194 
public
 
funùiÚ
 
	$£tFÜm©Code
(
$pV®ue
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL
)

196 ià(
$pV®ue
 == '') {

197 
$pV®ue
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL
;

199 ià(
$this
->
isSu³rvisÜ
) {

200 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('code' => 
$pV®ue
));

201 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

203 
$this
->
fÜm©Code
 = 
$pV®ue
;

204 
$this
->
butInFÜm©Code
 = 
£lf
::
	`butInFÜm©CodeIndex
(
$pV®ue
);

206  
$this
;

207 
	}
}

214 
public
 
funùiÚ
 
	$g‘ButInFÜm©Code
()

216 ià(
$this
->
isSu³rvisÜ
) {

217  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘ButInFÜm©Code
();

219  
$this
->
butInFÜm©Code
;

220 
	}
}

228 
public
 
funùiÚ
 
	$£tButInFÜm©Code
(
$pV®ue
 = 0)

231 ià(
$this
->
isSu³rvisÜ
) {

232 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('code' => 
£lf
::
	`butInFÜm©Code
(
$pV®ue
)));

233 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

235 
$this
->
butInFÜm©Code
 = 
$pV®ue
;

236 
$this
->
fÜm©Code
 = 
£lf
::
	`butInFÜm©Code
(
$pV®ue
);

238  
$this
;

239 
	}
}

244 
´iv©e
 
funùiÚ
 
	$flButInFÜm©Codes
()

269 ià(
	`is_nuÎ
(
£lf
::
$butInFÜm©s
)) {

270 
£lf
::
$butInFÜm©s
 = 
	`¬¿y
();

273 
£lf
::
$butInFÜm©s
[0] = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL
;

274 
£lf
::
$butInFÜm©s
[1] = '0';

275 
£lf
::
$butInFÜm©s
[2] = '0.00';

276 
£lf
::
$butInFÜm©s
[3] = '#,##0';

277 
£lf
::
$butInFÜm©s
[4] = '#,##0.00';

279 
£lf
::
$butInFÜm©s
[9] = '0%';

280 
£lf
::
$butInFÜm©s
[10] = '0.00%';

281 
£lf
::
$butInFÜm©s
[11] = '0.00E+00';

282 
£lf
::
$butInFÜm©s
[12] = '# ?/?';

283 
£lf
::
$butInFÜm©s
[13] = '# ??/??';

284 
£lf
::
$butInFÜm©s
[14] = 'm/d/yyyy';

285 
£lf
::
$butInFÜm©s
[15] = 'd-mmm-yy';

286 
£lf
::
$butInFÜm©s
[16] = 'd-mmm';

287 
£lf
::
$butInFÜm©s
[17] = 'mmm-yy';

288 
£lf
::
$butInFÜm©s
[18] = 'h:mm AM/PM';

289 
£lf
::
$butInFÜm©s
[19] = 'h:mm:ss AM/PM';

290 
£lf
::
$butInFÜm©s
[20] = 'h:mm';

291 
£lf
::
$butInFÜm©s
[21] = 'h:mm:ss';

292 
£lf
::
$butInFÜm©s
[22] = 'm/d/yyyy h:mm';

294 
£lf
::
$butInFÜm©s
[37] = '#,##0_);(#,##0)';

295 
£lf
::
$butInFÜm©s
[38] = '#,##0_);[Red](#,##0)';

296 
£lf
::
$butInFÜm©s
[39] = '#,##0.00_);(#,##0.00)';

297 
£lf
::
$butInFÜm©s
[40] = '#,##0.00_);[Red](#,##0.00)';

299 
£lf
::
$butInFÜm©s
[44] = '_("$"* #,##0.00_);_("$"* \(#,##0.00\);_("$"* "-"??_);_(@_)';

300 
£lf
::
$butInFÜm©s
[45] = 'mm:ss';

301 
£lf
::
$butInFÜm©s
[46] = '[h]:mm:ss';

302 
£lf
::
$butInFÜm©s
[47] = 'mm:ss.0';

303 
£lf
::
$butInFÜm©s
[48] = '##0.0E+0';

304 
£lf
::
$butInFÜm©s
[49] = '@';

307 
£lf
::
$butInFÜm©s
[27] = '[$-404]e/m/d';

308 
£lf
::
$butInFÜm©s
[30] = 'm/d/yy';

309 
£lf
::
$butInFÜm©s
[36] = '[$-404]e/m/d';

310 
£lf
::
$butInFÜm©s
[50] = '[$-404]e/m/d';

311 
£lf
::
$butInFÜm©s
[57] = '[$-404]e/m/d';

314 
£lf
::
$butInFÜm©s
[59] = 't0';

315 
£lf
::
$butInFÜm©s
[60] = 't0.00';

316 
£lf
::
$butInFÜm©s
[61] = 't#,##0';

317 
£lf
::
$butInFÜm©s
[62] = 't#,##0.00';

318 
£lf
::
$butInFÜm©s
[67] = 't0%';

319 
£lf
::
$butInFÜm©s
[68] = 't0.00%';

320 
£lf
::
$butInFÜm©s
[69] = 't# ?/?';

321 
£lf
::
$butInFÜm©s
[70] = 't# ??/??';

324 
£lf
::
$æ³dButInFÜm©s
 = 
	`¬¿y_æ
(£lf::
$butInFÜm©s
);

326 
	}
}

334 
public
 
funùiÚ
 
	$butInFÜm©Code
(
$pIndex
)

337 
$pIndex
 = 
	`štv®
($pIndex);

340 
£lf
::
	`flButInFÜm©Codes
();

343 ià(
	`is£t
(
£lf
::
$butInFÜm©s
[
$pIndex
])) {

344  
£lf
::
$butInFÜm©s
[
$pIndex
];

348 
	}
}

356 
public
 
funùiÚ
 
	$butInFÜm©CodeIndex
(
$fÜm©Code
)

359 
£lf
::
	`flButInFÜm©Codes
();

362 ià(
	`is£t
(
£lf
::
$æ³dButInFÜm©s
[
$fÜm©Code
])) {

363  
£lf
::
$æ³dButInFÜm©s
[
$fÜm©Code
];

366  
çl£
;

367 
	}
}

374 
public
 
funùiÚ
 
	$g‘HashCode
()

376 ià(
$this
->
isSu³rvisÜ
) {

377  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘HashCode
();

379  
	`md5
(

380 
$this
->
fÜm©Code
 .

381 
$this
->
butInFÜm©Code
 .

382 
__CLASS__


384 
	}
}

391 
´iv©e
 
	g$d©eFÜm©R•Ïûm’ts
 = 
¬¿y
(

434 
´iv©e
 
	g$d©eFÜm©R•Ïûm’ts24
 = 
¬¿y
(

443 
´iv©e
 
	g$d©eFÜm©R•Ïûm’ts12
 = 
¬¿y
(

448 
´iv©e
 
funùiÚ
 
	$£tLow”ÿ£C®lback
(
$m©ches
) {

449  
	`mb_¡¹Şow”
(
$m©ches
[0]);

450 
	}
}

452 
´iv©e
 
funùiÚ
 
	$esÿ³QuÙesC®lback
(
$m©ches
) {

453  '\\' . 
	`im¶ode
('\\', 
	`¡r_¥l™
(
$m©ches
[1]));

454 
	}
}

456 
´iv©e
 
funùiÚ
 
	$fÜm©AsD©e
(&
$v®ue
, &
$fÜm©
)

461 
$fÜm©
 = 
	`´eg_»¶aû
('/^(\[\$[A-Z]*-[0-9A-F]*\])/i', '', $format);

465 
$fÜm©
 = 
	`´eg_»¶aû_ÿÎback
('/(?:^|")([^"]*)(?:$|")/', 
	`¬¿y
('self', 'setLowercaseCallback'), $format);

468 
$blocks
 = 
	`ex¶ode
('"', 
$fÜm©
);

469 
	`fÜ—ch
(
$blocks
 
as
 
$key
 => &
$block
) {

470 ià(
$key
 % 2 == 0) {

471 
$block
 = 
	`¡¹r
($block, 
£lf
::
$d©eFÜm©R•Ïûm’ts
);

472 ià(!
	`¡½os
(
$block
, 'A')) {

474 
$block
 = 
	`¡¹r
($block, 
£lf
::
$d©eFÜm©R•Ïûm’ts24
);

477 
$block
 = 
	`¡¹r
($block, 
£lf
::
$d©eFÜm©R•Ïûm’ts12
);

481 
$fÜm©
 = 
	`im¶ode
('"', 
$blocks
);

484 
$fÜm©
 = 
	`´eg_»¶aû_ÿÎback
('/"(.*)"/U', 
	`¬¿y
('self', 'escapeQuotesCallback'), $format);

486 
$d©eObj
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHPObjeù
(
$v®ue
);

487 
$v®ue
 = 
$d©eObj
->
	`fÜm©
(
$fÜm©
);

488 
	}
}

490 
´iv©e
 
funùiÚ
 
	$fÜm©AsP”ûÁage
(&
$v®ue
, &
$fÜm©
)

492 ià(
$fÜm©
 ==ğ
£lf
::
FORMAT_PERCENTAGE
) {

493 
$v®ue
 = 
	`round
((100 * $value), 0) . '%';

495 ià(
	`´eg_m©ch
('/\.[#0]+/i', 
$fÜm©
, 
$m
)) {

496 
$s
 = 
	`sub¡r
(
$m
[0], 0, 1è. (
	`¡¾’
($m[0]) - 1);

497 
$fÜm©
 = 
	`¡r_»¶aû
(
$m
[0], 
$s
, $format);

499 ià(
	`´eg_m©ch
('/^[#0]+/', 
$fÜm©
, 
$m
)) {

500 
$fÜm©
 = 
	`¡r_»¶aû
(
$m
[0], 
	`¡¾’
($m[0]), $format);

502 
$fÜm©
 = '%' . 
	`¡r_»¶aû
('%', 'f%%', $format);

504 
$v®ue
 = 
	`¥rštf
(
$fÜm©
, 100 * $value);

506 
	}
}

508 
´iv©e
 
funùiÚ
 
	$fÜm©AsF¿ùiÚ
(&
$v®ue
, &
$fÜm©
)

510 
$sign
 = (
$v®ue
 < 0) ? '-' : '';

512 
$š‹g”P¬t
 = 
	`æoÜ
(
	`abs
(
$v®ue
));

513 
$decim®P¬t
 = 
	`Œim
(
	`fmod
(
	`abs
(
$v®ue
), 1), '0.');

514 
$decim®L’gth
 = 
	`¡¾’
(
$decim®P¬t
);

515 
$decim®DivisÜ
 = 
	`pow
(10, 
$decim®L’gth
);

517 
$GCD
 = 
PHPExûl_C®cuÏtiÚ_M©hTrig
::
	`GCD
(
$decim®P¬t
, 
$decim®DivisÜ
);

519 
$adju¡edDecim®P¬t
 = 
$decim®P¬t
/
$GCD
;

520 
$adju¡edDecim®DivisÜ
 = 
$decim®DivisÜ
/
$GCD
;

522 ià((
	`¡½os
(
$fÜm©
, '0'è!=ğ
çl£
è|| (¡½os($fÜm©, '#'è!=ğçl£è|| (
	`sub¡r
($format, 0, 3) == '? ?')) {

523 ià(
$š‹g”P¬t
 == 0) {

524 
$š‹g”P¬t
 = '';

526 
$v®ue
 = "$sign$integerPart $adjustedDecimalPart/$adjustedDecimalDivisor";

528 
$adju¡edDecim®P¬t
 +ğ
$š‹g”P¬t
 * 
$adju¡edDecim®DivisÜ
;

529 
$v®ue
 = "$sign$adjustedDecimalPart/$adjustedDecimalDivisor";

531 
	}
}

533 
´iv©e
 
funùiÚ
 
	$com¶exNumb”FÜm©Mask
(
$numb”
, 
$mask
, 
$Ëv–
 = 0)

535 
$sign
 = (
$numb”
 < 0.0);

536 
$numb”
 = 
	`abs
($number);

537 ià(
	`¡½os
(
$mask
, '.'è!=ğ
çl£
) {

538 
$numb”s
 = 
	`ex¶ode
('.', 
$numb”
 . '.0');

539 
$masks
 = 
	`ex¶ode
('.', 
$mask
 . '.0');

540 
$»suÉ1
 = 
£lf
::
	`com¶exNumb”FÜm©Mask
(
$numb”s
[0], 
$masks
[0], 1);

541 
$»suÉ2
 = 
	`¡¼ev
(
£lf
::
	`com¶exNumb”FÜm©Mask
(¡¼ev(
$numb”s
[1]), sŒ»v(
$masks
[1]), 1));

542  ((
$sign
è? '-' : ''è. 
$»suÉ1
 . '.' . 
$»suÉ2
;

545 
$r
 = 
	`´eg_m©ch_®l
('/0+/', 
$mask
, 
$»suÉ
, 
PREG_OFFSET_CAPTURE
);

546 ià(
$r
 > 1) {

547 
$»suÉ
 = 
	`¬¿y_»v”£
($result[0]);

549 
	`fÜ—ch
 (
$»suÉ
 
as
 
$block
) {

550 
$divisÜ
 = 1 . 
$block
[0];

551 
$size
 = 
	`¡¾’
(
$block
[0]);

552 
$off£t
 = 
$block
[1];

554 
$blockV®ue
 = 
	`¥rštf
(

555 '%0' . 
$size
 . 'd',

556 
	`fmod
(
$numb”
, 
$divisÜ
)

558 
$numb”
 = 
	`æoÜ
($numb” / 
$divisÜ
);

559 
$mask
 = 
	`sub¡r_»¶aû
($mask, 
$blockV®ue
, 
$off£t
, 
$size
);

561 ià(
$numb”
 > 0) {

562 
$mask
 = 
	`sub¡r_»¶aû
($mask, 
$numb”
, 
$off£t
, 0);

564 
$»suÉ
 = 
$mask
;

566 
$»suÉ
 = 
$numb”
;

569  ((
$sign
è? '-' : ''è. 
$»suÉ
;

570 
	}
}

580 
public
 
funùiÚ
 
toFÜm©‹dSŒšg
(
$v®ue
 = '0', 
$fÜm©
 = 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL
, 
$ÿÎBack
 = 
nuÎ
)

583 ià(!
is_num”ic
(
$v®ue
)) {

584  
$v®ue
;

589 ià((
	g$fÜm©
 ==ğ
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL
è|| (
$fÜm©
 ==ğPHPExûl_StyË_Numb”FÜm©::
FORMAT_TEXT
)) {

590  
$v®ue
;

594 
	g$fÜm©
 = 
´eg_»¶aû
('/(\\\(.))(?=(?:[^"]|"[^"]*")*$)/u', '"${2}"', 
$fÜm©
);

597 
	g$£ùiÚs
 = 
´eg_¥l™
('/(;)(?=(?:[^"]|"[^"]*")*$)/u', 
$fÜm©
);

606 
couÁ
(
$£ùiÚs
)) {

608 
$fÜm©
 = 
$£ùiÚs
[0];

611 
$fÜm©
 = (
$v®ue
 >ğ0è? 
$£ùiÚs
[0] : $sections[1];

612 
	g$v®ue
 = 
abs
(
$v®ue
);

615 
$fÜm©
 = (
$v®ue
 > 0) ?

616 
$£ùiÚs
[0] : ( (
$v®ue
 < 0) ?

617 
$£ùiÚs
[1] : $sections[2]);

618 
	g$v®ue
 = 
abs
(
$v®ue
);

621 
$fÜm©
 = (
$v®ue
 > 0) ?

622 
$£ùiÚs
[0] : ( (
$v®ue
 < 0) ?

623 
$£ùiÚs
[1] : $sections[2]);

624 
	g$v®ue
 = 
abs
(
$v®ue
);

628 
$fÜm©
 = 
$£ùiÚs
[0];

634 
	g$fÜm©
 = 
´eg_»¶aû
('/_./', ' ', 
$fÜm©
);

637 
	g$fÜm©CŞÜ
 = 
$fÜm©
;

640 
	g$cŞÜ_»gex
 = '/^\\[[a-zA-Z]+\\]/';

641 
	g$fÜm©
 = 
´eg_»¶aû
(
$cŞÜ_»gex
, '', 
$fÜm©
);

646 ià(
´eg_m©ch
('/(\[\$[A-Z]*-[0-9A-F]*\])*[hmsdy](?=(?:[^"]|"[^"]*")*$)/miu', 
$fÜm©
, 
$m©ches
)) {

648 
	g£lf
::
fÜm©AsD©e
(
$v®ue
, 
$fÜm©
);

649 } 
–£if
 (
´eg_m©ch
('/%$/', 
$fÜm©
)) {

651 
	g£lf
::
fÜm©AsP”ûÁage
(
$v®ue
, 
$fÜm©
);

653 ià(
	g$fÜm©
 ==ğ
£lf
::
FORMAT_CURRENCY_EUR_SIMPLE
) {

654 
$v®ue
 = 'EUR ' . 
¥rštf
('%1.2f', $value);

657 
	g$fÜm©
 = 
¡r_»¶aû
(
¬¿y
('"', '*'), '', 
$fÜm©
);

662 
	g$u£Thou§nds
 = 
´eg_m©ch
('/(#,#|0,0)/', 
$fÜm©
);

663 ià(
	g$u£Thou§nds
) {

664 
	g$fÜm©
 = 
´eg_»¶aû
('/0,0/', '00', 
$fÜm©
);

665 
	g$fÜm©
 = 
´eg_»¶aû
('/#,#/', '##', 
$fÜm©
);

671 
	g$sÿË
 = 1;

672 
	g$m©ches
 = 
¬¿y
();

673 ià(
´eg_m©ch
('/(#|0)(,+)/', 
$fÜm©
, 
$m©ches
)) {

674 
	g$sÿË
 = 
pow
(1000, 
¡¾’
(
$m©ches
[2]));

677 
	g$fÜm©
 = 
´eg_»¶aû
('/0,+/', '0', 
$fÜm©
);

678 
	g$fÜm©
 = 
´eg_»¶aû
('/#,+/', '#', 
$fÜm©
);

681 ià(
´eg_m©ch
('/#?.*\?\/\?/', 
$fÜm©
, 
$m
)) {

683 ià(
	g$v®ue
 !ğ()
$v®ue
) {

684 
£lf
::
fÜm©AsF¿ùiÚ
(
$v®ue
, 
$fÜm©
);

691 
	g$v®ue
 = 
$v®ue
 / 
$sÿË
;

694 
	g$fÜm©
 = 
´eg_»¶aû
('/\\#/', '0', 
$fÜm©
);

696 
	g$n
 = "/\[[^\]]+\]/";

697 
	g$m
 = 
´eg_»¶aû
(
$n
, '', 
$fÜm©
);

698 
	g$numb”_»gex
 = "/(0+)(\.?)(0*)/";

699 ià(
´eg_m©ch
(
$numb”_»gex
, 
$m
, 
$m©ches
)) {

700 
	g$Ëá
 = 
$m©ches
[1];

701 
	g$dec
 = 
$m©ches
[2];

702 
	g$right
 = 
$m©ches
[3];

705 
	g$mšWidth
 = 
¡¾’
(
$Ëá
è+ sŒËn(
$dec
è+ sŒËn(
$right
);

706 ià(
	g$u£Thou§nds
) {

707 
	g$v®ue
 = 
numb”_fÜm©
(

708 
$v®ue
,

709 
¡¾’
(
$right
),

710 
PHPExûl_Sh¬ed_SŒšg
::
g‘Decim®S•¬©Ü
(),

711 
PHPExûl_Sh¬ed_SŒšg
::
g‘Thou§ndsS•¬©Ü
()

713 
	g$v®ue
 = 
´eg_»¶aû
(
$numb”_»gex
, 
$v®ue
, 
$fÜm©
);

715 ià(
´eg_m©ch
('/[0#]E[+-]0/i', 
$fÜm©
)) {

717 
	g$v®ue
 = 
¥rštf
('%5.2E', 
$v®ue
);

718 } 
–£if
 (
´eg_m©ch
('/0([^\d\.]+)0/', 
$fÜm©
)) {

719 
	g$v®ue
 = 
£lf
::
com¶exNumb”FÜm©Mask
(
$v®ue
, 
$fÜm©
);

721 
	g$¥rštf_·‰”n
 = "%0$mšWidth." . 
¡¾’
(
$right
) . "f";

722 
	g$v®ue
 = 
¥rštf
(
$¥rštf_·‰”n
, 
$v®ue
);

723 
	g$v®ue
 = 
´eg_»¶aû
(
$numb”_»gex
, 
$v®ue
, 
$fÜm©
);

728 ià(
´eg_m©ch
('/\[\$(.*)\]/u', 
$fÜm©
, 
$m
)) {

730 
	g$cu¼’cyFÜm©
 = 
$m
[0];

731 
	g$cu¼’cyCode
 = 
$m
[1];

732 
li¡
(
$cu¼’cyCode
èğ
ex¶ode
('-', $currencyCode);

733 ià(
	g$cu¼’cyCode
 == '') {

734 
$cu¼’cyCode
 = 
PHPExûl_Sh¬ed_SŒšg
::
g‘Cu¼’cyCode
();

736 
	g$v®ue
 = 
´eg_»¶aû
('/\[\$([^\]]*)\]/u', 
$cu¼’cyCode
, 
$v®ue
);

742 
	g$fÜm©
 = 
´eg_»¶aû
("/\\\\/u", '\\', 
$fÜm©
);

745 ià(
	g$ÿÎBack
 !=ğ
nuÎ
) {

746 
li¡
(
$wr™”In¡ªû
, 
$funùiÚ
èğ
$ÿÎBack
;

747 
	g$v®ue
 = 
$wr™”In¡ªû
->
$funùiÚ
(
$v®ue
, 
$fÜm©CŞÜ
);

750  
	g$v®ue
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Protection.php

1 <?
php


28 şas 
	cPHPExûl_StyË_PrÙeùiÚ
 
ex‹nds
 
PHPExûl_StyË_Su³rvisÜ
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


31 cÚ¡ 
	mPROTECTION_INHERIT
 = 'inherit';

32 cÚ¡ 
	mPROTECTION_PROTECTED
 = 'protected';

33 cÚ¡ 
	mPROTECTION_UNPROTECTED
 = 'unprotected';

40 
´Ùeùed
 
	m$locked
;

47 
´Ùeùed
 
	m$hidd’
;

59 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$isSu³rvisÜ
 = 
çl£
, 
$isCÚd™iÚ®
 = false)

62 
·»Á
::
	`__cÚ¡ruù
(
$isSu³rvisÜ
);

65 ià(!
$isCÚd™iÚ®
) {

66 
$this
->
locked
 = 
£lf
::
PROTECTION_INHERIT
;

67 
$this
->
hidd’
 = 
£lf
::
PROTECTION_INHERIT
;

77 
public
 
funùiÚ
 
	$g‘Sh¬edCompÚ’t
()

79  
$this
->
·»Á
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘PrÙeùiÚ
();

80 
	}
}

88 
public
 
funùiÚ
 
	$g‘StyËA¼ay
(
$¬¿y
)

90  
	`¬¿y
('´ÙeùiÚ' => 
$¬¿y
);

91 
	}
}

109 
public
 
funùiÚ
 
	$­¶yFromA¼ay
(
$pStyËs
 = 
nuÎ
)

111 ià(
	`is_¬¿y
(
$pStyËs
)) {

112 ià(
$this
->
isSu³rvisÜ
) {

113 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
($this->
	`g‘StyËA¼ay
(
$pStyËs
));

115 ià(
	`is£t
(
$pStyËs
['locked'])) {

116 
$this
->
	`£tLocked
(
$pStyËs
['locked']);

118 ià(
	`is£t
(
$pStyËs
['hidden'])) {

119 
$this
->
	`£tHidd’
(
$pStyËs
['hidden']);

123 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid style‡rray…assed.");

125  
$this
;

126 
	}
}

133 
public
 
funùiÚ
 
	$g‘Locked
()

135 ià(
$this
->
isSu³rvisÜ
) {

136  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Locked
();

138  
$this
->
locked
;

139 
	}
}

147 
public
 
funùiÚ
 
	$£tLocked
(
$pV®ue
 = 
£lf
::
PROTECTION_INHERIT
)

149 ià(
$this
->
isSu³rvisÜ
) {

150 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('locked' => 
$pV®ue
));

151 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

153 
$this
->
locked
 = 
$pV®ue
;

155  
$this
;

156 
	}
}

163 
public
 
funùiÚ
 
	$g‘Hidd’
()

165 ià(
$this
->
isSu³rvisÜ
) {

166  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘Hidd’
();

168  
$this
->
hidd’
;

169 
	}
}

177 
public
 
funùiÚ
 
	$£tHidd’
(
$pV®ue
 = 
£lf
::
PROTECTION_INHERIT
)

179 ià(
$this
->
isSu³rvisÜ
) {

180 
$¡yËA¼ay
 = 
$this
->
	`g‘StyËA¼ay
(
	`¬¿y
('hidd’' => 
$pV®ue
));

181 
$this
->
	`g‘AùiveSh“t
()->
	`g‘StyË
($this->
	`g‘S–eùedC–ls
())->
	`­¶yFromA¼ay
(
$¡yËA¼ay
);

183 
$this
->
hidd’
 = 
$pV®ue
;

185  
$this
;

186 
	}
}

193 
public
 
funùiÚ
 
	$g‘HashCode
()

195 ià(
$this
->
isSu³rvisÜ
) {

196  
$this
->
	`g‘Sh¬edCompÚ’t
()->
	`g‘HashCode
();

198  
	`md5
(

199 
$this
->
locked
 .

200 
$this
->
hidd’
 .

201 
__CLASS__


203 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Supervisor.php

1 <?
php


28 
ab¡¿ù
 cÏs 
	cPHPExûl_StyË_Su³rvisÜ


35 
´Ùeùed
 
	m$isSu³rvisÜ
;

42 
´Ùeùed
 
	m$·»Á
;

51 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$isSu³rvisÜ
 = 
çl£
)

54 
$this
->
isSu³rvisÜ
 = 
$isSu³rvisÜ
;

63 
public
 
funùiÚ
 
	$bšdP¬’t
(
$·»Á
, 
$·»ÁPrİ”tyName
 = 
nuÎ
)

65 
$this
->
·»Á
 = 
$·»Á
;

66  
$this
;

67 
	}
}

74 
public
 
funùiÚ
 
	$g‘IsSu³rvisÜ
()

76  
$this
->
isSu³rvisÜ
;

77 
	}
}

84 
public
 
funùiÚ
 
	$g‘AùiveSh“t
()

86  
$this
->
·»Á
->
	`g‘AùiveSh“t
();

87 
	}
}

95 
public
 
funùiÚ
 
	$g‘S–eùedC–ls
()

97  
$this
->
	`g‘AùiveSh“t
()->
	`g‘S–eùedC–ls
();

98 
	}
}

106 
public
 
funùiÚ
 
	$g‘AùiveC–l
()

108  
$this
->
	`g‘AùiveSh“t
()->
	`g‘AùiveC–l
();

109 
	}
}

114 
public
 
funùiÚ
 
	$__şÚe
()

116 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

117 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

118 ià((
	`is_objeù
(
$v®ue
)è&& (
$key
 != 'parent')) {

119 
$this
->
$key
 = 
şÚe
 
$v®ue
;

121 
$this
->
$key
 = 
$v®ue
;

124 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


31 cÚ¡ 
	mBREAK_NONE
 = 0;

32 cÚ¡ 
	mBREAK_ROW
 = 1;

33 cÚ¡ 
	mBREAK_COLUMN
 = 2;

36 cÚ¡ 
	mSHEETSTATE_VISIBLE
 = 'visible';

37 cÚ¡ 
	mSHEETSTATE_HIDDEN
 = 'hidden';

38 cÚ¡ 
	mSHEETSTATE_VERYHIDDEN
 = 'veryHidden';

45 
´iv©e
 
	m$šv®idCh¬aù”s
 = 
¬¿y
('*', ':', '/', '\\', '?', '[', ']');

52 
´iv©e
 
	m$·»Á
;

59 
´iv©e
 
	m$ûÎCŞËùiÚ
;

66 
´iv©e
 
	m$rowDim’siÚs
 = 
¬¿y
();

73 
´iv©e
 
	m$deçuÉRowDim’siÚ
;

80 
´iv©e
 
	m$cŞumnDim’siÚs
 = 
¬¿y
();

87 
´iv©e
 
	m$deçuÉCŞumnDim’siÚ
 = 
nuÎ
;

94 
´iv©e
 
	m$d¿wšgCŞËùiÚ
 = 
nuÎ
;

101 
´iv©e
 
	m$ch¬tCŞËùiÚ
 = 
¬¿y
();

108 
´iv©e
 
	m$t™Ë
;

115 
´iv©e
 
	m$sh“tS‹
;

122 
´iv©e
 
	m$·geS‘up
;

129 
´iv©e
 
	m$·geM¬gšs
;

136 
´iv©e
 
	m$h—d”FoÙ”
;

143 
´iv©e
 
	m$sh“tV›w
;

150 
´iv©e
 
	m$´ÙeùiÚ
;

157 
´iv©e
 
	m$¡yËs
 = 
¬¿y
();

164 
´iv©e
 
	m$cÚd™iÚ®StyËsCŞËùiÚ
 = 
¬¿y
();

171 
´iv©e
 
	m$ûÎCŞËùiÚIsSÜ‹d
 = 
çl£
;

178 
´iv©e
 
	m$b»aks
 = 
¬¿y
();

185 
´iv©e
 
	m$m”geC–ls
 = 
¬¿y
();

192 
´iv©e
 
	m$´ÙeùedC–ls
 = 
¬¿y
();

199 
´iv©e
 
	m$autoF‹r
;

206 
´iv©e
 
	m$ä“zePªe
 = '';

213 
´iv©e
 
	m$showGridlšes
 = 
Œue
;

220 
´iv©e
 
	m$´štGridlšes
 = 
çl£
;

227 
´iv©e
 
	m$showRowCŞH—d”s
 = 
Œue
;

234 
´iv©e
 
	m$showSumm¬yB–ow
 = 
Œue
;

241 
´iv©e
 
	m$showSumm¬yRight
 = 
Œue
;

248 
´iv©e
 
	m$comm’ts
 = 
¬¿y
();

255 
´iv©e
 
	m$aùiveC–l
 = 'A1';

262 
´iv©e
 
	m$£ËùedC–ls
 = 'A1';

269 
´iv©e
 
	m$ÿchedHighe¡CŞumn
 = 'A';

276 
´iv©e
 
	m$ÿchedHighe¡Row
 = 1;

283 
´iv©e
 
	m$rightToLeá
 = 
çl£
;

290 
´iv©e
 
	m$hy³¾škCŞËùiÚ
 = 
¬¿y
();

297 
´iv©e
 
	m$d©aV®id©iÚCŞËùiÚ
 = 
¬¿y
();

304 
´iv©e
 
	m$bCŞÜ
;

311 
´iv©e
 
	m$dœty
 = 
Œue
;

318 
´iv©e
 
	m$hash
;

325 
´iv©e
 
	m$codeName
 = 
nuÎ
;

333 
public
 
funùiÚ
 
__cÚ¡ruù
(
PHPExûl
 
$pP¬’t
 = 
nuÎ
, 
$pT™Ë
 = 'Worksheet')

336 
$this
->
·»Á
 = 
$pP¬’t
;

337 
	m$this
->
£tT™Ë
(
$pT™Ë
, 
çl£
);

339 
	m$this
->
£tCodeName
(
$this
->
g‘T™Ë
());

340 
	m$this
->
£tSh“tS‹
(
PHPExûl_WÜksh“t
::
SHEETSTATE_VISIBLE
);

342 
	m$this
->
	mûÎCŞËùiÚ
 = 
PHPExûl_CachedObjeùStÜageFaùÜy
::
g‘In¡ªû
(
$this
);

344 
	m$this
->
	m·geS‘up
 = 
Ãw
 
PHPExûl_WÜksh“t_PageS‘up
();

346 
	m$this
->
	m·geM¬gšs
 = 
Ãw
 
PHPExûl_WÜksh“t_PageM¬gšs
();

348 
	m$this
->
	mh—d”FoÙ”
 = 
Ãw
 
PHPExûl_WÜksh“t_H—d”FoÙ”
();

350 
	m$this
->
	msh“tV›w
 = 
Ãw
 
PHPExûl_WÜksh“t_Sh“tV›w
();

352 
	m$this
->
	md¿wšgCŞËùiÚ
 = 
Ãw
 
A¼ayObjeù
();

354 
	m$this
->
	mch¬tCŞËùiÚ
 = 
Ãw
 
A¼ayObjeù
();

356 
	m$this
->
	m´ÙeùiÚ
 = 
Ãw
 
PHPExûl_WÜksh“t_PrÙeùiÚ
();

358 
	m$this
->
	mdeçuÉRowDim’siÚ
 = 
Ãw
 
PHPExûl_WÜksh“t_RowDim’siÚ
(
nuÎ
);

360 
	m$this
->
	mdeçuÉCŞumnDim’siÚ
 = 
Ãw
 
PHPExûl_WÜksh“t_CŞumnDim’siÚ
(
nuÎ
);

361 
	m$this
->
	mautoF‹r
 = 
Ãw
 
PHPExûl_WÜksh“t_AutoF‹r
(
nuÎ
, 
$this
);

370 
public
 
funùiÚ
 
	$discÚÃùC–ls
()

372 ià(
$this
->
ûÎCŞËùiÚ
 !=ğ
nuÎ
) {

373 
$this
->
ûÎCŞËùiÚ
->
	`un£tWÜksh“tC–ls
();

374 
$this
->
ûÎCŞËùiÚ
 = 
nuÎ
;

377 
$this
->
·»Á
 = 
nuÎ
;

378 
	}
}

384 
public
 
funùiÚ
 
	$__de¡ruù
()

386 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
·»Á
)->
	`ş—rC®cuÏtiÚCacheFÜWÜksh“t
($this->
t™Ë
);

388 
$this
->
	`discÚÃùC–ls
();

389 
	}
}

396 
public
 
funùiÚ
 
	$g‘C–lCacheCÚŒŞËr
()

398  
$this
->
ûÎCŞËùiÚ
;

399 
	}
}

407 
public
 
funùiÚ
 
	$g‘Inv®idCh¬aù”s
()

409  
£lf
::
$šv®idCh¬aù”s
;

410 
	}
}

419 
´iv©e
 
funùiÚ
 
	$checkSh“tCodeName
(
$pV®ue
)

421 
$Ch¬CouÁ
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$pV®ue
);

422 ià(
$Ch¬CouÁ
 == 0) {

423 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Sheet code‚ame cannot beƒmpty.');

426 ià((
	`¡r_»¶aû
(
£lf
::
$šv®idCh¬aù”s
, '', 
$pV®ue
) !== $pValue) ||

427 (
PHPExûl_Sh¬ed_SŒšg
::
	`Sub¡ršg
(
$pV®ue
, -1, 1)=='\'') ||

428 (
PHPExûl_Sh¬ed_SŒšg
::
	`Sub¡ršg
(
$pV®ue
, 0, 1)=='\'')) {

429 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid character found in sheet code‚ame');

433 ià(
$Ch¬CouÁ
 > 31) {

434 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Maximum 31 characters‡llowed in sheet code‚ame.');

437  
$pV®ue
;

438 
	}
}

447 
´iv©e
 
funùiÚ
 
	$checkSh“tT™Ë
(
$pV®ue
)

450 ià(
	`¡r_»¶aû
(
£lf
::
$šv®idCh¬aù”s
, '', 
$pV®ue
) !== $pValue) {

451 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid character found in sheetitle');

455 ià(
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$pV®ue
) > 31) {

456 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Maximum 31 characters‡llowed in sheetitle.');

459  
$pV®ue
;

460 
	}
}

468 
public
 
funùiÚ
 
	$g‘C–lCŞËùiÚ
(
$pSÜ‹d
 = 
Œue
)

470 ià(
$pSÜ‹d
) {

472  
$this
->
	`sÜtC–lCŞËùiÚ
();

474 ià(
$this
->
ûÎCŞËùiÚ
 !=ğ
nuÎ
) {

475  
$this
->
ûÎCŞËùiÚ
->
	`g‘C–lLi¡
();

477  
	`¬¿y
();

478 
	}
}

485 
public
 
funùiÚ
 
	$sÜtC–lCŞËùiÚ
()

487 ià(
$this
->
ûÎCŞËùiÚ
 !=ğ
nuÎ
) {

488  
$this
->
ûÎCŞËùiÚ
->
	`g‘SÜ‹dC–lLi¡
();

490  
	`¬¿y
();

491 
	}
}

498 
public
 
funùiÚ
 
	$g‘RowDim’siÚs
()

500  
$this
->
rowDim’siÚs
;

501 
	}
}

508 
public
 
funùiÚ
 
	$g‘DeçuÉRowDim’siÚ
()

510  
$this
->
deçuÉRowDim’siÚ
;

511 
	}
}

518 
public
 
funùiÚ
 
	$g‘CŞumnDim’siÚs
()

520  
$this
->
cŞumnDim’siÚs
;

521 
	}
}

528 
public
 
funùiÚ
 
	$g‘DeçuÉCŞumnDim’siÚ
()

530  
$this
->
deçuÉCŞumnDim’siÚ
;

531 
	}
}

538 
public
 
funùiÚ
 
	$g‘D¿wšgCŞËùiÚ
()

540  
$this
->
d¿wšgCŞËùiÚ
;

541 
	}
}

548 
public
 
funùiÚ
 
	$g‘Ch¬tCŞËùiÚ
()

550  
$this
->
ch¬tCŞËùiÚ
;

551 
	}
}

560 
public
 
funùiÚ
 
	$addCh¬t
(
PHPExûl_Ch¬t
 
$pCh¬t
 = 
nuÎ
, 
$iCh¬tIndex
 =‚ull)

562 
$pCh¬t
->
	`£tWÜksh“t
(
$this
);

563 ià(
	`is_nuÎ
(
$iCh¬tIndex
)) {

564 
$this
->
ch¬tCŞËùiÚ
[] = 
$pCh¬t
;

567 
	`¬¿y_¥liû
(
$this
->
ch¬tCŞËùiÚ
, 
$iCh¬tIndex
, 0, 
	`¬¿y
(
$pCh¬t
));

570  
$pCh¬t
;

571 
	}
}

578 
public
 
funùiÚ
 
	$g‘Ch¬tCouÁ
()

580  
	`couÁ
(
$this
->
ch¬tCŞËùiÚ
);

581 
	}
}

590 
public
 
funùiÚ
 
	$g‘Ch¬tByIndex
(
$šdex
 = 
nuÎ
)

592 
$ch¬tCouÁ
 = 
	`couÁ
(
$this
->
ch¬tCŞËùiÚ
);

593 ià(
$ch¬tCouÁ
 == 0) {

594  
çl£
;

596 ià(
	`is_nuÎ
(
$šdex
)) {

597 
$šdex
 = --
$ch¬tCouÁ
;

599 ià(!
	`is£t
(
$this
->
ch¬tCŞËùiÚ
[
$šdex
])) {

600  
çl£
;

603  
$this
->
ch¬tCŞËùiÚ
[
$šdex
];

604 
	}
}

612 
public
 
funùiÚ
 
	$g‘Ch¬tNames
()

614 
$ch¬tNames
 = 
	`¬¿y
();

615 
	`fÜ—ch
 (
$this
->
ch¬tCŞËùiÚ
 
as
 
$ch¬t
) {

616 
$ch¬tNames
[] = 
$ch¬t
->
	`g‘Name
();

618  
$ch¬tNames
;

619 
	}
}

628 
public
 
funùiÚ
 
g‘Ch¬tByName
(
$ch¬tName
 = '')

630 
$ch¬tCouÁ
 = 
couÁ
(
$this
->
ch¬tCŞËùiÚ
);

631 ià(
	g$ch¬tCouÁ
 == 0) {

632  
çl£
;

634 
fÜ—ch
 (
$this
->
ch¬tCŞËùiÚ
 
as
 
$šdex
 => 
$ch¬t
) {

635 ià(
$ch¬t
->
g‘Name
(è=ğ
$ch¬tName
) {

636  
$this
->
ch¬tCŞËùiÚ
[
$šdex
];

639  
	gçl£
;

647 
public
 
funùiÚ
 
	$»äeshCŞumnDim’siÚs
()

649 
$cu¼’tCŞumnDim’siÚs
 = 
$this
->
	`g‘CŞumnDim’siÚs
();

650 
$ÃwCŞumnDim’siÚs
 = 
	`¬¿y
();

652 
	`fÜ—ch
 (
$cu¼’tCŞumnDim’siÚs
 
as
 
$objCŞumnDim’siÚ
) {

653 
$ÃwCŞumnDim’siÚs
[
$objCŞumnDim’siÚ
->
	`g‘CŞumnIndex
()] = $objColumnDimension;

656 
$this
->
cŞumnDim’siÚs
 = 
$ÃwCŞumnDim’siÚs
;

658  
$this
;

659 
	}
}

666 
public
 
funùiÚ
 
	$»äeshRowDim’siÚs
()

668 
$cu¼’tRowDim’siÚs
 = 
$this
->
	`g‘RowDim’siÚs
();

669 
$ÃwRowDim’siÚs
 = 
	`¬¿y
();

671 
	`fÜ—ch
 (
$cu¼’tRowDim’siÚs
 
as
 
$objRowDim’siÚ
) {

672 
$ÃwRowDim’siÚs
[
$objRowDim’siÚ
->
	`g‘RowIndex
()] = $objRowDimension;

675 
$this
->
rowDim’siÚs
 = 
$ÃwRowDim’siÚs
;

677  
$this
;

678 
	}
}

685 
public
 
funùiÚ
 
	$ÿlcuÏ‹WÜksh“tDim’siÚ
()

688  'A1' . ':' . 
$this
->
	`g‘Highe¡CŞumn
(è. $this->
	`g‘Highe¡Row
();

689 
	}
}

696 
public
 
funùiÚ
 
	$ÿlcuÏ‹WÜksh“tD©aDim’siÚ
()

699  'A1' . ':' . 
$this
->
	`g‘Highe¡D©aCŞumn
(è. $this->
	`g‘Highe¡D©aRow
();

700 
	}
}

708 
public
 
funùiÚ
 
	$ÿlcuÏ‹CŞumnWidths
(
$ÿlcuÏ‹M”geC–ls
 = 
çl£
)

711 
$autoSizes
 = 
	`¬¿y
();

712 
	`fÜ—ch
 (
$this
->
	`g‘CŞumnDim’siÚs
(è
as
 
$cŞDim’siÚ
) {

713 ià(
$cŞDim’siÚ
->
	`g‘AutoSize
()) {

714 
$autoSizes
[
$cŞDim’siÚ
->
	`g‘CŞumnIndex
()] = -1;

719 ià(!
	`em±y
(
$autoSizes
)) {

721 
$isM”geC–l
 = 
	`¬¿y
();

722 
	`fÜ—ch
 (
$this
->
	`g‘M”geC–ls
(è
as
 
$ûÎs
) {

723 
	`fÜ—ch
 (
PHPExûl_C–l
::
	`exŒaùAÎC–lReã»nûsInRªge
(
$ûÎs
è
as
 
$ûÎReã»nû
) {

724 
$isM”geC–l
[
$ûÎReã»nû
] = 
Œue
;

729 
	`fÜ—ch
 (
$this
->
	`g‘C–lCŞËùiÚ
(
çl£
è
as
 
$ûÎID
) {

730 
$ûÎ
 = 
$this
->
	`g‘C–l
(
$ûÎID
);

731 ià(
	`is£t
(
$autoSizes
[
$this
->
ûÎCŞËùiÚ
->
	`g‘Cu¼’tCŞumn
()])) {

733 ià(!
	`is£t
(
$isM”geC–l
[
$this
->
ûÎCŞËùiÚ
->
	`g‘Cu¼’tAdd»ss
()])) {

736 
$ûÎV®ue
 = 
PHPExûl_StyË_Numb”FÜm©
::
	`toFÜm©‹dSŒšg
(

737 
$ûÎ
->
	`g‘C®cuÏ‹dV®ue
(),

738 
$this
->
	`g‘P¬’t
()->
	`g‘C–lXfByIndex
(
$ûÎ
->
	`g‘XfIndex
())->
	`g‘Numb”FÜm©
()->
	`g‘FÜm©Code
()

741 
$autoSizes
[
$this
->
ûÎCŞËùiÚ
->
	`g‘Cu¼’tCŞumn
()] = 
	`max
(

742 (è
$autoSizes
[
$this
->
ûÎCŞËùiÚ
->
	`g‘Cu¼’tCŞumn
()],

743 ()
PHPExûl_Sh¬ed_FÚt
::
	`ÿlcuÏ‹CŞumnWidth
(

744 
$this
->
	`g‘P¬’t
()->
	`g‘C–lXfByIndex
(
$ûÎ
->
	`g‘XfIndex
())->
	`g‘FÚt
(),

745 
$ûÎV®ue
,

746 
$this
->
	`g‘P¬’t
()->
	`g‘C–lXfByIndex
(
$ûÎ
->
	`g‘XfIndex
())->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
(),

747 
$this
->
	`g‘DeçuÉStyË
()->
	`g‘FÚt
()

755 
	`fÜ—ch
 (
$autoSizes
 
as
 
$cŞumnIndex
 => 
$width
) {

756 ià(
$width
 == -1) {

757 
$width
 = 
$this
->
	`g‘DeçuÉCŞumnDim’siÚ
()->
	`g‘Width
();

759 
$this
->
	`g‘CŞumnDim’siÚ
(
$cŞumnIndex
)->
	`£tWidth
(
$width
);

763  
$this
;

764 
	}
}

771 
public
 
funùiÚ
 
	$g‘P¬’t
()

773  
$this
->
·»Á
;

774 
	}
}

782 
public
 
funùiÚ
 
	$»bšdP¬’t
(
PHPExûl
 
$·»Á
)

784 ià(
$this
->
·»Á
 !=ğ
nuÎ
) {

785 
$ÇmedRªges
 = 
$this
->
·»Á
->
	`g‘NamedRªges
();

786 
	`fÜ—ch
 (
$ÇmedRªges
 
as
 
$ÇmedRªge
) {

787 
$·»Á
->
	`addNamedRªge
(
$ÇmedRªge
);

790 
$this
->
·»Á
->
	`»moveSh“tByIndex
(

791 
$this
->
·»Á
->
	`g‘Index
($this)

794 
$this
->
·»Á
 = 
$·»Á
;

796  
$this
;

797 
	}
}

804 
public
 
funùiÚ
 
	$g‘T™Ë
()

806  
$this
->
t™Ë
;

807 
	}
}

820 
public
 
funùiÚ
 
£tT™Ë
(
$pV®ue
 = 'WÜksh“t', 
$upd©eFÜmuÏC–lReã»nûs
 = 
Œue
)

823 ià(
$this
->
g‘T™Ë
(è=ğ
$pV®ue
) {

824  
$this
;

828 
	g£lf
::
checkSh“tT™Ë
(
$pV®ue
);

831 
	g$ŞdT™Ë
 = 
$this
->
g‘T™Ë
();

833 ià(
	g$this
->
	g·»Á
) {

835 ià(
	g$this
->
	g·»Á
->
sh“tNameExi¡s
(
$pV®ue
)) {

838 ià(
	gPHPExûl_Sh¬ed_SŒšg
::
CouÁCh¬aù”s
(
$pV®ue
) > 29) {

839 
$pV®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
Sub¡ršg
($pValue, 0, 29);

841 
	g$i
 = 1;

842 
	g$this
->
	g·»Á
->
sh“tNameExi¡s
(
$pV®ue
 . ' ' . 
$i
)) {

843 ++
	g$i
;

844 ià(
	g$i
 == 10) {

845 ià(
PHPExûl_Sh¬ed_SŒšg
::
CouÁCh¬aù”s
(
$pV®ue
) > 28) {

846 
$pV®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
Sub¡ršg
($pValue, 0, 28);

848 } 
–£if
 (
$i
 == 100) {

849 ià(
PHPExûl_Sh¬ed_SŒšg
::
CouÁCh¬aù”s
(
$pV®ue
) > 27) {

850 
$pV®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
Sub¡ršg
($pValue, 0, 27);

855 
	g$®tT™Ë
 = 
$pV®ue
 . ' ' . 
$i
;

856  
	g$this
->
£tT™Ë
(
$®tT™Ë
, 
$upd©eFÜmuÏC–lReã»nûs
);

861 
	g$this
->
	gt™Ë
 = 
$pV®ue
;

862 
	g$this
->
	gdœty
 = 
Œue
;

864 ià(
	g$this
->
	g·»Á
) {

866 
	g$ÃwT™Ë
 = 
$this
->
g‘T™Ë
();

867 
	gPHPExûl_C®cuÏtiÚ
::
g‘In¡ªû
(
$this
->
·»Á
)

868 ->
»ÇmeC®cuÏtiÚCacheFÜWÜksh“t
(
$ŞdT™Ë
, 
$ÃwT™Ë
);

869 ià(
	g$upd©eFÜmuÏC–lReã»nûs
) {

870 
	gPHPExûl_Reã»nûH–³r
::
g‘In¡ªû
()->
upd©eNamedFÜmuÏs
(
$this
->
·»Á
, 
$ŞdT™Ë
, 
$ÃwT™Ë
);

874  
	g$this
;

882 
public
 
funùiÚ
 
	$g‘Sh“tS‹
()

884  
$this
->
sh“tS‹
;

885 
	}
}

893 
public
 
funùiÚ
 
	$£tSh“tS‹
(
$v®ue
 = 
PHPExûl_WÜksh“t
::
SHEETSTATE_VISIBLE
)

895 
$this
->
sh“tS‹
 = 
$v®ue
;

896  
$this
;

897 
	}
}

904 
public
 
funùiÚ
 
	$g‘PageS‘up
()

906  
$this
->
·geS‘up
;

907 
	}
}

915 
public
 
funùiÚ
 
	$£tPageS‘up
(
PHPExûl_WÜksh“t_PageS‘up
 
$pV®ue
)

917 
$this
->
·geS‘up
 = 
$pV®ue
;

918  
$this
;

919 
	}
}

926 
public
 
funùiÚ
 
	$g‘PageM¬gšs
()

928  
$this
->
·geM¬gšs
;

929 
	}
}

937 
public
 
funùiÚ
 
	$£tPageM¬gšs
(
PHPExûl_WÜksh“t_PageM¬gšs
 
$pV®ue
)

939 
$this
->
·geM¬gšs
 = 
$pV®ue
;

940  
$this
;

941 
	}
}

948 
public
 
funùiÚ
 
	$g‘H—d”FoÙ”
()

950  
$this
->
h—d”FoÙ”
;

951 
	}
}

959 
public
 
funùiÚ
 
	$£tH—d”FoÙ”
(
PHPExûl_WÜksh“t_H—d”FoÙ”
 
$pV®ue
)

961 
$this
->
h—d”FoÙ”
 = 
$pV®ue
;

962  
$this
;

963 
	}
}

970 
public
 
funùiÚ
 
	$g‘Sh“tV›w
()

972  
$this
->
sh“tV›w
;

973 
	}
}

981 
public
 
funùiÚ
 
	$£tSh“tV›w
(
PHPExûl_WÜksh“t_Sh“tV›w
 
$pV®ue
)

983 
$this
->
sh“tV›w
 = 
$pV®ue
;

984  
$this
;

985 
	}
}

992 
public
 
funùiÚ
 
	$g‘PrÙeùiÚ
()

994  
$this
->
´ÙeùiÚ
;

995 
	}
}

1003 
public
 
funùiÚ
 
	$£tPrÙeùiÚ
(
PHPExûl_WÜksh“t_PrÙeùiÚ
 
$pV®ue
)

1005 
$this
->
´ÙeùiÚ
 = 
$pV®ue
;

1006 
$this
->
dœty
 = 
Œue
;

1008  
$this
;

1009 
	}
}

1018 
public
 
funùiÚ
 
	$g‘Highe¡CŞumn
(
$row
 = 
nuÎ
)

1020 ià(
$row
 =ğ
nuÎ
) {

1021  
$this
->
ÿchedHighe¡CŞumn
;

1023  
$this
->
	`g‘Highe¡D©aCŞumn
(
$row
);

1024 
	}
}

1033 
public
 
funùiÚ
 
	$g‘Highe¡D©aCŞumn
(
$row
 = 
nuÎ
)

1035  
$this
->
ûÎCŞËùiÚ
->
	`g‘Highe¡CŞumn
(
$row
);

1036 
	}
}

1045 
public
 
funùiÚ
 
	$g‘Highe¡Row
(
$cŞumn
 = 
nuÎ
)

1047 ià(
$cŞumn
 =ğ
nuÎ
) {

1048  
$this
->
ÿchedHighe¡Row
;

1050  
$this
->
	`g‘Highe¡D©aRow
(
$cŞumn
);

1051 
	}
}

1060 
public
 
funùiÚ
 
	$g‘Highe¡D©aRow
(
$cŞumn
 = 
nuÎ
)

1062  
$this
->
ûÎCŞËùiÚ
->
	`g‘Highe¡Row
(
$cŞumn
);

1063 
	}
}

1070 
public
 
funùiÚ
 
	$g‘Highe¡RowAndCŞumn
()

1072  
$this
->
ûÎCŞËùiÚ
->
	`g‘Highe¡RowAndCŞumn
();

1073 
	}
}

1083 
public
 
funùiÚ
 
£tC–lV®ue
(
$pCoÜdš©e
 = 'A1', 
$pV®ue
 = 
nuÎ
, 
$»tuºC–l
 = 
çl£
)

1085 
$ûÎ
 = 
$this
->
g‘C–l
(
¡¹ouµ”
(
$pCoÜdš©e
))->
£tV®ue
(
$pV®ue
);

1086  (
	g$»tuºC–l
è? 
	g$ûÎ
 : 
$this
;

1098 
public
 
funùiÚ
 
	$£tC–lV®ueByCŞumnAndRow
(
$pCŞumn
 = 0, 
$pRow
 = 1, 
$pV®ue
 = 
nuÎ
, 
$»tuºC–l
 = 
çl£
)

1100 
$ûÎ
 = 
$this
->
	`g‘C–lByCŞumnAndRow
(
$pCŞumn
, 
$pRow
)->
	`£tV®ue
(
$pV®ue
);

1101  (
$»tuºC–l
è? 
$ûÎ
 : 
$this
;

1102 
	}
}

1113 
public
 
funùiÚ
 
£tC–lV®ueEx¶ic™
(
$pCoÜdš©e
 = 'A1', 
$pV®ue
 = 
nuÎ
, 
$pD©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
, 
$»tuºC–l
 = 
çl£
)

1116 
$ûÎ
 = 
$this
->
g‘C–l
(
¡¹ouµ”
(
$pCoÜdš©e
))->
£tV®ueEx¶ic™
(
$pV®ue
, 
$pD©aTy³
);

1117  (
	g$»tuºC–l
è? 
	g$ûÎ
 : 
$this
;

1130 
public
 
funùiÚ
 
	$£tC–lV®ueEx¶ic™ByCŞumnAndRow
(
$pCŞumn
 = 0, 
$pRow
 = 1, 
$pV®ue
 = 
nuÎ
, 
$pD©aTy³
 = 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
, 
$»tuºC–l
 = 
çl£
)

1132 
$ûÎ
 = 
$this
->
	`g‘C–lByCŞumnAndRow
(
$pCŞumn
, 
$pRow
)->
	`£tV®ueEx¶ic™
(
$pV®ue
, 
$pD©aTy³
);

1133  (
$»tuºC–l
è? 
$ûÎ
 : 
$this
;

1134 
	}
}

1143 
public
 
funùiÚ
 
g‘C–l
(
$pCoÜdš©e
 = 'A1')

1146 ià(
$this
->
ûÎCŞËùiÚ
->
isD©aS‘
(
¡¹ouµ”
(
$pCoÜdš©e
))) {

1147  
$this
->
ûÎCŞËùiÚ
->
g‘CacheD©a
(
$pCoÜdš©e
);

1151 ià(
¡½os
(
$pCoÜdš©e
, '!'è!=ğ
çl£
) {

1152 
$wÜksh“tReã»nû
 = 
PHPExûl_WÜksh“t
::
exŒaùSh“tT™Ë
(
$pCoÜdš©e
, 
Œue
);

1153  
	g$this
->
	g·»Á
->
g‘Sh“tByName
(
$wÜksh“tReã»nû
[0])->
g‘C–l
(
¡¹ouµ”
($worksheetReference[1]));

1157 ià((!
´eg_m©ch
('/^'.
PHPExûl_C®cuÏtiÚ
::
CALCULATION_REGEXP_CELLREF
.'$/i', 
$pCoÜdš©e
, 
$m©ches
)) &&

1158 (
´eg_m©ch
('/^'.
PHPExûl_C®cuÏtiÚ
::
CALCULATION_REGEXP_NAMEDRANGE
.'$/i', 
$pCoÜdš©e
, 
$m©ches
))) {

1159 
	g$ÇmedRªge
 = 
PHPExûl_NamedRªge
::
»sŞveRªge
(
$pCoÜdš©e
, 
$this
);

1160 ià(
	g$ÇmedRªge
 !=ğ
nuÎ
) {

1161 
$pCoÜdš©e
 = 
$ÇmedRªge
->
g‘Rªge
();

1162  
	g$ÇmedRªge
->
g‘WÜksh“t
()->
g‘C–l
(
$pCoÜdš©e
);

1167 
	g$pCoÜdš©e
 = 
¡¹ouµ”
(
$pCoÜdš©e
);

1169 ià(
¡½os
(
$pCoÜdš©e
, ':'è!=ğ
çl£
 || strpos($pCoordinate, ',') !== false) {

1170 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate can‚ot be‡„ange of cells.');

1171 } 
–£if
 (
¡½os
(
$pCoÜdš©e
, '$'è!=ğ
çl£
) {

1172 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate must‚ot be‡bsolute.');

1176  
	g$this
->
ü—‹NewC–l
(
$pCoÜdš©e
);

1186 
public
 
funùiÚ
 
	$g‘C–lByCŞumnAndRow
(
$pCŞumn
 = 0, 
$pRow
 = 1)

1188 
$cŞumnL‘‹r
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn
);

1189 
$coÜdš©e
 = 
$cŞumnL‘‹r
 . 
$pRow
;

1191 ià(
$this
->
ûÎCŞËùiÚ
->
	`isD©aS‘
(
$coÜdš©e
)) {

1192  
$this
->
ûÎCŞËùiÚ
->
	`g‘CacheD©a
(
$coÜdš©e
);

1195  
$this
->
	`ü—‹NewC–l
(
$coÜdš©e
);

1196 
	}
}

1204 
´iv©e
 
funùiÚ
 
	$ü—‹NewC–l
(
$pCoÜdš©e
)

1206 
$ûÎ
 = 
$this
->
ûÎCŞËùiÚ
->
	`addCacheD©a
(

1207 
$pCoÜdš©e
,

1208 
Ãw
 
	`PHPExûl_C–l
(
nuÎ
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
, 
$this
)

1210 
$this
->
ûÎCŞËùiÚIsSÜ‹d
 = 
çl£
;

1213 
$aCoÜdš©es
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$pCoÜdš©e
);

1214 ià(
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$this
->
ÿchedHighe¡CŞumn
è< PHPExûl_C–l::cŞumnIndexFromSŒšg(
$aCoÜdš©es
[0])) {

1215 
$this
->
ÿchedHighe¡CŞumn
 = 
$aCoÜdš©es
[0];

1217 
$this
->
ÿchedHighe¡Row
 = 
	`max
($this->ÿchedHighe¡Row, 
$aCoÜdš©es
[1]);

1221 
$rowDim’siÚ
 = 
$this
->
	`g‘RowDim’siÚ
(
$aCoÜdš©es
[1], 
çl£
);

1222 
$cŞumnDim’siÚ
 = 
$this
->
	`g‘CŞumnDim’siÚ
(
$aCoÜdš©es
[0], 
çl£
);

1224 ià(
$rowDim’siÚ
 !=ğ
nuÎ
 && $rowDim’siÚ->
	`g‘XfIndex
() > 0) {

1226 
$ûÎ
->
	`£tXfIndex
(
$rowDim’siÚ
->
	`g‘XfIndex
());

1227 } 
	`–£if
 (
$cŞumnDim’siÚ
 !=ğ
nuÎ
 && $cŞumnDim’siÚ->
	`g‘XfIndex
() > 0) {

1229 
$ûÎ
->
	`£tXfIndex
(
$cŞumnDim’siÚ
->
	`g‘XfIndex
());

1232  
$ûÎ
;

1233 
	}
}

1242 
public
 
funùiÚ
 
ûÎExi¡s
(
$pCoÜdš©e
 = 'A1')

1245 ià(
¡½os
(
$pCoÜdš©e
, '!'è!=ğ
çl£
) {

1246 
$wÜksh“tReã»nû
 = 
PHPExûl_WÜksh“t
::
exŒaùSh“tT™Ë
(
$pCoÜdš©e
, 
Œue
);

1247  
	g$this
->
	g·»Á
->
g‘Sh“tByName
(
$wÜksh“tReã»nû
[0])->
ûÎExi¡s
(
¡¹ouµ”
($worksheetReference[1]));

1251 ià((!
´eg_m©ch
('/^'.
PHPExûl_C®cuÏtiÚ
::
CALCULATION_REGEXP_CELLREF
.'$/i', 
$pCoÜdš©e
, 
$m©ches
)) &&

1252 (
´eg_m©ch
('/^'.
PHPExûl_C®cuÏtiÚ
::
CALCULATION_REGEXP_NAMEDRANGE
.'$/i', 
$pCoÜdš©e
, 
$m©ches
))) {

1253 
	g$ÇmedRªge
 = 
PHPExûl_NamedRªge
::
»sŞveRªge
(
$pCoÜdš©e
, 
$this
);

1254 ià(
	g$ÇmedRªge
 !=ğ
nuÎ
) {

1255 
$pCoÜdš©e
 = 
$ÇmedRªge
->
g‘Rªge
();

1256 ià(
	g$this
->
g‘HashCode
(è!ğ
$ÇmedRªge
->
g‘WÜksh“t
()->getHashCode()) {

1257 ià(!
$ÇmedRªge
->
g‘LoÿlOÆy
()) {

1258  
$ÇmedRªge
->
g‘WÜksh“t
()->
ûÎExi¡s
(
$pCoÜdš©e
);

1260 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Named„ªg' . 
$ÇmedRªge
->
g‘Name
(è. ' i nÙ‡cûssibË from w™hš sh“ˆ' . 
$this
->
g‘T™Ë
());

1264  
	gçl£
;

1269 
	g$pCoÜdš©e
 = 
¡¹ouµ”
(
$pCoÜdš©e
);

1271 ià(
¡½os
(
$pCoÜdš©e
, ':'è!=ğ
çl£
 || strpos($pCoordinate, ',') !== false) {

1272 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate can‚ot be‡„ange of cells.');

1273 } 
–£if
 (
¡½os
(
$pCoÜdš©e
, '$'è!=ğ
çl£
) {

1274 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate must‚ot be‡bsolute.');

1277 
	g$aCoÜdš©es
 = 
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$pCoÜdš©e
);

1280  
	g$this
->
	gûÎCŞËùiÚ
->
isD©aS‘
(
$pCoÜdš©e
);

1291 
public
 
funùiÚ
 
	$ûÎExi¡sByCŞumnAndRow
(
$pCŞumn
 = 0, 
$pRow
 = 1)

1293  
$this
->
	`ûÎExi¡s
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn
è. 
$pRow
);

1294 
	}
}

1302 
public
 
funùiÚ
 
	$g‘RowDim’siÚ
(
$pRow
 = 1, 
$ü—‹
 = 
Œue
)

1305 
$found
 = 
nuÎ
;

1308 ià(!
	`is£t
(
$this
->
rowDim’siÚs
[
$pRow
])) {

1309 ià(!
$ü—‹
) {

1310  
nuÎ
;

1312 
$this
->
rowDim’siÚs
[
$pRow
] = 
Ãw
 
	`PHPExûl_WÜksh“t_RowDim’siÚ
($pRow);

1314 
$this
->
ÿchedHighe¡Row
 = 
	`max
($this->ÿchedHighe¡Row, 
$pRow
);

1316  
$this
->
rowDim’siÚs
[
$pRow
];

1317 
	}
}

1325 
public
 
funùiÚ
 
g‘CŞumnDim’siÚ
(
$pCŞumn
 = 'A', 
$ü—‹
 = 
Œue
)

1328 
$pCŞumn
 = 
¡¹ouµ”
($pColumn);

1331 ià(!
is£t
(
$this
->
cŞumnDim’siÚs
[
$pCŞumn
])) {

1332 ià(!
	g$ü—‹
) {

1333  
	gnuÎ
;

1335 
	g$this
->
	gcŞumnDim’siÚs
[
$pCŞumn
] = 
Ãw
 
PHPExûl_WÜksh“t_CŞumnDim’siÚ
($pColumn);

1337 ià(
	gPHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$this
->
ÿchedHighe¡CŞumn
è< 
PHPExûl_C–l
::cŞumnIndexFromSŒšg(
$pCŞumn
)) {

1338 
$this
->
ÿchedHighe¡CŞumn
 = 
$pCŞumn
;

1341  
	g$this
->
	gcŞumnDim’siÚs
[
$pCŞumn
];

1350 
public
 
funùiÚ
 
	$g‘CŞumnDim’siÚByCŞumn
(
$pCŞumn
 = 0)

1352  
$this
->
	`g‘CŞumnDim’siÚ
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn
));

1353 
	}
}

1360 
public
 
funùiÚ
 
	$g‘StyËs
()

1362  
$this
->
¡yËs
;

1363 
	}
}

1372 
public
 
funùiÚ
 
	$g‘DeçuÉStyË
()

1374  
$this
->
·»Á
->
	`g‘DeçuÉStyË
();

1375 
	}
}

1385 
public
 
funùiÚ
 
	$£tDeçuÉStyË
(
PHPExûl_StyË
 
$pV®ue
)

1387 
$this
->
·»Á
->
	`g‘DeçuÉStyË
()->
	`­¶yFromA¼ay
(
	`¬¿y
(

1388 'fÚt' => 
	`¬¿y
(

1389 'Çme' => 
$pV®ue
->
	`g‘FÚt
()->
	`g‘Name
(),

1390 'size' => 
$pV®ue
->
	`g‘FÚt
()->
	`g‘Size
(),

1393  
$this
;

1394 
	}
}

1403 
public
 
funùiÚ
 
g‘StyË
(
$pC–lCoÜdš©e
 = 'A1')

1406 
$this
->
·»Á
->
£tAùiveSh“tIndex
($this->·»Á->
g‘Index
($this));

1409 
	g$this
->
£tS–eùedC–ls
(
¡¹ouµ”
(
$pC–lCoÜdš©e
));

1411  
	g$this
->
	g·»Á
->
g‘C–lXfSu³rvisÜ
();

1420 
public
 
funùiÚ
 
g‘CÚd™iÚ®StyËs
(
$pCoÜdš©e
 = 'A1')

1422 
$pCoÜdš©e
 = 
¡¹ouµ”
($pCoordinate);

1423 ià(!
is£t
(
$this
->
cÚd™iÚ®StyËsCŞËùiÚ
[
$pCoÜdš©e
])) {

1424 
	g$this
->
	gcÚd™iÚ®StyËsCŞËùiÚ
[
$pCoÜdš©e
] = 
¬¿y
();

1426  
	g$this
->
	gcÚd™iÚ®StyËsCŞËùiÚ
[
$pCoÜdš©e
];

1435 
public
 
funùiÚ
 
cÚd™iÚ®StyËsExi¡s
(
$pCoÜdš©e
 = 'A1')

1437 ià(
is£t
(
$this
->
cÚd™iÚ®StyËsCŞËùiÚ
[
¡¹ouµ”
(
$pCoÜdš©e
)])) {

1438  
Œue
;

1440  
	gçl£
;

1449 
public
 
funùiÚ
 
»moveCÚd™iÚ®StyËs
(
$pCoÜdš©e
 = 'A1')

1451 
un£t
(
$this
->
cÚd™iÚ®StyËsCŞËùiÚ
[
¡¹ouµ”
(
$pCoÜdš©e
)]);

1452  
	g$this
;

1460 
public
 
funùiÚ
 
	$g‘CÚd™iÚ®StyËsCŞËùiÚ
()

1462  
$this
->
cÚd™iÚ®StyËsCŞËùiÚ
;

1463 
	}
}

1472 
public
 
funùiÚ
 
£tCÚd™iÚ®StyËs
(
$pCoÜdš©e
 = 'A1', 
$pV®ue
)

1474 
	g$this
->
	gcÚd™iÚ®StyËsCŞËùiÚ
[
¡¹ouµ”
(
$pCoÜdš©e
)] = 
$pV®ue
;

1475  
	g$this
;

1487 
public
 
funùiÚ
 
	$g‘StyËByCŞumnAndRow
(
$pCŞumn
 = 0, 
$pRow
 = 1, 
$pCŞumn2
 = 
nuÎ
, 
$pRow2
 =‚ull)

1489 ià(!
	`is_nuÎ
(
$pCŞumn2
è&& !is_nuÎ(
$pRow2
)) {

1490 
$ûÎRªge
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn
è. 
$pRow
 . ':' . PHPExûl_C–l::¡ršgFromCŞumnIndex(
$pCŞumn2
è. 
$pRow2
;

1491  
$this
->
	`g‘StyË
(
$ûÎRªge
);

1494  
$this
->
	`g‘StyË
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn
è. 
$pRow
);

1495 
	}
}

1508 
public
 
funùiÚ
 
£tSh¬edStyË
(
PHPExûl_StyË
 
$pSh¬edC–lStyË
 = 
nuÎ
, 
$pRªge
 = '')

1510 
$this
->
du¶iÿ‹StyË
(
$pSh¬edC–lStyË
, 
$pRªge
);

1511  
	g$this
;

1524 
public
 
funùiÚ
 
du¶iÿ‹StyË
(
PHPExûl_StyË
 
$pC–lStyË
 = 
nuÎ
, 
$pRªge
 = '')

1527 
$¡yË
 = 
$pC–lStyË
->
g‘IsSu³rvisÜ
(è? $pC–lStyË->
g‘Sh¬edCompÚ’t
() : $pCellStyle;

1530 
	g$wÜkbook
 = 
$this
->
·»Á
;

1531 ià(
	g$exi¡šgStyË
 = 
$this
->
·»Á
->
g‘C–lXfByHashCode
(
$pC–lStyË
->
g‘HashCode
())) {

1533 
$xfIndex
 = 
$exi¡šgStyË
->
g‘Index
();

1536 
	g$wÜkbook
->
addC–lXf
(
$pC–lStyË
);

1537 
	g$xfIndex
 = 
$pC–lStyË
->
g‘Index
();

1541 
li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
PHPExûl_C–l
::
¿ngeBound¬›s
(
$pRªge
 . ':' . $pRange);

1544 ià(
	g$¿ngeS¹
[0] > 
	g$¿ngeEnd
[0] && $rangeStart[1] > $rangeEnd[1]) {

1545 
	g$tmp
 = 
$¿ngeS¹
;

1546 
	g$¿ngeS¹
 = 
$¿ngeEnd
;

1547 
	g$¿ngeEnd
 = 
$tmp
;

1551 
	g$cŞ
 = 
$¿ngeS¹
[0]; $cŞ <ğ
$¿ngeEnd
[0]; ++$col) {

1552 
	g$row
 = 
$¿ngeS¹
[1]; $row <ğ
$¿ngeEnd
[1]; ++$row) {

1553 
	g$this
->
g‘C–l
(
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$cŞ
 - 1è. 
$row
)->
£tXfIndex
(
$xfIndex
);

1557  
	g$this
;

1570 
public
 
funùiÚ
 
du¶iÿ‹CÚd™iÚ®StyË
(
¬¿y
 
$pC–lStyË
 = 
nuÎ
, 
$pRªge
 = '')

1572 
fÜ—ch
 (
$pC–lStyË
 
as
 
$ûÎStyË
) {

1573 ià(!(
$ûÎStyË
 
š¡ªûof
 
PHPExûl_StyË_CÚd™iÚ®
)) {

1574 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Style is‚ot‡ conditional style');

1579 
li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
PHPExûl_C–l
::
¿ngeBound¬›s
(
$pRªge
 . ':' . $pRange);

1582 ià(
	g$¿ngeS¹
[0] > 
	g$¿ngeEnd
[0] && $rangeStart[1] > $rangeEnd[1]) {

1583 
	g$tmp
 = 
$¿ngeS¹
;

1584 
	g$¿ngeS¹
 = 
$¿ngeEnd
;

1585 
	g$¿ngeEnd
 = 
$tmp
;

1589 
	g$cŞ
 = 
$¿ngeS¹
[0]; $cŞ <ğ
$¿ngeEnd
[0]; ++$col) {

1590 
	g$row
 = 
$¿ngeS¹
[1]; $row <ğ
$¿ngeEnd
[1]; ++$row) {

1591 
	g$this
->
£tCÚd™iÚ®StyËs
(
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$cŞ
 - 1è. 
$row
, 
$pC–lStyË
);

1595  
	g$this
;

1612 
public
 
funùiÚ
 
du¶iÿ‹StyËA¼ay
(
$pStyËs
 = 
nuÎ
, 
$pRªge
 = '', 
$pAdvªûd
 = 
Œue
)

1614 
$this
->
g‘StyË
(
$pRªge
)->
­¶yFromA¼ay
(
$pStyËs
, 
$pAdvªûd
);

1615  
	g$this
;

1626 
public
 
funùiÚ
 
£tB»ak
(
$pC–l
 = 'A1', 
$pB»ak
 = 
PHPExûl_WÜksh“t
::
BREAK_NONE
)

1629 
$pC–l
 = 
¡¹ouµ”
($pCell);

1631 ià(
	g$pC–l
 != '') {

1632 ià(
$pB»ak
 =ğ
PHPExûl_WÜksh“t
::
BREAK_NONE
) {

1633 ià(
is£t
(
$this
->
b»aks
[
$pC–l
])) {

1634 
un£t
(
$this
->
b»aks
[
$pC–l
]);

1637 
	g$this
->
	gb»aks
[
$pC–l
] = 
$pB»ak
;

1640 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('No cell coordinate specified.');

1643  
	g$this
;

1654 
public
 
funùiÚ
 
	$£tB»akByCŞumnAndRow
(
$pCŞumn
 = 0, 
$pRow
 = 1, 
$pB»ak
 = 
PHPExûl_WÜksh“t
::
BREAK_NONE
)

1656  
$this
->
	`£tB»ak
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn
è. 
$pRow
, 
$pB»ak
);

1657 
	}
}

1664 
public
 
funùiÚ
 
	$g‘B»aks
()

1666  
$this
->
b»aks
;

1667 
	}
}

1676 
public
 
funùiÚ
 
m”geC–ls
(
$pRªge
 = 'A1:A1')

1679 
$pRªge
 = 
¡¹ouµ”
($pRange);

1681 ià(
¡½os
(
$pRªge
, ':'è!=ğ
çl£
) {

1682 
$this
->
m”geC–ls
[
$pRªge
] = $pRange;

1687 
	g$aReã»nûs
 = 
PHPExûl_C–l
::
exŒaùAÎC–lReã»nûsInRªge
(
$pRªge
);

1690 
	g$uµ”Leá
 = 
$aReã»nûs
[0];

1691 ià(!
	g$this
->
ûÎExi¡s
(
$uµ”Leá
)) {

1692 
	g$this
->
g‘C–l
(
$uµ”Leá
)->
£tV®ueEx¶ic™
(
nuÎ
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
);

1696 
	g$couÁ
 = 
couÁ
(
$aReã»nûs
);

1697 
	g$i
 = 1; $˜< 
	g$couÁ
; $i++) {

1698 
	g$this
->
g‘C–l
(
$aReã»nûs
[
$i
])->
£tV®ueEx¶ic™
(
nuÎ
, 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
);

1701 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Merge must be set on‡„ange of cells.');

1704  
	g$this
;

1717 
public
 
funùiÚ
 
	$m”geC–lsByCŞumnAndRow
(
$pCŞumn1
 = 0, 
$pRow1
 = 1, 
$pCŞumn2
 = 0, 
$pRow2
 = 1)

1719 
$ûÎRªge
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn1
è. 
$pRow1
 . ':' . PHPExûl_C–l::¡ršgFromCŞumnIndex(
$pCŞumn2
è. 
$pRow2
;

1720  
$this
->
	`m”geC–ls
(
$ûÎRªge
);

1721 
	}
}

1730 
public
 
funùiÚ
 
unm”geC–ls
(
$pRªge
 = 'A1:A1')

1733 
$pRªge
 = 
¡¹ouµ”
($pRange);

1735 ià(
¡½os
(
$pRªge
, ':'è!=ğ
çl£
) {

1736 ià(
is£t
(
$this
->
m”geC–ls
[
$pRªge
])) {

1737 
un£t
(
$this
->
m”geC–ls
[
$pRªge
]);

1739 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('C–È¿ng' . 
$pRªge
 . '‚ot known‡s merged.');

1742 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Merge can only be„emoved from‡„ange of cells.');

1745  
	g$this
;

1758 
public
 
funùiÚ
 
	$unm”geC–lsByCŞumnAndRow
(
$pCŞumn1
 = 0, 
$pRow1
 = 1, 
$pCŞumn2
 = 0, 
$pRow2
 = 1)

1760 
$ûÎRªge
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn1
è. 
$pRow1
 . ':' . PHPExûl_C–l::¡ršgFromCŞumnIndex(
$pCŞumn2
è. 
$pRow2
;

1761  
$this
->
	`unm”geC–ls
(
$ûÎRªge
);

1762 
	}
}

1769 
public
 
funùiÚ
 
	$g‘M”geC–ls
()

1771  
$this
->
m”geC–ls
;

1772 
	}
}

1780 
public
 
funùiÚ
 
£tM”geC–ls
(
$pV®ue
 = 
	$¬¿y
())

1782 
$this
->
m”geC–ls
 = 
$pV®ue
;

1783  
$this
;

1784 
	}
}

1795 
public
 
funùiÚ
 
´ÙeùC–ls
(
$pRªge
 = 'A1', 
$pPasswÜd
 = '', 
$pAÌ—dyHashed
 = 
çl£
)

1798 
$pRªge
 = 
¡¹ouµ”
($pRange);

1800 ià(!
	g$pAÌ—dyHashed
) {

1801 
	g$pPasswÜd
 = 
PHPExûl_Sh¬ed_PasswÜdHash”
::
hashPasswÜd
(
$pPasswÜd
);

1803 
	g$this
->
	g´ÙeùedC–ls
[
$pRªge
] = 
$pPasswÜd
;

1805  
	g$this
;

1820 
public
 
funùiÚ
 
´ÙeùC–lsByCŞumnAndRow
(
$pCŞumn1
 = 0, 
$pRow1
 = 1, 
$pCŞumn2
 = 0, 
$pRow2
 = 1, 
$pPasswÜd
 = '', 
$pAÌ—dyHashed
 = 
çl£
)

1822 
$ûÎRªge
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$pCŞumn1
è. 
$pRow1
 . ':' . PHPExûl_C–l::¡ršgFromCŞumnIndex(
$pCŞumn2
è. 
$pRow2
;

1823  
	g$this
->
´ÙeùC–ls
(
$ûÎRªge
, 
$pPasswÜd
, 
$pAÌ—dyHashed
);

1833 
public
 
funùiÚ
 
uÅrÙeùC–ls
(
$pRªge
 = 'A1')

1836 
$pRªge
 = 
¡¹ouµ”
($pRange);

1838 ià(
is£t
(
$this
->
´ÙeùedC–ls
[
$pRªge
])) {

1839 
un£t
(
$this
->
´ÙeùedC–ls
[
$pRªge
]);

1841 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('C–È¿ng' . 
$pRªge
 . '‚ot known‡s…rotected.');

1843  
	g$this
;

1858 
public
 
funùiÚ
 
uÅrÙeùC–lsByCŞumnAndRow
(
$pCŞumn1
 = 0, 
$pRow1
 = 1, 
$pCŞumn2
 = 0, 
$pRow2
 = 1, 
$pPasswÜd
 = '', 
$pAÌ—dyHashed
 = 
çl£
)

1860 
$ûÎRªge
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$pCŞumn1
è. 
$pRow1
 . ':' . PHPExûl_C–l::¡ršgFromCŞumnIndex(
$pCŞumn2
è. 
$pRow2
;

1861  
	g$this
->
uÅrÙeùC–ls
(
$ûÎRªge
, 
$pPasswÜd
, 
$pAÌ—dyHashed
);

1869 
public
 
funùiÚ
 
	$g‘PrÙeùedC–ls
()

1871  
$this
->
´ÙeùedC–ls
;

1872 
	}
}

1879 
public
 
funùiÚ
 
	$g‘AutoF‹r
()

1881  
$this
->
autoF‹r
;

1882 
	}
}

1892 
public
 
funùiÚ
 
	$£tAutoF‹r
(
$pV®ue
)

1894 
$pRªge
 = 
	`¡¹ouµ”
(
$pV®ue
);

1895 ià(
	`is_¡ršg
(
$pV®ue
)) {

1896 
$this
->
autoF‹r
->
	`£tRªge
(
$pV®ue
);

1897 } 
	`–£if
 (
	`is_objeù
(
$pV®ue
è&& ($pV®u
š¡ªûof
 
PHPExûl_WÜksh“t_AutoF‹r
)) {

1898 
$this
->
autoF‹r
 = 
$pV®ue
;

1900  
$this
;

1901 
	}
}

1913 
public
 
funùiÚ
 
	$£tAutoF‹rByCŞumnAndRow
(
$pCŞumn1
 = 0, 
$pRow1
 = 1, 
$pCŞumn2
 = 0, 
$pRow2
 = 1)

1915  
$this
->
	`£tAutoF‹r
(

1916 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn1
è. 
$pRow1


1918 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn2
è. 
$pRow2


1920 
	}
}

1927 
public
 
funùiÚ
 
	$»moveAutoF‹r
()

1929 
$this
->
autoF‹r
->
	`£tRªge
(
nuÎ
);

1930  
$this
;

1931 
	}
}

1938 
public
 
funùiÚ
 
	$g‘F»ezePªe
()

1940  
$this
->
ä“zePªe
;

1941 
	}
}

1955 
public
 
funùiÚ
 
ä“zePªe
(
$pC–l
 = '')

1958 
$pC–l
 = 
¡¹ouµ”
($pCell);

1959 ià(
¡½os
(
$pC–l
, ':'è==ğ
çl£
 && strpos($pCell, ',') === false) {

1960 
$this
->
ä“zePªe
 = 
$pC–l
;

1962 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Freeze…ane can‚ot be set on‡„ange of cells.');

1964  
	g$this
;

1975 
public
 
funùiÚ
 
	$ä“zePªeByCŞumnAndRow
(
$pCŞumn
 = 0, 
$pRow
 = 1)

1977  
$this
->
	`ä“zePªe
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn
è. 
$pRow
);

1978 
	}
}

1985 
public
 
funùiÚ
 
	$unä“zePªe
()

1987  
$this
->
	`ä“zePªe
('');

1988 
	}
}

1998 
public
 
funùiÚ
 
	$š£¹NewRowBefÜe
(
$pBefÜe
 = 1, 
$pNumRows
 = 1)

2000 ià(
$pBefÜe
 >= 1) {

2001 
$objReã»nûH–³r
 = 
PHPExûl_Reã»nûH–³r
::
	`g‘In¡ªû
();

2002 
$objReã»nûH–³r
->
	`š£¹NewBefÜe
('A' . 
$pBefÜe
, 0, 
$pNumRows
, 
$this
);

2004 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Rows can only be inserted before‡t†east„ow 1.");

2006  
$this
;

2007 
	}
}

2017 
public
 
funùiÚ
 
š£¹NewCŞumnBefÜe
(
$pBefÜe
 = 'A', 
$pNumCŞs
 = 1)

2019 ià(!
is_num”ic
(
$pBefÜe
)) {

2020 
$objReã»nûH–³r
 = 
PHPExûl_Reã»nûH–³r
::
g‘In¡ªû
();

2021 
	g$objReã»nûH–³r
->
š£¹NewBefÜe
(
$pBefÜe
 . '1', 
$pNumCŞs
, 0, 
$this
);

2023 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
("Column„eferences should‚ot be‚umeric.");

2025  
	g$this
;

2036 
public
 
funùiÚ
 
	$š£¹NewCŞumnBefÜeByIndex
(
$pBefÜe
 = 0, 
$pNumCŞs
 = 1)

2038 ià(
$pBefÜe
 >= 0) {

2039  
$this
->
	`š£¹NewCŞumnBefÜe
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pBefÜe
), 
$pNumCŞs
);

2041 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Columns can only be inserted before‡t†east column A (0).");

2043 
	}
}

2053 
public
 
funùiÚ
 
	$»moveRow
(
$pRow
 = 1, 
$pNumRows
 = 1)

2055 ià(
$pRow
 >= 1) {

2056 
$highe¡Row
 = 
$this
->
	`g‘Highe¡D©aRow
();

2057 
$objReã»nûH–³r
 = 
PHPExûl_Reã»nûH–³r
::
	`g‘In¡ªû
();

2058 
$objReã»nûH–³r
->
	`š£¹NewBefÜe
('A' . (
$pRow
 + 
$pNumRows
), 0, -$pNumRows, 
$this
);

2059 
$r
 = 0; $¸< 
$pNumRows
; ++$r) {

2060 
$this
->
	`g‘C–lCacheCÚŒŞËr
()->
	`»moveRow
(
$highe¡Row
);

2061 --
$highe¡Row
;

2064 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Rowso be deleted should‡t†east start from„ow 1.");

2066  
$this
;

2067 
	}
}

2077 
public
 
funùiÚ
 
»moveCŞumn
(
$pCŞumn
 = 'A', 
$pNumCŞs
 = 1)

2079 ià(!
is_num”ic
(
$pCŞumn
)) {

2080 
$highe¡CŞumn
 = 
$this
->
g‘Highe¡D©aCŞumn
();

2081 
	g$pCŞumn
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(PHPExûl_C–l::
cŞumnIndexFromSŒšg
(
$pCŞumn
è- 1 + 
$pNumCŞs
);

2082 
	g$objReã»nûH–³r
 = 
PHPExûl_Reã»nûH–³r
::
g‘In¡ªû
();

2083 
	g$objReã»nûH–³r
->
š£¹NewBefÜe
(
$pCŞumn
 . '1', -
$pNumCŞs
, 0, 
$this
);

2084 
	g$c
 = 0; $ø< 
	g$pNumCŞs
; ++$c) {

2085 
	g$this
->
g‘C–lCacheCÚŒŞËr
()->
»moveCŞumn
(
$highe¡CŞumn
);

2086 
	g$highe¡CŞumn
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(PHPExûl_C–l::
cŞumnIndexFromSŒšg
(
$highe¡CŞumn
) - 2);

2089 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
("Column„eferences should‚ot be‚umeric.");

2091  
	g$this
;

2102 
public
 
funùiÚ
 
	$»moveCŞumnByIndex
(
$pCŞumn
 = 0, 
$pNumCŞs
 = 1)

2104 ià(
$pCŞumn
 >= 0) {

2105  
$this
->
	`»moveCŞumn
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn
), 
$pNumCŞs
);

2107 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Columnso be deleted should‡t†east start from column 0");

2109 
	}
}

2116 
public
 
funùiÚ
 
	$g‘ShowGridlšes
()

2118  
$this
->
showGridlšes
;

2119 
	}
}

2127 
public
 
funùiÚ
 
	$£tShowGridlšes
(
$pV®ue
 = 
çl£
)

2129 
$this
->
showGridlšes
 = 
$pV®ue
;

2130  
$this
;

2131 
	}
}

2138 
public
 
funùiÚ
 
	$g‘PrštGridlšes
()

2140  
$this
->
´štGridlšes
;

2141 
	}
}

2149 
public
 
funùiÚ
 
	$£tPrštGridlšes
(
$pV®ue
 = 
çl£
)

2151 
$this
->
´štGridlšes
 = 
$pV®ue
;

2152  
$this
;

2153 
	}
}

2160 
public
 
funùiÚ
 
	$g‘ShowRowCŞH—d”s
()

2162  
$this
->
showRowCŞH—d”s
;

2163 
	}
}

2171 
public
 
funùiÚ
 
	$£tShowRowCŞH—d”s
(
$pV®ue
 = 
çl£
)

2173 
$this
->
showRowCŞH—d”s
 = 
$pV®ue
;

2174  
$this
;

2175 
	}
}

2182 
public
 
funùiÚ
 
	$g‘ShowSumm¬yB–ow
()

2184  
$this
->
showSumm¬yB–ow
;

2185 
	}
}

2193 
public
 
funùiÚ
 
	$£tShowSumm¬yB–ow
(
$pV®ue
 = 
Œue
)

2195 
$this
->
showSumm¬yB–ow
 = 
$pV®ue
;

2196  
$this
;

2197 
	}
}

2204 
public
 
funùiÚ
 
	$g‘ShowSumm¬yRight
()

2206  
$this
->
showSumm¬yRight
;

2207 
	}
}

2215 
public
 
funùiÚ
 
	$£tShowSumm¬yRight
(
$pV®ue
 = 
Œue
)

2217 
$this
->
showSumm¬yRight
 = 
$pV®ue
;

2218  
$this
;

2219 
	}
}

2226 
public
 
funùiÚ
 
	$g‘Comm’ts
()

2228  
$this
->
comm’ts
;

2229 
	}
}

2237 
public
 
funùiÚ
 
£tComm’ts
(
$pV®ue
 = 
	$¬¿y
())

2239 
$this
->
comm’ts
 = 
$pV®ue
;

2241  
$this
;

2242 
	}
}

2251 
public
 
funùiÚ
 
g‘Comm’t
(
$pC–lCoÜdš©e
 = 'A1')

2254 
$pC–lCoÜdš©e
 = 
¡¹ouµ”
($pCellCoordinate);

2256 ià(
¡½os
(
$pC–lCoÜdš©e
, ':'è!=ğ
çl£
 || strpos($pCellCoordinate, ',') !== false) {

2257 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate string can‚ot be‡„ange of cells.');

2258 } 
–£if
 (
¡½os
(
$pC–lCoÜdš©e
, '$'è!=ğ
çl£
) {

2259 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate string must‚ot be‡bsolute.');

2260 } 
–£if
 (
$pC–lCoÜdš©e
 == '') {

2261 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Cell coordinate can‚ot be zero-length string.');

2265 ià(
is£t
(
$this
->
comm’ts
[
$pC–lCoÜdš©e
])) {

2266  
	g$this
->
	gcomm’ts
[
$pC–lCoÜdš©e
];

2268 
	g$ÃwComm’t
 = 
Ãw
 
PHPExûl_Comm’t
();

2269 
	g$this
->
	gcomm’ts
[
$pC–lCoÜdš©e
] = 
$ÃwComm’t
;

2270  
	g$ÃwComm’t
;

2282 
public
 
funùiÚ
 
	$g‘Comm’tByCŞumnAndRow
(
$pCŞumn
 = 0, 
$pRow
 = 1)

2284  
$this
->
	`g‘Comm’t
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn
è. 
$pRow
);

2285 
	}
}

2293 
public
 
funùiÚ
 
	$g‘S–eùedC–l
()

2295  
$this
->
	`g‘S–eùedC–ls
();

2296 
	}
}

2303 
public
 
funùiÚ
 
	$g‘AùiveC–l
()

2305  
$this
->
aùiveC–l
;

2306 
	}
}

2313 
public
 
funùiÚ
 
	$g‘S–eùedC–ls
()

2315  
$this
->
£ËùedC–ls
;

2316 
	}
}

2324 
public
 
funùiÚ
 
£tS–eùedC–l
(
$pCoÜdš©e
 = 'A1')

2326  
$this
->
£tS–eùedC–ls
(
$pCoÜdš©e
);

2336 
public
 
funùiÚ
 
£tS–eùedC–ls
(
$pCoÜdš©e
 = 'A1')

2339 
$pCoÜdš©e
 = 
¡¹ouµ”
($pCoordinate);

2342 
	g$pCoÜdš©e
 = 
´eg_»¶aû
('/^([A-Z]+)$/', '${1}:${1}', 
$pCoÜdš©e
);

2345 
	g$pCoÜdš©e
 = 
´eg_»¶aû
('/^([0-9]+)$/', '${1}:${1}', 
$pCoÜdš©e
);

2348 
	g$pCoÜdš©e
 = 
´eg_»¶aû
('/^([A-Z]+):([A-Z]+)$/', '${1}1:${2}1048576', 
$pCoÜdš©e
);

2351 
	g$pCoÜdš©e
 = 
´eg_»¶aû
('/^([0-9]+):([0-9]+)$/', 'A${1}:XFD${2}', 
$pCoÜdš©e
);

2353 ià(
¡½os
(
$pCoÜdš©e
, ':'è!=ğ
çl£
 || strpos($pCoordinate, ',') !== false) {

2354 
li¡
(
$fœ¡
, ) = 
PHPExûl_C–l
::
¥l™Rªge
(
$pCoÜdš©e
);

2355 
	g$this
->
	gaùiveC–l
 = 
$fœ¡
[0];

2357 
	g$this
->
	gaùiveC–l
 = 
$pCoÜdš©e
;

2359 
	g$this
->
	g£ËùedC–ls
 = 
$pCoÜdš©e
;

2360  
	g$this
;

2371 
public
 
funùiÚ
 
	$£tS–eùedC–lByCŞumnAndRow
(
$pCŞumn
 = 0, 
$pRow
 = 1)

2373  
$this
->
	`£tS–eùedC–ls
(
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$pCŞumn
è. 
$pRow
);

2374 
	}
}

2381 
public
 
funùiÚ
 
	$g‘RightToLeá
()

2383  
$this
->
rightToLeá
;

2384 
	}
}

2392 
public
 
funùiÚ
 
	$£tRightToLeá
(
$v®ue
 = 
çl£
)

2394 
$this
->
rightToLeá
 = 
$v®ue
;

2395  
$this
;

2396 
	}
}

2408 
public
 
funùiÚ
 
äomA¼ay
(
$sourû
 = 
nuÎ
, 
$nuÎV®ue
 =‚uÎ, 
$¡¬tC–l
 = 'A1', 
$¡riùNuÎCom·risÚ
 = 
çl£
)

2410 ià(
is_¬¿y
(
$sourû
)) {

2412 ià(!
is_¬¿y
(
’d
(
$sourû
))) {

2413 
$sourû
 = 
¬¿y
($source);

2417 
li¡
 (
$¡¬tCŞumn
, 
$¡¬tRow
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$¡¬tC–l
);

2420 
fÜ—ch
 (
$sourû
 
as
 
$rowD©a
) {

2421 
	g$cu¼’tCŞumn
 = 
$¡¬tCŞumn
;

2422 
fÜ—ch
 (
$rowD©a
 
as
 
$ûÎV®ue
) {

2423 ià(
	g$¡riùNuÎCom·risÚ
) {

2424 ià(
	g$ûÎV®ue
 !=ğ
$nuÎV®ue
) {

2426 
$this
->
g‘C–l
(
$cu¼’tCŞumn
 . 
$¡¬tRow
)->
£tV®ue
(
$ûÎV®ue
);

2429 ià(
	g$ûÎV®ue
 !ğ
$nuÎV®ue
) {

2431 
$this
->
g‘C–l
(
$cu¼’tCŞumn
 . 
$¡¬tRow
)->
£tV®ue
(
$ûÎV®ue
);

2434 ++
	g$cu¼’tCŞumn
;

2436 ++
	g$¡¬tRow
;

2439 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
("Parameter \$source should be‡n‡rray.");

2441  
	g$this
;

2455 
public
 
funùiÚ
 
¿ngeToA¼ay
(
$pRªge
 = 'A1', 
$nuÎV®ue
 = 
nuÎ
, 
$ÿlcuÏ‹FÜmuÏs
 = 
Œue
, 
$fÜm©D©a
 =rue, 
$»tuºC–lRef
 = 
çl£
)

2458 
$»tuºV®ue
 = 
¬¿y
();

2460 
li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
PHPExûl_C–l
::
¿ngeBound¬›s
(
$pRªge
);

2461 
	g$mšCŞ
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$¿ngeS¹
[0] -1);

2462 
	g$mšRow
 = 
$¿ngeS¹
[1];

2463 
	g$maxCŞ
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$¿ngeEnd
[0] -1);

2464 
	g$maxRow
 = 
$¿ngeEnd
[1];

2466 
	g$maxCŞ
++;

2468 
	g$r
 = -1;

2469 
	g$row
 = 
$mšRow
; $row <ğ
$maxRow
; ++$row) {

2470 
	g$rRef
 = (
$»tuºC–lRef
è? 
$row
 : ++
$r
;

2471 
	g$c
 = -1;

2473 
	g$cŞ
 = 
$mšCŞ
; $cŞ !ğ
$maxCŞ
; ++$col) {

2474 
	g$cRef
 = (
$»tuºC–lRef
è? 
$cŞ
 : ++
$c
;

2477 ià(
	g$this
->
	gûÎCŞËùiÚ
->
isD©aS‘
(
$cŞ
.
$row
)) {

2479 
	g$ûÎ
 = 
$this
->
ûÎCŞËùiÚ
->
g‘CacheD©a
(
$cŞ
.
$row
);

2480 ià(
	g$ûÎ
->
g‘V®ue
(è!=ğ
nuÎ
) {

2481 ià(
$ûÎ
->
g‘V®ue
(è
š¡ªûof
 
PHPExûl_RichText
) {

2482 
$»tuºV®ue
[
$rRef
][
$cRef
] = 
$ûÎ
->
g‘V®ue
()->
g‘PÏšText
();

2484 ià(
	g$ÿlcuÏ‹FÜmuÏs
) {

2485 
	g$»tuºV®ue
[
$rRef
][
$cRef
] = 
$ûÎ
->
g‘C®cuÏ‹dV®ue
();

2487 
	g$»tuºV®ue
[
$rRef
][
$cRef
] = 
$ûÎ
->
g‘V®ue
();

2491 ià(
	g$fÜm©D©a
) {

2492 
	g$¡yË
 = 
$this
->
·»Á
->
g‘C–lXfByIndex
(
$ûÎ
->
g‘XfIndex
());

2493 
	g$»tuºV®ue
[
$rRef
][
$cRef
] = 
PHPExûl_StyË_Numb”FÜm©
::
toFÜm©‹dSŒšg
(

2494 
$»tuºV®ue
[
$rRef
][
$cRef
],

2495 (
$¡yË
 && $¡yË->
g‘Numb”FÜm©
()è? $¡yË->g‘Numb”FÜm©()->
g‘FÜm©Code
(è: 
PHPExûl_StyË_Numb”FÜm©
::
FORMAT_GENERAL


2500 
	g$»tuºV®ue
[
$rRef
][
$cRef
] = 
$nuÎV®ue
;

2504 
	g$»tuºV®ue
[
$rRef
][
$cRef
] = 
$nuÎV®ue
;

2510  
	g$»tuºV®ue
;

2526 
public
 
funùiÚ
 
ÇmedRªgeToA¼ay
(
$pNamedRªge
 = '', 
$nuÎV®ue
 = 
nuÎ
, 
$ÿlcuÏ‹FÜmuÏs
 = 
Œue
, 
$fÜm©D©a
 =rue, 
$»tuºC–lRef
 = 
çl£
)

2528 
$ÇmedRªge
 = 
PHPExûl_NamedRªge
::
»sŞveRªge
(
$pNamedRªge
, 
$this
);

2529 ià(
	g$ÇmedRªge
 !=ğ
nuÎ
) {

2530 
$pWÜkSh“t
 = 
$ÇmedRªge
->
g‘WÜksh“t
();

2531 
	g$pC–lRªge
 = 
$ÇmedRªge
->
g‘Rªge
();

2533  
	g$pWÜkSh“t
->
¿ngeToA¼ay
(
$pC–lRªge
, 
$nuÎV®ue
, 
$ÿlcuÏ‹FÜmuÏs
, 
$fÜm©D©a
, 
$»tuºC–lRef
);

2536 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Named Rªg'.
$pNamedRªge
.' does‚otƒxist.');

2550 
public
 
funùiÚ
 
	$toA¼ay
(
$nuÎV®ue
 = 
nuÎ
, 
$ÿlcuÏ‹FÜmuÏs
 = 
Œue
, 
$fÜm©D©a
 =rue, 
$»tuºC–lRef
 = 
çl£
)

2553 
$this
->
	`g¬bageCŞËù
();

2556 
$maxCŞ
 = 
$this
->
	`g‘Highe¡CŞumn
();

2557 
$maxRow
 = 
$this
->
	`g‘Highe¡Row
();

2559  
$this
->
	`¿ngeToA¼ay
('A1:'.
$maxCŞ
.
$maxRow
, 
$nuÎV®ue
, 
$ÿlcuÏ‹FÜmuÏs
, 
$fÜm©D©a
, 
$»tuºC–lRef
);

2560 
	}
}

2570 
public
 
funùiÚ
 
	$g‘RowI‹¿tÜ
(
$¡¬tRow
 = 1, 
$’dRow
 = 
nuÎ
)

2572  
Ãw
 
	`PHPExûl_WÜksh“t_RowI‹¿tÜ
(
$this
, 
$¡¬tRow
, 
$’dRow
);

2573 
	}
}

2583 
public
 
funùiÚ
 
g‘CŞumnI‹¿tÜ
(
$¡¬tCŞumn
 = 'A', 
$’dCŞumn
 = 
nuÎ
)

2585  
Ãw
 
PHPExûl_WÜksh“t_CŞumnI‹¿tÜ
(
$this
, 
$¡¬tCŞumn
, 
$’dCŞumn
);

2593 
public
 
funùiÚ
 
	$g¬bageCŞËù
()

2596 
$this
->
ûÎCŞËùiÚ
->
	`g‘CacheD©a
('A1');

2607 
$cŞRow
 = 
$this
->
ûÎCŞËùiÚ
->
	`g‘Highe¡RowAndCŞumn
();

2608 
$highe¡Row
 = 
$cŞRow
['row'];

2609 
$highe¡CŞumn
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞRow
['column']);

2612 
	`fÜ—ch
 (
$this
->
cŞumnDim’siÚs
 
as
 
$dim’siÚ
) {

2613 
$highe¡CŞumn
 = 
	`max
($highe¡CŞumn, 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$dim’siÚ
->
	`g‘CŞumnIndex
()));

2617 
	`fÜ—ch
 (
$this
->
rowDim’siÚs
 
as
 
$dim’siÚ
) {

2618 
$highe¡Row
 = 
	`max
($highe¡Row, 
$dim’siÚ
->
	`g‘RowIndex
());

2622 ià(
$highe¡CŞumn
 < 0) {

2623 
$this
->
ÿchedHighe¡CŞumn
 = 'A';

2625 
$this
->
ÿchedHighe¡CŞumn
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(--
$highe¡CŞumn
);

2627 
$this
->
ÿchedHighe¡Row
 = 
$highe¡Row
;

2630  
$this
;

2631 
	}
}

2638 
public
 
funùiÚ
 
	$g‘HashCode
()

2640 ià(
$this
->
dœty
) {

2641 
$this
->
hash
 = 
	`md5
($this->
t™Ë
 . $this->
autoF‹r
 . ($this->
´ÙeùiÚ
->
	`isPrÙeùiÚEÇbËd
(è? 't' : 'f'è. 
__CLASS__
);

2642 
$this
->
dœty
 = 
çl£
;

2644  
$this
->
hash
;

2645 
	}
}

2657 
public
 
funùiÚ
 
	$exŒaùSh“tT™Ë
(
$pRªge
, 
$»tuºRªge
 = 
çl£
)

2660 ià((
$£p
 = 
	`¡½os
(
$pRªge
, '!')è==ğ
çl£
) {

2664 ià(
$»tuºRªge
) {

2665  
	`¬¿y
(
	`Œim
(
	`sub¡r
(
$pRªge
, 0, 
$£p
), "'"), substr($pRange, $sep + 1));

2668  
	`sub¡r
(
$pRªge
, 
$£p
 + 1);

2669 
	}
}

2676 
public
 
funùiÚ
 
g‘Hy³¾šk
(
$pC–lCoÜdš©e
 = 'A1')

2679 ià(
is£t
(
$this
->
hy³¾škCŞËùiÚ
[
$pC–lCoÜdš©e
])) {

2680  
$this
->
hy³¾škCŞËùiÚ
[
$pC–lCoÜdš©e
];

2684 
	g$this
->
	ghy³¾škCŞËùiÚ
[
$pC–lCoÜdš©e
] = 
Ãw
 
PHPExûl_C–l_Hy³¾šk
();

2685  
	g$this
->
	ghy³¾škCŞËùiÚ
[
$pC–lCoÜdš©e
];

2695 
public
 
funùiÚ
 
£tHy³¾šk
(
$pC–lCoÜdš©e
 = 'A1', 
PHPExûl_C–l_Hy³¾šk
 
$pHy³¾šk
 = 
nuÎ
)

2697 ià(
$pHy³¾šk
 ==ğ
nuÎ
) {

2698 
un£t
(
$this
->
hy³¾škCŞËùiÚ
[
$pC–lCoÜdš©e
]);

2700 
	g$this
->
	ghy³¾škCŞËùiÚ
[
$pC–lCoÜdš©e
] = 
$pHy³¾šk
;

2702  
	g$this
;

2711 
public
 
funùiÚ
 
hy³¾škExi¡s
(
$pCoÜdš©e
 = 'A1')

2713  
is£t
(
$this
->
hy³¾škCŞËùiÚ
[
$pCoÜdš©e
]);

2721 
public
 
funùiÚ
 
	$g‘Hy³¾škCŞËùiÚ
()

2723  
$this
->
hy³¾škCŞËùiÚ
;

2724 
	}
}

2731 
public
 
funùiÚ
 
g‘D©aV®id©iÚ
(
$pC–lCoÜdš©e
 = 'A1')

2734 ià(
is£t
(
$this
->
d©aV®id©iÚCŞËùiÚ
[
$pC–lCoÜdš©e
])) {

2735  
$this
->
d©aV®id©iÚCŞËùiÚ
[
$pC–lCoÜdš©e
];

2739 
	g$this
->
	gd©aV®id©iÚCŞËùiÚ
[
$pC–lCoÜdš©e
] = 
Ãw
 
PHPExûl_C–l_D©aV®id©iÚ
();

2740  
	g$this
->
	gd©aV®id©iÚCŞËùiÚ
[
$pC–lCoÜdš©e
];

2750 
public
 
funùiÚ
 
£tD©aV®id©iÚ
(
$pC–lCoÜdš©e
 = 'A1', 
PHPExûl_C–l_D©aV®id©iÚ
 
$pD©aV®id©iÚ
 = 
nuÎ
)

2752 ià(
$pD©aV®id©iÚ
 ==ğ
nuÎ
) {

2753 
un£t
(
$this
->
d©aV®id©iÚCŞËùiÚ
[
$pC–lCoÜdš©e
]);

2755 
	g$this
->
	gd©aV®id©iÚCŞËùiÚ
[
$pC–lCoÜdš©e
] = 
$pD©aV®id©iÚ
;

2757  
	g$this
;

2766 
public
 
funùiÚ
 
d©aV®id©iÚExi¡s
(
$pCoÜdš©e
 = 'A1')

2768  
is£t
(
$this
->
d©aV®id©iÚCŞËùiÚ
[
$pCoÜdš©e
]);

2776 
public
 
funùiÚ
 
	$g‘D©aV®id©iÚCŞËùiÚ
()

2778  
$this
->
d©aV®id©iÚCŞËùiÚ
;

2779 
	}
}

2787 
public
 
funùiÚ
 
	$shrškRªgeToF™
(
$¿nge
)

2789 
$maxCŞ
 = 
$this
->
	`g‘Highe¡CŞumn
();

2790 
$maxRow
 = 
$this
->
	`g‘Highe¡Row
();

2791 
$maxCŞ
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($maxCol);

2793 
$¿ngeBlocks
 = 
	`ex¶ode
(' ', 
$¿nge
);

2794 
	`fÜ—ch
 (
$¿ngeBlocks
 
as
 &
$¿ngeS‘
) {

2795 
$¿ngeBound¬›s
 = 
PHPExûl_C–l
::
	`g‘RªgeBound¬›s
(
$¿ngeS‘
);

2797 ià(
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$¿ngeBound¬›s
[0][0]è> 
$maxCŞ
) {

2798 
$¿ngeBound¬›s
[0][0] = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$maxCŞ
);

2800 ià(
$¿ngeBound¬›s
[0][1] > 
$maxRow
) {

2801 
$¿ngeBound¬›s
[0][1] = 
$maxRow
;

2803 ià(
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$¿ngeBound¬›s
[1][0]è> 
$maxCŞ
) {

2804 
$¿ngeBound¬›s
[1][0] = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$maxCŞ
);

2806 ià(
$¿ngeBound¬›s
[1][1] > 
$maxRow
) {

2807 
$¿ngeBound¬›s
[1][1] = 
$maxRow
;

2809 
$¿ngeS‘
 = 
$¿ngeBound¬›s
[0][0].$rangeBoundaries[0][1].':'.$rangeBoundaries[1][0].$rangeBoundaries[1][1];

2811 
	`un£t
(
$¿ngeS‘
);

2812 
$¡Rªge
 = 
	`im¶ode
(' ', 
$¿ngeBlocks
);

2814  
$¡Rªge
;

2815 
	}
}

2822 
public
 
funùiÚ
 
	$g‘TabCŞÜ
()

2824 ià(
$this
->
bCŞÜ
 ==ğ
nuÎ
) {

2825 
$this
->
bCŞÜ
 = 
Ãw
 
	`PHPExûl_StyË_CŞÜ
();

2827  
$this
->
bCŞÜ
;

2828 
	}
}

2835 
public
 
funùiÚ
 
	$»£tTabCŞÜ
()

2837 
$this
->
bCŞÜ
 = 
nuÎ
;

2838 
	`un£t
(
$this
->
bCŞÜ
);

2840  
$this
;

2841 
	}
}

2848 
public
 
funùiÚ
 
	$isTabCŞÜS‘
()

2850  (
$this
->
bCŞÜ
 !=ğ
nuÎ
);

2851 
	}
}

2858 
public
 
funùiÚ
 
	$cİy
()

2860 
$cİ›d
 = 
şÚe
 
$this
;

2862  
$cİ›d
;

2863 
	}
}

2868 
public
 
funùiÚ
 
	$__şÚe
()

2870 
	`fÜ—ch
 (
$this
 
as
 
$key
 => 
$v®
) {

2871 ià(
$key
 == 'parent') {

2875 ià(
	`is_objeù
(
$v®
è|| (
	`is_¬¿y
($val))) {

2876 ià(
$key
 == 'cellCollection') {

2877 
$ÃwCŞËùiÚ
 = 
şÚe
 
$this
->
ûÎCŞËùiÚ
;

2878 
$ÃwCŞËùiÚ
->
	`cİyC–lCŞËùiÚ
(
$this
);

2879 
$this
->
ûÎCŞËùiÚ
 = 
$ÃwCŞËùiÚ
;

2880 } 
	`–£if
 (
$key
 == 'drawingCollection') {

2881 
$ÃwCŞËùiÚ
 = 
şÚe
 
$this
->
d¿wšgCŞËùiÚ
;

2882 
$this
->
d¿wšgCŞËùiÚ
 = 
$ÃwCŞËùiÚ
;

2883 } 
	`–£if
 ((
$key
 =ğ'autoF‹r'è&& (
$this
->
autoF‹r
 
š¡ªûof
 
PHPExûl_WÜksh“t_AutoF‹r
)) {

2884 
$ÃwAutoF‹r
 = 
şÚe
 
$this
->
autoF‹r
;

2885 
$this
->
autoF‹r
 = 
$ÃwAutoF‹r
;

2886 
$this
->
autoF‹r
->
	`£tP¬’t
($this);

2888 
$this
->{
$key
} = 
	`un£rŸlize
(
	`£rŸlize
(
$v®
));

2892 
	}
}

2900 
public
 
funùiÚ
 
	$£tCodeName
(
$pV®ue
 = 
nuÎ
)

2903 ià(
$this
->
	`g‘CodeName
(è=ğ
$pV®ue
) {

2904  
$this
;

2906 
$pV®ue
 = 
	`¡r_»¶aû
(' ', '_', $pValue);

2909 
£lf
::
	`checkSh“tCodeName
(
$pV®ue
);

2913 ià(
$this
->
	`g‘P¬’t
()) {

2915 ià(
$this
->
	`g‘P¬’t
()->
	`sh“tCodeNameExi¡s
(
$pV®ue
)) {

2918 ià(
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$pV®ue
) > 29) {

2919 
$pV®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`Sub¡ršg
($pValue, 0, 29);

2921 
$i
 = 1;

2922 
$this
->
	`g‘P¬’t
()->
	`sh“tCodeNameExi¡s
(
$pV®ue
 . '_' . 
$i
)) {

2923 ++
$i
;

2924 ià(
$i
 == 10) {

2925 ià(
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$pV®ue
) > 28) {

2926 
$pV®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`Sub¡ršg
($pValue, 0, 28);

2928 } 
	`–£if
 (
$i
 == 100) {

2929 ià(
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$pV®ue
) > 27) {

2930 
$pV®ue
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`Sub¡ršg
($pValue, 0, 27);

2935 
$pV®ue
 = $pV®u. '_' . 
$i
;

2941 
$this
->
codeName
=
$pV®ue
;

2942  
$this
;

2943 
	}
}

2949 
public
 
funùiÚ
 
	$g‘CodeName
()

2951  
$this
->
codeName
;

2952 
	}
}

2957 
public
 
funùiÚ
 
	$hasCodeName
()

2959  !(
	`is_nuÎ
(
$this
->
codeName
));

2960 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/AutoFilter.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_AutoF‹r


35 
´iv©e
 
	m$wÜkSh“t
;

43 
´iv©e
 
	m$¿nge
 = '';

51 
´iv©e
 
	m$cŞumns
 = 
¬¿y
();

60 
public
 
funùiÚ
 
__cÚ¡ruù
(
$pRªge
 = '', 
PHPExûl_WÜksh“t
 
$pSh“t
 = 
nuÎ
)

62 
$this
->
¿nge
 = 
$pRªge
;

63 
	m$this
->
	mwÜkSh“t
 = 
$pSh“t
;

71 
public
 
funùiÚ
 
	$g‘P¬’t
()

73  
$this
->
wÜkSh“t
;

74 
	}
}

82 
public
 
funùiÚ
 
	$£tP¬’t
(
PHPExûl_WÜksh“t
 
$pSh“t
 = 
nuÎ
)

84 
$this
->
wÜkSh“t
 = 
$pSh“t
;

86  
$this
;

87 
	}
}

94 
public
 
funùiÚ
 
	$g‘Rªge
()

96  
$this
->
¿nge
;

97 
	}
}

106 
public
 
funùiÚ
 
£tRªge
(
$pRªge
 = '')

109 
$ûÎAdd»ss
 = 
ex¶ode
('!', 
¡¹ouµ”
(
$pRªge
));

110 ià(
couÁ
(
$ûÎAdd»ss
) > 1) {

111 
li¡
(
$wÜksh“t
, 
$pRªge
èğ
$ûÎAdd»ss
;

114 ià(
¡½os
(
$pRªge
, ':'è!=ğ
çl£
) {

115 
$this
->
¿nge
 = 
$pRªge
;

116 } 
–£if
 (
em±y
(
$pRªge
)) {

117 
	g$this
->
	g¿nge
 = '';

119 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Autofilter must be set on‡„ange of cells.');

122 ià(
em±y
(
$pRªge
)) {

124 
	g$this
->
	gcŞumns
 = 
¬¿y
();

127 
li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
PHPExûl_C–l
::
¿ngeBound¬›s
(
$this
->
¿nge
);

128 
fÜ—ch
 (
$this
->
cŞumns
 
as
 
$key
 => 
$v®ue
) {

129 
$cŞIndex
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$key
);

130 ià((
	g$¿ngeS¹
[0] > 
	g$cŞIndex
è|| (
	g$¿ngeEnd
[0] < $colIndex)) {

131 
un£t
(
$this
->
cŞumns
[
$key
]);

136  
	g$this
;

145 
public
 
funùiÚ
 
	$g‘CŞumns
()

147  
$this
->
cŞumns
;

148 
	}
}

157 
public
 
funùiÚ
 
	$‹¡CŞumnInRªge
(
$cŞumn
)

159 ià(
	`em±y
(
$this
->
¿nge
)) {

160 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("No‡utofilter„ange is defined.");

163 
$cŞumnIndex
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞumn
);

164 
	`li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
PHPExûl_C–l
::
	`¿ngeBound¬›s
(
$this
->
¿nge
);

165 ià((
$¿ngeS¹
[0] > 
$cŞumnIndex
è|| (
$¿ngeEnd
[0] < $columnIndex)) {

166 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Column is outside of current‡utofilter„ange.");

169  
$cŞumnIndex
 - 
$¿ngeS¹
[0];

170 
	}
}

179 
public
 
funùiÚ
 
	$g‘CŞumnOff£t
(
$pCŞumn
)

181  
$this
->
	`‹¡CŞumnInRªge
(
$pCŞumn
);

182 
	}
}

191 
public
 
funùiÚ
 
	$g‘CŞumn
(
$pCŞumn
)

193 
$this
->
	`‹¡CŞumnInRªge
(
$pCŞumn
);

195 ià(!
	`is£t
(
$this
->
cŞumns
[
$pCŞumn
])) {

196 
$this
->
cŞumns
[
$pCŞumn
] = 
Ãw
 
	`PHPExûl_WÜksh“t_AutoF‹r_CŞumn
($pColumn, $this);

199  
$this
->
cŞumns
[
$pCŞumn
];

200 
	}
}

209 
public
 
funùiÚ
 
	$g‘CŞumnByOff£t
(
$pCŞumnOff£t
 = 0)

211 
	`li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
PHPExûl_C–l
::
	`¿ngeBound¬›s
(
$this
->
¿nge
);

212 
$pCŞumn
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$¿ngeS¹
[0] + 
$pCŞumnOff£t
 - 1);

214  
$this
->
	`g‘CŞumn
(
$pCŞumn
);

215 
	}
}

225 
public
 
funùiÚ
 
	$£tCŞumn
(
$pCŞumn
)

227 ià((
	`is_¡ršg
(
$pCŞumn
)è&& (!
	`em±y
($pColumn))) {

228 
$cŞumn
 = 
$pCŞumn
;

229 } 
	`–£if
 (
	`is_objeù
(
$pCŞumn
è&& ($pCŞumÀ
š¡ªûof
 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
)) {

230 
$cŞumn
 = 
$pCŞumn
->
	`g‘CŞumnIndex
();

232 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Column is‚ot withinhe‡utofilter„ange.");

234 
$this
->
	`‹¡CŞumnInRªge
(
$cŞumn
);

236 ià(
	`is_¡ršg
(
$pCŞumn
)) {

237 
$this
->
cŞumns
[
$pCŞumn
] = 
Ãw
 
	`PHPExûl_WÜksh“t_AutoF‹r_CŞumn
($pColumn, $this);

238 } 
	`–£if
 (
	`is_objeù
(
$pCŞumn
è&& ($pCŞumÀ
š¡ªûof
 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
)) {

239 
$pCŞumn
->
	`£tP¬’t
(
$this
);

240 
$this
->
cŞumns
[
$cŞumn
] = 
$pCŞumn
;

242 
	`ksÜt
(
$this
->
cŞumns
);

244  
$this
;

245 
	}
}

254 
public
 
funùiÚ
 
	$ş—rCŞumn
(
$pCŞumn
)

256 
$this
->
	`‹¡CŞumnInRªge
(
$pCŞumn
);

258 ià(
	`is£t
(
$this
->
cŞumns
[
$pCŞumn
])) {

259 
	`un£t
(
$this
->
cŞumns
[
$pCŞumn
]);

262  
$this
;

263 
	}
}

276 
public
 
funùiÚ
 
	$shiáCŞumn
(
$äomCŞumn
 = 
nuÎ
, 
$toCŞumn
 =‚ull)

278 
$äomCŞumn
 = 
	`¡¹ouµ”
($fromColumn);

279 
$toCŞumn
 = 
	`¡¹ouµ”
($toColumn);

281 ià((
$äomCŞumn
 !=ğ
nuÎ
è&& (
	`is£t
(
$this
->
cŞumns
[$äomCŞumn])è&& (
$toCŞumn
 !==‚ull)) {

282 
$this
->
cŞumns
[
$äomCŞumn
]->
	`£tP¬’t
();

283 
$this
->
cŞumns
[
$äomCŞumn
]->
	`£tCŞumnIndex
(
$toCŞumn
);

284 
$this
->
cŞumns
[
$toCŞumn
] = $this->cŞumns[
$äomCŞumn
];

285 
$this
->
cŞumns
[
$toCŞumn
]->
	`£tP¬’t
($this);

286 
	`un£t
(
$this
->
cŞumns
[
$äomCŞumn
]);

288 
	`ksÜt
(
$this
->
cŞumns
);

291  
$this
;

292 
	}
}

302 
´iv©e
 
funùiÚ
 
	$f‹rTe¡InSim¶eD©aS‘
(
$ûÎV®ue
, 
$d©aS‘
)

304 
$d©aS‘V®ues
 = 
$d©aS‘
['filterValues'];

305 
$bÏnks
 = 
$d©aS‘
['blanks'];

306 ià((
$ûÎV®ue
 =ğ''è|| ($ûÎV®u==ğ
nuÎ
)) {

307  
$bÏnks
;

309  
	`š_¬¿y
(
$ûÎV®ue
, 
$d©aS‘V®ues
);

310 
	}
}

319 
´iv©e
 
funùiÚ
 
	$f‹rTe¡InD©eGroupS‘
(
$ûÎV®ue
, 
$d©aS‘
)

321 
$d©eS‘
 = 
$d©aS‘
['filterValues'];

322 
$bÏnks
 = 
$d©aS‘
['blanks'];

323 ià((
$ûÎV®ue
 =ğ''è|| ($ûÎV®u==ğ
nuÎ
)) {

324  
$bÏnks
;

327 ià(
	`is_num”ic
(
$ûÎV®ue
)) {

328 
$d©eV®ue
 = 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
(
$ûÎV®ue
);

329 ià(
$ûÎV®ue
 < 1) {

331 
$dtV®
 = 
	`d©e
('His', 
$d©eV®ue
);

332 
$d©eS‘
 = $dateSet['time'];

333 } 
	`–£if
 (
$ûÎV®ue
 =ğ
	`æoÜ
($cellValue)) {

335 
$dtV®
 = 
	`d©e
('Ymd', 
$d©eV®ue
);

336 
$d©eS‘
 = $dateSet['date'];

339 
$dtV®
 = 
	`d©e
('YmdHis', 
$d©eV®ue
);

340 
$d©eS‘
 = $dateSet['dateTime'];

342 
	`fÜ—ch
 (
$d©eS‘
 
as
 
$d©eV®ue
) {

344 ià(
	`sub¡r
(
$dtV®
, 0, 
	`¡¾’
(
$d©eV®ue
)) == $dateValue) {

345  
Œue
;

349  
çl£
;

350 
	}
}

359 
´iv©e
 
funùiÚ
 
	$f‹rTe¡InCu¡omD©aS‘
(
$ûÎV®ue
, 
$ruËS‘
)

361 
$d©aS‘
 = 
$ruËS‘
['filterRules'];

362 
$još
 = 
$ruËS‘
['join'];

363 
$cu¡omRuËFÜBÏnks
 = 
	`is£t
(
$ruËS‘
['cu¡omRuËFÜBÏnks']è? $ruËS‘['cu¡omRuËFÜBÏnks'] : 
çl£
;

365 ià(!
$cu¡omRuËFÜBÏnks
) {

367 ià((
$ûÎV®ue
 =ğ''è|| ($ûÎV®u==ğ
nuÎ
)) {

368  
çl£
;

371 
$»tuºV®
 = (
$još
 =ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_COLUMN_JOIN_AND
);

372 
	`fÜ—ch
 (
$d©aS‘
 
as
 
$ruË
) {

373 ià(
	`is_num”ic
(
$ruË
['value'])) {

375 
$ruË
['operator']) {

376 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_EQUAL
:

377 
$»tV®
 = (
$ûÎV®ue
 =ğ
$ruË
['value']);

379 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_NOTEQUAL
:

380 
$»tV®
 = (
$ûÎV®ue
 !ğ
$ruË
['value']);

382 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_GREATERTHAN
:

383 
$»tV®
 = (
$ûÎV®ue
 > 
$ruË
['value']);

385 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_GREATERTHANOREQUAL
:

386 
$»tV®
 = (
$ûÎV®ue
 >ğ
$ruË
['value']);

388 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_LESSTHAN
:

389 
$»tV®
 = (
$ûÎV®ue
 < 
$ruË
['value']);

391 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_LESSTHANOREQUAL
:

392 
$»tV®
 = (
$ûÎV®ue
 <ğ
$ruË
['value']);

395 } 
	`–£if
 (
$ruË
['value'] == '') {

396 
$ruË
['operator']) {

397 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_EQUAL
:

398 
$»tV®
 = ((
$ûÎV®ue
 =ğ''è|| ($ûÎV®u==ğ
nuÎ
));

400 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_NOTEQUAL
:

401 
$»tV®
 = ((
$ûÎV®ue
 !ğ''è&& ($ûÎV®u!=ğ
nuÎ
));

404 
$»tV®
 = 
Œue
;

409 
$»tV®
 = 
	`´eg_m©ch
('/^'.
$ruË
['v®ue'].'$/i', 
$ûÎV®ue
);

412 
$još
) {

413 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_COLUMN_JOIN_OR
:

414 
$»tuºV®
 = $»tuºV® || 
$»tV®
;

417 ià(
$»tuºV®
) {

418  
$»tuºV®
;

421 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_COLUMN_JOIN_AND
:

422 
$»tuºV®
 = $»tuºV® && 
$»tV®
;

427  
$»tuºV®
;

428 
	}
}

437 
´iv©e
 
funùiÚ
 
	$f‹rTe¡InP”iodD©eS‘
(
$ûÎV®ue
, 
$mÚthS‘
)

440 ià((
$ûÎV®ue
 =ğ''è|| ($ûÎV®u==ğ
nuÎ
)) {

441  
çl£
;

444 ià(
	`is_num”ic
(
$ûÎV®ue
)) {

445 
$d©eV®ue
 = 
	`d©e
('m', 
PHPExûl_Sh¬ed_D©e
::
	`ExûlToPHP
(
$ûÎV®ue
));

446 ià(
	`š_¬¿y
(
$d©eV®ue
, 
$mÚthS‘
)) {

447  
Œue
;

451  
çl£
;

452 
	}
}

459 
´iv©e
 
	g$äomR•Ïû
 = 
¬¿y
('\*', '\?', '~~', '~.*', '~.?');

460 
´iv©e
 
	g$toR•Ïû
 = 
¬¿y
('.*', '.', '~', '\*', '\?');

470 
´iv©e
 
funùiÚ
 
	$dyÇmicF‹rD©eRªge
(
$dyÇmicRuËTy³
, &
$f‹rCŞumn
)

472 
$rD©eTy³
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
();

473 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`£tR‘uºD©eTy³
(PHPExûl_C®cuÏtiÚ_FunùiÚs::
RETURNDATE_PHP_NUMERIC
);

474 
$v®
 = 
$maxV®
 = 
nuÎ
;

476 
$ruËV®ues
 = 
	`¬¿y
();

477 
$ba£D©e
 = 
PHPExûl_C®cuÏtiÚ_D©eTime
::
	`DATENOW
();

479 
$dyÇmicRuËTy³
) {

480 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTWEEK
:

481 
$ba£D©e
 = 
	`¡¹Ùime
('-7 days', $baseDate);

483 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTWEEK
:

484 
$ba£D©e
 = 
	`¡¹Ùime
('-7 days', $baseDate);

486 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTMONTH
:

487 
$ba£D©e
 = 
	`¡¹Ùime
('-1 mÚth', 
	`gmmktime
(0, 0, 0, 1, 
	`d©e
('m', $baseDate), date('Y', $baseDate)));

489 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTMONTH
:

490 
$ba£D©e
 = 
	`¡¹Ùime
('+1 mÚth', 
	`gmmktime
(0, 0, 0, 1, 
	`d©e
('m', $baseDate), date('Y', $baseDate)));

492 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTQUARTER
:

493 
$ba£D©e
 = 
	`¡¹Ùime
('-3 mÚth', 
	`gmmktime
(0, 0, 0, 1, 
	`d©e
('m', $baseDate), date('Y', $baseDate)));

495 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTQUARTER
:

496 
$ba£D©e
 = 
	`¡¹Ùime
('+3 mÚth', 
	`gmmktime
(0, 0, 0, 1, 
	`d©e
('m', $baseDate), date('Y', $baseDate)));

498 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTYEAR
:

499 
$ba£D©e
 = 
	`¡¹Ùime
('-1 y—r', 
	`gmmktime
(0, 0, 0, 1, 
	`d©e
('m', $baseDate), date('Y', $baseDate)));

501 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTYEAR
:

502 
$ba£D©e
 = 
	`¡¹Ùime
('+1 y—r', 
	`gmmktime
(0, 0, 0, 1, 
	`d©e
('m', $baseDate), date('Y', $baseDate)));

506 
$dyÇmicRuËTy³
) {

507 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_TODAY
:

508 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_YESTERDAY
:

509 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_TOMORROW
:

510 
$maxV®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPtoExûl
(
	`¡¹Ùime
('+1 day', 
$ba£D©e
));

511 
$v®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
$ba£D©e
);

513 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_YEARTODATE
:

514 
$maxV®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPtoExûl
(
	`¡¹Ùime
('+1 day', 
$ba£D©e
));

515 
$v®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
	`gmmktime
(0, 0, 0, 1, 1, 
	`d©e
('Y', 
$ba£D©e
)));

517 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_THISYEAR
:

518 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTYEAR
:

519 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTYEAR
:

520 
$maxV®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
	`gmmktime
(0, 0, 0, 31, 12, 
	`d©e
('Y', 
$ba£D©e
)));

521 ++
$maxV®
;

522 
$v®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
	`gmmktime
(0, 0, 0, 1, 1, 
	`d©e
('Y', 
$ba£D©e
)));

524 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_THISQUARTER
:

525 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTQUARTER
:

526 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTQUARTER
:

527 
$thisMÚth
 = 
	`d©e
('m', 
$ba£D©e
);

528 
$thisQu¬‹r
 = 
	`æoÜ
(--
$thisMÚth
 / 3);

529 
$maxV®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPtoExûl
(
	`gmmktime
(0, 0, 0, 
	`d©e
('t', 
$ba£D©e
), (1+
$thisQu¬‹r
)*3, date('Y', $baseDate)));

530 ++
$maxV®
;

531 
$v®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
	`gmmktime
(0, 0, 0, 1, 1+
$thisQu¬‹r
*3, 
	`d©e
('Y', 
$ba£D©e
)));

533 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_THISMONTH
:

534 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTMONTH
:

535 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTMONTH
:

536 
$maxV®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPtoExûl
(
	`gmmktime
(0, 0, 0, 
	`d©e
('t', 
$ba£D©e
), date('m', $baseDate), date('Y', $baseDate)));

537 ++
$maxV®
;

538 
$v®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
	`gmmktime
(0, 0, 0, 1, 
	`d©e
('m', 
$ba£D©e
), date('Y', $baseDate)));

540 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_THISWEEK
:

541 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTWEEK
:

542 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTWEEK
:

543 
$dayOfW“k
 = 
	`d©e
('w', 
$ba£D©e
);

544 
$v®
 = (è
PHPExûl_Sh¬ed_D©e
::
	`PHPToExûl
(
$ba£D©e
è- 
$dayOfW“k
;

545 
$maxV®
 = 
$v®
 + 7;

549 
$dyÇmicRuËTy³
) {

551 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_YESTERDAY
:

552 --
$maxV®
;

553 --
$v®
;

555 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_TOMORROW
:

556 ++
$maxV®
;

557 ++
$v®
;

562 
$f‹rCŞumn
->
	`£tA‰ribu‹s
(
	`¬¿y
('v®' => 
$v®
, 'maxV®' => 
$maxV®
));

565 
$ruËV®ues
[] = 
	`¬¿y
('İ”©Ü' => 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_GREATERTHANOREQUAL
, 'v®ue' => 
$v®
);

566 
$ruËV®ues
[] = 
	`¬¿y
('İ”©Ü' => 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_LESSTHAN
, 'v®ue' => 
$maxV®
);

567 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`£tR‘uºD©eTy³
(
$rD©eTy³
);

569  
	`¬¿y
('m‘hod' => 'f‹rTe¡InCu¡omD©aS‘', '¬gum’ts' =>‡¼ay('f‹rRuËs' => 
$ruËV®ues
, 'još' => 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_COLUMN_JOIN_AND
));

570 
	}
}

572 
´iv©e
 
funùiÚ
 
	$ÿlcuÏ‹TİT’V®ue
(
$cŞumnID
, 
$¡¬tRow
, 
$’dRow
, 
$ruËTy³
, 
$ruËV®ue
)

574 
$¿nge
 = 
$cŞumnID
.
$¡¬tRow
.':'.$cŞumnID.
$’dRow
;

575 
$d©aV®ues
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`æ©‹nA¼ay
(
$this
->
wÜkSh“t
->
	`¿ngeToA¼ay
(
$¿nge
, 
nuÎ
, 
Œue
, 
çl£
));

577 
$d©aV®ues
 = 
	`¬¿y_f‹r
($dataValues);

578 ià(
$ruËTy³
 =ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_TOPTEN_TOP
) {

579 
	`rsÜt
(
$d©aV®ues
);

581 
	`sÜt
(
$d©aV®ues
);

584  
	`¬¿y_pİ
(
	`¬¿y_¦iû
(
$d©aV®ues
, 0, 
$ruËV®ue
));

585 
	}
}

593 
public
 
funùiÚ
 
	$showHideRows
()

595 
	`li¡
(
$¿ngeS¹
, 
$¿ngeEnd
èğ
PHPExûl_C–l
::
	`¿ngeBound¬›s
(
$this
->
¿nge
);

599 
$this
->
wÜkSh“t
->
	`g‘RowDim’siÚ
(
$¿ngeS¹
[1])->
	`£tVisibË
(
Œue
);

601 
$cŞumnF‹rTe¡s
 = 
	`¬¿y
();

602 
	`fÜ—ch
 (
$this
->
cŞumns
 
as
 
$cŞumnID
 => 
$f‹rCŞumn
) {

603 
$ruËs
 = 
$f‹rCŞumn
->
	`g‘RuËs
();

604 
$f‹rCŞumn
->
	`g‘F‹rTy³
()) {

605 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_FILTERTYPE_FILTER
:

606 
$ruËV®ues
 = 
	`¬¿y
();

608 
	`fÜ—ch
 (
$ruËs
 
as
 
$ruË
) {

609 
$ruËTy³
 = 
$ruË
->
	`g‘RuËTy³
();

610 
$ruËV®ues
[] = 
$ruË
->
	`g‘V®ue
();

613 
$bÏnks
 = 
çl£
;

614 
$ruËD©aS‘
 = 
	`¬¿y_f‹r
(
$ruËV®ues
);

615 ià(
	`couÁ
(
$ruËV®ues
è!ğcouÁ(
$ruËD©aS‘
)) {

616 
$bÏnks
 = 
Œue
;

618 ià(
$ruËTy³
 =ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_FILTER
) {

620 
$cŞumnF‹rTe¡s
[
$cŞumnID
] = 
	`¬¿y
(

622 '¬gum’ts' => 
	`¬¿y
('f‹rV®ues' => 
$ruËD©aS‘
, 'bÏnks' => 
$bÏnks
)

626 
$¬gum’ts
 = 
	`¬¿y
(

627 'd©e' => 
	`¬¿y
(),

628 'time' => 
	`¬¿y
(),

629 'd©eTime' => 
	`¬¿y
(),

631 
	`fÜ—ch
 (
$ruËD©aS‘
 
as
 
$ruËV®ue
) {

632 
$d©e
 = 
$time
 = '';

633 ià((
	`is£t
(
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_YEAR
])) &&

634 (
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_YEAR
] !== '')) {

635 
$d©e
 .ğ
	`¥rštf
('%04d', 
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_YEAR
]);

637 ià((
	`is£t
(
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_MONTH
])) &&

638 (
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_MONTH
] != '')) {

639 
$d©e
 .ğ
	`¥rštf
('%02d', 
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_MONTH
]);

641 ià((
	`is£t
(
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_DAY
])) &&

642 (
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_DAY
] !== '')) {

643 
$d©e
 .ğ
	`¥rštf
('%02d', 
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_DAY
]);

645 ià((
	`is£t
(
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_HOUR
])) &&

646 (
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_HOUR
] !== '')) {

647 
$time
 .ğ
	`¥rštf
('%02d', 
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_HOUR
]);

649 ià((
	`is£t
(
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_MINUTE
])) &&

650 (
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_MINUTE
] !== '')) {

651 
$time
 .ğ
	`¥rštf
('%02d', 
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_MINUTE
]);

653 ià((
	`is£t
(
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_SECOND
])) &&

654 (
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_SECOND
] !== '')) {

655 
$time
 .ğ
	`¥rštf
('%02d', 
$ruËV®ue
[
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP_SECOND
]);

657 
$d©eTime
 = 
$d©e
 . 
$time
;

658 
$¬gum’ts
['d©e'][] = 
$d©e
;

659 
$¬gum’ts
['time'][] = 
$time
;

660 
$¬gum’ts
['d©eTime'][] = 
$d©eTime
;

663 
$¬gum’ts
['d©e'] = 
	`¬¿y_f‹r
($arguments['date']);

664 
$¬gum’ts
['time'] = 
	`¬¿y_f‹r
($arguments['time']);

665 
$¬gum’ts
['d©eTime'] = 
	`¬¿y_f‹r
($arguments['dateTime']);

666 
$cŞumnF‹rTe¡s
[
$cŞumnID
] = 
	`¬¿y
(

668 '¬gum’ts' => 
	`¬¿y
('f‹rV®ues' => 
$¬gum’ts
, 'bÏnks' => 
$bÏnks
)

672 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_FILTERTYPE_CUSTOMFILTER
:

673 
$cu¡omRuËFÜBÏnks
 = 
çl£
;

674 
$ruËV®ues
 = 
	`¬¿y
();

676 
	`fÜ—ch
 (
$ruËs
 
as
 
$ruË
) {

677 
$ruËTy³
 = 
$ruË
->
	`g‘RuËTy³
();

678 
$ruËV®ue
 = 
$ruË
->
	`g‘V®ue
();

679 ià(!
	`is_num”ic
(
$ruËV®ue
)) {

681 
$ruËV®ue
 = 
	`´eg_quÙe
($ruleValue);

682 
$ruËV®ue
 = 
	`¡r_»¶aû
(
£lf
::
$äomR•Ïû
, s–f::
$toR•Ïû
, $ruleValue);

683 ià(
	`Œim
(
$ruËV®ue
) == '') {

684 
$cu¡omRuËFÜBÏnks
 = 
Œue
;

685 
$ruËV®ue
 = 
	`Œim
($ruleValue);

688 
$ruËV®ues
[] = 
	`¬¿y
('İ”©Ü' => 
$ruË
->
	`g‘O³¿tÜ
(), 'v®ue' => 
$ruËV®ue
);

690 
$još
 = 
$f‹rCŞumn
->
	`g‘Još
();

691 
$cŞumnF‹rTe¡s
[
$cŞumnID
] = 
	`¬¿y
(

693 '¬gum’ts' => 
	`¬¿y
('f‹rRuËs' => 
$ruËV®ues
, 'još' => 
$još
, 'cu¡omRuËFÜBÏnks' => 
$cu¡omRuËFÜBÏnks
)

696 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_FILTERTYPE_DYNAMICFILTER
:

697 
$ruËV®ues
 = 
	`¬¿y
();

698 
	`fÜ—ch
 (
$ruËs
 
as
 
$ruË
) {

700 
$dyÇmicRuËTy³
 = 
$ruË
->
	`g‘Groupšg
();

701 ià((
$dyÇmicRuËTy³
 =ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_ABOVEAVERAGE
) ||

702 (
$dyÇmicRuËTy³
 =ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_BELOWAVERAGE
)) {

705 
$av”ageFÜmuÏ
 = '=AVERAGE('.
$cŞumnID
.(
$¿ngeS¹
[1]+1).':'.$cŞumnID.
$¿ngeEnd
[1].')';

706 
$av”age
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
()->
	`ÿlcuÏ‹FÜmuÏ
(
$av”ageFÜmuÏ
, 
nuÎ
, 
$this
->
wÜkSh“t
->
	`g‘C–l
('A1'));

708 
$İ”©Ü
 = (
$dyÇmicRuËTy³
 ==ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMIC_ABOVEAVERAGE
)

709 ? 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_GREATERTHAN


710 : 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_LESSTHAN
;

711 
$ruËV®ues
[] = 
	`¬¿y
('İ”©Ü' => 
$İ”©Ü
,

712 'v®ue' => 
$av”age


714 
$cŞumnF‹rTe¡s
[
$cŞumnID
] = 
	`¬¿y
(

716 '¬gum’ts' => 
	`¬¿y
('f‹rRuËs' => 
$ruËV®ues
, 'još' => 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_COLUMN_JOIN_OR
)

720 ià(
$dyÇmicRuËTy³
{0} == 'M' || $dynamicRuleType{0} == 'Q') {

722 
	`ssÿnf
(
$dyÇmicRuËTy³
, '%[A-Z]%d', 
$³riodTy³
, 
$³riod
);

723 ià(
$³riodTy³
 == 'M') {

724 
$ruËV®ues
 = 
	`¬¿y
(
$³riod
);

726 --
$³riod
;

727 
$³riodEnd
 = (1+
$³riod
)*3;

728 
$³riodS¹
 = 1+
$³riod
*3;

729 
$ruËV®ues
 = 
	`¿nge
(
$³riodS¹
, 
$³riodEnd
);

731 
$cŞumnF‹rTe¡s
[
$cŞumnID
] = 
	`¬¿y
(

733 '¬gum’ts' => 
$ruËV®ues


735 
$f‹rCŞumn
->
	`£tA‰ribu‹s
(
	`¬¿y
());

738 
$cŞumnF‹rTe¡s
[
$cŞumnID
] = 
$this
->
	`dyÇmicF‹rD©eRªge
(
$dyÇmicRuËTy³
, 
$f‹rCŞumn
);

744 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_FILTERTYPE_TOPTENFILTER
:

745 
$ruËV®ues
 = 
	`¬¿y
();

746 
$d©aRowCouÁ
 = 
$¿ngeEnd
[1] - 
$¿ngeS¹
[1];

747 
	`fÜ—ch
 (
$ruËs
 
as
 
$ruË
) {

749 
$tİ‹nRuËTy³
 = 
$ruË
->
	`g‘Groupšg
();

750 
$ruËV®ue
 = 
$ruË
->
	`g‘V®ue
();

751 
$ruËO³¿tÜ
 = 
$ruË
->
	`g‘O³¿tÜ
();

753 ià(
$ruËO³¿tÜ
 ==ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_TOPTEN_PERCENT
) {

754 
$ruËV®ue
 = 
	`æoÜ
($ruËV®u* (
$d©aRowCouÁ
 / 100));

756 ià(
$ruËV®ue
 < 1) {

757 
$ruËV®ue
 = 1;

759 ià(
$ruËV®ue
 > 500) {

760 
$ruËV®ue
 = 500;

763 
$maxV®
 = 
$this
->
	`ÿlcuÏ‹TİT’V®ue
(
$cŞumnID
, 
$¿ngeS¹
[1]+1, 
$¿ngeEnd
[1], 
$tİ‹nRuËTy³
, 
$ruËV®ue
);

765 
$İ”©Ü
 = (
$tİ‹nRuËTy³
 =ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_TOPTEN_TOP
)

766 ? 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_GREATERTHANOREQUAL


767 : 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_LESSTHANOREQUAL
;

768 
$ruËV®ues
[] = 
	`¬¿y
('İ”©Ü' => 
$İ”©Ü
, 'v®ue' => 
$maxV®
);

769 
$cŞumnF‹rTe¡s
[
$cŞumnID
] = 
	`¬¿y
(

771 '¬gum’ts' => 
	`¬¿y
('f‹rRuËs' => 
$ruËV®ues
, 'još' => 
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_COLUMN_JOIN_OR
)

773 
$f‹rCŞumn
->
	`£tA‰ribu‹s
(
	`¬¿y
('maxV®' => 
$maxV®
));

782 
$row
 = 
$¿ngeS¹
[1]+1; $row <ğ
$¿ngeEnd
[1]; ++$row) {

784 
$»suÉ
 = 
Œue
;

785 
	`fÜ—ch
 (
$cŞumnF‹rTe¡s
 
as
 
$cŞumnID
 => 
$cŞumnF‹rTe¡
) {

787 
$ûÎV®ue
 = 
$this
->
wÜkSh“t
->
	`g‘C–l
(
$cŞumnID
.
$row
)->
	`g‘C®cuÏ‹dV®ue
();

790 
$»suÉ
 = $result &&

791 
	`ÿÎ_u£r_func_¬¿y
(

792 
	`¬¿y
('PHPExûl_WÜksh“t_AutoF‹r', 
$cŞumnF‹rTe¡
['method']),

793 
	`¬¿y
(
$ûÎV®ue
, 
$cŞumnF‹rTe¡
['arguments'])

797 ià(!
$»suÉ
) {

803 
$this
->
wÜkSh“t
->
	`g‘RowDim’siÚ
(
$row
)->
	`£tVisibË
(
$»suÉ
);

806  
$this
;

807 
	}
}

813 
public
 
funùiÚ
 
	$__şÚe
()

815 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

816 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

817 ià(
	`is_objeù
(
$v®ue
)) {

818 ià(
$key
 == 'workSheet') {

820 
$this
->{
$key
} = 
nuÎ
;

822 
$this
->{
$key
} = 
şÚe
 
$v®ue
;

824 } 
	`–£if
 ((
	`is_¬¿y
(
$v®ue
)è&& (
$key
 == 'columns')) {

826 
$this
->{
$key
} = 
	`¬¿y
();

827 
	`fÜ—ch
 (
$v®ue
 
as
 
$k
 => 
$v
) {

828 
$this
->{
$key
}[
$k
] = 
şÚe
 
$v
;

830 
$this
->{
$key
}[
$k
]->
	`£tP¬’t
($this);

833 
$this
->{
$key
} = 
$v®ue
;

836 
	}
}

842 
public
 
funùiÚ
 
	$__toSŒšg
()

844  (
¡ršg
è
$this
->
¿nge
;

845 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/AutoFilter/Column.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_AutoF‹r_CŞumn


30 cÚ¡ 
	mAUTOFILTER_FILTERTYPE_FILTER
 = 'filters';

31 cÚ¡ 
	mAUTOFILTER_FILTERTYPE_CUSTOMFILTER
 = 'customFilters';

34 cÚ¡ 
	mAUTOFILTER_FILTERTYPE_DYNAMICFILTER
 = 'dynamicFilter';

37 cÚ¡ 
	mAUTOFILTER_FILTERTYPE_TOPTENFILTER
 = 'top10';

44 
´iv©e
 
	m$f‹rTy³s
 = 
¬¿y
(

49 
£lf
::
AUTOFILTER_FILTERTYPE_FILTER
,

50 
£lf
::
AUTOFILTER_FILTERTYPE_CUSTOMFILTER
,

51 
£lf
::
AUTOFILTER_FILTERTYPE_DYNAMICFILTER
,

52 
£lf
::
AUTOFILTER_FILTERTYPE_TOPTENFILTER
,

56 cÚ¡ 
	mAUTOFILTER_COLUMN_JOIN_AND
 = 'and';

57 cÚ¡ 
	mAUTOFILTER_COLUMN_JOIN_OR
 = 'or';

64 
´iv©e
 
	m$ruËJošs
 = 
¬¿y
(

65 
£lf
::
AUTOFILTER_COLUMN_JOIN_AND
,

66 
£lf
::
AUTOFILTER_COLUMN_JOIN_OR
,

74 
´iv©e
 
	m$·»Á
;

82 
´iv©e
 
	m$cŞumnIndex
 = '';

90 
´iv©e
 
	m$f‹rTy³
 = 
£lf
::
AUTOFILTER_FILTERTYPE_FILTER
;

98 
´iv©e
 
	m$još
 = 
£lf
::
AUTOFILTER_COLUMN_JOIN_OR
;

106 
´iv©e
 
	m$ruË£t
 = 
¬¿y
();

114 
´iv©e
 
	m$©Œibu‹s
 = 
¬¿y
();

123 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$pCŞumn
, 
PHPExûl_WÜksh“t_AutoF‹r
 
$pP¬’t
 = 
nuÎ
)

125 
$this
->
cŞumnIndex
 = 
$pCŞumn
;

126 
$this
->
·»Á
 = 
$pP¬’t
;

134 
public
 
funùiÚ
 
	$g‘CŞumnIndex
()

136  
$this
->
cŞumnIndex
;

137 
	}
}

146 
public
 
funùiÚ
 
	$£tCŞumnIndex
(
$pCŞumn
)

149 
$pCŞumn
 = 
	`¡¹ouµ”
($pColumn);

150 ià(
$this
->
·»Á
 !=ğ
nuÎ
) {

151 
$this
->
·»Á
->
	`‹¡CŞumnInRªge
(
$pCŞumn
);

154 
$this
->
cŞumnIndex
 = 
$pCŞumn
;

156  
$this
;

157 
	}
}

164 
public
 
funùiÚ
 
	$g‘P¬’t
()

166  
$this
->
·»Á
;

167 
	}
}

175 
public
 
funùiÚ
 
	$£tP¬’t
(
PHPExûl_WÜksh“t_AutoF‹r
 
$pP¬’t
 = 
nuÎ
)

177 
$this
->
·»Á
 = 
$pP¬’t
;

179  
$this
;

180 
	}
}

187 
public
 
funùiÚ
 
	$g‘F‹rTy³
()

189  
$this
->
f‹rTy³
;

190 
	}
}

199 
public
 
funùiÚ
 
	$£tF‹rTy³
(
$pF‹rTy³
 = 
£lf
::
AUTOFILTER_FILTERTYPE_FILTER
)

201 ià(!
	`š_¬¿y
(
$pF‹rTy³
, 
£lf
::
$f‹rTy³s
)) {

202 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid filterype for column AutoFilter.');

205 
$this
->
f‹rTy³
 = 
$pF‹rTy³
;

207  
$this
;

208 
	}
}

215 
public
 
funùiÚ
 
	$g‘Još
()

217  
$this
->
još
;

218 
	}
}

227 
public
 
funùiÚ
 
	$£tJoš
(
$pJoš
 = 
£lf
::
AUTOFILTER_COLUMN_JOIN_OR
)

230 
$pJoš
 = 
	`¡¹Şow”
($pJoin);

231 ià(!
	`š_¬¿y
(
$pJoš
, 
£lf
::
$ruËJošs
)) {

232 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid„ule connection for column AutoFilter.');

235 
$this
->
još
 = 
$pJoš
;

237  
$this
;

238 
	}
}

247 
public
 
funùiÚ
 
£tA‰ribu‹s
(
$pA‰ribu‹s
 = 
	$¬¿y
())

249 
$this
->
©Œibu‹s
 = 
$pA‰ribu‹s
;

251  
$this
;

252 
	}
}

262 
public
 
funùiÚ
 
	$£tA‰ribu‹
(
$pName
, 
$pV®ue
)

264 
$this
->
©Œibu‹s
[
$pName
] = 
$pV®ue
;

266  
$this
;

267 
	}
}

274 
public
 
funùiÚ
 
	$g‘A‰ribu‹s
()

276  
$this
->
©Œibu‹s
;

277 
	}
}

285 
public
 
funùiÚ
 
	$g‘A‰ribu‹
(
$pName
)

287 ià(
	`is£t
(
$this
->
©Œibu‹s
[
$pName
])) {

288  
$this
->
©Œibu‹s
[
$pName
];

290  
nuÎ
;

291 
	}
}

299 
public
 
funùiÚ
 
	$g‘RuËs
()

301  
$this
->
ruË£t
;

302 
	}
}

310 
public
 
funùiÚ
 
	$g‘RuË
(
$pIndex
)

312 ià(!
	`is£t
(
$this
->
ruË£t
[
$pIndex
])) {

313 
$this
->
ruË£t
[
$pIndex
] = 
Ãw
 
	`PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
($this);

315  
$this
->
ruË£t
[
$pIndex
];

316 
	}
}

323 
public
 
funùiÚ
 
	$ü—‹RuË
()

325 
$this
->
ruË£t
[] = 
Ãw
 
	`PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
($this);

327  
	`’d
(
$this
->
ruË£t
);

328 
	}
}

337 
public
 
funùiÚ
 
	$addRuË
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
 
$pRuË
, 
$»tuºRuË
 = 
Œue
)

339 
$pRuË
->
	`£tP¬’t
(
$this
);

340 
$this
->
ruË£t
[] = 
$pRuË
;

342  (
$»tuºRuË
è? 
$pRuË
 : 
$this
;

343 
	}
}

352 
public
 
funùiÚ
 
	$d–‘eRuË
(
$pIndex
)

354 ià(
	`is£t
(
$this
->
ruË£t
[
$pIndex
])) {

355 
	`un£t
(
$this
->
ruË£t
[
$pIndex
]);

357 ià(
	`couÁ
(
$this
->
ruË£t
) <= 1) {

358 
$this
->
	`£tJoš
(
£lf
::
AUTOFILTER_COLUMN_JOIN_OR
);

362  
$this
;

363 
	}
}

370 
public
 
funùiÚ
 
	$ş—rRuËs
()

372 
$this
->
ruË£t
 = 
	`¬¿y
();

373 
$this
->
	`£tJoš
(
£lf
::
AUTOFILTER_COLUMN_JOIN_OR
);

375  
$this
;

376 
	}
}

381 
public
 
funùiÚ
 
	$__şÚe
()

383 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

384 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

385 ià(
	`is_objeù
(
$v®ue
)) {

386 ià(
$key
 == 'parent') {

388 
$this
->
$key
 = 
nuÎ
;

390 
$this
->
$key
 = 
şÚe
 
$v®ue
;

392 } 
	`–£if
 ((
	`is_¬¿y
(
$v®ue
)è&& (
$key
 == 'ruleset')) {

394 
$this
->
$key
 = 
	`¬¿y
();

395 
	`fÜ—ch
 (
$v®ue
 
as
 
$k
 => 
$v
) {

396 
$this
->
$key
[
$k
] = 
şÚe
 
$v
;

398 
$this
->
$key
[
$k
]->
	`£tP¬’t
($this);

401 
$this
->
$key
 = 
$v®ue
;

404 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/AutoFilter/Column/Rule.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË


30 cÚ¡ 
	mAUTOFILTER_RULETYPE_FILTER
 = 'filter';

31 cÚ¡ 
	mAUTOFILTER_RULETYPE_DATEGROUP
 = 'dateGroupItem';

32 cÚ¡ 
	mAUTOFILTER_RULETYPE_CUSTOMFILTER
 = 'customFilter';

33 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMICFILTER
 = 'dynamicFilter';

34 cÚ¡ 
	mAUTOFILTER_RULETYPE_TOPTENFILTER
 = 'top10Filter';

36 
´iv©e
 
	m$ruËTy³s
 = 
¬¿y
(

41 
£lf
::
AUTOFILTER_RULETYPE_FILTER
,

42 
£lf
::
AUTOFILTER_RULETYPE_DATEGROUP
,

43 
£lf
::
AUTOFILTER_RULETYPE_CUSTOMFILTER
,

44 
£lf
::
AUTOFILTER_RULETYPE_DYNAMICFILTER
,

45 
£lf
::
AUTOFILTER_RULETYPE_TOPTENFILTER
,

48 cÚ¡ 
	mAUTOFILTER_RULETYPE_DATEGROUP_YEAR
 = 'year';

49 cÚ¡ 
	mAUTOFILTER_RULETYPE_DATEGROUP_MONTH
 = 'month';

50 cÚ¡ 
	mAUTOFILTER_RULETYPE_DATEGROUP_DAY
 = 'day';

51 cÚ¡ 
	mAUTOFILTER_RULETYPE_DATEGROUP_HOUR
 = 'hour';

52 cÚ¡ 
	mAUTOFILTER_RULETYPE_DATEGROUP_MINUTE
 = 'minute';

53 cÚ¡ 
	mAUTOFILTER_RULETYPE_DATEGROUP_SECOND
 = 'second';

55 
´iv©e
 
	m$d©eTimeGroups
 = 
¬¿y
(

56 
£lf
::
AUTOFILTER_RULETYPE_DATEGROUP_YEAR
,

57 
£lf
::
AUTOFILTER_RULETYPE_DATEGROUP_MONTH
,

58 
£lf
::
AUTOFILTER_RULETYPE_DATEGROUP_DAY
,

59 
£lf
::
AUTOFILTER_RULETYPE_DATEGROUP_HOUR
,

60 
£lf
::
AUTOFILTER_RULETYPE_DATEGROUP_MINUTE
,

61 
£lf
::
AUTOFILTER_RULETYPE_DATEGROUP_SECOND
,

64 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_YESTERDAY
 = 'yesterday';

65 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_TODAY
 = 'today';

66 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_TOMORROW
 = 'tomorrow';

67 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_YEARTODATE
 = 'yearToDate';

68 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_THISYEAR
 = 'thisYear';

69 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_THISQUARTER
 = 'thisQuarter';

70 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_THISMONTH
 = 'thisMonth';

71 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_THISWEEK
 = 'thisWeek';

72 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_LASTYEAR
 = 'lastYear';

73 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_LASTQUARTER
 = 'lastQuarter';

74 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_LASTMONTH
 = 'lastMonth';

75 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_LASTWEEK
 = 'lastWeek';

76 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_NEXTYEAR
 = 'nextYear';

77 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_NEXTQUARTER
 = 'nextQuarter';

78 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_NEXTMONTH
 = 'nextMonth';

79 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_NEXTWEEK
 = 'nextWeek';

80 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_1
 = 'M1';

81 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_JANUARY
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_1
;

82 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_2
 = 'M2';

83 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_FEBRUARY
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_2
;

84 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_3
 = 'M3';

85 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MARCH
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_3
;

86 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_4
 = 'M4';

87 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_APRIL
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_4
;

88 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_5
 = 'M5';

89 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MAY
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_5
;

90 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_6
 = 'M6';

91 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_JUNE
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_6
;

92 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_7
 = 'M7';

93 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_JULY
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_7
;

94 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_8
 = 'M8';

95 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_AUGUST
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_8
;

96 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_9
 = 'M9';

97 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_SEPTEMBER
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_9
;

98 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_10
 = 'M10';

99 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_OCTOBER
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_10
;

100 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_11
 = 'M11';

101 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_NOVEMBER
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_11
;

102 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_MONTH_12
 = 'M12';

103 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_DECEMBER
 = 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_12
;

104 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_QUARTER_1
 = 'Q1';

105 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_QUARTER_2
 = 'Q2';

106 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_QUARTER_3
 = 'Q3';

107 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_QUARTER_4
 = 'Q4';

108 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_ABOVEAVERAGE
 = 'aboveAverage';

109 cÚ¡ 
	mAUTOFILTER_RULETYPE_DYNAMIC_BELOWAVERAGE
 = 'belowAverage';

111 
´iv©e
 
	m$dyÇmicTy³s
 = 
¬¿y
(

112 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_YESTERDAY
,

113 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_TODAY
,

114 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_TOMORROW
,

115 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_YEARTODATE
,

116 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_THISYEAR
,

117 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_THISQUARTER
,

118 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_THISMONTH
,

119 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_THISWEEK
,

120 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTYEAR
,

121 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTQUARTER
,

122 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTMONTH
,

123 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_LASTWEEK
,

124 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTYEAR
,

125 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTQUARTER
,

126 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTMONTH
,

127 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_NEXTWEEK
,

128 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_1
,

129 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_2
,

130 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_3
,

131 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_4
,

132 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_5
,

133 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_6
,

134 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_7
,

135 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_8
,

136 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_9
,

137 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_10
,

138 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_11
,

139 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_MONTH_12
,

140 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_QUARTER_1
,

141 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_QUARTER_2
,

142 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_QUARTER_3
,

143 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_QUARTER_4
,

144 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_ABOVEAVERAGE
,

145 
£lf
::
AUTOFILTER_RULETYPE_DYNAMIC_BELOWAVERAGE
,

157 cÚ¡ 
	mAUTOFILTER_COLUMN_RULE_EQUAL
 = 'equal';

158 cÚ¡ 
	mAUTOFILTER_COLUMN_RULE_NOTEQUAL
 = 'notEqual';

159 cÚ¡ 
	mAUTOFILTER_COLUMN_RULE_GREATERTHAN
 = 'greaterThan';

160 cÚ¡ 
	mAUTOFILTER_COLUMN_RULE_GREATERTHANOREQUAL
 = 'greaterThanOrEqual';

161 cÚ¡ 
	mAUTOFILTER_COLUMN_RULE_LESSTHAN
 = 'lessThan';

162 cÚ¡ 
	mAUTOFILTER_COLUMN_RULE_LESSTHANOREQUAL
 = 'lessThanOrEqual';

164 
´iv©e
 
	m$İ”©Üs
 = 
¬¿y
(

165 
£lf
::
AUTOFILTER_COLUMN_RULE_EQUAL
,

166 
£lf
::
AUTOFILTER_COLUMN_RULE_NOTEQUAL
,

167 
£lf
::
AUTOFILTER_COLUMN_RULE_GREATERTHAN
,

168 
£lf
::
AUTOFILTER_COLUMN_RULE_GREATERTHANOREQUAL
,

169 
£lf
::
AUTOFILTER_COLUMN_RULE_LESSTHAN
,

170 
£lf
::
AUTOFILTER_COLUMN_RULE_LESSTHANOREQUAL
,

173 cÚ¡ 
	mAUTOFILTER_COLUMN_RULE_TOPTEN_BY_VALUE
 = 'byValue';

174 cÚ¡ 
	mAUTOFILTER_COLUMN_RULE_TOPTEN_PERCENT
 = 'byPercent';

176 
´iv©e
 
	m$tİT’V®ue
 = 
¬¿y
(

177 
£lf
::
AUTOFILTER_COLUMN_RULE_TOPTEN_BY_VALUE
,

178 
£lf
::
AUTOFILTER_COLUMN_RULE_TOPTEN_PERCENT
,

181 cÚ¡ 
	mAUTOFILTER_COLUMN_RULE_TOPTEN_TOP
 = 'top';

182 cÚ¡ 
	mAUTOFILTER_COLUMN_RULE_TOPTEN_BOTTOM
 = 'bottom';

184 
´iv©e
 
	m$tİT’Ty³
 = 
¬¿y
(

185 
£lf
::
AUTOFILTER_COLUMN_RULE_TOPTEN_TOP
,

186 
£lf
::
AUTOFILTER_COLUMN_RULE_TOPTEN_BOTTOM
,

229 
´iv©e
 
	m$·»Á
 = 
nuÎ
;

237 
´iv©e
 
	m$ruËTy³
 = 
£lf
::
AUTOFILTER_RULETYPE_FILTER
;

245 
´iv©e
 
	m$v®ue
 = '';

252 
´iv©e
 
	m$İ”©Ü
 = 
£lf
::
AUTOFILTER_COLUMN_RULE_EQUAL
;

259 
´iv©e
 
	m$groupšg
 = '';

267 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
 
$pP¬’t
 = 
nuÎ
)

269 
$this
->
·»Á
 = 
$pP¬’t
;

277 
public
 
funùiÚ
 
	$g‘RuËTy³
()

279  
$this
->
ruËTy³
;

280 
	}
}

289 
public
 
funùiÚ
 
	$£tRuËTy³
(
$pRuËTy³
 = 
£lf
::
AUTOFILTER_RULETYPE_FILTER
)

291 ià(!
	`š_¬¿y
(
$pRuËTy³
, 
£lf
::
$ruËTy³s
)) {

292 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid„uleype for column AutoFilter Rule.');

295 
$this
->
ruËTy³
 = 
$pRuËTy³
;

297  
$this
;

298 
	}
}

305 
public
 
funùiÚ
 
	$g‘V®ue
()

307  
$this
->
v®ue
;

308 
	}
}

317 
public
 
funùiÚ
 
£tV®ue
(
$pV®ue
 = '')

319 ià(
is_¬¿y
(
$pV®ue
)) {

320 
$groupšg
 = -1;

321 
fÜ—ch
 (
$pV®ue
 
as
 
$key
 => 
$v®ue
) {

323 ià(!
š_¬¿y
(
$key
, 
£lf
::
$d©eTimeGroups
)) {

325 
un£t
(
$pV®ue
[
$key
]);

328 
	g$groupšg
 = 
max
(
$groupšg
, 
¬¿y_£¬ch
(
$key
, 
£lf
::
$d©eTimeGroups
));

331 ià(
couÁ
(
$pV®ue
) == 0) {

332 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('Invalid„ule value for column AutoFilter Rule.');

335 
	g$this
->
£tGroupšg
(
£lf
::
$d©eTimeGroups
[
$groupšg
]);

337 
	g$this
->
	gv®ue
 = 
$pV®ue
;

339  
	g$this
;

347 
public
 
funùiÚ
 
	$g‘O³¿tÜ
()

349  
$this
->
İ”©Ü
;

350 
	}
}

359 
public
 
funùiÚ
 
	$£tO³¿tÜ
(
$pO³¿tÜ
 = 
£lf
::
AUTOFILTER_COLUMN_RULE_EQUAL
)

361 ià(
	`em±y
(
$pO³¿tÜ
)) {

362 
$pO³¿tÜ
 = 
£lf
::
AUTOFILTER_COLUMN_RULE_EQUAL
;

364 ià((!
	`š_¬¿y
(
$pO³¿tÜ
, 
£lf
::
$İ”©Üs
)) &&

365 (!
	`š_¬¿y
(
$pO³¿tÜ
, 
£lf
::
$tİT’V®ue
))) {

366 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid operator for column AutoFilter Rule.');

368 
$this
->
İ”©Ü
 = 
$pO³¿tÜ
;

370  
$this
;

371 
	}
}

378 
public
 
funùiÚ
 
	$g‘Groupšg
()

380  
$this
->
groupšg
;

381 
	}
}

390 
public
 
funùiÚ
 
	$£tGroupšg
(
$pGroupšg
 = 
nuÎ
)

392 ià((
$pGroupšg
 !=ğ
nuÎ
) &&

393 (!
	`š_¬¿y
(
$pGroupšg
, 
£lf
::
$d©eTimeGroups
)) &&

394 (!
	`š_¬¿y
(
$pGroupšg
, 
£lf
::
$dyÇmicTy³s
)) &&

395 (!
	`š_¬¿y
(
$pGroupšg
, 
£lf
::
$tİT’Ty³
))) {

396 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid„uleype for column AutoFilter Rule.');

398 
$this
->
groupšg
 = 
$pGroupšg
;

400  
$this
;

401 
	}
}

412 
public
 
funùiÚ
 
£tRuË
(
$pO³¿tÜ
 = 
£lf
::
AUTOFILTER_COLUMN_RULE_EQUAL
, 
$pV®ue
 = '', 
$pGroupšg
 = 
nuÎ
)

414 
$this
->
£tO³¿tÜ
(
$pO³¿tÜ
);

415 
	g$this
->
£tV®ue
(
$pV®ue
);

419 ià(
	g$pGroupšg
 !=ğ
nuÎ
) {

420 
$this
->
£tGroupšg
(
$pGroupšg
);

423  
	g$this
;

431 
public
 
funùiÚ
 
	$g‘P¬’t
()

433  
$this
->
·»Á
;

434 
	}
}

442 
public
 
funùiÚ
 
	$£tP¬’t
(
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
 
$pP¬’t
 = 
nuÎ
)

444 
$this
->
·»Á
 = 
$pP¬’t
;

446  
$this
;

447 
	}
}

452 
public
 
funùiÚ
 
	$__şÚe
()

454 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

455 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

456 ià(
	`is_objeù
(
$v®ue
)) {

457 ià(
$key
 == 'parent') {

459 
$this
->
$key
 = 
nuÎ
;

461 
$this
->
$key
 = 
şÚe
 
$v®ue
;

464 
$this
->
$key
 = 
$v®ue
;

467 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/BaseDrawing.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_Ba£D¿wšg
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


35 
´iv©e
 
	m$imageCouÁ”
 = 0;

42 
´iv©e
 
	m$imageIndex
 = 0;

49 
´Ùeùed
 
	m$Çme
;

56 
´Ùeùed
 
	m$desütiÚ
;

63 
´Ùeùed
 
	m$wÜksh“t
;

70 
´Ùeùed
 
	m$coÜdš©es
;

77 
´Ùeùed
 
	m$off£tX
;

84 
´Ùeùed
 
	m$off£tY
;

91 
´Ùeùed
 
	m$width
;

98 
´Ùeùed
 
	m$height
;

105 
´Ùeùed
 
	m$»sizePrİÜtiÚ®
;

112 
´Ùeùed
 
	m$rÙ©iÚ
;

119 
´Ùeùed
 
	m$shadow
;

124 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

127 
$this
->
Çme
 = '';

128 
$this
->
desütiÚ
 = '';

129 
$this
->
wÜksh“t
 = 
nuÎ
;

130 
$this
->
coÜdš©es
 = 'A1';

131 
$this
->
off£tX
 = 0;

132 
$this
->
off£tY
 = 0;

133 
$this
->
width
 = 0;

134 
$this
->
height
 = 0;

135 
$this
->
»sizePrİÜtiÚ®
 = 
Œue
;

136 
$this
->
rÙ©iÚ
 = 0;

137 
$this
->
shadow
 = 
Ãw
 
	`PHPExûl_WÜksh“t_D¿wšg_Shadow
();

140 
£lf
::
$imageCouÁ”
++;

141 
$this
->
imageIndex
 = 
£lf
::
$imageCouÁ”
;

149 
public
 
funùiÚ
 
	$g‘ImageIndex
()

151  
$this
->
imageIndex
;

152 
	}
}

159 
public
 
funùiÚ
 
	$g‘Name
()

161  
$this
->
Çme
;

162 
	}
}

170 
public
 
funùiÚ
 
£tName
(
$pV®ue
 = '')

172 
$this
->
Çme
 = 
$pV®ue
;

173  
	g$this
;

181 
public
 
funùiÚ
 
	$g‘DesütiÚ
()

183  
$this
->
desütiÚ
;

184 
	}
}

192 
public
 
funùiÚ
 
£tDesütiÚ
(
$pV®ue
 = '')

194 
$this
->
desütiÚ
 = 
$pV®ue
;

195  
	g$this
;

203 
public
 
funùiÚ
 
	$g‘WÜksh“t
()

205  
$this
->
wÜksh“t
;

206 
	}
}

216 
public
 
funùiÚ
 
	$£tWÜksh“t
(
PHPExûl_WÜksh“t
 
$pV®ue
 = 
nuÎ
, 
$pOv”rideOld
 = 
çl£
)

218 ià(
	`is_nuÎ
(
$this
->
wÜksh“t
)) {

220 
$this
->
wÜksh“t
 = 
$pV®ue
;

221 
$this
->
wÜksh“t
->
	`g‘C–l
($this->
coÜdš©es
);

222 
$this
->
wÜksh“t
->
	`g‘D¿wšgCŞËùiÚ
()->
	`­³nd
($this);

224 ià(
$pOv”rideOld
) {

226 
$™”©Ü
 = 
$this
->
wÜksh“t
->
	`g‘D¿wšgCŞËùiÚ
()->
	`g‘I‹¿tÜ
();

228 
$™”©Ü
->
	`v®id
()) {

229 ià(
$™”©Ü
->
	`cu¼’t
()->
	`g‘HashCode
(è=ğ
$this
->getHashCode()) {

230 
$this
->
wÜksh“t
->
	`g‘D¿wšgCŞËùiÚ
()->
	`off£tUn£t
(
$™”©Ü
->
	`key
());

231 
$this
->
wÜksh“t
 = 
nuÎ
;

237 
$this
->
	`£tWÜksh“t
(
$pV®ue
);

239 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("A PHPExcel_Worksheet has‡lready been‡ssigned. Drawings can onlyƒxist on one PHPExcel_Worksheet.");

242  
$this
;

243 
	}
}

250 
public
 
funùiÚ
 
	$g‘CoÜdš©es
()

252  
$this
->
coÜdš©es
;

253 
	}
}

261 
public
 
funùiÚ
 
£tCoÜdš©es
(
$pV®ue
 = 'A1')

263 
$this
->
coÜdš©es
 = 
$pV®ue
;

264  
	g$this
;

272 
public
 
funùiÚ
 
	$g‘Off£tX
()

274  
$this
->
off£tX
;

275 
	}
}

283 
public
 
funùiÚ
 
	$£tOff£tX
(
$pV®ue
 = 0)

285 
$this
->
off£tX
 = 
$pV®ue
;

286  
$this
;

287 
	}
}

294 
public
 
funùiÚ
 
	$g‘Off£tY
()

296  
$this
->
off£tY
;

297 
	}
}

305 
public
 
funùiÚ
 
	$£tOff£tY
(
$pV®ue
 = 0)

307 
$this
->
off£tY
 = 
$pV®ue
;

308  
$this
;

309 
	}
}

316 
public
 
funùiÚ
 
	$g‘Width
()

318  
$this
->
width
;

319 
	}
}

327 
public
 
funùiÚ
 
	$£tWidth
(
$pV®ue
 = 0)

330 ià(
$this
->
»sizePrİÜtiÚ®
 && 
$pV®ue
 != 0) {

331 
$¿tio
 = 
$this
->
height
 / ($this->
width
 != 0 ? $this->width : 1);

332 
$this
->
height
 = 
	`round
(
$¿tio
 * 
$pV®ue
);

336 
$this
->
width
 = 
$pV®ue
;

338  
$this
;

339 
	}
}

346 
public
 
funùiÚ
 
	$g‘Height
()

348  
$this
->
height
;

349 
	}
}

357 
public
 
funùiÚ
 
	$£tHeight
(
$pV®ue
 = 0)

360 ià(
$this
->
»sizePrİÜtiÚ®
 && 
$pV®ue
 != 0) {

361 
$¿tio
 = 
$this
->
width
 / ($this->
height
 != 0 ? $this->height : 1);

362 
$this
->
width
 = 
	`round
(
$¿tio
 * 
$pV®ue
);

366 
$this
->
height
 = 
$pV®ue
;

368  
$this
;

369 
	}
}

384 
public
 
funùiÚ
 
	$£tWidthAndHeight
(
$width
 = 0, 
$height
 = 0)

386 
$x¿tio
 = 
$width
 / (
$this
->
width
 != 0 ? $this->width : 1);

387 
$y¿tio
 = 
$height
 / (
$this
->
height
 != 0 ? $this->height : 1);

388 ià(
$this
->
»sizePrİÜtiÚ®
 && !(
$width
 =ğ0 || 
$height
 == 0)) {

389 ià((
$x¿tio
 * 
$this
->
height
è< 
$height
) {

390 
$this
->
height
 = 
	`û
(
$x¿tio
 * $this->height);

391 
$this
->
width
 = 
$width
;

393 
$this
->
width
 = 
	`û
(
$y¿tio
 * $this->width);

394 
$this
->
height
 = 
$height
;

397 
$this
->
width
 = 
$width
;

398 
$this
->
height
 = 
$height
;

401  
$this
;

402 
	}
}

409 
public
 
funùiÚ
 
	$g‘ResizePrİÜtiÚ®
()

411  
$this
->
»sizePrİÜtiÚ®
;

412 
	}
}

420 
public
 
funùiÚ
 
	$£tResizePrİÜtiÚ®
(
$pV®ue
 = 
Œue
)

422 
$this
->
»sizePrİÜtiÚ®
 = 
$pV®ue
;

423  
$this
;

424 
	}
}

431 
public
 
funùiÚ
 
	$g‘RÙ©iÚ
()

433  
$this
->
rÙ©iÚ
;

434 
	}
}

442 
public
 
funùiÚ
 
	$£tRÙ©iÚ
(
$pV®ue
 = 0)

444 
$this
->
rÙ©iÚ
 = 
$pV®ue
;

445  
$this
;

446 
	}
}

453 
public
 
funùiÚ
 
	$g‘Shadow
()

455  
$this
->
shadow
;

456 
	}
}

465 
public
 
funùiÚ
 
	$£tShadow
(
PHPExûl_WÜksh“t_D¿wšg_Shadow
 
$pV®ue
 = 
nuÎ
)

467 
$this
->
shadow
 = 
$pV®ue
;

468  
$this
;

469 
	}
}

476 
public
 
funùiÚ
 
	$g‘HashCode
()

478  
	`md5
(

479 
$this
->
Çme
 .

480 
$this
->
desütiÚ
 .

481 
$this
->
wÜksh“t
->
	`g‘HashCode
() .

482 
$this
->
coÜdš©es
 .

483 
$this
->
off£tX
 .

484 
$this
->
off£tY
 .

485 
$this
->
width
 .

486 
$this
->
height
 .

487 
$this
->
rÙ©iÚ
 .

488 
$this
->
shadow
->
	`g‘HashCode
() .

489 
__CLASS__


491 
	}
}

496 
public
 
funùiÚ
 
	$__şÚe
()

498 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

499 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

500 ià(
	`is_objeù
(
$v®ue
)) {

501 
$this
->
$key
 = 
şÚe
 
$v®ue
;

503 
$this
->
$key
 = 
$v®ue
;

506 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/CellIterator.php

1 <?
php


28 
ab¡¿ù
 cÏs 
	cPHPExûl_WÜksh“t_C–lI‹¿tÜ


35 
´Ùeùed
 
	m$subjeù
;

42 
´Ùeùed
 
	m$pos™iÚ
 = 
nuÎ
;

49 
´Ùeùed
 
	m$ÚlyExi¡šgC–ls
 = 
çl£
;

54 
public
 
funùiÚ
 
	$__de¡ruù
()

56 
	`un£t
(
$this
->
subjeù
);

64 
public
 
funùiÚ
 
	$g‘I‹¿‹OÆyExi¡šgC–ls
()

66  
$this
->
ÚlyExi¡šgC–ls
;

67 
	}
}

74 
ab¡¿ù
 
´Ùeùed
 
funùiÚ
 
adju¡FÜExi¡šgOÆyRªge
();

82 
public
 
funùiÚ
 
	$£tI‹¿‹OÆyExi¡šgC–ls
(
$v®ue
 = 
Œue
)

84 
$this
->
ÚlyExi¡šgC–ls
 = (
boŞ—n
è
$v®ue
;

86 
$this
->
	`adju¡FÜExi¡šgOÆyRªge
();

87 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Column.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_CŞumn


35 
´iv©e
 
	m$·»Á
;

42 
´iv©e
 
	m$cŞumnIndex
;

50 
public
 
funùiÚ
 
__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$·»Á
 = 
nuÎ
, 
$cŞumnIndex
 = 'A')

53 
$this
->
·»Á
 = 
$·»Á
;

54 
	m$this
->
	mcŞumnIndex
 = 
$cŞumnIndex
;

60 
public
 
funùiÚ
 
	$__de¡ruù
()

62 
	`un£t
(
$this
->
·»Á
);

63 
	}
}

70 
public
 
funùiÚ
 
	$g‘CŞumnIndex
()

72  
$this
->
cŞumnIndex
;

73 
	}
}

82 
public
 
funùiÚ
 
	$g‘C–lI‹¿tÜ
(
$¡¬tRow
 = 1, 
$’dRow
 = 
nuÎ
)

84  
Ãw
 
	`PHPExûl_WÜksh“t_CŞumnC–lI‹¿tÜ
(
$this
->
·»Á
, $this->
cŞumnIndex
, 
$¡¬tRow
, 
$’dRow
);

85 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/ColumnCellIterator.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_CŞumnC–lI‹¿tÜ
 
ex‹nds
 
PHPExûl_WÜksh“t_C–lI‹¿tÜ
 
im¶em’ts
 
	mI‹¿tÜ


35 
´Ùeùed
 
	m$cŞumnIndex
;

42 
´Ùeùed
 
	m$¡¬tRow
 = 1;

49 
´Ùeùed
 
	m$’dRow
 = 1;

59 
public
 
funùiÚ
 
__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$subjeù
 = 
nuÎ
, 
$cŞumnIndex
 = 'A', 
$¡¬tRow
 = 1, 
$’dRow
 =‚ull)

62 
$this
->
subjeù
 = 
$subjeù
;

63 
	m$this
->
	mcŞumnIndex
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$cŞumnIndex
) - 1;

64 
	m$this
->
»£tEnd
(
$’dRow
);

65 
	m$this
->
»£tS¹
(
$¡¬tRow
);

71 
public
 
funùiÚ
 
	$__de¡ruù
()

73 
	`un£t
(
$this
->
subjeù
);

74 
	}
}

83 
public
 
funùiÚ
 
	$»£tS¹
(
$¡¬tRow
 = 1)

85 
$this
->
¡¬tRow
 = 
$¡¬tRow
;

86 
$this
->
	`adju¡FÜExi¡šgOÆyRªge
();

87 
$this
->
	`£ek
(
$¡¬tRow
);

89  
$this
;

90 
	}
}

99 
public
 
funùiÚ
 
	$»£tEnd
(
$’dRow
 = 
nuÎ
)

101 
$this
->
’dRow
 = (
$’dRow
è? $’dRow : $this->
subjeù
->
	`g‘Highe¡Row
();

102 
$this
->
	`adju¡FÜExi¡šgOÆyRªge
();

104  
$this
;

105 
	}
}

114 
public
 
funùiÚ
 
	$£ek
(
$row
 = 1)

116 ià((
$row
 < 
$this
->
¡¬tRow
è|| ($row > $this->
’dRow
)) {

117 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Row $row is out of„ange ({$this->startRow} - {$this->endRow})");

118 } 
	`–£if
 (
$this
->
ÚlyExi¡šgC–ls
 && !($this->
subjeù
->
	`ûÎExi¡sByCŞumnAndRow
($this->
cŞumnIndex
, 
$row
))) {

119 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('In "IterateOnlyExistingCells" mode‡nd Cell does‚otƒxist');

121 
$this
->
pos™iÚ
 = 
$row
;

123  
$this
;

124 
	}
}

129 
public
 
funùiÚ
 
	$»wšd
()

131 
$this
->
pos™iÚ
 = $this->
¡¬tRow
;

132 
	}
}

139 
public
 
funùiÚ
 
	$cu¼’t
()

141  
$this
->
subjeù
->
	`g‘C–lByCŞumnAndRow
($this->
cŞumnIndex
, $this->
pos™iÚ
);

142 
	}
}

149 
public
 
funùiÚ
 
	$key
()

151  
$this
->
pos™iÚ
;

152 
	}
}

157 
public
 
funùiÚ
 
	$Ãxt
()

160 ++
$this
->
pos™iÚ
;

161 } (
$this
->
ÚlyExi¡šgC–ls
) &&

162 (!
$this
->
subjeù
->
	`ûÎExi¡sByCŞumnAndRow
($this->
cŞumnIndex
, $this->
pos™iÚ
)) &&

163 (
$this
->
pos™iÚ
 <ğ$this->
’dRow
));

164 
	}
}

169 
public
 
funùiÚ
 
	$´ev
()

171 ià(
$this
->
pos™iÚ
 <ğ$this->
¡¬tRow
) {

172 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Row is‡lready‡the beginning of„ange ({$this->startRow} - {$this->endRow})");

176 --
$this
->
pos™iÚ
;

177 } (
$this
->
ÚlyExi¡šgC–ls
) &&

178 (!
$this
->
subjeù
->
	`ûÎExi¡sByCŞumnAndRow
($this->
cŞumnIndex
, $this->
pos™iÚ
)) &&

179 (
$this
->
pos™iÚ
 >ğ$this->
¡¬tRow
));

180 
	}
}

187 
public
 
funùiÚ
 
	$v®id
()

189  
$this
->
pos™iÚ
 <ğ$this->
’dRow
;

190 
	}
}

197 
´Ùeùed
 
funùiÚ
 
	$adju¡FÜExi¡šgOÆyRªge
()

199 ià(
$this
->
ÚlyExi¡šgC–ls
) {

200 (!
$this
->
subjeù
->
	`ûÎExi¡sByCŞumnAndRow
($this->
cŞumnIndex
, $this->
¡¬tRow
)) &&

201 (
$this
->
¡¬tRow
 <ğ$this->
’dRow
)) {

202 ++
$this
->
¡¬tRow
;

204 ià(
$this
->
¡¬tRow
 > $this->
’dRow
) {

205 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('No cellsƒxist withinhe specified„ange');

207 (!
$this
->
subjeù
->
	`ûÎExi¡sByCŞumnAndRow
($this->
cŞumnIndex
, $this->
’dRow
)) &&

208 (
$this
->
’dRow
 >ğ$this->
¡¬tRow
)) {

209 --
$this
->
’dRow
;

211 ià(
$this
->
’dRow
 < $this->
¡¬tRow
) {

212 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('No cellsƒxist withinhe specified„ange');

215 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/ColumnDimension.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_CŞumnDim’siÚ
 
ex‹nds
 
	mPHPExûl_WÜksh“t_Dim’siÚ


35 
´iv©e
 
	m$cŞumnIndex
;

44 
´iv©e
 
	m$width
 = -1;

51 
´iv©e
 
	m$autoSize
 = 
çl£
;

58 
public
 
funùiÚ
 
__cÚ¡ruù
(
$pIndex
 = 'A')

61 
$this
->
cŞumnIndex
 = 
$pIndex
;

64 
	m·»Á
::
__cÚ¡ruù
(0);

72 
public
 
funùiÚ
 
	$g‘CŞumnIndex
()

74  
$this
->
cŞumnIndex
;

75 
	}
}

83 
public
 
funùiÚ
 
	$£tCŞumnIndex
(
$pV®ue
)

85 
$this
->
cŞumnIndex
 = 
$pV®ue
;

86  
$this
;

87 
	}
}

94 
public
 
funùiÚ
 
	$g‘Width
()

96  
$this
->
width
;

97 
	}
}

105 
public
 
funùiÚ
 
£tWidth
(
$pV®ue
 = -1)

107 
$this
->
width
 = 
$pV®ue
;

108  
	g$this
;

116 
public
 
funùiÚ
 
	$g‘AutoSize
()

118  
$this
->
autoSize
;

119 
	}
}

127 
public
 
funùiÚ
 
	$£tAutoSize
(
$pV®ue
 = 
çl£
)

129 
$this
->
autoSize
 = 
$pV®ue
;

130  
$this
;

131 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/ColumnIterator.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_CŞumnI‹¿tÜ
 
im¶em’ts
 
	mI‹¿tÜ


35 
´iv©e
 
	m$subjeù
;

42 
´iv©e
 
	m$pos™iÚ
 = 0;

49 
´iv©e
 
	m$¡¬tCŞumn
 = 0;

57 
´iv©e
 
	m$’dCŞumn
 = 0;

67 
public
 
funùiÚ
 
__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$subjeù
 = 
nuÎ
, 
$¡¬tCŞumn
 = 'A', 
$’dCŞumn
 =‚ull)

70 
$this
->
subjeù
 = 
$subjeù
;

71 
	m$this
->
»£tEnd
(
$’dCŞumn
);

72 
	m$this
->
»£tS¹
(
$¡¬tCŞumn
);

78 
public
 
funùiÚ
 
	$__de¡ruù
()

80 
	`un£t
(
$this
->
subjeù
);

81 
	}
}

89 
public
 
funùiÚ
 
»£tS¹
(
$¡¬tCŞumn
 = 'A')

91 
$¡¬tCŞumnIndex
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$¡¬tCŞumn
) - 1;

92 
	g$this
->
	g¡¬tCŞumn
 = 
$¡¬tCŞumnIndex
;

93 
	g$this
->
£ek
(
$¡¬tCŞumn
);

95  
	g$this
;

104 
public
 
funùiÚ
 
	$»£tEnd
(
$’dCŞumn
 = 
nuÎ
)

106 
$’dCŞumn
 = ($’dCŞumnè? $’dCŞumÀ: 
$this
->
subjeù
->
	`g‘Highe¡CŞumn
();

107 
$this
->
’dCŞumn
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$’dCŞumn
) - 1;

109  
$this
;

110 
	}
}

119 
public
 
funùiÚ
 
£ek
(
$cŞumn
 = 'A')

121 
$cŞumn
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
($column) - 1;

122 ià((
	g$cŞumn
 < 
	g$this
->
	g¡¬tCŞumn
è|| ($cŞumÀ> $this->
	g’dCŞumn
)) {

123 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
("Column $column is out of„ange ({$this->startColumn} - {$this->endColumn})");

125 
	g$this
->
	gpos™iÚ
 = 
$cŞumn
;

127  
	g$this
;

133 
public
 
funùiÚ
 
	$»wšd
()

135 
$this
->
pos™iÚ
 = $this->
¡¬tCŞumn
;

136 
	}
}

143 
public
 
funùiÚ
 
	$cu¼’t
()

145  
Ãw
 
	`PHPExûl_WÜksh“t_CŞumn
(
$this
->
subjeù
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($this->
pos™iÚ
));

146 
	}
}

153 
public
 
funùiÚ
 
	$key
()

155  
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$this
->
pos™iÚ
);

156 
	}
}

161 
public
 
funùiÚ
 
	$Ãxt
()

163 ++
$this
->
pos™iÚ
;

164 
	}
}

171 
public
 
funùiÚ
 
	$´ev
()

173 ià(
$this
->
pos™iÚ
 <ğ$this->
¡¬tCŞumn
) {

174 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(

176 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$this
->
’dCŞumn
) . " - " .

177 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$this
->
’dCŞumn
) . ")"

181 --
$this
->
pos™iÚ
;

182 
	}
}

189 
public
 
funùiÚ
 
	$v®id
()

191  
$this
->
pos™iÚ
 <ğ$this->
’dCŞumn
;

192 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Dimension.php

1 <?
php


28 
ab¡¿ù
 cÏs 
	cPHPExûl_WÜksh“t_Dim’siÚ


35 
´iv©e
 
	m$visibË
 = 
Œue
;

42 
´iv©e
 
	m$oušeLev–
 = 0;

49 
´iv©e
 
	m$cŞÏp£d
 = 
çl£
;

56 
´iv©e
 
	m$xfIndex
;

63 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$š™ŸlV®ue
 = 
nuÎ
)

66 
$this
->
xfIndex
 = 
$š™ŸlV®ue
;

74 
public
 
funùiÚ
 
	$g‘VisibË
()

76  
$this
->
visibË
;

77 
	}
}

85 
public
 
funùiÚ
 
	$£tVisibË
(
$pV®ue
 = 
Œue
)

87 
$this
->
visibË
 = 
$pV®ue
;

88  
$this
;

89 
	}
}

96 
public
 
funùiÚ
 
	$g‘OušeLev–
()

98  
$this
->
oušeLev–
;

99 
	}
}

110 
public
 
funùiÚ
 
	$£tOušeLev–
(
$pV®ue
)

112 ià(
$pV®ue
 < 0 || $pValue > 7) {

113 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Outline†evel must„ange between 0‡nd 7.");

116 
$this
->
oušeLev–
 = 
$pV®ue
;

117  
$this
;

118 
	}
}

125 
public
 
funùiÚ
 
	$g‘CŞÏp£d
()

127  
$this
->
cŞÏp£d
;

128 
	}
}

136 
public
 
funùiÚ
 
	$£tCŞÏp£d
(
$pV®ue
 = 
Œue
)

138 
$this
->
cŞÏp£d
 = 
$pV®ue
;

139  
$this
;

140 
	}
}

147 
public
 
funùiÚ
 
	$g‘XfIndex
()

149  
$this
->
xfIndex
;

150 
	}
}

158 
public
 
funùiÚ
 
	$£tXfIndex
(
$pV®ue
 = 0)

160 
$this
->
xfIndex
 = 
$pV®ue
;

161  
$this
;

162 
	}
}

167 
public
 
funùiÚ
 
	$__şÚe
()

169 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

170 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

171 ià(
	`is_objeù
(
$v®ue
)) {

172 
$this
->
$key
 = 
şÚe
 
$v®ue
;

174 
$this
->
$key
 = 
$v®ue
;

177 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Drawing.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_D¿wšg
 
ex‹nds
 
PHPExûl_WÜksh“t_Ba£D¿wšg
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


35 
´iv©e
 
	m$·th
;

40 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

43 
$this
->
·th
 = '';

46 
·»Á
::
	`__cÚ¡ruù
();

54 
public
 
funùiÚ
 
	$g‘F’ame
()

56  
	`ba£Çme
(
$this
->
·th
);

57 
	}
}

64 
public
 
funùiÚ
 
	$g‘IndexedF’ame
()

66 
$feName
 = 
$this
->
	`g‘F’ame
();

67 
$feName
 = 
	`¡r_»¶aû
(' ', '_', $fileName);

68  
	`¡r_»¶aû
('.' . 
$this
->
	`g‘Ex‹nsiÚ
(), '', 
$feName
è. $this->
	`g‘ImageIndex
() . '.' . $this->getExtension();

69 
	}
}

76 
public
 
funùiÚ
 
	$g‘Ex‹nsiÚ
()

78 
$ex¶oded
 = 
	`ex¶ode
(".", 
	`ba£Çme
(
$this
->
·th
));

79  
$ex¶oded
[
	`couÁ
($exploded) - 1];

80 
	}
}

87 
public
 
funùiÚ
 
	$g‘P©h
()

89  
$this
->
·th
;

90 
	}
}

100 
public
 
funùiÚ
 
£tP©h
(
$pV®ue
 = '', 
$pV”ifyFe
 = 
Œue
)

102 ià(
$pV”ifyFe
) {

103 ià(
fe_exi¡s
(
$pV®ue
)) {

104 
$this
->
·th
 = 
$pV®ue
;

106 ià(
	g$this
->
	gwidth
 =ğ0 && 
$this
->
height
 == 0) {

108 
li¡
(
$this
->
width
, $this->
height
èğ
g‘imagesize
(
$pV®ue
);

111 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
("File $pValue‚ot found!");

114 
	g$this
->
	g·th
 = 
$pV®ue
;

116  
	g$this
;

124 
public
 
funùiÚ
 
	$g‘HashCode
()

126  
	`md5
(

127 
$this
->
·th
 .

128 
·»Á
::
	`g‘HashCode
() .

129 
__CLASS__


131 
	}
}

136 
public
 
funùiÚ
 
	$__şÚe
()

138 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

139 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

140 ià(
	`is_objeù
(
$v®ue
)) {

141 
$this
->
$key
 = 
şÚe
 
$v®ue
;

143 
$this
->
$key
 = 
$v®ue
;

146 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Drawing/Shadow.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_D¿wšg_Shadow
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


31 cÚ¡ 
	mSHADOW_BOTTOM
 = 'b';

32 cÚ¡ 
	mSHADOW_BOTTOM_LEFT
 = 'bl';

33 cÚ¡ 
	mSHADOW_BOTTOM_RIGHT
 = 'br';

34 cÚ¡ 
	mSHADOW_CENTER
 = 'ctr';

35 cÚ¡ 
	mSHADOW_LEFT
 = 'l';

36 cÚ¡ 
	mSHADOW_TOP
 = 't';

37 cÚ¡ 
	mSHADOW_TOP_LEFT
 = 'tl';

38 cÚ¡ 
	mSHADOW_TOP_RIGHT
 = 'tr';

45 
´iv©e
 
	m$visibË
;

54 
´iv©e
 
	m$blurRadius
;

63 
´iv©e
 
	m$di¡ªû
;

70 
´iv©e
 
	m$dœeùiÚ
;

77 
´iv©e
 
	m$®ignm’t
;

84 
´iv©e
 
	m$cŞÜ
;

91 
´iv©e
 
	m$®pha
;

96 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

99 
$this
->
visibË
 = 
çl£
;

100 
$this
->
blurRadius
 = 6;

101 
$this
->
di¡ªû
 = 2;

102 
$this
->
dœeùiÚ
 = 0;

103 
$this
->
®ignm’t
 = 
PHPExûl_WÜksh“t_D¿wšg_Shadow
::
SHADOW_BOTTOM_RIGHT
;

104 
$this
->
cŞÜ
 = 
Ãw
 
	`PHPExûl_StyË_CŞÜ
(
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK
);

105 
$this
->
®pha
 = 50;

113 
public
 
funùiÚ
 
	$g‘VisibË
()

115  
$this
->
visibË
;

116 
	}
}

124 
public
 
funùiÚ
 
	$£tVisibË
(
$pV®ue
 = 
çl£
)

126 
$this
->
visibË
 = 
$pV®ue
;

127  
$this
;

128 
	}
}

135 
public
 
funùiÚ
 
	$g‘BlurRadius
()

137  
$this
->
blurRadius
;

138 
	}
}

146 
public
 
funùiÚ
 
	$£tBlurRadius
(
$pV®ue
 = 6)

148 
$this
->
blurRadius
 = 
$pV®ue
;

149  
$this
;

150 
	}
}

157 
public
 
funùiÚ
 
	$g‘Di¡ªû
()

159  
$this
->
di¡ªû
;

160 
	}
}

168 
public
 
funùiÚ
 
	$£tDi¡ªû
(
$pV®ue
 = 2)

170 
$this
->
di¡ªû
 = 
$pV®ue
;

171  
$this
;

172 
	}
}

179 
public
 
funùiÚ
 
	$g‘DœeùiÚ
()

181  
$this
->
dœeùiÚ
;

182 
	}
}

190 
public
 
funùiÚ
 
	$£tDœeùiÚ
(
$pV®ue
 = 0)

192 
$this
->
dœeùiÚ
 = 
$pV®ue
;

193  
$this
;

194 
	}
}

201 
public
 
funùiÚ
 
	$g‘Alignm’t
()

203  
$this
->
®ignm’t
;

204 
	}
}

212 
public
 
funùiÚ
 
	$£tAlignm’t
(
$pV®ue
 = 0)

214 
$this
->
®ignm’t
 = 
$pV®ue
;

215  
$this
;

216 
	}
}

223 
public
 
funùiÚ
 
	$g‘CŞÜ
()

225  
$this
->
cŞÜ
;

226 
	}
}

235 
public
 
funùiÚ
 
	$£tCŞÜ
(
PHPExûl_StyË_CŞÜ
 
$pV®ue
 = 
nuÎ
)

237 
$this
->
cŞÜ
 = 
$pV®ue
;

238  
$this
;

239 
	}
}

246 
public
 
funùiÚ
 
	$g‘AÍha
()

248  
$this
->
®pha
;

249 
	}
}

257 
public
 
funùiÚ
 
	$£tAÍha
(
$pV®ue
 = 0)

259 
$this
->
®pha
 = 
$pV®ue
;

260  
$this
;

261 
	}
}

268 
public
 
funùiÚ
 
	$g‘HashCode
()

270  
	`md5
(

271 (
$this
->
visibË
 ? 't' : 'f') .

272 
$this
->
blurRadius
 .

273 
$this
->
di¡ªû
 .

274 
$this
->
dœeùiÚ
 .

275 
$this
->
®ignm’t
 .

276 
$this
->
cŞÜ
->
	`g‘HashCode
() .

277 
$this
->
®pha
 .

278 
__CLASS__


280 
	}
}

285 
public
 
funùiÚ
 
	$__şÚe
()

287 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

288 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

289 ià(
	`is_objeù
(
$v®ue
)) {

290 
$this
->
$key
 = 
şÚe
 
$v®ue
;

292 
$this
->
$key
 = 
$v®ue
;

295 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/HeaderFooter.php

1 <?
php


88 şas 
	cPHPExûl_WÜksh“t_H—d”FoÙ”


91 cÚ¡ 
	mIMAGE_HEADER_LEFT
 = 'LH';

92 cÚ¡ 
	mIMAGE_HEADER_CENTER
 = 'CH';

93 cÚ¡ 
	mIMAGE_HEADER_RIGHT
 = 'RH';

94 cÚ¡ 
	mIMAGE_FOOTER_LEFT
 = 'LF';

95 cÚ¡ 
	mIMAGE_FOOTER_CENTER
 = 'CF';

96 cÚ¡ 
	mIMAGE_FOOTER_RIGHT
 = 'RF';

103 
´iv©e
 
	m$oddH—d”
 = '';

110 
´iv©e
 
	m$oddFoÙ”
 = '';

117 
´iv©e
 
	m$ev’H—d”
 = '';

124 
´iv©e
 
	m$ev’FoÙ”
 = '';

131 
´iv©e
 
	m$fœ¡H—d”
 = '';

138 
´iv©e
 
	m$fœ¡FoÙ”
 = '';

145 
´iv©e
 
	m$difã»ÁOddEv’
 = 
çl£
;

152 
´iv©e
 
	m$difã»ÁFœ¡
 = 
çl£
;

159 
´iv©e
 
	m$sÿËW™hDocum’t
 = 
Œue
;

166 
´iv©e
 
	m$®ignW™hM¬gšs
 = 
Œue
;

173 
´iv©e
 
	m$h—d”FoÙ”Images
 = 
¬¿y
();

178 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

187 
public
 
funùiÚ
 
	$g‘OddH—d”
()

189  
$this
->
oddH—d”
;

190 
	}
}

198 
public
 
funùiÚ
 
	$£tOddH—d”
(
$pV®ue
)

200 
$this
->
oddH—d”
 = 
$pV®ue
;

201  
$this
;

202 
	}
}

209 
public
 
funùiÚ
 
	$g‘OddFoÙ”
()

211  
$this
->
oddFoÙ”
;

212 
	}
}

220 
public
 
funùiÚ
 
	$£tOddFoÙ”
(
$pV®ue
)

222 
$this
->
oddFoÙ”
 = 
$pV®ue
;

223  
$this
;

224 
	}
}

231 
public
 
funùiÚ
 
	$g‘Ev’H—d”
()

233  
$this
->
ev’H—d”
;

234 
	}
}

242 
public
 
funùiÚ
 
	$£tEv’H—d”
(
$pV®ue
)

244 
$this
->
ev’H—d”
 = 
$pV®ue
;

245  
$this
;

246 
	}
}

253 
public
 
funùiÚ
 
	$g‘Ev’FoÙ”
()

255  
$this
->
ev’FoÙ”
;

256 
	}
}

264 
public
 
funùiÚ
 
	$£tEv’FoÙ”
(
$pV®ue
)

266 
$this
->
ev’FoÙ”
 = 
$pV®ue
;

267  
$this
;

268 
	}
}

275 
public
 
funùiÚ
 
	$g‘Fœ¡H—d”
()

277  
$this
->
fœ¡H—d”
;

278 
	}
}

286 
public
 
funùiÚ
 
	$£tFœ¡H—d”
(
$pV®ue
)

288 
$this
->
fœ¡H—d”
 = 
$pV®ue
;

289  
$this
;

290 
	}
}

297 
public
 
funùiÚ
 
	$g‘Fœ¡FoÙ”
()

299  
$this
->
fœ¡FoÙ”
;

300 
	}
}

308 
public
 
funùiÚ
 
	$£tFœ¡FoÙ”
(
$pV®ue
)

310 
$this
->
fœ¡FoÙ”
 = 
$pV®ue
;

311  
$this
;

312 
	}
}

319 
public
 
funùiÚ
 
	$g‘Difã»ÁOddEv’
()

321  
$this
->
difã»ÁOddEv’
;

322 
	}
}

330 
public
 
funùiÚ
 
	$£tDifã»ÁOddEv’
(
$pV®ue
 = 
çl£
)

332 
$this
->
difã»ÁOddEv’
 = 
$pV®ue
;

333  
$this
;

334 
	}
}

341 
public
 
funùiÚ
 
	$g‘Difã»ÁFœ¡
()

343  
$this
->
difã»ÁFœ¡
;

344 
	}
}

352 
public
 
funùiÚ
 
	$£tDifã»ÁFœ¡
(
$pV®ue
 = 
çl£
)

354 
$this
->
difã»ÁFœ¡
 = 
$pV®ue
;

355  
$this
;

356 
	}
}

363 
public
 
funùiÚ
 
	$g‘SÿËW™hDocum’t
()

365  
$this
->
sÿËW™hDocum’t
;

366 
	}
}

374 
public
 
funùiÚ
 
	$£tSÿËW™hDocum’t
(
$pV®ue
 = 
Œue
)

376 
$this
->
sÿËW™hDocum’t
 = 
$pV®ue
;

377  
$this
;

378 
	}
}

385 
public
 
funùiÚ
 
	$g‘AlignW™hM¬gšs
()

387  
$this
->
®ignW™hM¬gšs
;

388 
	}
}

396 
public
 
funùiÚ
 
	$£tAlignW™hM¬gšs
(
$pV®ue
 = 
Œue
)

398 
$this
->
®ignW™hM¬gšs
 = 
$pV®ue
;

399  
$this
;

400 
	}
}

410 
public
 
funùiÚ
 
	$addImage
(
PHPExûl_WÜksh“t_H—d”FoÙ”D¿wšg
 
$image
 = 
nuÎ
, 
$loÿtiÚ
 = 
£lf
::
IMAGE_HEADER_LEFT
)

412 
$this
->
h—d”FoÙ”Images
[
$loÿtiÚ
] = 
$image
;

413  
$this
;

414 
	}
}

423 
public
 
funùiÚ
 
	$»moveImage
(
$loÿtiÚ
 = 
£lf
::
IMAGE_HEADER_LEFT
)

425 ià(
	`is£t
(
$this
->
h—d”FoÙ”Images
[
$loÿtiÚ
])) {

426 
	`un£t
(
$this
->
h—d”FoÙ”Images
[
$loÿtiÚ
]);

428  
$this
;

429 
	}
}

438 
public
 
funùiÚ
 
	$£tImages
(
$images
)

440 ià(!
	`is_¬¿y
(
$images
)) {

441 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid…arameter!');

444 
$this
->
h—d”FoÙ”Images
 = 
$images
;

445  
$this
;

446 
	}
}

453 
public
 
funùiÚ
 
	$g‘Images
()

456 
$images
 = 
	`¬¿y
();

457 ià(
	`is£t
(
$this
->
h—d”FoÙ”Images
[
£lf
::
IMAGE_HEADER_LEFT
])) {

458 
$images
[
£lf
::
IMAGE_HEADER_LEFT
] = 
$this
->
h—d”FoÙ”Images
[self::IMAGE_HEADER_LEFT];

460 ià(
	`is£t
(
$this
->
h—d”FoÙ”Images
[
£lf
::
IMAGE_HEADER_CENTER
])) {

461 
$images
[
£lf
::
IMAGE_HEADER_CENTER
] = 
$this
->
h—d”FoÙ”Images
[self::IMAGE_HEADER_CENTER];

463 ià(
	`is£t
(
$this
->
h—d”FoÙ”Images
[
£lf
::
IMAGE_HEADER_RIGHT
])) {

464 
$images
[
£lf
::
IMAGE_HEADER_RIGHT
] = 
$this
->
h—d”FoÙ”Images
[self::IMAGE_HEADER_RIGHT];

466 ià(
	`is£t
(
$this
->
h—d”FoÙ”Images
[
£lf
::
IMAGE_FOOTER_LEFT
])) {

467 
$images
[
£lf
::
IMAGE_FOOTER_LEFT
] = 
$this
->
h—d”FoÙ”Images
[self::IMAGE_FOOTER_LEFT];

469 ià(
	`is£t
(
$this
->
h—d”FoÙ”Images
[
£lf
::
IMAGE_FOOTER_CENTER
])) {

470 
$images
[
£lf
::
IMAGE_FOOTER_CENTER
] = 
$this
->
h—d”FoÙ”Images
[self::IMAGE_FOOTER_CENTER];

472 ià(
	`is£t
(
$this
->
h—d”FoÙ”Images
[
£lf
::
IMAGE_FOOTER_RIGHT
])) {

473 
$images
[
£lf
::
IMAGE_FOOTER_RIGHT
] = 
$this
->
h—d”FoÙ”Images
[self::IMAGE_FOOTER_RIGHT];

475 
$this
->
h—d”FoÙ”Images
 = 
$images
;

477  
$this
->
h—d”FoÙ”Images
;

478 
	}
}

483 
public
 
funùiÚ
 
	$__şÚe
()

485 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

486 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

487 ià(
	`is_objeù
(
$v®ue
)) {

488 
$this
->
$key
 = 
şÚe
 
$v®ue
;

490 
$this
->
$key
 = 
$v®ue
;

493 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/HeaderFooterDrawing.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_H—d”FoÙ”D¿wšg
 
ex‹nds
 
PHPExûl_WÜksh“t_D¿wšg
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


35 
´iv©e
 
	m$·th
;

42 
´Ùeùed
 
	m$Çme
;

49 
´Ùeùed
 
	m$off£tX
;

56 
´Ùeùed
 
	m$off£tY
;

63 
´Ùeùed
 
	m$width
;

70 
´Ùeùed
 
	m$height
;

77 
´Ùeùed
 
	m$»sizePrİÜtiÚ®
;

82 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

85 
$this
->
·th
 = '';

86 
$this
->
Çme
 = '';

87 
$this
->
off£tX
 = 0;

88 
$this
->
off£tY
 = 0;

89 
$this
->
width
 = 0;

90 
$this
->
height
 = 0;

91 
$this
->
»sizePrİÜtiÚ®
 = 
Œue
;

99 
public
 
funùiÚ
 
	$g‘Name
()

101  
$this
->
Çme
;

102 
	}
}

110 
public
 
funùiÚ
 
£tName
(
$pV®ue
 = '')

112 
$this
->
Çme
 = 
$pV®ue
;

113  
	g$this
;

121 
public
 
funùiÚ
 
	$g‘Off£tX
()

123  
$this
->
off£tX
;

124 
	}
}

132 
public
 
funùiÚ
 
	$£tOff£tX
(
$pV®ue
 = 0)

134 
$this
->
off£tX
 = 
$pV®ue
;

135  
$this
;

136 
	}
}

143 
public
 
funùiÚ
 
	$g‘Off£tY
()

145  
$this
->
off£tY
;

146 
	}
}

154 
public
 
funùiÚ
 
	$£tOff£tY
(
$pV®ue
 = 0)

156 
$this
->
off£tY
 = 
$pV®ue
;

157  
$this
;

158 
	}
}

165 
public
 
funùiÚ
 
	$g‘Width
()

167  
$this
->
width
;

168 
	}
}

176 
public
 
funùiÚ
 
	$£tWidth
(
$pV®ue
 = 0)

179 ià(
$this
->
»sizePrİÜtiÚ®
 && 
$pV®ue
 != 0) {

180 
$¿tio
 = 
$this
->
width
 / $this->
height
;

181 
$this
->
height
 = 
	`round
(
$¿tio
 * 
$pV®ue
);

185 
$this
->
width
 = 
$pV®ue
;

187  
$this
;

188 
	}
}

195 
public
 
funùiÚ
 
	$g‘Height
()

197  
$this
->
height
;

198 
	}
}

206 
public
 
funùiÚ
 
	$£tHeight
(
$pV®ue
 = 0)

209 ià(
$this
->
»sizePrİÜtiÚ®
 && 
$pV®ue
 != 0) {

210 
$¿tio
 = 
$this
->
width
 / $this->
height
;

211 
$this
->
width
 = 
	`round
(
$¿tio
 * 
$pV®ue
);

215 
$this
->
height
 = 
$pV®ue
;

217  
$this
;

218 
	}
}

233 
public
 
funùiÚ
 
	$£tWidthAndHeight
(
$width
 = 0, 
$height
 = 0)

235 
$x¿tio
 = 
$width
 / 
$this
->
width
;

236 
$y¿tio
 = 
$height
 / 
$this
->
height
;

237 ià(
$this
->
»sizePrİÜtiÚ®
 && !(
$width
 =ğ0 || 
$height
 == 0)) {

238 ià((
$x¿tio
 * 
$this
->
height
è< 
$height
) {

239 
$this
->
height
 = 
	`û
(
$x¿tio
 * $this->height);

240 
$this
->
width
 = 
$width
;

242 
$this
->
width
 = 
	`û
(
$y¿tio
 * $this->width);

243 
$this
->
height
 = 
$height
;

246  
$this
;

247 
	}
}

254 
public
 
funùiÚ
 
	$g‘ResizePrİÜtiÚ®
()

256  
$this
->
»sizePrİÜtiÚ®
;

257 
	}
}

265 
public
 
funùiÚ
 
	$£tResizePrİÜtiÚ®
(
$pV®ue
 = 
Œue
)

267 
$this
->
»sizePrİÜtiÚ®
 = 
$pV®ue
;

268  
$this
;

269 
	}
}

276 
public
 
funùiÚ
 
	$g‘F’ame
()

278  
	`ba£Çme
(
$this
->
·th
);

279 
	}
}

286 
public
 
funùiÚ
 
	$g‘Ex‹nsiÚ
()

288 
$·¹s
 = 
	`ex¶ode
(".", 
	`ba£Çme
(
$this
->
·th
));

289  
	`’d
(
$·¹s
);

290 
	}
}

297 
public
 
funùiÚ
 
	$g‘P©h
()

299  
$this
->
·th
;

300 
	}
}

310 
public
 
funùiÚ
 
£tP©h
(
$pV®ue
 = '', 
$pV”ifyFe
 = 
Œue
)

312 ià(
$pV”ifyFe
) {

313 ià(
fe_exi¡s
(
$pV®ue
)) {

314 
$this
->
·th
 = 
$pV®ue
;

316 ià(
	g$this
->
	gwidth
 =ğ0 && 
$this
->
height
 == 0) {

318 
li¡
(
$this
->
width
, $this->
height
èğ
g‘imagesize
(
$pV®ue
);

321 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
("File $pValue‚ot found!");

324 
	g$this
->
	g·th
 = 
$pV®ue
;

326  
	g$this
;

334 
public
 
funùiÚ
 
	$g‘HashCode
()

336  
	`md5
(

337 
$this
->
·th
 .

338 
$this
->
Çme
 .

339 
$this
->
off£tX
 .

340 
$this
->
off£tY
 .

341 
$this
->
width
 .

342 
$this
->
height
 .

343 
__CLASS__


345 
	}
}

350 
public
 
funùiÚ
 
	$__şÚe
()

352 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

353 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

354 ià(
	`is_objeù
(
$v®ue
)) {

355 
$this
->
$key
 = 
şÚe
 
$v®ue
;

357 
$this
->
$key
 = 
$v®ue
;

360 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/MemoryDrawing.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_MemÜyD¿wšg
 
ex‹nds
 
PHPExûl_WÜksh“t_Ba£D¿wšg
 
im¶em’ts
 
	mPHPExûl_ICom·¿bË


31 cÚ¡ 
	mRENDERING_DEFAULT
 = 'imagepng';

32 cÚ¡ 
	mRENDERING_PNG
 = 'imagepng';

33 cÚ¡ 
	mRENDERING_GIF
 = 'imagegif';

34 cÚ¡ 
	mRENDERING_JPEG
 = 'imagejpeg';

37 cÚ¡ 
	mMIMETYPE_DEFAULT
 = 'image/png';

38 cÚ¡ 
	mMIMETYPE_PNG
 = 'image/png';

39 cÚ¡ 
	mMIMETYPE_GIF
 = 'image/gif';

40 cÚ¡ 
	mMIMETYPE_JPEG
 = 'image/jpeg';

47 
´iv©e
 
	m$imageResourû
;

54 
´iv©e
 
	m$»nd”šgFunùiÚ
;

61 
´iv©e
 
	m$mimeTy³
;

68 
´iv©e
 
	m$uniqueName
;

73 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

76 
$this
->
imageResourû
 = 
nuÎ
;

77 
$this
->
»nd”šgFunùiÚ
 = 
£lf
::
RENDERING_DEFAULT
;

78 
$this
->
mimeTy³
 = 
£lf
::
MIMETYPE_DEFAULT
;

79 
$this
->
uniqueName
 = 
	`md5
(
	`¿nd
(0, 9999). 
	`time
() .„and(0, 9999));

82 
·»Á
::
	`__cÚ¡ruù
();

90 
public
 
funùiÚ
 
	$g‘ImageResourû
()

92  
$this
->
imageResourû
;

93 
	}
}

101 
public
 
funùiÚ
 
	$£tImageResourû
(
$v®ue
 = 
nuÎ
)

103 
$this
->
imageResourû
 = 
$v®ue
;

105 ià(!
	`is_nuÎ
(
$this
->
imageResourû
)) {

107 
$this
->
width
 = 
	`imagesx
($this->
imageResourû
);

108 
$this
->
height
 = 
	`imagesy
($this->
imageResourû
);

110  
$this
;

111 
	}
}

118 
public
 
funùiÚ
 
	$g‘R’d”šgFunùiÚ
()

120  
$this
->
»nd”šgFunùiÚ
;

121 
	}
}

129 
public
 
funùiÚ
 
	$£tR’d”šgFunùiÚ
(
$v®ue
 = 
PHPExûl_WÜksh“t_MemÜyD¿wšg
::
RENDERING_DEFAULT
)

131 
$this
->
»nd”šgFunùiÚ
 = 
$v®ue
;

132  
$this
;

133 
	}
}

140 
public
 
funùiÚ
 
	$g‘MimeTy³
()

142  
$this
->
mimeTy³
;

143 
	}
}

151 
public
 
funùiÚ
 
	$£tMimeTy³
(
$v®ue
 = 
PHPExûl_WÜksh“t_MemÜyD¿wšg
::
MIMETYPE_DEFAULT
)

153 
$this
->
mimeTy³
 = 
$v®ue
;

154  
$this
;

155 
	}
}

162 
public
 
funùiÚ
 
	$g‘IndexedF’ame
()

164 
$ex‹nsiÚ
 = 
	`¡¹Şow”
(
$this
->
	`g‘MimeTy³
());

165 
$ex‹nsiÚ
 = 
	`ex¶ode
('/', $extension);

166 
$ex‹nsiÚ
 = $extension[1];

168  
$this
->
uniqueName
 . $this->
	`g‘ImageIndex
(è. '.' . 
$ex‹nsiÚ
;

169 
	}
}

176 
public
 
funùiÚ
 
	$g‘HashCode
()

178  
	`md5
(

179 
$this
->
»nd”šgFunùiÚ
 .

180 
$this
->
mimeTy³
 .

181 
$this
->
uniqueName
 .

182 
·»Á
::
	`g‘HashCode
() .

183 
__CLASS__


185 
	}
}

190 
public
 
funùiÚ
 
	$__şÚe
()

192 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

193 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

194 ià(
	`is_objeù
(
$v®ue
)) {

195 
$this
->
$key
 = 
şÚe
 
$v®ue
;

197 
$this
->
$key
 = 
$v®ue
;

200 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/PageMargins.php

1 <?
php


36 şas 
	cPHPExûl_WÜksh“t_PageM¬gšs


43 
´iv©e
 
	m$Ëá
 = 0.7;

50 
´iv©e
 
	m$right
 = 0.7;

57 
´iv©e
 
	m$tİ
 = 0.75;

64 
´iv©e
 
	m$bÙtom
 = 0.75;

71 
´iv©e
 
	m$h—d”
 = 0.3;

78 
´iv©e
 
	m$foÙ”
 = 0.3;

83 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

92 
public
 
funùiÚ
 
	$g‘Leá
()

94  
$this
->
Ëá
;

95 
	}
}

103 
public
 
funùiÚ
 
	$£tLeá
(
$pV®ue
)

105 
$this
->
Ëá
 = 
$pV®ue
;

106  
$this
;

107 
	}
}

114 
public
 
funùiÚ
 
	$g‘Right
()

116  
$this
->
right
;

117 
	}
}

125 
public
 
funùiÚ
 
	$£tRight
(
$pV®ue
)

127 
$this
->
right
 = 
$pV®ue
;

128  
$this
;

129 
	}
}

136 
public
 
funùiÚ
 
	$g‘Tİ
()

138  
$this
->
tİ
;

139 
	}
}

147 
public
 
funùiÚ
 
	$£tTİ
(
$pV®ue
)

149 
$this
->
tİ
 = 
$pV®ue
;

150  
$this
;

151 
	}
}

158 
public
 
funùiÚ
 
	$g‘BÙtom
()

160  
$this
->
bÙtom
;

161 
	}
}

169 
public
 
funùiÚ
 
	$£tBÙtom
(
$pV®ue
)

171 
$this
->
bÙtom
 = 
$pV®ue
;

172  
$this
;

173 
	}
}

180 
public
 
funùiÚ
 
	$g‘H—d”
()

182  
$this
->
h—d”
;

183 
	}
}

191 
public
 
funùiÚ
 
	$£tH—d”
(
$pV®ue
)

193 
$this
->
h—d”
 = 
$pV®ue
;

194  
$this
;

195 
	}
}

202 
public
 
funùiÚ
 
	$g‘FoÙ”
()

204  
$this
->
foÙ”
;

205 
	}
}

213 
public
 
funùiÚ
 
	$£tFoÙ”
(
$pV®ue
)

215 
$this
->
foÙ”
 = 
$pV®ue
;

216  
$this
;

217 
	}
}

222 
public
 
funùiÚ
 
	$__şÚe
()

224 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

225 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

226 ià(
	`is_objeù
(
$v®ue
)) {

227 
$this
->
$key
 = 
şÚe
 
$v®ue
;

229 
$this
->
$key
 = 
$v®ue
;

232 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/PageSetup.php

1 <?
php


107 şas 
	cPHPExûl_WÜksh“t_PageS‘up


110 cÚ¡ 
	mPAPERSIZE_LETTER
 = 1;

111 cÚ¡ 
	mPAPERSIZE_LETTER_SMALL
 = 2;

112 cÚ¡ 
	mPAPERSIZE_TABLOID
 = 3;

113 cÚ¡ 
	mPAPERSIZE_LEDGER
 = 4;

114 cÚ¡ 
	mPAPERSIZE_LEGAL
 = 5;

115 cÚ¡ 
	mPAPERSIZE_STATEMENT
 = 6;

116 cÚ¡ 
	mPAPERSIZE_EXECUTIVE
 = 7;

117 cÚ¡ 
	mPAPERSIZE_A3
 = 8;

118 cÚ¡ 
	mPAPERSIZE_A4
 = 9;

119 cÚ¡ 
	mPAPERSIZE_A4_SMALL
 = 10;

120 cÚ¡ 
	mPAPERSIZE_A5
 = 11;

121 cÚ¡ 
	mPAPERSIZE_B4
 = 12;

122 cÚ¡ 
	mPAPERSIZE_B5
 = 13;

123 cÚ¡ 
	mPAPERSIZE_FOLIO
 = 14;

124 cÚ¡ 
	mPAPERSIZE_QUARTO
 = 15;

125 cÚ¡ 
	mPAPERSIZE_STANDARD_1
 = 16;

126 cÚ¡ 
	mPAPERSIZE_STANDARD_2
 = 17;

127 cÚ¡ 
	mPAPERSIZE_NOTE
 = 18;

128 cÚ¡ 
	mPAPERSIZE_NO9_ENVELOPE
 = 19;

129 cÚ¡ 
	mPAPERSIZE_NO10_ENVELOPE
 = 20;

130 cÚ¡ 
	mPAPERSIZE_NO11_ENVELOPE
 = 21;

131 cÚ¡ 
	mPAPERSIZE_NO12_ENVELOPE
 = 22;

132 cÚ¡ 
	mPAPERSIZE_NO14_ENVELOPE
 = 23;

133 cÚ¡ 
	mPAPERSIZE_C
 = 24;

134 cÚ¡ 
	mPAPERSIZE_D
 = 25;

135 cÚ¡ 
	mPAPERSIZE_E
 = 26;

136 cÚ¡ 
	mPAPERSIZE_DL_ENVELOPE
 = 27;

137 cÚ¡ 
	mPAPERSIZE_C5_ENVELOPE
 = 28;

138 cÚ¡ 
	mPAPERSIZE_C3_ENVELOPE
 = 29;

139 cÚ¡ 
	mPAPERSIZE_C4_ENVELOPE
 = 30;

140 cÚ¡ 
	mPAPERSIZE_C6_ENVELOPE
 = 31;

141 cÚ¡ 
	mPAPERSIZE_C65_ENVELOPE
 = 32;

142 cÚ¡ 
	mPAPERSIZE_B4_ENVELOPE
 = 33;

143 cÚ¡ 
	mPAPERSIZE_B5_ENVELOPE
 = 34;

144 cÚ¡ 
	mPAPERSIZE_B6_ENVELOPE
 = 35;

145 cÚ¡ 
	mPAPERSIZE_ITALY_ENVELOPE
 = 36;

146 cÚ¡ 
	mPAPERSIZE_MONARCH_ENVELOPE
 = 37;

147 cÚ¡ 
	mPAPERSIZE_6_3_4_ENVELOPE
 = 38;

148 cÚ¡ 
	mPAPERSIZE_US_STANDARD_FANFOLD
 = 39;

149 cÚ¡ 
	mPAPERSIZE_GERMAN_STANDARD_FANFOLD
 = 40;

150 cÚ¡ 
	mPAPERSIZE_GERMAN_LEGAL_FANFOLD
 = 41;

151 cÚ¡ 
	mPAPERSIZE_ISO_B4
 = 42;

152 cÚ¡ 
	mPAPERSIZE_JAPANESE_DOUBLE_POSTCARD
 = 43;

153 cÚ¡ 
	mPAPERSIZE_STANDARD_PAPER_1
 = 44;

154 cÚ¡ 
	mPAPERSIZE_STANDARD_PAPER_2
 = 45;

155 cÚ¡ 
	mPAPERSIZE_STANDARD_PAPER_3
 = 46;

156 cÚ¡ 
	mPAPERSIZE_INVITE_ENVELOPE
 = 47;

157 cÚ¡ 
	mPAPERSIZE_LETTER_EXTRA_PAPER
 = 48;

158 cÚ¡ 
	mPAPERSIZE_LEGAL_EXTRA_PAPER
 = 49;

159 cÚ¡ 
	mPAPERSIZE_TABLOID_EXTRA_PAPER
 = 50;

160 cÚ¡ 
	mPAPERSIZE_A4_EXTRA_PAPER
 = 51;

161 cÚ¡ 
	mPAPERSIZE_LETTER_TRANSVERSE_PAPER
 = 52;

162 cÚ¡ 
	mPAPERSIZE_A4_TRANSVERSE_PAPER
 = 53;

163 cÚ¡ 
	mPAPERSIZE_LETTER_EXTRA_TRANSVERSE_PAPER
 = 54;

164 cÚ¡ 
	mPAPERSIZE_SUPERA_SUPERA_A4_PAPER
 = 55;

165 cÚ¡ 
	mPAPERSIZE_SUPERB_SUPERB_A3_PAPER
 = 56;

166 cÚ¡ 
	mPAPERSIZE_LETTER_PLUS_PAPER
 = 57;

167 cÚ¡ 
	mPAPERSIZE_A4_PLUS_PAPER
 = 58;

168 cÚ¡ 
	mPAPERSIZE_A5_TRANSVERSE_PAPER
 = 59;

169 cÚ¡ 
	mPAPERSIZE_JIS_B5_TRANSVERSE_PAPER
 = 60;

170 cÚ¡ 
	mPAPERSIZE_A3_EXTRA_PAPER
 = 61;

171 cÚ¡ 
	mPAPERSIZE_A5_EXTRA_PAPER
 = 62;

172 cÚ¡ 
	mPAPERSIZE_ISO_B5_EXTRA_PAPER
 = 63;

173 cÚ¡ 
	mPAPERSIZE_A2_PAPER
 = 64;

174 cÚ¡ 
	mPAPERSIZE_A3_TRANSVERSE_PAPER
 = 65;

175 cÚ¡ 
	mPAPERSIZE_A3_EXTRA_TRANSVERSE_PAPER
 = 66;

178 cÚ¡ 
	mORIENTATION_DEFAULT
 = 'default';

179 cÚ¡ 
	mORIENTATION_LANDSCAPE
 = 'landscape';

180 cÚ¡ 
	mORIENTATION_PORTRAIT
 = 'portrait';

183 cÚ¡ 
	mSETPRINTRANGE_OVERWRITE
 = 'O';

184 cÚ¡ 
	mSETPRINTRANGE_INSERT
 = 'I';

192 
´iv©e
 
	m$·³rSize
 = 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LETTER
;

199 
´iv©e
 
	m$Ü›Á©iÚ
 = 
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_DEFAULT
;

209 
´iv©e
 
	m$sÿË
 = 100;

217 
´iv©e
 
	m$f™ToPage
 = 
çl£
;

225 
´iv©e
 
	m$f™ToHeight
 = 1;

233 
´iv©e
 
	m$f™ToWidth
 = 1;

240 
´iv©e
 
	m$cŞumnsToR•—tAtLeá
 = 
¬¿y
('', '');

247 
´iv©e
 
	m$rowsToR•—tAtTİ
 = 
¬¿y
(0, 0);

254 
´iv©e
 
	m$hÜizÚlC’‹»d
 = 
çl£
;

261 
´iv©e
 
	m$v”tiÿlC’‹»d
 = 
çl£
;

268 
´iv©e
 
	m$´štA»a
 = 
nuÎ
;

275 
´iv©e
 
	m$fœ¡PageNumb”
 = 
nuÎ
;

280 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

289 
public
 
funùiÚ
 
	$g‘P­”Size
()

291  
$this
->
·³rSize
;

292 
	}
}

300 
public
 
funùiÚ
 
	$£tP­”Size
(
$pV®ue
 = 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LETTER
)

302 
$this
->
·³rSize
 = 
$pV®ue
;

303  
$this
;

304 
	}
}

311 
public
 
funùiÚ
 
	$g‘Or›Á©iÚ
()

313  
$this
->
Ü›Á©iÚ
;

314 
	}
}

322 
public
 
funùiÚ
 
	$£tOr›Á©iÚ
(
$pV®ue
 = 
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_DEFAULT
)

324 
$this
->
Ü›Á©iÚ
 = 
$pV®ue
;

325  
$this
;

326 
	}
}

333 
public
 
funùiÚ
 
	$g‘SÿË
()

335  
$this
->
sÿË
;

336 
	}
}

349 
public
 
funùiÚ
 
	$£tSÿË
(
$pV®ue
 = 100, 
$pUpd©e
 = 
Œue
)

353 ià((
$pV®ue
 >ğ0è|| 
	`is_nuÎ
($pValue)) {

354 
$this
->
sÿË
 = 
$pV®ue
;

355 ià(
$pUpd©e
) {

356 
$this
->
f™ToPage
 = 
çl£
;

359 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Scale must‚ot be‚egative");

361  
$this
;

362 
	}
}

369 
public
 
funùiÚ
 
	$g‘F™ToPage
()

371  
$this
->
f™ToPage
;

372 
	}
}

380 
public
 
funùiÚ
 
	$£tF™ToPage
(
$pV®ue
 = 
Œue
)

382 
$this
->
f™ToPage
 = 
$pV®ue
;

383  
$this
;

384 
	}
}

391 
public
 
funùiÚ
 
	$g‘F™ToHeight
()

393  
$this
->
f™ToHeight
;

394 
	}
}

403 
public
 
funùiÚ
 
	$£tF™ToHeight
(
$pV®ue
 = 1, 
$pUpd©e
 = 
Œue
)

405 
$this
->
f™ToHeight
 = 
$pV®ue
;

406 ià(
$pUpd©e
) {

407 
$this
->
f™ToPage
 = 
Œue
;

409  
$this
;

410 
	}
}

417 
public
 
funùiÚ
 
	$g‘F™ToWidth
()

419  
$this
->
f™ToWidth
;

420 
	}
}

429 
public
 
funùiÚ
 
	$£tF™ToWidth
(
$pV®ue
 = 1, 
$pUpd©e
 = 
Œue
)

431 
$this
->
f™ToWidth
 = 
$pV®ue
;

432 ià(
$pUpd©e
) {

433 
$this
->
f™ToPage
 = 
Œue
;

435  
$this
;

436 
	}
}

443 
public
 
funùiÚ
 
	$isCŞumnsToR•—tAtLeáS‘
()

445 ià(
	`is_¬¿y
(
$this
->
cŞumnsToR•—tAtLeá
)) {

446 ià(
$this
->
cŞumnsToR•—tAtLeá
[0] != '' && $this->columnsToRepeatAtLeft[1] != '') {

447  
Œue
;

451  
çl£
;

452 
	}
}

459 
public
 
funùiÚ
 
	$g‘CŞumnsToR•—tAtLeá
()

461  
$this
->
cŞumnsToR•—tAtLeá
;

462 
	}
}

470 
public
 
funùiÚ
 
	$£tCŞumnsToR•—tAtLeá
(
$pV®ue
 = 
nuÎ
)

472 ià(
	`is_¬¿y
(
$pV®ue
)) {

473 
$this
->
cŞumnsToR•—tAtLeá
 = 
$pV®ue
;

475  
$this
;

476 
	}
}

485 
public
 
funùiÚ
 
£tCŞumnsToR•—tAtLeáByS¹AndEnd
(
$pS¹
 = 'A', 
$pEnd
 = 'A')

487 
$this
->
cŞumnsToR•—tAtLeá
 = 
¬¿y
(
$pS¹
, 
$pEnd
);

488  
	g$this
;

496 
public
 
funùiÚ
 
	$isRowsToR•—tAtTİS‘
()

498 ià(
	`is_¬¿y
(
$this
->
rowsToR•—tAtTİ
)) {

499 ià(
$this
->
rowsToR•—tAtTİ
[0] != 0 && $this->rowsToRepeatAtTop[1] != 0) {

500  
Œue
;

504  
çl£
;

505 
	}
}

512 
public
 
funùiÚ
 
	$g‘RowsToR•—tAtTİ
()

514  
$this
->
rowsToR•—tAtTİ
;

515 
	}
}

523 
public
 
funùiÚ
 
	$£tRowsToR•—tAtTİ
(
$pV®ue
 = 
nuÎ
)

525 ià(
	`is_¬¿y
(
$pV®ue
)) {

526 
$this
->
rowsToR•—tAtTİ
 = 
$pV®ue
;

528  
$this
;

529 
	}
}

538 
public
 
funùiÚ
 
	$£tRowsToR•—tAtTİByS¹AndEnd
(
$pS¹
 = 1, 
$pEnd
 = 1)

540 
$this
->
rowsToR•—tAtTİ
 = 
	`¬¿y
(
$pS¹
, 
$pEnd
);

541  
$this
;

542 
	}
}

549 
public
 
funùiÚ
 
	$g‘HÜizÚlC’‹»d
()

551  
$this
->
hÜizÚlC’‹»d
;

552 
	}
}

560 
public
 
funùiÚ
 
	$£tHÜizÚlC’‹»d
(
$v®ue
 = 
çl£
)

562 
$this
->
hÜizÚlC’‹»d
 = 
$v®ue
;

563  
$this
;

564 
	}
}

571 
public
 
funùiÚ
 
	$g‘V”tiÿlC’‹»d
()

573  
$this
->
v”tiÿlC’‹»d
;

574 
	}
}

582 
public
 
funùiÚ
 
	$£tV”tiÿlC’‹»d
(
$v®ue
 = 
çl£
)

584 
$this
->
v”tiÿlC’‹»d
 = 
$v®ue
;

585  
$this
;

586 
	}
}

598 
public
 
funùiÚ
 
	$g‘PrštA»a
(
$šdex
 = 0)

600 ià(
$šdex
 == 0) {

601  
$this
->
´štA»a
;

603 
$´štA»as
 = 
	`ex¶ode
(',', 
$this
->
´štA»a
);

604 ià(
	`is£t
(
$´štA»as
[
$šdex
-1])) {

605  
$´štA»as
[
$šdex
-1];

607 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Requested Print Area does‚otƒxist");

608 
	}
}

619 
public
 
funùiÚ
 
	$isPrštA»aS‘
(
$šdex
 = 0)

621 ià(
$šdex
 == 0) {

622  !
	`is_nuÎ
(
$this
->
´štA»a
);

624 
$´štA»as
 = 
	`ex¶ode
(',', 
$this
->
´štA»a
);

625  
	`is£t
(
$´štA»as
[
$šdex
-1]);

626 
	}
}

637 
public
 
funùiÚ
 
	$ş—rPrštA»a
(
$šdex
 = 0)

639 ià(
$šdex
 == 0) {

640 
$this
->
´štA»a
 = 
nuÎ
;

642 
$´štA»as
 = 
	`ex¶ode
(',', 
$this
->
´štA»a
);

643 ià(
	`is£t
(
$´štA»as
[
$šdex
-1])) {

644 
	`un£t
(
$´štA»as
[
$šdex
-1]);

645 
$this
->
´štA»a
 = 
	`im¶ode
(',', 
$´štA»as
);

649  
$this
;

650 
	}
}

672 
public
 
funùiÚ
 
	$£tPrštA»a
(
$v®ue
, 
$šdex
 = 0, 
$m‘hod
 = 
£lf
::
SETPRINTRANGE_OVERWRITE
)

674 ià(
	`¡½os
(
$v®ue
, '!'è!=ğ
çl£
) {

675 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Cell coordinate must‚ot specify‡ worksheet.');

676 } 
	`–£if
 (
	`¡½os
(
$v®ue
, ':'è==ğ
çl£
) {

677 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Cell coordinate must be‡„ange of cells.');

678 } 
	`–£if
 (
	`¡½os
(
$v®ue
, '$'è!=ğ
çl£
) {

679 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Cell coordinate must‚ot be‡bsolute.');

681 
$v®ue
 = 
	`¡¹ouµ”
($value);

683 ià(
$m‘hod
 =ğ
£lf
::
SETPRINTRANGE_OVERWRITE
) {

684 ià(
$šdex
 == 0) {

685 
$this
->
´štA»a
 = 
$v®ue
;

687 
$´štA»as
 = 
	`ex¶ode
(',', 
$this
->
´štA»a
);

688 ià(
$šdex
 < 0) {

689 
$šdex
 = 
	`couÁ
(
$´štA»as
è- 
	`abs
($index) + 1;

691 ià((
$šdex
 <ğ0è|| ($šdex > 
	`couÁ
(
$´štA»as
))) {

692 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid index for setting…rint„ange.');

694 
$´štA»as
[
$šdex
-1] = 
$v®ue
;

695 
$this
->
´štA»a
 = 
	`im¶ode
(',', 
$´štA»as
);

697 } 
	`–£if
 (
$m‘hod
 =ğ
£lf
::
SETPRINTRANGE_INSERT
) {

698 ià(
$šdex
 == 0) {

699 
$this
->
´štA»a
 .ğ($this->´štA»¨=ğ''è? 
$v®ue
 : ','.$value;

701 
$´štA»as
 = 
	`ex¶ode
(',', 
$this
->
´štA»a
);

702 ià(
$šdex
 < 0) {

703 
$šdex
 = 
	`abs
($index) - 1;

705 ià(
$šdex
 > 
	`couÁ
(
$´štA»as
)) {

706 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid index for setting…rint„ange.');

708 
$´štA»as
 = 
	`¬¿y_m”ge
(
	`¬¿y_¦iû
($´štA»as, 0, 
$šdex
), 
	`¬¿y
(
$v®ue
),‡rray_slice($printAreas, $index));

709 
$this
->
´štA»a
 = 
	`im¶ode
(',', 
$´štA»as
);

712 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('Invalid method for setting…rint„ange.');

715  
$this
;

716 
	}
}

731 
public
 
funùiÚ
 
addPrštA»a
(
$v®ue
, 
$šdex
 = -1)

733  
$this
->
£tPrštA»a
(
$v®ue
, 
$šdex
, 
£lf
::
SETPRINTRANGE_INSERT
);

759 
public
 
funùiÚ
 
	$£tPrštA»aByCŞumnAndRow
(
$cŞumn1
, 
$row1
, 
$cŞumn2
, 
$row2
, 
$šdex
 = 0, 
$m‘hod
 = 
£lf
::
SETPRINTRANGE_OVERWRITE
)

761  
$this
->
	`£tPrštA»a
(

762 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞumn1
è. 
$row1
 . ':' . PHPExûl_C–l::¡ršgFromCŞumnIndex(
$cŞumn2
è. 
$row2
,

763 
$šdex
,

764 
$m‘hod


766 
	}
}

784 
public
 
funùiÚ
 
addPrštA»aByCŞumnAndRow
(
$cŞumn1
, 
$row1
, 
$cŞumn2
, 
$row2
, 
$šdex
 = -1)

786  
$this
->
£tPrštA»a
(

787 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$cŞumn1
è. 
$row1
 . ':' . PHPExûl_C–l::¡ršgFromCŞumnIndex(
$cŞumn2
è. 
$row2
,

788 
$šdex
,

789 
£lf
::
SETPRINTRANGE_INSERT


798 
public
 
funùiÚ
 
	$g‘Fœ¡PageNumb”
()

800  
$this
->
fœ¡PageNumb”
;

801 
	}
}

809 
public
 
funùiÚ
 
	$£tFœ¡PageNumb”
(
$v®ue
 = 
nuÎ
)

811 
$this
->
fœ¡PageNumb”
 = 
$v®ue
;

812  
$this
;

813 
	}
}

820 
public
 
funùiÚ
 
	$»£tFœ¡PageNumb”
()

822  
$this
->
	`£tFœ¡PageNumb”
(
nuÎ
);

823 
	}
}

828 
public
 
funùiÚ
 
	$__şÚe
()

830 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

831 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

832 ià(
	`is_objeù
(
$v®ue
)) {

833 
$this
->
$key
 = 
şÚe
 
$v®ue
;

835 
$this
->
$key
 = 
$v®ue
;

838 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Protection.php

1 <?
php


36 şas 
	cPHPExûl_WÜksh“t_PrÙeùiÚ


43 
´iv©e
 
	m$sh“t
 = 
çl£
;

50 
´iv©e
 
	m$objeùs
 = 
çl£
;

57 
´iv©e
 
	m$sûÇrios
 = 
çl£
;

64 
´iv©e
 
	m$fÜm©C–ls
 = 
çl£
;

71 
´iv©e
 
	m$fÜm©CŞumns
 = 
çl£
;

78 
´iv©e
 
	m$fÜm©Rows
 = 
çl£
;

85 
´iv©e
 
	m$š£¹CŞumns
 = 
çl£
;

92 
´iv©e
 
	m$š£¹Rows
 = 
çl£
;

99 
´iv©e
 
	m$š£¹Hy³¾šks
 = 
çl£
;

106 
´iv©e
 
	m$d–‘eCŞumns
 = 
çl£
;

113 
´iv©e
 
	m$d–‘eRows
 = 
çl£
;

120 
´iv©e
 
	m$£ËùLockedC–ls
 = 
çl£
;

127 
´iv©e
 
	m$sÜt
 = 
çl£
;

134 
´iv©e
 
	m$autoF‹r
 = 
çl£
;

141 
´iv©e
 
	m$pivÙTabËs
 = 
çl£
;

148 
´iv©e
 
	m$£ËùUÆockedC–ls
 = 
çl£
;

155 
´iv©e
 
	m$·sswÜd
 = '';

160 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

169 
public
 
funùiÚ
 
	$isPrÙeùiÚEÇbËd
()

171  
$this
->
sh“t
 ||

172 
$this
->
objeùs
 ||

173 
$this
->
sûÇrios
 ||

174 
$this
->
fÜm©C–ls
 ||

175 
$this
->
fÜm©CŞumns
 ||

176 
$this
->
fÜm©Rows
 ||

177 
$this
->
š£¹CŞumns
 ||

178 
$this
->
š£¹Rows
 ||

179 
$this
->
š£¹Hy³¾šks
 ||

180 
$this
->
d–‘eCŞumns
 ||

181 
$this
->
d–‘eRows
 ||

182 
$this
->
£ËùLockedC–ls
 ||

183 
$this
->
sÜt
 ||

184 
$this
->
autoF‹r
 ||

185 
$this
->
pivÙTabËs
 ||

186 
$this
->
£ËùUÆockedC–ls
;

187 
	}
}

194 
public
 
funùiÚ
 
	$g‘Sh“t
()

196  
$this
->
sh“t
;

197 
	}
}

205 
public
 
funùiÚ
 
	$£tSh“t
(
$pV®ue
 = 
çl£
)

207 
$this
->
sh“t
 = 
$pV®ue
;

208  
$this
;

209 
	}
}

216 
public
 
funùiÚ
 
	$g‘Objeùs
()

218  
$this
->
objeùs
;

219 
	}
}

227 
public
 
funùiÚ
 
	$£tObjeùs
(
$pV®ue
 = 
çl£
)

229 
$this
->
objeùs
 = 
$pV®ue
;

230  
$this
;

231 
	}
}

238 
public
 
funùiÚ
 
	$g‘SûÇrios
()

240  
$this
->
sûÇrios
;

241 
	}
}

249 
public
 
funùiÚ
 
	$£tSûÇrios
(
$pV®ue
 = 
çl£
)

251 
$this
->
sûÇrios
 = 
$pV®ue
;

252  
$this
;

253 
	}
}

260 
public
 
funùiÚ
 
	$g‘FÜm©C–ls
()

262  
$this
->
fÜm©C–ls
;

263 
	}
}

271 
public
 
funùiÚ
 
	$£tFÜm©C–ls
(
$pV®ue
 = 
çl£
)

273 
$this
->
fÜm©C–ls
 = 
$pV®ue
;

274  
$this
;

275 
	}
}

282 
public
 
funùiÚ
 
	$g‘FÜm©CŞumns
()

284  
$this
->
fÜm©CŞumns
;

285 
	}
}

293 
public
 
funùiÚ
 
	$£tFÜm©CŞumns
(
$pV®ue
 = 
çl£
)

295 
$this
->
fÜm©CŞumns
 = 
$pV®ue
;

296  
$this
;

297 
	}
}

304 
public
 
funùiÚ
 
	$g‘FÜm©Rows
()

306  
$this
->
fÜm©Rows
;

307 
	}
}

315 
public
 
funùiÚ
 
	$£tFÜm©Rows
(
$pV®ue
 = 
çl£
)

317 
$this
->
fÜm©Rows
 = 
$pV®ue
;

318  
$this
;

319 
	}
}

326 
public
 
funùiÚ
 
	$g‘In£¹CŞumns
()

328  
$this
->
š£¹CŞumns
;

329 
	}
}

337 
public
 
funùiÚ
 
	$£tIn£¹CŞumns
(
$pV®ue
 = 
çl£
)

339 
$this
->
š£¹CŞumns
 = 
$pV®ue
;

340  
$this
;

341 
	}
}

348 
public
 
funùiÚ
 
	$g‘In£¹Rows
()

350  
$this
->
š£¹Rows
;

351 
	}
}

359 
public
 
funùiÚ
 
	$£tIn£¹Rows
(
$pV®ue
 = 
çl£
)

361 
$this
->
š£¹Rows
 = 
$pV®ue
;

362  
$this
;

363 
	}
}

370 
public
 
funùiÚ
 
	$g‘In£¹Hy³¾šks
()

372  
$this
->
š£¹Hy³¾šks
;

373 
	}
}

381 
public
 
funùiÚ
 
	$£tIn£¹Hy³¾šks
(
$pV®ue
 = 
çl£
)

383 
$this
->
š£¹Hy³¾šks
 = 
$pV®ue
;

384  
$this
;

385 
	}
}

392 
public
 
funùiÚ
 
	$g‘D–‘eCŞumns
()

394  
$this
->
d–‘eCŞumns
;

395 
	}
}

403 
public
 
funùiÚ
 
	$£tD–‘eCŞumns
(
$pV®ue
 = 
çl£
)

405 
$this
->
d–‘eCŞumns
 = 
$pV®ue
;

406  
$this
;

407 
	}
}

414 
public
 
funùiÚ
 
	$g‘D–‘eRows
()

416  
$this
->
d–‘eRows
;

417 
	}
}

425 
public
 
funùiÚ
 
	$£tD–‘eRows
(
$pV®ue
 = 
çl£
)

427 
$this
->
d–‘eRows
 = 
$pV®ue
;

428  
$this
;

429 
	}
}

436 
public
 
funùiÚ
 
	$g‘S–eùLockedC–ls
()

438  
$this
->
£ËùLockedC–ls
;

439 
	}
}

447 
public
 
funùiÚ
 
	$£tS–eùLockedC–ls
(
$pV®ue
 = 
çl£
)

449 
$this
->
£ËùLockedC–ls
 = 
$pV®ue
;

450  
$this
;

451 
	}
}

458 
public
 
funùiÚ
 
	$g‘SÜt
()

460  
$this
->
sÜt
;

461 
	}
}

469 
public
 
funùiÚ
 
	$£tSÜt
(
$pV®ue
 = 
çl£
)

471 
$this
->
sÜt
 = 
$pV®ue
;

472  
$this
;

473 
	}
}

480 
public
 
funùiÚ
 
	$g‘AutoF‹r
()

482  
$this
->
autoF‹r
;

483 
	}
}

491 
public
 
funùiÚ
 
	$£tAutoF‹r
(
$pV®ue
 = 
çl£
)

493 
$this
->
autoF‹r
 = 
$pV®ue
;

494  
$this
;

495 
	}
}

502 
public
 
funùiÚ
 
	$g‘PivÙTabËs
()

504  
$this
->
pivÙTabËs
;

505 
	}
}

513 
public
 
funùiÚ
 
	$£tPivÙTabËs
(
$pV®ue
 = 
çl£
)

515 
$this
->
pivÙTabËs
 = 
$pV®ue
;

516  
$this
;

517 
	}
}

524 
public
 
funùiÚ
 
	$g‘S–eùUÆockedC–ls
()

526  
$this
->
£ËùUÆockedC–ls
;

527 
	}
}

535 
public
 
funùiÚ
 
	$£tS–eùUÆockedC–ls
(
$pV®ue
 = 
çl£
)

537 
$this
->
£ËùUÆockedC–ls
 = 
$pV®ue
;

538  
$this
;

539 
	}
}

546 
public
 
funùiÚ
 
	$g‘PasswÜd
()

548  
$this
->
·sswÜd
;

549 
	}
}

558 
public
 
funùiÚ
 
£tPasswÜd
(
$pV®ue
 = '', 
$pAÌ—dyHashed
 = 
çl£
)

560 ià(!
$pAÌ—dyHashed
) {

561 
$pV®ue
 = 
PHPExûl_Sh¬ed_PasswÜdHash”
::
hashPasswÜd
($pValue);

563 
	g$this
->
	g·sswÜd
 = 
$pV®ue
;

564  
	g$this
;

570 
public
 
funùiÚ
 
	$__şÚe
()

572 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

573 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

574 ià(
	`is_objeù
(
$v®ue
)) {

575 
$this
->
$key
 = 
şÚe
 
$v®ue
;

577 
$this
->
$key
 = 
$v®ue
;

580 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Row.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_Row


35 
´iv©e
 
	m$·»Á
;

42 
´iv©e
 
	m$rowIndex
 = 0;

50 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$·»Á
 = 
nuÎ
, 
$rowIndex
 = 1)

53 
$this
->
·»Á
 = 
$·»Á
;

54 
$this
->
rowIndex
 = 
$rowIndex
;

60 
public
 
funùiÚ
 
	$__de¡ruù
()

62 
	`un£t
(
$this
->
·»Á
);

63 
	}
}

70 
public
 
funùiÚ
 
	$g‘RowIndex
()

72  
$this
->
rowIndex
;

73 
	}
}

82 
public
 
funùiÚ
 
g‘C–lI‹¿tÜ
(
$¡¬tCŞumn
 = 'A', 
$’dCŞumn
 = 
nuÎ
)

84  
Ãw
 
PHPExûl_WÜksh“t_RowC–lI‹¿tÜ
(
$this
->
·»Á
, $this->
rowIndex
, 
$¡¬tCŞumn
, 
$’dCŞumn
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/RowCellIterator.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_RowC–lI‹¿tÜ
 
ex‹nds
 
PHPExûl_WÜksh“t_C–lI‹¿tÜ
 
im¶em’ts
 
	mI‹¿tÜ


35 
´Ùeùed
 
	m$rowIndex
;

42 
´Ùeùed
 
	m$¡¬tCŞumn
 = 0;

49 
´Ùeùed
 
	m$’dCŞumn
 = 0;

59 
public
 
funùiÚ
 
__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$subjeù
 = 
nuÎ
, 
$rowIndex
 = 1, 
$¡¬tCŞumn
 = 'A', 
$’dCŞumn
 =‚ull)

62 
$this
->
subjeù
 = 
$subjeù
;

63 
	m$this
->
	mrowIndex
 = 
$rowIndex
;

64 
	m$this
->
»£tEnd
(
$’dCŞumn
);

65 
	m$this
->
»£tS¹
(
$¡¬tCŞumn
);

71 
public
 
funùiÚ
 
	$__de¡ruù
()

73 
	`un£t
(
$this
->
subjeù
);

74 
	}
}

83 
public
 
funùiÚ
 
»£tS¹
(
$¡¬tCŞumn
 = 'A')

85 
$¡¬tCŞumnIndex
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$¡¬tCŞumn
) - 1;

86 
	g$this
->
	g¡¬tCŞumn
 = 
$¡¬tCŞumnIndex
;

87 
	g$this
->
adju¡FÜExi¡šgOÆyRªge
();

88 
	g$this
->
£ek
(
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$this
->
¡¬tCŞumn
));

90  
	g$this
;

100 
public
 
funùiÚ
 
	$»£tEnd
(
$’dCŞumn
 = 
nuÎ
)

102 
$’dCŞumn
 = ($’dCŞumnè? $’dCŞumÀ: 
$this
->
subjeù
->
	`g‘Highe¡CŞumn
();

103 
$this
->
’dCŞumn
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$’dCŞumn
) - 1;

104 
$this
->
	`adju¡FÜExi¡šgOÆyRªge
();

106  
$this
;

107 
	}
}

116 
public
 
funùiÚ
 
£ek
(
$cŞumn
 = 'A')

118 
$cŞumn
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
($column) - 1;

119 ià((
	g$cŞumn
 < 
	g$this
->
	g¡¬tCŞumn
è|| ($cŞumÀ> $this->
	g’dCŞumn
)) {

120 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
("Column $column is out of„ange ({$this->startColumn} - {$this->endColumn})");

121 } 
–£if
 (
$this
->
ÚlyExi¡šgC–ls
 && !($this->
subjeù
->
ûÎExi¡sByCŞumnAndRow
(
$cŞumn
, $this->
rowIndex
))) {

122 
throw
 
Ãw
 
PHPExûl_Exû±iÚ
('In "IterateOnlyExistingCells" mode‡nd Cell does‚otƒxist');

124 
	g$this
->
	gpos™iÚ
 = 
$cŞumn
;

126  
	g$this
;

132 
public
 
funùiÚ
 
	$»wšd
()

134 
$this
->
pos™iÚ
 = $this->
¡¬tCŞumn
;

135 
	}
}

142 
public
 
funùiÚ
 
	$cu¼’t
()

144  
$this
->
subjeù
->
	`g‘C–lByCŞumnAndRow
($this->
pos™iÚ
, $this->
rowIndex
);

145 
	}
}

152 
public
 
funùiÚ
 
	$key
()

154  
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$this
->
pos™iÚ
);

155 
	}
}

160 
public
 
funùiÚ
 
	$Ãxt
()

163 ++
$this
->
pos™iÚ
;

164 } (
$this
->
ÚlyExi¡šgC–ls
) &&

165 (!
$this
->
subjeù
->
	`ûÎExi¡sByCŞumnAndRow
($this->
pos™iÚ
, $this->
rowIndex
)) &&

166 (
$this
->
pos™iÚ
 <ğ$this->
’dCŞumn
));

167 
	}
}

174 
public
 
funùiÚ
 
	$´ev
()

176 ià(
$this
->
pos™iÚ
 <ğ$this->
¡¬tCŞumn
) {

177 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
(

179 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$this
->
’dCŞumn
) . " - " .

180 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$this
->
’dCŞumn
) . ")"

185 --
$this
->
pos™iÚ
;

186 } (
$this
->
ÚlyExi¡šgC–ls
) &&

187 (!
$this
->
subjeù
->
	`ûÎExi¡sByCŞumnAndRow
($this->
pos™iÚ
, $this->
rowIndex
)) &&

188 (
$this
->
pos™iÚ
 >ğ$this->
¡¬tCŞumn
));

189 
	}
}

196 
public
 
funùiÚ
 
	$v®id
()

198  
$this
->
pos™iÚ
 <ğ$this->
’dCŞumn
;

199 
	}
}

206 
´Ùeùed
 
funùiÚ
 
	$adju¡FÜExi¡šgOÆyRªge
()

208 ià(
$this
->
ÚlyExi¡šgC–ls
) {

209 (!
$this
->
subjeù
->
	`ûÎExi¡sByCŞumnAndRow
($this->
¡¬tCŞumn
, $this->
rowIndex
)) &&

210 (
$this
->
¡¬tCŞumn
 <ğ$this->
’dCŞumn
)) {

211 ++
$this
->
¡¬tCŞumn
;

213 ià(
$this
->
¡¬tCŞumn
 > $this->
’dCŞumn
) {

214 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('No cellsƒxist withinhe specified„ange');

216 (!
$this
->
subjeù
->
	`ûÎExi¡sByCŞumnAndRow
($this->
’dCŞumn
, $this->
rowIndex
)) &&

217 (
$this
->
’dCŞumn
 >ğ$this->
¡¬tCŞumn
)) {

218 --
$this
->
’dCŞumn
;

220 ià(
$this
->
’dCŞumn
 < $this->
¡¬tCŞumn
) {

221 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
('No cellsƒxist withinhe specified„ange');

224 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/RowDimension.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_RowDim’siÚ
 
ex‹nds
 
	mPHPExûl_WÜksh“t_Dim’siÚ


35 
´iv©e
 
	m$rowIndex
;

44 
´iv©e
 
	m$height
 = -1;

51 
´iv©e
 
	m$z”oHeight
 = 
çl£
;

58 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$pIndex
 = 0)

61 
$this
->
rowIndex
 = 
$pIndex
;

64 
·»Á
::
	`__cÚ¡ruù
(
nuÎ
);

72 
public
 
funùiÚ
 
	$g‘RowIndex
()

74  
$this
->
rowIndex
;

75 
	}
}

83 
public
 
funùiÚ
 
	$£tRowIndex
(
$pV®ue
)

85 
$this
->
rowIndex
 = 
$pV®ue
;

86  
$this
;

87 
	}
}

94 
public
 
funùiÚ
 
	$g‘RowHeight
()

96  
$this
->
height
;

97 
	}
}

105 
public
 
funùiÚ
 
£tRowHeight
(
$pV®ue
 = -1)

107 
$this
->
height
 = 
$pV®ue
;

108  
	g$this
;

116 
public
 
funùiÚ
 
	$g‘Z”oHeight
()

118  
$this
->
z”oHeight
;

119 
	}
}

127 
public
 
funùiÚ
 
	$£tZ”oHeight
(
$pV®ue
 = 
çl£
)

129 
$this
->
z”oHeight
 = 
$pV®ue
;

130  
$this
;

131 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/RowIterator.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_RowI‹¿tÜ
 
im¶em’ts
 
	mI‹¿tÜ


35 
´iv©e
 
	m$subjeù
;

42 
´iv©e
 
	m$pos™iÚ
 = 1;

49 
´iv©e
 
	m$¡¬tRow
 = 1;

57 
´iv©e
 
	m$’dRow
 = 1;

67 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_WÜksh“t
 
$subjeù
 = 
nuÎ
, 
$¡¬tRow
 = 1, 
$’dRow
 =‚ull)

70 
$this
->
subjeù
 = 
$subjeù
;

71 
$this
->
	`»£tEnd
(
$’dRow
);

72 
$this
->
	`»£tS¹
(
$¡¬tRow
);

78 
public
 
funùiÚ
 
	$__de¡ruù
()

80 
	`un£t
(
$this
->
subjeù
);

81 
	}
}

89 
public
 
funùiÚ
 
	$»£tS¹
(
$¡¬tRow
 = 1)

91 
$this
->
¡¬tRow
 = 
$¡¬tRow
;

92 
$this
->
	`£ek
(
$¡¬tRow
);

94  
$this
;

95 
	}
}

103 
public
 
funùiÚ
 
	$»£tEnd
(
$’dRow
 = 
nuÎ
)

105 
$this
->
’dRow
 = (
$’dRow
è? $’dRow : $this->
subjeù
->
	`g‘Highe¡Row
();

107  
$this
;

108 
	}
}

117 
public
 
funùiÚ
 
	$£ek
(
$row
 = 1)

119 ià((
$row
 < 
$this
->
¡¬tRow
è|| ($row > $this->
’dRow
)) {

120 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Row $row is out of„ange ({$this->startRow} - {$this->endRow})");

122 
$this
->
pos™iÚ
 = 
$row
;

124  
$this
;

125 
	}
}

130 
public
 
funùiÚ
 
	$»wšd
()

132 
$this
->
pos™iÚ
 = $this->
¡¬tRow
;

133 
	}
}

140 
public
 
funùiÚ
 
	$cu¼’t
()

142  
Ãw
 
	`PHPExûl_WÜksh“t_Row
(
$this
->
subjeù
, $this->
pos™iÚ
);

143 
	}
}

150 
public
 
funùiÚ
 
	$key
()

152  
$this
->
pos™iÚ
;

153 
	}
}

158 
public
 
funùiÚ
 
	$Ãxt
()

160 ++
$this
->
pos™iÚ
;

161 
	}
}

166 
public
 
funùiÚ
 
	$´ev
()

168 ià(
$this
->
pos™iÚ
 <ğ$this->
¡¬tRow
) {

169 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Row is‡lready‡the beginning of„ange ({$this->startRow} - {$this->endRow})");

172 --
$this
->
pos™iÚ
;

173 
	}
}

180 
public
 
funùiÚ
 
	$v®id
()

182  
$this
->
pos™iÚ
 <ğ$this->
’dRow
;

183 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/SheetView.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“t_Sh“tV›w


32 cÚ¡ 
	mSHEETVIEW_NORMAL
 = 'normal';

33 cÚ¡ 
	mSHEETVIEW_PAGE_LAYOUT
 = 'pageLayout';

34 cÚ¡ 
	mSHEETVIEW_PAGE_BREAK_PREVIEW
 = 'pageBreakPreview';

36 
´iv©e
 
	m$sh“tV›wTy³s
 = 
¬¿y
(

37 
£lf
::
SHEETVIEW_NORMAL
,

38 
£lf
::
SHEETVIEW_PAGE_LAYOUT
,

39 
£lf
::
SHEETVIEW_PAGE_BREAK_PREVIEW
,

49 
´iv©e
 
	m$zoomSÿË
 = 100;

58 
´iv©e
 
	m$zoomSÿËNÜm®
 = 100;

67 
´iv©e
 
	m$sh“tv›wTy³
 = 
£lf
::
SHEETVIEW_NORMAL
;

72 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

81 
public
 
funùiÚ
 
	$g‘ZoomSÿË
()

83  
$this
->
zoomSÿË
;

84 
	}
}

95 
public
 
funùiÚ
 
	$£tZoomSÿË
(
$pV®ue
 = 100)

99 ià((
$pV®ue
 >ğ1è|| 
	`is_nuÎ
($pValue)) {

100 
$this
->
zoomSÿË
 = 
$pV®ue
;

102 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Scale must be greaterhan orƒqualo 1.");

104  
$this
;

105 
	}
}

112 
public
 
funùiÚ
 
	$g‘ZoomSÿËNÜm®
()

114  
$this
->
zoomSÿËNÜm®
;

115 
	}
}

126 
public
 
funùiÚ
 
	$£tZoomSÿËNÜm®
(
$pV®ue
 = 100)

128 ià((
$pV®ue
 >ğ1è|| 
	`is_nuÎ
($pValue)) {

129 
$this
->
zoomSÿËNÜm®
 = 
$pV®ue
;

131 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Scale must be greaterhan orƒqualo 1.");

133  
$this
;

134 
	}
}

141 
public
 
funùiÚ
 
	$g‘V›w
()

143  
$this
->
sh“tv›wTy³
;

144 
	}
}

158 
public
 
funùiÚ
 
	$£tV›w
(
$pV®ue
 = 
nuÎ
)

161 ià(
$pV®ue
 ==ğ
nuÎ
) {

162 
$pV®ue
 = 
£lf
::
SHEETVIEW_NORMAL
;

164 ià(
	`š_¬¿y
(
$pV®ue
, 
£lf
::
$sh“tV›wTy³s
)) {

165 
$this
->
sh“tv›wTy³
 = 
$pV®ue
;

167 
throw
 
Ãw
 
	`PHPExûl_Exû±iÚ
("Invalid sheetview†ayoutype.");

170  
$this
;

171 
	}
}

176 
public
 
funùiÚ
 
	$__şÚe
()

178 
$v¬s
 = 
	`g‘_objeù_v¬s
(
$this
);

179 
	`fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®ue
) {

180 ià(
	`is_objeù
(
$v®ue
)) {

181 
$this
->
$key
 = 
şÚe
 
$v®ue
;

183 
$this
->
$key
 = 
$v®ue
;

186 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/WorksheetIterator.php

1 <?
php


28 şas 
	cPHPExûl_WÜksh“tI‹¿tÜ
 
im¶em’ts
 
	mI‹¿tÜ


35 
´iv©e
 
	m$subjeù
;

42 
´iv©e
 
	m$pos™iÚ
 = 0;

49 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$subjeù
 = 
nuÎ
)

52 
$this
->
subjeù
 = 
$subjeù
;

58 
public
 
funùiÚ
 
	$__de¡ruù
()

60 
	`un£t
(
$this
->
subjeù
);

61 
	}
}

66 
public
 
funùiÚ
 
	$»wšd
()

68 
$this
->
pos™iÚ
 = 0;

69 
	}
}

76 
public
 
funùiÚ
 
	$cu¼’t
()

78  
$this
->
subjeù
->
	`g‘Sh“t
($this->
pos™iÚ
);

79 
	}
}

86 
public
 
funùiÚ
 
	$key
()

88  
$this
->
pos™iÚ
;

89 
	}
}

94 
public
 
funùiÚ
 
	$Ãxt
()

96 ++
$this
->
pos™iÚ
;

97 
	}
}

104 
public
 
funùiÚ
 
	$v®id
()

106  
$this
->
pos™iÚ
 < $this->
subjeù
->
	`g‘Sh“tCouÁ
();

107 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Abstract.php

1 <?
php


28 
ab¡¿ù
 cÏs 
	cPHPExûl_Wr™”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_Wr™”_IWr™”


36 
´Ùeùed
 
	m$šşudeCh¬ts
 = 
çl£
;

45 
´Ùeùed
 
	m$´eC®cuÏ‹FÜmuÏs
 = 
Œue
;

52 
´Ùeùed
 
	m$_u£DiskCachšg
 = 
çl£
;

59 
´Ùeùed
 
	m$_diskCachšgDœeùÜy
 = './';

68 
public
 
funùiÚ
 
	$g‘InşudeCh¬ts
()

70  
$this
->
šşudeCh¬ts
;

81 
public
 
funùiÚ
 
	$£tInşudeCh¬ts
(
$pV®ue
 = 
çl£
)

83 
$this
->
šşudeCh¬ts
 = (
boŞ—n
è
$pV®ue
;

84  
$this
;

85 
	}
}

97 
public
 
funùiÚ
 
	$g‘P»C®cuÏ‹FÜmuÏs
()

99  
$this
->
´eC®cuÏ‹FÜmuÏs
;

100 
	}
}

110 
public
 
funùiÚ
 
	$£tP»C®cuÏ‹FÜmuÏs
(
$pV®ue
 = 
Œue
)

112 
$this
->
´eC®cuÏ‹FÜmuÏs
 = (
boŞ—n
è
$pV®ue
;

113  
$this
;

114 
	}
}

121 
public
 
funùiÚ
 
	$g‘U£DiskCachšg
()

123  
$this
->
_u£DiskCachšg
;

124 
	}
}

134 
public
 
funùiÚ
 
	$£tU£DiskCachšg
(
$pV®ue
 = 
çl£
, 
$pDœeùÜy
 = 
nuÎ
)

136 
$this
->
_u£DiskCachšg
 = 
$pV®ue
;

138 ià(
$pDœeùÜy
 !=ğ
nuÎ
) {

139 ià(
	`is_dœ
(
$pDœeùÜy
)) {

140 
$this
->
_diskCachšgDœeùÜy
 = 
$pDœeùÜy
;

142 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Directory does‚otƒxist: $pDirectory");

145  
$this
;

146 
	}
}

153 
public
 
funùiÚ
 
	$g‘DiskCachšgDœeùÜy
()

155  
$this
->
_diskCachšgDœeùÜy
;

156 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/CSV.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_CSV
 
ex‹nds
 
PHPExûl_Wr™”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_Wr™”_IWr™”


35 
´iv©e
 
	m$phpExûl
;

42 
´iv©e
 
	m$d–im™”
 = ',';

49 
´iv©e
 
	m$’şosu»
 = '"';

56 
´iv©e
 
	m$lšeEndšg
 = 
PHP_EOL
;

63 
´iv©e
 
	m$sh“tIndex
 = 0;

70 
´iv©e
 
	m$u£BOM
 = 
çl£
;

77 
´iv©e
 
	m$exûlCom·tib™y
 = 
çl£
;

84 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$phpExûl
)

86 
$this
->
phpExûl
 = 
$phpExûl
;

95 
public
 
funùiÚ
 
	$§ve
(
$pF’ame
 = 
nuÎ
)

98 
$sh“t
 = 
$this
->
phpExûl
->
	`g‘Sh“t
($this->
sh“tIndex
);

100 
$§veDebugLog
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
phpExûl
)->
	`g‘DebugLog
()->
	`g‘Wr™eDebugLog
();

101 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
phpExûl
)->
	`g‘DebugLog
()->
	`£tWr™eDebugLog
(
çl£
);

102 
$§veA¼ayR‘uºTy³
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘A¼ayR‘uºTy³
();

103 
PHPExûl_C®cuÏtiÚ
::
	`£tA¼ayR‘uºTy³
(PHPExûl_C®cuÏtiÚ::
RETURN_ARRAY_AS_VALUE
);

106 
$feHªdË
 = 
	`fİ’
(
$pF’ame
, 'wb+');

107 ià(
$feHªdË
 ==ğ
çl£
) {

108 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Could‚ot open file $pFilename for writing.");

111 ià(
$this
->
exûlCom·tib™y
) {

112 
	`fwr™e
(
$feHªdË
, "\xEF\xBB\xBF");

113 
$this
->
	`£tEnşosu»
('"');

114 
$this
->
	`£tD–im™”
(";");

115 
$this
->
	`£tLšeEndšg
("\r\n");

116 
	`fwr™e
(
$feHªdË
, '£p=' . 
$this
->
	`g‘D–im™”
(è. $this->
lšeEndšg
);

117 } 
	`–£if
 (
$this
->
u£BOM
) {

119 
	`fwr™e
(
$feHªdË
, "\xEF\xBB\xBF");

123 
$maxCŞ
 = 
$sh“t
->
	`g‘Highe¡D©aCŞumn
();

124 
$maxRow
 = 
$sh“t
->
	`g‘Highe¡D©aRow
();

127 
$row
 = 1; $row <ğ
$maxRow
; ++$row) {

129 
$ûÎsA¼ay
 = 
$sh“t
->
	`¿ngeToA¼ay
('A'.
$row
.':'.
$maxCŞ
.$row, '', 
$this
->
´eC®cuÏ‹FÜmuÏs
);

131 
$this
->
	`wr™eLše
(
$feHªdË
, 
$ûÎsA¼ay
[0]);

135 
	`fşo£
(
$feHªdË
);

137 
PHPExûl_C®cuÏtiÚ
::
	`£tA¼ayR‘uºTy³
(
$§veA¼ayR‘uºTy³
);

138 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
phpExûl
)->
	`g‘DebugLog
()->
	`£tWr™eDebugLog
(
$§veDebugLog
);

139 
	}
}

146 
public
 
funùiÚ
 
	$g‘D–im™”
()

148  
$this
->
d–im™”
;

149 
	}
}

157 
public
 
funùiÚ
 
£tD–im™”
(
$pV®ue
 = ',')

159 
$this
->
d–im™”
 = 
$pV®ue
;

160  
	g$this
;

168 
public
 
funùiÚ
 
	$g‘Enşosu»
()

170  
$this
->
’şosu»
;

171 
	}
}

179 
public
 
funùiÚ
 
£tEnşosu»
(
$pV®ue
 = '"')

181 ià(
$pV®ue
 == '') {

182 
$pV®ue
 = 
nuÎ
;

184 
	g$this
->
	g’şosu»
 = 
$pV®ue
;

185  
	g$this
;

193 
public
 
funùiÚ
 
	$g‘LšeEndšg
()

195  
$this
->
lšeEndšg
;

196 
	}
}

204 
public
 
funùiÚ
 
	$£tLšeEndšg
(
$pV®ue
 = 
PHP_EOL
)

206 
$this
->
lšeEndšg
 = 
$pV®ue
;

207  
$this
;

208 
	}
}

215 
public
 
funùiÚ
 
	$g‘U£BOM
()

217  
$this
->
u£BOM
;

218 
	}
}

226 
public
 
funùiÚ
 
	$£tU£BOM
(
$pV®ue
 = 
çl£
)

228 
$this
->
u£BOM
 = 
$pV®ue
;

229  
$this
;

230 
	}
}

237 
public
 
funùiÚ
 
	$g‘ExûlCom·tib™y
()

239  
$this
->
exûlCom·tib™y
;

240 
	}
}

249 
public
 
funùiÚ
 
	$£tExûlCom·tib™y
(
$pV®ue
 = 
çl£
)

251 
$this
->
exûlCom·tib™y
 = 
$pV®ue
;

252  
$this
;

253 
	}
}

260 
public
 
funùiÚ
 
	$g‘Sh“tIndex
()

262  
$this
->
sh“tIndex
;

263 
	}
}

271 
public
 
funùiÚ
 
	$£tSh“tIndex
(
$pV®ue
 = 0)

273 
$this
->
sh“tIndex
 = 
$pV®ue
;

274  
$this
;

275 
	}
}

284 
´iv©e
 
funùiÚ
 
	$wr™eLše
(
$pFeHªdË
 = 
nuÎ
, 
$pV®ues
 =‚ull)

286 ià(
	`is_¬¿y
(
$pV®ues
)) {

288 
$wr™eD–im™”
 = 
çl£
;

291 
$lše
 = '';

293 
	`fÜ—ch
 (
$pV®ues
 
as
 
$–em’t
) {

295 
$–em’t
 = 
	`¡r_»¶aû
(
$this
->
’şosu»
, $this->enclosure . $this->enclosure, $element);

298 ià(
$wr™eD–im™”
) {

299 
$lše
 .ğ
$this
->
d–im™”
;

301 
$wr™eD–im™”
 = 
Œue
;

305 
$lše
 .ğ
$this
->
’şosu»
 . 
$–em’t
 . $this->enclosure;

309 
$lše
 .ğ
$this
->
lšeEndšg
;

312 
	`fwr™e
(
$pFeHªdË
, 
$lše
);

314 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Invalid data„ow…assedo CSV writer.");

316 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007
 
ex‹nds
 
PHPExûl_Wr™”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_Wr™”_IWr™”


39 
´Ùeùed
 
	m$´eC®cuÏ‹FÜmuÏs
 = 
çl£
;

46 
´iv©e
 
	m$offiû2003com·tib™y
 = 
çl£
;

53 
´iv©e
 
	m$wr™”P¬ts
 = 
¬¿y
();

60 
´iv©e
 
	m$¥»adSh“t
;

67 
´iv©e
 
	m$¡ršgTabË
 = 
¬¿y
();

74 
´iv©e
 
	m$¡yËsCÚd™iÚ®HashTabË
;

81 
´iv©e
 
	m$¡yËHashTabË
;

88 
´iv©e
 
	m$flHashTabË
;

95 
´iv©e
 
	m$fÚtHashTabË
;

102 
´iv©e
 
	m$bÜd”sHashTabË
 ;

109 
´iv©e
 
	m$numFmtHashTabË
;

116 
´iv©e
 
	m$d¿wšgHashTabË
;

123 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

126 
$this
->
	`£tPHPExûl
(
$pPHPExûl
);

128 
$wr™”P¬tsA¼ay
 = 
	`¬¿y
( 'stringtable' => 'PHPExcel_Writer_Excel2007_StringTable',

145 
	`fÜ—ch
 (
$wr™”P¬tsA¼ay
 
as
 
$wr™”
 => 
$şass
) {

146 
$this
->
wr™”P¬ts
[
$wr™”
] = 
Ãw
 
	`$şass
($this);

149 
$hashTabËsA¼ay
 = 
	`¬¿y
( 'stylesConditionalHashTable', 'fillHashTable', 'fontHashTable',

155 
	`fÜ—ch
 (
$hashTabËsA¼ay
 
as
 
$bËName
) {

156 
$this
->
$bËName
 = 
Ãw
 
	`PHPExûl_HashTabË
();

166 
public
 
funùiÚ
 
	`g‘Wr™”P¬t
(
$pP¬tName
 = '')

168 ià(
$pP¬tName
 !ğ'' && 
	`is£t
(
$this
->
wr™”P¬ts
[
	`¡¹Şow”
($pPartName)])) {

169  
$this
->
wr™”P¬ts
[
	`¡¹Şow”
(
$pP¬tName
)];

171  
nuÎ
;

173 
	}
}

181 
public
 
funùiÚ
 
	$§ve
(
$pF’ame
 = 
nuÎ
)

183 ià(
$this
->
¥»adSh“t
 !=ğ
nuÎ
) {

185 
$this
->
¥»adSh“t
->
	`g¬bageCŞËù
();

188 
$Üigš®F’ame
 = 
$pF’ame
;

189 ià(
	`¡¹Şow”
(
$pF’ame
) == 'php://output' || strtolower($pFilename) == 'php://stdout') {

190 
$pF’ame
 = @
	`‹m²am
(
PHPExûl_Sh¬ed_Fe
::
	`sys_g‘_‹mp_dœ
(), 'phpxltmp');

191 ià(
$pF’ame
 == '') {

192 
$pF’ame
 = 
$Üigš®F’ame
;

196 
$§veDebugLog
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
¥»adSh“t
)->
	`g‘DebugLog
()->
	`g‘Wr™eDebugLog
();

197 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
¥»adSh“t
)->
	`g‘DebugLog
()->
	`£tWr™eDebugLog
(
çl£
);

198 
$§veD©eR‘uºTy³
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
();

199 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`£tR‘uºD©eTy³
(PHPExûl_C®cuÏtiÚ_FunùiÚs::
RETURNDATE_EXCEL
);

202 
$this
->
¡ršgTabË
 = 
	`¬¿y
();

203 
$i
 = 0; $˜< 
$this
->
¥»adSh“t
->
	`g‘Sh“tCouÁ
(); ++$i) {

204 
$this
->
¡ršgTabË
 = $this->
	`g‘Wr™”P¬t
('SŒšgTabË')->
	`ü—‹SŒšgTabË
($this->
¥»adSh“t
->
	`g‘Sh“t
(
$i
), $this->stringTable);

208 
$this
->
¡yËHashTabË
->
	`addFromSourû
($this->
	`g‘Wr™”P¬t
('StyË')->
	`®lStyËs
($this->
¥»adSh“t
));

209 
$this
->
¡yËsCÚd™iÚ®HashTabË
->
	`addFromSourû
($this->
	`g‘Wr™”P¬t
('StyË')->
	`®lCÚd™iÚ®StyËs
($this->
¥»adSh“t
));

210 
$this
->
flHashTabË
->
	`addFromSourû
($this->
	`g‘Wr™”P¬t
('StyË')->
	`®lFls
($this->
¥»adSh“t
));

211 
$this
->
fÚtHashTabË
->
	`addFromSourû
($this->
	`g‘Wr™”P¬t
('StyË')->
	`®lFÚts
($this->
¥»adSh“t
));

212 
$this
->
bÜd”sHashTabË
->
	`addFromSourû
($this->
	`g‘Wr™”P¬t
('StyË')->
	`®lBÜd”s
($this->
¥»adSh“t
));

213 
$this
->
numFmtHashTabË
->
	`addFromSourû
($this->
	`g‘Wr™”P¬t
('StyË')->
	`®lNumb”FÜm©s
($this->
¥»adSh“t
));

216 
$this
->
d¿wšgHashTabË
->
	`addFromSourû
($this->
	`g‘Wr™”P¬t
('D¿wšg')->
	`®lD¿wšgs
($this->
¥»adSh“t
));

219 
$zCÏss
 = 
PHPExûl_S‘tšgs
::
	`g‘ZCÏss
();

220 
$objZ
 = 
Ãw
 
	`$zCÏss
();

224 
$ro
 = 
Ãw
 
	`ReæeùiÚObjeù
(
$objZ
);

225 
$zOv”Wr™e
 = 
$ro
->
	`g‘CÚ¡ªt
('OVERWRITE');

226 
$zC»©e
 = 
$ro
->
	`g‘CÚ¡ªt
('CREATE');

228 ià(
	`fe_exi¡s
(
$pF’ame
)) {

229 
	`uÆšk
(
$pF’ame
);

232 ià(
$objZ
->
	`İ’
(
$pF’ame
, 
$zOv”Wr™e
è!=ğ
Œue
) {

233 ià(
$objZ
->
	`İ’
(
$pF’ame
, 
$zC»©e
è!=ğ
Œue
) {

234 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Could‚Ù o³À" . 
$pF’ame
 . " for writing.");

239 
$objZ
->
	`addFromSŒšg
('[CÚ‹Á_Ty³s].xml', 
$this
->
	`g‘Wr™”P¬t
('CÚ‹ÁTy³s')->
	`wr™eCÚ‹ÁTy³s
($this->
¥»adSh“t
, $this->
šşudeCh¬ts
));

242 ià(
$this
->
¥»adSh“t
->
	`hasMaüos
()) {

243 
$maüosCode
=
$this
->
¥»adSh“t
->
	`g‘MaüosCode
();

244 ià(!
	`is_nuÎ
(
$maüosCode
)) {

245 
$objZ
->
	`addFromSŒšg
('xl/vbaProjeù.bš', 
$maüosCode
);

246 ià(
$this
->
¥»adSh“t
->
	`hasMaüosC”tifiÿ‹
()) {

248 
$objZ
->
	`addFromSŒšg
('xl/vbaProjeùSigÇtu».bš', 
$this
->
¥»adSh“t
->
	`g‘MaüosC”tifiÿ‹
());

249 
$objZ
->
	`addFromSŒšg
('xl/_»ls/vbaProjeù.bš.»ls', 
$this
->
	`g‘Wr™”P¬t
('R–sVBA')->
	`wr™eVBAR–©iÚshs
($this->
¥»adSh“t
));

254 ià(
$this
->
¥»adSh“t
->
	`hasRibbÚ
()) {

255 
$tmpRibbÚT¬g‘
=
$this
->
¥»adSh“t
->
	`g‘RibbÚXMLD©a
('target');

256 
$objZ
->
	`addFromSŒšg
(
$tmpRibbÚT¬g‘
, 
$this
->
¥»adSh“t
->
	`g‘RibbÚXMLD©a
('data'));

257 ià(
$this
->
¥»adSh“t
->
	`hasRibbÚBšObjeùs
()) {

258 
$tmpRoÙP©h
=
	`dœÇme
(
$tmpRibbÚT¬g‘
).'/';

259 
$ribbÚBšObjeùs
=
$this
->
¥»adSh“t
->
	`g‘RibbÚBšObjeùs
('data');

260 
	`fÜ—ch
 (
$ribbÚBšObjeùs
 
as
 
$aP©h
 => 
$aCÚ‹Á
) {

261 
$objZ
->
	`addFromSŒšg
(
$tmpRoÙP©h
.
$aP©h
, 
$aCÚ‹Á
);

264 
$objZ
->
	`addFromSŒšg
(
$tmpRoÙP©h
.'_»ls/'.
	`ba£Çme
(
$tmpRibbÚT¬g‘
).'.»ls', 
$this
->
	`g‘Wr™”P¬t
('R–sRibbÚObjeùs')->
	`wr™eRibbÚR–©iÚshs
($this->
¥»adSh“t
));

269 
$objZ
->
	`addFromSŒšg
('_»ls/.»ls', 
$this
->
	`g‘Wr™”P¬t
('R–s')->
	`wr™eR–©iÚshs
($this->
¥»adSh“t
));

270 
$objZ
->
	`addFromSŒšg
('xl/_»ls/wÜkbook.xml.»ls', 
$this
->
	`g‘Wr™”P¬t
('R–s')->
	`wr™eWÜkbookR–©iÚshs
($this->
¥»adSh“t
));

273 
$objZ
->
	`addFromSŒšg
('docPrİs/­p.xml', 
$this
->
	`g‘Wr™”P¬t
('DocPrİs')->
	`wr™eDocPrİsAµ
($this->
¥»adSh“t
));

274 
$objZ
->
	`addFromSŒšg
('docPrİs/cÜe.xml', 
$this
->
	`g‘Wr™”P¬t
('DocPrİs')->
	`wr™eDocPrİsCÜe
($this->
¥»adSh“t
));

275 
$cu¡omPrİ”t›sP¬t
 = 
$this
->
	`g‘Wr™”P¬t
('DocPrİs')->
	`wr™eDocPrİsCu¡om
($this->
¥»adSh“t
);

276 ià(
$cu¡omPrİ”t›sP¬t
 !=ğ
nuÎ
) {

277 
$objZ
->
	`addFromSŒšg
('docPrİs/cu¡om.xml', 
$cu¡omPrİ”t›sP¬t
);

281 
$objZ
->
	`addFromSŒšg
('xl/theme/theme1.xml', 
$this
->
	`g‘Wr™”P¬t
('Theme')->
	`wr™eTheme
($this->
¥»adSh“t
));

284 
$objZ
->
	`addFromSŒšg
('xl/sh¬edSŒšgs.xml', 
$this
->
	`g‘Wr™”P¬t
('SŒšgTabË')->
	`wr™eSŒšgTabË
($this->
¡ršgTabË
));

287 
$objZ
->
	`addFromSŒšg
('xl/¡yËs.xml', 
$this
->
	`g‘Wr™”P¬t
('StyË')->
	`wr™eStyËs
($this->
¥»adSh“t
));

290 
$objZ
->
	`addFromSŒšg
('xl/wÜkbook.xml', 
$this
->
	`g‘Wr™”P¬t
('WÜkbook')->
	`wr™eWÜkbook
($this->
¥»adSh“t
, $this->
´eC®cuÏ‹FÜmuÏs
));

292 
$ch¬tCouÁ
 = 0;

294 
$i
 = 0; $˜< 
$this
->
¥»adSh“t
->
	`g‘Sh“tCouÁ
(); ++$i) {

295 
$objZ
->
	`addFromSŒšg
('xl/wÜksh“ts/sh“t' . (
$i
 + 1è. '.xml', 
$this
->
	`g‘Wr™”P¬t
('WÜksh“t')->
	`wr™eWÜksh“t
($this->
¥»adSh“t
->
	`g‘Sh“t
($i), $this->
¡ršgTabË
, $this->
šşudeCh¬ts
));

296 ià(
$this
->
šşudeCh¬ts
) {

297 
$ch¬ts
 = 
$this
->
¥»adSh“t
->
	`g‘Sh“t
(
$i
)->
	`g‘Ch¬tCŞËùiÚ
();

298 ià(
	`couÁ
(
$ch¬ts
) > 0) {

299 
	`fÜ—ch
 (
$ch¬ts
 
as
 
$ch¬t
) {

300 
$objZ
->
	`addFromSŒšg
('xl/ch¬ts/ch¬t' . (
$ch¬tCouÁ
 + 1è. '.xml', 
$this
->
	`g‘Wr™”P¬t
('Ch¬t')->
	`wr™eCh¬t
(
$ch¬t
));

301 
$ch¬tCouÁ
++;

307 
$ch¬tRef1
 = 
$ch¬tRef2
 = 0;

309 
$i
 = 0; $˜< 
$this
->
¥»adSh“t
->
	`g‘Sh“tCouÁ
(); ++$i) {

311 
$objZ
->
	`addFromSŒšg
('xl/wÜksh“ts/_»ls/sh“t' . (
$i
 + 1è. '.xml.»ls', 
$this
->
	`g‘Wr™”P¬t
('R–s')->
	`wr™eWÜksh“tR–©iÚshs
($this->
¥»adSh“t
->
	`g‘Sh“t
($i), ($˜+ 1), $this->
šşudeCh¬ts
));

313 
$d¿wšgs
 = 
$this
->
¥»adSh“t
->
	`g‘Sh“t
(
$i
)->
	`g‘D¿wšgCŞËùiÚ
();

314 
$d¿wšgCouÁ
 = 
	`couÁ
(
$d¿wšgs
);

315 ià(
$this
->
šşudeCh¬ts
) {

316 
$ch¬tCouÁ
 = 
$this
->
¥»adSh“t
->
	`g‘Sh“t
(
$i
)->
	`g‘Ch¬tCouÁ
();

320 ià((
$d¿wšgCouÁ
 > 0è|| (
$ch¬tCouÁ
 > 0)) {

322 
$objZ
->
	`addFromSŒšg
('xl/d¿wšgs/_»ls/d¿wšg' . (
$i
 + 1è. '.xml.»ls', 
$this
->
	`g‘Wr™”P¬t
('R–s')->
	`wr™eD¿wšgR–©iÚshs
($this->
¥»adSh“t
->
	`g‘Sh“t
($i), 
$ch¬tRef1
, $this->
šşudeCh¬ts
));

325 
$objZ
->
	`addFromSŒšg
('xl/d¿wšgs/d¿wšg' . (
$i
 + 1è. '.xml', 
$this
->
	`g‘Wr™”P¬t
('D¿wšg')->
	`wr™eD¿wšgs
($this->
¥»adSh“t
->
	`g‘Sh“t
($i), 
$ch¬tRef2
, $this->
šşudeCh¬ts
));

329 ià(
	`couÁ
(
$this
->
¥»adSh“t
->
	`g‘Sh“t
(
$i
)->
	`g‘Comm’ts
()) > 0) {

331 
$objZ
->
	`addFromSŒšg
('xl/d¿wšgs/vmlD¿wšg' . (
$i
 + 1è. '.vml', 
$this
->
	`g‘Wr™”P¬t
('Comm’ts')->
	`wr™eVMLComm’ts
($this->
¥»adSh“t
->
	`g‘Sh“t
($i)));

334 
$objZ
->
	`addFromSŒšg
('xl/comm’ts' . (
$i
 + 1è. '.xml', 
$this
->
	`g‘Wr™”P¬t
('Comm’ts')->
	`wr™eComm’ts
($this->
¥»adSh“t
->
	`g‘Sh“t
($i)));

338 ià(
	`couÁ
(
$this
->
¥»adSh“t
->
	`g‘Sh“t
(
$i
)->
	`g‘H—d”FoÙ”
()->
	`g‘Images
()) > 0) {

340 
$objZ
->
	`addFromSŒšg
('xl/d¿wšgs/vmlD¿wšgHF' . (
$i
 + 1è. '.vml', 
$this
->
	`g‘Wr™”P¬t
('D¿wšg')->
	`wr™eVMLH—d”FoÙ”Images
($this->
¥»adSh“t
->
	`g‘Sh“t
($i)));

343 
$objZ
->
	`addFromSŒšg
('xl/d¿wšgs/_»ls/vmlD¿wšgHF' . (
$i
 + 1è. '.vml.»ls', 
$this
->
	`g‘Wr™”P¬t
('R–s')->
	`wr™eH—d”FoÙ”D¿wšgR–©iÚshs
($this->
¥»adSh“t
->
	`g‘Sh“t
($i)));

346 
	`fÜ—ch
 (
$this
->
¥»adSh“t
->
	`g‘Sh“t
(
$i
)->
	`g‘H—d”FoÙ”
()->
	`g‘Images
(è
as
 
$image
) {

347 
$objZ
->
	`addFromSŒšg
('xl/medŸ/' . 
$image
->
	`g‘IndexedF’ame
(), 
	`fe_g‘_cÚ‹Ás
($image->
	`g‘P©h
()));

353 
$i
 = 0; $˜< 
$this
->
	`g‘D¿wšgHashTabË
()->
	`couÁ
(); ++$i) {

354 ià(
$this
->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
è
š¡ªûof
 
PHPExûl_WÜksh“t_D¿wšg
) {

355 
$imageCÚ‹Ás
 = 
nuÎ
;

356 
$imageP©h
 = 
$this
->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
)->
	`g‘P©h
();

357 ià(
	`¡½os
(
$imageP©h
, 'z://'è!=ğ
çl£
) {

358 
$imageP©h
 = 
	`sub¡r
($imagePath, 6);

359 
$imageP©hS¶™‹d
 = 
	`ex¶ode
('#', 
$imageP©h
);

361 
$imageZ
 = 
Ãw
 
	`ZArchive
();

362 
$imageZ
->
	`İ’
(
$imageP©hS¶™‹d
[0]);

363 
$imageCÚ‹Ás
 = 
$imageZ
->
	`g‘FromName
(
$imageP©hS¶™‹d
[1]);

364 
$imageZ
->
	`şo£
();

365 
	`un£t
(
$imageZ
);

367 
$imageCÚ‹Ás
 = 
	`fe_g‘_cÚ‹Ás
(
$imageP©h
);

370 
$objZ
->
	`addFromSŒšg
('xl/medŸ/' . 
	`¡r_»¶aû
(' ', '_', 
$this
->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
)->
	`g‘IndexedF’ame
()), 
$imageCÚ‹Ás
);

371 } 
	`–£if
 (
$this
->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
è
š¡ªûof
 
PHPExûl_WÜksh“t_MemÜyD¿wšg
) {

372 
	`ob_¡¬t
();

373 
	`ÿÎ_u£r_func
(

374 
$this
->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
)->
	`g‘R’d”šgFunùiÚ
(),

375 
$this
->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
)->
	`g‘ImageResourû
()

377 
$imageCÚ‹Ás
 = 
	`ob_g‘_cÚ‹Ás
();

378 
	`ob_’d_ş—n
();

380 
$objZ
->
	`addFromSŒšg
('xl/medŸ/' . 
	`¡r_»¶aû
(' ', '_', 
$this
->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
)->
	`g‘IndexedF’ame
()), 
$imageCÚ‹Ás
);

384 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`£tR‘uºD©eTy³
(
$§veD©eR‘uºTy³
);

385 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
¥»adSh“t
)->
	`g‘DebugLog
()->
	`£tWr™eDebugLog
(
$§veDebugLog
);

388 ià(
$objZ
->
	`şo£
(è==ğ
çl£
) {

389 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Could‚ot close zip file $pFilename.");

393 ià(
$Üigš®F’ame
 !ğ
$pF’ame
) {

394 ià(
	`cİy
(
$pF’ame
, 
$Üigš®F’ame
è==ğ
çl£
) {

395 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Could‚ot copyemporary zip file $pFilenameo $originalFilename.");

397 @
	`uÆšk
(
$pF’ame
);

400 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("PHPExcel object unassigned.");

402 
	}
}

410 
public
 
funùiÚ
 
	$g‘PHPExûl
()

412 ià(
$this
->
¥»adSh“t
 !=ğ
nuÎ
) {

413  
$this
->
¥»adSh“t
;

415 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("No PHPExcel object‡ssigned.");

417 
	}
}

426 
public
 
funùiÚ
 
	$£tPHPExûl
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

428 
$this
->
¥»adSh“t
 = 
$pPHPExûl
;

429  
$this
;

430 
	}
}

437 
public
 
funùiÚ
 
	$g‘SŒšgTabË
()

439  
$this
->
¡ršgTabË
;

440 
	}
}

447 
public
 
funùiÚ
 
	$g‘StyËHashTabË
()

449  
$this
->
¡yËHashTabË
;

450 
	}
}

457 
public
 
funùiÚ
 
	$g‘StyËsCÚd™iÚ®HashTabË
()

459  
$this
->
¡yËsCÚd™iÚ®HashTabË
;

460 
	}
}

467 
public
 
funùiÚ
 
	$g‘FlHashTabË
()

469  
$this
->
flHashTabË
;

470 
	}
}

477 
public
 
funùiÚ
 
	$g‘FÚtHashTabË
()

479  
$this
->
fÚtHashTabË
;

480 
	}
}

487 
public
 
funùiÚ
 
	$g‘BÜd”sHashTabË
()

489  
$this
->
bÜd”sHashTabË
;

490 
	}
}

497 
public
 
funùiÚ
 
	$g‘NumFmtHashTabË
()

499  
$this
->
numFmtHashTabË
;

500 
	}
}

507 
public
 
funùiÚ
 
	$g‘D¿wšgHashTabË
()

509  
$this
->
d¿wšgHashTabË
;

510 
	}
}

517 
public
 
funùiÚ
 
	$g‘Offiû2003Com·tib™y
()

519  
$this
->
offiû2003com·tib™y
;

520 
	}
}

528 
public
 
funùiÚ
 
	$£tOffiû2003Com·tib™y
(
$pV®ue
 = 
çl£
)

530 
$this
->
offiû2003com·tib™y
 = 
$pV®ue
;

531  
$this
;

532 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Chart.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_Ch¬t
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


38 
public
 
funùiÚ
 
	$wr™eCh¬t
(
PHPExûl_Ch¬t
 
$pCh¬t
 = 
nuÎ
)

41 
$objWr™”
 = 
nuÎ
;

42 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

43 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

45 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

48 
$pCh¬t
->
	`»äesh
();

51 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

54 
$objWr™”
->
	`¡¬tEËm’t
('c:chartSpace');

55 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:c', 'http://schemas.openxmlformats.org/drawingml/2006/chart');

56 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:a', 'http://schemas.openxmlformats.org/drawingml/2006/main');

57 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');

59 
$objWr™”
->
	`¡¬tEËm’t
('c:date1904');

60 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

61 
$objWr™”
->
	`’dEËm’t
();

62 
$objWr™”
->
	`¡¬tEËm’t
('c:lang');

63 
$objWr™”
->
	`wr™eA‰ribu‹
('val', "en-GB");

64 
$objWr™”
->
	`’dEËm’t
();

65 
$objWr™”
->
	`¡¬tEËm’t
('c:roundedCorners');

66 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

67 
$objWr™”
->
	`’dEËm’t
();

69 
$this
->
	`wr™eAÉ”Ç‹CÚ‹Á
(
$objWr™”
);

71 
$objWr™”
->
	`¡¬tEËm’t
('c:chart');

73 
$this
->
	`wr™eT™Ë
(
$pCh¬t
->
	`g‘T™Ë
(), 
$objWr™”
);

75 
$objWr™”
->
	`¡¬tEËm’t
('c:autoTitleDeleted');

76 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

77 
$objWr™”
->
	`’dEËm’t
();

79 
$this
->
	`wr™ePlÙA»a
(
$pCh¬t
->
	`g‘PlÙA»a
(), $pCh¬t->
	`g‘XAxisLab–
(), $pCh¬t->
	`g‘YAxisLab–
(), 
$objWr™”
, $pCh¬t->
	`g‘WÜksh“t
(), $pCh¬t->
	`g‘Ch¬tAxisX
(), $pCh¬t->
	`g‘Ch¬tAxisY
(), $pCh¬t->
	`g‘MajÜGridlšes
(), $pCh¬t->
	`g‘MšÜGridlšes
());

81 
$this
->
	`wr™eLeg’d
(
$pCh¬t
->
	`g‘Leg’d
(), 
$objWr™”
);

83 
$objWr™”
->
	`¡¬tEËm’t
('c:plotVisOnly');

84 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 1);

85 
$objWr™”
->
	`’dEËm’t
();

87 
$objWr™”
->
	`¡¬tEËm’t
('c:dispBlanksAs');

88 
$objWr™”
->
	`wr™eA‰ribu‹
('val', "gap");

89 
$objWr™”
->
	`’dEËm’t
();

91 
$objWr™”
->
	`¡¬tEËm’t
('c:showDLblsOverMax');

92 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

93 
$objWr™”
->
	`’dEËm’t
();

95 
$objWr™”
->
	`’dEËm’t
();

97 
$this
->
	`wr™ePrštS‘tšgs
(
$objWr™”
);

99 
$objWr™”
->
	`’dEËm’t
();

102  
$objWr™”
->
	`g‘D©a
();

113 
´iv©e
 
funùiÚ
 
	$wr™eT™Ë
(
PHPExûl_Ch¬t_T™Ë
 
$t™Ë
 = 
nuÎ
, 
$objWr™”
)

115 ià(
	`is_nuÎ
(
$t™Ë
)) {

119 
$objWr™”
->
	`¡¬tEËm’t
('c:title');

120 
$objWr™”
->
	`¡¬tEËm’t
('c:tx');

121 
$objWr™”
->
	`¡¬tEËm’t
('c:rich');

123 
$objWr™”
->
	`¡¬tEËm’t
('a:bodyPr');

124 
$objWr™”
->
	`’dEËm’t
();

126 
$objWr™”
->
	`¡¬tEËm’t
('a:lstStyle');

127 
$objWr™”
->
	`’dEËm’t
();

129 
$objWr™”
->
	`¡¬tEËm’t
('a:p');

131 
$ÿ±iÚ
 = 
$t™Ë
->
	`g‘C­tiÚ
();

132 ià((
	`is_¬¿y
(
$ÿ±iÚ
)è&& (
	`couÁ
($caption) > 0)) {

133 
$ÿ±iÚ
 = $caption[0];

135 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘Wr™”P¬t
('¡ršgbË')->
	`wr™eRichTextFÜCh¬ts
(
$objWr™”
, 
$ÿ±iÚ
, 'a');

137 
$objWr™”
->
	`’dEËm’t
();

138 
$objWr™”
->
	`’dEËm’t
();

139 
$objWr™”
->
	`’dEËm’t
();

141 
$this
->
	`wr™eLayout
(
$t™Ë
->
	`g‘Layout
(), 
$objWr™”
);

143 
$objWr™”
->
	`¡¬tEËm’t
('c:overlay');

144 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

145 
$objWr™”
->
	`’dEËm’t
();

147 
$objWr™”
->
	`’dEËm’t
();

148 
	}
}

158 
´iv©e
 
funùiÚ
 
	$wr™eLeg’d
(
PHPExûl_Ch¬t_Leg’d
 
$Ëg’d
 = 
nuÎ
, 
$objWr™”
)

160 ià(
	`is_nuÎ
(
$Ëg’d
)) {

164 
$objWr™”
->
	`¡¬tEËm’t
('c:legend');

166 
$objWr™”
->
	`¡¬tEËm’t
('c:legendPos');

167 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$Ëg’d
->
	`g‘Pos™iÚ
());

168 
$objWr™”
->
	`’dEËm’t
();

170 
$this
->
	`wr™eLayout
(
$Ëg’d
->
	`g‘Layout
(), 
$objWr™”
);

172 
$objWr™”
->
	`¡¬tEËm’t
('c:overlay');

173 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', (
$Ëg’d
->
	`g‘Ov”Ïy
()) ? '1' : '0');

174 
$objWr™”
->
	`’dEËm’t
();

176 
$objWr™”
->
	`¡¬tEËm’t
('c:txPr');

177 
$objWr™”
->
	`¡¬tEËm’t
('a:bodyPr');

178 
$objWr™”
->
	`’dEËm’t
();

180 
$objWr™”
->
	`¡¬tEËm’t
('a:lstStyle');

181 
$objWr™”
->
	`’dEËm’t
();

183 
$objWr™”
->
	`¡¬tEËm’t
('a:p');

184 
$objWr™”
->
	`¡¬tEËm’t
('a:pPr');

185 
$objWr™”
->
	`wr™eA‰ribu‹
('rtl', 0);

187 
$objWr™”
->
	`¡¬tEËm’t
('a:defRPr');

188 
$objWr™”
->
	`’dEËm’t
();

189 
$objWr™”
->
	`’dEËm’t
();

191 
$objWr™”
->
	`¡¬tEËm’t
('a:endParaRPr');

192 
$objWr™”
->
	`wr™eA‰ribu‹
('lang', "en-US");

193 
$objWr™”
->
	`’dEËm’t
();

195 
$objWr™”
->
	`’dEËm’t
();

196 
$objWr™”
->
	`’dEËm’t
();

198 
$objWr™”
->
	`’dEËm’t
();

199 
	}
}

213 
´iv©e
 
funùiÚ
 
	$wr™ePlÙA»a
(
PHPExûl_Ch¬t_PlÙA»a
 
$¶ÙA»a
, 
PHPExûl_Ch¬t_T™Ë
 
$xAxisLab–
 = 
nuÎ
, PHPExûl_Ch¬t_T™Ë 
$yAxisLab–
 =‚uÎ, 
$objWr™”
, 
PHPExûl_WÜksh“t
 
$pSh“t
, 
PHPExûl_Ch¬t_Axis
 
$xAxis
, PHPExûl_Ch¬t_Axi 
$yAxis
, 
PHPExûl_Ch¬t_GridLšes
 
$majÜGridlšes
, PHPExûl_Ch¬t_GridLše 
$mšÜGridlšes
)

215 ià(
	`is_nuÎ
(
$¶ÙA»a
)) {

219 
$id1
 = 
$id2
 = 0;

220 
$this
->
_£r›sIndex
 = 0;

221 
$objWr™”
->
	`¡¬tEËm’t
('c:plotArea');

223 
$Ïyout
 = 
$¶ÙA»a
->
	`g‘Layout
();

225 
$this
->
	`wr™eLayout
(
$Ïyout
, 
$objWr™”
);

227 
$ch¬tTy³s
 = 
£lf
::
	`g‘Ch¬tTy³
(
$¶ÙA»a
);

228 
$ÿtIsMuÉiLev–S”›s
 = 
$v®IsMuÉiLev–S”›s
 = 
çl£
;

229 
$¶ÙGroupšgTy³
 = '';

230 
	`fÜ—ch
 (
$ch¬tTy³s
 
as
 
$ch¬tTy³
) {

231 
$objWr™”
->
	`¡¬tEËm’t
('c:' . 
$ch¬tTy³
);

233 
$groupCouÁ
 = 
$¶ÙA»a
->
	`g‘PlÙGroupCouÁ
();

234 
$i
 = 0; $˜< 
$groupCouÁ
; ++$i) {

235 
$¶ÙGroup
 = 
$¶ÙA»a
->
	`g‘PlÙGroupByIndex
(
$i
);

236 
$groupTy³
 = 
$¶ÙGroup
->
	`g‘PlÙTy³
();

237 ià(
$groupTy³
 =ğ
$ch¬tTy³
) {

238 
$¶ÙStyË
 = 
$¶ÙGroup
->
	`g‘PlÙStyË
();

239 ià(
$groupTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_RADARCHART
) {

240 
$objWr™”
->
	`¡¬tEËm’t
('c:radarStyle');

241 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$¶ÙStyË
);

242 
$objWr™”
->
	`’dEËm’t
();

243 } 
	`–£if
 (
$groupTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_SCATTERCHART
) {

244 
$objWr™”
->
	`¡¬tEËm’t
('c:scatterStyle');

245 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$¶ÙStyË
);

246 
$objWr™”
->
	`’dEËm’t
();

249 
$this
->
	`wr™ePlÙGroup
(
$¶ÙGroup
, 
$ch¬tTy³
, 
$objWr™”
, 
$ÿtIsMuÉiLev–S”›s
, 
$v®IsMuÉiLev–S”›s
, 
$¶ÙGroupšgTy³
, 
$pSh“t
);

253 
$this
->
	`wr™eD©aLab–s
(
$objWr™”
, 
$Ïyout
);

255 ià(
$ch¬tTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_LINECHART
) {

258 
$objWr™”
->
	`¡¬tEËm’t
('c:smooth');

259 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', (
š‹g”
è
$¶ÙGroup
->
	`g‘SmoÙhLše
());

260 
$objWr™”
->
	`’dEËm’t
();

261 } 
	`–£if
 ((
$ch¬tTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_BARCHART
è||($ch¬tTy³ ==ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_BARCHART_3D
)) {

262 
$objWr™”
->
	`¡¬tEËm’t
('c:gapWidth');

263 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 150);

264 
$objWr™”
->
	`’dEËm’t
();

266 ià(
$¶ÙGroupšgTy³
 == 'percentStacked' || $plotGroupingType == 'stacked') {

267 
$objWr™”
->
	`¡¬tEËm’t
('c:overlap');

268 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 100);

269 
$objWr™”
->
	`’dEËm’t
();

271 } 
	`–£if
 (
$ch¬tTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_BUBBLECHART
) {

272 
$objWr™”
->
	`¡¬tEËm’t
('c:bubbleScale');

273 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 25);

274 
$objWr™”
->
	`’dEËm’t
();

276 
$objWr™”
->
	`¡¬tEËm’t
('c:showNegBubbles');

277 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

278 
$objWr™”
->
	`’dEËm’t
();

279 } 
	`–£if
 (
$ch¬tTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_STOCKCHART
) {

280 
$objWr™”
->
	`¡¬tEËm’t
('c:hiLowLines');

281 
$objWr™”
->
	`’dEËm’t
();

283 
$objWr™”
->
	`¡¬tEËm’t
('c:upDownBars');

285 
$objWr™”
->
	`¡¬tEËm’t
('c:gapWidth');

286 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 300);

287 
$objWr™”
->
	`’dEËm’t
();

289 
$objWr™”
->
	`¡¬tEËm’t
('c:upBars');

290 
$objWr™”
->
	`’dEËm’t
();

292 
$objWr™”
->
	`¡¬tEËm’t
('c:downBars');

293 
$objWr™”
->
	`’dEËm’t
();

295 
$objWr™”
->
	`’dEËm’t
();

303 
$id1
 = '75091328';

304 
$id2
 = '75089408';

306 ià((
$ch¬tTy³
 !=ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_PIECHART
è&& ($ch¬tTy³ !=ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_PIECHART_3D
è&& ($ch¬tTy³ !=ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_DONUTCHART
)) {

307 
$objWr™”
->
	`¡¬tEËm’t
('c:axId');

308 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$id1
);

309 
$objWr™”
->
	`’dEËm’t
();

310 
$objWr™”
->
	`¡¬tEËm’t
('c:axId');

311 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$id2
);

312 
$objWr™”
->
	`’dEËm’t
();

314 
$objWr™”
->
	`¡¬tEËm’t
('c:firstSliceAng');

315 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

316 
$objWr™”
->
	`’dEËm’t
();

318 ià(
$ch¬tTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_DONUTCHART
) {

319 
$objWr™”
->
	`¡¬tEËm’t
('c:holeSize');

320 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 50);

321 
$objWr™”
->
	`’dEËm’t
();

325 
$objWr™”
->
	`’dEËm’t
();

328 ià((
$ch¬tTy³
 !=ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_PIECHART
è&& ($ch¬tTy³ !=ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_PIECHART_3D
è&& ($ch¬tTy³ !=ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_DONUTCHART
)) {

329 ià(
$ch¬tTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_BUBBLECHART
) {

330 
$this
->
	`wr™eV®ueAxis
(
$objWr™”
, 
$¶ÙA»a
, 
$xAxisLab–
, 
$ch¬tTy³
, 
$id1
, 
$id2
, 
$ÿtIsMuÉiLev–S”›s
, 
$xAxis
, 
$yAxis
, 
$majÜGridlšes
, 
$mšÜGridlšes
);

332 
$this
->
	`wr™eC©egÜyAxis
(
$objWr™”
, 
$¶ÙA»a
, 
$xAxisLab–
, 
$ch¬tTy³
, 
$id1
, 
$id2
, 
$ÿtIsMuÉiLev–S”›s
, 
$xAxis
, 
$yAxis
);

335 
$this
->
	`wr™eV®ueAxis
(
$objWr™”
, 
$¶ÙA»a
, 
$yAxisLab–
, 
$ch¬tTy³
, 
$id1
, 
$id2
, 
$v®IsMuÉiLev–S”›s
, 
$xAxis
, 
$yAxis
, 
$majÜGridlšes
, 
$mšÜGridlšes
);

338 
$objWr™”
->
	`’dEËm’t
();

339 
	}
}

349 
´iv©e
 
funùiÚ
 
	$wr™eD©aLab–s
(
$objWr™”
, 
$ch¬tLayout
)

351 
$objWr™”
->
	`¡¬tEËm’t
('c:dLbls');

353 
$objWr™”
->
	`¡¬tEËm’t
('c:showLegendKey');

354 
$showLeg’dKey
 = (
	`em±y
(
$ch¬tLayout
)è? 0 : $ch¬tLayout->
	`g‘ShowLeg’dKey
();

355 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', ((
	`em±y
(
$showLeg’dKey
)) ? 0 : 1));

356 
$objWr™”
->
	`’dEËm’t
();

358 
$objWr™”
->
	`¡¬tEËm’t
('c:showVal');

359 
$showV®
 = (
	`em±y
(
$ch¬tLayout
)è? 0 : $ch¬tLayout->
	`g‘ShowV®
();

360 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', ((
	`em±y
(
$showV®
)) ? 0 : 1));

361 
$objWr™”
->
	`’dEËm’t
();

363 
$objWr™”
->
	`¡¬tEËm’t
('c:showCatName');

364 
$showC©Name
 = (
	`em±y
(
$ch¬tLayout
)è? 0 : $ch¬tLayout->
	`g‘ShowC©Name
();

365 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', ((
	`em±y
(
$showC©Name
)) ? 0 : 1));

366 
$objWr™”
->
	`’dEËm’t
();

368 
$objWr™”
->
	`¡¬tEËm’t
('c:showSerName');

369 
$showS”Name
 = (
	`em±y
(
$ch¬tLayout
)è? 0 : $ch¬tLayout->
	`g‘ShowS”Name
();

370 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', ((
	`em±y
(
$showS”Name
)) ? 0 : 1));

371 
$objWr™”
->
	`’dEËm’t
();

373 
$objWr™”
->
	`¡¬tEËm’t
('c:showPercent');

374 
$showP”ûÁ
 = (
	`em±y
(
$ch¬tLayout
)è? 0 : $ch¬tLayout->
	`g‘ShowP”ûÁ
();

375 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', ((
	`em±y
(
$showP”ûÁ
)) ? 0 : 1));

376 
$objWr™”
->
	`’dEËm’t
();

378 
$objWr™”
->
	`¡¬tEËm’t
('c:showBubbleSize');

379 
$showBubbËSize
 = (
	`em±y
(
$ch¬tLayout
)è? 0 : $ch¬tLayout->
	`g‘ShowBubbËSize
();

380 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', ((
	`em±y
(
$showBubbËSize
)) ? 0 : 1));

381 
$objWr™”
->
	`’dEËm’t
();

383 
$objWr™”
->
	`¡¬tEËm’t
('c:showLeaderLines');

384 
$showL—d”Lšes
 = (
	`em±y
(
$ch¬tLayout
)è? 1 : $ch¬tLayout->
	`g‘ShowL—d”Lšes
();

385 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', ((
	`em±y
(
$showL—d”Lšes
)) ? 0 : 1));

386 
$objWr™”
->
	`’dEËm’t
();

388 
$objWr™”
->
	`’dEËm’t
();

389 
	}
}

404 
´iv©e
 
funùiÚ
 
	$wr™eC©egÜyAxis
(
$objWr™”
, 
PHPExûl_Ch¬t_PlÙA»a
 
$¶ÙA»a
, 
$xAxisLab–
, 
$groupTy³
, 
$id1
, 
$id2
, 
$isMuÉiLev–S”›s
, 
$xAxis
, 
$yAxis
)

406 
$objWr™”
->
	`¡¬tEËm’t
('c:catAx');

408 ià(
$id1
 > 0) {

409 
$objWr™”
->
	`¡¬tEËm’t
('c:axId');

410 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$id1
);

411 
$objWr™”
->
	`’dEËm’t
();

414 
$objWr™”
->
	`¡¬tEËm’t
('c:scaling');

415 
$objWr™”
->
	`¡¬tEËm’t
('c:orientation');

416 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$yAxis
->
	`g‘AxisO±iÚsPrİ”ty
('orientation'));

417 
$objWr™”
->
	`’dEËm’t
();

418 
$objWr™”
->
	`’dEËm’t
();

420 
$objWr™”
->
	`¡¬tEËm’t
('c:delete');

421 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

422 
$objWr™”
->
	`’dEËm’t
();

424 
$objWr™”
->
	`¡¬tEËm’t
('c:axPos');

425 
$objWr™”
->
	`wr™eA‰ribu‹
('val', "b");

426 
$objWr™”
->
	`’dEËm’t
();

428 ià(!
	`is_nuÎ
(
$xAxisLab–
)) {

429 
$objWr™”
->
	`¡¬tEËm’t
('c:title');

430 
$objWr™”
->
	`¡¬tEËm’t
('c:tx');

431 
$objWr™”
->
	`¡¬tEËm’t
('c:rich');

433 
$objWr™”
->
	`¡¬tEËm’t
('a:bodyPr');

434 
$objWr™”
->
	`’dEËm’t
();

436 
$objWr™”
->
	`¡¬tEËm’t
('a:lstStyle');

437 
$objWr™”
->
	`’dEËm’t
();

439 
$objWr™”
->
	`¡¬tEËm’t
('a:p');

440 
$objWr™”
->
	`¡¬tEËm’t
('a:r');

442 
$ÿ±iÚ
 = 
$xAxisLab–
->
	`g‘C­tiÚ
();

443 ià(
	`is_¬¿y
(
$ÿ±iÚ
)) {

444 
$ÿ±iÚ
 = $caption[0];

446 
$objWr™”
->
	`¡¬tEËm’t
('a:t');

448 
$objWr™”
->
	`wr™eRawD©a
(
PHPExûl_Sh¬ed_SŒšg
::
	`CÚŒŞCh¬aù”PHP2OOXML
(
$ÿ±iÚ
));

449 
$objWr™”
->
	`’dEËm’t
();

451 
$objWr™”
->
	`’dEËm’t
();

452 
$objWr™”
->
	`’dEËm’t
();

453 
$objWr™”
->
	`’dEËm’t
();

454 
$objWr™”
->
	`’dEËm’t
();

456 
$Ïyout
 = 
$xAxisLab–
->
	`g‘Layout
();

457 
$this
->
	`wr™eLayout
(
$Ïyout
, 
$objWr™”
);

459 
$objWr™”
->
	`¡¬tEËm’t
('c:overlay');

460 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

461 
$objWr™”
->
	`’dEËm’t
();

463 
$objWr™”
->
	`’dEËm’t
();

466 
$objWr™”
->
	`¡¬tEËm’t
('c:numFmt');

467 
$objWr™”
->
	`wr™eA‰ribu‹
('fÜm©Code', 
$yAxis
->
	`g‘AxisNumb”FÜm©
());

468 
$objWr™”
->
	`wr™eA‰ribu‹
('sourûLšked', 
$yAxis
->
	`g‘AxisNumb”SourûLšked
());

469 
$objWr™”
->
	`’dEËm’t
();

471 
$objWr™”
->
	`¡¬tEËm’t
('c:majorTickMark');

472 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$yAxis
->
	`g‘AxisO±iÚsPrİ”ty
('major_tick_mark'));

473 
$objWr™”
->
	`’dEËm’t
();

475 
$objWr™”
->
	`¡¬tEËm’t
('c:minorTickMark');

476 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$yAxis
->
	`g‘AxisO±iÚsPrİ”ty
('minor_tick_mark'));

477 
$objWr™”
->
	`’dEËm’t
();

479 
$objWr™”
->
	`¡¬tEËm’t
('c:tickLblPos');

480 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$yAxis
->
	`g‘AxisO±iÚsPrİ”ty
('axis_labels'));

481 
$objWr™”
->
	`’dEËm’t
();

483 ià(
$id2
 > 0) {

484 
$objWr™”
->
	`¡¬tEËm’t
('c:crossAx');

485 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$id2
);

486 
$objWr™”
->
	`’dEËm’t
();

488 
$objWr™”
->
	`¡¬tEËm’t
('c:crosses');

489 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$yAxis
->
	`g‘AxisO±iÚsPrİ”ty
('horizontal_crosses'));

490 
$objWr™”
->
	`’dEËm’t
();

493 
$objWr™”
->
	`¡¬tEËm’t
('c:auto');

494 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 1);

495 
$objWr™”
->
	`’dEËm’t
();

497 
$objWr™”
->
	`¡¬tEËm’t
('c:lblAlgn');

498 
$objWr™”
->
	`wr™eA‰ribu‹
('val', "ctr");

499 
$objWr™”
->
	`’dEËm’t
();

501 
$objWr™”
->
	`¡¬tEËm’t
('c:lblOffset');

502 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 100);

503 
$objWr™”
->
	`’dEËm’t
();

505 ià(
$isMuÉiLev–S”›s
) {

506 
$objWr™”
->
	`¡¬tEËm’t
('c:noMultiLvlLbl');

507 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

508 
$objWr™”
->
	`’dEËm’t
();

510 
$objWr™”
->
	`’dEËm’t
();

511 
	}
}

526 
´iv©e
 
funùiÚ
 
	$wr™eV®ueAxis
(
$objWr™”
, 
PHPExûl_Ch¬t_PlÙA»a
 
$¶ÙA»a
, 
$yAxisLab–
, 
$groupTy³
, 
$id1
, 
$id2
, 
$isMuÉiLev–S”›s
, 
$xAxis
, 
$yAxis
, 
$majÜGridlšes
, 
$mšÜGridlšes
)

528 
$objWr™”
->
	`¡¬tEËm’t
('c:valAx');

530 ià(
$id2
 > 0) {

531 
$objWr™”
->
	`¡¬tEËm’t
('c:axId');

532 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$id2
);

533 
$objWr™”
->
	`’dEËm’t
();

536 
$objWr™”
->
	`¡¬tEËm’t
('c:scaling');

537 
$objWr™”
->
	`¡¬tEËm’t
('c:orientation');

538 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('orientation'));

540 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('maximum'))) {

541 
$objWr™”
->
	`¡¬tEËm’t
('c:max');

542 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('maximum'));

543 
$objWr™”
->
	`’dEËm’t
();

546 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('minimum'))) {

547 
$objWr™”
->
	`¡¬tEËm’t
('c:min');

548 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('minimum'));

549 
$objWr™”
->
	`’dEËm’t
();

552 
$objWr™”
->
	`’dEËm’t
();

553 
$objWr™”
->
	`’dEËm’t
();

555 
$objWr™”
->
	`¡¬tEËm’t
('c:delete');

556 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

557 
$objWr™”
->
	`’dEËm’t
();

559 
$objWr™”
->
	`¡¬tEËm’t
('c:axPos');

560 
$objWr™”
->
	`wr™eA‰ribu‹
('val', "l");

561 
$objWr™”
->
	`’dEËm’t
();

563 
$objWr™”
->
	`¡¬tEËm’t
('c:majorGridlines');

564 
$objWr™”
->
	`¡¬tEËm’t
('c:spPr');

566 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘LšeCŞÜPrİ”ty
('value'))) {

567 
$objWr™”
->
	`¡¬tEËm’t
('a:ln');

568 
$objWr™”
->
	`wr™eA‰ribu‹
('w', 
$majÜGridlšes
->
	`g‘LšeStyËPrİ”ty
('width'));

569 
$objWr™”
->
	`¡¬tEËm’t
('a:solidFill');

570 
$objWr™”
->
	`¡¬tEËm’t
("a:{$majorGridlines->getLineColorProperty('type')}");

571 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$majÜGridlšes
->
	`g‘LšeCŞÜPrİ”ty
('value'));

572 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

573 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$majÜGridlšes
->
	`g‘LšeCŞÜPrİ”ty
('alpha'));

574 
$objWr™”
->
	`’dEËm’t
();

575 
$objWr™”
->
	`’dEËm’t
();

576 
$objWr™”
->
	`’dEËm’t
();

578 
$objWr™”
->
	`¡¬tEËm’t
('a:prstDash');

579 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$majÜGridlšes
->
	`g‘LšeStyËPrİ”ty
('dash'));

580 
$objWr™”
->
	`’dEËm’t
();

582 ià(
$majÜGridlšes
->
	`g‘LšeStyËPrİ”ty
('join') == 'miter') {

583 
$objWr™”
->
	`¡¬tEËm’t
('a:miter');

584 
$objWr™”
->
	`wr™eA‰ribu‹
('lim', '800000');

585 
$objWr™”
->
	`’dEËm’t
();

587 
$objWr™”
->
	`¡¬tEËm’t
('a:bevel');

588 
$objWr™”
->
	`’dEËm’t
();

591 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'head', 'type')))) {

592 
$objWr™”
->
	`¡¬tEËm’t
('a:headEnd');

593 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³', 
$majÜGridlšes
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'head', 'type')));

594 
$objWr™”
->
	`wr™eA‰ribu‹
('w', 
$majÜGridlšes
->
	`g‘LšeStyËA¼owP¬am‘”s
('head', 'w'));

595 
$objWr™”
->
	`wr™eA‰ribu‹
('Ën', 
$majÜGridlšes
->
	`g‘LšeStyËA¼owP¬am‘”s
('head', 'len'));

596 
$objWr™”
->
	`’dEËm’t
();

599 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'end', 'type')))) {

600 
$objWr™”
->
	`¡¬tEËm’t
('a:tailEnd');

601 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³', 
$majÜGridlšes
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'end', 'type')));

602 
$objWr™”
->
	`wr™eA‰ribu‹
('w', 
$majÜGridlšes
->
	`g‘LšeStyËA¼owP¬am‘”s
('end', 'w'));

603 
$objWr™”
->
	`wr™eA‰ribu‹
('Ën', 
$majÜGridlšes
->
	`g‘LšeStyËA¼owP¬am‘”s
('end', 'len'));

604 
$objWr™”
->
	`’dEËm’t
();

606 
$objWr™”
->
	`’dEËm’t
();

608 
$objWr™”
->
	`¡¬tEËm’t
('a:effectLst');

610 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘GlowSize
())) {

611 
$objWr™”
->
	`¡¬tEËm’t
('a:glow');

612 
$objWr™”
->
	`wr™eA‰ribu‹
('¿d', 
$majÜGridlšes
->
	`g‘GlowSize
());

613 
$objWr™”
->
	`¡¬tEËm’t
("a:{$majorGridlines->getGlowColor('type')}");

614 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$majÜGridlšes
->
	`g‘GlowCŞÜ
('value'));

615 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

616 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$majÜGridlšes
->
	`g‘GlowCŞÜ
('alpha'));

617 
$objWr™”
->
	`’dEËm’t
();

618 
$objWr™”
->
	`’dEËm’t
();

619 
$objWr™”
->
	`’dEËm’t
();

622 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('presets'))) {

623 
$objWr™”
->
	`¡¬tEËm’t
("a:{$majorGridlines->getShadowProperty('effect')}");

624 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('blur'))) {

625 
$objWr™”
->
	`wr™eA‰ribu‹
('blurRad', 
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('blur'));

627 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('distance'))) {

628 
$objWr™”
->
	`wr™eA‰ribu‹
('di¡', 
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('distance'));

630 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('direction'))) {

631 
$objWr™”
->
	`wr™eA‰ribu‹
('dœ', 
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('direction'));

633 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('algn'))) {

634 
$objWr™”
->
	`wr™eA‰ribu‹
('®gn', 
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('algn'));

636 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'sx')))) {

637 
$objWr™”
->
	`wr™eA‰ribu‹
('sx', 
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'sx')));

639 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'sy')))) {

640 
$objWr™”
->
	`wr™eA‰ribu‹
('sy', 
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'sy')));

642 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'kx')))) {

643 
$objWr™”
->
	`wr™eA‰ribu‹
('kx', 
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'kx')));

645 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('rotWithShape'))) {

646 
$objWr™”
->
	`wr™eA‰ribu‹
('rÙW™hSh­e', 
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
('rotWithShape'));

648 
$objWr™”
->
	`¡¬tEËm’t
("a:{$majorGridlines->getShadowProperty(array('color', 'type'))}");

649 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('color', 'value')));

651 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

652 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$majÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('color', 'alpha')));

653 
$objWr™”
->
	`’dEËm’t
();

655 
$objWr™”
->
	`’dEËm’t
();

656 
$objWr™”
->
	`’dEËm’t
();

659 ià(!
	`is_nuÎ
(
$majÜGridlšes
->
	`g‘SoáEdgesSize
())) {

660 
$objWr™”
->
	`¡¬tEËm’t
('a:softEdge');

661 
$objWr™”
->
	`wr™eA‰ribu‹
('¿d', 
$majÜGridlšes
->
	`g‘SoáEdgesSize
());

662 
$objWr™”
->
	`’dEËm’t
();

665 
$objWr™”
->
	`’dEËm’t
();

666 
$objWr™”
->
	`’dEËm’t
();

667 
$objWr™”
->
	`’dEËm’t
();

669 ià(
$mšÜGridlšes
->
	`g‘ObjeùS‹
()) {

670 
$objWr™”
->
	`¡¬tEËm’t
('c:minorGridlines');

671 
$objWr™”
->
	`¡¬tEËm’t
('c:spPr');

673 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘LšeCŞÜPrİ”ty
('value'))) {

674 
$objWr™”
->
	`¡¬tEËm’t
('a:ln');

675 
$objWr™”
->
	`wr™eA‰ribu‹
('w', 
$mšÜGridlšes
->
	`g‘LšeStyËPrİ”ty
('width'));

676 
$objWr™”
->
	`¡¬tEËm’t
('a:solidFill');

677 
$objWr™”
->
	`¡¬tEËm’t
("a:{$minorGridlines->getLineColorProperty('type')}");

678 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$mšÜGridlšes
->
	`g‘LšeCŞÜPrİ”ty
('value'));

679 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

680 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$mšÜGridlšes
->
	`g‘LšeCŞÜPrİ”ty
('alpha'));

681 
$objWr™”
->
	`’dEËm’t
();

682 
$objWr™”
->
	`’dEËm’t
();

683 
$objWr™”
->
	`’dEËm’t
();

685 
$objWr™”
->
	`¡¬tEËm’t
('a:prstDash');

686 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$mšÜGridlšes
->
	`g‘LšeStyËPrİ”ty
('dash'));

687 
$objWr™”
->
	`’dEËm’t
();

689 ià(
$mšÜGridlšes
->
	`g‘LšeStyËPrİ”ty
('join') == 'miter') {

690 
$objWr™”
->
	`¡¬tEËm’t
('a:miter');

691 
$objWr™”
->
	`wr™eA‰ribu‹
('lim', '800000');

692 
$objWr™”
->
	`’dEËm’t
();

694 
$objWr™”
->
	`¡¬tEËm’t
('a:bevel');

695 
$objWr™”
->
	`’dEËm’t
();

698 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'head', 'type')))) {

699 
$objWr™”
->
	`¡¬tEËm’t
('a:headEnd');

700 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³', 
$mšÜGridlšes
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'head', 'type')));

701 
$objWr™”
->
	`wr™eA‰ribu‹
('w', 
$mšÜGridlšes
->
	`g‘LšeStyËA¼owP¬am‘”s
('head', 'w'));

702 
$objWr™”
->
	`wr™eA‰ribu‹
('Ën', 
$mšÜGridlšes
->
	`g‘LšeStyËA¼owP¬am‘”s
('head', 'len'));

703 
$objWr™”
->
	`’dEËm’t
();

706 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'end', 'type')))) {

707 
$objWr™”
->
	`¡¬tEËm’t
('a:tailEnd');

708 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³', 
$mšÜGridlšes
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'end', 'type')));

709 
$objWr™”
->
	`wr™eA‰ribu‹
('w', 
$mšÜGridlšes
->
	`g‘LšeStyËA¼owP¬am‘”s
('end', 'w'));

710 
$objWr™”
->
	`wr™eA‰ribu‹
('Ën', 
$mšÜGridlšes
->
	`g‘LšeStyËA¼owP¬am‘”s
('end', 'len'));

711 
$objWr™”
->
	`’dEËm’t
();

713 
$objWr™”
->
	`’dEËm’t
();

716 
$objWr™”
->
	`¡¬tEËm’t
('a:effectLst');

718 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘GlowSize
())) {

719 
$objWr™”
->
	`¡¬tEËm’t
('a:glow');

720 
$objWr™”
->
	`wr™eA‰ribu‹
('¿d', 
$mšÜGridlšes
->
	`g‘GlowSize
());

721 
$objWr™”
->
	`¡¬tEËm’t
("a:{$minorGridlines->getGlowColor('type')}");

722 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$mšÜGridlšes
->
	`g‘GlowCŞÜ
('value'));

723 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

724 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$mšÜGridlšes
->
	`g‘GlowCŞÜ
('alpha'));

725 
$objWr™”
->
	`’dEËm’t
();

726 
$objWr™”
->
	`’dEËm’t
();

727 
$objWr™”
->
	`’dEËm’t
();

730 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('presets'))) {

731 
$objWr™”
->
	`¡¬tEËm’t
("a:{$minorGridlines->getShadowProperty('effect')}");

732 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('blur'))) {

733 
$objWr™”
->
	`wr™eA‰ribu‹
('blurRad', 
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('blur'));

735 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('distance'))) {

736 
$objWr™”
->
	`wr™eA‰ribu‹
('di¡', 
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('distance'));

738 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('direction'))) {

739 
$objWr™”
->
	`wr™eA‰ribu‹
('dœ', 
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('direction'));

741 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('algn'))) {

742 
$objWr™”
->
	`wr™eA‰ribu‹
('®gn', 
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('algn'));

744 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'sx')))) {

745 
$objWr™”
->
	`wr™eA‰ribu‹
('sx', 
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'sx')));

747 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'sy')))) {

748 
$objWr™”
->
	`wr™eA‰ribu‹
('sy', 
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'sy')));

750 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'kx')))) {

751 
$objWr™”
->
	`wr™eA‰ribu‹
('kx', 
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size', 'kx')));

753 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('rotWithShape'))) {

754 
$objWr™”
->
	`wr™eA‰ribu‹
('rÙW™hSh­e', 
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
('rotWithShape'));

756 
$objWr™”
->
	`¡¬tEËm’t
("a:{$minorGridlines->getShadowProperty(array('color', 'type'))}");

757 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('color', 'value')));

758 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

759 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$mšÜGridlšes
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('color', 'alpha')));

760 
$objWr™”
->
	`’dEËm’t
();

761 
$objWr™”
->
	`’dEËm’t
();

762 
$objWr™”
->
	`’dEËm’t
();

765 ià(!
	`is_nuÎ
(
$mšÜGridlšes
->
	`g‘SoáEdgesSize
())) {

766 
$objWr™”
->
	`¡¬tEËm’t
('a:softEdge');

767 
$objWr™”
->
	`wr™eA‰ribu‹
('¿d', 
$mšÜGridlšes
->
	`g‘SoáEdgesSize
());

768 
$objWr™”
->
	`’dEËm’t
();

771 
$objWr™”
->
	`’dEËm’t
();

772 
$objWr™”
->
	`’dEËm’t
();

773 
$objWr™”
->
	`’dEËm’t
();

776 ià(!
	`is_nuÎ
(
$yAxisLab–
)) {

777 
$objWr™”
->
	`¡¬tEËm’t
('c:title');

778 
$objWr™”
->
	`¡¬tEËm’t
('c:tx');

779 
$objWr™”
->
	`¡¬tEËm’t
('c:rich');

781 
$objWr™”
->
	`¡¬tEËm’t
('a:bodyPr');

782 
$objWr™”
->
	`’dEËm’t
();

784 
$objWr™”
->
	`¡¬tEËm’t
('a:lstStyle');

785 
$objWr™”
->
	`’dEËm’t
();

787 
$objWr™”
->
	`¡¬tEËm’t
('a:p');

788 
$objWr™”
->
	`¡¬tEËm’t
('a:r');

790 
$ÿ±iÚ
 = 
$yAxisLab–
->
	`g‘C­tiÚ
();

791 ià(
	`is_¬¿y
(
$ÿ±iÚ
)) {

792 
$ÿ±iÚ
 = $caption[0];

795 
$objWr™”
->
	`¡¬tEËm’t
('a:t');

797 
$objWr™”
->
	`wr™eRawD©a
(
PHPExûl_Sh¬ed_SŒšg
::
	`CÚŒŞCh¬aù”PHP2OOXML
(
$ÿ±iÚ
));

798 
$objWr™”
->
	`’dEËm’t
();

800 
$objWr™”
->
	`’dEËm’t
();

801 
$objWr™”
->
	`’dEËm’t
();

802 
$objWr™”
->
	`’dEËm’t
();

803 
$objWr™”
->
	`’dEËm’t
();

805 ià(
$groupTy³
 !=ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_BUBBLECHART
) {

806 
$Ïyout
 = 
$yAxisLab–
->
	`g‘Layout
();

807 
$this
->
	`wr™eLayout
(
$Ïyout
, 
$objWr™”
);

810 
$objWr™”
->
	`¡¬tEËm’t
('c:overlay');

811 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

812 
$objWr™”
->
	`’dEËm’t
();

814 
$objWr™”
->
	`’dEËm’t
();

817 
$objWr™”
->
	`¡¬tEËm’t
('c:numFmt');

818 
$objWr™”
->
	`wr™eA‰ribu‹
('fÜm©Code', 
$xAxis
->
	`g‘AxisNumb”FÜm©
());

819 
$objWr™”
->
	`wr™eA‰ribu‹
('sourûLšked', 
$xAxis
->
	`g‘AxisNumb”SourûLšked
());

820 
$objWr™”
->
	`’dEËm’t
();

822 
$objWr™”
->
	`¡¬tEËm’t
('c:majorTickMark');

823 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('major_tick_mark'));

824 
$objWr™”
->
	`’dEËm’t
();

826 
$objWr™”
->
	`¡¬tEËm’t
('c:minorTickMark');

827 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('minor_tick_mark'));

828 
$objWr™”
->
	`’dEËm’t
();

830 
$objWr™”
->
	`¡¬tEËm’t
('c:tickLblPos');

831 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('axis_labels'));

832 
$objWr™”
->
	`’dEËm’t
();

834 
$objWr™”
->
	`¡¬tEËm’t
('c:spPr');

836 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘FlPrİ”ty
('value'))) {

837 
$objWr™”
->
	`¡¬tEËm’t
('a:solidFill');

838 
$objWr™”
->
	`¡¬tEËm’t
("a:" . 
$xAxis
->
	`g‘FlPrİ”ty
('type'));

839 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘FlPrİ”ty
('value'));

840 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

841 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘FlPrİ”ty
('alpha'));

842 
$objWr™”
->
	`’dEËm’t
();

843 
$objWr™”
->
	`’dEËm’t
();

844 
$objWr™”
->
	`’dEËm’t
();

847 
$objWr™”
->
	`¡¬tEËm’t
('a:ln');

849 
$objWr™”
->
	`wr™eA‰ribu‹
('w', 
$xAxis
->
	`g‘LšeStyËPrİ”ty
('width'));

850 
$objWr™”
->
	`wr™eA‰ribu‹
('ÿp', 
$xAxis
->
	`g‘LšeStyËPrİ”ty
('cap'));

851 
$objWr™”
->
	`wr™eA‰ribu‹
('cmpd', 
$xAxis
->
	`g‘LšeStyËPrİ”ty
('compound'));

853 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘LšePrİ”ty
('value'))) {

854 
$objWr™”
->
	`¡¬tEËm’t
('a:solidFill');

855 
$objWr™”
->
	`¡¬tEËm’t
("a:" . 
$xAxis
->
	`g‘LšePrİ”ty
('type'));

856 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘LšePrİ”ty
('value'));

857 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

858 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘LšePrİ”ty
('alpha'));

859 
$objWr™”
->
	`’dEËm’t
();

860 
$objWr™”
->
	`’dEËm’t
();

861 
$objWr™”
->
	`’dEËm’t
();

864 
$objWr™”
->
	`¡¬tEËm’t
('a:prstDash');

865 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘LšeStyËPrİ”ty
('dash'));

866 
$objWr™”
->
	`’dEËm’t
();

868 ià(
$xAxis
->
	`g‘LšeStyËPrİ”ty
('join') == 'miter') {

869 
$objWr™”
->
	`¡¬tEËm’t
('a:miter');

870 
$objWr™”
->
	`wr™eA‰ribu‹
('lim', '800000');

871 
$objWr™”
->
	`’dEËm’t
();

873 
$objWr™”
->
	`¡¬tEËm’t
('a:bevel');

874 
$objWr™”
->
	`’dEËm’t
();

877 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'head', 'type')))) {

878 
$objWr™”
->
	`¡¬tEËm’t
('a:headEnd');

879 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³', 
$xAxis
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'head', 'type')));

880 
$objWr™”
->
	`wr™eA‰ribu‹
('w', 
$xAxis
->
	`g‘LšeStyËA¼owWidth
('head'));

881 
$objWr™”
->
	`wr™eA‰ribu‹
('Ën', 
$xAxis
->
	`g‘LšeStyËA¼owL’gth
('head'));

882 
$objWr™”
->
	`’dEËm’t
();

885 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'end', 'type')))) {

886 
$objWr™”
->
	`¡¬tEËm’t
('a:tailEnd');

887 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³', 
$xAxis
->
	`g‘LšeStyËPrİ”ty
(
	`¬¿y
('arrow', 'end', 'type')));

888 
$objWr™”
->
	`wr™eA‰ribu‹
('w', 
$xAxis
->
	`g‘LšeStyËA¼owWidth
('end'));

889 
$objWr™”
->
	`wr™eA‰ribu‹
('Ën', 
$xAxis
->
	`g‘LšeStyËA¼owL’gth
('end'));

890 
$objWr™”
->
	`’dEËm’t
();

893 
$objWr™”
->
	`’dEËm’t
();

895 
$objWr™”
->
	`¡¬tEËm’t
('a:effectLst');

897 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘GlowPrİ”ty
('size'))) {

898 
$objWr™”
->
	`¡¬tEËm’t
('a:glow');

899 
$objWr™”
->
	`wr™eA‰ribu‹
('¿d', 
$xAxis
->
	`g‘GlowPrİ”ty
('size'));

900 
$objWr™”
->
	`¡¬tEËm’t
("a:{$xAxis->getGlowProperty(array('color','type'))}");

901 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘GlowPrİ”ty
(
	`¬¿y
('color','value')));

902 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

903 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘GlowPrİ”ty
(
	`¬¿y
('color','alpha')));

904 
$objWr™”
->
	`’dEËm’t
();

905 
$objWr™”
->
	`’dEËm’t
();

906 
$objWr™”
->
	`’dEËm’t
();

909 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘ShadowPrİ”ty
('presets'))) {

910 
$objWr™”
->
	`¡¬tEËm’t
("a:{$xAxis->getShadowProperty('effect')}");

912 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘ShadowPrİ”ty
('blur'))) {

913 
$objWr™”
->
	`wr™eA‰ribu‹
('blurRad', 
$xAxis
->
	`g‘ShadowPrİ”ty
('blur'));

915 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘ShadowPrİ”ty
('distance'))) {

916 
$objWr™”
->
	`wr™eA‰ribu‹
('di¡', 
$xAxis
->
	`g‘ShadowPrİ”ty
('distance'));

918 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘ShadowPrİ”ty
('direction'))) {

919 
$objWr™”
->
	`wr™eA‰ribu‹
('dœ', 
$xAxis
->
	`g‘ShadowPrİ”ty
('direction'));

921 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘ShadowPrİ”ty
('algn'))) {

922 
$objWr™”
->
	`wr™eA‰ribu‹
('®gn', 
$xAxis
->
	`g‘ShadowPrİ”ty
('algn'));

924 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size','sx')))) {

925 
$objWr™”
->
	`wr™eA‰ribu‹
('sx', 
$xAxis
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size','sx')));

927 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size','sy')))) {

928 
$objWr™”
->
	`wr™eA‰ribu‹
('sy', 
$xAxis
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size','sy')));

930 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size','kx')))) {

931 
$objWr™”
->
	`wr™eA‰ribu‹
('kx', 
$xAxis
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('size','kx')));

933 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘ShadowPrİ”ty
('rotWithShape'))) {

934 
$objWr™”
->
	`wr™eA‰ribu‹
('rÙW™hSh­e', 
$xAxis
->
	`g‘ShadowPrİ”ty
('rotWithShape'));

937 
$objWr™”
->
	`¡¬tEËm’t
("a:{$xAxis->getShadowProperty(array('color','type'))}");

938 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('color','value')));

939 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

940 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘ShadowPrİ”ty
(
	`¬¿y
('color','alpha')));

941 
$objWr™”
->
	`’dEËm’t
();

942 
$objWr™”
->
	`’dEËm’t
();

944 
$objWr™”
->
	`’dEËm’t
();

947 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘SoáEdgesSize
())) {

948 
$objWr™”
->
	`¡¬tEËm’t
('a:softEdge');

949 
$objWr™”
->
	`wr™eA‰ribu‹
('¿d', 
$xAxis
->
	`g‘SoáEdgesSize
());

950 
$objWr™”
->
	`’dEËm’t
();

953 
$objWr™”
->
	`’dEËm’t
();

954 
$objWr™”
->
	`’dEËm’t
();

956 ià(
$id1
 > 0) {

957 
$objWr™”
->
	`¡¬tEËm’t
('c:crossAx');

958 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$id2
);

959 
$objWr™”
->
	`’dEËm’t
();

961 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('horizontal_crosses_value'))) {

962 
$objWr™”
->
	`¡¬tEËm’t
('c:crossesAt');

963 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('horizontal_crosses_value'));

964 
$objWr™”
->
	`’dEËm’t
();

966 
$objWr™”
->
	`¡¬tEËm’t
('c:crosses');

967 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('horizontal_crosses'));

968 
$objWr™”
->
	`’dEËm’t
();

971 
$objWr™”
->
	`¡¬tEËm’t
('c:crossBetween');

972 
$objWr™”
->
	`wr™eA‰ribu‹
('val', "midCat");

973 
$objWr™”
->
	`’dEËm’t
();

975 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('major_unit'))) {

976 
$objWr™”
->
	`¡¬tEËm’t
('c:majorUnit');

977 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('major_unit'));

978 
$objWr™”
->
	`’dEËm’t
();

981 ià(!
	`is_nuÎ
(
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('minor_unit'))) {

982 
$objWr™”
->
	`¡¬tEËm’t
('c:minorUnit');

983 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xAxis
->
	`g‘AxisO±iÚsPrİ”ty
('minor_unit'));

984 
$objWr™”
->
	`’dEËm’t
();

988 ià(
$isMuÉiLev–S”›s
) {

989 ià(
$groupTy³
 !=ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_BUBBLECHART
) {

990 
$objWr™”
->
	`¡¬tEËm’t
('c:noMultiLvlLbl');

991 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

992 
$objWr™”
->
	`’dEËm’t
();

996 
$objWr™”
->
	`’dEËm’t
();

997 
	}
}

1007 
´iv©e
 
funùiÚ
 
	$g‘Ch¬tTy³
(
$¶ÙA»a
)

1009 
$groupCouÁ
 = 
$¶ÙA»a
->
	`g‘PlÙGroupCouÁ
();

1011 ià(
$groupCouÁ
 == 1) {

1012 
$ch¬tTy³
 = 
	`¬¿y
(
$¶ÙA»a
->
	`g‘PlÙGroupByIndex
(0)->
	`g‘PlÙTy³
());

1014 
$ch¬tTy³s
 = 
	`¬¿y
();

1015 
$i
 = 0; $˜< 
$groupCouÁ
; ++$i) {

1016 
$ch¬tTy³s
[] = 
$¶ÙA»a
->
	`g‘PlÙGroupByIndex
(
$i
)->
	`g‘PlÙTy³
();

1018 
$ch¬tTy³
 = 
	`¬¿y_unique
(
$ch¬tTy³s
);

1019 ià(
	`couÁ
(
$ch¬tTy³s
) == 0) {

1020 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('Chart is‚ot yet implemented');

1024  
$ch¬tTy³
;

1025 
	}
}

1040 
´iv©e
 
funùiÚ
 
	$wr™ePlÙGroup
(
$¶ÙGroup
, 
$groupTy³
, 
$objWr™”
, &
$ÿtIsMuÉiLev–S”›s
, &
$v®IsMuÉiLev–S”›s
, &
$¶ÙGroupšgTy³
, 
PHPExûl_WÜksh“t
 
$pSh“t
)

1042 ià(
	`is_nuÎ
(
$¶ÙGroup
)) {

1046 ià((
$groupTy³
 =ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_BARCHART
è|| ($groupTy³ =ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_BARCHART_3D
)) {

1047 
$objWr™”
->
	`¡¬tEËm’t
('c:barDir');

1048 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$¶ÙGroup
->
	`g‘PlÙDœeùiÚ
());

1049 
$objWr™”
->
	`’dEËm’t
();

1052 ià(!
	`is_nuÎ
(
$¶ÙGroup
->
	`g‘PlÙGroupšg
())) {

1053 
$¶ÙGroupšgTy³
 = 
$¶ÙGroup
->
	`g‘PlÙGroupšg
();

1054 
$objWr™”
->
	`¡¬tEËm’t
('c:grouping');

1055 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$¶ÙGroupšgTy³
);

1056 
$objWr™”
->
	`’dEËm’t
();

1060 
$¶ÙS”›sOrd”
 = 
$¶ÙGroup
->
	`g‘PlÙOrd”
();

1061 
$¶ÙS”›sCouÁ
 = 
	`couÁ
(
$¶ÙS”›sOrd”
);

1063 ià((
$groupTy³
 !=ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_RADARCHART
è&& ($groupTy³ !=ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_STOCKCHART
)) {

1064 ià(
$groupTy³
 !=ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_LINECHART
) {

1065 ià((
$groupTy³
 =ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_PIECHART
è|| ($groupTy³ =ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_PIECHART_3D
è|| ($groupTy³ =ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_DONUTCHART
è|| (
$¶ÙS”›sCouÁ
 > 1)) {

1066 
$objWr™”
->
	`¡¬tEËm’t
('c:varyColors');

1067 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 1);

1068 
$objWr™”
->
	`’dEËm’t
();

1070 
$objWr™”
->
	`¡¬tEËm’t
('c:varyColors');

1071 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

1072 
$objWr™”
->
	`’dEËm’t
();

1077 
	`fÜ—ch
 (
$¶ÙS”›sOrd”
 
as
 
$¶ÙS”›sIdx
 => 
$¶ÙS”›sRef
) {

1078 
$objWr™”
->
	`¡¬tEËm’t
('c:ser');

1080 
$objWr™”
->
	`¡¬tEËm’t
('c:idx');

1081 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$this
->
_£r›sIndex
 + 
$¶ÙS”›sIdx
);

1082 
$objWr™”
->
	`’dEËm’t
();

1084 
$objWr™”
->
	`¡¬tEËm’t
('c:order');

1085 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$this
->
_£r›sIndex
 + 
$¶ÙS”›sRef
);

1086 
$objWr™”
->
	`’dEËm’t
();

1088 ià((
$groupTy³
 =ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_PIECHART
è|| ($groupTy³ =ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_PIECHART_3D
è|| ($groupTy³ =ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_DONUTCHART
)) {

1089 
$objWr™”
->
	`¡¬tEËm’t
('c:dPt');

1090 
$objWr™”
->
	`¡¬tEËm’t
('c:idx');

1091 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 3);

1092 
$objWr™”
->
	`’dEËm’t
();

1094 
$objWr™”
->
	`¡¬tEËm’t
('c:bubble3D');

1095 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

1096 
$objWr™”
->
	`’dEËm’t
();

1098 
$objWr™”
->
	`¡¬tEËm’t
('c:spPr');

1099 
$objWr™”
->
	`¡¬tEËm’t
('a:solidFill');

1100 
$objWr™”
->
	`¡¬tEËm’t
('a:srgbClr');

1101 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'FF9900');

1102 
$objWr™”
->
	`’dEËm’t
();

1103 
$objWr™”
->
	`’dEËm’t
();

1104 
$objWr™”
->
	`’dEËm’t
();

1105 
$objWr™”
->
	`’dEËm’t
();

1109 
$¶ÙS”›sLab–
 = 
$¶ÙGroup
->
	`g‘PlÙLab–ByIndex
(
$¶ÙS”›sRef
);

1110 ià(
$¶ÙS”›sLab–
 && ($¶ÙS”›sLab–->
	`g‘PoštCouÁ
() > 0)) {

1111 
$objWr™”
->
	`¡¬tEËm’t
('c:tx');

1112 
$objWr™”
->
	`¡¬tEËm’t
('c:strRef');

1113 
$this
->
	`wr™ePlÙS”›sLab–
(
$¶ÙS”›sLab–
, 
$objWr™”
);

1114 
$objWr™”
->
	`’dEËm’t
();

1115 
$objWr™”
->
	`’dEËm’t
();

1119 ià((
$groupTy³
 =ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_LINECHART
è|| ($groupTy³ =ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_STOCKCHART
)) {

1120 
$objWr™”
->
	`¡¬tEËm’t
('c:spPr');

1121 
$objWr™”
->
	`¡¬tEËm’t
('a:ln');

1122 
$objWr™”
->
	`wr™eA‰ribu‹
('w', 12700);

1123 ià(
$groupTy³
 =ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_STOCKCHART
) {

1124 
$objWr™”
->
	`¡¬tEËm’t
('a:noFill');

1125 
$objWr™”
->
	`’dEËm’t
();

1127 
$objWr™”
->
	`’dEËm’t
();

1128 
$objWr™”
->
	`’dEËm’t
();

1131 
$¶ÙS”›sV®ues
 = 
$¶ÙGroup
->
	`g‘PlÙV®uesByIndex
(
$¶ÙS”›sRef
);

1132 ià(
$¶ÙS”›sV®ues
) {

1133 
$¶ÙS”›sM¬k”
 = 
$¶ÙS”›sV®ues
->
	`g‘PoštM¬k”
();

1134 ià(
$¶ÙS”›sM¬k”
) {

1135 
$objWr™”
->
	`¡¬tEËm’t
('c:marker');

1136 
$objWr™”
->
	`¡¬tEËm’t
('c:symbol');

1137 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$¶ÙS”›sM¬k”
);

1138 
$objWr™”
->
	`’dEËm’t
();

1140 ià(
$¶ÙS”›sM¬k”
 !== 'none') {

1141 
$objWr™”
->
	`¡¬tEËm’t
('c:size');

1142 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 3);

1143 
$objWr™”
->
	`’dEËm’t
();

1146 
$objWr™”
->
	`’dEËm’t
();

1150 ià((
$groupTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_BARCHART
è|| ($groupTy³ ==ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_BARCHART_3D
è|| ($groupTy³ ==ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_BUBBLECHART
)) {

1151 
$objWr™”
->
	`¡¬tEËm’t
('c:invertIfNegative');

1152 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

1153 
$objWr™”
->
	`’dEËm’t
();

1157 
$¶ÙS”›sC©egÜy
 = 
$¶ÙGroup
->
	`g‘PlÙC©egÜyByIndex
(
$¶ÙS”›sRef
);

1158 ià(
$¶ÙS”›sC©egÜy
 && ($¶ÙS”›sC©egÜy->
	`g‘PoštCouÁ
() > 0)) {

1159 
$ÿtIsMuÉiLev–S”›s
 = $ÿtIsMuÉiLev–S”› || 
$¶ÙS”›sC©egÜy
->
	`isMuÉiLev–S”›s
();

1161 ià((
$groupTy³
 =ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_PIECHART
è|| ($groupTy³ =ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_PIECHART_3D
è|| ($groupTy³ =ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_DONUTCHART
)) {

1162 ià(!
	`is_nuÎ
(
$¶ÙGroup
->
	`g‘PlÙStyË
())) {

1163 
$¶ÙStyË
 = 
$¶ÙGroup
->
	`g‘PlÙStyË
();

1164 ià(
$¶ÙStyË
) {

1165 
$objWr™”
->
	`¡¬tEËm’t
('c:explosion');

1166 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 25);

1167 
$objWr™”
->
	`’dEËm’t
();

1172 ià((
$groupTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_BUBBLECHART
è|| ($groupTy³ ==ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_SCATTERCHART
)) {

1173 
$objWr™”
->
	`¡¬tEËm’t
('c:xVal');

1175 
$objWr™”
->
	`¡¬tEËm’t
('c:cat');

1178 
$this
->
	`wr™ePlÙS”›sV®ues
(
$¶ÙS”›sC©egÜy
, 
$objWr™”
, 
$groupTy³
, '¡r', 
$pSh“t
);

1179 
$objWr™”
->
	`’dEËm’t
();

1183 ià(
$¶ÙS”›sV®ues
) {

1184 
$v®IsMuÉiLev–S”›s
 = $v®IsMuÉiLev–S”› || 
$¶ÙS”›sV®ues
->
	`isMuÉiLev–S”›s
();

1186 ià((
$groupTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_BUBBLECHART
è|| ($groupTy³ ==ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_SCATTERCHART
)) {

1187 
$objWr™”
->
	`¡¬tEËm’t
('c:yVal');

1189 
$objWr™”
->
	`¡¬tEËm’t
('c:val');

1192 
$this
->
	`wr™ePlÙS”›sV®ues
(
$¶ÙS”›sV®ues
, 
$objWr™”
, 
$groupTy³
, 'num', 
$pSh“t
);

1193 
$objWr™”
->
	`’dEËm’t
();

1196 ià(
$groupTy³
 ==ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_BUBBLECHART
) {

1197 
$this
->
	`wr™eBubbËs
(
$¶ÙS”›sV®ues
, 
$objWr™”
, 
$pSh“t
);

1200 
$objWr™”
->
	`’dEËm’t
();

1203 
$this
->
_£r›sIndex
 +ğ
$¶ÙS”›sIdx
 + 1;

1204 
	}
}

1214 
´iv©e
 
funùiÚ
 
	$wr™ePlÙS”›sLab–
(
$¶ÙS”›sLab–
, 
$objWr™”
)

1216 ià(
	`is_nuÎ
(
$¶ÙS”›sLab–
)) {

1220 
$objWr™”
->
	`¡¬tEËm’t
('c:f');

1221 
$objWr™”
->
	`wr™eRawD©a
(
$¶ÙS”›sLab–
->
	`g‘D©aSourû
());

1222 
$objWr™”
->
	`’dEËm’t
();

1224 
$objWr™”
->
	`¡¬tEËm’t
('c:strCache');

1225 
$objWr™”
->
	`¡¬tEËm’t
('c:ptCount');

1226 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$¶ÙS”›sLab–
->
	`g‘PoštCouÁ
());

1227 
$objWr™”
->
	`’dEËm’t
();

1229 
	`fÜ—ch
 (
$¶ÙS”›sLab–
->
	`g‘D©aV®ues
(è
as
 
$¶ÙLab–Key
 => 
$¶ÙLab–V®ue
) {

1230 
$objWr™”
->
	`¡¬tEËm’t
('c:pt');

1231 
$objWr™”
->
	`wr™eA‰ribu‹
('idx', 
$¶ÙLab–Key
);

1233 
$objWr™”
->
	`¡¬tEËm’t
('c:v');

1234 
$objWr™”
->
	`wr™eRawD©a
(
$¶ÙLab–V®ue
);

1235 
$objWr™”
->
	`’dEËm’t
();

1236 
$objWr™”
->
	`’dEËm’t
();

1238 
$objWr™”
->
	`’dEËm’t
();

1239 
	}
}

1252 
´iv©e
 
funùiÚ
 
wr™ePlÙS”›sV®ues
(
$¶ÙS”›sV®ues
, 
$objWr™”
, 
$groupTy³
, 
$d©aTy³
 = '¡r', 
PHPExûl_WÜksh“t
 
$pSh“t
)

1254 ià(
is_nuÎ
(
$¶ÙS”›sV®ues
)) {

1258 ià(
	g$¶ÙS”›sV®ues
->
isMuÉiLev–S”›s
()) {

1259 
	g$Ëv–CouÁ
 = 
$¶ÙS”›sV®ues
->
muÉiLev–CouÁ
();

1261 
	g$objWr™”
->
¡¬tEËm’t
('c:multiLvlStrRef');

1263 
	g$objWr™”
->
¡¬tEËm’t
('c:f');

1264 
	g$objWr™”
->
wr™eRawD©a
(
$¶ÙS”›sV®ues
->
g‘D©aSourû
());

1265 
	g$objWr™”
->
’dEËm’t
();

1267 
	g$objWr™”
->
¡¬tEËm’t
('c:multiLvlStrCache');

1269 
	g$objWr™”
->
¡¬tEËm’t
('c:ptCount');

1270 
	g$objWr™”
->
wr™eA‰ribu‹
('v®', 
$¶ÙS”›sV®ues
->
g‘PoštCouÁ
());

1271 
	g$objWr™”
->
’dEËm’t
();

1273 
	g$Ëv–
 = 0; $Ëv– < 
	g$Ëv–CouÁ
; ++$level) {

1274 
	g$objWr™”
->
¡¬tEËm’t
('c:lvl');

1276 
fÜ—ch
 (
$¶ÙS”›sV®ues
->
g‘D©aV®ues
(è
as
 
$¶ÙS”›sKey
 => 
$¶ÙS”›sV®ue
) {

1277 ià(
is£t
(
$¶ÙS”›sV®ue
[
$Ëv–
])) {

1278 
$objWr™”
->
¡¬tEËm’t
('c:pt');

1279 
	g$objWr™”
->
wr™eA‰ribu‹
('idx', 
$¶ÙS”›sKey
);

1281 
	g$objWr™”
->
¡¬tEËm’t
('c:v');

1282 
	g$objWr™”
->
wr™eRawD©a
(
$¶ÙS”›sV®ue
[
$Ëv–
]);

1283 
	g$objWr™”
->
’dEËm’t
();

1284 
	g$objWr™”
->
’dEËm’t
();

1288 
	g$objWr™”
->
’dEËm’t
();

1291 
	g$objWr™”
->
’dEËm’t
();

1293 
	g$objWr™”
->
’dEËm’t
();

1295 
	g$objWr™”
->
¡¬tEËm’t
('c:' . 
$d©aTy³
 . 'Ref');

1297 
	g$objWr™”
->
¡¬tEËm’t
('c:f');

1298 
	g$objWr™”
->
wr™eRawD©a
(
$¶ÙS”›sV®ues
->
g‘D©aSourû
());

1299 
	g$objWr™”
->
’dEËm’t
();

1301 
	g$objWr™”
->
¡¬tEËm’t
('c:' . 
$d©aTy³
 . 'Cache');

1303 ià((
	g$groupTy³
 !ğ
PHPExûl_Ch¬t_D©aS”›s
::
TYPE_PIECHART
è&& (
$groupTy³
 !ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_PIECHART_3D
è&& ($groupTy³ !ğPHPExûl_Ch¬t_D©aS”›s::
TYPE_DONUTCHART
)) {

1304 ià((
$¶ÙS”›sV®ues
->
g‘FÜm©Code
(è!=ğ
nuÎ
) && ($plotSeriesValues->getFormatCode() !== '')) {

1305 
$objWr™”
->
¡¬tEËm’t
('c:formatCode');

1306 
	g$objWr™”
->
wr™eRawD©a
(
$¶ÙS”›sV®ues
->
g‘FÜm©Code
());

1307 
	g$objWr™”
->
’dEËm’t
();

1311 
	g$objWr™”
->
¡¬tEËm’t
('c:ptCount');

1312 
	g$objWr™”
->
wr™eA‰ribu‹
('v®', 
$¶ÙS”›sV®ues
->
g‘PoštCouÁ
());

1313 
	g$objWr™”
->
’dEËm’t
();

1315 
	g$d©aV®ues
 = 
$¶ÙS”›sV®ues
->
g‘D©aV®ues
();

1316 ià(!
em±y
(
$d©aV®ues
)) {

1317 ià(
is_¬¿y
(
$d©aV®ues
)) {

1318 
fÜ—ch
 (
$d©aV®ues
 
as
 
$¶ÙS”›sKey
 => 
$¶ÙS”›sV®ue
) {

1319 
$objWr™”
->
¡¬tEËm’t
('c:pt');

1320 
	g$objWr™”
->
wr™eA‰ribu‹
('idx', 
$¶ÙS”›sKey
);

1322 
	g$objWr™”
->
¡¬tEËm’t
('c:v');

1323 
	g$objWr™”
->
wr™eRawD©a
(
$¶ÙS”›sV®ue
);

1324 
	g$objWr™”
->
’dEËm’t
();

1325 
	g$objWr™”
->
’dEËm’t
();

1330 
	g$objWr™”
->
’dEËm’t
();

1332 
	g$objWr™”
->
’dEËm’t
();

1344 
´iv©e
 
funùiÚ
 
	$wr™eBubbËs
(
$¶ÙS”›sV®ues
, 
$objWr™”
, 
PHPExûl_WÜksh“t
 
$pSh“t
)

1346 ià(
	`is_nuÎ
(
$¶ÙS”›sV®ues
)) {

1350 
$objWr™”
->
	`¡¬tEËm’t
('c:bubbleSize');

1351 
$objWr™”
->
	`¡¬tEËm’t
('c:numLit');

1353 
$objWr™”
->
	`¡¬tEËm’t
('c:formatCode');

1354 
$objWr™”
->
	`wr™eRawD©a
('General');

1355 
$objWr™”
->
	`’dEËm’t
();

1357 
$objWr™”
->
	`¡¬tEËm’t
('c:ptCount');

1358 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$¶ÙS”›sV®ues
->
	`g‘PoštCouÁ
());

1359 
$objWr™”
->
	`’dEËm’t
();

1361 
$d©aV®ues
 = 
$¶ÙS”›sV®ues
->
	`g‘D©aV®ues
();

1362 ià(!
	`em±y
(
$d©aV®ues
)) {

1363 ià(
	`is_¬¿y
(
$d©aV®ues
)) {

1364 
	`fÜ—ch
 (
$d©aV®ues
 
as
 
$¶ÙS”›sKey
 => 
$¶ÙS”›sV®ue
) {

1365 
$objWr™”
->
	`¡¬tEËm’t
('c:pt');

1366 
$objWr™”
->
	`wr™eA‰ribu‹
('idx', 
$¶ÙS”›sKey
);

1367 
$objWr™”
->
	`¡¬tEËm’t
('c:v');

1368 
$objWr™”
->
	`wr™eRawD©a
(1);

1369 
$objWr™”
->
	`’dEËm’t
();

1370 
$objWr™”
->
	`’dEËm’t
();

1375 
$objWr™”
->
	`’dEËm’t
();

1376 
$objWr™”
->
	`’dEËm’t
();

1378 
$objWr™”
->
	`¡¬tEËm’t
('c:bubble3D');

1379 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 0);

1380 
$objWr™”
->
	`’dEËm’t
();

1381 
	}
}

1391 
´iv©e
 
funùiÚ
 
	$wr™eLayout
(
PHPExûl_Ch¬t_Layout
 
$Ïyout
 = 
nuÎ
, 
$objWr™”
)

1393 
$objWr™”
->
	`¡¬tEËm’t
('c:layout');

1395 ià(!
	`is_nuÎ
(
$Ïyout
)) {

1396 
$objWr™”
->
	`¡¬tEËm’t
('c:manualLayout');

1398 
$ÏyoutT¬g‘
 = 
$Ïyout
->
	`g‘LayoutT¬g‘
();

1399 ià(!
	`is_nuÎ
(
$ÏyoutT¬g‘
)) {

1400 
$objWr™”
->
	`¡¬tEËm’t
('c:layoutTarget');

1401 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$ÏyoutT¬g‘
);

1402 
$objWr™”
->
	`’dEËm’t
();

1405 
$xMode
 = 
$Ïyout
->
	`g‘XMode
();

1406 ià(!
	`is_nuÎ
(
$xMode
)) {

1407 
$objWr™”
->
	`¡¬tEËm’t
('c:xMode');

1408 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$xMode
);

1409 
$objWr™”
->
	`’dEËm’t
();

1412 
$yMode
 = 
$Ïyout
->
	`g‘YMode
();

1413 ià(!
	`is_nuÎ
(
$yMode
)) {

1414 
$objWr™”
->
	`¡¬tEËm’t
('c:yMode');

1415 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$yMode
);

1416 
$objWr™”
->
	`’dEËm’t
();

1419 
$x
 = 
$Ïyout
->
	`g‘XPos™iÚ
();

1420 ià(!
	`is_nuÎ
(
$x
)) {

1421 
$objWr™”
->
	`¡¬tEËm’t
('c:x');

1422 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$x
);

1423 
$objWr™”
->
	`’dEËm’t
();

1426 
$y
 = 
$Ïyout
->
	`g‘YPos™iÚ
();

1427 ià(!
	`is_nuÎ
(
$y
)) {

1428 
$objWr™”
->
	`¡¬tEËm’t
('c:y');

1429 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$y
);

1430 
$objWr™”
->
	`’dEËm’t
();

1433 
$w
 = 
$Ïyout
->
	`g‘Width
();

1434 ià(!
	`is_nuÎ
(
$w
)) {

1435 
$objWr™”
->
	`¡¬tEËm’t
('c:w');

1436 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$w
);

1437 
$objWr™”
->
	`’dEËm’t
();

1440 
$h
 = 
$Ïyout
->
	`g‘Height
();

1441 ià(!
	`is_nuÎ
(
$h
)) {

1442 
$objWr™”
->
	`¡¬tEËm’t
('c:h');

1443 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$h
);

1444 
$objWr™”
->
	`’dEËm’t
();

1447 
$objWr™”
->
	`’dEËm’t
();

1450 
$objWr™”
->
	`’dEËm’t
();

1451 
	}
}

1460 
´iv©e
 
funùiÚ
 
	$wr™eAÉ”Ç‹CÚ‹Á
(
$objWr™”
)

1462 
$objWr™”
->
	`¡¬tEËm’t
('mc:AlternateContent');

1463 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:mc', 'http://schemas.openxmlformats.org/markup-compatibility/2006');

1465 
$objWr™”
->
	`¡¬tEËm’t
('mc:Choice');

1466 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:c14', 'http://schemas.microsoft.com/office/drawing/2007/8/2/chart');

1467 
$objWr™”
->
	`wr™eA‰ribu‹
('Requires', 'c14');

1469 
$objWr™”
->
	`¡¬tEËm’t
('c14:style');

1470 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '102');

1471 
$objWr™”
->
	`’dEËm’t
();

1472 
$objWr™”
->
	`’dEËm’t
();

1474 
$objWr™”
->
	`¡¬tEËm’t
('mc:Fallback');

1475 
$objWr™”
->
	`¡¬tEËm’t
('c:style');

1476 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '2');

1477 
$objWr™”
->
	`’dEËm’t
();

1478 
$objWr™”
->
	`’dEËm’t
();

1480 
$objWr™”
->
	`’dEËm’t
();

1481 
	}
}

1490 
´iv©e
 
funùiÚ
 
	$wr™ePrštS‘tšgs
(
$objWr™”
)

1492 
$objWr™”
->
	`¡¬tEËm’t
('c:printSettings');

1494 
$objWr™”
->
	`¡¬tEËm’t
('c:headerFooter');

1495 
$objWr™”
->
	`’dEËm’t
();

1497 
$objWr™”
->
	`¡¬tEËm’t
('c:pageMargins');

1498 
$objWr™”
->
	`wr™eA‰ribu‹
('footer', 0.3);

1499 
$objWr™”
->
	`wr™eA‰ribu‹
('header', 0.3);

1500 
$objWr™”
->
	`wr™eA‰ribu‹
('r', 0.7);

1501 
$objWr™”
->
	`wr™eA‰ribu‹
('l', 0.7);

1502 
$objWr™”
->
	`wr™eA‰ribu‹
('t', 0.75);

1503 
$objWr™”
->
	`wr™eA‰ribu‹
('b', 0.75);

1504 
$objWr™”
->
	`’dEËm’t
();

1506 
$objWr™”
->
	`¡¬tEËm’t
('c:pageSetup');

1507 
$objWr™”
->
	`wr™eA‰ribu‹
('orientation', "portrait");

1508 
$objWr™”
->
	`’dEËm’t
();

1510 
$objWr™”
->
	`’dEËm’t
();

1511 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Comments.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_Comm’ts
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™eComm’ts
(
PHPExûl_WÜksh“t
 
$pWÜksh“t
 = 
nuÎ
)

40 
$objWr™”
 = 
nuÎ
;

41 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

42 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

44 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

48 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

51 
$comm’ts
 = 
$pWÜksh“t
->
	`g‘Comm’ts
();

54 
$authÜs
 = 
	`¬¿y
();

55 
$authÜId
 = 0;

56 
	`fÜ—ch
 (
$comm’ts
 
as
 
$comm’t
) {

57 ià(!
	`is£t
(
$authÜs
[
$comm’t
->
	`g‘AuthÜ
()])) {

58 
$authÜs
[
$comm’t
->
	`g‘AuthÜ
()] = 
$authÜId
++;

63 
$objWr™”
->
	`¡¬tEËm’t
('comments');

64 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');

67 
$objWr™”
->
	`¡¬tEËm’t
('authors');

68 
	`fÜ—ch
 (
$authÜs
 
as
 
$authÜ
 => 
$šdex
) {

69 
$objWr™”
->
	`wr™eEËm’t
('authÜ', 
$authÜ
);

71 
$objWr™”
->
	`’dEËm’t
();

74 
$objWr™”
->
	`¡¬tEËm’t
('commentList');

75 
	`fÜ—ch
 (
$comm’ts
 
as
 
$key
 => 
$v®ue
) {

76 
$this
->
	`wr™eComm’t
(
$objWr™”
, 
$key
, 
$v®ue
, 
$authÜs
);

78 
$objWr™”
->
	`’dEËm’t
();

80 
$objWr™”
->
	`’dEËm’t
();

83  
$objWr™”
->
	`g‘D©a
();

95 
´iv©e
 
funùiÚ
 
	`wr™eComm’t
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
$pC–lReã»nû
 = 'A1', 
PHPExûl_Comm’t
 
$pComm’t
 =‚uÎ, 
$pAuthÜs
 =‚ull)

98 
$objWr™”
->
	`¡¬tEËm’t
('comment');

99 
$objWr™”
->
	`wr™eA‰ribu‹
('»f', 
$pC–lReã»nû
);

100 
$objWr™”
->
	`wr™eA‰ribu‹
('authÜId', 
$pAuthÜs
[
$pComm’t
->
	`g‘AuthÜ
()]);

103 
$objWr™”
->
	`¡¬tEËm’t
('text');

104 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘Wr™”P¬t
('¡ršgbË')->
	`wr™eRichText
(
$objWr™”
, 
$pComm’t
->
	`g‘Text
());

105 
$objWr™”
->
	`’dEËm’t
();

107 
$objWr™”
->
	`’dEËm’t
();

108 
	}
}

117 
public
 
funùiÚ
 
	$wr™eVMLComm’ts
(
PHPExûl_WÜksh“t
 
$pWÜksh“t
 = 
nuÎ
)

120 
$objWr™”
 = 
nuÎ
;

121 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

122 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

124 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

128 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

131 
$comm’ts
 = 
$pWÜksh“t
->
	`g‘Comm’ts
();

134 
$objWr™”
->
	`¡¬tEËm’t
('xml');

135 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:v', 'urn:schemas-microsoft-com:vml');

136 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:o', 'urn:schemas-microsoft-com:office:office');

137 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:x', 'urn:schemas-microsoft-com:office:excel');

140 
$objWr™”
->
	`¡¬tEËm’t
('o:shapelayout');

141 
$objWr™”
->
	`wr™eA‰ribu‹
('v:ext', 'edit');

144 
$objWr™”
->
	`¡¬tEËm’t
('o:idmap');

145 
$objWr™”
->
	`wr™eA‰ribu‹
('v:ext', 'edit');

146 
$objWr™”
->
	`wr™eA‰ribu‹
('data', '1');

147 
$objWr™”
->
	`’dEËm’t
();

149 
$objWr™”
->
	`’dEËm’t
();

152 
$objWr™”
->
	`¡¬tEËm’t
('v:shapetype');

153 
$objWr™”
->
	`wr™eA‰ribu‹
('id', '_x0000_t202');

154 
$objWr™”
->
	`wr™eA‰ribu‹
('coordsize', '21600,21600');

155 
$objWr™”
->
	`wr™eA‰ribu‹
('o:spt', '202');

156 
$objWr™”
->
	`wr™eA‰ribu‹
('path', 'm,l,21600r21600,l21600,xe');

159 
$objWr™”
->
	`¡¬tEËm’t
('v:stroke');

160 
$objWr™”
->
	`wr™eA‰ribu‹
('joinstyle', 'miter');

161 
$objWr™”
->
	`’dEËm’t
();

164 
$objWr™”
->
	`¡¬tEËm’t
('v:path');

165 
$objWr™”
->
	`wr™eA‰ribu‹
('gradientshapeok', 't');

166 
$objWr™”
->
	`wr™eA‰ribu‹
('o:connecttype', 'rect');

167 
$objWr™”
->
	`’dEËm’t
();

169 
$objWr™”
->
	`’dEËm’t
();

172 
	`fÜ—ch
 (
$comm’ts
 
as
 
$key
 => 
$v®ue
) {

173 
$this
->
	`wr™eVMLComm’t
(
$objWr™”
, 
$key
, 
$v®ue
);

176 
$objWr™”
->
	`’dEËm’t
();

179  
$objWr™”
->
	`g‘D©a
();

180 
	}
}

190 
´iv©e
 
funùiÚ
 
wr™eVMLComm’t
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
$pC–lReã»nû
 = 'A1', 
PHPExûl_Comm’t
 
$pComm’t
 =‚ull)

193 
li¡
(
$cŞumn
, 
$row
èğ
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$pC–lReã»nû
);

194 
	g$cŞumn
 = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$cŞumn
);

195 
	g$id
 = 1024 + 
$cŞumn
 + 
$row
;

196 
	g$id
 = 
sub¡r
(
$id
, 0, 4);

199 
	g$objWr™”
->
¡¬tEËm’t
('v:shape');

200 
	g$objWr™”
->
wr™eA‰ribu‹
('id', '_x0000_s' . 
$id
);

201 
	g$objWr™”
->
wr™eA‰ribu‹
('type', '#_x0000_t202');

202 
	g$objWr™”
->
wr™eA‰ribu‹
('¡yË', 'pos™iÚ:absŞu‹;m¬gš-Ëá:' . 
$pComm’t
->
g‘M¬gšLeá
(è. ';m¬gš-tİ:' . $pComm’t->
g‘M¬gšTİ
(è. ';width:' . $pComm’t->
g‘Width
(è. ';height:' . $pComm’t->
g‘Height
(è. ';z-šdex:1;visib™y:' . ($pComm’t->
g‘VisibË
() ? 'visible' : 'hidden'));

203 
	g$objWr™”
->
wr™eA‰ribu‹
('flcŞÜ', '#' . 
$pComm’t
->
g‘FlCŞÜ
()->
g‘RGB
());

204 
	g$objWr™”
->
wr™eA‰ribu‹
('o:insetmode', 'auto');

207 
	g$objWr™”
->
¡¬tEËm’t
('v:fill');

208 
	g$objWr™”
->
wr™eA‰ribu‹
('cŞÜ2', '#' . 
$pComm’t
->
g‘FlCŞÜ
()->
g‘RGB
());

209 
	g$objWr™”
->
’dEËm’t
();

212 
	g$objWr™”
->
¡¬tEËm’t
('v:shadow');

213 
	g$objWr™”
->
wr™eA‰ribu‹
('on', 't');

214 
	g$objWr™”
->
wr™eA‰ribu‹
('color', 'black');

215 
	g$objWr™”
->
wr™eA‰ribu‹
('obscured', 't');

216 
	g$objWr™”
->
’dEËm’t
();

219 
	g$objWr™”
->
¡¬tEËm’t
('v:path');

220 
	g$objWr™”
->
wr™eA‰ribu‹
('o:connecttype', 'none');

221 
	g$objWr™”
->
’dEËm’t
();

224 
	g$objWr™”
->
¡¬tEËm’t
('v:textbox');

225 
	g$objWr™”
->
wr™eA‰ribu‹
('style', 'mso-direction-alt:auto');

228 
	g$objWr™”
->
¡¬tEËm’t
('div');

229 
	g$objWr™”
->
wr™eA‰ribu‹
('style', 'text-align:left');

230 
	g$objWr™”
->
’dEËm’t
();

232 
	g$objWr™”
->
’dEËm’t
();

235 
	g$objWr™”
->
¡¬tEËm’t
('x:ClientData');

236 
	g$objWr™”
->
wr™eA‰ribu‹
('ObjectType', 'Note');

239 
	g$objWr™”
->
wr™eEËm’t
('x:MoveWithCells', '');

242 
	g$objWr™”
->
wr™eEËm’t
('x:SizeWithCells', '');

248 
	g$objWr™”
->
wr™eEËm’t
('x:AutoFill', 'False');

251 
	g$objWr™”
->
wr™eEËm’t
('x:Row', (
$row
 - 1));

254 
	g$objWr™”
->
wr™eEËm’t
('x:CŞumn', (
$cŞumn
 - 1));

256 
	g$objWr™”
->
’dEËm’t
();

258 
	g$objWr™”
->
’dEËm’t
();

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/ContentTypes.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_CÚ‹ÁTy³s
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


38 
public
 
funùiÚ
 
	$wr™eCÚ‹ÁTy³s
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
, 
$šşudeCh¬ts
 = 
çl£
)

41 
$objWr™”
 = 
nuÎ
;

42 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

43 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

45 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

49 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

52 
$objWr™”
->
	`¡¬tEËm’t
('Types');

53 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/package/2006/content-types');

56 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/xl/theme/theme1.xml', 'application/vnd.openxmlformats-officedocument.theme+xml');

59 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/xl/styles.xml', 'application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml');

62 
$this
->
	`wr™eDeçuÉCÚ‹ÁTy³
(
$objWr™”
, 'rels', 'application/vnd.openxmlformats-package.relationships+xml');

65 
$this
->
	`wr™eDeçuÉCÚ‹ÁTy³
(
$objWr™”
, 'xml', 'application/xml');

68 
$this
->
	`wr™eDeçuÉCÚ‹ÁTy³
(
$objWr™”
, 'vml', 'application/vnd.openxmlformats-officedocument.vmlDrawing');

71 ià(
$pPHPExûl
->
	`hasMaüos
()) {

73 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/xl/workbook.xml', 'application/vnd.ms-excel.sheet.macroEnabled.main+xml');

75 
$this
->
	`wr™eDeçuÉCÚ‹ÁTy³
(
$objWr™”
, 'bin', 'application/vnd.ms-office.vbaProject');

76 ià(
$pPHPExûl
->
	`hasMaüosC”tifiÿ‹
()) {

78 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/xl/vbaProjectSignature.bin', 'application/vnd.ms-office.vbaProjectSignature');

81 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/xl/workbook.xml', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml');

85 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/docProps/app.xml', 'application/vnd.openxmlformats-officedocument.extended-properties+xml');

87 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/docProps/core.xml', 'application/vnd.openxmlformats-package.core-properties+xml');

89 
$cu¡omPrİ”tyLi¡
 = 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Cu¡omPrİ”t›s
();

90 ià(!
	`em±y
(
$cu¡omPrİ”tyLi¡
)) {

91 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/docProps/custom.xml', 'application/vnd.openxmlformats-officedocument.custom-properties+xml');

95 
$sh“tCouÁ
 = 
$pPHPExûl
->
	`g‘Sh“tCouÁ
();

96 
$i
 = 0; $˜< 
$sh“tCouÁ
; ++$i) {

97 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/xl/wÜksh“ts/sh“t' . (
$i
 + 1) . '.xml', 'application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml');

101 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/xl/sharedStrings.xml', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml');

104 
$ch¬t
 = 1;

105 
$i
 = 0; $˜< 
$sh“tCouÁ
; ++$i) {

106 
$d¿wšgs
 = 
$pPHPExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘D¿wšgCŞËùiÚ
();

107 
$d¿wšgCouÁ
 = 
	`couÁ
(
$d¿wšgs
);

108 
$ch¬tCouÁ
 = (
$šşudeCh¬ts
è? 
$pPHPExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘Ch¬tCouÁ
() : 0;

111 ià((
$d¿wšgCouÁ
 > 0è|| (
$ch¬tCouÁ
 > 0)) {

112 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/xl/d¿wšgs/d¿wšg' . (
$i
 + 1) . '.xml', 'application/vnd.openxmlformats-officedocument.drawing+xml');

116 ià(
$ch¬tCouÁ
 > 0) {

117 
$c
 = 0; $ø< 
$ch¬tCouÁ
; ++$c) {

118 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/xl/ch¬ts/ch¬t' . 
$ch¬t
++ . '.xml', 'application/vnd.openxmlformats-officedocument.drawingml.chart+xml');

124 
$i
 = 0; $˜< 
$sh“tCouÁ
; ++$i) {

125 ià(
	`couÁ
(
$pPHPExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘Comm’ts
()) > 0) {

126 
$this
->
	`wr™eOv”rideCÚ‹ÁTy³
(
$objWr™”
, '/xl/comm’ts' . (
$i
 + 1) . '.xml', 'application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml');

131 
$aMedŸCÚ‹ÁTy³s
 = 
	`¬¿y
();

132 
$medŸCouÁ
 = 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘D¿wšgHashTabË
()->
	`couÁ
();

133 
$i
 = 0; $˜< 
$medŸCouÁ
; ++$i) {

134 
$ex‹nsiÚ
 = '';

135 
$mimeTy³
 = '';

137 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
è
š¡ªûof
 
PHPExûl_WÜksh“t_D¿wšg
) {

138 
$ex‹nsiÚ
 = 
	`¡¹Şow”
(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
)->
	`g‘Ex‹nsiÚ
());

139 
$mimeTy³
 = 
$this
->
	`g‘ImageMimeTy³
($this->
	`g‘P¬’tWr™”
()->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
)->
	`g‘P©h
());

140 } 
	`–£if
 (
$this
->
	`g‘P¬’tWr™”
()->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
è
š¡ªûof
 
PHPExûl_WÜksh“t_MemÜyD¿wšg
) {

141 
$ex‹nsiÚ
 = 
	`¡¹Şow”
(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
)->
	`g‘MimeTy³
());

142 
$ex‹nsiÚ
 = 
	`ex¶ode
('/', $extension);

143 
$ex‹nsiÚ
 = $extension[1];

145 
$mimeTy³
 = 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘D¿wšgHashTabË
()->
	`g‘ByIndex
(
$i
)->
	`g‘MimeTy³
();

148 ià(!
	`is£t
Ğ
$aMedŸCÚ‹ÁTy³s
[
$ex‹nsiÚ
])) {

149 
$aMedŸCÚ‹ÁTy³s
[
$ex‹nsiÚ
] = 
$mimeTy³
;

151 
$this
->
	`wr™eDeçuÉCÚ‹ÁTy³
(
$objWr™”
, 
$ex‹nsiÚ
, 
$mimeTy³
);

154 ià(
$pPHPExûl
->
	`hasRibbÚBšObjeùs
()) {

157 
$bRibbÚTy³s
=
	`¬¿y_diff
(
$pPHPExûl
->
	`g‘RibbÚBšObjeùs
('ty³s'), 
	`¬¿y_keys
(
$aMedŸCÚ‹ÁTy³s
));

158 
	`fÜ—ch
 (
$bRibbÚTy³s
 
as
 
$aRibbÚTy³
) {

159 
$mimeTy³
='image/.'.
$aRibbÚTy³
;

160 
$this
->
	`wr™eDeçuÉCÚ‹ÁTy³
(
$objWr™”
, 
$aRibbÚTy³
, 
$mimeTy³
);

163 
$sh“tCouÁ
 = 
$pPHPExûl
->
	`g‘Sh“tCouÁ
();

164 
$i
 = 0; $˜< 
$sh“tCouÁ
; ++$i) {

165 ià(
	`couÁ
(
$pPHPExûl
->
	`g‘Sh“t
()->
	`g‘H—d”FoÙ”
()->
	`g‘Images
()) > 0) {

166 
	`fÜ—ch
 (
$pPHPExûl
->
	`g‘Sh“t
()->
	`g‘H—d”FoÙ”
()->
	`g‘Images
(è
as
 
$image
) {

167 ià(!
	`is£t
Ğ
$aMedŸCÚ‹ÁTy³s
[
	`¡¹Şow”
(
$image
->
	`g‘Ex‹nsiÚ
())])) {

168 
$aMedŸCÚ‹ÁTy³s
[
	`¡¹Şow”
(
$image
->
	`g‘Ex‹nsiÚ
())] = 
$this
->
	`g‘ImageMimeTy³
($image->
	`g‘P©h
());

170 
$this
->
	`wr™eDeçuÉCÚ‹ÁTy³
(
$objWr™”
, 
	`¡¹Şow”
(
$image
->
	`g‘Ex‹nsiÚ
()), 
$aMedŸCÚ‹ÁTy³s
[strtolower($image->getExtension())]);

176 
$objWr™”
->
	`’dEËm’t
();

179  
$objWr™”
->
	`g‘D©a
();

189 
´iv©e
 
funùiÚ
 
	`g‘ImageMimeTy³
(
$pFe
 = '')

191 ià(
PHPExûl_Sh¬ed_Fe
::
	`fe_exi¡s
(
$pFe
)) {

192 
$image
 = 
	`g‘imagesize
(
$pFe
);

193  
	`image_ty³_to_mime_ty³
(
$image
[2]);

195 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("File $pFile does‚otƒxist");

197 
	}
}

207 
´iv©e
 
funùiÚ
 
wr™eDeçuÉCÚ‹ÁTy³
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
$pP¬Šame
 = '', 
$pCÚ‹ÁTy³
 = '')

209 ià(
$pP¬Šame
 !ğ'' && 
$pCÚ‹ÁTy³
 != '') {

211 
$objWr™”
->
¡¬tEËm’t
('Default');

212 
	g$objWr™”
->
wr™eA‰ribu‹
('Ex‹nsiÚ', 
$pP¬Šame
);

213 
	g$objWr™”
->
wr™eA‰ribu‹
('CÚ‹ÁTy³', 
$pCÚ‹ÁTy³
);

214 
	g$objWr™”
->
’dEËm’t
();

216 
throw
 
Ãw
 
PHPExûl_Wr™”_Exû±iÚ
("Invalid…arameters…assed.");

228 
´iv©e
 
funùiÚ
 
wr™eOv”rideCÚ‹ÁTy³
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
$pP¬Šame
 = '', 
$pCÚ‹ÁTy³
 = '')

230 ià(
$pP¬Šame
 !ğ'' && 
$pCÚ‹ÁTy³
 != '') {

232 
$objWr™”
->
¡¬tEËm’t
('Override');

233 
	g$objWr™”
->
wr™eA‰ribu‹
('P¬tName', 
$pP¬Šame
);

234 
	g$objWr™”
->
wr™eA‰ribu‹
('CÚ‹ÁTy³', 
$pCÚ‹ÁTy³
);

235 
	g$objWr™”
->
’dEËm’t
();

237 
throw
 
Ãw
 
PHPExûl_Wr™”_Exû±iÚ
("Invalid…arameters…assed.");

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/DocProps.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_DocPrİs
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™eDocPrİsAµ
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

40 
$objWr™”
 = 
nuÎ
;

41 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

42 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

44 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

48 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

51 
$objWr™”
->
	`¡¬tEËm’t
('Properties');

52 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties');

53 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:vt', 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes');

56 
$objWr™”
->
	`wr™eEËm’t
('Application', 'Microsoft Excel');

59 
$objWr™”
->
	`wr™eEËm’t
('DocSecurity', '0');

62 
$objWr™”
->
	`wr™eEËm’t
('ScaleCrop', 'false');

65 
$objWr™”
->
	`¡¬tEËm’t
('HeadingPairs');

68 
$objWr™”
->
	`¡¬tEËm’t
('vt:vector');

69 
$objWr™”
->
	`wr™eA‰ribu‹
('size', '2');

70 
$objWr™”
->
	`wr™eA‰ribu‹
('baseType', 'variant');

73 
$objWr™”
->
	`¡¬tEËm’t
('vt:variant');

74 
$objWr™”
->
	`wr™eEËm’t
('vt:lpstr', 'Worksheets');

75 
$objWr™”
->
	`’dEËm’t
();

78 
$objWr™”
->
	`¡¬tEËm’t
('vt:variant');

79 
$objWr™”
->
	`wr™eEËm’t
('vt:i4', 
$pPHPExûl
->
	`g‘Sh“tCouÁ
());

80 
$objWr™”
->
	`’dEËm’t
();

82 
$objWr™”
->
	`’dEËm’t
();

84 
$objWr™”
->
	`’dEËm’t
();

87 
$objWr™”
->
	`¡¬tEËm’t
('TitlesOfParts');

90 
$objWr™”
->
	`¡¬tEËm’t
('vt:vector');

91 
$objWr™”
->
	`wr™eA‰ribu‹
('size', 
$pPHPExûl
->
	`g‘Sh“tCouÁ
());

92 
$objWr™”
->
	`wr™eA‰ribu‹
('baseType', 'lpstr');

94 
$sh“tCouÁ
 = 
$pPHPExûl
->
	`g‘Sh“tCouÁ
();

95 
$i
 = 0; $˜< 
$sh“tCouÁ
; ++$i) {

96 
$objWr™”
->
	`wr™eEËm’t
('vt:Í¡r', 
$pPHPExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘T™Ë
());

99 
$objWr™”
->
	`’dEËm’t
();

101 
$objWr™”
->
	`’dEËm’t
();

104 
$objWr™”
->
	`wr™eEËm’t
('Com·ny', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Com·ny
());

107 
$objWr™”
->
	`wr™eEËm’t
('Mªag”', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Mªag”
());

110 
$objWr™”
->
	`wr™eEËm’t
('LinksUpToDate', 'false');

113 
$objWr™”
->
	`wr™eEËm’t
('SharedDoc', 'false');

116 
$objWr™”
->
	`wr™eEËm’t
('HyperlinksChanged', 'false');

119 
$objWr™”
->
	`wr™eEËm’t
('AppVersion', '12.0000');

121 
$objWr™”
->
	`’dEËm’t
();

124  
$objWr™”
->
	`g‘D©a
();

134 
public
 
funùiÚ
 
	$wr™eDocPrİsCÜe
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

137 
$objWr™”
 = 
nuÎ
;

138 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

139 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

141 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

145 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

148 
$objWr™”
->
	`¡¬tEËm’t
('cp:coreProperties');

149 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:cp', 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties');

150 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:dc', 'http://purl.org/dc/elements/1.1/');

151 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:dcterms', 'http://purl.org/dc/terms/');

152 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:dcmitype', 'http://purl.org/dc/dcmitype/');

153 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xsi', 'http://www.w3.org/2001/XMLSchema-instance');

156 
$objWr™”
->
	`wr™eEËm’t
('dc:ü—tÜ', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©Ü
());

159 
$objWr™”
->
	`wr™eEËm’t
('ı:Ï¡Modif›dBy', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘La¡Modif›dBy
());

162 
$objWr™”
->
	`¡¬tEËm’t
('dcterms:created');

163 
$objWr™”
->
	`wr™eA‰ribu‹
('xsi:type', 'dcterms:W3CDTF');

164 
$objWr™”
->
	`wr™eRawD©a
(
	`d©e
(
DATE_W3C
, 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©ed
()));

165 
$objWr™”
->
	`’dEËm’t
();

168 
$objWr™”
->
	`¡¬tEËm’t
('dcterms:modified');

169 
$objWr™”
->
	`wr™eA‰ribu‹
('xsi:type', 'dcterms:W3CDTF');

170 
$objWr™”
->
	`wr™eRawD©a
(
	`d©e
(
DATE_W3C
, 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Modif›d
()));

171 
$objWr™”
->
	`’dEËm’t
();

174 
$objWr™”
->
	`wr™eEËm’t
('dc:t™Ë', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘T™Ë
());

177 
$objWr™”
->
	`wr™eEËm’t
('dc:desütiÚ', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘DesütiÚ
());

180 
$objWr™”
->
	`wr™eEËm’t
('dc:subjeù', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Subjeù
());

183 
$objWr™”
->
	`wr™eEËm’t
('ı:keywÜds', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘KeywÜds
());

186 
$objWr™”
->
	`wr™eEËm’t
('ı:ÿ‹gÜy', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘C©egÜy
());

188 
$objWr™”
->
	`’dEËm’t
();

191  
$objWr™”
->
	`g‘D©a
();

192 
	}
}

201 
public
 
funùiÚ
 
	$wr™eDocPrİsCu¡om
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

203 
$cu¡omPrİ”tyLi¡
 = 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Cu¡omPrİ”t›s
();

204 ià(
	`em±y
(
$cu¡omPrİ”tyLi¡
)) {

209 
$objWr™”
 = 
nuÎ
;

210 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

211 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

213 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

217 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

220 
$objWr™”
->
	`¡¬tEËm’t
('Properties');

221 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/officeDocument/2006/custom-properties');

222 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:vt', 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes');

225 
	`fÜ—ch
 (
$cu¡omPrİ”tyLi¡
 
as
 
$key
 => 
$cu¡omPrİ”ty
) {

226 
$´İ”tyV®ue
 = 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Cu¡omPrİ”tyV®ue
(
$cu¡omPrİ”ty
);

227 
$´İ”tyTy³
 = 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Cu¡omPrİ”tyTy³
(
$cu¡omPrİ”ty
);

229 
$objWr™”
->
	`¡¬tEËm’t
('property');

230 
$objWr™”
->
	`wr™eA‰ribu‹
('fmtid', '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}');

231 
$objWr™”
->
	`wr™eA‰ribu‹
('pid', 
$key
+2);

232 
$objWr™”
->
	`wr™eA‰ribu‹
('Çme', 
$cu¡omPrİ”ty
);

234 
$´İ”tyTy³
) {

236 
$objWr™”
->
	`wr™eEËm’t
('vt:i4', 
$´İ”tyV®ue
);

239 
$objWr™”
->
	`wr™eEËm’t
('vt:r8', 
$´İ”tyV®ue
);

242 
$objWr™”
->
	`wr™eEËm’t
('vt:boŞ', (
$´İ”tyV®ue
) ? 'true' : 'false');

245 
$objWr™”
->
	`¡¬tEËm’t
('vt:filetime');

246 
$objWr™”
->
	`wr™eRawD©a
(
	`d©e
(
DATE_W3C
, 
$´İ”tyV®ue
));

247 
$objWr™”
->
	`’dEËm’t
();

250 
$objWr™”
->
	`wr™eEËm’t
('vt:Íw¡r', 
$´İ”tyV®ue
);

254 
$objWr™”
->
	`’dEËm’t
();

258 
$objWr™”
->
	`’dEËm’t
();

260  
$objWr™”
->
	`g‘D©a
();

261 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Drawing.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_D¿wšg
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


39 
public
 
funùiÚ
 
	$wr™eD¿wšgs
(
PHPExûl_WÜksh“t
 
$pWÜksh“t
 = 
nuÎ
, &
$ch¬tRef
, 
$šşudeCh¬ts
 = 
çl£
)

42 
$objWr™”
 = 
nuÎ
;

43 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

44 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

46 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

50 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

53 
$objWr™”
->
	`¡¬tEËm’t
('xdr:wsDr');

54 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xdr', 'http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing');

55 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:a', 'http://schemas.openxmlformats.org/drawingml/2006/main');

58 
$i
 = 1;

59 
$™”©Ü
 = 
$pWÜksh“t
->
	`g‘D¿wšgCŞËùiÚ
()->
	`g‘I‹¿tÜ
();

60 
$™”©Ü
->
	`v®id
()) {

61 
$this
->
	`wr™eD¿wšg
(
$objWr™”
, 
$™”©Ü
->
	`cu¼’t
(), 
$i
);

63 
$™”©Ü
->
	`Ãxt
();

64 ++
$i
;

67 ià(
$šşudeCh¬ts
) {

68 
$ch¬tCouÁ
 = 
$pWÜksh“t
->
	`g‘Ch¬tCouÁ
();

70 ià(
$ch¬tCouÁ
 > 0) {

71 
$c
 = 0; $ø< 
$ch¬tCouÁ
; ++$c) {

72 
$this
->
	`wr™eCh¬t
(
$objWr™”
, 
$pWÜksh“t
->
	`g‘Ch¬tByIndex
(
$c
), $c+
$i
);

77 
$objWr™”
->
	`’dEËm’t
();

80  
$objWr™”
->
	`g‘D©a
();

91 
public
 
funùiÚ
 
	`wr™eCh¬t
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_Ch¬t
 
$pCh¬t
 =‚uÎ, 
$pR–©iÚId
 = -1)

93 
$
 = 
$pCh¬t
->
	`g‘TİLeáPos™iÚ
();

94 
$
['cŞRow'] = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
($tl['cell']);

95 
$br
 = 
$pCh¬t
->
	`g‘BÙtomRightPos™iÚ
();

96 
$br
['cŞRow'] = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
($br['cell']);

98 
$objWr™”
->
	`¡¬tEËm’t
('xdr:twoCellAnchor');

100 
$objWr™”
->
	`¡¬tEËm’t
('xdr:from');

101 
$objWr™”
->
	`wr™eEËm’t
('xdr:cŞ', 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$
['colRow'][0]) - 1);

102 
$objWr™”
->
	`wr™eEËm’t
('xdr:cŞOff', 
PHPExûl_Sh¬ed_D¿wšg
::
	`pix–sToEMU
(
$
['xOffset']));

103 
$objWr™”
->
	`wr™eEËm’t
('xdr:row', 
$
['colRow'][1] - 1);

104 
$objWr™”
->
	`wr™eEËm’t
('xdr:rowOff', 
PHPExûl_Sh¬ed_D¿wšg
::
	`pix–sToEMU
(
$
['yOffset']));

105 
$objWr™”
->
	`’dEËm’t
();

106 
$objWr™”
->
	`¡¬tEËm’t
('xdr:to');

107 
$objWr™”
->
	`wr™eEËm’t
('xdr:cŞ', 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$br
['colRow'][0]) - 1);

108 
$objWr™”
->
	`wr™eEËm’t
('xdr:cŞOff', 
PHPExûl_Sh¬ed_D¿wšg
::
	`pix–sToEMU
(
$br
['xOffset']));

109 
$objWr™”
->
	`wr™eEËm’t
('xdr:row', 
$br
['colRow'][1] - 1);

110 
$objWr™”
->
	`wr™eEËm’t
('xdr:rowOff', 
PHPExûl_Sh¬ed_D¿wšg
::
	`pix–sToEMU
(
$br
['yOffset']));

111 
$objWr™”
->
	`’dEËm’t
();

113 
$objWr™”
->
	`¡¬tEËm’t
('xdr:graphicFrame');

114 
$objWr™”
->
	`wr™eA‰ribu‹
('macro', '');

115 
$objWr™”
->
	`¡¬tEËm’t
('xdr:nvGraphicFramePr');

116 
$objWr™”
->
	`¡¬tEËm’t
('xdr:cNvPr');

117 
$objWr™”
->
	`wr™eA‰ribu‹
('Çme', 'Ch¬ˆ'.
$pR–©iÚId
);

118 
$objWr™”
->
	`wr™eA‰ribu‹
('id', 1025 * 
$pR–©iÚId
);

119 
$objWr™”
->
	`’dEËm’t
();

120 
$objWr™”
->
	`¡¬tEËm’t
('xdr:cNvGraphicFramePr');

121 
$objWr™”
->
	`¡¬tEËm’t
('a:graphicFrameLocks');

122 
$objWr™”
->
	`’dEËm’t
();

123 
$objWr™”
->
	`’dEËm’t
();

124 
$objWr™”
->
	`’dEËm’t
();

126 
$objWr™”
->
	`¡¬tEËm’t
('xdr:xfrm');

127 
$objWr™”
->
	`¡¬tEËm’t
('a:off');

128 
$objWr™”
->
	`wr™eA‰ribu‹
('x', '0');

129 
$objWr™”
->
	`wr™eA‰ribu‹
('y', '0');

130 
$objWr™”
->
	`’dEËm’t
();

131 
$objWr™”
->
	`¡¬tEËm’t
('a:ext');

132 
$objWr™”
->
	`wr™eA‰ribu‹
('cx', '0');

133 
$objWr™”
->
	`wr™eA‰ribu‹
('cy', '0');

134 
$objWr™”
->
	`’dEËm’t
();

135 
$objWr™”
->
	`’dEËm’t
();

137 
$objWr™”
->
	`¡¬tEËm’t
('a:graphic');

138 
$objWr™”
->
	`¡¬tEËm’t
('a:graphicData');

139 
$objWr™”
->
	`wr™eA‰ribu‹
('uri', 'http://schemas.openxmlformats.org/drawingml/2006/chart');

140 
$objWr™”
->
	`¡¬tEËm’t
('c:chart');

141 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:c', 'http://schemas.openxmlformats.org/drawingml/2006/chart');

142 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');

143 
$objWr™”
->
	`wr™eA‰ribu‹
('r:id', 'rId'.
$pR–©iÚId
);

144 
$objWr™”
->
	`’dEËm’t
();

145 
$objWr™”
->
	`’dEËm’t
();

146 
$objWr™”
->
	`’dEËm’t
();

147 
$objWr™”
->
	`’dEËm’t
();

149 
$objWr™”
->
	`¡¬tEËm’t
('xdr:clientData');

150 
$objWr™”
->
	`’dEËm’t
();

152 
$objWr™”
->
	`’dEËm’t
();

153 
	}
}

163 
public
 
funùiÚ
 
wr™eD¿wšg
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t_Ba£D¿wšg
 
$pD¿wšg
 =‚uÎ, 
$pR–©iÚId
 = -1)

165 ià(
$pR–©iÚId
 >= 0) {

167 
$objWr™”
->
¡¬tEËm’t
('xdr:oneCellAnchor');

169 
	g$aCoÜdš©es
 = 
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$pD¿wšg
->
g‘CoÜdš©es
());

170 
	g$aCoÜdš©es
[0] = 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
(
$aCoÜdš©es
[0]);

173 
	g$objWr™”
->
¡¬tEËm’t
('xdr:from');

174 
	g$objWr™”
->
wr™eEËm’t
('xdr:cŞ', 
$aCoÜdš©es
[0] - 1);

175 
	g$objWr™”
->
wr™eEËm’t
('xdr:cŞOff', 
PHPExûl_Sh¬ed_D¿wšg
::
pix–sToEMU
(
$pD¿wšg
->
g‘Off£tX
()));

176 
	g$objWr™”
->
wr™eEËm’t
('xdr:row', 
$aCoÜdš©es
[1] - 1);

177 
	g$objWr™”
->
wr™eEËm’t
('xdr:rowOff', 
PHPExûl_Sh¬ed_D¿wšg
::
pix–sToEMU
(
$pD¿wšg
->
g‘Off£tY
()));

178 
	g$objWr™”
->
’dEËm’t
();

181 
	g$objWr™”
->
¡¬tEËm’t
('xdr:ext');

182 
	g$objWr™”
->
wr™eA‰ribu‹
('cx', 
PHPExûl_Sh¬ed_D¿wšg
::
pix–sToEMU
(
$pD¿wšg
->
g‘Width
()));

183 
	g$objWr™”
->
wr™eA‰ribu‹
('cy', 
PHPExûl_Sh¬ed_D¿wšg
::
pix–sToEMU
(
$pD¿wšg
->
g‘Height
()));

184 
	g$objWr™”
->
’dEËm’t
();

187 
	g$objWr™”
->
¡¬tEËm’t
('xdr:pic');

190 
	g$objWr™”
->
¡¬tEËm’t
('xdr:nvPicPr');

193 
	g$objWr™”
->
¡¬tEËm’t
('xdr:cNvPr');

194 
	g$objWr™”
->
wr™eA‰ribu‹
('id', 
$pR–©iÚId
);

195 
	g$objWr™”
->
wr™eA‰ribu‹
('Çme', 
$pD¿wšg
->
g‘Name
());

196 
	g$objWr™”
->
wr™eA‰ribu‹
('desü', 
$pD¿wšg
->
g‘DesütiÚ
());

197 
	g$objWr™”
->
’dEËm’t
();

200 
	g$objWr™”
->
¡¬tEËm’t
('xdr:cNvPicPr');

203 
	g$objWr™”
->
¡¬tEËm’t
('a:picLocks');

204 
	g$objWr™”
->
wr™eA‰ribu‹
('noChangeAspect', '1');

205 
	g$objWr™”
->
’dEËm’t
();

207 
	g$objWr™”
->
’dEËm’t
();

209 
	g$objWr™”
->
’dEËm’t
();

212 
	g$objWr™”
->
¡¬tEËm’t
('xdr:blipFill');

215 
	g$objWr™”
->
¡¬tEËm’t
('a:blip');

216 
	g$objWr™”
->
wr™eA‰ribu‹
('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');

217 
	g$objWr™”
->
wr™eA‰ribu‹
('r:embed', 'rId' . 
$pR–©iÚId
);

218 
	g$objWr™”
->
’dEËm’t
();

221 
	g$objWr™”
->
¡¬tEËm’t
('a:stretch');

222 
	g$objWr™”
->
wr™eEËm’t
('a:flReù', 
nuÎ
);

223 
	g$objWr™”
->
’dEËm’t
();

225 
	g$objWr™”
->
’dEËm’t
();

228 
	g$objWr™”
->
¡¬tEËm’t
('xdr:spPr');

231 
	g$objWr™”
->
¡¬tEËm’t
('a:xfrm');

232 
	g$objWr™”
->
wr™eA‰ribu‹
('rÙ', 
PHPExûl_Sh¬ed_D¿wšg
::
deg»esToAngË
(
$pD¿wšg
->
g‘RÙ©iÚ
()));

233 
	g$objWr™”
->
’dEËm’t
();

236 
	g$objWr™”
->
¡¬tEËm’t
('a:prstGeom');

237 
	g$objWr™”
->
wr™eA‰ribu‹
('prst', 'rect');

240 
	g$objWr™”
->
wr™eEËm’t
('a:avL¡', 
nuÎ
);

242 
	g$objWr™”
->
’dEËm’t
();

285 ià(
	g$pD¿wšg
->
g‘Shadow
()->
g‘VisibË
()) {

287 
	g$objWr™”
->
¡¬tEËm’t
('a:effectLst');

290 
	g$objWr™”
->
¡¬tEËm’t
('a:outerShdw');

291 
	g$objWr™”
->
wr™eA‰ribu‹
('blurRad', 
PHPExûl_Sh¬ed_D¿wšg
::
pix–sToEMU
(
$pD¿wšg
->
g‘Shadow
()->
g‘BlurRadius
()));

292 
	g$objWr™”
->
wr™eA‰ribu‹
('di¡', 
PHPExûl_Sh¬ed_D¿wšg
::
pix–sToEMU
(
$pD¿wšg
->
g‘Shadow
()->
g‘Di¡ªû
()));

293 
	g$objWr™”
->
wr™eA‰ribu‹
('dœ', 
PHPExûl_Sh¬ed_D¿wšg
::
deg»esToAngË
(
$pD¿wšg
->
g‘Shadow
()->
g‘DœeùiÚ
()));

294 
	g$objWr™”
->
wr™eA‰ribu‹
('®gn', 
$pD¿wšg
->
g‘Shadow
()->
g‘Alignm’t
());

295 
	g$objWr™”
->
wr™eA‰ribu‹
('rotWithShape', '0');

298 
	g$objWr™”
->
¡¬tEËm’t
('a:srgbClr');

299 
	g$objWr™”
->
wr™eA‰ribu‹
('v®', 
$pD¿wšg
->
g‘Shadow
()->
g‘CŞÜ
()->
g‘RGB
());

302 
	g$objWr™”
->
¡¬tEËm’t
('a:alpha');

303 
	g$objWr™”
->
wr™eA‰ribu‹
('v®', 
$pD¿wšg
->
g‘Shadow
()->
g‘AÍha
() * 1000);

304 
	g$objWr™”
->
’dEËm’t
();

306 
	g$objWr™”
->
’dEËm’t
();

308 
	g$objWr™”
->
’dEËm’t
();

310 
	g$objWr™”
->
’dEËm’t
();

360 
	g$objWr™”
->
’dEËm’t
();

362 
	g$objWr™”
->
’dEËm’t
();

365 
	g$objWr™”
->
wr™eEËm’t
('xdr:ş›ÁD©a', 
nuÎ
);

367 
	g$objWr™”
->
’dEËm’t
();

369 
throw
 
Ãw
 
PHPExûl_Wr™”_Exû±iÚ
("Invalid…arameters…assed.");

380 
public
 
funùiÚ
 
	$wr™eVMLH—d”FoÙ”Images
(
PHPExûl_WÜksh“t
 
$pWÜksh“t
 = 
nuÎ
)

383 
$objWr™”
 = 
nuÎ
;

384 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

385 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

387 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

391 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

394 
$images
 = 
$pWÜksh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘Images
();

397 
$objWr™”
->
	`¡¬tEËm’t
('xml');

398 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:v', 'urn:schemas-microsoft-com:vml');

399 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:o', 'urn:schemas-microsoft-com:office:office');

400 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:x', 'urn:schemas-microsoft-com:office:excel');

403 
$objWr™”
->
	`¡¬tEËm’t
('o:shapelayout');

404 
$objWr™”
->
	`wr™eA‰ribu‹
('v:ext', 'edit');

407 
$objWr™”
->
	`¡¬tEËm’t
('o:idmap');

408 
$objWr™”
->
	`wr™eA‰ribu‹
('v:ext', 'edit');

409 
$objWr™”
->
	`wr™eA‰ribu‹
('data', '1');

410 
$objWr™”
->
	`’dEËm’t
();

412 
$objWr™”
->
	`’dEËm’t
();

415 
$objWr™”
->
	`¡¬tEËm’t
('v:shapetype');

416 
$objWr™”
->
	`wr™eA‰ribu‹
('id', '_x0000_t75');

417 
$objWr™”
->
	`wr™eA‰ribu‹
('coordsize', '21600,21600');

418 
$objWr™”
->
	`wr™eA‰ribu‹
('o:spt', '75');

419 
$objWr™”
->
	`wr™eA‰ribu‹
('o:preferrelative', 't');

420 
$objWr™”
->
	`wr™eA‰ribu‹
('path', 'm@4@5l@4@11@9@11@9@5xe');

421 
$objWr™”
->
	`wr™eA‰ribu‹
('filled', 'f');

422 
$objWr™”
->
	`wr™eA‰ribu‹
('stroked', 'f');

425 
$objWr™”
->
	`¡¬tEËm’t
('v:stroke');

426 
$objWr™”
->
	`wr™eA‰ribu‹
('joinstyle', 'miter');

427 
$objWr™”
->
	`’dEËm’t
();

430 
$objWr™”
->
	`¡¬tEËm’t
('v:formulas');

433 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

434 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'if†ineDrawn…ixelLineWidth 0');

435 
$objWr™”
->
	`’dEËm’t
();

438 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

439 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'sum @0 1 0');

440 
$objWr™”
->
	`’dEËm’t
();

443 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

444 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'sum 0 0 @1');

445 
$objWr™”
->
	`’dEËm’t
();

448 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

449 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'prod @2 1 2');

450 
$objWr™”
->
	`’dEËm’t
();

453 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

454 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'prod @3 21600…ixelWidth');

455 
$objWr™”
->
	`’dEËm’t
();

458 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

459 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'prod @3 21600…ixelHeight');

460 
$objWr™”
->
	`’dEËm’t
();

463 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

464 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'sum @0 0 1');

465 
$objWr™”
->
	`’dEËm’t
();

468 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

469 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'prod @6 1 2');

470 
$objWr™”
->
	`’dEËm’t
();

473 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

474 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'prod @7 21600…ixelWidth');

475 
$objWr™”
->
	`’dEËm’t
();

478 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

479 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'sum @8 21600 0');

480 
$objWr™”
->
	`’dEËm’t
();

483 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

484 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'prod @7 21600…ixelHeight');

485 
$objWr™”
->
	`’dEËm’t
();

488 
$objWr™”
->
	`¡¬tEËm’t
('v:f');

489 
$objWr™”
->
	`wr™eA‰ribu‹
('eqn', 'sum @10 21600 0');

490 
$objWr™”
->
	`’dEËm’t
();

492 
$objWr™”
->
	`’dEËm’t
();

495 
$objWr™”
->
	`¡¬tEËm’t
('v:path');

496 
$objWr™”
->
	`wr™eA‰ribu‹
('o:extrusionok', 'f');

497 
$objWr™”
->
	`wr™eA‰ribu‹
('gradientshapeok', 't');

498 
$objWr™”
->
	`wr™eA‰ribu‹
('o:connecttype', 'rect');

499 
$objWr™”
->
	`’dEËm’t
();

502 
$objWr™”
->
	`¡¬tEËm’t
('o:lock');

503 
$objWr™”
->
	`wr™eA‰ribu‹
('v:ext', 'edit');

504 
$objWr™”
->
	`wr™eA‰ribu‹
('aspectratio', 't');

505 
$objWr™”
->
	`’dEËm’t
();

507 
$objWr™”
->
	`’dEËm’t
();

510 
	`fÜ—ch
 (
$images
 
as
 
$key
 => 
$v®ue
) {

511 
$this
->
	`wr™eVMLH—d”FoÙ”Image
(
$objWr™”
, 
$key
, 
$v®ue
);

514 
$objWr™”
->
	`’dEËm’t
();

517  
$objWr™”
->
	`g‘D©a
();

518 
	}
}

528 
´iv©e
 
funùiÚ
 
wr™eVMLH—d”FoÙ”Image
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
$pReã»nû
 = '', 
PHPExûl_WÜksh“t_H—d”FoÙ”D¿wšg
 
$pImage
 =‚ull)

531 
´eg_m©ch
('{(\d+)}', 
md5
(
$pReã»nû
), 
$m
);

532 
	g$id
 = 1500 + (
sub¡r
(
$m
[1], 0, 2) * 1);

535 
	g$width
 = 
$pImage
->
g‘Width
();

536 
	g$height
 = 
$pImage
->
g‘Height
();

537 
	g$m¬gšLeá
 = 
$pImage
->
g‘Off£tX
();

538 
	g$m¬gšTİ
 = 
$pImage
->
g‘Off£tY
();

541 
	g$objWr™”
->
¡¬tEËm’t
('v:shape');

542 
	g$objWr™”
->
wr™eA‰ribu‹
('id', 
$pReã»nû
);

543 
	g$objWr™”
->
wr™eA‰ribu‹
('o:¥id', '_x0000_s' . 
$id
);

544 
	g$objWr™”
->
wr™eA‰ribu‹
('type', '#_x0000_t75');

545 
	g$objWr™”
->
wr™eA‰ribu‹
('style', "position:absolute;margin-left:{$marginLeft}px;margin-top:{$marginTop}px;width:{$width}px;height:{$height}px;z-index:1");

548 
	g$objWr™”
->
¡¬tEËm’t
('v:imagedata');

549 
	g$objWr™”
->
wr™eA‰ribu‹
('o:»lid', 'rId' . 
$pReã»nû
);

550 
	g$objWr™”
->
wr™eA‰ribu‹
('o:t™Ë', 
$pImage
->
g‘Name
());

551 
	g$objWr™”
->
’dEËm’t
();

554 
	g$objWr™”
->
¡¬tEËm’t
('o:lock');

555 
	g$objWr™”
->
wr™eA‰ribu‹
('v:ext', 'edit');

556 
	g$objWr™”
->
wr™eA‰ribu‹
('rotation', 't');

557 
	g$objWr™”
->
’dEËm’t
();

559 
	g$objWr™”
->
’dEËm’t
();

570 
public
 
funùiÚ
 
	$®lD¿wšgs
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

573 
$aD¿wšgs
 = 
	`¬¿y
();

576 
$sh“tCouÁ
 = 
$pPHPExûl
->
	`g‘Sh“tCouÁ
();

577 
$i
 = 0; $˜< 
$sh“tCouÁ
; ++$i) {

579 
$™”©Ü
 = 
$pPHPExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘D¿wšgCŞËùiÚ
()->
	`g‘I‹¿tÜ
();

580 
$™”©Ü
->
	`v®id
()) {

581 
$aD¿wšgs
[] = 
$™”©Ü
->
	`cu¼’t
();

583 
$™”©Ü
->
	`Ãxt
();

587  
$aD¿wšgs
;

588 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Rels.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_R–s
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™eR–©iÚshs
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

40 
$objWr™”
 = 
nuÎ
;

41 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

42 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

44 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

48 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

51 
$objWr™”
->
	`¡¬tEËm’t
('Relationships');

52 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');

54 
$cu¡omPrİ”tyLi¡
 = 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Cu¡omPrİ”t›s
();

55 ià(!
	`em±y
(
$cu¡omPrİ”tyLi¡
)) {

57 
$this
->
	`wr™eR–©iÚsh
(

58 
$objWr™”
,

67 
$this
->
	`wr™eR–©iÚsh
(

68 
$objWr™”
,

75 
$this
->
	`wr™eR–©iÚsh
(

76 
$objWr™”
,

83 
$this
->
	`wr™eR–©iÚsh
(

84 
$objWr™”
,

90 ià(
$pPHPExûl
->
	`hasRibbÚ
()) {

91 
$this
->
	`_wr™eR–©iÚSh
(

92 
$objWr™”
,

95 
$pPHPExûl
->
	`g‘RibbÚXMLD©a
('target')

99 
$objWr™”
->
	`’dEËm’t
();

101  
$objWr™”
->
	`g‘D©a
();

111 
public
 
funùiÚ
 
	$wr™eWÜkbookR–©iÚshs
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

114 
$objWr™”
 = 
nuÎ
;

115 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

116 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

118 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

122 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

125 
$objWr™”
->
	`¡¬tEËm’t
('Relationships');

126 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');

129 
$this
->
	`wr™eR–©iÚsh
(

130 
$objWr™”
,

137 
$this
->
	`wr™eR–©iÚsh
(

138 
$objWr™”
,

145 
$this
->
	`wr™eR–©iÚsh
(

146 
$objWr™”
,

153 
$sh“tCouÁ
 = 
$pPHPExûl
->
	`g‘Sh“tCouÁ
();

154 
$i
 = 0; $˜< 
$sh“tCouÁ
; ++$i) {

155 
$this
->
	`wr™eR–©iÚsh
(

156 
$objWr™”
,

157 (
$i
 + 1 + 3),

159 'wÜksh“ts/sh“t' . (
$i
 + 1) . '.xml'

164 ià(
$pPHPExûl
->
	`hasMaüos
()) {

165 
$this
->
	`_wr™eR–©iÚSh
(

166 
$objWr™”
,

167 (
$i
 + 1 + 3),

171 ++
$i
;

174 
$objWr™”
->
	`’dEËm’t
();

176  
$objWr™”
->
	`g‘D©a
();

177 
	}
}

192 
public
 
funùiÚ
 
	$wr™eWÜksh“tR–©iÚshs
(
PHPExûl_WÜksh“t
 
$pWÜksh“t
 = 
nuÎ
, 
$pWÜksh“tId
 = 1, 
$šşudeCh¬ts
 = 
çl£
)

195 
$objWr™”
 = 
nuÎ
;

196 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

197 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

199 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

203 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

206 
$objWr™”
->
	`¡¬tEËm’t
('Relationships');

207 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');

210 
$d
 = 0;

211 ià(
$šşudeCh¬ts
) {

212 
$ch¬ts
 = 
$pWÜksh“t
->
	`g‘Ch¬tCŞËùiÚ
();

214 
$ch¬ts
 = 
	`¬¿y
();

216 ià((
$pWÜksh“t
->
	`g‘D¿wšgCŞËùiÚ
()->
	`couÁ
() > 0) ||

217 (
	`couÁ
(
$ch¬ts
) > 0)) {

218 
$this
->
	`wr™eR–©iÚsh
(

219 
$objWr™”
,

220 ++
$d
,

222 '../d¿wšgs/d¿wšg' . 
$pWÜksh“tId
 . '.xml'

242 
$i
 = 1;

243 
	`fÜ—ch
 (
$pWÜksh“t
->
	`g‘Hy³¾škCŞËùiÚ
(è
as
 
$hy³¾šk
) {

244 ià(!
$hy³¾šk
->
	`isIÁ”Çl
()) {

245 
$this
->
	`wr™eR–©iÚsh
(

246 
$objWr™”
,

247 '_hy³¾šk_' . 
$i
,

249 
$hy³¾šk
->
	`g‘U¾
(),

253 ++
$i
;

258 
$i
 = 1;

259 ià(
	`couÁ
(
$pWÜksh“t
->
	`g‘Comm’ts
()) > 0) {

260 
$this
->
	`wr™eR–©iÚsh
(

261 
$objWr™”
,

262 '_comm’ts_vml' . 
$i
,

264 '../d¿wšgs/vmlD¿wšg' . 
$pWÜksh“tId
 . '.vml'

267 
$this
->
	`wr™eR–©iÚsh
(

268 
$objWr™”
,

269 '_comm’ts' . 
$i
,

271 '../comm’ts' . 
$pWÜksh“tId
 . '.xml'

276 
$i
 = 1;

277 ià(
	`couÁ
(
$pWÜksh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘Images
()) > 0) {

278 
$this
->
	`wr™eR–©iÚsh
(

279 
$objWr™”
,

280 '_h—d”foÙ”_vml' . 
$i
,

282 '../d¿wšgs/vmlD¿wšgHF' . 
$pWÜksh“tId
 . '.vml'

286 
$objWr™”
->
	`’dEËm’t
();

288  
$objWr™”
->
	`g‘D©a
();

289 
	}
}

300 
public
 
funùiÚ
 
	$wr™eD¿wšgR–©iÚshs
(
PHPExûl_WÜksh“t
 
$pWÜksh“t
 = 
nuÎ
, &
$ch¬tRef
, 
$šşudeCh¬ts
 = 
çl£
)

303 
$objWr™”
 = 
nuÎ
;

304 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

305 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

307 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

311 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

314 
$objWr™”
->
	`¡¬tEËm’t
('Relationships');

315 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');

318 
$i
 = 1;

319 
$™”©Ü
 = 
$pWÜksh“t
->
	`g‘D¿wšgCŞËùiÚ
()->
	`g‘I‹¿tÜ
();

320 
$™”©Ü
->
	`v®id
()) {

321 ià(
$™”©Ü
->
	`cu¼’t
(è
š¡ªûof
 
PHPExûl_WÜksh“t_D¿wšg


322 || 
$™”©Ü
->
	`cu¼’t
(è
š¡ªûof
 
PHPExûl_WÜksh“t_MemÜyD¿wšg
) {

324 
$this
->
	`wr™eR–©iÚsh
(

325 
$objWr™”
,

326 
$i
,

328 '../medŸ/' . 
	`¡r_»¶aû
(' ', '', 
$™”©Ü
->
	`cu¼’t
()->
	`g‘IndexedF’ame
())

332 
$™”©Ü
->
	`Ãxt
();

333 ++
$i
;

336 ià(
$šşudeCh¬ts
) {

338 
$ch¬tCouÁ
 = 
$pWÜksh“t
->
	`g‘Ch¬tCouÁ
();

339 ià(
$ch¬tCouÁ
 > 0) {

340 
$c
 = 0; $ø< 
$ch¬tCouÁ
; ++$c) {

341 
$this
->
	`wr™eR–©iÚsh
(

342 
$objWr™”
,

343 
$i
++,

345 '../ch¬ts/ch¬t' . ++
$ch¬tRef
 . '.xml'

351 
$objWr™”
->
	`’dEËm’t
();

353  
$objWr™”
->
	`g‘D©a
();

354 
	}
}

363 
public
 
funùiÚ
 
	$wr™eH—d”FoÙ”D¿wšgR–©iÚshs
(
PHPExûl_WÜksh“t
 
$pWÜksh“t
 = 
nuÎ
)

366 
$objWr™”
 = 
nuÎ
;

367 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

368 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

370 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

374 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

377 
$objWr™”
->
	`¡¬tEËm’t
('Relationships');

378 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');

381 
	`fÜ—ch
 (
$pWÜksh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘Images
(è
as
 
$key
 => 
$v®ue
) {

383 
$this
->
	`wr™eR–©iÚsh
(

384 
$objWr™”
,

385 
$key
,

387 '../medŸ/' . 
$v®ue
->
	`g‘IndexedF’ame
()

391 
$objWr™”
->
	`’dEËm’t
();

393  
$objWr™”
->
	`g‘D©a
();

394 
	}
}

406 
´iv©e
 
funùiÚ
 
wr™eR–©iÚsh
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
$pId
 = 1, 
$pTy³
 = '', 
$pT¬g‘
 = '', 
$pT¬g‘Mode
 = '')

408 ià(
$pTy³
 !ğ'' && 
$pT¬g‘
 != '') {

410 
$objWr™”
->
¡¬tEËm’t
('Relationship');

411 
	g$objWr™”
->
wr™eA‰ribu‹
('Id', 'rId' . 
$pId
);

412 
	g$objWr™”
->
wr™eA‰ribu‹
('Ty³', 
$pTy³
);

413 
	g$objWr™”
->
wr™eA‰ribu‹
('T¬g‘', 
$pT¬g‘
);

415 ià(
	g$pT¬g‘Mode
 != '') {

416 
$objWr™”
->
wr™eA‰ribu‹
('T¬g‘Mode', 
$pT¬g‘Mode
);

419 
	g$objWr™”
->
’dEËm’t
();

421 
throw
 
Ãw
 
PHPExûl_Wr™”_Exû±iÚ
("Invalid…arameters…assed.");

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/RelsRibbon.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_R–sRibbÚ
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™eRibbÚR–©iÚshs
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

40 
$objWr™”
 = 
nuÎ
;

41 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

42 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

44 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

48 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

51 
$objWr™”
->
	`¡¬tEËm’t
('Relationships');

52 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');

53 
$loÿlR–s
 = 
$pPHPExûl
->
	`g‘RibbÚBšObjeùs
('names');

54 ià(
	`is_¬¿y
(
$loÿlR–s
)) {

55 
	`fÜ—ch
 (
$loÿlR–s
 
as
 
$aId
 => 
$aT¬g‘
) {

56 
$objWr™”
->
	`¡¬tEËm’t
('Relationship');

57 
$objWr™”
->
	`wr™eA‰ribu‹
('Id', 
$aId
);

58 
$objWr™”
->
	`wr™eA‰ribu‹
('Type', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image');

59 
$objWr™”
->
	`wr™eA‰ribu‹
('T¬g‘', 
$aT¬g‘
);

60 
$objWr™”
->
	`’dEËm’t
();

63 
$objWr™”
->
	`’dEËm’t
();

65  
$objWr™”
->
	`g‘D©a
();

67 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/RelsVBA.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_R–sVBA
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™eVBAR–©iÚshs
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

40 
$objWr™”
 = 
nuÎ
;

41 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

42 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

44 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

48 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

51 
$objWr™”
->
	`¡¬tEËm’t
('Relationships');

52 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');

53 
$objWr™”
->
	`¡¬tEËm’t
('Relationship');

54 
$objWr™”
->
	`wr™eA‰ribu‹
('Id', 'rId1');

55 
$objWr™”
->
	`wr™eA‰ribu‹
('Type', 'http://schemas.microsoft.com/office/2006/relationships/vbaProjectSignature');

56 
$objWr™”
->
	`wr™eA‰ribu‹
('Target', 'vbaProjectSignature.bin');

57 
$objWr™”
->
	`’dEËm’t
();

58 
$objWr™”
->
	`’dEËm’t
();

60  
$objWr™”
->
	`g‘D©a
();

63 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/StringTable.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_SŒšgTabË
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


38 
public
 
funùiÚ
 
	$ü—‹SŒšgTabË
(
$pSh“t
 = 
nuÎ
, 
$pExi¡šgTabË
 =‚ull)

40 ià(
$pSh“t
 !=ğ
nuÎ
) {

42 
$aSŒšgTabË
 = 
	`¬¿y
();

43 
$ûÎCŞËùiÚ
 = 
nuÎ
;

44 
$aFl³dSŒšgTabË
 = 
nuÎ
;

47 ià((
$pExi¡šgTabË
 !=ğ
nuÎ
è&& 
	`is_¬¿y
($pExistingTable)) {

48 
$aSŒšgTabË
 = 
$pExi¡šgTabË
;

52 
$aFl³dSŒšgTabË
 = 
$this
->
	`æSŒšgTabË
(
$aSŒšgTabË
);

55 
	`fÜ—ch
 (
$pSh“t
->
	`g‘C–lCŞËùiÚ
(è
as
 
$ûÎID
) {

56 
$ûÎ
 = 
$pSh“t
->
	`g‘C–l
(
$ûÎID
);

57 
$ûÎV®ue
 = 
$ûÎ
->
	`g‘V®ue
();

58 ià(!
	`is_objeù
(
$ûÎV®ue
) &&

59 (
$ûÎV®ue
 !=ğ
nuÎ
) &&

60 
$ûÎV®ue
 !== '' &&

61 !
	`is£t
(
$aFl³dSŒšgTabË
[
$ûÎV®ue
]) &&

62 (
$ûÎ
->
	`g‘D©aTy³
(è=ğ
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
 || $ûÎ->g‘D©aTy³(è=ğPHPExûl_C–l_D©aTy³::
TYPE_STRING2
 || $ûÎ->g‘D©aTy³(è=ğPHPExûl_C–l_D©aTy³::
TYPE_NULL
)) {

63 
$aSŒšgTabË
[] = 
$ûÎV®ue
;

64 
$aFl³dSŒšgTabË
[
$ûÎV®ue
] = 
Œue
;

65 } 
	`–£if
 (
$ûÎV®ue
 
š¡ªûof
 
PHPExûl_RichText
 &&

66 (
$ûÎV®ue
 !=ğ
nuÎ
) &&

67 !
	`is£t
(
$aFl³dSŒšgTabË
[
$ûÎV®ue
->
	`g‘HashCode
()])) {

68 
$aSŒšgTabË
[] = 
$ûÎV®ue
;

69 
$aFl³dSŒšgTabË
[
$ûÎV®ue
->
	`g‘HashCode
()] = 
Œue
;

73  
$aSŒšgTabË
;

75 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Invalid PHPExcel_Worksheet object…assed.");

86 
public
 
funùiÚ
 
	$wr™eSŒšgTabË
(
$pSŒšgTabË
 = 
nuÎ
)

88 ià(
$pSŒšgTabË
 !=ğ
nuÎ
) {

90 
$objWr™”
 = 
nuÎ
;

91 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

92 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

94 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

98 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

101 
$objWr™”
->
	`¡¬tEËm’t
('sst');

102 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');

103 
$objWr™”
->
	`wr™eA‰ribu‹
('uniqueCouÁ', 
	`couÁ
(
$pSŒšgTabË
));

106 
	`fÜ—ch
 (
$pSŒšgTabË
 
as
 
$‹xtEËm’t
) {

107 
$objWr™”
->
	`¡¬tEËm’t
('si');

109 ià(! 
$‹xtEËm’t
 
š¡ªûof
 
PHPExûl_RichText
) {

110 
$‹xtToWr™e
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`CÚŒŞCh¬aù”PHP2OOXML
(
$‹xtEËm’t
);

111 
$objWr™”
->
	`¡¬tEËm’t
('t');

112 ià(
$‹xtToWr™e
 !=ğ
	`Œim
($textToWrite)) {

113 
$objWr™”
->
	`wr™eA‰ribu‹
('xml:space', 'preserve');

115 
$objWr™”
->
	`wr™eRawD©a
(
$‹xtToWr™e
);

116 
$objWr™”
->
	`’dEËm’t
();

117 } 
	`–£if
 (
$‹xtEËm’t
 
š¡ªûof
 
PHPExûl_RichText
) {

118 
$this
->
	`wr™eRichText
(
$objWr™”
, 
$‹xtEËm’t
);

121 
$objWr™”
->
	`’dEËm’t
();

124 
$objWr™”
->
	`’dEËm’t
();

126  
$objWr™”
->
	`g‘D©a
();

128 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Invalid stringable‡rray…assed.");

130 
	}
}

140 
public
 
funùiÚ
 
	$wr™eRichText
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_RichText
 
$pRichText
 =‚uÎ, 
$´efix
 =‚ull)

142 ià(
$´efix
 !=ğ
nuÎ
) {

143 
$´efix
 .= ':';

147 
$–em’ts
 = 
$pRichText
->
	`g‘RichTextEËm’ts
();

148 
	`fÜ—ch
 (
$–em’ts
 
as
 
$–em’t
) {

150 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'r');

153 ià(
$–em’t
 
š¡ªûof
 
PHPExûl_RichText_Run
) {

155 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'rPr');

158 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'rFont');

159 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$–em’t
->
	`g‘FÚt
()->
	`g‘Name
());

160 
$objWr™”
->
	`’dEËm’t
();

163 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'b');

164 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', (
$–em’t
->
	`g‘FÚt
()->
	`g‘BŞd
() ? 'true' : 'false'));

165 
$objWr™”
->
	`’dEËm’t
();

168 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'i');

169 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', (
$–em’t
->
	`g‘FÚt
()->
	`g‘Ilic
() ? 'true' : 'false'));

170 
$objWr™”
->
	`’dEËm’t
();

173 ià(
$–em’t
->
	`g‘FÚt
()->
	`g‘Su³rSüt
(è|| $–em’t->g‘FÚt()->
	`g‘SubSüt
()) {

174 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'vertAlign');

175 ià(
$–em’t
->
	`g‘FÚt
()->
	`g‘Su³rSüt
()) {

176 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'superscript');

177 } 
	`–£if
 (
$–em’t
->
	`g‘FÚt
()->
	`g‘SubSüt
()) {

178 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'subscript');

180 
$objWr™”
->
	`’dEËm’t
();

184 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'strike');

185 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', (
$–em’t
->
	`g‘FÚt
()->
	`g‘SŒik‘hrough
() ? 'true' : 'false'));

186 
$objWr™”
->
	`’dEËm’t
();

189 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'color');

190 
$objWr™”
->
	`wr™eA‰ribu‹
('rgb', 
$–em’t
->
	`g‘FÚt
()->
	`g‘CŞÜ
()->
	`g‘ARGB
());

191 
$objWr™”
->
	`’dEËm’t
();

194 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'sz');

195 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$–em’t
->
	`g‘FÚt
()->
	`g‘Size
());

196 
$objWr™”
->
	`’dEËm’t
();

199 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'u');

200 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$–em’t
->
	`g‘FÚt
()->
	`g‘Und”lše
());

201 
$objWr™”
->
	`’dEËm’t
();

203 
$objWr™”
->
	`’dEËm’t
();

207 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'t');

208 
$objWr™”
->
	`wr™eA‰ribu‹
('xml:space', 'preserve');

209 
$objWr™”
->
	`wr™eRawD©a
(
PHPExûl_Sh¬ed_SŒšg
::
	`CÚŒŞCh¬aù”PHP2OOXML
(
$–em’t
->
	`g‘Text
()));

210 
$objWr™”
->
	`’dEËm’t
();

212 
$objWr™”
->
	`’dEËm’t
();

214 
	}
}

224 
public
 
funùiÚ
 
	$wr™eRichTextFÜCh¬ts
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
$pRichText
 =‚uÎ, 
$´efix
 =‚ull)

226 ià(!
$pRichText
 
š¡ªûof
 
PHPExûl_RichText
) {

227 
$‹xtRun
 = 
$pRichText
;

228 
$pRichText
 = 
Ãw
 
	`PHPExûl_RichText
();

229 
$pRichText
->
	`ü—‹TextRun
(
$‹xtRun
);

232 ià(
$´efix
 !=ğ
nuÎ
) {

233 
$´efix
 .= ':';

237 
$–em’ts
 = 
$pRichText
->
	`g‘RichTextEËm’ts
();

238 
	`fÜ—ch
 (
$–em’ts
 
as
 
$–em’t
) {

240 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'r');

243 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'rPr');

246 
$objWr™”
->
	`wr™eA‰ribu‹
('b', (
$–em’t
->
	`g‘FÚt
()->
	`g‘BŞd
() ? 1 : 0));

248 
$objWr™”
->
	`wr™eA‰ribu‹
('i', (
$–em’t
->
	`g‘FÚt
()->
	`g‘Ilic
() ? 1 : 0));

250 
$und”lšeTy³
 = 
$–em’t
->
	`g‘FÚt
()->
	`g‘Und”lše
();

251 
$und”lšeTy³
) {

253 
$und”lšeTy³
 = 'sng';

256 
$und”lšeTy³
 = 'dbl';

259 
$objWr™”
->
	`wr™eA‰ribu‹
('u', 
$und”lšeTy³
);

261 
$objWr™”
->
	`wr™eA‰ribu‹
('¡rike', (
$–em’t
->
	`g‘FÚt
()->
	`g‘SŒik‘hrough
() ? 'sngStrike' : 'noStrike'));

264 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'latin');

265 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³çû', 
$–em’t
->
	`g‘FÚt
()->
	`g‘Name
());

266 
$objWr™”
->
	`’dEËm’t
();

279 
$objWr™”
->
	`’dEËm’t
();

282 
$objWr™”
->
	`¡¬tEËm’t
(
$´efix
.'t');

284 
$objWr™”
->
	`wr™eRawD©a
(
PHPExûl_Sh¬ed_SŒšg
::
	`CÚŒŞCh¬aù”PHP2OOXML
(
$–em’t
->
	`g‘Text
()));

285 
$objWr™”
->
	`’dEËm’t
();

287 
$objWr™”
->
	`’dEËm’t
();

289 
	}
}

297 
public
 
funùiÚ
 
æSŒšgTabË
(
$¡ršgTabË
 = 
	$¬¿y
())

300 
$»tuºV®ue
 = 
	`¬¿y
();

303 
	`fÜ—ch
 (
$¡ršgTabË
 
as
 
$key
 => 
$v®ue
) {

304 ià(! 
$v®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

305 
$»tuºV®ue
[
$v®ue
] = 
$key
;

306 } 
	`–£if
 (
$v®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

307 
$»tuºV®ue
[
$v®ue
->
	`g‘HashCode
()] = 
$key
;

311  
$»tuºV®ue
;

312 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Style.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_StyË
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™eStyËs
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

40 
$objWr™”
 = 
nuÎ
;

41 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

42 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

44 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

48 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

51 
$objWr™”
->
	`¡¬tEËm’t
('styleSheet');

52 
$objWr™”
->
	`wr™eA‰ribu‹
('xml:space', 'preserve');

53 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');

56 
$objWr™”
->
	`¡¬tEËm’t
('numFmts');

57 
$objWr™”
->
	`wr™eA‰ribu‹
('couÁ', 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘NumFmtHashTabË
()->
	`couÁ
());

60 
$i
 = 0; $˜< 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘NumFmtHashTabË
()->
	`couÁ
(); ++$i) {

61 
$this
->
	`wr™eNumFmt
(
$objWr™”
, $this->
	`g‘P¬’tWr™”
()->
	`g‘NumFmtHashTabË
()->
	`g‘ByIndex
(
$i
), $i);

64 
$objWr™”
->
	`’dEËm’t
();

67 
$objWr™”
->
	`¡¬tEËm’t
('fonts');

68 
$objWr™”
->
	`wr™eA‰ribu‹
('couÁ', 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘FÚtHashTabË
()->
	`couÁ
());

71 
$i
 = 0; $˜< 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘FÚtHashTabË
()->
	`couÁ
(); ++$i) {

72 
$this
->
	`wr™eFÚt
(
$objWr™”
, $this->
	`g‘P¬’tWr™”
()->
	`g‘FÚtHashTabË
()->
	`g‘ByIndex
(
$i
));

75 
$objWr™”
->
	`’dEËm’t
();

78 
$objWr™”
->
	`¡¬tEËm’t
('fills');

79 
$objWr™”
->
	`wr™eA‰ribu‹
('couÁ', 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘FlHashTabË
()->
	`couÁ
());

82 
$i
 = 0; $˜< 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘FlHashTabË
()->
	`couÁ
(); ++$i) {

83 
$this
->
	`wr™eFl
(
$objWr™”
, $this->
	`g‘P¬’tWr™”
()->
	`g‘FlHashTabË
()->
	`g‘ByIndex
(
$i
));

86 
$objWr™”
->
	`’dEËm’t
();

89 
$objWr™”
->
	`¡¬tEËm’t
('borders');

90 
$objWr™”
->
	`wr™eA‰ribu‹
('couÁ', 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘BÜd”sHashTabË
()->
	`couÁ
());

93 
$i
 = 0; $˜< 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘BÜd”sHashTabË
()->
	`couÁ
(); ++$i) {

94 
$this
->
	`wr™eBÜd”
(
$objWr™”
, $this->
	`g‘P¬’tWr™”
()->
	`g‘BÜd”sHashTabË
()->
	`g‘ByIndex
(
$i
));

97 
$objWr™”
->
	`’dEËm’t
();

100 
$objWr™”
->
	`¡¬tEËm’t
('cellStyleXfs');

101 
$objWr™”
->
	`wr™eA‰ribu‹
('count', 1);

104 
$objWr™”
->
	`¡¬tEËm’t
('xf');

105 
$objWr™”
->
	`wr™eA‰ribu‹
('numFmtId', 0);

106 
$objWr™”
->
	`wr™eA‰ribu‹
('fontId', 0);

107 
$objWr™”
->
	`wr™eA‰ribu‹
('fillId', 0);

108 
$objWr™”
->
	`wr™eA‰ribu‹
('borderId', 0);

109 
$objWr™”
->
	`’dEËm’t
();

111 
$objWr™”
->
	`’dEËm’t
();

114 
$objWr™”
->
	`¡¬tEËm’t
('cellXfs');

115 
$objWr™”
->
	`wr™eA‰ribu‹
('couÁ', 
	`couÁ
(
$pPHPExûl
->
	`g‘C–lXfCŞËùiÚ
()));

118 
	`fÜ—ch
 (
$pPHPExûl
->
	`g‘C–lXfCŞËùiÚ
(è
as
 
$ûÎXf
) {

119 
$this
->
	`wr™eC–lStyËXf
(
$objWr™”
, 
$ûÎXf
, 
$pPHPExûl
);

122 
$objWr™”
->
	`’dEËm’t
();

125 
$objWr™”
->
	`¡¬tEËm’t
('cellStyles');

126 
$objWr™”
->
	`wr™eA‰ribu‹
('count', 1);

129 
$objWr™”
->
	`¡¬tEËm’t
('cellStyle');

130 
$objWr™”
->
	`wr™eA‰ribu‹
('name', 'Normal');

131 
$objWr™”
->
	`wr™eA‰ribu‹
('xfId', 0);

132 
$objWr™”
->
	`wr™eA‰ribu‹
('builtinId', 0);

133 
$objWr™”
->
	`’dEËm’t
();

135 
$objWr™”
->
	`’dEËm’t
();

138 
$objWr™”
->
	`¡¬tEËm’t
('dxfs');

139 
$objWr™”
->
	`wr™eA‰ribu‹
('couÁ', 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘StyËsCÚd™iÚ®HashTabË
()->
	`couÁ
());

142 
$i
 = 0; $˜< 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘StyËsCÚd™iÚ®HashTabË
()->
	`couÁ
(); ++$i) {

143 
$this
->
	`wr™eC–lStyËDxf
(
$objWr™”
, $this->
	`g‘P¬’tWr™”
()->
	`g‘StyËsCÚd™iÚ®HashTabË
()->
	`g‘ByIndex
(
$i
)->
	`g‘StyË
());

146 
$objWr™”
->
	`’dEËm’t
();

149 
$objWr™”
->
	`¡¬tEËm’t
('tableStyles');

150 
$objWr™”
->
	`wr™eA‰ribu‹
('defaultTableStyle', 'TableStyleMedium9');

151 
$objWr™”
->
	`wr™eA‰ribu‹
('defaultPivotStyle', 'PivotTableStyle1');

152 
$objWr™”
->
	`’dEËm’t
();

154 
$objWr™”
->
	`’dEËm’t
();

157  
$objWr™”
->
	`g‘D©a
();

167 
´iv©e
 
funùiÚ
 
	$wr™eFl
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_StyË_Fl
 
$pFl
 =‚ull)

170 ià(
$pFl
->
	`g‘FlTy³
(è==ğ
PHPExûl_StyË_Fl
::
FILL_GRADIENT_LINEAR
 ||

171 
$pFl
->
	`g‘FlTy³
(è==ğ
PHPExûl_StyË_Fl
::
FILL_GRADIENT_PATH
) {

173 
$this
->
	`wr™eG¿d›ÁFl
(
$objWr™”
, 
$pFl
);

174 } 
	`–£if
 (
$pFl
->
	`g‘FlTy³
(è!=ğ
nuÎ
) {

176 
$this
->
	`wr™eP©‹ºFl
(
$objWr™”
, 
$pFl
);

178 
	}
}

187 
´iv©e
 
funùiÚ
 
	$wr™eG¿d›ÁFl
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_StyË_Fl
 
$pFl
 =‚ull)

190 
$objWr™”
->
	`¡¬tEËm’t
('fill');

193 
$objWr™”
->
	`¡¬tEËm’t
('gradientFill');

194 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³', 
$pFl
->
	`g‘FlTy³
());

195 
$objWr™”
->
	`wr™eA‰ribu‹
('deg»e', 
$pFl
->
	`g‘RÙ©iÚ
());

198 
$objWr™”
->
	`¡¬tEËm’t
('stop');

199 
$objWr™”
->
	`wr™eA‰ribu‹
('position', '0');

202 
$objWr™”
->
	`¡¬tEËm’t
('color');

203 
$objWr™”
->
	`wr™eA‰ribu‹
('rgb', 
$pFl
->
	`g‘S¹CŞÜ
()->
	`g‘ARGB
());

204 
$objWr™”
->
	`’dEËm’t
();

206 
$objWr™”
->
	`’dEËm’t
();

209 
$objWr™”
->
	`¡¬tEËm’t
('stop');

210 
$objWr™”
->
	`wr™eA‰ribu‹
('position', '1');

213 
$objWr™”
->
	`¡¬tEËm’t
('color');

214 
$objWr™”
->
	`wr™eA‰ribu‹
('rgb', 
$pFl
->
	`g‘EndCŞÜ
()->
	`g‘ARGB
());

215 
$objWr™”
->
	`’dEËm’t
();

217 
$objWr™”
->
	`’dEËm’t
();

219 
$objWr™”
->
	`’dEËm’t
();

221 
$objWr™”
->
	`’dEËm’t
();

222 
	}
}

231 
´iv©e
 
funùiÚ
 
	$wr™eP©‹ºFl
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_StyË_Fl
 
$pFl
 =‚ull)

234 
$objWr™”
->
	`¡¬tEËm’t
('fill');

237 
$objWr™”
->
	`¡¬tEËm’t
('patternFill');

238 
$objWr™”
->
	`wr™eA‰ribu‹
('·‰”nTy³', 
$pFl
->
	`g‘FlTy³
());

240 ià(
$pFl
->
	`g‘FlTy³
(è!=ğ
PHPExûl_StyË_Fl
::
FILL_NONE
) {

242 ià(
$pFl
->
	`g‘S¹CŞÜ
()->
	`g‘ARGB
()) {

243 
$objWr™”
->
	`¡¬tEËm’t
('fgColor');

244 
$objWr™”
->
	`wr™eA‰ribu‹
('rgb', 
$pFl
->
	`g‘S¹CŞÜ
()->
	`g‘ARGB
());

245 
$objWr™”
->
	`’dEËm’t
();

248 ià(
$pFl
->
	`g‘FlTy³
(è!=ğ
PHPExûl_StyË_Fl
::
FILL_NONE
) {

250 ià(
$pFl
->
	`g‘EndCŞÜ
()->
	`g‘ARGB
()) {

251 
$objWr™”
->
	`¡¬tEËm’t
('bgColor');

252 
$objWr™”
->
	`wr™eA‰ribu‹
('rgb', 
$pFl
->
	`g‘EndCŞÜ
()->
	`g‘ARGB
());

253 
$objWr™”
->
	`’dEËm’t
();

257 
$objWr™”
->
	`’dEËm’t
();

259 
$objWr™”
->
	`’dEËm’t
();

260 
	}
}

269 
´iv©e
 
funùiÚ
 
	$wr™eFÚt
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_StyË_FÚt
 
$pFÚt
 =‚ull)

272 
$objWr™”
->
	`¡¬tEËm’t
('font');

280 ià(
$pFÚt
->
	`g‘BŞd
(è!=ğ
nuÎ
) {

281 
$objWr™”
->
	`¡¬tEËm’t
('b');

282 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$pFÚt
->
	`g‘BŞd
() ? '1' : '0');

283 
$objWr™”
->
	`’dEËm’t
();

287 ià(
$pFÚt
->
	`g‘Ilic
(è!=ğ
nuÎ
) {

288 
$objWr™”
->
	`¡¬tEËm’t
('i');

289 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$pFÚt
->
	`g‘Ilic
() ? '1' : '0');

290 
$objWr™”
->
	`’dEËm’t
();

294 ià(
$pFÚt
->
	`g‘SŒik‘hrough
(è!=ğ
nuÎ
) {

295 
$objWr™”
->
	`¡¬tEËm’t
('strike');

296 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$pFÚt
->
	`g‘SŒik‘hrough
() ? '1' : '0');

297 
$objWr™”
->
	`’dEËm’t
();

301 ià(
$pFÚt
->
	`g‘Und”lše
(è!=ğ
nuÎ
) {

302 
$objWr™”
->
	`¡¬tEËm’t
('u');

303 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$pFÚt
->
	`g‘Und”lše
());

304 
$objWr™”
->
	`’dEËm’t
();

308 ià(
$pFÚt
->
	`g‘Su³rSüt
(è==ğ
Œue
 || $pFÚt->
	`g‘SubSüt
() ===rue) {

309 
$objWr™”
->
	`¡¬tEËm’t
('vertAlign');

310 ià(
$pFÚt
->
	`g‘Su³rSüt
(è==ğ
Œue
) {

311 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'superscript');

312 } 
	`–£if
 (
$pFÚt
->
	`g‘SubSüt
(è==ğ
Œue
) {

313 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'subscript');

315 
$objWr™”
->
	`’dEËm’t
();

319 ià(
$pFÚt
->
	`g‘Size
(è!=ğ
nuÎ
) {

320 
$objWr™”
->
	`¡¬tEËm’t
('sz');

321 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$pFÚt
->
	`g‘Size
());

322 
$objWr™”
->
	`’dEËm’t
();

326 ià(
$pFÚt
->
	`g‘CŞÜ
()->
	`g‘ARGB
(è!=ğ
nuÎ
) {

327 
$objWr™”
->
	`¡¬tEËm’t
('color');

328 
$objWr™”
->
	`wr™eA‰ribu‹
('rgb', 
$pFÚt
->
	`g‘CŞÜ
()->
	`g‘ARGB
());

329 
$objWr™”
->
	`’dEËm’t
();

333 ià(
$pFÚt
->
	`g‘Name
(è!=ğ
nuÎ
) {

334 
$objWr™”
->
	`¡¬tEËm’t
('name');

335 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$pFÚt
->
	`g‘Name
());

336 
$objWr™”
->
	`’dEËm’t
();

339 
$objWr™”
->
	`’dEËm’t
();

340 
	}
}

349 
´iv©e
 
funùiÚ
 
	$wr™eBÜd”
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_StyË_BÜd”s
 
$pBÜd”s
 =‚ull)

352 
$objWr™”
->
	`¡¬tEËm’t
('border');

354 
$pBÜd”s
->
	`g‘DŸgÚ®DœeùiÚ
()) {

355 
PHPExûl_StyË_BÜd”s
::
DIAGONAL_UP
:

356 
$objWr™”
->
	`wr™eA‰ribu‹
('diagonalUp', 'true');

357 
$objWr™”
->
	`wr™eA‰ribu‹
('diagonalDown', 'false');

359 
PHPExûl_StyË_BÜd”s
::
DIAGONAL_DOWN
:

360 
$objWr™”
->
	`wr™eA‰ribu‹
('diagonalUp', 'false');

361 
$objWr™”
->
	`wr™eA‰ribu‹
('diagonalDown', 'true');

363 
PHPExûl_StyË_BÜd”s
::
DIAGONAL_BOTH
:

364 
$objWr™”
->
	`wr™eA‰ribu‹
('diagonalUp', 'true');

365 
$objWr™”
->
	`wr™eA‰ribu‹
('diagonalDown', 'true');

370 
$this
->
	`wr™eBÜd”Pr
(
$objWr™”
, 'Ëá', 
$pBÜd”s
->
	`g‘Leá
());

371 
$this
->
	`wr™eBÜd”Pr
(
$objWr™”
, 'right', 
$pBÜd”s
->
	`g‘Right
());

372 
$this
->
	`wr™eBÜd”Pr
(
$objWr™”
, 'tİ', 
$pBÜd”s
->
	`g‘Tİ
());

373 
$this
->
	`wr™eBÜd”Pr
(
$objWr™”
, 'bÙtom', 
$pBÜd”s
->
	`g‘BÙtom
());

374 
$this
->
	`wr™eBÜd”Pr
(
$objWr™”
, 'dŸgÚ®', 
$pBÜd”s
->
	`g‘DŸgÚ®
());

375 
$objWr™”
->
	`’dEËm’t
();

376 
	}
}

386 
´iv©e
 
funùiÚ
 
	$wr™eC–lStyËXf
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_StyË
 
$pStyË
 =‚uÎ, 
PHPExûl
 
$pPHPExûl
 =‚ull)

389 
$objWr™”
->
	`¡¬tEËm’t
('xf');

390 
$objWr™”
->
	`wr™eA‰ribu‹
('xfId', 0);

391 
$objWr™”
->
	`wr™eA‰ribu‹
('fÚtId', ()
$this
->
	`g‘P¬’tWr™”
()->
	`g‘FÚtHashTabË
()->
	`g‘IndexFÜHashCode
(
$pStyË
->
	`g‘FÚt
()->
	`g‘HashCode
()));

392 ià(
$pStyË
->
	`g‘QuÙeP»fix
()) {

393 
$objWr™”
->
	`wr™eA‰ribu‹
('quotePrefix', 1);

396 ià(
$pStyË
->
	`g‘Numb”FÜm©
()->
	`g‘ButInFÜm©Code
(è==ğ
çl£
) {

397 
$objWr™”
->
	`wr™eA‰ribu‹
('numFmtId', ()(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘NumFmtHashTabË
()->
	`g‘IndexFÜHashCode
(
$pStyË
->
	`g‘Numb”FÜm©
()->
	`g‘HashCode
()) + 164));

399 
$objWr™”
->
	`wr™eA‰ribu‹
('numFmtId', ()
$pStyË
->
	`g‘Numb”FÜm©
()->
	`g‘ButInFÜm©Code
());

402 
$objWr™”
->
	`wr™eA‰ribu‹
('flId', ()
$this
->
	`g‘P¬’tWr™”
()->
	`g‘FlHashTabË
()->
	`g‘IndexFÜHashCode
(
$pStyË
->
	`g‘Fl
()->
	`g‘HashCode
()));

403 
$objWr™”
->
	`wr™eA‰ribu‹
('bÜd”Id', ()
$this
->
	`g‘P¬’tWr™”
()->
	`g‘BÜd”sHashTabË
()->
	`g‘IndexFÜHashCode
(
$pStyË
->
	`g‘BÜd”s
()->
	`g‘HashCode
()));

406 
$objWr™”
->
	`wr™eA‰ribu‹
('­¶yFÚt', (
$pPHPExûl
->
	`g‘DeçuÉStyË
()->
	`g‘FÚt
()->
	`g‘HashCode
(è!ğ
$pStyË
->getFont()->getHashCode()) ? '1' : '0');

407 
$objWr™”
->
	`wr™eA‰ribu‹
('­¶yNumb”FÜm©', (
$pPHPExûl
->
	`g‘DeçuÉStyË
()->
	`g‘Numb”FÜm©
()->
	`g‘HashCode
(è!ğ
$pStyË
->getNumberFormat()->getHashCode()) ? '1' : '0');

408 
$objWr™”
->
	`wr™eA‰ribu‹
('­¶yFl', (
$pPHPExûl
->
	`g‘DeçuÉStyË
()->
	`g‘Fl
()->
	`g‘HashCode
(è!ğ
$pStyË
->getFill()->getHashCode()) ? '1' : '0');

409 
$objWr™”
->
	`wr™eA‰ribu‹
('­¶yBÜd”', (
$pPHPExûl
->
	`g‘DeçuÉStyË
()->
	`g‘BÜd”s
()->
	`g‘HashCode
(è!ğ
$pStyË
->getBorders()->getHashCode()) ? '1' : '0');

410 
$objWr™”
->
	`wr™eA‰ribu‹
('­¶yAlignm’t', (
$pPHPExûl
->
	`g‘DeçuÉStyË
()->
	`g‘Alignm’t
()->
	`g‘HashCode
(è!ğ
$pStyË
->getAlignment()->getHashCode()) ? '1' : '0');

411 ià(
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è!ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
 || $pStyË->g‘PrÙeùiÚ()->
	`g‘Hidd’
() != PHPExcel_Style_Protection::PROTECTION_INHERIT) {

412 
$objWr™”
->
	`wr™eA‰ribu‹
('applyProtection', 'true');

416 
$objWr™”
->
	`¡¬tEËm’t
('alignment');

417 
$objWr™”
->
	`wr™eA‰ribu‹
('hÜizÚl', 
$pStyË
->
	`g‘Alignm’t
()->
	`g‘HÜizÚl
());

418 
$objWr™”
->
	`wr™eA‰ribu‹
('v”tiÿl', 
$pStyË
->
	`g‘Alignm’t
()->
	`g‘V”tiÿl
());

420 
$‹xtRÙ©iÚ
 = 0;

421 ià(
$pStyË
->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
() >= 0) {

422 
$‹xtRÙ©iÚ
 = 
$pStyË
->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
();

423 } 
	`–£if
 (
$pStyË
->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
() < 0) {

424 
$‹xtRÙ©iÚ
 = 90 - 
$pStyË
->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
();

426 
$objWr™”
->
	`wr™eA‰ribu‹
('‹xtRÙ©iÚ', 
$‹xtRÙ©iÚ
);

428 
$objWr™”
->
	`wr™eA‰ribu‹
('w¿pText', (
$pStyË
->
	`g‘Alignm’t
()->
	`g‘W¿pText
() ? 'true' : 'false'));

429 
$objWr™”
->
	`wr™eA‰ribu‹
('shrškToF™', (
$pStyË
->
	`g‘Alignm’t
()->
	`g‘ShrškToF™
() ? 'true' : 'false'));

431 ià(
$pStyË
->
	`g‘Alignm’t
()->
	`g‘Ind’t
() > 0) {

432 
$objWr™”
->
	`wr™eA‰ribu‹
('šd’t', 
$pStyË
->
	`g‘Alignm’t
()->
	`g‘Ind’t
());

434 ià(
$pStyË
->
	`g‘Alignm’t
()->
	`g‘R—dÜd”
() > 0) {

435 
$objWr™”
->
	`wr™eA‰ribu‹
('»adšgOrd”', 
$pStyË
->
	`g‘Alignm’t
()->
	`g‘R—dÜd”
());

437 
$objWr™”
->
	`’dEËm’t
();

440 ià(
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è!ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
 || $pStyË->g‘PrÙeùiÚ()->
	`g‘Hidd’
() != PHPExcel_Style_Protection::PROTECTION_INHERIT) {

441 
$objWr™”
->
	`¡¬tEËm’t
('protection');

442 ià(
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è!ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
) {

443 
$objWr™”
->
	`wr™eA‰ribu‹
('locked', (
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è=ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
 ? 'true' : 'false'));

445 ià(
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Hidd’
(è!ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
) {

446 
$objWr™”
->
	`wr™eA‰ribu‹
('hidd’', (
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Hidd’
(è=ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
 ? 'true' : 'false'));

448 
$objWr™”
->
	`’dEËm’t
();

451 
$objWr™”
->
	`’dEËm’t
();

452 
	}
}

461 
´iv©e
 
funùiÚ
 
	$wr™eC–lStyËDxf
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_StyË
 
$pStyË
 =‚ull)

464 
$objWr™”
->
	`¡¬tEËm’t
('dxf');

467 
$this
->
	`wr™eFÚt
(
$objWr™”
, 
$pStyË
->
	`g‘FÚt
());

470 
$this
->
	`wr™eNumFmt
(
$objWr™”
, 
$pStyË
->
	`g‘Numb”FÜm©
());

473 
$this
->
	`wr™eFl
(
$objWr™”
, 
$pStyË
->
	`g‘Fl
());

476 
$objWr™”
->
	`¡¬tEËm’t
('alignment');

477 ià(
$pStyË
->
	`g‘Alignm’t
()->
	`g‘HÜizÚl
(è!=ğ
nuÎ
) {

478 
$objWr™”
->
	`wr™eA‰ribu‹
('hÜizÚl', 
$pStyË
->
	`g‘Alignm’t
()->
	`g‘HÜizÚl
());

480 ià(
$pStyË
->
	`g‘Alignm’t
()->
	`g‘V”tiÿl
(è!=ğ
nuÎ
) {

481 
$objWr™”
->
	`wr™eA‰ribu‹
('v”tiÿl', 
$pStyË
->
	`g‘Alignm’t
()->
	`g‘V”tiÿl
());

484 ià(
$pStyË
->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
(è!=ğ
nuÎ
) {

485 
$‹xtRÙ©iÚ
 = 0;

486 ià(
$pStyË
->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
() >= 0) {

487 
$‹xtRÙ©iÚ
 = 
$pStyË
->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
();

488 } 
	`–£if
 (
$pStyË
->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
() < 0) {

489 
$‹xtRÙ©iÚ
 = 90 - 
$pStyË
->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
();

491 
$objWr™”
->
	`wr™eA‰ribu‹
('‹xtRÙ©iÚ', 
$‹xtRÙ©iÚ
);

493 
$objWr™”
->
	`’dEËm’t
();

496 
$this
->
	`wr™eBÜd”
(
$objWr™”
, 
$pStyË
->
	`g‘BÜd”s
());

499 ià((
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è!=ğ
nuÎ
è|| ($pStyË->g‘PrÙeùiÚ()->
	`g‘Hidd’
() !==‚ull)) {

500 ià(
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è!=ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
 ||

501 
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Hidd’
(è!=ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
) {

502 
$objWr™”
->
	`¡¬tEËm’t
('protection');

503 ià((
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è!=ğ
nuÎ
) &&

504 (
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è!=ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
)) {

505 
$objWr™”
->
	`wr™eA‰ribu‹
('locked', (
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è=ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
 ? 'true' : 'false'));

507 ià((
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Hidd’
(è!=ğ
nuÎ
) &&

508 (
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Hidd’
(è!=ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
)) {

509 
$objWr™”
->
	`wr™eA‰ribu‹
('hidd’', (
$pStyË
->
	`g‘PrÙeùiÚ
()->
	`g‘Hidd’
(è=ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
 ? 'true' : 'false'));

511 
$objWr™”
->
	`’dEËm’t
();

515 
$objWr™”
->
	`’dEËm’t
();

516 
	}
}

526 
´iv©e
 
funùiÚ
 
wr™eBÜd”Pr
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
$pName
 = 'Ëá', 
PHPExûl_StyË_BÜd”
 
$pBÜd”
 =‚ull)

529 ià(
$pBÜd”
->
g‘BÜd”StyË
(è!ğ
PHPExûl_StyË_BÜd”
::
BORDER_NONE
) {

530 
$objWr™”
->
¡¬tEËm’t
(
$pName
);

531 
	g$objWr™”
->
wr™eA‰ribu‹
('¡yË', 
$pBÜd”
->
g‘BÜd”StyË
());

534 
	g$objWr™”
->
¡¬tEËm’t
('color');

535 
	g$objWr™”
->
wr™eA‰ribu‹
('rgb', 
$pBÜd”
->
g‘CŞÜ
()->
g‘ARGB
());

536 
	g$objWr™”
->
’dEËm’t
();

538 
	g$objWr™”
->
’dEËm’t
();

550 
´iv©e
 
funùiÚ
 
	$wr™eNumFmt
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_StyË_Numb”FÜm©
 
$pNumb”FÜm©
 =‚uÎ, 
$pId
 = 0)

553 
$fÜm©Code
 = 
$pNumb”FÜm©
->
	`g‘FÜm©Code
();

556 ià(
$fÜm©Code
 !=ğ
nuÎ
) {

557 
$objWr™”
->
	`¡¬tEËm’t
('numFmt');

558 
$objWr™”
->
	`wr™eA‰ribu‹
('numFmtId', (
$pId
 + 164));

559 
$objWr™”
->
	`wr™eA‰ribu‹
('fÜm©Code', 
$fÜm©Code
);

560 
$objWr™”
->
	`’dEËm’t
();

562 
	}
}

571 
public
 
funùiÚ
 
	$®lStyËs
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

573  
$pPHPExûl
->
	`g‘C–lXfCŞËùiÚ
();

574 
	}
}

583 
public
 
funùiÚ
 
	$®lCÚd™iÚ®StyËs
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

586 
$aStyËs
 = 
	`¬¿y
();

588 
$sh“tCouÁ
 = 
$pPHPExûl
->
	`g‘Sh“tCouÁ
();

589 
$i
 = 0; $˜< 
$sh“tCouÁ
; ++$i) {

590 
	`fÜ—ch
 (
$pPHPExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘CÚd™iÚ®StyËsCŞËùiÚ
(è
as
 
$cÚd™iÚ®StyËs
) {

591 
	`fÜ—ch
 (
$cÚd™iÚ®StyËs
 
as
 
$cÚd™iÚ®StyË
) {

592 
$aStyËs
[] = 
$cÚd™iÚ®StyË
;

597  
$aStyËs
;

598 
	}
}

607 
public
 
funùiÚ
 
	$®lFls
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

610 
$aFls
 = 
	`¬¿y
();

613 
$fl0
 = 
Ãw
 
	`PHPExûl_StyË_Fl
();

614 
$fl0
->
	`£tFlTy³
(
PHPExûl_StyË_Fl
::
FILL_NONE
);

615 
$aFls
[] = 
$fl0
;

617 
$fl1
 = 
Ãw
 
	`PHPExûl_StyË_Fl
();

618 
$fl1
->
	`£tFlTy³
(
PHPExûl_StyË_Fl
::
FILL_PATTERN_GRAY125
);

619 
$aFls
[] = 
$fl1
;

621 
$aStyËs
 = 
$this
->
	`®lStyËs
(
$pPHPExûl
);

622 
	`fÜ—ch
 (
$aStyËs
 
as
 
$¡yË
) {

623 ià(!
	`¬¿y_key_exi¡s
(
$¡yË
->
	`g‘Fl
()->
	`g‘HashCode
(), 
$aFls
)) {

624 
$aFls
[ 
$¡yË
->
	`g‘Fl
()->
	`g‘HashCode
() ] = $style->getFill();

628  
$aFls
;

629 
	}
}

638 
public
 
funùiÚ
 
	$®lFÚts
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

641 
$aFÚts
 = 
	`¬¿y
();

642 
$aStyËs
 = 
$this
->
	`®lStyËs
(
$pPHPExûl
);

644 
	`fÜ—ch
 (
$aStyËs
 
as
 
$¡yË
) {

645 ià(!
	`¬¿y_key_exi¡s
(
$¡yË
->
	`g‘FÚt
()->
	`g‘HashCode
(), 
$aFÚts
)) {

646 
$aFÚts
[ 
$¡yË
->
	`g‘FÚt
()->
	`g‘HashCode
() ] = $style->getFont();

650  
$aFÚts
;

651 
	}
}

660 
public
 
funùiÚ
 
	$®lBÜd”s
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

663 
$aBÜd”s
 = 
	`¬¿y
();

664 
$aStyËs
 = 
$this
->
	`®lStyËs
(
$pPHPExûl
);

666 
	`fÜ—ch
 (
$aStyËs
 
as
 
$¡yË
) {

667 ià(!
	`¬¿y_key_exi¡s
(
$¡yË
->
	`g‘BÜd”s
()->
	`g‘HashCode
(), 
$aBÜd”s
)) {

668 
$aBÜd”s
[ 
$¡yË
->
	`g‘BÜd”s
()->
	`g‘HashCode
() ] = $style->getBorders();

672  
$aBÜd”s
;

673 
	}
}

682 
public
 
funùiÚ
 
	$®lNumb”FÜm©s
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

685 
$aNumFmts
 = 
	`¬¿y
();

686 
$aStyËs
 = 
$this
->
	`®lStyËs
(
$pPHPExûl
);

688 
	`fÜ—ch
 (
$aStyËs
 
as
 
$¡yË
) {

689 ià(
$¡yË
->
	`g‘Numb”FÜm©
()->
	`g‘ButInFÜm©Code
(è==ğ
çl£
 && !
	`¬¿y_key_exi¡s
($¡yË->g‘Numb”FÜm©()->
	`g‘HashCode
(), 
$aNumFmts
)) {

690 
$aNumFmts
[ 
$¡yË
->
	`g‘Numb”FÜm©
()->
	`g‘HashCode
() ] = $style->getNumberFormat();

694  
$aNumFmts
;

695 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Theme.php

1 <?
php


36 şas 
	cPHPExûl_Wr™”_Exûl2007_Theme
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


43 
´iv©e
 
	m$majÜFÚts
 = 
¬¿y
(

81 
´iv©e
 
	m$mšÜFÚts
 = 
¬¿y
(

119 
´iv©e
 
	m$cŞourScheme
 = 
¬¿y
(

139 
public
 
funùiÚ
 
	$wr™eTheme
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

142 
$objWr™”
 = 
nuÎ
;

143 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

144 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

146 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

150 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

153 
$objWr™”
->
	`¡¬tEËm’t
('a:theme');

154 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:a', 'http://schemas.openxmlformats.org/drawingml/2006/main');

155 
$objWr™”
->
	`wr™eA‰ribu‹
('name', 'Office Theme');

158 
$objWr™”
->
	`¡¬tEËm’t
('a:themeElements');

161 
$objWr™”
->
	`¡¬tEËm’t
('a:clrScheme');

162 
$objWr™”
->
	`wr™eA‰ribu‹
('name', 'Office');

165 
$objWr™”
->
	`¡¬tEËm’t
('a:dk1');

168 
$objWr™”
->
	`¡¬tEËm’t
('a:sysClr');

169 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'windowText');

170 
$objWr™”
->
	`wr™eA‰ribu‹
('lastClr', '000000');

171 
$objWr™”
->
	`’dEËm’t
();

173 
$objWr™”
->
	`’dEËm’t
();

176 
$objWr™”
->
	`¡¬tEËm’t
('a:lt1');

179 
$objWr™”
->
	`¡¬tEËm’t
('a:sysClr');

180 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'window');

181 
$objWr™”
->
	`wr™eA‰ribu‹
('lastClr', 'FFFFFF');

182 
$objWr™”
->
	`’dEËm’t
();

184 
$objWr™”
->
	`’dEËm’t
();

187 
$this
->
	`wr™eCŞourScheme
(
$objWr™”
);

189 
$objWr™”
->
	`’dEËm’t
();

192 
$objWr™”
->
	`¡¬tEËm’t
('a:fontScheme');

193 
$objWr™”
->
	`wr™eA‰ribu‹
('name', 'Office');

196 
$objWr™”
->
	`¡¬tEËm’t
('a:majorFont');

197 
$this
->
	`wr™eFÚts
(
$objWr™”
, 'CambrŸ', 
£lf
::
$majÜFÚts
);

198 
$objWr™”
->
	`’dEËm’t
();

201 
$objWr™”
->
	`¡¬tEËm’t
('a:minorFont');

202 
$this
->
	`wr™eFÚts
(
$objWr™”
, 'C®ibri', 
£lf
::
$mšÜFÚts
);

203 
$objWr™”
->
	`’dEËm’t
();

205 
$objWr™”
->
	`’dEËm’t
();

208 
$objWr™”
->
	`¡¬tEËm’t
('a:fmtScheme');

209 
$objWr™”
->
	`wr™eA‰ribu‹
('name', 'Office');

212 
$objWr™”
->
	`¡¬tEËm’t
('a:fillStyleLst');

215 
$objWr™”
->
	`¡¬tEËm’t
('a:solidFill');

218 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

219 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

220 
$objWr™”
->
	`’dEËm’t
();

222 
$objWr™”
->
	`’dEËm’t
();

225 
$objWr™”
->
	`¡¬tEËm’t
('a:gradFill');

226 
$objWr™”
->
	`wr™eA‰ribu‹
('rotWithShape', '1');

229 
$objWr™”
->
	`¡¬tEËm’t
('a:gsLst');

232 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

233 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '0');

236 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

237 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

240 
$objWr™”
->
	`¡¬tEËm’t
('a:tint');

241 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '50000');

242 
$objWr™”
->
	`’dEËm’t
();

245 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

246 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '300000');

247 
$objWr™”
->
	`’dEËm’t
();

249 
$objWr™”
->
	`’dEËm’t
();

251 
$objWr™”
->
	`’dEËm’t
();

254 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

255 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '35000');

258 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

259 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

262 
$objWr™”
->
	`¡¬tEËm’t
('a:tint');

263 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '37000');

264 
$objWr™”
->
	`’dEËm’t
();

267 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

268 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '300000');

269 
$objWr™”
->
	`’dEËm’t
();

271 
$objWr™”
->
	`’dEËm’t
();

273 
$objWr™”
->
	`’dEËm’t
();

276 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

277 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '100000');

280 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

281 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

284 
$objWr™”
->
	`¡¬tEËm’t
('a:tint');

285 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '15000');

286 
$objWr™”
->
	`’dEËm’t
();

289 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

290 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '350000');

291 
$objWr™”
->
	`’dEËm’t
();

293 
$objWr™”
->
	`’dEËm’t
();

295 
$objWr™”
->
	`’dEËm’t
();

297 
$objWr™”
->
	`’dEËm’t
();

300 
$objWr™”
->
	`¡¬tEËm’t
('a:lin');

301 
$objWr™”
->
	`wr™eA‰ribu‹
('ang', '16200000');

302 
$objWr™”
->
	`wr™eA‰ribu‹
('scaled', '1');

303 
$objWr™”
->
	`’dEËm’t
();

305 
$objWr™”
->
	`’dEËm’t
();

308 
$objWr™”
->
	`¡¬tEËm’t
('a:gradFill');

309 
$objWr™”
->
	`wr™eA‰ribu‹
('rotWithShape', '1');

312 
$objWr™”
->
	`¡¬tEËm’t
('a:gsLst');

315 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

316 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '0');

319 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

320 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

323 
$objWr™”
->
	`¡¬tEËm’t
('a:shade');

324 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '51000');

325 
$objWr™”
->
	`’dEËm’t
();

328 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

329 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '130000');

330 
$objWr™”
->
	`’dEËm’t
();

332 
$objWr™”
->
	`’dEËm’t
();

334 
$objWr™”
->
	`’dEËm’t
();

337 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

338 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '80000');

341 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

342 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

345 
$objWr™”
->
	`¡¬tEËm’t
('a:shade');

346 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '93000');

347 
$objWr™”
->
	`’dEËm’t
();

350 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

351 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '130000');

352 
$objWr™”
->
	`’dEËm’t
();

354 
$objWr™”
->
	`’dEËm’t
();

356 
$objWr™”
->
	`’dEËm’t
();

359 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

360 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '100000');

363 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

364 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

367 
$objWr™”
->
	`¡¬tEËm’t
('a:shade');

368 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '94000');

369 
$objWr™”
->
	`’dEËm’t
();

372 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

373 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '135000');

374 
$objWr™”
->
	`’dEËm’t
();

376 
$objWr™”
->
	`’dEËm’t
();

378 
$objWr™”
->
	`’dEËm’t
();

380 
$objWr™”
->
	`’dEËm’t
();

383 
$objWr™”
->
	`¡¬tEËm’t
('a:lin');

384 
$objWr™”
->
	`wr™eA‰ribu‹
('ang', '16200000');

385 
$objWr™”
->
	`wr™eA‰ribu‹
('scaled', '0');

386 
$objWr™”
->
	`’dEËm’t
();

388 
$objWr™”
->
	`’dEËm’t
();

390 
$objWr™”
->
	`’dEËm’t
();

393 
$objWr™”
->
	`¡¬tEËm’t
('a:lnStyleLst');

396 
$objWr™”
->
	`¡¬tEËm’t
('a:ln');

397 
$objWr™”
->
	`wr™eA‰ribu‹
('w', '9525');

398 
$objWr™”
->
	`wr™eA‰ribu‹
('cap', 'flat');

399 
$objWr™”
->
	`wr™eA‰ribu‹
('cmpd', 'sng');

400 
$objWr™”
->
	`wr™eA‰ribu‹
('algn', 'ctr');

403 
$objWr™”
->
	`¡¬tEËm’t
('a:solidFill');

406 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

407 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

410 
$objWr™”
->
	`¡¬tEËm’t
('a:shade');

411 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '95000');

412 
$objWr™”
->
	`’dEËm’t
();

415 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

416 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '105000');

417 
$objWr™”
->
	`’dEËm’t
();

419 
$objWr™”
->
	`’dEËm’t
();

421 
$objWr™”
->
	`’dEËm’t
();

424 
$objWr™”
->
	`¡¬tEËm’t
('a:prstDash');

425 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'solid');

426 
$objWr™”
->
	`’dEËm’t
();

428 
$objWr™”
->
	`’dEËm’t
();

431 
$objWr™”
->
	`¡¬tEËm’t
('a:ln');

432 
$objWr™”
->
	`wr™eA‰ribu‹
('w', '25400');

433 
$objWr™”
->
	`wr™eA‰ribu‹
('cap', 'flat');

434 
$objWr™”
->
	`wr™eA‰ribu‹
('cmpd', 'sng');

435 
$objWr™”
->
	`wr™eA‰ribu‹
('algn', 'ctr');

438 
$objWr™”
->
	`¡¬tEËm’t
('a:solidFill');

441 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

442 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

443 
$objWr™”
->
	`’dEËm’t
();

445 
$objWr™”
->
	`’dEËm’t
();

448 
$objWr™”
->
	`¡¬tEËm’t
('a:prstDash');

449 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'solid');

450 
$objWr™”
->
	`’dEËm’t
();

452 
$objWr™”
->
	`’dEËm’t
();

455 
$objWr™”
->
	`¡¬tEËm’t
('a:ln');

456 
$objWr™”
->
	`wr™eA‰ribu‹
('w', '38100');

457 
$objWr™”
->
	`wr™eA‰ribu‹
('cap', 'flat');

458 
$objWr™”
->
	`wr™eA‰ribu‹
('cmpd', 'sng');

459 
$objWr™”
->
	`wr™eA‰ribu‹
('algn', 'ctr');

462 
$objWr™”
->
	`¡¬tEËm’t
('a:solidFill');

465 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

466 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

467 
$objWr™”
->
	`’dEËm’t
();

469 
$objWr™”
->
	`’dEËm’t
();

472 
$objWr™”
->
	`¡¬tEËm’t
('a:prstDash');

473 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'solid');

474 
$objWr™”
->
	`’dEËm’t
();

476 
$objWr™”
->
	`’dEËm’t
();

478 
$objWr™”
->
	`’dEËm’t
();

483 
$objWr™”
->
	`¡¬tEËm’t
('a:effectStyleLst');

486 
$objWr™”
->
	`¡¬tEËm’t
('a:effectStyle');

489 
$objWr™”
->
	`¡¬tEËm’t
('a:effectLst');

492 
$objWr™”
->
	`¡¬tEËm’t
('a:outerShdw');

493 
$objWr™”
->
	`wr™eA‰ribu‹
('blurRad', '40000');

494 
$objWr™”
->
	`wr™eA‰ribu‹
('dist', '20000');

495 
$objWr™”
->
	`wr™eA‰ribu‹
('dir', '5400000');

496 
$objWr™”
->
	`wr™eA‰ribu‹
('rotWithShape', '0');

499 
$objWr™”
->
	`¡¬tEËm’t
('a:srgbClr');

500 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '000000');

503 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

504 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '38000');

505 
$objWr™”
->
	`’dEËm’t
();

507 
$objWr™”
->
	`’dEËm’t
();

509 
$objWr™”
->
	`’dEËm’t
();

511 
$objWr™”
->
	`’dEËm’t
();

513 
$objWr™”
->
	`’dEËm’t
();

516 
$objWr™”
->
	`¡¬tEËm’t
('a:effectStyle');

519 
$objWr™”
->
	`¡¬tEËm’t
('a:effectLst');

522 
$objWr™”
->
	`¡¬tEËm’t
('a:outerShdw');

523 
$objWr™”
->
	`wr™eA‰ribu‹
('blurRad', '40000');

524 
$objWr™”
->
	`wr™eA‰ribu‹
('dist', '23000');

525 
$objWr™”
->
	`wr™eA‰ribu‹
('dir', '5400000');

526 
$objWr™”
->
	`wr™eA‰ribu‹
('rotWithShape', '0');

529 
$objWr™”
->
	`¡¬tEËm’t
('a:srgbClr');

530 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '000000');

533 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

534 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '35000');

535 
$objWr™”
->
	`’dEËm’t
();

537 
$objWr™”
->
	`’dEËm’t
();

539 
$objWr™”
->
	`’dEËm’t
();

541 
$objWr™”
->
	`’dEËm’t
();

543 
$objWr™”
->
	`’dEËm’t
();

546 
$objWr™”
->
	`¡¬tEËm’t
('a:effectStyle');

549 
$objWr™”
->
	`¡¬tEËm’t
('a:effectLst');

552 
$objWr™”
->
	`¡¬tEËm’t
('a:outerShdw');

553 
$objWr™”
->
	`wr™eA‰ribu‹
('blurRad', '40000');

554 
$objWr™”
->
	`wr™eA‰ribu‹
('dist', '23000');

555 
$objWr™”
->
	`wr™eA‰ribu‹
('dir', '5400000');

556 
$objWr™”
->
	`wr™eA‰ribu‹
('rotWithShape', '0');

559 
$objWr™”
->
	`¡¬tEËm’t
('a:srgbClr');

560 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '000000');

563 
$objWr™”
->
	`¡¬tEËm’t
('a:alpha');

564 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '35000');

565 
$objWr™”
->
	`’dEËm’t
();

567 
$objWr™”
->
	`’dEËm’t
();

569 
$objWr™”
->
	`’dEËm’t
();

571 
$objWr™”
->
	`’dEËm’t
();

574 
$objWr™”
->
	`¡¬tEËm’t
('a:scene3d');

577 
$objWr™”
->
	`¡¬tEËm’t
('a:camera');

578 
$objWr™”
->
	`wr™eA‰ribu‹
('prst', 'orthographicFront');

581 
$objWr™”
->
	`¡¬tEËm’t
('a:rot');

582 
$objWr™”
->
	`wr™eA‰ribu‹
('lat', '0');

583 
$objWr™”
->
	`wr™eA‰ribu‹
('lon', '0');

584 
$objWr™”
->
	`wr™eA‰ribu‹
('rev', '0');

585 
$objWr™”
->
	`’dEËm’t
();

587 
$objWr™”
->
	`’dEËm’t
();

590 
$objWr™”
->
	`¡¬tEËm’t
('a:lightRig');

591 
$objWr™”
->
	`wr™eA‰ribu‹
('rig', 'threePt');

592 
$objWr™”
->
	`wr™eA‰ribu‹
('dir', 't');

595 
$objWr™”
->
	`¡¬tEËm’t
('a:rot');

596 
$objWr™”
->
	`wr™eA‰ribu‹
('lat', '0');

597 
$objWr™”
->
	`wr™eA‰ribu‹
('lon', '0');

598 
$objWr™”
->
	`wr™eA‰ribu‹
('rev', '1200000');

599 
$objWr™”
->
	`’dEËm’t
();

601 
$objWr™”
->
	`’dEËm’t
();

603 
$objWr™”
->
	`’dEËm’t
();

606 
$objWr™”
->
	`¡¬tEËm’t
('a:sp3d');

609 
$objWr™”
->
	`¡¬tEËm’t
('a:bevelT');

610 
$objWr™”
->
	`wr™eA‰ribu‹
('w', '63500');

611 
$objWr™”
->
	`wr™eA‰ribu‹
('h', '25400');

612 
$objWr™”
->
	`’dEËm’t
();

614 
$objWr™”
->
	`’dEËm’t
();

616 
$objWr™”
->
	`’dEËm’t
();

618 
$objWr™”
->
	`’dEËm’t
();

621 
$objWr™”
->
	`¡¬tEËm’t
('a:bgFillStyleLst');

624 
$objWr™”
->
	`¡¬tEËm’t
('a:solidFill');

627 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

628 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

629 
$objWr™”
->
	`’dEËm’t
();

631 
$objWr™”
->
	`’dEËm’t
();

634 
$objWr™”
->
	`¡¬tEËm’t
('a:gradFill');

635 
$objWr™”
->
	`wr™eA‰ribu‹
('rotWithShape', '1');

638 
$objWr™”
->
	`¡¬tEËm’t
('a:gsLst');

641 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

642 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '0');

645 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

646 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

649 
$objWr™”
->
	`¡¬tEËm’t
('a:tint');

650 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '40000');

651 
$objWr™”
->
	`’dEËm’t
();

654 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

655 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '350000');

656 
$objWr™”
->
	`’dEËm’t
();

658 
$objWr™”
->
	`’dEËm’t
();

660 
$objWr™”
->
	`’dEËm’t
();

663 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

664 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '40000');

667 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

668 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

671 
$objWr™”
->
	`¡¬tEËm’t
('a:tint');

672 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '45000');

673 
$objWr™”
->
	`’dEËm’t
();

676 
$objWr™”
->
	`¡¬tEËm’t
('a:shade');

677 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '99000');

678 
$objWr™”
->
	`’dEËm’t
();

681 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

682 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '350000');

683 
$objWr™”
->
	`’dEËm’t
();

685 
$objWr™”
->
	`’dEËm’t
();

687 
$objWr™”
->
	`’dEËm’t
();

690 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

691 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '100000');

694 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

695 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

698 
$objWr™”
->
	`¡¬tEËm’t
('a:shade');

699 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '20000');

700 
$objWr™”
->
	`’dEËm’t
();

703 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

704 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '255000');

705 
$objWr™”
->
	`’dEËm’t
();

707 
$objWr™”
->
	`’dEËm’t
();

709 
$objWr™”
->
	`’dEËm’t
();

711 
$objWr™”
->
	`’dEËm’t
();

714 
$objWr™”
->
	`¡¬tEËm’t
('a:path');

715 
$objWr™”
->
	`wr™eA‰ribu‹
('path', 'circle');

718 
$objWr™”
->
	`¡¬tEËm’t
('a:fillToRect');

719 
$objWr™”
->
	`wr™eA‰ribu‹
('l', '50000');

720 
$objWr™”
->
	`wr™eA‰ribu‹
('t', '-80000');

721 
$objWr™”
->
	`wr™eA‰ribu‹
('r', '50000');

722 
$objWr™”
->
	`wr™eA‰ribu‹
('b', '180000');

723 
$objWr™”
->
	`’dEËm’t
();

725 
$objWr™”
->
	`’dEËm’t
();

727 
$objWr™”
->
	`’dEËm’t
();

730 
$objWr™”
->
	`¡¬tEËm’t
('a:gradFill');

731 
$objWr™”
->
	`wr™eA‰ribu‹
('rotWithShape', '1');

734 
$objWr™”
->
	`¡¬tEËm’t
('a:gsLst');

737 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

738 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '0');

741 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

742 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

745 
$objWr™”
->
	`¡¬tEËm’t
('a:tint');

746 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '80000');

747 
$objWr™”
->
	`’dEËm’t
();

750 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

751 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '300000');

752 
$objWr™”
->
	`’dEËm’t
();

754 
$objWr™”
->
	`’dEËm’t
();

756 
$objWr™”
->
	`’dEËm’t
();

759 
$objWr™”
->
	`¡¬tEËm’t
('a:gs');

760 
$objWr™”
->
	`wr™eA‰ribu‹
('pos', '100000');

763 
$objWr™”
->
	`¡¬tEËm’t
('a:schemeClr');

764 
$objWr™”
->
	`wr™eA‰ribu‹
('val', 'phClr');

767 
$objWr™”
->
	`¡¬tEËm’t
('a:shade');

768 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '30000');

769 
$objWr™”
->
	`’dEËm’t
();

772 
$objWr™”
->
	`¡¬tEËm’t
('a:satMod');

773 
$objWr™”
->
	`wr™eA‰ribu‹
('val', '200000');

774 
$objWr™”
->
	`’dEËm’t
();

776 
$objWr™”
->
	`’dEËm’t
();

778 
$objWr™”
->
	`’dEËm’t
();

780 
$objWr™”
->
	`’dEËm’t
();

783 
$objWr™”
->
	`¡¬tEËm’t
('a:path');

784 
$objWr™”
->
	`wr™eA‰ribu‹
('path', 'circle');

787 
$objWr™”
->
	`¡¬tEËm’t
('a:fillToRect');

788 
$objWr™”
->
	`wr™eA‰ribu‹
('l', '50000');

789 
$objWr™”
->
	`wr™eA‰ribu‹
('t', '50000');

790 
$objWr™”
->
	`wr™eA‰ribu‹
('r', '50000');

791 
$objWr™”
->
	`wr™eA‰ribu‹
('b', '50000');

792 
$objWr™”
->
	`’dEËm’t
();

794 
$objWr™”
->
	`’dEËm’t
();

796 
$objWr™”
->
	`’dEËm’t
();

798 
$objWr™”
->
	`’dEËm’t
();

800 
$objWr™”
->
	`’dEËm’t
();

802 
$objWr™”
->
	`’dEËm’t
();

805 
$objWr™”
->
	`wr™eEËm’t
('a:objeùDeçuÉs', 
nuÎ
);

808 
$objWr™”
->
	`wr™eEËm’t
('a:exŒaCÌSchemeL¡', 
nuÎ
);

810 
$objWr™”
->
	`’dEËm’t
();

813  
$objWr™”
->
	`g‘D©a
();

825 
´iv©e
 
funùiÚ
 
	$wr™eFÚts
(
$objWr™”
, 
$ÏtšFÚt
, 
$fÚtS‘
)

828 
$objWr™”
->
	`¡¬tEËm’t
('a:latin');

829 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³çû', 
$ÏtšFÚt
);

830 
$objWr™”
->
	`’dEËm’t
();

833 
$objWr™”
->
	`¡¬tEËm’t
('a:ea');

834 
$objWr™”
->
	`wr™eA‰ribu‹
('typeface', '');

835 
$objWr™”
->
	`’dEËm’t
();

838 
$objWr™”
->
	`¡¬tEËm’t
('a:cs');

839 
$objWr™”
->
	`wr™eA‰ribu‹
('typeface', '');

840 
$objWr™”
->
	`’dEËm’t
();

842 
	`fÜ—ch
 (
$fÚtS‘
 
as
 
$fÚtSüt
 => 
$ty³çû
) {

843 
$objWr™”
->
	`¡¬tEËm’t
('a:font');

844 
$objWr™”
->
	`wr™eA‰ribu‹
('süt', 
$fÚtSüt
);

845 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³çû', 
$ty³çû
);

846 
$objWr™”
->
	`’dEËm’t
();

848 
	}
}

857 
´iv©e
 
funùiÚ
 
	$wr™eCŞourScheme
(
$objWr™”
)

859 
	`fÜ—ch
 (
£lf
::
$cŞourScheme
 
as
 
$cŞourName
 => 
$cŞourV®ue
) {

860 
$objWr™”
->
	`¡¬tEËm’t
('a:'.
$cŞourName
);

862 
$objWr™”
->
	`¡¬tEËm’t
('a:srgbClr');

863 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$cŞourV®ue
);

864 
$objWr™”
->
	`’dEËm’t
();

866 
$objWr™”
->
	`’dEËm’t
();

868 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Workbook.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl2007_WÜkbook
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


38 
public
 
funùiÚ
 
	$wr™eWÜkbook
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
, 
$»ÿlcRequœed
 = 
çl£
)

41 
$objWr™”
 = 
nuÎ
;

42 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

43 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

45 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

49 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

52 
$objWr™”
->
	`¡¬tEËm’t
('workbook');

53 
$objWr™”
->
	`wr™eA‰ribu‹
('xml:space', 'preserve');

54 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');

55 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');

58 
$this
->
	`wr™eFeV”siÚ
(
$objWr™”
);

61 
$this
->
	`wr™eWÜkbookPr
(
$objWr™”
);

64 
$this
->
	`wr™eWÜkbookPrÙeùiÚ
(
$objWr™”
, 
$pPHPExûl
);

67 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘Offiû2003Com·tib™y
(è==ğ
çl£
) {

68 
$this
->
	`wr™eBookV›ws
(
$objWr™”
, 
$pPHPExûl
);

72 
$this
->
	`wr™eSh“ts
(
$objWr™”
, 
$pPHPExûl
);

75 
$this
->
	`wr™eDefšedNames
(
$objWr™”
, 
$pPHPExûl
);

78 
$this
->
	`wr™eC®cPr
(
$objWr™”
, 
$»ÿlcRequœed
);

80 
$objWr™”
->
	`’dEËm’t
();

83  
$objWr™”
->
	`g‘D©a
();

92 
´iv©e
 
funùiÚ
 
	$wr™eFeV”siÚ
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
)

94 
$objWr™”
->
	`¡¬tEËm’t
('fileVersion');

95 
$objWr™”
->
	`wr™eA‰ribu‹
('appName', 'xl');

96 
$objWr™”
->
	`wr™eA‰ribu‹
('lastEdited', '4');

97 
$objWr™”
->
	`wr™eA‰ribu‹
('lowestEdited', '4');

98 
$objWr™”
->
	`wr™eA‰ribu‹
('rupBuild', '4505');

99 
$objWr™”
->
	`’dEËm’t
();

100 
	}
}

108 
´iv©e
 
funùiÚ
 
	$wr™eWÜkbookPr
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
)

110 
$objWr™”
->
	`¡¬tEËm’t
('workbookPr');

112 ià(
PHPExûl_Sh¬ed_D©e
::
	`g‘ExûlC®’d¬
(è=ğPHPExûl_Sh¬ed_D©e::
CALENDAR_MAC_1904
) {

113 
$objWr™”
->
	`wr™eA‰ribu‹
('date1904', '1');

116 
$objWr™”
->
	`wr™eA‰ribu‹
('codeName', 'ThisWorkbook');

118 
$objWr™”
->
	`’dEËm’t
();

119 
	}
}

128 
´iv©e
 
funùiÚ
 
	$wr™eBookV›ws
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl
 
$pPHPExûl
 =‚ull)

131 
$objWr™”
->
	`¡¬tEËm’t
('bookViews');

134 
$objWr™”
->
	`¡¬tEËm’t
('workbookView');

136 
$objWr™”
->
	`wr™eA‰ribu‹
('aùiveTab', 
$pPHPExûl
->
	`g‘AùiveSh“tIndex
());

137 
$objWr™”
->
	`wr™eA‰ribu‹
('autoFilterDateGrouping', '1');

138 
$objWr™”
->
	`wr™eA‰ribu‹
('firstSheet', '0');

139 
$objWr™”
->
	`wr™eA‰ribu‹
('minimized', '0');

140 
$objWr™”
->
	`wr™eA‰ribu‹
('showHorizontalScroll', '1');

141 
$objWr™”
->
	`wr™eA‰ribu‹
('showSheetTabs', '1');

142 
$objWr™”
->
	`wr™eA‰ribu‹
('showVerticalScroll', '1');

143 
$objWr™”
->
	`wr™eA‰ribu‹
('tabRatio', '600');

144 
$objWr™”
->
	`wr™eA‰ribu‹
('visibility', 'visible');

146 
$objWr™”
->
	`’dEËm’t
();

148 
$objWr™”
->
	`’dEËm’t
();

149 
	}
}

158 
´iv©e
 
funùiÚ
 
	$wr™eWÜkbookPrÙeùiÚ
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl
 
$pPHPExûl
 =‚ull)

160 ià(
$pPHPExûl
->
	`g‘Secur™y
()->
	`isSecur™yEÇbËd
()) {

161 
$objWr™”
->
	`¡¬tEËm’t
('workbookProtection');

162 
$objWr™”
->
	`wr™eA‰ribu‹
('lockRevisiÚ', (
$pPHPExûl
->
	`g‘Secur™y
()->
	`g‘LockRevisiÚ
() ? 'true' : 'false'));

163 
$objWr™”
->
	`wr™eA‰ribu‹
('lockSŒuùu»', (
$pPHPExûl
->
	`g‘Secur™y
()->
	`g‘LockSŒuùu»
() ? 'true' : 'false'));

164 
$objWr™”
->
	`wr™eA‰ribu‹
('lockWšdows', (
$pPHPExûl
->
	`g‘Secur™y
()->
	`g‘LockWšdows
() ? 'true' : 'false'));

166 ià(
$pPHPExûl
->
	`g‘Secur™y
()->
	`g‘RevisiÚsPasswÜd
() != '') {

167 
$objWr™”
->
	`wr™eA‰ribu‹
('»visiÚsPasswÜd', 
$pPHPExûl
->
	`g‘Secur™y
()->
	`g‘RevisiÚsPasswÜd
());

170 ià(
$pPHPExûl
->
	`g‘Secur™y
()->
	`g‘WÜkbookPasswÜd
() != '') {

171 
$objWr™”
->
	`wr™eA‰ribu‹
('wÜkbookPasswÜd', 
$pPHPExûl
->
	`g‘Secur™y
()->
	`g‘WÜkbookPasswÜd
());

174 
$objWr™”
->
	`’dEËm’t
();

176 
	}
}

185 
´iv©e
 
funùiÚ
 
	$wr™eC®cPr
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
$»ÿlcRequœed
 = 
Œue
)

187 
$objWr™”
->
	`¡¬tEËm’t
('calcPr');

192 
$objWr™”
->
	`wr™eA‰ribu‹
('calcId', '999999');

193 
$objWr™”
->
	`wr™eA‰ribu‹
('calcMode', 'auto');

195 
$objWr™”
->
	`wr™eA‰ribu‹
('ÿlcCom¶‘ed', (
$»ÿlcRequœed
) ? 1 : 0);

196 
$objWr™”
->
	`wr™eA‰ribu‹
('fuÎC®cOnLßd', (
$»ÿlcRequœed
) ? 0 : 1);

198 
$objWr™”
->
	`’dEËm’t
();

199 
	}
}

208 
´iv©e
 
funùiÚ
 
	$wr™eSh“ts
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl
 
$pPHPExûl
 =‚ull)

211 
$objWr™”
->
	`¡¬tEËm’t
('sheets');

212 
$sh“tCouÁ
 = 
$pPHPExûl
->
	`g‘Sh“tCouÁ
();

213 
$i
 = 0; $˜< 
$sh“tCouÁ
; ++$i) {

215 
$this
->
	`wr™eSh“t
(

216 
$objWr™”
,

217 
$pPHPExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘T™Ë
(),

218 (
$i
 + 1),

219 (
$i
 + 1 + 3),

220 
$pPHPExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘Sh“tS‹
()

224 
$objWr™”
->
	`’dEËm’t
();

225 
	}
}

237 
´iv©e
 
funùiÚ
 
wr™eSh“t
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
$pSh“Šame
 = '', 
$pSh“tId
 = 1, 
$pR–Id
 = 1, 
$sh“tS‹
 = 'visible')

239 ià(
$pSh“Šame
 != '') {

241 
$objWr™”
->
¡¬tEËm’t
('sheet');

242 
	g$objWr™”
->
wr™eA‰ribu‹
('Çme', 
$pSh“Šame
);

243 
	g$objWr™”
->
wr™eA‰ribu‹
('sh“tId', 
$pSh“tId
);

244 ià(
	g$sh“tS‹
 !ğ'visibË' && 
$sh“tS‹
 != '') {

245 
$objWr™”
->
wr™eA‰ribu‹
('¡©e', 
$sh“tS‹
);

247 
	g$objWr™”
->
wr™eA‰ribu‹
('r:id', 'rId' . 
$pR–Id
);

248 
	g$objWr™”
->
’dEËm’t
();

250 
throw
 
Ãw
 
PHPExûl_Wr™”_Exû±iÚ
("Invalid…arameters…assed.");

261 
´iv©e
 
funùiÚ
 
	$wr™eDefšedNames
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl
 
$pPHPExûl
 =‚ull)

264 
$objWr™”
->
	`¡¬tEËm’t
('definedNames');

267 ià(
	`couÁ
(
$pPHPExûl
->
	`g‘NamedRªges
()) > 0) {

269 
$this
->
	`wr™eNamedRªges
(
$objWr™”
, 
$pPHPExûl
);

273 
$sh“tCouÁ
 = 
$pPHPExûl
->
	`g‘Sh“tCouÁ
();

274 
$i
 = 0; $˜< 
$sh“tCouÁ
; ++$i) {

276 
$this
->
	`wr™eDefšedNameFÜAutof‹r
(
$objWr™”
, 
$pPHPExûl
->
	`g‘Sh“t
(
$i
), $i);

279 
$this
->
	`wr™eDefšedNameFÜPrštT™Ës
(
$objWr™”
, 
$pPHPExûl
->
	`g‘Sh“t
(
$i
), $i);

282 
$this
->
	`wr™eDefšedNameFÜPrštA»a
(
$objWr™”
, 
$pPHPExûl
->
	`g‘Sh“t
(
$i
), $i);

285 
$objWr™”
->
	`’dEËm’t
();

286 
	}
}

295 
´iv©e
 
funùiÚ
 
	$wr™eNamedRªges
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl
 
$pPHPExûl
)

298 
$ÇmedRªges
 = 
$pPHPExûl
->
	`g‘NamedRªges
();

299 
	`fÜ—ch
 (
$ÇmedRªges
 
as
 
$ÇmedRªge
) {

300 
$this
->
	`wr™eDefšedNameFÜNamedRªge
(
$objWr™”
, 
$ÇmedRªge
);

302 
	}
}

311 
´iv©e
 
funùiÚ
 
	$wr™eDefšedNameFÜNamedRªge
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_NamedRªge
 
$pNamedRªge
)

314 
$objWr™”
->
	`¡¬tEËm’t
('definedName');

315 
$objWr™”
->
	`wr™eA‰ribu‹
('Çme', 
$pNamedRªge
->
	`g‘Name
());

316 ià(
$pNamedRªge
->
	`g‘LoÿlOÆy
()) {

317 
$objWr™”
->
	`wr™eA‰ribu‹
('loÿlSh“tId', 
$pNamedRªge
->
	`g‘Scİe
()->
	`g‘P¬’t
()->
	`g‘Index
($pNamedRange->getScope()));

321 
$¿nge
 = 
PHPExûl_C–l
::
	`¥l™Rªge
(
$pNamedRªge
->
	`g‘Rªge
());

322 
$i
 = 0; $˜< 
	`couÁ
(
$¿nge
); $i++) {

323 
$¿nge
[
$i
][0] = '\'' . 
	`¡r_»¶aû
("'", "''", 
$pNamedRªge
->
	`g‘WÜksh“t
()->
	`g‘T™Ë
()è. '\'!' . 
PHPExûl_C–l
::
	`absŞu‹Reã»nû
($range[$i][0]);

324 ià(
	`is£t
(
$¿nge
[
$i
][1])) {

325 
$¿nge
[
$i
][1] = 
PHPExûl_C–l
::
	`absŞu‹Reã»nû
($range[$i][1]);

328 
$¿nge
 = 
PHPExûl_C–l
::
	`budRªge
($range);

330 
$objWr™”
->
	`wr™eRawD©a
(
$¿nge
);

332 
$objWr™”
->
	`’dEËm’t
();

333 
	}
}

343 
´iv©e
 
funùiÚ
 
	$wr™eDefšedNameFÜAutof‹r
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚uÎ, 
$pSh“tId
 = 0)

346 
$autoF‹rRªge
 = 
$pSh“t
->
	`g‘AutoF‹r
()->
	`g‘Rªge
();

347 ià(!
	`em±y
(
$autoF‹rRªge
)) {

348 
$objWr™”
->
	`¡¬tEËm’t
('definedName');

349 
$objWr™”
->
	`wr™eA‰ribu‹
('name', '_xlnm._FilterDatabase');

350 
$objWr™”
->
	`wr™eA‰ribu‹
('loÿlSh“tId', 
$pSh“tId
);

351 
$objWr™”
->
	`wr™eA‰ribu‹
('hidden', '1');

354 
$¿nge
 = 
PHPExûl_C–l
::
	`¥l™Rªge
(
$autoF‹rRªge
);

355 
$¿nge
 = $range[0];

357 ià(
	`¡½os
(
$¿nge
[0], '!'è!=ğ
çl£
) {

358 
	`li¡
(
$ws
, 
$¿nge
[0]èğ
	`ex¶ode
('!', $range[0]);

361 
$¿nge
[0] = 
PHPExûl_C–l
::
	`absŞu‹CoÜdš©e
($range[0]);

362 
$¿nge
[1] = 
PHPExûl_C–l
::
	`absŞu‹CoÜdš©e
($range[1]);

363 
$¿nge
 = 
	`im¶ode
(':', $range);

365 
$objWr™”
->
	`wr™eRawD©a
('\'' . 
	`¡r_»¶aû
("'", "''", 
$pSh“t
->
	`g‘T™Ë
()è. '\'!' . 
$¿nge
);

367 
$objWr™”
->
	`’dEËm’t
();

369 
	}
}

379 
´iv©e
 
funùiÚ
 
	$wr™eDefšedNameFÜPrštT™Ës
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚uÎ, 
$pSh“tId
 = 0)

382 ià(
$pSh“t
->
	`g‘PageS‘up
()->
	`isCŞumnsToR•—tAtLeáS‘
(è|| $pSh“t->g‘PageS‘up()->
	`isRowsToR•—tAtTİS‘
()) {

383 
$objWr™”
->
	`¡¬tEËm’t
('definedName');

384 
$objWr™”
->
	`wr™eA‰ribu‹
('name', '_xlnm.Print_Titles');

385 
$objWr™”
->
	`wr™eA‰ribu‹
('loÿlSh“tId', 
$pSh“tId
);

388 
$£‰šgSŒšg
 = '';

391 ià(
$pSh“t
->
	`g‘PageS‘up
()->
	`isCŞumnsToR•—tAtLeáS‘
()) {

392 
$»³©
 = 
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘CŞumnsToR•—tAtLeá
();

394 
$£‰šgSŒšg
 .ğ'\'' . 
	`¡r_»¶aû
("'", "''", 
$pSh“t
->
	`g‘T™Ë
()è. '\'!$' . 
$»³©
[0] . ':$' . $repeat[1];

398 ià(
$pSh“t
->
	`g‘PageS‘up
()->
	`isRowsToR•—tAtTİS‘
()) {

399 ià(
$pSh“t
->
	`g‘PageS‘up
()->
	`isCŞumnsToR•—tAtLeáS‘
()) {

400 
$£‰šgSŒšg
 .= ',';

403 
$»³©
 = 
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘RowsToR•—tAtTİ
();

405 
$£‰šgSŒšg
 .ğ'\'' . 
	`¡r_»¶aû
("'", "''", 
$pSh“t
->
	`g‘T™Ë
()è. '\'!$' . 
$»³©
[0] . ':$' . $repeat[1];

408 
$objWr™”
->
	`wr™eRawD©a
(
$£‰šgSŒšg
);

410 
$objWr™”
->
	`’dEËm’t
();

412 
	}
}

422 
´iv©e
 
funùiÚ
 
	$wr™eDefšedNameFÜPrštA»a
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚uÎ, 
$pSh“tId
 = 0)

425 ià(
$pSh“t
->
	`g‘PageS‘up
()->
	`isPrštA»aS‘
()) {

426 
$objWr™”
->
	`¡¬tEËm’t
('definedName');

427 
$objWr™”
->
	`wr™eA‰ribu‹
('name', '_xlnm.Print_Area');

428 
$objWr™”
->
	`wr™eA‰ribu‹
('loÿlSh“tId', 
$pSh“tId
);

431 
$£‰šgSŒšg
 = '';

434 
$´štA»a
 = 
PHPExûl_C–l
::
	`¥l™Rªge
(
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘PrštA»a
());

436 
$chunks
 = 
	`¬¿y
();

437 
	`fÜ—ch
 (
$´štA»a
 
as
 
$´štA»aReù
) {

438 
$´štA»aReù
[0] = 
PHPExûl_C–l
::
	`absŞu‹Reã»nû
($printAreaRect[0]);

439 
$´štA»aReù
[1] = 
PHPExûl_C–l
::
	`absŞu‹Reã»nû
($printAreaRect[1]);

440 
$chunks
[] = '\'' . 
	`¡r_»¶aû
("'", "''", 
$pSh“t
->
	`g‘T™Ë
()è. '\'!' . 
	`im¶ode
(':', 
$´štA»aReù
);

443 
$objWr™”
->
	`wr™eRawD©a
(
	`im¶ode
(',', 
$chunks
));

445 
$objWr™”
->
	`’dEËm’t
();

447 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Worksheet.php

1 <?
php


36 şas 
	cPHPExûl_Wr™”_Exûl2007_WÜksh“t
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


47 
public
 
funùiÚ
 
	$wr™eWÜksh“t
(
$pSh“t
 = 
nuÎ
, 
$pSŒšgTabË
 =‚uÎ, 
$šşudeCh¬ts
 = 
çl£
)

49 ià(!
	`is_nuÎ
(
$pSh“t
)) {

51 
$objWr™”
 = 
nuÎ
;

52 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

53 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

55 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

59 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8', 'yes');

62 
$objWr™”
->
	`¡¬tEËm’t
('worksheet');

63 
$objWr™”
->
	`wr™eA‰ribu‹
('xml:space', 'preserve');

64 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');

65 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');

68 
$this
->
	`wr™eSh“tPr
(
$objWr™”
, 
$pSh“t
);

71 
$this
->
	`wr™eDim’siÚ
(
$objWr™”
, 
$pSh“t
);

74 
$this
->
	`wr™eSh“tV›ws
(
$objWr™”
, 
$pSh“t
);

77 
$this
->
	`wr™eSh“tFÜm©Pr
(
$objWr™”
, 
$pSh“t
);

80 
$this
->
	`wr™eCŞs
(
$objWr™”
, 
$pSh“t
);

83 
$this
->
	`wr™eSh“tD©a
(
$objWr™”
, 
$pSh“t
, 
$pSŒšgTabË
);

86 
$this
->
	`wr™eSh“tPrÙeùiÚ
(
$objWr™”
, 
$pSh“t
);

89 
$this
->
	`wr™ePrÙeùedRªges
(
$objWr™”
, 
$pSh“t
);

92 
$this
->
	`wr™eAutoF‹r
(
$objWr™”
, 
$pSh“t
);

95 
$this
->
	`wr™eM”geC–ls
(
$objWr™”
, 
$pSh“t
);

98 
$this
->
	`wr™eCÚd™iÚ®FÜm©tšg
(
$objWr™”
, 
$pSh“t
);

101 
$this
->
	`wr™eD©aV®id©iÚs
(
$objWr™”
, 
$pSh“t
);

104 
$this
->
	`wr™eHy³¾šks
(
$objWr™”
, 
$pSh“t
);

107 
$this
->
	`wr™ePrštO±iÚs
(
$objWr™”
, 
$pSh“t
);

110 
$this
->
	`wr™ePageM¬gšs
(
$objWr™”
, 
$pSh“t
);

113 
$this
->
	`wr™ePageS‘up
(
$objWr™”
, 
$pSh“t
);

116 
$this
->
	`wr™eH—d”FoÙ”
(
$objWr™”
, 
$pSh“t
);

119 
$this
->
	`wr™eB»aks
(
$objWr™”
, 
$pSh“t
);

122 
$this
->
	`wr™eD¿wšgs
(
$objWr™”
, 
$pSh“t
, 
$šşudeCh¬ts
);

125 
$this
->
	`wr™eLegacyD¿wšg
(
$objWr™”
, 
$pSh“t
);

128 
$this
->
	`wr™eLegacyD¿wšgHF
(
$objWr™”
, 
$pSh“t
);

130 
$objWr™”
->
	`’dEËm’t
();

133  
$objWr™”
->
	`g‘D©a
();

135 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Invalid PHPExcel_Worksheet object…assed.");

146 
´iv©e
 
funùiÚ
 
	$wr™eSh“tPr
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

149 
$objWr™”
->
	`¡¬tEËm’t
('sheetPr');

151 ià(
$pSh“t
->
	`g‘P¬’t
()->
	`hasMaüos
()) {

152 ià(
$pSh“t
->
	`hasCodeName
()==
çl£
) {

153 
$pSh“t
->
	`£tCodeName
($pSh“t->
	`g‘T™Ë
());

155 
$objWr™”
->
	`wr™eA‰ribu‹
('codeName', 
$pSh“t
->
	`g‘CodeName
());

157 
$autoF‹rRªge
 = 
$pSh“t
->
	`g‘AutoF‹r
()->
	`g‘Rªge
();

158 ià(!
	`em±y
(
$autoF‹rRªge
)) {

159 
$objWr™”
->
	`wr™eA‰ribu‹
('filterMode', 1);

160 
$pSh“t
->
	`g‘AutoF‹r
()->
	`showHideRows
();

164 ià(
$pSh“t
->
	`isTabCŞÜS‘
()) {

165 
$objWr™”
->
	`¡¬tEËm’t
('tabColor');

166 
$objWr™”
->
	`wr™eA‰ribu‹
('rgb', 
$pSh“t
->
	`g‘TabCŞÜ
()->
	`g‘ARGB
());

167 
$objWr™”
->
	`’dEËm’t
();

171 
$objWr™”
->
	`¡¬tEËm’t
('outlinePr');

172 
$objWr™”
->
	`wr™eA‰ribu‹
('summ¬yB–ow', (
$pSh“t
->
	`g‘ShowSumm¬yB–ow
() ? '1' : '0'));

173 
$objWr™”
->
	`wr™eA‰ribu‹
('summ¬yRight', (
$pSh“t
->
	`g‘ShowSumm¬yRight
() ? '1' : '0'));

174 
$objWr™”
->
	`’dEËm’t
();

177 ià(
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘F™ToPage
()) {

178 
$objWr™”
->
	`¡¬tEËm’t
('pageSetUpPr');

179 
$objWr™”
->
	`wr™eA‰ribu‹
('fitToPage', '1');

180 
$objWr™”
->
	`’dEËm’t
();

183 
$objWr™”
->
	`’dEËm’t
();

184 
	}
}

193 
´iv©e
 
funùiÚ
 
	$wr™eDim’siÚ
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

196 
$objWr™”
->
	`¡¬tEËm’t
('dimension');

197 
$objWr™”
->
	`wr™eA‰ribu‹
('»f', 
$pSh“t
->
	`ÿlcuÏ‹WÜksh“tDim’siÚ
());

198 
$objWr™”
->
	`’dEËm’t
();

199 
	}
}

208 
´iv©e
 
funùiÚ
 
	$wr™eSh“tV›ws
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

211 
$objWr™”
->
	`¡¬tEËm’t
('sheetViews');

214 
$sh“tS–eùed
 = 
çl£
;

215 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘PHPExûl
()->
	`g‘Index
(
$pSh“t
è=ğ$this->g‘P¬’tWr™”()->g‘PHPExûl()->
	`g‘AùiveSh“tIndex
()) {

216 
$sh“tS–eùed
 = 
Œue
;

220 
$objWr™”
->
	`¡¬tEËm’t
('sheetView');

221 
$objWr™”
->
	`wr™eA‰ribu‹
('bS–eùed', 
$sh“tS–eùed
 ? '1' : '0');

222 
$objWr™”
->
	`wr™eA‰ribu‹
('workbookViewId', '0');

225 ià(
$pSh“t
->
	`g‘Sh“tV›w
()->
	`g‘ZoomSÿË
() != 100) {

226 
$objWr™”
->
	`wr™eA‰ribu‹
('zoomSÿË', 
$pSh“t
->
	`g‘Sh“tV›w
()->
	`g‘ZoomSÿË
());

228 ià(
$pSh“t
->
	`g‘Sh“tV›w
()->
	`g‘ZoomSÿËNÜm®
() != 100) {

229 
$objWr™”
->
	`wr™eA‰ribu‹
('zoomSÿËNÜm®', 
$pSh“t
->
	`g‘Sh“tV›w
()->
	`g‘ZoomSÿËNÜm®
());

233 ià(
$pSh“t
->
	`g‘Sh“tV›w
()->
	`g‘V›w
(è!=ğ
PHPExûl_WÜksh“t_Sh“tV›w
::
SHEETVIEW_NORMAL
) {

234 
$objWr™”
->
	`wr™eA‰ribu‹
('v›w', 
$pSh“t
->
	`g‘Sh“tV›w
()->
	`g‘V›w
());

238 ià(
$pSh“t
->
	`g‘ShowGridlšes
()) {

239 
$objWr™”
->
	`wr™eA‰ribu‹
('showGridLines', 'true');

241 
$objWr™”
->
	`wr™eA‰ribu‹
('showGridLines', 'false');

245 ià(
$pSh“t
->
	`g‘ShowRowCŞH—d”s
()) {

246 
$objWr™”
->
	`wr™eA‰ribu‹
('showRowColHeaders', '1');

248 
$objWr™”
->
	`wr™eA‰ribu‹
('showRowColHeaders', '0');

252 ià(
$pSh“t
->
	`g‘RightToLeá
()) {

253 
$objWr™”
->
	`wr™eA‰ribu‹
('rightToLeft', 'true');

256 
$aùiveC–l
 = 
$pSh“t
->
	`g‘AùiveC–l
();

259 
$·Ã
 = '';

260 
$tİLeáC–l
 = 
$pSh“t
->
	`g‘F»ezePªe
();

261 ià((
$tİLeáC–l
 != '') && ($topLeftCell != 'A1')) {

262 
$aùiveC–l
 = 
$tİLeáC–l
;

264 
$xS¶™
 = 
$yS¶™
 = 0;

266 
	`li¡
(
$xS¶™
, 
$yS¶™
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$tİLeáC–l
);

267 
$xS¶™
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($xSplit);

270 
$·Ã
 = 'topRight';

271 
$objWr™”
->
	`¡¬tEËm’t
('pane');

272 ià(
$xS¶™
 > 1) {

273 
$objWr™”
->
	`wr™eA‰ribu‹
('xS¶™', 
$xS¶™
 - 1);

275 ià(
$yS¶™
 > 1) {

276 
$objWr™”
->
	`wr™eA‰ribu‹
('yS¶™', 
$yS¶™
 - 1);

277 
$·Ã
 = (
$xS¶™
 > 1) ? 'bottomRight' : 'bottomLeft';

279 
$objWr™”
->
	`wr™eA‰ribu‹
('tİLeáC–l', 
$tİLeáC–l
);

280 
$objWr™”
->
	`wr™eA‰ribu‹
('aùivePªe', 
$·Ã
);

281 
$objWr™”
->
	`wr™eA‰ribu‹
('state', 'frozen');

282 
$objWr™”
->
	`’dEËm’t
();

284 ià((
$xS¶™
 > 1è&& (
$yS¶™
 > 1)) {

286 
$objWr™”
->
	`¡¬tEËm’t
('selection');

287 
$objWr™”
->
	`wr™eA‰ribu‹
('pane', 'topRight');

288 
$objWr™”
->
	`’dEËm’t
();

289 
$objWr™”
->
	`¡¬tEËm’t
('selection');

290 
$objWr™”
->
	`wr™eA‰ribu‹
('pane', 'bottomLeft');

291 
$objWr™”
->
	`’dEËm’t
();

299 
$objWr™”
->
	`¡¬tEËm’t
('selection');

300 ià(
$·Ã
 != '') {

301 
$objWr™”
->
	`wr™eA‰ribu‹
('·Ã', 
$·Ã
);

303 
$objWr™”
->
	`wr™eA‰ribu‹
('aùiveC–l', 
$aùiveC–l
);

304 
$objWr™”
->
	`wr™eA‰ribu‹
('sq»f', 
$aùiveC–l
);

305 
$objWr™”
->
	`’dEËm’t
();

308 
$objWr™”
->
	`’dEËm’t
();

310 
$objWr™”
->
	`’dEËm’t
();

311 
	}
}

320 
´iv©e
 
funùiÚ
 
	$wr™eSh“tFÜm©Pr
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

323 
$objWr™”
->
	`¡¬tEËm’t
('sheetFormatPr');

326 ià(
$pSh“t
->
	`g‘DeçuÉRowDim’siÚ
()->
	`g‘RowHeight
() >= 0) {

327 
$objWr™”
->
	`wr™eA‰ribu‹
('customHeight', 'true');

328 
$objWr™”
->
	`wr™eA‰ribu‹
('deçuÉRowHeight', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘DeçuÉRowDim’siÚ
()->
	`g‘RowHeight
()));

330 
$objWr™”
->
	`wr™eA‰ribu‹
('defaultRowHeight', '14.4');

334 ià((
¡ršg
)
$pSh“t
->
	`g‘DeçuÉRowDim’siÚ
()->
	`g‘Z”oHeight
() == '1' ||

335 
	`¡¹Şow”
((
¡ršg
)
$pSh“t
->
	`g‘DeçuÉRowDim’siÚ
()->
	`g‘Z”oHeight
()) == 'true') {

336 
$objWr™”
->
	`wr™eA‰ribu‹
('zeroHeight', '1');

340 ià(
$pSh“t
->
	`g‘DeçuÉCŞumnDim’siÚ
()->
	`g‘Width
() >= 0) {

341 
$objWr™”
->
	`wr™eA‰ribu‹
('deçuÉCŞWidth', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘DeçuÉCŞumnDim’siÚ
()->
	`g‘Width
()));

345 
$oušeLev–Row
 = 0;

346 
	`fÜ—ch
 (
$pSh“t
->
	`g‘RowDim’siÚs
(è
as
 
$dim’siÚ
) {

347 ià(
$dim’siÚ
->
	`g‘OušeLev–
(è> 
$oušeLev–Row
) {

348 
$oušeLev–Row
 = 
$dim’siÚ
->
	`g‘OušeLev–
();

351 
$objWr™”
->
	`wr™eA‰ribu‹
('oušeLev–Row', ()
$oušeLev–Row
);

354 
$oušeLev–CŞ
 = 0;

355 
	`fÜ—ch
 (
$pSh“t
->
	`g‘CŞumnDim’siÚs
(è
as
 
$dim’siÚ
) {

356 ià(
$dim’siÚ
->
	`g‘OušeLev–
(è> 
$oušeLev–CŞ
) {

357 
$oušeLev–CŞ
 = 
$dim’siÚ
->
	`g‘OušeLev–
();

360 
$objWr™”
->
	`wr™eA‰ribu‹
('oušeLev–CŞ', ()
$oušeLev–CŞ
);

362 
$objWr™”
->
	`’dEËm’t
();

363 
	}
}

372 
´iv©e
 
funùiÚ
 
	$wr™eCŞs
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

375 ià(
	`couÁ
(
$pSh“t
->
	`g‘CŞumnDim’siÚs
()) > 0) {

376 
$objWr™”
->
	`¡¬tEËm’t
('cols');

378 
$pSh“t
->
	`ÿlcuÏ‹CŞumnWidths
();

381 
	`fÜ—ch
 (
$pSh“t
->
	`g‘CŞumnDim’siÚs
(è
as
 
$cŞDim’siÚ
) {

383 
$objWr™”
->
	`¡¬tEËm’t
('col');

384 
$objWr™”
->
	`wr™eA‰ribu‹
('mš', 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞDim’siÚ
->
	`g‘CŞumnIndex
()));

385 
$objWr™”
->
	`wr™eA‰ribu‹
('max', 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞDim’siÚ
->
	`g‘CŞumnIndex
()));

387 ià(
$cŞDim’siÚ
->
	`g‘Width
() < 0) {

389 
$objWr™”
->
	`wr™eA‰ribu‹
('width', '9.10');

392 
$objWr™”
->
	`wr™eA‰ribu‹
('width', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$cŞDim’siÚ
->
	`g‘Width
()));

396 ià(
$cŞDim’siÚ
->
	`g‘VisibË
(è=ğ
çl£
) {

397 
$objWr™”
->
	`wr™eA‰ribu‹
('hidden', 'true');

401 ià(
$cŞDim’siÚ
->
	`g‘AutoSize
()) {

402 
$objWr™”
->
	`wr™eA‰ribu‹
('bestFit', 'true');

406 ià(
$cŞDim’siÚ
->
	`g‘Width
(è!ğ
$pSh“t
->
	`g‘DeçuÉCŞumnDim’siÚ
()->getWidth()) {

407 
$objWr™”
->
	`wr™eA‰ribu‹
('customWidth', 'true');

411 ià(
$cŞDim’siÚ
->
	`g‘CŞÏp£d
(è=ğ
Œue
) {

412 
$objWr™”
->
	`wr™eA‰ribu‹
('collapsed', 'true');

416 ià(
$cŞDim’siÚ
->
	`g‘OušeLev–
() > 0) {

417 
$objWr™”
->
	`wr™eA‰ribu‹
('oušeLev–', 
$cŞDim’siÚ
->
	`g‘OušeLev–
());

421 
$objWr™”
->
	`wr™eA‰ribu‹
('¡yË', 
$cŞDim’siÚ
->
	`g‘XfIndex
());

423 
$objWr™”
->
	`’dEËm’t
();

426 
$objWr™”
->
	`’dEËm’t
();

428 
	}
}

437 
´iv©e
 
funùiÚ
 
	$wr™eSh“tPrÙeùiÚ
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

440 
$objWr™”
->
	`¡¬tEËm’t
('sheetProtection');

442 ià(
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘PasswÜd
() != '') {

443 
$objWr™”
->
	`wr™eA‰ribu‹
('·sswÜd', 
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘PasswÜd
());

446 
$objWr™”
->
	`wr™eA‰ribu‹
('sh“t', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘Sh“t
() ? 'true' : 'false'));

447 
$objWr™”
->
	`wr™eA‰ribu‹
('objeùs', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘Objeùs
() ? 'true' : 'false'));

448 
$objWr™”
->
	`wr™eA‰ribu‹
('sûÇrios', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘SûÇrios
() ? 'true' : 'false'));

449 
$objWr™”
->
	`wr™eA‰ribu‹
('fÜm©C–ls', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘FÜm©C–ls
() ? 'true' : 'false'));

450 
$objWr™”
->
	`wr™eA‰ribu‹
('fÜm©CŞumns', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘FÜm©CŞumns
() ? 'true' : 'false'));

451 
$objWr™”
->
	`wr™eA‰ribu‹
('fÜm©Rows', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘FÜm©Rows
() ? 'true' : 'false'));

452 
$objWr™”
->
	`wr™eA‰ribu‹
('š£¹CŞumns', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘In£¹CŞumns
() ? 'true' : 'false'));

453 
$objWr™”
->
	`wr™eA‰ribu‹
('š£¹Rows', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘In£¹Rows
() ? 'true' : 'false'));

454 
$objWr™”
->
	`wr™eA‰ribu‹
('š£¹Hy³¾šks', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘In£¹Hy³¾šks
() ? 'true' : 'false'));

455 
$objWr™”
->
	`wr™eA‰ribu‹
('d–‘eCŞumns', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘D–‘eCŞumns
() ? 'true' : 'false'));

456 
$objWr™”
->
	`wr™eA‰ribu‹
('d–‘eRows', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘D–‘eRows
() ? 'true' : 'false'));

457 
$objWr™”
->
	`wr™eA‰ribu‹
('£ËùLockedC–ls', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘S–eùLockedC–ls
() ? 'true' : 'false'));

458 
$objWr™”
->
	`wr™eA‰ribu‹
('sÜt', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘SÜt
() ? 'true' : 'false'));

459 
$objWr™”
->
	`wr™eA‰ribu‹
('autoF‹r', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘AutoF‹r
() ? 'true' : 'false'));

460 
$objWr™”
->
	`wr™eA‰ribu‹
('pivÙTabËs', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘PivÙTabËs
() ? 'true' : 'false'));

461 
$objWr™”
->
	`wr™eA‰ribu‹
('£ËùUÆockedC–ls', (
$pSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘S–eùUÆockedC–ls
() ? 'true' : 'false'));

462 
$objWr™”
->
	`’dEËm’t
();

463 
	}
}

472 
´iv©e
 
funùiÚ
 
	$wr™eCÚd™iÚ®FÜm©tšg
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

475 
$id
 = 1;

478 
	`fÜ—ch
 (
$pSh“t
->
	`g‘CÚd™iÚ®StyËsCŞËùiÚ
(è
as
 
$ûÎCoÜdš©e
 => 
$cÚd™iÚ®StyËs
) {

479 
	`fÜ—ch
 (
$cÚd™iÚ®StyËs
 
as
 
$cÚd™iÚ®
) {

484 ià(
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è!ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_NONE
) {

486 
$objWr™”
->
	`¡¬tEËm’t
('conditionalFormatting');

487 
$objWr™”
->
	`wr™eA‰ribu‹
('sq»f', 
$ûÎCoÜdš©e
);

490 
$objWr™”
->
	`¡¬tEËm’t
('cfRule');

491 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³', 
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
());

492 
$objWr™”
->
	`wr™eA‰ribu‹
('dxfId', 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘StyËsCÚd™iÚ®HashTabË
()->
	`g‘IndexFÜHashCode
(
$cÚd™iÚ®
->
	`g‘HashCode
()));

493 
$objWr™”
->
	`wr™eA‰ribu‹
('´iÜ™y', 
$id
++);

495 ià((
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CELLIS
 || $cÚd™iÚ®->g‘CÚd™iÚTy³(è=ğPHPExûl_StyË_CÚd™iÚ®::
CONDITION_CONTAINSTEXT
)

496 && 
$cÚd™iÚ®
->
	`g‘O³¿tÜTy³
(è!ğ
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_NONE
) {

497 
$objWr™”
->
	`wr™eA‰ribu‹
('İ”©Ü', 
$cÚd™iÚ®
->
	`g‘O³¿tÜTy³
());

500 ià(
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CONTAINSTEXT


501 && !
	`is_nuÎ
(
$cÚd™iÚ®
->
	`g‘Text
())) {

502 
$objWr™”
->
	`wr™eA‰ribu‹
('‹xt', 
$cÚd™iÚ®
->
	`g‘Text
());

505 ià(
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CONTAINSTEXT


506 && 
$cÚd™iÚ®
->
	`g‘O³¿tÜTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_CONTAINSTEXT


507 && !
	`is_nuÎ
(
$cÚd™iÚ®
->
	`g‘Text
())) {

508 
$objWr™”
->
	`wr™eEËm’t
('fÜmuÏ', 'NOT(ISERROR(SEARCH("' . 
$cÚd™iÚ®
->
	`g‘Text
(è. '",' . 
$ûÎCoÜdš©e
 . ')))');

509 } 
	`–£if
 (
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CONTAINSTEXT


510 && 
$cÚd™iÚ®
->
	`g‘O³¿tÜTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_BEGINSWITH


511 && !
	`is_nuÎ
(
$cÚd™iÚ®
->
	`g‘Text
())) {

512 
$objWr™”
->
	`wr™eEËm’t
('fÜmuÏ', 'LEFT(' . 
$ûÎCoÜdš©e
 . ',' . 
	`¡¾’
(
$cÚd™iÚ®
->
	`g‘Text
()) . ')="' . $conditional->getText() . '"');

513 } 
	`–£if
 (
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CONTAINSTEXT


514 && 
$cÚd™iÚ®
->
	`g‘O³¿tÜTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_ENDSWITH


515 && !
	`is_nuÎ
(
$cÚd™iÚ®
->
	`g‘Text
())) {

516 
$objWr™”
->
	`wr™eEËm’t
('fÜmuÏ', 'RIGHT(' . 
$ûÎCoÜdš©e
 . ',' . 
	`¡¾’
(
$cÚd™iÚ®
->
	`g‘Text
()) . ')="' . $conditional->getText() . '"');

517 } 
	`–£if
 (
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CONTAINSTEXT


518 && 
$cÚd™iÚ®
->
	`g‘O³¿tÜTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_NOTCONTAINS


519 && !
	`is_nuÎ
(
$cÚd™iÚ®
->
	`g‘Text
())) {

520 
$objWr™”
->
	`wr™eEËm’t
('fÜmuÏ', 'ISERROR(SEARCH("' . 
$cÚd™iÚ®
->
	`g‘Text
(è. '",' . 
$ûÎCoÜdš©e
 . '))');

521 } 
	`–£if
 (
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CELLIS


522 || 
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CONTAINSTEXT


523 || 
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_EXPRESSION
) {

524 
	`fÜ—ch
 (
$cÚd™iÚ®
->
	`g‘CÚd™iÚs
(è
as
 
$fÜmuÏ
) {

526 
$objWr™”
->
	`wr™eEËm’t
('fÜmuÏ', 
$fÜmuÏ
);

530 
$objWr™”
->
	`’dEËm’t
();

532 
$objWr™”
->
	`’dEËm’t
();

536 
	}
}

545 
´iv©e
 
funùiÚ
 
	$wr™eD©aV®id©iÚs
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

548 
$d©aV®id©iÚCŞËùiÚ
 = 
$pSh“t
->
	`g‘D©aV®id©iÚCŞËùiÚ
();

551 ià(!
	`em±y
(
$d©aV®id©iÚCŞËùiÚ
)) {

552 
$objWr™”
->
	`¡¬tEËm’t
('dataValidations');

553 
$objWr™”
->
	`wr™eA‰ribu‹
('couÁ', 
	`couÁ
(
$d©aV®id©iÚCŞËùiÚ
));

555 
	`fÜ—ch
 (
$d©aV®id©iÚCŞËùiÚ
 
as
 
$coÜdš©e
 => 
$dv
) {

556 
$objWr™”
->
	`¡¬tEËm’t
('dataValidation');

558 ià(
$dv
->
	`g‘Ty³
() != '') {

559 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³', 
$dv
->
	`g‘Ty³
());

562 ià(
$dv
->
	`g‘E¼ÜStyË
() != '') {

563 
$objWr™”
->
	`wr™eA‰ribu‹
('”rÜStyË', 
$dv
->
	`g‘E¼ÜStyË
());

566 ià(
$dv
->
	`g‘O³¿tÜ
() != '') {

567 
$objWr™”
->
	`wr™eA‰ribu‹
('İ”©Ü', 
$dv
->
	`g‘O³¿tÜ
());

570 
$objWr™”
->
	`wr™eA‰ribu‹
('®lowBÏnk', (
$dv
->
	`g‘AÎowBÏnk
() ? '1' : '0'));

571 
$objWr™”
->
	`wr™eA‰ribu‹
('showDrİDown', (!
$dv
->
	`g‘ShowDrİDown
() ? '1' : '0'));

572 
$objWr™”
->
	`wr™eA‰ribu‹
('showIÅutMes§ge', (
$dv
->
	`g‘ShowIÅutMes§ge
() ? '1' : '0'));

573 
$objWr™”
->
	`wr™eA‰ribu‹
('showE¼ÜMes§ge', (
$dv
->
	`g‘ShowE¼ÜMes§ge
() ? '1' : '0'));

575 ià(
$dv
->
	`g‘E¼ÜT™Ë
() !== '') {

576 
$objWr™”
->
	`wr™eA‰ribu‹
('”rÜT™Ë', 
$dv
->
	`g‘E¼ÜT™Ë
());

578 ià(
$dv
->
	`g‘E¼Ü
() !== '') {

579 
$objWr™”
->
	`wr™eA‰ribu‹
('”rÜ', 
$dv
->
	`g‘E¼Ü
());

581 ià(
$dv
->
	`g‘Prom±T™Ë
() !== '') {

582 
$objWr™”
->
	`wr™eA‰ribu‹
('´om±T™Ë', 
$dv
->
	`g‘Prom±T™Ë
());

584 ià(
$dv
->
	`g‘Prom±
() !== '') {

585 
$objWr™”
->
	`wr™eA‰ribu‹
('´om±', 
$dv
->
	`g‘Prom±
());

588 
$objWr™”
->
	`wr™eA‰ribu‹
('sq»f', 
$coÜdš©e
);

590 ià(
$dv
->
	`g‘FÜmuÏ1
() !== '') {

591 
$objWr™”
->
	`wr™eEËm’t
('fÜmuÏ1', 
$dv
->
	`g‘FÜmuÏ1
());

593 ià(
$dv
->
	`g‘FÜmuÏ2
() !== '') {

594 
$objWr™”
->
	`wr™eEËm’t
('fÜmuÏ2', 
$dv
->
	`g‘FÜmuÏ2
());

597 
$objWr™”
->
	`’dEËm’t
();

600 
$objWr™”
->
	`’dEËm’t
();

602 
	}
}

611 
´iv©e
 
funùiÚ
 
	$wr™eHy³¾šks
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

614 
$hy³¾škCŞËùiÚ
 = 
$pSh“t
->
	`g‘Hy³¾škCŞËùiÚ
();

617 
$»ÏtiÚId
 = 1;

620 ià(!
	`em±y
(
$hy³¾škCŞËùiÚ
)) {

621 
$objWr™”
->
	`¡¬tEËm’t
('hyperlinks');

623 
	`fÜ—ch
 (
$hy³¾škCŞËùiÚ
 
as
 
$coÜdš©e
 => 
$hy³¾šk
) {

624 
$objWr™”
->
	`¡¬tEËm’t
('hyperlink');

626 
$objWr™”
->
	`wr™eA‰ribu‹
('»f', 
$coÜdš©e
);

627 ià(!
$hy³¾šk
->
	`isIÁ”Çl
()) {

628 
$objWr™”
->
	`wr™eA‰ribu‹
('r:id', 'rId_hy³¾šk_' . 
$»ÏtiÚId
);

629 ++
$»ÏtiÚId
;

631 
$objWr™”
->
	`wr™eA‰ribu‹
('loÿtiÚ', 
	`¡r_»¶aû
('sh“t://', '', 
$hy³¾šk
->
	`g‘U¾
()));

634 ià(
$hy³¾šk
->
	`g‘ToŞt
() != '') {

635 
$objWr™”
->
	`wr™eA‰ribu‹
('toŞt', 
$hy³¾šk
->
	`g‘ToŞt
());

638 
$objWr™”
->
	`’dEËm’t
();

641 
$objWr™”
->
	`’dEËm’t
();

643 
	}
}

652 
´iv©e
 
funùiÚ
 
	$wr™ePrÙeùedRªges
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

654 ià(
	`couÁ
(
$pSh“t
->
	`g‘PrÙeùedC–ls
()) > 0) {

656 
$objWr™”
->
	`¡¬tEËm’t
('protectedRanges');

659 
	`fÜ—ch
 (
$pSh“t
->
	`g‘PrÙeùedC–ls
(è
as
 
$´ÙeùedC–l
 => 
$·sswÜdHash
) {

661 
$objWr™”
->
	`¡¬tEËm’t
('protectedRange');

662 
$objWr™”
->
	`wr™eA‰ribu‹
('Çme', 'p' . 
	`md5
(
$´ÙeùedC–l
));

663 
$objWr™”
->
	`wr™eA‰ribu‹
('sq»f', 
$´ÙeùedC–l
);

664 ià(!
	`em±y
(
$·sswÜdHash
)) {

665 
$objWr™”
->
	`wr™eA‰ribu‹
('·sswÜd', 
$·sswÜdHash
);

667 
$objWr™”
->
	`’dEËm’t
();

670 
$objWr™”
->
	`’dEËm’t
();

672 
	}
}

681 
´iv©e
 
funùiÚ
 
	$wr™eM”geC–ls
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

683 ià(
	`couÁ
(
$pSh“t
->
	`g‘M”geC–ls
()) > 0) {

685 
$objWr™”
->
	`¡¬tEËm’t
('mergeCells');

688 
	`fÜ—ch
 (
$pSh“t
->
	`g‘M”geC–ls
(è
as
 
$m”geC–l
) {

690 
$objWr™”
->
	`¡¬tEËm’t
('mergeCell');

691 
$objWr™”
->
	`wr™eA‰ribu‹
('»f', 
$m”geC–l
);

692 
$objWr™”
->
	`’dEËm’t
();

695 
$objWr™”
->
	`’dEËm’t
();

697 
	}
}

706 
´iv©e
 
funùiÚ
 
	$wr™ePrštO±iÚs
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

709 
$objWr™”
->
	`¡¬tEËm’t
('printOptions');

711 
$objWr™”
->
	`wr™eA‰ribu‹
('gridLšes', (
$pSh“t
->
	`g‘PrštGridlšes
() ? 'true': 'false'));

712 
$objWr™”
->
	`wr™eA‰ribu‹
('gridLinesSet', 'true');

714 ià(
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘HÜizÚlC’‹»d
()) {

715 
$objWr™”
->
	`wr™eA‰ribu‹
('horizontalCentered', 'true');

718 ià(
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘V”tiÿlC’‹»d
()) {

719 
$objWr™”
->
	`wr™eA‰ribu‹
('verticalCentered', 'true');

722 
$objWr™”
->
	`’dEËm’t
();

723 
	}
}

732 
´iv©e
 
funùiÚ
 
	$wr™ePageM¬gšs
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

735 
$objWr™”
->
	`¡¬tEËm’t
('pageMargins');

736 
$objWr™”
->
	`wr™eA‰ribu‹
('Ëá', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘PageM¬gšs
()->
	`g‘Leá
()));

737 
$objWr™”
->
	`wr™eA‰ribu‹
('right', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘PageM¬gšs
()->
	`g‘Right
()));

738 
$objWr™”
->
	`wr™eA‰ribu‹
('tİ', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘PageM¬gšs
()->
	`g‘Tİ
()));

739 
$objWr™”
->
	`wr™eA‰ribu‹
('bÙtom', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘PageM¬gšs
()->
	`g‘BÙtom
()));

740 
$objWr™”
->
	`wr™eA‰ribu‹
('h—d”', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘PageM¬gšs
()->
	`g‘H—d”
()));

741 
$objWr™”
->
	`wr™eA‰ribu‹
('foÙ”', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘PageM¬gšs
()->
	`g‘FoÙ”
()));

742 
$objWr™”
->
	`’dEËm’t
();

743 
	}
}

752 
´iv©e
 
funùiÚ
 
	$wr™eAutoF‹r
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

754 
$autoF‹rRªge
 = 
$pSh“t
->
	`g‘AutoF‹r
()->
	`g‘Rªge
();

755 ià(!
	`em±y
(
$autoF‹rRªge
)) {

757 
$objWr™”
->
	`¡¬tEËm’t
('autoFilter');

760 
$¿nge
 = 
PHPExûl_C–l
::
	`¥l™Rªge
(
$autoF‹rRªge
);

761 
$¿nge
 = $range[0];

763 ià(
	`¡½os
(
$¿nge
[0], '!'è!=ğ
çl£
) {

764 
	`li¡
(
$ws
, 
$¿nge
[0]èğ
	`ex¶ode
('!', $range[0]);

766 
$¿nge
 = 
	`im¶ode
(':', $range);

768 
$objWr™”
->
	`wr™eA‰ribu‹
('»f', 
	`¡r_»¶aû
('$', '', 
$¿nge
));

770 
$cŞumns
 = 
$pSh“t
->
	`g‘AutoF‹r
()->
	`g‘CŞumns
();

771 ià(
	`couÁ
(
$cŞumns
 > 0)) {

772 
	`fÜ—ch
 (
$cŞumns
 
as
 
$cŞumnID
 => 
$cŞumn
) {

773 
$ruËs
 = 
$cŞumn
->
	`g‘RuËs
();

774 ià(
	`couÁ
(
$ruËs
) > 0) {

775 
$objWr™”
->
	`¡¬tEËm’t
('filterColumn');

776 
$objWr™”
->
	`wr™eA‰ribu‹
('cŞId', 
$pSh“t
->
	`g‘AutoF‹r
()->
	`g‘CŞumnOff£t
(
$cŞumnID
));

778 
$objWr™”
->
	`¡¬tEËm’t
(
$cŞumn
->
	`g‘F‹rTy³
());

779 ià(
$cŞumn
->
	`g‘Još
(è=ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_COLUMN_JOIN_AND
) {

780 
$objWr™”
->
	`wr™eA‰ribu‹
('and', 1);

783 
	`fÜ—ch
 (
$ruËs
 
as
 
$ruË
) {

784 ià((
$cŞumn
->
	`g‘F‹rTy³
(è==ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn
::
AUTOFILTER_FILTERTYPE_FILTER
) &&

785 (
$ruË
->
	`g‘O³¿tÜ
(è==ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_EQUAL
) &&

786 (
$ruË
->
	`g‘V®ue
() === '')) {

788 
$objWr™”
->
	`wr™eA‰ribu‹
('blank', 1);

789 } 
	`–£if
 (
$ruË
->
	`g‘RuËTy³
(è==ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DYNAMICFILTER
) {

791 
$objWr™”
->
	`wr™eA‰ribu‹
('ty³', 
$ruË
->
	`g‘Groupšg
());

792 
$v®
 = 
$cŞumn
->
	`g‘A‰ribu‹
('val');

793 ià(
$v®
 !=ğ
nuÎ
) {

794 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$v®
);

796 
$maxV®
 = 
$cŞumn
->
	`g‘A‰ribu‹
('maxVal');

797 ià(
$maxV®
 !=ğ
nuÎ
) {

798 
$objWr™”
->
	`wr™eA‰ribu‹
('maxV®', 
$maxV®
);

800 } 
	`–£if
 (
$ruË
->
	`g‘RuËTy³
(è==ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_TOPTENFILTER
) {

802 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$ruË
->
	`g‘V®ue
());

803 
$objWr™”
->
	`wr™eA‰ribu‹
('³rûÁ', ((
$ruË
->
	`g‘O³¿tÜ
(è==ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_TOPTEN_PERCENT
) ? '1' : '0'));

804 
$objWr™”
->
	`wr™eA‰ribu‹
('tİ', ((
$ruË
->
	`g‘Groupšg
(è==ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_TOPTEN_TOP
) ? '1': '0'));

807 
$objWr™”
->
	`¡¬tEËm’t
(
$ruË
->
	`g‘RuËTy³
());

809 ià(
$ruË
->
	`g‘O³¿tÜ
(è!=ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_COLUMN_RULE_EQUAL
) {

810 
$objWr™”
->
	`wr™eA‰ribu‹
('İ”©Ü', 
$ruË
->
	`g‘O³¿tÜ
());

812 ià(
$ruË
->
	`g‘RuËTy³
(è==ğ
PHPExûl_WÜksh“t_AutoF‹r_CŞumn_RuË
::
AUTOFILTER_RULETYPE_DATEGROUP
) {

814 
	`fÜ—ch
 (
$ruË
->
	`g‘V®ue
(è
as
 
$key
 => 
$v®ue
) {

815 ià(
$v®ue
 > '') {

816 
$objWr™”
->
	`wr™eA‰ribu‹
(
$key
, 
$v®ue
);

819 
$objWr™”
->
	`wr™eA‰ribu‹
('d©eTimeGroupšg', 
$ruË
->
	`g‘Groupšg
());

821 
$objWr™”
->
	`wr™eA‰ribu‹
('v®', 
$ruË
->
	`g‘V®ue
());

824 
$objWr™”
->
	`’dEËm’t
();

828 
$objWr™”
->
	`’dEËm’t
();

830 
$objWr™”
->
	`’dEËm’t
();

834 
$objWr™”
->
	`’dEËm’t
();

836 
	}
}

845 
´iv©e
 
funùiÚ
 
	$wr™ePageS‘up
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

848 
$objWr™”
->
	`¡¬tEËm’t
('pageSetup');

849 
$objWr™”
->
	`wr™eA‰ribu‹
('·³rSize', 
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘P­”Size
());

850 
$objWr™”
->
	`wr™eA‰ribu‹
('Ü›Á©iÚ', 
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘Or›Á©iÚ
());

852 ià(!
	`is_nuÎ
(
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘SÿË
())) {

853 
$objWr™”
->
	`wr™eA‰ribu‹
('sÿË', 
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘SÿË
());

855 ià(!
	`is_nuÎ
(
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘F™ToHeight
())) {

856 
$objWr™”
->
	`wr™eA‰ribu‹
('f™ToHeight', 
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘F™ToHeight
());

858 
$objWr™”
->
	`wr™eA‰ribu‹
('fitToHeight', '0');

860 ià(!
	`is_nuÎ
(
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘F™ToWidth
())) {

861 
$objWr™”
->
	`wr™eA‰ribu‹
('f™ToWidth', 
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘F™ToWidth
());

863 
$objWr™”
->
	`wr™eA‰ribu‹
('fitToWidth', '0');

865 ià(!
	`is_nuÎ
(
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘Fœ¡PageNumb”
())) {

866 
$objWr™”
->
	`wr™eA‰ribu‹
('fœ¡PageNumb”', 
$pSh“t
->
	`g‘PageS‘up
()->
	`g‘Fœ¡PageNumb”
());

867 
$objWr™”
->
	`wr™eA‰ribu‹
('useFirstPageNumber', '1');

870 
$objWr™”
->
	`’dEËm’t
();

871 
	}
}

880 
´iv©e
 
funùiÚ
 
	$wr™eH—d”FoÙ”
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

883 
$objWr™”
->
	`¡¬tEËm’t
('headerFooter');

884 
$objWr™”
->
	`wr™eA‰ribu‹
('difã»ÁOddEv’', (
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘Difã»ÁOddEv’
() ? 'true' : 'false'));

885 
$objWr™”
->
	`wr™eA‰ribu‹
('difã»ÁFœ¡', (
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘Difã»ÁFœ¡
() ? 'true' : 'false'));

886 
$objWr™”
->
	`wr™eA‰ribu‹
('sÿËW™hDoc', (
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘SÿËW™hDocum’t
() ? 'true' : 'false'));

887 
$objWr™”
->
	`wr™eA‰ribu‹
('®ignW™hM¬gšs', (
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘AlignW™hM¬gšs
() ? 'true' : 'false'));

889 
$objWr™”
->
	`wr™eEËm’t
('oddH—d”', 
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘OddH—d”
());

890 
$objWr™”
->
	`wr™eEËm’t
('oddFoÙ”', 
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘OddFoÙ”
());

891 
$objWr™”
->
	`wr™eEËm’t
('ev’H—d”', 
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘Ev’H—d”
());

892 
$objWr™”
->
	`wr™eEËm’t
('ev’FoÙ”', 
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘Ev’FoÙ”
());

893 
$objWr™”
->
	`wr™eEËm’t
('fœ¡H—d”', 
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘Fœ¡H—d”
());

894 
$objWr™”
->
	`wr™eEËm’t
('fœ¡FoÙ”', 
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘Fœ¡FoÙ”
());

895 
$objWr™”
->
	`’dEËm’t
();

896 
	}
}

905 
´iv©e
 
funùiÚ
 
	$wr™eB»aks
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

908 
$aRowB»aks
 = 
	`¬¿y
();

909 
$aCŞumnB»aks
 = 
	`¬¿y
();

910 
	`fÜ—ch
 (
$pSh“t
->
	`g‘B»aks
(è
as
 
$ûÎ
 => 
$b»akTy³
) {

911 ià(
$b»akTy³
 =ğ
PHPExûl_WÜksh“t
::
BREAK_ROW
) {

912 
$aRowB»aks
[] = 
$ûÎ
;

913 } 
	`–£if
 (
$b»akTy³
 =ğ
PHPExûl_WÜksh“t
::
BREAK_COLUMN
) {

914 
$aCŞumnB»aks
[] = 
$ûÎ
;

919 ià(!
	`em±y
(
$aRowB»aks
)) {

920 
$objWr™”
->
	`¡¬tEËm’t
('rowBreaks');

921 
$objWr™”
->
	`wr™eA‰ribu‹
('couÁ', 
	`couÁ
(
$aRowB»aks
));

922 
$objWr™”
->
	`wr™eA‰ribu‹
('mªu®B»akCouÁ', 
	`couÁ
(
$aRowB»aks
));

924 
	`fÜ—ch
 (
$aRowB»aks
 
as
 
$ûÎ
) {

925 
$coÜds
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$ûÎ
);

927 
$objWr™”
->
	`¡¬tEËm’t
('brk');

928 
$objWr™”
->
	`wr™eA‰ribu‹
('id', 
$coÜds
[1]);

929 
$objWr™”
->
	`wr™eA‰ribu‹
('man', '1');

930 
$objWr™”
->
	`’dEËm’t
();

933 
$objWr™”
->
	`’dEËm’t
();

937 ià(!
	`em±y
(
$aCŞumnB»aks
)) {

938 
$objWr™”
->
	`¡¬tEËm’t
('colBreaks');

939 
$objWr™”
->
	`wr™eA‰ribu‹
('couÁ', 
	`couÁ
(
$aCŞumnB»aks
));

940 
$objWr™”
->
	`wr™eA‰ribu‹
('mªu®B»akCouÁ', 
	`couÁ
(
$aCŞumnB»aks
));

942 
	`fÜ—ch
 (
$aCŞumnB»aks
 
as
 
$ûÎ
) {

943 
$coÜds
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$ûÎ
);

945 
$objWr™”
->
	`¡¬tEËm’t
('brk');

946 
$objWr™”
->
	`wr™eA‰ribu‹
('id', 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$coÜds
[0]) - 1);

947 
$objWr™”
->
	`wr™eA‰ribu‹
('man', '1');

948 
$objWr™”
->
	`’dEËm’t
();

951 
$objWr™”
->
	`’dEËm’t
();

953 
	}
}

963 
´iv©e
 
funùiÚ
 
	$wr™eSh“tD©a
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚uÎ, 
$pSŒšgTabË
 =‚ull)

965 ià(
	`is_¬¿y
(
$pSŒšgTabË
)) {

967 
$aFl³dSŒšgTabË
 = 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘Wr™”P¬t
('¡ršgbË')->
	`æSŒšgTabË
(
$pSŒšgTabË
);

970 
$objWr™”
->
	`¡¬tEËm’t
('sheetData');

973 
$cŞCouÁ
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$pSh“t
->
	`g‘Highe¡CŞumn
());

976 
$highe¡Row
 = 
$pSh“t
->
	`g‘Highe¡Row
();

979 
$ûÎsByRow
 = 
	`¬¿y
();

980 
	`fÜ—ch
 (
$pSh“t
->
	`g‘C–lCŞËùiÚ
(è
as
 
$ûÎID
) {

981 
$ûÎAdd»ss
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$ûÎID
);

982 
$ûÎsByRow
[
$ûÎAdd»ss
[1]][] = 
$ûÎID
;

985 
$cu¼’tRow
 = 0;

986 
$cu¼’tRow
++ < 
$highe¡Row
) {

988 
$rowDim’siÚ
 = 
$pSh“t
->
	`g‘RowDim’siÚ
(
$cu¼’tRow
);

991 
$wr™eCu¼’tRow
 = 
	`is£t
(
$ûÎsByRow
[
$cu¼’tRow
]è|| 
$rowDim’siÚ
->
	`g‘RowHeight
(è>ğ0 || $rowDim’siÚ->
	`g‘VisibË
(è=ğ
çl£
 || $rowDim’siÚ->
	`g‘CŞÏp£d
(è=ğ
Œue
 || $rowDim’siÚ->
	`g‘OušeLev–
(è> 0 || $rowDim’siÚ->
	`g‘XfIndex
(è!=ğ
nuÎ
;

993 ià(
$wr™eCu¼’tRow
) {

995 
$objWr™”
->
	`¡¬tEËm’t
('row');

996 
$objWr™”
->
	`wr™eA‰ribu‹
('r', 
$cu¼’tRow
);

997 
$objWr™”
->
	`wr™eA‰ribu‹
('¥ªs', '1:' . 
$cŞCouÁ
);

1000 ià(
$rowDim’siÚ
->
	`g‘RowHeight
() >= 0) {

1001 
$objWr™”
->
	`wr™eA‰ribu‹
('customHeight', '1');

1002 
$objWr™”
->
	`wr™eA‰ribu‹
('ht', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$rowDim’siÚ
->
	`g‘RowHeight
()));

1006 ià(
$rowDim’siÚ
->
	`g‘VisibË
(è=ğ
çl£
) {

1007 
$objWr™”
->
	`wr™eA‰ribu‹
('hidden', 'true');

1011 ià(
$rowDim’siÚ
->
	`g‘CŞÏp£d
(è=ğ
Œue
) {

1012 
$objWr™”
->
	`wr™eA‰ribu‹
('collapsed', 'true');

1016 ià(
$rowDim’siÚ
->
	`g‘OušeLev–
() > 0) {

1017 
$objWr™”
->
	`wr™eA‰ribu‹
('oušeLev–', 
$rowDim’siÚ
->
	`g‘OušeLev–
());

1021 ià(
$rowDim’siÚ
->
	`g‘XfIndex
(è!=ğ
nuÎ
) {

1022 
$objWr™”
->
	`wr™eA‰ribu‹
('s', 
$rowDim’siÚ
->
	`g‘XfIndex
());

1023 
$objWr™”
->
	`wr™eA‰ribu‹
('customFormat', '1');

1027 ià(
	`is£t
(
$ûÎsByRow
[
$cu¼’tRow
])) {

1028 
	`fÜ—ch
 (
$ûÎsByRow
[
$cu¼’tRow
] 
as
 
$ûÎAdd»ss
) {

1030 
$this
->
	`wr™eC–l
(
$objWr™”
, 
$pSh“t
, 
$ûÎAdd»ss
, 
$pSŒšgTabË
, 
$aFl³dSŒšgTabË
);

1035 
$objWr™”
->
	`’dEËm’t
();

1039 
$objWr™”
->
	`’dEËm’t
();

1041 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Invalid…arameters…assed.");

1043 
	}
}

1055 
´iv©e
 
funùiÚ
 
	$wr™eC–l
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚uÎ, 
$pC–lAdd»ss
 =‚uÎ, 
$pSŒšgTabË
 =‚uÎ, 
$pFl³dSŒšgTabË
 =‚ull)

1057 ià(
	`is_¬¿y
(
$pSŒšgTabË
è&& is_¬¿y(
$pFl³dSŒšgTabË
)) {

1059 
$pC–l
 = 
$pSh“t
->
	`g‘C–l
(
$pC–lAdd»ss
);

1060 
$objWr™”
->
	`¡¬tEËm’t
('c');

1061 
$objWr™”
->
	`wr™eA‰ribu‹
('r', 
$pC–lAdd»ss
);

1064 ià(
$pC–l
->
	`g‘XfIndex
() != '') {

1065 
$objWr™”
->
	`wr™eA‰ribu‹
('s', 
$pC–l
->
	`g‘XfIndex
());

1069 
$ûÎV®ue
 = 
$pC–l
->
	`g‘V®ue
();

1070 ià(
	`is_objeù
(
$ûÎV®ue
) || $cellValue !== '') {

1072 
$m­³dTy³
 = 
$pC–l
->
	`g‘D©aTy³
();

1075 
	`¡¹Şow”
(
$m­³dTy³
)) {

1079 
$objWr™”
->
	`wr™eA‰ribu‹
('t', 
$m­³dTy³
);

1082 
$ÿlcuÏ‹dV®ue
 = (
$this
->
	`g‘P¬’tWr™”
()->
	`g‘P»C®cuÏ‹FÜmuÏs
()) ?

1083 
$pC–l
->
	`g‘C®cuÏ‹dV®ue
() :

1084 
$ûÎV®ue
;

1085 ià(
	`is_¡ršg
(
$ÿlcuÏ‹dV®ue
)) {

1086 
$objWr™”
->
	`wr™eA‰ribu‹
('t', 'str');

1090 
$objWr™”
->
	`wr™eA‰ribu‹
('t', 
$m­³dTy³
);

1094 
	`¡¹Şow”
(
$m­³dTy³
)) {

1096 ià(! 
$ûÎV®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

1097 
$objWr™”
->
	`wr™eEËm’t
('t', 
PHPExûl_Sh¬ed_SŒšg
::
	`CÚŒŞCh¬aù”PHP2OOXML
(
	`html¥ecŸlch¬s
(
$ûÎV®ue
)));

1098 } 
	`–£if
 (
$ûÎV®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

1099 
$objWr™”
->
	`¡¬tEËm’t
('is');

1100 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘Wr™”P¬t
('¡ršgbË')->
	`wr™eRichText
(
$objWr™”
, 
$ûÎV®ue
);

1101 
$objWr™”
->
	`’dEËm’t
();

1106 ià(! 
$ûÎV®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

1107 ià(
	`is£t
(
$pFl³dSŒšgTabË
[
$ûÎV®ue
])) {

1108 
$objWr™”
->
	`wr™eEËm’t
('v', 
$pFl³dSŒšgTabË
[
$ûÎV®ue
]);

1110 } 
	`–£if
 (
$ûÎV®ue
 
š¡ªûof
 
PHPExûl_RichText
) {

1111 
$objWr™”
->
	`wr™eEËm’t
('v', 
$pFl³dSŒšgTabË
[
$ûÎV®ue
->
	`g‘HashCode
()]);

1116 
$©Œibu‹s
 = 
$pC–l
->
	`g‘FÜmuÏA‰ribu‹s
();

1117 ià(
$©Œibu‹s
['t'] == 'array') {

1118 
$objWr™”
->
	`¡¬tEËm’t
('f');

1119 
$objWr™”
->
	`wr™eA‰ribu‹
('t', 'array');

1120 
$objWr™”
->
	`wr™eA‰ribu‹
('»f', 
$pC–lAdd»ss
);

1121 
$objWr™”
->
	`wr™eA‰ribu‹
('aca', '1');

1122 
$objWr™”
->
	`wr™eA‰ribu‹
('ca', '1');

1123 
$objWr™”
->
	`‹xt
(
	`sub¡r
(
$ûÎV®ue
, 1));

1124 
$objWr™”
->
	`’dEËm’t
();

1126 
$objWr™”
->
	`wr™eEËm’t
('f', 
	`sub¡r
(
$ûÎV®ue
, 1));

1128 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘Offiû2003Com·tib™y
(è==ğ
çl£
) {

1129 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘P»C®cuÏ‹FÜmuÏs
()) {

1131 ià(!
	`is_¬¿y
(
$ÿlcuÏ‹dV®ue
è&& 
	`sub¡r
($calculatedValue, 0, 1) != '#') {

1132 
$objWr™”
->
	`wr™eEËm’t
('v', 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$ÿlcuÏ‹dV®ue
));

1134 
$objWr™”
->
	`wr™eEËm’t
('v', '0');

1137 
$objWr™”
->
	`wr™eEËm’t
('v', '0');

1143 
$objWr™”
->
	`wr™eEËm’t
('v', 
	`¡r_»¶aû
(',', '.', 
$ûÎV®ue
));

1146 
$objWr™”
->
	`wr™eEËm’t
('v', (
$ûÎV®ue
 ? '1' : '0'));

1149 ià(
	`sub¡r
(
$ûÎV®ue
, 0, 1) == '=') {

1150 
$objWr™”
->
	`wr™eEËm’t
('f', 
	`sub¡r
(
$ûÎV®ue
, 1));

1151 
$objWr™”
->
	`wr™eEËm’t
('v', 
	`sub¡r
(
$ûÎV®ue
, 1));

1153 
$objWr™”
->
	`wr™eEËm’t
('v', 
$ûÎV®ue
);

1160 
$objWr™”
->
	`’dEËm’t
();

1162 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Invalid…arameters…assed.");

1164 
	}
}

1174 
´iv©e
 
funùiÚ
 
	$wr™eD¿wšgs
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚uÎ, 
$šşudeCh¬ts
 = 
çl£
)

1176 
$ch¬tCouÁ
 = (
$šşudeCh¬ts
è? 
$pSh“t
->
	`g‘Ch¬tCŞËùiÚ
()->
	`couÁ
() : 0;

1178 ià((
$pSh“t
->
	`g‘D¿wšgCŞËùiÚ
()->
	`couÁ
() > 0) ||

1179 (
$ch¬tCouÁ
 > 0)) {

1180 
$objWr™”
->
	`¡¬tEËm’t
('drawing');

1181 
$objWr™”
->
	`wr™eA‰ribu‹
('r:id', 'rId1');

1182 
$objWr™”
->
	`’dEËm’t
();

1184 
	}
}

1193 
´iv©e
 
funùiÚ
 
	$wr™eLegacyD¿wšg
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

1196 ià(
	`couÁ
(
$pSh“t
->
	`g‘Comm’ts
()) > 0) {

1197 
$objWr™”
->
	`¡¬tEËm’t
('legacyDrawing');

1198 
$objWr™”
->
	`wr™eA‰ribu‹
('r:id', 'rId_comments_vml1');

1199 
$objWr™”
->
	`’dEËm’t
();

1201 
	}
}

1210 
´iv©e
 
funùiÚ
 
	$wr™eLegacyD¿wšgHF
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
 = 
nuÎ
, 
PHPExûl_WÜksh“t
 
$pSh“t
 =‚ull)

1213 ià(
	`couÁ
(
$pSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘Images
()) > 0) {

1214 
$objWr™”
->
	`¡¬tEËm’t
('legacyDrawingHF');

1215 
$objWr™”
->
	`wr™eA‰ribu‹
('r:id', 'rId_headerfooter_vml1');

1216 
$objWr™”
->
	`’dEËm’t
();

1218 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/WriterPart.php

1 <?
php


28 
ab¡¿ù
 cÏs 
	cPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


35 
´iv©e
 
	m$·»ÁWr™”
;

43 
public
 
funùiÚ
 
	$£tP¬’tWr™”
(
PHPExûl_Wr™”_IWr™”
 
$pWr™”
 = 
nuÎ
)

45 
$this
->
·»ÁWr™”
 = 
$pWr™”
;

54 
public
 
funùiÚ
 
	$g‘P¬’tWr™”
()

56 ià(!
	`is_nuÎ
(
$this
->
·»ÁWr™”
)) {

57  
$this
->
·»ÁWr™”
;

59 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("No…arent PHPExcel_Writer_IWriter‡ssigned.");

61 
	}
}

69 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_Wr™”_IWr™”
 
$pWr™”
 = 
nuÎ
)

71 ià(!
	`is_nuÎ
(
$pWr™”
)) {

72 
$this
->
·»ÁWr™”
 = 
$pWr™”
;

74 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl5
 
ex‹nds
 
PHPExûl_Wr™”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_Wr™”_IWr™”


35 
´iv©e
 
	m$phpExûl
;

42 
´iv©e
 
	m$¡rTÙ®
 = 0;

49 
´iv©e
 
	m$¡rUnique
 = 0;

56 
´iv©e
 
	m$¡rTabË
 = 
¬¿y
();

63 
´iv©e
 
	m$cŞÜs
;

70 
´iv©e
 
	m$·r£r
;

77 
´iv©e
 
	m$IDCLs
;

84 
´iv©e
 
	m$summ¬yInfÜm©iÚ
;

91 
´iv©e
 
	m$docum’tSumm¬yInfÜm©iÚ
;

98 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$phpExûl
)

100 
$this
->
phpExûl
 = 
$phpExûl
;

102 
$this
->
·r£r
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_P¬£r
();

111 
public
 
funùiÚ
 
	$§ve
(
$pF’ame
 = 
nuÎ
)

115 
$this
->
phpExûl
->
	`g¬bageCŞËù
();

117 
$§veDebugLog
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
phpExûl
)->
	`g‘DebugLog
()->
	`g‘Wr™eDebugLog
();

118 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
phpExûl
)->
	`g‘DebugLog
()->
	`£tWr™eDebugLog
(
çl£
);

119 
$§veD©eR‘uºTy³
 = 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`g‘R‘uºD©eTy³
();

120 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`£tR‘uºD©eTy³
(PHPExûl_C®cuÏtiÚ_FunùiÚs::
RETURNDATE_EXCEL
);

123 
$this
->
cŞÜs
 = 
	`¬¿y
();

126 
$this
->
wr™”WÜkbook
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_WÜkbook
($this->
phpExûl
, $this->
¡rTÙ®
, $this->
¡rUnique
, $this->
¡rTabË
, $this->
cŞÜs
, $this->
·r£r
);

129 
$couÁSh“ts
 = 
$this
->
phpExûl
->
	`g‘Sh“tCouÁ
();

130 
$i
 = 0; $˜< 
$couÁSh“ts
; ++$i) {

131 
$this
->
wr™”WÜksh“ts
[
$i
] = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_WÜksh“t
($this->
¡rTÙ®
, $this->
¡rUnique
, $this->
¡rTabË
, $this->
cŞÜs
, $this->
·r£r
, $this->
´eC®cuÏ‹FÜmuÏs
, $this->
phpExûl
->
	`g‘Sh“t
($i));

135 
$this
->
	`budWÜksh“tEsch”s
();

136 
$this
->
	`budWÜkbookEsch”
();

140 
$ûÎXfCŞËùiÚ
 = 
$this
->
phpExûl
->
	`g‘C–lXfCŞËùiÚ
();

141 
$i
 = 0; $i < 15; ++$i) {

142 
$this
->
wr™”WÜkbook
->
	`addXfWr™”
(
$ûÎXfCŞËùiÚ
[0], 
Œue
);

146 
	`fÜ—ch
 (
$this
->
phpExûl
->
	`g‘C–lXfCŞËùiÚ
(è
as
 
$¡yË
) {

147 
$this
->
wr™”WÜkbook
->
	`addXfWr™”
(
$¡yË
, 
çl£
);

151 
$i
 = 0; $˜< 
$couÁSh“ts
; ++$i) {

152 
	`fÜ—ch
 (
$this
->
wr™”WÜksh“ts
[
$i
]->
phpSh“t
->
	`g‘C–lCŞËùiÚ
(è
as
 
$ûÎID
) {

153 
$ûÎ
 = 
$this
->
wr™”WÜksh“ts
[
$i
]->
phpSh“t
->
	`g‘C–l
(
$ûÎID
);

154 
$cV®
 = 
$ûÎ
->
	`g‘V®ue
();

155 ià(
$cV®
 
š¡ªûof
 
PHPExûl_RichText
) {

156 
$–em’ts
 = 
$cV®
->
	`g‘RichTextEËm’ts
();

157 
	`fÜ—ch
 (
$–em’ts
 
as
 
$–em’t
) {

158 ià(
$–em’t
 
š¡ªûof
 
PHPExûl_RichText_Run
) {

159 
$fÚt
 = 
$–em’t
->
	`g‘FÚt
();

160 
$this
->
wr™”WÜksh“ts
[
$i
]->
fÚtHashIndex
[
$fÚt
->
	`g‘HashCode
()] = $this->
wr™”WÜkbook
->
	`addFÚt
($font);

168 
$wÜkbookSŒ—mName
 = 'Workbook';

169 
$OLE
 = 
Ãw
 
	`PHPExûl_Sh¬ed_OLE_PPS_Fe
(
PHPExûl_Sh¬ed_OLE
::
	`Asc2Ucs
(
$wÜkbookSŒ—mName
));

173 
$wÜksh“tSizes
 = 
	`¬¿y
();

174 
$i
 = 0; $˜< 
$couÁSh“ts
; ++$i) {

175 
$this
->
wr™”WÜksh“ts
[
$i
]->
	`şo£
();

176 
$wÜksh“tSizes
[] = 
$this
->
wr™”WÜksh“ts
[
$i
]->
_d©asize
;

180 
$OLE
->
	`­³nd
(
$this
->
wr™”WÜkbook
->
	`wr™eWÜkbook
(
$wÜksh“tSizes
));

183 
$i
 = 0; $˜< 
$couÁSh“ts
; ++$i) {

184 
$OLE
->
	`­³nd
(
$this
->
wr™”WÜksh“ts
[
$i
]->
	`g‘D©a
());

187 
$this
->
docum’tSumm¬yInfÜm©iÚ
 = $this->
	`wr™eDocum’tSumm¬yInfÜm©iÚ
();

189 ià(
	`is£t
(
$this
->
docum’tSumm¬yInfÜm©iÚ
è&& !
	`em±y
($this->documentSummaryInformation)) {

190 
$OLE_Docum’tSumm¬yInfÜm©iÚ
 = 
Ãw
 
	`PHPExûl_Sh¬ed_OLE_PPS_Fe
(
PHPExûl_Sh¬ed_OLE
::
	`Asc2Ucs
(
	`chr
(5) . 'DocumentSummaryInformation'));

191 
$OLE_Docum’tSumm¬yInfÜm©iÚ
->
	`­³nd
(
$this
->
docum’tSumm¬yInfÜm©iÚ
);

194 
$this
->
summ¬yInfÜm©iÚ
 = $this->
	`wr™eSumm¬yInfÜm©iÚ
();

196 ià(
	`is£t
(
$this
->
summ¬yInfÜm©iÚ
è&& !
	`em±y
($this->summaryInformation)) {

197 
$OLE_Summ¬yInfÜm©iÚ
 = 
Ãw
 
	`PHPExûl_Sh¬ed_OLE_PPS_Fe
(
PHPExûl_Sh¬ed_OLE
::
	`Asc2Ucs
(
	`chr
(5) . 'SummaryInformation'));

198 
$OLE_Summ¬yInfÜm©iÚ
->
	`­³nd
(
$this
->
summ¬yInfÜm©iÚ
);

202 
$¬rRoÙD©a
 = 
	`¬¿y
(
$OLE
);

204 ià(
	`is£t
(
$OLE_Summ¬yInfÜm©iÚ
)) {

205 
$¬rRoÙD©a
[] = 
$OLE_Summ¬yInfÜm©iÚ
;

208 ià(
	`is£t
(
$OLE_Docum’tSumm¬yInfÜm©iÚ
)) {

209 
$¬rRoÙD©a
[] = 
$OLE_Docum’tSumm¬yInfÜm©iÚ
;

212 
$roÙ
 = 
Ãw
 
	`PHPExûl_Sh¬ed_OLE_PPS_RoÙ
(
	`time
(),ime(), 
$¬rRoÙD©a
);

214 
$»s
 = 
$roÙ
->
	`§ve
(
$pF’ame
);

216 
PHPExûl_C®cuÏtiÚ_FunùiÚs
::
	`£tR‘uºD©eTy³
(
$§veD©eR‘uºTy³
);

217 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
phpExûl
)->
	`g‘DebugLog
()->
	`£tWr™eDebugLog
(
$§veDebugLog
);

218 
	}
}

228 
public
 
funùiÚ
 
£tTempDœ
(
$pV®ue
 = '')

230  
$this
;

237 
´iv©e
 
funùiÚ
 
	$budWÜksh“tEsch”s
()

240 
$blIndex
 = 0;

241 
$Ï¡ReduûdSpId
 = 0;

242 
$Ï¡SpId
 = 0;

244 
	`fÜ—ch
 (
$this
->
phpExûl
->
	`g‘AÎsh“ts
(è
as
 
$sh“t
) {

246 
$sh“tIndex
 = 
$sh“t
->
	`g‘P¬’t
()->
	`g‘Index
($sheet);

248 
$esch”
 = 
nuÎ
;

251 
$f‹rRªge
 = 
$sh“t
->
	`g‘AutoF‹r
()->
	`g‘Rªge
();

252 ià(
	`couÁ
(
$sh“t
->
	`g‘D¿wšgCŞËùiÚ
()è=ğ0 && 
	`em±y
(
$f‹rRªge
)) {

257 
$esch”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”
();

260 
$dgCÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DgCÚš”
();

263 
$dgId
 = 
$sh“t
->
	`g‘P¬’t
()->
	`g‘Index
($sheet) + 1;

264 
$dgCÚš”
->
	`£tDgId
(
$dgId
);

265 
$esch”
->
	`£tDgCÚš”
(
$dgCÚš”
);

268 
$¥grCÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DgCÚš”_SpgrCÚš”
();

269 
$dgCÚš”
->
	`£tSpgrCÚš”
(
$¥grCÚš”
);

272 
$¥CÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DgCÚš”_SpgrCÚš”_SpCÚš”
();

273 
$¥CÚš”
->
	`£tSpgr
(
Œue
);

274 
$¥CÚš”
->
	`£tSpTy³
(0);

275 
$¥CÚš”
->
	`£tSpId
((
$sh“t
->
	`g‘P¬’t
()->
	`g‘Index
($sheet) + 1) << 10);

276 
$¥grCÚš”
->
	`addChd
(
$¥CÚš”
);

280 
$couÁSh­es
[
$sh“tIndex
] = 0;

282 
	`fÜ—ch
 (
$sh“t
->
	`g‘D¿wšgCŞËùiÚ
(è
as
 
$d¿wšg
) {

283 ++
$blIndex
;

285 ++
$couÁSh­es
[
$sh“tIndex
];

288 
$¥CÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DgCÚš”_SpgrCÚš”_SpCÚš”
();

291 
$¥CÚš”
->
	`£tSpTy³
(0x004B);

293 
$¥CÚš”
->
	`£tSpFÏg
(0x02);

296 
$»duûdSpId
 = 
$couÁSh­es
[
$sh“tIndex
];

297 
$¥Id
 = 
$»duûdSpId


298 | (
$sh“t
->
	`g‘P¬’t
()->
	`g‘Index
($sheet) + 1) << 10;

299 
$¥CÚš”
->
	`£tSpId
(
$¥Id
);

302 
$Ï¡ReduûdSpId
 = 
$»duûdSpId
;

305 
$Ï¡SpId
 = 
$¥Id
;

308 
$¥CÚš”
->
	`£tOPT
(0x4104, 
$blIndex
);

311 
$coÜdš©es
 = 
$d¿wšg
->
	`g‘CoÜdš©es
();

312 
$off£tX
 = 
$d¿wšg
->
	`g‘Off£tX
();

313 
$off£tY
 = 
$d¿wšg
->
	`g‘Off£tY
();

314 
$width
 = 
$d¿wšg
->
	`g‘Width
();

315 
$height
 = 
$d¿wšg
->
	`g‘Height
();

317 
$twoAnchÜ
 = 
PHPExûl_Sh¬ed_Exûl5
::
	`ÚeAnchÜ2twoAnchÜ
(
$sh“t
, 
$coÜdš©es
, 
$off£tX
, 
$off£tY
, 
$width
, 
$height
);

319 
$¥CÚš”
->
	`£tS¹CoÜdš©es
(
$twoAnchÜ
['startCoordinates']);

320 
$¥CÚš”
->
	`£tS¹Off£tX
(
$twoAnchÜ
['startOffsetX']);

321 
$¥CÚš”
->
	`£tS¹Off£tY
(
$twoAnchÜ
['startOffsetY']);

322 
$¥CÚš”
->
	`£tEndCoÜdš©es
(
$twoAnchÜ
['endCoordinates']);

323 
$¥CÚš”
->
	`£tEndOff£tX
(
$twoAnchÜ
['endOffsetX']);

324 
$¥CÚš”
->
	`£tEndOff£tY
(
$twoAnchÜ
['endOffsetY']);

326 
$¥grCÚš”
->
	`addChd
(
$¥CÚš”
);

330 ià(!
	`em±y
(
$f‹rRªge
)) {

331 
$¿ngeBounds
 = 
PHPExûl_C–l
::
	`¿ngeBound¬›s
(
$f‹rRªge
);

332 
$iNumCŞS¹
 = 
$¿ngeBounds
[0][0];

333 
$iNumCŞEnd
 = 
$¿ngeBounds
[1][0];

335 
$iInc
 = 
$iNumCŞS¹
;

336 
$iInc
 <ğ
$iNumCŞEnd
) {

337 ++
$couÁSh­es
[
$sh“tIndex
];

340 
$oD¿wšg
 = 
Ãw
 
	`PHPExûl_WÜksh“t_Ba£D¿wšg
();

342 
$cD¿wšg
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$iInc
 - 1è. 
$¿ngeBounds
[0][1];

343 
$oD¿wšg
->
	`£tCoÜdš©es
(
$cD¿wšg
);

344 
$oD¿wšg
->
	`£tWÜksh“t
(
$sh“t
);

347 
$¥CÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DgCÚš”_SpgrCÚš”_SpCÚš”
();

349 
$¥CÚš”
->
	`£tSpTy³
(0x00C9);

351 
$¥CÚš”
->
	`£tSpFÏg
(0x01);

354 
$»duûdSpId
 = 
$couÁSh­es
[
$sh“tIndex
];

355 
$¥Id
 = 
$»duûdSpId


356 | (
$sh“t
->
	`g‘P¬’t
()->
	`g‘Index
($sheet) + 1) << 10;

357 
$¥CÚš”
->
	`£tSpId
(
$¥Id
);

360 
$Ï¡ReduûdSpId
 = 
$»duûdSpId
;

363 
$Ï¡SpId
 = 
$¥Id
;

365 
$¥CÚš”
->
	`£tOPT
(0x007F, 0x01040104);

366 
$¥CÚš”
->
	`£tOPT
(0x00BF, 0x00080008);

367 
$¥CÚš”
->
	`£tOPT
(0x01BF, 0x00010000);

368 
$¥CÚš”
->
	`£tOPT
(0x01FF, 0x00080000);

369 
$¥CÚš”
->
	`£tOPT
(0x03BF, 0x000A0000);

372 
$’dCoÜdš©es
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(PHPExûl_C–l::¡ršgFromCŞumnIndex(
$iInc
 - 1));

373 
$’dCoÜdš©es
 .ğ
$¿ngeBounds
[0][1] + 1;

375 
$¥CÚš”
->
	`£tS¹CoÜdš©es
(
$cD¿wšg
);

376 
$¥CÚš”
->
	`£tS¹Off£tX
(0);

377 
$¥CÚš”
->
	`£tS¹Off£tY
(0);

378 
$¥CÚš”
->
	`£tEndCoÜdš©es
(
$’dCoÜdš©es
);

379 
$¥CÚš”
->
	`£tEndOff£tX
(0);

380 
$¥CÚš”
->
	`£tEndOff£tY
(0);

382 
$¥grCÚš”
->
	`addChd
(
$¥CÚš”
);

383 
$iInc
++;

388 
$this
->
IDCLs
[
$dgId
] = 
$Ï¡ReduûdSpId
;

391 
$dgCÚš”
->
	`£tLa¡SpId
(
$Ï¡SpId
);

394 
$this
->
wr™”WÜksh“ts
[
$sh“tIndex
]->
	`£tEsch”
(
$esch”
);

396 
	}
}

401 
´iv©e
 
funùiÚ
 
	$budWÜkbookEsch”
()

403 
$esch”
 = 
nuÎ
;

406 
$found
 = 
çl£
;

407 
	`fÜ—ch
 (
$this
->
phpExûl
->
	`g‘AÎSh“ts
(è
as
 
$sh“t
) {

408 ià(
	`couÁ
(
$sh“t
->
	`g‘D¿wšgCŞËùiÚ
()) > 0) {

409 
$found
 = 
Œue
;

415 ià(!
$found
) {

420 
$esch”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”
();

423 
$dggCÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”
();

424 
$esch”
->
	`£tDggCÚš”
(
$dggCÚš”
);

427 
$dggCÚš”
->
	`£tIDCLs
(
$this
->
IDCLs
);

430 
$¥IdMax
 = 0;

431 
$tÙ®CouÁSh­es
 = 0;

432 
$couÁD¿wšgs
 = 0;

434 
	`fÜ—ch
 (
$this
->
phpExûl
->
	`g‘AÎsh“ts
(è
as
 
$sh“t
) {

435 
$sh“tCouÁSh­es
 = 0;

437 ià(
	`couÁ
(
$sh“t
->
	`g‘D¿wšgCŞËùiÚ
()) > 0) {

438 ++
$couÁD¿wšgs
;

440 
	`fÜ—ch
 (
$sh“t
->
	`g‘D¿wšgCŞËùiÚ
(è
as
 
$d¿wšg
) {

441 ++
$sh“tCouÁSh­es
;

442 ++
$tÙ®CouÁSh­es
;

444 
$¥Id
 = 
$sh“tCouÁSh­es
 | (
$this
->
phpExûl
->
	`g‘Index
(
$sh“t
) + 1) << 10;

445 
$¥IdMax
 = 
	`max
(
$¥Id
, $spIdMax);

450 
$dggCÚš”
->
	`£tSpIdMax
(
$¥IdMax
 + 1);

451 
$dggCÚš”
->
	`£tCDgSaved
(
$couÁD¿wšgs
);

452 
$dggCÚš”
->
	`£tCSpSaved
(
$tÙ®CouÁSh­es
 + 
$couÁD¿wšgs
);

455 
$b¡ÜeCÚš”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”
();

456 
$dggCÚš”
->
	`£tB¡ÜeCÚš”
(
$b¡ÜeCÚš”
);

459 
	`fÜ—ch
 (
$this
->
phpExûl
->
	`g‘AÎsh“ts
(è
as
 
$sh“t
) {

460 
	`fÜ—ch
 (
$sh“t
->
	`g‘D¿wšgCŞËùiÚ
(è
as
 
$d¿wšg
) {

461 ià(
$d¿wšg
 
š¡ªûof
 
PHPExûl_WÜksh“t_D¿wšg
) {

462 
$f’ame
 = 
$d¿wšg
->
	`g‘P©h
();

464 
	`li¡
(
$imagesx
, 
$imagesy
, 
$imageFÜm©
èğ
	`g‘imagesize
(
$f’ame
);

466 
$imageFÜm©
) {

468 
$blTy³
 = 
PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
::
BLIPTYPE_PNG
;

469 
	`ob_¡¬t
();

470 
	`imag•ng
(
	`imageü—‹äomgif
(
$f’ame
));

471 
$blD©a
 = 
	`ob_g‘_cÚ‹Ás
();

472 
	`ob_’d_ş—n
();

475 
$blTy³
 = 
PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
::
BLIPTYPE_JPEG
;

476 
$blD©a
 = 
	`fe_g‘_cÚ‹Ás
(
$f’ame
);

479 
$blTy³
 = 
PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
::
BLIPTYPE_PNG
;

480 
$blD©a
 = 
	`fe_g‘_cÚ‹Ás
(
$f’ame
);

483 
$blTy³
 = 
PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
::
BLIPTYPE_PNG
;

484 
	`ob_¡¬t
();

485 
	`imag•ng
(
PHPExûl_Sh¬ed_D¿wšg
::
	`imageü—‹äombmp
(
$f’ame
));

486 
$blD©a
 = 
	`ob_g‘_cÚ‹Ás
();

487 
	`ob_’d_ş—n
();

493 
$bl
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE_Bl
();

494 
$bl
->
	`£tD©a
(
$blD©a
);

496 
$BSE
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
();

497 
$BSE
->
	`£tBlTy³
(
$blTy³
);

498 
$BSE
->
	`£tBl
(
$bl
);

500 
$b¡ÜeCÚš”
->
	`addBSE
(
$BSE
);

501 } 
	`–£if
 (
$d¿wšg
 
š¡ªûof
 
PHPExûl_WÜksh“t_MemÜyD¿wšg
) {

502 
$d¿wšg
->
	`g‘R’d”šgFunùiÚ
()) {

503 
PHPExûl_WÜksh“t_MemÜyD¿wšg
::
RENDERING_JPEG
:

504 
$blTy³
 = 
PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
::
BLIPTYPE_JPEG
;

505 
$»nd”šgFunùiÚ
 = 'imagejpeg';

507 
PHPExûl_WÜksh“t_MemÜyD¿wšg
::
RENDERING_GIF
:

508 
PHPExûl_WÜksh“t_MemÜyD¿wšg
::
RENDERING_PNG
:

509 
PHPExûl_WÜksh“t_MemÜyD¿wšg
::
RENDERING_DEFAULT
:

510 
$blTy³
 = 
PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
::
BLIPTYPE_PNG
;

511 
$»nd”šgFunùiÚ
 = 'imagepng';

515 
	`ob_¡¬t
();

516 
	`ÿÎ_u£r_func
(
$»nd”šgFunùiÚ
, 
$d¿wšg
->
	`g‘ImageResourû
());

517 
$blD©a
 = 
	`ob_g‘_cÚ‹Ás
();

518 
	`ob_’d_ş—n
();

520 
$bl
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE_Bl
();

521 
$bl
->
	`£tD©a
(
$blD©a
);

523 
$BSE
 = 
Ãw
 
	`PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
();

524 
$BSE
->
	`£tBlTy³
(
$blTy³
);

525 
$BSE
->
	`£tBl
(
$bl
);

527 
$b¡ÜeCÚš”
->
	`addBSE
(
$BSE
);

533 
$this
->
wr™”WÜkbook
->
	`£tEsch”
(
$esch”
);

534 
	}
}

540 
´iv©e
 
funùiÚ
 
	$wr™eDocum’tSumm¬yInfÜm©iÚ
()

543 
$d©a
 = 
	`·ck
('v', 0xFFFE);

545 
$d©a
 .ğ
	`·ck
('v', 0x0000);

547 
$d©a
 .ğ
	`·ck
('v', 0x0106);

549 
$d©a
 .ğ
	`·ck
('v', 0x0002);

551 
$d©a
 .ğ
	`·ck
('VVVV', 0x00, 0x00, 0x00, 0x00);

553 
$d©a
 .ğ
	`·ck
('V', 0x0001);

556 
$d©a
 .ğ
	`·ck
('vvvvvvvv', 0xD502, 0xD5CD, 0x2E9C, 0x101B, 0x9793, 0x0008, 0x2C2B, 0xAEF9);

558 
$d©a
 .ğ
	`·ck
('V', 0x30);

561 
$d©aSeùiÚ
 = 
	`¬¿y
();

562 
$d©aSeùiÚ_NumPrİs
 = 0;

563 
$d©aSeùiÚ_Summ¬y
 = '';

564 
$d©aSeùiÚ_CÚ‹Á
 = '';

567 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x01),

568 'off£t' => 
	`¬¿y
('pack' => 'V'),

569 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x02),

570 'd©a' => 
	`¬¿y
('data' => 1252));

571 
$d©aSeùiÚ_NumPrİs
++;

574 ià(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘C©egÜy
()) {

575 
$d©aPrİ
 = 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘C©egÜy
();

576 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x02),

577 'off£t' => 
	`¬¿y
('pack' => 'V'),

578 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x1E),

579 'd©a' => 
	`¬¿y
('d©a' => 
$d©aPrİ
, 'Ëngth' => 
	`¡¾’
($dataProp)));

580 
$d©aSeùiÚ_NumPrİs
++;

583 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x17),

584 'off£t' => 
	`¬¿y
('pack' => 'V'),

585 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x03),

586 'd©a' => 
	`¬¿y
('pack' => 'V', 'data' => 0x000C0000));

587 
$d©aSeùiÚ_NumPrİs
++;

589 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x0B),

590 'off£t' => 
	`¬¿y
('pack' => 'V'),

591 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x0B),

592 'd©a' => 
	`¬¿y
('d©a' => 
çl£
));

593 
$d©aSeùiÚ_NumPrİs
++;

595 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x10),

596 'off£t' => 
	`¬¿y
('pack' => 'V'),

597 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x0B),

598 'd©a' => 
	`¬¿y
('d©a' => 
çl£
));

599 
$d©aSeùiÚ_NumPrİs
++;

601 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x13),

602 'off£t' => 
	`¬¿y
('pack' => 'V'),

603 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x0B),

604 'd©a' => 
	`¬¿y
('d©a' => 
çl£
));

605 
$d©aSeùiÚ_NumPrİs
++;

607 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x16),

608 'off£t' => 
	`¬¿y
('pack' => 'V'),

609 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x0B),

610 'd©a' => 
	`¬¿y
('d©a' => 
çl£
));

611 
$d©aSeùiÚ_NumPrİs
++;

617 
$d©aPrİ
 = 
	`·ck
('v', 0x0001);

618 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0000);

621 
$d©aPrİ
 .ğ
	`·ck
('v', 0x000A);

622 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0000);

624 
$d©aPrİ
 .ğ'WÜksh“t'.
	`chr
(0);

626 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x0D),

627 'off£t' => 
	`¬¿y
('pack' => 'V'),

628 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x101E),

629 'd©a' => 
	`¬¿y
('d©a' => 
$d©aPrİ
, 'Ëngth' => 
	`¡¾’
($dataProp)));

630 
$d©aSeùiÚ_NumPrİs
++;

635 
$d©aPrİ
 = 
	`·ck
('v', 0x0002);

636 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0000);

640 
$d©aPrİ
 .ğ
	`·ck
('v', 0x001E);

642 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0000);

645 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0013);

646 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0000);

648 
$d©aPrİ
 .= 'Feuilles de calcul';

651 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0300);

653 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0000);

655 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0100);

656 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0000);

657 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0000);

658 
$d©aPrİ
 .ğ
	`·ck
('v', 0x0000);

660 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x0C),

661 'off£t' => 
	`¬¿y
('pack' => 'V'),

662 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x100C),

663 'd©a' => 
	`¬¿y
('d©a' => 
$d©aPrİ
, 'Ëngth' => 
	`¡¾’
($dataProp)));

664 
$d©aSeùiÚ_NumPrİs
++;

669 
$d©aSeùiÚ_CÚ‹Á_Off£t
 = 8 + 
$d©aSeùiÚ_NumPrİs
 * 8;

670 
	`fÜ—ch
 (
$d©aSeùiÚ
 
as
 
$d©aPrİ
) {

672 
$d©aSeùiÚ_Summ¬y
 .ğ
	`·ck
(
$d©aPrİ
['summary']['pack'], $dataProp['summary']['data']);

674 
$d©aSeùiÚ_Summ¬y
 .ğ
	`·ck
(
$d©aPrİ
['off£t']['·ck'], 
$d©aSeùiÚ_CÚ‹Á_Off£t
);

676 
$d©aSeùiÚ_CÚ‹Á
 .ğ
	`·ck
(
$d©aPrİ
['type']['pack'], $dataProp['type']['data']);

678 ià(
$d©aPrİ
['type']['data'] == 0x02) {

679 
$d©aSeùiÚ_CÚ‹Á
 .ğ
	`·ck
('V', 
$d©aPrİ
['data']['data']);

681 
$d©aSeùiÚ_CÚ‹Á_Off£t
 += 4 + 4;

682 } 
	`–£if
 (
$d©aPrİ
['type']['data'] == 0x03) {

683 
$d©aSeùiÚ_CÚ‹Á
 .ğ
	`·ck
('V', 
$d©aPrİ
['data']['data']);

685 
$d©aSeùiÚ_CÚ‹Á_Off£t
 += 4 + 4;

686 } 
	`–£if
 (
$d©aPrİ
['type']['data'] == 0x0B) {

687 ià(
$d©aPrİ
['d©a']['d©a'] =ğ
çl£
) {

688 
$d©aSeùiÚ_CÚ‹Á
 .ğ
	`·ck
('V', 0x0000);

690 
$d©aSeùiÚ_CÚ‹Á
 .ğ
	`·ck
('V', 0x0001);

692 
$d©aSeùiÚ_CÚ‹Á_Off£t
 += 4 + 4;

693 } 
	`–£if
 (
$d©aPrİ
['type']['data'] == 0x1E) {

695 
$d©aPrİ
['d©a']['d©a'] .ğ
	`chr
(0);

696 
$d©aPrİ
['data']['length'] += 1;

698 
$d©aPrİ
['data']['length'] = $dataProp['data']['length'] + ((4 - $dataProp['data']['length'] % 4)==4 ? 0 : (4 - $dataProp['data']['length'] % 4));

699 
$d©aPrİ
['d©a']['d©a'] = 
	`¡r_·d
($d©aPrİ['d©a']['d©a'], $d©aPrİ['d©a']['Ëngth'], 
	`chr
(0), 
STR_PAD_RIGHT
);

701 
$d©aSeùiÚ_CÚ‹Á
 .ğ
	`·ck
('V', 
$d©aPrİ
['data']['length']);

702 
$d©aSeùiÚ_CÚ‹Á
 .ğ
$d©aPrİ
['data']['data'];

704 
$d©aSeùiÚ_CÚ‹Á_Off£t
 +ğ4 + 4 + 
	`¡¾’
(
$d©aPrİ
['data']['data']);

705 } 
	`–£if
 (
$d©aPrİ
['type']['data'] == 0x40) {

706 
$d©aSeùiÚ_CÚ‹Á
 .ğ
$d©aPrİ
['data']['data'];

708 
$d©aSeùiÚ_CÚ‹Á_Off£t
 += 4 + 8;

711 
$d©aSeùiÚ_CÚ‹Á
 .ğ
$d©aPrİ
['data']['data'];

713 
$d©aSeùiÚ_CÚ‹Á_Off£t
 +ğ4 + 
$d©aPrİ
['data']['length'];

721 
$d©a
 .ğ
	`·ck
('V', 
$d©aSeùiÚ_CÚ‹Á_Off£t
);

723 
$d©a
 .ğ
	`·ck
('V', 
$d©aSeùiÚ_NumPrİs
);

725 
$d©a
 .ğ
$d©aSeùiÚ_Summ¬y
;

727 
$d©a
 .ğ
$d©aSeùiÚ_CÚ‹Á
;

729  
$d©a
;

730 
	}
}

736 
´iv©e
 
funùiÚ
 
	$wr™eSumm¬yInfÜm©iÚ
()

739 
$d©a
 = 
	`·ck
('v', 0xFFFE);

741 
$d©a
 .ğ
	`·ck
('v', 0x0000);

743 
$d©a
 .ğ
	`·ck
('v', 0x0106);

745 
$d©a
 .ğ
	`·ck
('v', 0x0002);

747 
$d©a
 .ğ
	`·ck
('VVVV', 0x00, 0x00, 0x00, 0x00);

749 
$d©a
 .ğ
	`·ck
('V', 0x0001);

752 
$d©a
 .ğ
	`·ck
('vvvvvvvv', 0x85E0, 0xF29F, 0x4FF9, 0x1068, 0x91AB, 0x0008, 0x272B, 0xD9B3);

754 
$d©a
 .ğ
	`·ck
('V', 0x30);

757 
$d©aSeùiÚ
 = 
	`¬¿y
();

758 
$d©aSeùiÚ_NumPrİs
 = 0;

759 
$d©aSeùiÚ_Summ¬y
 = '';

760 
$d©aSeùiÚ_CÚ‹Á
 = '';

763 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x01),

764 'off£t' => 
	`¬¿y
('pack' => 'V'),

765 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x02),

766 'd©a' => 
	`¬¿y
('data' => 1252));

767 
$d©aSeùiÚ_NumPrİs
++;

770 ià(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘T™Ë
()) {

771 
$d©aPrİ
 = 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘T™Ë
();

772 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x02),

773 'off£t' => 
	`¬¿y
('pack' => 'V'),

774 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x1E),

775 'd©a' => 
	`¬¿y
('d©a' => 
$d©aPrİ
, 'Ëngth' => 
	`¡¾’
($dataProp)));

776 
$d©aSeùiÚ_NumPrİs
++;

779 ià(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘Subjeù
()) {

780 
$d©aPrİ
 = 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘Subjeù
();

781 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x03),

782 'off£t' => 
	`¬¿y
('pack' => 'V'),

783 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x1E),

784 'd©a' => 
	`¬¿y
('d©a' => 
$d©aPrİ
, 'Ëngth' => 
	`¡¾’
($dataProp)));

785 
$d©aSeùiÚ_NumPrİs
++;

788 ià(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©Ü
()) {

789 
$d©aPrİ
 = 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©Ü
();

790 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x04),

791 'off£t' => 
	`¬¿y
('pack' => 'V'),

792 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x1E),

793 'd©a' => 
	`¬¿y
('d©a' => 
$d©aPrİ
, 'Ëngth' => 
	`¡¾’
($dataProp)));

794 
$d©aSeùiÚ_NumPrİs
++;

797 ià(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘KeywÜds
()) {

798 
$d©aPrİ
 = 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘KeywÜds
();

799 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x05),

800 'off£t' => 
	`¬¿y
('pack' => 'V'),

801 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x1E),

802 'd©a' => 
	`¬¿y
('d©a' => 
$d©aPrİ
, 'Ëngth' => 
	`¡¾’
($dataProp)));

803 
$d©aSeùiÚ_NumPrİs
++;

806 ià(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘DesütiÚ
()) {

807 
$d©aPrİ
 = 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘DesütiÚ
();

808 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x06),

809 'off£t' => 
	`¬¿y
('pack' => 'V'),

810 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x1E),

811 'd©a' => 
	`¬¿y
('d©a' => 
$d©aPrİ
, 'Ëngth' => 
	`¡¾’
($dataProp)));

812 
$d©aSeùiÚ_NumPrİs
++;

815 ià(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘La¡Modif›dBy
()) {

816 
$d©aPrİ
 = 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘La¡Modif›dBy
();

817 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x08),

818 'off£t' => 
	`¬¿y
('pack' => 'V'),

819 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x1E),

820 'd©a' => 
	`¬¿y
('d©a' => 
$d©aPrİ
, 'Ëngth' => 
	`¡¾’
($dataProp)));

821 
$d©aSeùiÚ_NumPrİs
++;

824 ià(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©ed
()) {

825 
$d©aPrİ
 = 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©ed
();

826 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x0C),

827 'off£t' => 
	`¬¿y
('pack' => 'V'),

828 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x40),

829 'd©a' => 
	`¬¿y
('d©a' => 
PHPExûl_Sh¬ed_OLE
::
	`LoÿlD©e2OLE
(
$d©aPrİ
)));

830 
$d©aSeùiÚ_NumPrİs
++;

833 ià(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘Modif›d
()) {

834 
$d©aPrİ
 = 
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘Modif›d
();

835 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x0D),

836 'off£t' => 
	`¬¿y
('pack' => 'V'),

837 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x40),

838 'd©a' => 
	`¬¿y
('d©a' => 
PHPExûl_Sh¬ed_OLE
::
	`LoÿlD©e2OLE
(
$d©aPrİ
)));

839 
$d©aSeùiÚ_NumPrİs
++;

842 
$d©aSeùiÚ
[] = 
	`¬¿y
('summary'=>‡rray('pack' => 'V', 'data' => 0x13),

843 'off£t' => 
	`¬¿y
('pack' => 'V'),

844 'ty³' => 
	`¬¿y
('pack' => 'V', 'data' => 0x03),

845 'd©a' => 
	`¬¿y
('data' => 0x00));

846 
$d©aSeùiÚ_NumPrİs
++;

852 
$d©aSeùiÚ_CÚ‹Á_Off£t
 = 8 + 
$d©aSeùiÚ_NumPrİs
 * 8;

853 
	`fÜ—ch
 (
$d©aSeùiÚ
 
as
 
$d©aPrİ
) {

855 
$d©aSeùiÚ_Summ¬y
 .ğ
	`·ck
(
$d©aPrİ
['summary']['pack'], $dataProp['summary']['data']);

857 
$d©aSeùiÚ_Summ¬y
 .ğ
	`·ck
(
$d©aPrİ
['off£t']['·ck'], 
$d©aSeùiÚ_CÚ‹Á_Off£t
);

859 
$d©aSeùiÚ_CÚ‹Á
 .ğ
	`·ck
(
$d©aPrİ
['type']['pack'], $dataProp['type']['data']);

861 ià(
$d©aPrİ
['type']['data'] == 0x02) {

862 
$d©aSeùiÚ_CÚ‹Á
 .ğ
	`·ck
('V', 
$d©aPrİ
['data']['data']);

864 
$d©aSeùiÚ_CÚ‹Á_Off£t
 += 4 + 4;

865 } 
	`–£if
 (
$d©aPrİ
['type']['data'] == 0x03) {

866 
$d©aSeùiÚ_CÚ‹Á
 .ğ
	`·ck
('V', 
$d©aPrİ
['data']['data']);

868 
$d©aSeùiÚ_CÚ‹Á_Off£t
 += 4 + 4;

869 } 
	`–£if
 (
$d©aPrİ
['type']['data'] == 0x1E) {

871 
$d©aPrİ
['d©a']['d©a'] .ğ
	`chr
(0);

872 
$d©aPrİ
['data']['length'] += 1;

874 
$d©aPrİ
['data']['length'] = $dataProp['data']['length'] + ((4 - $dataProp['data']['length'] % 4)==4 ? 0 : (4 - $dataProp['data']['length'] % 4));

875 
$d©aPrİ
['d©a']['d©a'] = 
	`¡r_·d
($d©aPrİ['d©a']['d©a'], $d©aPrİ['d©a']['Ëngth'], 
	`chr
(0), 
STR_PAD_RIGHT
);

877 
$d©aSeùiÚ_CÚ‹Á
 .ğ
	`·ck
('V', 
$d©aPrİ
['data']['length']);

878 
$d©aSeùiÚ_CÚ‹Á
 .ğ
$d©aPrİ
['data']['data'];

880 
$d©aSeùiÚ_CÚ‹Á_Off£t
 +ğ4 + 4 + 
	`¡¾’
(
$d©aPrİ
['data']['data']);

881 } 
	`–£if
 (
$d©aPrİ
['type']['data'] == 0x40) {

882 
$d©aSeùiÚ_CÚ‹Á
 .ğ
$d©aPrİ
['data']['data'];

884 
$d©aSeùiÚ_CÚ‹Á_Off£t
 += 4 + 8;

894 
$d©a
 .ğ
	`·ck
('V', 
$d©aSeùiÚ_CÚ‹Á_Off£t
);

896 
$d©a
 .ğ
	`·ck
('V', 
$d©aSeùiÚ_NumPrİs
);

898 
$d©a
 .ğ
$d©aSeùiÚ_Summ¬y
;

900 
$d©a
 .ğ
$d©aSeùiÚ_CÚ‹Á
;

902  
$d©a
;

903 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/BIFFwriter.php

1 <?
php


62 şas 
	cPHPExûl_Wr™”_Exûl5_BIFFwr™”


68 
´iv©e
 
	m$by‹Ord”
;

74 
public
 
	m$_d©a
;

80 
public
 
	m$_d©asize
;

87 
´iv©e
 
	m$lim™
 = 8224;

92 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

94 
$this
->
_d©a
 = '';

95 
$this
->
_d©asize
 = 0;

105 
public
 
funùiÚ
 
	$g‘By‹Ord”
()

107 ià(!
	`is£t
(
£lf
::
$by‹Ord”
)) {

109 
$‹¡¡r
 = 
	`·ck
("d", 1.2345);

110 
$numb”
 = 
	`·ck
("C8", 0x8D, 0x97, 0x6E, 0x12, 0x83, 0xC0, 0xF3, 0x3F);

111 ià(
$numb”
 =ğ
$‹¡¡r
) {

112 
$by‹_Üd”
 = 0;

113 } 
	`–£if
 (
$numb”
 =ğ
	`¡¼ev
(
$‹¡¡r
)) {

114 
$by‹_Üd”
 = 1;

117 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Required floating…oint format‚ot supported onhis…latform.");

119 
£lf
::
$by‹Ord”
 = 
$by‹_Üd”
;

122  
£lf
::
$by‹Ord”
;

123 
	}
}

131 
´Ùeùed
 
funùiÚ
 
	$­³nd
(
$d©a
)

133 ià(
	`¡¾’
(
$d©a
è- 4 > 
$this
->
lim™
) {

134 
$d©a
 = 
$this
->
	`addCÚtšue
($data);

136 
$this
->
_d©a
 .ğ
$d©a
;

137 
$this
->
_d©asize
 +ğ
	`¡¾’
(
$d©a
);

138 
	}
}

146 
public
 
funùiÚ
 
	$wr™eD©a
(
$d©a
)

148 ià(
	`¡¾’
(
$d©a
è- 4 > 
$this
->
lim™
) {

149 
$d©a
 = 
$this
->
	`addCÚtšue
($data);

151 
$this
->
_d©asize
 +ğ
	`¡¾’
(
$d©a
);

153  
$d©a
;

154 
	}
}

164 
´Ùeùed
 
funùiÚ
 
	$¡ÜeBof
(
$ty³
)

166 
$»cÜd
 = 0x0809;

167 
$Ëngth
 = 0x0010;

170 
$unknown
 = 
	`·ck
("VV", 0x000100D1, 0x00000406);

172 
$bud
 = 0x0DBB;

173 
$y—r
 = 0x07CC;

175 
$v”siÚ
 = 0x0600;

177 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

178 
$d©a
 = 
	`·ck
("vvvv", 
$v”siÚ
, 
$ty³
, 
$bud
, 
$y—r
);

179 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
 . 
$unknown
);

180 
	}
}

187 
´Ùeùed
 
funùiÚ
 
	$¡ÜeEof
()

189 
$»cÜd
 = 0x000A;

190 
$Ëngth
 = 0x0000;

192 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

193 
$this
->
	`­³nd
(
$h—d”
);

194 
	}
}

201 
public
 
funùiÚ
 
	$wr™eEof
()

203 
$»cÜd
 = 0x000A;

204 
$Ëngth
 = 0x0000;

205 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

206  
$this
->
	`wr™eD©a
(
$h—d”
);

207 
	}
}

221 
´iv©e
 
funùiÚ
 
	$addCÚtšue
(
$d©a
)

223 
$lim™
 = 
$this
->
lim™
;

224 
$»cÜd
 = 0x003C;

228 
$tmp
 = 
	`sub¡r
(
$d©a
, 0, 2è. 
	`·ck
("v", 
$lim™
) . substr($data, 4, $limit);

230 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$lim™
);

233 
$d©a_Ëngth
 = 
	`¡¾’
(
$d©a
);

234 
$i
 = 
$lim™
 + 4; $˜< (
$d©a_Ëngth
 - $limit); $i += $limit) {

235 
$tmp
 .ğ
$h—d”
;

236 
$tmp
 .ğ
	`sub¡r
(
$d©a
, 
$i
, 
$lim™
);

240 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
	`¡¾’
(
$d©a
è- 
$i
);

241 
$tmp
 .ğ
$h—d”
;

242 
$tmp
 .ğ
	`sub¡r
(
$d©a
, 
$i
, 
	`¡¾’
($data) - $i);

244  
$tmp
;

245 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Escher.php

1 <?
php


36 şas 
	cPHPExûl_Wr™”_Exûl5_Esch”


41 
´iv©e
 
	m$objeù
;

46 
´iv©e
 
	m$d©a
;

53 
´iv©e
 
	m$¥Off£ts
;

60 
´iv©e
 
	m$¥Ty³s
;

67 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$objeù
)

69 
$this
->
objeù
 = 
$objeù
;

75 
public
 
funùiÚ
 
	$şo£
()

78 
$this
->
d©a
 = '';

80 
	`g‘_şass
(
$this
->
objeù
)) {

82 ià(
$dggCÚš”
 = 
$this
->
objeù
->
	`g‘DggCÚš”
()) {

83 
$wr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_Esch”
(
$dggCÚš”
);

84 
$this
->
d©a
 = 
$wr™”
->
	`şo£
();

85 } 
	`–£if
 (
$dgCÚš”
 = 
$this
->
objeù
->
	`g‘DgCÚš”
()) {

86 
$wr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_Esch”
(
$dgCÚš”
);

87 
$this
->
d©a
 = 
$wr™”
->
	`şo£
();

88 
$this
->
¥Off£ts
 = 
$wr™”
->
	`g‘SpOff£ts
();

89 
$this
->
¥Ty³s
 = 
$wr™”
->
	`g‘SpTy³s
();

96 
$šÃrD©a
 = '';

99 
$»cV”
 = 0x0;

100 
$»cIn¡ªû
 = 0x0000;

101 
$»cTy³
 = 0xF006;

103 
$»cV”In¡ªû
 = 
$»cV”
;

104 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

107 
$dggD©a
 =

108 
	`·ck
(

110 
$this
->
objeù
->
	`g‘SpIdMax
(),

111 
$this
->
objeù
->
	`g‘CDgSaved
() + 1,

112 
$this
->
objeù
->
	`g‘CSpSaved
(),

113 
$this
->
objeù
->
	`g‘CDgSaved
()

117 
$IDCLs
 = 
$this
->
objeù
->
	`g‘IDCLs
();

119 
	`fÜ—ch
 (
$IDCLs
 
as
 
$dgId
 => 
$maxReduûdSpId
) {

120 
$dggD©a
 .ğ
	`·ck
('VV', 
$dgId
, 
$maxReduûdSpId
 + 1);

123 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
	`¡¾’
(
$dggD©a
));

124 
$šÃrD©a
 .ğ
$h—d”
 . 
$dggD©a
;

127 ià(
$b¡ÜeCÚš”
 = 
$this
->
objeù
->
	`g‘B¡ÜeCÚš”
()) {

128 
$wr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_Esch”
(
$b¡ÜeCÚš”
);

129 
$šÃrD©a
 .ğ
$wr™”
->
	`şo£
();

133 
$»cV”
 = 0xF;

134 
$»cIn¡ªû
 = 0x0000;

135 
$»cTy³
 = 0xF000;

136 
$Ëngth
 = 
	`¡¾’
(
$šÃrD©a
);

138 
$»cV”In¡ªû
 = 
$»cV”
;

139 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

141 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

143 
$this
->
d©a
 = 
$h—d”
 . 
$šÃrD©a
;

149 
$šÃrD©a
 = '';

152 ià(
$BSECŞËùiÚ
 = 
$this
->
objeù
->
	`g‘BSECŞËùiÚ
()) {

153 
	`fÜ—ch
 (
$BSECŞËùiÚ
 
as
 
$BSE
) {

154 
$wr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_Esch”
(
$BSE
);

155 
$šÃrD©a
 .ğ
$wr™”
->
	`şo£
();

160 
$»cV”
 = 0xF;

161 
$»cIn¡ªû
 = 
	`couÁ
(
$this
->
objeù
->
	`g‘BSECŞËùiÚ
());

162 
$»cTy³
 = 0xF001;

163 
$Ëngth
 = 
	`¡¾’
(
$šÃrD©a
);

165 
$»cV”In¡ªû
 = 
$»cV”
;

166 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

168 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

170 
$this
->
d©a
 = 
$h—d”
 . 
$šÃrD©a
;

176 
$šÃrD©a
 = '';

179 ià(
$bl
 = 
$this
->
objeù
->
	`g‘Bl
()) {

180 
$wr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_Esch”
(
$bl
);

181 
$šÃrD©a
 .ğ
$wr™”
->
	`şo£
();

185 
$d©a
 = '';

187 
$btWš32
 = 
$this
->
objeù
->
	`g‘BlTy³
();

188 
$btMacOS
 = 
$this
->
objeù
->
	`g‘BlTy³
();

189 
$d©a
 .ğ
	`·ck
('CC', 
$btWš32
, 
$btMacOS
);

191 
$rgbUid
 = 
	`·ck
('VVVV', 0, 0, 0, 0);

192 
$d©a
 .ğ
$rgbUid
;

194 
$g
 = 0;

195 
$size
 = 
	`¡¾’
(
$šÃrD©a
);

196 
$cRef
 = 1;

197 
$foD–ay
 = 0;

198 
$unu£d1
 = 0x0;

199 
$cbName
 = 0x0;

200 
$unu£d2
 = 0x0;

201 
$unu£d3
 = 0x0;

202 
$d©a
 .ğ
	`·ck
('vVVVCCCC', 
$g
, 
$size
, 
$cRef
, 
$foD–ay
, 
$unu£d1
, 
$cbName
, 
$unu£d2
, 
$unu£d3
);

204 
$d©a
 .ğ
$šÃrD©a
;

207 
$»cV”
 = 0x2;

208 
$»cIn¡ªû
 = 
$this
->
objeù
->
	`g‘BlTy³
();

209 
$»cTy³
 = 0xF007;

210 
$Ëngth
 = 
	`¡¾’
(
$d©a
);

212 
$»cV”In¡ªû
 = 
$»cV”
;

213 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

215 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

217 
$this
->
d©a
 = 
$h—d”
;

219 
$this
->
d©a
 .ğ
$d©a
;

225 
$this
->
objeù
->
	`g‘P¬’t
()->
	`g‘BlTy³
()) {

226 
PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
::
BLIPTYPE_JPEG
:

228 
$šÃrD©a
 = '';

230 
$rgbUid1
 = 
	`·ck
('VVVV', 0, 0, 0, 0);

231 
$šÃrD©a
 .ğ
$rgbUid1
;

233 
$g
 = 0xFF;

234 
$šÃrD©a
 .ğ
	`·ck
('C', 
$g
);

236 
$šÃrD©a
 .ğ
$this
->
objeù
->
	`g‘D©a
();

238 
$»cV”
 = 0x0;

239 
$»cIn¡ªû
 = 0x46A;

240 
$»cTy³
 = 0xF01D;

241 
$Ëngth
 = 
	`¡¾’
(
$šÃrD©a
);

243 
$»cV”In¡ªû
 = 
$»cV”
;

244 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

246 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

248 
$this
->
d©a
 = 
$h—d”
;

250 
$this
->
d©a
 .ğ
$šÃrD©a
;

253 
PHPExûl_Sh¬ed_Esch”_DggCÚš”_B¡ÜeCÚš”_BSE
::
BLIPTYPE_PNG
:

255 
$šÃrD©a
 = '';

257 
$rgbUid1
 = 
	`·ck
('VVVV', 0, 0, 0, 0);

258 
$šÃrD©a
 .ğ
$rgbUid1
;

260 
$g
 = 0xFF;

261 
$šÃrD©a
 .ğ
	`·ck
('C', 
$g
);

263 
$šÃrD©a
 .ğ
$this
->
objeù
->
	`g‘D©a
();

265 
$»cV”
 = 0x0;

266 
$»cIn¡ªû
 = 0x6E0;

267 
$»cTy³
 = 0xF01E;

268 
$Ëngth
 = 
	`¡¾’
(
$šÃrD©a
);

270 
$»cV”In¡ªû
 = 
$»cV”
;

271 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

273 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

275 
$this
->
d©a
 = 
$h—d”
;

277 
$this
->
d©a
 .ğ
$šÃrD©a
;

285 
$šÃrD©a
 = '';

288 
$»cV”
 = 0x0;

289 
$»cIn¡ªû
 = 
$this
->
objeù
->
	`g‘DgId
();

290 
$»cTy³
 = 0xF008;

291 
$Ëngth
 = 8;

293 
$»cV”In¡ªû
 = 
$»cV”
;

294 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

296 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

299 
$couÁSh­es
 = 
	`couÁ
(
$this
->
objeù
->
	`g‘SpgrCÚš”
()->
	`g‘Chd»n
());

300 
$šÃrD©a
 .ğ
$h—d”
 . 
	`·ck
('VV', 
$couÁSh­es
, 
$this
->
objeù
->
	`g‘La¡SpId
());

304 ià(
$¥grCÚš”
 = 
$this
->
objeù
->
	`g‘SpgrCÚš”
()) {

305 
$wr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_Esch”
(
$¥grCÚš”
);

306 
$šÃrD©a
 .ğ
$wr™”
->
	`şo£
();

309 
$¥Off£ts
 = 
$wr™”
->
	`g‘SpOff£ts
();

310 
$¥Ty³s
 = 
$wr™”
->
	`g‘SpTy³s
();

313 
	`fÜ—ch
 (
$¥Off£ts
 
as
 & 
$¥Off£t
) {

314 
$¥Off£t
 += 24;

317 
$this
->
¥Off£ts
 = 
$¥Off£ts
;

318 
$this
->
¥Ty³s
 = 
$¥Ty³s
;

322 
$»cV”
 = 0xF;

323 
$»cIn¡ªû
 = 0x0000;

324 
$»cTy³
 = 0xF002;

325 
$Ëngth
 = 
	`¡¾’
(
$šÃrD©a
);

327 
$»cV”In¡ªû
 = 
$»cV”
;

328 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

330 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

332 
$this
->
d©a
 = 
$h—d”
 . 
$šÃrD©a
;

338 
$šÃrD©a
 = '';

341 
$tÙ®Size
 = 8;

342 
$¥Off£ts
 = 
	`¬¿y
();

343 
$¥Ty³s
 = 
	`¬¿y
();

346 
	`fÜ—ch
 (
$this
->
objeù
->
	`g‘Chd»n
(è
as
 
$¥CÚš”
) {

347 
$wr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_Esch”
(
$¥CÚš”
);

348 
$¥D©a
 = 
$wr™”
->
	`şo£
();

349 
$šÃrD©a
 .ğ
$¥D©a
;

352 
$tÙ®Size
 +ğ
	`¡¾’
(
$¥D©a
);

353 
$¥Off£ts
[] = 
$tÙ®Size
;

355 
$¥Ty³s
 = 
	`¬¿y_m”ge
($¥Ty³s, 
$wr™”
->
	`g‘SpTy³s
());

359 
$»cV”
 = 0xF;

360 
$»cIn¡ªû
 = 0x0000;

361 
$»cTy³
 = 0xF003;

362 
$Ëngth
 = 
	`¡¾’
(
$šÃrD©a
);

364 
$»cV”In¡ªû
 = 
$»cV”
;

365 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

367 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

369 
$this
->
d©a
 = 
$h—d”
 . 
$šÃrD©a
;

370 
$this
->
¥Off£ts
 = 
$¥Off£ts
;

371 
$this
->
¥Ty³s
 = 
$¥Ty³s
;

375 
$d©a
 = '';

380 ià(
$this
->
objeù
->
	`g‘Spgr
()) {

381 
$»cV”
 = 0x1;

382 
$»cIn¡ªû
 = 0x0000;

383 
$»cTy³
 = 0xF009;

384 
$Ëngth
 = 0x00000010;

386 
$»cV”In¡ªû
 = 
$»cV”
;

387 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

389 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

391 
$d©a
 .ğ
$h—d”
 . 
	`·ck
('VVVV', 0, 0, 0, 0);

393 
$this
->
¥Ty³s
[] = ($this->
objeù
->
	`g‘SpTy³
());

396 
$»cV”
 = 0x2;

397 
$»cIn¡ªû
 = 
$this
->
objeù
->
	`g‘SpTy³
();

398 
$»cTy³
 = 0xF00A;

399 
$Ëngth
 = 0x00000008;

401 
$»cV”In¡ªû
 = 
$»cV”
;

402 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

404 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

406 
$d©a
 .ğ
$h—d”
 . 
	`·ck
('VV', 
$this
->
objeù
->
	`g‘SpId
(), $this->objeù->
	`g‘Spgr
() ? 0x0005 : 0x0A00);

410 ià(
$this
->
objeù
->
	`g‘OPTCŞËùiÚ
()) {

411 
$İtD©a
 = '';

413 
$»cV”
 = 0x3;

414 
$»cIn¡ªû
 = 
	`couÁ
(
$this
->
objeù
->
	`g‘OPTCŞËùiÚ
());

415 
$»cTy³
 = 0xF00B;

416 
	`fÜ—ch
 (
$this
->
objeù
->
	`g‘OPTCŞËùiÚ
(è
as
 
$´İ”ty
 => 
$v®ue
) {

417 
$İtD©a
 .ğ
	`·ck
('vV', 
$´İ”ty
, 
$v®ue
);

419 
$Ëngth
 = 
	`¡¾’
(
$İtD©a
);

421 
$»cV”In¡ªû
 = 
$»cV”
;

422 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

424 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

425 
$d©a
 .ğ
$h—d”
 . 
$İtD©a
;

429 ià(
$this
->
objeù
->
	`g‘S¹CoÜdš©es
()) {

430 
$ş›ÁAnchÜD©a
 = '';

432 
$»cV”
 = 0x0;

433 
$»cIn¡ªû
 = 0x0;

434 
$»cTy³
 = 0xF010;

437 
	`li¡
(
$cŞumn
, 
$row
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$this
->
objeù
->
	`g‘S¹CoÜdš©es
());

438 
$c1
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞumn
) - 1;

439 
$r1
 = 
$row
 - 1;

442 
$¡¬tOff£tX
 = 
$this
->
objeù
->
	`g‘S¹Off£tX
();

445 
$¡¬tOff£tY
 = 
$this
->
objeù
->
	`g‘S¹Off£tY
();

448 
	`li¡
(
$cŞumn
, 
$row
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$this
->
objeù
->
	`g‘EndCoÜdš©es
());

449 
$c2
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞumn
) - 1;

450 
$r2
 = 
$row
 - 1;

453 
$’dOff£tX
 = 
$this
->
objeù
->
	`g‘EndOff£tX
();

456 
$’dOff£tY
 = 
$this
->
objeù
->
	`g‘EndOff£tY
();

458 
$ş›ÁAnchÜD©a
 = 
	`·ck
('vvvvvvvvv', 
$this
->
objeù
->
	`g‘SpFÏg
(), 
$c1
, 
$¡¬tOff£tX
, 
$r1
, 
$¡¬tOff£tY
, 
$c2
, 
$’dOff£tX
, 
$r2
, 
$’dOff£tY
);

460 
$Ëngth
 = 
	`¡¾’
(
$ş›ÁAnchÜD©a
);

462 
$»cV”In¡ªû
 = 
$»cV”
;

463 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

465 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

466 
$d©a
 .ğ
$h—d”
 . 
$ş›ÁAnchÜD©a
;

470 ià(!
$this
->
objeù
->
	`g‘Spgr
()) {

471 
$ş›ÁD©aD©a
 = '';

473 
$»cV”
 = 0x0;

474 
$»cIn¡ªû
 = 0x0;

475 
$»cTy³
 = 0xF011;

477 
$Ëngth
 = 
	`¡¾’
(
$ş›ÁD©aD©a
);

479 
$»cV”In¡ªû
 = 
$»cV”
;

480 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

482 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

483 
$d©a
 .ğ
$h—d”
 . 
$ş›ÁD©aD©a
;

487 
$»cV”
 = 0xF;

488 
$»cIn¡ªû
 = 0x0000;

489 
$»cTy³
 = 0xF004;

490 
$Ëngth
 = 
	`¡¾’
(
$d©a
);

492 
$»cV”In¡ªû
 = 
$»cV”
;

493 
$»cV”In¡ªû
 |ğ
$»cIn¡ªû
 << 4;

495 
$h—d”
 = 
	`·ck
('vvV', 
$»cV”In¡ªû
, 
$»cTy³
, 
$Ëngth
);

497 
$this
->
d©a
 = 
$h—d”
 . 
$d©a
;

501  
$this
->
d©a
;

502 
	}
}

509 
public
 
funùiÚ
 
	$g‘SpOff£ts
()

511  
$this
->
¥Off£ts
;

512 
	}
}

519 
public
 
funùiÚ
 
	$g‘SpTy³s
()

521  
$this
->
¥Ty³s
;

522 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Font.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exûl5_FÚt


35 
´iv©e
 
	m$cŞÜIndex
;

42 
´iv©e
 
	m$fÚt
;

49 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_StyË_FÚt
 
$fÚt
 = 
nuÎ
)

51 
$this
->
cŞÜIndex
 = 0x7FFF;

52 
$this
->
fÚt
 = 
$fÚt
;

60 
public
 
funùiÚ
 
	$£tCŞÜIndex
(
$cŞÜIndex
)

62 
$this
->
cŞÜIndex
 = 
$cŞÜIndex
;

63 
	}
}

70 
public
 
funùiÚ
 
	$wr™eFÚt
()

72 
$fÚt_ouše
 = 0;

73 
$fÚt_shadow
 = 0;

75 
$icv
 = 
$this
->
cŞÜIndex
;

76 ià(
$this
->
fÚt
->
	`g‘Su³rSüt
()) {

77 
$sss
 = 1;

78 } 
	`–£if
 (
$this
->
fÚt
->
	`g‘SubSüt
()) {

79 
$sss
 = 2;

81 
$sss
 = 0;

83 
$bFamy
 = 0;

84 
$bCh¬S‘
 = 
PHPExûl_Sh¬ed_FÚt
::
	`g‘Ch¬£tFromFÚtName
(
$this
->
fÚt
->
	`g‘Name
());

86 
$»cÜd
 = 0x31;

87 
$»£rved
 = 0x00;

88 
$grb™
 = 0x00;

89 ià(
$this
->
fÚt
->
	`g‘Ilic
()) {

90 
$grb™
 |= 0x02;

92 ià(
$this
->
fÚt
->
	`g‘SŒik‘hrough
()) {

93 
$grb™
 |= 0x08;

95 ià(
$fÚt_ouše
) {

96 
$grb™
 |= 0x10;

98 ià(
$fÚt_shadow
) {

99 
$grb™
 |= 0x20;

102 
$d©a
 = 
	`·ck
(

105 
$this
->
fÚt
->
	`g‘Size
() * 20,

106 
$grb™
,

108 
$icv
,

110 
£lf
::
	`m­BŞd
(
$this
->
fÚt
->
	`g‘BŞd
()),

112 
$sss
,

113 
£lf
::
	`m­Und”lše
(
$this
->
fÚt
->
	`g‘Und”lše
()),

114 
$bFamy
,

115 
$bCh¬S‘
,

116 
$»£rved


118 
$d©a
 .ğ
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeShÜt
(
$this
->
fÚt
->
	`g‘Name
());

120 
$Ëngth
 = 
	`¡¾’
(
$d©a
);

121 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

123 (
$h—d”
 . 
$d©a
);

124 
	}
}

132 
´iv©e
 
funùiÚ
 
	$m­BŞd
(
$bŞd
)

134 ià(
$bŞd
) {

138 
	}
}

145 
´iv©e
 
	g$m­Und”lše
 = 
¬¿y
(

146 
PHPExûl_StyË_FÚt
::
UNDERLINE_NONE
 => 0x00,

147 
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLE
 => 0x01,

148 
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLE
 => 0x02,

149 
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLEACCOUNTING
 => 0x21,

150 
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLEACCOUNTING
 => 0x22,

159 
´iv©e
 
funùiÚ
 
	$m­Und”lše
(
$und”lše
)

161 ià(
	`is£t
(
£lf
::
$m­Und”lše
[
$und”lše
])) {

162  
£lf
::
$m­Und”lše
[
$und”lše
];

165 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Parser.php

1 <?
php


52 şas 
	cPHPExûl_Wr™”_Exûl5_P¬£r


60 cÚ¡ 
	mREGEX_SHEET_TITLE_UNQUOTED
 = '[^\*\:\/\\\\\?\[\]\+\-\% \\\'\^\&\<\>\=\,\;\#\(\)\"\{\}]+';

66 cÚ¡ 
	mREGEX_SHEET_TITLE_QUOTED
 = '(([^\*\:\/\\\\\?\[\]\\\'])+|(\\\'\\\')+)+';

72 
public
 
	m$cu¼’tCh¬aù”
;

78 
public
 
	m$cu¼’tTok’
;

84 
´iv©e
 
	m$fÜmuÏ
;

90 
public
 
	m$lookAh—d
;

96 
´iv©e
 
	m$·r£T»e
;

102 
´iv©e
 
	m$ex‹º®Sh“ts
;

108 
public
 
	m$»ã»nûs
;

114 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

116 
$this
->
cu¼’tCh¬aù”
 = 0;

117 
$this
->
cu¼’tTok’
 = '';

118 
$this
->
fÜmuÏ
 = '';

119 
$this
->
lookAh—d
 = '';

120 
$this
->
·r£T»e
 = '';

121 
$this
->
	`š™ŸlizeHashes
();

122 
$this
->
ex‹º®Sh“ts
 = 
	`¬¿y
();

123 
$this
->
»ã»nûs
 = 
	`¬¿y
();

131 
´iv©e
 
funùiÚ
 
	$š™ŸlizeHashes
()

134 
$this
->
±g
 = 
	`¬¿y
(

245 
$this
->
funùiÚs
 = 
	`¬¿y
(

247 'COUNT' => 
	`¬¿y
( 0, -1, 0, 0 ),

248 'IF' => 
	`¬¿y
( 1, -1, 1, 0 ),

249 'ISNA' => 
	`¬¿y
( 2, 1, 1, 0 ),

250 'ISERROR' => 
	`¬¿y
( 3, 1, 1, 0 ),

251 'SUM' => 
	`¬¿y
( 4, -1, 0, 0 ),

252 'AVERAGE' => 
	`¬¿y
( 5, -1, 0, 0 ),

253 'MIN' => 
	`¬¿y
( 6, -1, 0, 0 ),

254 'MAX' => 
	`¬¿y
( 7, -1, 0, 0 ),

255 'ROW' => 
	`¬¿y
( 8, -1, 0, 0 ),

256 'COLUMN' => 
	`¬¿y
( 9, -1, 0, 0 ),

257 'NA' => 
	`¬¿y
( 10, 0, 0, 0 ),

258 'NPV' => 
	`¬¿y
( 11, -1, 1, 0 ),

259 'STDEV' => 
	`¬¿y
( 12, -1, 0, 0 ),

260 'DOLLAR' => 
	`¬¿y
( 13, -1, 1, 0 ),

261 'FIXED' => 
	`¬¿y
( 14, -1, 1, 0 ),

262 'SIN' => 
	`¬¿y
( 15, 1, 1, 0 ),

263 'COS' => 
	`¬¿y
( 16, 1, 1, 0 ),

264 'TAN' => 
	`¬¿y
( 17, 1, 1, 0 ),

265 'ATAN' => 
	`¬¿y
( 18, 1, 1, 0 ),

266 'PI' => 
	`¬¿y
( 19, 0, 1, 0 ),

267 'SQRT' => 
	`¬¿y
( 20, 1, 1, 0 ),

268 'EXP' => 
	`¬¿y
( 21, 1, 1, 0 ),

269 'LN' => 
	`¬¿y
( 22, 1, 1, 0 ),

270 'LOG10' => 
	`¬¿y
( 23, 1, 1, 0 ),

271 'ABS' => 
	`¬¿y
( 24, 1, 1, 0 ),

272 'INT' => 
	`¬¿y
( 25, 1, 1, 0 ),

273 'SIGN' => 
	`¬¿y
( 26, 1, 1, 0 ),

274 'ROUND' => 
	`¬¿y
( 27, 2, 1, 0 ),

275 'LOOKUP' => 
	`¬¿y
( 28, -1, 0, 0 ),

276 'INDEX' => 
	`¬¿y
( 29, -1, 0, 1 ),

277 'REPT' => 
	`¬¿y
( 30, 2, 1, 0 ),

278 'MID' => 
	`¬¿y
( 31, 3, 1, 0 ),

279 'LEN' => 
	`¬¿y
( 32, 1, 1, 0 ),

280 'VALUE' => 
	`¬¿y
( 33, 1, 1, 0 ),

281 'TRUE' => 
	`¬¿y
( 34, 0, 1, 0 ),

282 'FALSE' => 
	`¬¿y
( 35, 0, 1, 0 ),

283 'AND' => 
	`¬¿y
( 36, -1, 0, 0 ),

284 'OR' => 
	`¬¿y
( 37, -1, 0, 0 ),

285 'NOT' => 
	`¬¿y
( 38, 1, 1, 0 ),

286 'MOD' => 
	`¬¿y
( 39, 2, 1, 0 ),

287 'DCOUNT' => 
	`¬¿y
( 40, 3, 0, 0 ),

288 'DSUM' => 
	`¬¿y
( 41, 3, 0, 0 ),

289 'DAVERAGE' => 
	`¬¿y
( 42, 3, 0, 0 ),

290 'DMIN' => 
	`¬¿y
( 43, 3, 0, 0 ),

291 'DMAX' => 
	`¬¿y
( 44, 3, 0, 0 ),

292 'DSTDEV' => 
	`¬¿y
( 45, 3, 0, 0 ),

293 'VAR' => 
	`¬¿y
( 46, -1, 0, 0 ),

294 'DVAR' => 
	`¬¿y
( 47, 3, 0, 0 ),

295 'TEXT' => 
	`¬¿y
( 48, 2, 1, 0 ),

296 'LINEST' => 
	`¬¿y
( 49, -1, 0, 0 ),

297 'TREND' => 
	`¬¿y
( 50, -1, 0, 0 ),

298 'LOGEST' => 
	`¬¿y
( 51, -1, 0, 0 ),

299 'GROWTH' => 
	`¬¿y
( 52, -1, 0, 0 ),

300 'PV' => 
	`¬¿y
( 56, -1, 1, 0 ),

301 'FV' => 
	`¬¿y
( 57, -1, 1, 0 ),

302 'NPER' => 
	`¬¿y
( 58, -1, 1, 0 ),

303 'PMT' => 
	`¬¿y
( 59, -1, 1, 0 ),

304 'RATE' => 
	`¬¿y
( 60, -1, 1, 0 ),

305 'MIRR' => 
	`¬¿y
( 61, 3, 0, 0 ),

306 'IRR' => 
	`¬¿y
( 62, -1, 0, 0 ),

307 'RAND' => 
	`¬¿y
( 63, 0, 1, 1 ),

308 'MATCH' => 
	`¬¿y
( 64, -1, 0, 0 ),

309 'DATE' => 
	`¬¿y
( 65, 3, 1, 0 ),

310 'TIME' => 
	`¬¿y
( 66, 3, 1, 0 ),

311 'DAY' => 
	`¬¿y
( 67, 1, 1, 0 ),

312 'MONTH' => 
	`¬¿y
( 68, 1, 1, 0 ),

313 'YEAR' => 
	`¬¿y
( 69, 1, 1, 0 ),

314 'WEEKDAY' => 
	`¬¿y
( 70, -1, 1, 0 ),

315 'HOUR' => 
	`¬¿y
( 71, 1, 1, 0 ),

316 'MINUTE' => 
	`¬¿y
( 72, 1, 1, 0 ),

317 'SECOND' => 
	`¬¿y
( 73, 1, 1, 0 ),

318 'NOW' => 
	`¬¿y
( 74, 0, 1, 1 ),

319 'AREAS' => 
	`¬¿y
( 75, 1, 0, 1 ),

320 'ROWS' => 
	`¬¿y
( 76, 1, 0, 1 ),

321 'COLUMNS' => 
	`¬¿y
( 77, 1, 0, 1 ),

322 'OFFSET' => 
	`¬¿y
( 78, -1, 0, 1 ),

323 'SEARCH' => 
	`¬¿y
( 82, -1, 1, 0 ),

324 'TRANSPOSE' => 
	`¬¿y
( 83, 1, 1, 0 ),

325 'TYPE' => 
	`¬¿y
( 86, 1, 1, 0 ),

326 'ATAN2' => 
	`¬¿y
( 97, 2, 1, 0 ),

327 'ASIN' => 
	`¬¿y
( 98, 1, 1, 0 ),

328 'ACOS' => 
	`¬¿y
( 99, 1, 1, 0 ),

329 'CHOOSE' => 
	`¬¿y
( 100, -1, 1, 0 ),

330 'HLOOKUP' => 
	`¬¿y
( 101, -1, 0, 0 ),

331 'VLOOKUP' => 
	`¬¿y
( 102, -1, 0, 0 ),

332 'ISREF' => 
	`¬¿y
( 105, 1, 0, 0 ),

333 'LOG' => 
	`¬¿y
( 109, -1, 1, 0 ),

334 'CHAR' => 
	`¬¿y
( 111, 1, 1, 0 ),

335 'LOWER' => 
	`¬¿y
( 112, 1, 1, 0 ),

336 'UPPER' => 
	`¬¿y
( 113, 1, 1, 0 ),

337 'PROPER' => 
	`¬¿y
( 114, 1, 1, 0 ),

338 'LEFT' => 
	`¬¿y
( 115, -1, 1, 0 ),

339 'RIGHT' => 
	`¬¿y
( 116, -1, 1, 0 ),

340 'EXACT' => 
	`¬¿y
( 117, 2, 1, 0 ),

341 'TRIM' => 
	`¬¿y
( 118, 1, 1, 0 ),

342 'REPLACE' => 
	`¬¿y
( 119, 4, 1, 0 ),

343 'SUBSTITUTE' => 
	`¬¿y
( 120, -1, 1, 0 ),

344 'CODE' => 
	`¬¿y
( 121, 1, 1, 0 ),

345 'FIND' => 
	`¬¿y
( 124, -1, 1, 0 ),

346 'CELL' => 
	`¬¿y
( 125, -1, 0, 1 ),

347 'ISERR' => 
	`¬¿y
( 126, 1, 1, 0 ),

348 'ISTEXT' => 
	`¬¿y
( 127, 1, 1, 0 ),

349 'ISNUMBER' => 
	`¬¿y
( 128, 1, 1, 0 ),

350 'ISBLANK' => 
	`¬¿y
( 129, 1, 1, 0 ),

351 'T' => 
	`¬¿y
( 130, 1, 0, 0 ),

352 'N' => 
	`¬¿y
( 131, 1, 0, 0 ),

353 'DATEVALUE' => 
	`¬¿y
( 140, 1, 1, 0 ),

354 'TIMEVALUE' => 
	`¬¿y
( 141, 1, 1, 0 ),

355 'SLN' => 
	`¬¿y
( 142, 3, 1, 0 ),

356 'SYD' => 
	`¬¿y
( 143, 4, 1, 0 ),

357 'DDB' => 
	`¬¿y
( 144, -1, 1, 0 ),

358 'INDIRECT' => 
	`¬¿y
( 148, -1, 1, 1 ),

359 'CALL' => 
	`¬¿y
( 150, -1, 1, 0 ),

360 'CLEAN' => 
	`¬¿y
( 162, 1, 1, 0 ),

361 'MDETERM' => 
	`¬¿y
( 163, 1, 2, 0 ),

362 'MINVERSE' => 
	`¬¿y
( 164, 1, 2, 0 ),

363 'MMULT' => 
	`¬¿y
( 165, 2, 2, 0 ),

364 'IPMT' => 
	`¬¿y
( 167, -1, 1, 0 ),

365 'PPMT' => 
	`¬¿y
( 168, -1, 1, 0 ),

366 'COUNTA' => 
	`¬¿y
( 169, -1, 0, 0 ),

367 'PRODUCT' => 
	`¬¿y
( 183, -1, 0, 0 ),

368 'FACT' => 
	`¬¿y
( 184, 1, 1, 0 ),

369 'DPRODUCT' => 
	`¬¿y
( 189, 3, 0, 0 ),

370 'ISNONTEXT' => 
	`¬¿y
( 190, 1, 1, 0 ),

371 'STDEVP' => 
	`¬¿y
( 193, -1, 0, 0 ),

372 'VARP' => 
	`¬¿y
( 194, -1, 0, 0 ),

373 'DSTDEVP' => 
	`¬¿y
( 195, 3, 0, 0 ),

374 'DVARP' => 
	`¬¿y
( 196, 3, 0, 0 ),

375 'TRUNC' => 
	`¬¿y
( 197, -1, 1, 0 ),

376 'ISLOGICAL' => 
	`¬¿y
( 198, 1, 1, 0 ),

377 'DCOUNTA' => 
	`¬¿y
( 199, 3, 0, 0 ),

378 'USDOLLAR' => 
	`¬¿y
( 204, -1, 1, 0 ),

379 'FINDB' => 
	`¬¿y
( 205, -1, 1, 0 ),

380 'SEARCHB' => 
	`¬¿y
( 206, -1, 1, 0 ),

381 'REPLACEB' => 
	`¬¿y
( 207, 4, 1, 0 ),

382 'LEFTB' => 
	`¬¿y
( 208, -1, 1, 0 ),

383 'RIGHTB' => 
	`¬¿y
( 209, -1, 1, 0 ),

384 'MIDB' => 
	`¬¿y
( 210, 3, 1, 0 ),

385 'LENB' => 
	`¬¿y
( 211, 1, 1, 0 ),

386 'ROUNDUP' => 
	`¬¿y
( 212, 2, 1, 0 ),

387 'ROUNDDOWN' => 
	`¬¿y
( 213, 2, 1, 0 ),

388 'ASC' => 
	`¬¿y
( 214, 1, 1, 0 ),

389 'DBCS' => 
	`¬¿y
( 215, 1, 1, 0 ),

390 'RANK' => 
	`¬¿y
( 216, -1, 0, 0 ),

391 'ADDRESS' => 
	`¬¿y
( 219, -1, 1, 0 ),

392 'DAYS360' => 
	`¬¿y
( 220, -1, 1, 0 ),

393 'TODAY' => 
	`¬¿y
( 221, 0, 1, 1 ),

394 'VDB' => 
	`¬¿y
( 222, -1, 1, 0 ),

395 'MEDIAN' => 
	`¬¿y
( 227, -1, 0, 0 ),

396 'SUMPRODUCT' => 
	`¬¿y
( 228, -1, 2, 0 ),

397 'SINH' => 
	`¬¿y
( 229, 1, 1, 0 ),

398 'COSH' => 
	`¬¿y
( 230, 1, 1, 0 ),

399 'TANH' => 
	`¬¿y
( 231, 1, 1, 0 ),

400 'ASINH' => 
	`¬¿y
( 232, 1, 1, 0 ),

401 'ACOSH' => 
	`¬¿y
( 233, 1, 1, 0 ),

402 'ATANH' => 
	`¬¿y
( 234, 1, 1, 0 ),

403 'DGET' => 
	`¬¿y
( 235, 3, 0, 0 ),

404 'INFO' => 
	`¬¿y
( 244, 1, 1, 1 ),

405 'DB' => 
	`¬¿y
( 247, -1, 1, 0 ),

406 'FREQUENCY' => 
	`¬¿y
( 252, 2, 0, 0 ),

407 'ERROR.TYPE' => 
	`¬¿y
( 261, 1, 1, 0 ),

408 'REGISTER.ID' => 
	`¬¿y
( 267, -1, 1, 0 ),

409 'AVEDEV' => 
	`¬¿y
( 269, -1, 0, 0 ),

410 'BETADIST' => 
	`¬¿y
( 270, -1, 1, 0 ),

411 'GAMMALN' => 
	`¬¿y
( 271, 1, 1, 0 ),

412 'BETAINV' => 
	`¬¿y
( 272, -1, 1, 0 ),

413 'BINOMDIST' => 
	`¬¿y
( 273, 4, 1, 0 ),

414 'CHIDIST' => 
	`¬¿y
( 274, 2, 1, 0 ),

415 'CHIINV' => 
	`¬¿y
( 275, 2, 1, 0 ),

416 'COMBIN' => 
	`¬¿y
( 276, 2, 1, 0 ),

417 'CONFIDENCE' => 
	`¬¿y
( 277, 3, 1, 0 ),

418 'CRITBINOM' => 
	`¬¿y
( 278, 3, 1, 0 ),

419 'EVEN' => 
	`¬¿y
( 279, 1, 1, 0 ),

420 'EXPONDIST' => 
	`¬¿y
( 280, 3, 1, 0 ),

421 'FDIST' => 
	`¬¿y
( 281, 3, 1, 0 ),

422 'FINV' => 
	`¬¿y
( 282, 3, 1, 0 ),

423 'FISHER' => 
	`¬¿y
( 283, 1, 1, 0 ),

424 'FISHERINV' => 
	`¬¿y
( 284, 1, 1, 0 ),

425 'FLOOR' => 
	`¬¿y
( 285, 2, 1, 0 ),

426 'GAMMADIST' => 
	`¬¿y
( 286, 4, 1, 0 ),

427 'GAMMAINV' => 
	`¬¿y
( 287, 3, 1, 0 ),

428 'CEILING' => 
	`¬¿y
( 288, 2, 1, 0 ),

429 'HYPGEOMDIST' => 
	`¬¿y
( 289, 4, 1, 0 ),

430 'LOGNORMDIST' => 
	`¬¿y
( 290, 3, 1, 0 ),

431 'LOGINV' => 
	`¬¿y
( 291, 3, 1, 0 ),

432 'NEGBINOMDIST' => 
	`¬¿y
( 292, 3, 1, 0 ),

433 'NORMDIST' => 
	`¬¿y
( 293, 4, 1, 0 ),

434 'NORMSDIST' => 
	`¬¿y
( 294, 1, 1, 0 ),

435 'NORMINV' => 
	`¬¿y
( 295, 3, 1, 0 ),

436 'NORMSINV' => 
	`¬¿y
( 296, 1, 1, 0 ),

437 'STANDARDIZE' => 
	`¬¿y
( 297, 3, 1, 0 ),

438 'ODD' => 
	`¬¿y
( 298, 1, 1, 0 ),

439 'PERMUT' => 
	`¬¿y
( 299, 2, 1, 0 ),

440 'POISSON' => 
	`¬¿y
( 300, 3, 1, 0 ),

441 'TDIST' => 
	`¬¿y
( 301, 3, 1, 0 ),

442 'WEIBULL' => 
	`¬¿y
( 302, 4, 1, 0 ),

443 'SUMXMY2' => 
	`¬¿y
( 303, 2, 2, 0 ),

444 'SUMX2MY2' => 
	`¬¿y
( 304, 2, 2, 0 ),

445 'SUMX2PY2' => 
	`¬¿y
( 305, 2, 2, 0 ),

446 'CHITEST' => 
	`¬¿y
( 306, 2, 2, 0 ),

447 'CORREL' => 
	`¬¿y
( 307, 2, 2, 0 ),

448 'COVAR' => 
	`¬¿y
( 308, 2, 2, 0 ),

449 'FORECAST' => 
	`¬¿y
( 309, 3, 2, 0 ),

450 'FTEST' => 
	`¬¿y
( 310, 2, 2, 0 ),

451 'INTERCEPT' => 
	`¬¿y
( 311, 2, 2, 0 ),

452 'PEARSON' => 
	`¬¿y
( 312, 2, 2, 0 ),

453 'RSQ' => 
	`¬¿y
( 313, 2, 2, 0 ),

454 'STEYX' => 
	`¬¿y
( 314, 2, 2, 0 ),

455 'SLOPE' => 
	`¬¿y
( 315, 2, 2, 0 ),

456 'TTEST' => 
	`¬¿y
( 316, 4, 2, 0 ),

457 'PROB' => 
	`¬¿y
( 317, -1, 2, 0 ),

458 'DEVSQ' => 
	`¬¿y
( 318, -1, 0, 0 ),

459 'GEOMEAN' => 
	`¬¿y
( 319, -1, 0, 0 ),

460 'HARMEAN' => 
	`¬¿y
( 320, -1, 0, 0 ),

461 'SUMSQ' => 
	`¬¿y
( 321, -1, 0, 0 ),

462 'KURT' => 
	`¬¿y
( 322, -1, 0, 0 ),

463 'SKEW' => 
	`¬¿y
( 323, -1, 0, 0 ),

464 'ZTEST' => 
	`¬¿y
( 324, -1, 0, 0 ),

465 'LARGE' => 
	`¬¿y
( 325, 2, 0, 0 ),

466 'SMALL' => 
	`¬¿y
( 326, 2, 0, 0 ),

467 'QUARTILE' => 
	`¬¿y
( 327, 2, 0, 0 ),

468 'PERCENTILE' => 
	`¬¿y
( 328, 2, 0, 0 ),

469 'PERCENTRANK' => 
	`¬¿y
( 329, -1, 0, 0 ),

470 'MODE' => 
	`¬¿y
( 330, -1, 2, 0 ),

471 'TRIMMEAN' => 
	`¬¿y
( 331, 2, 0, 0 ),

472 'TINV' => 
	`¬¿y
( 332, 2, 1, 0 ),

473 'CONCATENATE' => 
	`¬¿y
( 336, -1, 1, 0 ),

474 'POWER' => 
	`¬¿y
( 337, 2, 1, 0 ),

475 'RADIANS' => 
	`¬¿y
( 342, 1, 1, 0 ),

476 'DEGREES' => 
	`¬¿y
( 343, 1, 1, 0 ),

477 'SUBTOTAL' => 
	`¬¿y
( 344, -1, 0, 0 ),

478 'SUMIF' => 
	`¬¿y
( 345, -1, 0, 0 ),

479 'COUNTIF' => 
	`¬¿y
( 346, 2, 0, 0 ),

480 'COUNTBLANK' => 
	`¬¿y
( 347, 1, 0, 0 ),

481 'ISPMT' => 
	`¬¿y
( 350, 4, 1, 0 ),

482 'DATEDIF' => 
	`¬¿y
( 351, 3, 1, 0 ),

483 'DATESTRING' => 
	`¬¿y
( 352, 1, 1, 0 ),

484 'NUMBERSTRING' => 
	`¬¿y
( 353, 2, 1, 0 ),

485 'ROMAN' => 
	`¬¿y
( 354, -1, 1, 0 ),

486 'GETPIVOTDATA' => 
	`¬¿y
( 358, -1, 0, 0 ),

487 'HYPERLINK' => 
	`¬¿y
( 359, -1, 1, 0 ),

488 'PHONETIC' => 
	`¬¿y
( 360, 1, 0, 0 ),

489 'AVERAGEA' => 
	`¬¿y
( 361, -1, 0, 0 ),

490 'MAXA' => 
	`¬¿y
( 362, -1, 0, 0 ),

491 'MINA' => 
	`¬¿y
( 363, -1, 0, 0 ),

492 'STDEVPA' => 
	`¬¿y
( 364, -1, 0, 0 ),

493 'VARPA' => 
	`¬¿y
( 365, -1, 0, 0 ),

494 'STDEVA' => 
	`¬¿y
( 366, -1, 0, 0 ),

495 'VARA' => 
	`¬¿y
( 367, -1, 0, 0 ),

496 'BAHTTEXT' => 
	`¬¿y
( 368, 1, 0, 0 ),

498 
	}
}

507 
´iv©e
 
funùiÚ
 
	$cÚv”t
(
$tok’
)

509 ià(
	`´eg_m©ch
("/\"([^\"]|\"\"){0,255}\"/", 
$tok’
)) {

510  
$this
->
	`cÚv”tSŒšg
(
$tok’
);

512 } 
	`–£if
 (
	`is_num”ic
(
$tok’
)) {

513  
$this
->
	`cÚv”tNumb”
(
$tok’
);

516 } 
	`–£if
 (
	`´eg_m©ch
('/^\$?([A-Ia-i]?[A-Za-z])\$?(\d+)$/', 
$tok’
)) {

517  
$this
->
	`cÚv”tRef2d
(
$tok’
);

520 } 
	`–£if
 (
	`´eg_m©ch
("/^" . 
£lf
::
REGEX_SHEET_TITLE_UNQUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_UNQUOTED . ")?\!\\$?[A-Ia-i]?[A-Za-z]\\$?(\d+)$/u", 
$tok’
)) {

521  
$this
->
	`cÚv”tRef3d
(
$tok’
);

524 } 
	`–£if
 (
	`´eg_m©ch
("/^'" . 
£lf
::
REGEX_SHEET_TITLE_QUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_QUOTED . ")?'\!\\$?[A-Ia-i]?[A-Za-z]\\$?(\d+)$/u", 
$tok’
)) {

525  
$this
->
	`cÚv”tRef3d
(
$tok’
);

528 } 
	`–£if
 (
	`´eg_m©ch
('/^(\$)?[A-Ia-i]?[A-Za-z](\$)?(\d+)\:(\$)?[A-Ia-i]?[A-Za-z](\$)?(\d+)$/', 
$tok’
)) {

529  
$this
->
	`cÚv”tRªge2d
(
$tok’
);

532 } 
	`–£if
 (
	`´eg_m©ch
("/^" . 
£lf
::
REGEX_SHEET_TITLE_UNQUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_UNQUOTED . ")?\!\\$?([A-Ia-i]?[A-Za-z])?\\$?(\d+)\:\\$?([A-Ia-i]?[A-Za-z])?\\$?(\d+)$/u", 
$tok’
)) {

533  
$this
->
	`cÚv”tRªge3d
(
$tok’
);

536 } 
	`–£if
 (
	`´eg_m©ch
("/^'" . 
£lf
::
REGEX_SHEET_TITLE_QUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_QUOTED . ")?'\!\\$?([A-Ia-i]?[A-Za-z])?\\$?(\d+)\:\\$?([A-Ia-i]?[A-Za-z])?\\$?(\d+)$/u", 
$tok’
)) {

537  
$this
->
	`cÚv”tRªge3d
(
$tok’
);

540 } 
	`–£if
 (
	`is£t
(
$this
->
±g
[
$tok’
])) {

541  
	`·ck
("C", 
$this
->
±g
[
$tok’
]);

544 } 
	`–£if
 (
	`´eg_m©ch
("/^#[A-Z0\/]{3,5}[!?]{1}$/", 
$tok’
è
Ü
 $token == '#N/A') {

545  
$this
->
	`cÚv”tE¼Ü
(
$tok’
);

554 } 
	`–£if
 (
$tok’
 == 'arg') {

559 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Unknownoken $token");

560 
	}
}

568 
´iv©e
 
funùiÚ
 
	$cÚv”tNumb”
(
$num
)

571 ià((
	`´eg_m©ch
("/^\d+$/", 
$num
)è
	`ªd
 ($num <= 65535)) {

572  
	`·ck
("Cv", 
$this
->
±g
['±gIÁ'], 
$num
);

574 ià(
PHPExûl_Wr™”_Exûl5_BIFFwr™”
::
	`g‘By‹Ord”
()) {

575 
$num
 = 
	`¡¼ev
($num);

577  
	`·ck
("Cd", 
$this
->
±g
['±gNum'], 
$num
);

579 
	}
}

588 
´iv©e
 
funùiÚ
 
	$cÚv”tSŒšg
(
$¡ršg
)

591 
$¡ršg
 = 
	`sub¡r
($¡ršg, 1, 
	`¡¾’
($string) - 2);

592 ià(
	`¡¾’
(
$¡ršg
) > 255) {

593 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("String isoo†ong");

596  
	`·ck
('C', 
$this
->
±g
['±gSŒ']è. 
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeShÜt
(
$¡ršg
);

597 
	}
}

608 
´iv©e
 
funùiÚ
 
	$cÚv”tFunùiÚ
(
$tok’
, 
$num_¬gs
)

610 
$¬gs
 = 
$this
->
funùiÚs
[
$tok’
][1];

614 ià(
$¬gs
 >= 0) {

615  
	`·ck
("Cv", 
$this
->
±g
['±gFuncV'], $this->
funùiÚs
[
$tok’
][0]);

618 ià(
$¬gs
 == -1) {

619  
	`·ck
("CCv", 
$this
->
±g
['±gFuncV¬V'], 
$num_¬gs
, $this->
funùiÚs
[
$tok’
][0]);

621 
	}
}

630 
´iv©e
 
funùiÚ
 
	$cÚv”tRªge2d
(
$¿nge
, 
$şass
 = 0)

635 ià(
	`´eg_m©ch
('/^(\$)?([A-Ia-i]?[A-Za-z])(\$)?(\d+)\:(\$)?([A-Ia-i]?[A-Za-z])(\$)?(\d+)$/', 
$¿nge
)) {

636 
	`li¡
(
$ûÎ1
, 
$ûÎ2
èğ
	`ex¶ode
(':', 
$¿nge
);

639 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Unknown„ange separator");

643 
	`li¡
(
$row1
, 
$cŞ1
èğ
$this
->
	`ûÎToPackedRowcŞ
(
$ûÎ1
);

644 
	`li¡
(
$row2
, 
$cŞ2
èğ
$this
->
	`ûÎToPackedRowcŞ
(
$ûÎ2
);

647 ià(
$şass
 == 0) {

648 
$±gA»a
 = 
	`·ck
("C", 
$this
->
±g
['ptgArea']);

649 } 
	`–£if
 (
$şass
 == 1) {

650 
$±gA»a
 = 
	`·ck
("C", 
$this
->
±g
['ptgAreaV']);

651 } 
	`–£if
 (
$şass
 == 2) {

652 
$±gA»a
 = 
	`·ck
("C", 
$this
->
±g
['ptgAreaA']);

655 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Unknown class $class");

657  
$±gA»a
 . 
$row1
 . 
$row2
 . 
$cŞ1
. 
$cŞ2
;

658 
	}
}

668 
´iv©e
 
funùiÚ
 
	$cÚv”tRªge3d
(
$tok’
)

673 
	`li¡
(
$ext_»f
, 
$¿nge
èğ
	`ex¶ode
('!', 
$tok’
);

676 
$ext_»f
 = 
$this
->
	`g‘RefIndex
($ext_ref);

679 
	`li¡
(
$ûÎ1
, 
$ûÎ2
èğ
	`ex¶ode
(':', 
$¿nge
);

682 ià(
	`´eg_m©ch
("/^(\\$)?[A-Ia-i]?[A-Za-z](\\$)?(\d+)$/", 
$ûÎ1
)) {

683 
	`li¡
(
$row1
, 
$cŞ1
èğ
$this
->
	`ûÎToPackedRowcŞ
(
$ûÎ1
);

684 
	`li¡
(
$row2
, 
$cŞ2
èğ
$this
->
	`ûÎToPackedRowcŞ
(
$ûÎ2
);

686 
	`li¡
(
$row1
, 
$cŞ1
, 
$row2
, 
$cŞ2
èğ
$this
->
	`¿ngeToPackedRªge
(
$ûÎ1
.':'.
$ûÎ2
);

691 
$±gA»a
 = 
	`·ck
("C", 
$this
->
±g
['ptgArea3d']);

700  
$±gA»a
 . 
$ext_»f
 . 
$row1
 . 
$row2
 . 
$cŞ1
. 
$cŞ2
;

701 
	}
}

710 
´iv©e
 
funùiÚ
 
	$cÚv”tRef2d
(
$ûÎ
)

715 
$ûÎ_¬¿y
 = 
$this
->
	`ûÎToPackedRowcŞ
(
$ûÎ
);

716 
	`li¡
(
$row
, 
$cŞ
èğ
$ûÎ_¬¿y
;

724 
$±gRef
 = 
	`·ck
("C", 
$this
->
±g
['ptgRefA']);

729  
$±gRef
.
$row
.
$cŞ
;

730 
	}
}

740 
´iv©e
 
funùiÚ
 
	$cÚv”tRef3d
(
$ûÎ
)

745 
	`li¡
(
$ext_»f
, 
$ûÎ
èğ
	`ex¶ode
('!', $cell);

748 
$ext_»f
 = 
$this
->
	`g‘RefIndex
($ext_ref);

751 
	`li¡
(
$row
, 
$cŞ
èğ
$this
->
	`ûÎToPackedRowcŞ
(
$ûÎ
);

759 
$±gRef
 = 
	`·ck
("C", 
$this
->
±g
['ptgRef3dA']);

764  
$±gRef
 . 
$ext_»f
. 
$row
 . 
$cŞ
;

765 
	}
}

774 
´iv©e
 
funùiÚ
 
	$cÚv”tE¼Ü
(
$”rÜCode
)

776 
$”rÜCode
) {

778  
	`·ck
("C", 0x00);

780  
	`·ck
("C", 0x07);

782  
	`·ck
("C", 0x0F);

784  
	`·ck
("C", 0x17);

786  
	`·ck
("C", 0x1D);

788  
	`·ck
("C", 0x24);

790  
	`·ck
("C", 0x2A);

792  
	`·ck
("C", 0xFF);

793 
	}
}

803 
´iv©e
 
funùiÚ
 
	$·ckExtRef
(
$ext_»f
)

805 
$ext_»f
 = 
	`´eg_»¶aû
("/^'/", '', $ext_ref);

806 
$ext_»f
 = 
	`´eg_»¶aû
("/'$/", '', $ext_ref);

809 ià(
	`´eg_m©ch
("/:/", 
$ext_»f
)) {

810 
	`li¡
(
$sh“t_Çme1
, 
$sh“t_Çme2
èğ
	`ex¶ode
(':', 
$ext_»f
);

812 
$sh“t1
 = 
$this
->
	`g‘Sh“tIndex
(
$sh“t_Çme1
);

813 ià(
$sh“t1
 == -1) {

814 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Unknown sheet‚ame $sheet_name1 in formula");

816 
$sh“t2
 = 
$this
->
	`g‘Sh“tIndex
(
$sh“t_Çme2
);

817 ià(
$sh“t2
 == -1) {

818 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Unknown sheet‚ame $sheet_name2 in formula");

822 ià(
$sh“t1
 > 
$sh“t2
) {

823 
	`li¡
(
$sh“t1
, 
$sh“t2
èğ
	`¬¿y
($sheet2, $sheet1);

826 
$sh“t1
 = 
$this
->
	`g‘Sh“tIndex
(
$ext_»f
);

827 ià(
$sh“t1
 == -1) {

828 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Unknown sheet‚ame $ext_ref in formula");

830 
$sh“t2
 = 
$sh“t1
;

834 
$off£t
 = -1 - 
$sh“t1
;

836  
	`·ck
('vdvv', 
$off£t
, 0x00, 
$sh“t1
, 
$sh“t2
);

837 
	}
}

848 
´iv©e
 
funùiÚ
 
	$g‘RefIndex
(
$ext_»f
)

850 
$ext_»f
 = 
	`´eg_»¶aû
("/^'/", '', $ext_ref);

851 
$ext_»f
 = 
	`´eg_»¶aû
("/'$/", '', $ext_ref);

852 
$ext_»f
 = 
	`¡r_»¶aû
('\'\'', '\'', $ext_ref);

855 ià(
	`´eg_m©ch
("/:/", 
$ext_»f
)) {

856 
	`li¡
(
$sh“t_Çme1
, 
$sh“t_Çme2
èğ
	`ex¶ode
(':', 
$ext_»f
);

858 
$sh“t1
 = 
$this
->
	`g‘Sh“tIndex
(
$sh“t_Çme1
);

859 ià(
$sh“t1
 == -1) {

860 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Unknown sheet‚ame $sheet_name1 in formula");

862 
$sh“t2
 = 
$this
->
	`g‘Sh“tIndex
(
$sh“t_Çme2
);

863 ià(
$sh“t2
 == -1) {

864 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Unknown sheet‚ame $sheet_name2 in formula");

868 ià(
$sh“t1
 > 
$sh“t2
) {

869 
	`li¡
(
$sh“t1
, 
$sh“t2
èğ
	`¬¿y
($sheet2, $sheet1);

872 
$sh“t1
 = 
$this
->
	`g‘Sh“tIndex
(
$ext_»f
);

873 ià(
$sh“t1
 == -1) {

874 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Unknown sheet‚ame $ext_ref in formula");

876 
$sh“t2
 = 
$sh“t1
;

880 
$supbook_šdex
 = 0x00;

881 
$»f
 = 
	`·ck
('vvv', 
$supbook_šdex
, 
$sh“t1
, 
$sh“t2
);

882 
$tÙ®»ã»nûs
 = 
	`couÁ
(
$this
->
»ã»nûs
);

883 
$šdex
 = -1;

884 
$i
 = 0; $˜< 
$tÙ®»ã»nûs
; ++$i) {

885 ià(
$»f
 =ğ
$this
->
»ã»nûs
[
$i
]) {

886 
$šdex
 = 
$i
;

891 ià(
$šdex
 == -1) {

892 
$this
->
»ã»nûs
[
$tÙ®»ã»nûs
] = 
$»f
;

893 
$šdex
 = 
$tÙ®»ã»nûs
;

896  
	`·ck
('v', 
$šdex
);

897 
	}
}

908 
´iv©e
 
funùiÚ
 
	$g‘Sh“tIndex
(
$sh“t_Çme
)

910 ià(!
	`is£t
(
$this
->
ex‹º®Sh“ts
[
$sh“t_Çme
])) {

913  
$this
->
ex‹º®Sh“ts
[
$sh“t_Çme
];

915 
	}
}

927 
public
 
funùiÚ
 
	$£tExtSh“t
(
$Çme
, 
$šdex
)

929 
$this
->
ex‹º®Sh“ts
[
$Çme
] = 
$šdex
;

930 
	}
}

939 
´iv©e
 
funùiÚ
 
	$ûÎToPackedRowcŞ
(
$ûÎ
)

941 
$ûÎ
 = 
	`¡¹ouµ”
($cell);

942 
	`li¡
(
$row
, 
$cŞ
, 
$row_»l
, 
$cŞ_»l
èğ
$this
->
	`ûÎToRowcŞ
(
$ûÎ
);

943 ià(
$cŞ
 >= 256) {

944 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Column in: $cell greaterhan 255");

946 ià(
$row
 >= 65536) {

947 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Row in: $cell greaterhan 65536 ");

951 
$cŞ
 |ğ
$cŞ_»l
 << 14;

952 
$cŞ
 |ğ
$row_»l
 << 15;

953 
$cŞ
 = 
	`·ck
('v', $col);

955 
$row
 = 
	`·ck
('v', $row);

957  
	`¬¿y
(
$row
, 
$cŞ
);

958 
	}
}

968 
´iv©e
 
funùiÚ
 
	$¿ngeToPackedRªge
(
$¿nge
)

970 
	`´eg_m©ch
('/(\$)?(\d+)\:(\$)?(\d+)/', 
$¿nge
, 
$m©ch
);

972 
$row1_»l
 = 
	`em±y
(
$m©ch
[1]) ? 1 : 0;

973 
$row1
 = 
$m©ch
[2];

974 
$row2_»l
 = 
	`em±y
(
$m©ch
[3]) ? 1 : 0;

975 
$row2
 = 
$m©ch
[4];

977 --
$row1
;

978 --
$row2
;

980 
$cŞ1
 = 0;

981 
$cŞ2
 = 65535;

984 ià((
$row1
 >ğ65536è
	`Ü
 (
$row2
 >= 65536)) {

985 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Row in: $range greaterhan 65536 ");

989 
$cŞ1
 |ğ
$row1_»l
 << 15;

990 
$cŞ2
 |ğ
$row2_»l
 << 15;

991 
$cŞ1
 = 
	`·ck
('v', $col1);

992 
$cŞ2
 = 
	`·ck
('v', $col2);

994 
$row1
 = 
	`·ck
('v', $row1);

995 
$row2
 = 
	`·ck
('v', $row2);

997  
	`¬¿y
(
$row1
, 
$cŞ1
, 
$row2
, 
$cŞ2
);

998 
	}
}

1009 
´iv©e
 
funùiÚ
 
	$ûÎToRowcŞ
(
$ûÎ
)

1011 
	`´eg_m©ch
('/(\$)?([A-I]?[A-Z])(\$)?(\d+)/', 
$ûÎ
, 
$m©ch
);

1013 
$cŞ_»l
 = 
	`em±y
(
$m©ch
[1]) ? 1 : 0;

1014 
$cŞ_»f
 = 
$m©ch
[2];

1015 
$row_»l
 = 
	`em±y
(
$m©ch
[3]) ? 1 : 0;

1016 
$row
 = 
$m©ch
[4];

1019 
$ex²
 = 
	`¡¾’
(
$cŞ_»f
) - 1;

1020 
$cŞ
 = 0;

1021 
$cŞ_»f_Ëngth
 = 
	`¡¾’
(
$cŞ_»f
);

1022 
$i
 = 0; $˜< 
$cŞ_»f_Ëngth
; ++$i) {

1023 
$cŞ
 +ğ(
	`Üd
(
$cŞ_»f
{
$i
}è- 64è* 
	`pow
(26, 
$ex²
);

1024 --
$ex²
;

1028 --
$row
;

1029 --
$cŞ
;

1031  
	`¬¿y
(
$row
, 
$cŞ
, 
$row_»l
, 
$cŞ_»l
);

1032 
	}
}

1039 
´iv©e
 
funùiÚ
 
	$advªû
()

1041 
$i
 = 
$this
->
cu¼’tCh¬aù”
;

1042 
$fÜmuÏ_Ëngth
 = 
	`¡¾’
(
$this
->
fÜmuÏ
);

1044 ià(
$i
 < 
$fÜmuÏ_Ëngth
) {

1045 
$this
->
fÜmuÏ
{
$i
} == " ") {

1046 ++
$i
;

1049 ià(
$i
 < (
$fÜmuÏ_Ëngth
 - 1)) {

1050 
$this
->
lookAh—d
 = $this->
fÜmuÏ
{
$i
+1};

1052 
$tok’
 = '';

1055 
$i
 < 
$fÜmuÏ_Ëngth
) {

1056 
$tok’
 .ğ
$this
->
fÜmuÏ
{
$i
};

1058 ià(
$i
 < (
$fÜmuÏ_Ëngth
 - 1)) {

1059 
$this
->
lookAh—d
 = $this->
fÜmuÏ
{
$i
+1};

1061 
$this
->
lookAh—d
 = '';

1064 ià(
$this
->
	`m©ch
(
$tok’
) != '') {

1068 
$this
->
cu¼’tCh¬aù”
 = 
$i
 + 1;

1069 
$this
->
cu¼’tTok’
 = 
$tok’
;

1073 ià(
$i
 < (
$fÜmuÏ_Ëngth
 - 2)) {

1074 
$this
->
lookAh—d
 = $this->
fÜmuÏ
{
$i
+2};

1076 
$this
->
lookAh—d
 = '';

1078 ++
$i
;

1081 
	}
}

1090 
´iv©e
 
funùiÚ
 
	$m©ch
(
$tok’
)

1092 
$tok’
) {

1108  
$tok’
;

1111 ià(
$this
->
lookAh—d
 == '=') {

1114  
$tok’
;

1118 ià((
$this
->
lookAh—d
 =ğ'='è
	`Ü
 ($this->lookAhead == '>')) {

1121  
$tok’
;

1125 ià(
	`´eg_m©ch
('/^\$?[A-Ia-i]?[A-Za-z]\$?[0-9]+$/', 
$tok’
è
ªd
 !´eg_m©ch("/[0-9]/", 
$this
->
lookAh—d
è
	`ªd
 ($this->lookAhead != ':')‡nd ($this->lookAhead != '.')‡nd ($this->lookAhead != '!')) {

1126  
$tok’
;

1127 } 
	`–£if
 (
	`´eg_m©ch
("/^" . 
£lf
::
REGEX_SHEET_TITLE_UNQUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_UNQUOTED . ")?\!\\$?[A-Ia-i]?[A-Za-z]\\$?[0-9]+$/u", 
$tok’
è
ªd
 !´eg_m©ch("/[0-9]/", 
$this
->
lookAh—d
è
	`ªd
 ($this->lookAhead != ':')‡nd ($this->lookAhead != '.')) {

1129  
$tok’
;

1130 } 
	`–£if
 (
	`´eg_m©ch
("/^'" . 
£lf
::
REGEX_SHEET_TITLE_QUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_QUOTED . ")?'\!\\$?[A-Ia-i]?[A-Za-z]\\$?[0-9]+$/u", 
$tok’
è
ªd
 !´eg_m©ch("/[0-9]/", 
$this
->
lookAh—d
è
	`ªd
 ($this->lookAhead != ':')‡nd ($this->lookAhead != '.')) {

1132  
$tok’
;

1133 } 
	`–£if
 (
	`´eg_m©ch
('/^(\$)?[A-Ia-i]?[A-Za-z](\$)?[0-9]+:(\$)?[A-Ia-i]?[A-Za-z](\$)?[0-9]+$/', 
$tok’
è&& !´eg_m©ch("/[0-9]/", 
$this
->
lookAh—d
)) {

1135  
$tok’
;

1136 } 
	`–£if
 (
	`´eg_m©ch
("/^" . 
£lf
::
REGEX_SHEET_TITLE_UNQUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_UNQUOTED . ")?\!\\$?([A-Ia-i]?[A-Za-z])?\\$?[0-9]+:\\$?([A-Ia-i]?[A-Za-z])?\\$?[0-9]+$/u", 
$tok’
è
ªd
 !´eg_m©ch("/[0-9]/", 
$this
->
lookAh—d
)) {

1138  
$tok’
;

1139 } 
	`–£if
 (
	`´eg_m©ch
("/^'" . 
£lf
::
REGEX_SHEET_TITLE_QUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_QUOTED . ")?'\!\\$?([A-Ia-i]?[A-Za-z])?\\$?[0-9]+:\\$?([A-Ia-i]?[A-Za-z])?\\$?[0-9]+$/u", 
$tok’
è
ªd
 !´eg_m©ch("/[0-9]/", 
$this
->
lookAh—d
)) {

1141  
$tok’
;

1142 } 
	`–£if
 (
	`is_num”ic
(
$tok’
è
	`ªd
 (!is_num”ic($tok’.
$this
->
lookAh—d
è
	`Ü
 ($this->lookAhead == ''))‡nd ($this->lookAhead != '!')‡nd ($this->lookAhead != ':')) {

1144  
$tok’
;

1145 } 
	`–£if
 (
	`´eg_m©ch
("/\"([^\"]|\"\"){0,255}\"/", 
$tok’
è
ªd
 
$this
->
lookAh—d
 !ğ'"' 
	`ªd
 (
	`sub¡r_couÁ
($token, '"')%2 == 0)) {

1147  
$tok’
;

1148 } 
	`–£if
 (
	`´eg_m©ch
("/^#[A-Z0\/]{3,5}[!?]{1}$/", 
$tok’
è
Ü
 $token == '#N/A') {

1150  
$tok’
;

1151 } 
	`–£if
 (
	`´eg_m©ch
("/^[A-Z0-9\xc0-\xdc\.]+$/i", 
$tok’
è
	`ªd
 (
$this
->
lookAh—d
 == "(")) {

1153  
$tok’
;

1154 } 
	`–£if
 (
	`sub¡r
(
$tok’
, -1) == ')') {

1157  
$tok’
;

1161 
	}
}

1171 
public
 
funùiÚ
 
	$·r£
(
$fÜmuÏ
)

1173 
$this
->
cu¼’tCh¬aù”
 = 0;

1174 
$this
->
fÜmuÏ
 = 
$fÜmuÏ
;

1175 
$this
->
lookAh—d
 = 
	`is£t
(
$fÜmuÏ
{1}) ? $formula{1} : '';

1176 
$this
->
	`advªû
();

1177 
$this
->
·r£T»e
 = $this->
	`cÚd™iÚ
();

1178  
Œue
;

1179 
	}
}

1188 
´iv©e
 
funùiÚ
 
	$cÚd™iÚ
()

1190 
$»suÉ
 = 
$this
->
	`ex´essiÚ
();

1191 ià(
$this
->
cu¼’tTok’
 == "<") {

1192 
$this
->
	`advªû
();

1193 
$»suÉ2
 = 
$this
->
	`ex´essiÚ
();

1194 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gLT', $»suÉ, 
$»suÉ2
);

1195 } 
	`–£if
 (
$this
->
cu¼’tTok’
 == ">") {

1196 
$this
->
	`advªû
();

1197 
$»suÉ2
 = 
$this
->
	`ex´essiÚ
();

1198 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gGT', $»suÉ, 
$»suÉ2
);

1199 } 
	`–£if
 (
$this
->
cu¼’tTok’
 == "<=") {

1200 
$this
->
	`advªû
();

1201 
$»suÉ2
 = 
$this
->
	`ex´essiÚ
();

1202 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gLE', $»suÉ, 
$»suÉ2
);

1203 } 
	`–£if
 (
$this
->
cu¼’tTok’
 == ">=") {

1204 
$this
->
	`advªû
();

1205 
$»suÉ2
 = 
$this
->
	`ex´essiÚ
();

1206 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gGE', $»suÉ, 
$»suÉ2
);

1207 } 
	`–£if
 (
$this
->
cu¼’tTok’
 == "=") {

1208 
$this
->
	`advªû
();

1209 
$»suÉ2
 = 
$this
->
	`ex´essiÚ
();

1210 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gEQ', $»suÉ, 
$»suÉ2
);

1211 } 
	`–£if
 (
$this
->
cu¼’tTok’
 == "<>") {

1212 
$this
->
	`advªû
();

1213 
$»suÉ2
 = 
$this
->
	`ex´essiÚ
();

1214 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gNE', $»suÉ, 
$»suÉ2
);

1215 } 
	`–£if
 (
$this
->
cu¼’tTok’
 == "&") {

1216 
$this
->
	`advªû
();

1217 
$»suÉ2
 = 
$this
->
	`ex´essiÚ
();

1218 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gCÚÿt', $»suÉ, 
$»suÉ2
);

1220  
$»suÉ
;

1221 
	}
}

1234 
´iv©e
 
funùiÚ
 
	$ex´essiÚ
()

1237 ià(
	`´eg_m©ch
("/\"([^\"]|\"\"){0,255}\"/", 
$this
->
cu¼’tTok’
)) {

1238 
$tmp
 = 
	`¡r_»¶aû
('""', '"', 
$this
->
cu¼’tTok’
);

1239 ià((
$tmp
 == '"') || ($tmp == '')) {

1241 
$tmp
 = '""';

1243 
$»suÉ
 = 
$this
->
	`ü—‹T»e
(
$tmp
, '', '');

1244 
$this
->
	`advªû
();

1245  
$»suÉ
;

1247 } 
	`–£if
 (
	`´eg_m©ch
("/^#[A-Z0\/]{3,5}[!?]{1}$/", 
$this
->
cu¼’tTok’
è
Ü
 $this->currentToken == '#N/A') {

1248 
$»suÉ
 = 
$this
->
	`ü—‹T»e
($this->
cu¼’tTok’
, 'ptgErr', '');

1249 
$this
->
	`advªû
();

1250  
$»suÉ
;

1252 } 
	`–£if
 (
$this
->
cu¼’tTok’
 == "-") {

1254 
$this
->
	`advªû
();

1255 
$»suÉ2
 = 
$this
->
	`ex´essiÚ
();

1256 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gUmšus', 
$»suÉ2
, '');

1257  
$»suÉ
;

1259 } 
	`–£if
 (
$this
->
cu¼’tTok’
 == "+") {

1261 
$this
->
	`advªû
();

1262 
$»suÉ2
 = 
$this
->
	`ex´essiÚ
();

1263 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gU¶us', 
$»suÉ2
, '');

1264  
$»suÉ
;

1266 
$»suÉ
 = 
$this
->
	`‹rm
();

1267 (
$this
->
cu¼’tTok’
 =ğ"+"è
Ü


1268 (
$this
->
cu¼’tTok’
 =ğ"-"è
Ü


1269 (
$this
->
cu¼’tTok’
 == "^")) {

1271 ià(
$this
->
cu¼’tTok’
 == "+") {

1272 
$this
->
	`advªû
();

1273 
$»suÉ2
 = 
$this
->
	`‹rm
();

1274 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gAdd', $»suÉ, 
$»suÉ2
);

1275 } 
	`–£if
 (
$this
->
cu¼’tTok’
 == "-") {

1276 
$this
->
	`advªû
();

1277 
$»suÉ2
 = 
$this
->
	`‹rm
();

1278 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gSub', $»suÉ, 
$»suÉ2
);

1280 
$this
->
	`advªû
();

1281 
$»suÉ2
 = 
$this
->
	`‹rm
();

1282 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gPow”', $»suÉ, 
$»suÉ2
);

1285  
$»suÉ
;

1286 
	}
}

1296 
´iv©e
 
funùiÚ
 
	$·»ÁhesizedEx´essiÚ
()

1298 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gP¬’', $this->
	`ex´essiÚ
(), '');

1299  
$»suÉ
;

1300 
	}
}

1309 
´iv©e
 
funùiÚ
 
	$‹rm
()

1311 
$»suÉ
 = 
$this
->
	`çù
();

1312 (
$this
->
cu¼’tTok’
 =ğ"*"è
Ü


1313 (
$this
->
cu¼’tTok’
 == "/")) {

1315 ià(
$this
->
cu¼’tTok’
 == "*") {

1316 
$this
->
	`advªû
();

1317 
$»suÉ2
 = 
$this
->
	`çù
();

1318 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gMul', $»suÉ, 
$»suÉ2
);

1320 
$this
->
	`advªû
();

1321 
$»suÉ2
 = 
$this
->
	`çù
();

1322 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gDiv', $»suÉ, 
$»suÉ2
);

1325  
$»suÉ
;

1326 
	}
}

1339 
´iv©e
 
funùiÚ
 
	$çù
()

1341 ià(
$this
->
cu¼’tTok’
 == "(") {

1342 
$this
->
	`advªû
();

1343 
$»suÉ
 = 
$this
->
	`·»ÁhesizedEx´essiÚ
();

1344 ià(
$this
->
cu¼’tTok’
 != ")") {

1345 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("')'okenƒxpected.");

1347 
$this
->
	`advªû
();

1348  
$»suÉ
;

1351 ià(
	`´eg_m©ch
('/^\$?[A-Ia-i]?[A-Za-z]\$?[0-9]+$/', 
$this
->
cu¼’tTok’
)) {

1352 
$»suÉ
 = 
$this
->
	`ü—‹T»e
($this->
cu¼’tTok’
, '', '');

1353 
$this
->
	`advªû
();

1354  
$»suÉ
;

1355 } 
	`–£if
 (
	`´eg_m©ch
("/^" . 
£lf
::
REGEX_SHEET_TITLE_UNQUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_UNQUOTED . ")?\!\\$?[A-Ia-i]?[A-Za-z]\\$?[0-9]+$/u", 
$this
->
cu¼’tTok’
)) {

1357 
$»suÉ
 = 
$this
->
	`ü—‹T»e
($this->
cu¼’tTok’
, '', '');

1358 
$this
->
	`advªû
();

1359  
$»suÉ
;

1360 } 
	`–£if
 (
	`´eg_m©ch
("/^'" . 
£lf
::
REGEX_SHEET_TITLE_QUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_QUOTED . ")?'\!\\$?[A-Ia-i]?[A-Za-z]\\$?[0-9]+$/u", 
$this
->
cu¼’tTok’
)) {

1362 
$»suÉ
 = 
$this
->
	`ü—‹T»e
($this->
cu¼’tTok’
, '', '');

1363 
$this
->
	`advªû
();

1364  
$»suÉ
;

1365 } 
	`–£if
 (
	`´eg_m©ch
('/^(\$)?[A-Ia-i]?[A-Za-z](\$)?[0-9]+:(\$)?[A-Ia-i]?[A-Za-z](\$)?[0-9]+$/', 
$this
->
cu¼’tTok’
è
Ü


1366 
	`´eg_m©ch
('/^(\$)?[A-Ia-i]?[A-Za-z](\$)?[0-9]+\.\.(\$)?[A-Ia-i]?[A-Za-z](\$)?[0-9]+$/', 
$this
->
cu¼’tTok’
)) {

1369 
$»suÉ
 = 
$this
->
	`ü—‹T»e
($this->
cu¼’tTok’
, '', '');

1370 
$this
->
	`advªû
();

1371  
$»suÉ
;

1372 } 
	`–£if
 (
	`´eg_m©ch
("/^" . 
£lf
::
REGEX_SHEET_TITLE_UNQUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_UNQUOTED . ")?\!\\$?([A-Ia-i]?[A-Za-z])?\\$?[0-9]+:\\$?([A-Ia-i]?[A-Za-z])?\\$?[0-9]+$/u", 
$this
->
cu¼’tTok’
)) {

1376 
$»suÉ
 = 
$this
->
	`ü—‹T»e
($this->
cu¼’tTok’
, '', '');

1377 
$this
->
	`advªû
();

1378  
$»suÉ
;

1379 } 
	`–£if
 (
	`´eg_m©ch
("/^'" . 
£lf
::
REGEX_SHEET_TITLE_QUOTED
 . "(\:" . s–f::REGEX_SHEET_TITLE_QUOTED . ")?'\!\\$?([A-Ia-i]?[A-Za-z])?\\$?[0-9]+:\\$?([A-Ia-i]?[A-Za-z])?\\$?[0-9]+$/u", 
$this
->
cu¼’tTok’
)) {

1383 
$»suÉ
 = 
$this
->
	`ü—‹T»e
($this->
cu¼’tTok’
, '', '');

1384 
$this
->
	`advªû
();

1385  
$»suÉ
;

1386 } 
	`–£if
 (
	`is_num”ic
(
$this
->
cu¼’tTok’
)) {

1388 ià(
$this
->
lookAh—d
 == '%') {

1389 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('±gP”ûÁ', $this->
cu¼’tTok’
, '');

1390 
$this
->
	`advªû
();

1392 
$»suÉ
 = 
$this
->
	`ü—‹T»e
($this->
cu¼’tTok’
, '', '');

1394 
$this
->
	`advªû
();

1395  
$»suÉ
;

1396 } 
	`–£if
 (
	`´eg_m©ch
("/^[A-Z0-9\xc0-\xdc\.]+$/i", 
$this
->
cu¼’tTok’
)) {

1398 
$»suÉ
 = 
$this
->
	`func
();

1399  
$»suÉ
;

1401 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("SyÁaxƒ¼Ü: ".
$this
->
cu¼’tTok’
.",†ookah—d: ".$this->
lookAh—d
.", cu¼’ˆch¬: ".$this->
cu¼’tCh¬aù”
);

1402 
	}
}

1411 
´iv©e
 
funùiÚ
 
	$func
()

1413 
$num_¬gs
 = 0;

1414 
$funùiÚ
 = 
	`¡¹ouµ”
(
$this
->
cu¼’tTok’
);

1415 
$»suÉ
 = '';

1416 
$this
->
	`advªû
();

1417 
$this
->
	`advªû
();

1418 
$this
->
cu¼’tTok’
 != ')') {

1420 ià(
$num_¬gs
 > 0) {

1421 ià(
$this
->
cu¼’tTok’
 == "," || $this->currentToken == ";") {

1422 
$this
->
	`advªû
();

1424 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Syntaxƒrror: commaƒxpected in function $function,‡rg #{$num_args}");

1426 
$»suÉ2
 = 
$this
->
	`cÚd™iÚ
();

1427 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('¬g', $»suÉ, 
$»suÉ2
);

1429 
$»suÉ2
 = 
$this
->
	`cÚd™iÚ
();

1430 
$»suÉ
 = 
$this
->
	`ü—‹T»e
('¬g', '', 
$»suÉ2
);

1432 ++
$num_¬gs
;

1434 ià(!
	`is£t
(
$this
->
funùiÚs
[
$funùiÚ
])) {

1435 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Function $function() doesn'tƒxist");

1437 
$¬gs
 = 
$this
->
funùiÚs
[
$funùiÚ
][1];

1439 ià((
$¬gs
 >ğ0è
	`ªd
 ($¬g !ğ
$num_¬gs
)) {

1440 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Incorrect‚umber of‡rguments in function $function() ");

1443 
$»suÉ
 = 
$this
->
	`ü—‹T»e
(
$funùiÚ
, $»suÉ, 
$num_¬gs
);

1444 
$this
->
	`advªû
();

1445  
$»suÉ
;

1446 
	}
}

1458 
´iv©e
 
funùiÚ
 
	$ü—‹T»e
(
$v®ue
, 
$Ëá
, 
$right
)

1460  
	`¬¿y
('v®ue' => 
$v®ue
, 'Ëá' => 
$Ëá
, 'right' => 
$right
);

1461 
	}
}

1490 
public
 
funùiÚ
 
toRev”£PŞish
(
$Œ“
 = 
	$¬¿y
())

1492 
$pŞish
 = "";

1493 ià(
	`em±y
(
$Œ“
)) {

1494 
$Œ“
 = 
$this
->
·r£T»e
;

1497 ià(
	`is_¬¿y
(
$Œ“
['left'])) {

1498 
$cÚv”‹d_Œ“
 = 
$this
->
	`toRev”£PŞish
(
$Œ“
['left']);

1499 
$pŞish
 .ğ
$cÚv”‹d_Œ“
;

1500 } 
	`–£if
 (
$Œ“
['left'] != '') {

1501 
$cÚv”‹d_Œ“
 = 
$this
->
	`cÚv”t
(
$Œ“
['left']);

1502 
$pŞish
 .ğ
$cÚv”‹d_Œ“
;

1504 ià(
	`is_¬¿y
(
$Œ“
['right'])) {

1505 
$cÚv”‹d_Œ“
 = 
$this
->
	`toRev”£PŞish
(
$Œ“
['right']);

1506 
$pŞish
 .ğ
$cÚv”‹d_Œ“
;

1507 } 
	`–£if
 (
$Œ“
['right'] != '') {

1508 
$cÚv”‹d_Œ“
 = 
$this
->
	`cÚv”t
(
$Œ“
['right']);

1509 
$pŞish
 .ğ
$cÚv”‹d_Œ“
;

1512 ià(
	`´eg_m©ch
("/^[A-Z0-9\xc0-\xdc\.]+$/", 
$Œ“
['v®ue']è
ªd


1513 !
	`´eg_m©ch
('/^([A-Ia-i]?[A-Za-z])(\d+)$/', 
$Œ“
['v®ue']è
ªd


1514 !
	`´eg_m©ch
("/^[A-Ia-i]?[A-Za-z](\d+)\.\.[A-Ia-i]?[A-Za-z](\d+)$/", 
$Œ“
['v®ue']è
ªd


1515 !
	`is_num”ic
(
$Œ“
['v®ue']è
ªd


1516 !
	`is£t
(
$this
->
±g
[
$Œ“
['value']])) {

1518 ià(
$Œ“
['left'] != '') {

1519 
$Ëá_Œ“
 = 
$this
->
	`toRev”£PŞish
(
$Œ“
['left']);

1521 
$Ëá_Œ“
 = '';

1524  
$Ëá_Œ“
.
$this
->
	`cÚv”tFunùiÚ
(
$Œ“
['value'], $tree['right']);

1526 
$cÚv”‹d_Œ“
 = 
$this
->
	`cÚv”t
(
$Œ“
['value']);

1528 
$pŞish
 .ğ
$cÚv”‹d_Œ“
;

1529  
$pŞish
;

1530 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Workbook.php

1 <?
php


63 şas 
	cPHPExûl_Wr™”_Exûl5_WÜkbook
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl5_BIFFwr™”


70 
´iv©e
 
	m$·r£r
;

77 
´iv©e
 
	m$biffSize
;

83 
´iv©e
 
	m$xfWr™”s
 = 
¬¿y
();

89 
´iv©e
 
	m$·Ë‰e
;

95 
´iv©e
 
	m$cod•age
;

101 
´iv©e
 
	m$couÁryCode
;

107 
´iv©e
 
	m$phpExûl
;

114 
´iv©e
 
	m$fÚtWr™”s
 = 
¬¿y
();

121 
´iv©e
 
	m$addedFÚts
 = 
¬¿y
();

128 
´iv©e
 
	m$numb”FÜm©s
 = 
¬¿y
();

135 
´iv©e
 
	m$addedNumb”FÜm©s
 = 
¬¿y
();

142 
´iv©e
 
	m$wÜksh“tSizes
 = 
¬¿y
();

149 
´iv©e
 
	m$wÜksh“tOff£ts
 = 
¬¿y
();

156 
´iv©e
 
	m$¡ršgTÙ®
;

163 
´iv©e
 
	m$¡ršgUnique
;

170 
´iv©e
 
	m$¡ršgTabË
;

175 
´iv©e
 
	m$cŞÜs
;

182 
´iv©e
 
	m$esch”
;

195 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$phpExûl
 = 
nuÎ
, &
$¡r_tÙ®
, &
$¡r_unique
, &
$¡r_bË
, &
$cŞÜs
, 
$·r£r
)

198 
·»Á
::
	`__cÚ¡ruù
();

200 
$this
->
·r£r
 = 
$·r£r
;

201 
$this
->
biffSize
 = 0;

202 
$this
->
·Ë‰e
 = 
	`¬¿y
();

203 
$this
->
couÁryCode
 = -1;

205 
$this
->
¡ršgTÙ®
 = &
$¡r_tÙ®
;

206 
$this
->
¡ršgUnique
 = &
$¡r_unique
;

207 
$this
->
¡ršgTabË
 = &
$¡r_bË
;

208 
$this
->
cŞÜs
 = &
$cŞÜs
;

209 
$this
->
	`£tP®‘‹Xl97
();

211 
$this
->
phpExûl
 = 
$phpExûl
;

215 
$this
->
cod•age
 = 0x04B0;

218 
$couÁSh“ts
 = 
$phpExûl
->
	`g‘Sh“tCouÁ
();

219 
$i
 = 0; $˜< 
$couÁSh“ts
; ++$i) {

220 
$phpSh“t
 = 
$phpExûl
->
	`g‘Sh“t
(
$i
);

222 
$this
->
·r£r
->
	`£tExtSh“t
(
$phpSh“t
->
	`g‘T™Ë
(), 
$i
);

224 
$supbook_šdex
 = 0x00;

225 
$»f
 = 
	`·ck
('vvv', 
$supbook_šdex
, 
$i
, $i);

226 
$this
->
·r£r
->
»ã»nûs
[] = 
$»f
;

229 ià(
$phpSh“t
->
	`isTabCŞÜS‘
()) {

230 
$this
->
	`addCŞÜ
(
$phpSh“t
->
	`g‘TabCŞÜ
()->
	`g‘RGB
());

243 
public
 
funùiÚ
 
	$addXfWr™”
(
$¡yË
, 
$isStyËXf
 = 
çl£
)

245 
$xfWr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_Xf
(
$¡yË
);

246 
$xfWr™”
->
	`£tIsStyËXf
(
$isStyËXf
);

249 
$fÚtIndex
 = 
$this
->
	`addFÚt
(
$¡yË
->
	`g‘FÚt
());

252 
$xfWr™”
->
	`£tFÚtIndex
(
$fÚtIndex
);

255 
$xfWr™”
->
	`£tFgCŞÜ
(
$this
->
	`addCŞÜ
(
$¡yË
->
	`g‘Fl
()->
	`g‘S¹CŞÜ
()->
	`g‘RGB
()));

256 
$xfWr™”
->
	`£tBgCŞÜ
(
$this
->
	`addCŞÜ
(
$¡yË
->
	`g‘Fl
()->
	`g‘EndCŞÜ
()->
	`g‘RGB
()));

257 
$xfWr™”
->
	`£tBÙtomCŞÜ
(
$this
->
	`addCŞÜ
(
$¡yË
->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
	`g‘CŞÜ
()->
	`g‘RGB
()));

258 
$xfWr™”
->
	`£tTİCŞÜ
(
$this
->
	`addCŞÜ
(
$¡yË
->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
	`g‘CŞÜ
()->
	`g‘RGB
()));

259 
$xfWr™”
->
	`£tRightCŞÜ
(
$this
->
	`addCŞÜ
(
$¡yË
->
	`g‘BÜd”s
()->
	`g‘Right
()->
	`g‘CŞÜ
()->
	`g‘RGB
()));

260 
$xfWr™”
->
	`£tLeáCŞÜ
(
$this
->
	`addCŞÜ
(
$¡yË
->
	`g‘BÜd”s
()->
	`g‘Leá
()->
	`g‘CŞÜ
()->
	`g‘RGB
()));

261 
$xfWr™”
->
	`£tDŸgCŞÜ
(
$this
->
	`addCŞÜ
(
$¡yË
->
	`g‘BÜd”s
()->
	`g‘DŸgÚ®
()->
	`g‘CŞÜ
()->
	`g‘RGB
()));

264 ià(
$¡yË
->
	`g‘Numb”FÜm©
()->
	`g‘ButInFÜm©Code
(è==ğ
çl£
) {

265 
$numb”FÜm©HashCode
 = 
$¡yË
->
	`g‘Numb”FÜm©
()->
	`g‘HashCode
();

267 ià(
	`is£t
(
$this
->
addedNumb”FÜm©s
[
$numb”FÜm©HashCode
])) {

268 
$numb”FÜm©Index
 = 
$this
->
addedNumb”FÜm©s
[
$numb”FÜm©HashCode
];

270 
$numb”FÜm©Index
 = 164 + 
	`couÁ
(
$this
->
numb”FÜm©s
);

271 
$this
->
numb”FÜm©s
[
$numb”FÜm©Index
] = 
$¡yË
->
	`g‘Numb”FÜm©
();

272 
$this
->
addedNumb”FÜm©s
[
$numb”FÜm©HashCode
] = 
$numb”FÜm©Index
;

275 
$numb”FÜm©Index
 = (è
$¡yË
->
	`g‘Numb”FÜm©
()->
	`g‘ButInFÜm©Code
();

279 
$xfWr™”
->
	`£tNumb”FÜm©Index
(
$numb”FÜm©Index
);

281 
$this
->
xfWr™”s
[] = 
$xfWr™”
;

283 
$xfIndex
 = 
	`couÁ
(
$this
->
xfWr™”s
) - 1;

284  
$xfIndex
;

285 
	}
}

293 
public
 
funùiÚ
 
	$addFÚt
(
PHPExûl_StyË_FÚt
 
$fÚt
)

295 
$fÚtHashCode
 = 
$fÚt
->
	`g‘HashCode
();

296 ià(
	`is£t
(
$this
->
addedFÚts
[
$fÚtHashCode
])) {

297 
$fÚtIndex
 = 
$this
->
addedFÚts
[
$fÚtHashCode
];

299 
$couÁFÚts
 = 
	`couÁ
(
$this
->
fÚtWr™”s
);

300 
$fÚtIndex
 = (
$couÁFÚts
 < 4) ? $countFonts : $countFonts + 1;

302 
$fÚtWr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_FÚt
(
$fÚt
);

303 
$fÚtWr™”
->
	`£tCŞÜIndex
(
$this
->
	`addCŞÜ
(
$fÚt
->
	`g‘CŞÜ
()->
	`g‘RGB
()));

304 
$this
->
fÚtWr™”s
[] = 
$fÚtWr™”
;

306 
$this
->
addedFÚts
[
$fÚtHashCode
] = 
$fÚtIndex
;

308  
$fÚtIndex
;

309 
	}
}

317 
´iv©e
 
funùiÚ
 
	$addCŞÜ
(
$rgb
)

319 ià(!
	`is£t
(
$this
->
cŞÜs
[
$rgb
])) {

320 ià(
	`couÁ
(
$this
->
cŞÜs
) < 57) {

322 
$cŞÜIndex
 = 8 + 
	`couÁ
(
$this
->
cŞÜs
);

323 
$this
->
·Ë‰e
[
$cŞÜIndex
] =

324 
	`¬¿y
(

325 
	`hexdec
(
	`sub¡r
(
$rgb
, 0, 2)),

326 
	`hexdec
(
	`sub¡r
(
$rgb
, 2, 2)),

327 
	`hexdec
(
	`sub¡r
(
$rgb
, 4)),

330 
$this
->
cŞÜs
[
$rgb
] = 
$cŞÜIndex
;

333 
$cŞÜIndex
 = 0;

337 
$cŞÜIndex
 = 
$this
->
cŞÜs
[
$rgb
];

340  
$cŞÜIndex
;

341 
	}
}

348 
´iv©e
 
funùiÚ
 
	$£tP®‘‹Xl97
()

350 
$this
->
·Ë‰e
 = 
	`¬¿y
(

351 0x08 => 
	`¬¿y
(0x00, 0x00, 0x00, 0x00),

352 0x09 => 
	`¬¿y
(0xff, 0xff, 0xff, 0x00),

353 0x0A => 
	`¬¿y
(0xff, 0x00, 0x00, 0x00),

354 0x0B => 
	`¬¿y
(0x00, 0xff, 0x00, 0x00),

355 0x0C => 
	`¬¿y
(0x00, 0x00, 0xff, 0x00),

356 0x0D => 
	`¬¿y
(0xff, 0xff, 0x00, 0x00),

357 0x0E => 
	`¬¿y
(0xff, 0x00, 0xff, 0x00),

358 0x0F => 
	`¬¿y
(0x00, 0xff, 0xff, 0x00),

359 0x10 => 
	`¬¿y
(0x80, 0x00, 0x00, 0x00),

360 0x11 => 
	`¬¿y
(0x00, 0x80, 0x00, 0x00),

361 0x12 => 
	`¬¿y
(0x00, 0x00, 0x80, 0x00),

362 0x13 => 
	`¬¿y
(0x80, 0x80, 0x00, 0x00),

363 0x14 => 
	`¬¿y
(0x80, 0x00, 0x80, 0x00),

364 0x15 => 
	`¬¿y
(0x00, 0x80, 0x80, 0x00),

365 0x16 => 
	`¬¿y
(0xc0, 0xc0, 0xc0, 0x00),

366 0x17 => 
	`¬¿y
(0x80, 0x80, 0x80, 0x00),

367 0x18 => 
	`¬¿y
(0x99, 0x99, 0xff, 0x00),

368 0x19 => 
	`¬¿y
(0x99, 0x33, 0x66, 0x00),

369 0x1A => 
	`¬¿y
(0xff, 0xff, 0xcc, 0x00),

370 0x1B => 
	`¬¿y
(0xcc, 0xff, 0xff, 0x00),

371 0x1C => 
	`¬¿y
(0x66, 0x00, 0x66, 0x00),

372 0x1D => 
	`¬¿y
(0xff, 0x80, 0x80, 0x00),

373 0x1E => 
	`¬¿y
(0x00, 0x66, 0xcc, 0x00),

374 0x1F => 
	`¬¿y
(0xcc, 0xcc, 0xff, 0x00),

375 0x20 => 
	`¬¿y
(0x00, 0x00, 0x80, 0x00),

376 0x21 => 
	`¬¿y
(0xff, 0x00, 0xff, 0x00),

377 0x22 => 
	`¬¿y
(0xff, 0xff, 0x00, 0x00),

378 0x23 => 
	`¬¿y
(0x00, 0xff, 0xff, 0x00),

379 0x24 => 
	`¬¿y
(0x80, 0x00, 0x80, 0x00),

380 0x25 => 
	`¬¿y
(0x80, 0x00, 0x00, 0x00),

381 0x26 => 
	`¬¿y
(0x00, 0x80, 0x80, 0x00),

382 0x27 => 
	`¬¿y
(0x00, 0x00, 0xff, 0x00),

383 0x28 => 
	`¬¿y
(0x00, 0xcc, 0xff, 0x00),

384 0x29 => 
	`¬¿y
(0xcc, 0xff, 0xff, 0x00),

385 0x2A => 
	`¬¿y
(0xcc, 0xff, 0xcc, 0x00),

386 0x2B => 
	`¬¿y
(0xff, 0xff, 0x99, 0x00),

387 0x2C => 
	`¬¿y
(0x99, 0xcc, 0xff, 0x00),

388 0x2D => 
	`¬¿y
(0xff, 0x99, 0xcc, 0x00),

389 0x2E => 
	`¬¿y
(0xcc, 0x99, 0xff, 0x00),

390 0x2F => 
	`¬¿y
(0xff, 0xcc, 0x99, 0x00),

391 0x30 => 
	`¬¿y
(0x33, 0x66, 0xff, 0x00),

392 0x31 => 
	`¬¿y
(0x33, 0xcc, 0xcc, 0x00),

393 0x32 => 
	`¬¿y
(0x99, 0xcc, 0x00, 0x00),

394 0x33 => 
	`¬¿y
(0xff, 0xcc, 0x00, 0x00),

395 0x34 => 
	`¬¿y
(0xff, 0x99, 0x00, 0x00),

396 0x35 => 
	`¬¿y
(0xff, 0x66, 0x00, 0x00),

397 0x36 => 
	`¬¿y
(0x66, 0x66, 0x99, 0x00),

398 0x37 => 
	`¬¿y
(0x96, 0x96, 0x96, 0x00),

399 0x38 => 
	`¬¿y
(0x00, 0x33, 0x66, 0x00),

400 0x39 => 
	`¬¿y
(0x33, 0x99, 0x66, 0x00),

401 0x3A => 
	`¬¿y
(0x00, 0x33, 0x00, 0x00),

402 0x3B => 
	`¬¿y
(0x33, 0x33, 0x00, 0x00),

403 0x3C => 
	`¬¿y
(0x99, 0x33, 0x00, 0x00),

404 0x3D => 
	`¬¿y
(0x99, 0x33, 0x66, 0x00),

405 0x3E => 
	`¬¿y
(0x33, 0x33, 0x99, 0x00),

406 0x3F => 
	`¬¿y
(0x33, 0x33, 0x33, 0x00),

408 
	}
}

417 
public
 
funùiÚ
 
	$wr™eWÜkbook
(
$pWÜksh“tSizes
 = 
nuÎ
)

419 
$this
->
wÜksh“tSizes
 = 
$pWÜksh“tSizes
;

423 
$tÙ®_wÜksh“ts
 = 
$this
->
phpExûl
->
	`g‘Sh“tCouÁ
();

426 
$this
->
	`¡ÜeBof
(0x0005);

427 
$this
->
	`wr™eCod•age
();

428 
$this
->
	`wr™eWšdow1
();

430 
$this
->
	`wr™eD©eMode
();

431 
$this
->
	`wr™eAÎFÚts
();

432 
$this
->
	`wr™eAÎNumb”FÜm©s
();

433 
$this
->
	`wr™eAÎXfs
();

434 
$this
->
	`wr™eAÎStyËs
();

435 
$this
->
	`wr™eP®‘‹
();

438 
$·¹3
 = '';

439 ià(
$this
->
couÁryCode
 != -1) {

440 
$·¹3
 .ğ
$this
->
	`wr™eCouÁry
();

442 
$·¹3
 .ğ
$this
->
	`wr™eReÿlcId
();

444 
$·¹3
 .ğ
$this
->
	`wr™eSupbookIÁ”Çl
();

447 
$·¹3
 .ğ
$this
->
	`wr™eEx‹º®sh“tBiff8
();

448 
$·¹3
 .ğ
$this
->
	`wr™eAÎDefšedNamesBiff8
();

449 
$·¹3
 .ğ
$this
->
	`wr™eMsoD¿wšgGroup
();

450 
$·¹3
 .ğ
$this
->
	`wr™eSh¬edSŒšgsTabË
();

452 
$·¹3
 .ğ
$this
->
	`wr™eEof
();

455 
$this
->
	`ÿlcSh“tOff£ts
();

456 
$i
 = 0; $˜< 
$tÙ®_wÜksh“ts
; ++$i) {

457 
$this
->
	`wr™eBoundSh“t
($this->
phpExûl
->
	`g‘Sh“t
(
$i
), $this->
wÜksh“tOff£ts
[$i]);

461 
$this
->
_d©a
 .ğ
$·¹3
;

463  
$this
->
_d©a
;

464 
	}
}

471 
´iv©e
 
funùiÚ
 
	$ÿlcSh“tOff£ts
()

473 
$boundsh“t_Ëngth
 = 10;

476 
$off£t
 = 
$this
->
_d©asize
;

479 
$tÙ®_wÜksh“ts
 = 
	`couÁ
(
$this
->
phpExûl
->
	`g‘AÎSh“ts
());

480 
	`fÜ—ch
 (
$this
->
phpExûl
->
	`g‘WÜksh“tI‹¿tÜ
(è
as
 
$sh“t
) {

481 
$off£t
 +ğ
$boundsh“t_Ëngth
 + 
	`¡¾’
(
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeShÜt
(
$sh“t
->
	`g‘T™Ë
()));

485 
$i
 = 0; $˜< 
$tÙ®_wÜksh“ts
; ++$i) {

486 
$this
->
wÜksh“tOff£ts
[
$i
] = 
$off£t
;

487 
$off£t
 +ğ
$this
->
wÜksh“tSizes
[
$i
];

489 
$this
->
biffSize
 = 
$off£t
;

490 
	}
}

495 
´iv©e
 
funùiÚ
 
	$wr™eAÎFÚts
()

497 
	`fÜ—ch
 (
$this
->
fÚtWr™”s
 
as
 
$fÚtWr™”
) {

498 
$this
->
	`­³nd
(
$fÚtWr™”
->
	`wr™eFÚt
());

500 
	}
}

505 
´iv©e
 
funùiÚ
 
	$wr™eAÎNumb”FÜm©s
()

507 
	`fÜ—ch
 (
$this
->
numb”FÜm©s
 
as
 
$numb”FÜm©Index
 => 
$numb”FÜm©
) {

508 
$this
->
	`wr™eNumb”FÜm©
(
$numb”FÜm©
->
	`g‘FÜm©Code
(), 
$numb”FÜm©Index
);

510 
	}
}

515 
´iv©e
 
funùiÚ
 
	$wr™eAÎXfs
()

517 
	`fÜ—ch
 (
$this
->
xfWr™”s
 
as
 
$xfWr™”
) {

518 
$this
->
	`­³nd
(
$xfWr™”
->
	`wr™eXf
());

520 
	}
}

525 
´iv©e
 
funùiÚ
 
	$wr™eAÎStyËs
()

527 
$this
->
	`wr™eStyË
();

528 
	}
}

534 
´iv©e
 
funùiÚ
 
	$wr™eEx‹º®s
()

536 
$couÁSh“ts
 = 
$this
->
phpExûl
->
	`g‘Sh“tCouÁ
();

538 
$this
->
	`wr™eEx‹º®CouÁ
(
$couÁSh“ts
);

541 
$i
 = 0; $˜< 
$couÁSh“ts
; ++$i) {

542 
$this
->
	`wr™eEx‹º®Sh“t
($this->
phpExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘T™Ë
());

544 
	}
}

549 
´iv©e
 
funùiÚ
 
	$wr™eNames
()

552 
$tÙ®_wÜksh“ts
 = 
$this
->
phpExûl
->
	`g‘Sh“tCouÁ
();

555 
$i
 = 0; $˜< 
$tÙ®_wÜksh“ts
; ++$i) {

556 
$sh“tS‘up
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘PageS‘up
();

558 ià(
$sh“tS‘up
->
	`isPrštA»aS‘
()) {

560 
$´štA»a
 = 
PHPExûl_C–l
::
	`¥l™Rªge
(
$sh“tS‘up
->
	`g‘PrštA»a
());

561 
$´štA»a
 = $printArea[0];

562 
$´štA»a
[0] = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
($printArea[0]);

563 
$´štA»a
[1] = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
($printArea[1]);

565 
$´št_rowmš
 = 
$´štA»a
[0][1] - 1;

566 
$´št_rowmax
 = 
$´štA»a
[1][1] - 1;

567 
$´št_cŞmš
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$´štA»a
[0][0]) - 1;

568 
$´št_cŞmax
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$´štA»a
[1][0]) - 1;

570 
$this
->
	`wr™eNameShÜt
(

571 
$i
,

573 
$´št_rowmš
,

574 
$´št_rowmax
,

575 
$´št_cŞmš
,

576 
$´št_cŞmax


582 
$i
 = 0; $˜< 
$tÙ®_wÜksh“ts
; ++$i) {

583 
$sh“tS‘up
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘PageS‘up
();

586 ià(
$sh“tS‘up
->
	`isCŞumnsToR•—tAtLeáS‘
(è&& $sh“tS‘up->
	`isRowsToR•—tAtTİS‘
()) {

587 
$»³©
 = 
$sh“tS‘up
->
	`g‘CŞumnsToR•—tAtLeá
();

588 
$cŞmš
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$»³©
[0]) - 1;

589 
$cŞmax
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$»³©
[1]) - 1;

591 
$»³©
 = 
$sh“tS‘up
->
	`g‘RowsToR•—tAtTİ
();

592 
$rowmš
 = 
$»³©
[0] - 1;

593 
$rowmax
 = 
$»³©
[1] - 1;

595 
$this
->
	`wr™eNameLÚg
(

596 
$i
,

598 
$rowmš
,

599 
$rowmax
,

600 
$cŞmš
,

601 
$cŞmax


605 } 
	`–£if
 (
$sh“tS‘up
->
	`isCŞumnsToR•—tAtLeáS‘
(è|| $sh“tS‘up->
	`isRowsToR•—tAtTİS‘
()) {

607 ià(
$sh“tS‘up
->
	`isCŞumnsToR•—tAtLeáS‘
()) {

608 
$»³©
 = 
$sh“tS‘up
->
	`g‘CŞumnsToR•—tAtLeá
();

609 
$cŞmš
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$»³©
[0]) - 1;

610 
$cŞmax
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$»³©
[1]) - 1;

612 
$cŞmš
 = 0;

613 
$cŞmax
 = 255;

617 ià(
$sh“tS‘up
->
	`isRowsToR•—tAtTİS‘
()) {

618 
$»³©
 = 
$sh“tS‘up
->
	`g‘RowsToR•—tAtTİ
();

619 
$rowmš
 = 
$»³©
[0] - 1;

620 
$rowmax
 = 
$»³©
[1] - 1;

622 
$rowmš
 = 0;

623 
$rowmax
 = 65535;

626 
$this
->
	`wr™eNameShÜt
(

627 
$i
,

629 
$rowmš
,

630 
$rowmax
,

631 
$cŞmš
,

632 
$cŞmax


636 
	}
}

642 
´iv©e
 
funùiÚ
 
	$wr™eAÎDefšedNamesBiff8
()

644 
$chunk
 = '';

647 ià(
	`couÁ
(
$this
->
phpExûl
->
	`g‘NamedRªges
()) > 0) {

649 
$ÇmedRªges
 = 
$this
->
phpExûl
->
	`g‘NamedRªges
();

650 
	`fÜ—ch
 (
$ÇmedRªges
 
as
 
$ÇmedRªge
) {

652 
$¿nge
 = 
PHPExûl_C–l
::
	`¥l™Rªge
(
$ÇmedRªge
->
	`g‘Rªge
());

653 
$i
 = 0; $˜< 
	`couÁ
(
$¿nge
); $i++) {

654 
$¿nge
[
$i
][0] = '\'' . 
	`¡r_»¶aû
("'", "''", 
$ÇmedRªge
->
	`g‘WÜksh“t
()->
	`g‘T™Ë
()è. '\'!' . 
PHPExûl_C–l
::
	`absŞu‹CoÜdš©e
($range[$i][0]);

655 ià(
	`is£t
(
$¿nge
[
$i
][1])) {

656 
$¿nge
[
$i
][1] = 
PHPExûl_C–l
::
	`absŞu‹CoÜdš©e
($range[$i][1]);

659 
$¿nge
 = 
PHPExûl_C–l
::
	`budRªge
($range);

662 
Œy
 {

663 
$”rÜ
 = 
$this
->
·r£r
->
	`·r£
(
$¿nge
);

664 
$fÜmuÏD©a
 = 
$this
->
·r£r
->
	`toRev”£PŞish
();

667 ià(
	`is£t
(
$fÜmuÏD©a
{0}è
	`ªd
 ($fÜmuÏD©a{0} =ğ"\x7A" 
Ü
 $formulaData{0} == "\x5A")) {

668 
$fÜmuÏD©a
 = "\x3A" . 
	`sub¡r
($formulaData, 1);

671 ià(
$ÇmedRªge
->
	`g‘LoÿlOÆy
()) {

673 
$scİe
 = 
$this
->
phpExûl
->
	`g‘Index
(
$ÇmedRªge
->
	`g‘Scİe
()) + 1;

676 
$scİe
 = 0;

678 
$chunk
 .ğ
$this
->
	`wr™eD©a
($this->
	`wr™eDefšedNameBiff8
(
$ÇmedRªge
->
	`g‘Name
(), 
$fÜmuÏD©a
, 
$scİe
, 
çl£
));

680 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

687 
$tÙ®_wÜksh“ts
 = 
$this
->
phpExûl
->
	`g‘Sh“tCouÁ
();

690 
$i
 = 0; $˜< 
$tÙ®_wÜksh“ts
; ++$i) {

691 
$sh“tS‘up
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘PageS‘up
();

693 ià(
$sh“tS‘up
->
	`isCŞumnsToR•—tAtLeáS‘
(è&& $sh“tS‘up->
	`isRowsToR•—tAtTİS‘
()) {

694 
$»³©
 = 
$sh“tS‘up
->
	`g‘CŞumnsToR•—tAtLeá
();

695 
$cŞmš
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$»³©
[0]) - 1;

696 
$cŞmax
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$»³©
[1]) - 1;

698 
$»³©
 = 
$sh“tS‘up
->
	`g‘RowsToR•—tAtTİ
();

699 
$rowmš
 = 
$»³©
[0] - 1;

700 
$rowmax
 = 
$»³©
[1] - 1;

703 
$fÜmuÏD©a
 = 
	`·ck
('Cv', 0x29, 0x17);

704 
$fÜmuÏD©a
 .ğ
	`·ck
('Cvvvvv', 0x3B, 
$i
, 0, 65535, 
$cŞmš
, 
$cŞmax
);

705 
$fÜmuÏD©a
 .ğ
	`·ck
('Cvvvvv', 0x3B, 
$i
, 
$rowmš
, 
$rowmax
, 0, 255);

706 
$fÜmuÏD©a
 .ğ
	`·ck
('C', 0x10);

709 
$chunk
 .ğ
$this
->
	`wr™eD©a
($this->
	`wr™eDefšedNameBiff8
(
	`·ck
('C', 0x07), 
$fÜmuÏD©a
, 
$i
 + 1, 
Œue
));

712 } 
	`–£if
 (
$sh“tS‘up
->
	`isCŞumnsToR•—tAtLeáS‘
(è|| $sh“tS‘up->
	`isRowsToR•—tAtTİS‘
()) {

714 ià(
$sh“tS‘up
->
	`isCŞumnsToR•—tAtLeáS‘
()) {

715 
$»³©
 = 
$sh“tS‘up
->
	`g‘CŞumnsToR•—tAtLeá
();

716 
$cŞmš
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$»³©
[0]) - 1;

717 
$cŞmax
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$»³©
[1]) - 1;

719 
$cŞmš
 = 0;

720 
$cŞmax
 = 255;

723 ià(
$sh“tS‘up
->
	`isRowsToR•—tAtTİS‘
()) {

724 
$»³©
 = 
$sh“tS‘up
->
	`g‘RowsToR•—tAtTİ
();

725 
$rowmš
 = 
$»³©
[0] - 1;

726 
$rowmax
 = 
$»³©
[1] - 1;

728 
$rowmš
 = 0;

729 
$rowmax
 = 65535;

733 
$fÜmuÏD©a
 = 
	`·ck
('Cvvvvv', 0x3B, 
$i
, 
$rowmš
, 
$rowmax
, 
$cŞmš
, 
$cŞmax
);

736 
$chunk
 .ğ
$this
->
	`wr™eD©a
($this->
	`wr™eDefšedNameBiff8
(
	`·ck
('C', 0x07), 
$fÜmuÏD©a
, 
$i
 + 1, 
Œue
));

741 
$i
 = 0; $˜< 
$tÙ®_wÜksh“ts
; ++$i) {

742 
$sh“tS‘up
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘PageS‘up
();

743 ià(
$sh“tS‘up
->
	`isPrštA»aS‘
()) {

745 
$´štA»a
 = 
PHPExûl_C–l
::
	`¥l™Rªge
(
$sh“tS‘up
->
	`g‘PrštA»a
());

746 
$couÁPrštA»a
 = 
	`couÁ
(
$´štA»a
);

748 
$fÜmuÏD©a
 = '';

749 
$j
 = 0; $j < 
$couÁPrštA»a
; ++$j) {

750 
$´štA»aReù
 = 
$´štA»a
[
$j
];

751 
$´štA»aReù
[0] = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
($printAreaRect[0]);

752 
$´štA»aReù
[1] = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
($printAreaRect[1]);

754 
$´št_rowmš
 = 
$´štA»aReù
[0][1] - 1;

755 
$´št_rowmax
 = 
$´štA»aReù
[1][1] - 1;

756 
$´št_cŞmš
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$´štA»aReù
[0][0]) - 1;

757 
$´št_cŞmax
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$´štA»aReù
[1][0]) - 1;

760 
$fÜmuÏD©a
 .ğ
	`·ck
('Cvvvvv', 0x3B, 
$i
, 
$´št_rowmš
, 
$´št_rowmax
, 
$´št_cŞmš
, 
$´št_cŞmax
);

762 ià(
$j
 > 0) {

763 
$fÜmuÏD©a
 .ğ
	`·ck
('C', 0x10);

768 
$chunk
 .ğ
$this
->
	`wr™eD©a
($this->
	`wr™eDefšedNameBiff8
(
	`·ck
('C', 0x06), 
$fÜmuÏD©a
, 
$i
 + 1, 
Œue
));

773 
$i
 = 0; $˜< 
$tÙ®_wÜksh“ts
; ++$i) {

774 
$sh“tAutoF‹r
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘AutoF‹r
();

775 
$autoF‹rRªge
 = 
$sh“tAutoF‹r
->
	`g‘Rªge
();

776 ià(!
	`em±y
(
$autoF‹rRªge
)) {

777 
$¿ngeBounds
 = 
PHPExûl_C–l
::
	`¿ngeBound¬›s
(
$autoF‹rRªge
);

780 
$Çme
 = 
	`·ck
('C', 0x0D);

782 
$chunk
 .ğ
$this
->
	`wr™eD©a
($this->
	`wr™eShÜtNameBiff8
(
$Çme
, 
$i
 + 1, 
$¿ngeBounds
, 
Œue
));

786  
$chunk
;

787 
	}
}

798 
´iv©e
 
funùiÚ
 
	$wr™eDefšedNameBiff8
(
$Çme
, 
$fÜmuÏD©a
, 
$sh“tIndex
 = 0, 
$isButIn
 = 
çl£
)

800 
$»cÜd
 = 0x0018;

803 
$İtiÚs
 = 
$isButIn
 ? 0x20 : 0x00;

806 
$Æ’
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$Çme
);

809 
$Çme
 = 
	`sub¡r
(
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
($name), 2);

812 
$sz
 = 
	`¡¾’
(
$fÜmuÏD©a
);

815 
$d©a
 = 
	`·ck
('vCCvvvCCCC', 
$İtiÚs
, 0, 
$Æ’
, 
$sz
, 0, 
$sh“tIndex
, 0, 0, 0, 0)

816 . 
$Çme
 . 
$fÜmuÏD©a
;

817 
$Ëngth
 = 
	`¡¾’
(
$d©a
);

819 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

821  
$h—d”
 . 
$d©a
;

822 
	}
}

833 
´iv©e
 
funùiÚ
 
	$wr™eShÜtNameBiff8
(
$Çme
, 
$sh“tIndex
 = 0, 
$¿ngeBounds
, 
$isHidd’
 = 
çl£
)

835 
$»cÜd
 = 0x0018;

838 
$İtiÚs
 = (
$isHidd’
 ? 0x21 : 0x00);

840 
$exŒa
 = 
	`·ck
(

843 
$sh“tIndex
 - 1,

844 
$¿ngeBounds
[0][1] - 1,

845 
$¿ngeBounds
[1][1] - 1,

846 
$¿ngeBounds
[0][0] - 1,

847 
$¿ngeBounds
[1][0] - 1

851 
$sz
 = 
	`¡¾’
(
$exŒa
);

854 
$d©a
 = 
	`·ck
('vCCvvvCCCCC', 
$İtiÚs
, 0, 1, 
$sz
, 0, 
$sh“tIndex
, 0, 0, 0, 0, 0)

855 . 
$Çme
 . 
$exŒa
;

856 
$Ëngth
 = 
	`¡¾’
(
$d©a
);

858 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

860  
$h—d”
 . 
$d©a
;

861 
	}
}

866 
´iv©e
 
funùiÚ
 
	$wr™eCod•age
()

868 
$»cÜd
 = 0x0042;

869 
$Ëngth
 = 0x0002;

870 
$cv
 = 
$this
->
cod•age
;

872 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

873 
$d©a
 = 
	`·ck
('v', 
$cv
);

875 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

876 
	}
}

881 
´iv©e
 
funùiÚ
 
	$wr™eWšdow1
()

883 
$»cÜd
 = 0x003D;

884 
$Ëngth
 = 0x0012;

886 
$xWn
 = 0x0000;

887 
$yWn
 = 0x0000;

888 
$dxWn
 = 0x25BC;

889 
$dyWn
 = 0x1572;

891 
$grb™
 = 0x0038;

894 
$ùab£l
 = 1;

896 
$wTabR©io
 = 0x0258;

899 
$™abFœ¡
 = 0;

900 
$™abCur
 = 
$this
->
phpExûl
->
	`g‘AùiveSh“tIndex
();

902 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

903 
$d©a
 = 
	`·ck
("vvvvvvvvv", 
$xWn
, 
$yWn
, 
$dxWn
, 
$dyWn
, 
$grb™
, 
$™abCur
, 
$™abFœ¡
, 
$ùab£l
, 
$wTabR©io
);

904 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

905 
	}
}

913 
´iv©e
 
funùiÚ
 
	$wr™eBoundSh“t
(
$sh“t
, 
$off£t
)

915 
$sh“Šame
 = 
$sh“t
->
	`g‘T™Ë
();

916 
$»cÜd
 = 0x0085;

919 
$sh“t
->
	`g‘Sh“tS‹
()) {

920 
PHPExûl_WÜksh“t
::
SHEETSTATE_VISIBLE
:

921 
$ss
 = 0x00;

923 
PHPExûl_WÜksh“t
::
SHEETSTATE_HIDDEN
:

924 
$ss
 = 0x01;

926 
PHPExûl_WÜksh“t
::
SHEETSTATE_VERYHIDDEN
:

927 
$ss
 = 0x02;

930 
$ss
 = 0x00;

935 
$¡
 = 0x00;

937 
$grb™
 = 0x0000;

939 
$d©a
 = 
	`·ck
("VCC", 
$off£t
, 
$ss
, 
$¡
);

940 
$d©a
 .ğ
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeShÜt
(
$sh“Šame
);

942 
$Ëngth
 = 
	`¡¾’
(
$d©a
);

943 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

944 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

945 
	}
}

950 
´iv©e
 
funùiÚ
 
	$wr™eSupbookIÁ”Çl
()

952 
$»cÜd
 = 0x01AE;

953 
$Ëngth
 = 0x0004;

955 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

956 
$d©a
 = 
	`·ck
("vv", 
$this
->
phpExûl
->
	`g‘Sh“tCouÁ
(), 0x0401);

957  
$this
->
	`wr™eD©a
(
$h—d”
 . 
$d©a
);

958 
	}
}

965 
´iv©e
 
funùiÚ
 
	$wr™eEx‹º®sh“tBiff8
()

967 
$tÙ®Reã»nûs
 = 
	`couÁ
(
$this
->
·r£r
->
»ã»nûs
);

968 
$»cÜd
 = 0x0017;

969 
$Ëngth
 = 2 + 6 * 
$tÙ®Reã»nûs
;

971 
$supbook_šdex
 = 0;

972 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

973 
$d©a
 = 
	`·ck
('v', 
$tÙ®Reã»nûs
);

974 
$i
 = 0; $˜< 
$tÙ®Reã»nûs
; ++$i) {

975 
$d©a
 .ğ
$this
->
·r£r
->
»ã»nûs
[
$i
];

977  
$this
->
	`wr™eD©a
(
$h—d”
 . 
$d©a
);

978 
	}
}

983 
´iv©e
 
funùiÚ
 
	$wr™eStyË
()

985 
$»cÜd
 = 0x0293;

986 
$Ëngth
 = 0x0004;

988 
$ixã
 = 0x8000;

989 
$ButIn
 = 0x00;

990 
$iLev–
 = 0xff;

992 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

993 
$d©a
 = 
	`·ck
("vCC", 
$ixã
, 
$ButIn
, 
$iLev–
);

994 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

995 
	}
}

1003 
´iv©e
 
funùiÚ
 
	$wr™eNumb”FÜm©
(
$fÜm©
, 
$ifmt
)

1005 
$»cÜd
 = 0x041E;

1007 
$numb”FÜm©SŒšg
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
(
$fÜm©
);

1008 
$Ëngth
 = 2 + 
	`¡¾’
(
$numb”FÜm©SŒšg
);

1011 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1012 
$d©a
 = 
	`·ck
("v", 
$ifmt
è. 
$numb”FÜm©SŒšg
;

1013 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1014 
	}
}

1019 
´iv©e
 
funùiÚ
 
	$wr™eD©eMode
()

1021 
$»cÜd
 = 0x0022;

1022 
$Ëngth
 = 0x0002;

1024 
$f1904
 = (
PHPExûl_Sh¬ed_D©e
::
	`g‘ExûlC®’d¬
(è=ğPHPExûl_Sh¬ed_D©e::
CALENDAR_MAC_1904
)

1028 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1029 
$d©a
 = 
	`·ck
("v", 
$f1904
);

1030 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1031 
	}
}

1045 
´iv©e
 
funùiÚ
 
	$wr™eEx‹º®CouÁ
(
$cx®s
)

1047 
$»cÜd
 = 0x0016;

1048 
$Ëngth
 = 0x0002;

1050 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1051 
$d©a
 = 
	`·ck
("v", 
$cx®s
);

1052 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1053 
	}
}

1064 
´iv©e
 
funùiÚ
 
	$wr™eEx‹º®Sh“t
(
$sh“Šame
)

1066 
$»cÜd
 = 0x0017;

1067 
$Ëngth
 = 0x02 + 
	`¡¾’
(
$sh“Šame
);

1069 
$cch
 = 
	`¡¾’
(
$sh“Šame
);

1070 
$rgch
 = 0x03;

1072 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1073 
$d©a
 = 
	`·ck
("CC", 
$cch
, 
$rgch
);

1074 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
 . 
$sh“Šame
);

1075 
	}
}

1088 
´iv©e
 
funùiÚ
 
	$wr™eNameShÜt
(
$šdex
, 
$ty³
, 
$rowmš
, 
$rowmax
, 
$cŞmš
, 
$cŞmax
)

1090 
$»cÜd
 = 0x0018;

1091 
$Ëngth
 = 0x0024;

1093 
$grb™
 = 0x0020;

1094 
$chKey
 = 0x00;

1095 
$cch
 = 0x01;

1096 
$cû
 = 0x0015;

1097 
$ix®s
 = 
$šdex
 + 1;

1098 
$™ab
 = 
$ix®s
;

1099 
$cchCu¡M’u
 = 0x00;

1100 
$cchDesütiÚ
 = 0x00;

1101 
$cchH–±İic
 = 0x00;

1102 
$cchStu¡ext
 = 0x00;

1103 
$rgch
 = 
$ty³
;

1105 
$unknown03
 = 0x3b;

1106 
$unknown04
 = 0xfffà- 
$šdex
;

1107 
$unknown05
 = 0x0000;

1108 
$unknown06
 = 0x0000;

1109 
$unknown07
 = 0x1087;

1110 
$unknown08
 = 0x8005;

1112 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1113 
$d©a
 = 
	`·ck
("v", 
$grb™
);

1114 
$d©a
 .ğ
	`·ck
("C", 
$chKey
);

1115 
$d©a
 .ğ
	`·ck
("C", 
$cch
);

1116 
$d©a
 .ğ
	`·ck
("v", 
$cû
);

1117 
$d©a
 .ğ
	`·ck
("v", 
$ix®s
);

1118 
$d©a
 .ğ
	`·ck
("v", 
$™ab
);

1119 
$d©a
 .ğ
	`·ck
("C", 
$cchCu¡M’u
);

1120 
$d©a
 .ğ
	`·ck
("C", 
$cchDesütiÚ
);

1121 
$d©a
 .ğ
	`·ck
("C", 
$cchH–±İic
);

1122 
$d©a
 .ğ
	`·ck
("C", 
$cchStu¡ext
);

1123 
$d©a
 .ğ
	`·ck
("C", 
$rgch
);

1124 
$d©a
 .ğ
	`·ck
("C", 
$unknown03
);

1125 
$d©a
 .ğ
	`·ck
("v", 
$unknown04
);

1126 
$d©a
 .ğ
	`·ck
("v", 
$unknown05
);

1127 
$d©a
 .ğ
	`·ck
("v", 
$unknown06
);

1128 
$d©a
 .ğ
	`·ck
("v", 
$unknown07
);

1129 
$d©a
 .ğ
	`·ck
("v", 
$unknown08
);

1130 
$d©a
 .ğ
	`·ck
("v", 
$šdex
);

1131 
$d©a
 .ğ
	`·ck
("v", 
$šdex
);

1132 
$d©a
 .ğ
	`·ck
("v", 
$rowmš
);

1133 
$d©a
 .ğ
	`·ck
("v", 
$rowmax
);

1134 
$d©a
 .ğ
	`·ck
("C", 
$cŞmš
);

1135 
$d©a
 .ğ
	`·ck
("C", 
$cŞmax
);

1136 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1137 
	}
}

1152 
´iv©e
 
funùiÚ
 
	$wr™eNameLÚg
(
$šdex
, 
$ty³
, 
$rowmš
, 
$rowmax
, 
$cŞmš
, 
$cŞmax
)

1154 
$»cÜd
 = 0x0018;

1155 
$Ëngth
 = 0x003d;

1156 
$grb™
 = 0x0020;

1157 
$chKey
 = 0x00;

1158 
$cch
 = 0x01;

1159 
$cû
 = 0x002e;

1160 
$ix®s
 = 
$šdex
 + 1;

1161 
$™ab
 = 
$ix®s
;

1162 
$cchCu¡M’u
 = 0x00;

1163 
$cchDesütiÚ
 = 0x00;

1164 
$cchH–±İic
 = 0x00;

1165 
$cchStu¡ext
 = 0x00;

1166 
$rgch
 = 
$ty³
;

1168 
$unknown01
 = 0x29;

1169 
$unknown02
 = 0x002b;

1170 
$unknown03
 = 0x3b;

1171 
$unknown04
 = 0xffff-
$šdex
;

1172 
$unknown05
 = 0x0000;

1173 
$unknown06
 = 0x0000;

1174 
$unknown07
 = 0x1087;

1175 
$unknown08
 = 0x8008;

1177 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1178 
$d©a
 = 
	`·ck
("v", 
$grb™
);

1179 
$d©a
 .ğ
	`·ck
("C", 
$chKey
);

1180 
$d©a
 .ğ
	`·ck
("C", 
$cch
);

1181 
$d©a
 .ğ
	`·ck
("v", 
$cû
);

1182 
$d©a
 .ğ
	`·ck
("v", 
$ix®s
);

1183 
$d©a
 .ğ
	`·ck
("v", 
$™ab
);

1184 
$d©a
 .ğ
	`·ck
("C", 
$cchCu¡M’u
);

1185 
$d©a
 .ğ
	`·ck
("C", 
$cchDesütiÚ
);

1186 
$d©a
 .ğ
	`·ck
("C", 
$cchH–±İic
);

1187 
$d©a
 .ğ
	`·ck
("C", 
$cchStu¡ext
);

1188 
$d©a
 .ğ
	`·ck
("C", 
$rgch
);

1189 
$d©a
 .ğ
	`·ck
("C", 
$unknown01
);

1190 
$d©a
 .ğ
	`·ck
("v", 
$unknown02
);

1192 
$d©a
 .ğ
	`·ck
("C", 
$unknown03
);

1193 
$d©a
 .ğ
	`·ck
("v", 
$unknown04
);

1194 
$d©a
 .ğ
	`·ck
("v", 
$unknown05
);

1195 
$d©a
 .ğ
	`·ck
("v", 
$unknown06
);

1196 
$d©a
 .ğ
	`·ck
("v", 
$unknown07
);

1197 
$d©a
 .ğ
	`·ck
("v", 
$unknown08
);

1198 
$d©a
 .ğ
	`·ck
("v", 
$šdex
);

1199 
$d©a
 .ğ
	`·ck
("v", 
$šdex
);

1200 
$d©a
 .ğ
	`·ck
("v", 0x0000);

1201 
$d©a
 .ğ
	`·ck
("v", 0x3fff);

1202 
$d©a
 .ğ
	`·ck
("C", 
$cŞmš
);

1203 
$d©a
 .ğ
	`·ck
("C", 
$cŞmax
);

1205 
$d©a
 .ğ
	`·ck
("C", 
$unknown03
);

1206 
$d©a
 .ğ
	`·ck
("v", 
$unknown04
);

1207 
$d©a
 .ğ
	`·ck
("v", 
$unknown05
);

1208 
$d©a
 .ğ
	`·ck
("v", 
$unknown06
);

1209 
$d©a
 .ğ
	`·ck
("v", 
$unknown07
);

1210 
$d©a
 .ğ
	`·ck
("v", 
$unknown08
);

1211 
$d©a
 .ğ
	`·ck
("v", 
$šdex
);

1212 
$d©a
 .ğ
	`·ck
("v", 
$šdex
);

1213 
$d©a
 .ğ
	`·ck
("v", 
$rowmš
);

1214 
$d©a
 .ğ
	`·ck
("v", 
$rowmax
);

1215 
$d©a
 .ğ
	`·ck
("C", 0x00);

1216 
$d©a
 .ğ
	`·ck
("C", 0xff);

1218 
$d©a
 .ğ
	`·ck
("C", 0x10);

1219 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1220 
	}
}

1227 
´iv©e
 
funùiÚ
 
	$wr™eCouÁry
()

1229 
$»cÜd
 = 0x008C;

1230 
$Ëngth
 = 4;

1232 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

1234 
$d©a
 = 
	`·ck
('vv', 
$this
->
couÁryCode
, $this->countryCode);

1236  
$this
->
	`wr™eD©a
(
$h—d”
 . 
$d©a
);

1237 
	}
}

1244 
´iv©e
 
funùiÚ
 
	$wr™eReÿlcId
()

1246 
$»cÜd
 = 0x01C1;

1247 
$Ëngth
 = 8;

1249 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

1252 
$d©a
 = 
	`·ck
('VV', 0x000001C1, 0x00001E667);

1254  
$this
->
	`wr™eD©a
(
$h—d”
 . 
$d©a
);

1255 
	}
}

1260 
´iv©e
 
funùiÚ
 
	$wr™eP®‘‹
()

1262 
$¬ef
 = 
$this
->
·Ë‰e
;

1264 
$»cÜd
 = 0x0092;

1265 
$Ëngth
 = 2 + 4 * 
	`couÁ
(
$¬ef
);

1266 
$ccv
 = 
	`couÁ
(
$¬ef
);

1267 
$d©a
 = '';

1270 
	`fÜ—ch
 (
$¬ef
 
as
 
$cŞÜ
) {

1271 
	`fÜ—ch
 (
$cŞÜ
 
as
 
$by‹
) {

1272 
$d©a
 .ğ
	`·ck
("C", 
$by‹
);

1276 
$h—d”
 = 
	`·ck
("vvv", 
$»cÜd
, 
$Ëngth
, 
$ccv
);

1277 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1278 
	}
}

1294 
´iv©e
 
funùiÚ
 
	$wr™eSh¬edSŒšgsTabË
()

1297 
$cÚtšue_lim™
 = 8224;

1300 
$»cÜdD©as
 = 
	`¬¿y
();

1303 
$»cÜdD©a
 = 
	`·ck
("VV", 
$this
->
¡ršgTÙ®
, $this->
¡ršgUnique
);

1306 
	`fÜ—ch
 (
	`¬¿y_keys
(
$this
->
¡ršgTabË
è
as
 
$¡ršg
) {

1310 
$h—d”šfo
 = 
	`uÅack
("vËngth/C’codšg", 
$¡ršg
);

1313 
$’codšg
 = 
$h—d”šfo
["encoding"];

1316 
$fšished
 = 
çl£
;

1318 
$fšished
 ==ğ
çl£
) {

1323 ià(
	`¡¾’
(
$»cÜdD©a
è+ sŒËn(
$¡ršg
è<ğ
$cÚtšue_lim™
) {

1325 
$»cÜdD©a
 .ğ
$¡ršg
;

1327 ià(
	`¡¾’
(
$»cÜdD©a
è+ sŒËn(
$¡ršg
è=ğ
$cÚtšue_lim™
) {

1329 
$»cÜdD©as
[] = 
$»cÜdD©a
;

1330 
$»cÜdD©a
 = '';

1334 
$fšished
 = 
Œue
;

1340 
$¥aû_»maššg
 = 
$cÚtšue_lim™
 - 
	`¡¾’
(
$»cÜdD©a
);

1345 
$mš_¥aû_Ãeded
 = (
$’codšg
 == 1) ? 5 : 4;

1354 ià(
$¥aû_»maššg
 < 
$mš_¥aû_Ãeded
) {

1356 
$»cÜdD©as
[] = 
$»cÜdD©a
;

1359 
$»cÜdD©a
 = '';

1364 
$efãùive_¥aû_»maššg
 = 
$¥aû_»maššg
;

1367 ià(
$’codšg
 =ğ1 && (
	`¡¾’
(
$¡ršg
è- 
$¥aû_»maššg
) % 2 == 1) {

1368 --
$efãùive_¥aû_»maššg
;

1372 
$»cÜdD©a
 .ğ
	`sub¡r
(
$¡ršg
, 0, 
$efãùive_¥aû_»maššg
);

1374 
$¡ršg
 = 
	`sub¡r
($¡ršg, 
$efãùive_¥aû_»maššg
);

1375 
$»cÜdD©as
[] = 
$»cÜdD©a
;

1378 
$»cÜdD©a
 = 
	`·ck
('C', 
$’codšg
);

1386 ià(
	`¡¾’
(
$»cÜdD©a
) > 0) {

1387 
$»cÜdD©as
[] = 
$»cÜdD©a
;

1391 
$chunk
 = '';

1392 
	`fÜ—ch
 (
$»cÜdD©as
 
as
 
$i
 => 
$»cÜdD©a
) {

1394 
$»cÜd
 = (
$i
 == 0) ? 0x00FC : 0x003C;

1396 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
	`¡¾’
(
$»cÜdD©a
));

1397 
$d©a
 = 
$h—d”
 . 
$»cÜdD©a
;

1399 
$chunk
 .ğ
$this
->
	`wr™eD©a
(
$d©a
);

1402  
$chunk
;

1403 
	}
}

1408 
´iv©e
 
funùiÚ
 
	$wr™eMsoD¿wšgGroup
()

1411 ià(
	`is£t
(
$this
->
esch”
)) {

1412 
$wr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_Esch”
(
$this
->
esch”
);

1413 
$d©a
 = 
$wr™”
->
	`şo£
();

1415 
$»cÜd
 = 0x00EB;

1416 
$Ëngth
 = 
	`¡¾’
(
$d©a
);

1417 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1419  
$this
->
	`wr™eD©a
(
$h—d”
 . 
$d©a
);

1423 
	}
}

1430 
public
 
funùiÚ
 
	$g‘Esch”
()

1432  
$this
->
esch”
;

1433 
	}
}

1440 
public
 
funùiÚ
 
	$£tEsch”
(
PHPExûl_Sh¬ed_Esch”
 
$pV®ue
 = 
nuÎ
)

1442 
$this
->
esch”
 = 
$pV®ue
;

1443 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Worksheet.php

1 <?
php


63 şas 
	cPHPExûl_Wr™”_Exûl5_WÜksh“t
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl5_BIFFwr™”


70 
´iv©e
 
	m$·r£r
;

76 
´iv©e
 
	m$xlsSŒšgMaxL’gth
;

82 
´iv©e
 
	m$cŞumnInfo
;

88 
´iv©e
 
	m$£ËùiÚ
;

94 
´iv©e
 
	m$aùivePªe
;

100 
´iv©e
 
	m$oušeOn
;

106 
´iv©e
 
	m$oušeStyË
;

112 
´iv©e
 
	m$oušeB–ow
;

118 
´iv©e
 
	m$oušeRight
;

124 
´iv©e
 
	m$¡ršgTÙ®
;

130 
´iv©e
 
	m$¡ršgUnique
;

136 
´iv©e
 
	m$¡ršgTabË
;

141 
´iv©e
 
	m$cŞÜs
;

147 
´iv©e
 
	m$fœ¡RowIndex
;

153 
´iv©e
 
	m$Ï¡RowIndex
;

159 
´iv©e
 
	m$fœ¡CŞumnIndex
;

165 
´iv©e
 
	m$Ï¡CŞumnIndex
;

171 
public
 
	m$phpSh“t
;

178 
´iv©e
 
	m$couÁC–lStyËXfs
;

185 
´iv©e
 
	m$esch”
;

192 
public
 
	m$fÚtHashIndex
;

206 
public
 
funùiÚ
 
	$__cÚ¡ruù
(&
$¡r_tÙ®
, &
$¡r_unique
, &
$¡r_bË
, &
$cŞÜs
, 
$·r£r
, 
$´eC®cuÏ‹FÜmuÏs
, 
$phpSh“t
)

209 
·»Á
::
	`__cÚ¡ruù
();

215 
$this
->
_´eC®cuÏ‹FÜmuÏs
 = 
$´eC®cuÏ‹FÜmuÏs
;

216 
$this
->
¡ršgTÙ®
 = &
$¡r_tÙ®
;

217 
$this
->
¡ršgUnique
 = &
$¡r_unique
;

218 
$this
->
¡ršgTabË
 = &
$¡r_bË
;

219 
$this
->
cŞÜs
 = &
$cŞÜs
;

220 
$this
->
·r£r
 = 
$·r£r
;

222 
$this
->
phpSh“t
 = 
$phpSh“t
;

226 
$this
->
xlsSŒšgMaxL’gth
 = 255;

227 
$this
->
cŞumnInfo
 = 
	`¬¿y
();

228 
$this
->
£ËùiÚ
 = 
	`¬¿y
(0,0,0,0);

229 
$this
->
aùivePªe
 = 3;

231 
$this
->
_´št_h—d”s
 = 0;

233 
$this
->
oušeStyË
 = 0;

234 
$this
->
oušeB–ow
 = 1;

235 
$this
->
oušeRight
 = 1;

236 
$this
->
oušeOn
 = 1;

238 
$this
->
fÚtHashIndex
 = 
	`¬¿y
();

241 
$mšR
 = 1;

242 
$mšC
 = 'A';

244 
$maxR
 = 
$this
->
phpSh“t
->
	`g‘Highe¡Row
();

245 
$maxC
 = 
$this
->
phpSh“t
->
	`g‘Highe¡CŞumn
();

249 
$this
->
Ï¡RowIndex
 = (
$maxR
 > 65535) ? 65535 : $maxR ;

251 
$this
->
fœ¡CŞumnIndex
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$mšC
);

252 
$this
->
Ï¡CŞumnIndex
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$maxC
);

255 ià(
$this
->
Ï¡CŞumnIndex
 > 255) {

256 
$this
->
Ï¡CŞumnIndex
 = 255;

259 
$this
->
couÁC–lStyËXfs
 = 
	`couÁ
(
$phpSh“t
->
	`g‘P¬’t
()->
	`g‘C–lStyËXfCŞËùiÚ
());

269 
public
 
funùiÚ
 
	$şo£
()

271 
$phpSh“t
 = 
$this
->
phpSh“t
;

273 
$num_sh“ts
 = 
$phpSh“t
->
	`g‘P¬’t
()->
	`g‘Sh“tCouÁ
();

276 
$this
->
	`¡ÜeBof
(0x0010);

279 
$this
->
	`wr™ePrštH—d”s
();

282 
$this
->
	`wr™ePrštGridlšes
();

285 
$this
->
	`wr™eGrid£t
();

288 
$phpSh“t
->
	`ÿlcuÏ‹CŞumnWidths
();

291 ià((
$deçuÉWidth
 = 
$phpSh“t
->
	`g‘DeçuÉCŞumnDim’siÚ
()->
	`g‘Width
()) < 0) {

292 
$deçuÉWidth
 = 
PHPExûl_Sh¬ed_FÚt
::
	`g‘DeçuÉCŞumnWidthByFÚt
(
$phpSh“t
->
	`g‘P¬’t
()->
	`g‘DeçuÉStyË
()->
	`g‘FÚt
());

295 
$cŞumnDim’siÚs
 = 
$phpSh“t
->
	`g‘CŞumnDim’siÚs
();

296 
$maxCŞ
 = 
$this
->
Ï¡CŞumnIndex
 -1;

297 
$i
 = 0; $˜<ğ
$maxCŞ
; ++$i) {

298 
$hidd’
 = 0;

299 
$Ëv–
 = 0;

300 
$xfIndex
 = 15;

302 
$width
 = 
$deçuÉWidth
;

304 
$cŞumnL‘‹r
 = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$i
);

305 ià(
	`is£t
(
$cŞumnDim’siÚs
[
$cŞumnL‘‹r
])) {

306 
$cŞumnDim’siÚ
 = 
$cŞumnDim’siÚs
[
$cŞumnL‘‹r
];

307 ià(
$cŞumnDim’siÚ
->
	`g‘Width
() >= 0) {

308 
$width
 = 
$cŞumnDim’siÚ
->
	`g‘Width
();

310 
$hidd’
 = 
$cŞumnDim’siÚ
->
	`g‘VisibË
() ? 0 : 1;

311 
$Ëv–
 = 
$cŞumnDim’siÚ
->
	`g‘OušeLev–
();

312 
$xfIndex
 = 
$cŞumnDim’siÚ
->
	`g‘XfIndex
() + 15;

322 
$this
->
cŞumnInfo
[] = 
	`¬¿y
(
$i
, $i, 
$width
, 
$xfIndex
, 
$hidd’
, 
$Ëv–
);

326 
$this
->
	`wr™eGuts
();

329 
$this
->
	`wr™eDeçuÉRowHeight
();

331 
$this
->
	`wr™eWsboŞ
();

333 
$this
->
	`wr™eB»aks
();

335 
$this
->
	`wr™eH—d”
();

337 
$this
->
	`wr™eFoÙ”
();

339 
$this
->
	`wr™eHûÁ”
();

341 
$this
->
	`wr™eVûÁ”
();

343 
$this
->
	`wr™eM¬gšLeá
();

345 
$this
->
	`wr™eM¬gšRight
();

347 
$this
->
	`wr™eM¬gšTİ
();

349 
$this
->
	`wr™eM¬gšBÙtom
();

351 
$this
->
	`wr™eS‘up
();

353 
$this
->
	`wr™ePrÙeù
();

355 
$this
->
	`wr™eSûnPrÙeù
();

357 
$this
->
	`wr™eObjeùPrÙeù
();

359 
$this
->
	`wr™ePasswÜd
();

361 
$this
->
	`wr™eDefcŞ
();

364 ià(!
	`em±y
(
$this
->
cŞumnInfo
)) {

365 
$cŞcouÁ
 = 
	`couÁ
(
$this
->
cŞumnInfo
);

366 
$i
 = 0; $˜< 
$cŞcouÁ
; ++$i) {

367 
$this
->
	`wr™eCŞšfo
($this->
cŞumnInfo
[
$i
]);

370 
$autoF‹rRªge
 = 
$phpSh“t
->
	`g‘AutoF‹r
()->
	`g‘Rªge
();

371 ià(!
	`em±y
(
$autoF‹rRªge
)) {

373 
$this
->
	`wr™eAutoF‹rInfo
();

377 
$this
->
	`wr™eDim’siÚs
();

380 
	`fÜ—ch
 (
$phpSh“t
->
	`g‘RowDim’siÚs
(è
as
 
$rowDim’siÚ
) {

381 
$xfIndex
 = 
$rowDim’siÚ
->
	`g‘XfIndex
() + 15;

382 
$this
->
	`wr™eRow
(
$rowDim’siÚ
->
	`g‘RowIndex
(è- 1, $rowDim’siÚ->
	`g‘RowHeight
(), 
$xfIndex
, ($rowDim’siÚ->
	`g‘VisibË
(è? '0' : '1'), $rowDim’siÚ->
	`g‘OušeLev–
());

386 
	`fÜ—ch
 (
$phpSh“t
->
	`g‘C–lCŞËùiÚ
(è
as
 
$ûÎID
) {

387 
$ûÎ
 = 
$phpSh“t
->
	`g‘C–l
(
$ûÎID
);

388 
$row
 = 
$ûÎ
->
	`g‘Row
() - 1;

389 
$cŞumn
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$ûÎ
->
	`g‘CŞumn
()) - 1;

393 ià(
$row
 > 65535 || 
$cŞumn
 > 255) {

398 
$xfIndex
 = 
$ûÎ
->
	`g‘XfIndex
() + 15;

400 
$cV®
 = 
$ûÎ
->
	`g‘V®ue
();

401 ià(
$cV®
 
š¡ªûof
 
PHPExûl_RichText
) {

403 
$¬rcRun
 = 
	`¬¿y
();

404 
$¡r_Ën
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$cV®
->
	`g‘PÏšText
(), 'UTF-8');

405 
$¡r_pos
 = 0;

406 
$–em’ts
 = 
$cV®
->
	`g‘RichTextEËm’ts
();

407 
	`fÜ—ch
 (
$–em’ts
 
as
 
$–em’t
) {

409 ià(
$–em’t
 
š¡ªûof
 
PHPExûl_RichText_Run
) {

410 
$¡r_fÚtidx
 = 
$this
->
fÚtHashIndex
[
$–em’t
->
	`g‘FÚt
()->
	`g‘HashCode
()];

412 
$¡r_fÚtidx
 = 0;

414 
$¬rcRun
[] = 
	`¬¿y
('¡¾’' => 
$¡r_pos
, 'fÚtidx' => 
$¡r_fÚtidx
);

416 
$¡r_pos
 +ğ
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$–em’t
->
	`g‘Text
(), 'UTF-8');

418 
$this
->
	`wr™eRichTextSŒšg
(
$row
, 
$cŞumn
, 
$cV®
->
	`g‘PÏšText
(), 
$xfIndex
, 
$¬rcRun
);

420 
$ûÎ
->
	`g‘D©©y³
()) {

421 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
:

422 
PHPExûl_C–l_D©aTy³
::
TYPE_NULL
:

423 ià(
$cV®
 ==ğ'' || $cV® ==ğ
nuÎ
) {

424 
$this
->
	`wr™eBÏnk
(
$row
, 
$cŞumn
, 
$xfIndex
);

426 
$this
->
	`wr™eSŒšg
(
$row
, 
$cŞumn
, 
$cV®
, 
$xfIndex
);

430 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
:

431 
$this
->
	`wr™eNumb”
(
$row
, 
$cŞumn
, 
$cV®
, 
$xfIndex
);

434 
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
:

435 
$ÿlcuÏ‹dV®ue
 = 
$this
->
_´eC®cuÏ‹FÜmuÏs
 ?

436 
$ûÎ
->
	`g‘C®cuÏ‹dV®ue
(è: 
nuÎ
;

437 
$this
->
	`wr™eFÜmuÏ
(
$row
, 
$cŞumn
, 
$cV®
, 
$xfIndex
, 
$ÿlcuÏ‹dV®ue
);

440 
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
:

441 
$this
->
	`wr™eBoŞE¼
(
$row
, 
$cŞumn
, 
$cV®
, 0, 
$xfIndex
);

444 
PHPExûl_C–l_D©aTy³
::
TYPE_ERROR
:

445 
$this
->
	`wr™eBoŞE¼
(
$row
, 
$cŞumn
, 
£lf
::
	`m­E¼ÜCode
(
$cV®
), 1, 
$xfIndex
);

453 
$this
->
	`wr™eMsoD¿wšg
();

456 
$this
->
	`wr™eWšdow2
();

459 
$this
->
	`wr™ePageLayoutV›w
();

462 
$this
->
	`wr™eZoom
();

463 ià(
$phpSh“t
->
	`g‘F»ezePªe
()) {

464 
$this
->
	`wr™ePªes
();

468 
$this
->
	`wr™eS–eùiÚ
();

471 
$this
->
	`wr™eM”gedC–ls
();

474 
	`fÜ—ch
 (
$phpSh“t
->
	`g‘Hy³rLškCŞËùiÚ
(è
as
 
$coÜdš©e
 => 
$hy³¾šk
) {

475 
	`li¡
(
$cŞumn
, 
$row
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$coÜdš©e
);

477 
$u¾
 = 
$hy³¾šk
->
	`g‘U¾
();

479 ià(
	`¡½os
(
$u¾
, 'sh“t://'è!=ğ
çl£
) {

481 
$u¾
 = 
	`¡r_»¶aû
('sheet://', 'internal:', $url);

483 } 
	`–£if
 (
	`´eg_m©ch
('/^(h‰p:|h‰ps:|áp:|mato:)/', 
$u¾
)) {

489 
$u¾
 = 'external:' . $url;

492 
$this
->
	`wr™eU¾
(
$row
 - 1, 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞumn
è- 1, 
$u¾
);

495 
$this
->
	`wr™eD©aV®id™y
();

496 
$this
->
	`wr™eSh“tLayout
();

499 
$this
->
	`wr™eSh“tPrÙeùiÚ
();

500 
$this
->
	`wr™eRªgePrÙeùiÚ
();

502 
$¬rCÚd™iÚ®StyËs
 = 
$phpSh“t
->
	`g‘CÚd™iÚ®StyËsCŞËùiÚ
();

503 ià(!
	`em±y
(
$¬rCÚd™iÚ®StyËs
)) {

504 
$¬rCÚd™iÚ®
 = 
	`¬¿y
();

507 
$this
->
	`wr™eCFH—d”
();

509 
	`fÜ—ch
 (
$¬rCÚd™iÚ®StyËs
 
as
 
$ûÎCoÜdš©e
 => 
$cÚd™iÚ®StyËs
) {

510 
	`fÜ—ch
 (
$cÚd™iÚ®StyËs
 
as
 
$cÚd™iÚ®
) {

511 ià(
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_EXPRESSION


512 || 
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CELLIS
) {

513 ià(!
	`š_¬¿y
(
$cÚd™iÚ®
->
	`g‘HashCode
(), 
$¬rCÚd™iÚ®
)) {

514 
$¬rCÚd™iÚ®
[] = 
$cÚd™iÚ®
->
	`g‘HashCode
();

516 
$this
->
	`wr™eCFRuË
(
$cÚd™iÚ®
);

523 
$this
->
	`¡ÜeEof
();

524 
	}
}

534 
´iv©e
 
funùiÚ
 
wr™eBIFF8C–lRªgeAdd»ssFixed
(
$¿nge
 = 'A1')

536 
$ex¶odes
 = 
ex¶ode
(':', 
$¿nge
);

539 
	g$fœ¡C–l
 = 
$ex¶odes
[0];

542 ià(
couÁ
(
$ex¶odes
) == 1) {

543 
$Ï¡C–l
 = 
$fœ¡C–l
;

545 
	g$Ï¡C–l
 = 
$ex¶odes
[1];

548 
	g$fœ¡C–lCoÜdš©es
 = 
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$fœ¡C–l
);

549 
	g$Ï¡C–lCoÜdš©es
 = 
PHPExûl_C–l
::
coÜdš©eFromSŒšg
(
$Ï¡C–l
);

551  
·ck
('vvvv', 
$fœ¡C–lCoÜdš©es
[1] - 1, 
$Ï¡C–lCoÜdš©es
[1] - 1, 
PHPExûl_C–l
::
cŞumnIndexFromSŒšg
($firstCellCoordinates[0]) - 1, PHPExcel_Cell::columnIndexFromString($lastCellCoordinates[0]) - 1);

560 
public
 
funùiÚ
 
	$g‘D©a
()

562 
$bufãr
 = 4096;

565 ià(
	`is£t
(
$this
->
_d©a
)) {

566 
$tmp
 = 
$this
->
_d©a
;

567 
	`un£t
(
$this
->
_d©a
);

568  
$tmp
;

571  
çl£
;

572 
	}
}

580 
public
 
funùiÚ
 
	$´štRowCŞH—d”s
(
$´št
 = 1)

582 
$this
->
_´št_h—d”s
 = 
$´št
;

583 
	}
}

594 
public
 
funùiÚ
 
	$£tOuše
(
$visibË
 = 
Œue
, 
$symbŞs_b–ow
 =rue, 
$symbŞs_right
 =rue, 
$auto_¡yË
 = 
çl£
)

596 
$this
->
oušeOn
 = 
$visibË
;

597 
$this
->
oušeB–ow
 = 
$symbŞs_b–ow
;

598 
$this
->
oušeRight
 = 
$symbŞs_right
;

599 
$this
->
oušeStyË
 = 
$auto_¡yË
;

602 ià(
$this
->
oušeOn
) {

603 
$this
->
oušeOn
 = 1;

605 
	}
}

621 
´iv©e
 
funùiÚ
 
	$wr™eNumb”
(
$row
, 
$cŞ
, 
$num
, 
$xfIndex
)

623 
$»cÜd
 = 0x0203;

624 
$Ëngth
 = 0x000E;

626 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

627 
$d©a
 = 
	`·ck
("vvv", 
$row
, 
$cŞ
, 
$xfIndex
);

628 
$xl_doubË
 = 
	`·ck
("d", 
$num
);

629 ià(
£lf
::
	`g‘By‹Ord”
()) {

630 
$xl_doubË
 = 
	`¡¼ev
($xl_double);

633 
$this
->
	`­³nd
(
$h—d”
.
$d©a
.
$xl_doubË
);

635 
	}
}

645 
´iv©e
 
funùiÚ
 
	$wr™eSŒšg
(
$row
, 
$cŞ
, 
$¡r
, 
$xfIndex
)

647 
$this
->
	`wr™eLab–S¡
(
$row
, 
$cŞ
, 
$¡r
, 
$xfIndex
);

648 
	}
}

659 
´iv©e
 
funùiÚ
 
	$wr™eRichTextSŒšg
(
$row
, 
$cŞ
, 
$¡r
, 
$xfIndex
, 
$¬rcRun
)

661 
$»cÜd
 = 0x00FD;

662 
$Ëngth
 = 0x000A;

663 
$¡r
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeShÜt
($¡r, 
$¬rcRun
);

666 ià(!
	`is£t
(
$this
->
¡ršgTabË
[
$¡r
])) {

667 
$this
->
¡ršgTabË
[
$¡r
] = $this->
¡ršgUnique
++;

669 
$this
->
¡ršgTÙ®
++;

671 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

672 
$d©a
 = 
	`·ck
('vvvV', 
$row
, 
$cŞ
, 
$xfIndex
, 
$this
->
¡ršgTabË
[
$¡r
]);

673 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

674 
	}
}

691 
´iv©e
 
funùiÚ
 
	$wr™eLab–
(
$row
, 
$cŞ
, 
$¡r
, 
$xfIndex
)

693 
$¡¾’
 = 
	`¡¾’
(
$¡r
);

694 
$»cÜd
 = 0x0204;

695 
$Ëngth
 = 0x0008 + 
$¡¾’
;

697 
$¡r_”rÜ
 = 0;

699 ià(
$¡¾’
 > 
$this
->
xlsSŒšgMaxL’gth
) {

700 
$¡r
 = 
	`sub¡r
($¡r, 0, 
$this
->
xlsSŒšgMaxL’gth
);

701 
$Ëngth
 = 0x0008 + 
$this
->
xlsSŒšgMaxL’gth
;

702 
$¡¾’
 = 
$this
->
xlsSŒšgMaxL’gth
;

703 
$¡r_”rÜ
 = -3;

706 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

707 
$d©a
 = 
	`·ck
("vvvv", 
$row
, 
$cŞ
, 
$xfIndex
, 
$¡¾’
);

708 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
 . 
$¡r
);

709 (
$¡r_”rÜ
);

710 
	}
}

727 
´iv©e
 
funùiÚ
 
	$wr™eLab–S¡
(
$row
, 
$cŞ
, 
$¡r
, 
$xfIndex
)

729 
$»cÜd
 = 0x00FD;

730 
$Ëngth
 = 0x000A;

732 
$¡r
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
($str);

735 ià(!
	`is£t
(
$this
->
¡ršgTabË
[
$¡r
])) {

736 
$this
->
¡ršgTabË
[
$¡r
] = $this->
¡ršgUnique
++;

738 
$this
->
¡ršgTÙ®
++;

740 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

741 
$d©a
 = 
	`·ck
('vvvV', 
$row
, 
$cŞ
, 
$xfIndex
, 
$this
->
¡ršgTabË
[
$¡r
]);

742 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

743 
	}
}

753 
´iv©e
 
funùiÚ
 
	$wr™eNÙe
(
$row
, 
$cŞ
, 
$nÙe
)

755 
$nÙe_Ëngth
 = 
	`¡¾’
(
$nÙe
);

756 
$»cÜd
 = 0x001C;

757 
$max_Ëngth
 = 2048;

760 
$Ëngth
 = 0x0006 + 
	`mš
(
$nÙe_Ëngth
, 2048);

761 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

762 
$d©a
 = 
	`·ck
("vvv", 
$row
, 
$cŞ
, 
$nÙe_Ëngth
);

763 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
 . 
	`sub¡r
(
$nÙe
, 0, 2048));

765 
$i
 = 
$max_Ëngth
; $˜< 
$nÙe_Ëngth
; $i += $max_length) {

766 
$chunk
 = 
	`sub¡r
(
$nÙe
, 
$i
, 
$max_Ëngth
);

767 
$Ëngth
 = 0x0006 + 
	`¡¾’
(
$chunk
);

768 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

769 
$d©a
 = 
	`·ck
("vvv", -1, 0, 
	`¡¾’
(
$chunk
));

770 
$this
->
	`­³nd
(
$h—d”
.
$d©a
.
$chunk
);

773 
	}
}

791 
public
 
funùiÚ
 
	$wr™eBÏnk
(
$row
, 
$cŞ
, 
$xfIndex
)

793 
$»cÜd
 = 0x0201;

794 
$Ëngth
 = 0x0006;

796 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

797 
$d©a
 = 
	`·ck
("vvv", 
$row
, 
$cŞ
, 
$xfIndex
);

798 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

800 
	}
}

811 
´iv©e
 
funùiÚ
 
	$wr™eBoŞE¼
(
$row
, 
$cŞ
, 
$v®ue
, 
$isE¼Ü
, 
$xfIndex
)

813 
$»cÜd
 = 0x0205;

814 
$Ëngth
 = 8;

816 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

817 
$d©a
 = 
	`·ck
("vvvCC", 
$row
, 
$cŞ
, 
$xfIndex
, 
$v®ue
, 
$isE¼Ü
);

818 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

820 
	}
}

838 
´iv©e
 
funùiÚ
 
	$wr™eFÜmuÏ
(
$row
, 
$cŞ
, 
$fÜmuÏ
, 
$xfIndex
, 
$ÿlcuÏ‹dV®ue
)

840 
$»cÜd
 = 0x0006;

843 
$¡ršgV®ue
 = 
nuÎ
;

846 ià(
	`is£t
(
$ÿlcuÏ‹dV®ue
)) {

849 ià(
	`is_boŞ
(
$ÿlcuÏ‹dV®ue
)) {

851 
$num
 = 
	`·ck
('CCCvCv', 0x01, 0x00, ()
$ÿlcuÏ‹dV®ue
, 0x00, 0x00, 0xFFFF);

852 } 
	`–£if
 (
	`is_št
(
$ÿlcuÏ‹dV®ue
è|| 
	`is_æßt
($calculatedValue)) {

854 
$num
 = 
	`·ck
('d', 
$ÿlcuÏ‹dV®ue
);

855 } 
	`–£if
 (
	`is_¡ršg
(
$ÿlcuÏ‹dV®ue
)) {

856 ià(
	`¬¿y_key_exi¡s
(
$ÿlcuÏ‹dV®ue
, 
PHPExûl_C–l_D©aTy³
::
	`g‘E¼ÜCodes
())) {

858 
$num
 = 
	`·ck
('CCCvCv', 0x02, 0x00, 
£lf
::
	`m­E¼ÜCode
(
$ÿlcuÏ‹dV®ue
), 0x00, 0x00, 0xFFFF);

859 } 
	`–£if
 (
$ÿlcuÏ‹dV®ue
 === '') {

861 
$num
 = 
	`·ck
('CCCvCv', 0x03, 0x00, 0x00, 0x00, 0x00, 0xFFFF);

864 
$¡ršgV®ue
 = 
$ÿlcuÏ‹dV®ue
;

865 
$num
 = 
	`·ck
('CCCvCv', 0x00, 0x00, 0x00, 0x00, 0x00, 0xFFFF);

869 
$num
 = 
	`·ck
('d', 0x00);

872 
$num
 = 
	`·ck
('d', 0x00);

875 
$grb™
 = 0x03;

876 
$unknown
 = 0x0000;

879 ià(
$fÜmuÏ
{0} == '=') {

880 
$fÜmuÏ
 = 
	`sub¡r
($formula, 1);

883 
$this
->
	`wr™eSŒšg
(
$row
, 
$cŞ
, 'Unrecognised character for formula');

888 
Œy
 {

889 
$”rÜ
 = 
$this
->
·r£r
->
	`·r£
(
$fÜmuÏ
);

890 
$fÜmuÏ
 = 
$this
->
·r£r
->
	`toRev”£PŞish
();

892 
$fÜmËn
 = 
	`¡¾’
(
$fÜmuÏ
);

893 
$Ëngth
 = 0x16 + 
$fÜmËn
;

895 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

897 
$d©a
 = 
	`·ck
("vvv", 
$row
, 
$cŞ
, 
$xfIndex
)

898 . 
$num


899 . 
	`·ck
("vVv", 
$grb™
, 
$unknown
, 
$fÜmËn
);

900 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
 . 
$fÜmuÏ
);

903 ià(
$¡ršgV®ue
 !=ğ
nuÎ
) {

904 
$this
->
	`wr™eSŒšgRecÜd
(
$¡ršgV®ue
);

909 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

913 
	}
}

920 
´iv©e
 
funùiÚ
 
	$wr™eSŒšgRecÜd
(
$¡ršgV®ue
)

922 
$»cÜd
 = 0x0207;

923 
$d©a
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
(
$¡ršgV®ue
);

925 
$Ëngth
 = 
	`¡¾’
(
$d©a
);

926 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

928 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

929 
	}
}

951 
´iv©e
 
funùiÚ
 
	$wr™eU¾
(
$row
, 
$cŞ
, 
$u¾
)

954 (
$this
->
	`wr™eU¾Rªge
(
$row
, 
$cŞ
, $row, $cŞ, 
$u¾
));

955 
	}
}

972 
public
 
funùiÚ
 
	$wr™eU¾Rªge
(
$row1
, 
$cŞ1
, 
$row2
, 
$cŞ2
, 
$u¾
)

975 ià(
	`´eg_m©ch
('[^š‹º®:]', 
$u¾
)) {

976 (
$this
->
	`wr™eU¾IÁ”Çl
(
$row1
, 
$cŞ1
, 
$row2
, 
$cŞ2
, 
$u¾
));

978 ià(
	`´eg_m©ch
('[^ex‹º®:]', 
$u¾
)) {

979 (
$this
->
	`wr™eU¾Ex‹º®
(
$row1
, 
$cŞ1
, 
$row2
, 
$cŞ2
, 
$u¾
));

981 (
$this
->
	`wr™eU¾Web
(
$row1
, 
$cŞ1
, 
$row2
, 
$cŞ2
, 
$u¾
));

982 
	}
}

998 
public
 
funùiÚ
 
	$wr™eU¾Web
(
$row1
, 
$cŞ1
, 
$row2
, 
$cŞ2
, 
$u¾
)

1000 
$»cÜd
 = 0x01B8;

1001 
$Ëngth
 = 0x00000;

1004 
$unknown1
 = 
	`·ck
("H*", "D0C9EA79F9BACE118C8200AA004BA90B02000000");

1005 
$unknown2
 = 
	`·ck
("H*", "E0C9EA79F9BACE118C8200AA004BA90B");

1008 
$İtiÚs
 = 
	`·ck
("V", 0x03);

1011 
$u¾
 = 
	`još
("\0", 
	`´eg_¥l™
("''", $u¾, -1, 
PREG_SPLIT_NO_EMPTY
));

1012 
$u¾
 = $url . "\0\0\0";

1015 
$u¾_Ën
 = 
	`·ck
("V", 
	`¡¾’
(
$u¾
));

1018 
$Ëngth
 = 0x34 + 
	`¡¾’
(
$u¾
);

1021 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1022 
$d©a
 = 
	`·ck
("vvvv", 
$row1
, 
$row2
, 
$cŞ1
, 
$cŞ2
);

1025 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
 .

1026 
$unknown1
 . 
$İtiÚs
 .

1027 
$unknown2
 . 
$u¾_Ën
 . 
$u¾
);

1029 
	}
}

1043 
public
 
funùiÚ
 
	$wr™eU¾IÁ”Çl
(
$row1
, 
$cŞ1
, 
$row2
, 
$cŞ2
, 
$u¾
)

1045 
$»cÜd
 = 0x01B8;

1046 
$Ëngth
 = 0x00000;

1049 
$u¾
 = 
	`´eg_»¶aû
('/^internal:/', '', $url);

1052 
$unknown1
 = 
	`·ck
("H*", "D0C9EA79F9BACE118C8200AA004BA90B02000000");

1055 
$İtiÚs
 = 
	`·ck
("V", 0x08);

1058 
$u¾
 .= "\0";

1061 
$u¾_Ën
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`CouÁCh¬aù”s
(
$u¾
);

1062 
$u¾_Ën
 = 
	`·ck
('V', $url_len);

1064 
$u¾
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`CÚv”tEncodšg
($url, 'UTF-16LE', 'UTF-8');

1067 
$Ëngth
 = 0x24 + 
	`¡¾’
(
$u¾
);

1070 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1071 
$d©a
 = 
	`·ck
("vvvv", 
$row1
, 
$row2
, 
$cŞ1
, 
$cŞ2
);

1074 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
 .

1075 
$unknown1
 . 
$İtiÚs
 .

1076 
$u¾_Ën
 . 
$u¾
);

1078 
	}
}

1096 
public
 
funùiÚ
 
	$wr™eU¾Ex‹º®
(
$row1
, 
$cŞ1
, 
$row2
, 
$cŞ2
, 
$u¾
)

1100 ià(
	`´eg_m©ch
('[^ex‹º®:\\\\]', 
$u¾
)) {

1104 
$»cÜd
 = 0x01B8;

1105 
$Ëngth
 = 0x00000;

1109 
$u¾
 = 
	`´eg_»¶aû
('/^external:/', '', $url);

1110 
$u¾
 = 
	`´eg_»¶aû
('/\//', "\\", $url);

1117 
$absŞu‹
 = 0x00;

1118 ià(
	`´eg_m©ch
('/^[A-Z]:/', 
$u¾
)) {

1119 
$absŞu‹
 = 0x02;

1121 
$lšk_ty³
 = 0x01 | 
$absŞu‹
;

1126 
$dœ_lÚg
 = 
$u¾
;

1127 ià(
	`´eg_m©ch
("/\#/", 
$u¾
)) {

1128 
$lšk_ty³
 |= 0x08;

1133 
$lšk_ty³
 = 
	`·ck
("V", $link_type);

1136 
$up_couÁ
 = 
	`´eg_m©ch_®l
("/\.\.\\\/", 
$dœ_lÚg
, 
$u£Ëss
);

1137 
$up_couÁ
 = 
	`·ck
("v", $up_count);

1140 
$dœ_shÜt
 = 
	`´eg_»¶aû
("/\.\.\\\/", '', 
$dœ_lÚg
) . "\0";

1143 
$dœ_lÚg
 = $dir_long . "\0";

1146 
$dœ_shÜt_Ën
 = 
	`·ck
("V", 
	`¡¾’
(
$dœ_shÜt
));

1147 
$dœ_lÚg_Ën
 = 
	`·ck
("V", 
	`¡¾’
(
$dœ_lÚg
));

1148 
$¡»am_Ën
 = 
	`·ck
("V", 0);

1151 
$unknown1
 = 
	`·ck
("H*", 'D0C9EA79F9BACE118C8200AA004BA90B02000000');

1152 
$unknown2
 = 
	`·ck
("H*", '0303000000000000C000000000000046');

1153 
$unknown3
 = 
	`·ck
("H*", 'FFFFADDE000000000000000000000000000000000000000');

1154 
$unknown4
 = 
	`·ck
("v", 0x03);

1157 
$d©a
 = 
	`·ck
("vvvv", 
$row1
, 
$row2
, 
$cŞ1
, 
$cŞ2
) .

1158 
$unknown1
 .

1159 
$lšk_ty³
 .

1160 
$unknown2
 .

1161 
$up_couÁ
 .

1162 
$dœ_shÜt_Ën
.

1163 
$dœ_shÜt
 .

1164 
$unknown3
 .

1165 
$¡»am_Ën
 ;

1173 
$Ëngth
 = 
	`¡¾’
(
$d©a
);

1174 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1177 
$this
->
	`­³nd
(
$h—d”
. 
$d©a
);

1179 
	}
}

1191 
´iv©e
 
funùiÚ
 
	$wr™eRow
(
$row
, 
$height
, 
$xfIndex
, 
$hidd’
 = 
çl£
, 
$Ëv–
 = 0)

1193 
$»cÜd
 = 0x0208;

1194 
$Ëngth
 = 0x0010;

1196 
$cŞMic
 = 0x0000;

1197 
$cŞMac
 = 0x0000;

1198 
$œwMac
 = 0x0000;

1199 
$»£rved
 = 0x0000;

1200 
$grb™
 = 0x0000;

1201 
$ixã
 = 
$xfIndex
;

1203 ià(
$height
 < 0) {

1204 
$height
 = 
nuÎ
;

1208 ià(
$height
 !ğ
nuÎ
) {

1209 
$miyRw
 = 
$height
 * 20;

1211 
$miyRw
 = 0xff;

1220 
$grb™
 |ğ
$Ëv–
;

1221 ià(
$hidd’
) {

1222 
$grb™
 |= 0x0030;

1224 ià(
$height
 !=ğ
nuÎ
) {

1225 
$grb™
 |= 0x0040;

1227 ià(
$xfIndex
 !== 0xF) {

1228 
$grb™
 |= 0x0080;

1230 
$grb™
 |= 0x0100;

1232 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1233 
$d©a
 = 
	`·ck
("vvvvvvvv", 
$row
, 
$cŞMic
, 
$cŞMac
, 
$miyRw
, 
$œwMac
, 
$»£rved
, 
$grb™
, 
$ixã
);

1234 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

1235 
	}
}

1240 
´iv©e
 
funùiÚ
 
	$wr™eDim’siÚs
()

1242 
$»cÜd
 = 0x0200;

1244 
$Ëngth
 = 0x000E;

1245 
$d©a
 = 
	`·ck
('VVvvv', 
$this
->
fœ¡RowIndex
, $this->
Ï¡RowIndex
 + 1, $this->
fœ¡CŞumnIndex
, $this->
Ï¡CŞumnIndex
 + 1, 0x0000);

1247 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1248 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

1249 
	}
}

1254 
´iv©e
 
funùiÚ
 
	$wr™eWšdow2
()

1256 
$»cÜd
 = 0x023E;

1257 
$Ëngth
 = 0x0012;

1259 
$grb™
 = 0x00B6;

1260 
$rwTİ
 = 0x0000;

1261 
$cŞLeá
 = 0x0000;

1265 
$fD¥FmÏ
 = 0;

1266 
$fD¥Grid
 = 
$this
->
phpSh“t
->
	`g‘ShowGridlšes
() ? 1 : 0;

1267 
$fD¥RwCŞ
 = 
$this
->
phpSh“t
->
	`g‘ShowRowCŞH—d”s
() ? 1 : 0;

1268 
$fFroz’
 = 
$this
->
phpSh“t
->
	`g‘F»ezePªe
() ? 1 : 0;

1269 
$fD¥Z”os
 = 1;

1270 
$fDeçuÉHdr
 = 1;

1271 
$fA¿bic
 = 
$this
->
phpSh“t
->
	`g‘RightToLeá
() ? 1 : 0;

1272 
$fD¥Guts
 = 
$this
->
oušeOn
;

1273 
$fFroz’NoS¶™
 = 0;

1275 
$fS–eùed
 = (
$this
->
phpSh“t
 ==ğ$this->phpSh“t->
	`g‘P¬’t
()->
	`g‘AùiveSh“t
()) ? 1 : 0;

1276 
$fPaged
 = 1;

1277 
$fPageB»akP»v›w
 = 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`g‘V›w
(è==ğ
PHPExûl_WÜksh“t_Sh“tV›w
::
SHEETVIEW_PAGE_BREAK_PREVIEW
;

1279 
$grb™
 = 
$fD¥FmÏ
;

1280 
$grb™
 |ğ
$fD¥Grid
 << 1;

1281 
$grb™
 |ğ
$fD¥RwCŞ
 << 2;

1282 
$grb™
 |ğ
$fFroz’
 << 3;

1283 
$grb™
 |ğ
$fD¥Z”os
 << 4;

1284 
$grb™
 |ğ
$fDeçuÉHdr
 << 5;

1285 
$grb™
 |ğ
$fA¿bic
 << 6;

1286 
$grb™
 |ğ
$fD¥Guts
 << 7;

1287 
$grb™
 |ğ
$fFroz’NoS¶™
 << 8;

1288 
$grb™
 |ğ
$fS–eùed
 << 9;

1289 
$grb™
 |ğ
$fPaged
 << 10;

1290 
$grb™
 |ğ
$fPageB»akP»v›w
 << 11;

1292 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1293 
$d©a
 = 
	`·ck
("vvv", 
$grb™
, 
$rwTİ
, 
$cŞLeá
);

1296 
$rgbHdr
 = 0x0040;

1297 
$zoom_çùÜ_·ge_b»ak
 = (
$fPageB»akP»v›w
 ? 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`g‘ZoomSÿË
() : 0x0000);

1298 
$zoom_çùÜ_nÜm®
 = 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`g‘ZoomSÿËNÜm®
();

1300 
$d©a
 .ğ
	`·ck
("vvvvV", 
$rgbHdr
, 0x0000, 
$zoom_çùÜ_·ge_b»ak
, 
$zoom_çùÜ_nÜm®
, 0x00000000);

1302 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

1303 
	}
}

1308 
´iv©e
 
funùiÚ
 
	$wr™eDeçuÉRowHeight
()

1310 
$deçuÉRowHeight
 = 
$this
->
phpSh“t
->
	`g‘DeçuÉRowDim’siÚ
()->
	`g‘RowHeight
();

1312 ià(
$deçuÉRowHeight
 < 0) {

1317 
$deçuÉRowHeight
 = () 20 * $defaultRowHeight;

1319 
$»cÜd
 = 0x0225;

1320 
$Ëngth
 = 0x0004;

1322 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1323 
$d©a
 = 
	`·ck
("vv", 1, 
$deçuÉRowHeight
);

1324 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1325 
	}
}

1330 
´iv©e
 
funùiÚ
 
	$wr™eDefcŞ
()

1332 
$deçuÉCŞWidth
 = 8;

1334 
$»cÜd
 = 0x0055;

1335 
$Ëngth
 = 0x0002;

1337 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1338 
$d©a
 = 
	`·ck
("v", 
$deçuÉCŞWidth
);

1339 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1340 
	}
}

1356 
´iv©e
 
funùiÚ
 
	$wr™eCŞšfo
(
$cŞ_¬¿y
)

1358 ià(
	`is£t
(
$cŞ_¬¿y
[0])) {

1359 
$cŞFœ¡
 = 
$cŞ_¬¿y
[0];

1361 ià(
	`is£t
(
$cŞ_¬¿y
[1])) {

1362 
$cŞLa¡
 = 
$cŞ_¬¿y
[1];

1364 ià(
	`is£t
(
$cŞ_¬¿y
[2])) {

1365 
$cŞdx
 = 
$cŞ_¬¿y
[2];

1367 
$cŞdx
 = 8.43;

1369 ià(
	`is£t
(
$cŞ_¬¿y
[3])) {

1370 
$xfIndex
 = 
$cŞ_¬¿y
[3];

1372 
$xfIndex
 = 15;

1374 ià(
	`is£t
(
$cŞ_¬¿y
[4])) {

1375 
$grb™
 = 
$cŞ_¬¿y
[4];

1377 
$grb™
 = 0;

1379 ià(
	`is£t
(
$cŞ_¬¿y
[5])) {

1380 
$Ëv–
 = 
$cŞ_¬¿y
[5];

1382 
$Ëv–
 = 0;

1384 
$»cÜd
 = 0x007D;

1385 
$Ëngth
 = 0x000C;

1387 
$cŞdx
 *= 256;

1389 
$ixã
 = 
$xfIndex
;

1390 
$»£rved
 = 0x0000;

1392 
$Ëv–
 = 
	`max
(0, 
	`mš
($level, 7));

1393 
$grb™
 |ğ
$Ëv–
 << 8;

1395 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1396 
$d©a
 = 
	`·ck
("vvvvvv", 
$cŞFœ¡
, 
$cŞLa¡
, 
$cŞdx
, 
$ixã
, 
$grb™
, 
$»£rved
);

1397 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

1398 
	}
}

1403 
´iv©e
 
funùiÚ
 
	$wr™eS–eùiÚ
()

1406 
$£ËùedC–ls
 = 
$this
->
phpSh“t
->
	`g‘S–eùedC–ls
();

1407 
$£ËùedC–ls
 = 
PHPExûl_C–l
::
	`¥l™Rªge
(
$this
->
phpSh“t
->
	`g‘S–eùedC–ls
());

1408 
$£ËùedC–ls
 = $selectedCells[0];

1409 ià(
	`couÁ
(
$£ËùedC–ls
) == 2) {

1410 
	`li¡
(
$fœ¡
, 
$Ï¡
èğ
$£ËùedC–ls
;

1412 
$fœ¡
 = 
$£ËùedC–ls
[0];

1413 
$Ï¡
 = 
$£ËùedC–ls
[0];

1416 
	`li¡
(
$cŞFœ¡
, 
$rwFœ¡
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$fœ¡
);

1417 
$cŞFœ¡
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($colFirst) - 1;

1418 --
$rwFœ¡
;

1420 
	`li¡
(
$cŞLa¡
, 
$rwLa¡
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$Ï¡
);

1421 
$cŞLa¡
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($colLast) - 1;

1422 --
$rwLa¡
;

1425 
$cŞFœ¡
 = 
	`mš
($colFirst, 255);

1426 
$cŞLa¡
 = 
	`mš
($colLast, 255);

1428 
$rwFœ¡
 = 
	`mš
($rwFirst, 65535);

1429 
$rwLa¡
 = 
	`mš
($rwLast, 65535);

1431 
$»cÜd
 = 0x001D;

1432 
$Ëngth
 = 0x000F;

1434 
$²n
 = 
$this
->
aùivePªe
;

1435 
$rwAù
 = 
$rwFœ¡
;

1436 
$cŞAù
 = 
$cŞFœ¡
;

1437 
$œefAù
 = 0;

1438 
$üef
 = 1;

1440 ià(!
	`is£t
(
$rwLa¡
)) {

1441 
$rwLa¡
 = 
$rwFœ¡
;

1443 ià(!
	`is£t
(
$cŞLa¡
)) {

1444 
$cŞLa¡
 = 
$cŞFœ¡
;

1448 ià(
$rwFœ¡
 > 
$rwLa¡
) {

1449 
	`li¡
(
$rwFœ¡
, 
$rwLa¡
èğ
	`¬¿y
($rwLast, $rwFirst);

1452 ià(
$cŞFœ¡
 > 
$cŞLa¡
) {

1453 
	`li¡
(
$cŞFœ¡
, 
$cŞLa¡
èğ
	`¬¿y
($colLast, $colFirst);

1456 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1457 
$d©a
 = 
	`·ck
("CvvvvvvCC", 
$²n
, 
$rwAù
, 
$cŞAù
, 
$œefAù
, 
$üef
, 
$rwFœ¡
, 
$rwLa¡
, 
$cŞFœ¡
, 
$cŞLa¡
);

1458 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1459 
	}
}

1464 
´iv©e
 
funùiÚ
 
	$wr™eM”gedC–ls
()

1466 
$m”geC–ls
 = 
$this
->
phpSh“t
->
	`g‘M”geC–ls
();

1467 
$couÁM”geC–ls
 = 
	`couÁ
(
$m”geC–ls
);

1469 ià(
$couÁM”geC–ls
 == 0) {

1474 
$maxCouÁM”geC–lsP”RecÜd
 = 1027;

1477 
$»cÜd
 = 0x00E5;

1480 
$i
 = 0;

1483 
$j
 = 0;

1486 
$»cÜdD©a
 = '';

1489 
	`fÜ—ch
 (
$m”geC–ls
 
as
 
$m”geC–l
) {

1490 ++
$i
;

1491 ++
$j
;

1494 
$¿nge
 = 
PHPExûl_C–l
::
	`¥l™Rªge
(
$m”geC–l
);

1495 
	`li¡
(
$fœ¡
, 
$Ï¡
èğ
$¿nge
[0];

1496 
	`li¡
(
$fœ¡CŞumn
, 
$fœ¡Row
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$fœ¡
);

1497 
	`li¡
(
$Ï¡CŞumn
, 
$Ï¡Row
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$Ï¡
);

1499 
$»cÜdD©a
 .ğ
	`·ck
('vvvv', 
$fœ¡Row
 - 1, 
$Ï¡Row
 - 1, 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$fœ¡CŞumn
è- 1, PHPExûl_C–l::cŞumnIndexFromSŒšg(
$Ï¡CŞumn
) - 1);

1502 ià(
$j
 =ğ
$maxCouÁM”geC–lsP”RecÜd
 
Ü
 
$i
 =ğ
$couÁM”geC–ls
) {

1503 
$»cÜdD©a
 = 
	`·ck
('v', 
$j
) . $recordData;

1504 
$Ëngth
 = 
	`¡¾’
(
$»cÜdD©a
);

1505 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

1506 
$this
->
	`­³nd
(
$h—d”
 . 
$»cÜdD©a
);

1509 
$»cÜdD©a
 = '';

1510 
$j
 = 0;

1513 
	}
}

1518 
´iv©e
 
funùiÚ
 
	$wr™eSh“tLayout
()

1520 ià(!
$this
->
phpSh“t
->
	`isTabCŞÜS‘
()) {

1524 
$»cÜdD©a
 = 
	`·ck
(

1531 
$this
->
cŞÜs
[$this->
phpSh“t
->
	`g‘TabCŞÜ
()->
	`g‘RGB
()],

1535 
$Ëngth
 = 
	`¡¾’
(
$»cÜdD©a
);

1537 
$»cÜd
 = 0x0862;

1538 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

1539 
$this
->
	`­³nd
(
$h—d”
 . 
$»cÜdD©a
);

1540 
	}
}

1545 
´iv©e
 
funùiÚ
 
	$wr™eSh“tPrÙeùiÚ
()

1548 
$»cÜd
 = 0x0867;

1551 
$İtiÚs
 = (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘Objeùs
()

1552 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘SûÇrios
() << 1

1553 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘FÜm©C–ls
() << 2

1554 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘FÜm©CŞumns
() << 3

1555 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘FÜm©Rows
() << 4

1556 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘In£¹CŞumns
() << 5

1557 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘In£¹Rows
() << 6

1558 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘In£¹Hy³¾šks
() << 7

1559 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘D–‘eCŞumns
() << 8

1560 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘D–‘eRows
() << 9

1561 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘S–eùLockedC–ls
() << 10

1562 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘SÜt
() << 11

1563 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘AutoF‹r
() << 12

1564 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘PivÙTabËs
() << 13

1565 | (è!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘S–eùUÆockedC–ls
() << 14 ;

1568 
$»cÜdD©a
 = 
	`·ck
(

1576 
$İtiÚs
,

1580 
$Ëngth
 = 
	`¡¾’
(
$»cÜdD©a
);

1581 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

1583 
$this
->
	`­³nd
(
$h—d”
 . 
$»cÜdD©a
);

1584 
	}
}

1592 
´iv©e
 
funùiÚ
 
	$wr™eRªgePrÙeùiÚ
()

1594 
	`fÜ—ch
 (
$this
->
phpSh“t
->
	`g‘PrÙeùedC–ls
(è
as
 
$¿nge
 => 
$·sswÜd
) {

1596 
$ûÎRªges
 = 
	`ex¶ode
(' ', 
$¿nge
);

1597 
$üef
 = 
	`couÁ
(
$ûÎRªges
);

1599 
$»cÜdD©a
 = 
	`·ck
(

1608 
$üef
,

1613 
	`fÜ—ch
 (
$ûÎRªges
 
as
 
$ûÎRªge
) {

1614 
$»cÜdD©a
 .ğ
$this
->
	`wr™eBIFF8C–lRªgeAdd»ssFixed
(
$ûÎRªge
);

1618 
$»cÜdD©a
 .ğ
	`·ck
(

1621 
	`hexdec
(
$·sswÜd
)

1624 
$»cÜdD©a
 .ğ
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
('p' . 
	`md5
($recordData));

1626 
$Ëngth
 = 
	`¡¾’
(
$»cÜdD©a
);

1628 
$»cÜd
 = 0x0868;

1629 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1630 
$this
->
	`­³nd
(
$h—d”
 . 
$»cÜdD©a
);

1632 
	}
}

1646 
´iv©e
 
funùiÚ
 
	$wr™eEx‹ºcouÁ
(
$couÁ
)

1648 
$»cÜd
 = 0x0016;

1649 
$Ëngth
 = 0x0002;

1651 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1652 
$d©a
 = 
	`·ck
("v", 
$couÁ
);

1653 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1654 
	}
}

1664 
´iv©e
 
funùiÚ
 
	$wr™eEx‹ºsh“t
(
$sh“Šame
)

1666 
$»cÜd
 = 0x0017;

1671 ià(
$this
->
phpSh“t
->
	`g‘T™Ë
(è=ğ
$sh“Šame
) {

1672 
$sh“Šame
 = '';

1673 
$Ëngth
 = 0x02;

1674 
$cch
 = 1;

1675 
$rgch
 = 0x02;

1677 
$Ëngth
 = 0x02 + 
	`¡¾’
(
$sh“Šame
);

1678 
$cch
 = 
	`¡¾’
(
$sh“Šame
);

1679 
$rgch
 = 0x03;

1682 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1683 
$d©a
 = 
	`·ck
("CC", 
$cch
, 
$rgch
);

1684 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
 . 
$sh“Šame
);

1685 
	}
}

1693 
´iv©e
 
funùiÚ
 
	$wr™ePªes
()

1695 
$·Ãs
 = 
	`¬¿y
();

1696 ià(
$ä“zePªe
 = 
$this
->
phpSh“t
->
	`g‘F»ezePªe
()) {

1697 
	`li¡
(
$cŞumn
, 
$row
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$ä“zePªe
);

1698 
$·Ãs
[0] = 
$row
 - 1;

1699 
$·Ãs
[1] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞumn
) - 1;

1705 
$y
 = 
	`is£t
(
$·Ãs
[0]è? $·Ãs[0] : 
nuÎ
;

1706 
$x
 = 
	`is£t
(
$·Ãs
[1]è? $·Ãs[1] : 
nuÎ
;

1707 
$rwTİ
 = 
	`is£t
(
$·Ãs
[2]è? $·Ãs[2] : 
nuÎ
;

1708 
$cŞLeá
 = 
	`is£t
(
$·Ãs
[3]è? $·Ãs[3] : 
nuÎ
;

1709 ià(
	`couÁ
(
$·Ãs
) > 4) {

1710 
$²nAù
 = 
$·Ãs
[4];

1712 
$²nAù
 = 
nuÎ
;

1714 
$»cÜd
 = 0x0041;

1715 
$Ëngth
 = 0x000A;

1718 ià(
$this
->
phpSh“t
->
	`g‘F»ezePªe
()) {

1720 ià(!
	`is£t
(
$rwTİ
)) {

1721 
$rwTİ
 = 
$y
;

1723 ià(!
	`is£t
(
$cŞLeá
)) {

1724 
$cŞLeá
 = 
$x
;

1728 ià(!
	`is£t
(
$rwTİ
)) {

1729 
$rwTİ
 = 0;

1731 ià(!
	`is£t
(
$cŞLeá
)) {

1732 
$cŞLeá
 = 0;

1740 
$y
 = 20*$y + 255;

1741 
$x
 = 113.879*$x + 390;

1748 ià(!
	`is£t
(
$²nAù
)) {

1749 ià(
$x
 !ğ0 && 
$y
 != 0) {

1750 
$²nAù
 = 0;

1752 ià(
$x
 !ğ0 && 
$y
 == 0) {

1753 
$²nAù
 = 1;

1755 ià(
$x
 =ğ0 && 
$y
 != 0) {

1756 
$²nAù
 = 2;

1758 ià(
$x
 =ğ0 && 
$y
 == 0) {

1759 
$²nAù
 = 3;

1763 
$this
->
aùivePªe
 = 
$²nAù
;

1765 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1766 
$d©a
 = 
	`·ck
("vvvvv", 
$x
, 
$y
, 
$rwTİ
, 
$cŞLeá
, 
$²nAù
);

1767 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1768 
	}
}

1773 
´iv©e
 
funùiÚ
 
	$wr™eS‘up
()

1775 
$»cÜd
 = 0x00A1;

1776 
$Ëngth
 = 0x0022;

1778 
$iP­”Size
 = 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`g‘P­”Size
();

1780 
$iSÿË
 = 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`g‘SÿË
() ?

1781 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`g‘SÿË
() : 100;

1783 
$iPageS¹
 = 0x01;

1784 
$iF™Width
 = (è
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`g‘F™ToWidth
();

1785 
$iF™Height
 = (è
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`g‘F™ToHeight
();

1786 
$grb™
 = 0x00;

1787 
$iRes
 = 0x0258;

1788 
$iVRes
 = 0x0258;

1790 
$numHdr
 = 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`g‘H—d”
();

1792 
$numFŒ
 = 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`g‘FoÙ”
();

1793 
$iCİ›s
 = 0x01;

1795 
$fLeáToRight
 = 0x0;

1798 
$fLªdsÿ³
 = (
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`g‘Or›Á©iÚ
(è=ğ
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_LANDSCAPE
) ?

1801 
$fNoPls
 = 0x0;

1802 
$fNoCŞÜ
 = 0x0;

1803 
$fD¿á
 = 0x0;

1804 
$fNÙes
 = 0x0;

1805 
$fNoOr›Á
 = 0x0;

1806 
$fU£Page
 = 0x0;

1808 
$grb™
 = 
$fLeáToRight
;

1809 
$grb™
 |ğ
$fLªdsÿ³
 << 1;

1810 
$grb™
 |ğ
$fNoPls
 << 2;

1811 
$grb™
 |ğ
$fNoCŞÜ
 << 3;

1812 
$grb™
 |ğ
$fD¿á
 << 4;

1813 
$grb™
 |ğ
$fNÙes
 << 5;

1814 
$grb™
 |ğ
$fNoOr›Á
 << 6;

1815 
$grb™
 |ğ
$fU£Page
 << 7;

1817 
$numHdr
 = 
	`·ck
("d", $numHdr);

1818 
$numFŒ
 = 
	`·ck
("d", $numFtr);

1819 ià(
£lf
::
	`g‘By‹Ord”
()) {

1820 
$numHdr
 = 
	`¡¼ev
($numHdr);

1821 
$numFŒ
 = 
	`¡¼ev
($numFtr);

1824 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1825 
$d©a1
 = 
	`·ck
("vvvvvvvv", 
$iP­”Size
, 
$iSÿË
, 
$iPageS¹
, 
$iF™Width
, 
$iF™Height
, 
$grb™
, 
$iRes
, 
$iVRes
);

1826 
$d©a2
 = 
$numHdr
.
$numFŒ
;

1827 
$d©a3
 = 
	`·ck
("v", 
$iCİ›s
);

1828 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a1
 . 
$d©a2
 . 
$d©a3
);

1829 
	}
}

1834 
´iv©e
 
funùiÚ
 
	$wr™eH—d”
()

1836 
$»cÜd
 = 0x0014;

1847 
$»cÜdD©a
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
(
$this
->
phpSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘OddH—d”
());

1848 
$Ëngth
 = 
	`¡¾’
(
$»cÜdD©a
);

1850 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1852 
$this
->
	`­³nd
(
$h—d”
 . 
$»cÜdD©a
);

1853 
	}
}

1858 
´iv©e
 
funùiÚ
 
	$wr™eFoÙ”
()

1860 
$»cÜd
 = 0x0015;

1871 
$»cÜdD©a
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
(
$this
->
phpSh“t
->
	`g‘H—d”FoÙ”
()->
	`g‘OddFoÙ”
());

1872 
$Ëngth
 = 
	`¡¾’
(
$»cÜdD©a
);

1874 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1876 
$this
->
	`­³nd
(
$h—d”
 . 
$»cÜdD©a
);

1877 
	}
}

1884 
´iv©e
 
funùiÚ
 
	$wr™eHûÁ”
()

1886 
$»cÜd
 = 0x0083;

1887 
$Ëngth
 = 0x0002;

1889 
$fHC’‹r
 = 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`g‘HÜizÚlC’‹»d
() ? 1 : 0;

1891 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1892 
$d©a
 = 
	`·ck
("v", 
$fHC’‹r
);

1894 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

1895 
	}
}

1900 
´iv©e
 
funùiÚ
 
	$wr™eVûÁ”
()

1902 
$»cÜd
 = 0x0084;

1903 
$Ëngth
 = 0x0002;

1905 
$fVC’‹r
 = 
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`g‘V”tiÿlC’‹»d
() ? 1 : 0;

1907 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1908 
$d©a
 = 
	`·ck
("v", 
$fVC’‹r
);

1909 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1910 
	}
}

1915 
´iv©e
 
funùiÚ
 
	$wr™eM¬gšLeá
()

1917 
$»cÜd
 = 0x0026;

1918 
$Ëngth
 = 0x0008;

1920 
$m¬gš
 = 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`g‘Leá
();

1922 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1923 
$d©a
 = 
	`·ck
("d", 
$m¬gš
);

1924 ià(
£lf
::
	`g‘By‹Ord”
()) {

1925 
$d©a
 = 
	`¡¼ev
($data);

1928 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1929 
	}
}

1934 
´iv©e
 
funùiÚ
 
	$wr™eM¬gšRight
()

1936 
$»cÜd
 = 0x0027;

1937 
$Ëngth
 = 0x0008;

1939 
$m¬gš
 = 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`g‘Right
();

1941 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1942 
$d©a
 = 
	`·ck
("d", 
$m¬gš
);

1943 ià(
£lf
::
	`g‘By‹Ord”
()) {

1944 
$d©a
 = 
	`¡¼ev
($data);

1947 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1948 
	}
}

1953 
´iv©e
 
funùiÚ
 
	$wr™eM¬gšTİ
()

1955 
$»cÜd
 = 0x0028;

1956 
$Ëngth
 = 0x0008;

1958 
$m¬gš
 = 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`g‘Tİ
();

1960 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1961 
$d©a
 = 
	`·ck
("d", 
$m¬gš
);

1962 ià(
£lf
::
	`g‘By‹Ord”
()) {

1963 
$d©a
 = 
	`¡¼ev
($data);

1966 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1967 
	}
}

1972 
´iv©e
 
funùiÚ
 
	$wr™eM¬gšBÙtom
()

1974 
$»cÜd
 = 0x0029;

1975 
$Ëngth
 = 0x0008;

1977 
$m¬gš
 = 
$this
->
phpSh“t
->
	`g‘PageM¬gšs
()->
	`g‘BÙtom
();

1979 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1980 
$d©a
 = 
	`·ck
("d", 
$m¬gš
);

1981 ià(
£lf
::
	`g‘By‹Ord”
()) {

1982 
$d©a
 = 
	`¡¼ev
($data);

1985 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

1986 
	}
}

1991 
´iv©e
 
funùiÚ
 
	$wr™ePrštH—d”s
()

1993 
$»cÜd
 = 0x002a;

1994 
$Ëngth
 = 0x0002;

1996 
$fPrštRwCŞ
 = 
$this
->
_´št_h—d”s
;

1998 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

1999 
$d©a
 = 
	`·ck
("v", 
$fPrštRwCŞ
);

2000 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2001 
	}
}

2007 
´iv©e
 
funùiÚ
 
	$wr™ePrštGridlšes
()

2009 
$»cÜd
 = 0x002b;

2010 
$Ëngth
 = 0x0002;

2012 
$fPrštGrid
 = 
$this
->
phpSh“t
->
	`g‘PrštGridlšes
() ? 1 : 0;

2014 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2015 
$d©a
 = 
	`·ck
("v", 
$fPrštGrid
);

2016 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2017 
	}
}

2023 
´iv©e
 
funùiÚ
 
	$wr™eGrid£t
()

2025 
$»cÜd
 = 0x0082;

2026 
$Ëngth
 = 0x0002;

2028 
$fGridS‘
 = !
$this
->
phpSh“t
->
	`g‘PrštGridlšes
();

2030 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2031 
$d©a
 = 
	`·ck
("v", 
$fGridS‘
);

2032 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2033 
	}
}

2038 
´iv©e
 
funùiÚ
 
	$wr™eAutoF‹rInfo
()

2040 
$»cÜd
 = 0x009D;

2041 
$Ëngth
 = 0x0002;

2043 
$¿ngeBounds
 = 
PHPExûl_C–l
::
	`¿ngeBound¬›s
(
$this
->
phpSh“t
->
	`g‘AutoF‹r
()->
	`g‘Rªge
());

2044 
$iNumF‹rs
 = 1 + 
$¿ngeBounds
[1][0] - $rangeBounds[0][0];

2046 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2047 
$d©a
 = 
	`·ck
("v", 
$iNumF‹rs
);

2048 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2049 
	}
}

2058 
´iv©e
 
funùiÚ
 
	$wr™eGuts
()

2060 
$»cÜd
 = 0x0080;

2061 
$Ëngth
 = 0x0008;

2063 
$dxRwGut
 = 0x0000;

2064 
$dxCŞGut
 = 0x0000;

2067 
$maxRowOušeLev–
 = 0;

2068 
	`fÜ—ch
 (
$this
->
phpSh“t
->
	`g‘RowDim’siÚs
(è
as
 
$rowDim’siÚ
) {

2069 
$maxRowOušeLev–
 = 
	`max
($maxRowOušeLev–, 
$rowDim’siÚ
->
	`g‘OušeLev–
());

2072 
$cŞ_Ëv–
 = 0;

2076 
$cŞcouÁ
 = 
	`couÁ
(
$this
->
cŞumnInfo
);

2077 
$i
 = 0; $˜< 
$cŞcouÁ
; ++$i) {

2078 
$cŞ_Ëv–
 = 
	`max
(
$this
->
cŞumnInfo
[
$i
][5], $col_level);

2082 
$cŞ_Ëv–
 = 
	`max
(0, 
	`mš
($col_level, 7));

2085 ià(
$maxRowOušeLev–
) {

2086 ++
$maxRowOušeLev–
;

2088 ià(
$cŞ_Ëv–
) {

2089 ++
$cŞ_Ëv–
;

2092 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2093 
$d©a
 = 
	`·ck
("vvvv", 
$dxRwGut
, 
$dxCŞGut
, 
$maxRowOušeLev–
, 
$cŞ_Ëv–
);

2095 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

2096 
	}
}

2102 
´iv©e
 
funùiÚ
 
	$wr™eWsboŞ
()

2104 
$»cÜd
 = 0x0081;

2105 
$Ëngth
 = 0x0002;

2106 
$grb™
 = 0x0000;

2112 
$grb™
 |= 0x0001;

2113 ià(
$this
->
oušeStyË
) {

2114 
$grb™
 |= 0x0020;

2116 ià(
$this
->
phpSh“t
->
	`g‘ShowSumm¬yB–ow
()) {

2117 
$grb™
 |= 0x0040;

2119 ià(
$this
->
phpSh“t
->
	`g‘ShowSumm¬yRight
()) {

2120 
$grb™
 |= 0x0080;

2122 ià(
$this
->
phpSh“t
->
	`g‘PageS‘up
()->
	`g‘F™ToPage
()) {

2123 
$grb™
 |= 0x0100;

2125 ià(
$this
->
oušeOn
) {

2126 
$grb™
 |= 0x0400;

2129 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2130 
$d©a
 = 
	`·ck
("v", 
$grb™
);

2131 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2132 
	}
}

2137 
´iv©e
 
funùiÚ
 
	$wr™eB»aks
()

2140 
$vb»aks
 = 
	`¬¿y
();

2141 
$hb»aks
 = 
	`¬¿y
();

2143 
	`fÜ—ch
 (
$this
->
phpSh“t
->
	`g‘B»aks
(è
as
 
$ûÎ
 => 
$b»akTy³
) {

2145 
$coÜdš©es
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$ûÎ
);

2148 
$b»akTy³
) {

2149 
PHPExûl_WÜksh“t
::
BREAK_COLUMN
:

2151 
$vb»aks
[] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$coÜdš©es
[0]) - 1;

2153 
PHPExûl_WÜksh“t
::
BREAK_ROW
:

2155 
$hb»aks
[] = 
$coÜdš©es
[1];

2157 
PHPExûl_WÜksh“t
::
BREAK_NONE
:

2165 ià(!
	`em±y
(
$hb»aks
)) {

2167 
	`sÜt
(
$hb»aks
, 
SORT_NUMERIC
);

2168 ià(
$hb»aks
[0] == 0) {

2169 
	`¬¿y_shiá
(
$hb»aks
);

2172 
$»cÜd
 = 0x001b;

2173 
$cbrk
 = 
	`couÁ
(
$hb»aks
);

2174 
$Ëngth
 = 2 + 6 * 
$cbrk
;

2176 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2177 
$d©a
 = 
	`·ck
("v", 
$cbrk
);

2180 
	`fÜ—ch
 (
$hb»aks
 
as
 
$hb»ak
) {

2181 
$d©a
 .ğ
	`·ck
("vvv", 
$hb»ak
, 0x0000, 0x00ff);

2184 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2188 ià(!
	`em±y
(
$vb»aks
)) {

2191 
$vb»aks
 = 
	`¬¿y_¦iû
($vbreaks, 0, 1000);

2194 
	`sÜt
(
$vb»aks
, 
SORT_NUMERIC
);

2195 ià(
$vb»aks
[0] == 0) {

2196 
	`¬¿y_shiá
(
$vb»aks
);

2199 
$»cÜd
 = 0x001a;

2200 
$cbrk
 = 
	`couÁ
(
$vb»aks
);

2201 
$Ëngth
 = 2 + 6 * 
$cbrk
;

2203 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2204 
$d©a
 = 
	`·ck
("v", 
$cbrk
);

2207 
	`fÜ—ch
 (
$vb»aks
 
as
 
$vb»ak
) {

2208 
$d©a
 .ğ
	`·ck
("vvv", 
$vb»ak
, 0x0000, 0xffff);

2211 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2213 
	}
}

2218 
´iv©e
 
funùiÚ
 
	$wr™ePrÙeù
()

2221 ià(!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘Sh“t
()) {

2225 
$»cÜd
 = 0x0012;

2226 
$Ëngth
 = 0x0002;

2228 
$fLock
 = 1;

2230 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2231 
$d©a
 = 
	`·ck
("v", 
$fLock
);

2233 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

2234 
	}
}

2239 
´iv©e
 
funùiÚ
 
	$wr™eSûnPrÙeù
()

2242 ià(!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘Sh“t
()) {

2247 ià(!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘SûÇrios
()) {

2251 
$»cÜd
 = 0x00DD;

2252 
$Ëngth
 = 0x0002;

2254 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

2255 
$d©a
 = 
	`·ck
('v', 1);

2257 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2258 
	}
}

2263 
´iv©e
 
funùiÚ
 
	$wr™eObjeùPrÙeù
()

2266 ià(!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘Sh“t
()) {

2271 ià(!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘Objeùs
()) {

2275 
$»cÜd
 = 0x0063;

2276 
$Ëngth
 = 0x0002;

2278 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

2279 
$d©a
 = 
	`·ck
('v', 1);

2281 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2282 
	}
}

2287 
´iv©e
 
funùiÚ
 
	$wr™ePasswÜd
()

2290 ià(!
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘Sh“t
(è|| !$this->phpSh“t->g‘PrÙeùiÚ()->
	`g‘PasswÜd
()) {

2294 
$»cÜd
 = 0x0013;

2295 
$Ëngth
 = 0x0002;

2297 
$wPasswÜd
 = 
	`hexdec
(
$this
->
phpSh“t
->
	`g‘PrÙeùiÚ
()->
	`g‘PasswÜd
());

2299 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2300 
$d©a
 = 
	`·ck
("v", 
$wPasswÜd
);

2302 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2303 
	}
}

2317 
public
 
funùiÚ
 
	$š£¹B™m­
(
$row
, 
$cŞ
, 
$b™m­
, 
$x
 = 0, 
$y
 = 0, 
$sÿË_x
 = 1, 
$sÿË_y
 = 1)

2319 
$b™m­_¬¿y
 = (
	`is_»sourû
(
$b™m­
è? 
$this
->
	`´oûssB™m­Gd
($b™m­è: $this->
	`´oûssB™m­
($bitmap));

2320 
	`li¡
(
$width
, 
$height
, 
$size
, 
$d©a
èğ
$b™m­_¬¿y
;

2323 
$width
 *ğ
$sÿË_x
;

2324 
$height
 *ğ
$sÿË_y
;

2327 
$this
->
	`pos™iÚImage
(
$cŞ
, 
$row
, 
$x
, 
$y
, 
$width
, 
$height
);

2330 
$»cÜd
 = 0x007f;

2331 
$Ëngth
 = 8 + 
$size
;

2332 
$cf
 = 0x09;

2333 
$’v
 = 0x01;

2334 
$lcb
 = 
$size
;

2336 
$h—d”
 = 
	`·ck
("vvvvV", 
$»cÜd
, 
$Ëngth
, 
$cf
, 
$’v
, 
$lcb
);

2337 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

2338 
	}
}

2391 
public
 
funùiÚ
 
	$pos™iÚImage
(
$cŞ_¡¬t
, 
$row_¡¬t
, 
$x1
, 
$y1
, 
$width
, 
$height
)

2394 
$cŞ_’d
 = 
$cŞ_¡¬t
;

2395 
$row_’d
 = 
$row_¡¬t
;

2398 ià(
$x1
 >ğ
PHPExûl_Sh¬ed_Exûl5
::
	`sizeCŞ
(
$this
->
phpSh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_¡¬t
))) {

2399 
$x1
 = 0;

2401 ià(
$y1
 >ğ
PHPExûl_Sh¬ed_Exûl5
::
	`sizeRow
(
$this
->
phpSh“t
, 
$row_¡¬t
 + 1)) {

2402 
$y1
 = 0;

2405 
$width
 = $width + 
$x1
 -1;

2406 
$height
 = $heighˆ+ 
$y1
 -1;

2409 
$width
 >ğ
PHPExûl_Sh¬ed_Exûl5
::
	`sizeCŞ
(
$this
->
phpSh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_’d
))) {

2410 
$width
 -ğ
PHPExûl_Sh¬ed_Exûl5
::
	`sizeCŞ
(
$this
->
phpSh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_’d
));

2411 ++
$cŞ_’d
;

2415 
$height
 >ğ
PHPExûl_Sh¬ed_Exûl5
::
	`sizeRow
(
$this
->
phpSh“t
, 
$row_’d
 + 1)) {

2416 
$height
 -ğ
PHPExûl_Sh¬ed_Exûl5
::
	`sizeRow
(
$this
->
phpSh“t
, 
$row_’d
 + 1);

2417 ++
$row_’d
;

2423 ià(
PHPExûl_Sh¬ed_Exûl5
::
	`sizeCŞ
(
$this
->
phpSh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_¡¬t
)) == 0) {

2426 ià(
PHPExûl_Sh¬ed_Exûl5
::
	`sizeCŞ
(
$this
->
phpSh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_’d
)) == 0) {

2429 ià(
PHPExûl_Sh¬ed_Exûl5
::
	`sizeRow
(
$this
->
phpSh“t
, 
$row_¡¬t
 + 1) == 0) {

2432 ià(
PHPExûl_Sh¬ed_Exûl5
::
	`sizeRow
(
$this
->
phpSh“t
, 
$row_’d
 + 1) == 0) {

2437 
$x1
 = $x1 / 
PHPExûl_Sh¬ed_Exûl5
::
	`sizeCŞ
(
$this
->
phpSh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_¡¬t
)) * 1024;

2438 
$y1
 = $y1 / 
PHPExûl_Sh¬ed_Exûl5
::
	`sizeRow
(
$this
->
phpSh“t
, 
$row_¡¬t
 + 1) * 256;

2439 
$x2
 = 
$width
 / 
PHPExûl_Sh¬ed_Exûl5
::
	`sizeCŞ
(
$this
->
phpSh“t
, 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
(
$cŞ_’d
)) * 1024;

2440 
$y2
 = 
$height
 / 
PHPExûl_Sh¬ed_Exûl5
::
	`sizeRow
(
$this
->
phpSh“t
, 
$row_’d
 + 1) * 256;

2442 
$this
->
	`wr™eObjPiùu»
(
$cŞ_¡¬t
, 
$x1
, 
$row_¡¬t
, 
$y1
, 
$cŞ_’d
, 
$x2
, 
$row_’d
, 
$y2
);

2443 
	}
}

2458 
´iv©e
 
funùiÚ
 
	$wr™eObjPiùu»
(
$cŞL
, 
$dxL
, 
$rwT
, 
$dyT
, 
$cŞR
, 
$dxR
, 
$rwB
, 
$dyB
)

2460 
$»cÜd
 = 0x005d;

2461 
$Ëngth
 = 0x003c;

2463 
$cObj
 = 0x0001;

2464 
$OT
 = 0x0008;

2465 
$id
 = 0x0001;

2466 
$grb™
 = 0x0614;

2468 
$cbMaüo
 = 0x0000;

2469 
$Re£rved1
 = 0x0000;

2470 
$Re£rved2
 = 0x0000;

2472 
$icvBack
 = 0x09;

2473 
$icvFÜe
 = 0x09;

2474 
$æs
 = 0x00;

2475 
$fAuto
 = 0x00;

2476 
$icv
 = 0x08;

2477 
$Ês
 = 0xff;

2478 
$Êw
 = 0x01;

2479 
$fAutoB
 = 0x00;

2480 
$äs
 = 0x0000;

2481 
$cf
 = 0x0009;

2482 
$Re£rved3
 = 0x0000;

2483 
$cbPiùFmÏ
 = 0x0000;

2484 
$Re£rved4
 = 0x0000;

2485 
$grb™2
 = 0x0001;

2486 
$Re£rved5
 = 0x0000;

2489 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2490 
$d©a
 = 
	`·ck
("V", 
$cObj
);

2491 
$d©a
 .ğ
	`·ck
("v", 
$OT
);

2492 
$d©a
 .ğ
	`·ck
("v", 
$id
);

2493 
$d©a
 .ğ
	`·ck
("v", 
$grb™
);

2494 
$d©a
 .ğ
	`·ck
("v", 
$cŞL
);

2495 
$d©a
 .ğ
	`·ck
("v", 
$dxL
);

2496 
$d©a
 .ğ
	`·ck
("v", 
$rwT
);

2497 
$d©a
 .ğ
	`·ck
("v", 
$dyT
);

2498 
$d©a
 .ğ
	`·ck
("v", 
$cŞR
);

2499 
$d©a
 .ğ
	`·ck
("v", 
$dxR
);

2500 
$d©a
 .ğ
	`·ck
("v", 
$rwB
);

2501 
$d©a
 .ğ
	`·ck
("v", 
$dyB
);

2502 
$d©a
 .ğ
	`·ck
("v", 
$cbMaüo
);

2503 
$d©a
 .ğ
	`·ck
("V", 
$Re£rved1
);

2504 
$d©a
 .ğ
	`·ck
("v", 
$Re£rved2
);

2505 
$d©a
 .ğ
	`·ck
("C", 
$icvBack
);

2506 
$d©a
 .ğ
	`·ck
("C", 
$icvFÜe
);

2507 
$d©a
 .ğ
	`·ck
("C", 
$æs
);

2508 
$d©a
 .ğ
	`·ck
("C", 
$fAuto
);

2509 
$d©a
 .ğ
	`·ck
("C", 
$icv
);

2510 
$d©a
 .ğ
	`·ck
("C", 
$Ês
);

2511 
$d©a
 .ğ
	`·ck
("C", 
$Êw
);

2512 
$d©a
 .ğ
	`·ck
("C", 
$fAutoB
);

2513 
$d©a
 .ğ
	`·ck
("v", 
$äs
);

2514 
$d©a
 .ğ
	`·ck
("V", 
$cf
);

2515 
$d©a
 .ğ
	`·ck
("v", 
$Re£rved3
);

2516 
$d©a
 .ğ
	`·ck
("v", 
$cbPiùFmÏ
);

2517 
$d©a
 .ğ
	`·ck
("v", 
$Re£rved4
);

2518 
$d©a
 .ğ
	`·ck
("v", 
$grb™2
);

2519 
$d©a
 .ğ
	`·ck
("V", 
$Re£rved5
);

2521 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2522 
	}
}

2531 
public
 
funùiÚ
 
	$´oûssB™m­Gd
(
$image
)

2533 
$width
 = 
	`imagesx
(
$image
);

2534 
$height
 = 
	`imagesy
(
$image
);

2536 
$d©a
 = 
	`·ck
("Vvvvv", 0x000c, 
$width
, 
$height
, 0x01, 0x18);

2537 
$j
=
$height
; $j--;) {

2538 
$i
=0; $˜< 
$width
; ++$i) {

2539 
$cŞÜ
 = 
	`imagecŞÜsfÜšdex
(
$image
, 
	`imagecŞÜ©
($image, 
$i
, 
$j
));

2540 
	`fÜ—ch
 (
	`¬¿y
("»d", "g»’", "blue"è
as
 
$key
) {

2541 
$cŞÜ
[
$key
] = $cŞÜ[$key] + 
	`round
((255 - $color[$key]) * $color["alpha"] / 127);

2543 
$d©a
 .ğ
	`chr
(
$cŞÜ
["blue"]) . chr($color["green"]) . chr($color["red"]);

2545 ià(3*
$width
 % 4) {

2546 
$d©a
 .ğ
	`¡r_»³©
("\x00", 4 - 3*
$width
 % 4);

2550  
	`¬¿y
(
$width
, 
$height
, 
	`¡¾’
(
$d©a
), $data);

2551 
	}
}

2562 
public
 
funùiÚ
 
	$´oûssB™m­
(
$b™m­
)

2565 
$bmp_fd
 = @
	`fİ’
(
$b™m­
, "rb");

2566 ià(!
$bmp_fd
) {

2567 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Couldn't import $bitmap");

2571 
$d©a
 = 
	`ä—d
(
$bmp_fd
, 
	`fesize
(
$b™m­
));

2574 ià(
	`¡¾’
(
$d©a
) <= 0x36) {

2575 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("$bitmap doesn't containƒnough data.\n");

2579 
$id’t™y
 = 
	`uÅack
("A2id’t", 
$d©a
);

2580 ià(
$id’t™y
['ident'] != "BM") {

2581 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("$bitmap doesn't‡ppearo be‡ valid bitmap image.\n");

2585 
$d©a
 = 
	`sub¡r
($data, 2);

2590 
$size_¬¿y
 = 
	`uÅack
("V§", 
	`sub¡r
(
$d©a
, 0, 4));

2591 
$size
 = 
$size_¬¿y
['sa'];

2592 
$d©a
 = 
	`sub¡r
($data, 4);

2593 
$size
 -= 0x36;

2594 
$size
 += 0x0C;

2597 
$d©a
 = 
	`sub¡r
($data, 12);

2600 
$width_ªd_height
 = 
	`uÅack
("V2", 
	`sub¡r
(
$d©a
, 0, 8));

2601 
$width
 = 
$width_ªd_height
[1];

2602 
$height
 = 
$width_ªd_height
[2];

2603 
$d©a
 = 
	`sub¡r
($data, 8);

2604 ià(
$width
 > 0xFFFF) {

2605 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("$bitmap:†argest image width supported is 65k.\n");

2607 ià(
$height
 > 0xFFFF) {

2608 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("$bitmap:†argest image height supported is 65k.\n");

2612 
$¶ªes_ªd_b™couÁ
 = 
	`uÅack
("v2", 
	`sub¡r
(
$d©a
, 0, 4));

2613 
$d©a
 = 
	`sub¡r
($data, 4);

2614 ià(
$¶ªes_ªd_b™couÁ
[2] != 24) {

2615 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("$bitmap isn't‡ 24bitrue color bitmap.\n");

2617 ià(
$¶ªes_ªd_b™couÁ
[1] != 1) {

2618 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("$bitmap: only 1…lane supported in bitmap image.\n");

2622 
$com´essiÚ
 = 
	`uÅack
("Vcomp", 
	`sub¡r
(
$d©a
, 0, 4));

2623 
$d©a
 = 
	`sub¡r
($data, 4);

2626 ià(
$com´essiÚ
['comp'] != 0) {

2627 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("$bitmap: compression‚ot supported in bitmap image.\n");

2631 
$d©a
 = 
	`sub¡r
($data, 20);

2634 
$h—d”
 = 
	`·ck
("Vvvvv", 0x000c, 
$width
, 
$height
, 0x01, 0x18);

2635 
$d©a
 = 
$h—d”
 . $data;

2637  (
	`¬¿y
(
$width
, 
$height
, 
$size
, 
$d©a
));

2638 
	}
}

2644 
´iv©e
 
funùiÚ
 
	$wr™eZoom
()

2647 ià(
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`g‘ZoomSÿË
() == 100) {

2651 
$»cÜd
 = 0x00A0;

2652 
$Ëngth
 = 0x0004;

2654 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2655 
$d©a
 = 
	`·ck
("vv", 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`g‘ZoomSÿË
(), 100);

2656 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2657 
	}
}

2664 
public
 
funùiÚ
 
	$g‘Esch”
()

2666  
$this
->
esch”
;

2667 
	}
}

2674 
public
 
funùiÚ
 
	$£tEsch”
(
PHPExûl_Sh¬ed_Esch”
 
$pV®ue
 = 
nuÎ
)

2676 
$this
->
esch”
 = 
$pV®ue
;

2677 
	}
}

2682 
´iv©e
 
funùiÚ
 
	$wr™eMsoD¿wšg
()

2685 ià(
	`is£t
(
$this
->
esch”
)) {

2686 
$wr™”
 = 
Ãw
 
	`PHPExûl_Wr™”_Exûl5_Esch”
(
$this
->
esch”
);

2687 
$d©a
 = 
$wr™”
->
	`şo£
();

2688 
$¥Off£ts
 = 
$wr™”
->
	`g‘SpOff£ts
();

2689 
$¥Ty³s
 = 
$wr™”
->
	`g‘SpTy³s
();

2693 
$¥Off£ts
[0] = 0;

2694 
$nm
 = 
	`couÁ
(
$¥Off£ts
) - 1;

2695 
$i
 = 1; $˜<ğ
$nm
; ++$i) {

2697 
$»cÜd
 = 0x00EC;

2700 
$d©aChunk
 = 
	`sub¡r
(
$d©a
, 
$¥Off£ts
[
$i
 -1], $spOffsets[$i] - $spOffsets[$i - 1]);

2702 
$Ëngth
 = 
	`¡¾’
(
$d©aChunk
);

2703 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2705 
$this
->
	`­³nd
(
$h—d”
 . 
$d©aChunk
);

2708 
$»cÜd
 = 0x005D;

2709 
$objD©a
 = '';

2712 ià(
$¥Ty³s
[
$i
] == 0x00C9) {

2714 
$objD©a
 .=

2715 
	`·ck
(

2720 
$i
,

2728 
$objD©a
 .ğ
	`·ck
('vv', 0x00C, 0x0014);

2729 
$objD©a
 .ğ
	`·ck
('H*', '0000000000000000640001000A00000010000100');

2731 
$objD©a
 .ğ
	`·ck
('vv', 0x0013, 0x1FEE);

2732 
$objD©a
 .ğ
	`·ck
('H*', '00000000010001030000020008005700');

2735 
$objD©a
 .=

2736 
	`·ck
(

2741 
$i
,

2750 
$objD©a
 .=

2751 
	`·ck
(

2757 
$Ëngth
 = 
	`¡¾’
(
$objD©a
);

2758 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

2759 
$this
->
	`­³nd
(
$h—d”
 . 
$objD©a
);

2762 
	}
}

2767 
´iv©e
 
funùiÚ
 
	$wr™eD©aV®id™y
()

2770 
$d©aV®id©iÚCŞËùiÚ
 = 
$this
->
phpSh“t
->
	`g‘D©aV®id©iÚCŞËùiÚ
();

2773 ià(!
	`em±y
(
$d©aV®id©iÚCŞËùiÚ
)) {

2775 
$»cÜd
 = 0x01B2;

2776 
$Ëngth
 = 0x0012;

2778 
$grb™
 = 0x0000;

2779 
$hÜPos
 = 0x00000000;

2780 
$v”Pos
 = 0x00000000;

2781 
$objId
 = 0xFFFFFFFF;

2783 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

2784 
$d©a
 = 
	`·ck
('vVVVV', 
$grb™
, 
$hÜPos
, 
$v”Pos
, 
$objId
, 
	`couÁ
(
$d©aV®id©iÚCŞËùiÚ
));

2785 
$this
->
	`­³nd
(
$h—d”
.
$d©a
);

2788 
$»cÜd
 = 0x01BE;

2790 
	`fÜ—ch
 (
$d©aV®id©iÚCŞËùiÚ
 
as
 
$ûÎCoÜdš©e
 => 
$d©aV®id©iÚ
) {

2792 
$d©a
 = '';

2795 
$İtiÚs
 = 0x00000000;

2798 
$ty³
 = 
$d©aV®id©iÚ
->
	`g‘Ty³
();

2799 
$ty³
) {

2800 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_NONE
:

2801 
$ty³
 = 0x00;

2803 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_WHOLE
:

2804 
$ty³
 = 0x01;

2806 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_DECIMAL
:

2807 
$ty³
 = 0x02;

2809 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_LIST
:

2810 
$ty³
 = 0x03;

2812 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_DATE
:

2813 
$ty³
 = 0x04;

2815 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_TIME
:

2816 
$ty³
 = 0x05;

2818 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_TEXTLENGTH
:

2819 
$ty³
 = 0x06;

2821 
PHPExûl_C–l_D©aV®id©iÚ
::
TYPE_CUSTOM
:

2822 
$ty³
 = 0x07;

2825 
$İtiÚs
 |ğ
$ty³
 << 0;

2828 
$”rÜStyË
 = 
$d©aV®id©iÚ
->
	`g‘Ty³
();

2829 
$”rÜStyË
) {

2830 
PHPExûl_C–l_D©aV®id©iÚ
::
STYLE_STOP
:

2831 
$”rÜStyË
 = 0x00;

2833 
PHPExûl_C–l_D©aV®id©iÚ
::
STYLE_WARNING
:

2834 
$”rÜStyË
 = 0x01;

2836 
PHPExûl_C–l_D©aV®id©iÚ
::
STYLE_INFORMATION
:

2837 
$”rÜStyË
 = 0x02;

2840 
$İtiÚs
 |ğ
$”rÜStyË
 << 4;

2843 ià(
$ty³
 =ğ0x03 && 
	`´eg_m©ch
('/^\".*\"$/', 
$d©aV®id©iÚ
->
	`g‘FÜmuÏ1
())) {

2844 
$İtiÚs
 |= 0x01 << 7;

2848 
$İtiÚs
 |ğ
$d©aV®id©iÚ
->
	`g‘AÎowBÏnk
() << 8;

2851 
$İtiÚs
 |ğ(!
$d©aV®id©iÚ
->
	`g‘ShowDrİDown
()) << 9;

2854 
$İtiÚs
 |ğ
$d©aV®id©iÚ
->
	`g‘ShowIÅutMes§ge
() << 18;

2857 
$İtiÚs
 |ğ
$d©aV®id©iÚ
->
	`g‘ShowE¼ÜMes§ge
() << 19;

2860 
$İ”©Ü
 = 
$d©aV®id©iÚ
->
	`g‘O³¿tÜ
();

2861 
$İ”©Ü
) {

2862 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_BETWEEN
:

2863 
$İ”©Ü
 = 0x00;

2865 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_NOTBETWEEN
:

2866 
$İ”©Ü
 = 0x01;

2868 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_EQUAL
:

2869 
$İ”©Ü
 = 0x02;

2871 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_NOTEQUAL
:

2872 
$İ”©Ü
 = 0x03;

2874 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_GREATERTHAN
:

2875 
$İ”©Ü
 = 0x04;

2877 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_LESSTHAN
:

2878 
$İ”©Ü
 = 0x05;

2880 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_GREATERTHANOREQUAL
:

2881 
$İ”©Ü
 = 0x06;

2883 
PHPExûl_C–l_D©aV®id©iÚ
::
OPERATOR_LESSTHANOREQUAL
:

2884 
$İ”©Ü
 = 0x07;

2887 
$İtiÚs
 |ğ
$İ”©Ü
 << 20;

2889 
$d©a
 = 
	`·ck
('V', 
$İtiÚs
);

2892 
$´om±T™Ë
 = 
$d©aV®id©iÚ
->
	`g‘Prom±T™Ë
() !== '' ?

2893 
$d©aV®id©iÚ
->
	`g‘Prom±T™Ë
(è: 
	`chr
(0);

2894 
$d©a
 .ğ
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
(
$´om±T™Ë
);

2897 
$”rÜT™Ë
 = 
$d©aV®id©iÚ
->
	`g‘E¼ÜT™Ë
() !== '' ?

2898 
$d©aV®id©iÚ
->
	`g‘E¼ÜT™Ë
(è: 
	`chr
(0);

2899 
$d©a
 .ğ
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
(
$”rÜT™Ë
);

2902 
$´om±
 = 
$d©aV®id©iÚ
->
	`g‘Prom±
() !== '' ?

2903 
$d©aV®id©iÚ
->
	`g‘Prom±
(è: 
	`chr
(0);

2904 
$d©a
 .ğ
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
(
$´om±
);

2907 
$”rÜ
 = 
$d©aV®id©iÚ
->
	`g‘E¼Ü
() !== '' ?

2908 
$d©aV®id©iÚ
->
	`g‘E¼Ü
(è: 
	`chr
(0);

2909 
$d©a
 .ğ
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
(
$”rÜ
);

2912 
Œy
 {

2913 
$fÜmuÏ1
 = 
$d©aV®id©iÚ
->
	`g‘FÜmuÏ1
();

2914 ià(
$ty³
 == 0x03) {

2915 
$fÜmuÏ1
 = 
	`¡r_»¶aû
(',', 
	`chr
(0), $formula1);

2917 
$this
->
·r£r
->
	`·r£
(
$fÜmuÏ1
);

2918 
$fÜmuÏ1
 = 
$this
->
·r£r
->
	`toRev”£PŞish
();

2919 
$sz1
 = 
	`¡¾’
(
$fÜmuÏ1
);

2920 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

2921 
$sz1
 = 0;

2922 
$fÜmuÏ1
 = '';

2924 
$d©a
 .ğ
	`·ck
('vv', 
$sz1
, 0x0000);

2925 
$d©a
 .ğ
$fÜmuÏ1
;

2928 
Œy
 {

2929 
$fÜmuÏ2
 = 
$d©aV®id©iÚ
->
	`g‘FÜmuÏ2
();

2930 ià(
$fÜmuÏ2
 === '') {

2931 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('No formula2');

2933 
$this
->
·r£r
->
	`·r£
(
$fÜmuÏ2
);

2934 
$fÜmuÏ2
 = 
$this
->
·r£r
->
	`toRev”£PŞish
();

2935 
$sz2
 = 
	`¡¾’
(
$fÜmuÏ2
);

2936 } 
	`ÿtch
 (
PHPExûl_Exû±iÚ
 
$e
) {

2937 
$sz2
 = 0;

2938 
$fÜmuÏ2
 = '';

2940 
$d©a
 .ğ
	`·ck
('vv', 
$sz2
, 0x0000);

2941 
$d©a
 .ğ
$fÜmuÏ2
;

2944 
$d©a
 .ğ
	`·ck
('v', 0x0001);

2945 
$d©a
 .ğ
$this
->
	`wr™eBIFF8C–lRªgeAdd»ssFixed
(
$ûÎCoÜdš©e
);

2947 
$Ëngth
 = 
	`¡¾’
(
$d©a
);

2948 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

2950 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

2953 
	}
}

2961 
´iv©e
 
funùiÚ
 
	$m­E¼ÜCode
(
$”rÜCode
)

2963 
$”rÜCode
) {

2981 
	}
}

2986 
´iv©e
 
funùiÚ
 
	$wr™ePageLayoutV›w
()

2988 
$»cÜd
 = 0x088B;

2989 
$Ëngth
 = 0x0010;

2991 
$¹
 = 0x088B;

2992 
$grb™F¹
 = 0x0000;

2993 
$»£rved
 = 0x0000000000000000;

2994 
$wSÿlvePLV
 = 
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`g‘ZoomSÿË
();

2997 ià(
$this
->
phpSh“t
->
	`g‘Sh“tV›w
()->
	`g‘V›w
(è=ğ
PHPExûl_WÜksh“t_Sh“tV›w
::
SHEETVIEW_PAGE_LAYOUT
) {

2998 
$fPageLayoutV›w
 = 1;

3000 
$fPageLayoutV›w
 = 0;

3002 
$fRuËrVisibË
 = 0;

3003 
$fWh™e¥aûHidd’
 = 0;

3005 
$grb™
 = 
$fPageLayoutV›w
;

3006 
$grb™
 |ğ
$fRuËrVisibË
 << 1;

3007 
$grb™
 |ğ
$fWh™e¥aûHidd’
 << 3;

3009 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

3010 
$d©a
 = 
	`·ck
("vvVVvv", 
$¹
, 
$grb™F¹
, 0x00000000, 0x00000000, 
$wSÿlvePLV
, 
$grb™
);

3011 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

3012 
	}
}

3018 
´iv©e
 
funùiÚ
 
	$wr™eCFRuË
(
PHPExûl_StyË_CÚd™iÚ®
 
$cÚd™iÚ®
)

3020 
$»cÜd
 = 0x01B1;

3024 ià(
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_EXPRESSION
) {

3025 
$ty³
 = 0x02;

3026 
$İ”©ÜTy³
 = 0x00;

3027 } 
	`–£if
 (
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CELLIS
) {

3028 
$ty³
 = 0x01;

3030 
$cÚd™iÚ®
->
	`g‘O³¿tÜTy³
()) {

3031 
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_NONE
:

3032 
$İ”©ÜTy³
 = 0x00;

3034 
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_EQUAL
:

3035 
$İ”©ÜTy³
 = 0x03;

3037 
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_GREATERTHAN
:

3038 
$İ”©ÜTy³
 = 0x05;

3040 
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_GREATERTHANOREQUAL
:

3041 
$İ”©ÜTy³
 = 0x07;

3043 
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_LESSTHAN
:

3044 
$İ”©ÜTy³
 = 0x06;

3046 
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_LESSTHANOREQUAL
:

3047 
$İ”©ÜTy³
 = 0x08;

3049 
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_NOTEQUAL
:

3050 
$İ”©ÜTy³
 = 0x04;

3052 
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_BETWEEN
:

3053 
$İ”©ÜTy³
 = 0x01;

3061 
$¬rCÚd™iÚs
 = 
$cÚd™iÚ®
->
	`g‘CÚd™iÚs
();

3062 
$numCÚd™iÚs
 = (
$¬rCÚd™iÚs
);

3063 ià(
$numCÚd™iÚs
 == 1) {

3064 
$szV®ue1
 = (
$¬rCÚd™iÚs
[0] <= 65535 ? 3 : 0x0000);

3065 
$szV®ue2
 = 0x0000;

3066 
$İ”ªd1
 = 
	`·ck
('Cv', 0x1E, 
$¬rCÚd™iÚs
[0]);

3067 
$İ”ªd2
 = 
nuÎ
;

3068 } 
	`–£if
 (
$numCÚd™iÚs
 =ğ2 && (
$cÚd™iÚ®
->
	`g‘O³¿tÜTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
OPERATOR_BETWEEN
)) {

3069 
$szV®ue1
 = (
$¬rCÚd™iÚs
[0] <= 65535 ? 3 : 0x0000);

3070 
$szV®ue2
 = (
$¬rCÚd™iÚs
[1] <= 65535 ? 3 : 0x0000);

3071 
$İ”ªd1
 = 
	`·ck
('Cv', 0x1E, 
$¬rCÚd™iÚs
[0]);

3072 
$İ”ªd2
 = 
	`·ck
('Cv', 0x1E, 
$¬rCÚd™iÚs
[1]);

3074 
$szV®ue1
 = 0x0000;

3075 
$szV®ue2
 = 0x0000;

3076 
$İ”ªd1
 = 
nuÎ
;

3077 
$İ”ªd2
 = 
nuÎ
;

3082 
$bAlignHz
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘HÜizÚl
(è=ğ
nuÎ
 ? 1 : 0);

3083 
$bAlignVt
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘V”tiÿl
(è=ğ
nuÎ
 ? 1 : 0);

3084 
$bAlignW¿pTx
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘W¿pText
(è=ğ
çl£
 ? 1 : 0);

3085 
$bTxRÙ©iÚ
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
(è=ğ
nuÎ
 ? 1 : 0);

3086 
$bInd’t
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘Ind’t
() == 0 ? 1 : 0);

3087 
$bShrškToF™
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘ShrškToF™
(è=ğ
çl£
 ? 1 : 0);

3088 ià(
$bAlignHz
 =ğ0 || 
$bAlignVt
 =ğ0 || 
$bAlignW¿pTx
 =ğ0 || 
$bTxRÙ©iÚ
 =ğ0 || 
$bInd’t
 =ğ0 || 
$bShrškToF™
 == 0) {

3089 
$bFÜm©Align
 = 1;

3091 
$bFÜm©Align
 = 0;

3094 
$bPrÙLocked
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è=ğ
nuÎ
 ? 1 : 0);

3095 
$bPrÙHidd’
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘PrÙeùiÚ
()->
	`g‘Hidd’
(è=ğ
nuÎ
 ? 1 : 0);

3096 ià(
$bPrÙLocked
 =ğ0 || 
$bPrÙHidd’
 == 0) {

3097 
$bFÜm©PrÙ
 = 1;

3099 
$bFÜm©PrÙ
 = 0;

3102 
$bBÜd”Leá
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘Leá
()->
	`g‘CŞÜ
()->
	`g‘ARGB
(è=ğ
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK


3103 && 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘Leá
()->
	`g‘BÜd”StyË
(è=ğ
PHPExûl_StyË_BÜd”
::
BORDER_NONE
 ? 1 : 0);

3104 
$bBÜd”Right
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘Right
()->
	`g‘CŞÜ
()->
	`g‘ARGB
(è=ğ
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK


3105 && 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘Right
()->
	`g‘BÜd”StyË
(è=ğ
PHPExûl_StyË_BÜd”
::
BORDER_NONE
 ? 1 : 0);

3106 
$bBÜd”Tİ
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
	`g‘CŞÜ
()->
	`g‘ARGB
(è=ğ
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK


3107 && 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
	`g‘BÜd”StyË
(è=ğ
PHPExûl_StyË_BÜd”
::
BORDER_NONE
 ? 1 : 0);

3108 
$bBÜd”BÙtom
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
	`g‘CŞÜ
()->
	`g‘ARGB
(è=ğ
PHPExûl_StyË_CŞÜ
::
COLOR_BLACK


3109 && 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
	`g‘BÜd”StyË
(è=ğ
PHPExûl_StyË_BÜd”
::
BORDER_NONE
 ? 1 : 0);

3110 ià(
$bBÜd”Leá
 =ğ0 || 
$bBÜd”Right
 =ğ0 || 
$bBÜd”Tİ
 =ğ0 || 
$bBÜd”BÙtom
 == 0) {

3111 
$bFÜm©BÜd”
 = 1;

3113 
$bFÜm©BÜd”
 = 0;

3116 
$bFlStyË
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Fl
()->
	`g‘FlTy³
(è=ğ
nuÎ
 ? 0 : 1);

3117 
$bFlCŞÜ
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Fl
()->
	`g‘S¹CŞÜ
()->
	`g‘ARGB
(è=ğ
nuÎ
 ? 0 : 1);

3118 
$bFlCŞÜBg
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Fl
()->
	`g‘EndCŞÜ
()->
	`g‘ARGB
(è=ğ
nuÎ
 ? 0 : 1);

3119 ià(
$bFlStyË
 =ğ0 || 
$bFlCŞÜ
 =ğ0 || 
$bFlCŞÜBg
 == 0) {

3120 
$bFÜm©Fl
 = 1;

3122 
$bFÜm©Fl
 = 0;

3125 ià(
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Name
(è!ğ
nuÎ


3126 || 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Size
(è!ğ
nuÎ


3127 || 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘BŞd
(è!ğ
nuÎ


3128 || 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Ilic
(è!ğ
nuÎ


3129 || 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Su³rSüt
(è!ğ
nuÎ


3130 || 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘SubSüt
(è!ğ
nuÎ


3131 || 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Und”lše
(è!ğ
nuÎ


3132 || 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘SŒik‘hrough
(è!ğ
nuÎ


3133 || 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘CŞÜ
()->
	`g‘ARGB
(è!ğ
nuÎ
) {

3134 
$bFÜm©FÚt
 = 1;

3136 
$bFÜm©FÚt
 = 0;

3139 
$æags
 = 0;

3140 
$æags
 |ğ(1 =ğ
$bAlignHz
 ? 0x00000001 : 0);

3141 
$æags
 |ğ(1 =ğ
$bAlignVt
 ? 0x00000002 : 0);

3142 
$æags
 |ğ(1 =ğ
$bAlignW¿pTx
 ? 0x00000004 : 0);

3143 
$æags
 |ğ(1 =ğ
$bTxRÙ©iÚ
 ? 0x00000008 : 0);

3145 
$æags
 |= (1 == 1 ? 0x00000010 : 0);

3146 
$æags
 |ğ(1 =ğ
$bInd’t
 ? 0x00000020 : 0);

3147 
$æags
 |ğ(1 =ğ
$bShrškToF™
 ? 0x00000040 : 0);

3149 
$æags
 |= (1 == 1 ? 0x00000080 : 0);

3151 
$æags
 |ğ(1 =ğ
$bPrÙLocked
 ? 0x00000100 : 0);

3152 
$æags
 |ğ(1 =ğ
$bPrÙHidd’
 ? 0x00000200 : 0);

3154 
$æags
 |ğ(1 =ğ
$bBÜd”Leá
 ? 0x00000400 : 0);

3155 
$æags
 |ğ(1 =ğ
$bBÜd”Right
 ? 0x00000800 : 0);

3156 
$æags
 |ğ(1 =ğ
$bBÜd”Tİ
 ? 0x00001000 : 0);

3157 
$æags
 |ğ(1 =ğ
$bBÜd”BÙtom
 ? 0x00002000 : 0);

3158 
$æags
 |= (1 == 1 ? 0x00004000 : 0);

3159 
$æags
 |= (1 == 1 ? 0x00008000 : 0);

3161 
$æags
 |ğ(1 =ğ
$bFlStyË
 ? 0x00010000 : 0);

3162 
$æags
 |ğ(1 =ğ
$bFlCŞÜ
 ? 0x00020000 : 0);

3163 
$æags
 |ğ(1 =ğ
$bFlCŞÜBg
 ? 0x00040000 : 0);

3164 
$æags
 |= (1 == 1 ? 0x00380000 : 0);

3166 
$æags
 |ğ(1 =ğ
$bFÜm©FÚt
 ? 0x04000000 : 0);

3168 
$æags
 |ğ(1 =ğ
$bFÜm©Align
 ? 0x08000000 : 0);

3170 
$æags
 |ğ(1 =ğ
$bFÜm©BÜd”
 ? 0x10000000 : 0);

3172 
$æags
 |ğ(1 =ğ
$bFÜm©Fl
 ? 0x20000000 : 0);

3174 
$æags
 |ğ(1 =ğ
$bFÜm©PrÙ
 ? 0x40000000 : 0);

3176 
$æags
 |= (1 == 0 ? 0x80000000 : 0);

3179 ià(
$bFÜm©FÚt
 == 1) {

3181 ià(
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Name
(è=ğ
nuÎ
) {

3182 
$d©aBlockFÚt
 = 
	`·ck
('VVVVVVVV', 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000);

3183 
$d©aBlockFÚt
 .ğ
	`·ck
('VVVVVVVV', 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000);

3185 
$d©aBlockFÚt
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`UTF8toBIFF8UnicodeLÚg
(
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Name
());

3188 ià(
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Size
(è=ğ
nuÎ
) {

3189 
$d©aBlockFÚt
 .ğ
	`·ck
('V', 20 * 11);

3191 
$d©aBlockFÚt
 .ğ
	`·ck
('V', 20 * 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Size
());

3194 
$d©aBlockFÚt
 .ğ
	`·ck
('V', 0);

3196 ià(
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘BŞd
(è=ğ
Œue
) {

3197 
$d©aBlockFÚt
 .ğ
	`·ck
('v', 0x02BC);

3199 
$d©aBlockFÚt
 .ğ
	`·ck
('v', 0x0190);

3202 ià(
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘SubSüt
(è=ğ
Œue
) {

3203 
$d©aBlockFÚt
 .ğ
	`·ck
('v', 0x02);

3204 
$fÚtEsÿ³m’t
 = 0;

3205 } 
	`–£if
 (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Su³rSüt
(è=ğ
Œue
) {

3206 
$d©aBlockFÚt
 .ğ
	`·ck
('v', 0x01);

3207 
$fÚtEsÿ³m’t
 = 0;

3209 
$d©aBlockFÚt
 .ğ
	`·ck
('v', 0x00);

3210 
$fÚtEsÿ³m’t
 = 1;

3213 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘Und”lše
()) {

3214 
PHPExûl_StyË_FÚt
::
UNDERLINE_NONE
:

3215 
$d©aBlockFÚt
 .ğ
	`·ck
('C', 0x00);

3216 
$fÚtUnd”lše
 = 0;

3218 
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLE
:

3219 
$d©aBlockFÚt
 .ğ
	`·ck
('C', 0x02);

3220 
$fÚtUnd”lše
 = 0;

3222 
PHPExûl_StyË_FÚt
::
UNDERLINE_DOUBLEACCOUNTING
:

3223 
$d©aBlockFÚt
 .ğ
	`·ck
('C', 0x22);

3224 
$fÚtUnd”lše
 = 0;

3226 
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLE
:

3227 
$d©aBlockFÚt
 .ğ
	`·ck
('C', 0x01);

3228 
$fÚtUnd”lše
 = 0;

3230 
PHPExûl_StyË_FÚt
::
UNDERLINE_SINGLEACCOUNTING
:

3231 
$d©aBlockFÚt
 .ğ
	`·ck
('C', 0x21);

3232 
$fÚtUnd”lše
 = 0;

3234 : 
$d©aBlockFÚt
 .ğ
	`·ck
('C', 0x00);

3235 
$fÚtUnd”lše
 = 1;

3239 
$d©aBlockFÚt
 .ğ
	`·ck
('vC', 0x0000, 0x00);

3241 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘CŞÜ
()->
	`g‘RGB
()) {

3243 
$cŞÜIdx
 = 0x08;

3246 
$cŞÜIdx
 = 0x09;

3249 
$cŞÜIdx
 = 0x0A;

3252 
$cŞÜIdx
 = 0x0B;

3255 
$cŞÜIdx
 = 0x0C;

3258 
$cŞÜIdx
 = 0x0D;

3261 
$cŞÜIdx
 = 0x0E;

3264 
$cŞÜIdx
 = 0x0F;

3267 
$cŞÜIdx
 = 0x10;

3270 
$cŞÜIdx
 = 0x11;

3273 
$cŞÜIdx
 = 0x12;

3276 
$cŞÜIdx
 = 0x13;

3279 
$cŞÜIdx
 = 0x14;

3282 
$cŞÜIdx
 = 0x15;

3285 
$cŞÜIdx
 = 0x16;

3288 
$cŞÜIdx
 = 0x17;

3291 
$cŞÜIdx
 = 0x18;

3294 
$cŞÜIdx
 = 0x19;

3297 
$cŞÜIdx
 = 0x1A;

3300 
$cŞÜIdx
 = 0x1B;

3303 
$cŞÜIdx
 = 0x1C;

3306 
$cŞÜIdx
 = 0x1D;

3309 
$cŞÜIdx
 = 0x1E;

3312 
$cŞÜIdx
 = 0x1F;

3315 
$cŞÜIdx
 = 0x20;

3318 
$cŞÜIdx
 = 0x21;

3321 
$cŞÜIdx
 = 0x22;

3324 
$cŞÜIdx
 = 0x23;

3327 
$cŞÜIdx
 = 0x24;

3330 
$cŞÜIdx
 = 0x25;

3333 
$cŞÜIdx
 = 0x26;

3336 
$cŞÜIdx
 = 0x27;

3339 
$cŞÜIdx
 = 0x28;

3342 
$cŞÜIdx
 = 0x29;

3345 
$cŞÜIdx
 = 0x2A;

3348 
$cŞÜIdx
 = 0x2B;

3351 
$cŞÜIdx
 = 0x2C;

3354 
$cŞÜIdx
 = 0x2D;

3357 
$cŞÜIdx
 = 0x2E;

3360 
$cŞÜIdx
 = 0x2F;

3363 
$cŞÜIdx
 = 0x30;

3366 
$cŞÜIdx
 = 0x31;

3369 
$cŞÜIdx
 = 0x32;

3372 
$cŞÜIdx
 = 0x33;

3375 
$cŞÜIdx
 = 0x34;

3378 
$cŞÜIdx
 = 0x35;

3381 
$cŞÜIdx
 = 0x36;

3384 
$cŞÜIdx
 = 0x37;

3387 
$cŞÜIdx
 = 0x38;

3390 
$cŞÜIdx
 = 0x39;

3393 
$cŞÜIdx
 = 0x3A;

3396 
$cŞÜIdx
 = 0x3B;

3399 
$cŞÜIdx
 = 0x3C;

3402 
$cŞÜIdx
 = 0x3D;

3405 
$cŞÜIdx
 = 0x3E;

3408 
$cŞÜIdx
 = 0x3F;

3411 
$cŞÜIdx
 = 0x00;

3414 
$d©aBlockFÚt
 .ğ
	`·ck
('V', 
$cŞÜIdx
);

3416 
$d©aBlockFÚt
 .ğ
	`·ck
('V', 0x00000000);

3418 
$İtiÚsFÏgs
 = 0;

3419 
$İtiÚsFÏgsBŞd
 = (
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘FÚt
()->
	`g‘BŞd
(è=ğ
nuÎ
 ? 1 : 0);

3420 
$İtiÚsFÏgs
 |ğ(1 =ğ
$İtiÚsFÏgsBŞd
 ? 0x00000002 : 0);

3421 
$İtiÚsFÏgs
 |= (1 == 1 ? 0x00000008 : 0);

3422 
$İtiÚsFÏgs
 |= (1 == 1 ? 0x00000010 : 0);

3423 
$İtiÚsFÏgs
 |= (1 == 0 ? 0x00000020 : 0);

3424 
$İtiÚsFÏgs
 |= (1 == 1 ? 0x00000080 : 0);

3425 
$d©aBlockFÚt
 .ğ
	`·ck
('V', 
$İtiÚsFÏgs
);

3427 
$d©aBlockFÚt
 .ğ
	`·ck
('V', 
$fÚtEsÿ³m’t
);

3429 
$d©aBlockFÚt
 .ğ
	`·ck
('V', 
$fÚtUnd”lše
);

3431 
$d©aBlockFÚt
 .ğ
	`·ck
('V', 0x00000000);

3433 
$d©aBlockFÚt
 .ğ
	`·ck
('V', 0x00000000);

3435 
$d©aBlockFÚt
 .ğ
	`·ck
('VV', 0x00000000, 0x00000000);

3437 
$d©aBlockFÚt
 .ğ
	`·ck
('v', 0x0001);

3439 ià(
$bFÜm©Align
 == 1) {

3440 
$blockAlign
 = 0;

3442 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘HÜizÚl
()) {

3443 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
:

3444 
$blockAlign
 = 0;

3446 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_LEFT
:

3447 
$blockAlign
 = 1;

3449 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_RIGHT
:

3450 
$blockAlign
 = 3;

3452 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER
:

3453 
$blockAlign
 = 2;

3455 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER_CONTINUOUS
:

3456 
$blockAlign
 = 6;

3458 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_JUSTIFY
:

3459 
$blockAlign
 = 5;

3462 ià(
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘W¿pText
(è=ğ
Œue
) {

3463 
$blockAlign
 |= 1 << 3;

3465 
$blockAlign
 |= 0 << 3;

3467 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘V”tiÿl
()) {

3468 
PHPExûl_StyË_Alignm’t
::
VERTICAL_BOTTOM
:

3469 
$blockAlign
 = 2 << 4;

3471 
PHPExûl_StyË_Alignm’t
::
VERTICAL_TOP
:

3472 
$blockAlign
 = 0 << 4;

3474 
PHPExûl_StyË_Alignm’t
::
VERTICAL_CENTER
:

3475 
$blockAlign
 = 1 << 4;

3477 
PHPExûl_StyË_Alignm’t
::
VERTICAL_JUSTIFY
:

3478 
$blockAlign
 = 3 << 4;

3481 
$blockAlign
 |= 0 << 7;

3484 
$blockRÙ©iÚ
 = 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
();

3487 
$blockInd’t
 = 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘Ind’t
();

3488 ià(
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Alignm’t
()->
	`g‘ShrškToF™
(è=ğ
Œue
) {

3489 
$blockInd’t
 |= 1 << 4;

3491 
$blockInd’t
 |= 0 << 4;

3493 
$blockInd’t
 |= 0 << 6;

3496 
$blockInd’tR–©ive
 = 255;

3498 
$d©aBlockAlign
 = 
	`·ck
('CCvvv', 
$blockAlign
, 
$blockRÙ©iÚ
, 
$blockInd’t
, 
$blockInd’tR–©ive
, 0x0000);

3500 ià(
$bFÜm©BÜd”
 == 1) {

3501 
$blockLšeStyË
 = 0;

3502 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘Leá
()->
	`g‘BÜd”StyË
()) {

3503 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
:

3504 
$blockLšeStyË
 |= 0x00;

3506 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
:

3507 
$blockLšeStyË
 |= 0x01;

3509 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
:

3510 
$blockLšeStyË
 |= 0x02;

3512 
PHPExûl_StyË_BÜd”
::
BORDER_DASHED
:

3513 
$blockLšeStyË
 |= 0x03;

3515 
PHPExûl_StyË_BÜd”
::
BORDER_DOTTED
:

3516 
$blockLšeStyË
 |= 0x04;

3518 
PHPExûl_StyË_BÜd”
::
BORDER_THICK
:

3519 
$blockLšeStyË
 |= 0x05;

3521 
PHPExûl_StyË_BÜd”
::
BORDER_DOUBLE
:

3522 
$blockLšeStyË
 |= 0x06;

3524 
PHPExûl_StyË_BÜd”
::
BORDER_HAIR
:

3525 
$blockLšeStyË
 |= 0x07;

3527 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHED
:

3528 
$blockLšeStyË
 |= 0x08;

3530 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOT
:

3531 
$blockLšeStyË
 |= 0x09;

3533 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOT
:

3534 
$blockLšeStyË
 |= 0x0A;

3536 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOTDOT
:

3537 
$blockLšeStyË
 |= 0x0B;

3539 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOTDOT
:

3540 
$blockLšeStyË
 |= 0x0C;

3542 
PHPExûl_StyË_BÜd”
::
BORDER_SLANTDASHDOT
:

3543 
$blockLšeStyË
 |= 0x0D;

3546 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘Right
()->
	`g‘BÜd”StyË
()) {

3547 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
:

3548 
$blockLšeStyË
 |= 0x00 << 4;

3550 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
:

3551 
$blockLšeStyË
 |= 0x01 << 4;

3553 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
:

3554 
$blockLšeStyË
 |= 0x02 << 4;

3556 
PHPExûl_StyË_BÜd”
::
BORDER_DASHED
:

3557 
$blockLšeStyË
 |= 0x03 << 4;

3559 
PHPExûl_StyË_BÜd”
::
BORDER_DOTTED
:

3560 
$blockLšeStyË
 |= 0x04 << 4;

3562 
PHPExûl_StyË_BÜd”
::
BORDER_THICK
:

3563 
$blockLšeStyË
 |= 0x05 << 4;

3565 
PHPExûl_StyË_BÜd”
::
BORDER_DOUBLE
:

3566 
$blockLšeStyË
 |= 0x06 << 4;

3568 
PHPExûl_StyË_BÜd”
::
BORDER_HAIR
:

3569 
$blockLšeStyË
 |= 0x07 << 4;

3571 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHED
:

3572 
$blockLšeStyË
 |= 0x08 << 4;

3574 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOT
:

3575 
$blockLšeStyË
 |= 0x09 << 4;

3577 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOT
:

3578 
$blockLšeStyË
 |= 0x0A << 4;

3580 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOTDOT
:

3581 
$blockLšeStyË
 |= 0x0B << 4;

3583 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOTDOT
:

3584 
$blockLšeStyË
 |= 0x0C << 4;

3586 
PHPExûl_StyË_BÜd”
::
BORDER_SLANTDASHDOT
:

3587 
$blockLšeStyË
 |= 0x0D << 4;

3590 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
	`g‘BÜd”StyË
()) {

3591 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
:

3592 
$blockLšeStyË
 |= 0x00 << 8;

3594 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
:

3595 
$blockLšeStyË
 |= 0x01 << 8;

3597 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
:

3598 
$blockLšeStyË
 |= 0x02 << 8;

3600 
PHPExûl_StyË_BÜd”
::
BORDER_DASHED
:

3601 
$blockLšeStyË
 |= 0x03 << 8;

3603 
PHPExûl_StyË_BÜd”
::
BORDER_DOTTED
:

3604 
$blockLšeStyË
 |= 0x04 << 8;

3606 
PHPExûl_StyË_BÜd”
::
BORDER_THICK
:

3607 
$blockLšeStyË
 |= 0x05 << 8;

3609 
PHPExûl_StyË_BÜd”
::
BORDER_DOUBLE
:

3610 
$blockLšeStyË
 |= 0x06 << 8;

3612 
PHPExûl_StyË_BÜd”
::
BORDER_HAIR
:

3613 
$blockLšeStyË
 |= 0x07 << 8;

3615 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHED
:

3616 
$blockLšeStyË
 |= 0x08 << 8;

3618 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOT
:

3619 
$blockLšeStyË
 |= 0x09 << 8;

3621 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOT
:

3622 
$blockLšeStyË
 |= 0x0A << 8;

3624 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOTDOT
:

3625 
$blockLšeStyË
 |= 0x0B << 8;

3627 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOTDOT
:

3628 
$blockLšeStyË
 |= 0x0C << 8;

3630 
PHPExûl_StyË_BÜd”
::
BORDER_SLANTDASHDOT
:

3631 
$blockLšeStyË
 |= 0x0D << 8;

3634 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
	`g‘BÜd”StyË
()) {

3635 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
:

3636 
$blockLšeStyË
 |= 0x00 << 12;

3638 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
:

3639 
$blockLšeStyË
 |= 0x01 << 12;

3641 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
:

3642 
$blockLšeStyË
 |= 0x02 << 12;

3644 
PHPExûl_StyË_BÜd”
::
BORDER_DASHED
:

3645 
$blockLšeStyË
 |= 0x03 << 12;

3647 
PHPExûl_StyË_BÜd”
::
BORDER_DOTTED
:

3648 
$blockLšeStyË
 |= 0x04 << 12;

3650 
PHPExûl_StyË_BÜd”
::
BORDER_THICK
:

3651 
$blockLšeStyË
 |= 0x05 << 12;

3653 
PHPExûl_StyË_BÜd”
::
BORDER_DOUBLE
:

3654 
$blockLšeStyË
 |= 0x06 << 12;

3656 
PHPExûl_StyË_BÜd”
::
BORDER_HAIR
:

3657 
$blockLšeStyË
 |= 0x07 << 12;

3659 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHED
:

3660 
$blockLšeStyË
 |= 0x08 << 12;

3662 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOT
:

3663 
$blockLšeStyË
 |= 0x09 << 12;

3665 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOT
:

3666 
$blockLšeStyË
 |= 0x0A << 12;

3668 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOTDOT
:

3669 
$blockLšeStyË
 |= 0x0B << 12;

3671 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOTDOT
:

3672 
$blockLšeStyË
 |= 0x0C << 12;

3674 
PHPExûl_StyË_BÜd”
::
BORDER_SLANTDASHDOT
:

3675 
$blockLšeStyË
 |= 0x0D << 12;

3682 
$blockCŞÜ
 = 0;

3686 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘BÜd”s
()->
	`g‘DŸgÚ®
()->
	`g‘BÜd”StyË
()) {

3687 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
:

3688 
$blockCŞÜ
 |= 0x00 << 21;

3690 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
:

3691 
$blockCŞÜ
 |= 0x01 << 21;

3693 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
:

3694 
$blockCŞÜ
 |= 0x02 << 21;

3696 
PHPExûl_StyË_BÜd”
::
BORDER_DASHED
:

3697 
$blockCŞÜ
 |= 0x03 << 21;

3699 
PHPExûl_StyË_BÜd”
::
BORDER_DOTTED
:

3700 
$blockCŞÜ
 |= 0x04 << 21;

3702 
PHPExûl_StyË_BÜd”
::
BORDER_THICK
:

3703 
$blockCŞÜ
 |= 0x05 << 21;

3705 
PHPExûl_StyË_BÜd”
::
BORDER_DOUBLE
:

3706 
$blockCŞÜ
 |= 0x06 << 21;

3708 
PHPExûl_StyË_BÜd”
::
BORDER_HAIR
:

3709 
$blockCŞÜ
 |= 0x07 << 21;

3711 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHED
:

3712 
$blockCŞÜ
 |= 0x08 << 21;

3714 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOT
:

3715 
$blockCŞÜ
 |= 0x09 << 21;

3717 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOT
:

3718 
$blockCŞÜ
 |= 0x0A << 21;

3720 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOTDOT
:

3721 
$blockCŞÜ
 |= 0x0B << 21;

3723 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOTDOT
:

3724 
$blockCŞÜ
 |= 0x0C << 21;

3726 
PHPExûl_StyË_BÜd”
::
BORDER_SLANTDASHDOT
:

3727 
$blockCŞÜ
 |= 0x0D << 21;

3730 
$d©aBlockBÜd”
 = 
	`·ck
('vv', 
$blockLšeStyË
, 
$blockCŞÜ
);

3732 ià(
$bFÜm©Fl
 == 1) {

3734 
$blockFlP©‹ºStyË
 = 0;

3735 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Fl
()->
	`g‘FlTy³
()) {

3736 
PHPExûl_StyË_Fl
::
FILL_NONE
:

3737 
$blockFlP©‹ºStyË
 = 0x00;

3739 
PHPExûl_StyË_Fl
::
FILL_SOLID
:

3740 
$blockFlP©‹ºStyË
 = 0x01;

3742 
PHPExûl_StyË_Fl
::
FILL_PATTERN_MEDIUMGRAY
:

3743 
$blockFlP©‹ºStyË
 = 0x02;

3745 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKGRAY
:

3746 
$blockFlP©‹ºStyË
 = 0x03;

3748 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTGRAY
:

3749 
$blockFlP©‹ºStyË
 = 0x04;

3751 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKHORIZONTAL
:

3752 
$blockFlP©‹ºStyË
 = 0x05;

3754 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKVERTICAL
:

3755 
$blockFlP©‹ºStyË
 = 0x06;

3757 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKDOWN
:

3758 
$blockFlP©‹ºStyË
 = 0x07;

3760 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKUP
:

3761 
$blockFlP©‹ºStyË
 = 0x08;

3763 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKGRID
:

3764 
$blockFlP©‹ºStyË
 = 0x09;

3766 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKTRELLIS
:

3767 
$blockFlP©‹ºStyË
 = 0x0A;

3769 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTHORIZONTAL
:

3770 
$blockFlP©‹ºStyË
 = 0x0B;

3772 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTVERTICAL
:

3773 
$blockFlP©‹ºStyË
 = 0x0C;

3775 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTDOWN
:

3776 
$blockFlP©‹ºStyË
 = 0x0D;

3778 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTUP
:

3779 
$blockFlP©‹ºStyË
 = 0x0E;

3781 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTGRID
:

3782 
$blockFlP©‹ºStyË
 = 0x0F;

3784 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTTRELLIS
:

3785 
$blockFlP©‹ºStyË
 = 0x10;

3787 
PHPExûl_StyË_Fl
::
FILL_PATTERN_GRAY125
:

3788 
$blockFlP©‹ºStyË
 = 0x11;

3790 
PHPExûl_StyË_Fl
::
FILL_PATTERN_GRAY0625
:

3791 
$blockFlP©‹ºStyË
 = 0x12;

3793 
PHPExûl_StyË_Fl
::
FILL_GRADIENT_LINEAR
:

3794 
$blockFlP©‹ºStyË
 = 0x00;

3796 
PHPExûl_StyË_Fl
::
FILL_GRADIENT_PATH
:

3797 
$blockFlP©‹ºStyË
 = 0x00;

3800 
$blockFlP©‹ºStyË
 = 0x00;

3804 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Fl
()->
	`g‘S¹CŞÜ
()->
	`g‘RGB
()) {

3806 
$cŞÜIdxBg
 = 0x08;

3809 
$cŞÜIdxBg
 = 0x09;

3812 
$cŞÜIdxBg
 = 0x0A;

3815 
$cŞÜIdxBg
 = 0x0B;

3818 
$cŞÜIdxBg
 = 0x0C;

3821 
$cŞÜIdxBg
 = 0x0D;

3824 
$cŞÜIdxBg
 = 0x0E;

3827 
$cŞÜIdxBg
 = 0x0F;

3830 
$cŞÜIdxBg
 = 0x10;

3833 
$cŞÜIdxBg
 = 0x11;

3836 
$cŞÜIdxBg
 = 0x12;

3839 
$cŞÜIdxBg
 = 0x13;

3842 
$cŞÜIdxBg
 = 0x14;

3845 
$cŞÜIdxBg
 = 0x15;

3848 
$cŞÜIdxBg
 = 0x16;

3851 
$cŞÜIdxBg
 = 0x17;

3854 
$cŞÜIdxBg
 = 0x18;

3857 
$cŞÜIdxBg
 = 0x19;

3860 
$cŞÜIdxBg
 = 0x1A;

3863 
$cŞÜIdxBg
 = 0x1B;

3866 
$cŞÜIdxBg
 = 0x1C;

3869 
$cŞÜIdxBg
 = 0x1D;

3872 
$cŞÜIdxBg
 = 0x1E;

3875 
$cŞÜIdxBg
 = 0x1F;

3878 
$cŞÜIdxBg
 = 0x20;

3881 
$cŞÜIdxBg
 = 0x21;

3884 
$cŞÜIdxBg
 = 0x22;

3887 
$cŞÜIdxBg
 = 0x23;

3890 
$cŞÜIdxBg
 = 0x24;

3893 
$cŞÜIdxBg
 = 0x25;

3896 
$cŞÜIdxBg
 = 0x26;

3899 
$cŞÜIdxBg
 = 0x27;

3902 
$cŞÜIdxBg
 = 0x28;

3905 
$cŞÜIdxBg
 = 0x29;

3908 
$cŞÜIdxBg
 = 0x2A;

3911 
$cŞÜIdxBg
 = 0x2B;

3914 
$cŞÜIdxBg
 = 0x2C;

3917 
$cŞÜIdxBg
 = 0x2D;

3920 
$cŞÜIdxBg
 = 0x2E;

3923 
$cŞÜIdxBg
 = 0x2F;

3926 
$cŞÜIdxBg
 = 0x30;

3929 
$cŞÜIdxBg
 = 0x31;

3932 
$cŞÜIdxBg
 = 0x32;

3935 
$cŞÜIdxBg
 = 0x33;

3938 
$cŞÜIdxBg
 = 0x34;

3941 
$cŞÜIdxBg
 = 0x35;

3944 
$cŞÜIdxBg
 = 0x36;

3947 
$cŞÜIdxBg
 = 0x37;

3950 
$cŞÜIdxBg
 = 0x38;

3953 
$cŞÜIdxBg
 = 0x39;

3956 
$cŞÜIdxBg
 = 0x3A;

3959 
$cŞÜIdxBg
 = 0x3B;

3962 
$cŞÜIdxBg
 = 0x3C;

3965 
$cŞÜIdxBg
 = 0x3D;

3968 
$cŞÜIdxBg
 = 0x3E;

3971 
$cŞÜIdxBg
 = 0x3F;

3974 
$cŞÜIdxBg
 = 0x41;

3978 
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘Fl
()->
	`g‘EndCŞÜ
()->
	`g‘RGB
()) {

3980 
$cŞÜIdxFg
 = 0x08;

3983 
$cŞÜIdxFg
 = 0x09;

3986 
$cŞÜIdxFg
 = 0x0A;

3989 
$cŞÜIdxFg
 = 0x0B;

3992 
$cŞÜIdxFg
 = 0x0C;

3995 
$cŞÜIdxFg
 = 0x0D;

3998 
$cŞÜIdxFg
 = 0x0E;

4001 
$cŞÜIdxFg
 = 0x0F;

4004 
$cŞÜIdxFg
 = 0x10;

4007 
$cŞÜIdxFg
 = 0x11;

4010 
$cŞÜIdxFg
 = 0x12;

4013 
$cŞÜIdxFg
 = 0x13;

4016 
$cŞÜIdxFg
 = 0x14;

4019 
$cŞÜIdxFg
 = 0x15;

4022 
$cŞÜIdxFg
 = 0x16;

4025 
$cŞÜIdxFg
 = 0x17;

4028 
$cŞÜIdxFg
 = 0x18;

4031 
$cŞÜIdxFg
 = 0x19;

4034 
$cŞÜIdxFg
 = 0x1A;

4037 
$cŞÜIdxFg
 = 0x1B;

4040 
$cŞÜIdxFg
 = 0x1C;

4043 
$cŞÜIdxFg
 = 0x1D;

4046 
$cŞÜIdxFg
 = 0x1E;

4049 
$cŞÜIdxFg
 = 0x1F;

4052 
$cŞÜIdxFg
 = 0x20;

4055 
$cŞÜIdxFg
 = 0x21;

4058 
$cŞÜIdxFg
 = 0x22;

4061 
$cŞÜIdxFg
 = 0x23;

4064 
$cŞÜIdxFg
 = 0x24;

4067 
$cŞÜIdxFg
 = 0x25;

4070 
$cŞÜIdxFg
 = 0x26;

4073 
$cŞÜIdxFg
 = 0x27;

4076 
$cŞÜIdxFg
 = 0x28;

4079 
$cŞÜIdxFg
 = 0x29;

4082 
$cŞÜIdxFg
 = 0x2A;

4085 
$cŞÜIdxFg
 = 0x2B;

4088 
$cŞÜIdxFg
 = 0x2C;

4091 
$cŞÜIdxFg
 = 0x2D;

4094 
$cŞÜIdxFg
 = 0x2E;

4097 
$cŞÜIdxFg
 = 0x2F;

4100 
$cŞÜIdxFg
 = 0x30;

4103 
$cŞÜIdxFg
 = 0x31;

4106 
$cŞÜIdxFg
 = 0x32;

4109 
$cŞÜIdxFg
 = 0x33;

4112 
$cŞÜIdxFg
 = 0x34;

4115 
$cŞÜIdxFg
 = 0x35;

4118 
$cŞÜIdxFg
 = 0x36;

4121 
$cŞÜIdxFg
 = 0x37;

4124 
$cŞÜIdxFg
 = 0x38;

4127 
$cŞÜIdxFg
 = 0x39;

4130 
$cŞÜIdxFg
 = 0x3A;

4133 
$cŞÜIdxFg
 = 0x3B;

4136 
$cŞÜIdxFg
 = 0x3C;

4139 
$cŞÜIdxFg
 = 0x3D;

4142 
$cŞÜIdxFg
 = 0x3E;

4145 
$cŞÜIdxFg
 = 0x3F;

4148 
$cŞÜIdxFg
 = 0x40;

4151 
$d©aBlockFl
 = 
	`·ck
('v', 
$blockFlP©‹ºStyË
);

4152 
$d©aBlockFl
 .ğ
	`·ck
('v', 
$cŞÜIdxFg
 | (
$cŞÜIdxBg
 << 7));

4154 ià(
$bFÜm©PrÙ
 == 1) {

4155 
$d©aBlockPrÙeùiÚ
 = 0;

4156 ià(
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
(è=ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
) {

4157 
$d©aBlockPrÙeùiÚ
 = 1;

4159 ià(
$cÚd™iÚ®
->
	`g‘StyË
()->
	`g‘PrÙeùiÚ
()->
	`g‘Hidd’
(è=ğ
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
) {

4160 
$d©aBlockPrÙeùiÚ
 = 1 << 1;

4164 
$d©a
 = 
	`·ck
('CCvvVv', 
$ty³
, 
$İ”©ÜTy³
, 
$szV®ue1
, 
$szV®ue2
, 
$æags
, 0x0000);

4165 ià(
$bFÜm©FÚt
 == 1) {

4166 
$d©a
 .ğ
$d©aBlockFÚt
;

4168 ià(
$bFÜm©Align
 == 1) {

4169 
$d©a
 .ğ
$d©aBlockAlign
;

4171 ià(
$bFÜm©BÜd”
 == 1) {

4172 
$d©a
 .ğ
$d©aBlockBÜd”
;

4174 ià(
$bFÜm©Fl
 == 1) {

4175 
$d©a
 .ğ
$d©aBlockFl
;

4177 ià(
$bFÜm©PrÙ
 == 1) {

4178 
$d©a
 .ğ
$d©aBlockPrÙeùiÚ
;

4180 ià(!
	`is_nuÎ
(
$İ”ªd1
)) {

4181 
$d©a
 .ğ
$İ”ªd1
;

4183 ià(!
	`is_nuÎ
(
$İ”ªd2
)) {

4184 
$d©a
 .ğ
$İ”ªd2
;

4186 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
	`¡¾’
(
$d©a
));

4187 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

4188 
	}
}

4193 
´iv©e
 
funùiÚ
 
	$wr™eCFH—d”
()

4195 
$»cÜd
 = 0x01B0;

4196 
$Ëngth
 = 0x0016;

4198 
$numCŞumnMš
 = 
nuÎ
;

4199 
$numCŞumnMax
 = 
nuÎ
;

4200 
$numRowMš
 = 
nuÎ
;

4201 
$numRowMax
 = 
nuÎ
;

4202 
$¬rCÚd™iÚ®
 = 
	`¬¿y
();

4203 
	`fÜ—ch
 (
$this
->
phpSh“t
->
	`g‘CÚd™iÚ®StyËsCŞËùiÚ
(è
as
 
$ûÎCoÜdš©e
 => 
$cÚd™iÚ®StyËs
) {

4204 
	`fÜ—ch
 (
$cÚd™iÚ®StyËs
 
as
 
$cÚd™iÚ®
) {

4205 ià(
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_EXPRESSION


4206 || 
$cÚd™iÚ®
->
	`g‘CÚd™iÚTy³
(è=ğ
PHPExûl_StyË_CÚd™iÚ®
::
CONDITION_CELLIS
) {

4207 ià(!
	`š_¬¿y
(
$cÚd™iÚ®
->
	`g‘HashCode
(), 
$¬rCÚd™iÚ®
)) {

4208 
$¬rCÚd™iÚ®
[] = 
$cÚd™iÚ®
->
	`g‘HashCode
();

4211 
$¬rCoÜd
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$ûÎCoÜdš©e
);

4212 ià(!
	`is_num”ic
(
$¬rCoÜd
[0])) {

4213 
$¬rCoÜd
[0] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($arrCoord[0]);

4215 ià(
	`is_nuÎ
(
$numCŞumnMš
è|| ($numCŞumnMš > 
$¬rCoÜd
[0])) {

4216 
$numCŞumnMš
 = 
$¬rCoÜd
[0];

4218 ià(
	`is_nuÎ
(
$numCŞumnMax
è|| ($numCŞumnMax < 
$¬rCoÜd
[0])) {

4219 
$numCŞumnMax
 = 
$¬rCoÜd
[0];

4221 ià(
	`is_nuÎ
(
$numRowMš
è|| ($numRowMš > 
$¬rCoÜd
[1])) {

4222 
$numRowMš
 = 
$¬rCoÜd
[1];

4224 ià(
	`is_nuÎ
(
$numRowMax
è|| ($numRowMax < 
$¬rCoÜd
[1])) {

4225 
$numRowMax
 = 
$¬rCoÜd
[1];

4230 
$ÃedRed¿w
 = 1;

4231 
$ûÎRªge
 = 
	`·ck
('vvvv', 
$numRowMš
-1, 
$numRowMax
-1, 
$numCŞumnMš
-1, 
$numCŞumnMax
-1);

4233 
$h—d”
 = 
	`·ck
('vv', 
$»cÜd
, 
$Ëngth
);

4234 
$d©a
 = 
	`·ck
('vv', 
	`couÁ
(
$¬rCÚd™iÚ®
), 
$ÃedRed¿w
);

4235 
$d©a
 .ğ
$ûÎRªge
;

4236 
$d©a
 .ğ
	`·ck
('v', 0x0001);

4237 
$d©a
 .ğ
$ûÎRªge
;

4238 
$this
->
	`­³nd
(
$h—d”
 . 
$d©a
);

4239 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Xf.php

1 <?
php


63 şas 
	cPHPExûl_Wr™”_Exûl5_Xf


70 
´iv©e
 
	m$isStyËXf
;

76 
´iv©e
 
	m$fÚtIndex
;

82 
´iv©e
 
	m$numb”FÜm©Index
;

88 
´iv©e
 
	m$‹xtJu¡La¡
;

94 
´iv©e
 
	m$fÜegroundCŞÜ
;

100 
´iv©e
 
	m$backgroundCŞÜ
;

106 
´iv©e
 
	m$bÙtomBÜd”CŞÜ
;

112 
´iv©e
 
	m$tİBÜd”CŞÜ
;

118 
´iv©e
 
	m$ËáBÜd”CŞÜ
;

124 
´iv©e
 
	m$rightBÜd”CŞÜ
;

132 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl_StyË
 
$¡yË
 = 
nuÎ
)

134 
$this
->
isStyËXf
 = 
çl£
;

135 
$this
->
fÚtIndex
 = 0;

137 
$this
->
numb”FÜm©Index
 = 0;

139 
$this
->
‹xtJu¡La¡
 = 0;

141 
$this
->
fÜegroundCŞÜ
 = 0x40;

142 
$this
->
backgroundCŞÜ
 = 0x41;

144 
$this
->
_dŸg
 = 0;

146 
$this
->
bÙtomBÜd”CŞÜ
 = 0x40;

147 
$this
->
tİBÜd”CŞÜ
 = 0x40;

148 
$this
->
ËáBÜd”CŞÜ
 = 0x40;

149 
$this
->
rightBÜd”CŞÜ
 = 0x40;

150 
$this
->
_dŸg_cŞÜ
 = 0x40;

151 
$this
->
_¡yË
 = 
$¡yË
;

161 
public
 
funùiÚ
 
	$wr™eXf
()

164 ià(
$this
->
isStyËXf
) {

165 
$¡yË
 = 0xFFF5;

167 
$¡yË
 = 
£lf
::
	`m­Locked
(
$this
->
_¡yË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
());

168 
$¡yË
 |ğ
£lf
::
	`m­Hidd’
(
$this
->
_¡yË
->
	`g‘PrÙeùiÚ
()->
	`g‘Hidd’
()) << 1;

172 
$©r_num
 = (
$this
->
numb”FÜm©Index
 != 0)?1:0;

173 
$©r_ât
 = (
$this
->
fÚtIndex
 != 0)?1:0;

174 
$©r_®c
 = ((è
$this
->
_¡yË
->
	`g‘Alignm’t
()->
	`g‘W¿pText
()) ? 1 : 0;

175 
$©r_bdr
 = (
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
	`g‘BÜd”StyË
()) ||

176 
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
	`g‘BÜd”StyË
()) ||

177 
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘Leá
()->
	`g‘BÜd”StyË
()) ||

178 
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘Right
()->
	`g‘BÜd”StyË
()))?1:0;

179 
$©r_·t
 = ((
$this
->
fÜegroundCŞÜ
 != 0x40) ||

180 (
$this
->
backgroundCŞÜ
 != 0x41) ||

181 
£lf
::
	`m­FlTy³
(
$this
->
_¡yË
->
	`g‘Fl
()->
	`g‘FlTy³
()))?1:0;

182 
$©r_´Ù
 = 
£lf
::
	`m­Locked
(
$this
->
_¡yË
->
	`g‘PrÙeùiÚ
()->
	`g‘Locked
())

183 | 
£lf
::
	`m­Hidd’
(
$this
->
_¡yË
->
	`g‘PrÙeùiÚ
()->
	`g‘Hidd’
());

186 ià(
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
	`g‘BÜd”StyË
()) == 0) {

187 
$this
->
bÙtomBÜd”CŞÜ
 = 0;

189 ià(
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
	`g‘BÜd”StyË
()) == 0) {

190 
$this
->
tİBÜd”CŞÜ
 = 0;

192 ià(
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘Right
()->
	`g‘BÜd”StyË
()) == 0) {

193 
$this
->
rightBÜd”CŞÜ
 = 0;

195 ià(
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘Leá
()->
	`g‘BÜd”StyË
()) == 0) {

196 
$this
->
ËáBÜd”CŞÜ
 = 0;

198 ià(
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘DŸgÚ®
()->
	`g‘BÜd”StyË
()) == 0) {

199 
$this
->
_dŸg_cŞÜ
 = 0;

202 
$»cÜd
 = 0x00E0;

203 
$Ëngth
 = 0x0014;

205 
$iât
 = 
$this
->
fÚtIndex
;

206 
$ifmt
 = 
$this
->
numb”FÜm©Index
;

208 
$®ign
 = 
$this
->
	`m­HAlign
($this->
_¡yË
->
	`g‘Alignm’t
()->
	`g‘HÜizÚl
());

209 
$®ign
 |ğ(è
$this
->
_¡yË
->
	`g‘Alignm’t
()->
	`g‘W¿pText
() << 3;

210 
$®ign
 |ğ
£lf
::
	`m­VAlign
(
$this
->
_¡yË
->
	`g‘Alignm’t
()->
	`g‘V”tiÿl
()) << 4;

211 
$®ign
 |ğ
$this
->
‹xtJu¡La¡
 << 7;

213 
$u£d_©Œib
 = 
$©r_num
 << 2;

214 
$u£d_©Œib
 |ğ
$©r_ât
 << 3;

215 
$u£d_©Œib
 |ğ
$©r_®c
 << 4;

216 
$u£d_©Œib
 |ğ
$©r_bdr
 << 5;

217 
$u£d_©Œib
 |ğ
$©r_·t
 << 6;

218 
$u£d_©Œib
 |ğ
$©r_´Ù
 << 7;

220 
$icv
 = 
$this
->
fÜegroundCŞÜ
;

221 
$icv
 |ğ
$this
->
backgroundCŞÜ
 << 7;

223 
$bÜd”1
 = 
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘Leá
()->
	`g‘BÜd”StyË
());

224 
$bÜd”1
 |ğ
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘Right
()->
	`g‘BÜd”StyË
()) << 4;

225 
$bÜd”1
 |ğ
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘Tİ
()->
	`g‘BÜd”StyË
()) << 8;

226 
$bÜd”1
 |ğ
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘BÙtom
()->
	`g‘BÜd”StyË
()) << 12;

227 
$bÜd”1
 |ğ
$this
->
ËáBÜd”CŞÜ
 << 16;

228 
$bÜd”1
 |ğ
$this
->
rightBÜd”CŞÜ
 << 23;

230 
$dŸgÚ®DœeùiÚ
 = 
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘DŸgÚ®DœeùiÚ
();

231 
$dŸg__to_rb
 = 
$dŸgÚ®DœeùiÚ
 =ğ
PHPExûl_StyË_BÜd”s
::
DIAGONAL_BOTH


232 || 
$dŸgÚ®DœeùiÚ
 =ğ
PHPExûl_StyË_BÜd”s
::
DIAGONAL_DOWN
;

233 
$dŸg_Œ_to_lb
 = 
$dŸgÚ®DœeùiÚ
 =ğ
PHPExûl_StyË_BÜd”s
::
DIAGONAL_BOTH


234 || 
$dŸgÚ®DœeùiÚ
 =ğ
PHPExûl_StyË_BÜd”s
::
DIAGONAL_UP
;

235 
$bÜd”1
 |ğ
$dŸg__to_rb
 << 30;

236 
$bÜd”1
 |ğ
$dŸg_Œ_to_lb
 << 31;

238 
$bÜd”2
 = 
$this
->
tİBÜd”CŞÜ
;

239 
$bÜd”2
 |ğ
$this
->
bÙtomBÜd”CŞÜ
 << 7;

240 
$bÜd”2
 |ğ
$this
->
_dŸg_cŞÜ
 << 14;

241 
$bÜd”2
 |ğ
£lf
::
	`m­BÜd”StyË
(
$this
->
_¡yË
->
	`g‘BÜd”s
()->
	`g‘DŸgÚ®
()->
	`g‘BÜd”StyË
()) << 21;

242 
$bÜd”2
 |ğ
£lf
::
	`m­FlTy³
(
$this
->
_¡yË
->
	`g‘Fl
()->
	`g‘FlTy³
()) << 26;

244 
$h—d”
 = 
	`·ck
("vv", 
$»cÜd
, 
$Ëngth
);

247 
$biff8_İtiÚs
 = 
$this
->
_¡yË
->
	`g‘Alignm’t
()->
	`g‘Ind’t
();

248 
$biff8_İtiÚs
 |ğ(è
$this
->
_¡yË
->
	`g‘Alignm’t
()->
	`g‘ShrškToF™
() << 4;

250 
$d©a
 = 
	`·ck
("vvvC", 
$iât
, 
$ifmt
, 
$¡yË
, 
$®ign
);

251 
$d©a
 .ğ
	`·ck
("CCC", 
£lf
::
	`m­TextRÙ©iÚ
(
$this
->
_¡yË
->
	`g‘Alignm’t
()->
	`g‘TextRÙ©iÚ
()), 
$biff8_İtiÚs
, 
$u£d_©Œib
);

252 
$d©a
 .ğ
	`·ck
("VVv", 
$bÜd”1
, 
$bÜd”2
, 
$icv
);

254 (
$h—d”
 . 
$d©a
);

255 
	}
}

262 
public
 
funùiÚ
 
	$£tIsStyËXf
(
$v®ue
)

264 
$this
->
isStyËXf
 = 
$v®ue
;

265 
	}
}

273 
public
 
funùiÚ
 
	$£tBÙtomCŞÜ
(
$cŞÜIndex
)

275 
$this
->
bÙtomBÜd”CŞÜ
 = 
$cŞÜIndex
;

276 
	}
}

284 
public
 
funùiÚ
 
	$£tTİCŞÜ
(
$cŞÜIndex
)

286 
$this
->
tİBÜd”CŞÜ
 = 
$cŞÜIndex
;

287 
	}
}

295 
public
 
funùiÚ
 
	$£tLeáCŞÜ
(
$cŞÜIndex
)

297 
$this
->
ËáBÜd”CŞÜ
 = 
$cŞÜIndex
;

298 
	}
}

306 
public
 
funùiÚ
 
	$£tRightCŞÜ
(
$cŞÜIndex
)

308 
$this
->
rightBÜd”CŞÜ
 = 
$cŞÜIndex
;

309 
	}
}

317 
public
 
funùiÚ
 
	$£tDŸgCŞÜ
(
$cŞÜIndex
)

319 
$this
->
_dŸg_cŞÜ
 = 
$cŞÜIndex
;

320 
	}
}

329 
public
 
funùiÚ
 
	$£tFgCŞÜ
(
$cŞÜIndex
)

331 
$this
->
fÜegroundCŞÜ
 = 
$cŞÜIndex
;

332 
	}
}

340 
public
 
funùiÚ
 
	$£tBgCŞÜ
(
$cŞÜIndex
)

342 
$this
->
backgroundCŞÜ
 = 
$cŞÜIndex
;

343 
	}
}

352 
public
 
funùiÚ
 
	$£tNumb”FÜm©Index
(
$numb”FÜm©Index
)

354 
$this
->
numb”FÜm©Index
 = 
$numb”FÜm©Index
;

355 
	}
}

362 
public
 
funùiÚ
 
	$£tFÚtIndex
(
$v®ue
)

364 
$this
->
fÚtIndex
 = 
$v®ue
;

365 
	}
}

372 
´iv©e
 
	g$m­BÜd”StyËs
 = 
¬¿y
(

373 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
 => 0x00,

374 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
 => 0x01,

375 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
 => 0x02,

376 
PHPExûl_StyË_BÜd”
::
BORDER_DASHED
 => 0x03,

377 
PHPExûl_StyË_BÜd”
::
BORDER_DOTTED
 => 0x04,

378 
PHPExûl_StyË_BÜd”
::
BORDER_THICK
 => 0x05,

379 
PHPExûl_StyË_BÜd”
::
BORDER_DOUBLE
 => 0x06,

380 
PHPExûl_StyË_BÜd”
::
BORDER_HAIR
 => 0x07,

381 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHED
 => 0x08,

382 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOT
 => 0x09,

383 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOT
 => 0x0A,

384 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOTDOT
 => 0x0B,

385 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOTDOT
 => 0x0C,

386 
PHPExûl_StyË_BÜd”
::
BORDER_SLANTDASHDOT
 => 0x0D,

395 
´iv©e
 
funùiÚ
 
	$m­BÜd”StyË
(
$bÜd”StyË
)

397 ià(
	`is£t
(
£lf
::
$m­BÜd”StyËs
[
$bÜd”StyË
])) {

398  
£lf
::
$m­BÜd”StyËs
[
$bÜd”StyË
];

401 
	}
}

408 
´iv©e
 
	g$m­FlTy³s
 = 
¬¿y
(

409 
PHPExûl_StyË_Fl
::
FILL_NONE
 => 0x00,

410 
PHPExûl_StyË_Fl
::
FILL_SOLID
 => 0x01,

411 
PHPExûl_StyË_Fl
::
FILL_PATTERN_MEDIUMGRAY
 => 0x02,

412 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKGRAY
 => 0x03,

413 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTGRAY
 => 0x04,

414 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKHORIZONTAL
 => 0x05,

415 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKVERTICAL
 => 0x06,

416 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKDOWN
 => 0x07,

417 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKUP
 => 0x08,

418 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKGRID
 => 0x09,

419 
PHPExûl_StyË_Fl
::
FILL_PATTERN_DARKTRELLIS
 => 0x0A,

420 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTHORIZONTAL
 => 0x0B,

421 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTVERTICAL
 => 0x0C,

422 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTDOWN
 => 0x0D,

423 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTUP
 => 0x0E,

424 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTGRID
 => 0x0F,

425 
PHPExûl_StyË_Fl
::
FILL_PATTERN_LIGHTTRELLIS
 => 0x10,

426 
PHPExûl_StyË_Fl
::
FILL_PATTERN_GRAY125
 => 0x11,

427 
PHPExûl_StyË_Fl
::
FILL_PATTERN_GRAY0625
 => 0x12,

428 
PHPExûl_StyË_Fl
::
FILL_GRADIENT_LINEAR
 => 0x00,

429 
PHPExûl_StyË_Fl
::
FILL_GRADIENT_PATH
 => 0x00,

438 
´iv©e
 
funùiÚ
 
	$m­FlTy³
(
$flTy³
)

440 ià(
	`is£t
(
£lf
::
$m­FlTy³s
[
$flTy³
])) {

441  
£lf
::
$m­FlTy³s
[
$flTy³
];

444 
	}
}

451 
´iv©e
 
	g$m­HAlignm’ts
 = 
¬¿y
(

452 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
 => 0,

453 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_LEFT
 => 1,

454 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER
 => 2,

455 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_RIGHT
 => 3,

456 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_FILL
 => 4,

457 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_JUSTIFY
 => 5,

458 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER_CONTINUOUS
 => 6,

467 
´iv©e
 
funùiÚ
 
	$m­HAlign
(
$hAlign
)

469 ià(
	`is£t
(
£lf
::
$m­HAlignm’ts
[
$hAlign
])) {

470  
£lf
::
$m­HAlignm’ts
[
$hAlign
];

473 
	}
}

480 
´iv©e
 
	g$m­VAlignm’ts
 = 
¬¿y
(

481 
PHPExûl_StyË_Alignm’t
::
VERTICAL_TOP
 => 0,

482 
PHPExûl_StyË_Alignm’t
::
VERTICAL_CENTER
 => 1,

483 
PHPExûl_StyË_Alignm’t
::
VERTICAL_BOTTOM
 => 2,

484 
PHPExûl_StyË_Alignm’t
::
VERTICAL_JUSTIFY
 => 3,

493 
´iv©e
 
funùiÚ
 
	$m­VAlign
(
$vAlign
)

495 ià(
	`is£t
(
£lf
::
$m­VAlignm’ts
[
$vAlign
])) {

496  
£lf
::
$m­VAlignm’ts
[
$vAlign
];

499 
	}
}

507 
´iv©e
 
funùiÚ
 
	$m­TextRÙ©iÚ
(
$‹xtRÙ©iÚ
)

509 ià(
$‹xtRÙ©iÚ
 >= 0) {

510  
$‹xtRÙ©iÚ
;

511 } 
	`–£if
 (
$‹xtRÙ©iÚ
 == -165) {

513 } 
	`–£if
 (
$‹xtRÙ©iÚ
 < 0) {

514  90 - 
$‹xtRÙ©iÚ
;

516 
	}
}

524 
´iv©e
 
funùiÚ
 
	$m­Locked
(
$locked
)

526 
$locked
) {

527 
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
:

529 
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
:

531 
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_UNPROTECTED
:

536 
	}
}

544 
´iv©e
 
funùiÚ
 
	$m­Hidd’
(
$hidd’
)

546 
$hidd’
) {

547 
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_INHERIT
:

549 
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_PROTECTED
:

551 
PHPExûl_StyË_PrÙeùiÚ
::
PROTECTION_UNPROTECTED
:

556 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Exception.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_Exû±iÚ
 
ex‹nds
 
	mPHPExûl_Exû±iÚ


39 
public
 
funùiÚ
 
	$”rÜHªdËrC®lback
(
$code
, 
$¡ršg
, 
$fe
, 
$lše
, 
$cÚ‹xt
)

41 
$e
 = 
Ãw
 
	`£lf
(
$¡ršg
, 
$code
);

42 
$e
->
lše
 = 
$lše
;

43 
$e
->
fe
 = 
$fe
;

44 
throw
 
$e
;

46 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/HTML.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_HTML
 
ex‹nds
 
PHPExûl_Wr™”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_Wr™”_IWr™”


35 
´Ùeùed
 
	m$phpExûl
;

42 
´iv©e
 
	m$sh“tIndex
 = 0;

49 
´iv©e
 
	m$imagesRoÙ
 = '.';

56 
´iv©e
 
	m$embedImages
 = 
çl£
;

63 
´iv©e
 
	m$u£IÆšeCss
 = 
çl£
;

70 
´iv©e
 
	m$cssStyËs
;

77 
´iv©e
 
	m$cŞumnWidths
;

84 
´iv©e
 
	m$deçuÉFÚt
;

91 
´iv©e
 
	m$¥ªsA»C®cuÏ‹d
 = 
çl£
;

98 
´iv©e
 
	m$isS·ÂedC–l
 = 
¬¿y
();

105 
´iv©e
 
	m$isBa£C–l
 = 
¬¿y
();

112 
´iv©e
 
	m$isS·ÂedRow
 = 
¬¿y
();

119 
´Ùeùed
 
	m$isPdf
 = 
çl£
;

126 
´iv©e
 
	m$g’”©eSh“tNavig©iÚBlock
 = 
Œue
;

133 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$phpExûl
)

135 
$this
->
phpExûl
 = 
$phpExûl
;

136 
$this
->
deçuÉFÚt
 = $this->
phpExûl
->
	`g‘DeçuÉStyË
()->
	`g‘FÚt
();

145 
public
 
funùiÚ
 
	$§ve
(
$pF’ame
 = 
nuÎ
)

148 
$this
->
phpExûl
->
	`g¬bageCŞËù
();

150 
$§veDebugLog
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
phpExûl
)->
	`g‘DebugLog
()->
	`g‘Wr™eDebugLog
();

151 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
phpExûl
)->
	`g‘DebugLog
()->
	`£tWr™eDebugLog
(
çl£
);

152 
$§veA¼ayR‘uºTy³
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘A¼ayR‘uºTy³
();

153 
PHPExûl_C®cuÏtiÚ
::
	`£tA¼ayR‘uºTy³
(PHPExûl_C®cuÏtiÚ::
RETURN_ARRAY_AS_VALUE
);

156 
$this
->
	`budCSS
(!$this->
u£IÆšeCss
);

159 
$feHªdË
 = 
	`fİ’
(
$pF’ame
, 'wb+');

160 ià(
$feHªdË
 ==ğ
çl£
) {

161 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Could‚ot open file $pFilename for writing.");

165 
	`fwr™e
(
$feHªdË
, 
$this
->
	`g’”©eHTMLH—d”
(!$this->
u£IÆšeCss
));

168 ià((!
$this
->
isPdf
è&& ($this->
g’”©eSh“tNavig©iÚBlock
)) {

169 
	`fwr™e
(
$feHªdË
, 
$this
->
	`g’”©eNavig©iÚ
());

173 
	`fwr™e
(
$feHªdË
, 
$this
->
	`g’”©eSh“tD©a
());

176 
	`fwr™e
(
$feHªdË
, 
$this
->
	`g’”©eHTMLFoÙ”
());

179 
	`fşo£
(
$feHªdË
);

181 
PHPExûl_C®cuÏtiÚ
::
	`£tA¼ayR‘uºTy³
(
$§veA¼ayR‘uºTy³
);

182 
PHPExûl_C®cuÏtiÚ
::
	`g‘In¡ªû
(
$this
->
phpExûl
)->
	`g‘DebugLog
()->
	`£tWr™eDebugLog
(
$§veDebugLog
);

183 
	}
}

191 
´iv©e
 
funùiÚ
 
	$m­VAlign
(
$vAlign
)

193 
$vAlign
) {

194 
PHPExûl_StyË_Alignm’t
::
VERTICAL_BOTTOM
:

196 
PHPExûl_StyË_Alignm’t
::
VERTICAL_TOP
:

198 
PHPExûl_StyË_Alignm’t
::
VERTICAL_CENTER
:

199 
PHPExûl_StyË_Alignm’t
::
VERTICAL_JUSTIFY
:

204 
	}
}

212 
´iv©e
 
funùiÚ
 
	$m­HAlign
(
$hAlign
)

214 
$hAlign
) {

215 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL
:

216  
çl£
;

217 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_LEFT
:

219 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_RIGHT
:

221 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER
:

222 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_CENTER_CONTINUOUS
:

224 
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_JUSTIFY
:

227  
çl£
;

229 
	}
}

237 
´iv©e
 
funùiÚ
 
	$m­BÜd”StyË
(
$bÜd”StyË
)

239 
$bÜd”StyË
) {

240 
PHPExûl_StyË_BÜd”
::
BORDER_NONE
:

242 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOT
:

244 
PHPExûl_StyË_BÜd”
::
BORDER_DASHDOTDOT
:

246 
PHPExûl_StyË_BÜd”
::
BORDER_DASHED
:

248 
PHPExûl_StyË_BÜd”
::
BORDER_DOTTED
:

250 
PHPExûl_StyË_BÜd”
::
BORDER_DOUBLE
:

252 
PHPExûl_StyË_BÜd”
::
BORDER_HAIR
:

254 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUM
:

256 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOT
:

258 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHDOTDOT
:

260 
PHPExûl_StyË_BÜd”
::
BORDER_MEDIUMDASHED
:

262 
PHPExûl_StyË_BÜd”
::
BORDER_SLANTDASHDOT
:

264 
PHPExûl_StyË_BÜd”
::
BORDER_THICK
:

266 
PHPExûl_StyË_BÜd”
::
BORDER_THIN
:

272 
	}
}

279 
public
 
funùiÚ
 
	$g‘Sh“tIndex
()

281  
$this
->
sh“tIndex
;

282 
	}
}

290 
public
 
funùiÚ
 
	$£tSh“tIndex
(
$pV®ue
 = 0)

292 
$this
->
sh“tIndex
 = 
$pV®ue
;

293  
$this
;

294 
	}
}

301 
public
 
funùiÚ
 
	$g‘G’”©eSh“tNavig©iÚBlock
()

303  
$this
->
g’”©eSh“tNavig©iÚBlock
;

304 
	}
}

312 
public
 
funùiÚ
 
	$£tG’”©eSh“tNavig©iÚBlock
(
$pV®ue
 = 
Œue
)

314 
$this
->
g’”©eSh“tNavig©iÚBlock
 = (
boŞ
è
$pV®ue
;

315  
$this
;

316 
	}
}

321 
public
 
funùiÚ
 
	$wr™eAÎSh“ts
()

323 
$this
->
sh“tIndex
 = 
nuÎ
;

324  
$this
;

325 
	}
}

334 
public
 
funùiÚ
 
	$g’”©eHTMLH—d”
(
$pInşudeStyËs
 = 
çl£
)

337 ià(
	`is_nuÎ
(
$this
->
phpExûl
)) {

338 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('Internal PHPExcel object‚ot seto‡n instance of‡n object.');

342 
$´İ”t›s
 = 
$this
->
phpExûl
->
	`g‘Prİ”t›s
();

343 
$html
 = '<!DOCTYPE htmÈPUBLIC "-//W3C//DTD HTML 4.01//EN" "h‰p://www.w3.Üg/TR/html4/¡riù.dtd">' . 
PHP_EOL
;

344 
$html
 .ğ'<!-- G’”©ed by PHPExûÈ- h‰p://www.ph³xûl.Ãˆ-->' . 
PHP_EOL
;

345 
$html
 .ğ'<html>' . 
PHP_EOL
;

346 
$html
 .ğ' <h—d>' . 
PHP_EOL
;

347 
$html
 .ğ' <m‘¨h‰p-equiv="CÚ‹Á-Ty³" cÚ‹Á="‹xt/html; ch¬£t=utf-8">' . 
PHP_EOL
;

348 ià(
$´İ”t›s
->
	`g‘T™Ë
() > '') {

349 
$html
 .ğ' <t™Ë>' . 
	`html¥ecŸlch¬s
(
$´İ”t›s
->
	`g‘T™Ë
()è. '</t™Ë>' . 
PHP_EOL
;

351 ià(
$´İ”t›s
->
	`g‘C»©Ü
() > '') {

352 
$html
 .ğ' <m‘¨Çme="authÜ" cÚ‹Á="' . 
	`html¥ecŸlch¬s
(
$´İ”t›s
->
	`g‘C»©Ü
()è. '" />' . 
PHP_EOL
;

354 ià(
$´İ”t›s
->
	`g‘T™Ë
() > '') {

355 
$html
 .ğ' <m‘¨Çme="t™Ë" cÚ‹Á="' . 
	`html¥ecŸlch¬s
(
$´İ”t›s
->
	`g‘T™Ë
()è. '" />' . 
PHP_EOL
;

357 ià(
$´İ”t›s
->
	`g‘DesütiÚ
() > '') {

358 
$html
 .ğ' <m‘¨Çme="desütiÚ" cÚ‹Á="' . 
	`html¥ecŸlch¬s
(
$´İ”t›s
->
	`g‘DesütiÚ
()è. '" />' . 
PHP_EOL
;

360 ià(
$´İ”t›s
->
	`g‘Subjeù
() > '') {

361 
$html
 .ğ' <m‘¨Çme="subjeù" cÚ‹Á="' . 
	`html¥ecŸlch¬s
(
$´İ”t›s
->
	`g‘Subjeù
()è. '" />' . 
PHP_EOL
;

363 ià(
$´İ”t›s
->
	`g‘KeywÜds
() > '') {

364 
$html
 .ğ' <m‘¨Çme="keywÜds" cÚ‹Á="' . 
	`html¥ecŸlch¬s
(
$´İ”t›s
->
	`g‘KeywÜds
()è. '" />' . 
PHP_EOL
;

366 ià(
$´İ”t›s
->
	`g‘C©egÜy
() > '') {

367 
$html
 .ğ' <m‘¨Çme="ÿ‹gÜy" cÚ‹Á="' . 
	`html¥ecŸlch¬s
(
$´İ”t›s
->
	`g‘C©egÜy
()è. '" />' . 
PHP_EOL
;

369 ià(
$´İ”t›s
->
	`g‘Com·ny
() > '') {

370 
$html
 .ğ' <m‘¨Çme="com·ny" cÚ‹Á="' . 
	`html¥ecŸlch¬s
(
$´İ”t›s
->
	`g‘Com·ny
()è. '" />' . 
PHP_EOL
;

372 ià(
$´İ”t›s
->
	`g‘Mªag”
() > '') {

373 
$html
 .ğ' <m‘¨Çme="mªag”" cÚ‹Á="' . 
	`html¥ecŸlch¬s
(
$´İ”t›s
->
	`g‘Mªag”
()è. '" />' . 
PHP_EOL
;

376 ià(
$pInşudeStyËs
) {

377 
$html
 .ğ
$this
->
	`g’”©eStyËs
(
Œue
);

380 
$html
 .ğ' </h—d>' . 
PHP_EOL
;

381 
$html
 .ğ'' . 
PHP_EOL
;

382 
$html
 .ğ' <body>' . 
PHP_EOL
;

384  
$html
;

385 
	}
}

393 
public
 
funùiÚ
 
	$g’”©eSh“tD©a
()

396 ià(
	`is_nuÎ
(
$this
->
phpExûl
)) {

397 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('Internal PHPExcel object‚ot seto‡n instance of‡n object.');

401 ià(!
$this
->
¥ªsA»C®cuÏ‹d
) {

402 
$this
->
	`ÿlcuÏ‹S·ns
();

406 
$sh“ts
 = 
	`¬¿y
();

407 ià(
	`is_nuÎ
(
$this
->
sh“tIndex
)) {

408 
$sh“ts
 = 
$this
->
phpExûl
->
	`g‘AÎSh“ts
();

410 
$sh“ts
[] = 
$this
->
phpExûl
->
	`g‘Sh“t
($this->
sh“tIndex
);

414 
$html
 = '';

417 
$sh“tId
 = 0;

418 
	`fÜ—ch
 (
$sh“ts
 
as
 
$sh“t
) {

420 
$html
 .ğ
$this
->
	`g’”©eTabËH—d”
(
$sh“t
);

423 
$dim’siÚ
 = 
	`ex¶ode
(':', 
$sh“t
->
	`ÿlcuÏ‹WÜksh“tDim’siÚ
());

424 
$dim’siÚ
[0] = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
($dimension[0]);

425 
$dim’siÚ
[0][0] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($dimension[0][0]) - 1;

426 
$dim’siÚ
[1] = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
($dimension[1]);

427 
$dim’siÚ
[1][0] = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($dimension[1][0]) - 1;

430 
$rowMš
 = 
$dim’siÚ
[0][1];

431 
$rowMax
 = 
$dim’siÚ
[1][1];

434 
$tbodyS¹
 = 
$rowMš
;

435 
$th—dS¹
 = 
$th—dEnd
 = 0;

436 ià(
$sh“t
->
	`g‘PageS‘up
()->
	`isRowsToR•—tAtTİS‘
()) {

437 
$rowsToR•—tAtTİ
 = 
$sh“t
->
	`g‘PageS‘up
()->
	`g‘RowsToR•—tAtTİ
();

440 ià(
$rowsToR•—tAtTİ
[0] == 1) {

441 
$th—dS¹
 = 
$rowsToR•—tAtTİ
[0];

442 
$th—dEnd
 = 
$rowsToR•—tAtTİ
[1];

443 
$tbodyS¹
 = 
$rowsToR•—tAtTİ
[1] + 1;

448 
$row
 = 
$rowMš
-1;

449 
$row
++ < 
$rowMax
) {

451 ià(
$row
 =ğ
$th—dS¹
) {

452 
$html
 .ğ' <th—d>' . 
PHP_EOL
;

453 
$ûÎTy³
 = 'th';

457 ià(
$row
 =ğ
$tbodyS¹
) {

458 
$html
 .ğ' <tbody>' . 
PHP_EOL
;

459 
$ûÎTy³
 = 'td';

463 ià(!
	`is£t
(
$this
->
isS·ÂedRow
[
$sh“t
->
	`g‘P¬’t
()->
	`g‘Index
($sh“t)][
$row
])) {

465 
$rowD©a
 = 
	`¬¿y
();

467 
$cŞumn
 = 
$dim’siÚ
[0][0] - 1;

468 
$cŞumn
++ < 
$dim’siÚ
[1][0]) {

470 ià(
$sh“t
->
	`ûÎExi¡sByCŞumnAndRow
(
$cŞumn
, 
$row
)) {

471 
$rowD©a
[
$cŞumn
] = 
PHPExûl_C–l
::
	`¡ršgFromCŞumnIndex
($cŞumnè. 
$row
;

473 
$rowD©a
[
$cŞumn
] = '';

476 
$html
 .ğ
$this
->
	`g’”©eRow
(
$sh“t
, 
$rowD©a
, 
$row
 - 1, 
$ûÎTy³
);

480 ià(
$row
 =ğ
$th—dEnd
) {

481 
$html
 .ğ' </th—d>' . 
PHP_EOL
;

484 
$html
 .ğ
$this
->
	`ex‹ndRowsFÜCh¬tsAndImages
(
$sh“t
, 
$row
);

487 
$html
 .ğ' </tbody>' . 
PHP_EOL
;

490 
$html
 .ğ
$this
->
	`g’”©eTabËFoÙ”
();

493 ià(
$this
->
isPdf
) {

494 ià(
	`is_nuÎ
(
$this
->
sh“tIndex
è&& 
$sh“tId
 + 1 < $this->
phpExûl
->
	`g‘Sh“tCouÁ
()) {

495 
$html
 .= '<div style="page-break-before:always" />';

500 ++
$sh“tId
;

503  
$html
;

504 
	}
}

512 
public
 
funùiÚ
 
	$g’”©eNavig©iÚ
()

515 ià(
	`is_nuÎ
(
$this
->
phpExûl
)) {

516 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('Internal PHPExcel object‚ot seto‡n instance of‡n object.');

520 
$sh“ts
 = 
	`¬¿y
();

521 ià(
	`is_nuÎ
(
$this
->
sh“tIndex
)) {

522 
$sh“ts
 = 
$this
->
phpExûl
->
	`g‘AÎSh“ts
();

524 
$sh“ts
[] = 
$this
->
phpExûl
->
	`g‘Sh“t
($this->
sh“tIndex
);

528 
$html
 = '';

531 ià(
	`couÁ
(
$sh“ts
) > 1) {

533 
$sh“tId
 = 0;

535 
$html
 .ğ'<uÈşass="Çvig©iÚ">' . 
PHP_EOL
;

537 
	`fÜ—ch
 (
$sh“ts
 
as
 
$sh“t
) {

538 
$html
 .ğ' <l˜şass="sh“t' . 
$sh“tId
 . '"><¨h»f="#sh“t' . $sh“tId . '">' . 
$sh“t
->
	`g‘T™Ë
(è. '</a></li>' . 
PHP_EOL
;

539 ++
$sh“tId
;

542 
$html
 .ğ'</ul>' . 
PHP_EOL
;

545  
$html
;

546 
	}
}

548 
´iv©e
 
funùiÚ
 
	$ex‹ndRowsFÜCh¬tsAndImages
(
PHPExûl_WÜksh“t
 
$pSh“t
, 
$row
)

550 
$rowMax
 = 
$row
;

551 
$cŞMax
 = 'A';

552 ià(
$this
->
šşudeCh¬ts
) {

553 
	`fÜ—ch
 (
$pSh“t
->
	`g‘Ch¬tCŞËùiÚ
(è
as
 
$ch¬t
) {

554 ià(
$ch¬t
 
š¡ªûof
 
PHPExûl_Ch¬t
) {

555 
$ch¬tCoÜdš©es
 = 
$ch¬t
->
	`g‘TİLeáPos™iÚ
();

556 
$ch¬tTL
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$ch¬tCoÜdš©es
['cell']);

557 
$ch¬tCŞ
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$ch¬tTL
[0]);

558 ià(
$ch¬tTL
[1] > 
$rowMax
) {

559 
$rowMax
 = 
$ch¬tTL
[1];

560 ià(
$ch¬tCŞ
 > 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞMax
)) {

561 
$cŞMax
 = 
$ch¬tTL
[0];

568 
	`fÜ—ch
 (
$pSh“t
->
	`g‘D¿wšgCŞËùiÚ
(è
as
 
$d¿wšg
) {

569 ià(
$d¿wšg
 
š¡ªûof
 
PHPExûl_WÜksh“t_D¿wšg
) {

570 
$imageTL
 = 
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$d¿wšg
->
	`g‘CoÜdš©es
());

571 
$imageCŞ
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$imageTL
[0]);

572 ià(
$imageTL
[1] > 
$rowMax
) {

573 
$rowMax
 = 
$imageTL
[1];

574 ià(
$imageCŞ
 > 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞMax
)) {

575 
$cŞMax
 = 
$imageTL
[0];

581 
$html
 = '';

582 
$cŞMax
++;

583 
$row
 <ğ
$rowMax
) {

584 
$html
 .= '<tr>';

585 
$cŞ
 = 'A'; $cŞ !ğ
$cŞMax
; ++$col) {

586 
$html
 .= '<td>';

587 
$html
 .ğ
$this
->
	`wr™eImageInC–l
(
$pSh“t
, 
$cŞ
.
$row
);

588 ià(
$this
->
šşudeCh¬ts
) {

589 
$html
 .ğ
$this
->
	`wr™eCh¬tInC–l
(
$pSh“t
, 
$cŞ
.
$row
);

591 
$html
 .= '</td>';

593 ++
$row
;

594 
$html
 .= '</tr>';

596  
$html
;

597 
	}
}

608 
´iv©e
 
funùiÚ
 
	$wr™eImageInC–l
(
PHPExûl_WÜksh“t
 
$pSh“t
, 
$coÜdš©es
)

611 
$html
 = '';

614 
	`fÜ—ch
 (
$pSh“t
->
	`g‘D¿wšgCŞËùiÚ
(è
as
 
$d¿wšg
) {

615 ià(
$d¿wšg
 
š¡ªûof
 
PHPExûl_WÜksh“t_D¿wšg
) {

616 ià(
$d¿wšg
->
	`g‘CoÜdš©es
(è=ğ
$coÜdš©es
) {

617 
$f’ame
 = 
$d¿wšg
->
	`g‘P©h
();

620 ià(
	`sub¡r
(
$f’ame
, 0, 1) == '.') {

621 
$f’ame
 = 
	`sub¡r
($filename, 1);

625 
$f’ame
 = 
$this
->
	`g‘ImagesRoÙ
() . $filename;

628 ià(
	`sub¡r
(
$f’ame
, 0, 1) == '.' && substr($filename, 0, 2) != './') {

629 
$f’ame
 = 
	`sub¡r
($filename, 1);

633 
$f’ame
 = 
	`html¥ecŸlch¬s
($filename);

635 
$html
 .ğ
PHP_EOL
;

636 ià((!
$this
->
embedImages
è|| ($this->
isPdf
)) {

637 
$imageD©a
 = 
$f’ame
;

639 
$imageD‘as
 = 
	`g‘imagesize
(
$f’ame
);

640 ià(
$å
 = 
	`fİ’
(
$f’ame
, "rb", 0)) {

641 
$piùu»
 = 
	`ä—d
(
$å
, 
	`fesize
(
$f’ame
));

642 
	`fşo£
(
$å
);

645 
$ba£64
 = 
	`chunk_¥l™
(
	`ba£64_’code
(
$piùu»
));

646 
$imageD©a
 = 'd©a:'.
$imageD‘as
['mime'].';ba£64,' . 
$ba£64
;

648 
$imageD©a
 = 
$f’ame
;

652 
$html
 .= '<div style="position:„elative;">';

653 
$html
 .= '<img style="position:‡bsolute; z-index: 1;†eft: ' .

654 
$d¿wšg
->
	`g‘Off£tX
(è. 'px;İ: ' . $d¿wšg->
	`g‘Off£tY
() . 'px; width: ' .

655 
$d¿wšg
->
	`g‘Width
(è. 'px; height: ' . $d¿wšg->
	`g‘Height
() . 'px;" src="' .

656 
$imageD©a
 . '" border="0" />';

657 
$html
 .= '</div>';

662  
$html
;

663 
	}
}

673 
´iv©e
 
funùiÚ
 
	$wr™eCh¬tInC–l
(
PHPExûl_WÜksh“t
 
$pSh“t
, 
$coÜdš©es
)

676 
$html
 = '';

679 
	`fÜ—ch
 (
$pSh“t
->
	`g‘Ch¬tCŞËùiÚ
(è
as
 
$ch¬t
) {

680 ià(
$ch¬t
 
š¡ªûof
 
PHPExûl_Ch¬t
) {

681 
$ch¬tCoÜdš©es
 = 
$ch¬t
->
	`g‘TİLeáPos™iÚ
();

682 ià(
$ch¬tCoÜdš©es
['ûÎ'] =ğ
$coÜdš©es
) {

683 
$ch¬tFeName
 = 
PHPExûl_Sh¬ed_Fe
::
	`sys_g‘_‹mp_dœ
().'/'.
	`uniqid
().'.png';

684 ià(!
$ch¬t
->
	`»nd”
(
$ch¬tFeName
)) {

688 
$html
 .ğ
PHP_EOL
;

689 
$imageD‘as
 = 
	`g‘imagesize
(
$ch¬tFeName
);

690 ià(
$å
 = 
	`fİ’
(
$ch¬tFeName
, "rb", 0)) {

691 
$piùu»
 = 
	`ä—d
(
$å
, 
	`fesize
(
$ch¬tFeName
));

692 
	`fşo£
(
$å
);

695 
$ba£64
 = 
	`chunk_¥l™
(
	`ba£64_’code
(
$piùu»
));

696 
$imageD©a
 = 'd©a:'.
$imageD‘as
['mime'].';ba£64,' . 
$ba£64
;

698 
$html
 .= '<div style="position:„elative;">';

699 
$html
 .ğ'<img styË="pos™iÚ:‡bsŞu‹; z-šdex: 1;†eá: ' . 
$ch¬tCoÜdš©es
['xOff£t'] . 'px;İ: ' . $ch¬tCoÜdš©es['yOff£t'] . 'px; width: ' . 
$imageD‘as
[0] . 'px; height: ' . $imageD‘as[1] . 'px;" src="' . 
$imageD©a
 . '" bÜd”="0" />' . 
PHP_EOL
;

700 
$html
 .= '</div>';

702 
	`uÆšk
(
$ch¬tFeName
);

709  
$html
;

710 
	}
}

719 
public
 
funùiÚ
 
	$g’”©eStyËs
(
$g’”©eSu¼oundšgHTML
 = 
Œue
)

722 ià(
	`is_nuÎ
(
$this
->
phpExûl
)) {

723 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('Internal PHPExcel object‚ot seto‡n instance of‡n object.');

727 
$css
 = 
$this
->
	`budCSS
(
$g’”©eSu¼oundšgHTML
);

730 
$html
 = '';

733 ià(
$g’”©eSu¼oundšgHTML
) {

734 
$html
 .ğ' <¡yËy³="‹xt/css">' . 
PHP_EOL
;

735 
$html
 .ğ' htmÈ{ ' . 
$this
->
	`as£mbËCSS
(
$css
['html']è. ' }' . 
PHP_EOL
;

739 
	`fÜ—ch
 (
$css
 
as
 
$¡yËName
 => 
$¡yËDefš™iÚ
) {

740 ià(
$¡yËName
 != 'html') {

741 
$html
 .ğ' ' . 
$¡yËName
 . ' { ' . 
$this
->
	`as£mbËCSS
(
$¡yËDefš™iÚ
è. ' }' . 
PHP_EOL
;

746 ià(
$g’”©eSu¼oundšgHTML
) {

747 
$html
 .ğ' </¡yË>' . 
PHP_EOL
;

751  
$html
;

752 
	}
}

761 
public
 
funùiÚ
 
	$budCSS
(
$g’”©eSu¼oundšgHTML
 = 
Œue
)

764 ià(
	`is_nuÎ
(
$this
->
phpExûl
)) {

765 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('Internal PHPExcel object‚ot seto‡n instance of‡n object.');

769 ià(!
	`is_nuÎ
(
$this
->
cssStyËs
)) {

770  
$this
->
cssStyËs
;

774 ià(!
$this
->
¥ªsA»C®cuÏ‹d
) {

775 
$this
->
	`ÿlcuÏ‹S·ns
();

779 
$css
 = 
	`¬¿y
();

782 ià(
$g’”©eSu¼oundšgHTML
) {

784 
$css
['html']['font-family'] = 'Calibri, Arial, Helvetica, sans-serif';

785 
$css
['html']['font-size'] = '11pt';

786 
$css
['html']['background-color'] = 'white';

791 
$css
['table']['border-collapse'] = 'collapse';

792 ià(!
$this
->
isPdf
) {

793 
$css
['table']['page-break-after'] = 'always';

797 
$css
['.gridlinesd']['border'] = '1px dotted black';

798 
$css
['.gridlinesh']['border'] = '1px dotted black';

801 
$css
['.b']['text-align'] = 'center';

804 
$css
['.e']['text-align'] = 'center';

807 
$css
['.f']['text-align'] = 'right';

810 
$css
['.inlineStr']['text-align'] = 'left';

813 
$css
['.n']['text-align'] = 'right';

816 
$css
['.s']['text-align'] = 'left';

819 
	`fÜ—ch
 (
$this
->
phpExûl
->
	`g‘C–lXfCŞËùiÚ
(è
as
 
$šdex
 => 
$¡yË
) {

820 
$css
['td.¡yË' . 
$šdex
] = 
$this
->
	`ü—‹CSSStyË
(
$¡yË
);

821 
$css
['th.¡yË' . 
$šdex
] = 
$this
->
	`ü—‹CSSStyË
(
$¡yË
);

825 
$sh“ts
 = 
	`¬¿y
();

826 ià(
	`is_nuÎ
(
$this
->
sh“tIndex
)) {

827 
$sh“ts
 = 
$this
->
phpExûl
->
	`g‘AÎSh“ts
();

829 
$sh“ts
[] = 
$this
->
phpExûl
->
	`g‘Sh“t
($this->
sh“tIndex
);

833 
	`fÜ—ch
 (
$sh“ts
 
as
 
$sh“t
) {

835 
$sh“tIndex
 = 
$sh“t
->
	`g‘P¬’t
()->
	`g‘Index
($sheet);

839 
$sh“t
->
	`ÿlcuÏ‹CŞumnWidths
();

842 
$highe¡CŞumnIndex
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$sh“t
->
	`g‘Highe¡CŞumn
()) - 1;

843 
$cŞumn
 = -1;

844 
$cŞumn
++ < 
$highe¡CŞumnIndex
) {

845 
$this
->
cŞumnWidths
[
$sh“tIndex
][
$cŞumn
] = 42;

846 
$css
['bË.sh“t' . 
$sh“tIndex
 . ' cŞ.cŞ' . 
$cŞumn
]['width'] = '42pt';

850 
	`fÜ—ch
 (
$sh“t
->
	`g‘CŞumnDim’siÚs
(è
as
 
$cŞumnDim’siÚ
) {

851 ià((
$width
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`ûÎDim’siÚToPix–s
(
$cŞumnDim’siÚ
->
	`g‘Width
(), 
$this
->
deçuÉFÚt
)) >= 0) {

852 
$width
 = 
PHPExûl_Sh¬ed_D¿wšg
::
	`pix–sToPošts
($width);

853 
$cŞumn
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$cŞumnDim’siÚ
->
	`g‘CŞumnIndex
()) - 1;

854 
$this
->
cŞumnWidths
[
$sh“tIndex
][
$cŞumn
] = 
$width
;

855 
$css
['bË.sh“t' . 
$sh“tIndex
 . ' cŞ.cŞ' . 
$cŞumn
]['width'] = 
$width
 . 'pt';

857 ià(
$cŞumnDim’siÚ
->
	`g‘VisibË
(è==ğ
çl£
) {

858 
$css
['bË.sh“t' . 
$sh“tIndex
 . ' cŞ.cŞ' . 
$cŞumn
]['visibility'] = 'collapse';

859 
$css
['bË.sh“t' . 
$sh“tIndex
 . ' cŞ.cŞ' . 
$cŞumn
]['*display'] = 'none';

865 
$rowDim’siÚ
 = 
$sh“t
->
	`g‘DeçuÉRowDim’siÚ
();

868 
$css
['bË.sh“t' . 
$sh“tIndex
 . 'r'] = 
	`¬¿y
();

870 ià(
$rowDim’siÚ
->
	`g‘RowHeight
() == -1) {

871 
$±_height
 = 
PHPExûl_Sh¬ed_FÚt
::
	`g‘DeçuÉRowHeightByFÚt
(
$this
->
phpExûl
->
	`g‘DeçuÉStyË
()->
	`g‘FÚt
());

873 
$±_height
 = 
$rowDim’siÚ
->
	`g‘RowHeight
();

875 
$css
['bË.sh“t' . 
$sh“tIndex
 . 'r']['height'] = 
$±_height
 . 'pt';

876 ià(
$rowDim’siÚ
->
	`g‘VisibË
(è==ğ
çl£
) {

877 
$css
['bË.sh“t' . 
$sh“tIndex
 . 'r']['display'] = 'none';

878 
$css
['bË.sh“t' . 
$sh“tIndex
 . 'r']['visibility'] = 'hidden';

882 
	`fÜ—ch
 (
$sh“t
->
	`g‘RowDim’siÚs
(è
as
 
$rowDim’siÚ
) {

883 
$row
 = 
$rowDim’siÚ
->
	`g‘RowIndex
() - 1;

886 
$css
['bË.sh“t' . 
$sh“tIndex
 . 'r.row' . 
$row
] = 
	`¬¿y
();

888 ià(
$rowDim’siÚ
->
	`g‘RowHeight
() == -1) {

889 
$±_height
 = 
PHPExûl_Sh¬ed_FÚt
::
	`g‘DeçuÉRowHeightByFÚt
(
$this
->
phpExûl
->
	`g‘DeçuÉStyË
()->
	`g‘FÚt
());

891 
$±_height
 = 
$rowDim’siÚ
->
	`g‘RowHeight
();

893 
$css
['bË.sh“t' . 
$sh“tIndex
 . 'r.row' . 
$row
]['height'] = 
$±_height
 . 'pt';

894 ià(
$rowDim’siÚ
->
	`g‘VisibË
(è==ğ
çl£
) {

895 
$css
['bË.sh“t' . 
$sh“tIndex
 . 'r.row' . 
$row
]['display'] = 'none';

896 
$css
['bË.sh“t' . 
$sh“tIndex
 . 'r.row' . 
$row
]['visibility'] = 'hidden';

902 ià(
	`is_nuÎ
(
$this
->
cssStyËs
)) {

903 
$this
->
cssStyËs
 = 
$css
;

907  
$css
;

908 
	}
}

916 
´iv©e
 
funùiÚ
 
	$ü—‹CSSStyË
(
PHPExûl_StyË
 
$pStyË
)

919 
$css
 = '';

922 
$css
 = 
	`¬¿y_m”ge
(

923 
$this
->
	`ü—‹CSSStyËAlignm’t
(
$pStyË
->
	`g‘Alignm’t
()),

924 
$this
->
	`ü—‹CSSStyËBÜd”s
(
$pStyË
->
	`g‘BÜd”s
()),

925 
$this
->
	`ü—‹CSSStyËFÚt
(
$pStyË
->
	`g‘FÚt
()),

926 
$this
->
	`ü—‹CSSStyËFl
(
$pStyË
->
	`g‘Fl
())

930  
$css
;

931 
	}
}

939 
´iv©e
 
funùiÚ
 
	$ü—‹CSSStyËAlignm’t
(
PHPExûl_StyË_Alignm’t
 
$pStyË
)

942 
$css
 = 
	`¬¿y
();

945 
$css
['v”tiÿl-®ign'] = 
$this
->
	`m­VAlign
(
$pStyË
->
	`g‘V”tiÿl
());

946 ià(
$‹xtAlign
 = 
$this
->
	`m­HAlign
(
$pStyË
->
	`g‘HÜizÚl
())) {

947 
$css
['‹xt-®ign'] = 
$‹xtAlign
;

948 ià(
	`š_¬¿y
(
$‹xtAlign
, 
	`¬¿y
('left', 'right'))) {

949 
$css
['·ddšg-'.
$‹xtAlign
] = (
¡ršg
)(()
$pStyË
->
	`g‘Ind’t
() * 9).'px';

953  
$css
;

954 
	}
}

962 
´iv©e
 
funùiÚ
 
	$ü—‹CSSStyËFÚt
(
PHPExûl_StyË_FÚt
 
$pStyË
)

965 
$css
 = 
	`¬¿y
();

968 ià(
$pStyË
->
	`g‘BŞd
()) {

969 
$css
['font-weight'] = 'bold';

971 ià(
$pStyË
->
	`g‘Und”lše
(è!ğ
PHPExûl_StyË_FÚt
::
UNDERLINE_NONE
 && $pStyË->
	`g‘SŒik‘hrough
()) {

972 
$css
['text-decoration'] = 'underline†ine-through';

973 } 
	`–£if
 (
$pStyË
->
	`g‘Und”lše
(è!ğ
PHPExûl_StyË_FÚt
::
UNDERLINE_NONE
) {

974 
$css
['text-decoration'] = 'underline';

975 } 
	`–£if
 (
$pStyË
->
	`g‘SŒik‘hrough
()) {

976 
$css
['text-decoration'] = 'line-through';

978 ià(
$pStyË
->
	`g‘Ilic
()) {

979 
$css
['font-style'] = 'italic';

982 
$css
['cŞÜ'] = '#' . 
$pStyË
->
	`g‘CŞÜ
()->
	`g‘RGB
();

983 
$css
['fÚt-çmy'] = '\'' . 
$pStyË
->
	`g‘Name
() . '\'';

984 
$css
['fÚt-size'] = 
$pStyË
->
	`g‘Size
() . 'pt';

986  
$css
;

987 
	}
}

995 
´iv©e
 
funùiÚ
 
	$ü—‹CSSStyËBÜd”s
(
PHPExûl_StyË_BÜd”s
 
$pStyË
)

998 
$css
 = 
	`¬¿y
();

1001 
$css
['bÜd”-bÙtom'] = 
$this
->
	`ü—‹CSSStyËBÜd”
(
$pStyË
->
	`g‘BÙtom
());

1002 
$css
['bÜd”-tİ'] = 
$this
->
	`ü—‹CSSStyËBÜd”
(
$pStyË
->
	`g‘Tİ
());

1003 
$css
['bÜd”-Ëá'] = 
$this
->
	`ü—‹CSSStyËBÜd”
(
$pStyË
->
	`g‘Leá
());

1004 
$css
['bÜd”-right'] = 
$this
->
	`ü—‹CSSStyËBÜd”
(
$pStyË
->
	`g‘Right
());

1006  
$css
;

1007 
	}
}

1015 
´iv©e
 
funùiÚ
 
	$ü—‹CSSStyËBÜd”
(
PHPExûl_StyË_BÜd”
 
$pStyË
)

1020 
$bÜd”StyË
 = 
$this
->
	`m­BÜd”StyË
(
$pStyË
->
	`g‘BÜd”StyË
());

1021 
$css
 = 
$bÜd”StyË
 . ' #' . 
$pStyË
->
	`g‘CŞÜ
()->
	`g‘RGB
() . (($borderStyle == 'none') ? '' : ' !important');

1023  
$css
;

1024 
	}
}

1032 
´iv©e
 
funùiÚ
 
	$ü—‹CSSStyËFl
(
PHPExûl_StyË_Fl
 
$pStyË
)

1035 
$css
 = 
	`¬¿y
();

1038 
$v®ue
 = 
$pStyË
->
	`g‘FlTy³
(è=ğ
PHPExûl_StyË_Fl
::
FILL_NONE
 ?

1039 'wh™e' : '#' . 
$pStyË
->
	`g‘S¹CŞÜ
()->
	`g‘RGB
();

1040 
$css
['background-cŞÜ'] = 
$v®ue
;

1042  
$css
;

1043 
	}
}

1048 
public
 
funùiÚ
 
	$g’”©eHTMLFoÙ”
()

1051 
$html
 = '';

1052 
$html
 .ğ' </body>' . 
PHP_EOL
;

1053 
$html
 .ğ'</html>' . 
PHP_EOL
;

1055  
$html
;

1056 
	}
}

1065 
´iv©e
 
funùiÚ
 
	$g’”©eTabËH—d”
(
$pSh“t
)

1067 
$sh“tIndex
 = 
$pSh“t
->
	`g‘P¬’t
()->
	`g‘Index
($pSheet);

1070 
$html
 = '';

1071 
$html
 .ğ
$this
->
	`£tM¬gšs
(
$pSh“t
);

1073 ià(!
$this
->
u£IÆšeCss
) {

1074 
$gridlšes
 = 
$pSh“t
->
	`g‘ShowGridlšes
() ? ' gridlines' : '';

1075 
$html
 .ğ' <bË bÜd”="0" c–Íaddšg="0" c–l¥acšg="0" id="sh“t' . 
$sh“tIndex
 . '" cÏss="sh“t' . $sh“tIndex . 
$gridlšes
 . '">' . 
PHP_EOL
;

1077 
$¡yË
 = 
	`is£t
(
$this
->
cssStyËs
['table']) ?

1078 
$this
->
	`as£mbËCSS
($this->
cssStyËs
['table']) : '';

1080 ià(
$this
->
isPdf
 && 
$pSh“t
->
	`g‘ShowGridlšes
()) {

1081 
$html
 .ğ' <bË bÜd”="1" c–Íaddšg="1" id="sh“t' . 
$sh“tIndex
 . '" c–l¥acšg="1" styË="' . 
$¡yË
 . '">' . 
PHP_EOL
;

1083 
$html
 .ğ' <bË bÜd”="0" c–Íaddšg="1" id="sh“t' . 
$sh“tIndex
 . '" c–l¥acšg="0" styË="' . 
$¡yË
 . '">' . 
PHP_EOL
;

1088 
$highe¡CŞumnIndex
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$pSh“t
->
	`g‘Highe¡CŞumn
()) - 1;

1089 
$i
 = -1;

1090 
$i
++ < 
$highe¡CŞumnIndex
) {

1091 ià(!
$this
->
isPdf
) {

1092 ià(!
$this
->
u£IÆšeCss
) {

1093 
$html
 .ğ' <cŞ cÏss="cŞ' . 
$i
 . '">' . 
PHP_EOL
;

1095 
$¡yË
 = 
	`is£t
(
$this
->
cssStyËs
['bË.sh“t' . 
$sh“tIndex
 . ' cŞ.cŞ' . 
$i
]) ?

1096 
$this
->
	`as£mbËCSS
($this->
cssStyËs
['bË.sh“t' . 
$sh“tIndex
 . ' cŞ.cŞ' . 
$i
]) : '';

1097 
$html
 .ğ' <cŞ styË="' . 
$¡yË
 . '">' . 
PHP_EOL
;

1102  
$html
;

1103 
	}
}

1110 
´iv©e
 
funùiÚ
 
	$g’”©eTabËFoÙ”
()

1112 
$html
 = ' </bË>' . 
PHP_EOL
;

1114  
$html
;

1115 
	}
}

1126 
´iv©e
 
funùiÚ
 
g’”©eRow
(
PHPExûl_WÜksh“t
 
$pSh“t
, 
$pV®ues
 = 
nuÎ
, 
$pRow
 = 0, 
$ûÎTy³
 = 'td')

1128 ià(
is_¬¿y
(
$pV®ues
)) {

1130 
$html
 = '';

1133 
	g$sh“tIndex
 = 
$pSh“t
->
g‘P¬’t
()->
g‘Index
($pSheet);

1136 ià(
	g$this
->
	gisPdf
 && 
couÁ
(
$pSh“t
->
g‘B»aks
()) > 0) {

1137 
	g$b»aks
 = 
$pSh“t
->
g‘B»aks
();

1140 ià(
is£t
(
$b»aks
['A' . 
$pRow
])) {

1142 
	g$html
 .ğ
$this
->
g’”©eTabËFoÙ”
();

1145 
	g$html
 .= '<div style="page-break-before:always" />';

1148 
	g$html
 .ğ
$this
->
g’”©eTabËH—d”
(
$pSh“t
);

1153 ià(!
	g$this
->
	gu£IÆšeCss
) {

1154 
	g$html
 .ğ' <Œ cÏss="row' . 
$pRow
 . '">' . 
PHP_EOL
;

1156 
	g$¡yË
 = 
is£t
(
$this
->
cssStyËs
['bË.sh“t' . 
$sh“tIndex
 . 'r.row' . 
$pRow
])

1157 ? 
$this
->
as£mbËCSS
($this->
cssStyËs
['bË.sh“t' . 
$sh“tIndex
 . 'r.row' . 
$pRow
]) : '';

1159 
	g$html
 .ğ' <Œ styË="' . 
$¡yË
 . '">' . 
PHP_EOL
;

1163 
	g$cŞNum
 = 0;

1164 
fÜ—ch
 (
$pV®ues
 
as
 
$ûÎAdd»ss
) {

1165 
	g$ûÎ
 = (
$ûÎAdd»ss
 > ''è? 
$pSh“t
->
g‘C–l
($cellAddress) : '';

1166 
	g$coÜdš©e
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$cŞNum
è. (
$pRow
 + 1);

1167 ià(!
	g$this
->
	gu£IÆšeCss
) {

1168 
	g$cssCÏss
 = '';

1169 
	g$cssCÏss
 = 'cŞumn' . 
$cŞNum
;

1171 
	g$cssCÏss
 = 
¬¿y
();

1172 ià(
	g$ûÎTy³
 == 'th') {

1173 ià(
is£t
(
$this
->
cssStyËs
['bË.sh“t' . 
$sh“tIndex
 . 'h.cŞumn' . 
$cŞNum
])) {

1174 
$this
->
cssStyËs
['bË.sh“t' . 
$sh“tIndex
 . 'h.cŞumn' . 
$cŞNum
];

1177 ià(
is£t
(
$this
->
cssStyËs
['bË.sh“t' . 
$sh“tIndex
 . 'd.cŞumn' . 
$cŞNum
])) {

1178 
	g$this
->
	gcssStyËs
['bË.sh“t' . 
$sh“tIndex
 . 'd.cŞumn' . 
$cŞNum
];

1182 
	g$cŞS·n
 = 1;

1183 
	g$rowS·n
 = 1;

1186 
	g$ûÎD©a
 = '&nbsp;';

1189 ià(
$ûÎ
 
š¡ªûof
 
	gPHPExûl_C–l
) {

1190 
	g$ûÎD©a
 = '';

1191 ià(
is_nuÎ
(
$ûÎ
->
g‘P¬’t
())) {

1192 
	g$ûÎ
->
©ch
(
$pSh“t
);

1195 ià(
	g$ûÎ
->
g‘V®ue
(è
š¡ªûof
 
	gPHPExûl_RichText
) {

1197 
	g$–em’ts
 = 
$ûÎ
->
g‘V®ue
()->
g‘RichTextEËm’ts
();

1198 
fÜ—ch
 (
$–em’ts
 
as
 
$–em’t
) {

1200 ià(
$–em’t
 
š¡ªûof
 
	gPHPExûl_RichText_Run
) {

1201 
	g$ûÎD©a
 .ğ'<¥ª styË="' . 
$this
->
as£mbËCSS
($this->
ü—‹CSSStyËFÚt
(
$–em’t
->
g‘FÚt
())) . '">';

1203 ià(
	g$–em’t
->
g‘FÚt
()->
g‘Su³rSüt
()) {

1204 
	g$ûÎD©a
 .= '<sup>';

1205 } 
–£if
 (
$–em’t
->
g‘FÚt
()->
g‘SubSüt
()) {

1206 
	g$ûÎD©a
 .= '<sub>';

1211 
	g$ûÎText
 = 
$–em’t
->
g‘Text
();

1212 
	g$ûÎD©a
 .ğ
html¥ecŸlch¬s
(
$ûÎText
);

1214 ià(
$–em’t
 
š¡ªûof
 
	gPHPExûl_RichText_Run
) {

1215 ià(
	g$–em’t
->
g‘FÚt
()->
g‘Su³rSüt
()) {

1216 
	g$ûÎD©a
 .= '</sup>';

1217 } 
–£if
 (
$–em’t
->
g‘FÚt
()->
g‘SubSüt
()) {

1218 
	g$ûÎD©a
 .= '</sub>';

1221 
	g$ûÎD©a
 .= '</span>';

1225 ià(
	g$this
->
	g´eC®cuÏ‹FÜmuÏs
) {

1226 
	g$ûÎD©a
 = 
PHPExûl_StyË_Numb”FÜm©
::
toFÜm©‹dSŒšg
(

1227 
$ûÎ
->
g‘C®cuÏ‹dV®ue
(),

1228 
$pSh“t
->
g‘P¬’t
()->
g‘C–lXfByIndex
(
$ûÎ
->
g‘XfIndex
())->
g‘Numb”FÜm©
()->
g‘FÜm©Code
(),

1229 
¬¿y
(
$this
, 'formatColor')

1232 
	g$ûÎD©a
 = 
PHPExûl_StyË_Numb”FÜm©
::
toFÜm©‹dSŒšg
(

1233 
$ûÎ
->
g‘V®ue
(),

1234 
$pSh“t
->
g‘P¬’t
()->
g‘C–lXfByIndex
(
$ûÎ
->
g‘XfIndex
())->
g‘Numb”FÜm©
()->
g‘FÜm©Code
(),

1235 
¬¿y
(
$this
, 'formatColor')

1238 
	g$ûÎD©a
 = 
html¥ecŸlch¬s
(
$ûÎD©a
);

1239 ià(
	g$pSh“t
->
g‘P¬’t
()->
g‘C–lXfByIndex
(
$ûÎ
->
g‘XfIndex
())->
g‘FÚt
()->
g‘Su³rSüt
()) {

1240 
	g$ûÎD©a
 = '<sup>'.
$ûÎD©a
.'</sup>';

1241 } 
–£if
 (
$pSh“t
->
g‘P¬’t
()->
g‘C–lXfByIndex
(
$ûÎ
->
g‘XfIndex
())->
g‘FÚt
()->
g‘SubSüt
()) {

1242 
	g$ûÎD©a
 = '<sub>'.
$ûÎD©a
.'</sub>';

1248 
	g$ûÎD©a
 = 
´eg_»¶aû
("/(?m)(?:^|\\Gè/", '&nb¥;', 
$ûÎD©a
);

1251 
	g$ûÎD©a
 = 
Æ2br
(
$ûÎD©a
);

1254 ià(!
	g$this
->
	gu£IÆšeCss
) {

1255 
	g$cssCÏss
 .ğ' styË' . 
$ûÎ
->
g‘XfIndex
();

1256 
	g$cssCÏss
 .ğ' ' . 
$ûÎ
->
g‘D©aTy³
();

1258 ià(
	g$ûÎTy³
 == 'th') {

1259 ià(
is£t
(
$this
->
cssStyËs
['th.¡yË' . 
$ûÎ
->
g‘XfIndex
()])) {

1260 
$cssCÏss
 = 
¬¿y_m”ge
($cssCÏss, 
$this
->
cssStyËs
['th.¡yË' . 
$ûÎ
->
g‘XfIndex
()]);

1263 ià(
is£t
(
$this
->
cssStyËs
['td.¡yË' . 
$ûÎ
->
g‘XfIndex
()])) {

1264 
	g$cssCÏss
 = 
¬¿y_m”ge
(
$cssCÏss
, 
$this
->
cssStyËs
['td.¡yË' . 
$ûÎ
->
g‘XfIndex
()]);

1269 
	g$sh¬edStyË
 = 
$pSh“t
->
g‘P¬’t
()->
g‘C–lXfByIndex
(
$ûÎ
->
g‘XfIndex
());

1270 ià(
	g$sh¬edStyË
->
g‘Alignm’t
()->
g‘HÜizÚl
(è=ğ
PHPExûl_StyË_Alignm’t
::
HORIZONTAL_GENERAL


1271 && 
is£t
(
$this
->
cssStyËs
['.' . 
$ûÎ
->
g‘D©aTy³
()]['text-align'])) {

1272 
$cssCÏss
['‹xt-®ign'] = 
$this
->
cssStyËs
['.' . 
$ûÎ
->
g‘D©aTy³
()]['text-align'];

1278 ià(
	g$pSh“t
->
hy³¾škExi¡s
(
$coÜdš©e
è&& !$pSh“t->
g‘Hy³¾šk
($coÜdš©e)->
isIÁ”Çl
()) {

1279 
	g$ûÎD©a
 = '<¨h»f="' . 
html¥ecŸlch¬s
(
$pSh“t
->
g‘Hy³¾šk
(
$coÜdš©e
)->
g‘U¾
()è. '"™Ë="' . html¥ecŸlch¬s($pSh“t->g‘Hy³¾šk($coÜdš©e)->
g‘ToŞt
()è. '">' . 
$ûÎD©a
 . '</a>';

1283 
	g$wr™eC–l
 = !(
is£t
(
$this
->
isS·ÂedC–l
[
$pSh“t
->
g‘P¬’t
()->
g‘Index
($pSh“t)][
$pRow
 + 1][
$cŞNum
])

1284 && 
$this
->
isS·ÂedC–l
[
$pSh“t
->
g‘P¬’t
()->
g‘Index
($pSh“t)][
$pRow
 + 1][
$cŞNum
]);

1287 
	g$cŞ¥ª
 = 1;

1288 
	g$row¥ª
 = 1;

1289 ià(
is£t
(
$this
->
isBa£C–l
[
$pSh“t
->
g‘P¬’t
()->
g‘Index
($pSh“t)][
$pRow
 + 1][
$cŞNum
])) {

1290 
	g$¥ªs
 = 
$this
->
isBa£C–l
[
$pSh“t
->
g‘P¬’t
()->
g‘Index
($pSh“t)][
$pRow
 + 1][
$cŞNum
];

1291 
	g$rowS·n
 = 
$¥ªs
['rowspan'];

1292 
	g$cŞS·n
 = 
$¥ªs
['colspan'];

1296 
	g$’dC–lCoÜd
 = 
PHPExûl_C–l
::
¡ršgFromCŞumnIndex
(
$cŞNum
 + 
$cŞS·n
 - 1è. (
$pRow
 + 
$rowS·n
);

1297 ià(!
	g$this
->
	gu£IÆšeCss
) {

1298 
	g$cssCÏss
 .ğ' styË' . 
$pSh“t
->
g‘C–l
(
$’dC–lCoÜd
)->
g‘XfIndex
();

1303 ià(
	g$wr™eC–l
) {

1305 
	g$html
 .ğ' <' . 
$ûÎTy³
;

1306 ià(!
	g$this
->
	gu£IÆšeCss
) {

1307 
	g$html
 .ğ' cÏss="' . 
$cssCÏss
 . '"';

1312 
	g$width
 = 0;

1313 
	g$i
 = 
$cŞNum
 - 1;

1314 
	g$e
 = 
$cŞNum
 + 
$cŞS·n
 - 1;

1315 
	g$i
++ < 
	g$e
) {

1316 ià(
is£t
(
$this
->
cŞumnWidths
[
$sh“tIndex
][
$i
])) {

1317 
	g$width
 +ğ
$this
->
cŞumnWidths
[
$sh“tIndex
][
$i
];

1320 
	g$cssCÏss
['width'] = 
$width
 . 'pt';

1324 ià(
is£t
(
$this
->
cssStyËs
['bË.sh“t' . 
$sh“tIndex
 . 'r.row' . 
$pRow
]['height'])) {

1325 
	g$height
 = 
$this
->
cssStyËs
['bË.sh“t' . 
$sh“tIndex
 . 'r.row' . 
$pRow
]['height'];

1326 
	g$cssCÏss
['height'] = 
$height
;

1330 
	g$html
 .ğ' styË="' . 
$this
->
as£mbËCSS
(
$cssCÏss
) . '"';

1332 ià(
	g$cŞS·n
 > 1) {

1333 
	g$html
 .ğ' cŞ¥ª="' . 
$cŞS·n
 . '"';

1335 ià(
	g$rowS·n
 > 1) {

1336 
	g$html
 .ğ'„ow¥ª="' . 
$rowS·n
 . '"';

1338 
	g$html
 .= '>';

1341 
	g$html
 .ğ
$this
->
wr™eImageInC–l
(
$pSh“t
, 
$coÜdš©e
);

1344 ià(
	g$this
->
	gšşudeCh¬ts
) {

1345 
	g$html
 .ğ
$this
->
wr™eCh¬tInC–l
(
$pSh“t
, 
$coÜdš©e
);

1349 
	g$html
 .ğ
$ûÎD©a
;

1352 
	g$html
 .ğ'</'.
$ûÎTy³
.'>' . 
PHP_EOL
;

1356 ++
	g$cŞNum
;

1360 
	g$html
 .ğ' </Œ>' . 
PHP_EOL
;

1363  
	g$html
;

1365 
throw
 
Ãw
 
PHPExûl_Wr™”_Exû±iÚ
("Invalid…arameters…assed.");

1375 
´iv©e
 
funùiÚ
 
as£mbËCSS
(
$pV®ue
 = 
	$¬¿y
())

1377 
$·œs
 = 
	`¬¿y
();

1378 
	`fÜ—ch
 (
$pV®ue
 
as
 
$´İ”ty
 => 
$v®ue
) {

1379 
$·œs
[] = 
$´İ”ty
 . ':' . 
$v®ue
;

1381 
$¡ršg
 = 
	`im¶ode
('; ', 
$·œs
);

1383  
$¡ršg
;

1384 
	}
}

1391 
public
 
funùiÚ
 
	$g‘ImagesRoÙ
()

1393  
$this
->
imagesRoÙ
;

1394 
	}
}

1402 
public
 
funùiÚ
 
£tImagesRoÙ
(
$pV®ue
 = '.')

1404 
$this
->
imagesRoÙ
 = 
$pV®ue
;

1405  
	g$this
;

1413 
public
 
funùiÚ
 
	$g‘EmbedImages
()

1415  
$this
->
embedImages
;

1416 
	}
}

1424 
public
 
funùiÚ
 
£tEmbedImages
(
$pV®ue
 = '.')

1426 
$this
->
embedImages
 = 
$pV®ue
;

1427  
	g$this
;

1435 
public
 
funùiÚ
 
	$g‘U£IÆšeCss
()

1437  
$this
->
u£IÆšeCss
;

1438 
	}
}

1446 
public
 
funùiÚ
 
	$£tU£IÆšeCss
(
$pV®ue
 = 
çl£
)

1448 
$this
->
u£IÆšeCss
 = 
$pV®ue
;

1449  
$this
;

1450 
	}
}

1459 
public
 
funùiÚ
 
	$fÜm©CŞÜ
(
$pV®ue
, 
$pFÜm©
)

1462 
$cŞÜ
 = 
nuÎ
;

1463 
$m©ches
 = 
	`¬¿y
();

1465 
$cŞÜ_»gex
 = '/^\\[[a-zA-Z]+\\]/';

1466 ià(
	`´eg_m©ch
(
$cŞÜ_»gex
, 
$pFÜm©
, 
$m©ches
)) {

1467 
$cŞÜ
 = 
	`¡r_»¶aû
('[', '', 
$m©ches
[0]);

1468 
$cŞÜ
 = 
	`¡r_»¶aû
(']', '', $color);

1469 
$cŞÜ
 = 
	`¡¹Şow”
($color);

1473 
$v®ue
 = 
	`html¥ecŸlch¬s
(
$pV®ue
);

1476 ià(
$cŞÜ
 !=ğ
nuÎ
) {

1477 
$v®ue
 = '<¥ª styË="cŞÜ:' . 
$cŞÜ
 . '">' . $value . '</span>';

1480  
$v®ue
;

1481 
	}
}

1486 
´iv©e
 
funùiÚ
 
	$ÿlcuÏ‹S·ns
()

1491 
$sh“tIndexes
 = 
$this
->
sh“tIndex
 !=ğ
nuÎ
 ?

1492 
	`¬¿y
(
$this
->
sh“tIndex
è: 
	`¿nge
(0, $this->
phpExûl
->
	`g‘Sh“tCouÁ
() - 1);

1494 
	`fÜ—ch
 (
$sh“tIndexes
 
as
 
$sh“tIndex
) {

1495 
$sh“t
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(
$sh“tIndex
);

1497 
$ÿndid©eS·ÂedRow
 = 
	`¬¿y
();

1500 
	`fÜ—ch
 (
$sh“t
->
	`g‘M”geC–ls
(è
as
 
$ûÎs
) {

1501 
	`li¡
(
$ûÎs
,èğ
PHPExûl_C–l
::
	`¥l™Rªge
($cells);

1502 
$fœ¡
 = 
$ûÎs
[0];

1503 
$Ï¡
 = 
$ûÎs
[1];

1505 
	`li¡
(
$fc
, 
$ä
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$fœ¡
);

1506 
$fc
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($fc) - 1;

1508 
	`li¡
(
$lc
, 
$Ì
èğ
PHPExûl_C–l
::
	`coÜdš©eFromSŒšg
(
$Ï¡
);

1509 
$lc
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
($lc) - 1;

1512 
$r
 = 
$ä
 - 1;

1513 
$r
++ < 
$Ì
) {

1515 
$ÿndid©eS·ÂedRow
[
$r
] = $r;

1517 
$c
 = 
$fc
 - 1;

1518 
$c
++ < 
$lc
) {

1519 ià(!(
$c
 =ğ
$fc
 && 
$r
 =ğ
$ä
)) {

1521 
$this
->
isS·ÂedC–l
[
$sh“tIndex
][
$r
][
$c
] = 
	`¬¿y
(

1522 'ba£C–l' => 
	`¬¿y
(
$ä
, 
$fc
),

1526 
$this
->
isBa£C–l
[
$sh“tIndex
][
$r
][
$c
] = 
	`¬¿y
(

1527 'xÌow¥ª' => 
$Ì
 - 
$ä
 + 1,

1528 'row¥ª' => 
$Ì
 - 
$ä
 + 1,

1529 'xlcŞ¥ª' => 
$lc
 - 
$fc
 + 1,

1530 'cŞ¥ª' => 
$lc
 - 
$fc
 + 1,

1539 
$couÁCŞumns
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$sh“t
->
	`g‘Highe¡CŞumn
());

1540 
	`fÜ—ch
 (
$ÿndid©eS·ÂedRow
 
as
 
$rowIndex
) {

1541 ià(
	`is£t
(
$this
->
isS·ÂedC–l
[
$sh“tIndex
][
$rowIndex
])) {

1542 ià(
	`couÁ
(
$this
->
isS·ÂedC–l
[
$sh“tIndex
][
$rowIndex
]è=ğ
$couÁCŞumns
) {

1543 
$this
->
isS·ÂedRow
[
$sh“tIndex
][
$rowIndex
] = $rowIndex;

1549 ià(
	`is£t
(
$this
->
isS·ÂedRow
[
$sh“tIndex
])) {

1550 
	`fÜ—ch
 (
$this
->
isS·ÂedRow
[
$sh“tIndex
] 
as
 
$rowIndex
) {

1551 
$adju¡edBa£C–ls
 = 
	`¬¿y
();

1552 
$c
 = -1;

1553 
$e
 = 
$couÁCŞumns
 - 1;

1554 
$c
++ < 
$e
) {

1555 
$ba£C–l
 = 
$this
->
isS·ÂedC–l
[
$sh“tIndex
][
$rowIndex
][
$c
]['baseCell'];

1557 ià(!
	`š_¬¿y
(
$ba£C–l
, 
$adju¡edBa£C–ls
)) {

1559 --
$this
->
isBa£C–l
[
$sh“tIndex
][ 
$ba£C–l
[0] ][ $baseCell[1] ]['rowspan'];

1560 
$adju¡edBa£C–ls
[] = 
$ba£C–l
;

1570 
$this
->
¥ªsA»C®cuÏ‹d
 = 
Œue
;

1571 
	}
}

1573 
´iv©e
 
funùiÚ
 
	$£tM¬gšs
(
PHPExûl_WÜksh“t
 
$pSh“t
)

1575 
$htmlPage
 = '@page { ';

1576 
$htmlBody
 = 'body { ';

1578 
$Ëá
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘PageM¬gšs
()->
	`g‘Leá
()) . 'in; ';

1579 
$htmlPage
 .ğ'Ëá-m¬gš: ' . 
$Ëá
;

1580 
$htmlBody
 .ğ'Ëá-m¬gš: ' . 
$Ëá
;

1581 
$right
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘PageM¬gšs
()->
	`g‘Right
()) . 'in; ';

1582 
$htmlPage
 .ğ'right-m¬gš: ' . 
$right
;

1583 
$htmlBody
 .ğ'right-m¬gš: ' . 
$right
;

1584 
$tİ
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘PageM¬gšs
()->
	`g‘Tİ
()) . 'in; ';

1585 
$htmlPage
 .ğ'tİ-m¬gš: ' . 
$tİ
;

1586 
$htmlBody
 .ğ'tİ-m¬gš: ' . 
$tİ
;

1587 
$bÙtom
 = 
PHPExûl_Sh¬ed_SŒšg
::
	`FÜm©Numb”
(
$pSh“t
->
	`g‘PageM¬gšs
()->
	`g‘BÙtom
()) . 'in; ';

1588 
$htmlPage
 .ğ'bÙtom-m¬gš: ' . 
$bÙtom
;

1589 
$htmlBody
 .ğ'bÙtom-m¬gš: ' . 
$bÙtom
;

1591 
$htmlPage
 .= "}\n";

1592 
$htmlBody
 .= "}\n";

1594  "<¡yË>\n" . 
$htmlPage
 . 
$htmlBody
 . "</style>\n";

1595 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/IWriter.php

1 <?
php


28 
š‹rçû
 
	gPHPExûl_Wr™”_IWr™”


36 
public
 
funùiÚ
 
§ve
(
$pF’ame
 = 
nuÎ
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_O³nDocum’t
 
ex‹nds
 
PHPExûl_Wr™”_Ab¡¿ù
 
im¶em’ts
 
	mPHPExûl_Wr™”_IWr™”


35 
´iv©e
 
	m$wr™”P¬ts
 = 
¬¿y
();

42 
´iv©e
 
	m$¥»adSh“t
;

49 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

51 
$this
->
	`£tPHPExûl
(
$pPHPExûl
);

53 
$wr™”P¬tsA¼ay
 = 
	`¬¿y
(

63 
	`fÜ—ch
 (
$wr™”P¬tsA¼ay
 
as
 
$wr™”
 => 
$şass
) {

64 
$this
->
wr™”P¬ts
[
$wr™”
] = 
Ãw
 
	`$şass
($this);

74 
public
 
funùiÚ
 
	`g‘Wr™”P¬t
(
$pP¬tName
 = '')

76 ià(
$pP¬tName
 !ğ'' && 
	`is£t
(
$this
->
wr™”P¬ts
[
	`¡¹Şow”
($pPartName)])) {

77  
$this
->
wr™”P¬ts
[
	`¡¹Şow”
(
$pP¬tName
)];

79  
nuÎ
;

81 
	}
}

89 
public
 
funùiÚ
 
	$§ve
(
$pF’ame
 = 
nuÎ
)

91 ià(!
$this
->
¥»adSh“t
) {

92 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('PHPExcel object unassigned.');

96 
$this
->
¥»adSh“t
->
	`g¬bageCŞËù
();

99 
$Üigš®F’ame
 = 
$pF’ame
;

100 ià(
	`¡¹Şow”
(
$pF’ame
) == 'php://output' || strtolower($pFilename) == 'php://stdout') {

101 
$pF’ame
 = @
	`‹m²am
(
PHPExûl_Sh¬ed_Fe
::
	`sys_g‘_‹mp_dœ
(), 'phpxltmp');

102 ià(
$pF’ame
 == '') {

103 
$pF’ame
 = 
$Üigš®F’ame
;

107 
$objZ
 = 
$this
->
	`ü—‹Z
(
$pF’ame
);

109 
$objZ
->
	`addFromSŒšg
('META-INF/mªiã¡.xml', 
$this
->
	`g‘Wr™”P¬t
('m‘a_šf')->
	`wr™eMªiã¡
());

110 
$objZ
->
	`addFromSŒšg
('ThumbÇs/thumbÇ.²g', 
$this
->
	`g‘Wr™”P¬t
('thumbÇs')->
	`wr™eThumbÇ
());

111 
$objZ
->
	`addFromSŒšg
('cÚ‹Á.xml', 
$this
->
	`g‘Wr™”P¬t
('cÚ‹Á')->
	`wr™e
());

112 
$objZ
->
	`addFromSŒšg
('m‘a.xml', 
$this
->
	`g‘Wr™”P¬t
('m‘a')->
	`wr™e
());

113 
$objZ
->
	`addFromSŒšg
('mim‘y³', 
$this
->
	`g‘Wr™”P¬t
('mim‘y³')->
	`wr™e
());

114 
$objZ
->
	`addFromSŒšg
('£‰šgs.xml', 
$this
->
	`g‘Wr™”P¬t
('£‰šgs')->
	`wr™e
());

115 
$objZ
->
	`addFromSŒšg
('¡yËs.xml', 
$this
->
	`g‘Wr™”P¬t
('¡yËs')->
	`wr™e
());

118 ià(
$objZ
->
	`şo£
(è==ğ
çl£
) {

119 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Could‚ot close zip file $pFilename.");

123 ià(
$Üigš®F’ame
 !ğ
$pF’ame
) {

124 ià(
	`cİy
(
$pF’ame
, 
$Üigš®F’ame
è==ğ
çl£
) {

125 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Could‚ot copyemporary zip file $pFilenameo $originalFilename.");

127 @
	`uÆšk
(
$pF’ame
);

129 
	}
}

138 
´iv©e
 
funùiÚ
 
	$ü—‹Z
(
$pF’ame
)

141 
$zCÏss
 = 
PHPExûl_S‘tšgs
::
	`g‘ZCÏss
();

142 
$objZ
 = 
Ãw
 
	`$zCÏss
();

146 
$ro
 = 
Ãw
 
	`ReæeùiÚObjeù
(
$objZ
);

147 
$zOv”Wr™e
 = 
$ro
->
	`g‘CÚ¡ªt
('OVERWRITE');

148 
$zC»©e
 = 
$ro
->
	`g‘CÚ¡ªt
('CREATE');

150 ià(
	`fe_exi¡s
(
$pF’ame
)) {

151 
	`uÆšk
(
$pF’ame
);

154 ià(
$objZ
->
	`İ’
(
$pF’ame
, 
$zOv”Wr™e
è!=ğ
Œue
) {

155 ià(
$objZ
->
	`İ’
(
$pF’ame
, 
$zC»©e
è!=ğ
Œue
) {

156 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Could‚ot open $pFilename for writing.");

160  
$objZ
;

161 
	}
}

169 
public
 
funùiÚ
 
	$g‘PHPExûl
()

171 ià(
$this
->
¥»adSh“t
 !=ğ
nuÎ
) {

172  
$this
->
¥»adSh“t
;

174 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('No PHPExcel‡ssigned.');

176 
	}
}

185 
public
 
funùiÚ
 
	$£tPHPExûl
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

187 
$this
->
¥»adSh“t
 = 
$pPHPExûl
;

188  
$this
;

189 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Cell/Comment.php

1 <?
php


37 şas 
	cPHPExûl_Wr™”_O³nDocum’t_C–l_Comm’t


39 
public
 
funùiÚ
 
	$wr™e
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
, 
PHPExûl_C–l
 
$ûÎ
)

41 
$comm’ts
 = 
$ûÎ
->
	`g‘WÜksh“t
()->
	`g‘Comm’ts
();

42 ià(!
	`is£t
(
$comm’ts
[
$ûÎ
->
	`g‘CoÜdš©e
()])) {

45 
$comm’t
 = 
$comm’ts
[
$ûÎ
->
	`g‘CoÜdš©e
()];

47 
$objWr™”
->
	`¡¬tEËm’t
('office:annotation');

50 
$objWr™”
->
	`wr™eA‰ribu‹
('svg:width', 
$comm’t
->
	`g‘Width
());

51 
$objWr™”
->
	`wr™eA‰ribu‹
('svg:height', 
$comm’t
->
	`g‘Height
());

52 
$objWr™”
->
	`wr™eA‰ribu‹
('svg:x', 
$comm’t
->
	`g‘M¬gšLeá
());

53 
$objWr™”
->
	`wr™eA‰ribu‹
('svg:y', 
$comm’t
->
	`g‘M¬gšTİ
());

56 
$objWr™”
->
	`wr™eEËm’t
('dc:ü—tÜ', 
$comm’t
->
	`g‘AuthÜ
());

59 
$objWr™”
->
	`wr™eEËm’t
('‹xt:p', 
$comm’t
->
	`g‘Text
()->
	`g‘PÏšText
());

61 
$objWr™”
->
	`’dEËm’t
();

63 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Content.php

1 <?
php


37 şas 
	cPHPExûl_Wr™”_O³nDocum’t_CÚ‹Á
 
ex‹nds
 
	mPHPExûl_Wr™”_O³nDocum’t_Wr™”P¬t


39 cÚ¡ 
	mNUMBER_COLS_REPEATED_MAX
 = 1024;

40 cÚ¡ 
	mNUMBER_ROWS_REPEATED_MAX
 = 1048576;

49 
public
 
funùiÚ
 
	$wr™e
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

51 ià(!
$pPHPExûl
) {

52 
$pPHPExûl
 = 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘PHPExûl
();

55 
$objWr™”
 = 
nuÎ
;

56 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

57 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

59 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

63 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8');

66 
$objWr™”
->
	`¡¬tEËm’t
('office:document-content');

67 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:office', 'urn:oasis:names:tc:opendocument:xmlns:office:1.0');

68 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:style', 'urn:oasis:names:tc:opendocument:xmlns:style:1.0');

69 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:text', 'urn:oasis:names:tc:opendocument:xmlns:text:1.0');

70 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:table', 'urn:oasis:names:tc:opendocument:xmlns:table:1.0');

71 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:draw', 'urn:oasis:names:tc:opendocument:xmlns:drawing:1.0');

72 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:fo', 'urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0');

73 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xlink', 'http://www.w3.org/1999/xlink');

74 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:dc', 'http://purl.org/dc/elements/1.1/');

75 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:meta', 'urn:oasis:names:tc:opendocument:xmlns:meta:1.0');

76 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:number', 'urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0');

77 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:presentation', 'urn:oasis:names:tc:opendocument:xmlns:presentation:1.0');

78 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:svg', 'urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0');

79 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:chart', 'urn:oasis:names:tc:opendocument:xmlns:chart:1.0');

80 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:dr3d', 'urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0');

81 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:math', 'http://www.w3.org/1998/Math/MathML');

82 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:form', 'urn:oasis:names:tc:opendocument:xmlns:form:1.0');

83 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:script', 'urn:oasis:names:tc:opendocument:xmlns:script:1.0');

84 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:ooo', 'http://openoffice.org/2004/office');

85 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:ooow', 'http://openoffice.org/2004/writer');

86 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:oooc', 'http://openoffice.org/2004/calc');

87 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:dom', 'http://www.w3.org/2001/xml-events');

88 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xforms', 'http://www.w3.org/2002/xforms');

89 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xsd', 'http://www.w3.org/2001/XMLSchema');

90 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xsi', 'http://www.w3.org/2001/XMLSchema-instance');

91 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:rpt', 'http://openoffice.org/2005/report');

92 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:of', 'urn:oasis:names:tc:opendocument:xmlns:of:1.2');

93 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xhtml', 'http://www.w3.org/1999/xhtml');

94 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:grddl', 'http://www.w3.org/2003/g/data-view#');

95 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:tableooo', 'http://openoffice.org/2009/table');

96 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:field', 'urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0');

97 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:formx', 'urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0');

98 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:css3t', 'http://www.w3.org/TR/css3-text/');

99 
$objWr™”
->
	`wr™eA‰ribu‹
('office:version', '1.2');

101 
$objWr™”
->
	`wr™eEËm’t
('office:scripts');

102 
$objWr™”
->
	`wr™eEËm’t
('office:font-face-decls');

103 
$objWr™”
->
	`wr™eEËm’t
('office:automatic-styles');

105 
$objWr™”
->
	`¡¬tEËm’t
('office:body');

106 
$objWr™”
->
	`¡¬tEËm’t
('office:spreadsheet');

107 
$objWr™”
->
	`wr™eEËm’t
('table:calculation-settings');

108 
$this
->
	`wr™eSh“ts
(
$objWr™”
);

109 
$objWr™”
->
	`wr™eEËm’t
('table:named-expressions');

110 
$objWr™”
->
	`’dEËm’t
();

111 
$objWr™”
->
	`’dEËm’t
();

112 
$objWr™”
->
	`’dEËm’t
();

114  
$objWr™”
->
	`g‘D©a
();

122 
´iv©e
 
funùiÚ
 
	$wr™eSh“ts
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
)

124 
$pPHPExûl
 = 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘PHPExûl
();

126 
$sh“t_couÁ
 = 
$pPHPExûl
->
	`g‘Sh“tCouÁ
();

127 
$i
 = 0; $˜< 
$sh“t_couÁ
; $i++) {

129 
$objWr™”
->
	`¡¬tEËm’t
('table:table');

130 
$objWr™”
->
	`wr™eA‰ribu‹
('bË:Çme', 
$pPHPExûl
->
	`g‘Sh“t
(
$i
)->
	`g‘T™Ë
());

131 
$objWr™”
->
	`wr™eEËm’t
('office:forms');

132 
$objWr™”
->
	`¡¬tEËm’t
('table:table-column');

133 
$objWr™”
->
	`wr™eA‰ribu‹
('bË:numb”-cŞumns-»³©ed', 
£lf
::
NUMBER_COLS_REPEATED_MAX
);

134 
$objWr™”
->
	`’dEËm’t
();

135 
$this
->
	`wr™eRows
(
$objWr™”
, 
$pPHPExûl
->
	`g‘Sh“t
(
$i
));

136 
$objWr™”
->
	`’dEËm’t
();

138 
	}
}

146 
´iv©e
 
funùiÚ
 
	$wr™eRows
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
, 
PHPExûl_WÜksh“t
 
$sh“t
)

148 
$numb”_rows_»³©ed
 = 
£lf
::
NUMBER_ROWS_REPEATED_MAX
;

149 
$¥ª_row
 = 0;

150 
$rows
 = 
$sh“t
->
	`g‘RowI‹¿tÜ
();

151 
$rows
->
	`v®id
()) {

152 
$numb”_rows_»³©ed
--;

153 
$row
 = 
$rows
->
	`cu¼’t
();

154 ià(
$row
->
	`g‘C–lI‹¿tÜ
()->
	`v®id
()) {

155 ià(
$¥ª_row
) {

156 
$objWr™”
->
	`¡¬tEËm’t
('table:table-row');

157 ià(
$¥ª_row
 > 1) {

158 
$objWr™”
->
	`wr™eA‰ribu‹
('bË:numb”-rows-»³©ed', 
$¥ª_row
);

160 
$objWr™”
->
	`¡¬tEËm’t
('table:table-cell');

161 
$objWr™”
->
	`wr™eA‰ribu‹
('bË:numb”-cŞumns-»³©ed', 
£lf
::
NUMBER_COLS_REPEATED_MAX
);

162 
$objWr™”
->
	`’dEËm’t
();

163 
$objWr™”
->
	`’dEËm’t
();

164 
$¥ª_row
 = 0;

166 
$objWr™”
->
	`¡¬tEËm’t
('table:table-row');

167 
$this
->
	`wr™eC–ls
(
$objWr™”
, 
$row
);

168 
$objWr™”
->
	`’dEËm’t
();

170 
$¥ª_row
++;

172 
$rows
->
	`Ãxt
();

174 
	}
}

183 
´iv©e
 
funùiÚ
 
	$wr™eC–ls
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
, 
PHPExûl_WÜksh“t_Row
 
$row
)

185 
$numb”_cŞs_»³©ed
 = 
£lf
::
NUMBER_COLS_REPEATED_MAX
;

186 
$´ev_cŞumn
 = -1;

187 
$ûÎs
 = 
$row
->
	`g‘C–lI‹¿tÜ
();

188 
$ûÎs
->
	`v®id
()) {

189 
$ûÎ
 = 
$ûÎs
->
	`cu¼’t
();

190 
$cŞumn
 = 
PHPExûl_C–l
::
	`cŞumnIndexFromSŒšg
(
$ûÎ
->
	`g‘CŞumn
()) - 1;

192 
$this
->
	`wr™eC–lS·n
(
$objWr™”
, 
$cŞumn
, 
$´ev_cŞumn
);

193 
$objWr™”
->
	`¡¬tEËm’t
('table:table-cell');

195 
$ûÎ
->
	`g‘D©aTy³
()) {

196 
PHPExûl_C–l_D©aTy³
::
TYPE_BOOL
:

197 
$objWr™”
->
	`wr™eA‰ribu‹
('office:value-type', 'boolean');

198 
$objWr™”
->
	`wr™eA‰ribu‹
('offiû:v®ue', 
$ûÎ
->
	`g‘V®ue
());

199 
$objWr™”
->
	`wr™eEËm’t
('‹xt:p', 
$ûÎ
->
	`g‘V®ue
());

202 
PHPExûl_C–l_D©aTy³
::
TYPE_ERROR
:

203 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('Writing ofƒrror‚ot implemented yet.');

206 
PHPExûl_C–l_D©aTy³
::
TYPE_FORMULA
:

207 
Œy
 {

208 
$fÜmuÏ_v®ue
 = 
$ûÎ
->
	`g‘C®cuÏ‹dV®ue
();

209 } 
	`ÿtch
 (
Exû±iÚ
 
$e
) {

210 
$fÜmuÏ_v®ue
 = 
$ûÎ
->
	`g‘V®ue
();

212 
$objWr™”
->
	`wr™eA‰ribu‹
('bË:fÜmuÏ', 'of:' . 
$ûÎ
->
	`g‘V®ue
());

213 ià(
	`is_num”ic
(
$fÜmuÏ_v®ue
)) {

214 
$objWr™”
->
	`wr™eA‰ribu‹
('office:value-type', 'float');

216 
$objWr™”
->
	`wr™eA‰ribu‹
('office:value-type', 'string');

218 
$objWr™”
->
	`wr™eA‰ribu‹
('offiû:v®ue', 
$fÜmuÏ_v®ue
);

219 
$objWr™”
->
	`wr™eEËm’t
('‹xt:p', 
$fÜmuÏ_v®ue
);

222 
PHPExûl_C–l_D©aTy³
::
TYPE_INLINE
:

223 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
('Writing of inline‚ot implemented yet.');

226 
PHPExûl_C–l_D©aTy³
::
TYPE_NUMERIC
:

227 
$objWr™”
->
	`wr™eA‰ribu‹
('office:value-type', 'float');

228 
$objWr™”
->
	`wr™eA‰ribu‹
('offiû:v®ue', 
$ûÎ
->
	`g‘V®ue
());

229 
$objWr™”
->
	`wr™eEËm’t
('‹xt:p', 
$ûÎ
->
	`g‘V®ue
());

232 
PHPExûl_C–l_D©aTy³
::
TYPE_STRING
:

233 
$objWr™”
->
	`wr™eA‰ribu‹
('office:value-type', 'string');

234 
$objWr™”
->
	`wr™eEËm’t
('‹xt:p', 
$ûÎ
->
	`g‘V®ue
());

237 
PHPExûl_Wr™”_O³nDocum’t_C–l_Comm’t
::
	`wr™e
(
$objWr™”
, 
$ûÎ
);

238 
$objWr™”
->
	`’dEËm’t
();

239 
$´ev_cŞumn
 = 
$cŞumn
;

240 
$ûÎs
->
	`Ãxt
();

242 
$numb”_cŞs_»³©ed
 = $numb”_cŞs_»³©ed - 
$´ev_cŞumn
 - 1;

243 ià(
$numb”_cŞs_»³©ed
 > 0) {

244 ià(
$numb”_cŞs_»³©ed
 > 1) {

245 
$objWr™”
->
	`¡¬tEËm’t
('table:table-cell');

246 
$objWr™”
->
	`wr™eA‰ribu‹
('bË:numb”-cŞumns-»³©ed', 
$numb”_cŞs_»³©ed
);

247 
$objWr™”
->
	`’dEËm’t
();

249 
$objWr™”
->
	`wr™eEËm’t
('table:table-cell');

252 
	}
}

261 
´iv©e
 
funùiÚ
 
	$wr™eC–lS·n
(
PHPExûl_Sh¬ed_XMLWr™”
 
$objWr™”
, 
$curCŞumn
, 
$´evCŞumn
)

263 
$diff
 = 
$curCŞumn
 - 
$´evCŞumn
 - 1;

264 ià(1 ==ğ
$diff
) {

265 
$objWr™”
->
	`wr™eEËm’t
('table:table-cell');

266 } 
	`–£if
 (
$diff
 > 1) {

267 
$objWr™”
->
	`¡¬tEËm’t
('table:table-cell');

268 
$objWr™”
->
	`wr™eA‰ribu‹
('bË:numb”-cŞumns-»³©ed', 
$diff
);

269 
$objWr™”
->
	`’dEËm’t
();

271 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Meta.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_O³nDocum’t_M‘a
 
ex‹nds
 
	mPHPExûl_Wr™”_O³nDocum’t_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™e
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

39 ià(!
$pPHPExûl
) {

40 
$pPHPExûl
 = 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘PHPExûl
();

43 
$objWr™”
 = 
nuÎ
;

44 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

45 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

47 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

51 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8');

54 
$objWr™”
->
	`¡¬tEËm’t
('office:document-meta');

56 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:office', 'urn:oasis:names:tc:opendocument:xmlns:office:1.0');

57 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xlink', 'http://www.w3.org/1999/xlink');

58 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:dc', 'http://purl.org/dc/elements/1.1/');

59 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:meta', 'urn:oasis:names:tc:opendocument:xmlns:meta:1.0');

60 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:ooo', 'http://openoffice.org/2004/office');

61 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:grddl', 'http://www.w3.org/2003/g/data-view#');

62 
$objWr™”
->
	`wr™eA‰ribu‹
('office:version', '1.2');

64 
$objWr™”
->
	`¡¬tEËm’t
('office:meta');

66 
$objWr™”
->
	`wr™eEËm’t
('m‘a:š™Ÿl-ü—tÜ', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©Ü
());

67 
$objWr™”
->
	`wr™eEËm’t
('dc:ü—tÜ', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©Ü
());

68 
$objWr™”
->
	`wr™eEËm’t
('m‘a:ü—tiÚ-d©e', 
	`d©e
(
DATE_W3C
, 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©ed
()));

69 
$objWr™”
->
	`wr™eEËm’t
('dc:d©e', 
	`d©e
(
DATE_W3C
, 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©ed
()));

70 
$objWr™”
->
	`wr™eEËm’t
('dc:t™Ë', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘T™Ë
());

71 
$objWr™”
->
	`wr™eEËm’t
('dc:desütiÚ', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘DesütiÚ
());

72 
$objWr™”
->
	`wr™eEËm’t
('dc:subjeù', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Subjeù
());

73 
$keywÜds
 = 
	`ex¶ode
(' ', 
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘KeywÜds
());

74 
	`fÜ—ch
 (
$keywÜds
 
as
 
$keywÜd
) {

75 
$objWr™”
->
	`wr™eEËm’t
('m‘a:keywÜd', 
$keywÜd
);

79 
$objWr™”
->
	`¡¬tEËm’t
('meta:user-defined');

80 
$objWr™”
->
	`wr™eA‰ribu‹
('meta:name', 'Company');

81 
$objWr™”
->
	`wr™eRaw
(
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘Com·ny
());

82 
$objWr™”
->
	`’dEËm’t
();

84 
$objWr™”
->
	`¡¬tEËm’t
('meta:user-defined');

85 
$objWr™”
->
	`wr™eA‰ribu‹
('meta:name', 'category');

86 
$objWr™”
->
	`wr™eRaw
(
$pPHPExûl
->
	`g‘Prİ”t›s
()->
	`g‘C©egÜy
());

87 
$objWr™”
->
	`’dEËm’t
();

89 
$objWr™”
->
	`’dEËm’t
();

91 
$objWr™”
->
	`’dEËm’t
();

93  
$objWr™”
->
	`g‘D©a
();

95 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/MetaInf.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_O³nDocum’t_M‘aInf
 
ex‹nds
 
	mPHPExûl_Wr™”_O³nDocum’t_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™eMªiã¡
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

39 ià(!
$pPHPExûl
) {

40 
$pPHPExûl
 = 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘PHPExûl
();

43 
$objWr™”
 = 
nuÎ
;

44 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

45 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

47 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

51 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8');

54 
$objWr™”
->
	`¡¬tEËm’t
('manifest:manifest');

55 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:manifest', 'urn:oasis:names:tc:opendocument:xmlns:manifest:1.0');

56 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:version', '1.2');

58 
$objWr™”
->
	`¡¬tEËm’t
('manifest:file-entry');

59 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:full-path', '/');

60 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:version', '1.2');

61 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:media-type', 'application/vnd.oasis.opendocument.spreadsheet');

62 
$objWr™”
->
	`’dEËm’t
();

63 
$objWr™”
->
	`¡¬tEËm’t
('manifest:file-entry');

64 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:full-path', 'meta.xml');

65 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:media-type', 'text/xml');

66 
$objWr™”
->
	`’dEËm’t
();

67 
$objWr™”
->
	`¡¬tEËm’t
('manifest:file-entry');

68 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:full-path', 'settings.xml');

69 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:media-type', 'text/xml');

70 
$objWr™”
->
	`’dEËm’t
();

71 
$objWr™”
->
	`¡¬tEËm’t
('manifest:file-entry');

72 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:full-path', 'content.xml');

73 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:media-type', 'text/xml');

74 
$objWr™”
->
	`’dEËm’t
();

75 
$objWr™”
->
	`¡¬tEËm’t
('manifest:file-entry');

76 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:full-path', 'Thumbnails/thumbnail.png');

77 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:media-type', 'image/png');

78 
$objWr™”
->
	`’dEËm’t
();

79 
$objWr™”
->
	`¡¬tEËm’t
('manifest:file-entry');

80 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:full-path', 'styles.xml');

81 
$objWr™”
->
	`wr™eA‰ribu‹
('manifest:media-type', 'text/xml');

82 
$objWr™”
->
	`’dEËm’t
();

83 
$objWr™”
->
	`’dEËm’t
();

85  
$objWr™”
->
	`g‘D©a
();

87 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Mimetype.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_O³nDocum’t_Mim‘y³
 
ex‹nds
 
	mPHPExûl_Wr™”_O³nDocum’t_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™e
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

41 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Settings.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_O³nDocum’t_S‘tšgs
 
ex‹nds
 
	mPHPExûl_Wr™”_O³nDocum’t_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™e
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

39 ià(!
$pPHPExûl
) {

40 
$pPHPExûl
 = 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘PHPExûl
();

43 
$objWr™”
 = 
nuÎ
;

44 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

45 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

47 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

51 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8');

54 
$objWr™”
->
	`¡¬tEËm’t
('office:document-settings');

55 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:office', 'urn:oasis:names:tc:opendocument:xmlns:office:1.0');

56 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xlink', 'http://www.w3.org/1999/xlink');

57 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:config', 'urn:oasis:names:tc:opendocument:xmlns:config:1.0');

58 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:ooo', 'http://openoffice.org/2004/office');

59 
$objWr™”
->
	`wr™eA‰ribu‹
('office:version', '1.2');

61 
$objWr™”
->
	`¡¬tEËm’t
('office:settings');

62 
$objWr™”
->
	`¡¬tEËm’t
('config:config-item-set');

63 
$objWr™”
->
	`wr™eA‰ribu‹
('config:name', 'ooo:view-settings');

64 
$objWr™”
->
	`¡¬tEËm’t
('config:config-item-map-indexed');

65 
$objWr™”
->
	`wr™eA‰ribu‹
('config:name', 'Views');

66 
$objWr™”
->
	`’dEËm’t
();

67 
$objWr™”
->
	`’dEËm’t
();

68 
$objWr™”
->
	`¡¬tEËm’t
('config:config-item-set');

69 
$objWr™”
->
	`wr™eA‰ribu‹
('config:name', 'ooo:configuration-settings');

70 
$objWr™”
->
	`’dEËm’t
();

71 
$objWr™”
->
	`’dEËm’t
();

72 
$objWr™”
->
	`’dEËm’t
();

74  
$objWr™”
->
	`g‘D©a
();

76 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Styles.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_O³nDocum’t_StyËs
 
ex‹nds
 
	mPHPExûl_Wr™”_O³nDocum’t_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™e
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

39 ià(!
$pPHPExûl
) {

40 
$pPHPExûl
 = 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘PHPExûl
();

43 
$objWr™”
 = 
nuÎ
;

44 ià(
$this
->
	`g‘P¬’tWr™”
()->
	`g‘U£DiskCachšg
()) {

45 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_DISK
, 
$this
->
	`g‘P¬’tWr™”
()->
	`g‘DiskCachšgDœeùÜy
());

47 
$objWr™”
 = 
Ãw
 
	`PHPExûl_Sh¬ed_XMLWr™”
(
PHPExûl_Sh¬ed_XMLWr™”
::
STORAGE_MEMORY
);

51 
$objWr™”
->
	`¡¬tDocum’t
('1.0', 'UTF-8');

54 
$objWr™”
->
	`¡¬tEËm’t
('office:document-styles');

55 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:office', 'urn:oasis:names:tc:opendocument:xmlns:office:1.0');

56 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:style', 'urn:oasis:names:tc:opendocument:xmlns:style:1.0');

57 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:text', 'urn:oasis:names:tc:opendocument:xmlns:text:1.0');

58 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:table', 'urn:oasis:names:tc:opendocument:xmlns:table:1.0');

59 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:draw', 'urn:oasis:names:tc:opendocument:xmlns:drawing:1.0');

60 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:fo', 'urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0');

61 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xlink', 'http://www.w3.org/1999/xlink');

62 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:dc', 'http://purl.org/dc/elements/1.1/');

63 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:meta', 'urn:oasis:names:tc:opendocument:xmlns:meta:1.0');

64 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:number', 'urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0');

65 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:presentation', 'urn:oasis:names:tc:opendocument:xmlns:presentation:1.0');

66 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:svg', 'urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0');

67 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:chart', 'urn:oasis:names:tc:opendocument:xmlns:chart:1.0');

68 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:dr3d', 'urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0');

69 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:math', 'http://www.w3.org/1998/Math/MathML');

70 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:form', 'urn:oasis:names:tc:opendocument:xmlns:form:1.0');

71 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:script', 'urn:oasis:names:tc:opendocument:xmlns:script:1.0');

72 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:ooo', 'http://openoffice.org/2004/office');

73 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:ooow', 'http://openoffice.org/2004/writer');

74 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:oooc', 'http://openoffice.org/2004/calc');

75 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:dom', 'http://www.w3.org/2001/xml-events');

76 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:rpt', 'http://openoffice.org/2005/report');

77 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:of', 'urn:oasis:names:tc:opendocument:xmlns:of:1.2');

78 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:xhtml', 'http://www.w3.org/1999/xhtml');

79 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:grddl', 'http://www.w3.org/2003/g/data-view#');

80 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:tableooo', 'http://openoffice.org/2009/table');

81 
$objWr™”
->
	`wr™eA‰ribu‹
('xmlns:css3t', 'http://www.w3.org/TR/css3-text/');

82 
$objWr™”
->
	`wr™eA‰ribu‹
('office:version', '1.2');

84 
$objWr™”
->
	`wr™eEËm’t
('office:font-face-decls');

85 
$objWr™”
->
	`wr™eEËm’t
('office:styles');

86 
$objWr™”
->
	`wr™eEËm’t
('office:automatic-styles');

87 
$objWr™”
->
	`wr™eEËm’t
('office:master-styles');

88 
$objWr™”
->
	`’dEËm’t
();

90  
$objWr™”
->
	`g‘D©a
();

92 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Thumbnails.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_O³nDocum’t_ThumbÇs
 
ex‹nds
 
	mPHPExûl_Wr™”_O³nDocum’t_Wr™”P¬t


37 
public
 
funùiÚ
 
	$wr™eThumbÇ
(
PHPExûl
 
$pPHPExûl
 = 
nuÎ
)

41 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/WriterPart.php

1 <?
php


28 
ab¡¿ù
 cÏs 
	cPHPExûl_Wr™”_O³nDocum’t_Wr™”P¬t
 
ex‹nds
 
	mPHPExûl_Wr™”_Exûl2007_Wr™”P¬t


	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/PDF.php

1 <?
php


28 şas 
	cPHPExûl_Wr™”_PDF
 
im¶em’ts
 
	mPHPExûl_Wr™”_IWr™”


36 
´iv©e
 
	m$»nd””
 = 
nuÎ
;

44 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$phpExûl
)

46 
$pdfLib¿ryName
 = 
PHPExûl_S‘tšgs
::
	`g‘PdfR’d””Name
();

47 ià(
	`is_nuÎ
(
$pdfLib¿ryName
)) {

48 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("PDF Rendering†ibrary has‚ot been defined.");

51 
$pdfLib¿ryP©h
 = 
PHPExûl_S‘tšgs
::
	`g‘PdfR’d””P©h
();

52 ià(
	`is_nuÎ
(
$pdfLib¿ryName
)) {

53 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("PDF Rendering†ibrary…ath has‚ot been defined.");

55 
$šşudeP©h
 = 
	`¡r_»¶aû
('\\', '/', 
	`g‘_šşude_·th
());

56 
$»nd””P©h
 = 
	`¡r_»¶aû
('\\', '/', 
$pdfLib¿ryP©h
);

57 ià(
	`¡½os
(
$»nd””P©h
, 
$šşudeP©h
è==ğ
çl£
) {

58 
	`£t_šşude_·th
(
	`g‘_šşude_·th
(è. 
PATH_SEPARATOR
 . 
$pdfLib¿ryP©h
);

61 
$»nd””Name
 = 'PHPExûl_Wr™”_PDF_' . 
$pdfLib¿ryName
;

62 
$this
->
»nd””
 = 
Ãw
 
	`$»nd””Name
(
$phpExûl
);

73 
public
 
funùiÚ
 
	$__ÿÎ
(
$Çme
, 
$¬gum’ts
)

75 ià(
$this
->
»nd””
 ==ğ
nuÎ
) {

76 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("PDF Rendering†ibrary has‚ot been defined.");

79  
	`ÿÎ_u£r_func_¬¿y
(
	`¬¿y
(
$this
->
»nd””
, 
$Çme
), 
$¬gum’ts
);

80 
	}
}

85 
public
 
funùiÚ
 
	$§ve
(
$pF’ame
 = 
nuÎ
)

87 
$this
->
»nd””
->
	`§ve
(
$pF’ame
);

88 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/PDF/Core.php

1 <?
php


28 
ab¡¿ù
 cÏs 
	cPHPExûl_Wr™”_PDF_CÜe
 
ex‹nds
 
	mPHPExûl_Wr™”_HTML


35 
´Ùeùed
 
	m$‹mpDœ
 = '';

42 
´Ùeùed
 
	m$fÚt
 = 'freesans';

49 
´Ùeùed
 
	m$Ü›Á©iÚ
;

56 
´Ùeùed
 
	m$·³rSize
;

64 
´iv©e
 
	m$§veA¼ayR‘uºTy³
;

71 
´Ùeùed
 
	m$·³rSizes
 = 
¬¿y
(

72 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LETTER


74 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LETTER_SMALL


76 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_TABLOID


77 => 
¬¿y
(792.00, 1224.00),

78 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LEDGER


79 => 
¬¿y
(1224.00, 792.00),

80 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LEGAL


82 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_STATEMENT


83 => 
¬¿y
(396.00, 612.00),

84 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_EXECUTIVE


86 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A3


88 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A4


90 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A4_SMALL


92 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A5


94 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_B4


96 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_B5


98 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_FOLIO


100 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_QUARTO


101 => 
¬¿y
(609.45, 779.53),

102 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_STANDARD_1


103 => 
¬¿y
(720.00, 1008.00),

104 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_STANDARD_2


105 => 
¬¿y
(792.00, 1224.00),

106 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_NOTE


108 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_NO9_ENVELOPE


109 => 
¬¿y
(279.00, 639.00),

110 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_NO10_ENVELOPE


111 => 
¬¿y
(297.00, 684.00),

112 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_NO11_ENVELOPE


113 => 
¬¿y
(324.00, 747.00),

114 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_NO12_ENVELOPE


115 => 
¬¿y
(342.00, 792.00),

116 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_NO14_ENVELOPE


117 => 
¬¿y
(360.00, 828.00),

118 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_C


119 => 
¬¿y
(1224.00, 1584.00),

120 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_D


121 => 
¬¿y
(1584.00, 2448.00),

122 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_E


123 => 
¬¿y
(2448.00, 3168.00),

124 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_DL_ENVELOPE


125 => 
¬¿y
(311.81, 623.62),

126 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_C5_ENVELOPE


128 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_C3_ENVELOPE


130 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_C4_ENVELOPE


132 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_C6_ENVELOPE


134 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_C65_ENVELOPE


135 => 
¬¿y
(323.15, 649.13),

136 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_B4_ENVELOPE


138 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_B5_ENVELOPE


140 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_B6_ENVELOPE


141 => 
¬¿y
(498.90, 354.33),

142 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_ITALY_ENVELOPE


143 => 
¬¿y
(311.81, 651.97),

144 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_MONARCH_ENVELOPE


145 => 
¬¿y
(279.00, 540.00),

146 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_6_3_4_ENVELOPE


147 => 
¬¿y
(261.00, 468.00),

148 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_US_STANDARD_FANFOLD


149 => 
¬¿y
(1071.00, 792.00),

150 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_GERMAN_STANDARD_FANFOLD


151 => 
¬¿y
(612.00, 864.00),

152 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_GERMAN_LEGAL_FANFOLD


154 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_ISO_B4


156 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_JAPANESE_DOUBLE_POSTCARD


157 => 
¬¿y
(566.93, 419.53),

158 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_STANDARD_PAPER_1


159 => 
¬¿y
(648.00, 792.00),

160 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_STANDARD_PAPER_2


161 => 
¬¿y
(720.00, 792.00),

162 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_STANDARD_PAPER_3


163 => 
¬¿y
(1080.00, 792.00),

164 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_INVITE_ENVELOPE


165 => 
¬¿y
(623.62, 623.62),

166 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LETTER_EXTRA_PAPER


167 => 
¬¿y
(667.80, 864.00),

168 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LEGAL_EXTRA_PAPER


169 => 
¬¿y
(667.80, 1080.00),

170 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_TABLOID_EXTRA_PAPER


171 => 
¬¿y
(841.68, 1296.00),

172 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A4_EXTRA_PAPER


173 => 
¬¿y
(668.98, 912.76),

174 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LETTER_TRANSVERSE_PAPER


175 => 
¬¿y
(595.80, 792.00),

176 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A4_TRANSVERSE_PAPER


178 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LETTER_EXTRA_TRANSVERSE_PAPER


179 => 
¬¿y
(667.80, 864.00),

180 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_SUPERA_SUPERA_A4_PAPER


181 => 
¬¿y
(643.46, 1009.13),

182 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_SUPERB_SUPERB_A3_PAPER


183 => 
¬¿y
(864.57, 1380.47),

184 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LETTER_PLUS_PAPER


185 => 
¬¿y
(612.00, 913.68),

186 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A4_PLUS_PAPER


187 => 
¬¿y
(595.28, 935.43),

188 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A5_TRANSVERSE_PAPER


190 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_JIS_B5_TRANSVERSE_PAPER


191 => 
¬¿y
(515.91, 728.50),

192 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A3_EXTRA_PAPER


193 => 
¬¿y
(912.76, 1261.42),

194 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A5_EXTRA_PAPER


195 => 
¬¿y
(493.23, 666.14),

196 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_ISO_B5_EXTRA_PAPER


197 => 
¬¿y
(569.76, 782.36),

198 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A2_PAPER


200 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A3_TRANSVERSE_PAPER


202 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_A3_EXTRA_TRANSVERSE_PAPER


203 => 
¬¿y
(912.76, 1261.42)

211 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$phpExûl
)

213 
·»Á
::
	`__cÚ¡ruù
(
$phpExûl
);

214 
$this
->
	`£tU£IÆšeCss
(
Œue
);

215 
$this
->
‹mpDœ
 = 
PHPExûl_Sh¬ed_Fe
::
	`sys_g‘_‹mp_dœ
();

223 
public
 
funùiÚ
 
	$g‘FÚt
()

225  
$this
->
fÚt
;

226 
	}
}

237 
public
 
funùiÚ
 
	$£tFÚt
(
$fÚtName
)

239 
$this
->
fÚt
 = 
$fÚtName
;

240  
$this
;

241 
	}
}

248 
public
 
funùiÚ
 
	$g‘P­”Size
()

250  
$this
->
·³rSize
;

251 
	}
}

259 
public
 
funùiÚ
 
	$£tP­”Size
(
$pV®ue
 = 
PHPExûl_WÜksh“t_PageS‘up
::
PAPERSIZE_LETTER
)

261 
$this
->
·³rSize
 = 
$pV®ue
;

262  
$this
;

263 
	}
}

270 
public
 
funùiÚ
 
	$g‘Or›Á©iÚ
()

272  
$this
->
Ü›Á©iÚ
;

273 
	}
}

281 
public
 
funùiÚ
 
	$£tOr›Á©iÚ
(
$pV®ue
 = 
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_DEFAULT
)

283 
$this
->
Ü›Á©iÚ
 = 
$pV®ue
;

284  
$this
;

285 
	}
}

292 
public
 
funùiÚ
 
	$g‘TempDœ
()

294  
$this
->
‹mpDœ
;

295 
	}
}

304 
public
 
funùiÚ
 
£tTempDœ
(
$pV®ue
 = '')

306 ià(
is_dœ
(
$pV®ue
)) {

307 
$this
->
‹mpDœ
 = 
$pV®ue
;

309 
throw
 
Ãw
 
PHPExûl_Wr™”_Exû±iÚ
("Directory does‚otƒxist: $pValue");

311  
	g$this
;

320 
´Ùeùed
 
funùiÚ
 
	$´•¬eFÜSave
(
$pF’ame
 = 
nuÎ
)

323 
$this
->
phpExûl
->
	`g¬bageCŞËù
();

325 
$this
->
§veA¼ayR‘uºTy³
 = 
PHPExûl_C®cuÏtiÚ
::
	`g‘A¼ayR‘uºTy³
();

326 
PHPExûl_C®cuÏtiÚ
::
	`£tA¼ayR‘uºTy³
(PHPExûl_C®cuÏtiÚ::
RETURN_ARRAY_AS_VALUE
);

329 
$feHªdË
 = 
	`fİ’
(
$pF’ame
, 'w');

330 ià(
$feHªdË
 ==ğ
çl£
) {

331 
throw
 
Ãw
 
	`PHPExûl_Wr™”_Exû±iÚ
("Could‚ot open file $pFilename for writing.");

335 
$this
->
isPdf
 = 
Œue
;

337 
$this
->
	`budCSS
(
Œue
);

339  
$feHªdË
;

340 
	}
}

348 
´Ùeùed
 
funùiÚ
 
	$»¡ÜeS‹Aá”Save
(
$feHªdË
)

351 
	`fşo£
(
$feHªdË
);

353 
PHPExûl_C®cuÏtiÚ
::
	`£tA¼ayR‘uºTy³
(
$this
->
§veA¼ayR‘uºTy³
);

354 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/PDF/DomPDF.php

1 <?
php


4 
	g$pdfR’d””CÏssFe
 = 
PHPExûl_S‘tšgs
::
g‘PdfR’d””P©h
() . '/dompdf_config.inc.php';

5 ià(
	$fe_exi¡s
(
$pdfR’d””CÏssFe
)) {

6 
»quœe_Úû
 
$pdfR’d””CÏssFe
;

7 
	}
} {

8 
throw
 
Ãw
 
PHPExûl_Wr™”_Exû±iÚ
('Unableo†oad PDF Rendering†ibrary');

36 şas 
	cPHPExûl_Wr™”_PDF_DomPDF
 
ex‹nds
 
PHPExûl_Wr™”_PDF_CÜe
 
im¶em’ts
 
	mPHPExûl_Wr™”_IWr™”


43 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$phpExûl
)

45 
·»Á
::
	`__cÚ¡ruù
(
$phpExûl
);

54 
public
 
funùiÚ
 
	$§ve
(
$pF’ame
 = 
nuÎ
)

56 
$feHªdË
 = 
·»Á
::
	`´•¬eFÜSave
(
$pF’ame
);

59 
$·³rSize
 = 'LETTER';

62 ià(
	`is_nuÎ
(
$this
->
	`g‘Sh“tIndex
())) {

63 
$Ü›Á©iÚ
 = (
$this
->
phpExûl
->
	`g‘Sh“t
(0)->
	`g‘PageS‘up
()->
	`g‘Or›Á©iÚ
()

64 =ğ
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_LANDSCAPE
) ? 'L' : 'P';

65 
$´štP­”Size
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(0)->
	`g‘PageS‘up
()->
	`g‘P­”Size
();

66 
$´štM¬gšs
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(0)->
	`g‘PageM¬gšs
();

68 
$Ü›Á©iÚ
 = (
$this
->
phpExûl
->
	`g‘Sh“t
($this->
	`g‘Sh“tIndex
())->
	`g‘PageS‘up
()->
	`g‘Or›Á©iÚ
()

69 =ğ
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_LANDSCAPE
) ? 'L' : 'P';

70 
$´štP­”Size
 = 
$this
->
phpExûl
->
	`g‘Sh“t
($this->
	`g‘Sh“tIndex
())->
	`g‘PageS‘up
()->
	`g‘P­”Size
();

71 
$´štM¬gšs
 = 
$this
->
phpExûl
->
	`g‘Sh“t
($this->
	`g‘Sh“tIndex
())->
	`g‘PageM¬gšs
();

74 
$Ü›Á©iÚ
 = ($orientation == 'L') ? 'landscape' : 'portrait';

77 ià(!
	`is_nuÎ
(
$this
->
	`g‘Or›Á©iÚ
())) {

78 
$Ü›Á©iÚ
 = (
$this
->
	`g‘Or›Á©iÚ
(è=ğ
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_DEFAULT
)

79 ? 
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_PORTRAIT


80 : 
$this
->
	`g‘Or›Á©iÚ
();

83 ià(!
	`is_nuÎ
(
$this
->
	`g‘P­”Size
())) {

84 
$´štP­”Size
 = 
$this
->
	`g‘P­”Size
();

87 ià(
	`is£t
(
£lf
::
$·³rSizes
[
$´štP­”Size
])) {

88 
$·³rSize
 = 
£lf
::
$·³rSizes
[
$´štP­”Size
];

93 
$pdf
 = 
Ãw
 
	`DOMPDF
();

94 
$pdf
->
	`£t_·³r
(
	`¡¹Şow”
(
$·³rSize
), 
$Ü›Á©iÚ
);

96 
$pdf
->
	`lßd_html
(

97 
$this
->
	`g’”©eHTMLH—d”
(
çl£
) .

98 
$this
->
	`g’”©eSh“tD©a
() .

99 
$this
->
	`g’”©eHTMLFoÙ”
()

101 
$pdf
->
	`»nd”
();

104 
	`fwr™e
(
$feHªdË
, 
$pdf
->
	`ouut
());

106 
·»Á
::
	`»¡ÜeS‹Aá”Save
(
$feHªdË
);

107 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/PDF/mPDF.php

1 <?
php


4 
	g$pdfR’d””CÏssFe
 = 
PHPExûl_S‘tšgs
::
g‘PdfR’d””P©h
() . '/mpdf.php';

5 ià(
	$fe_exi¡s
(
$pdfR’d””CÏssFe
)) {

6 
»quœe_Úû
 
$pdfR’d””CÏssFe
;

7 
	}
} {

8 
throw
 
Ãw
 
PHPExûl_Wr™”_Exû±iÚ
('Unableo†oad PDF Rendering†ibrary');

36 şas 
	cPHPExûl_Wr™”_PDF_mPDF
 
ex‹nds
 
PHPExûl_Wr™”_PDF_CÜe
 
im¶em’ts
 
	mPHPExûl_Wr™”_IWr™”


43 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$phpExûl
)

45 
·»Á
::
	`__cÚ¡ruù
(
$phpExûl
);

54 
public
 
funùiÚ
 
	$§ve
(
$pF’ame
 = 
nuÎ
)

56 
$feHªdË
 = 
·»Á
::
	`´•¬eFÜSave
(
$pF’ame
);

59 
$·³rSize
 = 'LETTER';

62 ià(
	`is_nuÎ
(
$this
->
	`g‘Sh“tIndex
())) {

63 
$Ü›Á©iÚ
 = (
$this
->
phpExûl
->
	`g‘Sh“t
(0)->
	`g‘PageS‘up
()->
	`g‘Or›Á©iÚ
()

64 =ğ
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_LANDSCAPE
) ? 'L' : 'P';

65 
$´štP­”Size
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(0)->
	`g‘PageS‘up
()->
	`g‘P­”Size
();

66 
$´štM¬gšs
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(0)->
	`g‘PageM¬gšs
();

68 
$Ü›Á©iÚ
 = (
$this
->
phpExûl
->
	`g‘Sh“t
($this->
	`g‘Sh“tIndex
())->
	`g‘PageS‘up
()->
	`g‘Or›Á©iÚ
()

69 =ğ
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_LANDSCAPE
) ? 'L' : 'P';

70 
$´štP­”Size
 = 
$this
->
phpExûl
->
	`g‘Sh“t
($this->
	`g‘Sh“tIndex
())->
	`g‘PageS‘up
()->
	`g‘P­”Size
();

71 
$´štM¬gšs
 = 
$this
->
phpExûl
->
	`g‘Sh“t
($this->
	`g‘Sh“tIndex
())->
	`g‘PageM¬gšs
();

73 
$this
->
	`£tOr›Á©iÚ
(
$Ü›Á©iÚ
);

76 ià(!
	`is_nuÎ
(
$this
->
	`g‘Or›Á©iÚ
())) {

77 
$Ü›Á©iÚ
 = (
$this
->
	`g‘Or›Á©iÚ
(è=ğ
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_DEFAULT
)

78 ? 
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_PORTRAIT


79 : 
$this
->
	`g‘Or›Á©iÚ
();

81 
$Ü›Á©iÚ
 = 
	`¡¹ouµ”
($orientation);

84 ià(!
	`is_nuÎ
(
$this
->
	`g‘P­”Size
())) {

85 
$´štP­”Size
 = 
$this
->
	`g‘P­”Size
();

88 ià(
	`is£t
(
£lf
::
$·³rSizes
[
$´štP­”Size
])) {

89 
$·³rSize
 = 
£lf
::
$·³rSizes
[
$´štP­”Size
];

94 
$pdf
 = 
Ãw
 
	`mpdf
();

95 
$Ütmp
 = 
$Ü›Á©iÚ
;

96 
$pdf
->
	`_£tPageSize
(
	`¡¹ouµ”
(
$·³rSize
), 
$Ütmp
);

97 
$pdf
->
DefOr›Á©iÚ
 = 
$Ü›Á©iÚ
;

98 
$pdf
->
	`AddPage
(
$Ü›Á©iÚ
);

101 
$pdf
->
	`S‘T™Ë
(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘T™Ë
());

102 
$pdf
->
	`S‘AuthÜ
(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©Ü
());

103 
$pdf
->
	`S‘Subjeù
(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘Subjeù
());

104 
$pdf
->
	`S‘KeywÜds
(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘KeywÜds
());

105 
$pdf
->
	`S‘C»©Ü
(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©Ü
());

107 
$pdf
->
	`Wr™eHTML
(

108 
$this
->
	`g’”©eHTMLH—d”
(
çl£
) .

109 
$this
->
	`g’”©eSh“tD©a
() .

110 
$this
->
	`g’”©eHTMLFoÙ”
()

114 
	`fwr™e
(
$feHªdË
, 
$pdf
->
	`Ouut
('', 'S'));

116 
·»Á
::
	`»¡ÜeS‹Aá”Save
(
$feHªdË
);

117 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/PDF/tcPDF.php

1 <?
php


4 
	g$pdfR’d””CÏssFe
 = 
PHPExûl_S‘tšgs
::
g‘PdfR’d””P©h
() . '/tcpdf.php';

5 ià(
	$fe_exi¡s
(
$pdfR’d””CÏssFe
)) {

6 
$k_·th_u¾
 = 
PHPExûl_S‘tšgs
::
	`g‘PdfR’d””P©h
();

7 
»quœe_Úû
 
$pdfR’d””CÏssFe
;

8 
	}
} {

9 
throw
 
Ãw
 
PHPExûl_Wr™”_Exû±iÚ
('Unableo†oad PDF Rendering†ibrary');

37 şas 
	cPHPExûl_Wr™”_PDF_tcPDF
 
ex‹nds
 
PHPExûl_Wr™”_PDF_CÜe
 
im¶em’ts
 
	mPHPExûl_Wr™”_IWr™”


44 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
PHPExûl
 
$phpExûl
)

46 
·»Á
::
	`__cÚ¡ruù
(
$phpExûl
);

55 
public
 
funùiÚ
 
	$§ve
(
$pF’ame
 = 
nuÎ
)

57 
$feHªdË
 = 
·»Á
::
	`´•¬eFÜSave
(
$pF’ame
);

60 
$·³rSize
 = 'LETTER';

63 ià(
	`is_nuÎ
(
$this
->
	`g‘Sh“tIndex
())) {

64 
$Ü›Á©iÚ
 = (
$this
->
phpExûl
->
	`g‘Sh“t
(0)->
	`g‘PageS‘up
()->
	`g‘Or›Á©iÚ
()

65 =ğ
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_LANDSCAPE
) ? 'L' : 'P';

66 
$´štP­”Size
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(0)->
	`g‘PageS‘up
()->
	`g‘P­”Size
();

67 
$´štM¬gšs
 = 
$this
->
phpExûl
->
	`g‘Sh“t
(0)->
	`g‘PageM¬gšs
();

69 
$Ü›Á©iÚ
 = (
$this
->
phpExûl
->
	`g‘Sh“t
($this->
	`g‘Sh“tIndex
())->
	`g‘PageS‘up
()->
	`g‘Or›Á©iÚ
()

70 =ğ
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_LANDSCAPE
) ? 'L' : 'P';

71 
$´štP­”Size
 = 
$this
->
phpExûl
->
	`g‘Sh“t
($this->
	`g‘Sh“tIndex
())->
	`g‘PageS‘up
()->
	`g‘P­”Size
();

72 
$´štM¬gšs
 = 
$this
->
phpExûl
->
	`g‘Sh“t
($this->
	`g‘Sh“tIndex
())->
	`g‘PageM¬gšs
();

76 ià(!
	`is_nuÎ
(
$this
->
	`g‘Or›Á©iÚ
())) {

77 
$Ü›Á©iÚ
 = (
$this
->
	`g‘Or›Á©iÚ
(è=ğ
PHPExûl_WÜksh“t_PageS‘up
::
ORIENTATION_LANDSCAPE
)

82 ià(!
	`is_nuÎ
(
$this
->
	`g‘P­”Size
())) {

83 
$´štP­”Size
 = 
$this
->
	`g‘P­”Size
();

86 ià(
	`is£t
(
£lf
::
$·³rSizes
[
$´štP­”Size
])) {

87 
$·³rSize
 = 
£lf
::
$·³rSizes
[
$´štP­”Size
];

92 
$pdf
 = 
Ãw
 
	`TCPDF
(
$Ü›Á©iÚ
, '±', 
$·³rSize
);

93 
$pdf
->
	`£tFÚtSub£‰šg
(
çl£
);

95 
$pdf
->
	`S‘M¬gšs
(
$´štM¬gšs
->
	`g‘Leá
(è* 72, $´štM¬gšs->
	`g‘Tİ
(è* 72, $´štM¬gšs->
	`g‘Right
() * 72);

96 
$pdf
->
	`S‘AutoPageB»ak
(
Œue
, 
$´štM¬gšs
->
	`g‘BÙtom
() * 72);

98 
$pdf
->
	`£tPrštH—d”
(
çl£
);

99 
$pdf
->
	`£tPrštFoÙ”
(
çl£
);

101 
$pdf
->
	`AddPage
();

104 
$pdf
->
	`S‘FÚt
(
$this
->
	`g‘FÚt
());

105 
$pdf
->
	`wr™eHTML
(

106 
$this
->
	`g’”©eHTMLH—d”
(
çl£
) .

107 
$this
->
	`g’”©eSh“tD©a
() .

108 
$this
->
	`g’”©eHTMLFoÙ”
()

112 
$pdf
->
	`S‘T™Ë
(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘T™Ë
());

113 
$pdf
->
	`S‘AuthÜ
(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©Ü
());

114 
$pdf
->
	`S‘Subjeù
(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘Subjeù
());

115 
$pdf
->
	`S‘KeywÜds
(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘KeywÜds
());

116 
$pdf
->
	`S‘C»©Ü
(
$this
->
phpExûl
->
	`g‘Prİ”t›s
()->
	`g‘C»©Ü
());

119 
	`fwr™e
(
$feHªdË
, 
$pdf
->
	`ouut
(
$pF’ame
, 'S'));

121 
·»Á
::
	`»¡ÜeS‹Aá”Save
(
$feHªdË
);

122 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/admin/home/home.php

2 <
div
 
	gşass
="block">

3 <
h2
>
W–come
 
to
 
this
 
¶©efÜm
</h2>

5 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/admin/home/login.php

1 <!
doùy³
 
	ghtml
>

2 <
	ghtml
>

3 <
	gh—d
>

4 <
	g¡yË
>

6 .
	gcÚš”
-
	gæuid
 {

7 
	gm¬gš
-
	gtİ
: 20
px
;

9 </
	g¡yË
>

10 <
m‘a
 
	gch¬£t
="utf-8">

11 <
t™Ë
>æ— æ ‡é¢˜æ–‡æ¡£</title>

12 <
m‘a
 
Çme
="v›wpÜt" 
cÚ‹Á
="width=device-width, initial-scale=1.0">

13 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url() ?>style/admin/css/bootstrap/css/bootstrap.css">

14 <
lšk
 
h»f
="<?ph°echØba£_u¾(è?>¡yË/admš/css/boÙ¡¿p/css/boÙ¡¿p-»¥Úsive.mš.css" 
»l
="stylesheet">

15 <
süt
 
¤c
="<?phpƒcho base_url() ?>style/admin/css/bootstrap/js/jquery-1.8.3.min.js"></script>

16 <
süt
 
¤c
="<?phpƒcho base_url() ?>style/admin/css/bootstrap/js/bootstrap.js"></script>

17 <
lšk
 
h»f
="<?ph°echØba£_u¾(è?>¡yË/admš/css/fÚts/fÚt-awesome.mš.css" 
»l
="stylesheet">

18 </
h—d
>

19 <
body
>

21 <
div
 
şass
="navbar‚avbar-inverse">

22 <
div
 
şass
="navbar-inner">

23 <
div
 
şass
="container">

26 <
a
 
şass
="b¿nd" 
h»f
="#">åå°</a>

28 <!-- 
Ev”ythšg
 
you
 
wªt
 
hidd’
 
©
 940
px
 
Ü
 
Ëss
, 
¶aû
 
w™hš
 
	gh”e
 -->

29 <
ul
 
	gşass
="nav…ull-right">

32 <
li
 
şass
="dropdown">

33 <
a
 
d©a
-
toggË
="drİdown" 
şass
="drİdown-toggË" 
h»f
="#">ç™»é™†<
b
 class="caret"></b></a>

34 <
ul
 
şass
="dropdown-menu">

35 <
li
><
a
 
h»f
="#">
AùiÚ
</a></li>

36 <
li
><
a
 
h»f
="#">
AnÙh”
 
aùiÚ
</a></li>

37 <
li
><
a
 
h»f
="#">
Som‘hšg
 
h”e
</a></li>

38 <
li
 
şass
="divider"></li>

39 <
li
><
a
 
h»f
="#">
S•¬©ed
 
lšk
</a></li>

40 </
ul
>

41 </
li
>

42 </
ul
>

44 </
div
>

45 </
div
>

46 </
div
>

54 <
div
 
şass
="mod®" 
¡yË
="margin-top: 50px;">

55 <
div
 
şass
="modal-header">

56 <
h3
>ç™»é™†</h3>

57 <
br
>

58 <?
php
 if(
$this
->
£ssiÚ
->
u£rd©a
('”rÜ_mes§ge')!=
nuÎ
){
echo
 "<span style='color:red' class='alert‡lert-danger'>".$this->session->userdata('error_message')."</span>";}?>

60 </
	gdiv
>

61 <
fÜm
 
	gm‘hod
="po¡" 
aùiÚ
="<?ph°echØs™e_u¾('admš/home/logš'è?>" 
id
="login-form">

62 <
p
 
şass
="nÙe">&
nb¥
;</
	gp
>

63 <
div
 
	gşass
="modal-body">

64 <
div
>

65 <
Ïb–
 ="">ç”¨æˆ·å*</Ïb–><
šput
 
ty³
="‹xt" 
Çme
="au_Çme" 
şass
="fÜm-cÚŒŞ" 
v®ue
='<?ph°echØ£t_v®ue('
au_Çme
'è?>'><?
php
 
echo
 "<¥ª styË='cŞÜ:»d'>".
fÜm_”rÜ
('au_name')."</span>" ?>

66 </
div
>

68 <
div
>

69 <
Ïb–
 ="">å¯†ç *</Ïb–><
šput
 
ty³
="·sswÜd" 
Çme
="au_·sswÜd" 
id
="" 
şass
="fÜm-cÚŒŞ" 
v®ue
='<?ph°echØ£t_v®ue('
au_·sswÜd
'è?>'><?
php
 
echo
 "<¥ª styË='cŞÜ:»d'>".
fÜm_”rÜ
('au_password')."</span>" ?>

70 <
div
>

71 </
div
>

73 <
div
 
şass
="modal-footer">

75 <
šput
 
ty³
="subm™" 
Çme
="subm™" 
şass
='bŠ bŠ-sucûss' 
v®ue
="login">

76 </
div
>

80 </
fÜm
>

81 </
div
><!-- 
fÜm
 -->

85 </
body
>

86 </
html
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/admin/layouts/bottom.php

1 </
	gdiv
>

2 </
	gdiv
>

3 </
	gdiv
>

4 <
	gfoÙ”
>

5 <
	gp
>

7 </
	gp
>

8 </
	gfoÙ”
>

10 <
div
 
	g¡yË
="pos™iÚ: fixed; z-šdex: 2147483647;" 
t™Ë
="SüŞÈtØtİ" 
id
="süŞlUp">å›åˆ°<
br
>é¡¶éƒ¨</div>

12 <
süt
 
ty³
="text/javascript">

13 
v¬
 
¡2
=
docum’t
.
docum’tEËm’t
.
süŞlTİ
;

14 ià(
	g¡2
>200) {

15 
$
("#süŞlUp").
show
();

17 
$
("#süŞlUp").
hide
();

21 
$
(
wšdow
).
süŞl
(
	$funùiÚ
(){

22 
v¬
 
¡2
=
docum’t
.
docum’tEËm’t
.
süŞlTİ
;

23 ià(
¡2
>200) {

25 
	`$
("#süŞlUp").
	`çdeIn
();

26 
	`$
("#süŞlUp").
	`çdeIn
("slow");

27 
	`$
("#süŞlUp").
	`çdeIn
(3000);

29 
	`$
("#süŞlUp").
	`çdeOut
();

30 
	`$
("#süŞlUp").
	`çdeOut
("slow");

31 
	`$
("#süŞlUp").
	`çdeOut
(3000);

33 
	}
});

34 
$
("#süŞlUp").
şick
(
	$funùiÚ
(){

35 
	`$
('html').
	`ªim©e
({
süŞlTİ
:0},500);

36 
	}
});

37 </
	gsüt
>

39 <
süt
 
	g¤c
="<?phpƒcho base_url();?>style/index/js/tiny-scrollbar.js"></script>

40 <
süt
 
ty³
="text/javascript">

43 
funùiÚ
 
	$p›_ch¬t
() {

45 
	`$
(
	`funùiÚ
 () {

47 
	`$
('.ch¬t5').
	`—syP›Ch¬t
({

48 
ªim©e
: 3000,

49 
b¬CŞÜ
: '#F63131',

50 
ŒackCŞÜ
: '#dddddd',

51 
sÿËCŞÜ
: '#F63131',

52 
size
: 140,

53 
lšeWidth
: 6,

56 
	`£tTimeout
(
	`funùiÚ
 () {

57 
	`$
('.ch¬t5').
	`d©a
('—syP›Ch¬t').
	`upd©e
(30);

59 
	`£tTimeout
(
	`funùiÚ
 () {

60 
	`$
('.ch¬t5').
	`d©a
('—syP›Ch¬t').
	`upd©e
(87);

62 
	`£tTimeout
(
	`funùiÚ
 () {

63 
	`$
('.ch¬t5').
	`d©a
('—syP›Ch¬t').
	`upd©e
(28);

65 
	`£tTimeout
(
	`funùiÚ
 () {

66 
	`$
('.ch¬t5').
	`d©a
('—syP›Ch¬t').
	`upd©e
(69);

68 
	`£tTimeout
(
	`funùiÚ
 () {

69 
	`$
('.ch¬t5').
	`d©a
('—syP›Ch¬t').
	`upd©e
(99);

72 
	}
}

74 
$
('#süŞlb¬').
tšysüŞlb¬
();

75 
$
('#süŞlb¬-Úe').
tšysüŞlb¬
();

76 
$
('#süŞlb¬-two').
tšysüŞlb¬
();

77 
$
('#süŞlb¬-th»e').
tšysüŞlb¬
();

80 </
	gsüt
>

81 <
süt
 
	g¤c
="<?phpƒcho base_url();?>style/admin/js/lee/lee.js"></script>

82 <
süt
 
¤c
="<?phpƒcho base_url();?>style/admin/js/jquery.dataTables.js"></script>

83 </
body
>

84 </
html
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/admin/layouts/head.php

1 <!
DOCTYPE
 
	ghtml
>

2 <
html
 
	gÏng
="en">

3 <
h—d
>

4 <
m‘a
 
h‰p
-
equiv
="CÚ‹Á-Ty³" 
cÚ‹Á
="text/html; charset=utf-8" />

5 <
m‘a
 
cÚ‹Á
="IEódge,chrome=1" 
h‰p
-
equiv
="X-UA-Compatible">

6 <
m‘a
 
Çme
="v›wpÜt" 
cÚ‹Á
="width=device-width, initial-scale=1.0">

7 <
m‘a
 
Çme
="desütiÚ" 
cÚ‹Á
="">

8 <
m‘a
 
Çme
="authÜ" 
cÚ‹Á
="">

9 <!--<
süt
 
ty³
="‹xt/javasüt" 
¤c
="http://html5shiv.googlecode.com/svn/trunk/html5.js">-->

10 </
süt
>

11 <
t™Ë
>å®¢æˆ·åŒ–å¹³å°</title>

12 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/admš/css/boÙ¡¿p/css/boÙ¡¿p.css" 
»l
="stylesheet"></link>

13 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/admš/css/jqu”y-ui-boÙ¡¿p.css" 
»l
="stylesheet"></link>

14 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/admš/css/¡yË.css" 
»l
="stylesheet"></link>

15 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/admš/css/maš.css" 
»l
="stylesheet"></link>

16 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/admš/css/Ëe.css" 
»l
="stylesheet"></link>

17 <
süt
 
¤c
="<?phpƒcho base_url();?>style/admin/js/jquery.js"></script>

18 <
süt
 
¤c
="<?phpƒcho base_url();?>style/admin/js/jui/js/jquery-ui.min.js"></script>

19 <
süt
 
¤c
="<?phpƒcho base_url();?>style/admin/css/bootstrap/js/bootstrap.min.js"></script>

21 </
h—d
>

22 <
body
>

23 <
h—d”
>

24 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="šdex.php" 
şass
="logo">

25 
LOGO


26 </
a
>

28 <
div
 
şass
="user-profile">

29 <
a
 
d©a
-
Üigš®
-
t™Ë
="" d©a-
toggË
="drİdown" 
şass
="dropdown-toggle">

30 <
img
 
¤c
="<?ph°echØba£_u¾();?>¡yË/admš/css/img/´ofe1.²g" 
®t
="Profile-Image">

31 <
¥ª
 
şass
="caret"></span>

32 </
a
>

33 <
ul
 
şass
="dropdown-menu…ull-right">

34 <
li
>

35 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="#">

36 
Ed™
 
Profe


37 </
a
>

38 </
li
>

39 <
li
>

40 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="#">

41 
AccouÁ
 
S‘tšgs


42 </
a
>

43 </
li
>

44 <
li
>

45 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="<?phpƒcho site_url('admin/home/out') ?>">

46 
Logout


47 </
a
>

48 </
li
>

49 </
ul
>

50 </
div
>

51 <
ul
 
şass
="mini-nav">

52 <
li
>

53 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="#">

54 <
div
 
şass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="î€"></div>

55 <
¥ª
 
şass
="šfo-Ïb–" 
id
="quickMessages">16</span>

56 </
a
>

57 </
li
>

58 <
li
>

59 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="#">

60 <
div
 
şass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="&#xe0aa;"></div>

61 <
¥ª
 
şass
="šfo-Ïb–-g»’" 
id
="quickAlerts">10</span>

62 </
a
>

63 </
li
>

64 <
li
>

65 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="#">

66 <
div
 
şass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="î€·"></div>

67 <
¥ª
 
şass
="šfo-Ïb–-Üªge" 
id
="quickShop">10</span>

68 </
a
>

69 </
li
>

70 </
ul
>

71 </
h—d”
>

76 <
div
 
şass
="container-fluid">

77 <
div
 
şass
="dashboard-container">

78 <
div
 
şass
="top-nav">

79 <
ul
>

80 <
li
>

81 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
Çme
='glšk' 
h»f
="<?ph°echØs™e_u¾('admš/home/šdex'è?>" 
şass
="">

82 <
div
 
şass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="&#xe000"></div>

84 </
a
>

85 </
li
>

86 <
li
>

87 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
Çme
='glšk' 
h»f
="<?ph°echØs™e_u¾('admš/objeù/šdex')?>" <?
php
 ià(
$this
->
m’u1
=='cus'){
echo
 'class="selected"';}?>>

88 <
div
 
	gşass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="&#xe0bb"></div>

90 </
a
>

91 </
li
>

92 <
li
>

93 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
Çme
='glšk' 
h»f
="<?ph°echØs™e_u¾('admš/‹m¶©e')?>" <?
php
 ià(
$this
->
m’u1
=='‹m¶©e'){
echo
 'class="selected"';}?>>

94 <
div
 
	gşass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="&#xe003"></div>

96 </
a
>

97 </
li
>

98 <
li
>

99 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
Çme
='glšk' 
h»f
="<?ph°echØs™e_u¾('admš/m’u/šdex')?>" <?
php
 ià(
$this
->
m’u1
=='m’u'){
echo
 'class="selected"';}?>>

100 <
div
 
	gşass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="&#xe157"></div>

102 </
a
>

103 </
li
>

104 <
li
>

105 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
Çme
='glšk' 
h»f
="<?ph°echØs™e_u¾('admš/toŞs/šdex')?>" <?
php
 ià(
$this
->
m’u1
=='toŞs'){
echo
 'class="selected"';}?>>

106 <
div
 
	gşass
="fs1" 
¬Ÿ
-
hidd’
="Œue" 
d©a
-
icÚ
="&#xe08b"></div>

108 </
a
>

109 </
li
>

110 </
ul
>

111 <
div
 
şass
="clearfix">

112 </
div
>

113 </
div
>

114 <
div
 
şass
="sub-nav">

115 <?
php
 ià(
$this
->
m’u1
=='tools'){ ?>

116 <
ul
>

117 <
li
>

118 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="<?ph°echØs™e_u¾('admš/toŞs/šdex')?>" <?
php
 ià(
$this
->
m’u2
=='šdex'){
echo
 'class="selected"';}?>>

120 </
	ga
>

121 </
	gli
>

122 <
	gli
>

123 <
a
 
	gd©a
-
	gÜigš®
-
	gt™Ë
="" 
h»f
="<?ph°echØs™e_u¾('admš/timšg_sk/šdex'è?>" <?
php
 ià(
$this
->
m’u2
=='timšg_sk'){
echo
 'class="selected"';}?>>

125 </
	ga
>

126 </
	gli
>

127 </
	gul
>

128 <?
	gphp
 }?>

129 <?
php
 ià(
	g$this
->
	gm’u1
=='cus'){ ?>

130 <
ul
>

131 <
li
>

132 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="<?ph°echØs™e_u¾('admš/objeù/šdex')?>" <?
php
 ià(
$this
->
m’u2
=='objeù'){
echo
 'şass="£Ëùed"';}?>>å¯¹è±¡ç®¡ç†</
	ga
>

133 </
	gli
>

134 <
	gli
>

135 <
a
 
	gd©a
-
	gÜigš®
-
	gt™Ë
="" 
h»f
="<?ph°echØs™e_u¾('admš/©Œty³/ty³_li¡'è?>" <?
php
 ià(
$this
->
m’u2
=='©Œty³'){
echo
 'class="selected"';}?>>

137 </
	ga
>

138 </
	gli
>

139 </
	gul
>

140 <?
	gphp
 }ià(
	g$this
->
	gm’u1
=='template'){ ?>

141 <
ul
>

142 <
li
>

143 <
a
 
d©a
-
Üigš®
-
t™Ë
="" 
h»f
="<?ph°echØs™e_u¾('admš/‹m¶©e/šdex?‹m¶©e_ty³=v›w')?>" <?
php
 ià(
$this
->
m’u2
=='v›w'){
echo
 'class="selected"';}?>>

145 </
	ga
>

146 </
	gli
>

147 <
	gli
>

148 <
a
 
	gd©a
-
	gÜigš®
-
	gt™Ë
="" 
h»f
="<?ph°echØs™e_u¾('admš/‹m¶©e/šdex?‹m¶©e_ty³=cÚŒŞËr')?>" <?
php
 ià(
$this
->
m’u2
=='cÚŒŞËr'){
echo
 'şass="£Ëùed"';}?>>æ§åˆ¶å™¨ æ¨¡æ¿</
	ga
>

149 </
	gli
>

150 <
	gli
>

151 <
a
 
	gd©a
-
	gÜigš®
-
	gt™Ë
="" 
h»f
="<?ph°echØs™e_u¾('admš/‹m¶©e/šdex?‹m¶©e_ty³=mod–')?>" <?
php
 ià(
$this
->
m’u2
=='mod–'){
echo
 'class="selected"';}?>>

153 </
	ga
>

154 </
	gli
>

155 </
	gul
>

156 <?
	gphp
 } ?>

157 <
šput
 
	g¶aûhŞd”
="å…ˆä¸¢è¿™é‡Œæš‚æ—¶ä¸ç”¨" 
şass
="šput-£¬ch hidd’-phÚe" 
ty³
="search">

158 <
div
 
şass
="btn-group…ull-right">

159 <
bu‰Ú
 
şass
="btn btn-warning2">

160 
bŠ
-
w¬nšg2


161 </
bu‰Ú
>

162 <
bu‰Ú
 
d©a
-
toggË
="drİdown" 
şass
="btn btn-warning2 dropdown-toggle">

163 <
¥ª
 
şass
="caret">

164 </
¥ª
>

165 </
bu‰Ú
>

166 <
ul
 
şass
="dropdown-menu…ull-right">

167 <
li
>

168 <
a
 
h»f
="" 
d©a
-
Üigš®
-
t™Ë
="">

170 </
a
>

171 </
li
>

172 <
li
>

173 <
a
 
h»f
="" 
d©a
-
Üigš®
-
t™Ë
="">

175 </
a
>

176 </
li
>

177 </
ul
>

178 </
div
>

179 </
div
>

180 <
div
 
şass
="dashboard-wrapper">

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/add.php

1 <
süt
 
	gty³
="text/javascript">

2 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

3 
	`$
('[Çme=ÿnûl]').
	`şick
(
	`funùiÚ
(){

4 
loÿtiÚ
.
h»f
="<?phpƒcho base_url();?>index.php/www/objects/lists?obj_type=<?phpƒcho $obj_type;?>"

6  
çl£
;

7 
	}
});

9 </
	gsüt
>

10 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

11 <
div
 
şass
="main-content">

12 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

13 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

14 <
ul
 
şass
="breadcrumb">

15 <
li
>

16 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

17 <
a
 
h»f
="<?phpƒcho base_url();?>index.php/www">é¦–é¡µ</a>

18 </
li
>

19 <
li
 
şass
="aùive"><
a
 
h»f
="<?ph°echØba£_u¾();?>šdex.php/www/objeùs/li¡s?obj_ty³=<?ph°echØ$obj_ty³;?>>"><?
php
 
echo
 
$diù
;?>åˆ—è¡¨</
	ga
></
	gli
>

20 <
	gli
>æ–°å¢<?
php
 
echo
 
	g$diù
;?></li>

21 </
	gul
><!-- /.
	gb»adüumb
 -->

22 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

23 </
div
>

25 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

26 <
div
 
şass
="page-content">

27 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

28 <
div
 
şass
="page-header">

29 <
h1
>

30 æ–°å¢<?
php
 
echo
 
$diù
;?>

31 <
	gsm®l
>

32 <?
php
 
echo
 
	g$moduË
;?> 
	gAdd


33 </
	gsm®l
>

34 </
	gh1
>

35 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

37 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

38 <
div
 
	gşass
="row">

39 <
fÜm
 
id
="FÜm" 
Úsubm™
="return false">

40 <
šput
 
ty³
="hidd’" 
Çme
="<?ph°echØ$´im¬y['key'];?>" 
v®ue
="<?phpƒcho $primary['value'];?>"/>

41 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_mod–" 
v®ue
="<?phpƒcho $module;?>"/>

42 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_aùiÚ" 
v®ue
="module_add"/>

43 <
div
 
şass
="col-xs-12">

44 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

45 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

47 </
bu‰Ú
>

48 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

49 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

51 </
bu‰Ú
>

52 <
div
 
şass
="hr hr-dotted hr-16"></div>

53 </
div
>

55 <
div
 
şass
="cŞ-xs-12" 
id
="EditFormat"></div>

56 <
div
 
şass
="hr hr-dotted hr-16"></div>

57 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

58 <
div
 
şass
="col-xs-12">

59 <
div
 
şass
="hr hr-dotted hr-16"></div>

60 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

61 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

63 </
bu‰Ú
>

65 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

66 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

68 </
bu‰Ú
>

70 </
div
>

71 </
fÜm
>

72 <
süt
 
ty³
="text/javascript">

74 
$
(
docum’t
).
»ady
(
	$funùiÚ
() {

75 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
);?>;

76 
	`$
("#Ed™FÜm©").
	`FÜm©
({

77 
ty³
: "edit",

78 
FÜm©D©a
: 
fÜm©_d©a
,

79 
FromID
:"Form",

80 
S–eùChdEnumsU¾
:'<?phpƒcho base_url();?>index.php/admin/enum/SelectChildEnums'

83 
v¬
 
d_obj_Çme
 = "<?phpƒcho $dtl_obj_name?>";

85 if(
d_obj_Çme
.
Ëngth
 != 0){

86 
	`$
("#d‘a").
	`L“TabË
({

87 
CŞ
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞl
);?>,

88 
IsEd™
:
Œue


94 
	}
});

95 </
	gsüt
>

96 </
	gdiv
><!-- /.
	grow
 -->

97 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

98 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

99 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

100 <
süt
 
	gty³
="text/javascript">

102 
$
("#FÜm").
v®id©e
({

103 
subm™HªdËr
: 
funùiÚ
() {

104 
v¬
 
d©a
 = 
$
("#FÜm").
£rŸlizeA¼ay
();

105 
v¬
 
ld©a
 = <?
php
 
echo
 
jsÚ_’code
(
$Ëad_d©a
);?>;

106 
v¬
 
moduË
 = "<?phpƒcho $module;?>";

107 
$
.
ajax
({

109 'd©a':{'d©a':
d©a
,

110 'ld©a':
ld©a


112 'sucûss':
funùiÚ
(
d©a
){

114 
d©a
 = 
ev®
("("+data+")");

116 if(
d©a
.
»s
=='suc'){

117 
®”t
(
d©a
.
msg
);

118 if(
moduË
!='User'){

119 
loÿtiÚ
.
h»f
="<?phpƒcho base_url();?>index.php/www/objects/lists?obj_type=<?phpƒcho $obj_type;?>";

121 
loÿtiÚ
.
h»f
="<?phpƒcho base_url();?>index.php/www";

126 
®”t
(
d©a
.
msg
);

131 'ÿche':
çl£


138 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/ajax_add.php

1 <?
php
 
	g$¿ndom
 =
¿nd
(100,999);?>

2 <
süt
 
	gty³
="text/javascript">

3 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

4 
	`$
('[Çme=ÿnûl]').
	`şick
(
	`funùiÚ
(){

5 
	`$
('#'+
$DŸlogDivIDM
).
	`dŸlog
("close");

7  
çl£
;

8 
	}
});

10 </
	gsüt
>

11 <
div
 
	gşass
="page-content">

12 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

13 <
div
 
şass
="page-header">

14 <
h1
>

15 æ–°å¢<?
php
 
echo
 
$diù
;?>

16 <
	gsm®l
>

17 <?
php
 
echo
 
	g$moduË
;?> 
	gAdd


18 </
	gsm®l
>

19 </
	gh1
>

20 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

22 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

23 <
div
 
	gşass
="row">

24 <
fÜm
 
id
="FÜm" 
Úsubm™
="return false">

25 <
šput
 
ty³
="hidd’" 
Çme
="<?ph°echØ$´im¬y['key'];?>" 
v®ue
="<?phpƒcho $primary['value'];?>"/>

26 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_mod–" 
v®ue
="<?phpƒcho $module;?>"/>

27 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_aùiÚ" 
v®ue
="module_add"/>

28 <
šput
 
ty³
="hidd’" 
Çme
 = "sobj_Çme" 
v®ue
 = <?
php
 
echo
 
$sobj_Çme
;?>>

29 <
šput
 
	gty³
="hidd’" 
Çme
 = "sobj_id" 
v®ue
 = <?
php
 
echo
 
$sobj_id
;?>>

30 <
div
 
	gşass
="col-xs-12">

31 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

32 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

34 </
bu‰Ú
>

35 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

36 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

38 </
bu‰Ú
>

39 <
div
 
şass
="hr hr-dotted hr-16"></div>

40 </
div
>

42 <
div
 
şass
="cŞ-xs-12" 
id
="Ajax_add_<?phpƒcho $random?>"></div>

43 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

44 <
div
 
şass
="col-xs-12">

45 <
div
 
şass
="hr hr-dotted hr-16"></div>

46 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

47 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

49 </
bu‰Ú
>

51 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

52 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

54 </
bu‰Ú
>

56 </
div
>

57 </
fÜm
>

58 <
süt
 
ty³
="text/javascript">

60 
$
(
docum’t
).
»ady
(
	$funùiÚ
() {

61 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
);?>;

62 
	`$
("#Ajax_add_<?ph°echØ$¿ndom?>").
	`FÜm©
({

63 
ty³
: "edit",

64 
FÜm©D©a
: 
fÜm©_d©a
,

65 
FromID
:"Form",

66 
S–eùChdEnumsU¾
:'<?phpƒcho base_url();?>index.php/admin/enum/SelectChildEnums'

69 
	}
});

70 </
	gsüt
>

71 </
	gdiv
><!-- /.
	grow
 -->

72 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

74 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

75 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

76 <
süt
 
	gty³
="text/javascript">

77 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

78 
	`$
('[Çme=§ve]').
	`şick
(
	`funùiÚ
(){

79 
v¬
 
d©a
 = 
	`$
("#FÜm").
	`£rŸlizeA¼ay
();

80 
v¬
 
ld©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$Ëad_d©a
)?>;

82 
$
.
	`ajax
({

84 'd©a':{'d©a':
d©a
,'ld©a':
ld©a
},

85 'sucûss':
	`funùiÚ
(
d©a
){

86 
d©a
 = 
	`ev®
("("+data+")");

88 if(
d©a
.
»s
=='suc'){

89 
	`®”t
(
d©a
.
msg
);

90 
	`$
('#'+
$DŸlogDivIDM
).
	`dŸlog
("close");

91 
wšdow
.
loÿtiÚ
.
	`»¶aû
ÖoÿtiÚ.
h»f
);

93 
	`®”t
(
d©a
.
msg
);

98 'ÿche':
çl£


102  
çl£
;

104 
	}
});

106 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/ajax_list.php

1 <
div
 
	gşass
="<?phpƒcho $DialogID; ?>_ajax_page_content">

3 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

4 <
div
 
şass
="row">

6 <
div
 
şass
="col-xs-12">

7 <
bu‰Ú
 
id
='<?ph°echØ$DŸlogID; ?>_sub' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
süt
 
ty³
="text/javascript">

13 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

14 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

16 
	`$
("#<?ph°echØ$DŸlogID; ?>_sub").
	`S’iÜQu”y
({

17 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

18 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

19 
Li¡Div
: "#<?phpƒcho $DialogID; ?>_page_content"

22 
	}
});

24 </
	gsüt
>

25 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

26 </
div
>

28 <
div
 
şass
="cŞ-xs-12" 
id
="<?phpƒcho $DialogID; ?>_page_content">

29 </
div
><!-- /.
cŞ
 -->

30 </
div
><!-- /.
row
 -->

31 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

32 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

33 <
süt
 
ty³
="text/javascript">

34 
jQu”y
(
	$funùiÚ
 (
$
) {

35 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>";

36 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

37 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

38 
v¬
 
Çm—‰ºame
 = '<?ph°echØ$obj_d©a['
NAME_ATTR_NAME
']?>';

39 
v¬
 
po¡D©a
 = 
nuÎ
;

40 
v¬
 
obj_ty³
 = '<?phpƒcho $ObjType;?>';

41 
v¬
 
robj_ty³
 = '<?phpƒcho $rObjType;?>';

42 if(
obj_ty³
 == '300'){

43 
po¡D©a
 = {
£niÜqu”y
:{
wh”e
:{1:{
©Œ
:'Ty³.ObjeùTy³',
aùiÚ
:'EQUAL',
v®ue
:
robj_ty³
}},
»l
:'1'}};

45 
	`$
("#<?ph°echØ$DŸlogID; ?>_·ge_cÚ‹Á").
	`L“TabË
({

46 
U¾
:
u¾
,

47 
CŞ
:
cŞ
,

48 
MuÉiS–eù
:
Œue
,

49 
MuÉiTy³
:1,

50 
KeyA‰rName
:
key©ŒÇme
,

51 
NameA‰rName
:
Çm—‰ºame
,

52 
po¡D©a
:postData

54 
	}
});

56 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/ajax_view_list.php

1 <
div
 
	gid
="<?phpƒcho $DialogID;?>_ajax_page_content">

2 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

3 <
süt
 
ty³
="text/javascript">

4 
jQu”y
(
	$funùiÚ
 (
$
) {

5 
v¬
 
·¿ms
 = {
d©a_jsÚ
:'<?ph°echØjsÚ_’code($d©a_jsÚ); ?>',
cÚd™iÚ
:'<?phpƒcho $condition;?>'};

6 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_object_json?obj_type=<?phpƒcho $ObjType; ?>";

7 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

8 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

9 
v¬
 
O³¿tiÚ
 = [

10 {
T™Ë
:'åˆ é™¤',
U¾
:'javasüt:void(0);',
Js
:"dÉ('{"+
key©ŒÇme
+"}','<?ph°echØ$ObjTy³; ?>','#<?ph°echØ$DŸlogID;?>_ajax_·ge_cÚ‹Á','<?ph°echØba£_u¾(); ?>šdex.php/www/objeùs/li¡_jsÚ?obj_ty³=<?ph°echØ$ObjTy³; ?>')",
Css
:'fa fa-trash-o„ed'},

12 
	`$
("#<?ph°echØ$DŸlogID;?>_ajax_·ge_cÚ‹Á").
	`L“TabË
({

13 
TabËHeight
:100,

14 
U¾
:
u¾
,

15 
O³¿tiÚ
:Operation,

16 
CŞ
:
cŞ
,

17 
KeyA‰rName
:
key©ŒÇme
,

18 
po¡D©a
:
·¿ms
,

19 
IsNÙPage
:1

21 
	}
});

23 
funùiÚ
 
	$dÉ
(
id
, 
obj_ty³
, 
grid_£ËùÜ
, 
u¾
) {

24 ià(
	`cÚfœm
("ç¡®å®šè¦åˆ é™¤æ•°æ®å—ï¼Ÿ")) {

25 
v¬
 
d–_u¾
 = "<?ph°echØs™e_u¾("
www
/
objeùs
/
d–
?
maš_ty³
=".$obj_ty³."&
mid
=".$id); ?>";

26 
$
.
	`ajax
({

27 
ty³
: "GET",

28 
u¾
: 
d–_u¾
,

29 
d©a
: {
id
: id, 
obj_ty³
: obj_type},

30 
sucûss
: 
	`funùiÚ
 (
d©a
) {

31 ià(
d©a
 == "success") {

32 
	`®”t
("åˆ é™¤æ•°æ®æˆåŠŸ");

33 
	`jQu”y
(
grid_£ËùÜ
).
	`L“TabË
('SetGridParam');

35 
	`®”t
(
d©a
);

40 
	}
}

41 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/assign_staff.php

1 <
süt
 
	gty³
="text/javascript">

2 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

3 
	`$
("#"+"<?ph°echØ$_GET['bu‰Ú']?>_sub").
	`AjaxDŸlog
({

4 
DŸlogU¾
: "<?ph°echØba£_u¾()?>šdex.php/www/objeùs/di¡ributiÚ?em¶oy“s=<?ph°echØ$_GET["
em¶oy“s
"]?>&sel=<?phpƒcho $ObjType; ?>"+"&obj_type=99&div_id=<?phpƒcho $div_id?>",

5 
DŸlogT™Ë
: "æ‰¹é‡åˆ†é…å‘˜å·¥",

6 
DŸlogWidth
: 800,

7 
DŸlogHeight
: 500});

9 
	`$
("#qx").
	`şick
(
	`funùiÚ
(){

10 
	`$
("#em¶oy“s").
	`·»Á
().
	`dŸlog
('close');

13 
	}
});

14 </
	gsüt
>

15 <
div
 
	g¡yË
="width:100px;m¬gš-Ëá:‡uto;m¬gš-right:‡uto;m¬gš-tİ: 30px" 
id
="employees">

16 <
div
>

17 <
div
><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="1">æ›´æ–°é€‰ä¸­è®°å½•</div>

18 <
div
 
¡yË
="m¬gš-tİ: 15px"><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="2">æ›´æ–°å½“å‰åˆ—è¡¨</div>

20 </
div
>

21 <
div
 
¡yË
="margin-top: 40px">

22 <
šput
 
v®ue
="ç¡®å®š" 
ty³
="bu‰Ú" 
id
="<?phpƒcho $_GET['button']?>_sub">

23 <
šput
 
v®ue
="å–æ¶ˆ" 
ty³
="bu‰Ú" 
id
="qx">

24 </
div
>

25 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/batch_up.php

1 <
	g¡yË
>

2 .
	gup_div
{

3 
	gwidth
:400
px
;
	gm¬gš
-
	gËá
:‡uto;m¬gš-
	gright
:‡uto;

8 .
up_div
 
div
 
	gdiv
 {

9 
	gm¬gš
-
	gtİ
: 10
px
;

10 
	gm¬gš
-
	gËá
: 50
px
;

12 .
	gsub
 {

13 
	gm¬gš
-
	gtİ
: 10
px
;

15 .
sub
 
div
 
	gšput
 {

16 
	gm¬gš
-
	gËá
: 80
px
;

18 .
	gšput
-
	ggroup
{

19 
	gwidth
: 150
px
;

22 </
	g¡yË
>

23 <
süt
 
	gty³
="text/javascript">

24 
$
.
ajax
({

25 
u¾
 : "<?ph°echØba£_u¾()?>šdex.php/www/objeùs/b©ch_up_©Œ?obj_ty³="+<?
php
 
echo
 
$ObjTy³
?>,

26 
d©aTy³
:"json",

27 
sucûss
:
funùiÚ
(
d©a
){

28 
v¬
 
html
 = '<option value=""></option>'

29 
$
.
—ch
(
d©a
,
funùiÚ
(
idx
,
™em
){

30 
html
 +ğ'<İtiÚ v®ue="'+
™em
.
ATTR_NAME
+'">'+™em.
LABEL
+'</option>'

32 
$
("#up_£l").
html
(html)

35 
$
(
	$funùiÚ
(){

37 
$
.
	`ajax
({

38 
u¾
:"<?ph°echØba£_u¾()?>šdex.php/www/objeùs/£Ëù_d©a?obj_ty³="+<?
php
 
echo
 
$ObjTy³
?>,

39 
sucûss
:
	`funùiÚ
(
d©as
){

40 
	`$
("#jsÚ").
	`v®
(
d©as
)

44 
	`$
("#up_£l").
	`chªge
(
	`funùiÚ
(){

45 
v¬
 
v®ue
 = 
	`$
(
this
).
	`v®
();

46 
v¬
 
obj
 = 
	`ev®
('(' + 
	`$
("#jsÚ").
	`v®
() + ')');

47 
$
.
	`—ch
(
obj
,
	`funùiÚ
(
idx
,
™em
){

48 ià(
™em
.
Çme
 =ğ
v®ue
) {

50 if(
™em
.
©Œ_ty³
 == 13){

51 
v¬
 
html
 = '<select style="width:200px;"‚ame="up_sel_value"><option value=""></option>'

52 
$
.
	`—ch
(
™em
.
fÜm_d©a
.
’um_¬r
,
	`funùiÚ
(
idx
,item){

53 
html
 +ğ'<İtiÚ v®ue="'+
™em
.
’um_key
+'">'+™em.
’um_v®ue
+'</option>'

55 
html
 += "</select>"

56 
	`$
("#upd©e").
	`html
(
html
);

57 }if(
™em
.
©Œ_ty³
 == 18){

58 
v¬
 
id
 = 
™em
.
Çme
.
	`»¶aû
('.', "_")

59 
v¬
 
html
 = '<div cÏss="šput-group"><špuˆÇme="up_£l_v®ue" styË="width:150px;" id="'+
id
+'"></div>';

60 
	`$
("#upd©e").
	`html
(
html
);

61 
	`ajax_aá”
(
id
,
™em
.
Çme
,™em.
fÜm_d©a
.
ObjName
,™em.fÜm_d©a.
RefU¾
)

62 }if(
™em
.
©Œ_ty³
 == 11){

63 
	`$
("#upd©e").
	`html
('<inputype="checkbox" style="width:200px;" class="myCheck"><inputype="hidden"‚ame="up_sel_value" value="0">')

64 
	`ajax_check
()

66 
	`$
("#upd©e").
	`html
('<input‚ame="up_sel_value" style="width:200px;">')

73 
	`$
("#qx").
	`şick
(
	`funùiÚ
(){

74 
	`$
(".up_div").
	`·»Á
().
	`dŸlog
('close');

76 
	`$
("#subm™").
	`şick
(
	`funùiÚ
(){

78 
v¬
 
d©a
 = "";

79 
v¬
 
¿dio
 = 
	`$
('šput:¿dio[Çme=upd©e]:checked').
	`v®
();

81 if(
¿dio
 == "2") {

82 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

83 ià(
d©a
 == "") {

84 
d©a
 = 
	`$
(
this
).
	`v®
();

86 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

89 }ià(
¿dio
 == "1"){

90 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

91 ià(
d©a
 == "") {

92 
d©a
 = 
	`$
(
this
).
	`v®
();

94 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

99 
d©a
 = d©a.
	`»¶aû
(/
Ú
,/, "");

101 if(
¿dio
 =ğ
undefšed
 || 
d©a
.
Ëngth
 == 0 ){

102 
	`®”t
("è¯·é€‰æ‹©æ›´æ–°æ•°æ®")

105 
cÚsŞe
.
	`log
(
d©a
);

106 
cÚsŞe
.
	`log
(
	`$
("#cÚ‹Á").
	`£rŸlize
())

107 
$
.
	`ajax
({

108 
u¾
:"<?ph°echØba£_u¾()?>šdex.php/www/objeùs/b©ch_d©a?id="+
d©a
+"&obj_ty³="+<?
php
 
echo
 
$ObjTy³
?>,

109 
ty³
:"post",

110 
d©a
:
	`$
("#cÚ‹Á").
	`£rŸlize
(),

111 
sucûss
:
	`funùiÚ
(
d©a
){

112 if(
d©a
 =="success"){

113 
	`®”t
("ä¿®æ”¹æˆåŠŸ")

114 
	`$
(".up_div").
	`·»Á
().
	`dŸlog
('close');

115 
	`jQu”y
("#<?ph°echØ$div_id?>").
	`L“TabË
('SetGridParam');

117 
	`®”t
(
d©a
)

128 
	}
})

129 
funùiÚ
 
	$ajax_check
(){

130 
	`$
(".myCheck").
	`şick
(
	`funùiÚ
(){

131 ifĞ
	`$
(
this
).
	`´İ
("checked") ) {

132 
	`$
(
this
).
	`Ãxt
().
	`v®
("1")

134 
	`$
(
this
).
	`Ãxt
().
	`v®
("0")

137 
	}
}

138 
funùiÚ
 
	$ajax_aá”
(
id
,
Çme
,
Ïb–
,
u¾
){

139 
	`$
("#"+
id
).
	`QuÙeIn™Ÿl
({

140 
u¾
:url,

141 
t™Ë
:
Ïb–
,

142 
Çme
:name

146 
	}
}

148 </
	gsüt
>

149 <
div
 
	gşass
="up_div">

150 <
fÜm
 
id
="content">

151 <
div
 
şass
="content">

152 <
div
><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="1">æ›´æ–°é€‰ä¸­è®°å½•</div>

153 <
div
><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="2">æ›´æ–°å½“å‰åˆ—è¡¨</div>

154 <
div
>ã€€æ›´æ–°&
nb¥
;&
	gnb¥
;<
£Ëù
 
	g¡yË
="width:200px;" 
id
="up_£l" 
Çme
="up_sel_attr"></select>

155 </
div
>

156 <
div
><
¥ª
 
¡yË
="æßt:†eá;">ä¿®æ”¹ä¸º&
nb¥
;&
	gnb¥
;</
	g¥ª
><¥ª 
	gid
="upd©e"><
£Ëù
 styË="width:200px;" 
Çme
="up_sel_value"></select></span>

157 </
div
>

158 <
div
><
šput
 
ty³
="checkbox" 
Çme
="background">åå°å¤„ç†</div>

159 <
div
 
¡yË
="height: 50px"></div>

160 </
div
>

161 </
fÜm
>

162 <
div
 
şass
="sub">

163 <
div
><
šput
 
ty³
="bu‰Ú" 
v®ue
="æäº¤" 
id
="submit" id=""><inputype="button" value="å–æ¶ˆ" id="qx"></div>

164 </
div
>

165 </
div
>

166 <
šput
 
ty³
="hidd’" 
id
="json">

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/button.php

1 <
a
 
	gh»f
="<?phpƒcho base_url(); ?>index.php/www/objects/add?obj_type=<?phpƒcho $ObjType; ?>&type_id=91">

2 <
bu‰Ú
 
şass
="btn">

3 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

5 </
bu‰Ú
>

6 </
a
>

7 <
bu‰Ú
 
id
='Ëad_§Ë_£niÜqu”y' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
süt
 
ty³
="text/javascript">

13 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

14 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

15 
	`$
("#Ëad_§Ë_£niÜqu”y").
	`S’iÜQu”y
({

16 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

17 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

18 
Li¡Div
: "<?phpƒcho $ListDiv; ?>"

21 
	}
});

22 </
	gsüt
>

23 <
bu‰Ú
 
	gşass
="bŠ bŠ-šfo" 
id
="import">

24 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

26 </
bu‰Ú
>

27 <
süt
 
ty³
="text/javascript">

29 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

31 
	`$
("#impÜt").
	`AjaxDŸlog
({

32 
DŸlogU¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/import?obj_type=<?phpƒcho $ObjType; ?>",

33 
DŸlogT™Ë
: "æ‰¹é‡å¯¼å…¥",

34 
DŸlogWidth
: 700,

35 
DŸlogHeight
: 400

37 
	`$
("#b©ch_up").
	`AjaxDŸlog
({

38 
DŸlogU¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/batchUp",

39 
DŸlogT™Ë
: "æ‰¹é‡æ›´æ–°",

40 
DŸlogWidth
: 500,

41 
DŸlogHeight
: 400

45 
	}
});

46 </
	gsüt
>

47 <
bu‰Ú
 
	gşass
="bŠ bŠ-sucûss" 
id
="export">

49 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

51 </
bu‰Ú
>

53 <
süt
 
ty³
="text/javascript">

56 
$
("#expÜt").
şick
(
	$funùiÚ
 () {

57 
v¬
 
d©a
 = "";

58 
$DŸlogDivID
 = "DŸlogDiv" + 
	`$
(
this
).
	`©Œ
("id")

59 
	`$
("šput[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

60 ià(
d©a
 == "") {

61 
d©a
 = 
	`$
(
this
).
	`v®
();

63 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

68 ià(
	`$
('#' + 
$DŸlogDivID
).
Ëngth
 == 0) {

69 
	`$
(
this
).
	`aá”
('<div id="' + 
$DŸlogDivID
 + '" style="display:none;"></div>');

71 
$
.
	`ajax
({

73 'd©a': {"d©a": 
d©a
},

74 'sucûss': 
	`funùiÚ
 (
d©a
) {

75 
	`$
('#' + 
$DŸlogDivID
).
	`html
(
d©a
);

78 'ÿche': 
çl£


80 
	`$
("#" + 
$DŸlogDivID
).
	`dŸlog
({

81 
t™Ë
: "æ‰¹é‡å¯¼å‡º",

82 
mod®
: 
Œue
,

83 
width
: 400,

84 
height
: 220,

85 
bu‰Ús
: [

87 
‹xt
: "æŸ¥è¯¢",

88 
CÏss
: "btn bottom-margin btn-primary",

89 
şick
: 
	`funùiÚ
 () {

91 
	`$
(
this
).
	`dŸlog
("close");

95 
‹xt
: "å–æ¶ˆ",

96 
CÏss
: "btn bottom-margin btn-danger ",

97 
şick
: 
	`funùiÚ
 () {

98 
	`$
(
this
).
	`dŸlog
("close");

103 
	`$
('#' + 
$DŸlogDivID
).
	`dŸlog
('open');

116 
	}
});

119 </
	gsüt
>

122 <
bu‰Ú
 
	gşass
="bŠ bŠ-w¬nšg" 
id
="batch_up">

123 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

125 </
bu‰Ú
>

126 <!-- <
bu‰Ú
 
şass
="btn btn-danger">-->

127 <!-- <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>-->

129 <!-- </
bu‰Ú
>-->

130 <!--<
bu‰Ú
 
şass
="btn btn-inverse">-->

131 <!-- <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>-->

133 <!--</
bu‰Ú
>-->

134 <
bu‰Ú
 
şass
="btn btn-pink">

135 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

137 </
bu‰Ú
>

138 <
div
 
şass
="hr hr-dotted hr-16"></div>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/detail.php

1 <
div
 
	gşass
="row">

2 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

3 </
div
>

5 <
süt
 
ty³
="text/javascript">

6 
jQu”y
(
	$funùiÚ
 () {

7 
	`$
("#d‘a").
	`L“TabË
({

19 
CŞ
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞ
);?>,

23 
IsEd™
:
Œue


25 
	}
})

26 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/detail_check.php

1 <
div
 
	gşass
="<?phpƒcho $DialogID; ?>_ajax_page_content">

3 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

4 <
div
 
şass
="row">

6 <
div
 
şass
="col-xs-12">

7 <
bu‰Ú
 
id
='<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
bu‰Ú
 
id
='G‘S–eùedA‰r' 
şass
="btn btn-primary">

12 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

14 </
bu‰Ú
>

15 <
a
 
id
="GetSelectedAttr"> </a>

16 <
süt
 
ty³
="text/javascript">

18 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

19 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

20 
	`$
("#<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y").
	`S’iÜQu”y
({

21 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

22 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

23 
Li¡Div
: "#<?phpƒcho $DialogID; ?>_grid_table"

26 
	}
});

28 </
	gsüt
>

29 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

30 </
div
>

32 <
div
 
şass
="cŞ-xs-12" 
id
="<?phpƒcho $DialogID; ?>_page_content">

33 </
div
><!-- /.
cŞ
 -->

34 </
div
><!-- /.
row
 -->

35 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

37 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

38 <
süt
 
ty³
="text/javascript">

39 
funùiÚ
 
	$aá”
(
id
, 
Çme
, 
Ïb–
, 
u¾
) {

40 
	`$
("#" + 
id
).
	`QuÙeIn™Ÿl
({

41 
u¾
: url,

42 
t™Ë
: 
Ïb–
,

43 
Çme
:‚ame

45 
	}
}

46 
jQu”y
(
	$funùiÚ
 (
$
) {

47 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>";

48 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

49 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

50 
	`$
("#<?ph°echØ$DŸlogID; ?>_·ge_cÚ‹Á").
	`L“TabË
({

51 
U¾
:
u¾
,

52 
CŞ
:
cŞ
,

53 
MuÉiS–eù
:
Œue
,

54 
MuÉiTy³
:0,

55 
KeyA‰rName
:
key©ŒÇme


57 
v¬
 
myd©a
 = 
$
.
	`·r£JSON
Ğ
	`$
("#¡r").
	`v®
() )

58 
v¬
 
İ”©iÚ
 = 
$
.
	`·r£JSON
Ğ
	`$
("#İ”©iÚ").
	`v®
() )

59 
v¬
 
i
 = "<?phpƒcho $index ?>";

60 
	`$
('#G‘S–eùedA‰r').
	`şick
(
	`funùiÚ
(){

61 
v¬
 
©Œ
 = 
	`$
("#<?ph°echØ$objName[0]['LABEL'] ?>_·ge-cÚ‹Á").
	`L“TabË
('GetSelectedAttr');

62 
v¬
 
´oduù
;

63 
v¬
 
¡ªd¬dPriû
;

64 
v¬
 
id
 ;

65 
$
.
	`—ch
(
©Œ
,
	`funùiÚ
(
k
,
v
){

66 
i
++;

67 
´oduù
 = 
v
["Product.Name"]

68 
¡ªd¬dPriû
 = 
v
["Product.StandardPrice"]

69 
id
 = 
v
[" Product.ID"]

70 
	`jQu”y
("#li¡4").
	`jqGrid
('addRowD©a', 
i
, 
myd©a
);

71 
v¬
 
šputs
 = 
	`$
("#" + 
i
).
	`chd»n
().
	`fšd
("input");

72 
šputs
.
	`—ch
(
	`funùiÚ
 () {

73 
v¬
 
šdex
 = 
	`$
(
this
).
	`©Œ
("class");

74 ià(
šdex
.
	`šdexOf
(18) != -1) {

75 
v¬
 
idd
 = 
	`$
(
this
).
	`©Œ
("id"è+ 
i


76 
	`$
(
this
).
	`©Œ
("id", 
idd
)

77 
v¬
 
u¾
 = 
	`$
(
this
).
	`©Œ
("u")

78 
v¬
 
Ïb–
 = 
	`$
(
this
).
	`©Œ
("l")

79 
v¬
 
Çme
 = 
	`$
(
this
).
	`©Œ
("name")

80 
	`aá”
(
idd
, 
Çme
, 
Ïb–
, 
u¾
)

82 
cÚsŞe
.
	`log
(
k
)

83 
cÚsŞe
.
	`log
(
	`$
(
this
).
	`Ãxt
())

85 
	`$
(
this
).
	`Ãxt
().
	`v®
(
k
)

86 
cÚsŞe
.
	`log
(
	`$
(
this
).
	`Ãxt
())

89 ià(
šdex
.
	`šdexOf
(
İ”©iÚ
["results"]) != -1) {

90 
	`$
(
this
).
	`©Œ
("readonly", "readonly")

92 ià(
šdex
.
	`šdexOf
(
İ”©iÚ
["first"]) != -1) {

93 
v¬
 
Ï¡_obj
;

94 
v¬
 
»suÉs_obj
;

95 
šputs
.
	`—ch
(
	`funùiÚ
 () {

96 
v¬
 
šdex2
 = 
	`$
(
this
).
	`©Œ
("class");

97 ià(
šdex2
.
	`šdexOf
(
İ”©iÚ
["last"]) != -1) {

98 
Ï¡_obj
 = 
this
;

99 
	`$
(
this
).
	`v®
(0)

101 ià(
šdex2
.
	`šdexOf
(
İ”©iÚ
["results"]) != -1) {

102 
»suÉs_obj
 = 
this
;

105 
	`$
(
this
).
	`blur
(
	`funùiÚ
 () {

106 
v¬
 
fœ¡
 = 
	`·r£Flßt
(
	`$
(
this
).
	`v®
())

107 
v¬
 
Ï¡
 = 
	`·r£Flßt
(
	`$
(
Ï¡_obj
).
	`v®
())

108 ià(
İ”©iÚ
["symbol"] == "/") {

109 ià(
Ï¡
 != 0) {

110 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
/
Ï¡
)

112 }if(
İ”©iÚ
["symbol"] == "*"){

113 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
*
Ï¡
)

114 }if(
İ”©iÚ
["symbol"] == "-"){

115 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
-
Ï¡
)

116 } if(
İ”©iÚ
["symbol"] == "+"){

117 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
+
Ï¡
)

124 ià(
šdex
.
	`šdexOf
(
İ”©iÚ
["last"]) != -1) {

125 
v¬
 
fœ¡_obj
;

126 
v¬
 
»suÉs_obj
;

127 
šputs
.
	`—ch
(
	`funùiÚ
 () {

128 
v¬
 
šdex3
 = 
	`$
(
this
).
	`©Œ
("class");

129 ià(
šdex3
.
	`šdexOf
(
İ”©iÚ
["first"]) != -1) {

130 
fœ¡_obj
 = 
this
;

131 
	`$
(
this
).
	`v®
(0)

133 ià(
šdex3
.
	`šdexOf
(
İ”©iÚ
["results"]) != -1) {

134 
»suÉs_obj
 = 
this
;

137 
	`$
(
this
).
	`blur
(
	`funùiÚ
 () {

138 
v¬
 
Ï¡
 = 
	`·r£Flßt
(
	`$
(
this
).
	`v®
());

139 
v¬
 
fœ¡
 = 
	`·r£Flßt
(
	`$
(
fœ¡_obj
).
	`v®
());

140 ià(
İ”©iÚ
["symbol"] == "/") {

141 ià(
Ï¡
 != 0) {

142 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
/
Ï¡
)

144 }if(
İ”©iÚ
["symbol"] == "*"){

145 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
*
Ï¡
)

146 }if(
İ”©iÚ
["symbol"] == "-"){

147 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
-
Ï¡
)

148 } if(
İ”©iÚ
["symbol"] == "+"){

149 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
+
Ï¡
)

155 ià(
šdex
.
	`šdexOf
(15) != -1) {

156 
	`$
(
this
).
	`d©•ick”
();

158 
	`$
(".3").
	`ÚlyMÚey
();

159 
	`$
(".1").
	`ÚlyNum
();

161 
	`$
("#"+
i
).
	`chd»n
().
	`fšd
(".add").
	`AjaxDŸlog
({

162 
DŸlogU¾
: "<?ph°echØba£_u¾()?>šdex.php/www/objeùs/d‘a_sšgË?obj_ty³=9&id="+
i
,

163 
DŸlogT™Ë
: "ä»·æ ¼è¡¨äº§å“",

164 
DŸlogWidth
: 800,

165 
DŸlogHeight
: 500,

167 
	`$
("#"+
i
).
	`chd»n
().
	`fšd
(".d–").
	`şick
(
	`funùiÚ
(){

168 
	`$
(
this
).
	`·»Á
().·»Á().
	`»move
();

171 
šputs
.
	`—ch
(
	`funùiÚ
(){

172 
v¬
 
Çme
 = 
	`$
(
this
).
	`©Œ
("name")

173 if(
Çme
.
	`šdexOf
('Product') != -1){

174 
	`$
(
this
).
	`v®
(
´oduù
)

175 }if(
Çme
.
	`šdexOf
('StandardPrice') != -1){

176 
	`$
(
this
).
	`v®
(
¡ªd¬dPriû
)

185 
	}
});

187 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/detail_single.php

1 <
div
 
	gşass
="<?phpƒcho $DialogID; ?>_ajax_page_content">

3 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

4 <
div
 
şass
="row">

6 <
div
 
şass
="col-xs-12">

7 <
bu‰Ú
 
id
='<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
bu‰Ú
 
id
='G‘S–eùedA‰r' 
şass
="btn btn-primary">

12 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

14 </
bu‰Ú
>

15 <
a
 
id
="GetSelectedAttr"> </a>

16 <
süt
 
ty³
="text/javascript">

18 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

19 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

20 
	`$
("#<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y").
	`S’iÜQu”y
({

21 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

22 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

23 
Li¡Div
: "#<?phpƒcho $DialogID; ?>_grid_table"

26 
	}
});

28 </
	gsüt
>

29 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

30 </
div
>

32 <
div
 
şass
="cŞ-xs-12" 
id
="<?phpƒcho $DialogID; ?>_page_content">

33 </
div
><!-- /.
cŞ
 -->

34 </
div
><!-- /.
row
 -->

35 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

37 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

38 <
süt
 
ty³
="text/javascript">

39 
jQu”y
(
	$funùiÚ
 (
$
) {

40 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>";

41 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

42 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

43 
	`$
("#<?ph°echØ$DŸlogID; ?>_·ge_cÚ‹Á").
	`L“TabË
({

44 
U¾
:
u¾
,

45 
CŞ
:
cŞ
,

46 
MuÉiS–eù
:
Œue
,

47 
MuÉiTy³
:0,

48 
KeyA‰rName
:
key©ŒÇme


51 
	`$
('#G‘S–eùedA‰r').
	`şick
(
	`funùiÚ
(){

52 
v¬
 
©Œ
 = 
	`$
("#<?ph°echØ$objName[0]['LABEL'] ?>_·ge-cÚ‹Á").
	`L“TabË
('GetSelectedAttr');

53 
v¬
 
´oduù
;

54 
v¬
 
¡ªd¬dPriû
;

55 
v¬
 
id
 ;

56 
$
.
	`—ch
(
©Œ
,
	`funùiÚ
(
k
,
v
){

57 
´oduù
 = 
v
["Product.Name"]

58 
¡ªd¬dPriû
 = 
v
["Product.StandardPrice"]

59 
id
 = 
v
[" Product.ID"]

61 
v¬
 
šput
 = 
	`$
("#<?ph°echØ$id?>").
	`chd»n
().
	`fšd
("input")

62 
šput
.
	`—ch
(
	`funùiÚ
(){

63 
v¬
 
Çme
 = 
	`$
(
this
).
	`©Œ
("name")

64 if(
Çme
.
	`šdexOf
('Product.ID') != -1){

65 
	`$
(
this
).
	`v®
(
id
)

66 
	`$
(
this
).
	`´ev
().
	`v®
(
´oduù
)

67 }if(
Çme
.
	`šdexOf
('StandardPrice') != -1){

68 
	`$
(
this
).
	`v®
(
¡ªd¬dPriû
)

76 
	}
});

78 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/distribution.php

1 <
div
 
	gşass
="<?phpƒcho $DialogID; ?>_ajax_page_content">

3 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

4 <
div
 
şass
="row">

6 <
div
 
şass
="col-xs-12">

7 <
bu‰Ú
 
id
='<?ph°echØ$DŸlogID; ?>_sub' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
bu‰Ú
 
id
="sub<?ph°echØ$_GET["
em¶oy“s
"]?>" 
şass
="btn btn-primary">

12 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

14 </
bu‰Ú
>

15 <
süt
 
ty³
="text/javascript">

17 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

18 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

20 
	`$
("#<?ph°echØ$DŸlogID; ?>_sub").
	`S’iÜQu”y
({

21 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

22 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

23 
Li¡Div
: "#<?phpƒcho $DialogID; ?>_page_content"

26 
	}
});

28 </
	gsüt
>

29 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

30 </
div
>

32 <
div
 
şass
="cŞ-xs-12" 
id
="<?phpƒcho $DialogID; ?>_page_content">

33 </
div
><!-- /.
cŞ
 -->

34 </
div
><!-- /.
row
 -->

35 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

36 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

37 <
div
>

38 <
šput
 
ty³
="‹xt" 
Çme
="·ge_’d" 
id
="<?phpƒcho $DialogID; ?>page_end"/>

39 </
div
>

40 <
süt
 
ty³
="text/javascript">

41 
jQu”y
(
	$funùiÚ
 (
$
) {

42 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>";

43 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

44 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

45 
v¬
 
Çm—‰ºame
 = '<?ph°echØ$obj_d©a['
NAME_ATTR_NAME
']?>';

46 
v¬
 
po¡D©a
 = 
nuÎ
;

47 
v¬
 
obj_ty³
 = '<?phpƒcho $ObjType;?>';

48 
v¬
 
robj_ty³
 = '<?phpƒcho $rObjType;?>';

49 if(
obj_ty³
 == '300'){

50 
po¡D©a
 = {
£niÜqu”y
:{
wh”e
:{1:{
©Œ
:'Ty³.ObjeùTy³',
aùiÚ
:'EQUAL',
v®ue
:
robj_ty³
}},
»l
:'1'}};

52 
	`$
("#<?ph°echØ$DŸlogID; ?>_·ge_cÚ‹Á").
	`L“TabË
({

53 
U¾
:
u¾
,

54 
CŞ
:
cŞ
,

55 
MuÉiS–eù
:
Œue
,

56 
MuÉiTy³
:0,

57 
KeyA‰rName
:
key©ŒÇme
,

58 
NameA‰rName
:
Çm—‰ºame
,

59 
po¡D©a
:postData

61 
	`$
("#sub<?ph°echØ$_GET["
em¶oy“s
"]?>").
	`şick
(
	`funùiÚ
(){

62 
v¬
 
d©a
 = "";

63 
v¬
 
¿dio
 = 
	`$
('šput:¿dio[Çme=upd©e]:checked').
	`v®
();

64 if(
¿dio
 == "2") {

65 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

66 ià(
d©a
 == "") {

67 
d©a
 = 
	`$
(
this
).
	`v®
();

69 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

72 }ià(
¿dio
 == "1"){

73 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

74 ià(
d©a
 == "") {

75 
d©a
 = 
	`$
(
this
).
	`v®
();

77 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

82 
d©a
 = d©a.
	`»¶aû
(/
Ú
,/, "");

83 
v¬
 
em¶oy“s
 = "";

84 
	`$
("#"+"<?ph°echØ$DŸlogID; ?>_·ge_cÚ‹Á iÅut[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

85 ià(
em¶oy“s
 == "") {

86 
em¶oy“s
 = 
	`$
(
this
).
	`v®
();

88 
em¶oy“s
 =ƒm¶oy“ + "," + 
	`$
(
this
).
	`v®
();

91 if(
d©a
.
Ëngth
 == 0){

92 
	`®”t
("è¯·é€‰æ‹©åˆ†é…æ•°æ®");

95 if(
em¶oy“s
.
Ëngth
 == 0){

96 
	`®”t
("è¯·é€‰æ‹©å‘˜å·¥æ•°æ®");

102 
$
.
	`ajax
({

103 
u¾
:"<?ph°echØba£_u¾(); ?>šdex.php/www/objeùs/š_»l_u£r?em¶oy“s=<?ph°echØ$_GET["
em¶oy“s
"]?>&obj_type=<?phpƒcho $sel; ?>",

104 
ty³
:"post",

105 
d©a
:{
id
:d©a,
u£rs
:
em¶oy“s
},

106 
sucûss
:
	`funùiÚ
(
d©a
){

107 if(
d©a
 =="success"){

108 
	`®”t
("æ‰¹é‡æ›´æ–°æˆåŠŸ")

109 
wšdow
.
hi¡Üy
.
	`go
(0)

111 
	`®”t
("æ‰¹é‡æ›´æ–°å¤±è´¥")

116 
	}
});

120 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/edit.php

2 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

3 <
div
 
şass
="main-content">

4 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

5 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

6 <
ul
 
şass
="breadcrumb">

7 <
li
>

8 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

9 <
a
 
h»f
="<?phpƒcho base_url();?>index.php/www">é¦–é¡µ</a>

10 </
li
>

11 <
li
 
şass
="aùive"><
a
 
h»f
="<?ph°echØba£_u¾();?>šdex.php/www/objeùs/li¡s?obj_ty³=<?ph°echØ$obj_ty³;?>"><?
php
 
echo
 
$diù
;?>åˆ—è¡¨</
	ga
></
	gli
>

12 <
	gli
><?
php
 
echo
 
	g$Ëad_d©a
[
$moduË
.'.Name']; ?></li>

13 </
	gul
><!-- /.
	gb»adüumb
 -->

14 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

15 </
div
>

17 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

18 <
div
 
şass
="page-content">

19 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

20 <
div
 
şass
="page-header">

21 <
h1
>

22 <?
php
 
echo
 
$Ëad_d©a
[
$moduË
.'.Name']; ?>

23 <
	gsm®l
>

24 <?
php
 
echo
 
	g$moduË
;?> 
	gEd™


25 </
	gsm®l
>

26 </
	gh1
>

27 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

29 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

30 <
div
 
	gşass
="row">

31 <
fÜm
 
id
="FÜm" 
Úsubm™
="return false">

32 <
šput
 
ty³
="hidd’" 
Çme
="<?ph°echØ$´im¬y['key']; ?>" 
v®ue
="<?phpƒcho $primary['value']; ?>"/>

33 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_mod–" 
v®ue
="<?phpƒcho $module; ?>"/>

34 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_aùiÚ" 
v®ue
="module_update"/>

35 <
div
 
şass
="col-xs-12">

36 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

37 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

39 </
bu‰Ú
>

40 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

41 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

43 </
bu‰Ú
>

44 <
div
 
şass
="hr hr-dotted hr-16"></div>

45 </
div
>

47 <
div
 
şass
="cŞ-xs-12" 
id
="EditFormat"></div>

48 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

49 <
div
 
şass
="col-xs-12">

50 <
div
 
şass
="hr hr-dotted hr-16"></div>

51 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

52 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

54 </
bu‰Ú
>

55 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

56 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

58 </
bu‰Ú
>

59 </
div
>

60 </
fÜm
>

61 <
süt
 
ty³
="text/javascript">

63 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

64 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
); ?>;

65 
	`$
("#Ed™FÜm©").
	`FÜm©
({

66 
ty³
: "edit",

67 
FÜm©D©a
: 
fÜm©_d©a
,

68 
FromID
: "Form",

69 
S–eùChdEnumsU¾
: '<?phpƒcho base_url(); ?>index.php/admin/enum/SelectChildEnums'

71 
v¬
 
d_obj_Çme
 = "<?phpƒcho $dtl_obj_name?>";

72 
v¬
 
KeyA‰rName
 = "<?phpƒcho $KeyAttrName?>";

74 if(
d_obj_Çme
.
Ëngth
 != 0){

75 
	`$
("#d‘a").
	`L“TabË
({

76 
CŞ
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞl
);?>,

77 
IsEd™
:
Œue
,

78 
KeyA‰rName
:KeyAttrName

80 
	`$
("#d‘a").
	`L“TabË
('AddRowD©a',<?
php
 
echo
 
	`jsÚ_’code
(
$ûÎs
);?>);

82 
	}
});

83 </
	gsüt
>

84 </
	gdiv
><!-- /.
	grow
 -->

85 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

87 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

88 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

89 <
süt
 
	gty³
="text/javascript">

91 
$
("#FÜm").
v®id©e
({

92 
subm™HªdËr
: 
funùiÚ
() {

93 
v¬
 
d©a
 = 
$
("#FÜm").
£rŸlizeA¼ay
();

94 
v¬
 
ld©a
 = <?
php
 
echo
 
jsÚ_’code
(
$Ëad_d©a
)?>;

95 
$
.
ajax
({

97 'd©a':{'d©a':
d©a
,

98 'ld©a':
ld©a


100 'sucûss':
funùiÚ
(
d©a
){

102 
d©a
 = 
ev®
("("+data+")");

104 if(
d©a
.
»s
=='suc'){

105 
®”t
(
d©a
.
msg
);

106 
loÿtiÚ
.
h»f
="<?phpƒcho base_url();?>index.php/www/objects/lists?obj_type=<?phpƒcho $obj_type;?>";

108 
®”t
(
d©a
.
msg
);

113 'ÿche':
çl£


119 
$
('[Çme=ÿnûl]').
şick
(
	$funùiÚ
(){

120 
wšdow
.
hi¡Üy
.
	`go
(-1);

121  
çl£
;

122 
	}
});

125 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/export.php

1 <
div
 
	gid
="my-wiz¬d" 
d©a
-
rg‘
="#step-container">

2 <
ul
 
şass
="wizard-steps">

3 <
li
 
d©a
-
rg‘
="#¡•1" 
şass
="active">

4 <
¥ª
 
şass
="step">1</span>

5 <
¥ª
 
şass
="title">æ­¥éª¤ä¸€</span>

6 </
li
>

7 <
li
 
d©a
-
rg‘
="#step2">

8 <
¥ª
 
şass
="step">2</span>

9 <
¥ª
 
şass
="title">æ­¥éª¤äºŒ</span>

10 </
li
>

11 <
li
 
d©a
-
rg‘
="#step3">

12 <
¥ª
 
şass
="step">3</span>

13 <
¥ª
 
şass
="title">å¯¼å‡ºå®Œæˆ</span>

14 </
li
>

15 </
ul
>

16 </
div
>

18 <
div
 
şass
="¡•-cÚ‹Á" 
id
="step-container">

19 <
fÜm
 
şass
="fÜm-hÜizÚl" 
id
="§m¶e-fÜm" 
m‘hod
ğ"po¡" 
’ùy³
="muÉ¬t/fÜm-d©a" 
aùiÚ
="<?phpƒcho base_url();?>index.php/www/objects/export_csv">

20 <
div
 
şass
="¡•-·Ã‡ùive" 
id
="step1">

21 <
šput
 
ty³
="hidd’" 
Çme
="obj_ty³" 
v®ue
="<?phpƒcho $obj_type?>">

22 <!-- 
¡•
 1 -->

23 <
´e
>è¯·é€‰æ‹©éœ€è¦å¯¼å‡ºçš„æ•°æ®ã€‚</pre>

24 <
div
 
şass
="form-group">

26 <
div
 
şass
="radio">

27 <
Ïb–
>

28 <
šput
 
şass
="aû" 
ty³
="¿dio" 
Çme
="expÜt_li¡" 
v®ue
="0">

29 <
¥ª
 
şass
="lbl"> å¯¼å‡ºé€‰ä¸­è®°å½• </span>

30 <
šput
 
ty³
="hidd’" 
Çme
="£Ëùed_d©a" 
v®ue
="<?phpƒcho $selected_data?>">

31 </
Ïb–
>

32 </
div
>

33 <
div
 
şass
="radio">

34 <
Ïb–
>

35 <
šput
 
şass
="aû" 
ty³
="¿dio" 
Çme
="expÜt_li¡" 
v®ue
="1">

36 <
¥ª
 
şass
="lbl"> å¯¼å‡ºå½“å‰åˆ—è¡¨ </span>

37 </
Ïb–
>

38 </
div
>

41 </
div
>

44 </
div
>

45 <
div
 
şass
="¡•-·Ã" 
id
="step2">

46 <!-- 
¡•
 2 -->

49 </
div
>

50 <
div
 
şass
="¡•-·Ã" 
id
="step3">

51 <!-- 
¡•
 3 -->

52 </
div
>

53 </
fÜm
>

54 </
div
>

56 <
div
 
şass
="wizard-actions">

57 <
bu‰Ú
 
şass
="btn-prev btn">

58 <
i
 
şass
="ace-icon fa fa-arrow-left"></i> ä¸Šä¸€æ­¥

59 </
bu‰Ú
>

60 <
bu‰Ú
 
şass
="bŠ-ÃxˆbŠ bŠ-sucûss" 
d©a
-
Ï¡
="å®Œæˆ" >

61 ä¸‹ä¸€æ­¥ <
i
 
şass
="ace-icon fa fa-arrow-right icon-on-right"></i>

62 </
bu‰Ú
>

63 </
div
>

65 <
süt
 
ty³
="text/javascript">

66 
jQu”y
(
	$funùiÚ
(
$
) {

68 
	`$
('#my-file-input')

69 .
	`aû_fe_šput
()

70 .
	`Ú
('chªge', 
	`funùiÚ
() {

71 
fes
 = 
	`$
(
this
).
	`d©a
('ace_input_files');

75 
	`$
('#my-wizard')

76 .
	`aû_wiz¬d
({

79 .
	`Ú
('chªge' , 
	`funùiÚ
(
e
, 
šfo
) {

85 if(
šfo
.
¡•
==1 && info.
dœeùiÚ
 == 'next'){

86 
v¬
 
d©a2
 = 
	`$
("šput[ty³ôadio]:checked").
	`v®
();

87 
v¬
 
£Ëùed_d©a
 = <?
php
 
echo
 
$£Ëùed_d©a
;?>;

88 
	`®”t
(
£Ëùed_d©a
);

89 if(
d©a2
 == ""){

90 
	`®”t
("è¯·é€‰æ‹©éœ€è¦å¯¼å‡ºçš„æ•°æ®ã€‚");

91 
wiz¬d
.
cu¼’tS‹p
 = 1;

92 
wiz¬d
.
	`£tS‹
();

95 if(
d©a2
 != 1 ){

97 if(
£Ëùed_d©a
 =ğ
nuÎ
 || s–eùed_d©¨=ğ'' || s–eùed_d©¨=ğ
undefšed
){

99 
	`®”t
("è¯·å‹¾é€‰éœ€è¦å¯¼å‡ºçš„æ•°æ®ã€‚");

101 
wiz¬d
.
cu¼’tS‹p
 = 1;

102 
wiz¬d
.
	`£tS‹
();

106 
$
.
	`ajax
({

108 
d©a
:{

109 'expÜt_®l':
d©a2
,

110 '£Ëùed_d©a':
£Ëùed_d©a


113 'sucûss':
	`funùiÚ
(
d©a
){

114 
	`$
('#¡•2').
	`html
(
d©a
);

117 'ÿche':
çl£


120 if(
šfo
.
¡•
==2 && info.
dœeùiÚ
 == 'next'){

121 
v¬
 
d©a
="";

122 
	`$
('#tØİtiÚ').
	`—ch
(
	`funùiÚ
(
k
,
v
){

124 if(
d©a
==""){

125 
d©a
 = 
	`$
(
this
).
	`v®
();

127 
d©a
 = d©a+","+
	`$
(
this
).
	`v®
();

130 
v¬
 
d©a2
 = 
	`$
("šput[ty³ôadio]:checked").
	`v®
();

131 
v¬
 
£Ëùed_d©a
 = <?
php
 
echo
 
$£Ëùed_d©a
;?>;

132 
$
.
	`ajax
({

135 '£Ëùed_Ïb–':
d©a
,

136 'expÜt_®l':
d©a2
,

137 '£Ëùed_d©a':
£Ëùed_d©a
,

139 'sucûss':
	`funùiÚ
(
d©a
){

140 
	`$
('#¡•3').
	`html
(
d©a
);

143 'ÿche':
çl£


147 .
	`Ú
('fšished', 
	`funùiÚ
(
e
) {

149 
	`$
(
this
).
	`şo£¡
("[d©a-Çme='DŸlogDivexpÜt']").
	`dŸlog
("close");

150 }).
	`Ú
('¡•şick', 
	`funùiÚ
(
e
) {

152 
	`®”t
(3);

156 
	}
});

159 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/exportf.php

1 <
	g´e
>æ–‡ä»¶å·²å¯¼å‡ºï¼Œè¯·ç‚¹å‡»ä¸‹è½½</pre>

2 <
bu‰Ú
 
	gşass
="bŠ bŠ-wh™bŠ-šfØbŠ-bŞd" 
id
="download">

3 <
i
 
şass
="ace-icon fa fa-floppy-o bigger-120 blue"></i>

5 </
bu‰Ú
>

6 <
šput
 
ty³
="hidd’" 
Çme
="fe_d©a" 
v®ue
="<?phpƒcho $file_data;?>"/>

7 <
šput
 
ty³
="hidd’" 
Çme
="fe_Çme" 
v®ue
="<?phpƒcho $file_name;?>"/>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/exportm.php

1 <
süt
 
	gty³
="text/javascript">

2 
jQu”y
(
docum’t
).
»ady
(
	$funùiÚ
 () {

4 
	`$
("#addOÃ").
	`şick
(
	`funùiÚ
 () {

5 
	`$
("#äom o±iÚ:£Ëùed").
	`şÚe
().
	`­³ndTo
("#to");

6 
	`$
("#äom o±iÚ:£Ëùed").
	`»move
();

10 
	`$
("#addAÎ").
	`şick
(
	`funùiÚ
 () {

11 
	`$
("#äom o±iÚ").
	`şÚe
().
	`­³ndTo
("#to");

12 
	`$
("#äom o±iÚ").
	`»move
();

16 
	`$
("#»moveOÃ").
	`şick
(
	`funùiÚ
 () {

17 
	`$
("#tØİtiÚ:£Ëùed").
	`şÚe
().
	`­³ndTo
("#from");

18 
	`$
("#tØİtiÚ:£Ëùed").
	`»move
();

22 
	`$
("#»moveAÎ").
	`şick
(
	`funùiÚ
 () {

23 
	`$
("#tØİtiÚ").
	`şÚe
().
	`­³ndTo
("#from");

24 
	`$
("#tØİtiÚ").
	`»move
();

28 
	`$
("#Tİ").
	`şick
(
	`funùiÚ
 () {

29 
v¬
 
®lO±s
 = 
	`$
("#to option");

30 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

32 ià(
£Ëùed
.
	`g‘
(0).
šdex
 != 0) {

33 
i
 = 0; i < 
£Ëùed
.
Ëngth
; i++) {

34 
v¬
 
™em
 = 
	`$
(
£Ëùed
.
	`g‘
(
i
));

35 
v¬
 
tİ
 = 
	`$
(
®lO±s
.
	`g‘
(0));

36 
™em
.
	`š£¹BefÜe
(
tİ
);

42 
	`$
("#Up").
	`şick
(
	`funùiÚ
 () {

43 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

44 ià(
£Ëùed
.
	`g‘
(0).
šdex
 != 0) {

45 
£Ëùed
.
	`—ch
(
	`funùiÚ
 () {

46 
	`$
(
this
).
	`´ev
().
	`befÜe
($(this));

52 
	`$
("#Down").
	`şick
(
	`funùiÚ
 () {

53 
v¬
 
®lO±s
 = 
	`$
("#to option");

54 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

56 ià(
£Ëùed
.
	`g‘
(£Ëùed.
Ëngth
 - 1).
šdex
 !ğ
®lO±s
.length - 1) {

57 
i
 = 
£Ëùed
.
Ëngth
 - 1; i >= 0; i--) {

58 
v¬
 
™em
 = 
	`$
(
£Ëùed
.
	`g‘
(
i
));

59 
™em
.
	`š£¹Aá”
(™em.
	`Ãxt
());

65 
	`$
("#Bu‰om").
	`şick
(
	`funùiÚ
 () {

66 
v¬
 
®lO±s
 = 
	`$
("#to option");

67 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

69 ià(
£Ëùed
.
	`g‘
(£Ëùed.
Ëngth
 - 1).
šdex
 !ğ
®lO±s
.length - 1) {

70 
i
 = 
£Ëùed
.
Ëngth
 - 1; i >= 0; i--) {

71 
v¬
 
™em
 = 
	`$
(
£Ëùed
.
	`g‘
(
i
));

72 
v¬
 
bu‰om
 = 
	`$
(
®lO±s
.
	`g‘
(
Ëngth
 - 1));

73 
™em
.
	`š£¹Aá”
(
bu‰om
);

79 
	}
});

80 </
	gsüt
>

81 <
	gdiv
>

83 </
	gdiv
>

86 <
div
 
	gşass
="w–l" 
¡yË
="height: 65px">

87 <
div
 
¡yË
="æßt:†eá">åœ¨æ­¤å¯ä»¥å°†çº¿ç´¢æ•°æ®å¯¼å‡ºåˆ°
CSV
æ–‡ä»¶ã€‚è¯·é€‰æ‹©å¯¼å‡ºçš„å±æ€§ã€‚</div>

88 <
div
 
¡yË
="float:†eft">

89 å¯¼å‡ºæ–‡ä»¶ç¼–ç ï¼š<
£Ëù
 
id
="codšg" 
Çme
="codšg" 
¡yË
="height: 30px;width:100px;margin-top: -5px">

90 <
İtiÚ
 
v®ue
="utf-8">
utf
-8</option>

91 <
İtiÚ
 
v®ue
="gbk">
gbk
</option>

92 <
İtiÚ
 
v®ue
="gb2312">
gb2312
</option>

93 </
£Ëù
>

94 </
div
>

96 </
div
>

99 </
´e
>

102 <
div
 
şass
="row">

104 <
div
 
şass
="col-xs-12 col-md-5">

106 <
div
 
şass
="well">

107 <
h3
 
şass
="header blue†ighter smaller">

108 <
i
 
şass
="ace-icon fa fa-calendar-o smaller-90"></i>

110 </
h3
>

111 <
£Ëù
 
Çme
="äom" 
id
="äom" 
¡yË
="width:100%;" 
size
="10" 
muÉË
="multiple">

112 <?
php
 
fÜ—ch
 (
$Ëá_li¡
 
as
 
$k
 => 
$v
) {?>

113 <
İtiÚ
 
v®ue
="<?ph°echØ$v['©Œ_Çme'];?>"><?
php
 
echo
 
$v
['Ïb–'];?></
	gİtiÚ
>

114 <?
	gphp
 }?>

115 <?
php
 
fÜ—ch
 (
$»f_Ëá_li¡
 
as
 
$k
 => 
$v
) {?>

116 <
İtiÚ
 
v®ue
="<?ph°echØ$v['©Œ_Çme'];?>"><?
php
 
echo
 
$v
['Ïb–'];?></
	gİtiÚ
>

117 <?
	gphp
 }?>

119 </
	g£Ëù
>

120 </
	gdiv
>

121 </
	gdiv
>

122 <
div
 
	gşass
="col-xs-12 col-md-2">

123 <
div
 
şass
="well with-header">

124 <
h3
 
şass
="header blue†ighter smaller">

126 </
h3
>

127 <
div
 
şass
="span2">

128 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Tİ" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

129 <
i
 
şass
="ace-icon fa fa-angle-double-up bigger-120 blue"></i>

130 </
a
>

131 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Up" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

132 <
i
 
şass
="ace-icon fa fa-angle-up bigger-120 blue"></i>

133 </
a
>

134 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="addOÃ" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

135 <
i
 
şass
="ace-icon fa fa-angle-right bigger-120 blue"></i>

136 </
a
>

137 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="»moveOÃ" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

138 <
i
 
şass
="ace-icon fa fa-angle-left bigger-120 blue"></i>

139 </
a
>

140 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Down" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

141 <
i
 
şass
="ace-icon fa fa-angle-down bigger-120 blue"></i>

142 </
a
>

143 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Bu‰om" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

144 <
i
 
şass
="ace-icon fa fa-angle-double-down bigger-120 blue"></i>

145 </
a
>

146 </
div
>

147 </
div
>

148 </
div
>

149 <
div
 
şass
="col-xs-12 col-md-5">

150 <
div
 
şass
="well with-header">

151 <
h3
 
şass
="header blue†ighter smaller">

152 <
i
 
şass
="ace-icon fa fa-calendar-o smaller-90"></i>

154 </
h3
>

155 <
£Ëù
 
Çme
="to" 
id
="to" 
¡yË
="width:100%;" 
size
="10" 
muÉË
="multiple">

156 <?
php
 
fÜ—ch
 (
$Ïb–s
 
as
 
$k
 => 
$v
) {?>

157 <
İtiÚ
 
v®ue
="<?ph°echØ$v['©Œ_Çme'];?>"><?
php
 
echo
 
$v
['Ïb–'];?></
	gİtiÚ
>

158 <?
	gphp
 }?>

159 </
	g£Ëù
>

160 </
	gdiv
>

161 </
	gdiv
>

162 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/imagesupload.php

2 <
body
 
	gşass
="no-skin">

4 <
div
 
şass
="maš-cÚš”" 
id
="main-container">

5 <
süt
 
ty³
="text/javascript">

6 
Œy
{
aû
.
£‰šgs
.
check
('maš-cÚš”' , 'fixed')}
	$ÿtch
(
e
){
	}
}

7 </
süt
>

10 <
div
 
şass
="main-content">

11 <
div
 
şass
="main-content-inner">

13 <
div
 
şass
="page-content">

14 <
div
 
şass
="aû-£‰šgs-cÚš”" 
id
="ace-settings-container">

15 <
div
 
şass
="bŠ bŠ-­°bŠ-x bŠ-w¬nšg‡û-£‰šgs-bŠ" 
id
="ace-settings-btn">

16 <
i
 
şass
="ace-icon fa fa-cog bigger-130"></i>

17 </
div
>

19 <
div
 
şass
="aû-£‰šgs-box cË¬fix" 
id
="ace-settings-box">

20 <
div
 
şass
="pull-left width-50">

21 <
div
 
şass
="ace-settings-item">

22 <
div
 
şass
="pull-left">

23 <
£Ëù
 
id
="skš-cŞÜpick”" 
şass
="hide">

24 <
İtiÚ
 
d©a
-
skš
="no-skš" 
v®ue
="#438EB9">#438EB9</option>

25 <
İtiÚ
 
d©a
-
skš
="skš-1" 
v®ue
="#222A2D">#222A2D</option>

26 <
İtiÚ
 
d©a
-
skš
="skš-2" 
v®ue
="#C6487E">#C6487E</option>

27 <
İtiÚ
 
d©a
-
skš
="skš-3" 
v®ue
="#D0D0D0">#D0D0D0</option>

28 </
£Ëù
>

29 </
div
>

30 <
¥ª
>&
nb¥
; 
Choo£
 
	gSkš
</
	g¥ª
>

31 </
	gdiv
>

33 <
div
 
	gşass
="ace-settings-item">

34 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-navbar" />

35 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-Çvb¬"> 
Fixed
 
Navb¬
</label>

36 </
div
>

38 <
div
 
şass
="ace-settings-item">

39 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-sidebar" />

40 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-sideb¬"> 
Fixed
 
Sideb¬
</label>

41 </
div
>

43 <
div
 
şass
="ace-settings-item">

44 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-breadcrumbs" />

45 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-b»adüumbs"> 
Fixed
 
B»adüumbs
</label>

46 </
div
>

48 <
div
 
şass
="ace-settings-item">

49 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-rtl" />

50 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-¹l"> 
Right
 
To
 
Leá
 (
¹l
)</label>

51 </
div
>

53 <
div
 
şass
="ace-settings-item">

54 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-add-container" />

55 <
Ïb–
 
şass
="lbl" ="ace-settings-add-container">

56 
Inside


57 <
b
>.
cÚš”
</b>

58 </
Ïb–
>

59 </
div
>

60 </
div
><!-- /.
puÎ
-
Ëá
 -->

62 <
div
 
şass
="pull-left width-50">

63 <
div
 
şass
="ace-settings-item">

64 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-hover" />

65 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-hov”"> 
Subm’u
 
Ú
 
Hov”
</label>

66 </
div
>

68 <
div
 
şass
="ace-settings-item">

69 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-compact" />

70 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-com·ù"> 
Com·ù
 
Sideb¬
</label>

71 </
div
>

73 <
div
 
şass
="ace-settings-item">

74 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-highlight" />

75 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-highlight"> 
AÉ
. 
Aùive
 
I‹m
</label>

76 </
div
>

77 </
div
><!-- /.
puÎ
-
Ëá
 -->

78 </
div
><!-- /.
aû
-
£‰šgs
-
box
 -->

79 </
div
><!-- /.
aû
-
£‰šgs
-
cÚš”
 -->

82 <
div
 
şass
="row">

83 <
div
 
şass
="col-xs-12">

84 <!-- 
PAGE
 
CONTENT
 
BEGINS
 -->

85 <
div
 
şass
="alert‡lert-info">

86 <
i
 
şass
="ace-icon fa fa-hand-o-right"></i>

89 <
bu‰Ú
 
şass
="şo£" 
d©a
-
dismiss
="alert">

90 <
i
 
şass
="ace-icon fa fa-times"></i>

91 </
bu‰Ú
>

92 </
div
>

94 <
div
>

95 <
fÜm
 
aùiÚ
="<?ph°echØba£_u¾(); ?>šdex.php/www/objeùs/muÉiFes" 
şass
="drİzÚe" 
id
="dropzone">

96 <
div
 
şass
="fallback">

97 <
šput
 
Çme
="fe" 
ty³
="fe" 
muÉË
="" />

98 </
div
>

99 </
fÜm
>

100 </
div
><!-- 
PAGE
 
CONTENT
 
ENDS
 -->

101 </
div
><!-- /.
cŞ
 -->

102 </
div
><!-- /.
row
 -->

103 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

104 </
div
>

105 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

107 <
a
 
h»f
="#" 
id
="bŠ-süŞl-up" 
şass
="btn-scroll-up btn btn-sm btn-inverse">

108 <
i
 
şass
="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>

109 </
a
>

110 </
div
><!-- /.
maš
-
cÚš”
 -->

113 <!-- 
šlše
 
süts
 
»Ï‹d
 
to
 
this
 
·ge
 -->

114 <
süt
 
ty³
="text/javascript">

115 
jQu”y
(
	$funùiÚ
(
$
){

117 
Œy
 {

118 
DrİzÚe
.
autoDiscov”
 = 
çl£
;

119 
v¬
 
myDrİzÚe
 = 
Ãw
 
	`DrİzÚe
("#dropzone" , {

120 
·¿mName
: "file",

121 
maxFesize
: 2000,

122 
addRemoveLšks
 : 
Œue
,

123 
diùDeçuÉMes§ge
 :

125 <
¥ª
 
şass
="sm®Ër-80 g»y">(æˆ–è€… å•å‡»)</¥ª> <
br
 /> \

126 <
i
 
şass
="upload-icon‡ce-icon fa fa-cloud-upload blue fa-3x"></i>'

128 
diùRe¥Ú£E¼Ü
: 'Error while uploading file!',

131 
´ev›wTem¶©e
: "<div class=\"dz-preview dz-file-preview\">\n <div class=\"dz-details\">\n <div class=\"dz-filename\"><span data-dz-name></span></div>\n <div class=\"dz-size\" data-dz-size></div>\n <img data-dz-thumbnail />\n </div>\n <div class=\"progress…rogress-small…rogress-striped‡ctive\"><div class=\"progress-bar…rogress-bar-success\" data-dz-uploadprogress></div></div>\n <div class=\"dz-success-mark\"><span></span></div>\n <div class=\"dz-error-mark\"><span></span></div>\n <div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n</div>"

134 
	`$
(
docum’t
).
	`Úe
('ajaxlßd¡¬t.·ge', 
	`funùiÚ
(
e
) {

135 
Œy
 {

136 
myDrİzÚe
.
	`de¡roy
();

137 } 
	`ÿtch
(
e
) {}

140 } 
	`ÿtch
(
e
) {

141 
	`®”t
('æµè§ˆå™¨ä¸æ”¯æŒ');

144 
	}
});

145 </
	gsüt
>

146 </
	gbody
>

147 </
	ghtml
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/import.php

1 <
div
 
	gid
="my-wiz¬d" 
d©a
-
rg‘
="#step-container">

2 <
ul
 
şass
="wizard-steps">

3 <
li
 
d©a
-
rg‘
="#¡•1" 
şass
="active">

4 <
¥ª
 
şass
="step">1</span>

5 <
¥ª
 
şass
="title">æ­¥éª¤ä¸€</span>

6 </
li
>

7 <
li
 
d©a
-
rg‘
="#step2">

8 <
¥ª
 
şass
="step">2</span>

9 <
¥ª
 
şass
="title">æ­¥éª¤äºŒ</span>

10 </
li
>

11 <
li
 
d©a
-
rg‘
="#step3">

12 <
¥ª
 
şass
="step">3</span>

13 <
¥ª
 
şass
="title">å¯¼å…¥å®Œæˆ</span>

14 </
li
>

15 </
ul
>

16 </
div
>

18 <
div
 
şass
="¡•-cÚ‹Á" 
id
="step-container">

19 <
fÜm
 
şass
="fÜm-hÜizÚl" 
id
="§m¶e-fÜm" 
m‘hod
ğ"po¡" 
’ùy³
="muÉ¬t/fÜm-d©a" 
aùiÚ
="<?phpƒcho base_url();?>index.php/www/objects/importfile">

20 <
div
 
şass
="¡•-·Ã‡ùive" 
id
="step1">

21 <
šput
 
ty³
="hidd’" 
Çme
="obj_ty³" 
v®ue
="<?phpƒcho $obj_type?>">

22 <!-- 
¡•
 1 -->

23 <
´e
>1. ä½ å¯ä»¥æŠŠ
csv
æ–‡ä»¶ã€åˆ¶è¡¨ç¬¦åˆ†éš”çš„æ–‡ä»¶æˆ–å…¶å®ƒåˆ†éš”ç¬¦åˆ†éš”çš„æ•°æ®æ–‡ä»¶å¯¼å…¥ç³»ç»Ÿã€‚

26 4. å¦‚æœéœ€è¦å¯¼å…¥å¤§çš„æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å°†å…¶æ‹†æˆè‹¥å¹²ä¸ªå°çš„æ–‡ä»¶ç„¶ååˆ†åˆ«å¯¼å…¥ã€‚</
´e
>

27 <
div
 
şass
="form-group">

28 <
Ïb–
 ="suffix" 
şass
="col-sm-3 control-label‚o-padding-right">æŒ‡å®šå¯¼å…¥æ–‡ä»¶æ ¼å¼ï¼š</label>

29 <
div
 
şass
="col-sm-3">

30 <
£Ëù
 
id
="suffix" 
şass
="cŞ-sm-12" 
Çme
="file-type">

31 <
İtiÚ
 
v®ue
="csv">
CSV
(*.
csv
)</option>

32 <
İtiÚ
 
v®ue
="xls">
Exûl
(*.
xls
)</option>

33 <
İtiÚ
 
v®ue
="xlsx">
Exûl2007
(*.
xlsx
)</option>

34 </
£Ëù
>

35 </
div
>

36 <
div
 
şass
="h–p-block cŞ-sm-6">(æš‚æ—¶åªæ”¯æŒ
csv
æ ¼å¼ é»˜è®¤ä¸ºé€—å·åˆ†éš”)</div>

37 </
div
>

38 <
div
 
şass
="form-group">

39 <
Ïb–
 ="symbŞ" 
şass
="col-sm-3 control-label"></label>

40 <
div
 
şass
="col-sm-9">

41 <
Ïb–
>

42 <
šput
 
ty³
="¿dio" 
Çme
="symbŞ" 
şass
="aû" 
v®ue
="," 
checked
/>

43 <
¥ª
 
şass
="lbl">é€—å·åˆ†éš”çš„æ–‡ä»¶</span>

44 </
Ïb–
>

45 <
Ïb–
>

46 <
šput
 
ty³
="¿dio" 
Çme
="symbŞ" 
şass
="aû" 
v®ue
="|" />

47 <
¥ª
 
şass
="lbl">åˆ¶è¡¨ç¬¦åˆ†éš”çš„æ–‡ä»¶</span>

48 </
Ïb–
>

49 <
Ïb–
>

50 <
šput
 
ty³
="¿dio" 
Çme
="symbŞ" 
şass
="aû" 
v®ue
=""/>

51 <
¥ª
 
şass
="lbl">è‡ªå®šä¹‰åˆ†éš”ç¬¦åˆ†éš”çš„æ–‡ä»¶</span>

52 <
šput
 
ty³
="‹xt" 
v®ue
="," 
maxËngth
="1" 
¡yË
="width:40px;" 
Çme
="userdelimited"/>

53 </
Ïb–
>

54 </
div
>

55 </
div
>

56 <
div
 
şass
="form-group">

58 <
Ïb–
 ="my-fe-šput" 
şass
="col-sm-3 control-label‚o-padding-right">é€‰ä¸­å¯¼å…¥æ–‡ä»¶ï¼š</label>

59 <
div
 
şass
="col-sm-5">

60 <
šput
 
ty³
="fe" 
Úchªge
="ajaxFeU¶ßdÑhis)" 
şass
="u¶ßdFe" 
Çme
="myfe" 
id
="myfile">

61 <
šput
 
ty³
="hidd’" 
id
="fe_addr" 
Çme
="file_addr">

62 <
¥ª
 
¡yË
="display:‚one; width: 200px;color:„ed">æ¡£æ¡ˆä¸Šä¼ ä¸­ï¼Œè¯·ç¨å</span>

63 </
div
>

64 <
div
 
şass
="col-sm-4">

65 </
div
>

66 </
div
>

67 <
div
 
şass
="form-group">

68 <
Ïb–
 
şass
="col-sm-3 control-label"></label>

69 <
div
 
şass
="col-sm-9">

70 <
Ïb–
>

71 <
šput
 
ty³
="checkbox" 
Çme
="w™h_t™Ë" 
şass
="aû" 
v®ue
="1" 
checked
/>

72 <
¥ª
 
şass
="lbl">æœ‰æ ‡é¢˜æ </span>

73 </
Ïb–
>

74 <
Ïb–
>

75 <
šput
 
ty³
="checkbox" 
Çme
="ü—‹_’um" 
şass
="aû" 
v®ue
="1"/>

76 <
¥ª
 
şass
="lbl">åˆ›å»ºä¸å­˜åœ¨çš„æšä¸¾å€¼</span>

77 </
Ïb–
>

78 </
div
>

79 </
div
>

82 </
div
>

83 <
div
 
şass
="¡•-·Ã" 
id
="step2">

84 <!-- 
¡•
 2 -->

86 </
div
>

87 <
div
 
şass
="¡•-·Ã" 
id
="step3">

88 <!-- 
¡•
 3 -->

90 </
div
>

91 </
fÜm
>

92 </
div
>

94 <
div
 
şass
="wizard-actions">

95 <
bu‰Ú
 
şass
="btn-prev btn">

96 <
i
 
şass
="ace-icon fa fa-arrow-left"></i> ä¸Šä¸€æ­¥

97 </
bu‰Ú
>

98 <
bu‰Ú
 
şass
="bŠ-ÃxˆbŠ bŠ-sucûss" 
d©a
-
Ï¡
="å®Œæˆ" >

99 ä¸‹ä¸€æ­¥ <
i
 
şass
="ace-icon fa fa-arrow-right icon-on-right"></i>

100 </
bu‰Ú
>

101 </
div
>

103 <
süt
 
ty³
="text/javascript">

104 
jQu”y
(
	$funùiÚ
(
$
) {

106 
	`$
('#my-file-input')

107 .
	`aû_fe_šput
()

108 .
	`Ú
('chªge', 
	`funùiÚ
() {

109 
fes
 = 
	`$
(
this
).
	`d©a
('ace_input_files');

113 
	`$
('#my-wizard')

114 .
	`aû_wiz¬d
({

117 .
	`Ú
('chªge' , 
	`funùiÚ
(
e
, 
šfo
) {

123 if(
šfo
.
¡•
==1 && info.
dœeùiÚ
 == 'next'){

124 
v¬
 
fe_u¾
 =
	`$
('#fe_addr').
	`v®
();

126 
$
.
	`ajax
({

128 
d©a
:{'fe_u¾':
fe_u¾
},

129 'sucûss':
	`funùiÚ
(
d©a
){

130 
	`$
('#¡•2').
	`html
(
d©a
);

133 'ÿche':
çl£


136 if(
šfo
.
¡•
==2 && info.
dœeùiÚ
 == 'å®Œæˆ'){

137 
$
.
	`ajax
({

139 'sucûss':
	`funùiÚ
(
d©a
){

140 
	`$
('#¡•2').
	`html
(
d©a
);

143 'ÿche':
çl£


146 if(
šfo
.
¡•
==2 && info.
dœeùiÚ
 == 'next'){

147 
v¬
 
v
 = 
Œue
;

148 
	`$
(".mu¡").
	`—ch
(
	`funùiÚ
(){

149 if(
	`$
(
this
).
	`v®
() == "null"){

150 
v
 = 
çl£
;

154 if(
v
){

155 
v¬
 
d©aInfo
 = 
	`$
("#impÜtR–©iÚ").
	`£rŸlize
().
	`toSŒšg
();

157 
$
.
	`ajax
({

159 'd©a':{
d©a
:
d©aInfo
},

160 'sucûss':
	`funùiÚ
(
d©a
){

161 
	`$
('#¡•3').
	`html
(
d©a
);

164 'ÿche':
çl£


167 
	`®”t
("è¯·å¡«å†™æ•°æ®")

172 .
	`Ú
('fšished', 
	`funùiÚ
(
e
) {

174 
	`®”t
(2);

175 
	`$
(
this
).
	`şo£¡
("[d©a-Çme='DŸlogDiv']").
	`dŸlog
("close");

176 }).
	`Ú
('¡•şick', 
	`funùiÚ
(
e
) {

178 
	`®”t
(3);

182 
	}
});

184 
funùiÚ
 
	$ajaxFeU¶ßd
(
This
){

185 
v¬
 
thisNext
=
	`$
(
This
). 
	`Ãxt
();

186 
v¬
 
thisNextS·n
ğ
	`$
(
This
). 
	`Ãxt
().‚ext()

187 
thisNextS·n
.
	`css
('display','inline-block');

188 
v¬
 
v®id
=
Œue
;

189 
v¬
 
feId
=
nuÎ
;

190 
v¬
 
feV®ues
='';

191 if(
	`$
(
This
).
	`v®
().
Ëngth
!=0){

192 
feV®ues
=
	`$
(
This
).
	`v®
();

193 
	`$
(
This
).
	`´ev
().´ev().
	`v®
(
feV®ues
)

194 
feId
=
	`$
(
This
).
	`©Œ
('id')

195 if(
thisNext
.
	`v®
().
Ëngth
!=0){

196 
v¬
 
Hidd’
=
thisNext
.
	`v®
();

199 
v®id
=
çl£
;

205 if(
v®id
){

206 
$
.
	`ajaxFeU¶ßd
({

207 
u¾
:'<?phpƒcho base_url();?>index.php/www/objects/upload',

208 
£cu»uri
:
çl£
,

209 
d©aTy³
: 'json',

210 
feEËm’tId
:"myfile",

211 
sucûss
: 
	`funùiÚ
 (
d©a
)

215 
thisNextS·n
.
	`css
('display','none');

216 if(
d©a
.
fuÎ_·th
 !ğ
nuÎ
)

218 
thisNext
.
	`v®
(
d©a
.
fuÎ_·th
);

222 
	`®”t
(
d©a
.
”rÜ
);

225 
”rÜ
: 
	`funùiÚ
 (
d©a
,
¡©us
, 
e
)

227 
	`®”t
(
e
);

231 
thisNextS·n
.
	`css
('display','none');

233 
	}
}

235 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/importf.php

1 <
	g¡yË
>

2 .
	gmu¡
 {

3 
	gbÜd”
: 1
px
 
sŞid
 
»d
;

5 </
	g¡yË
>

6 <
	g´e
>1.åœ¨ç³»ç»Ÿå­—æ®µä¸­ï¼Œé€‰æ‹©ä¸
	gCRM
ç³»ç»ŸåŒ¹é…çš„æ•°æ®åˆ—ï¼›

8 3.å¯¹å¼•ç”¨å­—æ®µï¼Œé€‰æ‹©å¯ä»¥åœ¨ç³»ç»Ÿä¸­æŒ‰åç§°æŸ¥æ‰¾å¯¹åº”è®°å½•çš„å­—æ®µã€‚</
	g´e
>

9 <
fÜm
 
	gÇme
="impÜtR–©iÚ" 
id
="importRelation">

10 <
šput
 
ty³
="hidd’" 
Çme
="fe_u¾" 
v®ue
="<?phpƒcho $file_url ?>"/>

12 <
h3
>ç³»ç»Ÿå±æ€§</h3>

13 <
bË
 
şass
="bËabË-¡redabË-bÜd”ed" 
id
="">

14 <
tbody
>

15 <
Œ
>

16 <
th
>
CRM
å±æ€§</th>

17 <
th
>å¯¼å…¥å±æ€§</th>

18 <
th
>ä¸»é”®</th>

19 <
th
>
CRM
å±æ€§</th>

20 <
th
>å¯¼å…¥å±æ€§</th>

21 <
th
>ä¸»é”®</th>

22 </
Œ
>

23 <?
php


25 
$deçuÉ_İtiÚ
 = '<option value="null"></option>';

26 
fÜ—ch
 (
$csv
 
as
 
$k
 => 
$v
) {

27 
$deçuÉ_İtiÚ
 .ğ'<İtiÚ v®ue="' . 
$k
 . '">' . 
$v
 . '</option>';

30 
fÜ—ch
 (
$Ëad
['sy¡em'] 
as
 
$key
 => 
$v®ue
) {

31 
$num
 = 
$key
 + 1;

32 ià(
	g$num
 == 1) {

33 
echo
 "<tr>";

36 
	g$dis
 = "";

37 ià(
	g$v®ue
["ATTR_TYPE"] == 4) {

38 
$dis
 = "none";

41 
	g$İtiÚ
 = '<option value="null"></option>';

42 
fÜ—ch
 (
$csv
 
as
 
$k
 => 
$v
) {

43 ià(
$v®ue
['LABEL'] =ğ
$v
) {

44 
$İtiÚ
 .ğ'<İtiÚ v®ue="' . 
$k
 . '" s–eùed = "£Ëùed">' . 
$v
 . '</option>';

46 
	g$İtiÚ
 .ğ'<İtiÚ v®ue="' . 
$k
 . '">' . 
$v
 . '</option>';

49 
	g$şass
 = "col-sm-12";

50 
	g$t™Ë
 = "";

51 ià(
	g$v®ue
["IS_MUST"] == 1) {

52 
$şass
 = "col-sm-12 must";

53 
	g$t™Ë
 = "å¿…é¡»é€‰æ‹©";

55 
	gecho
 '<td>' . 
	g$v®ue
['LABEL'] . '</td>

56 <
	gtd
>

57 <
£Ëù
 
	gid
="suffix" 
şass
="' . $şas . '" 
Çme
="' . $v®ue['ATTR_NAME'] . '" 
t™Ë
="' . $title . '">

59 </
£Ëù
>

60 </
td
>

61 <
td
>

62 <
šput
 
¡yË
="di¥Ïy:' . $di . '" 
Çme
="' . $v®ue['ATTR_NAME'] . 'checkBox" 
ty³
="checkbox"/>

63 </
td
>';

65 ià(
$num
 =ğ
couÁ
(
$Ëad
['system'])) {

66 
echo
 "</tr>";

69 ià(
	g$num
 % 2 == 0) {

70 
echo
 "</tr><tr>";

75 <
	gtbody
>

76 </
	gbË
>

78 <
	gh3
>å¼•ç”¨å±æ€§</h3>

79 <
bË
 
	gşass
="tableable-stripedable-bordered">

80 <
tbody
>

81 <
Œ
>

82 <
th
>
CRM
å±æ€§</th>

83 <
th
>å¯¼å…¥å±æ€§</th>

84 <
th
>ä¸»é”®</th>

85 <
th
>
CRM
å±æ€§</th>

86 <
th
>å¯¼å…¥å±æ€§</th>

87 <
th
>ä¸»é”®</th>

88 </
Œ
>

89 <?
php


91 
fÜ—ch
 (
$Ëad
['»f'] 
as
 
$key
 => 
$v®ue
) {

92 
$İtiÚ2
 = "";

93 
fÜ—ch
 (
$v®ue
 
as
 
$k
 => 
$v
) {

94 
$İtiÚ2
 .ğ'<İtiÚ v®ue="' . 
$v
["ATTR_NAME"] . '">' . 
$key
 . ":" . $v["LABEL"] . '</option>';

96 
	g$£Ëù_¬r
[
$key
] = 
$İtiÚ2
;

99 
	g$num
 = 1;

100 
fÜ—ch
 (
$Ëad
['»f'] 
as
 
$key
 => 
$v®ue
) {

101 ià(
$num
 == 1) {

102 
echo
 "<tr>";

105 
	g$İtiÚ2
 = '<option value="null"></option>';

106 
	g$şass
 = "col-sm-12„efValue";

107 
	g$t™Ë
 = "";

108 
	g$£Ëù_šdex
 = "null";

109 ià(
	g$v®ue
["IS_MUST"] == 1) {

110 
$şass
 = "col-sm-12„efValue must";

111 
	g$t™Ë
 = "å¿…é¡»é€‰æ‹©";

113 
fÜ—ch
 (
$csv
 
as
 
$k
 => 
$v
) {

114 ià(
$key
 =ğ
$v
) {

115 
$İtiÚ2
 .ğ'<İtiÚ v®ue="' . 
$k
 . '" s–eùed = "£Ëùed">' . 
$v
 . '</option>';

116 
	g$£Ëù_šdex
 = 
$k
;

118 
	g$İtiÚ2
 .ğ'<İtiÚ v®ue="' . 
$k
 . '">' . 
$v
 . '</option>';

121 
	gecho
 '<td>

122 <
£Ëù
 
	gşass
="col-sm-12„efName">

124 </
£Ëù
>

125 </
td
>

126 <
šput
 
ty³
="hidd’" 
Çme
="' . $v®ue[0]['ATTR_NAME'] . '" 
v®ue
="'.$select_index.'">

127 <
td
>

128 <
£Ëù
 
şass
="' . $şas . '" 
t™Ë
="' . $title . '">

130 </
£Ëù
>

131 </
td
>

132 <
td
>

133 <
šput
 
ty³
="checkbox" 
Çme
="' . $value[0]['ATTR_NAME'] . 'checkBox"/>

134 </
td
>';

136 ià(
$num
 =ğ
couÁ
(
$Ëad
['ref'])) {

137 
echo
 "</tr>";

140 ià(
	g$num
 % 2 == 0) {

141 
echo
 "</tr><tr>";

143 
	g$num
++;

146 <
	gtbody
>

147 </
	gbË
>

148 </
	gfÜm
>

149 <
süt
 
	gty³
="text/javascript">

150 
$
(
	$funùiÚ
 () {

151 
	`$
(".»fName").
	`chªge
(
	`funùiÚ
 () {

152 
v¬
 
hidd’
 = 
	`$
(
this
).
	`·»Á
().
	`Ãxt
();

153 
	`$
(
hidd’
).
	`©Œ
("Çme", $(
this
).
	`v®
())

154 
v¬
 
check
 = 
	`$
(
this
).
	`·»Á
().
	`Ãxt
().Ãxt().Ãxt().
	`chd»n
();

155 
	`$
(
check
).
	`©Œ
("Çme", $(
this
).
	`v®
() + "checkBox")

158 
	`$
(".»fV®ue").
	`chªge
(
	`funùiÚ
 () {

159 
v¬
 
hidd’
 = 
	`$
(
this
).
	`·»Á
().
	`´ev
();

160 
	`$
(
hidd’
).
	`v®
($(
this
).val());

163 
	}
})

165 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/list.php

1 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

2 <
div
 
şass
="main-content">

3 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

4 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

5 <
ul
 
şass
="breadcrumb">

6 <
li
>

7 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

8 <
a
 
h»f
="<?phpƒcho base_url(); ?>index.php/www/">é¦–é¡µ</a>

9 </
li
>

11 <
li
 
şass
="aùive"><?
php
 
echo
 
$obj
[1]['LABEL'] ?>åˆ—è¡¨</li>

12 </
ul
><!-- /.
b»adüumb
 -->

16 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

17 </
div
>

19 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

20 <
div
 
şass
="page-content">

21 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

22 <
div
 
şass
="page-header">

23 <
h1
>

24 <?
php
 
echo
 
$obj
[1]['LABEL'] ?>åˆ—è¡¨

25 <
sm®l
>

26 <?
php
 
echo
 
$obj
[0]['LABEL'] ?> 
Li¡


27 </
sm®l
>

28 </
h1
>

29 </
div
><!-- /.
·ge
-
h—d”
 -->

31 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

32 <
div
 
şass
="row">

33 <
div
 
şass
="col-xs-12">

35 <
bË
 
id
="grid-table"></table>

37 <
div
 
id
="grid-pager"></div>

39 <
süt
 
ty³
="text/javascript">

40 
v¬
 
$·th_ba£
 = ".";

41 </
	gsüt
>

43 <!-- 
PAGE
 
CONTENT
 
	gENDS
 -->

44 </
	gdiv
><!-- /.
	gcŞ
 -->

45 </
	gdiv
><!-- /.
	grow
 -->

46 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

48 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

49 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

51 <
süt
 
	gty³
="text/javascript">

52 
$
(
docum’t
).
»ady
(
	$funùiÚ
(){

53 
$
.
	`po¡
("<?ph°echØba£_u¾(); ?>šdex.php/www/cu¡om”/li¡_objeù_jsÚ",{},
	`funùiÚ
(
d©a
){

54 
v¬
 
»t
 = 
	`ev®
("("+
d©a
+")");

55 
	`jqgridIn™
(
»t
);

57 
	}
})

58 
funùiÚ
 
	$jqgridIn™
(
grid_d©a
){

59 
v¬
 
grid_£ËùÜ
 = "#grid-table";

60 
v¬
 
·g”_£ËùÜ
 = "#grid-pager";

61 
	`$
(
wšdow
).
	`Ú
('»size.jqGrid', 
	`funùiÚ
 () {

62 
	`$
(
grid_£ËùÜ
).
	`jqGrid
Ğ'£tGridWidth', $(".·ge-cÚ‹Á").
	`width
() );

64 
v¬
 
·»Á_cŞumn
 = 
	`$
(
grid_£ËùÜ
).
	`şo£¡
('[class*="col-"]');

65 
	`$
(
docum’t
).
	`Ú
('£‰šgs.aû.jqGrid' , 
	`funùiÚ
(
ev
, 
ev’t_Çme
, 
cŞÏp£d
) {

66 ifĞ
ev’t_Çme
 === 'sidebar_collapsed' ||ƒvent_name === 'main_container_fixed' ) {

67 
	`£tTimeout
(
	`funùiÚ
() {

68 
	`$
(
grid_£ËùÜ
).
	`jqGrid
Ğ'£tGridWidth', 
·»Á_cŞumn
.
	`width
() );

72 
	`jQu”y
(
grid_£ËùÜ
).
	`jqGrid
({

73 
subGrid
 : 
çl£
,

74 
subGridO±iÚs
 : {

75 
¶usicÚ
 : "ace-icon fa fa-plus center bigger-110 blue",

76 
mšusicÚ
 : "ace-icon fa fa-minus center bigger-110 blue",

77 
İ’icÚ
 : "ace-icon fa fa-chevron-right center orange"

79 
d©a
: 
grid_d©a
,

80 
d©©y³
: "local",

81 
height
: 250,

82 
cŞNames
:[' ', 'æ ‡è¯†','åç§°'],

83 
cŞMod–
:[

84 {
Çme
:'myac',
šdex
:'', 
width
:80, 
fixed
:
Œue
, 
sÜbË
:
çl£
, 
»size
:false,

85 
fÜm©‹r
:'actions',

86 
fÜm©İtiÚs
:{

87 
keys
:
Œue
,

88 
d–O±iÚs
:{
»ü—‹FÜm
: 
Œue
, 
befÜeShowFÜm
:
befÜeD–‘eC®lback
},

91 {
Çme
:'uid',
šdex
:'uid', 
width
:60, 
sÜ‰y³
:"št", 
ed™abË
: 
Œue
},

92 {
Çme
:'uÇme',
šdex
:'uÇme',
width
:90, 
ed™abË
:
Œue
, 
sÜ‰y³
:"date"},

116 
v›w»cÜds
 : 
Œue
,

117 
rowNum
:10,

118 
rowLi¡
:[10,20,30],

119 
·g”
 : 
·g”_£ËùÜ
,

120 
®tRows
: 
Œue
,

122 
muÉi£Ëù
: 
Œue
,

123 
muÉiboxÚly
: 
Œue
,

125 
lßdCom¶‘e
 : 
	`funùiÚ
() {

126 
v¬
 
bË
 = 
this
;

127 
	`£tTimeout
(
	`funùiÚ
(){

128 
	`¡yËCheckbox
(
bË
);

129 
	`upd©eAùiÚIcÚs
(
bË
);

130 
	`upd©ePag”IcÚs
(
bË
);

131 
	`’abËToŞts
(
bË
);

135 
ed™u¾
: "<?phpƒcho base_url(); ?>index.php/www/customer/oper",

136 
ÿ±iÚ
: "å®¢æˆ·åŸºç¡€ä¿¡æ¯åˆ—è¡¨"

139 
	`$
(
wšdow
).
	`Œigg”HªdËr
('resize.jqGrid');

140 
funùiÚ
 
	`aûSw™ch
Ğ
ûÎv®ue
, 
İtiÚs
, 
ûÎ
 ) {

141 
	`£tTimeout
(
	`funùiÚ
(){

142 
	`$
(
ûÎ
è.
	`fšd
('input[type=checkbox]')

143 .
	`addCÏss
('ace‡ce-switch‡ce-switch-5')

144 .
	`aá”
('<span class="lbl"></span>');

147 
funùiÚ
 
	`pickD©e
Ğ
ûÎv®ue
, 
İtiÚs
, 
ûÎ
 ) {

148 
	`£tTimeout
(
	`funùiÚ
(){

149 
	`$
(
ûÎ
è.
	`fšd
('input[type=text]')

150 .
	`d©•ick”
({
fÜm©
:'yyyy-mm-dd' , 
autoşo£
:
Œue
});

155 
	`jQu”y
(
grid_£ËùÜ
).
	`jqGrid
('ÇvGrid',
·g”_£ËùÜ
,

157 
ed™
: 
Œue
,

158 
ed™icÚ
 : 'ace-icon fa fa-pencil blue',

163 
£¬ch
: 
Œue
,

164 
£¬chicÚ
 : 'ace-icon fa fa-search orange',

171 
»ü—‹FÜm
: 
Œue
,

172 
befÜeShowFÜm
 : 
	`funùiÚ
(
e
) {

173 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

174 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ëb¬').
	`w¿pIÂ”
('<div class="widget-header" />')

175 
	`¡yË_ed™_fÜm
(
fÜm
);

179 
şo£Aá”Add
: 
Œue
,

180 
»ü—‹FÜm
: 
Œue
,

181 
v›wPag”Bu‰Ús
: 
çl£
,

182 
befÜeShowFÜm
 : 
	`funùiÚ
(
e
) {

183 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

184 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdialog-titlebar')

185 .
	`w¿pIÂ”
('<div class="widget-header" />')

186 
	`¡yË_ed™_fÜm
(
fÜm
);

190 
»ü—‹FÜm
: 
Œue
,

191 
befÜeShowFÜm
 : 
	`funùiÚ
(
e
) {

192 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

193 if(
fÜm
.
	`d©a
('¡yËd')è 
çl£
;

195 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ëb¬').
	`w¿pIÂ”
('<div class="widget-header" />')

196 
	`¡yË_d–‘e_fÜm
(
fÜm
);

198 
fÜm
.
	`d©a
('¡yËd', 
Œue
);

200 
ÚClick
 : 
	`funùiÚ
(
e
) {

204 
»ü—‹FÜm
: 
Œue
,

205 
aá”ShowS—rch
: 
	`funùiÚ
(
e
){

206 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

207 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ë').
	`w¿p
('<div class="widget-header" />')

208 
	`¡yË_£¬ch_fÜm
(
fÜm
);

210 
aá”Red¿w
: 
	`funùiÚ
(){

211 
	`¡yË_£¬ch_f‹rs
(
	`$
(
this
));

214 
muÉËS—rch
: 
Œue
,

217 
»ü—‹FÜm
: 
Œue
,

218 
befÜeShowFÜm
: 
	`funùiÚ
(
e
){

219 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

220 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ë').
	`w¿p
('<div class="widget-header" />')

227 
funùiÚ
 
	`¡yË_ed™_fÜm
(
fÜm
) {

228 
fÜm
.
	`fšd
('šput[Çme=sd©e]').
	`d©•ick”
({
fÜm©
:'yyyy-mm-dd' , 
autoşo£
:
Œue
})

230 
fÜm
.
	`fšd
('šput[Çme=¡ock]').
	`addCÏss
('aû‡û-sw™ch‡û-sw™ch-5').
	`aá”
('<span class="lbl"></span>');

231 
v¬
 
bu‰Ús
 = 
fÜm
.
	`Ãxt
().
	`fšd
('.EditButton .fm-button');

232 
bu‰Ús
.
	`addCÏss
('bŠ bŠ-sm').
	`fšd
('[şass*="-icÚ"]').
	`hide
();

233 
bu‰Ús
.
	`eq
(0).
	`addCÏss
('bŠ-´im¬y').
	`´•’d
('<i class="ace-icon fa fa-check"></i>');

234 
bu‰Ús
.
	`eq
(1).
	`´•’d
('<i class="ace-icon fa fa-times"></i>')

236 
bu‰Ús
 = 
fÜm
.
	`Ãxt
().
	`fšd
('.navButton‡');

237 
bu‰Ús
.
	`fšd
('.ui-icÚ').
	`hide
();

238 
bu‰Ús
.
	`eq
(0).
	`­³nd
('<i class="ace-icon fa fa-chevron-left"></i>');

239 
bu‰Ús
.
	`eq
(1).
	`­³nd
('<i class="ace-icon fa fa-chevron-right"></i>');

242 
funùiÚ
 
	`¡yË_d–‘e_fÜm
(
fÜm
) {

243 
v¬
 
bu‰Ús
 = 
fÜm
.
	`Ãxt
().
	`fšd
('.EditButton .fm-button');

244 
bu‰Ús
.
	`addCÏss
('bŠ bŠ-sm bŠ-wh™bŠ-round').
	`fšd
('[şass*="-icÚ"]').
	`hide
();

245 
bu‰Ús
.
	`eq
(0).
	`addCÏss
('bŠ-dªg”').
	`´•’d
('<i class="ace-icon fa fa-trash-o"></i>');

246 
bu‰Ús
.
	`eq
(1).
	`addCÏss
('bŠ-deçuÉ').
	`´•’d
('<i class="ace-icon fa fa-times"></i>')

249 
funùiÚ
 
	`¡yË_£¬ch_f‹rs
(
fÜm
) {

250 
fÜm
.
	`fšd
('.d–‘e-ruË').
	`v®
('X');

251 
fÜm
.
	`fšd
('.add-ruË').
	`addCÏss
('btn btn-xs btn-primary');

252 
fÜm
.
	`fšd
('.add-group').
	`addCÏss
('btn btn-xs btn-success');

253 
fÜm
.
	`fšd
('.d–‘e-group').
	`addCÏss
('btn btn-xs btn-danger');

255 
funùiÚ
 
	`¡yË_£¬ch_fÜm
(
fÜm
) {

256 
v¬
 
dŸlog
 = 
fÜm
.
	`şo£¡
('.ui-jqdialog');

257 
v¬
 
bu‰Ús
 = 
dŸlog
.
	`fšd
('.EditTable')

258 
bu‰Ús
.
	`fšd
('.Ed™Bu‰Ú‡[id*="_»£t"]').
	`addCÏss
('bŠ bŠ-sm bŠ-šfo').fšd('.ui-icÚ').
	`©Œ
('class', 'ace-icon fa fa-retweet');

259 
bu‰Ús
.
	`fšd
('.Ed™Bu‰Ú‡[id*="_qu”y"]').
	`addCÏss
('bŠ bŠ-sm bŠ-šv”£').fšd('.ui-icÚ').
	`©Œ
('class', 'ace-icon fa fa-comment-o');

260 
bu‰Ús
.
	`fšd
('.Ed™Bu‰Ú‡[id*="_£¬ch"]').
	`addCÏss
('bŠ bŠ-sm bŠ-pu½Ë').fšd('.ui-icÚ').
	`©Œ
('class', 'ace-icon fa fa-search');

263 
funùiÚ
 
	`befÜeD–‘eC®lback
(
e
) {

264 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

265 
cÚsŞe
.
	`debug
(
fÜm
);

266 if(
fÜm
.
	`d©a
('¡yËd')è 
çl£
;

268 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ëb¬').
	`w¿pIÂ”
('<div class="widget-header" />')

269 
	`¡yË_d–‘e_fÜm
(
fÜm
);

271 
fÜm
.
	`d©a
('¡yËd', 
Œue
);

274 
funùiÚ
 
	`befÜeEd™C®lback
(
e
) {

275 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

276 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ëb¬').
	`w¿pIÂ”
('<div class="widget-header" />')

277 
	`¡yË_ed™_fÜm
(
fÜm
);

282 
funùiÚ
 
	`¡yËCheckbox
(
bË
) {

286 
funùiÚ
 
	`upd©eAùiÚIcÚs
(
bË
) {

289 
funùiÚ
 
	`upd©ePag”IcÚs
(
bË
) {

290 
v¬
 
»¶aûm’t
 =

297 
	`$
('.ui-pg-bË:nÙ(.ÇvbËè>body >¸> .ui-pg-bu‰Ú > .ui-icÚ').
	`—ch
(
	`funùiÚ
(){

298 
v¬
 
icÚ
 = 
	`$
(
this
);

299 
v¬
 
$şass
 = 
$
.
	`Œim
(
icÚ
.
	`©Œ
('şass').
	`»¶aû
('ui-icon', ''));

301 if(
$şass
 
š
 
»¶aûm’t
è
icÚ
.
	`©Œ
('class', 'ui-icon '+replacement[$class]);

305 
funùiÚ
 
	`’abËToŞts
(
bË
) {

306 
	`$
('.ÇvbË .ui-pg-bu‰Ú').
	`toŞt
({
cÚš”
:'body'});

307 
	`$
(
bË
).
	`fšd
('.ui-pg-div').
	`toŞt
({
cÚš”
:'body'});

309 
	`$
(
docum’t
).
	`Úe
('ajaxlßd¡¬t.·ge', 
	`funùiÚ
(
e
) {

310 
	`$
(
grid_£ËùÜ
).
	`jqGrid
('GridUnload');

311 
	`$
('.ui-jqdŸlog').
	`»move
();

313 
	}
}

314 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/object_list_view.php

1 <?
php
 
fÜ—ch
 (
$»s
 
as
 
$k
 => 
$v
) { ?>

2 <
div
 
şass
="widget-box" >

3 <
div
 
şass
="widget-header widget-header-flat">

4 <
h5
 
şass
="widg‘-t™Ë"><?
php
 
echo
 
$v
['LABEL']; ?></
	gh5
>

5 <!-- #£ùiÚ:
cu¡om
/
widg‘
-
box
.
toŞb¬
 -->

6 <
div
 
şass
="widget-toolbar">

7 <
a
 
h»f
="#" 
d©a
-
aùiÚ
="collapse">

8 <!--
i
 
şass
="ace-icon fa fa-chevron-up"></i-->

9 <
i
 
şass
="aû-icÚ f¨ç-¶us" 
d©a
-
icÚ
-
hide
="ç-mšus" d©a-icÚ-
show
="fa-plus"></i>

10 </
a
>

11 </
div
>

12 <
div
 
şass
="widget-toolbar‚o-border">

13 <
div
 
şass
="widget-menu">

14 <?
php
 if(
is£t
(
$v
['btn_action'])){?>

15 <?
php
 
fÜ—ch
 (
$v
['bŠ_aùiÚ']['bu‰Ús'] 
as
 
$bŠ_k
 => 
$bŠ_v
) {

16 ià(
is£t
(
$bŠ_v
['url'])) { ?>

17 <
a
 
d©a
-
aùiÚ
="settings">

18 <
i
 
id
="<?ph°echØ$v['REL_LIST_NAME'].'_but_'.$bŠ_k;?>_ajax_li¡s" 
şass
="aû-icÚ f¨ç-b¬s"><?
php
 
echo
 
$bŠ_v
['Çme'];?></
	gi
>

19 </
	ga
>

20 <
süt
 
	gty³
="text/javascript">

21 
$
("#<?ph°echØ$v['REL_LIST_NAME'].'_but_'.$bŠ_k;?>_ajax_li¡s").
şick
(
funùiÚ
(){

22 
v¬
 
id
 = <?
php
 
echo
 
$id
;?>;

23 
v¬
 
obj_ty³
 = <?
php
 
echo
 
$v
['OBJ_TYPE'];?>;

24 
v¬
 
u¾
 = "<?phpƒcho $btn_v['url'];?>";

25 
$DŸlogDivIDW
 = "DŸlogDiv" + 
$
(
this
).
©Œ
("id");

26 ià(
$
('#' + 
$DŸlogDivIDW
).
Ëngth
 == 0) {

27 
$
('#dŸlogdiv').
aá”
('<div id="' + 
$DŸlogDivIDW
 + '" style="display:none;"></div>');

30 
$
.
ajax
({

32 'sucûss': 
funùiÚ
 (
d©a
) {

33 
$
('#' + 
$DŸlogDivIDW
).
html
(
d©a
);

35 'u¾': 
u¾
,

36 'ÿche': 
çl£


38 
$
("#" + 
$DŸlogDivIDW
).
dŸlog
({

39 
t™Ë
: "<?phpƒcho $btn_v['name'];?>",

40 
mod®
: 
Œue
,

41 
width
: 900,

42 
height
: 600,

43 
bu‰Ús
:[{

44 
‹xt
:'ç¡®è®¤',

45 
CÏss
:"btn btn-primary",

46 
şick
: 
funùiÚ
(){

47 
v¬
 
¿dio
 = 
$
('#'+
$DŸlogDivIDW
).
fšd
('input[type=radio]:checked');

48 
v¬
 
¿dio_v®
 = 
¿dio
.
v®
();

49 
v¬
 
¿dio_Çme
 = 
¿dio
.
©Œ
("data-name");

51 
$
.
ajax
({

53 'd©a':{'id':
id
,'obj_ty³':
obj_ty³
,'»l_id':
¿dio_v®
},

54 'sucûss':
funùiÚ
(
d©a
){

55 
d©a
 = 
ev®
("("+data+")");

56 if(
d©a
.
»s
=='fail'){

57 
®”t
(
d©a
.
msg
);

59 
$
('#'+
$DŸlogDivIDW
).
dŸlog
("close");

60 
wšdow
.
loÿtiÚ
.
»¶aû
ÖoÿtiÚ.
h»f
);

64 
u¾
:'<?ph°echØ$bŠ_v['
§ve_u¾
'];?>'

70 
‹xt
:'å–æ¶ˆ',

71 
CÏss
:"btn btn-primary",

72 
şick
: 
funùiÚ
(){

73 
$
(
this
).
dŸlog
("close");

77 
$
('#' + 
$DŸlogDivIDW
).
dŸlog
('open');

80 </
	gsüt
>

81 <?
	gphp
 } { ?>

82 <
a
 
	gd©a
-
	gaùiÚ
="£‰šgs" 
d©a
-
toggË
="dropdown">

83 <
i
 
şass
="aû-icÚ f¨ç-b¬s"><?
php
 
echo
 
$bŠ_v
['Çme'];?></
	gi
>

84 </
	ga
>

85 <
ul
 
	gşass
="dropdown-menu dropdown-menu-right dropdown-light-blue dropdown-caret dropdown-closer">

86 <?
php
 
fÜ—ch
 (
$bŠ_v
['sub'] 
as
 
$sub_k
 => 
$sub_v
) {?>

87 <
li
>

88 <
a
 
id
="<?ph°echØ$v['REL_LIST_NAME'].'_sub_'.$sub_k;?>_ajax_add" 
d©a
-
toggË
="b" ><?
php
 
echo
 
$sub_v
['Çme'];?></
	ga
>

89 </
	gli
>

90 <
süt
 
	gty³
="text/javascript">

91 
$
("#<?ph°echØ$v['REL_LIST_NAME'].'_sub_'.$sub_k;?>_ajax_add").
şick
(
funùiÚ
(){

92 
v¬
 
id
 = <?
php
 
echo
 
$id
;?>;

93 
v¬
 
sobj_ty³
 = <?
php
 
echo
 
$v
['OBJ_TYPE'];?>;

94 
v¬
 
u¾
 = "<?phpƒcho $sub_v['url'];?>";

99 
$DŸlogDivIDM
 = "DŸlogDiv" + 
$
(
this
).
©Œ
("id");

100 ià(
$
('#' + 
$DŸlogDivIDM
).
Ëngth
 == 0) {

101 
$
('#dŸlogdiv').
aá”
('<div id="' + 
$DŸlogDivIDM
 + '" style="display:none;"></div>');

103 
$
.
ajax
({

105 'd©a': {'id':
id
,'sobj_ty³':
sobj_ty³
},

106 'sucûss': 
funùiÚ
 (
d©a
) {

108 
$
('#' + 
$DŸlogDivIDM
).
html
(
d©a
);

110 'u¾': 
u¾
,

111 'ÿche': 
çl£


113 
$
("#" + 
$DŸlogDivIDM
).
dŸlog
({

114 
t™Ë
: "æ–°å¢",

115 
mod®
: 
Œue
,

116 
width
: 1000,

117 
height
: 800,

120 
$
('#' + 
$DŸlogDivIDM
).
dŸlog
('open');

123 </
	gsüt
>

124 <?
	gphp
 } ?>

126 </
	gul
>

127 <?
	gphp
 } } ?>

128 <?
	gphp
 } ?>

130 </
	gdiv
>

131 <
a
 
	gh»f
="#" 
d©a
-
aùiÚ
="fuÎsü“n" 
şass
="orange2">

132 <
i
 
şass
="ace-icon fa fa-expand"></i>

133 </
a
>

134 <
a
 
h»f
="#" 
d©a
-
aùiÚ
="reload">

135 <
i
 
şass
="ace-icon fa fa-refresh"></i>

136 </
a
>

137 </
div
>

138 <!-- /
£ùiÚ
:
cu¡om
/
widg‘
-
box
.
toŞb¬
 -->

139 </
div
>

140 <
div
 
şass
="widget-body">

141 <
div
 
şass
="widget-main…adding-4">

142 <
div
 
şass
="my-cÚ‹Á" 
id
="<?phpƒcho $v['REL_LIST_NAME']; ?>-my-reluser-content">

143 </
div
>

145 </
div
>

146 </
div
>

147 </
div
>

148 <?
php
 } 
¦“p
(1); ?>

150 <
süt
 
	gty³
="text/javascript">

152 </
süt
>

155 <?
php
 
fÜ—ch
 (
$»s
 
as
 
$key
 => 
$v®ue
) { ?>

156 <
süt
 
ty³
="text/javascript">

157 
$
('#<?ph°echØ$v®ue['
REL_LIST_NAME
']; ?>-my-»lu£r-cÚ‹Á').
aû_süŞl
({

158 
hÜizÚl
: 
Œue
,

159 
size
: 1800,

162 }).
css
('padding-bottom', 15);

163 </
	gsüt
>

164 <
süt
 
	gty³
="text/javascript">

165 
v¬
 
·¿ms
 = <?
php
 
echo
 
jsÚ_’code
(
$v®ue
); ?>;

166 
v¬
 
	gu¾
 = '<?ph°echØs™e_u¾('
www
/
objeùs
/
ajax_v›w_li¡s
') . "?id=" . $id."&obj_type=".$obj_type ;?>'

168 
$
("#<?ph°echØ$v®ue['REL_LIST_NAME']; ?>-my-»lu£r-cÚ‹Á").
AjaxHtml
({

169 
U¾
: 
u¾
,

170 
D©a
: 
·¿ms


173 </
	gsüt
>

174 <?
	gphp
 } ?>

175 <
div
 
	gid
='dialogdiv'></div>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/recyc_staff.php

1 <
süt
 
	gty³
="text/javascript">

2 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

3 
	`$
("#assign_¡aff_sub3").
	`AjaxDŸlog
({

4 
DŸlogU¾
: "<?phpƒcho base_url()?>index.php/www/objects/recycling?sel=<?phpƒcho $ObjType; ?>"+"&obj_type=99&div_id=<?phpƒcho $div_id?>",

5 
DŸlogT™Ë
: "æ‰¹é‡å›æ”¶å‘˜å·¥",

6 
DŸlogWidth
: 800,

7 
DŸlogHeight
: 500});

8 
	`$
("#qx").
	`şick
(
	`funùiÚ
(){

9 
	`$
("#»cyşšg").
	`·»Á
().
	`dŸlog
('close');

11 
	}
});

12 </
	gsüt
>

13 <
div
 
	g¡yË
="width:100px;m¬gš-Ëá:‡uto;m¬gš-right:‡uto;m¬gš-tİ: 30px" 
id
="recycling">

14 <
div
>

15 <
div
><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="1">æ›´æ–°é€‰ä¸­è®°å½•</div>

16 <
div
 
¡yË
="m¬gš-tİ: 15px"><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="2">æ›´æ–°å½“å‰åˆ—è¡¨</div>

18 </
div
>

19 <
div
 
¡yË
="margin-top: 40px">

20 <
šput
 
v®ue
="ç¡®å®š" 
ty³
="bu‰Ú" 
id
="assign_staff_sub3">

21 <
šput
 
v®ue
="å–æ¶ˆ" 
ty³
="bu‰Ú" 
id
="qx">

22 </
div
>

23 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/recycling.php

1 <
div
 
	gşass
="<?phpƒcho $DialogID; ?>_ajax_page_content">

3 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

4 <
div
 
şass
="row">

6 <
div
 
şass
="col-xs-12">

7 <
bu‰Ú
 
id
='<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
bu‰Ú
 
id
="sub" 
şass
="btn btn-primary">

12 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

14 </
bu‰Ú
>

15 <
süt
 
ty³
="text/javascript">

17 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

18 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

19 
	`$
("#<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y").
	`S’iÜQu”y
({

20 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

21 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

22 
Li¡Div
: "#<?phpƒcho $DialogID; ?>_grid_table"

25 
	}
});

27 </
	gsüt
>

28 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

29 </
div
>

31 <
div
 
şass
="col-xs-12">

32 <!-- 
PAGE
 
CONTENT
 
BEGINS
 -->

33 <
div
 
id
=""></div>

34 <!-- 
PAGE
 
CONTENT
 
ENDS
 -->

35 </
div
><!-- /.
cŞ
 -->

36 </
div
><!-- /.
row
 -->

37 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

39 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

40 <
div
>

41 <
šput
 
ty³
="‹xt" 
Çme
="·ge_’d" 
id
="<?phpƒcho $DialogID; ?>page_end"/>

42 </
div
>

43 <
süt
 
ty³
="text/javascript">

44 
jQu”y
(
	$funùiÚ
 (
$
) {

45 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>";

46 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

47 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

48 
	`$
("#<?ph°echØ$DŸlogID; ?>_grid_·g”").
	`L“TabË
({

49 
U¾
:
u¾
,

50 
CŞ
:
cŞ
,

51 
MuÉiS–eù
:
Œue
,

52 
MuÉiTy³
:0,

53 
KeyA‰rName
:
key©ŒÇme


57 
	`$
("#sub").
	`şick
(
	`funùiÚ
(){

58 
v¬
 
d©a
 = "";

59 
v¬
 
¿dio
 = 
	`$
('šput:¿dio[Çme=upd©e]:checked').
	`v®
();

61 if(
¿dio
 == "2") {

62 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

63 ià(
d©a
 == "") {

64 
d©a
 = 
	`$
(
this
).
	`v®
();

66 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

69 }ià(
¿dio
 == "1"){

70 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

71 ià(
d©a
 == "") {

72 
d©a
 = 
	`$
(
this
).
	`v®
();

74 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

78 
d©a
 = d©a.
	`»¶aû
(/
Ú
,/, "");

79 
v¬
 
em¶oy“s
 = "";

80 
	`$
("#"+"<?ph°echØ$DŸlogID; ?>_grid_·g” iÅut[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

81 ià(
em¶oy“s
 == "") {

82 
em¶oy“s
 = 
	`$
(
this
).
	`v®
();

84 
em¶oy“s
 =ƒm¶oy“ + "," + 
	`$
(
this
).
	`v®
();

87 if(
d©a
.
Ëngth
 == 0){

88 
	`®”t
("è¯·é€‰æ‹©åˆ†é…æ•°æ®");

91 if(
em¶oy“s
.
Ëngth
 == 0){

92 
	`®”t
("è¯·é€‰æ‹©å‘˜å·¥æ•°æ®");

95 
cÚsŞe
.
	`log
(
d©a
);

96 
cÚsŞe
.
	`log
(
em¶oy“s
);

97 
$
.
	`ajax
({

98 
u¾
:"<?phpƒcho base_url(); ?>index.php/www/objects/del_rel_user?obj_type=<?phpƒcho $sel; ?>",

99 
ty³
:"post",

100 
d©a
:{
id
:d©a,
u£rs
:
em¶oy“s
},

101 
sucûss
:
	`funùiÚ
(
d©a
){

102 if(
d©a
 =="success"){

103 
	`®”t
("æ‰¹é‡æ›´æ–°æˆåŠŸ")

104 
wšdow
.
hi¡Üy
.
	`go
(0)

106 
	`®”t
("æ‰¹é‡æ›´æ–°å¤±è´¥")

115 
	}
});

118 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/view.php

1 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

2 <
div
 
şass
="main-content">

3 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

4 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

5 <
ul
 
şass
="breadcrumb">

6 <
li
>

7 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

8 <
a
 
h»f
="<?phpƒcho base_url();?>index.php/www">é¦–é¡µ</a>

9 </
li
>

10 <
li
 
şass
="aùive"><
a
 
h»f
="<?ph°echØba£_u¾();?>šdex.php/www/objeùs/li¡s?obj_ty³=<?ph°echØ$obj_ty³;?>"><?
php
 
echo
 
$diù
;?>åˆ—è¡¨</
	ga
></
	gli
>

11 <
	gli
><?
php
 
echo
 
	g$Ëad_d©a
[
$OBJ_NAME
.'.Name'];?></li>

12 </
	gul
><!-- /.
	gb»adüumb
 -->

13 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

14 </
div
>

16 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

17 <
div
 
şass
="page-content">

18 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

19 <
div
 
şass
="page-header">

20 <
h1
>

21 <?
php
 
echo
 
$Ëad_d©a
[
$OBJ_NAME
.'.Name'];?>

23 </
	gh1
>

24 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

26 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

27 <
div
 
	gşass
="row">

29 <
div
 
şass
="col-xs-12">

30 <
div
 
şass
="col-xs-12">

33 <?
php
 
fÜ—ch
(
$but_¬¿y
 
as
 
$k
=>
$v
){

34 ifĞ
$obj_ty³
 != 1 && $obj_type != 3){

35 if(
$k
 == 6 ||$k == 7 ){

39 if(
	g$Ëad_d©a
[
$OBJ_NAME
.".StopFlag"] == 1){

40 if(
$k
 == 6){

44 if(
	g$k
 == 7){

50 <
div
 
	gşass
="btn-group">

51 <
a
 
şass
="<?ph°echØ$v['cŞour'];?>" <?
php
 if(
is£t
(
$v
['id'])è{
echo
 "id=".$v['id'];}?> <?ph°if(is£t($v['u¾'])è{
	gecho
 "h»f=".
	g$v
['url'];}?> <?php if(isset($v['dropdown'])){echo 'data-toggle="dropdown"';}?>>

52 <
i
 
	gşass
="ace-icon <?phpƒcho $v['icon'];?>‡lign-top bigger-125"></i>

53 <?
php
 
echo
 
$v
['name'];?>

54 <?
php
 if(
is£t
(
$v
['dropdown'])){?>

55 <
¥ª
 
	gşass
="ace-icon fa fa-angle-down icon-only smaller-90"></span>

56 <?
php
 }?>

57 </
	ga
>

58 <?
php
 if(
is£t
(
$v
['dropdown'])){?>

59 <
ul
 
	gşass
="dropdown-menu dropdown-warning">

60 <?
php
 
fÜ—ch
(
$v
['drİdown'] 
as
 
$dk
=>
$dv
){?>

61 <
li
>

62 <
a
 <?
php
 if(
is£t
(
$dv
['u¾'])è{
echo
 "h»f=".$dv['u¾'];}?> <?ph°if(is£t($dv['id'])è{
	gecho
 "id=".
	g$dv
['id'];}?>>

63 <?
php
 
echo
 
	g$dv
["name"];?>

64 </
	ga
>

65 <?
php
 if(
is£t
(
$dv
['javascript'])){?>

66 <
süt
 
	gty³
="text/javascript">

67 <?
php
 
echo
 
$dv
['javascript'];?>

68 </
	gsüt
>

69 <?
	gphp
 }?>

70 </
	gli
>

71 <?
	gphp
 }?>

72 </
	gul
>

73 <?
	gphp
 }?>

74 </
	gdiv
>

75 <?
php
 if(
is£t
(
$v
['javascript'])){?>

76 <
süt
 
	gty³
="text/javascript">

77 <?
php
 
echo
 
$v
['javascript'];?>

78 </
	gsüt
>

79 <?
	gphp
 }?>

80 <?
	gphp
 }?>

81 <?
php
 if(
	$couÁ
(
$´iv©e_but
[
$OBJ_NAME
])){ ?>

82 <?
php
 
	`fÜ—ch
(
$´iv©e_but
[
$OBJ_NAME
] 
as
 
$k
=>
$v
){?>

83 <
div
 
şass
="btn-group">

84 <
a
 
şass
="<?ph°echØ$v['cŞour'];?>" <?
php
 if(
	`is£t
(
$v
['id'])è{
echo
 "id=".$v['id'];}?> <?php if(isset($v['url'])) {echo "href=".$v['url'];}?> <?php if(isset($v['dropdown'])){echo 'data-toggle="dropdown"';}?>>

85 <
i
 
şass
="ace-icon <?phpƒcho $v['icon'];?>‡lign-top bigger-125"></i>

86 <?
php
 
echo
 
$v
['name'];?>

87 <?
php
 if(
	`is£t
(
$v
['dropdown'])){?>

88 <
¥ª
 
şass
="ace-icon fa fa-angle-down icon-only smaller-90"></span>

89 <?
php
 }?>

90 </
a
>

91 <?
php
 if(
	`is£t
(
$v
['dropdown'])){?>

92 <
ul
 
şass
="dropdown-menu dropdown-warning">

93 <?
php
 
	`fÜ—ch
(
$v
['drİdown'] 
as
 
$dk
=>
$dv
){?>

94 <
li
>

95 <
a
 <?
php
 if(
	`is£t
(
$dv
['u¾'])è{
echo
 "href=".$dv['url'];}?> <?php if(isset($dv['id'])) {echo "id=".$dv['id'];}?>>

96 <?
php
 
echo
 
$dv
["name"];?>

97 </
a
>

98 <?
php
 if(
	`is£t
(
$dv
['javascript'])){?>

99 <
süt
 
ty³
="text/javascript">

100 <?
php
 
echo
 
$dv
['javascript'];?>

101 </
süt
>

102 <?
php
 }?>

103 </
li
>

104 <?
php
 }?>

105 </
ul
>

106 <?
php
 }?>

107 </
div
>

108 <?
php
 if(
	`is£t
(
$v
['javascript'])){?>

109 <
süt
 
ty³
="text/javascript">

110 <?
php
 
echo
 
$v
['javascript'];?>

111 </
süt
>

112 <?
php
 }?>

113 <?
php
 }?>

114 <?
php
 
	}
}?>

117 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

118 </
div
>

119 <
div
 
şass
="hr hr-dotted hr-16"></div>

120 </
div
>

122 <
div
 
id
="V›wFÜm©" 
şass
="cŞ-xs-12"></div><!-- /.
cŞ
 -->

123 <
süt
 
ty³
="text/javascript">

125 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

126 
	`$
("#şues_što").
	`AjaxDŸlog
({

127 
DŸlogU¾
: "<?phpƒcho base_url(); ?>index.php/www/lead/leadConversion",

128 
DŸlogT™Ë
: "çº¿ç´¢è½¬åŒ–",

129 
DŸlogWidth
: 450,

130 
DŸlogHeight
: 406,

131 
DŸlogD©a
: {
id
:<?
php
 
echo
 
$this
->
šput
->
	`g‘
("id"è?>, 
obj_ty³
:<?phpƒcho $this->input->get("obj_type") ?>},

132 
DŸlogBu‰Ús
: [{

133 
‹xt
: "ç¡®å®š",

134 
CÏss
: "btn btn-primary",

135 
şick
: 
	`funùiÚ
 () {

136 
v¬
 
sub
 = 
Œue
;

137 ià(
	`$
("#šput_key_AccouÁ_OwÃr").
	`v®
().
Ëngth
 == 0) {

138 
sub
 = 
çl£
;

139 
	`®”t
("è¯·é€‰æ‹©å®¢æˆ·æ‰€æœ‰è€…");

142 ià(
	`$
("#cÚù").
	`´İ
("checked"è&& $("#šput_key_CÚù_OwÃr").
	`v®
().
Ëngth
 == 0) {

143 
sub
 = 
çl£
;

144 
	`®”t
("è¯·é€‰æ‹©è”ç³»äººæ‰€æœ‰è€…");

147 ià(
	`$
("#İpÜtun™y").
	`´İ
("checked"è&& $("#šput_key_OµÜtun™y_OwÃr").
	`v®
().
Ëngth
 == 0) {

148 
sub
 = 
çl£
;

149 
	`®”t
("è¯·é€‰æ‹©è”ç³»äººæ‰€æœ‰è€…");

152 ià(
sub
) {

155 
	`$
("#şuesIÁoD©a").
	`subm™
();

161 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
); ?>;

162 
	`$
("#V›wFÜm©").
	`FÜm©
({

163 
ty³
: "view",

164 
FÜm©D©a
: 
fÜm©_d©a


166 
	}
});

167 </
	gsüt
>

168 </
	gdiv
><!-- /.
	grow
 -->

169 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

170 <
div
 
id
="object_list_view"></div>

171 <
süt
 
ty³
="text/javascript">

172 
v¬
 
u¾
 = '<?ph°echØs™e_u¾('
www
/
objeùs
/
objeù_li¡_v›w
');?>'

173 
v¬
 
·¿ms
 = {
id
:'<?ph°echØ$Ëad_d©a[$moduË['
KEY_ATTR_NAME
']]?>',
obj_ty³
:'<?ph°echØ$obj_ty³;?>',
ty³_id
:'<?ph°echØ$Ëad_d©a[$moduË['
OBJ_NAME
'] . ".TypeID"]?>'};

174 
$
("#objeù_li¡_v›w").
AjaxHtml
({

175 
U¾
: 
u¾
,

176 
D©a
: 
·¿ms


178 </
	gsüt
>

184 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

185 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

188 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/home/index.php

5 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

6 <
div
 
şass
="main-content">

7 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

8 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

9 <
süt
 
ty³
="text/javascript">

10 
Œy
{
aû
.
£‰šgs
.
check
('b»adüumbs' , 'fixed')}
	$ÿtch
(
e
){
	}
}

11 </
süt
>

13 <
ul
 
şass
="breadcrumb">

14 <
li
>

15 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

17 </
li
>

18 </
ul
><!-- /.
b»adüumb
 -->

20 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

21 </
div
>

23 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

24 <
div
 
şass
="page-content">

25 <
div
 
şass
="row">

26 <
div
 
şass
="col-xs-12">

27 <!-- 
PAGE
 
CONTENT
 
BEGINS
 -->

30 <
div
 
şass
="row">

31 <
div
 
şass
="col-sm-12">

32 </
div
><!-- /.
cŞ
 -->

33 </
div
><!-- /.
row
 -->

35 <!-- #£ùiÚ:
cu¡om
/
exŒa
.
hr
 -->

37 <!-- /
£ùiÚ
:
cu¡om
/
exŒa
.
hr
 -->

38 <
div
 
şass
="row">

39 <
div
 
şass
="col-sm-12">

40 <
div
 
şass
="widget-boxransparent">

41 <
div
 
şass
="widget-header widget-header-flat">

42 <
h4
 
şass
="widget-title†ighter">

43 <
i
 
şass
="ace-icon fa fa-star orange"></i>

45 </
h4
>

47 <
div
 
şass
="widget-toolbar">

48 <
a
 
h»f
="#" 
d©a
-
aùiÚ
="collapse">

49 <
i
 
şass
="ace-icon fa fa-chevron-up"></i>

50 </
a
>

51 </
div
>

52 </
div
>

54 <
div
 
şass
="widget-body">

55 <
div
 
id
="»mšd_·ge-cÚ‹Á" 
şass
="widget-main‚o-padding">

57 </
div
><!-- /.
widg‘
-
maš
 -->

58 </
div
><!-- /.
widg‘
-
body
 -->

59 </
div
><!-- /.
widg‘
-
box
 -->

60 </
div
><!-- /.
cŞ
 -->

61 </
div
><!-- /.
row
 -->

64 <!-- 
PAGE
 
CONTENT
 
ENDS
 -->

65 </
div
><!-- /.
cŞ
 -->

66 </
div
><!-- /.
row
 -->

69 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

70 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/layouts/bottom.php

3 <
div
 
	gşass
="footer">

4 <
div
 
şass
="footer-inner">

5 <!-- #£ùiÚ:
basics
/
foÙ”
 -->

6 <
div
 
şass
="footer-content">

7 <
¥ª
 
şass
="bigger-120">

8 <
¥ª
 
şass
="blubŞd”">
TRUECOLOR
</span>

9 
JacksÚ
 &
cİy
; <?
php
 
echo
 
d©e
("Y-m-d");?>

10 </
	g¥ª
>

11 </
	gdiv
>

13 <!-- /
	g£ùiÚ
:
basics
/
foÙ”
 -->

14 </
div
>

15 </
div
>

17 <
a
 
h»f
="#" 
id
="bŠ-süŞl-up" 
şass
="btn-scroll-up btn btn-sm btn-inverse">

18 <
i
 
şass
="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>

19 </
a
>

21 </
div
><!-- /.
maš
-
cÚš”
 -->

22 <!-- 
basic
 
süts
 -->

25 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/bootstrap.min.js"></script>

27 <!-- 
·ge
 
¥ecific
 
¶ugš
 
süts
 -->

29 <!-- 
aû
 
süts
 -->

30 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/ace.min.js"></script>

32 <!-- 
šlše
 
süts
 
»Ï‹d
 
to
 
this
 
·ge
 -->

34 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/lee/js/LeeBackLoad.js"></script>

35 <!-- 
·ge
 
¥ecific
 
¶ugš
 
süts
 -->

36 <
süt
>

37 
L“BackLßd
('<?phpƒcho base_url();?>');

38 </
	gsüt
>

39 </
	gbody
>

40 </
	ghtml
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/layouts/head.php

1 <!
DOCTYPE
 
	ghtml
>

2 <
html
 
	gÏng
="en">

3 <
h—d
>

4 <
m‘a
 
h‰p
-
equiv
="X-UA-Com·tibË" 
cÚ‹Á
="IE=edge,chrome=1" />

5 <
m‘a
 
ch¬£t
="utf-8" />

6 <
t™Ë
>
TRUECOLOR
</title>

7 <
m‘a
 
Çme
="desütiÚ" 
cÚ‹Á
="overview &amp; stats" />

8 <
m‘a
 
Çme
="v›wpÜt" 
cÚ‹Á
="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

9 <!-- 
boÙ¡¿p
 & 
fÚwesome
 -->

10 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/chosen.css" />

11 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/jquery-ui.min.css" />

12 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/bootstrap.min.css" />

13 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/font-awesome.min.css" />

15 <!-- 
·ge
 
¥ecific
 
¶ugš
 
¡yËs
 -->

16 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/ui.jqgrid.css" />

18 <!-- 
‹xt
 
fÚts
 -->

19 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/ace-fonts.css" />

20 <!-- 
aû
 
¡yËs
 -->

21 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/ace.min.css" />

23 <!-- 
·ge
 
¥ecific
 
¶ugš
 
¡yËs
 -->

24 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/colorbox.css" />

25 <
lšk
 
»l
="¡yËsh“t" 
h»f
="http://localhost/skypro/ace-master/assets/css/dropzone.min.css" />

26 <!--[
Ée
 
IE
 9]>

27 <
lšk
 
»l
="¡yËsh“t" 
h»f
="../assets/css/ace-part2.min.css" />

28 <![
’dif
]-->

29 <!-- 
Ëe


30 <
lšk
 
»l
="¡yËsh“t" 
h»f
="../assets/css/ace-skins.min.css" />

31 <
lšk
 
»l
="¡yËsh“t" 
h»f
="../assets/css/ace-rtl.min.css" />

32 
Ëe
 -->

33 <!--[
Ée
 
IE
 9]>

34 <
lšk
 
»l
="¡yËsh“t" 
h»f
="../assets/css/ace-ie.min.css" />

35 <![
’dif
]-->

37 <!-- 
šlše
 
¡yËs
 
»Ï‹d
 
to
 
this
 
·ge
 -->

39 <!-- å·¦ä¾§ç›®å½•æ æ”¶ç¼©åŠŸèƒ½çš„
JS
 -->

40 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/ace-extra.min.js"></script>

42 <!-- 
HTML5
 
shim
 
ªd
 
Re¥Úd
.
js
 
IE8
 
suµÜt
 
of
 HTML5 
–em’ts
‡nd 
medŸ
 
qu”›s
 -->

44 <!--[
Ée
 
IE
 8]>

45 <
süt
 
¤c
="../assets/js/html5shiv.js"></script>

46 <
süt
 
¤c
="../assets/js/respond.min.js"></script>

47 <![
’dif
]-->

49 <
lšk
 
h»f
="<?ph°echØba£_u¾();?>¡yË/aû/Ëe/css/L“.css" 
»l
="stylesheet" />

51 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/jquery.min.js"></script>

52 <!-- 
aû
è¿™ä¸ªç‰ˆæœ¬
dŸlog
æœ‰é—®é¢˜ æ”¹æˆæ–°ç‰ˆæœ¬

53 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/jquery-ui.min.js"></script>

55 <
süt
 
¤c
="<?phpƒcho base_url();?>style/js/jquery-ui.min.js"></script>

57 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/chosen.jquery.min.js"></script>

58 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/date-time/bootstrap-datepicker.min.js"></script>

59 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/jqGrid/jquery.jqGrid.min.js"></script>

60 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/jqGrid/i18n/grid.locale-cn.js"></script>

62 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/jquery.validate.min.js"></script>

64 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/jquery.colorbox-min.js"></script>

65 <!-- 
·ge
 
¥ecific
 
¶ugš
 
süts
 -->

66 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/jquery.dataTables.min.js"></script>

67 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/jquery.dataTables.bootstrap.js"></script>

68 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/dataTables.tableTools.min.js"></script>

69 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/dataTables.colVis.min.js"></script>

71 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ckeditor/ckeditor.js"></script>

72 <
süt
 
¤c
="<?phpƒcho base_url();?>style/config.js"></script>

74 <
süt
 
¤c
="http://localhost/skypro/ace-master/assets/js/dropzone.min.js"></script>

75 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/lee/js/LeeUI.js"></script>

76 <
süt
>

77 
L“UI
('<?phpƒcho base_url();?>');

78 </
	gsüt
>

80 <!-- 
·ge
 
¥ecific
 
¶ugš
 
	gsüts
 -->

81 </
	gh—d
>

82 <
body
 
	gşass
="no-skin">

83 <!-- #£ùiÚ:
basics
/
Çvb¬
.
Ïyout
 -->

84 <
div
 
id
="Çvb¬" 
şass
="navbar‚avbar-default">

85 <
div
 
şass
="Çvb¬-cÚš”" 
id
="navbar-container">

86 <!-- /
£ùiÚ
:
basics
/
sideb¬
.
mobe
.
toggË
 -->

87 <
div
 
şass
="navbar-header…ull-left">

88 <!-- #£ùiÚ:
basics
/
Çvb¬
.
Ïyout
.
b¿nd
 -->

89 <
a
 
h»f
="#" 
şass
="navbar-brand">

90 <
sm®l
>

91 <
i
 
şass
="fa fa-leaf"></i>

92 
TRUECOLOR


93 </
sm®l
>

94 </
a
>

96 <!-- /
£ùiÚ
:
basics
/
Çvb¬
.
Ïyout
.
b¿nd
 -->

98 <!-- #£ùiÚ:
basics
/
Çvb¬
.
toggË
 -->

100 <!-- /
£ùiÚ
:
basics
/
Çvb¬
.
toggË
 -->

101 </
div
>

103 <!-- #£ùiÚ:
basics
/
Çvb¬
.
drİdown
 -->

104 <
div
 
şass
="Çvb¬-bu‰Ú Çvb¬-h—d”…uÎ-right" 
rŞe
="navigation">

105 <
ul
 
şass
="nav‡ce-nav">

106 <
li
 
şass
="grey">

107 <
a
 
d©a
-
toggË
="drİdown" 
şass
="drİdown-toggË" 
h»f
="#">

108 <
i
 
şass
="ace-icon fa fa-tasks"></i>

109 <
¥ª
 
şass
="badgbadge-g»y"><?
php
 
echo
 
$mes§ge
['couÁ'];?></
	g¥ª
>

110 </
	ga
>

112 <
ul
 
	gşass
="dropdown-menu-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close">

113 <
li
 
şass
="dropdown-header">

114 <
i
 
şass
="ace-icon fa fa-check"></i>

116 </
li
>

117 <
li
 
şass
="dropdown-footer">

118 <
a
 
h»f
="#">

120 <
i
 
şass
="ace-icon fa fa-arrow-right"></i>

121 </
a
>

122 </
li
>

123 </
ul
>

124 </
li
>

126 <!-- è¿™é‡Œæ˜¯å…³äºå³ä¸Šè§’ç”¨æˆ·çš„ä¸€ç‚¹ä¸œè¥¿ 
¡¬t
 -->

127 <
li
 
şass
="light-blue">

128 <
a
 
d©a
-
toggË
="drİdown" 
h»f
="#" 
şass
="dropdown-toggle">

129 <
img
 
şass
="Çv-u£r-phÙo" 
¤c
="<?ph°echØba£_u¾();?>¡yË/aû/av©¬s/u£r.jpg" 
®t
="Jason's Photo" />

130 <
¥ª
 
şass
="user-info">

131 <
sm®l
>æ¬¢è¿,</
	gsm®l
>

132 <?
php
 
echo
 
	g$£ssiÚ
['user_name']?>

133 </
	g¥ª
>

135 <
i
 
	gşass
="ace-icon fa fa-caret-down"></i>

136 </
a
>

138 <
ul
 
şass
="user-menu dropdown-menu-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">

139 <
li
>

140 <
a
 
id
='modify_password'>

141 <
i
 
şass
="ace-icon fa fa-key"></i>

143 </
a
>

144 </
li
>

146 <
li
>

147 <
a
 
h»f
="<?phpƒcho base_url();?>index.php/www/objects/edit?id=<?phpƒcho $session['user_id'];?>&obj_type=99">

148 <
i
 
şass
="ace-icon fa fa-user"></i>

150 </
a
>

151 </
li
>

153 <
li
 
şass
="divider"></li>

155 <
li
>

156 <
a
 
h»f
="<?phpƒcho base_url();?>index.php/www/login/logout">

157 <
i
 
şass
="ace-icon fa fa-power-off"></i>

159 </
a
>

160 </
li
>

161 </
ul
>

162 </
li
>

164 <!-- è¿™é‡Œæ˜¯å…³äºå³ä¸Šè§’ç”¨æˆ·çš„ä¸€ç‚¹ä¸œè¥¿ 
’d
 -->

165 </
ul
>

166 </
div
>

168 <!-- /
£ùiÚ
:
basics
/
Çvb¬
.
drİdown
 -->

169 </
div
><!-- /.
Çvb¬
-
cÚš”
 -->

170 </
div
>

172 <!-- /
£ùiÚ
:
basics
/
Çvb¬
.
Ïyout
 -->

173 <
div
 
şass
="maš-cÚš”" 
id
="main-container">

174 <!-- #£ùiÚ:
basics
/
sideb¬
 -->

175 <
div
 
id
="sideb¬" 
şass
="sidebar„esponsive">

176 <
div
 
şass
="sideb¬-shÜtcuts" 
id
="sidebar-shortcuts">

177 <
div
 
şass
="sideb¬-shÜtcuts-Ïrge" 
id
="sidebar-shortcuts-large">

178 <
bu‰Ú
 
şass
="btn btn-success">

179 <
i
 
şass
="ace-icon fa fa-signal"></i>

180 </
bu‰Ú
>

182 <
bu‰Ú
 
şass
="btn btn-info">

183 <
i
 
şass
="ace-icon fa fa-pencil"></i>

184 </
bu‰Ú
>

186 <!-- #£ùiÚ:
basics
/
sideb¬
.
Ïyout
.
shÜtcuts
 -->

187 <
bu‰Ú
 
şass
="btn btn-warning">

188 <
i
 
şass
="ace-icon fa fa-users"></i>

189 </
bu‰Ú
>

191 <
bu‰Ú
 
şass
="btn btn-danger">

192 <
i
 
şass
="ace-icon fa fa-cogs"></i>

193 </
bu‰Ú
>

195 <!-- /
£ùiÚ
:
basics
/
sideb¬
.
Ïyout
.
shÜtcuts
 -->

196 </
div
>

198 <
div
 
şass
="sideb¬-shÜtcuts-mši" 
id
="sidebar-shortcuts-mini">

199 <
¥ª
 
şass
="btn btn-success"></span>

201 <
¥ª
 
şass
="btn btn-info"></span>

203 <
¥ª
 
şass
="btn btn-warning"></span>

205 <
¥ª
 
şass
="btn btn-danger"></span>

206 </
div
>

207 </
div
><!-- /.
sideb¬
-
shÜtcuts
 -->

209 <
ul
 
şass
="Çv‚av-li¡" 
Ëeui
-
Çme
="m’u"></ul><!-- /.
Çv
-
li¡
 -->

210 <
süt
 
ty³
="text/javascript">

211 
jQu”y
(
	$funùiÚ
(
$
) {

213 
funùiÚ
 
	`ui_m’u
(
ba£_u¾
,
d©a
,
pid
){

214 if(
pid
==
nuÎ
){

215 
pid
=0;

218 
$
.
	`—ch
(
d©a
,
	`funùiÚ
(
i
,
v®
){

221 if(
v®
.
pid
 ==…id){

223 if(
v®
.
icÚ
==
nuÎ
){

224 
icÚ_şass
 = "";

226 
icÚ_şass
 = 
v®
.
icÚ
;

229 if(
v®
.
u¾
==
nuÎ
){

230 
u¾_h»f
 = "#";

232 if(
v®
.
u¾
.
	`sub¡ršg
(0,4)=="http"){

233 
u¾_h»f
 = 
v®
.
u¾
;

235 
u¾_h»f
 = 
ba£_u¾
+
v®
.
u¾
;

239 if(
pid
==0){

241 
	`$
("[Ëeui-Çme='m’u']").
	`­³nd
('<l˜şass="" id="m’u_li_'+
v®
.
id
+'"></li>');

242 
	`$
("#m’u_li_"+
v®
.
id
).
	`­³nd
('<¨h»f="'+
u¾_h»f
+'" id="m’u_a_'+v®.id+'"><˜şass="m’u-icÚ '+
icÚ_şass
+'"></i><¥ª cÏss="m’u-‹xt">'+v®.
Çme
+'</span></a>');

243 
	`$
("#m’u_li_"+
v®
.
id
).
	`­³nd
('<b class="arrow"></b>');

247 if(
	`$
("#m’u_ul_"+
v®
.
pid
).
Ëngth
 < 1){

248 
	`$
("#m’u_a_"+
v®
.
pid
).
	`addCÏss
("dropdown-toggle");

250 
	`$
("#m’u_li_"+
v®
.
pid
).
	`­³nd
('<ul class="submenu" id="menu_ul_'+val.pid+'"></ul>');

251 
	`$
("#m’u_a_"+
v®
.
pid
).
	`­³nd
('<b class="arrow fa fa-angle-down"></b>');

253 
	`$
("#m’u_ul_"+
v®
.
pid
).
	`­³nd
('<l˜şass="" id="m’u_li_'+v®.
id
+'"><¨h»f="'+
u¾_h»f
+'" id="m’u_a_'+v®.id+'"><˜şass="m’u-icÚ '+
icÚ_şass
+'"></i>'+v®.
Çme
+'</a><b class="arrow"></b></li>');

256 
	`ui_m’u
(
ba£_u¾
,
d©a
,
v®
.
id
);

257 if(
v®
.
aùive
==1){

258 
	`ui_m’u_aùive
(
v®
.
id
,
d©a
,'active')

265 
funùiÚ
 
	`ui_m’u_aùive
(
id
,
d©a
,
aùive_şass
){

266 if(
aùive_şass
==
nuÎ
){

267 
aùive_şass
='active';

269 
$
.
	`—ch
(
d©a
,
	`funùiÚ
(
i
,
v®
){

270 if(
v®
.
id
 == id){

271 
	`$
("#m’u_li_"+
v®
.
id
).
	`addCÏss
(
aùive_şass
);

272 
	`ui_m’u_aùive
(
v®
.
pid
,
d©a
,'active open');

277 
v¬
 
m’u_jsÚ
 = <?
php
 
echo
 
$m’u_jsÚ
;?>;

278 
v¬
 
ba£_u¾
 = '<?phpƒcho base_url();?>index.php/';

279 
	`ui_m’u
(
ba£_u¾
,
m’u_jsÚ
);

281 
	`$
('#modify_·sswÜd').
	`şick
(
	`funùiÚ
(){

282 
$
.
	`ajax
({

284 'sucûss': 
	`funùiÚ
 (
d©a
) {

285 
	`$
('#modify').
	`html
(
d©a
);

288 'ÿche': 
çl£


290 
	`$
("#modify").
	`dŸlog
({

291 
t™Ë
: "ä¿®æ”¹å¯†ç ",

292 
mod®
: 
Œue
,

293 
width
: 400,

294 
height
: 300,

296 
	`$
('#modify').
	`dŸlog
('open');

298 
	}
});

300 </
	gsüt
>

301 <
div
 
	gid
="modify" 
¡yË
= "display:none"></div>

302 <!-- #£ùiÚ:
basics
/
sideb¬
.
Ïyout
.
mšimize
 -->

303 <
div
 
şass
="sideb¬-toggË sideb¬-cŞÏp£" 
id
="sidebar-collapse">

304 <
i
 
şass
="aû-icÚ f¨ç-ªgË-doubË-Ëá" 
d©a
-
icÚ1
="aû-icÚ f¨ç-ªgË-doubË-Ëá" d©a-
icÚ2
="ace-icon fa fa-angle-double-right"></i>

305 </
div
>

306 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/add.php

2 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

3 <
div
 
şass
="main-content">

4 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

5 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

6 <
ul
 
şass
="breadcrumb">

7 <
li
>

8 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

9 <
a
 
h»f
="#">é¦–é¡µ</a>

10 </
li
>

11 <
li
 
şass
="aùive"><
a
 
h»f
="<?phpƒcho base_url();?>index.php/www/lead/list_json?>">çº¿ç´¢åˆ—è¡¨</a></li>

12 <
li
><?
php
 
echo
 
$Ëad_d©a
['L—d.Name'];?></
	gli
>

13 </
	gul
><!-- /.
	gb»adüumb
 -->

14 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

15 </
div
>

17 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

18 <
div
 
şass
="page-content">

19 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

20 <
div
 
şass
="page-header">

21 <
h1
>

22 <?
php
 
echo
 
$Ëad_d©a
['Lead.Name'];?>

23 <
	gsm®l
>

24 
L—d
 
	gv›w


25 </
	gsm®l
>

26 </
	gh1
>

27 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

29 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

30 <
div
 
	gşass
="row">

31 <
fÜm
 
id
="Form">

32 <
šput
 
ty³
="hidd’" 
Çme
="<?ph°echØ$´im¬y['key'];?>" 
v®ue
="<?phpƒcho $primary['value'];?>"/>

33 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_mod–" 
v®ue
="<?phpƒcho $module;?>"/>

34 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_aùiÚ" 
v®ue
="module_add"/>

35 <
div
 
şass
="col-xs-12">

36 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

37 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

39 </
bu‰Ú
>

40 <
bu‰Ú
 
şass
="btn btn-danger">

41 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

43 </
bu‰Ú
>

44 <
div
 
şass
="hr hr-dotted hr-16"></div>

45 </
div
>

47 <
div
 
şass
="cŞ-xs-12" 
id
="EditFormat"></div>

48 <
div
 
şass
="hr hr-dotted hr-16"></div>

49 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

50 <
div
 
şass
="col-xs-12">

51 <
div
 
şass
="hr hr-dotted hr-16"></div>

52 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

53 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

55 </
bu‰Ú
>

56 <
süt
 
ty³
="text/javascript">

57 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

58 
	`$
('[Çme=§ve]').
	`şick
(
	`funùiÚ
(){

59 
v¬
 
d©a
 = 
	`$
("#FÜm").
	`£rŸlizeA¼ay
();

61 
$
.
	`ajax
({

63 'd©a':{'d©a':
d©a
},

64 'sucûss':
	`funùiÚ
(
d©a
){

65 if(
d©a
==""){

66 
loÿtiÚ
.
h»f
="<?phpƒcho base_url(); ?>index.php/www/"

68 
	`®”t
(
d©a
);

73 'ÿche':
çl£


75  
çl£
;

77 
çl£
;

79 
	}
});

81 </
	gsüt
>

82 <
bu‰Ú
 
	gşass
="btn btn-danger">

83 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

85 </
bu‰Ú
>

86 </
div
>

87 </
fÜm
>

88 <?
php


89 <
süt
 
ty³
="text/javascript">

91 
$
(
docum’t
).
»ady
(
	$funùiÚ
() {

92 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
);?>;

93 
	`$
("#Ed™FÜm©").
	`FÜm©
({

94 
ty³
: "edit",

95 
FÜm©D©a
: 
fÜm©_d©a
,

96 
FromID
:"Form",

97 
S–eùChdEnumsU¾
:'<?phpƒcho base_url();?>index.php/admin/enum/SelectChildEnums'

100 
	`$
("#d‘a").
	`L“TabË
({

112 
CŞ
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞ
);?>,

116 
IsEd™
:
Œue


127 
	}
});

128 </
	gsüt
>

129 </
	gdiv
><!-- /.
	grow
 -->

130 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

132 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

133 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/conversion.php

1 <
fÜm
 
	gid
="şuesIÁoD©a" 
m‘hod
="po¡" 
aùiÚ
="<?phpƒcho base_url().'index.php/www/lead/cluesInto' ?>" >

2 <
šput
 
ty³
="hidd’" 
Çme
="LEAD_ID" 
v®ue
="<?phpƒcho $id ?>">

3 <
šput
 
ty³
="hidd’" 
Çme
="OBJ_TYPE" 
v®ue
="<?phpƒcho $obj_type ?>">

4 <
Ïb–
 
şass
="_left">

5 <
šput
 
ty³
="checkbox" 
checked
 
id
="Ãw_cu¡om”" 
v®ue
="AccouÁ" 
Çme
="AccouÁ" 
şass
="aû"/><
¥ª
 class="lbl">æ–°å»ºå®¢æˆ·</span>

6 </
Ïb–
>

7 <
div
 
şass
="_right">

8 <
bË
>

9 <
tbody
>

10 <
Œ
><
td
><
Ïb–
>åç§°</Ïb–></td><td><
šput
 
Çme
="AccouÁ.Name" 
şass
="şuesAccouÁName" 
v®ue
="<?phpƒcho $name ?>"></td></tr>

11 <
Œ
><
td
><
Ïb–
>æ‰€æœ‰è€…</Ïb–></td><td><
div
 
şass
="šput-group"><
šput
 
¡yË
="width:116px;" 
Çme
="AccouÁ.OwÃr" 
v®ue
="<?ph°echØ $this->£ssiÚ->u£rd©a('u£r_Çme'è?>" 
id
="Account_Owner"></div></td></tr>

12 <
Œ
><
td
><
Ïb–
>è¯·å…ˆå®šä¹‰å¯¹è±¡ç±»å‹</label></td>

13 <
td
>

14 <
£Ëù
 
Çme
="AccouÁ.Ty³.ID" 
şass
="form-control">

15 <?
php
 
echo
 
$obj_ty³_£Ëù_¬r
[0] ?>

16 </
£Ëù
>

17 </
td
>

18 </
Œ
>

19 </
tbody
>

20 </
bË
>

21 </
div
>

23 <
div
 
şass
="_clear"></div>

24 <
hr
>

25 <
Ïb–
 
şass
="_left">

26 <
šput
 
ty³
="checkbox" 
checked
 
şass
="aû‚ew" 
v®ue
="CÚù" 
Çme
="CÚù" 
id
="cÚù" /><
¥ª
 class="lbl">æ–°å»ºè”ç³»äºº</span>

27 </
Ïb–
>

28 <
div
 
şass
="_right" 
¡yË
="margin-right: 18px">

29 <
bË
>

30 <
tbody
>

31 <
Œ
><
td
><
Ïb–
>æ‰€æœ‰è€…</Ïb–></td><td><
div
 
şass
="šput-group"><
šput
 
¡yË
="width:116px;" 
Çme
="CÚù.OwÃr" 
v®ue
="<?ph°echØ $this->£ssiÚ->u£rd©a('u£r_Çme'è?>" 
id
="Contact_Owner"></div></td></tr>

32 <
Œ
><
td
><
Ïb–
>è¯·å…ˆå®šä¹‰å¯¹è±¡ç±»å‹</label></td><td>

33 <
£Ëù
 
Çme
="CÚù.Ty³.ID" 
şass
="form-control">

34 <?
php
 
echo
 
$obj_ty³_£Ëù_¬r
[1] ?>

35 </
£Ëù
>

36 </
td
>

37 </
Œ
>

38 </
tbody
>

39 </
bË
>

40 </
div
>

42 <
div
 
şass
="_clear"></div>

43 <
hr
>

44 <
Ïb–
 
şass
="_left‚ew">

45 <
šput
 
ty³
="checkbox" 
checked
 
şass
="aû‚ew" 
Çme
="OµÜtun™y" 
v®ue
="OµÜtun™y" 
id
="İpÜtun™y" /><
¥ª
 class="lbl">æ–°å»ºé”€å”®æœºä¼š</span>

46 </
Ïb–
>

47 <
div
 
şass
="_right">

48 <
bË
>

49 <
tbody
>

50 <
Œ
><
td
><
Ïb–
>åç§°</Ïb–></td><td><
šput
 
Çme
="OµÜtun™y.Name" 
şass
="şuesAccouÁName" 
v®ue
="<?phpƒcho $name ?>"></td></tr>

51 <
Œ
><
td
><
Ïb–
>æ‰€æœ‰è€…</Ïb–></td><td><
div
 
şass
="šput-group"><
šput
 
Çme
="OµÜtun™y.OwÃr" 
¡yË
="width:116px;" 
v®ue
="<?ph°echØ $this->£ssiÚ->u£rd©a('u£r_Çme'è?>" 
id
="Opportunity_Owner"></div></td></tr>

52 <
Œ
><
td
><
Ïb–
>è¯·å…ˆå®šä¹‰å¯¹è±¡ç±»å‹</label></td>

53 <
td
>

54 <
£Ëù
 
Çme
="OµÜtun™y.Ty³.ID" 
şass
="form-control">

55 <?
php
 
echo
 
$obj_ty³_£Ëù_¬r
[2] ?>

56 </
£Ëù
>

57 </
td
>

58 </
Œ
>

59 </
tbody
>

60 </
bË
>

61 </
div
>

62 <
div
 
şass
="_clear"></div>

63 </
fÜm
>

64 <
süt
 
ty³
="text/javascript">

65 
jQu”y
(
	$funùiÚ
(
$
) {

66 
	`$
("#AccouÁ_OwÃr").
	`QuÙeIn™Ÿl
({

67 
u¾
:"<?phpƒcho base_url()?>index.php/www/objects/ajax_lists?obj_type=99",

68 
t™Ë
:"æ‰€æœ‰è€…",

69 
Çme
:"Account.Owner"

74 
	`$
("#CÚù_OwÃr").
	`QuÙeIn™Ÿl
({

75 
u¾
:"<?phpƒcho base_url()?>index.php/www/objects/ajax_lists?obj_type=99",

76 
t™Ë
:"æ‰€æœ‰è€…",

77 
Çme
:"Contact.Owner"

80 
	`$
("#OµÜtun™y_OwÃr").
	`QuÙeIn™Ÿl
({

81 
u¾
:"<?phpƒcho base_url()?>index.php/www/objects/ajax_lists?obj_type=99",

82 
t™Ë
:"æ‰€æœ‰è€…",

83 
Çme
:"Opportunity.Owner"

86 
	`$
("#AccouÁ_OwÃr").
	`Ãxt
().
	`v®
("<?phpƒcho $this->session->userdata('user_id') ?>")

87 
	`$
("#CÚù_OwÃr").
	`Ãxt
().
	`v®
("<?phpƒcho $this->session->userdata('user_id') ?>")

88 
	`$
("#OµÜtun™y_OwÃr").
	`Ãxt
().
	`v®
("<?phpƒcho $this->session->userdata('user_id') ?>")

90 
	`$
("body").
	`Ú
("şick","#Ãw_cu¡om”",
	`funùiÚ
(){

91 if(
	`$
(
this
).
	`´İ
("checked")==
çl£
){

92 
	`$
(".Ãw").
	`´İ
("checked",
çl£
);

93 
	`$
("._right").
	`css
("display","none")

95 
	`$
(
this
).
	`·»Á
().
	`Ãxt
().
	`css
("display","block");

99 
	`$
("body").
	`Ú
("şick",".Ãw",
	`funùiÚ
(){

100 if(
	`$
(
this
).
	`´İ
("checked")){

101 
	`$
("#Ãw_cu¡om”").
	`´İ
("checked",
Œue
);

102 
	`$
("#Ãw_cu¡om”").
	`·»Á
().
	`Ãxt
().
	`css
("display","block");

103 
	`$
(
this
).
	`·»Á
().
	`Ãxt
().
	`css
("display","block");

105 
	`$
(
this
).
	`·»Á
().
	`Ãxt
().
	`css
("display","none");

109 
	}
});

110 </
	gsüt
>

111 <
	g¡yË
>

112 .
	g_Ëá
{

113 : 
Ëá
;

114 
	gm¬gš
-
	gtİ
: 3
px


116 .
_right
{

117 : 
right
;

120 .
	g_ş—r
{

121 
	gş—r
: 
bÙh
;

123 .
_right
 
	g¥ª
{

124 
	gwidth
: 5
px
;
	gheight
: 10px;

126 
	gšput
{

127 
	gbackground
-
	gcŞÜ
: #fff;

128 
	gbÜd”
: 1
px
 
sŞid
 #d5d5d5;

129 
	gbÜd”
-
	g¿dius
: 0 !
impÜÁ
;

130 
	gbox
-
	gshadow
: 
nÚe
 !
impÜÁ
;

131 
	gcŞÜ
: #858585;

132 
	gfÚt
-
	gçmy
: 
šh”™
;

133 
	gfÚt
-
	gsize
: 14
px
;

134 
	gŒªs™iÚ
-
	gdu¿tiÚ
: 0.1
s
;

136 </
	g¡yË
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/detail.php

1 <
	g¡yË
>

2 #li¡4 
Œ
 
td
 
šput
 {

3 
	gwidth
: 90
px
 !
impÜÁ
;

5 </
	g¡yË
>

6 <?
php


10 
	g$®l_©Œ
 = 
jsÚ_decode
(
$®l_©Œ
, 
Œue
);

11 
fÜ—ch
 (
$d‘a_t™Ë
 
as
 
$key
 => 
$v®ue
) {

12 
$cŞNames
[] = 
$v®ue
;

13 
	g$keys
 = 
¡r_»¶aû
(".", "_", 
$key
);

14 
	g$cŞMod–
[] = 
¬¿y
("Çme" => 
$keys
, "index" => $keys, "width" => 130, "sorttype" => "string");

15 
fÜ—ch
 (
$®l_©Œ
 
as
 
$k
 => 
$v
) {

16 ià(
$key
 =ğ
$v
["name"]) {

17 
$myd©a
[
$key
]["A‰rTy³"] = 
$v
["attr_type"];

18 
	g$myd©a
[
$key
]["Name"] = 
$v
["name"];

19 
	g$myd©a
[
$key
]["LªgEn"] = 
$v
["label"];

20 
	g$myd©a
[
$key
]["FromD©a"]["Çme"] = 
$v
["name"];

23 
p
(
$myd©a
);

26 <
bË
 
	gid
="list4"></table>

27 <
süt
 
ty³
="text/javascript">

28 
$
(
	$funùiÚ
 () {

29 
v¬
 
i
 = 0;

30 
funùiÚ
 
	`aá”
(
id
, 
Çme
, 
Ïb–
, 
u¾
) {

31 
	`$
("#" + 
id
).
	`QuÙeIn™Ÿl
({

32 
u¾
: url,

33 
t™Ë
: 
Ïb–
,

34 
Çme
:‚ame

38 
	`jQu”y
("#li¡4").
	`jqGrid
({

39 
d©©y³
: "local",

40 
height
: 250,

41 
cŞNames
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞNames
);?>,

42 
cŞMod–
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞMod–
);?>,

43 
ÿ±iÚ
: '<img src="/add.gif" id="add">&nbsp;&nbsp;&nbsp;&nbsp;<img src="/lookup.gif" id="add_much">'

46 
v¬
 
myd©a
 = [<?
php
 
echo
 
	`jsÚ_’code
(
$myd©a
);?>];

47 
v¬
 
¡r
 = 
JSON
.
	`¡ršgify
(
myd©a
[0]);

48 
v¬
 
İ”©iÚ
 = 
JSON
.
	`¡ršgify
(<?
php
 
echo
 
	`jsÚ_’code
(
$İ”©iÚ
);?>)

49 
	`$
("#İ”©iÚ").
	`v®
(
İ”©iÚ
)

50 
	`$
("#¡r").
	`v®
(
¡r
)

51 
	`$
("#add").
	`şick
(
	`funùiÚ
 () {

53 if(
	`$
("#li¡4").
	`chd»n
().
	`fšd
("Œ").
	`Ï¡
().
	`©Œ
("id"è=ğ
undefšed
){

54 
i
 = 0

56 
i
 = 
	`·r£IÁ
(
	`$
("#li¡4").
	`chd»n
().
	`fšd
("Œ").
	`Ï¡
().
	`©Œ
("id")) +1

59 
	`jQu”y
("#li¡4").
	`jqGrid
('addRowD©a', 
i
, 
myd©a
[0]);

60 
v¬
 
šputs
 = 
	`$
("#" + 
i
).
	`chd»n
().
	`fšd
("input");

61 
šputs
.
	`—ch
(
	`funùiÚ
 () {

62 
v¬
 
šdex
 = 
	`$
(
this
).
	`©Œ
("class");

63 ià(
šdex
.
	`šdexOf
(18) != -1) {

64 
v¬
 
id
 = 
	`$
(
this
).
	`©Œ
("id"è+ 
i


65 
	`$
(
this
).
	`©Œ
("id", 
id
)

66 
v¬
 
u¾
 = 
	`$
(
this
).
	`©Œ
("u")

67 
v¬
 
Ïb–
 = 
	`$
(
this
).
	`©Œ
("l")

68 
v¬
 
Çme
 = 
	`$
(
this
).
	`©Œ
("name")

69 
	`aá”
(
id
, 
Çme
, 
Ïb–
, 
u¾
)

71 ià(
šdex
.
	`šdexOf
("<?ph°echØ$İ”©iÚ["
»suÉs
"]?>") != -1) {

72 
	`$
(
this
).
	`©Œ
("readonly", "readonly")

74 ià(
šdex
.
	`šdexOf
("<?ph°echØ$İ”©iÚ["
fœ¡
"]?>") != -1) {

75 
v¬
 
Ï¡_obj
;

76 
v¬
 
»suÉs_obj
;

77 
šputs
.
	`—ch
(
	`funùiÚ
 () {

78 
v¬
 
šdex2
 = 
	`$
(
this
).
	`©Œ
("class");

79 ià(
šdex2
.
	`šdexOf
("<?ph°echØ$İ”©iÚ["
Ï¡
"]?>") != -1) {

80 
Ï¡_obj
 = 
this
;

81 
	`$
(
this
).
	`v®
(0)

83 ià(
šdex2
.
	`šdexOf
("<?ph°echØ$İ”©iÚ["
»suÉs
"]?>") != -1) {

84 
»suÉs_obj
 = 
this
;

87 
	`$
(
this
).
	`blur
(
	`funùiÚ
 () {

88 
v¬
 
fœ¡
 = 
	`·r£Flßt
(
	`$
(
this
).
	`v®
())

89 
v¬
 
Ï¡
 = 
	`·r£Flßt
(
	`$
(
Ï¡_obj
).
	`v®
())

90 ià("<?ph°echØ$İ”©iÚ["
symbŞ
"]?>" == "/") {

91 ià(
Ï¡
 != 0) {

92 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
<?
php
 
echo
 
$İ”©iÚ
["symbŞ"]?>
Ï¡
)

95 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
<?
php
 
echo
 
$İ”©iÚ
["symbŞ"]?>
Ï¡
)

102 ià(
šdex
.
	`šdexOf
("<?ph°echØ$İ”©iÚ["
Ï¡
"]?>") != -1) {

103 
v¬
 
fœ¡_obj
;

104 
v¬
 
»suÉs_obj
;

105 
šputs
.
	`—ch
(
	`funùiÚ
 () {

106 
v¬
 
šdex3
 = 
	`$
(
this
).
	`©Œ
("class");

107 ià(
šdex3
.
	`šdexOf
("<?ph°echØ$İ”©iÚ["
fœ¡
"]?>") != -1) {

108 
fœ¡_obj
 = 
this
;

109 
	`$
(
this
).
	`v®
(0)

111 ià(
šdex3
.
	`šdexOf
("<?ph°echØ$İ”©iÚ["
»suÉs
"]?>") != -1) {

112 
»suÉs_obj
 = 
this
;

115 
	`$
(
this
).
	`blur
(
	`funùiÚ
 () {

116 
v¬
 
Ï¡
 = 
	`·r£Flßt
(
	`$
(
this
).
	`v®
());

117 
v¬
 
fœ¡
 = 
	`·r£Flßt
(
	`$
(
fœ¡_obj
).
	`v®
());

118 ià("<?ph°echØ$İ”©iÚ["
symbŞ
"]?>" == "/") {

119 ià(
Ï¡
 != 0) {

120 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
<?
php
 
echo
 
$İ”©iÚ
["symbŞ"]?>
Ï¡
)

123 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
<?
php
 
echo
 
$İ”©iÚ
["symbŞ"]?>
Ï¡
)

129 ià(
šdex
.
	`šdexOf
(15) != -1) {

130 
	`$
(
this
).
	`d©•ick”
();

132 
	`$
(".3").
	`ÚlyMÚey
();

133 
	`$
(".1").
	`ÚlyNum
();

137 
	`$
("#"+
i
).
	`chd»n
().
	`fšd
(".add").
	`AjaxDŸlog
({

138 
DŸlogU¾
: "<?ph°echØba£_u¾()?>šdex.php/www/objeùs/d‘a_sšgË?obj_ty³=9&id="+
i
,

139 
DŸlogT™Ë
: "ä»·æ ¼è¡¨äº§å“",

140 
DŸlogWidth
: 800,

141 
DŸlogHeight
: 500

143 
	`$
("#"+
i
).
	`chd»n
().
	`fšd
(".d–").
	`şick
(
	`funùiÚ
(){

144 
	`$
(
this
).
	`·»Á
().·»Á().
	`»move
();

146 
	`$
("#add_much").
	`unbšd
("click")

147 
	`$
("#add_much").
	`AjaxDŸlog
({

148 
DŸlogU¾
: "<?ph°echØba£_u¾()?>šdex.php/www/objeùs/d‘a_check?obj_ty³=9&šdex="+
i
,

149 
DŸlogT™Ë
: "ä»·æ ¼è¡¨äº§å“",

150 
DŸlogWidth
: 800,

151 
DŸlogHeight
: 500

157 
	}
})

158 </
süt
>

159 <
šput
 
ty³
="hidd’" 
id
="str">

160 <
šput
 
ty³
="hidd’" 
id
="operation">

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/edit.php

2 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

3 <
div
 
şass
="main-content">

4 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

5 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

6 <
ul
 
şass
="breadcrumb">

7 <
li
>

8 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

9 <
a
 
h»f
="#">é¦–é¡µ</a>

10 </
li
>

11 <
li
 
şass
="aùive"><
a
 
h»f
="<?phpƒcho base_url(); ?>index.php/www/lead/list_json?>">çº¿ç´¢åˆ—è¡¨</a></li>

12 <
li
><?
php
 
echo
 
$Ëad_d©a
['L—d.Name']; ?></
	gli
>

13 </
	gul
><!-- /.
	gb»adüumb
 -->

14 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

15 </
div
>

17 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

18 <
div
 
şass
="page-content">

19 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

20 <
div
 
şass
="page-header">

21 <
h1
>

22 <?
php
 
echo
 
$Ëad_d©a
['Lead.Name']; ?>

23 <
	gsm®l
>

24 
L—d
 
	gv›w


25 </
	gsm®l
>

26 </
	gh1
>

27 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

29 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

30 <
div
 
	gşass
="row">

31 <
fÜm
 
id
="Form" >

33 <
šput
 
ty³
="hidd’" 
Çme
="<?ph°echØ$´im¬y['key']; ?>" 
v®ue
="<?phpƒcho $primary['value']; ?>"/>

34 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_mod–" 
v®ue
="<?phpƒcho $module; ?>"/>

35 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_aùiÚ" 
v®ue
="module_update"/>

36 <
div
 
şass
="col-xs-12">

37 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

38 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

40 </
bu‰Ú
>

41 <
bu‰Ú
 
şass
="btn btn-danger">

42 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

44 </
bu‰Ú
>

45 <
div
 
şass
="hr hr-dotted hr-16"></div>

46 </
div
>

48 <
div
 
şass
="cŞ-xs-12" 
id
="EditFormat"></div>

49 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

50 <
div
 
şass
="col-xs-12">

51 <
div
 
şass
="hr hr-dotted hr-16"></div>

52 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

53 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

55 </
bu‰Ú
>

56 <
süt
 
ty³
="text/javascript">

57 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

58 
	`$
('[Çme=§ve]').
	`şick
(
	`funùiÚ
(){

59 
v¬
 
d©a
 = 
	`$
("#FÜm").
	`£rŸlizeA¼ay
();

61 
$
.
	`ajax
({

63 'd©a':{'d©a':
d©a
},

64 'sucûss':
	`funùiÚ
(
d©a
){

68 'ÿche':
çl£


70  
çl£
;

72 
çl£
;

74 
	}
});

76 </
	gsüt
>

77 <
bu‰Ú
 
	gşass
="btn btn-danger">

78 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

80 </
bu‰Ú
>

81 </
div
>

82 </
fÜm
>

83 <
süt
 
ty³
="text/javascript">

85 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

86 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
); ?>;

87 
	`$
("#Ed™FÜm©").
	`FÜm©
({

88 
ty³
: "edit",

89 
FÜm©D©a
: 
fÜm©_d©a
,

90 
FromID
: "Form",

91 
S–eùChdEnumsU¾
: '<?phpƒcho base_url(); ?>index.php/admin/enum/SelectChildEnums'

94 
	`$
("#d‘a").
	`L“TabË
({

96 
CŞ
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞ
);?>,

97 
IsEd™
:
Œue


99 
	}
});

100 </
	gsüt
>

101 </
	gdiv
><!-- /.
	grow
 -->

102 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

104 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

105 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/edit_format.php

2 <
div
 
	gşass
="main-content">

3 <
div
 
şass
="row">

4 <
div
 
şass
="col-sm-10 col-sm-offset-1">

5 <
div
 
şass
="widget-boxransparent invoice-box">

6 <
div
 
şass
="row">

7 <
div
 
şass
="col-sm-10 col-sm-offset-1">

8 <
div
 
şass
="widget-boxransparent invoice-box">

9 <
div
 
şass
="widget-body">

10 <
div
 
şass
="widget-main…adding-24">

12 <?
php
 
$i
=0;
exŒaù
(
$bËs
[0], 
EXTR_OVERWRITE
); ?>

13 <
bË
 
	gşass
="tableable-stripedable-bordered">

15 <
Œ
>

16 <?
php
 
fÜ—ch
 (
$ûÎs
 
as
 
$k
 => 
$v
) {?>

18 <
td
 
row¥ª
="<?ph°echØ$v['row¥ª']?>" 
cŞ¥ª
="<?phpƒcho $v['colspan']?>" >

20 <?
php
 if(
$v
['label']==1){?>

21 <
Ïb–
 ="<?ph°echØ$v['Çme']?>"><?
php
 
echo
 
$v
[$v['Çme']]['Ïb–'];?></
	gÏb–
>

22 <?
	gphp
 }{?><
šput
 
	gid
="<?ph°echØ$v['Çme'];?>" 
v®ue
="<?ph°echØ$v['cÚ‹Á'];?>" 
»quœed
="<?php if($v['required']){echo"required";}?>"/>

23 <?
php
 }?>

25 </
	gtd
>

26 <?
php


27 
	g$i
=
$i
+
$v
['colspan'];

28 if(
	g$i
 % 
	g$cŞumns
 == 0 ){

29 
echo
 '</tr>';

31 }?></
	gŒ
>

32 </
	gbË
>

33 </
	gdiv
>

34 </
	gdiv
>

35 </
	gdiv
>

36 </
	gdiv
>

37 </
	gdiv
>

38 </
	gdiv
>

39 </
	gdiv
>

40 </
	gdiv
>

41 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/format.php

2 <
div
 
	gşass
="main-content">

3 <
div
 
şass
="row">

4 <
div
 
şass
="col-sm-10 col-sm-offset-1">

5 <
div
 
şass
="widget-boxransparent invoice-box">

6 <
div
 
şass
="row">

7 <
div
 
şass
="col-sm-10 col-sm-offset-1">

8 <
div
 
şass
="widget-boxransparent invoice-box">

9 <
div
 
şass
="widget-body">

10 <
div
 
şass
="widget-main…adding-24">

12 <?
php
 
$i
=0;
exŒaù
(
$bËs
[0], 
EXTR_OVERWRITE
); ?>

13 <
bË
 
	gşass
="tableable-stripedable-bordered">

15 <
Œ
>

16 <?
php
 
fÜ—ch
 (
$ûÎs
 
as
 
$k
 => 
$v
) {?>

18 <
td
 
row¥ª
="<?ph°echØ$v['row¥ª']?>" 
cŞ¥ª
="<?phpƒcho $v['colspan']?>" >

20 <?
php
 if(
$v
['label']==1){?>

21 <
div
 ><?
php
 
echo
 
$v
[$v['Çme']]['Ïb–'];?></
	gdiv
>

22 <?
	gphp
 }{?><
div
 
	gşass
=""> <?
php
 if(
is£t
(
$v
[$v['Çme'].".ENUM_VALUE"])){
echo
 $v[$v['Çme'].".ENUM_VALUE"];}
–£if
(is£t($v[$v['Çme'].".Name"])){echØ
	g$v
[$v['Çme'].".Name"];}{echØ$v['cÚ‹Á'];}?></
	gdiv
>

23 <?
	gphp
 }?>

25 </
	gtd
>

26 <?
php


27 
	g$i
=
$i
+
$v
['colspan'];

28 if(
	g$i
 % 
	g$cŞumns
 == 0 ){

29 
echo
 '</tr>';

31 }?></
	gŒ
>

32 </
	gbË
>

33 </
	gdiv
>

34 </
	gdiv
>

35 </
	gdiv
>

36 </
	gdiv
>

37 </
	gdiv
>

38 </
	gdiv
>

39 </
	gdiv
>

40 </
	gdiv
>

41 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/list.php

6 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

7 <
div
 
şass
="main-content">

8 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

9 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

10 <
ul
 
şass
="breadcrumb">

11 <
li
>

12 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

13 <
a
 
h»f
="#">é¦–é¡µ</a>

14 </
li
>

15 <
li
 
şass
="active">çº¿ç´¢åˆ—è¡¨</li>

16 </
ul
><!-- /.
b»adüumb
 -->

20 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

21 </
div
>

23 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

24 <
div
 
şass
="page-content">

25 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

26 <
div
 
şass
="page-header">

27 <
h1
>

29 <
sm®l
>

30 
L—d
 
Li¡


31 </
sm®l
>

32 </
h1
>

33 </
div
><!-- /.
·ge
-
h—d”
 -->

35 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

36 <
div
 
şass
="row">

38 <
div
 
şass
="col-xs-12">

39 <
a
 
h»f
="<?ph°echØs™e_u¾("
www
/
objeùs
/
add
?
obj_ty³
=91");?>"><
bu‰Ú
 
şass
="btn">

40 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

42 </
bu‰Ú
></
a
>

43 <
bu‰Ú
 
id
='Ëad_§Ë_£niÜqu”y' 
şass
="btn btn-primary">

44 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

46 </
bu‰Ú
>

47 <
süt
 
ty³
="text/javascript">

49 
$
(
docum’t
).
»ady
(
	$funùiÚ
() {

50 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
;?>;

51 
	`$
("#Ëad_§Ë_£niÜqu”y").
	`S’iÜQu”y
({

52 
S–eùA‰r
: 
£niÜqu”y_©Œ


55 
	}
});

56 </
	gsüt
>

57 <
bu‰Ú
 
	gşass
="btn btn-info">

58 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

60 </
bu‰Ú
>

61 <
bu‰Ú
 
şass
="btn btn-success">

62 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

64 </
bu‰Ú
>

65 <
bu‰Ú
 
şass
="btn btn-warning">

66 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

68 </
bu‰Ú
>

69 <
bu‰Ú
 
şass
="btn btn-danger">

70 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

72 </
bu‰Ú
>

73 <
bu‰Ú
 
şass
="btn btn-inverse">

74 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

76 </
bu‰Ú
>

77 <
bu‰Ú
 
şass
="btn btn-pink">

78 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

80 </
bu‰Ú
>

81 <
div
 
şass
="hr hr-dotted hr-16"></div>

82 </
div
>

84 <
div
 
şass
="col-xs-12">

85 <!-- 
PAGE
 
CONTENT
 
BEGINS
 -->

86 <
bË
 
id
="grid-table"></table>

88 <
div
 
id
="grid-pager"></div>

89 <!-- 
PAGE
 
CONTENT
 
ENDS
 -->

90 </
div
><!-- /.
cŞ
 -->

91 </
div
><!-- /.
row
 -->

92 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

94 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

95 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

101 <
süt
 
ty³
="text/javascript">

103 
jQu”y
(
	$funùiÚ
(
$
) {

104 
v¬
 
grid_£ËùÜ
 = "#grid-table";

105 
v¬
 
·g”_£ËùÜ
 = "#grid-pager";

108 
	`$
(
wšdow
).
	`Ú
('»size.jqGrid', 
	`funùiÚ
 () {

109 
	`$
(
grid_£ËùÜ
).
	`jqGrid
Ğ'£tGridWidth', $(".·ge-cÚ‹Á").
	`width
() );

112 
v¬
 
·»Á_cŞumn
 = 
	`$
(
grid_£ËùÜ
).
	`şo£¡
('[class*="col-"]');

113 
	`$
(
docum’t
).
	`Ú
('£‰šgs.aû.jqGrid' , 
	`funùiÚ
(
ev
, 
ev’t_Çme
, 
cŞÏp£d
) {

114 ifĞ
ev’t_Çme
 === 'sidebar_collapsed' ||ƒvent_name === 'main_container_fixed' ) {

115 
	`$
(
grid_£ËùÜ
).
	`jqGrid
Ğ'£tGridWidth', 
·»Á_cŞumn
.
	`width
() );

118 
v¬
 
u¾
 = "<?phpƒcho base_url();?>index.php/www/objects/list_json?id=<?phpƒcho $ObjType; ?>";

119 
v¬
 
cŞNames
 = <?
php
 
echo
 
$CŞNames
;?>;

120 
v¬
 
cŞMod–
 = <?
php
 
echo
 
$CŞMod–
;?>;

121 
v¬
 
jsÚ_d©a
 = "";

122 
	`jQu”y
(
grid_£ËùÜ
).
	`jqGrid
({

123 
u¾
:url,

124 
mty³
:"POST",

125 
d©©y³
:"json",

129 
height
: 420,

130 
cŞNames
:colNames,

131 
cŞMod–
:colModel,

132 
v›w»cÜds
 : 
Œue
,

133 
rowNum
:10,

134 
·g”
 : 
·g”_£ËùÜ
,

135 
®tRows
: 
Œue
,

136 
muÉi£Ëù
: 
Œue
,

137 
muÉiboxÚly
: 
Œue
,

138 
lßdCom¶‘e
 : 
	`funùiÚ
() {

139 
v¬
 
bË
 = 
this
;

140 
	`£tTimeout
(
	`funùiÚ
(){

141 
	`upd©ePag”IcÚs
(
bË
);

145 
befÜeProûssšg
: 
	`funùiÚ
(
xhr
) {

146 
jsÚ_d©a
 = 
xhr
;

148 
gridCom¶‘e
: 
	`funùiÚ
(){

149 
v¬
 
gt
 = 
	`$
("#grid-table");

150 
v¬
 
ids
 = 
gt
.
	`g‘D©aIDs
();

152 
v¬
 
v›w_u¾
 = "<?ph°echØs™e_u¾("
www
/
Ëad
/
v›w
");?>";

153 
v¬
 
ed™_u¾
 = "<?ph°echØs™e_u¾("
www
/
Ëad
/
ed™
");?>";

154 
v¬
 
d–_u¾
 = "<?ph°echØs™e_u¾("
www
/
Ëad
/
d–
");?>";

156 
v¬
 
i
=0;i<
ids
.
Ëngth
;i++){

157 
v¬
 
ş
 = 
ids
[
i
];

158 
v¬
 
·¿m_id
 = 
jsÚ_d©a
.
rows
[
i
].
ûÎ
['<?phpƒcho $obj_data["KEY_ATTR_NAME"];?>'];

159 
v›w
 = " <¨h»f='"+
v›w_u¾
+"?id="+
·¿m_id
+"'itle='æŸ¥çœ‹'><span class='ui-pg-div fa fa-search orange bigger-150'></span></a> ";

160 
ed™
 = " <¨h»f='"+
ed™_u¾
+"?id="+
·¿m_id
+"'itle='ç¼–è¾‘'><span class='fa fa-pencil blue bigger-150'></span></a> ";

161 
d–
 = " <span class='fa fa-trash-o„ed bigger-150'></span> ";

162 
	`jQu”y
("#grid-bË").
	`jqGrid
('£tRowD©a',
ids
[
i
],{
İ”©iÚ
:
v›w
+
ed™
+
d–
});

167 
	`$
("#Ëad_§Ë_£¬ch").
	`şick
(
	`funùiÚ
(){

168 
v¬
 
wsP¬ams
 = {"Lead.Company":"å¦é—¨å‘é¹­æ±Ÿå•†è´¸æœ‰é™å…¬å¸"};

169 
v¬
 
gridP¬am
 = {
u¾
:u¾,
d©©y³
:"jsÚ",
po¡D©a
:
wsP¬ams
,
·ge
:1};

170 
	`$
(
grid_£ËùÜ
).
	`jqGrid
('£tGridP¬am', 
gridP¬am
).
	`Œigg”
("reloadGrid");

175 
funùiÚ
 
	`upd©ePag”IcÚs
(
bË
) {

176 
v¬
 
»¶aûm’t
 =

183 
	`$
('.ui-pg-bË:nÙ(.ÇvbËè>body >¸> .ui-pg-bu‰Ú > .ui-icÚ').
	`—ch
(
	`funùiÚ
(){

184 
v¬
 
icÚ
 = 
	`$
(
this
);

185 
v¬
 
$şass
 = 
$
.
	`Œim
(
icÚ
.
	`©Œ
('şass').
	`»¶aû
('ui-icon', ''));

187 if(
$şass
 
š
 
»¶aûm’t
è
icÚ
.
	`©Œ
('class', 'ui-icon '+replacement[$class]);

192 
	`$
(
wšdow
).
	`Œigg”HªdËr
('resize.jqGrid');

193 
	}
});

194 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/view.php

2 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

3 <
div
 
şass
="main-content">

4 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

5 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

6 <
ul
 
şass
="breadcrumb">

7 <
li
>

8 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

9 <
a
 
h»f
="#">é¦–é¡µ</a>

10 </
li
>

11 <
li
 
şass
="aùive"><
a
 
h»f
="<?phpƒcho base_url();?>index.php/www/lead">çº¿ç´¢åˆ—è¡¨</a></li>

12 <
li
><?
php
 
echo
 
$Ëad_d©a
['L—d.Name'];?></
	gli
>

13 </
	gul
><!-- /.
	gb»adüumb
 -->

14 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

15 </
div
>

17 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

18 <
div
 
şass
="page-content">

19 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

20 <
div
 
şass
="page-header">

21 <
h1
>

22 <?
php
 
echo
 
$Ëad_d©a
['Lead.Name'];?>

23 <
	gsm®l
>

24 
L—d
 
	gv›w


25 </
	gsm®l
>

26 </
	gh1
>

27 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

29 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

30 <
div
 
	gşass
="row">

32 <
div
 
şass
="col-xs-12">

33 <
bu‰Ú
 
şass
="btn">

34 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

36 </
bu‰Ú
>

37 <
bu‰Ú
 
şass
="btn btn-info">

38 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

40 </
bu‰Ú
>

41 <
bu‰Ú
 
şass
="btn btn-success">

42 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

44 </
bu‰Ú
>

45 <
bu‰Ú
 
şass
="btn btn-warning">

46 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

48 </
bu‰Ú
>

49 <
bu‰Ú
 
şass
="btn btn-danger">

50 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

52 </
bu‰Ú
>

53 <
bu‰Ú
 
şass
="btn btn-inverse">

54 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

56 </
bu‰Ú
>

57 <
bu‰Ú
 
şass
="bŠ bŠ-pšk" 
id
="clues_into">

58 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

61 </
bu‰Ú
>

62 <
div
 
şass
="hr hr-dotted hr-16"></div>

63 </
div
>

65 <
div
 
id
="V›wFÜm©" 
şass
="cŞ-xs-12"></div><!-- /.
cŞ
 -->

66 <
süt
 
ty³
="text/javascript">

68 
$
(
docum’t
).
»ady
(
	$funùiÚ
() {

69 
	`$
("#şues_što").
	`AjaxDŸlog
({

70 
DŸlogU¾
:"<?phpƒcho base_url();?>index.php/www/lead/leadConversion",

71 
DŸlogT™Ë
:"çº¿ç´¢è½¬åŒ–",

72 
DŸlogWidth
:450,

73 
DŸlogHeight
:406,

74 
DŸlogD©a
:{
id
:<?
php
 
echo
 
$this
 -> 
šput
 -> 
	`g‘
("id")?>,
obj_ty³
:<?phpƒcho $this -> input -> get("obj_type")?>},

75 
DŸlogBu‰Ús
: [{

76 
‹xt
:"ç¡®å®š",

77 
CÏss
:"btn btn-primary",

78 
şick
: 
	`funùiÚ
(){

79 
v¬
 
sub
 = 
Œue
;

80 if(
	`$
("#šput_key_AccouÁ_OwÃr").
	`v®
().
Ëngth
 == 0){

81 
sub
 = 
çl£
;

82 
	`®”t
("è¯·é€‰æ‹©å®¢æˆ·æ‰€æœ‰è€…");

85 if(
	`$
("#cÚù").
	`´İ
("checked"è&& $("#šput_key_CÚù_OwÃr").
	`v®
().
Ëngth
 == 0){

86 
sub
 = 
çl£
;

87 
	`®”t
("è¯·é€‰æ‹©è”ç³»äººæ‰€æœ‰è€…");

90 if(
	`$
("#İpÜtun™y").
	`´İ
("checked"è&& $("#šput_key_OµÜtun™y_OwÃr").
	`v®
().
Ëngth
 == 0){

91 
sub
 = 
çl£
;

92 
	`®”t
("è¯·é€‰æ‹©è”ç³»äººæ‰€æœ‰è€…");

95 if(
sub
){

98 
	`$
("#şuesIÁoD©a").
	`subm™
();

104 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
);?>;

105 
	`$
("#V›wFÜm©").
	`FÜm©
({

106 
ty³
: "view",

107 
FÜm©D©a
: 
fÜm©_d©a


109 
	}
});

110 </
	gsüt
>

111 </
	gdiv
><!-- /.
	grow
 -->

112 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

114 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

115 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lee/export.php

1 <
süt
 
	gty³
="text/javascript">

2 
jQu”y
(
docum’t
).
»ady
(
	$funùiÚ
 () {

4 
	`$
("#addOÃ").
	`şick
(
	`funùiÚ
 () {

5 
	`$
("#äom o±iÚ:£Ëùed").
	`şÚe
().
	`­³ndTo
("#to");

6 
	`$
("#äom o±iÚ:£Ëùed").
	`»move
();

10 
	`$
("#addAÎ").
	`şick
(
	`funùiÚ
 () {

11 
	`$
("#äom o±iÚ").
	`şÚe
().
	`­³ndTo
("#to");

12 
	`$
("#äom o±iÚ").
	`»move
();

16 
	`$
("#»moveOÃ").
	`şick
(
	`funùiÚ
 () {

17 
	`$
("#tØİtiÚ:£Ëùed").
	`şÚe
().
	`­³ndTo
("#from");

18 
	`$
("#tØİtiÚ:£Ëùed").
	`»move
();

22 
	`$
("#»moveAÎ").
	`şick
(
	`funùiÚ
 () {

23 
	`$
("#tØİtiÚ").
	`şÚe
().
	`­³ndTo
("#from");

24 
	`$
("#tØİtiÚ").
	`»move
();

28 
	`$
("#Tİ").
	`şick
(
	`funùiÚ
 () {

29 
v¬
 
®lO±s
 = 
	`$
("#to option");

30 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

32 ià(
£Ëùed
.
	`g‘
(0).
šdex
 != 0) {

33 
i
 = 0; i < 
£Ëùed
.
Ëngth
; i++) {

34 
v¬
 
™em
 = 
	`$
(
£Ëùed
.
	`g‘
(
i
));

35 
v¬
 
tİ
 = 
	`$
(
®lO±s
.
	`g‘
(0));

36 
™em
.
	`š£¹BefÜe
(
tİ
);

42 
	`$
("#Up").
	`şick
(
	`funùiÚ
 () {

43 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

44 ià(
£Ëùed
.
	`g‘
(0).
šdex
 != 0) {

45 
£Ëùed
.
	`—ch
(
	`funùiÚ
 () {

46 
	`$
(
this
).
	`´ev
().
	`befÜe
($(this));

52 
	`$
("#Down").
	`şick
(
	`funùiÚ
 () {

53 
v¬
 
®lO±s
 = 
	`$
("#to option");

54 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

56 ià(
£Ëùed
.
	`g‘
(£Ëùed.
Ëngth
 - 1).
šdex
 !ğ
®lO±s
.length - 1) {

57 
i
 = 
£Ëùed
.
Ëngth
 - 1; i >= 0; i--) {

58 
v¬
 
™em
 = 
	`$
(
£Ëùed
.
	`g‘
(
i
));

59 
™em
.
	`š£¹Aá”
(™em.
	`Ãxt
());

65 
	`$
("#Bu‰om").
	`şick
(
	`funùiÚ
 () {

66 
v¬
 
®lO±s
 = 
	`$
("#to option");

67 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

69 ià(
£Ëùed
.
	`g‘
(£Ëùed.
Ëngth
 - 1).
šdex
 !ğ
®lO±s
.length - 1) {

70 
i
 = 
£Ëùed
.
Ëngth
 - 1; i >= 0; i--) {

71 
v¬
 
™em
 = 
	`$
(
£Ëùed
.
	`g‘
(
i
));

72 
v¬
 
bu‰om
 = 
	`$
(
®lO±s
.
	`g‘
(
Ëngth
 - 1));

73 
™em
.
	`š£¹Aá”
(
bu‰om
);

79 
	}
});

80 </
	gsüt
>

81 <
div
 
	gşass
="row">

82 <
div
 
şass
="col-xs-12 col-md-5">

83 <
div
 
şass
="well">

84 <
h3
 
şass
="header blue†ighter smaller">

85 <
i
 
şass
="ace-icon fa fa-calendar-o smaller-90"></i>

87 </
h3
>

88 <
£Ëù
 
Çme
="äom" 
id
="äom" 
¡yË
="width:100%;" 
size
="10" 
muÉË
="multiple">

89 <
İtiÚ
 
v®ue
="1">1</option>

90 <
İtiÚ
 
v®ue
="2">2</option>

91 <
İtiÚ
 
v®ue
="3">3</option>

92 <
İtiÚ
 
v®ue
="1">1</option>

93 <
İtiÚ
 
v®ue
="2">2</option>

94 <
İtiÚ
 
v®ue
="3">3</option>

95 <
İtiÚ
 
v®ue
="1">1</option>

96 <
İtiÚ
 
v®ue
="2">2</option>

97 <
İtiÚ
 
v®ue
="3">3</option>

98 <
İtiÚ
 
v®ue
="1">1</option>

99 <
İtiÚ
 
v®ue
="2">2</option>

100 <
İtiÚ
 
v®ue
="3">3</option>

101 <
İtiÚ
 
v®ue
="1">1</option>

102 <
İtiÚ
 
v®ue
="2">2</option>

103 <
İtiÚ
 
v®ue
="3">3</option>

104 </
£Ëù
>

105 </
div
>

106 </
div
>

107 <
div
 
şass
="col-xs-12 col-md-2">

108 <
div
 
şass
="well with-header">

109 <
h3
 
şass
="header blue†ighter smaller">

111 </
h3
>

112 <
div
 
şass
="span2">

113 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Tİ" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

114 <
i
 
şass
="ace-icon fa fa-angle-double-up bigger-120 blue"></i>

115 </
a
>

116 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Up" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

117 <
i
 
şass
="ace-icon fa fa-angle-up bigger-120 blue"></i>

118 </
a
>

119 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="addOÃ" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

120 <
i
 
şass
="ace-icon fa fa-angle-right bigger-120 blue"></i>

121 </
a
>

122 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="»moveOÃ" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

123 <
i
 
şass
="ace-icon fa fa-angle-left bigger-120 blue"></i>

124 </
a
>

125 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Down" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

126 <
i
 
şass
="ace-icon fa fa-angle-down bigger-120 blue"></i>

127 </
a
>

128 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Bu‰om" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

129 <
i
 
şass
="ace-icon fa fa-angle-double-down bigger-120 blue"></i>

130 </
a
>

131 </
div
>

132 </
div
>

133 </
div
>

134 <
div
 
şass
="col-xs-12 col-md-5">

135 <
div
 
şass
="well with-header">

136 <
h3
 
şass
="header blue†ighter smaller">

137 <
i
 
şass
="ace-icon fa fa-calendar-o smaller-90"></i>

139 </
h3
>

140 <
£Ëù
 
Çme
="to" 
id
="to" 
¡yË
="width:100%;" 
size
="10" 
muÉË
="multiple">

141 <
İtiÚ
 
v®ue
="4">4</option>

142 <
İtiÚ
 
v®ue
="5">5</option>

143 <
İtiÚ
 
v®ue
="6">6</option>

144 </
£Ëù
>

145 </
div
>

146 </
div
>

147 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/login/index.php

1 <!
DOCTYPE
 
	ghtml
>

2 <
html
 
	gÏng
="en">

3 <
h—d
>

4 <
m‘a
 
h‰p
-
equiv
="X-UA-Com·tibË" 
cÚ‹Á
="IE=edge,chrome=1" />

5 <
m‘a
 
ch¬£t
="utf-8" />

6 <
t™Ë
>ç™»é™† - 
ŒuecŞÜ
</title>

8 <
m‘a
 
Çme
="desütiÚ" 
cÚ‹Á
="User†ogin…age" />

9 <
m‘a
 
Çme
="v›wpÜt" 
cÚ‹Á
="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

11 <!-- 
boÙ¡¿p
 & 
fÚwesome
 -->

12 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/bootstrap.min.css" />

13 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/font-awesome.min.css" />

15 <!-- 
‹xt
 
fÚts
 -->

16 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/ace-fonts.css" />

18 <!-- 
aû
 
¡yËs
 -->

19 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/ace.min.css" />

21 <!--[
Ée
 
IE
 9]>

22 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/ace-part2.min.css" />

23 <![
’dif
]-->

24 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/ace-rtl.min.css" />

26 <!--[
Ée
 
IE
 9]>

27 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/ace-ie.min.css" />

28 <![
’dif
]-->

29 <
lšk
 
»l
="¡yËsh“t" 
h»f
="<?phpƒcho base_url();?>style/ace/css/ace.onpage-help.css" />

31 <!-- 
HTML5
 
shim
 
ªd
 
Re¥Úd
.
js
 
IE8
 
suµÜt
 
of
 HTML5 
–em’ts
‡nd 
medŸ
 
qu”›s
 -->

33 <!--[
É
 
IE
 9]>

34 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/html5shiv.js"></script>

35 <
süt
 
¤c
="<?phpƒcho base_url();?>style/ace/js/respond.min.js"></script>

36 <![
’dif
]-->

37 </
h—d
>

39 <
body
 
şass
="login-layout">

40 <
div
 
şass
="main-container">

41 <
div
 
şass
="main-content">

42 <
div
 
şass
="row">

43 <
div
 
şass
="col-sm-10 col-sm-offset-1">

44 <
div
 
şass
="login-container">

45 <
div
 
şass
="center">

46 <
h1
>

47 <
i
 
şass
="ace-icon fa fa-leaf green"></i>

48 <
¥ª
 
şass
="»d">
TrueCŞÜ
</span>

49 <
¥ª
 
şass
="wh™e" 
id
="id-text2">ç”¨æˆ·ç™»å½•</span>

50 </
h1
>

51 <
h4
 
şass
="blue" 
id
="id-com·ny-‹xt">&
cİy
; 
	gTRUECOLOR
</
	gh4
>

52 </
	gdiv
>

54 <
div
 
	gşass
="space-6"></div>

56 <
div
 
şass
="position-relative">

57 <
div
 
id
="logš-box" 
şass
="login-box visible widget-box‚o-border">

58 <
div
 
şass
="widget-body">

59 <
div
 
şass
="widget-main">

60 <
h4
 
şass
="header blue†ighter bigger">

61 <
i
 
şass
="ace-icon fa fa-coffee green"></i>

63 </
h4
>

64 <
div
 
şass
="space-6"></div>

65 <
fÜm
 
aùiÚ
="<?ph°echØba£_u¾()?>šdex.php/www/logš" 
m‘hod
="post">

66 <
f›ld£t
>

67 <
Ïb–
 
şass
="block clearfix">

68 <
¥ª
 
şass
="block input-icon input-icon-right">

69 <
šput
 
Çme
="u£r[Ügcode]" 
ty³
="‹xt" 
şass
="fÜm-cÚŒŞ" 
¶aûhŞd”
="å•ä½ç®€ç§°" 
v®ue
="<?ph°if(is£t($Ügcode)){echØ$Ügcode;}–£{echØ"
TrueCŞÜ
";}?>" 
t™Ë
="å•ä½ç®€ç§°" 
d©a
-
»l
="toŞt" d©a-
¶aûm’t
="right"/>

70 <
i
 
şass
="ace-icon fa fa-home"></i>

71 </
¥ª
>

72 </
Ïb–
>

73 <
Ïb–
 
şass
="block clearfix">

74 <
¥ª
 
şass
="block input-icon input-icon-right">

75 <
£Ëù
 
Çme
="u£r[logš_sys]" 
şass
="fÜm-cÚŒŞ" 
id
="fÜm-f›ld-£Ëù-1" 
t™Ë
="ç³»ç»Ÿæ¨¡å—" 
d©a
-
»l
="toŞt" d©a-
¶aûm’t
="right">

76 <
İtiÚ
 
v®ue
="1" <?
php
 if(
	$is£t
(
$logš_sys
)){if($logš_sys==1){
echo
 '£Ëùed="£Ëùed"';}
	}
}?>>è®¢å•ç®¡ç†</
	gİtiÚ
>

77 <
İtiÚ
 
	gv®ue
="2" <?
php
 if(
	$is£t
(
$logš_sys
)){if($logš_sys==2){
echo
 '£Ëùed="£Ëùed"';}
	}
}?>>é—¨æˆ·ç®¡ç†</
	gİtiÚ
>

78 </
	g£Ëù
>

79 </
	g¥ª
>

80 </
	gÏb–
>

81 <
Ïb–
 
	gşass
="block clearfix">

82 <
¥ª
 
şass
="block input-icon input-icon-right">

83 <
šput
 
Çme
="u£r[logš_Çme]" 
ty³
="‹xt" 
şass
="fÜm-cÚŒŞ" 
¶aûhŞd”
="ç™»å½•å" 
v®ue
="<?ph°if(is£t($logš_Çme)){echØ$logš_Çme;}?>" 
t™Ë
="ç™»å½•å" 
d©a
-
»l
="toŞt" d©a-
¶aûm’t
="right"/>

84 <
i
 
şass
="ace-icon fa fa-user"></i>

85 </
¥ª
>

86 </
Ïb–
>

88 <
Ïb–
 
şass
="block clearfix">

89 <
¥ª
 
şass
="block input-icon input-icon-right">

90 <
šput
 
Çme
="u£r[·sswÜd]" 
ty³
="·sswÜd" 
şass
="fÜm-cÚŒŞ" 
¶aûhŞd”
="å¯†ç " 
v®ue
="<?ph°if(is£t($·sswÜd)){echØ$·sswÜd;}?>" 
t™Ë
="å¯†ç " 
d©a
-
»l
="toŞt" d©a-
¶aûm’t
="right"/>

91 <
i
 
şass
="ace-icon fa fa-lock"></i>

92 </
¥ª
>

93 </
Ïb–
>

95 <
div
 
şass
="space"></div>

97 <
div
 
şass
="clearfix">

98 <
Ïb–
 
şass
="inline">

99 <
šput
 
ty³
="checkbox" 
şass
="ace" />

100 <
¥ª
 
şass
="lbl"> è®°ä½è´¦å·</span>

101 </
Ïb–
>

103 <
bu‰Ú
 
ty³
="subm™" 
şass
="width-35…ull-right btn btn-sm btn-primary">

104 <
i
 
şass
="ace-icon fa fa-key"></i>

105 <
¥ª
 
şass
="bigger-110">ç™»å½•</span>

106 </
bu‰Ú
>

107 </
div
>

109 <
div
 
şass
="space-4"></div>

110 <?
php
 if(
$”rÜ
!=""){?>

111 <
div
 
şass
="alert‡lert-danger">

112 <
bu‰Ú
 
ty³
="bu‰Ú" 
şass
="şo£" 
d©a
-
dismiss
="alert">

113 <
i
 
şass
="ace-icon fa fa-times"></i>

114 </
bu‰Ú
>

115 <?
php
 
echo
 
$”rÜ
;?>

116 <
	gbr
 />

117 </
	gdiv
>

118 <?
	gphp
 } ?>

119 </
	gf›ld£t
>

120 </
	gfÜm
>

122 </
	gdiv
><!-- /.
	gwidg‘
-
	gmaš
 -->

124 </
	gdiv
><!-- /.
	gwidg‘
-
	gbody
 -->

125 </
	gdiv
><!-- /.
	glogš
-
	gbox
 -->

127 </
	gdiv
><!-- /.
	gpos™iÚ
-
	g»Ïtive
 -->

129 </
	gdiv
>

130 </
	gdiv
><!-- /.
	gcŞ
 -->

131 </
	gdiv
><!-- /.
	grow
 -->

132 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

133 </
	gdiv
><!-- /.
	gmaš
-
	gcÚš”
 -->

135 <!-- 
basic
 
	gsüts
 -->

137 <!--[!
IE
]> -->

138 <
süt
 
	gty³
="text/javascript">

139 
wšdow
.
jQu”y
 || 
docum’t
.
wr™e
("<script src='<?phpƒcho base_url();?>style/ace/js/jquery.min.js'>"+"<"+"/script>");

140 </
	gsüt
>

142 <!-- <![
’dif
]-->

144 <!--[
IE
]>

145 <
süt
 
	gty³
="text/javascript">

146 
wšdow
.
jQu”y
 || 
docum’t
.
wr™e
("<script src='<?phpƒcho base_url();?>style/ace/js/jquery1x.min.js'>"+"<"+"/script>");

147 </
	gsüt
>

148 <![
’dif
]-->

149 <
süt
 
	g¤c
="<?phpƒcho base_url();?>style/ace/js/bootstrap.min.js"></script>

151 <!-- 
šlše
 
süts
 
»Ï‹d
 
to
 
this
 
·ge
 -->

152 <
süt
 
ty³
="text/javascript">

153 
jQu”y
(
	$funùiÚ
(
$
) {

154 
	`$
(
docum’t
).
	`Ú
('şick', '.toŞb¬‡[d©a-rg‘]', 
	`funùiÚ
(
e
) {

155 
e
.
	`´ev’tDeçuÉ
();

156 
v¬
 
rg‘
 = 
	`$
(
this
).
	`d©a
('target');

157 
	`$
('.widg‘-box.visibË').
	`»moveCÏss
('visible');

158 
	`$
(
rg‘
).
	`addCÏss
('visible');

160 
	}
});

163 
jQu”y
(
	$funùiÚ
(
$
) {

165 
	`$
('body').
	`©Œ
('class', 'login-layout blur-login');

166 
	`$
('#id-‹xt2').
	`©Œ
('class', 'white');

167 
	`$
('#id-com·ny-‹xt').
	`©Œ
('class', 'light-blue');

169 
	`$
('[d©a-»lñoŞt]').
	`toŞt
();

171 
	}
});

172 </
	gsüt
>

173 </
	gbody
>

174 </
	ghtml
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/login/modify_password.php

1 <
süt
 
	gty³
="text/javascript">

2 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

3 
	`$
('[Çme=mÿnûl]').
	`şick
(
	`funùiÚ
(){

4 
	`$
('#modify').
	`dŸlog
("close");

6  
çl£
;

7 
	}
});

9 </
	gsüt
>

10 <
div
 
	gşass
 = "col-xs-12">

11 <
fÜm
 
id
="FÜm11" 
Úsubm™
="return false">

12 <
bË
 
şass
 = "tableable-stripedable-bordered">

13 <
tbody
>

14 <
Œ
>

15 <
td
 
row¥ª
="1" 
cŞ¥ª
="1" 
¡yË
="width:25%;text-align:right;font-weight:bold;color:#0daed3;line-height: 34px;">åŸå¯†ç </td>

16 <
td
 
row¥ª
="1" 
cŞ¥ª
="1" 
¡yË
="width:75%;text-align:left;">

17 <
div
 
şass
="form-group">

18 <
šput
 
ty³
="·sswÜd" 
şass
="cŞ-xs-12" 
Çme
='User.LoginPassword'>

19 </
div
>

20 </
td
>

21 </
Œ
>

22 <
Œ
>

23 <
td
 
row¥ª
="1" 
cŞ¥ª
="1" 
¡yË
="width:25%;text-align:right;font-weight:bold;color:#0daed3;line-height: 34px;">å¯†ç </td>

24 <
td
 
row¥ª
="1" 
cŞ¥ª
="1" 
¡yË
="width:75%;text-align:left;">

25 <
div
 
şass
="form-group">

26 <
šput
 
id
="·sswÜd" 
ty³
="·sswÜd" 
şass
="cŞ-xs-12" 
Çme
='password'>

27 </
div
>

28 </
td
>

29 </
Œ
>

30 <
Œ
>

31 <
td
 
row¥ª
="1" 
cŞ¥ª
="1" 
¡yË
="width:25%;text-align:right;font-weight:bold;color:#0daed3;line-height: 34px;">ç¡®è®¤å¯†ç </td>

32 <
td
 
row¥ª
="1" 
cŞ¥ª
="1" 
¡yË
="width:75%;text-align:left;">

33 <
div
 
şass
="form-group">

34 <
šput
 
id
="cÚfœm_·sswÜd" 
ty³
="·sswÜd" 
şass
="cŞ-xs-12" 
Çme
='confirm_password'>

35 </
div
>

36 </
td
>

37 </
Œ
>

38 </
tbody
>

39 </
bË
>

40 <
div
 
şass
="col-xs-12">

41 <
div
 
şass
="hr hr-dotted hr-16"></div>

42 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="msave">

43 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

45 </
bu‰Ú
>

46 <
a
 
şass
="bŠ bŠ-dªg”" 
Çme
="mcancel">

47 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

49 </
a
>

51 </
div
>

52 </
fÜm
>

53 <
süt
 
ty³
="text/javascript">

54 
$
(
docum’t
).
»ady
(
	$funùiÚ
(){

56 
	`$
('#FÜm11').
	`v®id©e
({

57 
ruËs
:{

58 
·sswÜd
: {

59 
»quœed
: 
Œue
,

60 
mšËngth
: 5

62 
cÚfœm_·sswÜd
: {

63 
»quœed
: 
Œue
,

64 
mšËngth
: 5,

65 
equ®To
: "#password"

68 
subm™HªdËr
: 
	`funùiÚ
() {

69 
v¬
 
d©a
 = 
	`$
("#FÜm11").
	`£rŸlizeA¼ay
();

70 
$
.
	`ajax
({

72 'd©a':
d©a
,

73 'sucûss':
	`funùiÚ
(
d©a
){

75 
d©a
 = 
	`ev®
("("+data+")");

77 if(
d©a
.
»s
=='suc'){

78 
	`®”t
(
d©a
.
msg
);

79 
	`$
("#modify").
	`dŸlog
("close");

81 
	`®”t
(
d©a
.
msg
);

86 'ÿche':
çl£


90 
	}
});

115 </
	gsüt
>

116 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/message/add.php

2 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

3 <
div
 
şass
="main-content">

4 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

5 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

6 <
ul
 
şass
="breadcrumb">

7 <
li
>

8 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

9 <
a
 
h»f
="#">é¦–é¡µ</a>

10 </
li
>

11 <
li
 
şass
="aùive"><
a
 
h»f
="<?phpƒcho base_url();?>index.php/www/lead/list_json?>">çº¿ç´¢åˆ—è¡¨</a></li>

12 <
li
><?
php
 
echo
 
$Ëad_d©a
['L—d.Name'];?></
	gli
>

13 </
	gul
><!-- /.
	gb»adüumb
 -->

14 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

15 </
div
>

17 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

18 <
div
 
şass
="page-content">

19 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

20 <
div
 
şass
="page-header">

21 <
h1
>

22 <?
php
 
echo
 
$Ëad_d©a
['Lead.Name'];?>

23 <
	gsm®l
>

24 
L—d
 
	gv›w


25 </
	gsm®l
>

26 </
	gh1
>

27 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

29 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

30 <
div
 
	gşass
="row">

31 <
fÜm
 
id
="Form">

32 <
šput
 
ty³
="hidd’" 
Çme
="<?ph°echØ$´im¬y['key'];?>" 
v®ue
="<?phpƒcho $primary['value'];?>"/>

33 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_mod–" 
v®ue
="<?phpƒcho $module;?>"/>

34 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_aùiÚ" 
v®ue
="module_add"/>

35 <
div
 
şass
="col-xs-12">

36 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

37 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

39 </
bu‰Ú
>

40 <
bu‰Ú
 
şass
="btn btn-danger">

41 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

43 </
bu‰Ú
>

44 <
div
 
şass
="hr hr-dotted hr-16"></div>

45 </
div
>

47 <
div
 
şass
="cŞ-xs-12" 
id
="EditFormat"></div>

48 <
div
 
şass
="hr hr-dotted hr-16"></div>

49 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

50 <
div
 
şass
="col-xs-12">

51 <
div
 
şass
="hr hr-dotted hr-16"></div>

52 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

53 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

55 </
bu‰Ú
>

56 <
süt
 
ty³
="text/javascript">

57 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

58 
	`$
('[Çme=§ve]').
	`şick
(
	`funùiÚ
(){

59 
v¬
 
d©a
 = 
	`$
("#FÜm").
	`£rŸlizeA¼ay
();

61 
$
.
	`ajax
({

63 'd©a':{'d©a':
d©a
},

64 'sucûss':
	`funùiÚ
(
d©a
){

65 if(
d©a
==""){

66 
loÿtiÚ
.
h»f
="<?phpƒcho base_url(); ?>index.php/www/"

68 
	`®”t
(
d©a
);

73 'ÿche':
çl£


75  
çl£
;

77 
çl£
;

79 
	}
});

81 </
	gsüt
>

82 <
bu‰Ú
 
	gşass
="btn btn-danger">

83 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

85 </
bu‰Ú
>

86 </
div
>

87 </
fÜm
>

88 <?
php


89 <
süt
 
ty³
="text/javascript">

91 
$
(
docum’t
).
»ady
(
	$funùiÚ
() {

92 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
);?>;

93 
	`$
("#Ed™FÜm©").
	`FÜm©
({

94 
ty³
: "edit",

95 
FÜm©D©a
: 
fÜm©_d©a
,

96 
FromID
:"Form",

97 
S–eùChdEnumsU¾
:'<?phpƒcho base_url();?>index.php/admin/enum/SelectChildEnums'

100 
	`$
("#d‘a").
	`L“TabË
({

112 
CŞ
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞ
);?>,

116 
IsEd™
:
Œue


127 
	}
});

128 </
	gsüt
>

129 </
	gdiv
><!-- /.
	grow
 -->

130 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

132 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

133 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/message/list.php

1 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

2 <
div
 
şass
="main-content">

3 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

4 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

5 <
ul
 
şass
="breadcrumb">

6 <
li
>

7 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

8 <
a
 
h»f
="#">é¦–é¡µ</a>

9 </
li
>

10 <
li
 
şass
="active">æ¶ˆæ¯åˆ—è¡¨</li>

11 </
ul
><!-- /.
b»adüumb
 -->

15 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

16 </
div
>

18 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

19 <
div
 
şass
="page-content">

20 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

21 <
div
 
şass
="page-header">

22 <
h1
>

24 <
sm®l
>

25 
Mes§ge
 
Li¡


26 </
sm®l
>

27 </
h1
>

28 </
div
><!-- /.
·ge
-
h—d”
 -->

30 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

31 <
div
 
şass
="row">

33 <!--<
div
 
şass
="col-xs-12">

34 <
div
 
şass
="btn-group">

35 <
a
 
şass
="bŠ bŠ-´im¬y" 
d©a
-
toggË
="dropdown">

37 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

39 <
¥ª
 
şass
="ace-icon fa fa-angle-down icon-only smaller-90"></span>

40 </
a
>

41 <
ul
 
şass
="dropdown-menu dropdown-warning">

42 <
li
>

43 <
a
 
h»f
="http://localhost:88/ncrm/index.php/www/message/add?obj_type=<?phpƒcho $ObjType;?>&type_id=1"> ç³»ç»Ÿæ¶ˆæ¯ </a>

44 </
li
>

45 <
li
>

46 <
a
 
h»f
="http://localhost:88/ncrm/index.php/www/message/add?obj_type=<?phpƒcho $ObjType;?>&type_id=2"> ç”¨æˆ·æ¶ˆæ¯ </a>

47 </
li
>

48 </
ul
>

49 </
div
>

50 <?
php
 
¬¿y_shiá
(
$but_¬¿y
);

51 
fÜ—ch
(
$but_¬¿y
 
as
 
$k
=>
$v
){?>

52 <
div
 
şass
="btn-group">

53 <
a
 
şass
="<?ph°echØ$v['cŞour'];?>" <?
php
 if(
is£t
(
$v
['id'])è{
echo
 "id=".$v['id'];}?> <?ph°if(is£t($v['u¾'])è{
	gecho
 "h»f=".
	g$v
['url'];}?> <?php if(isset($v['dropdown'])){echo 'data-toggle="dropdown"';}?>>

54 <
i
 
	gşass
="ace-icon <?phpƒcho $v['icon'];?>‡lign-top bigger-125"></i>

55 <?
php
 
echo
 
$v
['name'];?>

56 <?
php
 if(
is£t
(
$v
['dropdown'])){?>

57 <
¥ª
 
	gşass
="ace-icon fa fa-angle-down icon-only smaller-90"></span>

58 <?
php
 }?>

59 </
	ga
>

60 <?
php
 if(
is£t
(
$v
['dropdown'])){?>

61 <
ul
 
	gşass
="dropdown-menu dropdown-warning">

62 <?
php
 
fÜ—ch
(
$v
['drİdown'] 
as
 
$dk
=>
$dv
){?>

63 <
li
>

64 <
a
 <?
php
 if(
is£t
(
$dv
['u¾'])è{
echo
 "h»f=".$dv['u¾'];}?> <?ph°if(is£t($dv['id'])è{
	gecho
 "id=".
	g$dv
['id'];}?>>

65 <?
php
 
echo
 
	g$dv
["name"];?>

66 </
	ga
>

67 <?
php
 if(
is£t
(
$dv
['javascript'])){?>

68 <
süt
 
	gty³
="text/javascript">

69 <?
php
 
echo
 
$dv
['javascript'];?>

70 </
	gsüt
>

71 <?
	gphp
 }?>

72 </
	gli
>

73 <?
	gphp
 }?>

74 </
	gul
>

75 <?
	gphp
 }?>

76 </
	gdiv
>

77 <?
php
 if(
is£t
(
$v
['javascript'])){?>

78 <
süt
 
	gty³
="text/javascript">

79 <?
php
 
echo
 
$v
['javascript'];?>

80 </
	gsüt
>

81 <?
	gphp
 }?>

82 <?
	gphp
 }?>

83 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

84 </
div
>-->

86 <
div
 
şass
="cŞ-xs-12" 
id
="message_page-content">

88 </
div
> <!-- /.
cŞ
 -->

89 <!--<
a
 
id
="G‘S–eùedID"> è·å–é€‰ä¸­çš„
ID
 </a>

90 <
a
 
id
="GetSelectedAttr"> è·å–é€‰ä¸­çš„å±æ€§ </a>

91 <
a
 
id
="SetGridParam"> åˆ·æ–°å½“å‰åˆ—è¡¨ </a>-->

93 </
div
><!-- /.
row
 -->

94 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

96 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

97 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

99 <
süt
 
ty³
="text/javascript">

100 
jQu”y
(
	$funùiÚ
 (
$
) {

101 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/message/list_json?obj_type=<?phpƒcho $ObjType; ?>";

102 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

103 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

104 
	`$
("#mes§ge_·ge-cÚ‹Á").
	`L“TabË
({

105 
U¾
:
u¾
,

106 
O³¿tiÚ
:[

107 {
T™Ë
:'æŸ¥çœ‹',
U¾
:'<?ph°echØs™e_u¾("www/mes§ge/v›w"); ?>?id={' + 
key©ŒÇme
 + '}&obj_ty³=<?ph°echØ$ObjTy³; ?>',
Css
:'fa fa-search orange'},

109 {
T™Ë
:'åˆ é™¤',
U¾
:'javasüt:void(0);',
Js
:"dÉ('{<?ph°echØ$obj_d©a["
KEY_ATTR_NAME
"]; ?>}','<?ph°echØ$ObjTy³; ?>','#L“TabË','<?ph°echØba£_u¾(); ?>šdex.php/www/objeùs/li¡_jsÚ?obj_ty³=<?ph°echØ$ObjTy³; ?>')",
Css
:'fa fa-trash-o„ed'},

112 
CŞ
:
cŞ
,

113 
MuÉiS–eù
:
Œue
,

114 
MuÉiTy³
:0,

115 
KeyA‰rName
:
key©ŒÇme


117 
	}
});

119 
$
('#G‘S–eùedID').
şick
(
	$funùiÚ
(){

120 
cÚsŞe
.
	`debug
(
	`$
("#<?ph°echØ$objName[0]['LABEL'] ?>_·ge-cÚ‹Á").
	`L“TabË
('GetSelectedID'));

121 
	}
});

122 
$
('#G‘S–eùedA‰r').
şick
(
	$funùiÚ
(){

123 
cÚsŞe
.
	`debug
(
	`$
("#<?ph°echØ$objName[0]['LABEL'] ?>_·ge-cÚ‹Á").
	`L“TabË
('GetSelectedAttr'));

124 
	}
});

125 
$
('#S‘GridP¬am').
şick
(
	$funùiÚ
(){

126 
	`$
("#<?ph°echØ$objName[0]['LABEL'] ?>_·ge-cÚ‹Á").
	`L“TabË
('SetGridParam');

127 
	}
});

129 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/message/view.php

2 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

3 <
div
 
şass
="main-content">

4 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

5 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

6 <
ul
 
şass
="breadcrumb">

7 <
li
>

8 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

9 <
a
 
h»f
="<?phpƒcho base_url();?>index.php/www">é¦–é¡µ</a>

10 </
li
>

11 <
li
 
şass
="aùive"><
a
 
h»f
="<?ph°echØba£_u¾();?>šdex.php/www/objeùs/li¡s?obj_ty³=<?ph°echØ$obj_ty³;?>"><?
php
 
echo
 
$diù
; ?></
	ga
></
	gli
>

12 <
	gli
><?
php
 
echo
 
	g$Ëad_d©a
[
$OBJ_NAME
.'.Subject'];?></li>

13 </
	gul
><!-- /.
	gb»adüumb
 -->

14 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

15 </
div
>

17 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

18 <
div
 
şass
="page-content">

19 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

20 <
div
 
şass
="page-header">

21 <
h1
>

22 <?
php
 
echo
 
$Ëad_d©a
[
$OBJ_NAME
.'.Subject'];?>

24 </
	gh1
>

25 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

27 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

28 <
div
 
	gşass
="row">

29 <
div
 
şass
="col-xs-12">

30 <
div
 
şass
="col-xs-12">

31 <!-- <
div
 
şass
="btn-group">

32 <
a
 
şass
="bŠ bŠ-´im¬y" 
d©a
-
toggË
="dropdown">

34 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

36 <
¥ª
 
şass
="ace-icon fa fa-angle-down icon-only smaller-90"></span>

37 </
a
>

38 </
div
>

39 <?
php
 
¬¿y_shiá
(
$but_¬¿y
);

40 
fÜ—ch
(
$but_¬¿y
 
as
 
$k
=>
$v
){

41 ifĞ
$obj_ty³
 != 1 && $obj_type != 3){

42 if(
$k
 == 6 ||$k == 7 ){

47 <
div
 
	gşass
="btn-group">

48 <
a
 
şass
="<?ph°echØ$v['cŞour'];?>" <?
php
 if(
is£t
(
$v
['id'])è{
echo
 "id=".$v['id'];}?> <?ph°if(is£t($v['u¾'])è{
	gecho
 "h»f=".
	g$v
['url'];}?> <?php if(isset($v['dropdown'])){echo 'data-toggle="dropdown"';}?>>

49 <
i
 
	gşass
="ace-icon <?phpƒcho $v['icon'];?>‡lign-top bigger-125"></i>

50 <?
php
 
echo
 
$v
['name'];?>

51 <?
php
 if(
is£t
(
$v
['dropdown'])){?>

52 <
¥ª
 
	gşass
="ace-icon fa fa-angle-down icon-only smaller-90"></span>

53 <?
php
 }?>

54 </
	ga
>

55 <?
php
 if(
is£t
(
$v
['dropdown'])){?>

56 <
ul
 
	gşass
="dropdown-menu dropdown-warning">

57 <?
php
 
fÜ—ch
(
$v
['drİdown'] 
as
 
$dk
=>
$dv
){?>

58 <
li
>

59 <
a
 <?
php
 if(
is£t
(
$dv
['u¾'])è{
echo
 "h»f=".$dv['u¾'];}?> <?ph°if(is£t($dv['id'])è{
	gecho
 "id=".
	g$dv
['id'];}?>>

60 <?
php
 
echo
 
	g$dv
["name"];?>

61 </
	ga
>

62 <?
php
 if(
is£t
(
$dv
['javascript'])){?>

63 <
süt
 
	gty³
="text/javascript">

64 <?
php
 
echo
 
$dv
['javascript'];?>

65 </
	gsüt
>

66 <?
	gphp
 }?>

67 </
	gli
>

68 <?
	gphp
 }?>

69 </
	gul
>

70 <?
	gphp
 }?>

71 </
	gdiv
>

72 <?
php
 if(
is£t
(
$v
['javascript'])){?>

73 <
süt
 
	gty³
="text/javascript">

74 <?
php
 
echo
 
$v
['javascript'];?>

75 </
	gsüt
>

76 <?
	gphp
 }?>

77 <?
	gphp
 }?>

78 <?
php
 if(
	$couÁ
(
$´iv©e_but
[
$OBJ_NAME
])){ ?>

79 <?
php
 
	`fÜ—ch
(
$´iv©e_but
[
$OBJ_NAME
] 
as
 
$k
=>
$v
){?>

80 <
div
 
şass
="btn-group">

81 <
a
 
şass
="<?ph°echØ$v['cŞour'];?>" <?
php
 if(
	`is£t
(
$v
['id'])è{
echo
 "id=".$v['id'];}?> <?php if(isset($v['url'])) {echo "href=".$v['url'];}?> <?php if(isset($v['dropdown'])){echo 'data-toggle="dropdown"';}?>>

82 <
i
 
şass
="ace-icon <?phpƒcho $v['icon'];?>‡lign-top bigger-125"></i>

83 <?
php
 
echo
 
$v
['name'];?>

84 <?
php
 if(
	`is£t
(
$v
['dropdown'])){?>

85 <
¥ª
 
şass
="ace-icon fa fa-angle-down icon-only smaller-90"></span>

86 <?
php
 }?>

87 </
a
>

88 <?
php
 if(
	`is£t
(
$v
['dropdown'])){?>

89 <
ul
 
şass
="dropdown-menu dropdown-warning">

90 <?
php
 
	`fÜ—ch
(
$v
['drİdown'] 
as
 
$dk
=>
$dv
){?>

91 <
li
>

92 <
a
 <?
php
 if(
	`is£t
(
$dv
['u¾'])è{
echo
 "href=".$dv['url'];}?> <?php if(isset($dv['id'])) {echo "id=".$dv['id'];}?>>

93 <?
php
 
echo
 
$dv
["name"];?>

94 </
a
>

95 <?
php
 if(
	`is£t
(
$dv
['javascript'])){?>

96 <
süt
 
ty³
="text/javascript">

97 <?
php
 
echo
 
$dv
['javascript'];?>

98 </
süt
>

99 <?
php
 }?>

100 </
li
>

101 <?
php
 }?>

102 </
ul
>

103 <?
php
 }?>

104 </
div
>

105 <?
php
 if(
	`is£t
(
$v
['javascript'])){?>

106 <
süt
 
ty³
="text/javascript">

107 <?
php
 
echo
 
$v
['javascript'];?>

108 </
süt
>

109 <?
php
 }?>

110 <?
php
 }?>

111 <?
php
 
	}
}?>

114 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

115 </
div
>

116 <
div
 
şass
="hr hr-dotted hr-16"></div>

117 </
div
>-->

119 <
div
 
id
="V›wFÜm©" 
şass
="cŞ-xs-12"></div><!-- /.
cŞ
 -->

120 <
süt
 
ty³
="text/javascript">

122 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

123 
	`$
("#şues_što").
	`AjaxDŸlog
({

124 
DŸlogU¾
: "<?phpƒcho base_url(); ?>index.php/www/lead/leadConversion",

125 
DŸlogT™Ë
: "çº¿ç´¢è½¬åŒ–",

126 
DŸlogWidth
: 450,

127 
DŸlogHeight
: 406,

128 
DŸlogD©a
: {
id
:<?
php
 
echo
 
$this
->
šput
->
	`g‘
("id"è?>, 
obj_ty³
:<?phpƒcho $this->input->get("obj_type") ?>},

129 
DŸlogBu‰Ús
: [{

130 
‹xt
: "ç¡®å®š",

131 
CÏss
: "btn btn-primary",

132 
şick
: 
	`funùiÚ
 () {

133 
v¬
 
sub
 = 
Œue
;

134 ià(
	`$
("#šput_key_AccouÁ_OwÃr").
	`v®
().
Ëngth
 == 0) {

135 
sub
 = 
çl£
;

136 
	`®”t
("è¯·é€‰æ‹©å®¢æˆ·æ‰€æœ‰è€…");

139 ià(
	`$
("#cÚù").
	`´İ
("checked"è&& $("#šput_key_CÚù_OwÃr").
	`v®
().
Ëngth
 == 0) {

140 
sub
 = 
çl£
;

141 
	`®”t
("è¯·é€‰æ‹©è”ç³»äººæ‰€æœ‰è€…");

144 ià(
	`$
("#İpÜtun™y").
	`´İ
("checked"è&& $("#šput_key_OµÜtun™y_OwÃr").
	`v®
().
Ëngth
 == 0) {

145 
sub
 = 
çl£
;

146 
	`®”t
("è¯·é€‰æ‹©è”ç³»äººæ‰€æœ‰è€…");

149 ià(
sub
) {

152 
	`$
("#şuesIÁoD©a").
	`subm™
();

158 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
); ?>;

159 
	`$
("#V›wFÜm©").
	`FÜm©
({

160 
ty³
: "view",

161 
FÜm©D©a
: 
fÜm©_d©a


163 
	}
});

164 </
	gsüt
>

165 </
	gdiv
><!-- /.
	grow
 -->

166 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

173 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

174 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

177 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/add.php

1 <
süt
 
	gty³
="text/javascript">

2 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

3 
	`$
('[Çme=ÿnûl]').
	`şick
(
	`funùiÚ
(){

4 
loÿtiÚ
.
h»f
="<?phpƒcho base_url();?>index.php/www/objects/lists?obj_type=<?phpƒcho $obj_type;?>"

6  
çl£
;

7 
	}
});

9 </
	gsüt
>

10 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

11 <
div
 
şass
="main-content">

12 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

13 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

14 <
ul
 
şass
="breadcrumb">

15 <
li
>

16 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

17 <
a
 
h»f
="<?phpƒcho base_url();?>index.php/www">é¦–é¡µ</a>

18 </
li
>

19 <
li
 
şass
="aùive"><
a
 
h»f
="<?ph°echØba£_u¾();?>šdex.php/www/objeùs/li¡s?obj_ty³=<?ph°echØ$obj_ty³;?>>"><?
php
 
echo
 
$diù
;?>åˆ—è¡¨</
	ga
></
	gli
>

20 <
	gli
>æ–°å¢<?
php
 
echo
 
	g$diù
;?></li>

21 </
	gul
><!-- /.
	gb»adüumb
 -->

22 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

23 </
div
>

25 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

26 <
div
 
şass
="page-content">

27 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

28 <
div
 
şass
="page-header">

29 <
h1
>

30 æ–°å¢<?
php
 
echo
 
$diù
;?>

31 <
	gsm®l
>

32 <?
php
 
echo
 
	g$moduË
;?> 
	gAdd


33 </
	gsm®l
>

34 </
	gh1
>

35 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

37 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

38 <
div
 
	gşass
="row">

39 <
fÜm
 
id
="FÜm" 
Úsubm™
="return false">

40 <
šput
 
ty³
="hidd’" 
Çme
="<?ph°echØ$´im¬y['key'];?>" 
v®ue
="<?phpƒcho $primary['value'];?>"/>

41 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_mod–" 
v®ue
="<?phpƒcho $module;?>"/>

42 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_aùiÚ" 
v®ue
="module_add"/>

43 <
div
 
şass
="col-xs-12">

44 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

45 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

47 </
bu‰Ú
>

48 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

49 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

51 </
bu‰Ú
>

52 <
div
 
şass
="hr hr-dotted hr-16"></div>

53 </
div
>

55 <
div
 
şass
="cŞ-xs-12" 
id
="EditFormat"></div>

56 <
div
 
şass
="hr hr-dotted hr-16"></div>

57 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

58 <
div
 
şass
="col-xs-12">

59 <
div
 
şass
="hr hr-dotted hr-16"></div>

60 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

61 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

63 </
bu‰Ú
>

65 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

66 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

68 </
bu‰Ú
>

70 </
div
>

71 </
fÜm
>

72 <
süt
 
ty³
="text/javascript">

74 
$
(
docum’t
).
»ady
(
	$funùiÚ
() {

75 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
);?>;

76 
	`$
("#Ed™FÜm©").
	`FÜm©
({

77 
ty³
: "edit",

78 
FÜm©D©a
: 
fÜm©_d©a
,

79 
FromID
:"Form",

80 
S–eùChdEnumsU¾
:'<?phpƒcho base_url();?>index.php/admin/enum/SelectChildEnums'

83 
v¬
 
d_obj_Çme
 = "<?phpƒcho $dtl_obj_name?>";

85 if(
d_obj_Çme
.
Ëngth
 != 0){

86 
	`$
("#d‘a").
	`L“TabË
({

87 
CŞ
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞl
);?>,

88 
IsEd™
:
Œue


94 
	}
});

95 </
	gsüt
>

96 </
	gdiv
><!-- /.
	grow
 -->

97 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

98 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

99 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

100 <
süt
 
	gty³
="text/javascript">

102 
$
("#FÜm").
v®id©e
({

103 
subm™HªdËr
: 
funùiÚ
() {

104 
v¬
 
d©a
 = 
$
("#FÜm").
£rŸlizeA¼ay
();

105 
v¬
 
ld©a
 = <?
php
 
echo
 
jsÚ_’code
(
$Ëad_d©a
);?>;

106 
v¬
 
moduË
 = "<?phpƒcho $module;?>";

107 
$
.
ajax
({

109 'd©a':{'d©a':
d©a
,

110 'ld©a':
ld©a


112 'sucûss':
funùiÚ
(
d©a
){

114 
d©a
 = 
ev®
("("+data+")");

116 if(
d©a
.
»s
=='suc'){

117 
®”t
(
d©a
.
msg
);

118 if(
moduË
!='User'){

119 
loÿtiÚ
.
h»f
="<?phpƒcho base_url();?>index.php/www/objects/lists?obj_type=<?phpƒcho $obj_type;?>";

121 
loÿtiÚ
.
h»f
="<?phpƒcho base_url();?>index.php/www";

126 
®”t
(
d©a
.
msg
);

131 'ÿche':
çl£


138 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/ajax_add.php

1 <?
php
 
	g$¿ndom
 =
¿nd
(100,999);?>

2 <
süt
 
	gty³
="text/javascript">

3 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

4 
	`$
('[Çme=ÿnûl]').
	`şick
(
	`funùiÚ
(){

5 
	`$
('#'+
$DŸlogDivIDM
).
	`dŸlog
("close");

7  
çl£
;

8 
	}
});

10 </
	gsüt
>

11 <
div
 
	gşass
="page-content">

12 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

13 <
div
 
şass
="page-header">

14 <
h1
>

15 æ–°å¢<?
php
 
echo
 
$diù
;?>

16 <
	gsm®l
>

17 <?
php
 
echo
 
	g$moduË
;?> 
	gAdd


18 </
	gsm®l
>

19 </
	gh1
>

20 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

22 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

23 <
div
 
	gşass
="row">

24 <
fÜm
 
id
="FÜm" 
Úsubm™
="return false">

25 <
šput
 
ty³
="hidd’" 
Çme
="<?ph°echØ$´im¬y['key'];?>" 
v®ue
="<?phpƒcho $primary['value'];?>"/>

26 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_mod–" 
v®ue
="<?phpƒcho $module;?>"/>

27 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_aùiÚ" 
v®ue
="module_add"/>

28 <
šput
 
ty³
="hidd’" 
Çme
 = "sobj_Çme" 
v®ue
 = <?
php
 
echo
 
$sobj_Çme
;?>>

29 <
šput
 
	gty³
="hidd’" 
Çme
 = "sobj_id" 
v®ue
 = <?
php
 
echo
 
$sobj_id
;?>>

30 <
div
 
	gşass
="col-xs-12">

31 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

32 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

34 </
bu‰Ú
>

35 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

36 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

38 </
bu‰Ú
>

39 <
div
 
şass
="hr hr-dotted hr-16"></div>

40 </
div
>

42 <
div
 
şass
="cŞ-xs-12" 
id
="Ajax_add_<?phpƒcho $random?>"></div>

43 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

44 <
div
 
şass
="col-xs-12">

45 <
div
 
şass
="hr hr-dotted hr-16"></div>

46 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

47 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

49 </
bu‰Ú
>

51 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

52 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

54 </
bu‰Ú
>

56 </
div
>

57 </
fÜm
>

58 <
süt
 
ty³
="text/javascript">

60 
$
(
docum’t
).
»ady
(
	$funùiÚ
() {

61 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
);?>;

62 
	`$
("#Ajax_add_<?ph°echØ$¿ndom?>").
	`FÜm©
({

63 
ty³
: "edit",

64 
FÜm©D©a
: 
fÜm©_d©a
,

65 
FromID
:"Form",

66 
S–eùChdEnumsU¾
:'<?phpƒcho base_url();?>index.php/admin/enum/SelectChildEnums'

69 
	}
});

70 </
	gsüt
>

71 </
	gdiv
><!-- /.
	grow
 -->

72 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

74 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

75 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

76 <
süt
 
	gty³
="text/javascript">

77 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

78 
	`$
('[Çme=§ve]').
	`şick
(
	`funùiÚ
(){

79 
v¬
 
d©a
 = 
	`$
("#FÜm").
	`£rŸlizeA¼ay
();

80 
v¬
 
ld©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$Ëad_d©a
)?>;

82 
$
.
	`ajax
({

84 'd©a':{'d©a':
d©a
,'ld©a':
ld©a
},

85 'sucûss':
	`funùiÚ
(
d©a
){

86 
d©a
 = 
	`ev®
("("+data+")");

88 if(
d©a
.
»s
=='suc'){

89 
	`®”t
(
d©a
.
msg
);

90 
	`$
('#'+
$DŸlogDivIDM
).
	`dŸlog
("close");

91 
wšdow
.
loÿtiÚ
.
	`»¶aû
ÖoÿtiÚ.
h»f
);

93 
	`®”t
(
d©a
.
msg
);

98 'ÿche':
çl£


102  
çl£
;

104 
	}
});

106 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/ajax_list.php

1 <
div
 
	gşass
="<?phpƒcho $DialogID; ?>_ajax_page_content">

3 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

4 <
div
 
şass
="row">

6 <
div
 
şass
="col-xs-12">

7 <
bu‰Ú
 
id
='<?ph°echØ$DŸlogID; ?>_sub' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
süt
 
ty³
="text/javascript">

13 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

14 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

16 
	`$
("#<?ph°echØ$DŸlogID; ?>_sub").
	`S’iÜQu”y
({

17 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

18 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

19 
Li¡Div
: "#<?phpƒcho $DialogID; ?>_page_content"

22 
	}
});

24 </
	gsüt
>

25 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

26 </
div
>

28 <
div
 
şass
="cŞ-xs-12" 
id
="<?phpƒcho $DialogID; ?>_page_content">

29 </
div
><!-- /.
cŞ
 -->

30 </
div
><!-- /.
row
 -->

31 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

32 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

33 <
süt
 
ty³
="text/javascript">

34 
jQu”y
(
	$funùiÚ
 (
$
) {

35 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>";

36 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

37 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

38 
v¬
 
Çm—‰ºame
 = '<?ph°echØ$obj_d©a['
NAME_ATTR_NAME
']?>';

39 
v¬
 
po¡D©a
 = 
nuÎ
;

40 
v¬
 
obj_ty³
 = '<?phpƒcho $ObjType;?>';

41 
v¬
 
robj_ty³
 = '<?phpƒcho $rObjType;?>';

42 if(
obj_ty³
 == '300'){

43 
po¡D©a
 = {
£niÜqu”y
:{
wh”e
:{1:{
©Œ
:'Ty³.ObjeùTy³',
aùiÚ
:'EQUAL',
v®ue
:
robj_ty³
}},
»l
:'1'}};

45 
	`$
("#<?ph°echØ$DŸlogID; ?>_·ge_cÚ‹Á").
	`L“TabË
({

46 
U¾
:
u¾
,

47 
CŞ
:
cŞ
,

48 
MuÉiS–eù
:
Œue
,

49 
MuÉiTy³
:1,

50 
KeyA‰rName
:
key©ŒÇme
,

51 
NameA‰rName
:
Çm—‰ºame
,

52 
po¡D©a
:postData

54 
	}
});

56 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/ajax_view_list.php

1 <
div
 
	gid
="<?phpƒcho $DialogID;?>_ajax_page_content">

2 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

3 <
süt
 
ty³
="text/javascript">

4 
jQu”y
(
	$funùiÚ
 (
$
) {

5 
v¬
 
·¿ms
 = {
d©a_jsÚ
:'<?ph°echØjsÚ_’code($d©a_jsÚ); ?>',
cÚd™iÚ
:'<?phpƒcho $condition;?>'};

6 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_object_json?obj_type=<?phpƒcho $ObjType; ?>";

7 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

8 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

9 
v¬
 
O³¿tiÚ
 = [

10 {
T™Ë
:'åˆ é™¤',
U¾
:'javasüt:void(0);',
Js
:"dÉ('{"+
key©ŒÇme
+"}','<?ph°echØ$ObjTy³; ?>','#<?ph°echØ$DŸlogID;?>_ajax_·ge_cÚ‹Á','<?ph°echØba£_u¾(); ?>šdex.php/www/objeùs/li¡_jsÚ?obj_ty³=<?ph°echØ$ObjTy³; ?>')",
Css
:'fa fa-trash-o„ed'},

12 
	`$
("#<?ph°echØ$DŸlogID;?>_ajax_·ge_cÚ‹Á").
	`L“TabË
({

13 
TabËHeight
:100,

14 
U¾
:
u¾
,

15 
O³¿tiÚ
:Operation,

16 
CŞ
:
cŞ
,

17 
KeyA‰rName
:
key©ŒÇme
,

18 
po¡D©a
:
·¿ms
,

19 
IsNÙPage
:1

21 
	}
});

23 
funùiÚ
 
	$dÉ
(
id
, 
obj_ty³
, 
grid_£ËùÜ
, 
u¾
) {

24 ià(
	`cÚfœm
("ç¡®å®šè¦åˆ é™¤æ•°æ®å—ï¼Ÿ")) {

25 
v¬
 
d–_u¾
 = "<?ph°echØs™e_u¾("
www
/
objeùs
/
d–
?
maš_ty³
=".$obj_ty³."&
mid
=".$id); ?>";

26 
$
.
	`ajax
({

27 
ty³
: "GET",

28 
u¾
: 
d–_u¾
,

29 
d©a
: {
id
: id, 
obj_ty³
: obj_type},

30 
sucûss
: 
	`funùiÚ
 (
d©a
) {

31 ià(
d©a
 == "success") {

32 
	`®”t
("åˆ é™¤æ•°æ®æˆåŠŸ");

33 
	`jQu”y
(
grid_£ËùÜ
).
	`L“TabË
('SetGridParam');

35 
	`®”t
(
d©a
);

40 
	}
}

41 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/assign_staff.php

1 <
süt
 
	gty³
="text/javascript">

2 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

3 
	`$
("#"+"<?ph°echØ$_GET['bu‰Ú']?>_sub").
	`AjaxDŸlog
({

4 
DŸlogU¾
: "<?ph°echØba£_u¾()?>šdex.php/www/objeùs/di¡ributiÚ?em¶oy“s=<?ph°echØ$_GET["
em¶oy“s
"]?>&sel=<?phpƒcho $ObjType; ?>"+"&obj_type=99&div_id=<?phpƒcho $div_id?>",

5 
DŸlogT™Ë
: "æ‰¹é‡åˆ†é…å‘˜å·¥",

6 
DŸlogWidth
: 800,

7 
DŸlogHeight
: 500});

9 
	`$
("#qx").
	`şick
(
	`funùiÚ
(){

10 
	`$
("#em¶oy“s").
	`·»Á
().
	`dŸlog
('close');

13 
	}
});

14 </
	gsüt
>

15 <
div
 
	g¡yË
="width:100px;m¬gš-Ëá:‡uto;m¬gš-right:‡uto;m¬gš-tİ: 30px" 
id
="employees">

16 <
div
>

17 <
div
><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="1">æ›´æ–°é€‰ä¸­è®°å½•</div>

18 <
div
 
¡yË
="m¬gš-tİ: 15px"><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="2">æ›´æ–°å½“å‰åˆ—è¡¨</div>

20 </
div
>

21 <
div
 
¡yË
="margin-top: 40px">

22 <
šput
 
v®ue
="ç¡®å®š" 
ty³
="bu‰Ú" 
id
="<?phpƒcho $_GET['button']?>_sub">

23 <
šput
 
v®ue
="å–æ¶ˆ" 
ty³
="bu‰Ú" 
id
="qx">

24 </
div
>

25 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/batch_up.php

1 <
	g¡yË
>

2 .
	gup_div
{

3 
	gwidth
:400
px
;
	gm¬gš
-
	gËá
:‡uto;m¬gš-
	gright
:‡uto;

8 .
up_div
 
div
 
	gdiv
 {

9 
	gm¬gš
-
	gtİ
: 10
px
;

10 
	gm¬gš
-
	gËá
: 50
px
;

12 .
	gsub
 {

13 
	gm¬gš
-
	gtİ
: 10
px
;

15 .
sub
 
div
 
	gšput
 {

16 
	gm¬gš
-
	gËá
: 80
px
;

18 .
	gšput
-
	ggroup
{

19 
	gwidth
: 150
px
;

22 </
	g¡yË
>

23 <
süt
 
	gty³
="text/javascript">

24 
$
.
ajax
({

25 
u¾
 : "<?ph°echØba£_u¾()?>šdex.php/www/objeùs/b©ch_up_©Œ?obj_ty³="+<?
php
 
echo
 
$ObjTy³
?>,

26 
d©aTy³
:"json",

27 
sucûss
:
funùiÚ
(
d©a
){

28 
v¬
 
html
 = '<option value=""></option>'

29 
$
.
—ch
(
d©a
,
funùiÚ
(
idx
,
™em
){

30 
html
 +ğ'<İtiÚ v®ue="'+
™em
.
ATTR_NAME
+'">'+™em.
LABEL
+'</option>'

32 
$
("#up_£l").
html
(html)

35 
$
(
	$funùiÚ
(){

37 
$
.
	`ajax
({

38 
u¾
:"<?ph°echØba£_u¾()?>šdex.php/www/objeùs/£Ëù_d©a?obj_ty³="+<?
php
 
echo
 
$ObjTy³
?>,

39 
sucûss
:
	`funùiÚ
(
d©as
){

40 
	`$
("#jsÚ").
	`v®
(
d©as
)

44 
	`$
("#up_£l").
	`chªge
(
	`funùiÚ
(){

45 
v¬
 
v®ue
 = 
	`$
(
this
).
	`v®
();

46 
v¬
 
obj
 = 
	`ev®
('(' + 
	`$
("#jsÚ").
	`v®
() + ')');

47 
$
.
	`—ch
(
obj
,
	`funùiÚ
(
idx
,
™em
){

48 ià(
™em
.
Çme
 =ğ
v®ue
) {

50 if(
™em
.
©Œ_ty³
 == 13){

51 
v¬
 
html
 = '<select style="width:200px;"‚ame="up_sel_value"><option value=""></option>'

52 
$
.
	`—ch
(
™em
.
fÜm_d©a
.
’um_¬r
,
	`funùiÚ
(
idx
,item){

53 
html
 +ğ'<İtiÚ v®ue="'+
™em
.
’um_key
+'">'+™em.
’um_v®ue
+'</option>'

55 
html
 += "</select>"

56 
	`$
("#upd©e").
	`html
(
html
);

57 }if(
™em
.
©Œ_ty³
 == 18){

58 
v¬
 
id
 = 
™em
.
Çme
.
	`»¶aû
('.', "_")

59 
v¬
 
html
 = '<div cÏss="šput-group"><špuˆÇme="up_£l_v®ue" styË="width:150px;" id="'+
id
+'"></div>';

60 
	`$
("#upd©e").
	`html
(
html
);

61 
	`ajax_aá”
(
id
,
™em
.
Çme
,™em.
fÜm_d©a
.
ObjName
,™em.fÜm_d©a.
RefU¾
)

62 }if(
™em
.
©Œ_ty³
 == 11){

63 
	`$
("#upd©e").
	`html
('<inputype="checkbox" style="width:200px;" class="myCheck"><inputype="hidden"‚ame="up_sel_value" value="0">')

64 
	`ajax_check
()

66 
	`$
("#upd©e").
	`html
('<input‚ame="up_sel_value" style="width:200px;">')

73 
	`$
("#qx").
	`şick
(
	`funùiÚ
(){

74 
	`$
(".up_div").
	`·»Á
().
	`dŸlog
('close');

76 
	`$
("#subm™").
	`şick
(
	`funùiÚ
(){

78 
v¬
 
d©a
 = "";

79 
v¬
 
¿dio
 = 
	`$
('šput:¿dio[Çme=upd©e]:checked').
	`v®
();

81 if(
¿dio
 == "2") {

82 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

83 ià(
d©a
 == "") {

84 
d©a
 = 
	`$
(
this
).
	`v®
();

86 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

89 }ià(
¿dio
 == "1"){

90 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

91 ià(
d©a
 == "") {

92 
d©a
 = 
	`$
(
this
).
	`v®
();

94 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

99 
d©a
 = d©a.
	`»¶aû
(/
Ú
,/, "");

101 if(
¿dio
 =ğ
undefšed
 || 
d©a
.
Ëngth
 == 0 ){

102 
	`®”t
("è¯·é€‰æ‹©æ›´æ–°æ•°æ®")

105 
cÚsŞe
.
	`log
(
d©a
);

106 
cÚsŞe
.
	`log
(
	`$
("#cÚ‹Á").
	`£rŸlize
())

107 
$
.
	`ajax
({

108 
u¾
:"<?ph°echØba£_u¾()?>šdex.php/www/objeùs/b©ch_d©a?id="+
d©a
+"&obj_ty³="+<?
php
 
echo
 
$ObjTy³
?>,

109 
ty³
:"post",

110 
d©a
:
	`$
("#cÚ‹Á").
	`£rŸlize
(),

111 
sucûss
:
	`funùiÚ
(
d©a
){

112 if(
d©a
 =="success"){

113 
	`®”t
("ä¿®æ”¹æˆåŠŸ")

114 
	`$
(".up_div").
	`·»Á
().
	`dŸlog
('close');

115 
	`jQu”y
("#<?ph°echØ$div_id?>").
	`L“TabË
('SetGridParam');

117 
	`®”t
(
d©a
)

128 
	}
})

129 
funùiÚ
 
	$ajax_check
(){

130 
	`$
(".myCheck").
	`şick
(
	`funùiÚ
(){

131 ifĞ
	`$
(
this
).
	`´İ
("checked") ) {

132 
	`$
(
this
).
	`Ãxt
().
	`v®
("1")

134 
	`$
(
this
).
	`Ãxt
().
	`v®
("0")

137 
	}
}

138 
funùiÚ
 
	$ajax_aá”
(
id
,
Çme
,
Ïb–
,
u¾
){

139 
	`$
("#"+
id
).
	`QuÙeIn™Ÿl
({

140 
u¾
:url,

141 
t™Ë
:
Ïb–
,

142 
Çme
:name

146 
	}
}

148 </
	gsüt
>

149 <
div
 
	gşass
="up_div">

150 <
fÜm
 
id
="content">

151 <
div
 
şass
="content">

152 <
div
><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="1">æ›´æ–°é€‰ä¸­è®°å½•</div>

153 <
div
><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="2">æ›´æ–°å½“å‰åˆ—è¡¨</div>

154 <
div
>ã€€æ›´æ–°&
nb¥
;&
	gnb¥
;<
£Ëù
 
	g¡yË
="width:200px;" 
id
="up_£l" 
Çme
="up_sel_attr"></select>

155 </
div
>

156 <
div
><
¥ª
 
¡yË
="æßt:†eá;">ä¿®æ”¹ä¸º&
nb¥
;&
	gnb¥
;</
	g¥ª
><¥ª 
	gid
="upd©e"><
£Ëù
 styË="width:200px;" 
Çme
="up_sel_value"></select></span>

157 </
div
>

158 <
div
><
šput
 
ty³
="checkbox" 
Çme
="background">åå°å¤„ç†</div>

159 <
div
 
¡yË
="height: 50px"></div>

160 </
div
>

161 </
fÜm
>

162 <
div
 
şass
="sub">

163 <
div
><
šput
 
ty³
="bu‰Ú" 
v®ue
="æäº¤" 
id
="submit" id=""><inputype="button" value="å–æ¶ˆ" id="qx"></div>

164 </
div
>

165 </
div
>

166 <
šput
 
ty³
="hidd’" 
id
="json">

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/button.php

1 <
a
 
	gh»f
="<?phpƒcho base_url(); ?>index.php/www/objects/add?obj_type=<?phpƒcho $ObjType; ?>&type_id=91">

2 <
bu‰Ú
 
şass
="btn">

3 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

5 </
bu‰Ú
>

6 </
a
>

7 <
bu‰Ú
 
id
='Ëad_§Ë_£niÜqu”y' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
süt
 
ty³
="text/javascript">

13 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

14 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

15 
	`$
("#Ëad_§Ë_£niÜqu”y").
	`S’iÜQu”y
({

16 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

17 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

18 
Li¡Div
: "<?phpƒcho $ListDiv; ?>"

21 
	}
});

22 </
	gsüt
>

23 <
bu‰Ú
 
	gşass
="bŠ bŠ-šfo" 
id
="import">

24 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

26 </
bu‰Ú
>

27 <
süt
 
ty³
="text/javascript">

29 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

31 
	`$
("#impÜt").
	`AjaxDŸlog
({

32 
DŸlogU¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/import?obj_type=<?phpƒcho $ObjType; ?>",

33 
DŸlogT™Ë
: "æ‰¹é‡å¯¼å…¥",

34 
DŸlogWidth
: 700,

35 
DŸlogHeight
: 400

37 
	`$
("#b©ch_up").
	`AjaxDŸlog
({

38 
DŸlogU¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/batchUp",

39 
DŸlogT™Ë
: "æ‰¹é‡æ›´æ–°",

40 
DŸlogWidth
: 500,

41 
DŸlogHeight
: 400

45 
	}
});

46 </
	gsüt
>

47 <
bu‰Ú
 
	gşass
="bŠ bŠ-sucûss" 
id
="export">

49 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

51 </
bu‰Ú
>

53 <
süt
 
ty³
="text/javascript">

56 
$
("#expÜt").
şick
(
	$funùiÚ
 () {

57 
v¬
 
d©a
 = "";

58 
$DŸlogDivID
 = "DŸlogDiv" + 
	`$
(
this
).
	`©Œ
("id")

59 
	`$
("šput[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

60 ià(
d©a
 == "") {

61 
d©a
 = 
	`$
(
this
).
	`v®
();

63 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

68 ià(
	`$
('#' + 
$DŸlogDivID
).
Ëngth
 == 0) {

69 
	`$
(
this
).
	`aá”
('<div id="' + 
$DŸlogDivID
 + '" style="display:none;"></div>');

71 
$
.
	`ajax
({

73 'd©a': {"d©a": 
d©a
},

74 'sucûss': 
	`funùiÚ
 (
d©a
) {

75 
	`$
('#' + 
$DŸlogDivID
).
	`html
(
d©a
);

78 'ÿche': 
çl£


80 
	`$
("#" + 
$DŸlogDivID
).
	`dŸlog
({

81 
t™Ë
: "æ‰¹é‡å¯¼å‡º",

82 
mod®
: 
Œue
,

83 
width
: 400,

84 
height
: 220,

85 
bu‰Ús
: [

87 
‹xt
: "æŸ¥è¯¢",

88 
CÏss
: "btn bottom-margin btn-primary",

89 
şick
: 
	`funùiÚ
 () {

91 
	`$
(
this
).
	`dŸlog
("close");

95 
‹xt
: "å–æ¶ˆ",

96 
CÏss
: "btn bottom-margin btn-danger ",

97 
şick
: 
	`funùiÚ
 () {

98 
	`$
(
this
).
	`dŸlog
("close");

103 
	`$
('#' + 
$DŸlogDivID
).
	`dŸlog
('open');

116 
	}
});

119 </
	gsüt
>

122 <
bu‰Ú
 
	gşass
="bŠ bŠ-w¬nšg" 
id
="batch_up">

123 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

125 </
bu‰Ú
>

126 <!-- <
bu‰Ú
 
şass
="btn btn-danger">-->

127 <!-- <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>-->

129 <!-- </
bu‰Ú
>-->

130 <!--<
bu‰Ú
 
şass
="btn btn-inverse">-->

131 <!-- <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>-->

133 <!--</
bu‰Ú
>-->

134 <
bu‰Ú
 
şass
="btn btn-pink">

135 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

137 </
bu‰Ú
>

138 <
div
 
şass
="hr hr-dotted hr-16"></div>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/detail.php

1 <
div
 
	gşass
="row">

2 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

3 </
div
>

5 <
süt
 
ty³
="text/javascript">

6 
jQu”y
(
	$funùiÚ
 () {

7 
	`$
("#d‘a").
	`L“TabË
({

19 
CŞ
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞ
);?>,

23 
IsEd™
:
Œue


25 
	}
})

26 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/detail_check.php

1 <
div
 
	gşass
="<?phpƒcho $DialogID; ?>_ajax_page_content">

3 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

4 <
div
 
şass
="row">

6 <
div
 
şass
="col-xs-12">

7 <
bu‰Ú
 
id
='<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
bu‰Ú
 
id
='G‘S–eùedA‰r' 
şass
="btn btn-primary">

12 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

14 </
bu‰Ú
>

15 <
a
 
id
="GetSelectedAttr"> </a>

16 <
süt
 
ty³
="text/javascript">

18 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

19 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

20 
	`$
("#<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y").
	`S’iÜQu”y
({

21 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

22 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

23 
Li¡Div
: "#<?phpƒcho $DialogID; ?>_grid_table"

26 
	}
});

28 </
	gsüt
>

29 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

30 </
div
>

32 <
div
 
şass
="cŞ-xs-12" 
id
="<?phpƒcho $DialogID; ?>_page_content">

33 </
div
><!-- /.
cŞ
 -->

34 </
div
><!-- /.
row
 -->

35 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

37 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

38 <
süt
 
ty³
="text/javascript">

39 
funùiÚ
 
	$aá”
(
id
, 
Çme
, 
Ïb–
, 
u¾
) {

40 
	`$
("#" + 
id
).
	`QuÙeIn™Ÿl
({

41 
u¾
: url,

42 
t™Ë
: 
Ïb–
,

43 
Çme
:‚ame

45 
	}
}

46 
jQu”y
(
	$funùiÚ
 (
$
) {

47 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>";

48 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

49 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

50 
	`$
("#<?ph°echØ$DŸlogID; ?>_·ge_cÚ‹Á").
	`L“TabË
({

51 
U¾
:
u¾
,

52 
CŞ
:
cŞ
,

53 
MuÉiS–eù
:
Œue
,

54 
MuÉiTy³
:0,

55 
KeyA‰rName
:
key©ŒÇme


57 
v¬
 
myd©a
 = 
$
.
	`·r£JSON
Ğ
	`$
("#¡r").
	`v®
() )

58 
v¬
 
İ”©iÚ
 = 
$
.
	`·r£JSON
Ğ
	`$
("#İ”©iÚ").
	`v®
() )

59 
v¬
 
i
 = "<?phpƒcho $index ?>";

60 
	`$
('#G‘S–eùedA‰r').
	`şick
(
	`funùiÚ
(){

61 
v¬
 
©Œ
 = 
	`$
("#<?ph°echØ$objName[0]['LABEL'] ?>_·ge-cÚ‹Á").
	`L“TabË
('GetSelectedAttr');

62 
v¬
 
´oduù
;

63 
v¬
 
¡ªd¬dPriû
;

64 
v¬
 
id
 ;

65 
$
.
	`—ch
(
©Œ
,
	`funùiÚ
(
k
,
v
){

66 
i
++;

67 
´oduù
 = 
v
["Product.Name"]

68 
¡ªd¬dPriû
 = 
v
["Product.StandardPrice"]

69 
id
 = 
v
[" Product.ID"]

70 
	`jQu”y
("#li¡4").
	`jqGrid
('addRowD©a', 
i
, 
myd©a
);

71 
v¬
 
šputs
 = 
	`$
("#" + 
i
).
	`chd»n
().
	`fšd
("input");

72 
šputs
.
	`—ch
(
	`funùiÚ
 () {

73 
v¬
 
šdex
 = 
	`$
(
this
).
	`©Œ
("class");

74 ià(
šdex
.
	`šdexOf
(18) != -1) {

75 
v¬
 
idd
 = 
	`$
(
this
).
	`©Œ
("id"è+ 
i


76 
	`$
(
this
).
	`©Œ
("id", 
idd
)

77 
v¬
 
u¾
 = 
	`$
(
this
).
	`©Œ
("u")

78 
v¬
 
Ïb–
 = 
	`$
(
this
).
	`©Œ
("l")

79 
v¬
 
Çme
 = 
	`$
(
this
).
	`©Œ
("name")

80 
	`aá”
(
idd
, 
Çme
, 
Ïb–
, 
u¾
)

82 
cÚsŞe
.
	`log
(
k
)

83 
cÚsŞe
.
	`log
(
	`$
(
this
).
	`Ãxt
())

85 
	`$
(
this
).
	`Ãxt
().
	`v®
(
k
)

86 
cÚsŞe
.
	`log
(
	`$
(
this
).
	`Ãxt
())

89 ià(
šdex
.
	`šdexOf
(
İ”©iÚ
["results"]) != -1) {

90 
	`$
(
this
).
	`©Œ
("readonly", "readonly")

92 ià(
šdex
.
	`šdexOf
(
İ”©iÚ
["first"]) != -1) {

93 
v¬
 
Ï¡_obj
;

94 
v¬
 
»suÉs_obj
;

95 
šputs
.
	`—ch
(
	`funùiÚ
 () {

96 
v¬
 
šdex2
 = 
	`$
(
this
).
	`©Œ
("class");

97 ià(
šdex2
.
	`šdexOf
(
İ”©iÚ
["last"]) != -1) {

98 
Ï¡_obj
 = 
this
;

99 
	`$
(
this
).
	`v®
(0)

101 ià(
šdex2
.
	`šdexOf
(
İ”©iÚ
["results"]) != -1) {

102 
»suÉs_obj
 = 
this
;

105 
	`$
(
this
).
	`blur
(
	`funùiÚ
 () {

106 
v¬
 
fœ¡
 = 
	`·r£Flßt
(
	`$
(
this
).
	`v®
())

107 
v¬
 
Ï¡
 = 
	`·r£Flßt
(
	`$
(
Ï¡_obj
).
	`v®
())

108 ià(
İ”©iÚ
["symbol"] == "/") {

109 ià(
Ï¡
 != 0) {

110 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
/
Ï¡
)

112 }if(
İ”©iÚ
["symbol"] == "*"){

113 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
*
Ï¡
)

114 }if(
İ”©iÚ
["symbol"] == "-"){

115 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
-
Ï¡
)

116 } if(
İ”©iÚ
["symbol"] == "+"){

117 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
+
Ï¡
)

124 ià(
šdex
.
	`šdexOf
(
İ”©iÚ
["last"]) != -1) {

125 
v¬
 
fœ¡_obj
;

126 
v¬
 
»suÉs_obj
;

127 
šputs
.
	`—ch
(
	`funùiÚ
 () {

128 
v¬
 
šdex3
 = 
	`$
(
this
).
	`©Œ
("class");

129 ià(
šdex3
.
	`šdexOf
(
İ”©iÚ
["first"]) != -1) {

130 
fœ¡_obj
 = 
this
;

131 
	`$
(
this
).
	`v®
(0)

133 ià(
šdex3
.
	`šdexOf
(
İ”©iÚ
["results"]) != -1) {

134 
»suÉs_obj
 = 
this
;

137 
	`$
(
this
).
	`blur
(
	`funùiÚ
 () {

138 
v¬
 
Ï¡
 = 
	`·r£Flßt
(
	`$
(
this
).
	`v®
());

139 
v¬
 
fœ¡
 = 
	`·r£Flßt
(
	`$
(
fœ¡_obj
).
	`v®
());

140 ià(
İ”©iÚ
["symbol"] == "/") {

141 ià(
Ï¡
 != 0) {

142 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
/
Ï¡
)

144 }if(
İ”©iÚ
["symbol"] == "*"){

145 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
*
Ï¡
)

146 }if(
İ”©iÚ
["symbol"] == "-"){

147 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
-
Ï¡
)

148 } if(
İ”©iÚ
["symbol"] == "+"){

149 
	`$
(
»suÉs_obj
).
	`v®
(
fœ¡
+
Ï¡
)

155 ià(
šdex
.
	`šdexOf
(15) != -1) {

156 
	`$
(
this
).
	`d©•ick”
();

158 
	`$
(".3").
	`ÚlyMÚey
();

159 
	`$
(".1").
	`ÚlyNum
();

161 
	`$
("#"+
i
).
	`chd»n
().
	`fšd
(".add").
	`AjaxDŸlog
({

162 
DŸlogU¾
: "<?ph°echØba£_u¾()?>šdex.php/www/objeùs/d‘a_sšgË?obj_ty³=9&id="+
i
,

163 
DŸlogT™Ë
: "ä»·æ ¼è¡¨äº§å“",

164 
DŸlogWidth
: 800,

165 
DŸlogHeight
: 500,

167 
	`$
("#"+
i
).
	`chd»n
().
	`fšd
(".d–").
	`şick
(
	`funùiÚ
(){

168 
	`$
(
this
).
	`·»Á
().·»Á().
	`»move
();

171 
šputs
.
	`—ch
(
	`funùiÚ
(){

172 
v¬
 
Çme
 = 
	`$
(
this
).
	`©Œ
("name")

173 if(
Çme
.
	`šdexOf
('Product') != -1){

174 
	`$
(
this
).
	`v®
(
´oduù
)

175 }if(
Çme
.
	`šdexOf
('StandardPrice') != -1){

176 
	`$
(
this
).
	`v®
(
¡ªd¬dPriû
)

185 
	}
});

187 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/detail_single.php

1 <
div
 
	gşass
="<?phpƒcho $DialogID; ?>_ajax_page_content">

3 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

4 <
div
 
şass
="row">

6 <
div
 
şass
="col-xs-12">

7 <
bu‰Ú
 
id
='<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
bu‰Ú
 
id
='G‘S–eùedA‰r' 
şass
="btn btn-primary">

12 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

14 </
bu‰Ú
>

15 <
a
 
id
="GetSelectedAttr"> </a>

16 <
süt
 
ty³
="text/javascript">

18 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

19 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

20 
	`$
("#<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y").
	`S’iÜQu”y
({

21 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

22 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

23 
Li¡Div
: "#<?phpƒcho $DialogID; ?>_grid_table"

26 
	}
});

28 </
	gsüt
>

29 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

30 </
div
>

32 <
div
 
şass
="cŞ-xs-12" 
id
="<?phpƒcho $DialogID; ?>_page_content">

33 </
div
><!-- /.
cŞ
 -->

34 </
div
><!-- /.
row
 -->

35 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

37 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

38 <
süt
 
ty³
="text/javascript">

39 
jQu”y
(
	$funùiÚ
 (
$
) {

40 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>";

41 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

42 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

43 
	`$
("#<?ph°echØ$DŸlogID; ?>_·ge_cÚ‹Á").
	`L“TabË
({

44 
U¾
:
u¾
,

45 
CŞ
:
cŞ
,

46 
MuÉiS–eù
:
Œue
,

47 
MuÉiTy³
:0,

48 
KeyA‰rName
:
key©ŒÇme


51 
	`$
('#G‘S–eùedA‰r').
	`şick
(
	`funùiÚ
(){

52 
v¬
 
©Œ
 = 
	`$
("#<?ph°echØ$objName[0]['LABEL'] ?>_·ge-cÚ‹Á").
	`L“TabË
('GetSelectedAttr');

53 
v¬
 
´oduù
;

54 
v¬
 
¡ªd¬dPriû
;

55 
v¬
 
id
 ;

56 
$
.
	`—ch
(
©Œ
,
	`funùiÚ
(
k
,
v
){

57 
´oduù
 = 
v
["Product.Name"]

58 
¡ªd¬dPriû
 = 
v
["Product.StandardPrice"]

59 
id
 = 
v
[" Product.ID"]

61 
v¬
 
šput
 = 
	`$
("#<?ph°echØ$id?>").
	`chd»n
().
	`fšd
("input")

62 
šput
.
	`—ch
(
	`funùiÚ
(){

63 
v¬
 
Çme
 = 
	`$
(
this
).
	`©Œ
("name")

64 if(
Çme
.
	`šdexOf
('Product.ID') != -1){

65 
	`$
(
this
).
	`v®
(
id
)

66 
	`$
(
this
).
	`´ev
().
	`v®
(
´oduù
)

67 }if(
Çme
.
	`šdexOf
('StandardPrice') != -1){

68 
	`$
(
this
).
	`v®
(
¡ªd¬dPriû
)

76 
	}
});

78 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/distribution.php

1 <
div
 
	gşass
="<?phpƒcho $DialogID; ?>_ajax_page_content">

3 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

4 <
div
 
şass
="row">

6 <
div
 
şass
="col-xs-12">

7 <
bu‰Ú
 
id
='<?ph°echØ$DŸlogID; ?>_sub' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
bu‰Ú
 
id
="sub<?ph°echØ$_GET["
em¶oy“s
"]?>" 
şass
="btn btn-primary">

12 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

14 </
bu‰Ú
>

15 <
süt
 
ty³
="text/javascript">

17 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

18 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

20 
	`$
("#<?ph°echØ$DŸlogID; ?>_sub").
	`S’iÜQu”y
({

21 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

22 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

23 
Li¡Div
: "#<?phpƒcho $DialogID; ?>_page_content"

26 
	}
});

28 </
	gsüt
>

29 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

30 </
div
>

32 <
div
 
şass
="cŞ-xs-12" 
id
="<?phpƒcho $DialogID; ?>_page_content">

33 </
div
><!-- /.
cŞ
 -->

34 </
div
><!-- /.
row
 -->

35 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

36 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

37 <
div
>

38 <
šput
 
ty³
="‹xt" 
Çme
="·ge_’d" 
id
="<?phpƒcho $DialogID; ?>page_end"/>

39 </
div
>

40 <
süt
 
ty³
="text/javascript">

41 
jQu”y
(
	$funùiÚ
 (
$
) {

42 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>";

43 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

44 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

45 
v¬
 
Çm—‰ºame
 = '<?ph°echØ$obj_d©a['
NAME_ATTR_NAME
']?>';

46 
v¬
 
po¡D©a
 = 
nuÎ
;

47 
v¬
 
obj_ty³
 = '<?phpƒcho $ObjType;?>';

48 
v¬
 
robj_ty³
 = '<?phpƒcho $rObjType;?>';

49 if(
obj_ty³
 == '300'){

50 
po¡D©a
 = {
£niÜqu”y
:{
wh”e
:{1:{
©Œ
:'Ty³.ObjeùTy³',
aùiÚ
:'EQUAL',
v®ue
:
robj_ty³
}},
»l
:'1'}};

52 
	`$
("#<?ph°echØ$DŸlogID; ?>_·ge_cÚ‹Á").
	`L“TabË
({

53 
U¾
:
u¾
,

54 
CŞ
:
cŞ
,

55 
MuÉiS–eù
:
Œue
,

56 
MuÉiTy³
:0,

57 
KeyA‰rName
:
key©ŒÇme
,

58 
NameA‰rName
:
Çm—‰ºame
,

59 
po¡D©a
:postData

61 
	`$
("#sub<?ph°echØ$_GET["
em¶oy“s
"]?>").
	`şick
(
	`funùiÚ
(){

62 
v¬
 
d©a
 = "";

63 
v¬
 
¿dio
 = 
	`$
('šput:¿dio[Çme=upd©e]:checked').
	`v®
();

64 if(
¿dio
 == "2") {

65 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

66 ià(
d©a
 == "") {

67 
d©a
 = 
	`$
(
this
).
	`v®
();

69 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

72 }ià(
¿dio
 == "1"){

73 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

74 ià(
d©a
 == "") {

75 
d©a
 = 
	`$
(
this
).
	`v®
();

77 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

82 
d©a
 = d©a.
	`»¶aû
(/
Ú
,/, "");

83 
v¬
 
em¶oy“s
 = "";

84 
	`$
("#"+"<?ph°echØ$DŸlogID; ?>_·ge_cÚ‹Á iÅut[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

85 ià(
em¶oy“s
 == "") {

86 
em¶oy“s
 = 
	`$
(
this
).
	`v®
();

88 
em¶oy“s
 =ƒm¶oy“ + "," + 
	`$
(
this
).
	`v®
();

91 if(
d©a
.
Ëngth
 == 0){

92 
	`®”t
("è¯·é€‰æ‹©åˆ†é…æ•°æ®");

95 if(
em¶oy“s
.
Ëngth
 == 0){

96 
	`®”t
("è¯·é€‰æ‹©å‘˜å·¥æ•°æ®");

102 
$
.
	`ajax
({

103 
u¾
:"<?ph°echØba£_u¾(); ?>šdex.php/www/objeùs/š_»l_u£r?em¶oy“s=<?ph°echØ$_GET["
em¶oy“s
"]?>&obj_type=<?phpƒcho $sel; ?>",

104 
ty³
:"post",

105 
d©a
:{
id
:d©a,
u£rs
:
em¶oy“s
},

106 
sucûss
:
	`funùiÚ
(
d©a
){

107 if(
d©a
 =="success"){

108 
	`®”t
("æ‰¹é‡æ›´æ–°æˆåŠŸ")

109 
wšdow
.
hi¡Üy
.
	`go
(0)

111 
	`®”t
("æ‰¹é‡æ›´æ–°å¤±è´¥")

116 
	}
});

120 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/edit.php

2 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

3 <
div
 
şass
="main-content">

4 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

5 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

6 <
ul
 
şass
="breadcrumb">

7 <
li
>

8 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

9 <
a
 
h»f
="<?phpƒcho base_url();?>index.php/www">é¦–é¡µ</a>

10 </
li
>

11 <
li
 
şass
="aùive"><
a
 
h»f
="<?ph°echØba£_u¾();?>šdex.php/www/objeùs/li¡s?obj_ty³=<?ph°echØ$obj_ty³;?>"><?
php
 
echo
 
$diù
;?>åˆ—è¡¨</
	ga
></
	gli
>

12 <
	gli
><?
php
 
echo
 
	g$Ëad_d©a
[
$moduË
.'.Name']; ?></li>

13 </
	gul
><!-- /.
	gb»adüumb
 -->

14 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

15 </
div
>

17 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

18 <
div
 
şass
="page-content">

19 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

20 <
div
 
şass
="page-header">

21 <
h1
>

22 <?
php
 
echo
 
$Ëad_d©a
[
$moduË
.'.Name']; ?>

23 <
	gsm®l
>

24 <?
php
 
echo
 
	g$moduË
;?> 
	gEd™


25 </
	gsm®l
>

26 </
	gh1
>

27 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

29 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

30 <
div
 
	gşass
="row">

31 <
fÜm
 
id
="FÜm" 
Úsubm™
="return false">

32 <
šput
 
ty³
="hidd’" 
Çme
="<?ph°echØ$´im¬y['key']; ?>" 
v®ue
="<?phpƒcho $primary['value']; ?>"/>

33 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_mod–" 
v®ue
="<?phpƒcho $module; ?>"/>

34 <
šput
 
ty³
="hidd’" 
Çme
 = "moduË_aùiÚ" 
v®ue
="module_update"/>

35 <
div
 
şass
="col-xs-12">

36 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

37 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

39 </
bu‰Ú
>

40 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

41 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

43 </
bu‰Ú
>

44 <
div
 
şass
="hr hr-dotted hr-16"></div>

45 </
div
>

47 <
div
 
şass
="cŞ-xs-12" 
id
="EditFormat"></div>

48 <
div
 
id
="d‘a" 
şass
="col-xs-12"></div>

49 <
div
 
şass
="col-xs-12">

50 <
div
 
şass
="hr hr-dotted hr-16"></div>

51 <
bu‰Ú
 
şass
="bŠ bŠ-šfo" 
Çme
="save">

52 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

54 </
bu‰Ú
>

55 <
bu‰Ú
 
şass
="bŠ bŠ-dªg”" 
Çme
="cancel">

56 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

58 </
bu‰Ú
>

59 </
div
>

60 </
fÜm
>

61 <
süt
 
ty³
="text/javascript">

63 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

64 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
); ?>;

65 
	`$
("#Ed™FÜm©").
	`FÜm©
({

66 
ty³
: "edit",

67 
FÜm©D©a
: 
fÜm©_d©a
,

68 
FromID
: "Form",

69 
S–eùChdEnumsU¾
: '<?phpƒcho base_url(); ?>index.php/admin/enum/SelectChildEnums'

71 
v¬
 
d_obj_Çme
 = "<?phpƒcho $dtl_obj_name?>";

72 
v¬
 
KeyA‰rName
 = "<?phpƒcho $KeyAttrName?>";

74 if(
d_obj_Çme
.
Ëngth
 != 0){

75 
	`$
("#d‘a").
	`L“TabË
({

76 
CŞ
:<?
php
 
echo
 
	`jsÚ_’code
(
$cŞl
);?>,

77 
IsEd™
:
Œue
,

78 
KeyA‰rName
:KeyAttrName

80 
	`$
("#d‘a").
	`L“TabË
('AddRowD©a',<?
php
 
echo
 
	`jsÚ_’code
(
$ûÎs
);?>);

82 
	}
});

83 </
	gsüt
>

84 </
	gdiv
><!-- /.
	grow
 -->

85 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

87 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

88 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

89 <
süt
 
	gty³
="text/javascript">

91 
$
("#FÜm").
v®id©e
({

92 
subm™HªdËr
: 
funùiÚ
() {

93 
v¬
 
d©a
 = 
$
("#FÜm").
£rŸlizeA¼ay
();

94 
v¬
 
ld©a
 = <?
php
 
echo
 
jsÚ_’code
(
$Ëad_d©a
)?>;

95 
$
.
ajax
({

97 'd©a':{'d©a':
d©a
,

98 'ld©a':
ld©a


100 'sucûss':
funùiÚ
(
d©a
){

102 
d©a
 = 
ev®
("("+data+")");

104 if(
d©a
.
»s
=='suc'){

105 
®”t
(
d©a
.
msg
);

106 
loÿtiÚ
.
h»f
="<?phpƒcho base_url();?>index.php/www/objects/lists?obj_type=<?phpƒcho $obj_type;?>";

108 
®”t
(
d©a
.
msg
);

113 'ÿche':
çl£


119 
$
('[Çme=ÿnûl]').
şick
(
	$funùiÚ
(){

120 
wšdow
.
hi¡Üy
.
	`go
(-1);

121  
çl£
;

122 
	}
});

125 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/export.php

1 <
div
 
	gid
="my-wiz¬d" 
d©a
-
rg‘
="#step-container">

2 <
ul
 
şass
="wizard-steps">

3 <
li
 
d©a
-
rg‘
="#¡•1" 
şass
="active">

4 <
¥ª
 
şass
="step">1</span>

5 <
¥ª
 
şass
="title">æ­¥éª¤ä¸€</span>

6 </
li
>

7 <
li
 
d©a
-
rg‘
="#step2">

8 <
¥ª
 
şass
="step">2</span>

9 <
¥ª
 
şass
="title">æ­¥éª¤äºŒ</span>

10 </
li
>

11 <
li
 
d©a
-
rg‘
="#step3">

12 <
¥ª
 
şass
="step">3</span>

13 <
¥ª
 
şass
="title">å¯¼å‡ºå®Œæˆ</span>

14 </
li
>

15 </
ul
>

16 </
div
>

18 <
div
 
şass
="¡•-cÚ‹Á" 
id
="step-container">

19 <
fÜm
 
şass
="fÜm-hÜizÚl" 
id
="§m¶e-fÜm" 
m‘hod
ğ"po¡" 
’ùy³
="muÉ¬t/fÜm-d©a" 
aùiÚ
="<?phpƒcho base_url();?>index.php/www/objects/export_csv">

20 <
div
 
şass
="¡•-·Ã‡ùive" 
id
="step1">

21 <
šput
 
ty³
="hidd’" 
Çme
="obj_ty³" 
v®ue
="<?phpƒcho $obj_type?>">

22 <!-- 
¡•
 1 -->

23 <
´e
>è¯·é€‰æ‹©éœ€è¦å¯¼å‡ºçš„æ•°æ®ã€‚</pre>

24 <
div
 
şass
="form-group">

26 <
div
 
şass
="radio">

27 <
Ïb–
>

28 <
šput
 
şass
="aû" 
ty³
="¿dio" 
Çme
="expÜt_li¡" 
v®ue
="0">

29 <
¥ª
 
şass
="lbl"> å¯¼å‡ºé€‰ä¸­è®°å½• </span>

30 <
šput
 
ty³
="hidd’" 
Çme
="£Ëùed_d©a" 
v®ue
="<?phpƒcho $selected_data?>">

31 </
Ïb–
>

32 </
div
>

33 <
div
 
şass
="radio">

34 <
Ïb–
>

35 <
šput
 
şass
="aû" 
ty³
="¿dio" 
Çme
="expÜt_li¡" 
v®ue
="1">

36 <
¥ª
 
şass
="lbl"> å¯¼å‡ºå½“å‰åˆ—è¡¨ </span>

37 </
Ïb–
>

38 </
div
>

41 </
div
>

44 </
div
>

45 <
div
 
şass
="¡•-·Ã" 
id
="step2">

46 <!-- 
¡•
 2 -->

49 </
div
>

50 <
div
 
şass
="¡•-·Ã" 
id
="step3">

51 <!-- 
¡•
 3 -->

52 </
div
>

53 </
fÜm
>

54 </
div
>

56 <
div
 
şass
="wizard-actions">

57 <
bu‰Ú
 
şass
="btn-prev btn">

58 <
i
 
şass
="ace-icon fa fa-arrow-left"></i> ä¸Šä¸€æ­¥

59 </
bu‰Ú
>

60 <
bu‰Ú
 
şass
="bŠ-ÃxˆbŠ bŠ-sucûss" 
d©a
-
Ï¡
="å®Œæˆ" >

61 ä¸‹ä¸€æ­¥ <
i
 
şass
="ace-icon fa fa-arrow-right icon-on-right"></i>

62 </
bu‰Ú
>

63 </
div
>

65 <
süt
 
ty³
="text/javascript">

66 
jQu”y
(
	$funùiÚ
(
$
) {

68 
	`$
('#my-file-input')

69 .
	`aû_fe_šput
()

70 .
	`Ú
('chªge', 
	`funùiÚ
() {

71 
fes
 = 
	`$
(
this
).
	`d©a
('ace_input_files');

75 
	`$
('#my-wizard')

76 .
	`aû_wiz¬d
({

79 .
	`Ú
('chªge' , 
	`funùiÚ
(
e
, 
šfo
) {

85 if(
šfo
.
¡•
==1 && info.
dœeùiÚ
 == 'next'){

86 
v¬
 
d©a2
 = 
	`$
("šput[ty³ôadio]:checked").
	`v®
();

87 
v¬
 
£Ëùed_d©a
 = <?
php
 
echo
 
$£Ëùed_d©a
;?>;

88 
	`®”t
(
£Ëùed_d©a
);

89 if(
d©a2
 == ""){

90 
	`®”t
("è¯·é€‰æ‹©éœ€è¦å¯¼å‡ºçš„æ•°æ®ã€‚");

91 
wiz¬d
.
cu¼’tS‹p
 = 1;

92 
wiz¬d
.
	`£tS‹
();

95 if(
d©a2
 != 1 ){

97 if(
£Ëùed_d©a
 =ğ
nuÎ
 || s–eùed_d©¨=ğ'' || s–eùed_d©¨=ğ
undefšed
){

99 
	`®”t
("è¯·å‹¾é€‰éœ€è¦å¯¼å‡ºçš„æ•°æ®ã€‚");

101 
wiz¬d
.
cu¼’tS‹p
 = 1;

102 
wiz¬d
.
	`£tS‹
();

106 
$
.
	`ajax
({

108 
d©a
:{

109 'expÜt_®l':
d©a2
,

110 '£Ëùed_d©a':
£Ëùed_d©a


113 'sucûss':
	`funùiÚ
(
d©a
){

114 
	`$
('#¡•2').
	`html
(
d©a
);

117 'ÿche':
çl£


120 if(
šfo
.
¡•
==2 && info.
dœeùiÚ
 == 'next'){

121 
v¬
 
d©a
="";

122 
	`$
('#tØİtiÚ').
	`—ch
(
	`funùiÚ
(
k
,
v
){

124 if(
d©a
==""){

125 
d©a
 = 
	`$
(
this
).
	`v®
();

127 
d©a
 = d©a+","+
	`$
(
this
).
	`v®
();

130 
v¬
 
d©a2
 = 
	`$
("šput[ty³ôadio]:checked").
	`v®
();

131 
v¬
 
£Ëùed_d©a
 = <?
php
 
echo
 
$£Ëùed_d©a
;?>;

132 
$
.
	`ajax
({

135 '£Ëùed_Ïb–':
d©a
,

136 'expÜt_®l':
d©a2
,

137 '£Ëùed_d©a':
£Ëùed_d©a
,

139 'sucûss':
	`funùiÚ
(
d©a
){

140 
	`$
('#¡•3').
	`html
(
d©a
);

143 'ÿche':
çl£


147 .
	`Ú
('fšished', 
	`funùiÚ
(
e
) {

149 
	`$
(
this
).
	`şo£¡
("[d©a-Çme='DŸlogDivexpÜt']").
	`dŸlog
("close");

150 }).
	`Ú
('¡•şick', 
	`funùiÚ
(
e
) {

152 
	`®”t
(3);

156 
	}
});

159 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/exportf.php

1 <
	g´e
>æ–‡ä»¶å·²å¯¼å‡ºï¼Œè¯·ç‚¹å‡»ä¸‹è½½</pre>

2 <
bu‰Ú
 
	gşass
="bŠ bŠ-wh™bŠ-šfØbŠ-bŞd" 
id
="download">

3 <
i
 
şass
="ace-icon fa fa-floppy-o bigger-120 blue"></i>

5 </
bu‰Ú
>

6 <
šput
 
ty³
="hidd’" 
Çme
="fe_d©a" 
v®ue
="<?phpƒcho $file_data;?>"/>

7 <
šput
 
ty³
="hidd’" 
Çme
="fe_Çme" 
v®ue
="<?phpƒcho $file_name;?>"/>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/exportm.php

1 <
süt
 
	gty³
="text/javascript">

2 
jQu”y
(
docum’t
).
»ady
(
	$funùiÚ
 () {

4 
	`$
("#addOÃ").
	`şick
(
	`funùiÚ
 () {

5 
	`$
("#äom o±iÚ:£Ëùed").
	`şÚe
().
	`­³ndTo
("#to");

6 
	`$
("#äom o±iÚ:£Ëùed").
	`»move
();

10 
	`$
("#addAÎ").
	`şick
(
	`funùiÚ
 () {

11 
	`$
("#äom o±iÚ").
	`şÚe
().
	`­³ndTo
("#to");

12 
	`$
("#äom o±iÚ").
	`»move
();

16 
	`$
("#»moveOÃ").
	`şick
(
	`funùiÚ
 () {

17 
	`$
("#tØİtiÚ:£Ëùed").
	`şÚe
().
	`­³ndTo
("#from");

18 
	`$
("#tØİtiÚ:£Ëùed").
	`»move
();

22 
	`$
("#»moveAÎ").
	`şick
(
	`funùiÚ
 () {

23 
	`$
("#tØİtiÚ").
	`şÚe
().
	`­³ndTo
("#from");

24 
	`$
("#tØİtiÚ").
	`»move
();

28 
	`$
("#Tİ").
	`şick
(
	`funùiÚ
 () {

29 
v¬
 
®lO±s
 = 
	`$
("#to option");

30 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

32 ià(
£Ëùed
.
	`g‘
(0).
šdex
 != 0) {

33 
i
 = 0; i < 
£Ëùed
.
Ëngth
; i++) {

34 
v¬
 
™em
 = 
	`$
(
£Ëùed
.
	`g‘
(
i
));

35 
v¬
 
tİ
 = 
	`$
(
®lO±s
.
	`g‘
(0));

36 
™em
.
	`š£¹BefÜe
(
tİ
);

42 
	`$
("#Up").
	`şick
(
	`funùiÚ
 () {

43 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

44 ià(
£Ëùed
.
	`g‘
(0).
šdex
 != 0) {

45 
£Ëùed
.
	`—ch
(
	`funùiÚ
 () {

46 
	`$
(
this
).
	`´ev
().
	`befÜe
($(this));

52 
	`$
("#Down").
	`şick
(
	`funùiÚ
 () {

53 
v¬
 
®lO±s
 = 
	`$
("#to option");

54 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

56 ià(
£Ëùed
.
	`g‘
(£Ëùed.
Ëngth
 - 1).
šdex
 !ğ
®lO±s
.length - 1) {

57 
i
 = 
£Ëùed
.
Ëngth
 - 1; i >= 0; i--) {

58 
v¬
 
™em
 = 
	`$
(
£Ëùed
.
	`g‘
(
i
));

59 
™em
.
	`š£¹Aá”
(™em.
	`Ãxt
());

65 
	`$
("#Bu‰om").
	`şick
(
	`funùiÚ
 () {

66 
v¬
 
®lO±s
 = 
	`$
("#to option");

67 
v¬
 
£Ëùed
 = 
	`$
("#to option:selected");

69 ià(
£Ëùed
.
	`g‘
(£Ëùed.
Ëngth
 - 1).
šdex
 !ğ
®lO±s
.length - 1) {

70 
i
 = 
£Ëùed
.
Ëngth
 - 1; i >= 0; i--) {

71 
v¬
 
™em
 = 
	`$
(
£Ëùed
.
	`g‘
(
i
));

72 
v¬
 
bu‰om
 = 
	`$
(
®lO±s
.
	`g‘
(
Ëngth
 - 1));

73 
™em
.
	`š£¹Aá”
(
bu‰om
);

79 
	}
});

80 </
	gsüt
>

81 <
	gdiv
>

83 </
	gdiv
>

86 <
div
 
	gşass
="w–l" 
¡yË
="height: 65px">

87 <
div
 
¡yË
="æßt:†eá">åœ¨æ­¤å¯ä»¥å°†çº¿ç´¢æ•°æ®å¯¼å‡ºåˆ°
CSV
æ–‡ä»¶ã€‚è¯·é€‰æ‹©å¯¼å‡ºçš„å±æ€§ã€‚</div>

88 <
div
 
¡yË
="float:†eft">

89 å¯¼å‡ºæ–‡ä»¶ç¼–ç ï¼š<
£Ëù
 
id
="codšg" 
Çme
="codšg" 
¡yË
="height: 30px;width:100px;margin-top: -5px">

90 <
İtiÚ
 
v®ue
="utf-8">
utf
-8</option>

91 <
İtiÚ
 
v®ue
="gbk">
gbk
</option>

92 <
İtiÚ
 
v®ue
="gb2312">
gb2312
</option>

93 </
£Ëù
>

94 </
div
>

96 </
div
>

99 </
´e
>

102 <
div
 
şass
="row">

104 <
div
 
şass
="col-xs-12 col-md-5">

106 <
div
 
şass
="well">

107 <
h3
 
şass
="header blue†ighter smaller">

108 <
i
 
şass
="ace-icon fa fa-calendar-o smaller-90"></i>

110 </
h3
>

111 <
£Ëù
 
Çme
="äom" 
id
="äom" 
¡yË
="width:100%;" 
size
="10" 
muÉË
="multiple">

112 <?
php
 
fÜ—ch
 (
$Ëá_li¡
 
as
 
$k
 => 
$v
) {?>

113 <
İtiÚ
 
v®ue
="<?ph°echØ$v['©Œ_Çme'];?>"><?
php
 
echo
 
$v
['Ïb–'];?></
	gİtiÚ
>

114 <?
	gphp
 }?>

115 <?
php
 
fÜ—ch
 (
$»f_Ëá_li¡
 
as
 
$k
 => 
$v
) {?>

116 <
İtiÚ
 
v®ue
="<?ph°echØ$v['©Œ_Çme'];?>"><?
php
 
echo
 
$v
['Ïb–'];?></
	gİtiÚ
>

117 <?
	gphp
 }?>

119 </
	g£Ëù
>

120 </
	gdiv
>

121 </
	gdiv
>

122 <
div
 
	gşass
="col-xs-12 col-md-2">

123 <
div
 
şass
="well with-header">

124 <
h3
 
şass
="header blue†ighter smaller">

126 </
h3
>

127 <
div
 
şass
="span2">

128 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Tİ" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

129 <
i
 
şass
="ace-icon fa fa-angle-double-up bigger-120 blue"></i>

130 </
a
>

131 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Up" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

132 <
i
 
şass
="ace-icon fa fa-angle-up bigger-120 blue"></i>

133 </
a
>

134 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="addOÃ" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

135 <
i
 
şass
="ace-icon fa fa-angle-right bigger-120 blue"></i>

136 </
a
>

137 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="»moveOÃ" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

138 <
i
 
şass
="ace-icon fa fa-angle-left bigger-120 blue"></i>

139 </
a
>

140 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Down" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

141 <
i
 
şass
="ace-icon fa fa-angle-down bigger-120 blue"></i>

142 </
a
>

143 <
a
 
şass
="bŠ bŠ-wh™e" 
id
="Bu‰om" 
ty³
="bu‰Ú" 
¡yË
="width: 50px;">

144 <
i
 
şass
="ace-icon fa fa-angle-double-down bigger-120 blue"></i>

145 </
a
>

146 </
div
>

147 </
div
>

148 </
div
>

149 <
div
 
şass
="col-xs-12 col-md-5">

150 <
div
 
şass
="well with-header">

151 <
h3
 
şass
="header blue†ighter smaller">

152 <
i
 
şass
="ace-icon fa fa-calendar-o smaller-90"></i>

154 </
h3
>

155 <
£Ëù
 
Çme
="to" 
id
="to" 
¡yË
="width:100%;" 
size
="10" 
muÉË
="multiple">

156 <?
php
 
fÜ—ch
 (
$Ïb–s
 
as
 
$k
 => 
$v
) {?>

157 <
İtiÚ
 
v®ue
="<?ph°echØ$v['©Œ_Çme'];?>"><?
php
 
echo
 
$v
['Ïb–'];?></
	gİtiÚ
>

158 <?
	gphp
 }?>

159 </
	g£Ëù
>

160 </
	gdiv
>

161 </
	gdiv
>

162 </
	gdiv
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/imagesupload.php

2 <
body
 
	gşass
="no-skin">

4 <
div
 
şass
="maš-cÚš”" 
id
="main-container">

5 <
süt
 
ty³
="text/javascript">

6 
Œy
{
aû
.
£‰šgs
.
check
('maš-cÚš”' , 'fixed')}
	$ÿtch
(
e
){
	}
}

7 </
süt
>

10 <
div
 
şass
="main-content">

11 <
div
 
şass
="main-content-inner">

13 <
div
 
şass
="page-content">

14 <
div
 
şass
="aû-£‰šgs-cÚš”" 
id
="ace-settings-container">

15 <
div
 
şass
="bŠ bŠ-­°bŠ-x bŠ-w¬nšg‡û-£‰šgs-bŠ" 
id
="ace-settings-btn">

16 <
i
 
şass
="ace-icon fa fa-cog bigger-130"></i>

17 </
div
>

19 <
div
 
şass
="aû-£‰šgs-box cË¬fix" 
id
="ace-settings-box">

20 <
div
 
şass
="pull-left width-50">

21 <
div
 
şass
="ace-settings-item">

22 <
div
 
şass
="pull-left">

23 <
£Ëù
 
id
="skš-cŞÜpick”" 
şass
="hide">

24 <
İtiÚ
 
d©a
-
skš
="no-skš" 
v®ue
="#438EB9">#438EB9</option>

25 <
İtiÚ
 
d©a
-
skš
="skš-1" 
v®ue
="#222A2D">#222A2D</option>

26 <
İtiÚ
 
d©a
-
skš
="skš-2" 
v®ue
="#C6487E">#C6487E</option>

27 <
İtiÚ
 
d©a
-
skš
="skš-3" 
v®ue
="#D0D0D0">#D0D0D0</option>

28 </
£Ëù
>

29 </
div
>

30 <
¥ª
>&
nb¥
; 
Choo£
 
	gSkš
</
	g¥ª
>

31 </
	gdiv
>

33 <
div
 
	gşass
="ace-settings-item">

34 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-navbar" />

35 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-Çvb¬"> 
Fixed
 
Navb¬
</label>

36 </
div
>

38 <
div
 
şass
="ace-settings-item">

39 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-sidebar" />

40 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-sideb¬"> 
Fixed
 
Sideb¬
</label>

41 </
div
>

43 <
div
 
şass
="ace-settings-item">

44 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-breadcrumbs" />

45 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-b»adüumbs"> 
Fixed
 
B»adüumbs
</label>

46 </
div
>

48 <
div
 
şass
="ace-settings-item">

49 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-rtl" />

50 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-¹l"> 
Right
 
To
 
Leá
 (
¹l
)</label>

51 </
div
>

53 <
div
 
şass
="ace-settings-item">

54 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-add-container" />

55 <
Ïb–
 
şass
="lbl" ="ace-settings-add-container">

56 
Inside


57 <
b
>.
cÚš”
</b>

58 </
Ïb–
>

59 </
div
>

60 </
div
><!-- /.
puÎ
-
Ëá
 -->

62 <
div
 
şass
="pull-left width-50">

63 <
div
 
şass
="ace-settings-item">

64 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-hover" />

65 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-hov”"> 
Subm’u
 
Ú
 
Hov”
</label>

66 </
div
>

68 <
div
 
şass
="ace-settings-item">

69 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-compact" />

70 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-com·ù"> 
Com·ù
 
Sideb¬
</label>

71 </
div
>

73 <
div
 
şass
="ace-settings-item">

74 <
šput
 
ty³
="checkbox" 
şass
="aû‡û-checkbox-2" 
id
="ace-settings-highlight" />

75 <
Ïb–
 
şass
="lbl" ="aû-£‰šgs-highlight"> 
AÉ
. 
Aùive
 
I‹m
</label>

76 </
div
>

77 </
div
><!-- /.
puÎ
-
Ëá
 -->

78 </
div
><!-- /.
aû
-
£‰šgs
-
box
 -->

79 </
div
><!-- /.
aû
-
£‰šgs
-
cÚš”
 -->

82 <
div
 
şass
="row">

83 <
div
 
şass
="col-xs-12">

84 <!-- 
PAGE
 
CONTENT
 
BEGINS
 -->

85 <
div
 
şass
="alert‡lert-info">

86 <
i
 
şass
="ace-icon fa fa-hand-o-right"></i>

89 <
bu‰Ú
 
şass
="şo£" 
d©a
-
dismiss
="alert">

90 <
i
 
şass
="ace-icon fa fa-times"></i>

91 </
bu‰Ú
>

92 </
div
>

94 <
div
>

95 <
fÜm
 
aùiÚ
="<?ph°echØ$u¾; ?>" 
şass
="drİzÚe" 
id
="dropzone">

96 <
div
 
şass
="fallback">

97 <
šput
 
Çme
="fe" 
ty³
="fe" 
muÉË
="" />

98 </
div
>

99 </
fÜm
>

100 </
div
><!-- 
PAGE
 
CONTENT
 
ENDS
 -->

101 </
div
><!-- /.
cŞ
 -->

102 </
div
><!-- /.
row
 -->

103 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

104 </
div
>

105 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

107 <
a
 
h»f
="#" 
id
="bŠ-süŞl-up" 
şass
="btn-scroll-up btn btn-sm btn-inverse">

108 <
i
 
şass
="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>

109 </
a
>

110 </
div
><!-- /.
maš
-
cÚš”
 -->

113 <!-- 
šlše
 
süts
 
»Ï‹d
 
to
 
this
 
·ge
 -->

114 <
süt
 
ty³
="text/javascript">

115 
jQu”y
(
	$funùiÚ
(
$
){

117 
Œy
 {

118 
DrİzÚe
.
autoDiscov”
 = 
çl£
;

119 
v¬
 
myDrİzÚe
 = 
Ãw
 
	`DrİzÚe
("#dropzone" , {

120 
·¿mName
: "file",

121 
maxFesize
: 2000,

122 
addRemoveLšks
 : 
Œue
,

123 
diùDeçuÉMes§ge
 :

125 <
¥ª
 
şass
="sm®Ër-80 g»y">(æˆ–è€… å•å‡»)</¥ª> <
br
 /> \

126 <
i
 
şass
="upload-icon‡ce-icon fa fa-cloud-upload blue fa-3x"></i>'

128 
diùRe¥Ú£E¼Ü
: 'Error while uploading file!',

131 
´ev›wTem¶©e
: "<div class=\"dz-preview dz-file-preview\">\n <div class=\"dz-details\">\n <div class=\"dz-filename\"><span data-dz-name></span></div>\n <div class=\"dz-size\" data-dz-size></div>\n <img data-dz-thumbnail />\n </div>\n <div class=\"progress…rogress-small…rogress-striped‡ctive\"><div class=\"progress-bar…rogress-bar-success\" data-dz-uploadprogress></div></div>\n <div class=\"dz-success-mark\"><span></span></div>\n <div class=\"dz-error-mark\"><span></span></div>\n <div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n</div>"

134 
	`$
(
docum’t
).
	`Úe
('ajaxlßd¡¬t.·ge', 
	`funùiÚ
(
e
) {

135 
Œy
 {

136 
myDrİzÚe
.
	`de¡roy
();

137 } 
	`ÿtch
(
e
) {}

140 } 
	`ÿtch
(
e
) {

141 
	`®”t
('æµè§ˆå™¨ä¸æ”¯æŒ');

144 
	}
});

145 </
	gsüt
>

146 </
	gbody
>

147 </
	ghtml
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/import.php

1 <
div
 
	gid
="my-wiz¬d" 
d©a
-
rg‘
="#step-container">

2 <
ul
 
şass
="wizard-steps">

3 <
li
 
d©a
-
rg‘
="#¡•1" 
şass
="active">

4 <
¥ª
 
şass
="step">1</span>

5 <
¥ª
 
şass
="title">æ­¥éª¤ä¸€</span>

6 </
li
>

7 <
li
 
d©a
-
rg‘
="#step2">

8 <
¥ª
 
şass
="step">2</span>

9 <
¥ª
 
şass
="title">æ­¥éª¤äºŒ</span>

10 </
li
>

11 <
li
 
d©a
-
rg‘
="#step3">

12 <
¥ª
 
şass
="step">3</span>

13 <
¥ª
 
şass
="title">å¯¼å…¥å®Œæˆ</span>

14 </
li
>

15 </
ul
>

16 </
div
>

18 <
div
 
şass
="¡•-cÚ‹Á" 
id
="step-container">

19 <
fÜm
 
şass
="fÜm-hÜizÚl" 
id
="§m¶e-fÜm" 
m‘hod
ğ"po¡" 
’ùy³
="muÉ¬t/fÜm-d©a" 
aùiÚ
="<?phpƒcho base_url();?>index.php/www/objects/importfile">

20 <
div
 
şass
="¡•-·Ã‡ùive" 
id
="step1">

21 <
šput
 
ty³
="hidd’" 
Çme
="obj_ty³" 
v®ue
="<?phpƒcho $obj_type?>">

22 <!-- 
¡•
 1 -->

23 <
´e
>1. ä½ å¯ä»¥æŠŠ
csv
æ–‡ä»¶ã€åˆ¶è¡¨ç¬¦åˆ†éš”çš„æ–‡ä»¶æˆ–å…¶å®ƒåˆ†éš”ç¬¦åˆ†éš”çš„æ•°æ®æ–‡ä»¶å¯¼å…¥ç³»ç»Ÿã€‚

26 4. å¦‚æœéœ€è¦å¯¼å…¥å¤§çš„æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å°†å…¶æ‹†æˆè‹¥å¹²ä¸ªå°çš„æ–‡ä»¶ç„¶ååˆ†åˆ«å¯¼å…¥ã€‚</
´e
>

27 <
div
 
şass
="form-group">

28 <
Ïb–
 ="suffix" 
şass
="col-sm-3 control-label‚o-padding-right">æŒ‡å®šå¯¼å…¥æ–‡ä»¶æ ¼å¼ï¼š</label>

29 <
div
 
şass
="col-sm-3">

30 <
£Ëù
 
id
="suffix" 
şass
="cŞ-sm-12" 
Çme
="file-type">

31 <
İtiÚ
 
v®ue
="csv">
CSV
(*.
csv
)</option>

32 <
İtiÚ
 
v®ue
="xls">
Exûl
(*.
xls
)</option>

33 <
İtiÚ
 
v®ue
="xlsx">
Exûl2007
(*.
xlsx
)</option>

34 </
£Ëù
>

35 </
div
>

36 <
div
 
şass
="h–p-block cŞ-sm-6">(æš‚æ—¶åªæ”¯æŒ
csv
æ ¼å¼ é»˜è®¤ä¸ºé€—å·åˆ†éš”)</div>

37 </
div
>

38 <
div
 
şass
="form-group">

39 <
Ïb–
 ="symbŞ" 
şass
="col-sm-3 control-label"></label>

40 <
div
 
şass
="col-sm-9">

41 <
Ïb–
>

42 <
šput
 
ty³
="¿dio" 
Çme
="symbŞ" 
şass
="aû" 
v®ue
="," 
checked
/>

43 <
¥ª
 
şass
="lbl">é€—å·åˆ†éš”çš„æ–‡ä»¶</span>

44 </
Ïb–
>

45 <
Ïb–
>

46 <
šput
 
ty³
="¿dio" 
Çme
="symbŞ" 
şass
="aû" 
v®ue
="|" />

47 <
¥ª
 
şass
="lbl">åˆ¶è¡¨ç¬¦åˆ†éš”çš„æ–‡ä»¶</span>

48 </
Ïb–
>

49 <
Ïb–
>

50 <
šput
 
ty³
="¿dio" 
Çme
="symbŞ" 
şass
="aû" 
v®ue
=""/>

51 <
¥ª
 
şass
="lbl">è‡ªå®šä¹‰åˆ†éš”ç¬¦åˆ†éš”çš„æ–‡ä»¶</span>

52 <
šput
 
ty³
="‹xt" 
v®ue
="," 
maxËngth
="1" 
¡yË
="width:40px;" 
Çme
="userdelimited"/>

53 </
Ïb–
>

54 </
div
>

55 </
div
>

56 <
div
 
şass
="form-group">

58 <
Ïb–
 ="my-fe-šput" 
şass
="col-sm-3 control-label‚o-padding-right">é€‰ä¸­å¯¼å…¥æ–‡ä»¶ï¼š</label>

59 <
div
 
şass
="col-sm-5">

60 <
šput
 
ty³
="fe" 
Úchªge
="ajaxFeU¶ßdÑhis)" 
şass
="u¶ßdFe" 
Çme
="myfe" 
id
="myfile">

61 <
šput
 
ty³
="hidd’" 
id
="fe_addr" 
Çme
="file_addr">

62 <
¥ª
 
¡yË
="display:‚one; width: 200px;color:„ed">æ¡£æ¡ˆä¸Šä¼ ä¸­ï¼Œè¯·ç¨å</span>

63 </
div
>

64 <
div
 
şass
="col-sm-4">

65 </
div
>

66 </
div
>

67 <
div
 
şass
="form-group">

68 <
Ïb–
 
şass
="col-sm-3 control-label"></label>

69 <
div
 
şass
="col-sm-9">

70 <
Ïb–
>

71 <
šput
 
ty³
="checkbox" 
Çme
="w™h_t™Ë" 
şass
="aû" 
v®ue
="1" 
checked
/>

72 <
¥ª
 
şass
="lbl">æœ‰æ ‡é¢˜æ </span>

73 </
Ïb–
>

74 <
Ïb–
>

75 <
šput
 
ty³
="checkbox" 
Çme
="ü—‹_’um" 
şass
="aû" 
v®ue
="1"/>

76 <
¥ª
 
şass
="lbl">åˆ›å»ºä¸å­˜åœ¨çš„æšä¸¾å€¼</span>

77 </
Ïb–
>

78 </
div
>

79 </
div
>

82 </
div
>

83 <
div
 
şass
="¡•-·Ã" 
id
="step2">

84 <!-- 
¡•
 2 -->

86 </
div
>

87 <
div
 
şass
="¡•-·Ã" 
id
="step3">

88 <!-- 
¡•
 3 -->

90 </
div
>

91 </
fÜm
>

92 </
div
>

94 <
div
 
şass
="wizard-actions">

95 <
bu‰Ú
 
şass
="btn-prev btn">

96 <
i
 
şass
="ace-icon fa fa-arrow-left"></i> ä¸Šä¸€æ­¥

97 </
bu‰Ú
>

98 <
bu‰Ú
 
şass
="bŠ-ÃxˆbŠ bŠ-sucûss" 
d©a
-
Ï¡
="å®Œæˆ" >

99 ä¸‹ä¸€æ­¥ <
i
 
şass
="ace-icon fa fa-arrow-right icon-on-right"></i>

100 </
bu‰Ú
>

101 </
div
>

103 <
süt
 
ty³
="text/javascript">

104 
jQu”y
(
	$funùiÚ
(
$
) {

106 
	`$
('#my-file-input')

107 .
	`aû_fe_šput
()

108 .
	`Ú
('chªge', 
	`funùiÚ
() {

109 
fes
 = 
	`$
(
this
).
	`d©a
('ace_input_files');

113 
	`$
('#my-wizard')

114 .
	`aû_wiz¬d
({

117 .
	`Ú
('chªge' , 
	`funùiÚ
(
e
, 
šfo
) {

123 if(
šfo
.
¡•
==1 && info.
dœeùiÚ
 == 'next'){

124 
v¬
 
fe_u¾
 =
	`$
('#fe_addr').
	`v®
();

126 
$
.
	`ajax
({

128 
d©a
:{'fe_u¾':
fe_u¾
},

129 'sucûss':
	`funùiÚ
(
d©a
){

130 
	`$
('#¡•2').
	`html
(
d©a
);

133 'ÿche':
çl£


136 if(
šfo
.
¡•
==2 && info.
dœeùiÚ
 == 'å®Œæˆ'){

137 
$
.
	`ajax
({

139 'sucûss':
	`funùiÚ
(
d©a
){

140 
	`$
('#¡•2').
	`html
(
d©a
);

143 'ÿche':
çl£


146 if(
šfo
.
¡•
==2 && info.
dœeùiÚ
 == 'next'){

147 
v¬
 
v
 = 
Œue
;

148 
	`$
(".mu¡").
	`—ch
(
	`funùiÚ
(){

149 if(
	`$
(
this
).
	`v®
() == "null"){

150 
v
 = 
çl£
;

154 if(
v
){

155 
v¬
 
d©aInfo
 = 
	`$
("#impÜtR–©iÚ").
	`£rŸlize
().
	`toSŒšg
();

157 
$
.
	`ajax
({

159 'd©a':{
d©a
:
d©aInfo
},

160 'sucûss':
	`funùiÚ
(
d©a
){

161 
	`$
('#¡•3').
	`html
(
d©a
);

164 'ÿche':
çl£


167 
	`®”t
("è¯·å¡«å†™æ•°æ®")

172 .
	`Ú
('fšished', 
	`funùiÚ
(
e
) {

174 
	`®”t
(2);

175 
	`$
(
this
).
	`şo£¡
("[d©a-Çme='DŸlogDiv']").
	`dŸlog
("close");

176 }).
	`Ú
('¡•şick', 
	`funùiÚ
(
e
) {

178 
	`®”t
(3);

182 
	}
});

184 
funùiÚ
 
	$ajaxFeU¶ßd
(
This
){

185 
v¬
 
thisNext
=
	`$
(
This
). 
	`Ãxt
();

186 
v¬
 
thisNextS·n
ğ
	`$
(
This
). 
	`Ãxt
().‚ext()

187 
thisNextS·n
.
	`css
('display','inline-block');

188 
v¬
 
v®id
=
Œue
;

189 
v¬
 
feId
=
nuÎ
;

190 
v¬
 
feV®ues
='';

191 if(
	`$
(
This
).
	`v®
().
Ëngth
!=0){

192 
feV®ues
=
	`$
(
This
).
	`v®
();

193 
	`$
(
This
).
	`´ev
().´ev().
	`v®
(
feV®ues
)

194 
feId
=
	`$
(
This
).
	`©Œ
('id')

195 if(
thisNext
.
	`v®
().
Ëngth
!=0){

196 
v¬
 
Hidd’
=
thisNext
.
	`v®
();

199 
v®id
=
çl£
;

205 if(
v®id
){

206 
$
.
	`ajaxFeU¶ßd
({

207 
u¾
:'<?phpƒcho base_url();?>index.php/www/objects/upload',

208 
£cu»uri
:
çl£
,

209 
d©aTy³
: 'json',

210 
feEËm’tId
:"myfile",

211 
sucûss
: 
	`funùiÚ
 (
d©a
)

215 
thisNextS·n
.
	`css
('display','none');

216 if(
d©a
.
fuÎ_·th
 !ğ
nuÎ
)

218 
thisNext
.
	`v®
(
d©a
.
fuÎ_·th
);

222 
	`®”t
(
d©a
.
”rÜ
);

225 
”rÜ
: 
	`funùiÚ
 (
d©a
,
¡©us
, 
e
)

227 
	`®”t
(
e
);

231 
thisNextS·n
.
	`css
('display','none');

233 
	}
}

235 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/importf.php

1 <
	g¡yË
>

2 .
	gmu¡
 {

3 
	gbÜd”
: 1
px
 
sŞid
 
»d
;

5 </
	g¡yË
>

6 <
	g´e
>1.åœ¨ç³»ç»Ÿå­—æ®µä¸­ï¼Œé€‰æ‹©ä¸
	gCRM
ç³»ç»ŸåŒ¹é…çš„æ•°æ®åˆ—ï¼›

8 3.å¯¹å¼•ç”¨å­—æ®µï¼Œé€‰æ‹©å¯ä»¥åœ¨ç³»ç»Ÿä¸­æŒ‰åç§°æŸ¥æ‰¾å¯¹åº”è®°å½•çš„å­—æ®µã€‚</
	g´e
>

9 <
fÜm
 
	gÇme
="impÜtR–©iÚ" 
id
="importRelation">

10 <
šput
 
ty³
="hidd’" 
Çme
="fe_u¾" 
v®ue
="<?phpƒcho $file_url ?>"/>

12 <
h3
>ç³»ç»Ÿå±æ€§</h3>

13 <
bË
 
şass
="bËabË-¡redabË-bÜd”ed" 
id
="">

14 <
tbody
>

15 <
Œ
>

16 <
th
>
CRM
å±æ€§</th>

17 <
th
>å¯¼å…¥å±æ€§</th>

18 <
th
>ä¸»é”®</th>

19 <
th
>
CRM
å±æ€§</th>

20 <
th
>å¯¼å…¥å±æ€§</th>

21 <
th
>ä¸»é”®</th>

22 </
Œ
>

23 <?
php


25 
$deçuÉ_İtiÚ
 = '<option value="null"></option>';

26 
fÜ—ch
 (
$csv
 
as
 
$k
 => 
$v
) {

27 
$deçuÉ_İtiÚ
 .ğ'<İtiÚ v®ue="' . 
$k
 . '">' . 
$v
 . '</option>';

30 
fÜ—ch
 (
$Ëad
['sy¡em'] 
as
 
$key
 => 
$v®ue
) {

31 
$num
 = 
$key
 + 1;

32 ià(
	g$num
 == 1) {

33 
echo
 "<tr>";

36 
	g$dis
 = "";

37 ià(
	g$v®ue
["ATTR_TYPE"] == 4) {

38 
$dis
 = "none";

41 
	g$İtiÚ
 = '<option value="null"></option>';

42 
fÜ—ch
 (
$csv
 
as
 
$k
 => 
$v
) {

43 ià(
$v®ue
['LABEL'] =ğ
$v
) {

44 
$İtiÚ
 .ğ'<İtiÚ v®ue="' . 
$k
 . '" s–eùed = "£Ëùed">' . 
$v
 . '</option>';

46 
	g$İtiÚ
 .ğ'<İtiÚ v®ue="' . 
$k
 . '">' . 
$v
 . '</option>';

49 
	g$şass
 = "col-sm-12";

50 
	g$t™Ë
 = "";

51 ià(
	g$v®ue
["IS_MUST"] == 1) {

52 
$şass
 = "col-sm-12 must";

53 
	g$t™Ë
 = "å¿…é¡»é€‰æ‹©";

55 
	gecho
 '<td>' . 
	g$v®ue
['LABEL'] . '</td>

56 <
	gtd
>

57 <
£Ëù
 
	gid
="suffix" 
şass
="' . $şas . '" 
Çme
="' . $v®ue['ATTR_NAME'] . '" 
t™Ë
="' . $title . '">

59 </
£Ëù
>

60 </
td
>

61 <
td
>

62 <
šput
 
¡yË
="di¥Ïy:' . $di . '" 
Çme
="' . $v®ue['ATTR_NAME'] . 'checkBox" 
ty³
="checkbox"/>

63 </
td
>';

65 ià(
$num
 =ğ
couÁ
(
$Ëad
['system'])) {

66 
echo
 "</tr>";

69 ià(
	g$num
 % 2 == 0) {

70 
echo
 "</tr><tr>";

75 <
	gtbody
>

76 </
	gbË
>

78 <
	gh3
>å¼•ç”¨å±æ€§</h3>

79 <
bË
 
	gşass
="tableable-stripedable-bordered">

80 <
tbody
>

81 <
Œ
>

82 <
th
>
CRM
å±æ€§</th>

83 <
th
>å¯¼å…¥å±æ€§</th>

84 <
th
>ä¸»é”®</th>

85 <
th
>
CRM
å±æ€§</th>

86 <
th
>å¯¼å…¥å±æ€§</th>

87 <
th
>ä¸»é”®</th>

88 </
Œ
>

89 <?
php


91 
fÜ—ch
 (
$Ëad
['»f'] 
as
 
$key
 => 
$v®ue
) {

92 
$İtiÚ2
 = "";

93 
fÜ—ch
 (
$v®ue
 
as
 
$k
 => 
$v
) {

94 
$İtiÚ2
 .ğ'<İtiÚ v®ue="' . 
$v
["ATTR_NAME"] . '">' . 
$key
 . ":" . $v["LABEL"] . '</option>';

96 
	g$£Ëù_¬r
[
$key
] = 
$İtiÚ2
;

99 
	g$num
 = 1;

100 
fÜ—ch
 (
$Ëad
['»f'] 
as
 
$key
 => 
$v®ue
) {

101 ià(
$num
 == 1) {

102 
echo
 "<tr>";

105 
	g$İtiÚ2
 = '<option value="null"></option>';

106 
	g$şass
 = "col-sm-12„efValue";

107 
	g$t™Ë
 = "";

108 
	g$£Ëù_šdex
 = "null";

109 ià(
	g$v®ue
["IS_MUST"] == 1) {

110 
$şass
 = "col-sm-12„efValue must";

111 
	g$t™Ë
 = "å¿…é¡»é€‰æ‹©";

113 
fÜ—ch
 (
$csv
 
as
 
$k
 => 
$v
) {

114 ià(
$key
 =ğ
$v
) {

115 
$İtiÚ2
 .ğ'<İtiÚ v®ue="' . 
$k
 . '" s–eùed = "£Ëùed">' . 
$v
 . '</option>';

116 
	g$£Ëù_šdex
 = 
$k
;

118 
	g$İtiÚ2
 .ğ'<İtiÚ v®ue="' . 
$k
 . '">' . 
$v
 . '</option>';

121 
	gecho
 '<td>

122 <
£Ëù
 
	gşass
="col-sm-12„efName">

124 </
£Ëù
>

125 </
td
>

126 <
šput
 
ty³
="hidd’" 
Çme
="' . $v®ue[0]['ATTR_NAME'] . '" 
v®ue
="'.$select_index.'">

127 <
td
>

128 <
£Ëù
 
şass
="' . $şas . '" 
t™Ë
="' . $title . '">

130 </
£Ëù
>

131 </
td
>

132 <
td
>

133 <
šput
 
ty³
="checkbox" 
Çme
="' . $value[0]['ATTR_NAME'] . 'checkBox"/>

134 </
td
>';

136 ià(
$num
 =ğ
couÁ
(
$Ëad
['ref'])) {

137 
echo
 "</tr>";

140 ià(
	g$num
 % 2 == 0) {

141 
echo
 "</tr><tr>";

143 
	g$num
++;

146 <
	gtbody
>

147 </
	gbË
>

148 </
	gfÜm
>

149 <
süt
 
	gty³
="text/javascript">

150 
$
(
	$funùiÚ
 () {

151 
	`$
(".»fName").
	`chªge
(
	`funùiÚ
 () {

152 
v¬
 
hidd’
 = 
	`$
(
this
).
	`·»Á
().
	`Ãxt
();

153 
	`$
(
hidd’
).
	`©Œ
("Çme", $(
this
).
	`v®
())

154 
v¬
 
check
 = 
	`$
(
this
).
	`·»Á
().
	`Ãxt
().Ãxt().Ãxt().
	`chd»n
();

155 
	`$
(
check
).
	`©Œ
("Çme", $(
this
).
	`v®
() + "checkBox")

158 
	`$
(".»fV®ue").
	`chªge
(
	`funùiÚ
 () {

159 
v¬
 
hidd’
 = 
	`$
(
this
).
	`·»Á
().
	`´ev
();

160 
	`$
(
hidd’
).
	`v®
($(
this
).val());

163 
	}
})

165 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/list.php

1 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

2 <
div
 
şass
="main-content">

3 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

4 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

5 <
ul
 
şass
="breadcrumb">

6 <
li
>

7 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

8 <
a
 
h»f
="<?phpƒcho base_url(); ?>index.php/www/">é¦–é¡µ</a>

9 </
li
>

11 <
li
 
şass
="aùive"><?
php
 
echo
 
$obj
[1]['LABEL'] ?>åˆ—è¡¨</li>

12 </
ul
><!-- /.
b»adüumb
 -->

16 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

17 </
div
>

19 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

20 <
div
 
şass
="page-content">

21 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

22 <
div
 
şass
="page-header">

23 <
h1
>

24 <?
php
 
echo
 
$obj
[1]['LABEL'] ?>åˆ—è¡¨

25 <
sm®l
>

26 <?
php
 
echo
 
$obj
[0]['LABEL'] ?> 
Li¡


27 </
sm®l
>

28 </
h1
>

29 </
div
><!-- /.
·ge
-
h—d”
 -->

31 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

32 <
div
 
şass
="row">

33 <
div
 
şass
="col-xs-12">

35 <
bË
 
id
="grid-table"></table>

37 <
div
 
id
="grid-pager"></div>

39 <
süt
 
ty³
="text/javascript">

40 
v¬
 
$·th_ba£
 = ".";

41 </
	gsüt
>

43 <!-- 
PAGE
 
CONTENT
 
	gENDS
 -->

44 </
	gdiv
><!-- /.
	gcŞ
 -->

45 </
	gdiv
><!-- /.
	grow
 -->

46 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

48 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

49 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

51 <
süt
 
	gty³
="text/javascript">

52 
$
(
docum’t
).
»ady
(
	$funùiÚ
(){

53 
$
.
	`po¡
("<?ph°echØba£_u¾(); ?>šdex.php/www/objeùs/li¡_objeù_jsÚ",{},
	`funùiÚ
(
d©a
){

54 
v¬
 
»t
 = 
	`ev®
("("+
d©a
+")");

55 
	`jqgridIn™
(
»t
);

57 
	}
})

58 
funùiÚ
 
	$jqgridIn™
(
grid_d©a
){

59 
v¬
 
grid_£ËùÜ
 = "#grid-table";

60 
v¬
 
·g”_£ËùÜ
 = "#grid-pager";

61 
	`$
(
wšdow
).
	`Ú
('»size.jqGrid', 
	`funùiÚ
 () {

62 
	`$
(
grid_£ËùÜ
).
	`jqGrid
Ğ'£tGridWidth', $(".·ge-cÚ‹Á").
	`width
() );

64 
v¬
 
·»Á_cŞumn
 = 
	`$
(
grid_£ËùÜ
).
	`şo£¡
('[class*="col-"]');

65 
	`$
(
docum’t
).
	`Ú
('£‰šgs.aû.jqGrid' , 
	`funùiÚ
(
ev
, 
ev’t_Çme
, 
cŞÏp£d
) {

66 ifĞ
ev’t_Çme
 === 'sidebar_collapsed' ||ƒvent_name === 'main_container_fixed' ) {

67 
	`£tTimeout
(
	`funùiÚ
() {

68 
	`$
(
grid_£ËùÜ
).
	`jqGrid
Ğ'£tGridWidth', 
·»Á_cŞumn
.
	`width
() );

72 
	`jQu”y
(
grid_£ËùÜ
).
	`jqGrid
({

73 
subGrid
 : 
çl£
,

74 
subGridO±iÚs
 : {

75 
¶usicÚ
 : "ace-icon fa fa-plus center bigger-110 blue",

76 
mšusicÚ
 : "ace-icon fa fa-minus center bigger-110 blue",

77 
İ’icÚ
 : "ace-icon fa fa-chevron-right center orange"

79 
d©a
: 
grid_d©a
,

80 
d©©y³
: "local",

81 
height
: 250,

82 
cŞNames
:[' ', 'æ ‡è¯†','å“ç±»','ç³»åˆ—', 'åºå·', 'è´§å·','ç¬¬äºŒé¡¹ç›®å·', 'å“å','è§„æ ¼','é¢„è®¡ä¸Šå¸‚æ—¶é—´', 'å•ä½', 'å°ç›’','ä¸­ç›’', 'ä»¶','å…¨å›½æ‰¹å‘éƒ¨é¢ä»·å…ƒ/ï¼ˆæ”¯/ç›’/ä¸ªï¼‰','ä¸œåŒ—æ‰¹å‘éƒ¨é¢ä»·å…ƒ/ï¼ˆæ”¯/ç›’/ä¸ªï¼‰', 'å»ºè®®é›¶å”®ä»·', 'å…¨å›½å¼€å•æ‰£ï¼ˆé™¤ä¸œåŒ—ã€æ–°ç–†ï¼‰','ä¸œåŒ—å¼€å•æ‰£','æ–°ç–†å¼€å•æ‰£','ä¸­ç±»','å“ç‰Œ','JDEå±æ€§','å¤‡æ³¨'],

83 
cŞMod–
:[

84 {
Çme
:'myac',
šdex
:'', 
width
:80, 
fixed
:
Œue
, 
sÜbË
:
çl£
, 
»size
:false,

85 
fÜm©‹r
:'actions',

86 
fÜm©İtiÚs
:{

87 
keys
:
Œue
,

88 
d–O±iÚs
:{
»ü—‹FÜm
: 
Œue
, 
befÜeShowFÜm
:
befÜeD–‘eC®lback
},

91 {
Çme
:'id',
šdex
:'id', 
width
:60, 
sÜ‰y³
:"št", 
ed™abË
: 
çl£
},

92 {
Çme
:'ÿ‹',
šdex
:'ÿ‹',
width
:90, 
ed™abË
:
Œue
, 
sÜ‰y³
:"date"},

93 {
Çme
:'£r›s',
šdex
:'£r›s', 
width
:150,
ed™abË
: 
Œue
},

94 {
Çme
:'numb”',
šdex
:'numb”', 
width
:70, 
ed™abË
: 
Œue
},

95 {
Çme
:'id1',
šdex
:'id1', 
width
:90, 
ed™abË
: 
Œue
},

96 {
Çme
:'id2',
šdex
:'id2', 
width
:150, 
sÜbË
:
çl£
,
ed™abË
: 
Œue
,
ed™ty³
:"textarea"},

97 {
Çme
:'Çme',
šdex
:'Çme', 
width
:60, 
sÜ‰y³
:"št", 
ed™abË
: 
Œue
},

98 {
Çme
:'¡ªd¬d',
šdex
:'¡ªd¬d',
width
:90, 
ed™abË
:
Œue
, 
sÜ‰y³
:"date"},

99 {
Çme
:'m¬k‘_d©e',
šdex
:'m¬k‘_d©e', 
width
:150,
ed™abË
: 
Œue
,
unfÜm©
: 
pickD©e
},

100 {
Çme
:'un™',
šdex
:'un™', 
width
:70, 
ed™abË
: 
Œue
},

101 {
Çme
:'sm®l_box',
šdex
:'sm®l_box', 
width
:90, 
ed™abË
: 
Œue
},

102 {
Çme
:'nÜm®_box',
šdex
:'nÜm®_box', 
width
:150, 
sÜbË
:
çl£
,
ed™abË
: 
Œue
,
ed™ty³
:"‹x»a", 
ed™İtiÚs
:{
rows
:"2",
cŞs
:"10"}},

103 {
Çme
:'p›û',
šdex
:'p›û',
width
:90, 
ed™abË
:
Œue
, 
sÜ‰y³
:"date"},

104 {
Çme
:'´iû',
šdex
:'´iû', 
width
:150,
ed™abË
: 
Œue
,
ed™İtiÚs
:{
size
:"20",
maxËngth
:"30"}},

105 {
Çme
:'´iû2',
šdex
:'´iû2', 
width
:70, 
ed™abË
: 
Œue
},

106 {
Çme
:'´iû_tmp',
šdex
:'´iû_tmp', 
width
:90, 
ed™abË
: 
Œue
},

107 {
Çme
:'Üd”_kou',
šdex
:'Üd”_kou', 
width
:150, 
sÜbË
:
çl£
,
ed™abË
: 
Œue
,
ed™ty³
:"‹x»a", 
ed™İtiÚs
:{
rows
:"2",
cŞs
:"10"}},

108 {
Çme
:'Üd”_kou2',
šdex
:'Üd”_kou2', 
wÜd”_kou2th
:60, 
sÜ‰y³
:"št", 
ed™abË
: 
Œue
},

109 {
Çme
:'Üd”_kou3',
šdex
:'Üd”_kou3',
width
:90, 
ed™abË
:
Œue
},

110 {
Çme
:'bigÿ‹',
šdex
:'bigÿ‹', 
width
:150,
ed™abË
: 
Œue
},

111 {
Çme
:'b¿nd',
šdex
:'b¿nd', 
width
:150, 
sÜbË
:
çl£
,
ed™abË
: 
Œue
,
ed™ty³
:"‹x»a", 
ed™İtiÚs
:{
rows
:"2",
cŞs
:"10"}},

112 {
Çme
:'jde_©Œ',
šdex
:'jde_©Œ', 
width
:70, 
ed™abË
: 
Œue
},

113 {
Çme
:'zh’gû',
šdex
:'zh’gû', 
width
:90, 
ed™abË
: 
Œue
},

116 
v›w»cÜds
 : 
Œue
,

117 
rowNum
:10,

118 
rowLi¡
:[10,20,30],

119 
·g”
 : 
·g”_£ËùÜ
,

120 
®tRows
: 
Œue
,

122 
muÉi£Ëù
: 
Œue
,

123 
muÉiboxÚly
: 
Œue
,

125 
lßdCom¶‘e
 : 
	`funùiÚ
() {

126 
v¬
 
bË
 = 
this
;

127 
	`£tTimeout
(
	`funùiÚ
(){

128 
	`¡yËCheckbox
(
bË
);

129 
	`upd©eAùiÚIcÚs
(
bË
);

130 
	`upd©ePag”IcÚs
(
bË
);

131 
	`’abËToŞts
(
bË
);

135 
ed™u¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/oper",

136 
ÿ±iÚ
: "è®¢å•åŸºç¡€ä¿¡æ¯åˆ—è¡¨"

139 
	`$
(
wšdow
).
	`Œigg”HªdËr
('resize.jqGrid');

140 
funùiÚ
 
	`aûSw™ch
Ğ
ûÎv®ue
, 
İtiÚs
, 
ûÎ
 ) {

141 
	`£tTimeout
(
	`funùiÚ
(){

142 
	`$
(
ûÎ
è.
	`fšd
('input[type=checkbox]')

143 .
	`addCÏss
('ace‡ce-switch‡ce-switch-5')

144 .
	`aá”
('<span class="lbl"></span>');

147 
funùiÚ
 
	`pickD©e
Ğ
ûÎv®ue
, 
İtiÚs
, 
ûÎ
 ) {

148 
	`£tTimeout
(
	`funùiÚ
(){

149 
	`$
(
ûÎ
è.
	`fšd
('input[type=text]')

150 .
	`d©•ick”
({
fÜm©
:'yyyy-mm-dd' , 
autoşo£
:
Œue
});

155 
	`jQu”y
(
grid_£ËùÜ
).
	`jqGrid
('ÇvGrid',
·g”_£ËùÜ
,

157 
ed™
: 
Œue
,

158 
ed™icÚ
 : 'ace-icon fa fa-pencil blue',

163 
£¬ch
: 
Œue
,

164 
£¬chicÚ
 : 'ace-icon fa fa-search orange',

171 
»ü—‹FÜm
: 
Œue
,

172 
befÜeShowFÜm
 : 
	`funùiÚ
(
e
) {

173 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

174 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ëb¬').
	`w¿pIÂ”
('<div class="widget-header" />')

175 
	`¡yË_ed™_fÜm
(
fÜm
);

179 
şo£Aá”Add
: 
Œue
,

180 
»ü—‹FÜm
: 
Œue
,

181 
v›wPag”Bu‰Ús
: 
çl£
,

182 
befÜeShowFÜm
 : 
	`funùiÚ
(
e
) {

183 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

184 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdialog-titlebar')

185 .
	`w¿pIÂ”
('<div class="widget-header" />')

186 
	`¡yË_ed™_fÜm
(
fÜm
);

190 
»ü—‹FÜm
: 
Œue
,

191 
befÜeShowFÜm
 : 
	`funùiÚ
(
e
) {

192 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

193 if(
fÜm
.
	`d©a
('¡yËd')è 
çl£
;

195 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ëb¬').
	`w¿pIÂ”
('<div class="widget-header" />')

196 
	`¡yË_d–‘e_fÜm
(
fÜm
);

198 
fÜm
.
	`d©a
('¡yËd', 
Œue
);

200 
ÚClick
 : 
	`funùiÚ
(
e
) {

204 
»ü—‹FÜm
: 
Œue
,

205 
aá”ShowS—rch
: 
	`funùiÚ
(
e
){

206 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

207 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ë').
	`w¿p
('<div class="widget-header" />')

208 
	`¡yË_£¬ch_fÜm
(
fÜm
);

210 
aá”Red¿w
: 
	`funùiÚ
(){

211 
	`¡yË_£¬ch_f‹rs
(
	`$
(
this
));

214 
muÉËS—rch
: 
Œue
,

217 
»ü—‹FÜm
: 
Œue
,

218 
befÜeShowFÜm
: 
	`funùiÚ
(
e
){

219 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

220 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ë').
	`w¿p
('<div class="widget-header" />')

227 
funùiÚ
 
	`¡yË_ed™_fÜm
(
fÜm
) {

228 
fÜm
.
	`fšd
('šput[Çme=sd©e]').
	`d©•ick”
({
fÜm©
:'yyyy-mm-dd' , 
autoşo£
:
Œue
})

230 
fÜm
.
	`fšd
('šput[Çme=¡ock]').
	`addCÏss
('aû‡û-sw™ch‡û-sw™ch-5').
	`aá”
('<span class="lbl"></span>');

231 
v¬
 
bu‰Ús
 = 
fÜm
.
	`Ãxt
().
	`fšd
('.EditButton .fm-button');

232 
bu‰Ús
.
	`addCÏss
('bŠ bŠ-sm').
	`fšd
('[şass*="-icÚ"]').
	`hide
();

233 
bu‰Ús
.
	`eq
(0).
	`addCÏss
('bŠ-´im¬y').
	`´•’d
('<i class="ace-icon fa fa-check"></i>');

234 
bu‰Ús
.
	`eq
(1).
	`´•’d
('<i class="ace-icon fa fa-times"></i>')

236 
bu‰Ús
 = 
fÜm
.
	`Ãxt
().
	`fšd
('.navButton‡');

237 
bu‰Ús
.
	`fšd
('.ui-icÚ').
	`hide
();

238 
bu‰Ús
.
	`eq
(0).
	`­³nd
('<i class="ace-icon fa fa-chevron-left"></i>');

239 
bu‰Ús
.
	`eq
(1).
	`­³nd
('<i class="ace-icon fa fa-chevron-right"></i>');

242 
funùiÚ
 
	`¡yË_d–‘e_fÜm
(
fÜm
) {

243 
v¬
 
bu‰Ús
 = 
fÜm
.
	`Ãxt
().
	`fšd
('.EditButton .fm-button');

244 
bu‰Ús
.
	`addCÏss
('bŠ bŠ-sm bŠ-wh™bŠ-round').
	`fšd
('[şass*="-icÚ"]').
	`hide
();

245 
bu‰Ús
.
	`eq
(0).
	`addCÏss
('bŠ-dªg”').
	`´•’d
('<i class="ace-icon fa fa-trash-o"></i>');

246 
bu‰Ús
.
	`eq
(1).
	`addCÏss
('bŠ-deçuÉ').
	`´•’d
('<i class="ace-icon fa fa-times"></i>')

249 
funùiÚ
 
	`¡yË_£¬ch_f‹rs
(
fÜm
) {

250 
fÜm
.
	`fšd
('.d–‘e-ruË').
	`v®
('X');

251 
fÜm
.
	`fšd
('.add-ruË').
	`addCÏss
('btn btn-xs btn-primary');

252 
fÜm
.
	`fšd
('.add-group').
	`addCÏss
('btn btn-xs btn-success');

253 
fÜm
.
	`fšd
('.d–‘e-group').
	`addCÏss
('btn btn-xs btn-danger');

255 
funùiÚ
 
	`¡yË_£¬ch_fÜm
(
fÜm
) {

256 
v¬
 
dŸlog
 = 
fÜm
.
	`şo£¡
('.ui-jqdialog');

257 
v¬
 
bu‰Ús
 = 
dŸlog
.
	`fšd
('.EditTable')

258 
bu‰Ús
.
	`fšd
('.Ed™Bu‰Ú‡[id*="_»£t"]').
	`addCÏss
('bŠ bŠ-sm bŠ-šfo').fšd('.ui-icÚ').
	`©Œ
('class', 'ace-icon fa fa-retweet');

259 
bu‰Ús
.
	`fšd
('.Ed™Bu‰Ú‡[id*="_qu”y"]').
	`addCÏss
('bŠ bŠ-sm bŠ-šv”£').fšd('.ui-icÚ').
	`©Œ
('class', 'ace-icon fa fa-comment-o');

260 
bu‰Ús
.
	`fšd
('.Ed™Bu‰Ú‡[id*="_£¬ch"]').
	`addCÏss
('bŠ bŠ-sm bŠ-pu½Ë').fšd('.ui-icÚ').
	`©Œ
('class', 'ace-icon fa fa-search');

263 
funùiÚ
 
	`befÜeD–‘eC®lback
(
e
) {

264 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

265 
cÚsŞe
.
	`debug
(
fÜm
);

266 if(
fÜm
.
	`d©a
('¡yËd')è 
çl£
;

268 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ëb¬').
	`w¿pIÂ”
('<div class="widget-header" />')

269 
	`¡yË_d–‘e_fÜm
(
fÜm
);

271 
fÜm
.
	`d©a
('¡yËd', 
Œue
);

274 
funùiÚ
 
	`befÜeEd™C®lback
(
e
) {

275 
v¬
 
fÜm
 = 
	`$
(
e
[0]);

276 
fÜm
.
	`şo£¡
('.ui-jqdŸlog').
	`fšd
('.ui-jqdŸlog-t™Ëb¬').
	`w¿pIÂ”
('<div class="widget-header" />')

277 
	`¡yË_ed™_fÜm
(
fÜm
);

282 
funùiÚ
 
	`¡yËCheckbox
(
bË
) {

286 
funùiÚ
 
	`upd©eAùiÚIcÚs
(
bË
) {

289 
funùiÚ
 
	`upd©ePag”IcÚs
(
bË
) {

290 
v¬
 
»¶aûm’t
 =

297 
	`$
('.ui-pg-bË:nÙ(.ÇvbËè>body >¸> .ui-pg-bu‰Ú > .ui-icÚ').
	`—ch
(
	`funùiÚ
(){

298 
v¬
 
icÚ
 = 
	`$
(
this
);

299 
v¬
 
$şass
 = 
$
.
	`Œim
(
icÚ
.
	`©Œ
('şass').
	`»¶aû
('ui-icon', ''));

301 if(
$şass
 
š
 
»¶aûm’t
è
icÚ
.
	`©Œ
('class', 'ui-icon '+replacement[$class]);

305 
funùiÚ
 
	`’abËToŞts
(
bË
) {

306 
	`$
('.ÇvbË .ui-pg-bu‰Ú').
	`toŞt
({
cÚš”
:'body'});

307 
	`$
(
bË
).
	`fšd
('.ui-pg-div').
	`toŞt
({
cÚš”
:'body'});

309 
	`$
(
docum’t
).
	`Úe
('ajaxlßd¡¬t.·ge', 
	`funùiÚ
(
e
) {

310 
	`$
(
grid_£ËùÜ
).
	`jqGrid
('GridUnload');

311 
	`$
('.ui-jqdŸlog').
	`»move
();

313 
	}
}

314 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/object_list_view.php

1 <?
php
 
fÜ—ch
 (
$»s
 
as
 
$k
 => 
$v
) { ?>

2 <
div
 
şass
="widget-box" >

3 <
div
 
şass
="widget-header widget-header-flat">

4 <
h5
 
şass
="widg‘-t™Ë"><?
php
 
echo
 
$v
['LABEL']; ?></
	gh5
>

5 <!-- #£ùiÚ:
cu¡om
/
widg‘
-
box
.
toŞb¬
 -->

6 <
div
 
şass
="widget-toolbar">

7 <
a
 
h»f
="#" 
d©a
-
aùiÚ
="collapse">

8 <!--
i
 
şass
="ace-icon fa fa-chevron-up"></i-->

9 <
i
 
şass
="aû-icÚ f¨ç-¶us" 
d©a
-
icÚ
-
hide
="ç-mšus" d©a-icÚ-
show
="fa-plus"></i>

10 </
a
>

11 </
div
>

12 <
div
 
şass
="widget-toolbar‚o-border">

13 <
div
 
şass
="widget-menu">

14 <?
php
 if(
is£t
(
$v
['btn_action'])){?>

15 <?
php
 
fÜ—ch
 (
$v
['bŠ_aùiÚ']['bu‰Ús'] 
as
 
$bŠ_k
 => 
$bŠ_v
) {

16 ià(
is£t
(
$bŠ_v
['url'])) { ?>

17 <
a
 
d©a
-
aùiÚ
="settings">

18 <
i
 
id
="<?ph°echØ$v['REL_LIST_NAME'].'_but_'.$bŠ_k;?>_ajax_li¡s" 
şass
="aû-icÚ f¨ç-b¬s"><?
php
 
echo
 
$bŠ_v
['Çme'];?></
	gi
>

19 </
	ga
>

20 <
süt
 
	gty³
="text/javascript">

21 
$
("#<?ph°echØ$v['REL_LIST_NAME'].'_but_'.$bŠ_k;?>_ajax_li¡s").
şick
(
funùiÚ
(){

22 
v¬
 
id
 = <?
php
 
echo
 
$id
;?>;

23 
v¬
 
obj_ty³
 = <?
php
 
echo
 
$v
['OBJ_TYPE'];?>;

24 
v¬
 
u¾
 = "<?phpƒcho $btn_v['url'];?>";

25 
$DŸlogDivIDW
 = "DŸlogDiv" + 
$
(
this
).
©Œ
("id");

26 ià(
$
('#' + 
$DŸlogDivIDW
).
Ëngth
 == 0) {

27 
$
('#dŸlogdiv').
aá”
('<div id="' + 
$DŸlogDivIDW
 + '" style="display:none;"></div>');

30 
$
.
ajax
({

32 'sucûss': 
funùiÚ
 (
d©a
) {

33 
$
('#' + 
$DŸlogDivIDW
).
html
(
d©a
);

35 'u¾': 
u¾
,

36 'ÿche': 
çl£


38 
$
("#" + 
$DŸlogDivIDW
).
dŸlog
({

39 
t™Ë
: "<?phpƒcho $btn_v['name'];?>",

40 
mod®
: 
Œue
,

41 
width
: 900,

42 
height
: 600,

43 
bu‰Ús
:[{

44 
‹xt
:'ç¡®è®¤',

45 
CÏss
:"btn btn-primary",

46 
şick
: 
funùiÚ
(){

47 
v¬
 
¿dio
 = 
$
('#'+
$DŸlogDivIDW
).
fšd
('input[type=radio]:checked');

48 
v¬
 
¿dio_v®
 = 
¿dio
.
v®
();

49 
v¬
 
¿dio_Çme
 = 
¿dio
.
©Œ
("data-name");

51 
$
.
ajax
({

53 'd©a':{'id':
id
,'obj_ty³':
obj_ty³
,'»l_id':
¿dio_v®
},

54 'sucûss':
funùiÚ
(
d©a
){

55 
d©a
 = 
ev®
("("+data+")");

56 if(
d©a
.
»s
=='fail'){

57 
®”t
(
d©a
.
msg
);

59 
$
('#'+
$DŸlogDivIDW
).
dŸlog
("close");

60 
wšdow
.
loÿtiÚ
.
»¶aû
ÖoÿtiÚ.
h»f
);

64 
u¾
:'<?ph°echØ$bŠ_v['
§ve_u¾
'];?>'

70 
‹xt
:'å–æ¶ˆ',

71 
CÏss
:"btn btn-primary",

72 
şick
: 
funùiÚ
(){

73 
$
(
this
).
dŸlog
("close");

77 
$
('#' + 
$DŸlogDivIDW
).
dŸlog
('open');

80 </
	gsüt
>

81 <?
	gphp
 } { ?>

82 <
a
 
	gd©a
-
	gaùiÚ
="£‰šgs" 
d©a
-
toggË
="dropdown">

83 <
i
 
şass
="aû-icÚ f¨ç-b¬s"><?
php
 
echo
 
$bŠ_v
['Çme'];?></
	gi
>

84 </
	ga
>

85 <
ul
 
	gşass
="dropdown-menu dropdown-menu-right dropdown-light-blue dropdown-caret dropdown-closer">

86 <?
php
 
fÜ—ch
 (
$bŠ_v
['sub'] 
as
 
$sub_k
 => 
$sub_v
) {?>

87 <
li
>

88 <
a
 
id
="<?ph°echØ$v['REL_LIST_NAME'].'_sub_'.$sub_k;?>_ajax_add" 
d©a
-
toggË
="b" ><?
php
 
echo
 
$sub_v
['Çme'];?></
	ga
>

89 </
	gli
>

90 <
süt
 
	gty³
="text/javascript">

91 
$
("#<?ph°echØ$v['REL_LIST_NAME'].'_sub_'.$sub_k;?>_ajax_add").
şick
(
funùiÚ
(){

92 
v¬
 
id
 = <?
php
 
echo
 
$id
;?>;

93 
v¬
 
sobj_ty³
 = <?
php
 
echo
 
$v
['OBJ_TYPE'];?>;

94 
v¬
 
u¾
 = "<?phpƒcho $sub_v['url'];?>";

99 
$DŸlogDivIDM
 = "DŸlogDiv" + 
$
(
this
).
©Œ
("id");

100 ià(
$
('#' + 
$DŸlogDivIDM
).
Ëngth
 == 0) {

101 
$
('#dŸlogdiv').
aá”
('<div id="' + 
$DŸlogDivIDM
 + '" style="display:none;"></div>');

103 
$
.
ajax
({

105 'd©a': {'id':
id
,'sobj_ty³':
sobj_ty³
},

106 'sucûss': 
funùiÚ
 (
d©a
) {

108 
$
('#' + 
$DŸlogDivIDM
).
html
(
d©a
);

110 'u¾': 
u¾
,

111 'ÿche': 
çl£


113 
$
("#" + 
$DŸlogDivIDM
).
dŸlog
({

114 
t™Ë
: "æ–°å¢",

115 
mod®
: 
Œue
,

116 
width
: 1000,

117 
height
: 800,

120 
$
('#' + 
$DŸlogDivIDM
).
dŸlog
('open');

123 </
	gsüt
>

124 <?
	gphp
 } ?>

126 </
	gul
>

127 <?
	gphp
 } } ?>

128 <?
	gphp
 } ?>

130 </
	gdiv
>

131 <
a
 
	gh»f
="#" 
d©a
-
aùiÚ
="fuÎsü“n" 
şass
="orange2">

132 <
i
 
şass
="ace-icon fa fa-expand"></i>

133 </
a
>

134 <
a
 
h»f
="#" 
d©a
-
aùiÚ
="reload">

135 <
i
 
şass
="ace-icon fa fa-refresh"></i>

136 </
a
>

137 </
div
>

138 <!-- /
£ùiÚ
:
cu¡om
/
widg‘
-
box
.
toŞb¬
 -->

139 </
div
>

140 <
div
 
şass
="widget-body">

141 <
div
 
şass
="widget-main…adding-4">

142 <
div
 
şass
="my-cÚ‹Á" 
id
="<?phpƒcho $v['REL_LIST_NAME']; ?>-my-reluser-content">

143 </
div
>

145 </
div
>

146 </
div
>

147 </
div
>

148 <?
php
 } 
¦“p
(1); ?>

150 <
süt
 
	gty³
="text/javascript">

152 </
süt
>

155 <?
php
 
fÜ—ch
 (
$»s
 
as
 
$key
 => 
$v®ue
) { ?>

156 <
süt
 
ty³
="text/javascript">

157 
$
('#<?ph°echØ$v®ue['
REL_LIST_NAME
']; ?>-my-»lu£r-cÚ‹Á').
aû_süŞl
({

158 
hÜizÚl
: 
Œue
,

159 
size
: 1800,

162 }).
css
('padding-bottom', 15);

163 </
	gsüt
>

164 <
süt
 
	gty³
="text/javascript">

165 
v¬
 
·¿ms
 = <?
php
 
echo
 
jsÚ_’code
(
$v®ue
); ?>;

166 
v¬
 
	gu¾
 = '<?ph°echØs™e_u¾('
www
/
objeùs
/
ajax_v›w_li¡s
') . "?id=" . $id."&obj_type=".$obj_type ;?>'

168 
$
("#<?ph°echØ$v®ue['REL_LIST_NAME']; ?>-my-»lu£r-cÚ‹Á").
AjaxHtml
({

169 
U¾
: 
u¾
,

170 
D©a
: 
·¿ms


173 </
	gsüt
>

174 <?
	gphp
 } ?>

175 <
div
 
	gid
='dialogdiv'></div>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/recyc_staff.php

1 <
süt
 
	gty³
="text/javascript">

2 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

3 
	`$
("#assign_¡aff_sub3").
	`AjaxDŸlog
({

4 
DŸlogU¾
: "<?phpƒcho base_url()?>index.php/www/objects/recycling?sel=<?phpƒcho $ObjType; ?>"+"&obj_type=99&div_id=<?phpƒcho $div_id?>",

5 
DŸlogT™Ë
: "æ‰¹é‡å›æ”¶å‘˜å·¥",

6 
DŸlogWidth
: 800,

7 
DŸlogHeight
: 500});

8 
	`$
("#qx").
	`şick
(
	`funùiÚ
(){

9 
	`$
("#»cyşšg").
	`·»Á
().
	`dŸlog
('close');

11 
	}
});

12 </
	gsüt
>

13 <
div
 
	g¡yË
="width:100px;m¬gš-Ëá:‡uto;m¬gš-right:‡uto;m¬gš-tİ: 30px" 
id
="recycling">

14 <
div
>

15 <
div
><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="1">æ›´æ–°é€‰ä¸­è®°å½•</div>

16 <
div
 
¡yË
="m¬gš-tİ: 15px"><
šput
 
ty³
="¿dio" 
Çme
="upd©e" 
v®ue
="2">æ›´æ–°å½“å‰åˆ—è¡¨</div>

18 </
div
>

19 <
div
 
¡yË
="margin-top: 40px">

20 <
šput
 
v®ue
="ç¡®å®š" 
ty³
="bu‰Ú" 
id
="assign_staff_sub3">

21 <
šput
 
v®ue
="å–æ¶ˆ" 
ty³
="bu‰Ú" 
id
="qx">

22 </
div
>

23 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/recycling.php

1 <
div
 
	gşass
="<?phpƒcho $DialogID; ?>_ajax_page_content">

3 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

4 <
div
 
şass
="row">

6 <
div
 
şass
="col-xs-12">

7 <
bu‰Ú
 
id
='<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y' 
şass
="btn btn-primary">

8 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

10 </
bu‰Ú
>

11 <
bu‰Ú
 
id
="sub" 
şass
="btn btn-primary">

12 <
i
 
şass
="ace-icon fa fa-pencil‡lign-top bigger-125"></i>

14 </
bu‰Ú
>

15 <
süt
 
ty³
="text/javascript">

17 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

18 
v¬
 
£niÜqu”y_©Œ
 = <?
php
 
echo
 
$S’iÜQu”yA‰rJsÚ
; ?>;

19 
	`$
("#<?ph°echØ$DŸlogID; ?>_ajax_§Ë_£niÜqu”y").
	`S’iÜQu”y
({

20 
S–eùA‰r
: 
£niÜqu”y_©Œ
,

21 
Li¡U¾
: "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>",

22 
Li¡Div
: "#<?phpƒcho $DialogID; ?>_grid_table"

25 
	}
});

27 </
	gsüt
>

28 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

29 </
div
>

31 <
div
 
şass
="col-xs-12">

32 <!-- 
PAGE
 
CONTENT
 
BEGINS
 -->

33 <
div
 
id
=""></div>

34 <!-- 
PAGE
 
CONTENT
 
ENDS
 -->

35 </
div
><!-- /.
cŞ
 -->

36 </
div
><!-- /.
row
 -->

37 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

39 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

40 <
div
>

41 <
šput
 
ty³
="‹xt" 
Çme
="·ge_’d" 
id
="<?phpƒcho $DialogID; ?>page_end"/>

42 </
div
>

43 <
süt
 
ty³
="text/javascript">

44 
jQu”y
(
	$funùiÚ
 (
$
) {

45 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/objects/list_json?obj_type=<?phpƒcho $ObjType; ?>";

46 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

47 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

48 
	`$
("#<?ph°echØ$DŸlogID; ?>_grid_·g”").
	`L“TabË
({

49 
U¾
:
u¾
,

50 
CŞ
:
cŞ
,

51 
MuÉiS–eù
:
Œue
,

52 
MuÉiTy³
:0,

53 
KeyA‰rName
:
key©ŒÇme


57 
	`$
("#sub").
	`şick
(
	`funùiÚ
(){

58 
v¬
 
d©a
 = "";

59 
v¬
 
¿dio
 = 
	`$
('šput:¿dio[Çme=upd©e]:checked').
	`v®
();

61 if(
¿dio
 == "2") {

62 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

63 ià(
d©a
 == "") {

64 
d©a
 = 
	`$
(
this
).
	`v®
();

66 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

69 }ià(
¿dio
 == "1"){

70 
	`$
("#<?ph°echØ$div_id?> iÅut[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

71 ià(
d©a
 == "") {

72 
d©a
 = 
	`$
(
this
).
	`v®
();

74 
d©a
 = d©¨+ "," + 
	`$
(
this
).
	`v®
();

78 
d©a
 = d©a.
	`»¶aû
(/
Ú
,/, "");

79 
v¬
 
em¶oy“s
 = "";

80 
	`$
("#"+"<?ph°echØ$DŸlogID; ?>_grid_·g” iÅut[ty³=checkbox]:checked").
	`—ch
(
	`funùiÚ
 (
k
, 
v
) {

81 ià(
em¶oy“s
 == "") {

82 
em¶oy“s
 = 
	`$
(
this
).
	`v®
();

84 
em¶oy“s
 =ƒm¶oy“ + "," + 
	`$
(
this
).
	`v®
();

87 if(
d©a
.
Ëngth
 == 0){

88 
	`®”t
("è¯·é€‰æ‹©åˆ†é…æ•°æ®");

91 if(
em¶oy“s
.
Ëngth
 == 0){

92 
	`®”t
("è¯·é€‰æ‹©å‘˜å·¥æ•°æ®");

95 
cÚsŞe
.
	`log
(
d©a
);

96 
cÚsŞe
.
	`log
(
em¶oy“s
);

97 
$
.
	`ajax
({

98 
u¾
:"<?phpƒcho base_url(); ?>index.php/www/objects/del_rel_user?obj_type=<?phpƒcho $sel; ?>",

99 
ty³
:"post",

100 
d©a
:{
id
:d©a,
u£rs
:
em¶oy“s
},

101 
sucûss
:
	`funùiÚ
(
d©a
){

102 if(
d©a
 =="success"){

103 
	`®”t
("æ‰¹é‡æ›´æ–°æˆåŠŸ")

104 
wšdow
.
hi¡Üy
.
	`go
(0)

106 
	`®”t
("æ‰¹é‡æ›´æ–°å¤±è´¥")

115 
	}
});

118 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/view.php

1 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

2 <
div
 
şass
="main-content">

3 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

4 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

5 <
ul
 
şass
="breadcrumb">

6 <
li
>

7 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

8 <
a
 
h»f
="<?phpƒcho base_url();?>index.php/www">é¦–é¡µ</a>

9 </
li
>

10 <
li
 
şass
="aùive"><
a
 
h»f
="<?ph°echØba£_u¾();?>šdex.php/www/objeùs/li¡s?obj_ty³=<?ph°echØ$obj_ty³;?>"><?
php
 
echo
 
$diù
;?>åˆ—è¡¨</
	ga
></
	gli
>

11 <
	gli
><?
php
 
echo
 
	g$Ëad_d©a
[
$OBJ_NAME
.'.Name'];?></li>

12 </
	gul
><!-- /.
	gb»adüumb
 -->

13 <!-- /
	g£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

14 </
div
>

16 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

17 <
div
 
şass
="page-content">

18 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

19 <
div
 
şass
="page-header">

20 <
h1
>

21 <?
php
 
echo
 
$Ëad_d©a
[
$OBJ_NAME
.'.Name'];?>

23 </
	gh1
>

24 </
	gdiv
><!-- /.
	g·ge
-
	gh—d”
 -->

26 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g¡¬t
-->

27 <
div
 
	gşass
="row">

29 <
div
 
şass
="col-xs-12">

30 <
div
 
şass
="col-xs-12">

33 <?
php
 
fÜ—ch
(
$but_¬¿y
 
as
 
$k
=>
$v
){

34 ifĞ
$obj_ty³
 != 1 && $obj_type != 3){

35 if(
$k
 == 6 ||$k == 7 ){

39 if(
	g$Ëad_d©a
[
$OBJ_NAME
.".StopFlag"] == 1){

40 if(
$k
 == 6){

44 if(
	g$k
 == 7){

50 <
div
 
	gşass
="btn-group">

51 <
a
 
şass
="<?ph°echØ$v['cŞour'];?>" <?
php
 if(
is£t
(
$v
['id'])è{
echo
 "id=".$v['id'];}?> <?ph°if(is£t($v['u¾'])è{
	gecho
 "h»f=".
	g$v
['url'];}?> <?php if(isset($v['dropdown'])){echo 'data-toggle="dropdown"';}?>>

52 <
i
 
	gşass
="ace-icon <?phpƒcho $v['icon'];?>‡lign-top bigger-125"></i>

53 <?
php
 
echo
 
$v
['name'];?>

54 <?
php
 if(
is£t
(
$v
['dropdown'])){?>

55 <
¥ª
 
	gşass
="ace-icon fa fa-angle-down icon-only smaller-90"></span>

56 <?
php
 }?>

57 </
	ga
>

58 <?
php
 if(
is£t
(
$v
['dropdown'])){?>

59 <
ul
 
	gşass
="dropdown-menu dropdown-warning">

60 <?
php
 
fÜ—ch
(
$v
['drİdown'] 
as
 
$dk
=>
$dv
){?>

61 <
li
>

62 <
a
 <?
php
 if(
is£t
(
$dv
['u¾'])è{
echo
 "h»f=".$dv['u¾'];}?> <?ph°if(is£t($dv['id'])è{
	gecho
 "id=".
	g$dv
['id'];}?>>

63 <?
php
 
echo
 
	g$dv
["name"];?>

64 </
	ga
>

65 <?
php
 if(
is£t
(
$dv
['javascript'])){?>

66 <
süt
 
	gty³
="text/javascript">

67 <?
php
 
echo
 
$dv
['javascript'];?>

68 </
	gsüt
>

69 <?
	gphp
 }?>

70 </
	gli
>

71 <?
	gphp
 }?>

72 </
	gul
>

73 <?
	gphp
 }?>

74 </
	gdiv
>

75 <?
php
 if(
is£t
(
$v
['javascript'])){?>

76 <
süt
 
	gty³
="text/javascript">

77 <?
php
 
echo
 
$v
['javascript'];?>

78 </
	gsüt
>

79 <?
	gphp
 }?>

80 <?
	gphp
 }?>

81 <?
php
 if(
	$couÁ
(
$´iv©e_but
[
$OBJ_NAME
])){ ?>

82 <?
php
 
	`fÜ—ch
(
$´iv©e_but
[
$OBJ_NAME
] 
as
 
$k
=>
$v
){?>

83 <
div
 
şass
="btn-group">

84 <
a
 
şass
="<?ph°echØ$v['cŞour'];?>" <?
php
 if(
	`is£t
(
$v
['id'])è{
echo
 "id=".$v['id'];}?> <?php if(isset($v['url'])) {echo "href=".$v['url'];}?> <?php if(isset($v['dropdown'])){echo 'data-toggle="dropdown"';}?>>

85 <
i
 
şass
="ace-icon <?phpƒcho $v['icon'];?>‡lign-top bigger-125"></i>

86 <?
php
 
echo
 
$v
['name'];?>

87 <?
php
 if(
	`is£t
(
$v
['dropdown'])){?>

88 <
¥ª
 
şass
="ace-icon fa fa-angle-down icon-only smaller-90"></span>

89 <?
php
 }?>

90 </
a
>

91 <?
php
 if(
	`is£t
(
$v
['dropdown'])){?>

92 <
ul
 
şass
="dropdown-menu dropdown-warning">

93 <?
php
 
	`fÜ—ch
(
$v
['drİdown'] 
as
 
$dk
=>
$dv
){?>

94 <
li
>

95 <
a
 <?
php
 if(
	`is£t
(
$dv
['u¾'])è{
echo
 "href=".$dv['url'];}?> <?php if(isset($dv['id'])) {echo "id=".$dv['id'];}?>>

96 <?
php
 
echo
 
$dv
["name"];?>

97 </
a
>

98 <?
php
 if(
	`is£t
(
$dv
['javascript'])){?>

99 <
süt
 
ty³
="text/javascript">

100 <?
php
 
echo
 
$dv
['javascript'];?>

101 </
süt
>

102 <?
php
 }?>

103 </
li
>

104 <?
php
 }?>

105 </
ul
>

106 <?
php
 }?>

107 </
div
>

108 <?
php
 if(
	`is£t
(
$v
['javascript'])){?>

109 <
süt
 
ty³
="text/javascript">

110 <?
php
 
echo
 
$v
['javascript'];?>

111 </
süt
>

112 <?
php
 }?>

113 <?
php
 }?>

114 <?
php
 
	}
}?>

117 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

118 </
div
>

119 <
div
 
şass
="hr hr-dotted hr-16"></div>

120 </
div
>

122 <
div
 
id
="V›wFÜm©" 
şass
="cŞ-xs-12"></div><!-- /.
cŞ
 -->

123 <
süt
 
ty³
="text/javascript">

125 
$
(
docum’t
).
»ady
(
	$funùiÚ
 () {

126 
	`$
("#şues_što").
	`AjaxDŸlog
({

127 
DŸlogU¾
: "<?phpƒcho base_url(); ?>index.php/www/lead/leadConversion",

128 
DŸlogT™Ë
: "çº¿ç´¢è½¬åŒ–",

129 
DŸlogWidth
: 450,

130 
DŸlogHeight
: 406,

131 
DŸlogD©a
: {
id
:<?
php
 
echo
 
$this
->
šput
->
	`g‘
("id"è?>, 
obj_ty³
:<?phpƒcho $this->input->get("obj_type") ?>},

132 
DŸlogBu‰Ús
: [{

133 
‹xt
: "ç¡®å®š",

134 
CÏss
: "btn btn-primary",

135 
şick
: 
	`funùiÚ
 () {

136 
v¬
 
sub
 = 
Œue
;

137 ià(
	`$
("#šput_key_AccouÁ_OwÃr").
	`v®
().
Ëngth
 == 0) {

138 
sub
 = 
çl£
;

139 
	`®”t
("è¯·é€‰æ‹©å®¢æˆ·æ‰€æœ‰è€…");

142 ià(
	`$
("#cÚù").
	`´İ
("checked"è&& $("#šput_key_CÚù_OwÃr").
	`v®
().
Ëngth
 == 0) {

143 
sub
 = 
çl£
;

144 
	`®”t
("è¯·é€‰æ‹©è”ç³»äººæ‰€æœ‰è€…");

147 ià(
	`$
("#İpÜtun™y").
	`´İ
("checked"è&& $("#šput_key_OµÜtun™y_OwÃr").
	`v®
().
Ëngth
 == 0) {

148 
sub
 = 
çl£
;

149 
	`®”t
("è¯·é€‰æ‹©è”ç³»äººæ‰€æœ‰è€…");

152 ià(
sub
) {

155 
	`$
("#şuesIÁoD©a").
	`subm™
();

161 
v¬
 
fÜm©_d©a
 = <?
php
 
echo
 
	`jsÚ_’code
(
$fÜm©_d©a
); ?>;

162 
	`$
("#V›wFÜm©").
	`FÜm©
({

163 
ty³
: "view",

164 
FÜm©D©a
: 
fÜm©_d©a


166 
	}
});

167 </
	gsüt
>

168 </
	gdiv
><!-- /.
	grow
 -->

169 <
div
 
	gşass
="hr hr-dotted hr-16"></div>

170 <
div
 
id
="object_list_view"></div>

171 <
süt
 
ty³
="text/javascript">

172 
v¬
 
u¾
 = '<?ph°echØs™e_u¾('
www
/
objeùs
/
objeù_li¡_v›w
');?>'

173 
v¬
 
·¿ms
 = {
id
:'<?ph°echØ$Ëad_d©a[$moduË['
KEY_ATTR_NAME
']]?>',
obj_ty³
:'<?ph°echØ$obj_ty³;?>',
ty³_id
:'<?ph°echØ$Ëad_d©a[$moduË['
OBJ_NAME
'] . ".TypeID"]?>'};

174 
$
("#objeù_li¡_v›w").
AjaxHtml
({

175 
U¾
: 
u¾
,

176 
D©a
: 
·¿ms


178 </
	gsüt
>

184 <!--
	gËe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
	g’d
-->

185 </
	gdiv
><!-- /.
	g·ge
-
	gcÚ‹Á
 -->

188 </
	gdiv
><!-- /.
	gmaš
-
	gcÚ‹Á
 -->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/opportunity/phase_promotion.php

1 <
	g¡yË
>

3 </
	g¡yË
>

4 <
süt
 
	gty³
="text/javascript">

5 
$
(
	$funùiÚ
(){

6 
	`$
("#ÿnûl").
	`şick
(
	`funùiÚ
(){

7 
	`$
("#pha£").
	`·»Á
().
	`dŸlog
('close');

10 
	`$
('#´omÙiÚ iÅut[Çme="Ãw_¡age"]').
	`şick
(
	`funùiÚ
(){

11 
	`$
('šput[Çme="sucûss_hidd’"]').
	`v®
("0")

12 if(
	`$
("#sucûss").
	`´İ
("checked")){

13 
	`$
('šput[Çme="sucûss_hidd’"]').
	`v®
("1")

17 
	`$
("#sub").
	`şick
(
	`funùiÚ
(){

18 
v¬
 
r
 = 
	`$
('#´omÙiÚ iÅut[Çme="Ãw_¡age"]:checked').
	`v®
();

19 ifĞ
r
 =ğ
undefšed
 ){

20 
	`®”t
("è¯·é€‰æ‹©é˜¶æ®µç”³è¿çš„æ•°æ®");

22 
$
.
	`ajax
({

23 
ty³
:"post",

24 
u¾
:"<?phpƒcho base_url(); ?>index.php/www/opportunity/save_promotion_data",

25 
d©a
:
	`$
("#´omÙiÚ").
	`£rŸlize
(),

26 
sucûss
:
	`funùiÚ
(
d©a
){

27 if(
d©a
 == 1){

28 
	`®”t
("ç”³è¿æˆåŠŸ");

29 
	`$
("#pha£").
	`·»Á
().
	`dŸlog
('close');

30 
wšdow
.
hi¡Üy
.
	`go
(0)

32 
	`®”t
(
d©a
);

39 
	}
})

40 </
	gsüt
>

41 <
div
 
	g¡yË
="height: 100px;width:100px;m¬gš-Ëá:‡uto;m¬gš-right:‡uto" 
id
="phase">

42 <
fÜm
 
id
="promotion">

43 <
šput
 
ty³
="hidd’" 
v®ue
="<?ph°echØ$id ?>" 
Çme
="id">

44 <?
php


45 
fÜ—ch
(
$»s
 
as
 
$key
 => 
$v®ue
){

46 if(
$v®ue
["DATA_VALUE"] == "æˆåŠŸç»“æŸ"){

47 
echo
 '<špuˆty³="¿dio" id = "sucûss"‚ame="Ãw_¡age" v®ue="'.
$v®ue
["NEW_STAGE"].'"> <inputype="hidden"‚ame="success_hidden">'.$value["DATA_VALUE"].'<br /><br />';

49 
	gecho
 '<špuˆty³="¿dio"‚ame="Ãw_¡age" v®ue="'.
	g$v®ue
["NEW_STAGE"].'">'.$value["DATA_VALUE"].'<br /><br />';

54 </
	gfÜm
>

55 <
šput
 
	gty³
="bu‰Ú" 
v®ue
="æäº¤" 
id
="sub"><špuˆ
ty³
="button" value="å–æ¶ˆ" id="cancel">

56 </
div
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/announcement.php

1 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

2 <
div
 
şass
="main-content">

3 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

4 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

5 <
ul
 
şass
="breadcrumb">

6 <
li
>

7 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

8 <
a
 
h»f
="<?phpƒcho base_url(); ?>index.php/www/">é¦–é¡µ</a>

9 </
li
>

11 <
li
 
şass
="aùive"><?
php
 
echo
 
$obj
[1]['LABEL'] ?>å…¬å‘Šç®¡ç†</li>

12 </
ul
><!-- /.
b»adüumb
 -->

16 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

17 </
div
>

19 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

20 <
div
 
şass
="page-content">

21 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

22 <
div
 
şass
="page-header">

23 <
h1
>

24 <
sm®l
>

25 <
a
 
h»f
="#" 
id
="addAÂounûm’t" 
şass
="btn btn-purple btn-sm">å…¬å‘Šæ–°å¢</a>

26 </
sm®l
>

27 </
h1
>

28 </
div
><!-- /.
·ge
-
h—d”
 -->

31 <
div
 
şass
="row">

32 <
div
 
şass
="col-xs-12">

33 <!-- 
div
.
d©aTabËs_bÜd”W¿p
 -->

34 <
div
>

35 <
bË
 
id
="dyÇmic-bË" 
şass
="tableable-stripedable-borderedable-hover">

36 <
th—d
>

37 <
Œ
>

38 <
th
>å…¬å‘Šæ ‡é¢˜</th>

39 <
th
>å…¬å‘Šæ—¥æœŸ</th>

40 <
th
 
şass
="hidden-480">æ ‡ç­¾</th>

41 <
th
 
şass
="hidden-480">å…¬å‘ŠçŠ¶æ€</th>

42 <
th
>å…¬å‘Šå‘å¸ƒäºº</th>

43 <
th
>æ“ä½œ</th>

44 </
Œ
>

45 </
th—d
>

47 <
tbody
>

48 <?
php


49 
fÜ—ch
(
$ªnounûm’tD©a
 
as
 
$key
 => 
$ªnounûm’t
){

51 <
Œ
>

53 <
td
> <?
php
 
echo
 
$ªnounûm’t
['t™Ë'];?> </
	gtd
>

54 <
td
 
	gşass
="hidd’-480"> <?
php
 
echo
 
$ªnounûm’t
['ü—‹D©e'];?> </
	gtd
>

55 <
td
 
	gşass
="hidden-480">

56 <
¥ª
 
şass
="Ïb–†ab–-sm†ab–-w¬nšg"><?
php
 
echo
 
$ªnounûm’t
['g'];?> </
	g¥ª
>

57 </
	gtd
>

58 <
td
 
	gşass
="hidden-480">

59 <
¥ª
 
şass
="Ïb–†ab–-sm†ab–-w¬nšg"><?
php
 
echo
 't' ==ğ
$ªnounûm’t
['isStus'] ? 'å¼€å¯' : 'å…³é—­';?> </
	g¥ª
>

60 </
	gtd
>

61 <
td
 
	gşass
="hidden-480">

62 <
¥ª
 
şass
="Ïb–†ab–-sm†ab–-w¬nšg"><?
php
 
echo
 
$ªnounûm’t
['u£rName'];?> </
	g¥ª
>

63 </
	gtd
>

64 <
	gtd
>

65 <
div
 
	gşass
="hidden-sm hidden-xs‡ction-buttons">

66 <
a
 
Çme
="v›wAÂounûm’t" 
d©a
-
id
="<?ph°echØ$key;?>" 
şass
="blue" 
h»f
="#">

67 <
i
 
şass
="ace-icon fa fa-search-plus bigger-130"></i>

68 </
a
>

70 <
a
 
Çme
="ed™AÂounûm’t" 
d©a
-
id
="<?ph°echØ$key;?>" 
şass
="g»’" 
h»f
="#">

71 <
i
 
şass
="ace-icon fa fa-pencil bigger-130"></i>

72 </
a
>

74 <
a
 
Çme
="d–AÂounûm’t" 
d©a
-
id
="<?ph°echØ$key;?>" 
şass
="»d" 
h»f
="#">

75 <
i
 
şass
="ace-icon fa fa-trash-o bigger-130"></i>

76 </
a
>

77 </
div
>

79 </
td
>

80 </
Œ
>

84 </
	gtbody
>

85 </
	gbË
>

86 </
	gdiv
>

87 </
	gdiv
>

88 </
	gdiv
><!-- /.
	grow
 -->

89 <
div
 
	gid
="dŸlogAÂounûm’t" 
şass
="hide">

90 </
div
><!-- #dŸlog-
mes§ge
 -->

91 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

92 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

94 <
süt
 
ty³
="text/javascript">

95 
jQu”y
(
	$funùiÚ
(
$
) {

97 
v¬
 
oTabË1
 =

98 
	`$
('#dynamic-table')

99 .
	`d©aTabË
( {

100 
bAutoWidth
: 
çl£
,

103 
	`$
('[d©a-»l="toŞt"]').
	`toŞt
({
¶aûm’t
: 
toŞt_¶aûm’t
});

104 
funùiÚ
 
	`toŞt_¶aûm’t
(
cÚ‹xt
, 
sourû
) {

105 
v¬
 
$sourû
 = 
	`$
(
sourû
);

106 
v¬
 
$·»Á
 = 
$sourû
.
	`şo£¡
('table')

107 
v¬
 
off1
 = 
$·»Á
.
	`off£t
();

108 
v¬
 
w1
 = 
$·»Á
.
	`width
();

110 
v¬
 
off2
 = 
$sourû
.
	`off£t
();

113 ifĞ
	`·r£IÁ
(
off2
.
Ëá
è<…¬£IÁ(
off1
.Ëáè+…¬£IÁ(
w1
 / 2) )  'right';

117 
	`addAÂounûm’t
();

118 
	`ed™AÂounûm’t
();

119 
	`d–AÂounûm’t
();

120 
	`v›wAÂounûm’t
();

121 
	}
})

126 
funùiÚ
 
	$addAÂounûm’t
(){

127 
	`$
("#addAÂounûm’t").
	`Ú
("şick", 
	`funùiÚ
(){

128 
v¬
 
u¾
 = '<?ph°echØs™e_u¾('
www
/
ªnounûm’t
/
v›wAÂounûm’t
');?>';

129 
v¬
 
·¿ms
 = {};

130 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

131 
	`$
("#dŸlogAÂounûm’t").
	`html
(
d©a
);

132 }).
	`”rÜ
(
	`funùiÚ
(){

133 
	`$
("#dŸlogAÂounûm’t").
	`html
("ç½‘ç»œè¯·æ±‚å¤±è´¥");

135 
v¬
 
dŸlog
 = 
	`$
("#dŸlogAÂounûm’t").
	`»moveCÏss
('hide').
	`dŸlog
({

136 
mod®
: 
Œue
,

137 
autoO³n
: 
Œue
,

138 
width
: "auto",

139 
pos™iÚ
: { 
my
: "tİ", 
©
: "tİ", 
of
: 
wšdow
 },

140 
t™Ë
: "å…¬å‘Šæ“ä½œ",

141 
t™Ë_html
: 
Œue
,

142 
bu‰Ús
: [

144 
‹xt
: "Cancel",

146 
şick
: 
	`funùiÚ
() {

147 
	`$
("#v›wAÂounûm’t").
	`html
('');

148 
	`$
(
this
).
	`dŸlog
("close");

152 
‹xt
: "OK",

154 
şick
: 
	`funùiÚ
() {

155 
v¬
 
ªnounûm’tT™Ë
 = 
	`$
("#ªnounûm’tT™Ë").
	`v®
();

156 
v¬
 
ªnounûm’tTag
 = 
	`$
("#ªnounûm’tTag").
	`v®
();

157 
v¬
 
ªnounûm’tHtml
 = 
CKEDITOR
.
š¡ªûs
.
ed™Ü
.
	`g‘D©a
();

158 
v¬
 
ªnounûm’tPic
 = 
	`$
("#ªnounûm’tPic").
	`v®
();

159 
v¬
 
ªnounûm’tC»©eU£rName
 = 
	`$
("#ªnounûm’tC»©eU£rName").
	`v®
();

160 
v¬
 
u¾
 = '<?phpƒcho site_url("www/announcement/addAnnouncement");?>';

161 
v¬
 
·¿ms
 = {
ªnounûm’t_t™Ë
:
ªnounûm’tT™Ë
, 
ªnounûm’t_pic
:
ªnounûm’tPic
, 
ªnounûm’t_g
:
ªnounûm’tTag
, 
ªnounûm’t_html
:
ªnounûm’tHtml
, 
ªnounûm’t_ü—‹_u£r
:
ªnounûm’tC»©eU£rName
};

162 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

163 
cÚsŞe
.
	`debug
(
Œue
==
d©a
);

164 
cÚsŞe
.
	`debug
(
d©a
);

166 
cÚsŞe
.
	`debug
(
CKEDITOR
.
š¡ªûs
.
ed™Ü
.
	`g‘D©a
());

173 
	}
}

180 
funùiÚ
 
	$ed™AÂounûm’t
(){

181 
	`$
("a[Çme='ed™AÂounûm’t']").
	`Ú
("şick", 
	`funùiÚ
(){

182 
v¬
 
d©a_id
 = 
	`$
(
this
).
	`d©a
("id");

183 
v¬
 
u¾
 = '<?ph°echØs™e_u¾('
www
/
ªnounûm’t
/
v›wAÂounûm’t
');?>';

184 
v¬
 
·¿ms
 = {
ªnounûm’t_id
:
d©a_id
};

185 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

186 
	`$
("#dŸlogAÂounûm’t").
	`html
(
d©a
);

188 
v¬
 
dŸlog
 = 
	`$
("#dŸlogAÂounûm’t").
	`»moveCÏss
('hide').
	`dŸlog
({

189 
mod®
: 
Œue
,

190 
autoO³n
: 
Œue
,

191 
width
: "auto",

192 
pos™iÚ
: { 
my
: "tİ", 
©
: "tİ", 
of
: 
wšdow
 },

193 
t™Ë
: "å…¬å‘Šæ“ä½œ",

194 
t™Ë_html
: 
Œue
,

195 
bu‰Ús
: [

197 
‹xt
: "Cancel",

199 
şick
: 
	`funùiÚ
() {

200 
	`$
("#v›wAÂounûm’t").
	`html
('');

201 
	`$
(
this
).
	`dŸlog
("close");

205 
‹xt
: "OK",

207 
şick
: 
	`funùiÚ
() {

208 
v¬
 
ªnounûm’tID
 = 
d©a_id
;

209 
v¬
 
ªnounûm’tT™Ë
 = 
	`$
("#ªnounûm’tT™Ë").
	`v®
();

210 
v¬
 
ªnounûm’tTag
 = 
	`$
("#ªnounûm’tTag").
	`v®
();

211 
v¬
 
ªnounûm’tHtml
 = 
CKEDITOR
.
š¡ªûs
.
ed™Ü
.
	`g‘D©a
();

212 
v¬
 
ªnounûm’tPic
 = 
	`$
("#ªnounûm’tPic").
	`v®
();

213 
v¬
 
ªnounûm’tC»©eU£rName
 = 
	`$
("#ªnounûm’tC»©eU£rName").
	`v®
();

214 
v¬
 
u¾
 = '<?phpƒcho site_url("www/announcement/editAnnouncement");?>';

215 
v¬
 
·¿ms
 = {
ªnounûm’t_id
:
ªnounûm’tID
, 
ªnounûm’t_t™Ë
:
ªnounûm’tT™Ë
, 
ªnounûm’t_pic
:
ªnounûm’tPic
, 
ªnounûm’t_g
:
ªnounûm’tTag
, 
ªnounûm’t_html
:
ªnounûm’tHtml
,
ªnounûm’t_ü—‹_u£r
:
ªnounûm’tC»©eU£rName
};

216 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

217 
cÚsŞe
.
	`debug
(
Œue
==
d©a
);

218 
cÚsŞe
.
	`debug
(
d©a
);

226 
	}
}

233 
funùiÚ
 
	$d–AÂounûm’t
(){

234 
	`$
("a[Çme='d–AÂounûm’t']").
	`Ú
("şick", 
	`funùiÚ
(){

235 
v¬
 
d©a_id
 = 
	`$
(
this
).
	`d©a
("id");

236 
v¬
 
u¾
 = '<?ph°echØs™e_u¾('
www
/
ªnounûm’t
/
v›wAÂounûm’t
');?>';

237 
v¬
 
d©a
 = 'ç¡®è®¤è¦åˆ é™¤æ­¤æ¡å…¬å‘Šä¿¡æ¯å—?';

238 
	`$
("#dŸlogAÂounûm’t").
	`html
(
d©a
);

239 
v¬
 
dŸlog
 = 
	`$
("#dŸlogAÂounûm’t").
	`»moveCÏss
('hide').
	`dŸlog
({

240 
mod®
: 
Œue
,

241 
autoO³n
: 
Œue
,

242 
width
: "auto",

243 
pos™iÚ
: { 
my
: "tİ", 
©
: "tİ", 
of
: 
wšdow
 },

244 
t™Ë
: "å…¬å‘Šæ“ä½œ",

245 
t™Ë_html
: 
Œue
,

246 
bu‰Ús
: [

248 
‹xt
: "Cancel",

250 
şick
: 
	`funùiÚ
() {

251 
	`$
("#v›wAÂounûm’t").
	`html
('');

252 
	`$
(
this
).
	`dŸlog
("close");

256 
‹xt
: "OK",

258 
şick
: 
	`funùiÚ
() {

259 
v¬
 
ªnounûm’tID
 = 
d©a_id
;

260 
v¬
 
u¾
 = '<?phpƒcho site_url("www/announcement/delAnnouncement");?>';

261 
v¬
 
·¿ms
 = {
ªnounûm’t_id
:
ªnounûm’tID
};

262 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

263 
cÚsŞe
.
	`debug
(
Œue
==
d©a
);

264 
cÚsŞe
.
	`debug
(
d©a
);

266 
	`$
(
this
).
	`dŸlog
("close");

272 
	}
}

279 
funùiÚ
 
	$v›wAÂounûm’t
(){

280 
	`$
("a[Çme='v›wAÂounûm’t']").
	`Ú
("şick", 
	`funùiÚ
(){

281 
v¬
 
d©a_id
 = 
	`$
(
this
).
	`d©a
("id");

282 
v¬
 
u¾
 = '<?ph°echØs™e_u¾('
www
/
ªnounûm’t
/
»v›wAÂounûm’t
');?>';

283 
v¬
 
·¿ms
 = {
ªnounûm’t_id
:
d©a_id
};

284 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

285 
	`$
("#dŸlogAÂounûm’t").
	`html
(
d©a
);

287 
v¬
 
dŸlog
 = 
	`$
("#dŸlogAÂounûm’t").
	`»moveCÏss
('hide').
	`dŸlog
({

288 
mod®
: 
Œue
,

289 
autoO³n
: 
Œue
,

290 
width
: "auto",

291 
pos™iÚ
: { 
my
: "tİ", 
©
: "tİ", 
of
: 
wšdow
 },

292 
t™Ë
: "å…¬å‘Šæ“ä½œ",

293 
t™Ë_html
: 
Œue
,

294 
bu‰Ús
: [

296 
‹xt
: "Cancel",

298 
şick
: 
	`funùiÚ
() {

299 
	`$
("#v›wAÂounûm’t").
	`html
('');

300 
	`$
(
this
).
	`dŸlog
("close");

304 
‹xt
: "OK",

306 
şick
: 
	`funùiÚ
() {

307 
	`$
(
this
).
	`dŸlog
("close");

313 
	}
}

314 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/contacts.php

1 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

2 <
div
 
şass
="main-content">

3 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

4 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

5 <
ul
 
şass
="breadcrumb">

6 <
li
>

7 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

8 <
a
 
h»f
="<?phpƒcho base_url(); ?>index.php/www/">é¦–é¡µ</a>

9 </
li
>

11 <
li
 
şass
="aùive"><?
php
 
echo
 
$obj
[1]['LABEL'] ?>è”ç³»äººé€šè®¯å½•</li>

12 </
ul
><!-- /.
b»adüumb
 -->

16 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

17 </
div
>

19 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

20 <
div
 
şass
="page-content">

21 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

22 <
div
 
şass
="page-header">

23 <
h1
>

24 <
sm®l
>

25 <
div
 
şass
="btn-group">

26 <
bu‰Ú
 
d©a
-
toggË
="drİdown" 
şass
="btn btn-success btn-lg dropdown-toggle">

28 <
i
 
şass
="ace-icon fa fa-angle-down icon-on-right"></i>

29 </
bu‰Ú
>

31 <
ul
 
şass
="dropdown-menu dropdown-success dropdown-menu-right">

32 <
li
>

33 <
a
 
şass
="drİdown-impÜt" 
d©a
-
ty³
="­³nd" d©a-
İ”
="impÜt" 
h»f
="#">é€šè®¯å½•å¯¼å…¥(è¿½åŠ æ–¹å¼)</a>

34 </
li
>

36 <
li
>

37 <
a
 
şass
="drİdown-impÜt" 
d©a
-
ty³
="Œunÿt" d©a-
İ”
="impÜt" 
h»f
="#">é€šè®¯å½•å¯¼å…¥(è¦†ç›–æ–¹å¼)</a>

38 </
li
>

40 <
li
>

41 <
a
 
şass
="drİdown-add" 
d©a
-
ty³
="add" d©a-
İ”
="add" 
h»f
="#">æ–°å¢</a>

42 </
li
>

44 </
ul
>

45 </
div
><!-- /.
bŠ
-
group
 -->

46 </
sm®l
>

47 </
h1
>

48 </
div
><!-- /.
·ge
-
h—d”
 -->

51 <
div
 
şass
="row">

52 <
div
 
şass
="col-xs-12">

53 <!-- 
div
.
d©aTabËs_bÜd”W¿p
 -->

54 <
div
>

55 <
bË
 
id
="dyÇmic-bË" 
şass
="tableable-stripedable-borderedable-hover">

56 <
th—d
>

57 <
Œ
>

58 <
th
>å·¥å·</th>

59 <
th
>å§“å</th>

60 <
th
 
şass
="hidden-480">æ‰‹æœºå·ç </th>

61 <
th
 
şass
="hidden-480">åæœºå·ç </th>

62 </
Œ
>

63 </
th—d
>

65 <
tbody
>

66 <?
php


67 
fÜ—ch
(
$cÚÁsD©a
 
as
 
$key
 => 
$cÚÁs
){

69 <
Œ
>

71 <
td
> <?
php
 
echo
 
$cÚÁs
['cÚÁs_u£r_gÚghao'];?> </
	gtd
>

72 <
td
 
	gşass
="hidd’-480"> <?
php
 
echo
 
$cÚÁs
['cÚÁs_Çme'];?> </
	gtd
>

73 <
td
 
	gşass
="hidden-480">

74 <
¥ª
 
şass
="Ïb–†ab–-sm†ab–-w¬nšg"><?
php
 
echo
 
$cÚÁs
['cÚÁs_phÚe'];?> </
	g¥ª
>

75 </
	gtd
>

76 <
td
 
	gşass
="hidden-480">

77 <
¥ª
 
şass
="Ïb–†ab–-sm†ab–-w¬nšg"><?
php
 
echo
 
$cÚÁs
['cÚÁs_‹l'];?> </
	g¥ª
>

78 </
	gtd
>

79 </
	gŒ
>

83 </
	gtbody
>

84 </
	gbË
>

85 </
	gdiv
>

86 </
	gdiv
>

87 </
	gdiv
><!-- /.
	grow
 -->

88 <
div
 
	gid
="dŸlogCÚÁs" 
şass
="hide">

89 </
div
><!-- #dŸlog-
mes§ge
 -->

90 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

91 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

93 <
süt
 
ty³
="text/javascript">

94 
jQu”y
(
	$funùiÚ
(
$
) {

96 
v¬
 
oTabË1
 =

97 
	`$
('#dynamic-table')

98 .
	`d©aTabË
( {

99 
bAutoWidth
: 
çl£
,

102 
	`$
('[d©a-»l="toŞt"]').
	`toŞt
({
¶aûm’t
: 
toŞt_¶aûm’t
});

103 
funùiÚ
 
	`toŞt_¶aûm’t
(
cÚ‹xt
, 
sourû
) {

104 
v¬
 
$sourû
 = 
	`$
(
sourû
);

105 
v¬
 
$·»Á
 = 
$sourû
.
	`şo£¡
('table')

106 
v¬
 
off1
 = 
$·»Á
.
	`off£t
();

107 
v¬
 
w1
 = 
$·»Á
.
	`width
();

109 
v¬
 
off2
 = 
$sourû
.
	`off£t
();

112 ifĞ
	`·r£IÁ
(
off2
.
Ëá
è<…¬£IÁ(
off1
.Ëáè+…¬£IÁ(
w1
 / 2) )  'right';

116 
	`addCÚÁs
();

117 
	`impÜtCÚÁs
();

118 
	}
});

126 
funùiÚ
 
	$impÜtCÚÁs
(){

127 
	`$
("a[şass='drİdown-impÜt']").
	`Ú
("şick", 
	`funùiÚ
(){

128 
v¬
 
d©a_ty³
 = 
	`$
(
this
).
	`d©a
("type");

129 
v¬
 
d©a_İ”
 = 
	`$
(
this
).
	`d©a
("oper");

130 
v¬
 
u¾
 = '<?ph°echØba£_u¾();?>šdex.php' + 
CONFIG
.
cÚÁ
.
impÜtCÚÁ
;

131 
v¬
 
impÜtU¾
 = '<?ph°echØba£_u¾();?>šdex.php' + 
CONFIG
.
cÚÁ
.
impÜtCÚÁAùiÚ
;

132 
v¬
 
·¿ms
 = {
İ”
:
d©a_ty³
};

133 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

134 
	`$
("#dŸlogCÚÁs").
	`html
(
d©a
);

136 
v¬
 
dŸlog
 = 
	`$
("#dŸlogCÚÁs").
	`»moveCÏss
('hide').
	`dŸlog
({

137 
mod®
: 
Œue
,

138 
autoO³n
: 
Œue
,

139 
width
: "auto",

140 
pos™iÚ
: { 
my
: "tİ", 
©
: "tİ", 
of
: 
wšdow
 },

141 
t™Ë
: "é€šè®¯å½•æ“ä½œ",

142 
t™Ë_html
: 
Œue
,

143 
bu‰Ús
: [

145 
‹xt
: "Cancel",

147 
şick
: 
	`funùiÚ
() {

148 
	`$
("#dŸlogCÚÁs").
	`html
('');

149 
	`$
(
this
).
	`dŸlog
("close");

153 
‹xt
: "OK",

155 
şick
: 
	`funùiÚ
() {

162 
	}
}

169 
funùiÚ
 
	$addCÚÁs
(){

170 
	`$
("a[şass='drİdown-add']").
	`Ú
("şick", 
	`funùiÚ
(){

171 
v¬
 
d©a_ty³
 = 
	`$
(
this
).
	`d©a
("type");

172 
v¬
 
d©a_add
 = 
	`$
(
this
).
	`d©a
("oper");

173 
v¬
 
u¾
 = '<?ph°echØba£_u¾();?>šdex.php' + 
CONFIG
.
cÚÁ
.
addCÚÁ
;

174 
v¬
 
addU¾
 = '<?ph°echØba£_u¾();?>šdex.php' + 
CONFIG
.
cÚÁ
.
addV›wAùiÚ
;

175 
v¬
 
·¿ms
 = {};

176 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

177 
	`$
("#dŸlogCÚÁs").
	`html
(
d©a
);

179 
v¬
 
dŸlog
 = 
	`$
("#dŸlogCÚÁs").
	`»moveCÏss
('hide').
	`dŸlog
({

180 
mod®
: 
Œue
,

181 
autoO³n
: 
Œue
,

182 
width
: "auto",

183 
pos™iÚ
: { 
my
: "tİ", 
©
: "tİ", 
of
: 
wšdow
 },

184 
t™Ë
: "é€šè®¯å½•æ“ä½œ",

185 
t™Ë_html
: 
Œue
,

186 
bu‰Ús
: [

188 
‹xt
: "Cancel",

190 
şick
: 
	`funùiÚ
() {

191 
	`$
("#dŸlogCÚÁs").
	`html
('');

192 
	`$
(
this
).
	`dŸlog
("close");

196 
‹xt
: "OK",

198 
şick
: 
	`funùiÚ
() {

199 
v¬
 
phÚeNumb”
 = 
$
.
	`Œim
(
	`$
("#phÚeNumb”").
	`v®
());

200 
v¬
 
‹lPhÚeNumb”
 = 
$
.
	`Œim
(
	`$
("#‹lPhÚeNumb”").
	`v®
());

201 
v¬
 
Çme
 = 
$
.
	`Œim
(
	`$
("#cÚÁsName").
	`v®
());

202 
v¬
 
gÚghao
 = 
$
.
	`Œim
(
	`$
("#cÚÁsGÚghao").
	`v®
());

203 
cÚsŞe
.
	`debug
(
phÚeNumb”
, 
‹lPhÚeNumb”
, 
Çme
, 
gÚghao
);

205 if("" =ğ
phÚeNumb”
){

206 
	`®”t
("æ‰‹æœºå·ç ä¸èƒ½ä¸ºç©º");

207  
çl£
;

209 if("" =ğ
‹lPhÚeNumb”
){

210 
	`®”t
("å›ºå®šå·ç ä¸ä¸ºç©º");

211  
çl£
;

213 if("" =ğ
Çme
){

214 
	`®”t
("å§“åä¸èƒ½ä¸ºç©º");

215  
çl£
;

217 if("" =ğ
gÚghao
){

218 
	`®”t
("å·¥å·ä¸èƒ½ä¸ºç©º");

219  
çl£
;

221 if(
	`isNaN
(
gÚghao
)){

222 
	`®”t
("æ‰‹æœºå·ç é”™è¯¯");

223  
çl£
;

225 if(!
	`checkPhÚe
(
phÚeNumb”
)){

226 
	`®”t
("æ‰‹æœºå·ç é”™è¯¯");

227  
çl£
;

229 if(!
	`checkT–PhÚe
(
‹lPhÚeNumb”
)){

230 
	`®”t
("å›ºå®šç”µè¯å·ç é”™è¯¯");

231  
çl£
;

233 
v¬
 
addP¬ams
 = {
gÚghao
 : gÚghao, 
phÚe
 : 
phÚeNumb”
, 
‹l
 : 
‹lPhÚeNumb”
, 
Çme
 :‚ame};

234 
$
.
	`po¡
(
addU¾
, 
addP¬ams
, 
	`funùiÚ
(
d©a
){

235 
cÚsŞe
.
	`debug
(
d©a
);

243 
	}
}

252 
funùiÚ
 
	$checkPhÚe
(
v
){

253 
v¬
 
isMob
=/^((\+?86)|(\(\+86\)))?(13[012356789][0-9]{8}|15[012356789][0-9]{8}|18[02356789][0-9]{8}|147[0-9]{8}|1349[0-9]{7})
$
/;

254 if(
isMob
.
	`‹¡
(
v
)){

255  
Œue
;

257  
çl£
;

259 
	}
}

268 
funùiÚ
 
	$checkT–PhÚe
(
v
){

269 
v¬
 
isPhÚe
 = /^([0-9]{3,4}-)?[0-9]{7,8}
$
/;

270 if(
isPhÚe
.
	`‹¡
(
v
)){

271  
Œue
;

273  
çl£
;

275 
	}
}

276 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/expressManager.php

1 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

2 <
div
 
şass
="main-content">

3 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

4 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

5 <
ul
 
şass
="breadcrumb">

6 <
li
>

7 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

8 <
a
 
h»f
="<?phpƒcho base_url(); ?>index.php/www/">é¦–é¡µ</a>

9 </
li
>

11 <
li
 
şass
="active">å¿«ä»¶ç®¡ç†</li>

12 </
ul
><!-- /.
b»adüumb
 -->

16 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

17 </
div
>

19 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

20 <
div
 
şass
="page-content">

21 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

22 <
div
 
şass
="page-header">

23 <
h1
>

24 </
h1
>

25 </
div
><!-- /.
·ge
-
h—d”
 -->

28 <
div
 
şass
="row">

29 <
div
 
şass
="col-xs-12">

30 <!-- 
div
.
d©aTabËs_bÜd”W¿p
 -->

31 <
div
>

32 <
bË
 
id
="dyÇmic-bË" 
şass
="tableable-stripedable-borderedable-hover">

33 <
th—d
>

34 <
Œ
>

35 <
th
>ç”¨æˆ·å§“å</th>

36 <
th
>ç”¨æˆ·æ‰‹æœºå·ç </th>

37 <
th
 
şass
="hidden-480">é‚®ç®±</th>

38 <
th
>æ“ä½œ</th>

39 </
Œ
>

40 </
th—d
>

42 <
tbody
>

43 <?
php


44 
fÜ—ch
(
$ex´essLi¡U£rs
 
as
 
$key
 => 
$li¡U£rs
){

46 <
Œ
>

48 <
td
> <?
php
 
echo
 
$li¡U£rs
->
u£r_Çme
;?> </
	gtd
>

49 <
	gtd
> <?
php
 
echo
 
	g$li¡U£rs
->
	gu£r_duty_Çme
;?> </td>

50 <
td
 
	gşass
="hidden-480">

51 <
¥ª
 
şass
="Ïb–†ab–-sm†ab–-w¬nšg"><?
php
 
echo
 
$li¡U£rs
->
u£r_ema
;?> </
	g¥ª
>

52 </
	gtd
>

53 <
	gtd
>

54 <
div
 
	gşass
="hidden-sm hidden-xs‡ction-buttons">

55 <
a
 
Çme
="v›wEx´essD‘a" 
d©a
-
id
="<?ph°echØ$li¡U£rs->u£r_id;?>" 
şass
="blue" 
h»f
="#">

56 <
i
 
şass
="ace-icon fa fa-search-plus bigger-130"></i>

57 </
a
>

58 <
a
 
Çme
="keEx´essU£r" 
d©a
-
id
="<?ph°echØ$li¡U£rs->u£r_id;?>" 
şass
="blue" 
h»f
="#">

59 <
i
 
şass
="ace-icon fa fa-flag bigger-120"></i>

60 </
a
>

61 </
div
>

64 </
td
>

65 </
Œ
>

69 </
	gtbody
>

70 </
	gbË
>

71 </
	gdiv
>

72 </
	gdiv
>

73 </
	gdiv
><!-- /.
	grow
 -->

74 <
div
 
	gid
="dŸlogEx´essD‘a" 
şass
="hide">

75 </
div
><!-- #dŸlog-
mes§ge
 -->

76 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

77 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

79 <
süt
 
ty³
="text/javascript">

80 
jQu”y
(
	$funùiÚ
(
$
) {

82 
v¬
 
oTabË1
 =

83 
	`$
('#dynamic-table')

84 .
	`d©aTabË
( {

85 
bAutoWidth
: 
çl£
,

88 
	`$
('[d©a-»l="toŞt"]').
	`toŞt
({
¶aûm’t
: 
toŞt_¶aûm’t
});

89 
funùiÚ
 
	`toŞt_¶aûm’t
(
cÚ‹xt
, 
sourû
) {

90 
v¬
 
$sourû
 = 
	`$
(
sourû
);

91 
v¬
 
$·»Á
 = 
$sourû
.
	`şo£¡
('table')

92 
v¬
 
off1
 = 
$·»Á
.
	`off£t
();

93 
v¬
 
w1
 = 
$·»Á
.
	`width
();

95 
v¬
 
off2
 = 
$sourû
.
	`off£t
();

98 ifĞ
	`·r£IÁ
(
off2
.
Ëá
è<…¬£IÁ(
off1
.Ëáè+…¬£IÁ(
w1
 / 2) )  'right';

102 
	`v›wEx´essD‘a
();

103 
	`keEx´ess
();

104 
	}
});

106 
funùiÚ
 
	$keEx´ess
(){

107 
	`$
("a[Çme='keEx´essU£r']").
	`Ú
("şick", 
	`funùiÚ
(){

108 
v¬
 
d©a_id
 = 
	`$
(
this
).
	`d©a
("id");

109 
v¬
 
u¾
 = '<?ph°echØs™e_u¾('
www
/
ex´ess
/
ex´essTakeD‘aAùiÚ
');?>';

110 
v¬
 
·¿ms
 = {
keU£rID
:
d©a_id
};

111 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

112 
cÚsŞe
.
	`debug
(
d©a
)

115 
	}
}

119 
funùiÚ
 
	$v›wEx´essD‘a
(){

120 
	`$
("a[Çme='v›wEx´essD‘a']").
	`Ú
("şick", 
	`funùiÚ
(){

121 
v¬
 
d©a_id
 = 
	`$
(
this
).
	`d©a
("id");

122 
v¬
 
u¾
 = '<?ph°echØs™e_u¾('
www
/
ex´ess
/
ex´essTakeD‘aAùiÚ
');?>';

123 
v¬
 
·¿ms
 = {
u£rID
:
d©a_id
};

124 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

125 
	`$
("#dŸlogEx´essD‘a").
	`html
(
d©a
);

127 
v¬
 
dŸlog
 = 
	`$
("#dŸlogEx´essD‘a").
	`»moveCÏss
('hide').
	`dŸlog
({

128 
mod®
: 
Œue
,

129 
autoO³n
: 
Œue
,

130 
width
: "auto",

131 
pos™iÚ
: { 
my
: "tİ", 
©
: "tİ", 
of
: 
wšdow
 },

132 
t™Ë
: "å¿«ä»¶æ“ä½œ",

133 
t™Ë_html
: 
Œue
,

134 
bu‰Ús
: [

136 
‹xt
: "Cancel",

138 
şick
: 
	`funùiÚ
() {

139 
	`$
("#dŸlogEx´essD‘a").
	`html
('');

140 
	`$
(
this
).
	`dŸlog
("close");

144 
‹xt
: "OK",

146 
şick
: 
	`funùiÚ
() {

147 
	`$
(
this
).
	`dŸlog
("close");

153 
	}
}

154 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/images.php

1 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

2 <
div
 
şass
="main-content">

3 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

4 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

5 <
ul
 
şass
="breadcrumb">

6 <
li
>

7 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

8 <
a
 
h»f
="<?phpƒcho base_url(); ?>index.php/www/">é¦–é¡µ</a>

9 </
li
>

11 <
li
 
şass
="aùive"><?
php
 
echo
 
$obj
[1]['LABEL'] ?>åˆ—è¡¨</li>

12 </
ul
><!-- /.
b»adüumb
 -->

16 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

17 </
div
>

19 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

20 <
div
 
şass
="page-content">

21 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

22 <
div
 
şass
="page-header">

23 <
h1
>

24 <
sm®l
>

25 <
a
 
h»f
="#" 
id
="muÉife" 
şass
="btn btn-purple btn-sm">æ‰¹é‡ä¸Šä¼ </a>

26 <
div
 
id
="muÉife-mes§ge" 
şass
="hide">

27 </
div
><!-- #dŸlog-
mes§ge
 -->

28 </
sm®l
>

29 </
h1
>

30 </
div
><!-- /.
·ge
-
h—d”
 -->

33 <
div
 
şass
="row">

34 <
div
 
şass
="col-xs-12">

35 <!-- 
PAGE
 
CONTENT
 
BEGINS
 -->

36 <
div
>

37 <
ul
 
şass
="ace-thumbnails clearfix">

38 <?
php
 
fÜ—ch
(
$d©a
 
as
 
$key
 => 
$v®ue
){?>

39 <
li
>

40 <
a
 
h»f
="<?ph°echØ$v®ue['bªÃr_pic'];?>" 
d©a
-
»l
="colorbox">

41 <
img
 
width
="150" 
height
="150" 
®t
="150x150" 
¤c
="<?phpƒcho $value['banner_pic'];?>" />

42 <
div
 
şass
="text">

43 <
div
 
şass
="inner">å›¾ç‰‡ç®¡ç†</div>

44 </
div
>

45 </
a
>

47 <
div
 
şass
="toolsools-bottom">

48 <
a
 
h»f
="#" 
Çme
="pÜlImage" 
id
="<?phpƒcho $value['banner_id'];?>">

49 <
i
 
şass
="ace-icon fa fa-times„ed"></i>

50 </
a
>

51 </
div
>

52 </
li
>

54 <?
php
 }?>

55 </
ul
>

56 </
div
><!-- 
PAGE
 
CONTENT
 
ENDS
 -->

57 </
div
><!-- /.
cŞ
 -->

58 </
div
><!-- /.
row
 -->

59 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

60 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

63 <!-- 
šlše
 
süts
 
»Ï‹d
 
to
 
this
 
·ge
 -->

64 <
süt
 
ty³
="text/javascript">

65 
jQu”y
(
	$funùiÚ
(
$
) {

66 
	`$
("a[Çme='pÜlImage']").
	`Ú
("şick", 
	`funùiÚ
(){

67 
v¬
 
pÜlId
 = 
this
.
id
;

68 
v¬
 
pÜlU¾D–
 = '<?ph°echØs™e_u¾('
www
/
bªÃr
/
d–BªÃr
');?>';

69 
v¬
 
pÜlP¬ams
 = {
pÜlId
:portalId};

70 
$
.
	`po¡
(
pÜlU¾D–
, 
pÜlP¬ams
, 
	`funùiÚ
(
d©a
){

71 if(
d©a
){

72 
wšdow
.
loÿtiÚ
.
h»f
 = '<?ph°echØs™e_u¾('
www
/
bªÃr
/
images
');?>';

74 
	`®”t
("åˆ é™¤å¤±è´¥ï¼Œè¯·è”ç³»ç®¡ç†å‘˜");

76 }).
	`”rÜ
(
	`funùiÚ
(){

77 
	`®”t
("å‡ºé”™äº†ï¼");

80 
	`$
Ğ"#muÉife" ).
	`Ú
('şick', 
	`funùiÚ
(
e
) {

81 
e
.
	`´ev’tDeçuÉ
();

82 
v¬
 
u¾
 = '<?phpƒcho site_url("www/banner/multifile");?>';

83 
v¬
 
·¿ms
 = {};

84 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

85 
	`$
("#muÉife-mes§ge").
	`html
(
d©a
);

88 
v¬
 
dŸlog
 = 
	`$
Ğ"#muÉife-mes§ge" ).
	`»moveCÏss
('hide').
	`dŸlog
({

89 
mod®
: 
Œue
,

90 
autoO³n
: 
Œue
,

91 
width
: "auto",

92 
pos™iÚ
: { 
my
: "tİ", 
©
: "tİ", 
of
: 
wšdow
 },

93 
t™Ë
: "å›¾ç‰‡ä¸Šä¼ ",

94 
t™Ë_html
: 
Œue
,

95 
bu‰Ús
: [

97 
‹xt
: "Cancel",

99 
şick
: 
	`funùiÚ
() {

100 
	`$
Ğ
this
 ).
	`dŸlog
( "close" );

104 
‹xt
: "OK",

106 
şick
: 
	`funùiÚ
() {

107 
	`$
Ğ
this
 ).
	`dŸlog
( "close" );

119 
v¬
 
$ov”æow
 = '';

120 
v¬
 
cŞÜbox_·¿ms
 = {

121 
»l
: 'colorbox',

122 
»pos™iÚ
:
Œue
,

123 
sÿËPhÙos
:
Œue
,

124 
süŞlšg
:
çl£
,

125 
´evious
:'<i class="ace-icon fa fa-arrow-left"></i>',

126 
Ãxt
:'<i class="ace-icon fa fa-arrow-right"></i>',

127 
şo£
:'&times;',

128 
cu¼’t
:'{current} of {total}',

129 
maxWidth
:'100%',

130 
maxHeight
:'100%',

131 
ÚO³n
:
	`funùiÚ
(){

132 
$ov”æow
 = 
docum’t
.
body
.
¡yË
.
ov”æow
;

133 
docum’t
.
body
.
¡yË
.
ov”æow
 = 'hidden';

135 
ÚClo£d
:
	`funùiÚ
(){

136 
docum’t
.
body
.
¡yË
.
ov”æow
 = 
$ov”æow
;

138 
ÚCom¶‘e
:
	`funùiÚ
(){

139 
$
.
cŞÜbox
.
	`»size
();

143 
	`$
('.aû-thumbÇ [d©a-»l="cŞÜbox"]').
	`cŞÜbox
(
cŞÜbox_·¿ms
);

144 
	`$
("#cboxLßdšgG¿phic").
	`html
("<i class='ace-icon fa fa-spinner orange fa-spin'></i>");

147 
	`$
(
docum’t
).
	`Úe
('ajaxlßd¡¬t.·ge', 
	`funùiÚ
(
e
) {

148 
	`$
('#cŞÜbox, #cboxOv”Ïy').
	`»move
();

150 
	}
})

151 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/info.php

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/reviewAnnouncement.php

2 <
div
 
	gşass
="row">

3 <
div
 
şass
="col-xs-12">

4 <!-- 
PAGE
 
CONTENT
 
BEGINS
 -->

5 <
fÜm
 
şass
="fÜm-hÜizÚl" 
rŞe
="form">

7 <
div
 
şass
="form-group">

8 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right" ="form-field-1-1"> æ ‡é¢˜ </label>

10 <
div
 
şass
="col-sm-9">

11 <?
php
 
echo
 
$ªnounûm’tD©a
[
$ªnounûm’tID
]['title'];?>

12 </
	gdiv
>

13 </
	gdiv
>

15 <
div
 
	gşass
="space-4"></div>

16 <
div
 
şass
="form-group">

17 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right">å‘å¸ƒäºº</label>

19 <
div
 
şass
="col-sm-9">

20 <
¥ª
 
şass
="col-sm-9">

21 <?
php
 
echo
 
$ªnounûm’tD©a
[
$ªnounûm’tID
]['userName'];?>

22 </
	g¥ª
>

24 </
	gdiv
>

25 </
	gdiv
>

27 <
div
 
	gşass
="space-4"></div>

28 <
div
 
şass
="form-group">

29 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right">æ ‡ç­¾</label>

31 <
div
 
şass
="col-sm-9">

32 <
¥ª
 
şass
="input-icon">

33 <?
php
 
echo
 
$ªnounûm’tD©a
[
$ªnounûm’tID
]['tag'];?>

34 </
	g¥ª
>

36 </
	gdiv
>

37 </
	gdiv
>

39 <
div
 
	gşass
="space-4"></div>

41 <
div
 
şass
="form-group">

42 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right" ="form-field-tags">å…¬å‘Šå†…å®¹</label>

44 <
div
 
şass
="col-sm-9">

45 <
div
 
id
="editor">

46 <?
php
 
echo
 
$ªnounûm’tD©a
[
$ªnounûm’tID
]['htmlPath'];?>

47 </
	gdiv
>

48 </
	gdiv
>

49 </
	gdiv
>

50 </
	gdiv
>

51 </
	gdiv
><!-- /.
	gmaš
-
	gcÚš”
 -->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/system.php

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/viewAnnouncement.php

2 <
div
 
	gşass
="row">

3 <
div
 
şass
="col-xs-12">

4 <!-- 
PAGE
 
CONTENT
 
BEGINS
 -->

5 <
fÜm
 
şass
="fÜm-hÜizÚl" 
rŞe
="form">

7 <
div
 
şass
="form-group">

8 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right" ="form-field-1-1"> æ ‡é¢˜ </label>

10 <
div
 
şass
="col-sm-9">

11 <
šput
 
ty³
="‹xt" 
id
="ªnounûm’tT™Ë" 
¶aûhŞd”
="æ ‡é¢˜" 
şass
="fÜm-cÚŒŞ" 
v®ue
="<?phpƒcho $announcementData[$announcementID]['title'];?>" />

12 </
div
>

13 </
div
>

15 <
div
 
şass
="space-4"></div>

16 <
div
 
şass
="form-group">

17 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right">æ ‡ç­¾</label>

19 <
div
 
şass
="col-sm-9">

20 <
¥ª
 
şass
="input-icon">

21 <
šput
 
ty³
="‹xt" 
id
="ªnounûm’tTag" 
v®ue
="<?phpƒcho $announcementData[$announcementID]['tag'];?>"/>

22 <
i
 
şass
="ace-icon fa fa-leaf blue"></i>

23 </
¥ª
>

25 </
div
>

26 </
div
>

28 <
div
 
şass
="space-4"></div>

30 <
div
 
şass
="form-group">

31 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right" ="form-field-tags">å…¬å‘Šå†…å®¹</label>

33 <
div
 
şass
="col-sm-9">

34 <
div
 
id
="editor">

35 <?
php
 
echo
 
$ªnounûm’tD©a
[
$ªnounûm’tID
]['htmlPath'];?>

36 </
	gdiv
>

37 </
	gdiv
>

38 </
	gdiv
>

39 <
šput
 
	gty³
="hidd’" 
Çme
="ªnounûm’tPic" 
id
="ªnounûm’tPic" 
v®ue
="<?phpƒcho $announcementData[$announcementID]['pic'];?>"/>

40 </
div
>

41 </
div
><!-- /.
maš
-
cÚš”
 -->

42 <
süt
>

43 iàĞ
CKEDITOR
.
’v
.
›
 && CKEDITOR.’v.
v”siÚ
 < 9 )

44 
CKEDITOR
.
toŞs
.
’abËHtml5EËm’ts
Ğ
docum’t
 );

46 
	gCKEDITOR
.
	gcÚfig
.
	gheight
 = 150;

47 
	gCKEDITOR
.
	gcÚfig
.
	gwidth
 = 'auto';

49 
v¬
 
	gš™Sam¶e
 = ( 
	$funùiÚ
() {

50 
v¬
 
wysiwyg¬—AvaabË
 = 
	`isWysiwyg¬—AvaabË
(),

51 
isBBCodeButIn
 = !!
CKEDITOR
.
¶ugšs
.
	`g‘
( 'bbcode' );

53  
	`funùiÚ
() {

54 
v¬
 
ed™ÜEËm’t
 = 
CKEDITOR
.
docum’t
.
	`g‘ById
( 'editor' );

56 iàĞ
isBBCodeButIn
 ) {

57 
ed™ÜEËm’t
.
	`£tHtml
(

62 iàĞ
wysiwyg¬—AvaabË
 ) {

63 
CKEDITOR
.
	`»¶aû
( 'editor' );

65 
ed™ÜEËm’t
.
	`£tA‰ribu‹
( 'contenteditable', 'true' );

66 
CKEDITOR
.
	`šlše
( 'editor' );

70 
funùiÚ
 
	`isWysiwyg¬—AvaabË
() {

71 iàĞ
CKEDITOR
.
»visiÚ
 == ( '%RE' + 'V%' ) ) {

72  
Œue
;

75  !!
CKEDITOR
.
¶ugšs
.
	`g‘
( 'wysiwygarea' );

77 
	}
} )();

79 
š™Sam¶e
();

80 
funùiÚ
 
	$šÃrAÂounûm’t
(
ªnounûm’tPic
){

81 
v¬
 
_ªnounûm’tPic
 = 
	`$
("#ªnounûm’tPic").
	`v®
();

82 
_ªnounûm’tPic
 +ğ"," + 
ªnounûm’tPic
;

83 
	`$
("#ªnounûm’tPic").
	`v®
(
_ªnounûm’tPic
);

84 
	}
}

85 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/viewContants.php

2 <
div
 
	gşass
="row">

3 <
div
 
şass
="col-xs-12">

4 <!-- 
PAGE
 
CONTENT
 
BEGINS
 -->

5 <
fÜm
 
şass
="fÜm-hÜizÚl" 
rŞe
="form">

7 <
div
 
şass
="form-group">

8 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right" ="form-field-1-1"> å·¥å· </label>

10 <
div
 
şass
="col-sm-9">

11 <
šput
 
ty³
="‹xt" 
id
="cÚÁsGÚghao" 
¶aûhŞd”
="å·¥å·" 
şass
="fÜm-cÚŒŞ" 
v®ue
="" />

12 </
div
>

13 </
div
>

15 <
div
 
şass
="space-4"></div>

16 <
div
 
şass
="form-group">

17 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right">å§“å</label>

19 <
div
 
şass
="col-sm-9">

20 <
¥ª
 
şass
="input-icon">

21 <
šput
 
ty³
="‹xt" 
id
="cÚÁsName" 
v®ue
=""/>

22 <
i
 
şass
="ace-icon fa fa-leaf blue"></i>

23 </
¥ª
>

25 </
div
>

26 </
div
>

28 <
div
 
şass
="space-4"></div>

29 <
div
 
şass
="form-group">

30 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right">æ‰‹æœºå·ç </label>

32 <
div
 
şass
="col-sm-9">

33 <
¥ª
 
şass
="input-icon">

34 <
šput
 
ty³
="‹xt" 
id
="phÚeNumb”" 
v®ue
=""/>

35 <
i
 
şass
="ace-icon fa fa-leaf blue"></i>

36 </
¥ª
>

38 </
div
>

39 </
div
>

40 <
div
 
şass
="space-4"></div>

41 <
div
 
şass
="form-group">

42 <
Ïb–
 
şass
="col-sm-3 control-label‚o-padding-right">å›ºå®šå·ç </label>

44 <
div
 
şass
="col-sm-9">

45 <
¥ª
 
şass
="input-icon">

46 <
šput
 
ty³
="‹xt" 
id
="‹lPhÚeNumb”" 
v®ue
=""/>

47 <
i
 
şass
="ace-icon fa fa-leaf blue"></i>

48 </
¥ª
>

50 </
div
>

51 </
div
>

52 </
div
><!-- /.
maš
-
cÚš”
 -->

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/viewExpressDetail.php

1 <
div
 
	gşass
="row">

2 <
div
 
şass
="col-xs-12">

3 <!-- 
div
.
d©aTabËs_bÜd”W¿p
 -->

4 <
div
>

5 <
bË
 
id
="ex´ess-d‘a-bË" 
şass
="tableable-stripedable-borderedable-hover">

6 <
th—d
>

7 <
Œ
>

8 <
th
>ä»£æ”¶ä»¶äºº</th>

9 <
th
>åˆ°ä»¶æ—¶é—´</th>

10 <
th
>æ“ä½œ</th>

11 </
Œ
>

12 </
th—d
>

14 <
tbody
>

15 <?
php


16 if(
$ex´essTakeD‘a
 ==ğ"nuÎ"è
d›
;

17 
fÜ—ch
(
$ex´essTakeD‘a
 
as
 
$key
 => 
$ex´essTake
){

19 <
Œ
>

21 <
td
> <?
php
 
echo
 
$ex´essTake
['u£rName'];?> </
	gtd
>

22 <
	gtd
> <?
php
 
echo
 
	g$ex´essTake
['createDate'];?> </td>

23 <
	gtd
>

24 <
div
 
	gşass
="hidden-sm hidden-xs‡ction-buttons">

25 <
a
 
Çme
="v›wEx´essTake" 
d©a
-
ex´essid
="<?ph°echØ$ex´essTake['ex´essID'];?>" d©a-
u£rid
="<?ph°echØ$ex´essTake['u£rID'];?>" 
şass
="blue" 
h»f
="#">

26 <
i
 
şass
="ace-icon fa fa-search-plus bigger-130"></i>

27 </
a
>

28 </
div
>

30 </
td
>

31 </
Œ
>

35 </
	gtbody
>

36 </
	gbË
>

37 </
	gdiv
>

38 </
	gdiv
>

39 </
	gdiv
><!-- /.
	grow
 -->

41 <
süt
 
	gty³
="text/javascript">

42 
jQu”y
(
	$funùiÚ
(
$
) {

44 
v¬
 
oTabË1
 =

45 
	`$
('#express-detail-table')

46 .
	`d©aTabË
( {

47 
bAutoWidth
: 
çl£
,

50 
	`$
('[d©a-»l="toŞt"]').
	`toŞt
({
¶aûm’t
: 
toŞt_¶aûm’t
});

51 
funùiÚ
 
	`toŞt_¶aûm’t
(
cÚ‹xt
, 
sourû
) {

52 
v¬
 
$sourû
 = 
	`$
(
sourû
);

53 
v¬
 
$·»Á
 = 
$sourû
.
	`şo£¡
('table')

54 
v¬
 
off1
 = 
$·»Á
.
	`off£t
();

55 
v¬
 
w1
 = 
$·»Á
.
	`width
();

57 
v¬
 
off2
 = 
$sourû
.
	`off£t
();

60 ifĞ
	`·r£IÁ
(
off2
.
Ëá
è<…¬£IÁ(
off1
.Ëáè+…¬£IÁ(
w1
 / 2) )  'right';

64 
	`v›wEx´essTake
();

65 
	}
})

67 
funùiÚ
 
	$v›wEx´essTake
(){

68 
	`$
("a[Çme='v›wEx´essTake']").
	`Ú
("şick", 
	`funùiÚ
(){

69 
v¬
 
u£rid
 = 
	`$
(
this
).
	`d©a
("userid");

70 
v¬
 
ex´essid
 = 
	`$
(
this
).
	`d©a
("expressid");

71 
v¬
 
u¾
 = '<?ph°echØs™e_u¾('
www
/
ex´ess
/
v›wEx´essTake
');?>';

72 
v¬
 
·¿ms
 = {
u£rID
:
u£rid
, 
ex´essID
:
ex´essid
};

73 
$
.
	`po¡
(
u¾
, 
·¿ms
, 
	`funùiÚ
(
d©a
){

74 
cÚsŞe
.
	`debug
(
d©a
);

77 
	}
}

78 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/remind/list.php

1 <!-- /
	g£ùiÚ
:
basics
/
sideb¬
 -->

2 <
div
 
şass
="main-content">

3 <!-- #£ùiÚ:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

4 <
div
 
şass
="b»adüumbs" 
id
="breadcrumbs">

5 <
ul
 
şass
="breadcrumb">

6 <
li
>

7 <
i
 
şass
="ace-icon fa fa-home home-icon"></i>

8 <
a
 
h»f
="#">é¦–é¡µ</a>

9 </
li
>

10 <
li
 
şass
="active">æ¶ˆæ¯åˆ—è¡¨</li>

11 </
ul
><!-- /.
b»adüumb
 -->

15 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
£¬chbox
 -->

16 </
div
>

18 <!-- /
£ùiÚ
:
basics
/
cÚ‹Á
.
b»adüumbs
 -->

19 <
div
 
şass
="page-content">

20 <!-- /
£ùiÚ
:
£‰šgs
.
box
 -->

21 <
div
 
şass
="page-header">

22 <
h1
>

24 <
sm®l
>

25 
Remšd”
 
Li¡


26 </
sm®l
>

27 </
h1
>

28 </
div
><!-- /.
·ge
-
h—d”
 -->

30 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
¡¬t
-->

31 <
div
 
şass
="row">

33 <
div
 
şass
="col-xs-12">

36 <
div
 
şass
="cŞ-xs-12" 
id
="message_page-content">

38 </
div
><!-- /.
cŞ
 -->

39 </
div
><!-- /.
row
 -->

40 <!--
Ëe
 è¿™é‡Œæ˜¯ä¸­é—´å†…å®¹éƒ¨åˆ† 
’d
-->

42 </
div
><!-- /.
·ge
-
cÚ‹Á
 -->

43 </
div
><!-- /.
maš
-
cÚ‹Á
 -->

44 <
div
>

45 <
šput
 
ty³
="‹xt" 
v®ue
="" 
Çme
="·gšg_no" 
id
="paging_no"/>

46 <
šput
 
ty³
="‹xt" 
v®ue
="" 
Çme
="·gšg_Ùh”" 
id
="paging_other"/>

47 <
šput
 
ty³
="‹xt" 
v®ue
="" 
Çme
="·ge_’d" 
id
="page_end"/>

48 </
div
>

49 <
süt
 
ty³
="text/javascript">

50 
jQu”y
(
	$funùiÚ
 (
$
) {

51 
v¬
 
u¾
 = "<?phpƒcho base_url(); ?>index.php/www/remind/ReminderList?obj_type=<?phpƒcho $ObjType; ?>";

52 
v¬
 
cŞ
 = <?
php
 
echo
 
	`jsÚ_’code
(
$CŞMod–
['Col']); ?>;

53 
v¬
 
key©ŒÇme
 = '<?ph°echØ$CŞMod–['
KeyA‰rName
'];?>';

54 
	`$
("#mes§ge_·ge-cÚ‹Á").
	`L“TabË
({

55 
U¾
:
u¾
,

56 
O³¿tiÚ
:[

57 {
T™Ë
:'æŸ¥çœ‹',
U¾
:'{REMIND.u¾}',
Css
:'fa fa-search orange'},

59 {
T™Ë
:'åˆ é™¤',
U¾
:'javasüt:void(0);',
Js
:"dÉ('{<?ph°echØ$obj_d©a["
KEY_ATTR_NAME
"]; ?>}','<?ph°echØ$ObjTy³; ?>','#L“TabË','<?ph°echØba£_u¾(); ?>šdex.php/www/objeùs/li¡_jsÚ?obj_ty³=<?ph°echØ$ObjTy³; ?>')",
Css
:'fa fa-trash-o„ed'},

62 
CŞ
:
cŞ
,

63 
MuÉiS–eù
:
Œue
,

64 
MuÉiTy³
:0,

65 
KeyA‰rName
:
key©ŒÇme


67 
	}
});

71 </
	gsüt
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/demo.php

1 <?
php


2 
	gecho
 'hello world';

	@/Library/WebServer/Documents/truecolorpro/newpbi/index.php

1 <?
php


21 
defše
('ENVIRONMENT', 'development');

31 ià(
defšed
('ENVIRONMENT'))

33 
	gENVIRONMENT
)

36 
”rÜ_»pÜtšg
(
E_ALL
 & ~
E_NOTICE
);

41 
”rÜ_»pÜtšg
(0);

45 
ex™
('The‡pplicationƒnvironment is‚ot set correctly.');

59 
	g$sy¡em_·th
 = 'system';

75 
	g$­¶iÿtiÚ_fŞd”
 = 'application';

138 ià(
defšed
('STDIN'))

140 
chdœ
(
dœÇme
(
__FILE__
));

143 ià(
»®·th
(
$sy¡em_·th
è!=ğ
FALSE
)

145 
$sy¡em_·th
 = 
»®·th
($system_path).'/';

149 
	g$sy¡em_·th
 = 
¹rim
(
$sy¡em_·th
, '/').'/';

152 iàĞ! 
	$is_dœ
(
$sy¡em_·th
))

154 
	`ex™
("You¸sy¡em fŞd”…©h dÛ nÙ‡µ—¸tØb£ˆcÜ»ùly. PËa£ o³ÀthfŞlowšg fªd cÜ»ùhis: ".
	`·thšfo
(
__FILE__
, 
PATHINFO_BASENAME
));

155 
	}
}

163 
defše
('SELF', 
·thšfo
(
__FILE__
, 
PATHINFO_BASENAME
));

167 
defše
('EXT', '.php');

170 
defše
('BASEPATH', 
¡r_»¶aû
("\\", "/", 
$sy¡em_·th
));

173 
defše
('FCPATH', 
¡r_»¶aû
(
SELF
, '', 
__FILE__
));

176 
defše
('SYSDIR', 
Œim
(
¡¼chr
Ñrim(
BASEPATH
, '/'), '/'), '/'));

180 ià(
	$is_dœ
(
$­¶iÿtiÚ_fŞd”
))

182 
	`defše
('APPPATH', 
$­¶iÿtiÚ_fŞd”
.'/');

183 
	}
}

186 iàĞ! 
is_dœ
(
BASEPATH
.
$­¶iÿtiÚ_fŞd”
.'/'))

188 
ex™
("You¸­¶iÿtiÚ fŞd”…©h dÛ nÙ‡µ—¸tØb£ˆcÜ»ùly. PËa£ o³ÀthfŞlowšg fªd cÜ»ùhis: ".
SELF
);

191 
defše
('APPPATH', 
BASEPATH
.
$­¶iÿtiÚ_fŞd”
.'/');

203 
»quœe_Úû
 
	gBASEPATH
.'core/CodeIgniter.php';

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/Uploader.class.php

1 <?
php


9 şas 
	cU¶ßd”


11 
´iv©e
 
	m$feF›ld
;

12 
´iv©e
 
	m$fe
;

13 
´iv©e
 
	m$cÚfig
;

14 
´iv©e
 
	m$ÜiName
;

15 
´iv©e
 
	m$feName
;

16 
´iv©e
 
	m$fuÎName
;

17 
´iv©e
 
	m$feSize
;

18 
´iv©e
 
	m$feTy³
;

19 
´iv©e
 
	m$¡©eInfo
;

20 
´iv©e
 
	m$¡©eM­
 = 
¬¿y
(

54 
public
 
funùiÚ
 
	$__cÚ¡ruù
Ğ
$feF›ld
 , 
$cÚfig
 , 
$ba£64
 = 
çl£
 )

56 
$this
->
feF›ld
 = 
$feF›ld
;

57 
$this
->
cÚfig
 = 
$cÚfig
;

58 
$this
->
¡©eInfo
 = $this->
¡©eM­
[ 0 ];

59 
$this
->
	`upFe
Ğ
$ba£64
 );

67 
´iv©e
 
funùiÚ
 
	$upFe
Ğ
$ba£64
 )

70 iàĞ"ba£64" =ğ
$ba£64
 ) {

71 
$cÚ‹Á
 = 
$_POST
[ 
$this
->
feF›ld
 ];

72 
$this
->
	`ba£64ToImage
Ğ
$cÚ‹Á
 );

77 
$fe
 = 
$this
->
fe
 = 
$_FILES
[ $this->
feF›ld
 ];

78 iàĞ!
$fe
 ) {

79 
$this
->
¡©eInfo
 = $this->
	`g‘S‹Info
( 'POST' );

82 iàĞ
$this
->
fe
[ 'error' ] ) {

83 
$this
->
¡©eInfo
 = $this->
	`g‘S‹Info
Ğ
$fe
[ 'error' ] );

86 iàĞ!
	`is_u¶ßded_fe
Ğ
$fe
[ 'tmp_name' ] ) ) {

87 
$this
->
¡©eInfo
 = $this->
	`g‘S‹Info
( "UNKNOWN" );

91 
$this
->
ÜiName
 = 
$fe
[ 'name' ];

92 
$this
->
feSize
 = 
$fe
[ 'size' ];

93 
$this
->
feTy³
 = $this->
	`g‘FeExt
();

95 iàĞ!
$this
->
	`checkSize
() ) {

96 
$this
->
¡©eInfo
 = $this->
	`g‘S‹Info
( "SIZE" );

99 iàĞ!
$this
->
	`checkTy³
() ) {

100 
$this
->
¡©eInfo
 = $this->
	`g‘S‹Info
( "TYPE" );

103 
$this
->
fuÎName
 = $this->
	`g‘FŞd”
(è. '/' . $this->
	`g‘Name
();

104 iàĞ
$this
->
¡©eInfo
 =ğ$this->
¡©eM­
[ 0 ] ) {

105 iàĞ!
	`move_u¶ßded_fe
Ğ
$fe
[ "tmp_Çme" ] , 
$this
->
fuÎName
 ) ) {

106 
$this
->
¡©eInfo
 = $this->
	`g‘S‹Info
( "MOVE" );

109 
	}
}

116 
´iv©e
 
funùiÚ
 
	$ba£64ToImage
Ğ
$ba£64D©a
 )

118 
$img
 = 
	`ba£64_decode
Ğ
$ba£64D©a
 );

119 
$this
->
feName
 = 
	`time
(è. 
	`¿nd
( 1 , 10000 ) . ".png";

120 
$this
->
fuÎName
 = $this->
	`g‘FŞd”
(è. '/' . $this->
feName
;

121 iàĞ!
	`fe_put_cÚ‹Ás
Ğ
$this
->
fuÎName
 , 
$img
 ) ) {

122 
$this
->
¡©eInfo
 = $this->
	`g‘S‹Info
( "IO" );

125 
$this
->
ÜiName
 = "";

126 
$this
->
feSize
 = 
	`¡¾’
Ğ
$img
 );

127 
$this
->
feTy³
 = ".png";

128 
	}
}

134 
public
 
funùiÚ
 
	$g‘FeInfo
()

136  
	`¬¿y
(

137 "Üigš®Name" => 
$this
->
ÜiName
 ,

138 "Çme" => 
$this
->
feName
 ,

139 "u¾" => 
$this
->
fuÎName
 ,

140 "size" => 
$this
->
feSize
 ,

141 "ty³" => 
$this
->
feTy³
 ,

142 "¡©e" => 
$this
->
¡©eInfo


144 
	}
}

151 
´iv©e
 
funùiÚ
 
	$g‘S‹Info
Ğ
$”rCode
 )

153  !
$this
->
¡©eM­
[ 
$”rCode
 ] ? $this->stateMap[ "UNKNOWN" ] : $this->stateMap[ $errCode ];

154 
	}
}

160 
´iv©e
 
funùiÚ
 
	$g‘Name
()

162  
$this
->
feName
 = 
	`time
(è. 
	`¿nd
Ğ1 , 10000 ) . $this->
	`g‘FeExt
();

163 
	}
}

169 
´iv©e
 
funùiÚ
 
	$checkTy³
()

171  
	`š_¬¿y
Ğ
$this
->
	`g‘FeExt
(è, $this->
cÚfig
[ "allowFiles" ] );

172 
	}
}

178 
´iv©e
 
funùiÚ
 
	$checkSize
()

180  
$this
->
feSize
 <ğĞ$this->
cÚfig
[ "maxSize" ] * 1024 );

181 
	}
}

187 
´iv©e
 
funùiÚ
 
	$g‘FeExt
()

189  
	`¡¹Şow”
Ğ
	`¡¼chr
Ğ
$this
->
fe
[ "name" ] , '.' ) );

190 
	}
}

196 
´iv©e
 
funùiÚ
 
	$g‘FŞd”
()

198 
$·thSŒ
 = 
$this
->
cÚfig
[ "savePath" ];

199 iàĞ
	`¡¼chr
Ğ
$·thSŒ
 , "/" ) != "/" ) {

200 
$·thSŒ
 .= "/";

202 
$·thSŒ
 .ğ
	`d©e
( "Ymd" );

203 iàĞ!
	`fe_exi¡s
Ğ
$·thSŒ
 ) ) {

204 iàĞ!
	`mkdœ
Ğ
$·thSŒ
 , 0777 , 
Œue
 ) ) {

205  
çl£
;

208  
$·thSŒ
;

209 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/config.php

1 <?
php


3  
¬¿y
(

6 'imageSaveP©h' => 
¬¿y
 (

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/fileUp.php

1 <?
php


8 
h—d”
("Content-Type:ext/html; charset=utf-8");

9 
”rÜ_»pÜtšg
Ğ
E_ERROR
 | 
E_WARNING
 );

10 
	gšşude
 "Uploader.class.php";

12 
	g$cÚfig
 = 
¬¿y
(

14 "®lowFes" => 
¬¿y
( ".rar" , ".doc" , ".docx" , ".zip" , ".pdf" , ".txt" , ".swf" , ".wmv" ) ,

18 
	g$up
 = 
Ãw
 
U¶ßd”
Ğ"upfe" , 
$cÚfig
 );

31 
	g$šfo
 = 
$up
->
g‘FeInfo
();

42 
	gecho
 '{"u¾":"' .
	g$šfo
[ "url" ] . '","fileType":"' . $info[ "type" ] . '","original":"' . $info[ "originalName" ] . '","state":"' . $info["state"] . '"}';

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/getContent.php

1 <
m‘a
 
	gh‰p
-
	gequiv
="CÚ‹Á-Ty³" 
cÚ‹Á
="text/html;charset=utf-8"/>

2 <
süt
 
¤c
="../ued™Ü.·r£.js" 
ty³
="text/javascript"></script>

3 <
süt
>

4 
uP¬£
('.content',{

8 </
süt
>

9 <?
php


11 
”rÜ_»pÜtšg
(
E_ERROR
|
E_WARNING
);

12 
	g$cÚ‹Á
 = 
html¥ecŸlch¬s
(
¡r¦ashes
(
$_POST
['myEditor']));

18 
	gecho
 "ç¬¬1ä¸ªç¼–è¾‘å™¨çš„å€¼";

19 
	gecho
 "<div cÏss='cÚ‹Á'>".
html¥ecŸlch¬s_decode
(
$cÚ‹Á
)."</div>";

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/getMovie.php

1 <?
php


9 
”rÜ_»pÜtšg
(
E_ERROR
|
E_WARNING
);

10 
	g$key
 =
html¥ecŸlch¬s
(
$_POST
["searchKey"]);

11 
	g$ty³
 = 
html¥ecŸlch¬s
(
$_POST
["videoType"]);

12 
	g$html
 = 
fe_g‘_cÚ‹Ás
('h‰p://­i.tudou.com/v3/gw?m‘hod=™em.£¬ch&­pKey=myKey&fÜm©=jsÚ&kw='.
$key
.'&·geNo=1&·geSize=20&chªÃlId='.
$ty³
.'&inDays=7&media=v&sort=s');

13 
echo
 
	g$html
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/getRemoteImage.php

1 <?
php


9 
h—d”
("Content-Type:ext/html; charset=utf-8");

10 
”rÜ_»pÜtšg
(
E_ERROR
|
E_WARNING
);

12 
	g$cÚfig
 = 
¬¿y
(

14 "®lowFes" => 
¬¿y
( ".gif" , ".png" , ".jpg" , ".jpeg" , ".bmp" ) ,

17 
	g$uri
 = 
html¥ecŸlch¬s
Ğ
$_POST
[ 'upfile' ] );

18 
	g$uri
 = 
¡r_»¶aû
Ğ"&amp;" , "&" , 
$uri
 );

19 
g‘RemÙeImage
Ğ
$uri
,
$cÚfig
 );

26 
funùiÚ
 
	$g‘RemÙeImage
Ğ
$uri
,
$cÚfig
)

29 
	`£t_time_lim™
( 0 );

31 
$imgU¾s
 = 
	`ex¶ode
Ğ"ue_£·¿‹_ue" , 
$uri
 );

32 
$tmpNames
 = 
	`¬¿y
();

33 
	`fÜ—ch
 ( 
$imgU¾s
 
as
 
$imgU¾
 ) {

35 if(
	`¡½os
(
$imgU¾
,"http")!==0){

36 
	`¬¿y_push
Ğ
$tmpNames
 , "error" );

40 
$h—ds
 = 
	`g‘_h—d”s
Ğ
$imgU¾
 );

42 iàĞ!Ğ
	`¡ri¡r
Ğ
$h—ds
[ 0 ] , "200" ) && stristr( $heads[ 0 ] , "OK" ) ) ) {

43 
	`¬¿y_push
Ğ
$tmpNames
 , "error" );

48 
$feTy³
 = 
	`¡¹Şow”
Ğ
	`¡¼chr
Ğ
$imgU¾
 , '.' ) );

49 iàĞ!
	`š_¬¿y
Ğ
$feTy³
 , 
$cÚfig
[ '®lowFes' ] ) || 
	`¡ri¡r
Ğ
$h—ds
[ 'Content-Type' ] , "image" ) ) {

50 
	`¬¿y_push
Ğ
$tmpNames
 , "error" );

55 
	`ob_¡¬t
();

56 
$cÚ‹xt
 = 
	`¡»am_cÚ‹xt_ü—‹
(

57 
	`¬¿y
 (

58 'h‰p' => 
	`¬¿y
 (

59 'fŞlow_loÿtiÚ' => 
çl£


64 
	`»adfe
Ğ
$imgU¾
,
çl£
,
$cÚ‹xt
);

65 
$img
 = 
	`ob_g‘_cÚ‹Ás
();

66 
	`ob_’d_ş—n
();

69 
$uriSize
 = 
	`¡¾’
Ğ
$img
 );

70 
$®lowSize
 = 1024 * 
$cÚfig
[ 'maxSize' ];

71 iàĞ
$uriSize
 > 
$®lowSize
 ) {

72 
	`¬¿y_push
Ğ
$tmpNames
 , "error" );

76 
$§veP©h
 = 
$cÚfig
[ 'savePath' ];

77 iàĞ!
	`fe_exi¡s
Ğ
$§veP©h
 ) ) {

78 
	`mkdœ
( "$savePath" , 0777 );

81 
$tmpName
 = 
$§veP©h
 . 
	`¿nd
Ğ1 , 10000 ) . 
	`time
(è. 
	`¡¼chr
Ğ
$imgU¾
 , '.' );

82 
Œy
 {

83 
$å2
 = @
	`fİ’
Ğ
$tmpName
 , "a" );

84 
	`fwr™e
Ğ
$å2
 , 
$img
 );

85 
	`fşo£
Ğ
$å2
 );

86 
	`¬¿y_push
Ğ
$tmpNames
 , 
$tmpName
 );

87 } 
	`ÿtch
 ( 
Exû±iÚ
 
$e
 ) {

88 
	`¬¿y_push
Ğ
$tmpNames
 , "error" );

99 
echo
 "{'u¾':'" . 
	`im¶ode
Ğ"ue_£·¿‹_ue" , 
$tmpNames
 ) . "','t':'è¿œç¨‹å›¾ç‰‡æŠ“å–æˆåŠŸï¼','¤cU¾':'" . 
$uri
 . "'}";

100 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/imageManager.php

1 <?
php


9 
h—d”
("Content-Type:ext/html; charset=utf-8");

10 
”rÜ_»pÜtšg
Ğ
E_ERROR
 | 
E_WARNING
 );

13 
	g$·ths
 = 
¬¿y
('upload/','upload1/');

15 
	g$aùiÚ
 = 
html¥ecŸlch¬s
Ğ
$_POST
[ "action" ] );

16 iàĞ
	g$aùiÚ
 == "get" ) {

17 
$fes
 = 
¬¿y
();

18 
fÜ—ch
 ( 
$·ths
 
as
 
$·th
){

19 
	g$tmp
 = 
g‘fes
Ğ
$·th
 );

20 if(
	g$tmp
){

21 
	g$fes
 = 
¬¿y_m”ge
(
$fes
,
$tmp
);

24 iàĞ!
couÁ
(
$fes
) ) ;

25 
rsÜt
(
$fes
,
SORT_STRING
);

26 
	g$¡r
 = "";

27 
fÜ—ch
 ( 
$fes
 
as
 
$fe
 ) {

28 
	g$¡r
 .ğ
$fe
 . "ue_separate_ue";

30 
echo
 
	g$¡r
;

39 
funùiÚ
 
g‘fes
Ğ
$·th
 , &
$fes
 = 
	$¬¿y
() )

41 iàĞ!
	`is_dœ
Ğ
$·th
 ) )  
nuÎ
;

42 
$hªdË
 = 
	`İ’dœ
Ğ
$·th
 );

43  
çl£
 !=ğĞ
$fe
 = 
	`»addœ
Ğ
$hªdË
 ) ) ) {

44 iàĞ
$fe
 != '.' && $file != '..' ) {

45 
$·th2
 = 
$·th
 . '/' . 
$fe
;

46 iàĞ
	`is_dœ
Ğ
$·th2
 ) ) {

47 
	`g‘fes
Ğ
$·th2
 , 
$fes
 );

49 iàĞ
	`´eg_m©ch
Ğ"/\.(gif|j³g|jpg|²g|bmp)$/i" , 
$fe
 ) ) {

50 
$fes
[] = 
$·th2
;

55  
$fes
;

56 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/imageUp.php

1 <?
php


10 
h—d”
("Content-Type:ext/html; charset=utf-8");

11 
”rÜ_»pÜtšg
(
E_ERROR
 | 
E_WARNING
);

12 
d©e_deçuÉ_timezÚe_£t
("Asia/chongqing");

13 
	gšşude
 "Uploader.class.php";

15 
	g$t™Ë
 = 
html¥ecŸlch¬s
(
$_POST
['più™Ë'], 
ENT_QUOTES
);

16 
	g$·th
 = 
html¥ecŸlch¬s
(
$_POST
['dœ'], 
ENT_QUOTES
);

17 
	g$glob®CÚfig
 = 
šşude
( "config.php" );

18 
	g$imgSaveP©hCÚfig
 = 
$glob®CÚfig
[ 'imageSavePath' ];

21 iàĞ
is£t
Ğ
$_GET
[ 'fetch' ] ) ) {

23 
h—d”
( 'Content-Type:ext/javascript' );

24 
	gecho
 'upd©eSaveP©h('. 
jsÚ_’code
(
$imgSaveP©hCÚfig
) .');';

30 
	g$cÚfig
 = 
¬¿y
(

31 "§veP©h" => 
$imgSaveP©hCÚfig
,

33 "®lowFes" => 
¬¿y
(".gif", ".png", ".jpg", ".jpeg", ".bmp")

36 iàĞ
	$em±y
Ğ
$·th
 ) ) {

38 
$·th
 = 
$cÚfig
[ 'savePath' ][ 0 ];

40 
	}
}

43 iàĞ!
š_¬¿y
Ğ
$·th
, 
$cÚfig
[ 'savePath' ] ) ) {

45 
	gecho
 '{"state":"\u975e\u6cd5\u4e0a\u4f20\u76ee\u5f55"}';

49 
	g$cÚfig
[ '§veP©h' ] = 
$·th
 . '/';

52 
	g$up
 = 
Ãw
 
U¶ßd”
("upfe", 
$cÚfig
);

65 
	g$šfo
 = 
$up
->
g‘FeInfo
();

76 
	gecho
 "{'u¾':'" . 
	g$šfo
["u¾"] . "','t™Ë':'" . 
	g$t™Ë
 . "','original':'" . $info["originalName"] . "','state':'" . $info["state"] . "'}";

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/scrawlUp.php

1 <?
php


2 
h—d”
("Content-Type:text/html;charset=utf-8");

3 
”rÜ_»pÜtšg
Ğ
E_ERROR
 | 
E_WARNING
 );

4 
	gšşude
 "Uploader.class.php";

6 
	g$cÚfig
 = 
¬¿y
(

9 "®lowFes" => 
¬¿y
( ".gif" , ".png" , ".jpg" , ".jpeg" , ".bmp" )

12 
	g$tmpP©h
 = "tmp/";

15 
	g$aùiÚ
 = 
html¥ecŸlch¬s
Ğ
$_GET
[ "action" ] );

16 iàĞ
	g$aùiÚ
 == "tmpImg" ) {

18 
$cÚfig
[ "§veP©h" ] = 
$tmpP©h
;

19 
	g$up
 = 
Ãw
 
U¶ßd”
Ğ"upfe" , 
$cÚfig
 );

20 
	g$šfo
 = 
$up
->
g‘FeInfo
();

24 
	gecho
 "<süt>·»Á.ue_ÿÎback('" . 
	g$šfo
[ "url" ] . "','" . $info[ "state" ] . "')</script>";

27 
	g$up
 = 
Ãw
 
U¶ßd”
Ğ"cÚ‹Á" , 
$cÚfig
 , 
Œue
 );

29 if(
fe_exi¡s
(
$tmpP©h
)){

30 
d–Dœ
(
$tmpP©h
);

32 
	g$šfo
 = 
$up
->
g‘FeInfo
();

33 
	gecho
 "{'u¾':'" . 
	g$šfo
[ "url" ] . "',state:'" . $info[ "state" ] . "'}";

40 
funùiÚ
 
	$d–Dœ
Ğ
$dœ
 )

43 
$dh
 = 
	`İ’dœ
Ğ
$dœ
 );

44  
$fe
 = 
	`»addœ
Ğ
$dh
 ) ) {

45 iàĞ
$fe
 != "." && $file != ".." ) {

46 
$fuÎ·th
 = 
$dœ
 . "/" . 
$fe
;

47 iàĞ!
	`is_dœ
Ğ
$fuÎ·th
 ) ) {

48 
	`uÆšk
Ğ
$fuÎ·th
 );

50 
	`d–Dœ
Ğ
$fuÎ·th
 );

54 
	`şo£dœ
Ğ
$dh
 );

56  
	`rmdœ
Ğ
$dœ
 );

57 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/ckeditor/samples/old/assets/posteddata.php

1 <!
DOCTYPE
 
	ghtml
>

2 <?
	gphp


8 <
	ghtml
>

9 <
	gh—d
>

10 <
m‘a
 
	gch¬£t
="utf-8">

11 <
t™Ë
>
Sam¶e
 &
mdash
; 
	gCKEd™Ü
</
	gt™Ë
>

12 <
lšk
 
	g»l
="¡yËsh“t" 
h»f
="sample.css">

13 </
h—d
>

14 <
body
>

15 <
h1
 
şass
="samples">

16 
CKEd™Ü
 &
mdash
; 
Po¡ed
 
	gD©a


17 </
	gh1
>

18 <
bË
 
	gbÜd”
="1" 
ûÎ¥acšg
="0" 
id
="outputSample">

19 <
cŞgroup
><
cŞ
 
width
="120"></colgroup>

20 <
th—d
>

21 <
Œ
>

22 <
th
>
F›ld
&
nb¥
;
	gName
</
	gth
>

23 <
	gth
>
	gV®ue
</th>

24 </
	gŒ
>

25 </
	gth—d
>

26 <?
php


28 ià(!
	$em±y
(
$_POST
))

30 
	`fÜ—ch
 ( 
$_POST
 
as
 
$key
 => 
$v®ue
 )

32 iàĞĞ!
	`is_¡ršg
(
$v®ue
è&& !
	`is_num”ic
($v®ueèè|| !is_¡ršg(
$key
) )

35 iàĞ
	`g‘_magic_quÙes_gpc
() )

36 
$v®ue
 = 
	`html¥ecŸlch¬s
Ğ
	`¡r¦ashes
((
¡ršg
)$value) );

38 
$v®ue
 = 
	`html¥ecŸlch¬s
Ğ(
¡ršg
)$value );

40 <
Œ
>

41 <
th
 
¡yË
="v”tiÿl-®ign:İ"><?
php
 
echo
 
	`html¥ecŸlch¬s
Ğ(
¡ršg
)
$key
 ); ?></th>

42 <
td
><
´e
 
şass
="§m¶es"><?
php
 
echo
 
$v®ue
; ?></pre></td>

43 </
Œ
>

44 <?
php


46 
	}
}

48 </
	gbË
>

49 <
div
 
	gid
="footer">

50 <
hr
>

51 <
p
>

52 
CKEd™Ü
 - 
The
 
‹xt
 
ed™Ü
 
the
 
IÁ”Ãt
 - <
a
 
şass
="§m¶es" 
h»f
="h‰p://cked™Ü.com/">
h‰p
:

53 </
p
>

54 <
p
 
id
="copy">

55 
Cİyright
 &
cİy
; 2003-2015, <
a
 
	gşass
="§m¶es" 
h»f
="h‰p://cksourû.com/">
CKSourû
</a> - 
F»d”ico
 
KÇbb’
. 
AÎ
 
rights
 
»£rved
.

56 </
p
>

57 </
div
>

58 </
body
>

59 </
html
>

	@/Library/WebServer/Documents/truecolorpro/newpbi/style/ckeditor/samples/old/sample_posteddata.php

1 <?
php


16  
	gšşude
 "assets/posteddata.php"; ?>

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Benchmark.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

30 şas 
	cCI_B’chm¬k
 {

37 
v¬
 
	m$m¬k”
 = 
¬¿y
();

51 
funùiÚ
 
	$m¬k
(
$Çme
)

53 
$this
->
m¬k”
[
$Çme
] = 
	`miüÙime
();

72 
funùiÚ
 
	`–­£d_time
(
$pošt1
 = '', 
$pošt2
 = '', 
$decim®s
 = 4)

74 ià(
$pošt1
 == '')

79 iàĞ! 
	`is£t
(
$this
->
m¬k”
[
$pošt1
]))

84 iàĞ! 
	`is£t
(
$this
->
m¬k”
[
$pošt2
]))

86 
$this
->
m¬k”
[
$pošt2
] = 
	`miüÙime
();

89 
	`li¡
(
$sm
, 
$ss
èğ
	`ex¶ode
(' ', 
$this
->
m¬k”
[
$pošt1
]);

90 
	`li¡
(
$em
, 
$es
èğ
	`ex¶ode
(' ', 
$this
->
m¬k”
[
$pošt2
]);

92  
	`numb”_fÜm©
((
$em
 + 
$es
è- (
$sm
 + 
$ss
), 
$decim®s
);

93 
	}
}

108 
funùiÚ
 
	$memÜy_u§ge
()

111 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/CodeIgniter.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

36 
defše
('CI_VERSION', '2.2.0');

44 
defše
('CI_CORE', 
FALSE
);

51 
»quœe
(
BASEPATH
.'core/Common.php');

58 ià(
defšed
('ENVIRONMENT'è
AND
 
fe_exi¡s
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/constants.php'))

60 
»quœe
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/constants.php');

64 
»quœe
(
APPPATH
.'config/constants.php');

72 
£t_”rÜ_hªdËr
('_exception_handler');

74 iàĞ! 
is_php
('5.3'))

76 @
£t_magic_quÙes_ruÁime
(0);

95 ià(
is£t
(
$assign_to_cÚfig
['subşass_´efix']è
AND
 
	g$assign_to_cÚfig
['subclass_prefix'] != '')

97 
g‘_cÚfig
(
¬¿y
('subşass_´efix' => 
$assign_to_cÚfig
['subclass_prefix']));

105 ià(
funùiÚ_exi¡s
("£t_time_lim™"è=ğ
TRUE
 
AND
 @
ši_g‘
("safe_mode") == 0)

107 @
£t_time_lim™
(300);

115 
	g$BM
 =& 
lßd_şass
('Benchmark', 'core');

116 
	g$BM
->
m¬k
('total_execution_time_start');

117 
	g$BM
->
m¬k
('loading_time:_base_classes_start');

124 
	g$EXT
 =& 
lßd_şass
('Hooks', 'core');

131 
	g$EXT
->
_ÿÎ_hook
('pre_system');

138 
	g$CFG
 =& 
lßd_şass
('Config', 'core');

141 ià(
	$is£t
(
$assign_to_cÚfig
))

143 
$CFG
->
	`_assign_to_cÚfig
(
$assign_to_cÚfig
);

144 
	}
}

158 
	g$UNI
 =& 
lßd_şass
('Utf8', 'core');

165 
	g$URI
 =& 
lßd_şass
('URI', 'core');

172 
	g$RTR
 =& 
lßd_şass
('Router', 'core');

173 
	g$RTR
->
_£t_routšg
();

176 ià(
	$is£t
(
$routšg
))

178 
$RTR
->
	`_£t_ov”rides
(
$routšg
);

179 
	}
}

186 
	g$OUT
 =& 
lßd_şass
('Output', 'core');

193 ià(
	g$EXT
->
_ÿÎ_hook
('ÿche_ov”ride'è==ğ
FALSE
)

195 ià(
$OUT
->
_di¥Ïy_ÿche
(
$CFG
, 
$URI
è=ğ
TRUE
)

197 
ex™
;

206 
	g$SEC
 =& 
lßd_şass
('Security', 'core');

213 
	g$IN
 =& 
lßd_şass
('Input', 'core');

220 
	g$LANG
 =& 
lßd_şass
('Lang', 'core');

229 
»quœe
 
	gBASEPATH
.'core/Controller.php';

231 
	gfunùiÚ
 &
	$g‘_š¡ªû
()

233  
CI_CÚŒŞËr
::
	`g‘_š¡ªû
();

234 
	}
}

237 ià(
fe_exi¡s
(
APPPATH
.'cÜe/'.
$CFG
->
cÚfig
['subclass_prefix'].'Controller.php'))

239 
»quœe
 
	gAPPPATH
.'cÜe/'.
	g$CFG
->
	gcÚfig
['subclass_prefix'].'Controller.php';

245 iàĞ! 
fe_exi¡s
(
APPPATH
.'cÚŒŞËrs/'.
$RTR
->
ãtch_dœeùÜy
().$RTR->
ãtch_şass
().'.php'))

247 
show_”rÜ
('Unableo†oad your default controller. Please make surehe controller specified in your Routes.php file is valid.');

250 
šşude
(
APPPATH
.'cÚŒŞËrs/'.
$RTR
->
ãtch_dœeùÜy
().$RTR->
ãtch_şass
().'.php');

253 
	g$BM
->
m¬k
('loading_time:_base_classes_end');

264 
	g$şass
 = 
$RTR
->
ãtch_şass
();

265 
	g$m‘hod
 = 
$RTR
->
ãtch_m‘hod
();

267 iàĞ! 
	$şass_exi¡s
(
$şass
)

268 
OR
 
	`¡ºcmp
(
$m‘hod
, '_', 1) == 0

269 
OR
 
	`š_¬¿y
(
	`¡¹Şow”
(
$m‘hod
), 
	`¬¿y_m­
('¡¹Şow”', 
	`g‘_şass_m‘hods
('CI_Controller')))

272 iàĞ! 
	`em±y
(
$RTR
->
rou‹s
['404_override']))

274 
$x
 = 
	`ex¶ode
('/', 
$RTR
->
rou‹s
['404_override']);

275 
$şass
 = 
$x
[0];

276 
$m‘hod
 = (
	`is£t
(
$x
[1]) ? $x[1] : 'index');

277 iàĞ! 
	`şass_exi¡s
(
$şass
))

279 iàĞ! 
	`fe_exi¡s
(
APPPATH
.'cÚŒŞËrs/'.
$şass
.'.php'))

281 
	`show_404
("{$class}/{$method}");

284 
	`šşude_Úû
(
APPPATH
.'cÚŒŞËrs/'.
$şass
.'.php');

289 
	`show_404
("{$class}/{$method}");

291 
	}
}

298 
	g$EXT
->
_ÿÎ_hook
('pre_controller');

306 
	g$BM
->
m¬k
('cÚŒŞËr_executiÚ_time_Ğ'.
$şass
.' / '.
$m‘hod
.' )_start');

308 
	g$CI
 = 
Ãw
 
$şass
();

315 
	g$EXT
->
_ÿÎ_hook
('post_controller_constructor');

323 ià(
m‘hod_exi¡s
(
$CI
, '_remap'))

325 
	g$CI
->
_»m­
(
$m‘hod
, 
¬¿y_¦iû
(
$URI
->
r£gm’ts
, 2));

331 iàĞ! 
š_¬¿y
(
¡¹Şow”
(
$m‘hod
), 
¬¿y_m­
('¡¹Şow”', 
g‘_şass_m‘hods
(
$CI
))))

334 iàĞ! 
em±y
(
$RTR
->
rou‹s
['404_override']))

336 
	g$x
 = 
ex¶ode
('/', 
$RTR
->
rou‹s
['404_override']);

337 
	g$şass
 = 
$x
[0];

338 
	g$m‘hod
 = (
is£t
(
$x
[1]) ? $x[1] : 'index');

339 iàĞ! 
şass_exi¡s
(
$şass
))

341 iàĞ! 
fe_exi¡s
(
APPPATH
.'cÚŒŞËrs/'.
$şass
.'.php'))

343 
show_404
("{$class}/{$method}");

346 
šşude_Úû
(
APPPATH
.'cÚŒŞËrs/'.
$şass
.'.php');

347 
un£t
(
$CI
);

348 
	g$CI
 = 
Ãw
 
$şass
();

353 
show_404
("{$class}/{$method}");

359 
ÿÎ_u£r_func_¬¿y
(
¬¿y
(&
$CI
, 
$m‘hod
), 
¬¿y_¦iû
(
$URI
->
r£gm’ts
, 2));

364 
	g$BM
->
m¬k
('cÚŒŞËr_executiÚ_time_Ğ'.
$şass
.' / '.
$m‘hod
.' )_end');

371 
	g$EXT
->
_ÿÎ_hook
('post_controller');

378 ià(
	g$EXT
->
_ÿÎ_hook
('di¥Ïy_ov”ride'è==ğ
FALSE
)

380 
$OUT
->
_di¥Ïy
();

388 
	g$EXT
->
_ÿÎ_hook
('post_system');

395 ià(
şass_exi¡s
('CI_DB'è
AND
 
is£t
(
$CI
->
db
))

397 
	g$CI
->
	gdb
->
şo£
();

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Common.php

1 <?
php


3 ià(!
defšed
('BASEPATH'))

4 
ex™
('No direct script‡ccess‡llowed');

43 ià(!
funùiÚ_exi¡s
('is_php')) {

45 
funùiÚ
 
is_php
(
$v”siÚ
 = '5.0.0') {

46 
$_is_php
;

47 
	g$v”siÚ
 = (
¡ršg
è
$v”siÚ
;

49 ià(!
is£t
(
$_is_php
[
$v”siÚ
])) {

50 
	g$_is_php
[
$v”siÚ
] = (
v”siÚ_com·»
(
PHP_VERSION
, $v”siÚè< 0è? 
	gFALSE
 : 
TRUE
;

53  
	g$_is_php
[
$v”siÚ
];

70 ià(!
funùiÚ_exi¡s
('is_really_writable')) {

72 
funùiÚ
 
is_»®ly_wr™abË
(
$fe
) {

74 ià(
	gDIRECTORY_SEPARATOR
 =ğ'/' 
AND
 @ 
ši_g‘
("§ã_mode"è=ğ
FALSE
) {

75  
is_wr™abË
(
$fe
);

80 ià(
is_dœ
(
$fe
)) {

81 
	g$fe
 = 
¹rim
(
$fe
, '/'è. '/' . 
md5
(
mt_¿nd
(1, 100) . mt_rand(1, 100));

83 ià((
	g$å
 = @
fİ’
(
$fe
, 
FOPEN_WRITE_CREATE
)è==ğ
FALSE
) {

84  
FALSE
;

87 
fşo£
(
$å
);

88 @
chmod
(
$fe
, 
DIR_WRITE_MODE
);

89 @
uÆšk
(
$fe
);

90  
	gTRUE
;

91 } 
–£if
 (!
is_fe
(
$fe
è
OR
 ( 
$å
 = @
fİ’
($fe, 
FOPEN_WRITE_CREATE
)è==ğ
FALSE
) {

92  
FALSE
;

95 
fşo£
(
$å
);

96  
	gTRUE
;

116 ià(!
funùiÚ_exi¡s
('load_class')) {

118 
	gfunùiÚ
 &
lßd_şass
(
$şass
, 
$dœeùÜy
 = 'lib¿r›s', 
$´efix
 = 'CI_') {

119 
$_şas£s
 = 
¬¿y
();

122 ià(
is£t
(
$_şas£s
[
$şass
])) {

123  
	g$_şas£s
[
$şass
];

126 
	g$Çme
 = 
FALSE
;

130 
fÜ—ch
 (
¬¿y
(
APPPATH
, 
BASEPATH
è
as
 
$·th
) {

131 ià(
fe_exi¡s
(
$·th
 . 
$dœeùÜy
 . '/' . 
$şass
 . '.php')) {

132 
	g$Çme
 = 
$´efix
 . 
$şass
;

134 ià(
şass_exi¡s
(
$Çme
è==ğ
FALSE
) {

135 
»quœe
(
$·th
 . 
$dœeùÜy
 . '/' . 
$şass
 . '.php');

143 ià(
fe_exi¡s
(
APPPATH
 . 
$dœeùÜy
 . '/' . 
cÚfig_™em
('subşass_´efix'è. 
$şass
 . '.php')) {

144 
	g$Çme
 = 
cÚfig_™em
('subşass_´efix'è. 
$şass
;

146 ià(
şass_exi¡s
(
$Çme
è==ğ
FALSE
) {

147 
»quœe
(
APPPATH
 . 
$dœeùÜy
 . '/' . 
cÚfig_™em
('subşass_´efix'è. 
$şass
 . '.php');

152 ià(
	g$Çme
 ==ğ
FALSE
) {

155 
ex™
('UÇbËØloÿ‹h¥ecif›d cÏss: ' . 
$şass
 . '.php');

159 
is_lßded
(
$şass
);

161 
	g$_şas£s
[
$şass
] = 
Ãw
 
$Çme
();

162  
	g$_şas£s
[
$şass
];

176 ià(!
funùiÚ_exi¡s
('is_loaded')) {

178 
	gfunùiÚ
 &
is_lßded
(
$şass
 = '') {

179 
$_is_lßded
 = 
¬¿y
();

181 ià(
	g$şass
 != '') {

182 
$_is_lßded
[
¡¹Şow”
(
$şass
)] = $class;

185  
	g$_is_lßded
;

201 ià(!
funùiÚ_exi¡s
('get_config')) {

203 
	gfunùiÚ
 &
g‘_cÚfig
(
$»¶aû
 = 
¬¿y
()) {

204 
$_cÚfig
;

206 ià(
is£t
(
$_cÚfig
)) {

207  
	g$_cÚfig
[0];

211 ià(!
defšed
('ENVIRONMENT'è
	gOR
 ! 
fe_exi¡s
(
$fe_·th
 = 
APPPATH
 . 'cÚfig/' . 
ENVIRONMENT
 . '/config.php')) {

212 
$fe_·th
 = 
APPPATH
 . 'config/config.php';

216 ià(!
fe_exi¡s
(
$fe_·th
)) {

217 
ex™
('The configuration file does‚otƒxist.');

220 
»quœe
(
$fe_·th
);

223 ià(!
is£t
(
$cÚfig
è
	gOR
 ! 
is_¬¿y
($config)) {

224 
ex™
('Your config file does‚ot‡ppearo be formatted correctly.');

228 ià(
couÁ
(
$»¶aû
) > 0) {

229 
fÜ—ch
 (
$»¶aû
 
as
 
$key
 => 
$v®
) {

230 ià(
is£t
(
$cÚfig
[
$key
])) {

231 
$cÚfig
[
$key
] = 
$v®
;

236  
	g$_cÚfig
[0] = & 
$cÚfig
;

249 ià(!
funùiÚ_exi¡s
('config_item')) {

251 
funùiÚ
 
cÚfig_™em
(
$™em
) {

252 
	g$_cÚfig_™em
 = 
¬¿y
();

254 ià(!
is£t
(
$_cÚfig_™em
[
$™em
])) {

255 
	g$cÚfig
 = & 
g‘_cÚfig
();

257 ià(!
is£t
(
$cÚfig
[
$™em
])) {

258  
	gFALSE
;

260 
	g$_cÚfig_™em
[
$™em
] = 
$cÚfig
[$item];

263  
	g$_cÚfig_™em
[
$™em
];

282 ià(!
funùiÚ_exi¡s
('show_error')) {

284 
funùiÚ
 
show_”rÜ
(
$mes§ge
, 
$¡©us_code
 = 500, 
$h—dšg
 = 'An Error Was Encountered') {

285 
$_”rÜ
 = & 
lßd_şass
('Exceptions', 'core');

286 
echo
 
	g$_”rÜ
->
show_”rÜ
(
$h—dšg
, 
$mes§ge
, '”rÜ_g’”®', 
$¡©us_code
);

287 
	gex™
;

304 ià(!
funùiÚ_exi¡s
('show_404')) {

306 
funùiÚ
 
show_404
(
$·ge
 = '', 
$log_”rÜ
 = 
TRUE
) {

307 
$_”rÜ
 = & 
lßd_şass
('Exceptions', 'core');

308 
	g$_”rÜ
->
show_404
(
$·ge
, 
$log_”rÜ
);

309 
	gex™
;

325 ià(!
funùiÚ_exi¡s
('log_message')) {

327 
funùiÚ
 
log_mes§ge
(
$Ëv–
 = '”rÜ', 
$mes§ge
, 
$php_”rÜ
 = 
FALSE
) {

328 
$_log
;

330 ià(
cÚfig_™em
('log_threshold') == 0) {

334 
	g$_log
 = & 
lßd_şass
('Log');

335 
	g$_log
->
wr™e_log
(
$Ëv–
, 
$mes§ge
, 
$php_”rÜ
);

350 ià(!
funùiÚ_exi¡s
('set_status_header')) {

352 
funùiÚ
 
£t_¡©us_h—d”
(
$code
 = 200, 
$‹xt
 = '') {

353 
$¡©i
 = 
¬¿y
(

392 ià(
	g$code
 =ğ'' 
OR
 ! 
is_num”ic
(
$code
)) {

393 
show_”rÜ
('Status codes must be‚umeric', 500);

396 ià(
is£t
(
$¡©i
[
$code
]è
AND
 
	g$‹xt
 == '') {

397 
$‹xt
 = 
$¡©i
[
$code
];

400 ià(
	g$‹xt
 == '') {

401 
show_”rÜ
('No statusext‡vailable. Please check your status code‚umber or supply your own messageext.', 500);

404 
	g$£rv”_´ÙocŞ
 = (
is£t
(
$_SERVER
['SERVER_PROTOCOL'])è? $_SERVER['SERVER_PROTOCOL'] : 
FALSE
;

406 ià(
sub¡r
(
php_§pi_Çme
(), 0, 3) == 'cgi') {

407 
h—d”
("Stus: {$code} {$‹xt}", 
TRUE
);

408 } 
–£if
 (
$£rv”_´ÙocŞ
 =ğ'HTTP/1.1' 
OR
 $server_protocol == 'HTTP/1.0') {

409 
h—d”
(
$£rv”_´ÙocŞ
 . " {$code} {$‹xt}", 
TRUE
, 
$code
);

411 
h—d”
("HTTP/1.1 {$code} {$‹xt}", 
TRUE
, 
$code
);

433 ià(!
funùiÚ_exi¡s
('_exception_handler')) {

435 
funùiÚ
 
_exû±iÚ_hªdËr
(
$£v”™y
, 
$mes§ge
, 
$f•©h
, 
$lše
) {

441 ià(
	g$£v”™y
 =ğ
E_STRICT
) {

445 
	g$_”rÜ
 = & 
lßd_şass
('Exceptions', 'core');

449 ià((
	g$£v”™y
 & 
”rÜ_»pÜtšg
()è=ğ
$£v”™y
) {

450 
$_”rÜ
->
show_php_”rÜ
(
$£v”™y
, 
$mes§ge
, 
$f•©h
, 
$lše
);

454 ià(
cÚfig_™em
('log_threshold') == 0) {

458 
	g$_”rÜ
->
log_exû±iÚ
(
$£v”™y
, 
$mes§ge
, 
$f•©h
, 
$lše
);

475 ià(!
funùiÚ_exi¡s
('remove_invisible_characters')) {

477 
funùiÚ
 
»move_švisibË_ch¬aù”s
(
$¡r
, 
$u¾_’coded
 = 
TRUE
) {

478 
$nÚ_di¥ÏyabËs
 = 
¬¿y
();

483 ià(
	g$u¾_’coded
) {

484 
	g$nÚ_di¥ÏyabËs
[] = '/%0[0-8bcef]/';

485 
	g$nÚ_di¥ÏyabËs
[] = '/%1[0-9a-f]/';

488 
	g$nÚ_di¥ÏyabËs
[] = '/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]+/S';

491 
	g$¡r
 = 
´eg_»¶aû
(
$nÚ_di¥ÏyabËs
, '', 
$¡r
, -1, 
$couÁ
);

492 } 
	g$couÁ
);

494  
	g$¡r
;

508 ià(!
funùiÚ_exi¡s
('html_escape')) {

510 
funùiÚ
 
html_esÿ³
(
$v¬
) {

511 ià(
is_¬¿y
(
$v¬
)) {

512  
¬¿y_m­
('html_esÿ³', 
$v¬
);

514  
html¥ecŸlch¬s
(
$v¬
, 
ENT_QUOTES
, 
cÚfig_™em
('charset'));

523 
funùiÚ
 
	$p
(
$¬r
) {

525 
echo
 "<pre>";

526 
	`´št_r
(
$¬r
);

527 
echo
 "</pre>";

528 
	}
}

530 
funùiÚ
 
	$sucûss
(
$u¾
, 
$msg
) {

532 
	`h—d”
('Content-Type:text/html;charset=utf-8');

533 
$u¾
 = 
	`s™e_u¾
($url);

534 
echo
 "<script>alert('$msg');location.href='$url'</script>";

535 
d›
;

536 
	}
}

538 
funùiÚ
 
Ëe_jump
(
$u¾
, 
$msg
 = "") {

539 
h—d”
('Content-Type:text/html;charset=utf-8');

540 ià(
	g$msg
 == "") {

541 
echo
 "<süt>loÿtiÚ.h»f='" . 
$u¾
 . "'</script>";

543 
	gecho
 "<süt>®”t('$msg');loÿtiÚ.h»f='" . 
	g$u¾
 . "'</script>";

545 
	gd›
;

548 
funùiÚ
 
	$”rÜ
(
$msg
) {

549 
	`h—d”
('Content-Type:text/html;charset=utf-8');

550 
echo
 "<script>alert('$msg');window.history.back();</script>";

551 
d›
;

552 
	}
}

556 
funùiÚ
 
	$©Œibu‹
(
$d©a
) {

557 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

558 ià(
$k
 != 'submit') {

559 
$¬r
[
$k
] = 
$v
;

561 
$¬r
['upd©e_time'] = 
	`time
();

563  
$¬r
;

564 
	}
}

566 
funùiÚ
 
	$»¶aû
(
$row
, 
$Çme
, 
$cÚ‹Á
) {

567 
$row
 = 
	`¡r_»¶aû
("%Çme%", 
$Çme
, $row);

568 
$row
 = 
	`¡r_»¶aû
("%cÚ‹Á%", 
$cÚ‹Á
, $row);

569  
$row
;

570 
	}
}

572 
funùiÚ
 
	$»¶aû_v›w
(
$row
, 
$cÚ‹Á
) {

573 
$row
 = 
	`¡r_»¶aû
("%fÜm_cÚ‹Á%", 
$cÚ‹Á
, $row);

574  
$row
;

575 
	}
}

577 
funùiÚ
 
	$code
(
$width
 = 80, 
$height
 = 25, 
$fÚtSize
 = 15, 
$codeL’
 = 6) {

579 
$cÚfig
 = 
	`¬¿y
(

580 'width' => 
$width
,

581 'height' => 
$height
,

582 'fÚtSize' => 
$fÚtSize
,

583 'codeL’' => 
$codeL’
,

585 
$this
->
lßd
->
	`lib¿ry
('code', 
$cÚfig
);

587 ià(!
	`is£t
(
$_SESSION
)) {

588 
	`£ssiÚ_¡¬t
();

590 
$_SESSION
['code'] = 
$this
->
code
->
	`g‘Code
();

591 
echo
 
$this
->
code
->
	`show
();

592 
	}
}

596 
funùiÚ
 
	$f›ld_ty³
(
$v
) {

597 
$v
) {

619 
	}
}

621 
funùiÚ
 
	$pj
(
$¬r
) {

622 
echo
 
$jsÚ
 = 
	`jsÚ_’code
(
$¬r
);

623 
	}
}

625 
funùiÚ
 
	$bšgji
(
$¬r1
, 
$¬r2
) {

626 
$’gth
 = 
	`couÁ
(
$¬r1
);

627 
$jËngth
 = 
	`couÁ
(
$¬r2
);

628 
$i
 = 0; $˜< 
$jËngth
; $i++) {

629 
$chªge
 = 
çl£
;

630 
$j
 = 0; $j < 
$’gth
; $j++) {

631 ià(
$¬r2
[
$i
] =ğ
$¬r1
[
$j
]) {

632 
$chªge
 = 
Œue
;

636 ià(
$chªge
 =ğ
çl£
) {

637 
$¬r1
[] = 
$¬r2
[
$i
];

640  
$¬r1
;

641 
	}
}

648 
funùiÚ
 
	$mÚey
(
$num
) {

651  
	`numb”_fÜm©
(
	`æßtv®
(
$num
), 2, '.', '');

652 
	}
}

656 
funùiÚ
 
	$objeù_¬¿y
(
$¬¿y
) {

657 ià(
	`is_objeù
(
$¬¿y
)) {

658 
$¬¿y
 = 
	`g‘_objeù_v¬s
($array);

660 ià(
	`is_¬¿y
(
$¬¿y
)) {

661 
	`fÜ—ch
 (
$¬¿y
 
as
 
$key
 => 
$v®ue
) {

662 
$¬¿y
[
$key
] = 
	`objeù_¬¿y
(
$v®ue
);

665  
$¬¿y
;

666 
	}
}

669 
funùiÚ
 
	$d©a_auth_to_num
(
$d©a_auth_v®
) {

670 ià(
$d©a_auth_v®
 == 'all_privileges') {

672 } ià(
$d©a_auth_v®
 == 'charge') {

674 } ià(
$d©a_auth_v®
 == 'self_department') {

679 
	}
}

682 
funùiÚ
 
CÚv”A¼ay
(
$¬r
, 
$¥l™
 = ",") {

683  
ex¶ode
(
$¥l™
, 
$¬r
);

692 
funùiÚ
 
	$im¶ode_r
(
$glue
, 
$p›ûs
) {

693 
$»tuº
 = "";

695 ià(!
	`is_¬¿y
(
$glue
)) {

696 
$glue
 = 
	`¬¿y
($glue);

699 
$thisLev–Glue
 = 
	`¬¿y_shiá
(
$glue
);

701 ià(!
	`couÁ
(
$glue
))

702 
$glue
 = 
	`¬¿y
(
$thisLev–Glue
);

704 ià(!
	`is_¬¿y
(
$p›ûs
)) {

705  (
¡ršg
è
$p›ûs
;

708 
	`fÜ—ch
 (
$p›ûs
 
as
 
$sub
) {

709 
$»tuº
 .ğ
	`im¶ode_r
(
$glue
, 
$sub
è. 
$thisLev–Glue
;

712 ià(
	`couÁ
(
$p›ûs
))

713 
$»tuº
 = 
	`sub¡r
($»tuº, 0, 
	`¡¾’
($»tuºè- sŒËn(
$thisLev–Glue
));

715  
$»tuº
;

716 
	}
}

724 
funùiÚ
 
	$_msg
(
$»s
, 
$msg
) {

725  
	`jsÚ_’code
(

726 
	`¬¿y
(

727 "»s" => 
$»s
, "msg" => 
$msg


730 
	}
}

738 
funùiÚ
 
	$_HashD©a
(
$HashD©a
, 
$HashKey
) {

739 
$ResD©a
 = 
	`¬¿y
();

740 
	`fÜ—ch
 (
$HashD©a
 
as
 
$key
 => 
$v®ue
) {

741 
	`fÜ—ch
 (
$v®ue
 
as
 
$k
 => 
$v
) {

742 
$ResD©a
[
$v®ue
[
$HashKey
]][
$k
] = 
$v
;

745  
$ResD©a
;

746 
	}
}

753 
funùiÚ
 
	$_CÚv”OÃA¼ay
(
$¬rs
) {

754 
$»s_d©a
 = 
	`¬¿y
();

755 
	`fÜ—ch
 (
$¬rs
 
as
 
$k
 => 
$v
) {

756 
	`fÜ—ch
 (
$v
 
as
 
$kk
 => 
$vv
) {

757 ià(!
	`em±y
(
$vv
)) {

758 
$»s_d©a
[] = 
$vv
;

762  
$»s_d©a
;

763 
	}
}

770 
funùiÚ
 
	$d©aAdd8
(
$fÜm©
) {

771  
	`d©e
(
$fÜm©
, 
	`time
() + 3600 * 8);

772 
	}
}

780 
funùiÚ
 
	$d©aReduû8
(
$fÜm©
, 
$time
) {

781  
	`d©e
(
$fÜm©
, 
	`¡¹Ùime
(
$time
) - 3600 * 8);

783 
	}
}

788 
funùiÚ
 
	$su³r_unique
(
$¬¿y
) {

789 
$»suÉ
 = 
	`¬¿y_m­
("un£rŸlize", 
	`¬¿y_unique
×¼ay_m­("£rŸlize", 
$¬¿y
)));

790 
	`fÜ—ch
 (
$»suÉ
 
as
 
$key
 => 
$v®ue
) {

791 ià(
	`is_¬¿y
(
$v®ue
)) {

792 
$»suÉ
[
$key
] = 
	`su³r_unique
(
$v®ue
);

795  
$»suÉ
;

796 
	}
}

806 
funùiÚ
 
d©e_add_sub
(
$sS¹D©e
, 
$add_sub
 = '+2 days', 
$fÜm©‹r
 = 'Y-m-d') {

807  
d©e
(
$fÜm©‹r
, 
¡¹Ùime
(
$add_sub
, sŒtÙime(
$sS¹D©e
)));

817 
funùiÚ
 
	$d©e_time
(
$D©eTime
, 
$ex³ris
 = 28800) {

818 
$»s_d©e
 = 
	`em±y
(
$D©eTime
è? 
nuÎ
 : 
	`d©e
("Y-m-d H:i:s", 
	`¡¹Ùime
($D©eTimeè+ 
$ex³ris
);

819  
$»s_d©e
;

820 
	}
}

826 
funùiÚ
 
	$mysqlEsÿ³SŒ
(
$¡r
){

827  
	`add¦ashes
(
$¡r
);

828 
	}
}

839 
funùiÚ
 
	$mod–Requœed
(
$mod–Requœed
, 
$f›ldsName
, 
$mod–D©a
){

840 
$”rÜR‘
 = 
	`¬¿y
('succ' => 
TRUE
, 'msg' =>‡rray());

841 
$»quœedA‰r
 = 
	`¬¿y
();

842 
$”rÜMsg
 = 
	`¬¿y
();

843 if(
$mod–Requœed
){

845 
	`fÜ—ch
(
$f›ldsName
 
as
 
$f›lds
){

846 
	`li¡
(
$ruËF›ld
, 
$©ŒF›ld
èğ
	`ex¶ode
("|", 
$f›lds
);

847 
$»quœedA‰r
[
$©ŒF›ld
] = 
$ruËF›ld
;

850 
	`fÜ—ch
(
$mod–D©a
 
as
 
$mod–Key
 => 
$mod–V®
){

854 if(
	`is£t
(
$»quœedA‰r
[
$mod–Key
])){

855 
$ruË
 = 
$»quœedA‰r
[
$mod–Key
];

856 
$ruË
 = 
	`Œim
($rule, '`');

857 
	`li¡
(
$sign
, 
$ty³
, 
$Ëngth
, 
$isPrim¬y
, 
$»ÏtiÚ
èğ
	`ex¶ode
("#", 
$ruË
);

858 
$ruËR‘
 = 
	`ruËFunc
(
$sign
, 
$ty³
, 
$Ëngth
, 
$isPrim¬y
, 
$»ÏtiÚ
, 
$mod–V®
);

859 if(!
$ruËR‘
){

860 
$”rÜR‘
['msg'][] = 
$ruËR‘
;

861 
$”rÜR‘
['succ'] = 
FALSE
;

864 
$”rÜR‘
['msg']['noRule'][] = 'NOTICE:key {$k} is‚ot include„ule';

865 
$”rÜR‘
['succ'] = 
FALSE
;

869  
$”rÜR‘
;

870 
	}
}

884 
funùiÚ
 
	$ruËFunc
(
$sign
, 
$ty³
, 
$Ëngth
, 
$isPrim¬y
, 
$»ÏtiÚ
, 
$v®
){

885 
$v®
 = 
	`Œim
($val);

886 
$ËnV®
 = 
	`mb_¡¾’
(
$v®
, 'UTF-8');

887 
$ty³V®
 = 
	`g‘ty³
(
$v®
);

888 if(
$sign
 === "ignore"){

889  
Œue
;

890 }
	`–£if
(
$sign
 === "required"){

891 
	`li¡
(
$ty³RuËK
, 
$ty³RuËV
èğ
	`ex¶ode
(":", 
$ty³
);

892 
	`li¡
(
$ËngthRuËK
, 
$ËngthRuËV
èğ
	`ex¶ode
(":", 
$Ëngth
);

893 if(
	`em±y
(
$v®
)){

896 if(
$ty³V®
 !=ğ
$ty³RuËV
){

899 if(
$ËnV®
 > 
$ËngthRuËV
){

905  
TRUE
;

906 
	}
}

915 
funùiÚ
 
	$»gexPhÚe
(
$phÚeNumb”
){

916 if(
	`´eg_m©ch
("/1[3458]{1}\d{9}$/", 
$phÚeNumb”
)){

917  
TRUE
;

919  
FALSE
;

921 
	}
}

930 
funùiÚ
 
	$»gexT–
(
$‹lNumb”
){

931 if(
	`´eg_m©ch
("/^([0-9]{3,4}-)?[0-9]{7,8}$/", 
$‹lNumb”
)){

932  
TRUE
;

934  
FALSE
;

936 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Config.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_CÚfig
 {

36 
v¬
 
	m$cÚfig
 = 
¬¿y
();

42 
v¬
 
	m$is_lßded
 = 
¬¿y
();

48 
v¬
 
	m$_cÚfig_·ths
 = 
¬¿y
(
APPPATH
);

61 
funùiÚ
 
	$__cÚ¡ruù
()

63 
$this
->
cÚfig
 =& 
	`g‘_cÚfig
();

64 
	`log_mes§ge
('debug', "Config Class Initialized");

67 ià(
$this
->
cÚfig
['base_url'] == '')

69 ià(
	`is£t
(
$_SERVER
['HTTP_HOST']))

71 
$ba£_u¾
 = 
	`is£t
(
$_SERVER
['HTTPS']è&& 
	`¡¹Şow”
($_SERVER['HTTPS']) !== 'off' ? 'https' : 'http';

72 
$ba£_u¾
 .ğ'://'. 
$_SERVER
['HTTP_HOST'];

73 
$ba£_u¾
 .ğ
	`¡r_»¶aû
(
	`ba£Çme
(
$_SERVER
['SCRIPT_NAME']), '', $_SERVER['SCRIPT_NAME']);

78 
$ba£_u¾
 = 'http://localhost/';

81 
$this
->
	`£t_™em
('ba£_u¾', 
$ba£_u¾
);

96 
funùiÚ
 
	`lßd
(
$fe
 = '', 
$u£_£ùiÚs
 = 
FALSE
, 
$ç_g¿ûfuÎy
 = FALSE)

98 
$fe
 = ($f=ğ''è? 'cÚfig' : 
	`¡r_»¶aû
('.php', '', $file);

99 
$found
 = 
FALSE
;

100 
$lßded
 = 
FALSE
;

102 
$check_loÿtiÚs
 = 
	`defšed
('ENVIRONMENT')

103 ? 
	`¬¿y
(
ENVIRONMENT
.'/'.
$fe
, $file)

104 : 
	`¬¿y
(
$fe
);

106 
	`fÜ—ch
 (
$this
->
_cÚfig_·ths
 
as
 
$·th
)

108 
	`fÜ—ch
 (
$check_loÿtiÚs
 
as
 
$loÿtiÚ
)

110 
$fe_·th
 = 
$·th
.'cÚfig/'.
$loÿtiÚ
.'.php';

112 ià(
	`š_¬¿y
(
$fe_·th
, 
$this
->
is_lßded
, 
TRUE
))

114 
$lßded
 = 
TRUE
;

118 ià(
	`fe_exi¡s
(
$fe_·th
))

120 
$found
 = 
TRUE
;

125 ià(
$found
 ==ğ
FALSE
)

130 
	`šşude
(
$fe_·th
);

132 iàĞ! 
	`is£t
(
$cÚfig
è
OR
 ! 
	`is_¬¿y
($config))

134 ià(
$ç_g¿ûfuÎy
 ==ğ
TRUE
)

136  
FALSE
;

138 
	`show_”rÜ
('You¸'.
$fe_·th
.' file does‚ot‡ppearo contain‡ valid configuration‡rray.');

141 ià(
$u£_£ùiÚs
 ==ğ
TRUE
)

143 ià(
	`is£t
(
$this
->
cÚfig
[
$fe
]))

145 
$this
->
cÚfig
[
$fe
] = 
	`¬¿y_m”ge
($this->cÚfig[$fe], 
$cÚfig
);

149 
$this
->
cÚfig
[
$fe
] = 
$cÚfig
;

154 
$this
->
cÚfig
 = 
	`¬¿y_m”ge
($this->cÚfig, 
$cÚfig
);

157 
$this
->
is_lßded
[] = 
$fe_·th
;

158 
	`un£t
(
$cÚfig
);

160 
$lßded
 = 
TRUE
;

161 
	`log_mes§ge
('debug', 'CÚfig flßded: '.
$fe_·th
);

165 ià(
$lßded
 ==ğ
FALSE
)

167 ià(
$ç_g¿ûfuÎy
 ==ğ
TRUE
)

169  
FALSE
;

171 
	`show_”rÜ
('ThcÚfigu¿tiÚ f'.
$fe
.'.php does‚otƒxist.');

174  
TRUE
;

175 
	}
}

189 
funùiÚ
 
™em
(
$™em
, 
$šdex
 = '')

191 ià(
$šdex
 == '')

193 iàĞ! 
is£t
(
$this
->
cÚfig
[
$™em
]))

195  
FALSE
;

198 
	g$´ef
 = 
$this
->
cÚfig
[
$™em
];

202 iàĞ! 
is£t
(
$this
->
cÚfig
[
$šdex
]))

204  
	gFALSE
;

207 iàĞ! 
is£t
(
$this
->
cÚfig
[
$šdex
][
$™em
]))

209  
	gFALSE
;

212 
	g$´ef
 = 
$this
->
cÚfig
[
$šdex
][
$™em
];

215  
	g$´ef
;

228 
funùiÚ
 
	$¦ash_™em
(
$™em
)

230 iàĞ! 
	`is£t
(
$this
->
cÚfig
[
$™em
]))

232  
FALSE
;

234 ifĞ
	`Œim
(
$this
->
cÚfig
[
$™em
]) == '')

239  
	`¹rim
(
$this
->
cÚfig
[
$™em
], '/').'/';

240 
	}
}

252 
funùiÚ
 
s™e_u¾
(
$uri
 = '')

254 ià(
$uri
 == '')

256  
$this
->
¦ash_™em
('ba£_u¾').$this->
™em
('index_page');

259 ià(
	g$this
->
™em
('’abË_qu”y_¡ršgs'è=ğ
FALSE
)

261 
$suffix
 = (
$this
->
™em
('u¾_suffix'è=ğ
FALSE
) ? '' : $this->item('url_suffix');

262  
	g$this
->
¦ash_™em
('ba£_u¾').$this->¦ash_™em('šdex_·ge').$this->
_uri_¡ršg
(
$uri
).
	g$suffix
;

266  
	g$this
->
¦ash_™em
('ba£_u¾').$this->
™em
('šdex_·ge').'?'.$this->
_uri_¡ršg
(
$uri
);

280 
funùiÚ
 
ba£_u¾
(
$uri
 = '')

282  
$this
->
¦ash_™em
('ba£_u¾').
Érim
($this->
_uri_¡ršg
(
$uri
), '/');

294 
´Ùeùed
 
funùiÚ
 
	$_uri_¡ršg
(
$uri
)

296 ià(
$this
->
	`™em
('’abË_qu”y_¡ršgs'è=ğ
FALSE
)

298 ià(
	`is_¬¿y
(
$uri
))

300 
$uri
 = 
	`im¶ode
('/', $uri);

302 
$uri
 = 
	`Œim
($uri, '/');

306 ià(
	`is_¬¿y
(
$uri
))

308 
$i
 = 0;

309 
$¡r
 = '';

310 
	`fÜ—ch
 (
$uri
 
as
 
$key
 => 
$v®
)

312 
$´efix
 = (
$i
 == 0) ? '' : '&';

313 
$¡r
 .ğ
$´efix
.
$key
.'='.
$v®
;

314 
$i
++;

316 
$uri
 = 
$¡r
;

319  
$uri
;

320 
	}
}

330 
funùiÚ
 
	$sy¡em_u¾
()

332 
$x
 = 
	`ex¶ode
("/", 
	`´eg_»¶aû
("|/*(.+?)/*$|", "\\1", 
BASEPATH
));

333  
$this
->
	`¦ash_™em
('ba£_u¾').
	`’d
(
$x
).'/';

334 
	}
}

346 
funùiÚ
 
	$£t_™em
(
$™em
, 
$v®ue
)

348 
$this
->
cÚfig
[
$™em
] = 
$v®ue
;

349 
	}
}

364 
funùiÚ
 
_assign_to_cÚfig
(
$™ems
 = 
	$¬¿y
())

366 ià(
	`is_¬¿y
(
$™ems
))

368 
	`fÜ—ch
 (
$™ems
 
as
 
$key
 => 
$v®
)

370 
$this
->
	`£t_™em
(
$key
, 
$v®
);

373 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Controller.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

30 şas 
	cCI_CÚŒŞËr
 {

32 
´iv©e
 
	m$š¡ªû
;

37 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

39 
£lf
::
$š¡ªû
 =& 
$this
;

44 
	`fÜ—ch
 (
	`is_lßded
(è
as
 
$v¬
 => 
$şass
)

46 
$this
->
$v¬
 =& 
	`lßd_şass
(
$şass
);

49 
$this
->
lßd
 =& 
	`lßd_şass
('Loader', 'core');

51 
$this
->
lßd
->
	`š™Ÿlize
();

53 
	`log_mes§ge
('debug', "Controller Class Initialized");

56 
public
 
funùiÚ
 &
	$g‘_š¡ªû
()

58  
£lf
::
$š¡ªû
;

59 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Exceptions.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Exû±iÚs
 {

28 
v¬
 
	m$aùiÚ
;

29 
v¬
 
	m$£v”™y
;

30 
v¬
 
	m$mes§ge
;

31 
v¬
 
	m$f’ame
;

32 
v¬
 
	m$lše
;

40 
v¬
 
	m$ob_Ëv–
;

48 
v¬
 
	m$Ëv–s
 = 
¬¿y
(

49 
E_ERROR
 => 'Error',

50 
E_WARNING
 => 'Warning',

51 
E_PARSE
 => 'Parsing Error',

52 
E_NOTICE
 => 'Notice',

53 
E_CORE_ERROR
 => 'Core Error',

54 
E_CORE_WARNING
 => 'Core Warning',

55 
E_COMPILE_ERROR
 => 'Compile Error',

56 
E_COMPILE_WARNING
 => 'Compile Warning',

57 
E_USER_ERROR
 => 'User Error',

58 
E_USER_WARNING
 => 'User Warning',

59 
E_USER_NOTICE
 => 'User Notice',

60 
E_STRICT
 => 'Runtime Notice'

67 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

69 
$this
->
ob_Ëv–
 = 
	`ob_g‘_Ëv–
();

87 
funùiÚ
 
	$log_exû±iÚ
(
$£v”™y
, 
$mes§ge
, 
$f•©h
, 
$lše
)

89 
$£v”™y
 = ( ! 
	`is£t
(
$this
->
Ëv–s
[$severity])) ? $severity : $this->levels[$severity];

91 
	`log_mes§ge
('”rÜ', 'Sev”™y: '.
$£v”™y
.' --> '.
$mes§ge
. ' '.
$f•©h
.' '.
$lše
, 
TRUE
);

92 
	}
}

104 
funùiÚ
 
show_404
(
$·ge
 = '', 
$log_”rÜ
 = 
TRUE
)

106 
$h—dšg
 = "404 Page Not Found";

107 
	g$mes§ge
 = "The…age you„equested was‚ot found.";

110 ià(
	g$log_”rÜ
)

112 
log_mes§ge
('”rÜ', '404 PagNÙ Found --> '.
$·ge
);

115 
echo
 
	g$this
->
show_”rÜ
(
$h—dšg
, 
$mes§ge
, 'error_404', 404);

116 
	gex™
;

135 
funùiÚ
 
show_”rÜ
(
$h—dšg
, 
$mes§ge
, 
$‹m¶©e
 = '”rÜ_g’”®', 
$¡©us_code
 = 500)

137 
£t_¡©us_h—d”
(
$¡©us_code
);

139 
	g$mes§ge
 = '<p>'.
im¶ode
('</p><p>', ( ! 
is_¬¿y
(
$mes§ge
)è? 
¬¿y
($message) : $message).'</p>';

141 ià(
ob_g‘_Ëv–
(è> 
	g$this
->
	gob_Ëv–
 + 1)

143 
ob_’d_æush
();

145 
ob_¡¬t
();

146 
šşude
(
APPPATH
.'”rÜs/'.
$‹m¶©e
.'.php');

147 
	g$bufãr
 = 
ob_g‘_cÚ‹Ás
();

148 
ob_’d_ş—n
();

149  
	g$bufãr
;

164 
funùiÚ
 
	$show_php_”rÜ
(
$£v”™y
, 
$mes§ge
, 
$f•©h
, 
$lše
)

166 
$£v”™y
 = ( ! 
	`is£t
(
$this
->
Ëv–s
[$severity])) ? $severity : $this->levels[$severity];

168 
$f•©h
 = 
	`¡r_»¶aû
("\\", "/", $filepath);

171 ià(
FALSE
 !=ğ
	`¡½os
(
$f•©h
, '/'))

173 
$x
 = 
	`ex¶ode
('/', 
$f•©h
);

174 
$f•©h
 = 
$x
[
	`couÁ
($x)-2].'/'.
	`’d
($x);

177 ià(
	`ob_g‘_Ëv–
(è> 
$this
->
ob_Ëv–
 + 1)

179 
	`ob_’d_æush
();

181 
	`ob_¡¬t
();

182 
	`šşude
(
APPPATH
.'errors/error_php.php');

183 
$bufãr
 = 
	`ob_g‘_cÚ‹Ás
();

184 
	`ob_’d_ş—n
();

185 
echo
 
$bufãr
;

186 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Hooks.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_Hooks
 {

36 
v¬
 
	m$’abËd
 = 
FALSE
;

42 
v¬
 
	m$hooks
 = 
¬¿y
();

48 
v¬
 
	m$š_´og»ss
 = 
FALSE
;

54 
funùiÚ
 
	$__cÚ¡ruù
()

56 
$this
->
	`_š™Ÿlize
();

57 
	`log_mes§ge
('debug', "Hooks Class Initialized");

68 
funùiÚ
 
	$_š™Ÿlize
()

70 
$CFG
 =& 
	`lßd_şass
('Config', 'core');

75 ià(
$CFG
->
	`™em
('’abË_hooks'è=ğ
FALSE
)

83 ià(
	`defšed
('ENVIRONMENT'è
AND
 
	`is_fe
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/hooks.php'))

85 
	`šşude
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/hooks.php');

87 
	`–£if
 (
	`is_fe
(
APPPATH
.'config/hooks.php'))

89 
	`šşude
(
APPPATH
.'config/hooks.php');

93 iàĞ! 
	`is£t
(
$hook
è
OR
 ! 
	`is_¬¿y
($hook))

98 
$this
->
hooks
 =& 
$hook
;

99 
$this
->
’abËd
 = 
TRUE
;

100 
	}
}

113 
funùiÚ
 
_ÿÎ_hook
(
$which
 = '')

115 iàĞ! 
$this
->
’abËd
 
OR
 ! 
is£t
($this->
hooks
[
$which
]))

117  
FALSE
;

120 ià(
is£t
(
$this
->
hooks
[
$which
][0]è
AND
 
is_¬¿y
($this->hooks[$which][0]))

122 
fÜ—ch
 (
$this
->
hooks
[
$which
] 
as
 
$v®
)

124 
	g$this
->
_run_hook
(
$v®
);

129 
	g$this
->
_run_hook
(
$this
->
hooks
[
$which
]);

132  
	gTRUE
;

146 
funùiÚ
 
	$_run_hook
(
$d©a
)

148 iàĞ! 
	`is_¬¿y
(
$d©a
))

150  
FALSE
;

160 ià(
$this
->
š_´og»ss
 =ğ
TRUE
)

169 iàĞ! 
	`is£t
(
$d©a
['f•©h']è
OR
 ! isset($data['filename']))

171  
FALSE
;

174 
$f•©h
 = 
APPPATH
.
$d©a
['filepath'].'/'.$data['filename'];

176 iàĞ! 
	`fe_exi¡s
(
$f•©h
))

178  
FALSE
;

185 
$şass
 = 
FALSE
;

186 
$funùiÚ
 = 
FALSE
;

187 
$·¿ms
 = '';

189 ià(
	`is£t
(
$d©a
['şass']è
AND
 $data['class'] != '')

191 
$şass
 = 
$d©a
['class'];

194 ià(
	`is£t
(
$d©a
['function']))

196 
$funùiÚ
 = 
$d©a
['function'];

199 ià(
	`is£t
(
$d©a
['params']))

201 
$·¿ms
 = 
$d©a
['params'];

204 ià(
$şass
 ==ğ
FALSE
 
AND
 
$funùiÚ
 === FALSE)

206  
FALSE
;

213 
$this
->
š_´og»ss
 = 
TRUE
;

219 ià(
$şass
 !=ğ
FALSE
)

221 iàĞ! 
	`şass_exi¡s
(
$şass
))

223 
	`»quœe
(
$f•©h
);

226 
$HOOK
 = 
Ãw
 
$şass
;

227 
$HOOK
->
	`$funùiÚ
(
$·¿ms
);

231 iàĞ! 
	`funùiÚ_exi¡s
(
$funùiÚ
))

233 
	`»quœe
(
$f•©h
);

236 
	`$funùiÚ
(
$·¿ms
);

239 
$this
->
š_´og»ss
 = 
FALSE
;

240  
TRUE
;

241 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Input.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_IÅut
 {

36 
v¬
 
	m$_add»ss
 = 
FALSE
;

42 
v¬
 
	m$u£r_ag’t
 = 
FALSE
;

48 
v¬
 
	m$_®low_g‘_¬¿y
 = 
TRUE
;

54 
v¬
 
	m$_¡ªd¬dize_Ãwlšes
 = 
TRUE
;

61 
v¬
 
	m$_’abË_xss
 = 
FALSE
;

68 
v¬
 
	m$_’abË_c¤f
 = 
FALSE
;

74 
´Ùeùed
 
	m$h—d”s
 = 
¬¿y
();

84 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

86 
	`log_mes§ge
('debug', "Input Class Initialized");

88 
$this
->
_®low_g‘_¬¿y
 = (
	`cÚfig_™em
('®low_g‘_¬¿y'è==ğ
TRUE
);

89 
$this
->
_’abË_xss
 = (
	`cÚfig_™em
('glob®_xss_f‹ršg'è==ğ
TRUE
);

90 
$this
->
_’abË_c¤f
 = (
	`cÚfig_™em
('c¤f_´ÙeùiÚ'è==ğ
TRUE
);

92 
glob®
 
$SEC
;

93 
$this
->
£cur™y
 =& 
$SEC
;

96 ià(
UTF8_ENABLED
 ==ğ
TRUE
)

98 
glob®
 
$UNI
;

99 
$this
->
uni
 =& 
$UNI
;

103 
$this
->
	`_§n™ize_glob®s
();

119 
funùiÚ
 
	`_ãtch_äom_¬¿y
(&
$¬¿y
, 
$šdex
 = '', 
$xss_ş—n
 = 
FALSE
)

121 iàĞ! 
	`is£t
(
$¬¿y
[
$šdex
]))

123  
FALSE
;

126 ià(
$xss_ş—n
 ==ğ
TRUE
)

128  
$this
->
£cur™y
->
	`xss_ş—n
(
$¬¿y
[
$šdex
]);

131  
$¬¿y
[
$šdex
];

132 
	}
}

144 
funùiÚ
 
	$g‘
(
$šdex
 = 
NULL
, 
$xss_ş—n
 = 
FALSE
)

147 ià(
$šdex
 ==ğ
NULL
 
AND
 ! 
	`em±y
(
$_GET
))

149 
$g‘
 = 
	`¬¿y
();

152 
	`fÜ—ch
 (
	`¬¿y_keys
(
$_GET
è
as
 
$key
)

154 
$g‘
[
$key
] = 
$this
->
	`_ãtch_äom_¬¿y
(
$_GET
, $key, 
$xss_ş—n
);

156  
$g‘
;

159  
$this
->
	`_ãtch_äom_¬¿y
(
$_GET
, 
$šdex
, 
$xss_ş—n
);

160 
	}
}

172 
funùiÚ
 
	$po¡
(
$šdex
 = 
NULL
, 
$xss_ş—n
 = 
FALSE
)

175 ià(
$šdex
 ==ğ
NULL
 
AND
 ! 
	`em±y
(
$_POST
))

177 
$po¡
 = 
	`¬¿y
();

180 
	`fÜ—ch
 (
	`¬¿y_keys
(
$_POST
è
as
 
$key
)

182 
$po¡
[
$key
] = 
$this
->
	`_ãtch_äom_¬¿y
(
$_POST
, $key, 
$xss_ş—n
);

184  
$po¡
;

187  
$this
->
	`_ãtch_äom_¬¿y
(
$_POST
, 
$šdex
, 
$xss_ş—n
);

188 
	}
}

201 
funùiÚ
 
g‘_po¡
(
$šdex
 = '', 
$xss_ş—n
 = 
FALSE
)

203 iàĞ! 
is£t
(
$_POST
[
$šdex
]) )

205  
$this
->
g‘
(
$šdex
, 
$xss_ş—n
);

209  
	g$this
->
po¡
(
$šdex
, 
$xss_ş—n
);

223 
funùiÚ
 
cook›
(
$šdex
 = '', 
$xss_ş—n
 = 
FALSE
)

225  
$this
->
_ãtch_äom_¬¿y
(
$_COOKIE
, 
$šdex
, 
$xss_ş—n
);

246 
funùiÚ
 
£t_cook›
(
$Çme
 = '', 
$v®ue
 = '', 
$expœe
 = '', 
$domaš
 = '', 
$·th
 = '/', 
$´efix
 = '', 
$£cu»
 = 
FALSE
)

248 ià(
is_¬¿y
(
$Çme
))

251 
fÜ—ch
 (
¬¿y
('v®ue', 'expœe', 'domaš', '·th', '´efix', '£cu»', 'Çme'è
as
 
$™em
)

253 ià(
is£t
(
$Çme
[
$™em
]))

255 
$$™em
 = 
$Çme
[
$™em
];

260 ià(
	g$´efix
 =ğ'' 
AND
 
cÚfig_™em
('cookie_prefix') != '')

262 
$´efix
 = 
cÚfig_™em
('cookie_prefix');

264 ià(
	g$domaš
 =ğ'' 
AND
 
cÚfig_™em
('cookie_domain') != '')

266 
$domaš
 = 
cÚfig_™em
('cookie_domain');

268 ià(
	g$·th
 =ğ'/' 
AND
 
cÚfig_™em
('cookie_path') != '/')

270 
$·th
 = 
cÚfig_™em
('cookie_path');

272 ià(
	g$£cu»
 =ğ
FALSE
 
AND
 
cÚfig_™em
('cookie_secure') != FALSE)

274 
$£cu»
 = 
cÚfig_™em
('cookie_secure');

277 iàĞ! 
is_num”ic
(
$expœe
))

279 
	g$expœe
 = 
time
() - 86500;

283 
	g$expœe
 = (
$expœe
 > 0è? 
time
() + $expire : 0;

286 
£tcook›
(
$´efix
.
$Çme
, 
$v®ue
, 
$expœe
, 
$·th
, 
$domaš
, 
$£cu»
);

299 
funùiÚ
 
£rv”
(
$šdex
 = '', 
$xss_ş—n
 = 
FALSE
)

301  
$this
->
_ãtch_äom_¬¿y
(
$_SERVER
, 
$šdex
, 
$xss_ş—n
);

311 
public
 
funùiÚ
 
	$_add»ss
()

313 ià(
$this
->
_add»ss
 !=ğ
FALSE
)

315  
$this
->
_add»ss
;

318 
$´oxy_s
 = 
	`cÚfig_™em
('proxy_ips');

319 iàĞ! 
	`em±y
(
$´oxy_s
))

321 
$´oxy_s
 = 
	`ex¶ode
(',', 
	`¡r_»¶aû
(' ', '', $proxy_ips));

322 
	`fÜ—ch
 (
	`¬¿y
('HTTP_X_FORWARDED_FOR', 'HTTP_CLIENT_IP', 'HTTP_X_CLIENT_IP', 'HTTP_X_CLUSTER_CLIENT_IP'è
as
 
$h—d”
)

324 ià((
$¥oof
 = 
$this
->
	`£rv”
(
$h—d”
)è!=ğ
FALSE
)

329 ià(
	`¡½os
(
$¥oof
, ','è!=ğ
FALSE
)

331 
$¥oof
 = 
	`ex¶ode
(',', $spoof, 2);

332 
$¥oof
 = $spoof[0];

335 iàĞ! 
$this
->
	`v®id_
(
$¥oof
))

337 
$¥oof
 = 
FALSE
;

346 
$this
->
_add»ss
 = (
$¥oof
 !=ğ
FALSE
 && 
	`š_¬¿y
(
$_SERVER
['REMOTE_ADDR'], 
$´oxy_s
, 
TRUE
))

347 ? 
$¥oof
 : 
$_SERVER
['REMOTE_ADDR'];

351 
$this
->
_add»ss
 = 
$_SERVER
['REMOTE_ADDR'];

354 iàĞ! 
$this
->
	`v®id_
($this->
_add»ss
))

356 
$this
->
_add»ss
 = '0.0.0.0';

359  
$this
->
_add»ss
;

360 
	}
}

372 
public
 
funùiÚ
 
v®id_
(
$
, 
$which
 = '')

374 
$which
 = 
¡¹Şow”
($which);

377 ià(
is_ÿÎabË
('filter_var'))

379 
	g$which
) {

381 
$æag
 = 
FILTER_FLAG_IPV4
;

384 
$æag
 = 
FILTER_FLAG_IPV6
;

387 
$æag
 = '';

391  (
	gboŞ
è
f‹r_v¬
(
$
, 
FILTER_VALIDATE_IP
, 
$æag
);

394 ià(
	g$which
 !=ğ'v6' && 
$which
 !== 'ipv4')

396 ià(
¡½os
(
$
, ':'è!=ğ
FALSE
)

398 
$which
 = 'ipv6';

400 
–£if
 (
¡½os
(
$
, '.'è!=ğ
FALSE
)

402 
$which
 = 'ipv4';

406  
	gFALSE
;

410 
	g$func
 = '_v®id_'.
$which
;

411  
	g$this
->
$func
(
$
);

425 
´Ùeùed
 
funùiÚ
 
	$_v®id_v4
(
$
)

427 
$_£gm’ts
 = 
	`ex¶ode
('.', 
$
);

430 ià(
	`couÁ
(
$_£gm’ts
) !== 4)

432  
FALSE
;

435 ià(
$_£gm’ts
[0][0] == '0')

437  
FALSE
;

441 
	`fÜ—ch
 (
$_£gm’ts
 
as
 
$£gm’t
)

445 ià(
$£gm’t
 =ğ'' 
OR
 
	`´eg_m©ch
("/[^0-9]/", $£gm’tèOR $£gm’ˆ> 255 OR 
	`¡¾’
($segment) > 3)

447  
FALSE
;

451  
TRUE
;

452 
	}
}

463 
´Ùeùed
 
funùiÚ
 
	$_v®id_v6
(
$¡r
)

469 
$groups
 = 8;

470 
$cŞÏp£d
 = 
FALSE
;

472 
$chunks
 = 
	`¬¿y_f‹r
(

473 
	`´eg_¥l™
('/(:{1,2})/', 
$¡r
, 
NULL
, 
PREG_SPLIT_DELIM_CAPTURE
)

477 ià(
	`cu¼’t
(
$chunks
è=ğ':' 
OR
 
	`’d
($chunks) == ':')

479  
FALSE
;

483 ià(
	`¡½os
(
	`’d
(
$chunks
), '.'è!=ğ
FALSE
)

485 
$v4
 = 
	`¬¿y_pİ
(
$chunks
);

487 iàĞ! 
$this
->
	`_v®id_v4
(
$v4
))

489  
FALSE
;

492 
$groups
--;

495 
$£g
 = 
	`¬¿y_pİ
(
$chunks
))

497 ià(
$£g
[0] == ':')

499 ià(--
$groups
 == 0)

501  
FALSE
;

504 ià(
	`¡¾’
(
$£g
) > 2)

506  
FALSE
;

509 ià(
$£g
 == '::')

511 ià(
$cŞÏp£d
)

513  
FALSE
;

516 
$cŞÏp£d
 = 
TRUE
;

519 
	`–£if
 (
	`´eg_m©ch
("/[^0-9a-f]/i", 
$£g
è
OR
 
	`¡¾’
($seg) > 4)

521  
FALSE
;

525  
$cŞÏp£d
 
OR
 
$groups
 == 1;

526 
	}
}

536 
funùiÚ
 
	$u£r_ag’t
()

538 ià(
$this
->
u£r_ag’t
 !=ğ
FALSE
)

540  
$this
->
u£r_ag’t
;

543 
$this
->
u£r_ag’t
 = ( ! 
	`is£t
(
$_SERVER
['HTTP_USER_AGENT'])è? 
FALSE
 : $_SERVER['HTTP_USER_AGENT'];

545  
$this
->
u£r_ag’t
;

546 
	}
}

564 
funùiÚ
 
	$_§n™ize_glob®s
()

567 
$´Ùeùed
 = 
	`¬¿y
('_SERVER', '_GET', '_POST', '_FILES', '_REQUEST',

574 
	`fÜ—ch
 (
	`¬¿y
(
$_GET
, 
$_POST
, 
$_COOKIE
è
as
 
$glob®
)

576 iàĞ! 
	`is_¬¿y
(
$glob®
))

578 iàĞ! 
	`š_¬¿y
(
$glob®
, 
$´Ùeùed
))

580 
glob®
 
$$glob®
;

581 
$$glob®
 = 
NULL
;

586 
	`fÜ—ch
 (
$glob®
 
as
 
$key
 => 
$v®
)

588 iàĞ! 
	`š_¬¿y
(
$key
, 
$´Ùeùed
))

590 
glob®
 
$$key
;

591 
$$key
 = 
NULL
;

598 ià(
$this
->
_®low_g‘_¬¿y
 =ğ
FALSE
)

600 
$_GET
 = 
	`¬¿y
();

604 ià(
	`is_¬¿y
(
$_GET
è
AND
 
	`couÁ
($_GET) > 0)

606 
	`fÜ—ch
 (
$_GET
 
as
 
$key
 => 
$v®
)

608 
$_GET
[
$this
->
	`_ş—n_šput_keys
(
$key
)] = $this->
	`_ş—n_šput_d©a
(
$v®
);

614 ià(
	`is_¬¿y
(
$_POST
è
AND
 
	`couÁ
($_POST) > 0)

616 
	`fÜ—ch
 (
$_POST
 
as
 
$key
 => 
$v®
)

618 
$_POST
[
$this
->
	`_ş—n_šput_keys
(
$key
)] = $this->
	`_ş—n_šput_d©a
(
$v®
);

623 ià(
	`is_¬¿y
(
$_COOKIE
è
AND
 
	`couÁ
($_COOKIE) > 0)

630 
	`un£t
(
$_COOKIE
['$Version']);

631 
	`un£t
(
$_COOKIE
['$Path']);

632 
	`un£t
(
$_COOKIE
['$Domain']);

634 
	`fÜ—ch
 (
$_COOKIE
 
as
 
$key
 => 
$v®
)

636 
$_COOKIE
[
$this
->
	`_ş—n_šput_keys
(
$key
)] = $this->
	`_ş—n_šput_d©a
(
$v®
);

641 
$_SERVER
['PHP_SELF'] = 
	`¡r_gs
($_SERVER['PHP_SELF']);

645 ià(
$this
->
_’abË_c¤f
 =ğ
TRUE
 && ! $this->
	`is_şi_»que¡
())

647 
$this
->
£cur™y
->
	`c¤f_v”ify
();

650 
	`log_mes§ge
('debug', "Global POST‡nd COOKIE data sanitized");

651 
	}
}

665 
funùiÚ
 
	$_ş—n_šput_d©a
(
$¡r
)

667 ià(
	`is_¬¿y
(
$¡r
))

669 
$Ãw_¬¿y
 = 
	`¬¿y
();

670 
	`fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

672 
$Ãw_¬¿y
[
$this
->
	`_ş—n_šput_keys
(
$key
)] = $this->
	`_ş—n_šput_d©a
(
$v®
);

674  
$Ãw_¬¿y
;

682 iàĞ! 
	`is_php
('5.4'è&& 
	`g‘_magic_quÙes_gpc
())

684 
$¡r
 = 
	`¡r¦ashes
($str);

688 ià(
UTF8_ENABLED
 ==ğ
TRUE
)

690 
$¡r
 = 
$this
->
uni
->
	`ş—n_¡ršg
($str);

694 
$¡r
 = 
	`»move_švisibË_ch¬aù”s
($str);

697 ià(
$this
->
_’abË_xss
 ==ğ
TRUE
)

699 
$¡r
 = 
$this
->
£cur™y
->
	`xss_ş—n
($str);

703 ià(
$this
->
_¡ªd¬dize_Ãwlšes
 =ğ
TRUE
)

705 ià(
	`¡½os
(
$¡r
, "\r"è!=ğ
FALSE
)

707 
$¡r
 = 
	`¡r_»¶aû
(
	`¬¿y
("\r\n", "\r", "\r\n\n"), 
PHP_EOL
, $str);

711  
$¡r
;

712 
	}
}

727 
funùiÚ
 
	$_ş—n_šput_keys
(
$¡r
)

729 
$cÚfig
=&
	`g‘_cÚfig
('config');

730 iàĞ! 
	`´eg_m©ch
("/^[".
$cÚfig
['³rm™‹d_uri_ch¬s']."]+$/i", 
	`¿wu¾’code
(
$¡r
)))

732 
	`ex™
('Disallowed Key Characters.');

736 ià(
UTF8_ENABLED
 ==ğ
TRUE
)

738 
$¡r
 = 
$this
->
uni
->
	`ş—n_¡ršg
($str);

741  
$¡r
;

742 
	}
}

756 
public
 
funùiÚ
 
	$»que¡_h—d”s
(
$xss_ş—n
 = 
FALSE
)

759 ià(
	`funùiÚ_exi¡s
('apache_request_headers'))

761 
$h—d”s
 = 
	`­ache_»que¡_h—d”s
();

765 
$h—d”s
['CÚ‹Á-Ty³'] = (
	`is£t
(
$_SERVER
['CONTENT_TYPE'])è? $_SERVER['CONTENT_TYPE'] : @
	`g‘’v
('CONTENT_TYPE');

767 
	`fÜ—ch
 (
$_SERVER
 
as
 
$key
 => 
$v®
)

769 ià(
	`¡ºcmp
(
$key
, 'HTTP_', 5) === 0)

771 
$h—d”s
[
	`sub¡r
(
$key
, 5)] = 
$this
->
	`_ãtch_äom_¬¿y
(
$_SERVER
, $key, 
$xss_ş—n
);

777 
	`fÜ—ch
 (
$h—d”s
 
as
 
$key
 => 
$v®
)

779 
$key
 = 
	`¡r_»¶aû
('_', ' ', 
	`¡¹Şow”
($key));

780 
$key
 = 
	`¡r_»¶aû
(' ', '-', 
	`ucwÜds
($key));

782 
$this
->
h—d”s
[
$key
] = 
$v®
;

785  
$this
->
h—d”s
;

786 
	}
}

799 
public
 
funùiÚ
 
	$g‘_»que¡_h—d”
(
$šdex
, 
$xss_ş—n
 = 
FALSE
)

801 ià(
	`em±y
(
$this
->
h—d”s
))

803 
$this
->
	`»que¡_h—d”s
();

806 iàĞ! 
	`is£t
(
$this
->
h—d”s
[
$šdex
]))

808  
FALSE
;

811 ià(
$xss_ş—n
 ==ğ
TRUE
)

813  
$this
->
£cur™y
->
	`xss_ş—n
($this->
h—d”s
[
$šdex
]);

816  
$this
->
h—d”s
[
$šdex
];

817 
	}
}

828 
public
 
funùiÚ
 
	$is_ajax_»que¡
()

830  (
$this
->
	`£rv”
('HTTP_X_REQUESTED_WITH') === 'XMLHttpRequest');

831 
	}
}

842 
public
 
funùiÚ
 
	$is_şi_»que¡
()

844  (
	`php_§pi_Çme
(è==ğ'şi' 
OR
 
	`defšed
('STDIN'));

845 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Lang.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Lªg
 {

34 
v¬
 
	m$Ïnguage
 = 
¬¿y
();

40 
v¬
 
	m$is_lßded
 = 
¬¿y
();

47 
funùiÚ
 
	$__cÚ¡ruù
()

49 
	`log_mes§ge
('debug', "Language Class Initialized");

65 
funùiÚ
 
	`lßd
(
$Ïngfe
 = '', 
$idiom
 = '', 
$»tuº
 = 
FALSE
, 
$add_suffix
 = 
TRUE
, 
$®t_·th
 = '')

67 
$Ïngfe
 = 
	`¡r_»¶aû
('.php', '', $langfile);

69 ià(
$add_suffix
 =ğ
TRUE
)

71 
$Ïngfe
 = 
	`¡r_»¶aû
('_lang.', '', $langfile).'_lang';

74 
$Ïngfe
 .= '.php';

76 ià(
	`š_¬¿y
(
$Ïngfe
, 
$this
->
is_lßded
, 
TRUE
))

81 
$cÚfig
 =& 
	`g‘_cÚfig
();

83 ià(
$idiom
 == '')

85 
$deá_Ïng
 = ( ! 
	`is£t
(
$cÚfig
['language'])) ? 'english' : $config['language'];

86 
$idiom
 = (
$deá_Ïng
 == '') ? 'english' : $deft_lang;

90 ià(
$®t_·th
 !ğ'' && 
	`fe_exi¡s
($®t_·th.'Ïnguage/'.
$idiom
.'/'.
$Ïngfe
))

92 
	`šşude
(
$®t_·th
.'Ïnguage/'.
$idiom
.'/'.
$Ïngfe
);

96 
$found
 = 
FALSE
;

98 
	`fÜ—ch
 (
	`g‘_š¡ªû
()->
lßd
->
	`g‘_·ckage_·ths
(
TRUE
è
as
 
$·ckage_·th
)

100 ià(
	`fe_exi¡s
(
$·ckage_·th
.'Ïnguage/'.
$idiom
.'/'.
$Ïngfe
))

102 
	`šşude
(
$·ckage_·th
.'Ïnguage/'.
$idiom
.'/'.
$Ïngfe
);

103 
$found
 = 
TRUE
;

108 ià(
$found
 !=ğ
TRUE
)

110 
	`show_”rÜ
('UÇbËØlßdh»que¡ed†ªguagfe:†ªguage/'.
$idiom
.'/'.
$Ïngfe
);

115 iàĞ! 
	`is£t
(
$Ïng
))

117 
	`log_mes§ge
('”rÜ', 'LªguagfcÚš nØd©a:†ªguage/'.
$idiom
.'/'.
$Ïngfe
);

121 ià(
$»tuº
 =ğ
TRUE
)

123  
$Ïng
;

126 
$this
->
is_lßded
[] = 
$Ïngfe
;

127 
$this
->
Ïnguage
 = 
	`¬¿y_m”ge
($this->Ïnguage, 
$Ïng
);

128 
	`un£t
(
$Ïng
);

130 
	`log_mes§ge
('debug', 'Lªguagflßded:†ªguage/'.
$idiom
.'/'.
$Ïngfe
);

131  
TRUE
;

132 
	}
}

143 
funùiÚ
 
lše
(
$lše
 = '')

145 
$v®ue
 = (
$lše
 =ğ'' 
OR
 ! 
is£t
(
$this
->
Ïnguage
[$lše])è? 
FALSE
 : $this->language[$line];

148 ià(
	g$v®ue
 ==ğ
FALSE
)

150 
log_mes§ge
('”rÜ', 'Could‚Ù fšdhÏnguaglš"'.
$lše
.'"');

153  
	g$v®ue
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Loader.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_Lßd”
 {

38 
´Ùeùed
 
	m$_ci_ob_Ëv–
;

45 
´Ùeùed
 
	m$_ci_v›w_·ths
 = 
¬¿y
();

52 
´Ùeùed
 
	m$_ci_lib¿ry_·ths
 = 
¬¿y
();

59 
´Ùeùed
 
	m$_ci_mod–_·ths
 = 
¬¿y
();

60 
´Ùeùed
 
	m$_ci_cÚŒŞËr_·ths
 = 
¬¿y
();

67 
´Ùeùed
 
	m$_ci_h–³r_·ths
 = 
¬¿y
();

75 
´Ùeùed
 
	m$_ba£_şas£s
 = 
¬¿y
();

82 
´Ùeùed
 
	m$_ci_ÿched_v¬s
 = 
¬¿y
();

89 
´Ùeùed
 
	m$_ci_şas£s
 = 
¬¿y
();

96 
´Ùeùed
 
	m$_ci_lßded_fes
 = 
¬¿y
();

103 
´Ùeùed
 
	m$_ci_mod–s
 = 
¬¿y
();

104 
´Ùeùed
 
	m$_ci_cÚŒŞËrs
 = 
¬¿y
();

111 
´Ùeùed
 
	m$_ci_h–³rs
 = 
¬¿y
();

118 
´Ùeùed
 
	m$_ci_v¬m­
 = 
¬¿y
('unit_test' => 'unit',

126 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

128 
$this
->
_ci_ob_Ëv–
 = 
	`ob_g‘_Ëv–
();

129 
$this
->
_ci_lib¿ry_·ths
 = 
	`¬¿y
(
APPPATH
, 
BASEPATH
);

130 
$this
->
_ci_h–³r_·ths
 = 
	`¬¿y
(
APPPATH
, 
BASEPATH
);

131 
$this
->
_ci_mod–_·ths
 = 
	`¬¿y
(
APPPATH
);

132 
$this
->
_ci_cÚŒŞËr_·ths
 = 
	`¬¿y
(
APPPATH
);

133 
$this
->
_ci_v›w_·ths
 = 
	`¬¿y
(
APPPATH
.'v›ws/' => 
TRUE
);

135 
	`log_mes§ge
('debug', "Loader Class Initialized");

148 
public
 
funùiÚ
 
	$š™Ÿlize
()

150 
$this
->
_ci_şas£s
 = 
	`¬¿y
();

151 
$this
->
_ci_lßded_fes
 = 
	`¬¿y
();

152 
$this
->
_ci_mod–s
 = 
	`¬¿y
();

153 
$this
->
_ba£_şas£s
 =& 
	`is_lßded
();

155 
$this
->
	`_ci_autŞßd”
();

157  
$this
;

158 
	}
}

174 
public
 
funùiÚ
 
	$is_lßded
(
$şass
)

176 ià(
	`is£t
(
$this
->
_ci_şas£s
[
$şass
]))

178  
$this
->
_ci_şas£s
[
$şass
];

181  
FALSE
;

182 
	}
}

197 
public
 
funùiÚ
 
lib¿ry
(
$lib¿ry
 = '', 
$·¿ms
 = 
NULL
, 
$objeù_Çme
 = NULL)

199 ià(
is_¬¿y
(
$lib¿ry
))

201 
fÜ—ch
 (
$lib¿ry
 
as
 
$şass
)

203 
$this
->
lib¿ry
(
$şass
, 
$·¿ms
);

209 ià(
	g$lib¿ry
 =ğ'' 
OR
 
is£t
(
$this
->
_ba£_şas£s
[
$lib¿ry
]))

211  
FALSE
;

214 iàĞ! 
is_nuÎ
(
$·¿ms
è&& ! 
is_¬¿y
($params))

216 
	g$·¿ms
 = 
NULL
;

219 
	g$this
->
_ci_lßd_şass
(
$lib¿ry
, 
$·¿ms
, 
$objeù_Çme
);

224 
public
 
funùiÚ
 
cÚŒŞËr
(
$cÚŒŞËr
, 
$Çme
 = "") {

225 ià(
is_¬¿y
(
$cÚŒŞËr
))

227 
fÜ—ch
 (
$cÚŒŞËr
 
as
 
$ba£
)

229 
$this
->
cÚŒŞËr
(
$ba£
);

234 ià(
	g$cÚŒŞËr
 == '')

239 
	g$·th
 = '';

241 ià((
	g$Ï¡_¦ash
 = 
¡¼pos
(
$cÚŒŞËr
, '/')è!=ğ
FALSE
)

243 
$·th
 = 
sub¡r
(
$cÚŒŞËr
, 0, 
$Ï¡_¦ash
 + 1);

245 
	g$cÚŒŞËr
 = 
sub¡r
(
$cÚŒŞËr
, 
$Ï¡_¦ash
 + 1);

248 ià(
	g$Çme
 == '')

250 
$Çme
 = 
$cÚŒŞËr
;

253 
	g$CI
 =& 
g‘_š¡ªû
();

255 ià(
is£t
(
$CI
->
$Çme
))

257 
show_”rÜ
('ThcÚŒŞË¸Çmyou‡»†ßdšg i thÇmoà¨»sourûh© i ®»ady bešg u£d: '.
$Çme
);

260 
	g$cÚŒŞËr
 = 
¡¹Şow”
(
$cÚŒŞËr
);

262 
fÜ—ch
 (
$this
->
_ci_cÚŒŞËr_·ths
 
as
 
$cÚ_·th
)

264 iàĞ! 
fe_exi¡s
(
$cÚ_·th
.'cÚŒŞËrs/'.
$·th
.
$cÚŒŞËr
.'.php'))

269 
»quœe_Úû
(
$cÚ_·th
.'cÚŒŞËrs/'.
$·th
.
$cÚŒŞËr
.'.php');

271 
	g$cÚŒŞËr
 = 
ucfœ¡
(
$cÚŒŞËr
);

274 
	g$CI
->
	g$Çme
 = 
Ãw
 
$cÚŒŞËr
();

276 
	g$this
->
	g_ci_cÚŒŞËrs
[] = 
$Çme
;

281 
show_”rÜ
('UÇbËØloÿ‹hcÚŒŞË¸you hav¥ecif›d: '.
$_ci_cÚŒŞËrs
);

296 
public
 
funùiÚ
 
mod–
(
$mod–
, 
$Çme
 = '', 
$db_cÚn
 = 
FALSE
)

298 ià(
is_¬¿y
(
$mod–
))

300 
fÜ—ch
 (
$mod–
 
as
 
$babe
)

302 
$this
->
mod–
(
$babe
);

307 ià(
	g$mod–
 == '')

312 
	g$·th
 = '';

315 ià((
	g$Ï¡_¦ash
 = 
¡¼pos
(
$mod–
, '/')è!=ğ
FALSE
)

318 
$·th
 = 
sub¡r
(
$mod–
, 0, 
$Ï¡_¦ash
 + 1);

321 
	g$mod–
 = 
sub¡r
(
$mod–
, 
$Ï¡_¦ash
 + 1);

324 ià(
	g$Çme
 == '')

326 
$Çme
 = 
$mod–
;

329 ià(
š_¬¿y
(
$Çme
, 
$this
->
_ci_mod–s
, 
TRUE
))

334 
	g$CI
 =& 
g‘_š¡ªû
();

335 ià(
is£t
(
$CI
->
$Çme
))

337 
show_”rÜ
('Thmod–‚amyou‡»†ßdšg i thÇmoà¨»sourûh© i ®»ady bešg u£d: '.
$Çme
);

340 
	g$mod–
 = 
¡¹Şow”
(
$mod–
);

342 
fÜ—ch
 (
$this
->
_ci_mod–_·ths
 
as
 
$mod_·th
)

344 iàĞ! 
fe_exi¡s
(
$mod_·th
.'mod–s/'.
$·th
.
$mod–
.'.php'))

349 ià(
	g$db_cÚn
 !=ğ
FALSE
 
AND
 ! 
şass_exi¡s
('CI_DB'))

351 ià(
$db_cÚn
 ==ğ
TRUE
)

353 
$db_cÚn
 = '';

356 
	g$CI
->
	glßd
->
d©aba£
(
$db_cÚn
, 
FALSE
, 
TRUE
);

359 iàĞ! 
şass_exi¡s
('CI_Model'))

361 
lßd_şass
('Model', 'core');

364 
»quœe_Úû
(
$mod_·th
.'mod–s/'.
$·th
.
$mod–
.'.php');

366 
	g$mod–
 = 
ucfœ¡
(
$mod–
);

368 
	g$CI
->
	g$Çme
 = 
Ãw
 
$mod–
();

370 
	g$this
->
	g_ci_mod–s
[] = 
$Çme
;

375 
show_”rÜ
('UÇbËØloÿ‹hmod– you hav¥ecif›d: '.
$mod–
);

388 
public
 
funùiÚ
 
d©aba£
(
$·¿ms
 = '', 
$»tuº
 = 
FALSE
, 
$aùive_»cÜd
 = 
NULL
)

391 
$CI
 =& 
g‘_š¡ªû
();

394 ià(
şass_exi¡s
('CI_DB'è
AND
 
	g$»tuº
 =ğ
FALSE
 AND 
$aùive_»cÜd
 =ğ
NULL
 AND 
is£t
(
$CI
->
db
èAND 
is_objeù
($CI->db))

396  
FALSE
;

399 
»quœe_Úû
(
BASEPATH
.'database/DB.php');

401 ià(
	g$»tuº
 ==ğ
TRUE
)

403  
DB
(
$·¿ms
, 
$aùive_»cÜd
);

408 
	g$CI
->
	gdb
 = '';

411 
	g$CI
->
	gdb
 =& 
DB
(
$·¿ms
, 
$aùive_»cÜd
);

421 
public
 
funùiÚ
 
	$dbut
()

423 iàĞ! 
	`şass_exi¡s
('CI_DB'))

425 
$this
->
	`d©aba£
();

428 
$CI
 =& 
	`g‘_š¡ªû
();

432 
$CI
->
lßd
->
	`dbfÜge
();

434 
	`»quœe_Úû
(
BASEPATH
.'database/DB_utility.php');

435 
	`»quœe_Úû
(
BASEPATH
.'d©aba£/driv”s/'.
$CI
->
db
->
dbdriv”
.'/'.$CI->db->dbdriver.'_utility.php');

436 
$şass
 = 'CI_DB_'.
$CI
->
db
->
dbdriv”
.'_utility';

438 
$CI
->
dbut
 = 
Ãw
 
	`$şass
();

439 
	}
}

448 
public
 
funùiÚ
 
	$dbfÜge
()

450 iàĞ! 
	`şass_exi¡s
('CI_DB'))

452 
$this
->
	`d©aba£
();

455 
$CI
 =& 
	`g‘_š¡ªû
();

457 
	`»quœe_Úû
(
BASEPATH
.'database/DB_forge.php');

458 
	`»quœe_Úû
(
BASEPATH
.'d©aba£/driv”s/'.
$CI
->
db
->
dbdriv”
.'/'.$CI->db->dbdriver.'_forge.php');

459 
$şass
 = 'CI_DB_'.
$CI
->
db
->
dbdriv”
.'_forge';

461 
$CI
->
dbfÜge
 = 
Ãw
 
	`$şass
();

462 
	}
}

482 
public
 
funùiÚ
 
v›w
(
$v›w
, 
$v¬s
 = 
¬¿y
(), 
$»tuº
 = 
FALSE
)

484  
$this
->
_ci_lßd
(
¬¿y
('_ci_v›w' => 
$v›w
, '_ci_v¬s' => $this->
_ci_objeù_to_¬¿y
(
$v¬s
), '_ci_»tuº' => 
$»tuº
));

498 
public
 
funùiÚ
 
	$fe
(
$·th
, 
$»tuº
 = 
FALSE
)

500  
$this
->
	`_ci_lßd
(
	`¬¿y
('_ci_·th' => 
$·th
, '_ci_»tuº' => 
$»tuº
));

501 
	}
}

515 
public
 
funùiÚ
 
v¬s
(
$v¬s
 = 
¬¿y
(), 
$v®
 = '')

517 ià(
$v®
 !ğ'' 
AND
 
is_¡ršg
(
$v¬s
))

519 
$v¬s
 = 
¬¿y
($v¬ => 
$v®
);

522 
	g$v¬s
 = 
$this
->
_ci_objeù_to_¬¿y
(
$v¬s
);

524 ià(
is_¬¿y
(
$v¬s
è
AND
 
couÁ
($vars) > 0)

526 
fÜ—ch
 (
$v¬s
 
as
 
$key
 => 
$v®
)

528 
$this
->
_ci_ÿched_v¬s
[
$key
] = 
$v®
;

543 
public
 
funùiÚ
 
	$g‘_v¬
(
$key
)

545  
	`is£t
(
$this
->
_ci_ÿched_v¬s
[
$key
]è? $this->_ci_ÿched_v¬s[$key] : 
NULL
;

546 
	}
}

558 
public
 
funùiÚ
 
h–³r
(
$h–³rs
 = 
	$¬¿y
())

560 
	`fÜ—ch
 (
$this
->
	`_ci_´•_f’ame
(
$h–³rs
, '_h–³r'è
as
 
$h–³r
)

562 ià(
	`is£t
(
$this
->
_ci_h–³rs
[
$h–³r
]))

567 
$ext_h–³r
 = 
APPPATH
.'h–³rs/'.
	`cÚfig_™em
('subşass_´efix').
$h–³r
.'.php';

570 ià(
	`fe_exi¡s
(
$ext_h–³r
))

572 
$ba£_h–³r
 = 
BASEPATH
.'h–³rs/'.
$h–³r
.'.php';

574 iàĞ! 
	`fe_exi¡s
(
$ba£_h–³r
))

576 
	`show_”rÜ
('UÇbËØlßdh»que¡ed fe: h–³rs/'.
$h–³r
.'.php');

579 
	`šşude_Úû
(
$ext_h–³r
);

580 
	`šşude_Úû
(
$ba£_h–³r
);

582 
$this
->
_ci_h–³rs
[
$h–³r
] = 
TRUE
;

583 
	`log_mes§ge
('debug', 'H–³¸lßded: '.
$h–³r
);

588 
	`fÜ—ch
 (
$this
->
_ci_h–³r_·ths
 
as
 
$·th
)

590 ià(
	`fe_exi¡s
(
$·th
.'h–³rs/'.
$h–³r
.'.php'))

592 
	`šşude_Úû
(
$·th
.'h–³rs/'.
$h–³r
.'.php');

594 
$this
->
_ci_h–³rs
[
$h–³r
] = 
TRUE
;

595 
	`log_mes§ge
('debug', 'H–³¸lßded: '.
$h–³r
);

601 iàĞ! 
	`is£t
(
$this
->
_ci_h–³rs
[
$h–³r
]))

603 
	`show_”rÜ
('UÇbËØlßdh»que¡ed fe: h–³rs/'.
$h–³r
.'.php');

606 
	}
}

619 
public
 
funùiÚ
 
h–³rs
(
$h–³rs
 = 
	$¬¿y
())

621 
$this
->
	`h–³r
(
$h–³rs
);

622 
	}
}

633 
public
 
funùiÚ
 
Ïnguage
(
$fe
 = 
¬¿y
(), 
$Ïng
 = '')

635 
$CI
 =& 
g‘_š¡ªû
();

637 iàĞ! 
is_¬¿y
(
$fe
))

639 
	g$fe
 = 
¬¿y
(
$fe
);

642 
fÜ—ch
 (
$fe
 
as
 
$Ïngfe
)

644 
	g$CI
->
	gÏng
->
lßd
(
$Ïngfe
, 
$Ïng
);

658 
public
 
funùiÚ
 
cÚfig
(
$fe
 = '', 
$u£_£ùiÚs
 = 
FALSE
, 
$ç_g¿ûfuÎy
 = FALSE)

660 
$CI
 =& 
g‘_š¡ªû
();

661 
	g$CI
->
	gcÚfig
->
lßd
(
$fe
, 
$u£_£ùiÚs
, 
$ç_g¿ûfuÎy
);

676 
public
 
funùiÚ
 
driv”
(
$lib¿ry
 = '', 
$·¿ms
 = 
NULL
, 
$objeù_Çme
 = NULL)

678 iàĞ! 
şass_exi¡s
('CI_Driver_Library'))

681 
»quœe
 
BASEPATH
.'libraries/Driver.php';

684 ià(
	g$lib¿ry
 == '')

686  
FALSE
;

691 iàĞ! 
¡½os
(
$lib¿ry
, '/'))

693 
	g$lib¿ry
 = 
ucfœ¡
(
$lib¿ry
).'/'.$library;

696  
	g$this
->
lib¿ry
(
$lib¿ry
, 
$·¿ms
, 
$objeù_Çme
);

710 
public
 
funùiÚ
 
	$add_·ckage_·th
(
$·th
, 
$v›w_ÿsÿde
=
TRUE
)

712 
$·th
 = 
	`¹rim
($path, '/').'/';

714 
	`¬¿y_unshiá
(
$this
->
_ci_lib¿ry_·ths
, 
$·th
);

715 
	`¬¿y_unshiá
(
$this
->
_ci_mod–_·ths
, 
$·th
);

716 
	`¬¿y_unshiá
(
$this
->
_ci_h–³r_·ths
, 
$·th
);

718 
$this
->
_ci_v›w_·ths
 = 
	`¬¿y
(
$·th
.'v›ws/' => 
$v›w_ÿsÿde
) + $this->_ci_view_paths;

721 
$cÚfig
 =& 
$this
->
	`_ci_g‘_compÚ’t
('config');

722 
	`¬¿y_unshiá
(
$cÚfig
->
_cÚfig_·ths
, 
$·th
);

723 
	}
}

735 
public
 
funùiÚ
 
	$g‘_·ckage_·ths
(
$šşude_ba£
 = 
FALSE
)

737  
$šşude_ba£
 ==ğ
TRUE
 ? 
$this
->
_ci_lib¿ry_·ths
 : $this->
_ci_mod–_·ths
;

738 
	}
}

752 
public
 
funùiÚ
 
»move_·ckage_·th
(
$·th
 = '', 
$»move_cÚfig_·th
 = 
TRUE
)

754 
$cÚfig
 =& 
$this
->
_ci_g‘_compÚ’t
('config');

756 ià(
	g$·th
 == '')

758 
$void
 = 
¬¿y_shiá
(
$this
->
_ci_lib¿ry_·ths
);

759 
	g$void
 = 
¬¿y_shiá
(
$this
->
_ci_mod–_·ths
);

760 
	g$void
 = 
¬¿y_shiá
(
$this
->
_ci_h–³r_·ths
);

761 
	g$void
 = 
¬¿y_shiá
(
$this
->
_ci_v›w_·ths
);

762 
	g$void
 = 
¬¿y_shiá
(
$cÚfig
->
_cÚfig_·ths
);

766 
	g$·th
 = 
¹rim
(
$·th
, '/').'/';

767 
fÜ—ch
 (
¬¿y
('_ci_lib¿ry_·ths', '_ci_mod–_·ths', '_ci_h–³r_·ths'è
as
 
$v¬
)

769 ià((
	g$key
 = 
¬¿y_£¬ch
(
$·th
, 
$this
->{
$v¬
})è!=ğ
FALSE
)

771 
un£t
(
$this
->{
$v¬
}[
$key
]);

775 ià(
is£t
(
$this
->
_ci_v›w_·ths
[
$·th
.'views/']))

777 
un£t
(
$this
->
_ci_v›w_·ths
[
$·th
.'views/']);

780 ià((
	g$key
 = 
¬¿y_£¬ch
(
$·th
, 
$cÚfig
->
_cÚfig_·ths
)è!=ğ
FALSE
)

782 
un£t
(
$cÚfig
->
_cÚfig_·ths
[
$key
]);

787 
	g$this
->
	g_ci_lib¿ry_·ths
 = 
¬¿y_unique
(
¬¿y_m”ge
(
$this
->
_ci_lib¿ry_·ths
, 
¬¿y
(
APPPATH
, 
BASEPATH
)));

788 
	g$this
->
	g_ci_h–³r_·ths
 = 
¬¿y_unique
(
¬¿y_m”ge
(
$this
->
_ci_h–³r_·ths
, 
¬¿y
(
APPPATH
, 
BASEPATH
)));

789 
	g$this
->
	g_ci_mod–_·ths
 = 
¬¿y_unique
(
¬¿y_m”ge
(
$this
->
_ci_mod–_·ths
, 
¬¿y
(
APPPATH
)));

790 
	g$this
->
	g_ci_v›w_·ths
 = 
¬¿y_m”ge
(
$this
->
_ci_v›w_·ths
, 
¬¿y
(
APPPATH
.'v›ws/' => 
TRUE
));

791 
	g$cÚfig
->
	g_cÚfig_·ths
 = 
¬¿y_unique
(
¬¿y_m”ge
(
$cÚfig
->
_cÚfig_·ths
, 
¬¿y
(
APPPATH
)));

806 
´Ùeùed
 
funùiÚ
 
	$_ci_lßd
(
$_ci_d©a
)

809 
	`fÜ—ch
 (
	`¬¿y
('_ci_v›w', '_ci_v¬s', '_ci_·th', '_ci_»tuº'è
as
 
$_ci_v®
)

811 
$$_ci_v®
 = ( ! 
	`is£t
(
$_ci_d©a
[
$_ci_v®
])è? 
FALSE
 : $_ci_data[$_ci_val];

814 
$fe_exi¡s
 = 
FALSE
;

817 ià(
$_ci_·th
 != '')

819 
$_ci_x
 = 
	`ex¶ode
('/', 
$_ci_·th
);

820 
$_ci_fe
 = 
	`’d
(
$_ci_x
);

824 
$_ci_ext
 = 
	`·thšfo
(
$_ci_v›w
, 
PATHINFO_EXTENSION
);

825 
$_ci_fe
 = (
$_ci_ext
 =ğ''è? 
$_ci_v›w
.'.php' : $_ci_view;

827 
	`fÜ—ch
 (
$this
->
_ci_v›w_·ths
 
as
 
$v›w_fe
 => 
$ÿsÿde
)

829 ià(
	`fe_exi¡s
(
$v›w_fe
.
$_ci_fe
))

831 
$_ci_·th
 = 
$v›w_fe
.
$_ci_fe
;

832 
$fe_exi¡s
 = 
TRUE
;

836 iàĞ! 
$ÿsÿde
)

843 iàĞ! 
$fe_exi¡s
 && ! 
	`fe_exi¡s
(
$_ci_·th
))

845 
	`show_”rÜ
('UÇbËØlßdh»que¡ed fe: '.
$_ci_fe
);

851 
$_ci_CI
 =& 
	`g‘_š¡ªû
();

852 
	`fÜ—ch
 (
	`g‘_objeù_v¬s
(
$_ci_CI
è
as
 
$_ci_key
 => 
$_ci_v¬
)

854 iàĞ! 
	`is£t
(
$this
->
$_ci_key
))

856 
$this
->
$_ci_key
 =& 
$_ci_CI
->$_ci_key;

868 ià(
	`is_¬¿y
(
$_ci_v¬s
))

870 
$this
->
_ci_ÿched_v¬s
 = 
	`¬¿y_m”ge
($this->_ci_ÿched_v¬s, 
$_ci_v¬s
);

872 
	`exŒaù
(
$this
->
_ci_ÿched_v¬s
);

886 
	`ob_¡¬t
();

892 ià((
boŞ
è@
	`ši_g‘
('shÜt_İ’_g'è==ğ
FALSE
 
AND
 
	`cÚfig_™em
('»wr™e_shÜt_gs'è=ğ
TRUE
)

894 
echo
 
	`ev®
('?>'.
	`´eg_»¶aû
("/;*\s*\?>/", "; ?>", 
	`¡r_»¶aû
('<?=', '<?ph°echØ', 
	`fe_g‘_cÚ‹Ás
(
$_ci_·th
))));

898 
	`šşude
(
$_ci_·th
);

901 
	`log_mes§ge
('debug', 'Flßded: '.
$_ci_·th
);

904 ià(
$_ci_»tuº
 ==ğ
TRUE
)

906 
$bufãr
 = 
	`ob_g‘_cÚ‹Ás
();

907 @
	`ob_’d_ş—n
();

908  
$bufãr
;

921 ià(
	`ob_g‘_Ëv–
(è> 
$this
->
_ci_ob_Ëv–
 + 1)

923 
	`ob_’d_æush
();

927 
$_ci_CI
->
ouut
->
	`­³nd_ouut
(
	`ob_g‘_cÚ‹Ás
());

928 @
	`ob_’d_ş—n
();

930 
	}
}

944 
´Ùeùed
 
funùiÚ
 
	$_ci_lßd_şass
(
$şass
, 
$·¿ms
 = 
NULL
, 
$objeù_Çme
 = NULL)

949 
$şass
 = 
	`¡r_»¶aû
('.php', '', 
	`Œim
($class, '/'));

953 
$subdœ
 = '';

954 ià((
$Ï¡_¦ash
 = 
	`¡¼pos
(
$şass
, '/')è!=ğ
FALSE
)

957 
$subdœ
 = 
	`sub¡r
(
$şass
, 0, 
$Ï¡_¦ash
 + 1);

960 
$şass
 = 
	`sub¡r
($şass, 
$Ï¡_¦ash
 + 1);

964 
	`fÜ—ch
 (
	`¬¿y
(
	`ucfœ¡
(
$şass
), 
	`¡¹Şow”
($şass)è
as
 $class)

966 
$subşass
 = 
APPPATH
.'lib¿r›s/'.
$subdœ
.
	`cÚfig_™em
('subşass_´efix').
$şass
.'.php';

969 ià(
	`fe_exi¡s
(
$subşass
))

971 
$ba£şass
 = 
BASEPATH
.'lib¿r›s/'.
	`ucfœ¡
(
$şass
).'.php';

973 iàĞ! 
	`fe_exi¡s
(
$ba£şass
))

975 
	`log_mes§ge
('”rÜ', "UÇbËØlßdh»que¡ed cÏss: ".
$şass
);

976 
	`show_”rÜ
("UÇbËØlßdh»que¡ed cÏss: ".
$şass
);

980 ià(
	`š_¬¿y
(
$subşass
, 
$this
->
_ci_lßded_fes
))

985 iàĞ! 
	`is_nuÎ
(
$objeù_Çme
))

987 
$CI
 =& 
	`g‘_š¡ªû
();

988 iàĞ! 
	`is£t
(
$CI
->
$objeù_Çme
))

990  
$this
->
	`_ci_š™_şass
(
$şass
, 
	`cÚfig_™em
('subşass_´efix'), 
$·¿ms
, 
$objeù_Çme
);

994 
$is_du¶iÿ‹
 = 
TRUE
;

995 
	`log_mes§ge
('debug', 
$şass
." class‡lready†oaded. Second‡ttempt ignored.");

999 
	`šşude_Úû
(
$ba£şass
);

1000 
	`šşude_Úû
(
$subşass
);

1001 
$this
->
_ci_lßded_fes
[] = 
$subşass
;

1003  
$this
->
	`_ci_š™_şass
(
$şass
, 
	`cÚfig_™em
('subşass_´efix'), 
$·¿ms
, 
$objeù_Çme
);

1007 
$is_du¶iÿ‹
 = 
FALSE
;

1008 
	`fÜ—ch
 (
$this
->
_ci_lib¿ry_·ths
 
as
 
$·th
)

1010 
$f•©h
 = 
$·th
.'lib¿r›s/'.
$subdœ
.
$şass
.'.php';

1013 iàĞ! 
	`fe_exi¡s
(
$f•©h
))

1019 ià(
	`š_¬¿y
(
$f•©h
, 
$this
->
_ci_lßded_fes
))

1024 iàĞ! 
	`is_nuÎ
(
$objeù_Çme
))

1026 
$CI
 =& 
	`g‘_š¡ªû
();

1027 iàĞ! 
	`is£t
(
$CI
->
$objeù_Çme
))

1029  
$this
->
	`_ci_š™_şass
(
$şass
, '', 
$·¿ms
, 
$objeù_Çme
);

1033 
$is_du¶iÿ‹
 = 
TRUE
;

1034 
	`log_mes§ge
('debug', 
$şass
." class‡lready†oaded. Second‡ttempt ignored.");

1038 
	`šşude_Úû
(
$f•©h
);

1039 
$this
->
_ci_lßded_fes
[] = 
$f•©h
;

1040  
$this
->
	`_ci_š™_şass
(
$şass
, '', 
$·¿ms
, 
$objeù_Çme
);

1046 ià(
$subdœ
 == '')

1048 
$·th
 = 
	`¡¹Şow”
(
$şass
).'/'.$class;

1049  
$this
->
	`_ci_lßd_şass
(
$·th
, 
$·¿ms
);

1054 ià(
$is_du¶iÿ‹
 =ğ
FALSE
)

1056 
	`log_mes§ge
('”rÜ', "UÇbËØlßdh»que¡ed cÏss: ".
$şass
);

1057 
	`show_”rÜ
("UÇbËØlßdh»que¡ed cÏss: ".
$şass
);

1059 
	}
}

1072 
´Ùeùed
 
funùiÚ
 
_ci_š™_şass
(
$şass
, 
$´efix
 = '', 
$cÚfig
 = 
FALSE
, 
$objeù_Çme
 = 
NULL
)

1075 ià(
$cÚfig
 ==ğ
NULL
)

1078 
$cÚfig_compÚ’t
 = 
$this
->
_ci_g‘_compÚ’t
('config');

1080 ià(
is_¬¿y
(
$cÚfig_compÚ’t
->
_cÚfig_·ths
))

1084 
fÜ—ch
 (
$cÚfig_compÚ’t
->
_cÚfig_·ths
 
as
 
$·th
)

1089 ià(
defšed
('ENVIRONMENT'è
AND
 
fe_exi¡s
(
$·th
 .'cÚfig/'.
ENVIRONMENT
.'/'.
¡¹Şow”
(
$şass
).'.php'))

1091 
šşude
(
$·th
 .'cÚfig/'.
ENVIRONMENT
.'/'.
¡¹Şow”
(
$şass
).'.php');

1094 
–£if
 (
defšed
('ENVIRONMENT'è
AND
 
fe_exi¡s
(
$·th
 .'cÚfig/'.
ENVIRONMENT
.'/'.
ucfœ¡
(
¡¹Şow”
(
$şass
)).'.php'))

1096 
šşude
(
$·th
 .'cÚfig/'.
ENVIRONMENT
.'/'.
ucfœ¡
(
¡¹Şow”
(
$şass
)).'.php');

1099 
–£if
 (
fe_exi¡s
(
$·th
 .'cÚfig/'.
¡¹Şow”
(
$şass
).'.php'))

1101 
šşude
(
$·th
 .'cÚfig/'.
¡¹Şow”
(
$şass
).'.php');

1104 
–£if
 (
fe_exi¡s
(
$·th
 .'cÚfig/'.
ucfœ¡
(
¡¹Şow”
(
$şass
)).'.php'))

1106 
šşude
(
$·th
 .'cÚfig/'.
ucfœ¡
(
¡¹Şow”
(
$şass
)).'.php');

1113 ià(
	g$´efix
 == '')

1115 ià(
şass_exi¡s
('CI_'.
$şass
))

1117 
$Çme
 = 'CI_'.
$şass
;

1119 
–£if
 (
şass_exi¡s
(
cÚfig_™em
('subşass_´efix').
$şass
))

1121 
	g$Çme
 = 
cÚfig_™em
('subşass_´efix').
$şass
;

1125 
	g$Çme
 = 
$şass
;

1130 
	g$Çme
 = 
$´efix
.
$şass
;

1134 iàĞ! 
şass_exi¡s
(
$Çme
))

1136 
log_mes§ge
('”rÜ', "NÚ-exi¡’ˆşass: ".
$Çme
);

1137 
show_”rÜ
("NÚ-exi¡’ˆşass: ".
$şass
);

1142 
	g$şass
 = 
¡¹Şow”
(
$şass
);

1144 ià(
is_nuÎ
(
$objeù_Çme
))

1146 
	g$şassv¬
 = ( ! 
is£t
(
$this
->
_ci_v¬m­
[
$şass
])) ? $class : $this->_ci_varmap[$class];

1150 
	g$şassv¬
 = 
$objeù_Çme
;

1154 
	g$this
->
	g_ci_şas£s
[
$şass
] = 
$şassv¬
;

1157 
	g$CI
 =& 
g‘_š¡ªû
();

1158 ià(
	g$cÚfig
 !=ğ
NULL
)

1160 
$CI
->
$şassv¬
 = 
Ãw
 
$Çme
(
$cÚfig
);

1164 
	g$CI
->
	g$şassv¬
 = 
Ãw
 
$Çme
;

1179 
´iv©e
 
funùiÚ
 
	$_ci_autŞßd”
()

1181 ià(
	`defšed
('ENVIRONMENT'è
AND
 
	`fe_exi¡s
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/autoload.php'))

1183 
	`šşude
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/autoload.php');

1187 
	`šşude
(
APPPATH
.'config/autoload.php');

1190 iàĞ! 
	`is£t
(
$autŞßd
))

1192  
FALSE
;

1196 ià(
	`is£t
(
$autŞßd
['packages']))

1198 
	`fÜ—ch
 (
$autŞßd
['·ckages'] 
as
 
$·ckage_·th
)

1200 
$this
->
	`add_·ckage_·th
(
$·ckage_·th
);

1205 ià(
	`couÁ
(
$autŞßd
['config']) > 0)

1207 
$CI
 =& 
	`g‘_š¡ªû
();

1208 
	`fÜ—ch
 (
$autŞßd
['cÚfig'] 
as
 
$key
 => 
$v®
)

1210 
$CI
->
cÚfig
->
	`lßd
(
$v®
);

1215 
	`fÜ—ch
 (
	`¬¿y
('h–³r', 'Ïnguage'è
as
 
$ty³
)

1217 ià(
	`is£t
(
$autŞßd
[
$ty³
]è
AND
 
	`couÁ
($autoload[$type]) > 0)

1219 
$this
->
	`$ty³
(
$autŞßd
[
$ty³
]);

1225 iàĞ! 
	`is£t
(
$autŞßd
['lib¿r›s']è
AND
 isset($autoload['core']))

1227 
$autŞßd
['libraries'] = $autoload['core'];

1231 ià(
	`is£t
(
$autŞßd
['lib¿r›s']è
AND
 
	`couÁ
($autoload['libraries']) > 0)

1234 ià(
	`š_¬¿y
('d©aba£', 
$autŞßd
['libraries']))

1236 
$this
->
	`d©aba£
();

1237 
$autŞßd
['lib¿r›s'] = 
	`¬¿y_diff
($autŞßd['lib¿r›s'], 
	`¬¿y
('database'));

1241 
	`fÜ—ch
 (
$autŞßd
['lib¿r›s'] 
as
 
$™em
)

1243 
$this
->
	`lib¿ry
(
$™em
);

1248 ià(
	`is£t
(
$autŞßd
['model']))

1250 
$this
->
	`mod–
(
$autŞßd
['model']);

1254 ià(
	`is£t
(
$autŞßd
['controller'])) {

1255 
$this
->
	`cÚŒŞËr
(
$autŞßd
['controller']);

1257 
	}
}

1269 
´Ùeùed
 
funùiÚ
 
	$_ci_objeù_to_¬¿y
(
$objeù
)

1271  (
	`is_objeù
(
$objeù
)è? 
	`g‘_objeù_v¬s
($object) : $object;

1272 
	}
}

1282 
´Ùeùed
 
	gfunùiÚ
 &
	$_ci_g‘_compÚ’t
(
$compÚ’t
)

1284 
$CI
 =& 
	`g‘_š¡ªû
();

1285  
$CI
->
$compÚ’t
;

1286 
	}
}

1299 
´Ùeùed
 
funùiÚ
 
	$_ci_´•_f’ame
(
$f’ame
, 
$ex‹nsiÚ
)

1301 iàĞ! 
	`is_¬¿y
(
$f’ame
))

1303  
	`¬¿y
(
	`¡¹Şow”
(
	`¡r_»¶aû
('.php', '', sŒ_»¶aû(
$ex‹nsiÚ
, '', 
$f’ame
)).$extension));

1307 
	`fÜ—ch
 (
$f’ame
 
as
 
$key
 => 
$v®
)

1309 
$f’ame
[
$key
] = 
	`¡¹Şow”
(
	`¡r_»¶aû
('.php', '', sŒ_»¶aû(
$ex‹nsiÚ
, '', 
$v®
)).$extension);

1312  
$f’ame
;

1314 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Model.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Mod–
 {

34 
funùiÚ
 
	$__cÚ¡ruù
()

36 
	`log_mes§ge
('debug', "Model Class Initialized");

48 
funùiÚ
 
	$__g‘
(
$key
)

50 
$CI
 =& 
	`g‘_š¡ªû
();

51  
$CI
->
$key
;

52 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Output.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_Ouut
 {

37 
´Ùeùed
 
	m$fš®_ouut
;

44 
´Ùeùed
 
	m$ÿche_expœ©iÚ
 = 0;

51 
´Ùeùed
 
	m$h—d”s
 = 
¬¿y
();

58 
´Ùeùed
 
	m$mime_ty³s
 = 
¬¿y
();

65 
´Ùeùed
 
	m$’abË_´of”
 = 
FALSE
;

72 
´Ùeùed
 
	m$_zlib_oc
 = 
FALSE
;

79 
´Ùeùed
 
	m$_´of”_£ùiÚs
 = 
¬¿y
();

86 
´Ùeùed
 
	m$·r£_exec_v¬s
 = 
TRUE
;

92 
funùiÚ
 
	$__cÚ¡ruù
()

94 
$this
->
_zlib_oc
 = @
	`ši_g‘
('zlib.output_compression');

97 ià(
	`defšed
('ENVIRONMENT'è
AND
 
	`fe_exi¡s
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/mimes.php'))

99 
šşude
 
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/mimes.php';

103 
šşude
 
APPPATH
.'config/mimes.php';

107 
$this
->
mime_ty³s
 = 
$mimes
;

109 
	`log_mes§ge
('debug', "Output Class Initialized");

122 
funùiÚ
 
	$g‘_ouut
()

124  
$this
->
fš®_ouut
;

125 
	}
}

138 
funùiÚ
 
	$£t_ouut
(
$ouut
)

140 
$this
->
fš®_ouut
 = 
$ouut
;

142  
$this
;

143 
	}
}

156 
funùiÚ
 
	$­³nd_ouut
(
$ouut
)

158 ià(
$this
->
fš®_ouut
 == '')

160 
$this
->
fš®_ouut
 = 
$ouut
;

164 
$this
->
fš®_ouut
 .ğ
$ouut
;

167  
$this
;

168 
	}
}

185 
funùiÚ
 
	$£t_h—d”
(
$h—d”
, 
$»¶aû
 = 
TRUE
)

192 ià(
$this
->
_zlib_oc
 && 
	`¡ºÿ£cmp
(
$h—d”
, 'content-length', 14) == 0)

197 
$this
->
h—d”s
[] = 
	`¬¿y
(
$h—d”
, 
$»¶aû
);

199  
$this
;

200 
	}
}

211 
funùiÚ
 
	$£t_cÚ‹Á_ty³
(
$mime_ty³
)

213 ià(
	`¡½os
(
$mime_ty³
, '/'è==ğ
FALSE
)

215 
$ex‹nsiÚ
 = 
	`Érim
(
$mime_ty³
, '.');

218 ià(
	`is£t
(
$this
->
mime_ty³s
[
$ex‹nsiÚ
]))

220 
$mime_ty³
 =& 
$this
->
mime_ty³s
[
$ex‹nsiÚ
];

222 ià(
	`is_¬¿y
(
$mime_ty³
))

224 
$mime_ty³
 = 
	`cu¼’t
($mime_type);

229 
$h—d”
 = 'CÚ‹Á-Ty³: '.
$mime_ty³
;

231 
$this
->
h—d”s
[] = 
	`¬¿y
(
$h—d”
, 
TRUE
);

233  
$this
;

234 
	}
}

247 
funùiÚ
 
£t_¡©us_h—d”
(
$code
 = 200, 
$‹xt
 = '')

249 
£t_¡©us_h—d”
(
$code
, 
$‹xt
);

251  
	g$this
;

263 
funùiÚ
 
	$’abË_´of”
(
$v®
 = 
TRUE
)

265 
$this
->
’abË_´of”
 = (
	`is_boŞ
(
$v®
)è? $v® : 
TRUE
;

267  
$this
;

268 
	}
}

281 
funùiÚ
 
	$£t_´of”_£ùiÚs
(
$£ùiÚs
)

283 
	`fÜ—ch
 (
$£ùiÚs
 
as
 
$£ùiÚ
 => 
$’abË
)

285 
$this
->
_´of”_£ùiÚs
[
$£ùiÚ
] = (
$’abË
 !=ğ
FALSE
è? 
TRUE
 : FALSE;

288  
$this
;

289 
	}
}

300 
funùiÚ
 
	$ÿche
(
$time
)

302 
$this
->
ÿche_expœ©iÚ
 = ( ! 
	`is_num”ic
(
$time
)) ? 0 : $time;

304  
$this
;

305 
	}
}

324 
funùiÚ
 
_di¥Ïy
(
$ouut
 = '')

329 
glob®
 
$BM
, 
$CFG
;

332 ià(
şass_exi¡s
('CI_Controller'))

334 
	g$CI
 =& 
g‘_š¡ªû
();

340 ià(
	g$ouut
 == '')

342 
$ouut
 =& 
$this
->
fš®_ouut
;

350 ià(
	g$this
->
	gÿche_expœ©iÚ
 > 0 && 
is£t
(
$CI
è&& ! 
m‘hod_exi¡s
($CI, '_output'))

352 
	g$this
->
_wr™e_ÿche
(
$ouut
);

360 
	g$–­£d
 = 
$BM
->
–­£d_time
('total_execution_time_start', 'total_execution_time_end');

362 ià(
	g$this
->
	g·r£_exec_v¬s
 ==ğ
TRUE
)

364 
$memÜy
 = ( ! 
funùiÚ_exi¡s
('memÜy_g‘_u§ge')è? '0' : 
round
(
memÜy_g‘_u§ge
()/1024/1024, 2).'MB';

366 
	g$ouut
 = 
¡r_»¶aû
('{–­£d_time}', 
$–­£d
, 
$ouut
);

367 
	g$ouut
 = 
¡r_»¶aû
('{memÜy_u§ge}', 
$memÜy
, 
$ouut
);

373 ià(
	g$CFG
->
™em
('com´ess_ouut'è==ğ
TRUE
 && 
$this
->
_zlib_oc
 =ğ
FALSE
)

375 ià(
ex‹nsiÚ_lßded
('zlib'))

377 ià(
is£t
(
$_SERVER
['HTTP_ACCEPT_ENCODING']è
AND
 
¡½os
($_SERVER['HTTP_ACCEPT_ENCODING'], 'gz'è!=ğ
FALSE
)

379 
ob_¡¬t
('ob_gzhandler');

387 ià(
couÁ
(
$this
->
h—d”s
) > 0)

389 
fÜ—ch
 (
$this
->
h—d”s
 
as
 
$h—d”
)

391 @
h—d”
(
$h—d”
[0], $header[1]);

400 iàĞ! 
is£t
(
$CI
))

402 
echo
 
	g$ouut
;

403 
log_mes§ge
('debug', "Final output sento browser");

404 
log_mes§ge
('debug', "TÙ®ƒxecutiÚime: ".
$–­£d
);

405  
	gTRUE
;

412 ià(
	g$this
->
	g’abË_´of”
 =ğ
TRUE
)

414 
$CI
->
lßd
->
lib¿ry
('profiler');

416 iàĞ! 
em±y
(
$this
->
_´of”_£ùiÚs
))

418 
	g$CI
->
	g´of”
->
£t_£ùiÚs
(
$this
->
_´of”_£ùiÚs
);

423 ià(
´eg_m©ch
("|</body>.*?</html>|is", 
$ouut
))

425 
	g$ouut
 = 
´eg_»¶aû
("|</body>.*?</html>|is", '', 
$ouut
);

426 
	g$ouut
 .ğ
$CI
->
´of”
->
run
();

427 
	g$ouut
 .= '</body></html>';

431 
	g$ouut
 .ğ
$CI
->
´of”
->
run
();

439 ià(
m‘hod_exi¡s
(
$CI
, '_output'))

441 
	g$CI
->
_ouut
(
$ouut
);

445 
echo
 
	g$ouut
;

448 
log_mes§ge
('debug', "Final output sento browser");

449 
log_mes§ge
('debug', "TÙ®ƒxecutiÚime: ".
$–­£d
);

461 
funùiÚ
 
	$_wr™e_ÿche
(
$ouut
)

463 
$CI
 =& 
	`g‘_š¡ªû
();

464 
$·th
 = 
$CI
->
cÚfig
->
	`™em
('cache_path');

466 
$ÿche_·th
 = (
$·th
 =ğ''è? 
APPPATH
.'cache/' : $path;

468 iàĞ! 
	`is_dœ
(
$ÿche_·th
è
OR
 ! 
	`is_»®ly_wr™abË
($cache_path))

470 
	`log_mes§ge
('”rÜ', "UÇbËØwr™ÿchfe: ".
$ÿche_·th
);

474 
$uri
 = 
$CI
->
cÚfig
->
	`™em
('base_url').

475 
$CI
->
cÚfig
->
	`™em
('index_page').

476 
$CI
->
uri
->
	`uri_¡ršg
();

478 
$ÿche_·th
 .ğ
	`md5
(
$uri
);

480 iàĞ! 
$å
 = @
	`fİ’
(
$ÿche_·th
, 
FOPEN_WRITE_CREATE_DESTRUCTIVE
))

482 
	`log_mes§ge
('”rÜ', "UÇbËØwr™ÿchfe: ".
$ÿche_·th
);

486 
$expœe
 = 
	`time
(è+ (
$this
->
ÿche_expœ©iÚ
 * 60);

488 ià(
	`æock
(
$å
, 
LOCK_EX
))

490 
	`fwr™e
(
$å
, 
$expœe
.'TS--->'.
$ouut
);

491 
	`æock
(
$å
, 
LOCK_UN
);

495 
	`log_mes§ge
('”rÜ', "UÇbËØ£cu»‡ flock fÜ f©: ".
$ÿche_·th
);

498 
	`fşo£
(
$å
);

499 @
	`chmod
(
$ÿche_·th
, 
FILE_WRITE_MODE
);

501 
	`log_mes§ge
('debug', "Cachfwr™‹n: ".
$ÿche_·th
);

502 
	}
}

514 
funùiÚ
 
	$_di¥Ïy_ÿche
(&
$CFG
, &
$URI
)

516 
$ÿche_·th
 = (
$CFG
->
	`™em
('ÿche_·th'è=ğ''è? 
APPPATH
.'cache/' : $CFG->item('cache_path');

519 
$uri
 = 
$CFG
->
	`™em
('base_url').

520 
$CFG
->
	`™em
('index_page').

521 
$URI
->
uri_¡ršg
;

523 
$f•©h
 = 
$ÿche_·th
.
	`md5
(
$uri
);

525 iàĞ! @
	`fe_exi¡s
(
$f•©h
))

527  
FALSE
;

530 iàĞ! 
$å
 = @
	`fİ’
(
$f•©h
, 
FOPEN_READ
))

532  
FALSE
;

535 
	`æock
(
$å
, 
LOCK_SH
);

537 
$ÿche
 = '';

538 ià(
	`fesize
(
$f•©h
) > 0)

540 
$ÿche
 = 
	`ä—d
(
$å
, 
	`fesize
(
$f•©h
));

543 
	`æock
(
$å
, 
LOCK_UN
);

544 
	`fşo£
(
$å
);

547 iàĞ! 
	`´eg_m©ch
("/(\d+TS--->)/", 
$ÿche
, 
$m©ch
))

549  
FALSE
;

553 ià(
	`time
(è>ğ
	`Œim
(
	`¡r_»¶aû
('TS--->', '', 
$m©ch
['1'])))

555 ià(
	`is_»®ly_wr™abË
(
$ÿche_·th
))

557 @
	`uÆšk
(
$f•©h
);

558 
	`log_mes§ge
('debug', "Cache file hasƒxpired. File deleted");

559  
FALSE
;

564 
$this
->
	`_di¥Ïy
(
	`¡r_»¶aû
(
$m©ch
['0'], '', 
$ÿche
));

565 
	`log_mes§ge
('debug', "Cache file is current. Sending ito browser.");

566  
TRUE
;

567 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Router.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_Rou‹r
 {

37 
v¬
 
	m$cÚfig
;

44 
v¬
 
	m$rou‹s
 = 
¬¿y
();

51 
v¬
 
	m$”rÜ_rou‹s
 = 
¬¿y
();

58 
v¬
 
	m$şass
 = '';

65 
v¬
 
	m$m‘hod
 = 'index';

72 
v¬
 
	m$dœeùÜy
 = '';

79 
v¬
 
	m$deçuÉ_cÚŒŞËr
;

86 
funùiÚ
 
	$__cÚ¡ruù
()

88 
$this
->
cÚfig
 =& 
	`lßd_şass
('Config', 'core');

89 
$this
->
uri
 =& 
	`lßd_şass
('URI', 'core');

90 
	`log_mes§ge
('debug', "Router Class Initialized");

104 
funùiÚ
 
	$_£t_routšg
()

109 
$£gm’ts
 = 
	`¬¿y
();

110 ià(
$this
->
cÚfig
->
	`™em
('’abË_qu”y_¡ršgs'è==ğ
TRUE
 
AND
 
	`is£t
(
$_GET
[$this->config->item('controller_trigger')]))

112 ià(
	`is£t
(
$_GET
[
$this
->
cÚfig
->
	`™em
('directory_trigger')]))

114 
$this
->
	`£t_dœeùÜy
(
	`Œim
($this->
uri
->
	`_f‹r_uri
(
$_GET
[$this->
cÚfig
->
	`™em
('directory_trigger')])));

115 
$£gm’ts
[] = 
$this
->
	`ãtch_dœeùÜy
();

118 ià(
	`is£t
(
$_GET
[
$this
->
cÚfig
->
	`™em
('controller_trigger')]))

120 
$this
->
	`£t_şass
(
	`Œim
($this->
uri
->
	`_f‹r_uri
(
$_GET
[$this->
cÚfig
->
	`™em
('controller_trigger')])));

121 
$£gm’ts
[] = 
$this
->
	`ãtch_şass
();

124 ià(
	`is£t
(
$_GET
[
$this
->
cÚfig
->
	`™em
('function_trigger')]))

126 
$this
->
	`£t_m‘hod
(
	`Œim
($this->
uri
->
	`_f‹r_uri
(
$_GET
[$this->
cÚfig
->
	`™em
('function_trigger')])));

127 
$£gm’ts
[] = 
$this
->
	`ãtch_m‘hod
();

132 ià(
	`defšed
('ENVIRONMENT'è
AND
 
	`is_fe
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/routes.php'))

134 
	`šşude
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/routes.php');

136 
	`–£if
 (
	`is_fe
(
APPPATH
.'config/routes.php'))

138 
	`šşude
(
APPPATH
.'config/routes.php');

141 
$this
->
rou‹s
 = ( ! 
	`is£t
(
$rou‹
è
OR
 ! 
	`is_¬¿y
($rou‹)è? 
	`¬¿y
() : $route;

142 
	`un£t
(
$rou‹
);

146 
$this
->
deçuÉ_cÚŒŞËr
 = ( ! 
	`is£t
($this->
rou‹s
['deçuÉ_cÚŒŞËr']è
OR
 $this->rou‹s['deçuÉ_cÚŒŞËr'] =ğ''è? 
FALSE
 : 
	`¡¹Şow”
($this->routes['default_controller']);

149 ià(
	`couÁ
(
$£gm’ts
) > 0)

151  
$this
->
	`_v®id©e_»que¡
(
$£gm’ts
);

155 
$this
->
uri
->
	`_ãtch_uri_¡ršg
();

158 ià(
$this
->
uri
->
uri_¡ršg
 == '')

160  
$this
->
	`_£t_deçuÉ_cÚŒŞËr
();

164 
$this
->
uri
->
	`_»move_u¾_suffix
();

167 
$this
->
uri
->
	`_ex¶ode_£gm’ts
();

170 
$this
->
	`_·r£_rou‹s
();

173 
$this
->
uri
->
	`_»šdex_£gm’ts
();

174 
	}
}

184 
funùiÚ
 
	$_£t_deçuÉ_cÚŒŞËr
()

186 ià(
$this
->
deçuÉ_cÚŒŞËr
 ==ğ
FALSE
)

188 
	`show_”rÜ
("Unableo determine what should be displayed. A default„oute has‚ot been specified inhe„outing file.");

191 ià(
	`¡½os
(
$this
->
deçuÉ_cÚŒŞËr
, '/'è!=ğ
FALSE
)

193 
$x
 = 
	`ex¶ode
('/', 
$this
->
deçuÉ_cÚŒŞËr
);

195 
$this
->
	`£t_şass
(
$x
[0]);

196 
$this
->
	`£t_m‘hod
(
$x
[1]);

197 
$this
->
	`_£t_»que¡
(
$x
);

201 
$this
->
	`£t_şass
($this->
deçuÉ_cÚŒŞËr
);

202 
$this
->
	`£t_m‘hod
('index');

203 
$this
->
	`_£t_»que¡
(
	`¬¿y
($this->
deçuÉ_cÚŒŞËr
, 'index'));

207 
$this
->
uri
->
	`_»šdex_£gm’ts
();

209 
	`log_mes§ge
('debug', "No URI…resent. Default controller set.");

210 
	}
}

225 
funùiÚ
 
_£t_»que¡
(
$£gm’ts
 = 
	$¬¿y
())

227 
$£gm’ts
 = 
$this
->
	`_v®id©e_»que¡
($segments);

229 ià(
	`couÁ
(
$£gm’ts
) == 0)

231  
$this
->
	`_£t_deçuÉ_cÚŒŞËr
();

234 
$this
->
	`£t_şass
(
$£gm’ts
[0]);

236 ià(
	`is£t
(
$£gm’ts
[1]))

239 
$this
->
	`£t_m‘hod
(
$£gm’ts
[1]);

245 
$£gm’ts
[1] = 'index';

251 
$this
->
uri
->
r£gm’ts
 = 
$£gm’ts
;

252 
	}
}

264 
funùiÚ
 
	$_v®id©e_»que¡
(
$£gm’ts
)

266 ià(
	`couÁ
(
$£gm’ts
) == 0)

268  
$£gm’ts
;

272 ià(
	`fe_exi¡s
(
APPPATH
.'cÚŒŞËrs/'.
$£gm’ts
[0].'.php'))

274  
$£gm’ts
;

278 ià(
	`is_dœ
(
APPPATH
.'cÚŒŞËrs/'.
$£gm’ts
[0]))

281 
$this
->
	`£t_dœeùÜy
(
$£gm’ts
[0]);

282 
$£gm’ts
 = 
	`¬¿y_¦iû
($segments, 1);

284 ià(
	`couÁ
(
$£gm’ts
) > 0)

287 iàĞ! 
	`fe_exi¡s
(
APPPATH
.'cÚŒŞËrs/'.
$this
->
	`ãtch_dœeùÜy
().
$£gm’ts
[0].'.php'))

289 iàĞ! 
	`em±y
(
$this
->
rou‹s
['404_override']))

291 
$x
 = 
	`ex¶ode
('/', 
$this
->
rou‹s
['404_override']);

293 
$this
->
	`£t_dœeùÜy
('');

294 
$this
->
	`£t_şass
(
$x
[0]);

295 
$this
->
	`£t_m‘hod
(
	`is£t
(
$x
[1]) ? $x[1] : 'index');

297  
$x
;

301 
	`show_404
(
$this
->
	`ãtch_dœeùÜy
().
$£gm’ts
[0]);

308 ià(
	`¡½os
(
$this
->
deçuÉ_cÚŒŞËr
, '/'è!=ğ
FALSE
)

310 
$x
 = 
	`ex¶ode
('/', 
$this
->
deçuÉ_cÚŒŞËr
);

312 
$this
->
	`£t_şass
(
$x
[0]);

313 
$this
->
	`£t_m‘hod
(
$x
[1]);

317 
$this
->
	`£t_şass
($this->
deçuÉ_cÚŒŞËr
);

318 
$this
->
	`£t_m‘hod
('index');

322 iàĞ! 
	`fe_exi¡s
(
APPPATH
.'cÚŒŞËrs/'.
$this
->
	`ãtch_dœeùÜy
().$this->
deçuÉ_cÚŒŞËr
.'.php'))

324 
$this
->
dœeùÜy
 = '';

325  
	`¬¿y
();

330  
$£gm’ts
;

336 iàĞ! 
	`em±y
(
$this
->
rou‹s
['404_override']))

338 
$x
 = 
	`ex¶ode
('/', 
$this
->
rou‹s
['404_override']);

340 
$this
->
	`£t_şass
(
$x
[0]);

341 
$this
->
	`£t_m‘hod
(
	`is£t
(
$x
[1]) ? $x[1] : 'index');

343  
$x
;

348 
	`show_404
(
$£gm’ts
[0]);

349 
	}
}

363 
funùiÚ
 
	$_·r£_rou‹s
()

366 
$uri
 = 
	`im¶ode
('/', 
$this
->
uri
->
£gm’ts
);

369 ià(
	`is£t
(
$this
->
rou‹s
[
$uri
]))

371  
$this
->
	`_£t_»que¡
(
	`ex¶ode
('/', $this->
rou‹s
[
$uri
]));

375 
	`fÜ—ch
 (
$this
->
rou‹s
 
as
 
$key
 => 
$v®
)

378 
$key
 = 
	`¡r_»¶aû
(':any', '.+', str_replace(':num', '[0-9]+', $key));

381 ià(
	`´eg_m©ch
('#^'.
$key
.'$#', 
$uri
))

384 ià(
	`¡½os
(
$v®
, '$'è!=ğ
FALSE
 
AND
 sŒpos(
$key
, '(') !== FALSE)

386 
$v®
 = 
	`´eg_»¶aû
('#^'.
$key
.'$#', $v®, 
$uri
);

389  
$this
->
	`_£t_»que¡
(
	`ex¶ode
('/', 
$v®
));

395 
$this
->
	`_£t_»que¡
($this->
uri
->
£gm’ts
);

396 
	}
}

407 
funùiÚ
 
	$£t_şass
(
$şass
)

409 
$this
->
şass
 = 
	`¡r_»¶aû
(
	`¬¿y
('/', '.'), '', 
$şass
);

410 
	}
}

420 
funùiÚ
 
	$ãtch_şass
()

422  
$this
->
şass
;

423 
	}
}

434 
funùiÚ
 
	$£t_m‘hod
(
$m‘hod
)

436 
$this
->
m‘hod
 = 
$m‘hod
;

437 
	}
}

447 
funùiÚ
 
	$ãtch_m‘hod
()

449 ià(
$this
->
m‘hod
 =ğ$this->
	`ãtch_şass
())

454  
$this
->
m‘hod
;

455 
	}
}

466 
funùiÚ
 
	$£t_dœeùÜy
(
$dœ
)

468 
$this
->
dœeùÜy
 = 
	`¡r_»¶aû
(
	`¬¿y
('/', '.'), '', 
$dœ
).'/';

469 
	}
}

479 
funùiÚ
 
	$ãtch_dœeùÜy
()

481  
$this
->
dœeùÜy
;

482 
	}
}

493 
funùiÚ
 
	$_£t_ov”rides
(
$routšg
)

495 iàĞ! 
	`is_¬¿y
(
$routšg
))

500 ià(
	`is£t
(
$routšg
['directory']))

502 
$this
->
	`£t_dœeùÜy
(
$routšg
['directory']);

505 ià(
	`is£t
(
$routšg
['cÚŒŞËr']è
AND
 $routing['controller'] != '')

507 
$this
->
	`£t_şass
(
$routšg
['controller']);

510 ià(
	`is£t
(
$routšg
['function']))

512 
$routšg
['function'] = ($routing['function'] == '') ? 'index' : $routing['function'];

513 
$this
->
	`£t_m‘hod
(
$routšg
['function']);

515 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Security.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Secur™y
 {

35 
´Ùeùed
 
	m$_xss_hash
 = '';

42 
´Ùeùed
 
	m$_c¤f_hash
 = '';

50 
´Ùeùed
 
	m$_c¤f_expœe
 = 7200;

57 
´Ùeùed
 
	m$_c¤f_tok’_Çme
 = 'ci_csrf_token';

64 
´Ùeùed
 
	m$_c¤f_cook›_Çme
 = 'ci_csrf_token';

71 
´Ùeùed
 
	m$_Ãv”_®lowed_¡r
 = 
¬¿y
(

91 
´Ùeùed
 
	m$_Ãv”_®lowed_»gex
 = 
¬¿y
(

104 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

107 ià(
	`cÚfig_™em
('c¤f_´ÙeùiÚ'è==ğ
TRUE
)

110 
	`fÜ—ch
 (
	`¬¿y
('c¤f_expœe', 'c¤f_tok’_Çme', 'c¤f_cook›_Çme'è
as
 
$key
)

112 ià(
FALSE
 !=ğ(
$v®
 = 
	`cÚfig_™em
(
$key
)))

114 
$this
->{'_'.
$key
} = 
$v®
;

119 ià(
	`cÚfig_™em
('cookie_prefix'))

121 
$this
->
_c¤f_cook›_Çme
 = 
	`cÚfig_™em
('cookie_prefix').$this->_csrf_cookie_name;

125 
$this
->
	`_c¤f_£t_hash
();

128 
	`log_mes§ge
('debug', "Security Class Initialized");

138 
public
 
funùiÚ
 
	$c¤f_v”ify
()

141 ià(
	`¡¹ouµ”
(
$_SERVER
['REQUEST_METHOD']) !== 'POST')

143  
$this
->
	`c¤f_£t_cook›
();

147 iàĞ! 
	`is£t
(
$_POST
[
$this
->
_c¤f_tok’_Çme
], 
$_COOKIE
[$this->
_c¤f_cook›_Çme
]))

149 
$this
->
	`c¤f_show_”rÜ
();

153 ià(
$_POST
[
$this
->
_c¤f_tok’_Çme
] !ğ
$_COOKIE
[$this->
_c¤f_cook›_Çme
])

155 
$this
->
	`c¤f_show_”rÜ
();

160 
	`un£t
(
$_POST
[
$this
->
_c¤f_tok’_Çme
]);

163 
	`un£t
(
$_COOKIE
[
$this
->
_c¤f_cook›_Çme
]);

164 
$this
->
	`_c¤f_£t_hash
();

165 
$this
->
	`c¤f_£t_cook›
();

167 
	`log_mes§ge
('debug', 'CSRFoken verified');

169  
$this
;

170 
	}
}

179 
public
 
funùiÚ
 
	$c¤f_£t_cook›
()

181 
$expœe
 = 
	`time
(è+ 
$this
->
_c¤f_expœe
;

182 
$£cu»_cook›
 = (
	`cÚfig_™em
('cook›_£cu»'è==ğ
TRUE
) ? 1 : 0;

184 ià(
$£cu»_cook›
 && (
	`em±y
(
$_SERVER
['HTTPS']è
OR
 
	`¡¹Şow”
($_SERVER['HTTPS']) === 'off'))

186  
FALSE
;

189 
	`£tcook›
(
$this
->
_c¤f_cook›_Çme
, $this->
_c¤f_hash
, 
$expœe
, 
	`cÚfig_™em
('cook›_·th'), cÚfig_™em('cook›_domaš'), 
$£cu»_cook›
);

191 
	`log_mes§ge
('debug', "CRSF cookie Set");

193  
$this
;

194 
	}
}

203 
public
 
funùiÚ
 
	$c¤f_show_”rÜ
()

205 
	`show_”rÜ
('The‡ction you have„equested is‚ot‡llowed.');

206 
	}
}

217 
public
 
funùiÚ
 
	$g‘_c¤f_hash
()

219  
$this
->
_c¤f_hash
;

220 
	}
}

231 
public
 
funùiÚ
 
	$g‘_c¤f_tok’_Çme
()

233  
$this
->
_c¤f_tok’_Çme
;

234 
	}
}

264 
public
 
funùiÚ
 
	$xss_ş—n
(
$¡r
, 
$is_image
 = 
FALSE
)

270 ià(
	`is_¬¿y
(
$¡r
))

272 
	`li¡
(
$key
èğ
	`—ch
(
$¡r
))

274 
$¡r
[
$key
] = 
$this
->
	`xss_ş—n
($str[$key]);

277  
$¡r
;

283 
$¡r
 = 
	`»move_švisibË_ch¬aù”s
($str);

286 
$¡r
 = 
$this
->
	`_v®id©e_’t™›s
($str);

298 
$¡r
 = 
	`¿wu¾decode
($str);

309 
$¡r
 = 
	`´eg_»¶aû_ÿÎback
("/[a-z]+=([\'\"]).*?\\1/si", 
	`¬¿y
(
$this
, '_convert_attribute'), $str);

311 
$¡r
 = 
	`´eg_»¶aû_ÿÎback
("/<\w+.*?(?=>|<|$)/si", 
	`¬¿y
(
$this
, '_decode_entity'), $str);

316 
$¡r
 = 
	`»move_švisibË_ch¬aù”s
($str);

327 ià(
	`¡½os
(
$¡r
, "\t"è!=ğ
FALSE
)

329 
$¡r
 = 
	`¡r_»¶aû
("\t", ' ', $str);

335 
$cÚv”‹d_¡ršg
 = 
$¡r
;

338 
$¡r
 = 
$this
->
	`_do_Ãv”_®lowed
($str);

349 ià(
$is_image
 ==ğ
TRUE
)

354 
$¡r
 = 
	`´eg_»¶aû
('/<\?(php)/i', "&lt;?\\1", $str);

358 
$¡r
 = 
	`¡r_»¶aû
(
	`¬¿y
('<?', '?'.'>'),‡rray('&lt;?', '?&gt;'), $str);

367 
$wÜds
 = 
	`¬¿y
(

372 
	`fÜ—ch
 (
$wÜds
 
as
 
$wÜd
)

374 
$‹mp
 = '';

376 
$i
 = 0, 
$wÜdËn
 = 
	`¡¾’
(
$wÜd
); $i < $wordlen; $i++)

378 
$‹mp
 .ğ
	`sub¡r
(
$wÜd
, 
$i
, 1)."\s*";

383 
$¡r
 = 
	`´eg_»¶aû_ÿÎback
('#('.
	`sub¡r
(
$‹mp
, 0, -3).')(\W)#is', 
	`¬¿y
(
$this
, '_compact_exploded_words'), $str);

394 
$Üigš®
 = 
$¡r
;

396 ià(
	`´eg_m©ch
("/<a/i", 
$¡r
))

398 
$¡r
 = 
	`´eg_»¶aû_ÿÎback
("#<a\s+([^>]*?)(>|$)#si", 
	`¬¿y
(
$this
, '_js_link_removal'), $str);

401 ià(
	`´eg_m©ch
("/<img/i", 
$¡r
))

403 
$¡r
 = 
	`´eg_»¶aû_ÿÎback
("#<img\s+([^>]*?)(\s?/?>|$)#si", 
	`¬¿y
(
$this
, '_js_img_removal'), $str);

406 ià(
	`´eg_m©ch
("/süt/i", 
$¡r
è
OR
…reg_match("/xss/i", $str))

408 
$¡r
 = 
	`´eg_»¶aû
("#<(/*)(script|xss)(.*?)\>#si", '[removed]', $str);

411 
$Üigš®
 !ğ
$¡r
);

413 
	`un£t
(
$Üigš®
);

416 
$¡r
 = 
$this
->
	`_»move_ev_©Œibu‹s
($¡r, 
$is_image
);

427 
$Çughty
 = 'alert|applet|audio|basefont|base|behavior|bgsound|blink|body|embed|expression|form|frameset|frame|head|html|ilayer|iframe|input|isindex|layer|link|meta|object|plaintext|style|script|textarea|title|video|xml|xss';

428 
$¡r
 = 
	`´eg_»¶aû_ÿÎback
('#<(/*\s*)('.
$Çughty
.')([^><]*)([><]*)#is', 
	`¬¿y
(
$this
, '_sanitize_naughty_html'), $str);

442 
$¡r
 = 
	`´eg_»¶aû
('#(alert|cmd|passthru|eval|exec|expression|system|fopen|fsockopen|file|file_get_contents|readfile|unlink)(\s*)\((.*?)\)#si', "\\1\\2&#40;\\3&#41;", $str);

448 
$¡r
 = 
$this
->
	`_do_Ãv”_®lowed
($str);

460 ià(
$is_image
 ==ğ
TRUE
)

462  (
$¡r
 =ğ
$cÚv”‹d_¡ršg
è? 
TRUE
: 
FALSE
;

465 
	`log_mes§ge
('debug', "XSS Filtering completed");

466  
$¡r
;

467 
	}
}

476 
public
 
funùiÚ
 
	$xss_hash
()

478 ià(
$this
->
_xss_hash
 == '')

480 
	`mt_¤ªd
();

481 
$this
->
_xss_hash
 = 
	`md5
(
	`time
(è+ 
	`mt_¿nd
(0, 1999999999));

484  
$this
->
_xss_hash
;

485 
	}
}

504 
public
 
funùiÚ
 
’t™y_decode
(
$¡r
, 
$ch¬£t
='UTF-8')

506 ià(
¡ri¡r
(
$¡r
, '&'è==ğ
FALSE
)

508  
$¡r
;

511 
	g$¡r
 = 
html_’t™y_decode
(
$¡r
, 
ENT_COMPAT
, 
$ch¬£t
);

512 
	g$¡r
 = 
´eg_»¶aû
('~&#x(0*[0-9a-f]{2,5})~ei', 'chr(hexdec("\\1"))', 
$¡r
);

513  
´eg_»¶aû
('~&#([0-9]{2,4})~e', 'chr(\\1)', 
$¡r
);

525 
public
 
funùiÚ
 
	$§n™ize_f’ame
(
$¡r
, 
$»Ïtive_·th
 = 
FALSE
)

527 
$bad
 = 
	`¬¿y
(

561 iàĞ! 
$»Ïtive_·th
)

563 
$bad
[] = './';

564 
$bad
[] = '/';

567 
$¡r
 = 
	`»move_švisibË_ch¬aù”s
($¡r, 
FALSE
);

568  
	`¡r¦ashes
(
	`¡r_»¶aû
(
$bad
, '', 
$¡r
));

569 
	}
}

582 
´Ùeùed
 
funùiÚ
 
	$_com·ù_ex¶oded_wÜds
(
$m©ches
)

584  
	`´eg_»¶aû
('/\s+/s', '', 
$m©ches
[1]).$matches[2];

585 
	}
}

604 
´Ùeùed
 
funùiÚ
 
	$_»move_ev_©Œibu‹s
(
$¡r
, 
$is_image
)

607 
$ev_©Œibu‹s
 = 
	`¬¿y
('on\w*', 'style', 'xmlns', 'formaction');

609 ià(
$is_image
 ==ğ
TRUE
)

615 
	`un£t
(
$ev_©Œibu‹s
[
	`¬¿y_£¬ch
('xmlns', $evil_attributes)]);

619 
$couÁ
 = 0;

620 
$©Œibs
 = 
	`¬¿y
();

623 
	`´eg_m©ch_®l
('/('.
	`im¶ode
('|', 
$ev_©Œibu‹s
).')\s*=\s*(\042|\047)([^\\2]*?)(\\2)/is', 
$¡r
, 
$m©ches
, 
PREG_SET_ORDER
);

625 
	`fÜ—ch
 (
$m©ches
 
as
 
$©Œ
)

627 
$©Œibs
[] = 
	`´eg_quÙe
(
$©Œ
[0], '/');

631 
	`´eg_m©ch_®l
('/('.
	`im¶ode
('|', 
$ev_©Œibu‹s
).')\s*=\s*([^\s>]*)/is', 
$¡r
, 
$m©ches
, 
PREG_SET_ORDER
);

633 
	`fÜ—ch
 (
$m©ches
 
as
 
$©Œ
)

635 
$©Œibs
[] = 
	`´eg_quÙe
(
$©Œ
[0], '/');

639 ià(
	`couÁ
(
$©Œibs
) > 0)

641 
$¡r
 = 
	`´eg_»¶aû
('/(<?)(\/?[^><]+?)([^A-Za-z<>\-])(.*?)('.
	`im¶ode
('|', 
$©Œibs
).')(.*?)([\s><]?)([><]*)/i', '$1$2 $4$6$7$8', $¡r, -1, 
$couÁ
);

644 } 
$couÁ
);

646  
$¡r
;

647 
	}
}

659 
´Ùeùed
 
funùiÚ
 
	$_§n™ize_Çughty_html
(
$m©ches
)

662 
$¡r
 = '&É;'.
$m©ches
[1].$matches[2].$matches[3];

665 
$¡r
 .ğ
	`¡r_»¶aû
(
	`¬¿y
('>', '<'),‡rray('&gt;', '&lt;'),

666 
$m©ches
[4]);

668  
$¡r
;

669 
	}
}

684 
´Ùeùed
 
funùiÚ
 
	$_js_lšk_»mov®
(
$m©ch
)

686  
	`¡r_»¶aû
(

687 
$m©ch
[1],

688 
	`´eg_»¶aû
(

691 
$this
->
	`_f‹r_©Œibu‹s
(
	`¡r_»¶aû
(
	`¬¿y
('<', '>'), '', 
$m©ch
[1]))

693 
$m©ch
[0]

695 
	}
}

710 
´Ùeùed
 
funùiÚ
 
	$_js_img_»mov®
(
$m©ch
)

712  
	`¡r_»¶aû
(

713 
$m©ch
[1],

714 
	`´eg_»¶aû
(

717 
$this
->
	`_f‹r_©Œibu‹s
(
	`¡r_»¶aû
(
	`¬¿y
('<', '>'), '', 
$m©ch
[1]))

719 
$m©ch
[0]

721 
	}
}

733 
´Ùeùed
 
funùiÚ
 
	$_cÚv”t_©Œibu‹
(
$m©ch
)

735  
	`¡r_»¶aû
(
	`¬¿y
('>', '<', '\\'),‡¼ay('&gt;', '&É;', '\\\\'), 
$m©ch
[0]);

736 
	}
}

748 
´Ùeùed
 
funùiÚ
 
	$_f‹r_©Œibu‹s
(
$¡r
)

750 
$out
 = '';

752 ià(
	`´eg_m©ch_®l
('#\s*[a-z\-]+\s*=\s*(\042|\047)([^\\1]*?)\\1#is', 
$¡r
, 
$m©ches
))

754 
	`fÜ—ch
 (
$m©ches
[0] 
as
 
$m©ch
)

756 
$out
 .ğ
	`´eg_»¶aû
("#/\*.*?\*/#s", '', 
$m©ch
);

760  
$out
;

761 
	}
}

773 
´Ùeùed
 
funùiÚ
 
	$_decode_’t™y
(
$m©ch
)

775  
$this
->
	`’t™y_decode
(
$m©ch
[0], 
	`¡¹ouµ”
(
	`cÚfig_™em
('charset')));

776 
	}
}

788 
´Ùeùed
 
funùiÚ
 
	$_v®id©e_’t™›s
(
$¡r
)

796 
$¡r
 = 
	`´eg_»¶aû
('|\&([a-z\_0-9\-]+)\=([a-z\_0-9\-]+)|i', 
$this
->
	`xss_hash
()."\\1=\\2", $str);

805 
$¡r
 = 
	`´eg_»¶aû
('#(&\#?[0-9a-z]{2,})([\x00-\x20])*;?#i', "\\1;\\2", $str);

813 
$¡r
 = 
	`´eg_»¶aû
('#(&\#x?)([0-9A-F]+);?#i',"\\1\\2;",$str);

818 
$¡r
 = 
	`¡r_»¶aû
(
$this
->
	`xss_hash
(), '&', $str);

820  
$¡r
;

821 
	}
}

833 
´Ùeùed
 
funùiÚ
 
	$_do_Ãv”_®lowed
(
$¡r
)

835 
$¡r
 = 
	`¡r_»¶aû
(
	`¬¿y_keys
(
$this
->
_Ãv”_®lowed_¡r
), $this->_never_allowed_str, $str);

837 
	`fÜ—ch
 (
$this
->
_Ãv”_®lowed_»gex
 
as
 
$»gex
)

839 
$¡r
 = 
	`´eg_»¶aû
('#'.
$»gex
.'#is', '[removed]', $str);

842  
$¡r
;

843 
	}
}

852 
´Ùeùed
 
funùiÚ
 
	$_c¤f_£t_hash
()

854 ià(
$this
->
_c¤f_hash
 == '')

860 ià(
	`is£t
(
$_COOKIE
[
$this
->
_c¤f_cook›_Çme
]) &&

861 
	`´eg_m©ch
('#^[0-9a-f]{32}$#iS', 
$_COOKIE
[
$this
->
_c¤f_cook›_Çme
]) === 1)

863  
$this
->
_c¤f_hash
 = 
$_COOKIE
[$this->
_c¤f_cook›_Çme
];

866  
$this
->
_c¤f_hash
 = 
	`md5
(
	`uniqid
(
	`¿nd
(), 
TRUE
));

869  
$this
->
_c¤f_hash
;

870 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/URI.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_URI
 {

37 
v¬
 
	m$keyv®
 = 
¬¿y
();

44 
v¬
 
	m$uri_¡ršg
;

51 
v¬
 
	m$£gm’ts
 = 
¬¿y
();

59 
v¬
 
	m$r£gm’ts
 = 
¬¿y
();

70 
funùiÚ
 
	$__cÚ¡ruù
()

72 
$this
->
cÚfig
 =& 
	`lßd_şass
('Config', 'core');

73 
	`log_mes§ge
('debug', "URI Class Initialized");

85 
funùiÚ
 
	$_ãtch_uri_¡ršg
()

87 ià(
	`¡¹ouµ”
(
$this
->
cÚfig
->
	`™em
('uri_protocol')) == 'AUTO')

90 ià(
	`php_§pi_Çme
(è=ğ'şi' 
Ü
 
	`defšed
('STDIN'))

92 
$this
->
	`_£t_uri_¡ršg
($this->
	`_·r£_şi_¬gs
());

97 ià(
$uri
 = 
$this
->
	`_d‘eù_uri
())

99 
$this
->
	`_£t_uri_¡ršg
(
$uri
);

105 
$·th
 = (
	`is£t
(
$_SERVER
['PATH_INFO'])è? $_SERVER['PATH_INFO'] : @
	`g‘’v
('PATH_INFO');

106 ià(
	`Œim
(
$·th
, '/'è!ğ'' && $·th !ğ"/".
SELF
)

108 
$this
->
	`_£t_uri_¡ršg
(
$·th
);

113 
$·th
 = (
	`is£t
(
$_SERVER
['QUERY_STRING'])è? $_SERVER['QUERY_STRING'] : @
	`g‘’v
('QUERY_STRING');

114 ià(
	`Œim
(
$·th
, '/') != '')

116 
$this
->
	`_£t_uri_¡ršg
(
$·th
);

121 ià(
	`is_¬¿y
(
$_GET
è&& 
	`couÁ
($_GETè=ğ1 && 
	`Œim
(
	`key
($_GET), '/') != '')

123 
$this
->
	`_£t_uri_¡ršg
(
	`key
(
$_GET
));

128 
$this
->
uri_¡ršg
 = '';

132 
$uri
 = 
	`¡¹ouµ”
(
$this
->
cÚfig
->
	`™em
('uri_protocol'));

134 ià(
$uri
 == 'REQUEST_URI')

136 
$this
->
	`_£t_uri_¡ršg
($this->
	`_d‘eù_uri
());

139 
	`–£if
 (
$uri
 == 'CLI')

141 
$this
->
	`_£t_uri_¡ršg
($this->
	`_·r£_şi_¬gs
());

145 
$·th
 = (
	`is£t
(
$_SERVER
[
$uri
])è? $_SERVER[$uri] : @
	`g‘’v
($uri);

146 
$this
->
	`_£t_uri_¡ršg
(
$·th
);

147 
	}
}

158 
funùiÚ
 
	$_£t_uri_¡ršg
(
$¡r
)

161 
$¡r
 = 
	`»move_švisibË_ch¬aù”s
($¡r, 
FALSE
);

164 
$this
->
uri_¡ršg
 = (
$¡r
 == '/') ? '' : $str;

165 
	}
}

178 
´iv©e
 
funùiÚ
 
	$_d‘eù_uri
()

180 iàĞ! 
	`is£t
(
$_SERVER
['REQUEST_URI']è
OR
 ! isset($_SERVER['SCRIPT_NAME']))

185 
$uri
 = 
$_SERVER
['REQUEST_URI'];

186 ià(
	`¡½os
(
$uri
, 
$_SERVER
['SCRIPT_NAME']) === 0)

188 
$uri
 = 
	`sub¡r
($uri, 
	`¡¾’
(
$_SERVER
['SCRIPT_NAME']));

190 
	`–£if
 (
	`¡½os
(
$uri
, 
	`dœÇme
(
$_SERVER
['SCRIPT_NAME'])) === 0)

192 
$uri
 = 
	`sub¡r
($uri, 
	`¡¾’
(
	`dœÇme
(
$_SERVER
['SCRIPT_NAME'])));

197 ià(
	`¡ºcmp
(
$uri
, '?/', 2) === 0)

199 
$uri
 = 
	`sub¡r
($uri, 2);

201 
$·¹s
 = 
	`´eg_¥l™
('#\?#i', 
$uri
, 2);

202 
$uri
 = 
$·¹s
[0];

203 ià(
	`is£t
(
$·¹s
[1]))

205 
$_SERVER
['QUERY_STRING'] = 
$·¹s
[1];

206 
	`·r£_¡r
(
$_SERVER
['QUERY_STRING'], 
$_GET
);

210 
$_SERVER
['QUERY_STRING'] = '';

211 
$_GET
 = 
	`¬¿y
();

214 ià(
$uri
 =ğ'/' || 
	`em±y
($uri))

219 
$uri
 = 
	`·r£_u¾
($uri, 
PHP_URL_PATH
);

222  
	`¡r_»¶aû
(
	`¬¿y
('//', '../'), '/', 
	`Œim
(
$uri
, '/'));

223 
	}
}

235 
´iv©e
 
funùiÚ
 
	$_·r£_şi_¬gs
()

237 
$¬gs
 = 
	`¬¿y_¦iû
(
$_SERVER
['argv'], 1);

239  
$¬gs
 ? '/' . 
	`im¶ode
('/', $args) : '';

240 
	}
}

251 
funùiÚ
 
	$_f‹r_uri
(
$¡r
)

253 ià(
$¡r
 !ğ'' && 
$this
->
cÚfig
->
	`™em
('³rm™‹d_uri_ch¬s'è!ğ'' && $this->cÚfig->™em('’abË_qu”y_¡ršgs'è=ğ
FALSE
)

257 iàĞ! 
	`´eg_m©ch
("|^[".
	`¡r_»¶aû
(
	`¬¿y
('\\-', '\-'), '-', 
	`´eg_quÙe
(
$this
->
cÚfig
->
	`™em
('³rm™‹d_uri_ch¬s'), '-'))."]+$|i", 
$¡r
))

259 
	`show_”rÜ
('The URI you submitted has disallowed characters.', 400);

264 
$bad
 = 
	`¬¿y
('$', '(', ')', '%28', '%29');

265 
$good
 = 
	`¬¿y
('&#36;', '&#40;', '&#41;', '&#40;', '&#41;');

267  
	`¡r_»¶aû
(
$bad
, 
$good
, 
$¡r
);

268 
	}
}

278 
funùiÚ
 
	$_»move_u¾_suffix
()

280 ià(
$this
->
cÚfig
->
	`™em
('url_suffix') != "")

282 
$this
->
uri_¡ršg
 = 
	`´eg_»¶aû
("|".
	`´eg_quÙe
($this->
cÚfig
->
	`™em
('url_suffix'))."$|", "", $this->uri_string);

284 
	}
}

295 
funùiÚ
 
	$_ex¶ode_£gm’ts
()

297 
	`fÜ—ch
 (
	`ex¶ode
("/", 
	`´eg_»¶aû
("|/*(.+?)/*$|", "\\1", 
$this
->
uri_¡ršg
)è
as
 
$v®
)

300 
$v®
 = 
	`Œim
(
$this
->
	`_f‹r_uri
($val));

302 ià(
$v®
 != '')

304 
$this
->
£gm’ts
[] = 
$v®
;

307 
	}
}

321 
funùiÚ
 
	$_»šdex_£gm’ts
()

323 
	`¬¿y_unshiá
(
$this
->
£gm’ts
, 
NULL
);

324 
	`¬¿y_unshiá
(
$this
->
r£gm’ts
, 
NULL
);

325 
	`un£t
(
$this
->
£gm’ts
[0]);

326 
	`un£t
(
$this
->
r£gm’ts
[0]);

327 
	}
}

341 
funùiÚ
 
	$£gm’t
(
$n
, 
$no_»suÉ
 = 
FALSE
)

343  ( ! 
	`is£t
(
$this
->
£gm’ts
[
$n
])è? 
$no_»suÉ
 : $this->segments[$n];

344 
	}
}

360 
funùiÚ
 
	$r£gm’t
(
$n
, 
$no_»suÉ
 = 
FALSE
)

362  ( ! 
	`is£t
(
$this
->
r£gm’ts
[
$n
])è? 
$no_»suÉ
 : $this->rsegments[$n];

363 
	}
}

388 
funùiÚ
 
uri_to_assoc
(
$n
 = 3, 
$deçuÉ
 = 
	$¬¿y
())

390  
$this
->
	`_uri_to_assoc
(
$n
, 
$deçuÉ
, 'segment');

391 
	}
}

401 
funùiÚ
 
ruri_to_assoc
(
$n
 = 3, 
$deçuÉ
 = 
	$¬¿y
())

403  
$this
->
	`_uri_to_assoc
(
$n
, 
$deçuÉ
, 'rsegment');

404 
	}
}

417 
funùiÚ
 
_uri_to_assoc
(
$n
 = 3, 
$deçuÉ
 = 
¬¿y
(), 
$which
 = 'segment')

419 ià(
$which
 == 'segment')

421 
$tÙ®_£gm’ts
 = 'total_segments';

422 
	g$£gm’t_¬¿y
 = 'segment_array';

426 
	g$tÙ®_£gm’ts
 = 'total_rsegments';

427 
	g$£gm’t_¬¿y
 = 'rsegment_array';

430 iàĞ! 
is_num”ic
(
$n
))

432  
	g$deçuÉ
;

435 ià(
is£t
(
$this
->
keyv®
[
$n
]))

437  
	g$this
->
	gkeyv®
[
$n
];

440 ià(
	g$this
->
$tÙ®_£gm’ts
(è< 
	g$n
)

442 ià(
couÁ
(
$deçuÉ
) == 0)

444  
¬¿y
();

447 
	g$»tv®
 = 
¬¿y
();

448 
fÜ—ch
 (
$deçuÉ
 
as
 
$v®
)

450 
	g$»tv®
[
$v®
] = 
FALSE
;

452  
	g$»tv®
;

455 
	g$£gm’ts
 = 
¬¿y_¦iû
(
$this
->
$£gm’t_¬¿y
(), (
$n
 - 1));

457 
	g$i
 = 0;

458 
	g$Ï¡v®
 = '';

459 
	g$»tv®
 = 
¬¿y
();

460 
fÜ—ch
 (
$£gm’ts
 
as
 
$£g
)

462 ià(
	g$i
 % 2)

464 
	g$»tv®
[
$Ï¡v®
] = 
$£g
;

468 
	g$»tv®
[
$£g
] = 
FALSE
;

469 
	g$Ï¡v®
 = 
$£g
;

472 
	g$i
++;

475 ià(
couÁ
(
$deçuÉ
) > 0)

477 
fÜ—ch
 (
$deçuÉ
 
as
 
$v®
)

479 iàĞ! 
¬¿y_key_exi¡s
(
$v®
, 
$»tv®
))

481 
	g$»tv®
[
$v®
] = 
FALSE
;

487 
	g$this
->
	gkeyv®
[
$n
] = 
$»tv®
;

488  
	g$»tv®
;

501 
funùiÚ
 
	$assoc_to_uri
(
$¬¿y
)

503 
$‹mp
 = 
	`¬¿y
();

504 
	`fÜ—ch
 ((
¬¿y
)
$¬¿y
 
as
 
$key
 => 
$v®
)

506 
$‹mp
[] = 
$key
;

507 
$‹mp
[] = 
$v®
;

510  
	`im¶ode
('/', 
$‹mp
);

511 
	}
}

523 
funùiÚ
 
¦ash_£gm’t
(
$n
, 
$wh”e
 = 'trailing')

525  
$this
->
_¦ash_£gm’t
(
$n
, 
$wh”e
, 'segment');

538 
funùiÚ
 
¦ash_r£gm’t
(
$n
, 
$wh”e
 = 'trailing')

540  
$this
->
_¦ash_£gm’t
(
$n
, 
$wh”e
, 'rsegment');

554 
funùiÚ
 
_¦ash_£gm’t
(
$n
, 
$wh”e
 = 'Œašg', 
$which
 = 'segment')

556 
$Ëadšg
 = '/';

557 
	g$Œašg
 = '/';

559 ià(
	g$wh”e
 == 'trailing')

561 
$Ëadšg
 = '';

563 
–£if
 (
$wh”e
 == 'leading')

565 
$Œašg
 = '';

568  
	g$Ëadšg
.
	g$this
->
$which
(
$n
).
	g$Œašg
;

579 
funùiÚ
 
	$£gm’t_¬¿y
()

581  
$this
->
£gm’ts
;

582 
	}
}

592 
funùiÚ
 
	$r£gm’t_¬¿y
()

594  
$this
->
r£gm’ts
;

595 
	}
}

605 
funùiÚ
 
	$tÙ®_£gm’ts
()

607  
	`couÁ
(
$this
->
£gm’ts
);

608 
	}
}

618 
funùiÚ
 
	$tÙ®_r£gm’ts
()

620  
	`couÁ
(
$this
->
r£gm’ts
);

621 
	}
}

631 
funùiÚ
 
	$uri_¡ršg
()

633  
$this
->
uri_¡ršg
;

634 
	}
}

645 
funùiÚ
 
	$ruri_¡ršg
()

647  '/'.
	`im¶ode
('/', 
$this
->
	`r£gm’t_¬¿y
());

648 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Utf8.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_Utf8
 {

37 
funùiÚ
 
	$__cÚ¡ruù
()

39 
	`log_mes§ge
('debug', "Utf8 Class Initialized");

41 
glob®
 
$CFG
;

44 
	`´eg_m©ch
('/./u', 'Ã©') === 1

45 
AND
 
	`funùiÚ_exi¡s
('iconv')

46 
AND
 
	`ši_g‘
('mbstring.func_overload') != 1

47 
AND
 
$CFG
->
	`™em
('charset') == 'UTF-8'

50 
	`log_mes§ge
('debug', "UTF-8 Support Enabled");

52 
	`defše
('UTF8_ENABLED', 
TRUE
);

57 ià(
	`ex‹nsiÚ_lßded
('mbstring'))

59 
	`defše
('MB_ENABLED', 
TRUE
);

60 
	`mb_š‹º®_’codšg
('UTF-8');

64 
	`defše
('MB_ENABLED', 
FALSE
);

69 
	`log_mes§ge
('debug', "UTF-8 Support Disabled");

70 
	`defše
('UTF8_ENABLED', 
FALSE
);

85 
funùiÚ
 
	$ş—n_¡ršg
(
$¡r
)

87 ià(
$this
->
	`_is_ascii
(
$¡r
è==ğ
FALSE
)

89 
$¡r
 = @
	`icÚv
('UTF-8', 'UTF-8//IGNORE', $str);

92  
$¡r
;

93 
	}
}

108 
funùiÚ
 
	$§ã_ascii_fÜ_xml
(
$¡r
)

110  
	`»move_švisibË_ch¬aù”s
(
$¡r
, 
FALSE
);

111 
	}
}

125 
funùiÚ
 
	$cÚv”t_to_utf8
(
$¡r
, 
$’codšg
)

127 ià(
	`funùiÚ_exi¡s
('iconv'))

129 
$¡r
 = @
	`icÚv
(
$’codšg
, 'UTF-8', $str);

131 
	`–£if
 (
	`funùiÚ_exi¡s
('mb_convert_encoding'))

133 
$¡r
 = @
	`mb_cÚv”t_’codšg
($¡r, 'UTF-8', 
$’codšg
);

137  
FALSE
;

140  
$¡r
;

141 
	}
}

154 
funùiÚ
 
	$_is_ascii
(
$¡r
)

156  (
	`´eg_m©ch
('/[^\x00-\x7F]/S', 
$¡r
) == 0);

157 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 
	gfunùiÚ
 &
DB
(
$·¿ms
 = '', 
$aùive_»cÜd_ov”ride
 = 
NULL
)

30 ià(
is_¡ršg
(
$·¿ms
è
AND
 
¡½os
($·¿ms, '://'è==ğ
FALSE
)

33 iàĞ! 
defšed
('ENVIRONMENT'è
OR
 ! 
fe_exi¡s
(
$fe_·th
 = 
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/database.php'))

35 iàĞ! 
fe_exi¡s
(
$fe_·th
 = 
APPPATH
.'config/database.php'))

37 
show_”rÜ
('The configuration file database.php does‚otƒxist.');

41 
šşude
(
$fe_·th
);

43 iàĞ! 
is£t
(
$db
è
OR
 
couÁ
($db) == 0)

45 
show_”rÜ
('No database connection settings were found inhe database config file.');

48 ià(
	g$·¿ms
 != '')

50 
$aùive_group
 = 
$·¿ms
;

53 iàĞ! 
is£t
(
$aùive_group
è
	gOR
 ! is£t(
$db
[$active_group]))

55 
show_”rÜ
('You have specified‡n invalid database connection group.');

58 
	g$·¿ms
 = 
$db
[
$aùive_group
];

60 
–£if
 (
is_¡ršg
(
$·¿ms
))

70 ià((
	g$dns
 = @
·r£_u¾
(
$·¿ms
)è==ğ
FALSE
)

72 
show_”rÜ
('Invalid DB Connection String');

75 
	g$·¿ms
 = 
¬¿y
(

76 'dbdriv”' => 
$dns
['scheme'],

77 'ho¡Çme' => (
is£t
(
$dns
['ho¡'])è? 
¿wu¾decode
($dns['host']) : '',

78 'u£ºame' => (
is£t
(
$dns
['u£r'])è? 
¿wu¾decode
($dns['user']) : '',

79 '·sswÜd' => (
is£t
(
$dns
['·ss'])è? 
¿wu¾decode
($dns['pass']) : '',

80 'd©aba£' => (
is£t
(
$dns
['·th'])è? 
¿wu¾decode
(
sub¡r
($dns['path'], 1)) : ''

84 ià(
is£t
(
$dns
['query']))

86 
·r£_¡r
(
$dns
['qu”y'], 
$exŒa
);

88 
fÜ—ch
 (
$exŒa
 
as
 
$key
 => 
$v®
)

91 ià(
¡¹ouµ”
(
$v®
) == "TRUE")

93 
$v®
 = 
TRUE
;

95 
–£if
 (
¡¹ouµ”
(
$v®
) == "FALSE")

97 
$v®
 = 
FALSE
;

100 
	g$·¿ms
[
$key
] = 
$v®
;

106 iàĞ! 
is£t
(
$·¿ms
['dbdriv”']è
OR
 
	g$·¿ms
['dbdriver'] == '')

108 
show_”rÜ
('You have‚ot selected‡ databaseypeo connecto.');

116 ià(
	g$aùive_»cÜd_ov”ride
 !=ğ
NULL
)

118 
$aùive_»cÜd
 = 
$aùive_»cÜd_ov”ride
;

121 
»quœe_Úû
(
BASEPATH
.'database/DB_driver.php');

123 iàĞ! 
is£t
(
$aùive_»cÜd
è
OR
 
	g$aùive_»cÜd
 =ğ
TRUE
)

125 
»quœe_Úû
(
BASEPATH
.'database/DB_active_rec.php');

127 iàĞ! 
şass_exi¡s
('CI_DB'))

129 
ev®
('class CI_DBƒxtends CI_DB_active_record { }');

134 iàĞ! 
şass_exi¡s
('CI_DB'))

136 
ev®
('class CI_DBƒxtends CI_DB_driver { }');

140 
»quœe_Úû
(
BASEPATH
.'d©aba£/driv”s/'.
$·¿ms
['dbdriver'].'/'.$params['dbdriver'].'_driver.php');

143 
	g$driv”
 = 'CI_DB_'.
$·¿ms
['dbdriver'].'_driver';

144 
	g$DB
 = 
Ãw
 
$driv”
(
$·¿ms
);

146 ià(
	g$DB
->
	gautoš™
 =ğ
TRUE
)

148 
$DB
->
š™Ÿlize
();

151 ià(
is£t
(
$·¿ms
['¡riùÚ']è&& 
	g$·¿ms
['¡riùÚ'] =ğ
TRUE
)

153 
$DB
->
qu”y
('SET SESSION sql_mode="STRICT_ALL_TABLES"');

156  
	g$DB
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_active_rec.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_DB_aùive_»cÜd
 
ex‹nds
 
	mCI_DB_driv”
 {

31 
v¬
 
	m$¬_£Ëù
 = 
¬¿y
();

32 
v¬
 
	m$¬_di¡šù
 = 
FALSE
;

33 
v¬
 
	m$¬_äom
 = 
¬¿y
();

34 
v¬
 
	m$¬_još
 = 
¬¿y
();

35 
v¬
 
	m$¬_wh”e
 = 
¬¿y
();

36 
v¬
 
	m$¬_like
 = 
¬¿y
();

37 
v¬
 
	m$¬_groupby
 = 
¬¿y
();

38 
v¬
 
	m$¬_havšg
 = 
¬¿y
();

39 
v¬
 
	m$¬_keys
 = 
¬¿y
();

40 
v¬
 
	m$¬_lim™
 = 
FALSE
;

41 
v¬
 
	m$¬_off£t
 = 
FALSE
;

42 
v¬
 
	m$¬_Üd”
 = 
FALSE
;

43 
v¬
 
	m$¬_Üd”by
 = 
¬¿y
();

44 
v¬
 
	m$¬_£t
 = 
¬¿y
();

45 
v¬
 
	m$¬_wh”eš
 = 
¬¿y
();

46 
v¬
 
	m$¬_®Ÿ£d_bËs
 = 
¬¿y
();

47 
v¬
 
	m$¬_¡Üe_¬¿y
 = 
¬¿y
();

50 
v¬
 
	m$¬_ÿchšg
 = 
FALSE
;

51 
v¬
 
	m$¬_ÿche_exi¡s
 = 
¬¿y
();

52 
v¬
 
	m$¬_ÿche_£Ëù
 = 
¬¿y
();

53 
v¬
 
	m$¬_ÿche_äom
 = 
¬¿y
();

54 
v¬
 
	m$¬_ÿche_još
 = 
¬¿y
();

55 
v¬
 
	m$¬_ÿche_wh”e
 = 
¬¿y
();

56 
v¬
 
	m$¬_ÿche_like
 = 
¬¿y
();

57 
v¬
 
	m$¬_ÿche_groupby
 = 
¬¿y
();

58 
v¬
 
	m$¬_ÿche_havšg
 = 
¬¿y
();

59 
v¬
 
	m$¬_ÿche_Üd”by
 = 
¬¿y
();

60 
v¬
 
	m$¬_ÿche_£t
 = 
¬¿y
();

62 
v¬
 
	m$¬_no_esÿ³
 = 
¬¿y
();

63 
v¬
 
	m$¬_ÿche_no_esÿ³
 = 
¬¿y
();

75 
public
 
funùiÚ
 
£Ëù
(
$£Ëù
 = '*', 
$esÿ³
 = 
NULL
)

77 ià(
is_¡ršg
(
$£Ëù
))

79 
$£Ëù
 = 
ex¶ode
(',', $select);

82 
fÜ—ch
 (
$£Ëù
 
as
 
$v®
)

84 
	m$v®
 = 
Œim
(
$v®
);

86 ià(
	m$v®
 != '')

88 
$this
->
¬_£Ëù
[] = 
$v®
;

89 
	m$this
->
	m¬_no_esÿ³
[] = 
$esÿ³
;

91 ià(
	m$this
->
	m¬_ÿchšg
 ==ğ
TRUE
)

93 
$this
->
¬_ÿche_£Ëù
[] = 
$v®
;

94 
	m$this
->
	m¬_ÿche_exi¡s
[] = 'select';

95 
	m$this
->
	m¬_ÿche_no_esÿ³
[] = 
$esÿ³
;

99  
	m$this
;

113 
public
 
funùiÚ
 
£Ëù_max
(
$£Ëù
 = '', 
$®Ÿs
 = '')

115  
$this
->
_max_mš_avg_sum
(
$£Ëù
, 
$®Ÿs
, 'MAX');

129 
public
 
funùiÚ
 
£Ëù_mš
(
$£Ëù
 = '', 
$®Ÿs
 = '')

131  
$this
->
_max_mš_avg_sum
(
$£Ëù
, 
$®Ÿs
, 'MIN');

145 
public
 
funùiÚ
 
£Ëù_avg
(
$£Ëù
 = '', 
$®Ÿs
 = '')

147  
$this
->
_max_mš_avg_sum
(
$£Ëù
, 
$®Ÿs
, 'AVG');

161 
public
 
funùiÚ
 
£Ëù_sum
(
$£Ëù
 = '', 
$®Ÿs
 = '')

163  
$this
->
_max_mš_avg_sum
(
$£Ëù
, 
$®Ÿs
, 'SUM');

180 
´Ùeùed
 
funùiÚ
 
_max_mš_avg_sum
(
$£Ëù
 = '', 
$®Ÿs
 = '', 
$ty³
 = 'MAX')

182 iàĞ! 
is_¡ršg
(
$£Ëù
è
OR
 $select == '')

184 
$this
->
di¥Ïy_”rÜ
('db_invalid_query');

187 
	g$ty³
 = 
¡¹ouµ”
(
$ty³
);

189 iàĞ! 
š_¬¿y
(
$ty³
, 
¬¿y
('MAX', 'MIN', 'AVG', 'SUM')))

191 
show_”rÜ
('Inv®id funùiÚy³: '.
$ty³
);

194 ià(
	g$®Ÿs
 == '')

196 
$®Ÿs
 = 
$this
->
_ü—‹_®Ÿs_äom_bË
(
Œim
(
$£Ëù
));

199 
	g$sql
 = 
$ty³
.'('.
$this
->
_´Ùeù_id’tif›rs
(
Œim
(
$£Ëù
)).'èAS '.
$®Ÿs
;

201 
	g$this
->
	g¬_£Ëù
[] = 
$sql
;

203 ià(
	g$this
->
	g¬_ÿchšg
 ==ğ
TRUE
)

205 
$this
->
¬_ÿche_£Ëù
[] = 
$sql
;

206 
	g$this
->
	g¬_ÿche_exi¡s
[] = 'select';

209  
	g$this
;

220 
´Ùeùed
 
funùiÚ
 
	$_ü—‹_®Ÿs_äom_bË
(
$™em
)

222 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
)

224  
	`’d
(
	`ex¶ode
('.', 
$™em
));

227  
$™em
;

228 
	}
}

240 
public
 
funùiÚ
 
	$di¡šù
(
$v®
 = 
TRUE
)

242 
$this
->
¬_di¡šù
 = (
	`is_boŞ
(
$v®
)è? $v® : 
TRUE
;

243  
$this
;

244 
	}
}

256 
public
 
funùiÚ
 
	$äom
(
$äom
)

258 
	`fÜ—ch
 ((
¬¿y
è
$äom
 
as
 
$v®
)

260 ià(
	`¡½os
(
$v®
, ','è!=ğ
FALSE
)

262 
	`fÜ—ch
 (
	`ex¶ode
(',', 
$v®
è
as
 
$v
)

264 
$v
 = 
	`Œim
($v);

265 
$this
->
	`_Œack_®Ÿ£s
(
$v
);

267 
$this
->
¬_äom
[] = $this->
	`_´Ùeù_id’tif›rs
(
$v
, 
TRUE
, 
NULL
, 
FALSE
);

269 ià(
$this
->
¬_ÿchšg
 ==ğ
TRUE
)

271 
$this
->
¬_ÿche_äom
[] = $this->
	`_´Ùeù_id’tif›rs
(
$v
, 
TRUE
, 
NULL
, 
FALSE
);

272 
$this
->
¬_ÿche_exi¡s
[] = 'from';

279 
$v®
 = 
	`Œim
($val);

283 
$this
->
	`_Œack_®Ÿ£s
(
$v®
);

285 
$this
->
¬_äom
[] = $this->
	`_´Ùeù_id’tif›rs
(
$v®
, 
TRUE
, 
NULL
, 
FALSE
);

287 ià(
$this
->
¬_ÿchšg
 ==ğ
TRUE
)

289 
$this
->
¬_ÿche_äom
[] = $this->
	`_´Ùeù_id’tif›rs
(
$v®
, 
TRUE
, 
NULL
, 
FALSE
);

290 
$this
->
¬_ÿche_exi¡s
[] = 'from';

295  
$this
;

296 
	}
}

310 
public
 
funùiÚ
 
još
(
$bË
, 
$cÚd
, 
$ty³
 = '')

312 ià(
$ty³
 != '')

314 
$ty³
 = 
¡¹ouµ”
(
Œim
($type));

316 iàĞ! 
š_¬¿y
(
$ty³
, 
¬¿y
('LEFT', 'RIGHT', 'OUTER', 'INNER', 'LEFT OUTER', 'RIGHT OUTER')))

318 
	g$ty³
 = '';

322 
	g$ty³
 .= ' ';

328 
	g$this
->
_Œack_®Ÿ£s
(
$bË
);

331 ià(
´eg_m©ch
('/([\w\.]+)([\W\s]+)(.+)/', 
$cÚd
, 
$m©ch
))

333 
	g$m©ch
[1] = 
$this
->
_´Ùeù_id’tif›rs
(
$m©ch
[1]);

334 
	g$m©ch
[3] = 
$this
->
_´Ùeù_id’tif›rs
(
$m©ch
[3]);

336 
	g$cÚd
 = 
$m©ch
[1].$match[2].$match[3];

340 
	g$još
 = 
$ty³
.'JOIN '.
$this
->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
).' ON '.
	g$cÚd
;

342 
	g$this
->
	g¬_još
[] = 
$još
;

343 ià(
	g$this
->
	g¬_ÿchšg
 ==ğ
TRUE
)

345 
$this
->
¬_ÿche_još
[] = 
$još
;

346 
	g$this
->
	g¬_ÿche_exi¡s
[] = 'join';

349  
	g$this
;

364 
public
 
funùiÚ
 
	$wh”e
(
$key
, 
$v®ue
 = 
NULL
, 
$esÿ³
 = 
TRUE
)

366  
$this
->
	`_wh”e
(
$key
, 
$v®ue
, 'AND ', 
$esÿ³
);

367 
	}
}

381 
public
 
funùiÚ
 
	$Ü_wh”e
(
$key
, 
$v®ue
 = 
NULL
, 
$esÿ³
 = 
TRUE
)

383  
$this
->
	`_wh”e
(
$key
, 
$v®ue
, 'OR ', 
$esÿ³
);

384 
	}
}

398 
´Ùeùed
 
funùiÚ
 
_wh”e
(
$key
, 
$v®ue
 = 
NULL
, 
$ty³
 = 'AND ', 
$esÿ³
 = NULL)

400 iàĞ! 
is_¬¿y
(
$key
))

402 
$key
 = 
¬¿y
($key => 
$v®ue
);

406 iàĞ! 
is_boŞ
(
$esÿ³
))

408 
	g$esÿ³
 = 
$this
->
_´Ùeù_id’tif›rs
;

411 
fÜ—ch
 (
$key
 
as
 
$k
 => 
$v
)

413 
$´efix
 = (
couÁ
(
$this
->
¬_wh”e
è=ğ0 
AND
 couÁ($this->
¬_ÿche_wh”e
è=ğ0è? '' : 
$ty³
;

415 ià(
is_nuÎ
(
$v
è&& ! 
	g$this
->
_has_İ”©Ü
(
$k
))

418 
	g$k
 .= ' IS NULL';

421 iàĞ! 
is_nuÎ
(
$v
))

423 ià(
	g$esÿ³
 ==ğ
TRUE
)

425 
$k
 = 
$this
->
_´Ùeù_id’tif›rs
($k, 
FALSE
, 
$esÿ³
);

427 
	g$v
 = ' '.
$this
->
esÿ³
(
$v
);

430 iàĞ! 
	g$this
->
_has_İ”©Ü
(
$k
))

432 
	g$k
 .= ' = ';

437 
	g$k
 = 
$this
->
_´Ùeù_id’tif›rs
(
$k
, 
FALSE
, 
$esÿ³
);

440 
	g$this
->
	g¬_wh”e
[] = 
$´efix
.
$k
.
$v
;

442 ià(
	g$this
->
	g¬_ÿchšg
 ==ğ
TRUE
)

444 
$this
->
¬_ÿche_wh”e
[] = 
$´efix
.
$k
.
$v
;

445 
	g$this
->
	g¬_ÿche_exi¡s
[] = 'where';

450  
	g$this
;

465 
public
 
funùiÚ
 
	$wh”e_š
(
$key
 = 
NULL
, 
$v®ues
 = NULL)

467  
$this
->
	`_wh”e_š
(
$key
, 
$v®ues
);

468 
	}
}

482 
public
 
funùiÚ
 
	$Ü_wh”e_š
(
$key
 = 
NULL
, 
$v®ues
 = NULL)

484  
$this
->
	`_wh”e_š
(
$key
, 
$v®ues
, 
FALSE
, 'OR ');

485 
	}
}

499 
public
 
funùiÚ
 
	$wh”e_nÙ_š
(
$key
 = 
NULL
, 
$v®ues
 = NULL)

501  
$this
->
	`_wh”e_š
(
$key
, 
$v®ues
, 
TRUE
);

502 
	}
}

516 
public
 
funùiÚ
 
	$Ü_wh”e_nÙ_š
(
$key
 = 
NULL
, 
$v®ues
 = NULL)

518  
$this
->
	`_wh”e_š
(
$key
, 
$v®ues
, 
TRUE
, 'OR ');

519 
	}
}

534 
´Ùeùed
 
funùiÚ
 
_wh”e_š
(
$key
 = 
NULL
, 
$v®ues
 = NULL, 
$nÙ
 = 
FALSE
, 
$ty³
 = 'AND ')

536 ià(
$key
 ==ğ
NULL
 
OR
 
$v®ues
 === NULL)

541 iàĞ! 
is_¬¿y
(
$v®ues
))

543 
	g$v®ues
 = 
¬¿y
(
$v®ues
);

546 
	g$nÙ
 = (
$nÙ
) ? ' NOT' : '';

548 
fÜ—ch
 (
$v®ues
 
as
 
$v®ue
)

550 
	g$this
->
	g¬_wh”eš
[] = 
$this
->
esÿ³
(
$v®ue
);

553 
	g$´efix
 = (
couÁ
(
$this
->
¬_wh”e
è=ğ0è? '' : 
$ty³
;

555 
	g$wh”e_š
 = 
$´efix
 . 
$this
->
_´Ùeù_id’tif›rs
(
$key
è. 
$nÙ
 . " IN (" . 
im¶ode
(", ", $this->
¬_wh”eš
) . ") ";

557 
	g$this
->
	g¬_wh”e
[] = 
$wh”e_š
;

558 ià(
	g$this
->
	g¬_ÿchšg
 ==ğ
TRUE
)

560 
$this
->
¬_ÿche_wh”e
[] = 
$wh”e_š
;

561 
	g$this
->
	g¬_ÿche_exi¡s
[] = 'where';

565 
	g$this
->
	g¬_wh”eš
 = 
¬¿y
();

566  
	g$this
;

581 
public
 
funùiÚ
 
like
(
$f›ld
, 
$m©ch
 = '', 
$side
 = 'both')

583  
$this
->
_like
(
$f›ld
, 
$m©ch
, 'AND ', 
$side
);

598 
public
 
funùiÚ
 
nÙ_like
(
$f›ld
, 
$m©ch
 = '', 
$side
 = 'both')

600  
$this
->
_like
(
$f›ld
, 
$m©ch
, 'AND ', 
$side
, 'NOT');

615 
public
 
funùiÚ
 
Ü_like
(
$f›ld
, 
$m©ch
 = '', 
$side
 = 'both')

617  
$this
->
_like
(
$f›ld
, 
$m©ch
, 'OR ', 
$side
);

632 
public
 
funùiÚ
 
Ü_nÙ_like
(
$f›ld
, 
$m©ch
 = '', 
$side
 = 'both')

634  
$this
->
_like
(
$f›ld
, 
$m©ch
, 'OR ', 
$side
, 'NOT');

649 
´Ùeùed
 
funùiÚ
 
_like
(
$f›ld
, 
$m©ch
 = '', 
$ty³
 = 'AND ', 
$side
 = 'bÙh', 
$nÙ
 = '')

651 iàĞ! 
is_¬¿y
(
$f›ld
))

653 
$f›ld
 = 
¬¿y
($f›ld => 
$m©ch
);

656 
fÜ—ch
 (
$f›ld
 
as
 
$k
 => 
$v
)

658 
$k
 = 
$this
->
_´Ùeù_id’tif›rs
($k);

660 
	g$´efix
 = (
couÁ
(
$this
->
¬_like
è=ğ0è? '' : 
$ty³
;

662 
	g$v
 = 
$this
->
esÿ³_like_¡r
(
$v
);

664 ià(
	g$side
 == 'none')

666 
$like_¡©em’t
 = 
$´efix
." $k $not LIKE '{$v}'";

668 
–£if
 (
$side
 == 'before')

670 
$like_¡©em’t
 = 
$´efix
." $k $not LIKE '%{$v}'";

672 
–£if
 (
$side
 == 'after')

674 
$like_¡©em’t
 = 
$´efix
." $k $not LIKE '{$v}%'";

678 
	g$like_¡©em’t
 = 
$´efix
." $k $not LIKE '%{$v}%'";

682 ià(
	g$this
->
	g_like_esÿ³_¡r
 != '')

684 
$like_¡©em’t
 = $like_¡©em’t.
¥rštf
(
$this
->
_like_esÿ³_¡r
, $this->
_like_esÿ³_chr
);

687 
	g$this
->
	g¬_like
[] = 
$like_¡©em’t
;

688 ià(
	g$this
->
	g¬_ÿchšg
 ==ğ
TRUE
)

690 
$this
->
¬_ÿche_like
[] = 
$like_¡©em’t
;

691 
	g$this
->
	g¬_ÿche_exi¡s
[] = 'like';

695  
	g$this
;

706 
public
 
funùiÚ
 
	$group_by
(
$by
)

708 ià(
	`is_¡ršg
(
$by
))

710 
$by
 = 
	`ex¶ode
(',', $by);

713 
	`fÜ—ch
 (
$by
 
as
 
$v®
)

715 
$v®
 = 
	`Œim
($val);

717 ià(
$v®
 != '')

719 
$this
->
¬_groupby
[] = $this->
	`_´Ùeù_id’tif›rs
(
$v®
);

721 ià(
$this
->
¬_ÿchšg
 ==ğ
TRUE
)

723 
$this
->
¬_ÿche_groupby
[] = $this->
	`_´Ùeù_id’tif›rs
(
$v®
);

724 
$this
->
¬_ÿche_exi¡s
[] = 'groupby';

728  
$this
;

729 
	}
}

742 
public
 
funùiÚ
 
havšg
(
$key
, 
$v®ue
 = '', 
$esÿ³
 = 
TRUE
)

744  
$this
->
_havšg
(
$key
, 
$v®ue
, 'AND ', 
$esÿ³
);

758 
public
 
funùiÚ
 
Ü_havšg
(
$key
, 
$v®ue
 = '', 
$esÿ³
 = 
TRUE
)

760  
$this
->
_havšg
(
$key
, 
$v®ue
, 'OR ', 
$esÿ³
);

774 
´Ùeùed
 
funùiÚ
 
_havšg
(
$key
, 
$v®ue
 = '', 
$ty³
 = 'AND ', 
$esÿ³
 = 
TRUE
)

776 iàĞ! 
is_¬¿y
(
$key
))

778 
$key
 = 
¬¿y
($key => 
$v®ue
);

781 
fÜ—ch
 (
$key
 
as
 
$k
 => 
$v
)

783 
$´efix
 = (
couÁ
(
$this
->
¬_havšg
è=ğ0è? '' : 
$ty³
;

785 ià(
	g$esÿ³
 ==ğ
TRUE
)

787 
$k
 = 
$this
->
_´Ùeù_id’tif›rs
($k);

790 iàĞ! 
	g$this
->
_has_İ”©Ü
(
$k
))

792 
	g$k
 .= ' = ';

795 ià(
	g$v
 != '')

797 
$v
 = ' '.
$this
->
esÿ³
($v);

800 
	g$this
->
	g¬_havšg
[] = 
$´efix
.
$k
.
$v
;

801 ià(
	g$this
->
	g¬_ÿchšg
 ==ğ
TRUE
)

803 
$this
->
¬_ÿche_havšg
[] = 
$´efix
.
$k
.
$v
;

804 
	g$this
->
	g¬_ÿche_exi¡s
[] = 'having';

808  
	g$this
;

820 
public
 
funùiÚ
 
Üd”_by
(
$Üd”by
, 
$dœeùiÚ
 = '')

822 ià(
¡¹Şow”
(
$dœeùiÚ
) == 'random')

824 
$Üd”by
 = '';

825 
	g$dœeùiÚ
 = 
$this
->
_¿ndom_keywÜd
;

827 
–£if
 (
Œim
(
$dœeùiÚ
) != '')

829 
$dœeùiÚ
 = (
š_¬¿y
(
¡¹ouµ”
(
Œim
($dœeùiÚ)), 
¬¿y
('ASC', 'DESC'), 
TRUE
)è? ' '.
	g$dœeùiÚ
 : ' ASC';

833 ià(
¡½os
(
$Üd”by
, ','è!=ğ
FALSE
)

835 
$‹mp
 = 
¬¿y
();

836 
fÜ—ch
 (
ex¶ode
(',', 
$Üd”by
è
as
 
$·¹
)

838 
	g$·¹
 = 
Œim
(
$·¹
);

839 iàĞ! 
š_¬¿y
(
$·¹
, 
$this
->
¬_®Ÿ£d_bËs
))

841 
	g$·¹
 = 
$this
->
_´Ùeù_id’tif›rs
(
Œim
(
$·¹
));

844 
	g$‹mp
[] = 
$·¹
;

847 
	g$Üd”by
 = 
im¶ode
(', ', 
$‹mp
);

849 ià(
	g$dœeùiÚ
 !ğ
$this
->
_¿ndom_keywÜd
)

851 
$Üd”by
 = 
$this
->
_´Ùeù_id’tif›rs
($orderby);

854 
	g$Üd”by_¡©em’t
 = 
$Üd”by
.
$dœeùiÚ
;

856 
	g$this
->
	g¬_Üd”by
[] = 
$Üd”by_¡©em’t
;

857 ià(
	g$this
->
	g¬_ÿchšg
 ==ğ
TRUE
)

859 
$this
->
¬_ÿche_Üd”by
[] = 
$Üd”by_¡©em’t
;

860 
	g$this
->
	g¬_ÿche_exi¡s
[] = 'orderby';

863  
	g$this
;

875 
public
 
funùiÚ
 
lim™
(
$v®ue
, 
$off£t
 = '')

877 
$this
->
¬_lim™
 = (è
$v®ue
;

879 ià(
	g$off£t
 != '')

881 
$this
->
¬_off£t
 = (è
$off£t
;

884  
	g$this
;

895 
public
 
funùiÚ
 
	$off£t
(
$off£t
)

897 
$this
->
¬_off£t
 = 
$off£t
;

898  
$this
;

899 
	}
}

911 
public
 
funùiÚ
 
£t
(
$key
, 
$v®ue
 = '', 
$esÿ³
 = 
TRUE
)

913 
$key
 = 
$this
->
_objeù_to_¬¿y
($key);

915 iàĞ! 
is_¬¿y
(
$key
))

917 
	g$key
 = 
¬¿y
(
$key
 => 
$v®ue
);

920 
fÜ—ch
 (
$key
 
as
 
$k
 => 
$v
)

922 ià(
$esÿ³
 ==ğ
FALSE
)

924 
$this
->
¬_£t
[$this->
_´Ùeù_id’tif›rs
(
$k
)] = 
$v
;

928 
	g$this
->
	g¬_£t
[
$this
->
_´Ùeù_id’tif›rs
(
$k
, 
FALSE
, 
TRUE
)] = $this->
esÿ³
(
$v
);

932  
	g$this
;

948 
public
 
funùiÚ
 
g‘
(
$bË
 = '', 
$lim™
 = 
nuÎ
, 
$off£t
 =‚ull)

950 ià(
$bË
 != '')

952 
$this
->
_Œack_®Ÿ£s
(
$bË
);

953 
	g$this
->
äom
(
$bË
);

956 iàĞ! 
is_nuÎ
(
$lim™
))

958 
	g$this
->
lim™
(
$lim™
, 
$off£t
);

961 
	g$sql
 = 
$this
->
_compe_£Ëù
();

963 
	g$»suÉ
 = 
$this
->
qu”y
(
$sql
);

964 
	g$this
->
_»£t_£Ëù
();

965  
	g$»suÉ
;

977 
public
 
funùiÚ
 
couÁ_®l_»suÉs
(
$bË
 = '')

979 ià(
$bË
 != '')

981 
$this
->
_Œack_®Ÿ£s
(
$bË
);

982 
	g$this
->
äom
(
$bË
);

985 
	g$sql
 = 
$this
->
_compe_£Ëù
($this->
_couÁ_¡ršg
 . $this->
_´Ùeù_id’tif›rs
('numrows'));

987 
	g$qu”y
 = 
$this
->
qu”y
(
$sql
);

988 
	g$this
->
_»£t_£Ëù
();

990 ià(
	g$qu”y
->
num_rows
() == 0)

994 
	g$row
 = 
$qu”y
->
row
();

998 if(
is£t
(
$row
->
numrows
)){

999  (è
	g$row
->
	gnumrows
;

1000 }
–£if
(
is£t
(
$row
->
NUMROWS
)){

1001  (è
	g$row
->
	gNUMROWS
;

1017 
public
 
funùiÚ
 
g‘_wh”e
(
$bË
 = '', 
$wh”e
 = 
nuÎ
, 
$lim™
 =‚uÎ, 
$off£t
 =‚ull)

1019 ià(
$bË
 != '')

1021 
$this
->
äom
(
$bË
);

1024 iàĞ! 
is_nuÎ
(
$wh”e
))

1026 
	g$this
->
wh”e
(
$wh”e
);

1029 iàĞ! 
is_nuÎ
(
$lim™
))

1031 
	g$this
->
lim™
(
$lim™
, 
$off£t
);

1034 
	g$sql
 = 
$this
->
_compe_£Ëù
();

1036 
	g$»suÉ
 = 
$this
->
qu”y
(
$sql
);

1037 
	g$this
->
_»£t_£Ëù
();

1038  
	g$»suÉ
;

1052 
public
 
funùiÚ
 
š£¹_b©ch
(
$bË
 = '', 
$£t
 = 
NULL
)

1054 iàĞ! 
is_nuÎ
(
$£t
))

1056 
$this
->
£t_š£¹_b©ch
(
$£t
);

1059 ià(
couÁ
(
$this
->
¬_£t
) == 0)

1061 ià(
$this
->
db_debug
)

1064  
$this
->
di¥Ïy_”rÜ
('db_must_use_set');

1066  
	gFALSE
;

1069 ià(
	g$bË
 == '')

1071 iàĞ! 
is£t
(
$this
->
¬_äom
[0]))

1073 ià(
$this
->
db_debug
)

1075  
$this
->
di¥Ïy_”rÜ
('db_must_set_table');

1077  
	gFALSE
;

1080 
	g$bË
 = 
$this
->
¬_äom
[0];

1084 
	g$i
 = 0, 
	g$tÙ®
 = 
couÁ
(
$this
->
¬_£t
); $˜< $tÙ®; $˜ğ
$i
 + 100)

1087 
$sql
 = 
$this
->
_š£¹_b©ch
($this->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
), $this->
¬_keys
, 
¬¿y_¦iû
($this->
¬_£t
, 
$i
, 100));

1091 
	g$this
->
qu”y
(
$sql
);

1094 
	g$this
->
_»£t_wr™e
();

1097  
	gTRUE
;

1110 
public
 
funùiÚ
 
£t_š£¹_b©ch
(
$key
, 
$v®ue
 = '', 
$esÿ³
 = 
TRUE
)

1112 
$key
 = 
$this
->
_objeù_to_¬¿y_b©ch
($key);

1114 iàĞ! 
is_¬¿y
(
$key
))

1116 
	g$key
 = 
¬¿y
(
$key
 => 
$v®ue
);

1119 
	g$keys
 = 
¬¿y_keys
(
cu¼’t
(
$key
));

1120 
sÜt
(
$keys
);

1122 
fÜ—ch
 (
$key
 
as
 
$row
)

1124 ià(
couÁ
(
¬¿y_diff
(
$keys
, 
¬¿y_keys
(
$row
))è> 0 
OR
 count(array_diff(array_keys($row), $keys)) > 0)

1127 
	g$this
->
	g¬_£t
[] = 
¬¿y
();

1131 
ksÜt
(
$row
);

1133 ià(
	g$esÿ³
 ==ğ
FALSE
)

1135 
$this
->
¬_£t
[] = '('.
im¶ode
(',', 
$row
).')';

1139 
	g$ş—n
 = 
¬¿y
();

1141 
fÜ—ch
 (
$row
 
as
 
$v®ue
)

1143 
	g$ş—n
[] = 
$this
->
esÿ³
(
$v®ue
);

1146 
	g$this
->
	g¬_£t
[] = '('.
im¶ode
(',', 
$ş—n
).')';

1150 
fÜ—ch
 (
$keys
 
as
 
$k
)

1152 
	g$this
->
	g¬_keys
[] = 
$this
->
_´Ùeù_id’tif›rs
(
$k
);

1155  
	g$this
;

1169 
funùiÚ
 
š£¹
(
$bË
 = '', 
$£t
 = 
NULL
)

1171 iàĞ! 
is_nuÎ
(
$£t
))

1173 
$this
->
£t
(
$£t
);

1176 ià(
couÁ
(
$this
->
¬_£t
) == 0)

1178 ià(
$this
->
db_debug
)

1180  
$this
->
di¥Ïy_”rÜ
('db_must_use_set');

1182  
	gFALSE
;

1185 ià(
	g$bË
 == '')

1187 iàĞ! 
is£t
(
$this
->
¬_äom
[0]))

1189 ià(
$this
->
db_debug
)

1191  
$this
->
di¥Ïy_”rÜ
('db_must_set_table');

1193  
	gFALSE
;

1196 
	g$bË
 = 
$this
->
¬_äom
[0];

1199 
	g$sql
 = 
$this
->
_š£¹
($this->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
), 
¬¿y_keys
($this->
¬_£t
), 
¬¿y_v®ues
($this->ar_set));

1201 
	g$this
->
_»£t_wr™e
();

1202  
	g$this
->
qu”y
(
$sql
);

1216 
public
 
funùiÚ
 
»¶aû
(
$bË
 = '', 
$£t
 = 
NULL
)

1218 iàĞ! 
is_nuÎ
(
$£t
))

1220 
$this
->
£t
(
$£t
);

1223 ià(
couÁ
(
$this
->
¬_£t
) == 0)

1225 ià(
$this
->
db_debug
)

1227  
$this
->
di¥Ïy_”rÜ
('db_must_use_set');

1229  
	gFALSE
;

1232 ià(
	g$bË
 == '')

1234 iàĞ! 
is£t
(
$this
->
¬_äom
[0]))

1236 ià(
$this
->
db_debug
)

1238  
$this
->
di¥Ïy_”rÜ
('db_must_set_table');

1240  
	gFALSE
;

1243 
	g$bË
 = 
$this
->
¬_äom
[0];

1246 
	g$sql
 = 
$this
->
_»¶aû
($this->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
), 
¬¿y_keys
($this->
¬_£t
), 
¬¿y_v®ues
($this->ar_set));

1248 
	g$this
->
_»£t_wr™e
();

1249  
	g$this
->
qu”y
(
$sql
);

1264 
public
 
funùiÚ
 
upd©e
(
$bË
 = '', 
$£t
 = 
NULL
, 
$wh”e
 = NULL, 
$lim™
 = NULL)

1267 
$this
->
_m”ge_ÿche
();

1269 iàĞ! 
is_nuÎ
(
$£t
))

1271 
	g$this
->
£t
(
$£t
);

1274 ià(
couÁ
(
$this
->
¬_£t
) == 0)

1276 ià(
$this
->
db_debug
)

1278  
$this
->
di¥Ïy_”rÜ
('db_must_use_set');

1280  
	gFALSE
;

1283 ià(
	g$bË
 == '')

1285 iàĞ! 
is£t
(
$this
->
¬_äom
[0]))

1287 ià(
$this
->
db_debug
)

1289  
$this
->
di¥Ïy_”rÜ
('db_must_set_table');

1291  
	gFALSE
;

1294 
	g$bË
 = 
$this
->
¬_äom
[0];

1297 ià(
	g$wh”e
 !ğ
NULL
)

1299 
$this
->
wh”e
(
$wh”e
);

1302 ià(
	g$lim™
 !ğ
NULL
)

1304 
$this
->
lim™
(
$lim™
);

1307 
	g$sql
 = 
$this
->
_upd©e
($this->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
), $this->
¬_£t
, $this->
¬_wh”e
, $this->
¬_Üd”by
, $this->
¬_lim™
);

1309 
	g$this
->
_»£t_wr™e
();

1310  
	g$this
->
qu”y
(
$sql
);

1326 
public
 
funùiÚ
 
upd©e_b©ch
(
$bË
 = '', 
$£t
 = 
NULL
, 
$šdex
 = NULL)

1329 
$this
->
_m”ge_ÿche
();

1331 ià(
is_nuÎ
(
$šdex
))

1333 ià(
	g$this
->
	gdb_debug
)

1335  
	g$this
->
di¥Ïy_”rÜ
('db_must_use_index');

1338  
	gFALSE
;

1341 iàĞ! 
is_nuÎ
(
$£t
))

1343 
	g$this
->
£t_upd©e_b©ch
(
$£t
, 
$šdex
);

1346 ià(
couÁ
(
$this
->
¬_£t
) == 0)

1348 ià(
$this
->
db_debug
)

1350  
$this
->
di¥Ïy_”rÜ
('db_must_use_set');

1353  
	gFALSE
;

1356 ià(
	g$bË
 == '')

1358 iàĞ! 
is£t
(
$this
->
¬_äom
[0]))

1360 ià(
$this
->
db_debug
)

1362  
$this
->
di¥Ïy_”rÜ
('db_must_set_table');

1364  
	gFALSE
;

1367 
	g$bË
 = 
$this
->
¬_äom
[0];

1371 
	g$i
 = 0, 
	g$tÙ®
 = 
couÁ
(
$this
->
¬_£t
); $˜< $tÙ®; $˜ğ
$i
 + 100)

1373 
$sql
 = 
$this
->
_upd©e_b©ch
($this->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
), 
¬¿y_¦iû
($this->
¬_£t
, 
$i
, 100), $this->_´Ùeù_id’tif›rs(
$šdex
), $this->
¬_wh”e
);

1375 
	g$this
->
qu”y
(
$sql
);

1378 
	g$this
->
_»£t_wr™e
();

1391 
public
 
funùiÚ
 
£t_upd©e_b©ch
(
$key
, 
$šdex
 = '', 
$esÿ³
 = 
TRUE
)

1393 
$key
 = 
$this
->
_objeù_to_¬¿y_b©ch
($key);

1395 iàĞ! 
is_¬¿y
(
$key
))

1400 
fÜ—ch
 (
$key
 
as
 
$k
 => 
$v
)

1402 
$šdex_£t
 = 
FALSE
;

1403 
	g$ş—n
 = 
¬¿y
();

1405 
fÜ—ch
 (
$v
 
as
 
$k2
 => 
$v2
)

1407 ià(
$k2
 =ğ
$šdex
)

1409 
$šdex_£t
 = 
TRUE
;

1413 
	g$nÙ
[] = 
$k2
.'-'.
$v2
;

1416 ià(
	g$esÿ³
 ==ğ
FALSE
)

1418 
$ş—n
[
$this
->
_´Ùeù_id’tif›rs
(
$k2
)] = 
$v2
;

1422 
	g$ş—n
[
$this
->
_´Ùeù_id’tif›rs
(
$k2
)] = $this->
esÿ³
(
$v2
);

1426 ià(
	g$šdex_£t
 =ğ
FALSE
)

1428  
$this
->
di¥Ïy_”rÜ
('db_batch_missing_index');

1431 
	g$this
->
	g¬_£t
[] = 
$ş—n
;

1434  
	g$this
;

1447 
public
 
funùiÚ
 
em±y_bË
(
$bË
 = '')

1449 ià(
$bË
 == '')

1451 iàĞ! 
is£t
(
$this
->
¬_äom
[0]))

1453 ià(
$this
->
db_debug
)

1455  
$this
->
di¥Ïy_”rÜ
('db_must_set_table');

1457  
	gFALSE
;

1460 
	g$bË
 = 
$this
->
¬_äom
[0];

1464 
	g$bË
 = 
$this
->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
);

1467 
	g$sql
 = 
$this
->
_d–‘e
(
$bË
);

1469 
	g$this
->
_»£t_wr™e
();

1471  
	g$this
->
qu”y
(
$sql
);

1486 
public
 
funùiÚ
 
Œunÿ‹
(
$bË
 = '')

1488 ià(
$bË
 == '')

1490 iàĞ! 
is£t
(
$this
->
¬_äom
[0]))

1492 ià(
$this
->
db_debug
)

1494  
$this
->
di¥Ïy_”rÜ
('db_must_set_table');

1496  
	gFALSE
;

1499 
	g$bË
 = 
$this
->
¬_äom
[0];

1503 
	g$bË
 = 
$this
->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
);

1506 
	g$sql
 = 
$this
->
_Œunÿ‹
(
$bË
);

1508 
	g$this
->
_»£t_wr™e
();

1510  
	g$this
->
qu”y
(
$sql
);

1526 
public
 
funùiÚ
 
d–‘e
(
$bË
 = '', 
$wh”e
 = '', 
$lim™
 = 
NULL
, 
$»£t_d©a
 = 
TRUE
)

1529 
$this
->
_m”ge_ÿche
();

1531 ià(
	g$bË
 == '')

1533 iàĞ! 
is£t
(
$this
->
¬_äom
[0]))

1535 ià(
$this
->
db_debug
)

1537  
$this
->
di¥Ïy_”rÜ
('db_must_set_table');

1539  
	gFALSE
;

1542 
	g$bË
 = 
$this
->
¬_äom
[0];

1544 
–£if
 (
is_¬¿y
(
$bË
))

1546 
fÜ—ch
 (
$bË
 
as
 
$sšgË_bË
)

1548 
	g$this
->
d–‘e
(
$sšgË_bË
, 
$wh”e
, 
$lim™
, 
FALSE
);

1551 
	g$this
->
_»£t_wr™e
();

1556 
	g$bË
 = 
$this
->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
);

1559 ià(
	g$wh”e
 != '')

1561 
$this
->
wh”e
(
$wh”e
);

1564 ià(
	g$lim™
 !ğ
NULL
)

1566 
$this
->
lim™
(
$lim™
);

1569 ià(
couÁ
(
$this
->
¬_wh”e
è=ğ0 && couÁ($this->
¬_wh”eš
è=ğ0 && couÁ($this->
¬_like
) == 0)

1571 ià(
$this
->
db_debug
)

1573  
$this
->
di¥Ïy_”rÜ
('db_del_must_use_where');

1576  
	gFALSE
;

1579 
	g$sql
 = 
$this
->
_d–‘e
(
$bË
, $this->
¬_wh”e
, $this->
¬_like
, $this->
¬_lim™
);

1581 ià(
	g$»£t_d©a
)

1583 
	g$this
->
_»£t_wr™e
();

1586  
	g$this
->
qu”y
(
$sql
);

1599 
public
 
funùiÚ
 
db´efix
(
$bË
 = '')

1601 ià(
$bË
 == '')

1603 
$this
->
di¥Ïy_”rÜ
('db_table_name_required');

1606  
	g$this
->
	gdb´efix
.
	g$bË
;

1619 
public
 
funùiÚ
 
£t_db´efix
(
$´efix
 = '')

1621  
$this
->
db´efix
 = 
$´efix
;

1634 
´Ùeùed
 
funùiÚ
 
	$_Œack_®Ÿ£s
(
$bË
)

1636 ià(
	`is_¬¿y
(
$bË
))

1638 
	`fÜ—ch
 (
$bË
 
as
 
$t
)

1640 
$this
->
	`_Œack_®Ÿ£s
(
$t
);

1647 ià(
	`¡½os
(
$bË
, ','è!=ğ
FALSE
)

1649  
$this
->
	`_Œack_®Ÿ£s
(
	`ex¶ode
(',', 
$bË
));

1653 ià(
	`¡½os
(
$bË
, " "è!=ğ
FALSE
)

1656 
$bË
 = 
	`´eg_»¶aû
('/\s+AS\s+/i', ' ', $table);

1659 
$bË
 = 
	`Œim
(
	`¡¼chr
($table, " "));

1662 iàĞ! 
	`š_¬¿y
(
$bË
, 
$this
->
¬_®Ÿ£d_bËs
))

1664 
$this
->
¬_®Ÿ£d_bËs
[] = 
$bË
;

1667 
	}
}

1679 
´Ùeùed
 
funùiÚ
 
	$_compe_£Ëù
(
$£Ëù_ov”ride
 = 
FALSE
)

1682 
$this
->
	`_m”ge_ÿche
();

1688 ià(
$£Ëù_ov”ride
 !=ğ
FALSE
)

1690 
$sql
 = 
$£Ëù_ov”ride
;

1694 
$sql
 = ( ! 
$this
->
¬_di¡šù
) ? 'SELECT ' : 'SELECT DISTINCT ';

1696 ià(
	`couÁ
(
$this
->
¬_£Ëù
) == 0)

1698 
$sql
 .= '*';

1705 
	`fÜ—ch
 (
$this
->
¬_£Ëù
 
as
 
$key
 => 
$v®
)

1707 
$no_esÿ³
 = 
	`is£t
(
$this
->
¬_no_esÿ³
[
$key
]è? $this->¬_no_esÿ³[$key] : 
NULL
;

1708 
$this
->
¬_£Ëù
[
$key
] = $this->
	`_´Ùeù_id’tif›rs
(
$v®
, 
FALSE
, 
$no_esÿ³
);

1711 
$sql
 .ğ
	`im¶ode
(', ', 
$this
->
¬_£Ëù
);

1719 ià(
	`couÁ
(
$this
->
¬_äom
) > 0)

1721 
$sql
 .= "\nFROM ";

1723 
$sql
 .ğ
$this
->
	`_äom_bËs
($this->
¬_äom
);

1730 ià(
	`couÁ
(
$this
->
¬_još
) > 0)

1732 
$sql
 .= "\n";

1734 
$sql
 .ğ
	`im¶ode
("\n", 
$this
->
¬_još
);

1741 ià(
	`couÁ
(
$this
->
¬_wh”e
è> 0 
OR
 couÁ($this->
¬_like
) > 0)

1743 
$sql
 .= "\nWHERE ";

1746 
$sql
 .ğ
	`im¶ode
("\n", 
$this
->
¬_wh”e
);

1752 ià(
	`couÁ
(
$this
->
¬_like
) > 0)

1754 ià(
	`couÁ
(
$this
->
¬_wh”e
) > 0)

1756 
$sql
 .= "\nAND ";

1759 
$sql
 .ğ
	`im¶ode
("\n", 
$this
->
¬_like
);

1766 ià(
	`couÁ
(
$this
->
¬_groupby
) > 0)

1768 
$sql
 .= "\nGROUP BY ";

1770 
$sql
 .ğ
	`im¶ode
(', ', 
$this
->
¬_groupby
);

1777 ià(
	`couÁ
(
$this
->
¬_havšg
) > 0)

1779 
$sql
 .= "\nHAVING ";

1780 
$sql
 .ğ
	`im¶ode
("\n", 
$this
->
¬_havšg
);

1787 ià(
	`couÁ
(
$this
->
¬_Üd”by
) > 0)

1789 
$sql
 .= "\nORDER BY ";

1790 
$sql
 .ğ
	`im¶ode
(', ', 
$this
->
¬_Üd”by
);

1792 ià(
$this
->
¬_Üd”
 !=ğ
FALSE
)

1794 
$sql
 .ğ(
$this
->
¬_Üd”
 == 'desc') ? ' DESC' : ' ASC';

1802 ià(
	`is_num”ic
(
$this
->
¬_lim™
))

1804 
$sql
 .= "\n";

1805 
$sql
 = 
$this
->
	`_lim™
($sql, $this->
¬_lim™
, $this->
¬_off£t
);

1808  
$sql
;

1809 
	}
}

1821 
public
 
funùiÚ
 
	$_objeù_to_¬¿y
(
$objeù
)

1823 iàĞ! 
	`is_objeù
(
$objeù
))

1825  
$objeù
;

1828 
$¬¿y
 = 
	`¬¿y
();

1829 
	`fÜ—ch
 (
	`g‘_objeù_v¬s
(
$objeù
è
as
 
$key
 => 
$v®
)

1832 iàĞ! 
	`is_objeù
(
$v®
è&& ! 
	`is_¬¿y
($v®è&& 
$key
 != '_parent_name')

1834 
$¬¿y
[
$key
] = 
$v®
;

1838  
$¬¿y
;

1839 
	}
}

1851 
public
 
funùiÚ
 
	$_objeù_to_¬¿y_b©ch
(
$objeù
)

1853 iàĞ! 
	`is_objeù
(
$objeù
))

1855  
$objeù
;

1858 
$¬¿y
 = 
	`¬¿y
();

1859 
$out
 = 
	`g‘_objeù_v¬s
(
$objeù
);

1860 
$f›lds
 = 
	`¬¿y_keys
(
$out
);

1862 
	`fÜ—ch
 (
$f›lds
 
as
 
$v®
)

1865 ià(
$v®
 != '_parent_name')

1868 
$i
 = 0;

1869 
	`fÜ—ch
 (
$out
[
$v®
] 
as
 
$d©a
)

1871 
$¬¿y
[
$i
][
$v®
] = 
$d©a
;

1872 
$i
++;

1877  
$¬¿y
;

1878 
	}
}

1889 
public
 
funùiÚ
 
	$¡¬t_ÿche
()

1891 
$this
->
¬_ÿchšg
 = 
TRUE
;

1892 
	}
}

1903 
public
 
funùiÚ
 
	$¡İ_ÿche
()

1905 
$this
->
¬_ÿchšg
 = 
FALSE
;

1906 
	}
}

1918 
public
 
funùiÚ
 
	$æush_ÿche
()

1920 
$this
->
	`_»£t_run
(
	`¬¿y
(

1921 '¬_ÿche_£Ëù' => 
	`¬¿y
(),

1922 '¬_ÿche_äom' => 
	`¬¿y
(),

1923 '¬_ÿche_još' => 
	`¬¿y
(),

1924 '¬_ÿche_wh”e' => 
	`¬¿y
(),

1925 '¬_ÿche_like' => 
	`¬¿y
(),

1926 '¬_ÿche_groupby' => 
	`¬¿y
(),

1927 '¬_ÿche_havšg' => 
	`¬¿y
(),

1928 '¬_ÿche_Üd”by' => 
	`¬¿y
(),

1929 '¬_ÿche_£t' => 
	`¬¿y
(),

1930 '¬_ÿche_exi¡s' => 
	`¬¿y
(),

1931 '¬_ÿche_no_esÿ³' => 
	`¬¿y
()

1933 
	}
}

1945 
´Ùeùed
 
funùiÚ
 
	$_m”ge_ÿche
()

1947 ià(
	`couÁ
(
$this
->
¬_ÿche_exi¡s
) == 0)

1952 
	`fÜ—ch
 (
$this
->
¬_ÿche_exi¡s
 
as
 
$v®
)

1954 
$¬_v¬ŸbË
 = '¬_'.
$v®
;

1955 
$¬_ÿche_v¬
 = '¬_ÿche_'.
$v®
;

1957 ià(
	`couÁ
(
$this
->
$¬_ÿche_v¬
) == 0)

1962 
$this
->
$¬_v¬ŸbË
 = 
	`¬¿y_unique
(
	`¬¿y_m”ge
($this->
$¬_ÿche_v¬
, $this->$ar_variable));

1967 ià(
$this
->
_´Ùeù_id’tif›rs
 ==ğ
TRUE
 
AND
 
	`couÁ
($this->
¬_ÿche_äom
) > 0)

1969 
$this
->
	`_Œack_®Ÿ£s
($this->
¬_äom
);

1972 
$this
->
¬_no_esÿ³
 = $this->
¬_ÿche_no_esÿ³
;

1973 
	}
}

1983 
´Ùeùed
 
funùiÚ
 
	$_»£t_run
(
$¬_»£t_™ems
)

1985 
	`fÜ—ch
 (
$¬_»£t_™ems
 
as
 
$™em
 => 
$deçuÉ_v®ue
)

1987 iàĞ! 
	`š_¬¿y
(
$™em
, 
$this
->
¬_¡Üe_¬¿y
))

1989 
$this
->
$™em
 = 
$deçuÉ_v®ue
;

1992 
	}
}

2001 
´Ùeùed
 
funùiÚ
 
	$_»£t_£Ëù
()

2003 
$¬_»£t_™ems
 = 
	`¬¿y
(

2004 '¬_£Ëù' => 
	`¬¿y
(),

2005 '¬_äom' => 
	`¬¿y
(),

2006 '¬_još' => 
	`¬¿y
(),

2007 '¬_wh”e' => 
	`¬¿y
(),

2008 '¬_like' => 
	`¬¿y
(),

2009 '¬_groupby' => 
	`¬¿y
(),

2010 '¬_havšg' => 
	`¬¿y
(),

2011 '¬_Üd”by' => 
	`¬¿y
(),

2012 '¬_wh”eš' => 
	`¬¿y
(),

2013 '¬_®Ÿ£d_bËs' => 
	`¬¿y
(),

2014 '¬_no_esÿ³' => 
	`¬¿y
(),

2015 '¬_di¡šù' => 
FALSE
,

2016 '¬_lim™' => 
FALSE
,

2017 '¬_off£t' => 
FALSE
,

2018 '¬_Üd”' => 
FALSE
,

2021 
$this
->
	`_»£t_run
(
$¬_»£t_™ems
);

2022 
	}
}

2033 
´Ùeùed
 
funùiÚ
 
	$_»£t_wr™e
()

2035 
$¬_»£t_™ems
 = 
	`¬¿y
(

2036 '¬_£t' => 
	`¬¿y
(),

2037 '¬_äom' => 
	`¬¿y
(),

2038 '¬_wh”e' => 
	`¬¿y
(),

2039 '¬_like' => 
	`¬¿y
(),

2040 '¬_Üd”by' => 
	`¬¿y
(),

2041 '¬_keys' => 
	`¬¿y
(),

2042 '¬_lim™' => 
FALSE
,

2043 '¬_Üd”' => 
FALSE


2046 
$this
->
	`_»£t_run
(
$¬_»£t_™ems
);

2047 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_cache.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_Cache
 {

27 
v¬
 
	m$CI
;

28 
v¬
 
	m$db
;

36 
funùiÚ
 
	$__cÚ¡ruù
(&
$db
)

40 
$this
->
CI
 =& 
	`g‘_š¡ªû
();

41 
$this
->
db
 =& 
$db
;

42 
$this
->
CI
->
lßd
->
	`h–³r
('file');

54 
funùiÚ
 
	`check_·th
(
$·th
 = '')

56 ià(
$·th
 == '')

58 ià(
$this
->
db
->
ÿchedœ
 == '')

60  
$this
->
db
->
	`ÿche_off
();

63 
$·th
 = 
$this
->
db
->
ÿchedœ
;

67 
$·th
 = 
	`´eg_»¶aû
("/(.+?)\/*$/", "\\1/", $path);

69 iàĞ! 
	`is_dœ
(
$·th
è
OR
 ! 
	`is_»®ly_wr™abË
($path))

72  
$this
->
db
->
	`ÿche_off
();

75 
$this
->
db
->
ÿchedœ
 = 
$·th
;

76  
TRUE
;

77 
	}
}

90 
funùiÚ
 
	$»ad
(
$sql
)

92 iàĞ! 
$this
->
	`check_·th
())

94  
$this
->
db
->
	`ÿche_off
();

97 
$£gm’t_Úe
 = (
$this
->
CI
->
uri
->
	`£gm’t
(1è=ğ
FALSE
) ? 'default' : $this->CI->uri->segment(1);

99 
$£gm’t_two
 = (
$this
->
CI
->
uri
->
	`£gm’t
(2è=ğ
FALSE
) ? 'index' : $this->CI->uri->segment(2);

101 
$f•©h
 = 
$this
->
db
->
ÿchedœ
.
$£gm’t_Úe
.'+'.
$£gm’t_two
.'/'.
	`md5
(
$sql
);

103 ià(
FALSE
 ==ğ(
$ÿched©a
 = 
	`»ad_fe
(
$f•©h
)))

105  
FALSE
;

108  
	`un£rŸlize
(
$ÿched©a
);

109 
	}
}

119 
funùiÚ
 
	$wr™e
(
$sql
, 
$objeù
)

121 iàĞ! 
$this
->
	`check_·th
())

123  
$this
->
db
->
	`ÿche_off
();

126 
$£gm’t_Úe
 = (
$this
->
CI
->
uri
->
	`£gm’t
(1è=ğ
FALSE
) ? 'default' : $this->CI->uri->segment(1);

128 
$£gm’t_two
 = (
$this
->
CI
->
uri
->
	`£gm’t
(2è=ğ
FALSE
) ? 'index' : $this->CI->uri->segment(2);

130 
$dœ_·th
 = 
$this
->
db
->
ÿchedœ
.
$£gm’t_Úe
.'+'.
$£gm’t_two
.'/';

132 
$f’ame
 = 
	`md5
(
$sql
);

134 iàĞ! @
	`is_dœ
(
$dœ_·th
))

136 iàĞ! @
	`mkdœ
(
$dœ_·th
, 
DIR_WRITE_MODE
))

138  
FALSE
;

141 @
	`chmod
(
$dœ_·th
, 
DIR_WRITE_MODE
);

144 ià(
	`wr™e_fe
(
$dœ_·th
.
$f’ame
, 
	`£rŸlize
(
$objeù
)è==ğ
FALSE
)

146  
FALSE
;

149 @
	`chmod
(
$dœ_·th
.
$f’ame
, 
FILE_WRITE_MODE
);

150  
TRUE
;

151 
	}
}

161 
funùiÚ
 
d–‘e
(
$£gm’t_Úe
 = '', 
$£gm’t_two
 = '')

163 ià(
$£gm’t_Úe
 == '')

165 
$£gm’t_Úe
 = (
$this
->
CI
->
uri
->
£gm’t
(1è=ğ
FALSE
) ? 'default' : $this->CI->uri->segment(1);

168 ià(
	g$£gm’t_two
 == '')

170 
$£gm’t_two
 = (
$this
->
CI
->
uri
->
£gm’t
(2è=ğ
FALSE
) ? 'index' : $this->CI->uri->segment(2);

173 
	g$dœ_·th
 = 
$this
->
db
->
ÿchedœ
.
$£gm’t_Úe
.'+'.
$£gm’t_two
.'/';

175 
d–‘e_fes
(
$dœ_·th
, 
TRUE
);

186 
funùiÚ
 
	$d–‘e_®l
()

188 
	`d–‘e_fes
(
$this
->
db
->
ÿchedœ
, 
TRUE
);

189 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

31 şas 
	cCI_DB_driv”
 {

33 
v¬
 
	m$u£ºame
;

34 
v¬
 
	m$·sswÜd
;

35 
v¬
 
	m$ho¡Çme
;

36 
v¬
 
	m$d©aba£
;

37 
v¬
 
	m$dbdriv”
 = 'mysql';

38 
v¬
 
	m$db´efix
 = '';

39 
v¬
 
	m$ch¬_£t
 = 'GBK';

40 
v¬
 
	m$dbcŞÏt
 = 'utf8_general_ci';

41 
v¬
 
	m$autoš™
 = 
TRUE
;

42 
v¬
 
	m$sw­_´e
 = '';

43 
v¬
 
	m$pÜt
 = '';

44 
v¬
 
	m$pcÚÃù
 = 
FALSE
;

45 
v¬
 
	m$cÚn_id
 = 
FALSE
;

46 
v¬
 
	m$»suÉ_id
 = 
FALSE
;

47 
v¬
 
	m$db_debug
 = 
FALSE
;

48 
v¬
 
	m$b’chm¬k
 = 0;

49 
v¬
 
	m$qu”y_couÁ
 = 0;

50 
v¬
 
	m$bšd_m¬k”
 = '?';

51 
v¬
 
	m$§ve_qu”›s
 = 
TRUE
;

52 
v¬
 
	m$qu”›s
 = 
¬¿y
();

53 
v¬
 
	m$qu”y_times
 = 
¬¿y
();

54 
v¬
 
	m$d©a_ÿche
 = 
¬¿y
();

55 
v¬
 
	m$Œªs_’abËd
 = 
TRUE
;

56 
v¬
 
	m$Œªs_¡riù
 = 
TRUE
;

57 
v¬
 
	m$_Œªs_d•th
 = 0;

58 
v¬
 
	m$_Œªs_¡©us
 = 
TRUE
;

59 
v¬
 
	m$ÿche_Ú
 = 
FALSE
;

60 
v¬
 
	m$ÿchedœ
 = '';

61 
v¬
 
	m$ÿche_autod–
 = 
FALSE
;

62 
v¬
 
	m$CACHE
;

65 
v¬
 
	m$_´Ùeù_id’tif›rs
 = 
TRUE
;

66 
v¬
 
	m$_»£rved_id’tif›rs
 = 
¬¿y
('*');

69 
v¬
 
	m$¡mt_id
;

70 
v¬
 
	m$curs_id
;

71 
v¬
 
	m$lim™_u£d
;

81 
funùiÚ
 
	$__cÚ¡ruù
(
$·¿ms
)

83 ià(
	`is_¬¿y
(
$·¿ms
))

85 
	`fÜ—ch
 (
$·¿ms
 
as
 
$key
 => 
$v®
)

87 
$this
->
$key
 = 
$v®
;

91 
	`log_mes§ge
('debug', 'Database Driver Class Initialized');

103 
funùiÚ
 
	$š™Ÿlize
()

107 ià(
	`is_»sourû
(
$this
->
cÚn_id
è
OR
 
	`is_objeù
($this->conn_id))

109  
TRUE
;

115 
$this
->
cÚn_id
 = ($this->
pcÚÃù
 =ğ
FALSE
è? $this->
	`db_cÚÃù
(è: $this->
	`db_pcÚÃù
();

118 iàĞ! 
$this
->
cÚn_id
)

120 
	`log_mes§ge
('error', 'Unableo connectohe database');

122 ià(
$this
->
db_debug
)

124 
$this
->
	`di¥Ïy_”rÜ
('db_unable_to_connect');

126  
FALSE
;

132 ià(
$this
->
d©aba£
 != '')

134 iàĞ! 
$this
->
	`db_£Ëù
())

136 
	`log_mes§ge
('”rÜ', 'UÇbËØ£Ëù d©aba£: '.
$this
->
d©aba£
);

138 ià(
$this
->
db_debug
)

140 
$this
->
	`di¥Ïy_”rÜ
('db_uÇbË_to_£Ëù', $this->
d©aba£
);

142  
FALSE
;

147 iàĞ! 
$this
->
	`db_£t_ch¬£t
($this->
ch¬_£t
, $this->
dbcŞÏt
))

149  
FALSE
;

152  
TRUE
;

156  
TRUE
;

157 
	}
}

169 
funùiÚ
 
	$db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
)

171 iàĞ! 
$this
->
	`_db_£t_ch¬£t
($this->
ch¬_£t
, $this->
dbcŞÏt
))

173 
	`log_mes§ge
('”rÜ', 'UÇbËØ£ˆd©aba£ cÚÃùiÚ ch¬£t: '.
$this
->
ch¬_£t
);

175 ià(
$this
->
db_debug
)

177 
$this
->
	`di¥Ïy_”rÜ
('db_uÇbË_to_£t_ch¬£t', $this->
ch¬_£t
);

180  
FALSE
;

183  
TRUE
;

184 
	}
}

194 
funùiÚ
 
	$¶©fÜm
()

196  
$this
->
dbdriv”
;

197 
	}
}

208 
funùiÚ
 
	$v”siÚ
()

210 ià(
FALSE
 ==ğ(
$sql
 = 
$this
->
	`_v”siÚ
()))

212 ià(
$this
->
db_debug
)

214  
$this
->
	`di¥Ïy_”rÜ
('db_unsupported_function');

216  
FALSE
;

221 
$driv”_v”siÚ_exû±iÚs
 = 
	`¬¿y
('oci8', 'sqlite', 'cubrid');

223 ià(
	`š_¬¿y
(
$this
->
dbdriv”
, 
$driv”_v”siÚ_exû±iÚs
))

225  
$sql
;

229 
$qu”y
 = 
$this
->
	`qu”y
(
$sql
);

230  
$qu”y
->
	`row
('ver');

232 
	}
}

250 
funùiÚ
 
	$qu”y
(
$sql
, 
$bšds
 = 
FALSE
, 
$»tuº_objeù
 = 
TRUE
)

252 ià(
$sql
 == '')

254 ià(
$this
->
db_debug
)

256 
	`log_mes§ge
('”rÜ', 'Inv®id qu”y: '.
$sql
);

257  
$this
->
	`di¥Ïy_”rÜ
('db_invalid_query');

259  
FALSE
;

263 iàĞ(
$this
->
db´efix
 !ğ'' 
AND
 $this->
sw­_´e
 !ğ''è
	`AND
 ($this->dbprefix != $this->swap_pre) )

265 
$sql
 = 
	`´eg_»¶aû
("/(\W)".
$this
->
sw­_´e
."(\S+?)/", "\\1".$this->
db´efix
."\\2", $sql);

269 ià(
$bšds
 !=ğ
FALSE
)

271 
$sql
 = 
$this
->
	`compe_bšds
($sql, 
$bšds
);

277 ià(
$this
->
ÿche_Ú
 =ğ
TRUE
 
AND
 
	`¡ri¡r
(
$sql
, 'SELECT'))

279 ià(
$this
->
	`_ÿche_š™
())

281 
$this
->
	`lßd_rdriv”
();

282 ià(
FALSE
 !=ğ(
$ÿche
 = 
$this
->
CACHE
->
	`»ad
(
$sql
)))

284  
$ÿche
;

290 ià(
$this
->
§ve_qu”›s
 =ğ
TRUE
)

292 
$this
->
qu”›s
[] = 
$sql
;

296 
$time_¡¬t
 = 
	`li¡
(
$sm
, 
$ss
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

299 ià(
FALSE
 ==ğ(
$this
->
»suÉ_id
 = $this->
	`sim¶e_qu”y
(
$sql
)))

301 ià(
$this
->
§ve_qu”›s
 =ğ
TRUE
)

303 
$this
->
qu”y_times
[] = 0;

307 
$this
->
_Œªs_¡©us
 = 
FALSE
;

309 ià(
$this
->
db_debug
)

313 
$”rÜ_no
 = 
$this
->
	`_”rÜ_numb”
();

314 
$”rÜ_msg
 = 
$this
->
	`_”rÜ_mes§ge
();

320 
$this
->
	`Œªs_com¶‘e
();

323 
	`log_mes§ge
('”rÜ', 'Qu”yƒ¼Ü: '.
$”rÜ_msg
);

324  
$this
->
	`di¥Ïy_”rÜ
(

325 
	`¬¿y
(

326 'E¼Ü Numb”: '.
$”rÜ_no
,

327 
$”rÜ_msg
,

328 
$sql


333  
FALSE
;

337 
$time_’d
 = 
	`li¡
(
$em
, 
$es
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

338 
$this
->
b’chm¬k
 +ğ(
$em
 + 
$es
è- (
$sm
 + 
$ss
);

340 ià(
$this
->
§ve_qu”›s
 =ğ
TRUE
)

342 
$this
->
qu”y_times
[] = (
$em
 + 
$es
è- (
$sm
 + 
$ss
);

346 
$this
->
qu”y_couÁ
++;

350 ià(
$this
->
	`is_wr™e_ty³
(
$sql
è==ğ
TRUE
)

354 ià(
$this
->
ÿche_Ú
 =ğ
TRUE
 
AND
 $this->
ÿche_autod–
 =ğTRUE AND $this->
	`_ÿche_š™
())

356 
$this
->
CACHE
->
	`d–‘e
();

359  
TRUE
;

365 ià(
$»tuº_objeù
 !=ğ
TRUE
)

367  
TRUE
;

372 
$driv”
 = 
$this
->
	`lßd_rdriv”
();

373 
$RES
 = 
Ãw
 
	`$driv”
();

374 
$RES
->
cÚn_id
 = 
$this
->conn_id;

375 
$RES
->
»suÉ_id
 = 
$this
->result_id;

377 ià(
$this
->
dbdriv”
 == 'oci8')

379 
$RES
->
¡mt_id
 = 
$this
->stmt_id;

380 
$RES
->
curs_id
 = 
NULL
;

381 
$RES
->
lim™_u£d
 = 
$this
->limit_used;

382 
$this
->
¡mt_id
 = 
FALSE
;

386 
$RES
->
num_rows
 = $RES->
	`num_rows
();

390 ià(
$this
->
ÿche_Ú
 =ğ
TRUE
 
AND
 $this->
	`_ÿche_š™
())

398 
$CR
 = 
Ãw
 
	`CI_DB_»suÉ
();

399 
$CR
->
num_rows
 = 
$RES
->
	`num_rows
();

400 
$CR
->
»suÉ_objeù
 = 
$RES
->
	`»suÉ_objeù
();

401 
$CR
->
»suÉ_¬¿y
 = 
$RES
->
	`»suÉ_¬¿y
();

404 
$CR
->
cÚn_id
 = 
NULL
;

405 
$CR
->
»suÉ_id
 = 
NULL
;

407 
$this
->
CACHE
->
	`wr™e
(
$sql
, 
$CR
);

410  
$RES
;

411 
	}
}

421 
funùiÚ
 
	$lßd_rdriv”
()

423 
$driv”
 = 'CI_DB_'.
$this
->
dbdriv”
.'_result';

425 iàĞ! 
	`şass_exi¡s
(
$driv”
))

427 
	`šşude_Úû
(
BASEPATH
.'database/DB_result.php');

428 
	`šşude_Úû
(
BASEPATH
.'d©aba£/driv”s/'.
$this
->
dbdriv”
.'/'.$this->dbdriver.'_result.php');

431  
$driv”
;

432 
	}
}

446 
funùiÚ
 
	$sim¶e_qu”y
(
$sql
)

448 iàĞ! 
$this
->
cÚn_id
)

450 
$this
->
	`š™Ÿlize
();

453  
$this
->
	`_execu‹
(
$sql
);

454 
	}
}

465 
funùiÚ
 
	$Œªs_off
()

467 
$this
->
Œªs_’abËd
 = 
FALSE
;

468 
	}
}

482 
funùiÚ
 
	$Œªs_¡riù
(
$mode
 = 
TRUE
)

484 
$this
->
Œªs_¡riù
 = 
	`is_boŞ
(
$mode
è? $mod: 
TRUE
;

485 
	}
}

495 
funùiÚ
 
	$Œªs_¡¬t
(
$‹¡_mode
 = 
FALSE
)

497 iàĞ! 
$this
->
Œªs_’abËd
)

499  
FALSE
;

503 ià(
$this
->
_Œªs_d•th
 > 0)

505 
$this
->
_Œªs_d•th
 += 1;

509 
$this
->
	`Œªs_begš
(
$‹¡_mode
);

510 
	}
}

520 
funùiÚ
 
	$Œªs_com¶‘e
()

522 iàĞ! 
$this
->
Œªs_’abËd
)

524  
FALSE
;

528 ià(
$this
->
_Œªs_d•th
 > 1)

530 
$this
->
_Œªs_d•th
 -= 1;

531  
TRUE
;

535 ià(
$this
->
_Œªs_¡©us
 ==ğ
FALSE
)

537 
$this
->
	`Œªs_rŞlback
();

542 ià(
$this
->
Œªs_¡riù
 ==ğ
FALSE
)

544 
$this
->
_Œªs_¡©us
 = 
TRUE
;

547 
	`log_mes§ge
('debug', 'DB Transaction Failure');

548  
FALSE
;

551 
$this
->
	`Œªs_comm™
();

552  
TRUE
;

553 
	}
}

563 
funùiÚ
 
	$Œªs_¡©us
()

565  
$this
->
_Œªs_¡©us
;

566 
	}
}

578 
funùiÚ
 
	$compe_bšds
(
$sql
, 
$bšds
)

580 ià(
	`¡½os
(
$sql
, 
$this
->
bšd_m¬k”
è==ğ
FALSE
)

582  
$sql
;

585 iàĞ! 
	`is_¬¿y
(
$bšds
))

587 
$bšds
 = 
	`¬¿y
($binds);

591 
$£gm’ts
 = 
	`ex¶ode
(
$this
->
bšd_m¬k”
, 
$sql
);

595 ià(
	`couÁ
(
$bšds
è>ğcouÁ(
$£gm’ts
)) {

596 
$bšds
 = 
	`¬¿y_¦iû
($bšds, 0, 
	`couÁ
(
$£gm’ts
)-1);

600 
$»suÉ
 = 
$£gm’ts
[0];

601 
$i
 = 0;

602 
	`fÜ—ch
 (
$bšds
 
as
 
$bšd
)

604 
$»suÉ
 .ğ
$this
->
	`esÿ³
(
$bšd
);

605 
$»suÉ
 .ğ
$£gm’ts
[++
$i
];

608  
$»suÉ
;

609 
	}
}

620 
funùiÚ
 
	$is_wr™e_ty³
(
$sql
)

622 iàĞ! 
	`´eg_m©ch
('/^\s*"?(SET|INSERT|UPDATE|DELETE|REPLACE|CREATE|DROP|TRUNCATE|LOAD DATA|COPY|ALTER|GRANT|REVOKE|LOCK|UNLOCK)\s+/i', 
$sql
))

624  
FALSE
;

626  
TRUE
;

627 
	}
}

638 
funùiÚ
 
	$–­£d_time
(
$decim®s
 = 6)

640  
	`numb”_fÜm©
(
$this
->
b’chm¬k
, 
$decim®s
);

641 
	}
}

651 
funùiÚ
 
	$tÙ®_qu”›s
()

653  
$this
->
qu”y_couÁ
;

654 
	}
}

664 
funùiÚ
 
	$Ï¡_qu”y
()

666  
	`’d
(
$this
->
qu”›s
);

667 
	}
}

681 
funùiÚ
 
	$esÿ³
(
$¡r
)

683 ià(
	`is_¡ršg
(
$¡r
))

685 
$¡r
 = "'".
$this
->
	`esÿ³_¡r
($str)."'";

687 
	`–£if
 (
	`is_boŞ
(
$¡r
))

689 
$¡r
 = ($¡¸==ğ
FALSE
) ? 0 : 1;

691 
	`–£if
 (
	`is_nuÎ
(
$¡r
))

693 
$¡r
 = 'NULL';

696  
$¡r
;

697 
	}
}

711 
funùiÚ
 
	$esÿ³_like_¡r
(
$¡r
)

713  
$this
->
	`esÿ³_¡r
(
$¡r
, 
TRUE
);

714 
	}
}

728 
funùiÚ
 
´im¬y
(
$bË
 = '')

730 
$f›lds
 = 
$this
->
li¡_f›lds
(
$bË
);

732 iàĞ! 
is_¬¿y
(
$f›lds
))

734  
	gFALSE
;

737  
cu¼’t
(
$f›lds
);

748 
funùiÚ
 
	$li¡_bËs
(
$cÚ¡¿š_by_´efix
 = 
FALSE
)

751 ià(
	`is£t
(
$this
->
d©a_ÿche
['table_names']))

753  
$this
->
d©a_ÿche
['table_names'];

756 ià(
FALSE
 ==ğ(
$sql
 = 
$this
->
	`_li¡_bËs
(
$cÚ¡¿š_by_´efix
)))

758 ià(
$this
->
db_debug
)

760  
$this
->
	`di¥Ïy_”rÜ
('db_unsupported_function');

762  
FALSE
;

765 
$»tv®
 = 
	`¬¿y
();

766 
$qu”y
 = 
$this
->
	`qu”y
(
$sql
);

768 ià(
$qu”y
->
	`num_rows
() > 0)

770 
	`fÜ—ch
 (
$qu”y
->
	`»suÉ_¬¿y
(è
as
 
$row
)

772 ià(
	`is£t
(
$row
['TABLE_NAME']))

774 
$»tv®
[] = 
$row
['TABLE_NAME'];

778 
$»tv®
[] = 
	`¬¿y_shiá
(
$row
);

783 
$this
->
d©a_ÿche
['bË_Çmes'] = 
$»tv®
;

784  
$this
->
d©a_ÿche
['table_names'];

785 
	}
}

794 
funùiÚ
 
	$bË_exi¡s
(
$bË_Çme
)

796  ( ! 
	`š_¬¿y
(
$this
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
, 
TRUE
, 
FALSE
, FALSE), $this->
	`li¡_bËs
())) ? FALSE : TRUE;

797 
	}
}

808 
funùiÚ
 
li¡_f›lds
(
$bË
 = '')

811 ià(
is£t
(
$this
->
d©a_ÿche
['f›ld_Çmes'][
$bË
]))

813  
$this
->
d©a_ÿche
['f›ld_Çmes'][
$bË
];

816 ià(
	g$bË
 == '')

818 ià(
$this
->
db_debug
)

820  
$this
->
di¥Ïy_”rÜ
('db_field_param_missing');

822  
	gFALSE
;

825 ià(
	gFALSE
 ==ğ(
$sql
 = 
$this
->
_li¡_cŞumns
(
$bË
)))

827 ià(
$this
->
db_debug
)

829  
$this
->
di¥Ïy_”rÜ
('db_unsupported_function');

831  
	gFALSE
;

834 
	g$qu”y
 = 
$this
->
qu”y
(
$sql
);

836 
	g$»tv®
 = 
¬¿y
();

837 
fÜ—ch
 (
$qu”y
->
»suÉ_¬¿y
(è
as
 
$row
)

839 ià(
is£t
(
$row
['COLUMN_NAME']))

841 
	g$»tv®
[] = 
$row
['COLUMN_NAME'];

845 
	g$»tv®
[] = 
cu¼’t
(
$row
);

849 
	g$this
->
	gd©a_ÿche
['f›ld_Çmes'][
$bË
] = 
$»tv®
;

850  
	g$this
->
	gd©a_ÿche
['f›ld_Çmes'][
$bË
];

862 
funùiÚ
 
	$f›ld_exi¡s
(
$f›ld_Çme
, 
$bË_Çme
)

864  ( ! 
	`š_¬¿y
(
$f›ld_Çme
, 
$this
->
	`li¡_f›lds
(
$bË_Çme
))è? 
FALSE
 : 
TRUE
;

865 
	}
}

876 
funùiÚ
 
f›ld_d©a
(
$bË
 = '')

878 ià(
$bË
 == '')

880 ià(
$this
->
db_debug
)

882  
$this
->
di¥Ïy_”rÜ
('db_field_param_missing');

884  
	gFALSE
;

887 
	g$qu”y
 = 
$this
->
qu”y
($this->
_f›ld_d©a
($this->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
)));

889  
	g$qu”y
->
f›ld_d©a
();

902 
funùiÚ
 
	$š£¹_¡ršg
(
$bË
, 
$d©a
)

904 
$f›lds
 = 
	`¬¿y
();

905 
$v®ues
 = 
	`¬¿y
();

907 
	`fÜ—ch
 (
$d©a
 
as
 
$key
 => 
$v®
)

909 
$f›lds
[] = 
$this
->
	`_esÿ³_id’tif›rs
(
$key
);

910 
$v®ues
[] = 
$this
->
	`esÿ³
(
$v®
);

913  
$this
->
	`_š£¹
($this->
	`_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
), 
$f›lds
, 
$v®ues
);

914 
	}
}

927 
funùiÚ
 
	$upd©e_¡ršg
(
$bË
, 
$d©a
, 
$wh”e
)

929 ià(
$wh”e
 == '')

931  
çl£
;

934 
$f›lds
 = 
	`¬¿y
();

935 
	`fÜ—ch
 (
$d©a
 
as
 
$key
 => 
$v®
)

937 
$f›lds
[
$this
->
	`_´Ùeù_id’tif›rs
(
$key
)] = $this->
	`esÿ³
(
$v®
);

940 iàĞ! 
	`is_¬¿y
(
$wh”e
))

942 
$de¡
 = 
	`¬¿y
(
$wh”e
);

946 
$de¡
 = 
	`¬¿y
();

947 
	`fÜ—ch
 (
$wh”e
 
as
 
$key
 => 
$v®
)

949 
$´efix
 = (
	`couÁ
(
$de¡
) == 0) ? '' : ' AND ';

951 ià(
$v®
 !== '')

953 iàĞ! 
$this
->
	`_has_İ”©Ü
(
$key
))

955 
$key
 .= ' =';

958 
$v®
 = ' '.
$this
->
	`esÿ³
($val);

961 
$de¡
[] = 
$´efix
.
$key
.
$v®
;

965  
$this
->
	`_upd©e
($this->
	`_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
), 
$f›lds
, 
$de¡
);

966 
	}
}

977 
funùiÚ
 
	$_has_İ”©Ü
(
$¡r
)

979 
$¡r
 = 
	`Œim
($str);

980 iàĞ! 
	`´eg_m©ch
("/(\s|<|>|!|=|i nuÎ|i nÙ‚uÎ)/i", 
$¡r
))

982  
FALSE
;

985  
TRUE
;

986 
	}
}

998 
funùiÚ
 
	$ÿÎ_funùiÚ
(
$funùiÚ
)

1000 
$driv”
 = (
$this
->
dbdriv”
 == 'postgre') ? 'pg_' : $this->dbdriver.'_';

1002 ià(
FALSE
 ==ğ
	`¡½os
(
$driv”
, 
$funùiÚ
))

1004 
$funùiÚ
 = 
$driv”
.$function;

1007 iàĞ! 
	`funùiÚ_exi¡s
(
$funùiÚ
))

1009 ià(
$this
->
db_debug
)

1011  
$this
->
	`di¥Ïy_”rÜ
('db_unsupported_function');

1013  
FALSE
;

1017 
$¬gs
 = (
	`func_num_¬gs
(è> 1è? 
	`¬¿y_¥liû
(
	`func_g‘_¬gs
(), 1è: 
nuÎ
;

1018 ià(
	`is_nuÎ
(
$¬gs
))

1020  
	`ÿÎ_u£r_func
(
$funùiÚ
);

1024  
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
);

1027 
	}
}

1038 
funùiÚ
 
ÿche_£t_·th
(
$·th
 = '')

1040 
$this
->
ÿchedœ
 = 
$·th
;

1051 
funùiÚ
 
	$ÿche_Ú
()

1053 
$this
->
ÿche_Ú
 = 
TRUE
;

1054  
TRUE
;

1055 
	}
}

1065 
funùiÚ
 
	$ÿche_off
()

1067 
$this
->
ÿche_Ú
 = 
FALSE
;

1068  
FALSE
;

1069 
	}
}

1080 
funùiÚ
 
ÿche_d–‘e
(
$£gm’t_Úe
 = '', 
$£gm’t_two
 = '')

1082 iàĞ! 
$this
->
_ÿche_š™
())

1084  
FALSE
;

1086  
	g$this
->
	gCACHE
->
d–‘e
(
$£gm’t_Úe
, 
$£gm’t_two
);

1097 
funùiÚ
 
	$ÿche_d–‘e_®l
()

1099 iàĞ! 
$this
->
	`_ÿche_š™
())

1101  
FALSE
;

1104  
$this
->
CACHE
->
	`d–‘e_®l
();

1105 
	}
}

1115 
funùiÚ
 
	$_ÿche_š™
()

1117 ià(
	`is_objeù
(
$this
->
CACHE
è
AND
 
	`şass_exi¡s
('CI_DB_Cache'))

1119  
TRUE
;

1122 iàĞ! 
	`şass_exi¡s
('CI_DB_Cache'))

1124 iàĞ! @
	`šşude
(
BASEPATH
.'database/DB_cache.php'))

1126  
$this
->
	`ÿche_off
();

1130 
$this
->
CACHE
 = 
Ãw
 
	`CI_DB_Cache
($this);

1131  
TRUE
;

1132 
	}
}

1142 
funùiÚ
 
	$şo£
()

1144 ià(
	`is_»sourû
(
$this
->
cÚn_id
è
OR
 
	`is_objeù
($this->conn_id))

1146 
$this
->
	`_şo£
($this->
cÚn_id
);

1148 
$this
->
cÚn_id
 = 
FALSE
;

1149 
	}
}

1162 
funùiÚ
 
di¥Ïy_”rÜ
(
$”rÜ
 = '', 
$sw­
 = '', 
$Çtive
 = 
FALSE
)

1164 
$LANG
 =& 
lßd_şass
('Lang', 'core');

1165 
	g$LANG
->
lßd
('db');

1167 
	g$h—dšg
 = 
$LANG
->
lše
('db_error_heading');

1169 ià(
	g$Çtive
 =ğ
TRUE
)

1171 
$mes§ge
 = 
$”rÜ
;

1175 
	g$mes§ge
 = ( ! 
is_¬¿y
(
$”rÜ
)è? 
¬¿y
(
¡r_»¶aû
('%s', 
$sw­
, 
$LANG
->
lše
($error))) : $error;

1182 
	g$Œaû
 = 
debug_backŒaû
();

1184 
fÜ—ch
 (
$Œaû
 
as
 
$ÿÎ
)

1186 ià(
is£t
(
$ÿÎ
['fe']è&& 
¡½os
($ÿÎ['fe'], 
BASEPATH
.'d©aba£'è==ğ
FALSE
)

1189 
$mes§ge
[] = 'F’ame: '.
¡r_»¶aû
(
¬¿y
(
BASEPATH
, 
APPPATH
), '', 
$ÿÎ
['file']);

1190 
	g$mes§ge
[] = 'LšNumb”: '.
$ÿÎ
['line'];

1196 
	g$”rÜ
 =& 
lßd_şass
('Exceptions', 'core');

1197 
echo
 
	g$”rÜ
->
show_”rÜ
(
$h—dšg
, 
$mes§ge
, 'error_db');

1198 
	gex™
;

1212 
funùiÚ
 
	$´Ùeù_id’tif›rs
(
$™em
, 
$´efix_sšgË
 = 
FALSE
)

1214  
$this
->
	`_´Ùeù_id’tif›rs
(
$™em
, 
$´efix_sšgË
);

1215 
	}
}

1246 
funùiÚ
 
	$_´Ùeù_id’tif›rs
(
$™em
, 
$´efix_sšgË
 = 
FALSE
, 
$´Ùeù_id’tif›rs
 = 
NULL
, 
$f›ld_exi¡s
 = 
TRUE
)

1248 iàĞ! 
	`is_boŞ
(
$´Ùeù_id’tif›rs
))

1250 
$´Ùeù_id’tif›rs
 = 
$this
->
_´Ùeù_id’tif›rs
;

1253 ià(
	`is_¬¿y
(
$™em
))

1255 
$esÿ³d_¬¿y
 = 
	`¬¿y
();

1257 
	`fÜ—ch
 (
$™em
 
as
 
$k
 => 
$v
)

1259 
$esÿ³d_¬¿y
[
$this
->
	`_´Ùeù_id’tif›rs
(
$k
)] = $this->_´Ùeù_id’tif›rs(
$v
);

1262  
$esÿ³d_¬¿y
;

1266 
$™em
 = 
	`´eg_»¶aû
('/[\t ]+/', ' ', $item);

1270 ià(
	`¡½os
(
$™em
, ' 'è!=ğ
FALSE
)

1272 
$®Ÿs
 = 
	`¡r¡r
(
$™em
, ' ');

1273 
$™em
 = 
	`sub¡r
($™em, 0, - 
	`¡¾’
(
$®Ÿs
));

1277 
$®Ÿs
 = '';

1284 ià(
	`¡½os
(
$™em
, '('è!=ğ
FALSE
)

1286  
$™em
.
$®Ÿs
;

1292 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
)

1294 
$·¹s
 = 
	`ex¶ode
('.', 
$™em
);

1299 ià(
	`š_¬¿y
(
$·¹s
[0], 
$this
->
¬_®Ÿ£d_bËs
))

1301 ià(
$´Ùeù_id’tif›rs
 ==ğ
TRUE
)

1303 
	`fÜ—ch
 (
$·¹s
 
as
 
$key
 => 
$v®
)

1305 iàĞ! 
	`š_¬¿y
(
$v®
, 
$this
->
_»£rved_id’tif›rs
))

1307 
$·¹s
[
$key
] = 
$this
->
	`_esÿ³_id’tif›rs
(
$v®
);

1311 
$™em
 = 
	`im¶ode
('.', 
$·¹s
);

1313  
$™em
.
$®Ÿs
;

1317 ià(
$this
->
db´efix
 != '')

1322 ià(
	`is£t
(
$·¹s
[3]))

1324 
$i
 = 2;

1328 
	`–£if
 (
	`is£t
(
$·¹s
[2]))

1330 
$i
 = 1;

1336 
$i
 = 0;

1341 ià(
$f›ld_exi¡s
 =ğ
FALSE
)

1343 
$i
++;

1347 ià(
$this
->
sw­_´e
 !ğ'' && 
	`¡ºcmp
(
$·¹s
[
$i
], $this->sw­_´e, 
	`¡¾’
($this->swap_pre)) === 0)

1349 
$·¹s
[
$i
] = 
	`´eg_»¶aû
("/^".
$this
->
sw­_´e
."(\S+?)/", $this->
db´efix
."\\1", $parts[$i]);

1353 ià(
	`sub¡r
(
$·¹s
[
$i
], 0, 
	`¡¾’
(
$this
->
db´efix
)) != $this->dbprefix)

1355 
$·¹s
[
$i
] = 
$this
->
db´efix
.$parts[$i];

1359 
$™em
 = 
	`im¶ode
('.', 
$·¹s
);

1362 ià(
$´Ùeù_id’tif›rs
 ==ğ
TRUE
)

1364 
$™em
 = 
$this
->
	`_esÿ³_id’tif›rs
($item);

1367  
$™em
.
$®Ÿs
;

1371 ià(
$this
->
db´efix
 != '')

1374 ià(
$this
->
sw­_´e
 !ğ'' && 
	`¡ºcmp
(
$™em
, $this->sw­_´e, 
	`¡¾’
($this->swap_pre)) === 0)

1376 
$™em
 = 
	`´eg_»¶aû
("/^".
$this
->
sw­_´e
."(\S+?)/", $this->
db´efix
."\\1", $item);

1380 ià(
$´efix_sšgË
 =ğ
TRUE
 
AND
 
	`sub¡r
(
$™em
, 0, 
	`¡¾’
(
$this
->
db´efix
)) != $this->dbprefix)

1382 
$™em
 = 
$this
->
db´efix
.$item;

1386 ià(
$´Ùeù_id’tif›rs
 ==ğ
TRUE
 
AND
 ! 
	`š_¬¿y
(
$™em
, 
$this
->
_»£rved_id’tif›rs
))

1388 
$™em
 = 
$this
->
	`_esÿ³_id’tif›rs
($item);

1391  
$™em
.
$®Ÿs
;

1392 
	}
}

1403 
´Ùeùed
 
funùiÚ
 
	$_»£t_£Ëù
()

1405 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_fÜge
 {

27 
v¬
 
	m$f›lds
 = 
¬¿y
();

28 
v¬
 
	m$keys
 = 
¬¿y
();

29 
v¬
 
	m$´im¬y_keys
 = 
¬¿y
();

30 
v¬
 
	m$db_ch¬_£t
 = '';

38 
funùiÚ
 
	$__cÚ¡ruù
()

41 
$CI
 =& 
	`g‘_š¡ªû
();

42 
$this
->
db
 =& 
$CI
->db;

43 
	`log_mes§ge
('debug', "Database Forge Class Initialized");

55 
funùiÚ
 
	$ü—‹_d©aba£
(
$db_Çme
)

57 
$sql
 = 
$this
->
	`_ü—‹_d©aba£
(
$db_Çme
);

59 ià(
	`is_boŞ
(
$sql
))

61  
$sql
;

64  
$this
->
db
->
	`qu”y
(
$sql
);

65 
	}
}

76 
funùiÚ
 
	$drİ_d©aba£
(
$db_Çme
)

78 
$sql
 = 
$this
->
	`_drİ_d©aba£
(
$db_Çme
);

80 ià(
	`is_boŞ
(
$sql
))

82  
$sql
;

85  
$this
->
db
->
	`qu”y
(
$sql
);

86 
	}
}

98 
funùiÚ
 
add_key
(
$key
 = '', 
$´im¬y
 = 
FALSE
)

100 ià(
is_¬¿y
(
$key
))

102 
fÜ—ch
 (
$key
 
as
 
$Úe
)

104 
$this
->
add_key
(
$Úe
, 
$´im¬y
);

110 ià(
	g$key
 == '')

112 
show_”rÜ
('Key information is„equired forhat operation.');

115 ià(
	g$´im¬y
 ==ğ
TRUE
)

117 
$this
->
´im¬y_keys
[] = 
$key
;

121 
	g$this
->
	gkeys
[] = 
$key
;

134 
funùiÚ
 
add_f›ld
(
$f›ld
 = '')

136 ià(
$f›ld
 == '')

138 
show_”rÜ
('Field information is„equired.');

141 ià(
is_¡ršg
(
$f›ld
))

143 ià(
	g$f›ld
 == 'id')

145 
$this
->
add_f›ld
(
¬¿y
(

146 'id' => 
¬¿y
(

149 'auto_šüem’t' => 
TRUE


152 
	g$this
->
add_key
('id', 
TRUE
);

156 ià(
¡½os
(
$f›ld
, ' 'è==ğ
FALSE
)

158 
show_”rÜ
('Field information is„equired forhat operation.');

161 
	g$this
->
	gf›lds
[] = 
$f›ld
;

165 ià(
is_¬¿y
(
$f›ld
))

167 
	g$this
->
	gf›lds
 = 
¬¿y_m”ge
(
$this
->
f›lds
, 
$f›ld
);

181 
funùiÚ
 
ü—‹_bË
(
$bË
 = '', 
$if_nÙ_exi¡s
 = 
FALSE
)

183 ià(
$bË
 == '')

185 
show_”rÜ
('Aable‚ame is„equired forhat operation.');

188 ià(
couÁ
(
$this
->
f›lds
) == 0)

190 
show_”rÜ
('Field information is„equired.');

193 
	g$sql
 = 
$this
->
_ü—‹_bË
($this->
db
->
db´efix
.
$bË
, $this->
f›lds
, $this->
´im¬y_keys
, $this->
keys
, 
$if_nÙ_exi¡s
);

195 
	g$this
->
_»£t
();

196  
	g$this
->
	gdb
->
qu”y
(
$sql
);

208 
funùiÚ
 
	$drİ_bË
(
$bË_Çme
)

210 
$sql
 = 
$this
->
	`_drİ_bË
($this->
db
->
db´efix
.
$bË_Çme
);

212 ià(
	`is_boŞ
(
$sql
))

214  
$sql
;

217  
$this
->
db
->
	`qu”y
(
$sql
);

218 
	}
}

230 
funùiÚ
 
	$»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

232 ià(
$bË_Çme
 =ğ'' 
OR
 
$Ãw_bË_Çme
 == '')

234 
	`show_”rÜ
('Aable‚ame is„equired forhat operation.');

237 
$sql
 = 
$this
->
	`_»Çme_bË
($this->
db
->
db´efix
.
$bË_Çme
, $this->db->db´efix.
$Ãw_bË_Çme
);

238  
$this
->
db
->
	`qu”y
(
$sql
);

239 
	}
}

252 
funùiÚ
 
add_cŞumn
(
$bË
 = '', 
$f›ld
 = 
¬¿y
(), 
$aá”_f›ld
 = '')

254 ià(
$bË
 == '')

256 
show_”rÜ
('Aable‚ame is„equired forhat operation.');

262 
fÜ—ch
 (
$f›ld
 
as
 
$k
 => 
$v
)

264 
$this
->
add_f›ld
(
¬¿y
(
$k
 => 
$f›ld
[$k]));

266 ià(
couÁ
(
$this
->
f›lds
) == 0)

268 
show_”rÜ
('Field information is„equired.');

271 
	g$sql
 = 
$this
->
_®‹r_bË
('ADD', $this->
db
->
db´efix
.
$bË
, $this->
f›lds
, 
$aá”_f›ld
);

273 
	g$this
->
_»£t
();

275 ià(
	g$this
->
	gdb
->
qu”y
(
$sql
è==ğ
FALSE
)

277  
FALSE
;

281  
	gTRUE
;

295 
funùiÚ
 
drİ_cŞumn
(
$bË
 = '', 
$cŞumn_Çme
 = '')

298 ià(
$bË
 == '')

300 
show_”rÜ
('Aable‚ame is„equired forhat operation.');

303 ià(
	g$cŞumn_Çme
 == '')

305 
show_”rÜ
('A column‚ame is„equired forhat operation.');

308 
	g$sql
 = 
$this
->
_®‹r_bË
('DROP', $this->
db
->
db´efix
.
$bË
, 
$cŞumn_Çme
);

310  
	g$this
->
	gdb
->
qu”y
(
$sql
);

324 
funùiÚ
 
modify_cŞumn
(
$bË
 = '', 
$f›ld
 = 
	$¬¿y
())

326 ià(
$bË
 == '')

328 
	`show_”rÜ
('Aable‚ame is„equired forhat operation.');

334 
	`fÜ—ch
 (
$f›ld
 
as
 
$k
 => 
$v
)

337 iàĞ! 
	`is£t
(
$f›ld
[
$k
]['name']))

339 
$f›ld
[
$k
]['name'] = $k;

342 
$this
->
	`add_f›ld
(
	`¬¿y
(
$k
 => 
$f›ld
[$k]));

344 ià(
	`couÁ
(
$this
->
f›lds
) == 0)

346 
	`show_”rÜ
('Field information is„equired.');

349 
$sql
 = 
$this
->
	`_®‹r_bË
('CHANGE', $this->
db
->
db´efix
.
$bË
, $this->
f›lds
);

351 
$this
->
	`_»£t
();

353 ià(
$this
->
db
->
	`qu”y
(
$sql
è==ğ
FALSE
)

355  
FALSE
;

359  
TRUE
;

360 
	}
}

372 
funùiÚ
 
	$_»£t
()

374 
$this
->
f›lds
 = 
	`¬¿y
();

375 
$this
->
keys
 = 
	`¬¿y
();

376 
$this
->
´im¬y_keys
 = 
	`¬¿y
();

377 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_result.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_DB_»suÉ
 {

31 
v¬
 
	m$cÚn_id
 = 
NULL
;

32 
v¬
 
	m$»suÉ_id
 = 
NULL
;

33 
v¬
 
	m$»suÉ_¬¿y
 = 
¬¿y
();

34 
v¬
 
	m$»suÉ_objeù
 = 
¬¿y
();

35 
v¬
 
	m$cu¡om_»suÉ_objeù
 = 
¬¿y
();

36 
v¬
 
	m$cu¼’t_row
 = 0;

37 
v¬
 
	m$num_rows
 = 0;

38 
v¬
 
	m$row_d©a
 = 
NULL
;

48 
public
 
funùiÚ
 
»suÉ
(
$ty³
 = 'object')

50 ià(
$ty³
 =ğ'¬¿y'è 
$this
->
»suÉ_¬¿y
();

51 ià(
	m$ty³
 =ğ'objeù'è 
$this
->
»suÉ_objeù
();

52  
	m$this
->
cu¡om_»suÉ_objeù
(
$ty³
);

63 
public
 
funùiÚ
 
	$cu¡om_»suÉ_objeù
(
$şass_Çme
)

65 ià(
	`¬¿y_key_exi¡s
(
$şass_Çme
, 
$this
->
cu¡om_»suÉ_objeù
))

67  
$this
->
cu¡om_»suÉ_objeù
[
$şass_Çme
];

70 ià(
$this
->
»suÉ_id
 ==ğ
FALSE
 
OR
 $this->
	`num_rows
() == 0)

72  
	`¬¿y
();

76 
$this
->
	`_d©a_£ek
(0);

77 
$»suÉ_objeù
 = 
	`¬¿y
();

79 
$row
 = 
$this
->
	`_ãtch_objeù
())

81 
$objeù
 = 
Ãw
 
	`$şass_Çme
();

83 
	`fÜ—ch
 (
$row
 
as
 
$key
 => 
$v®ue
)

85 
$objeù
->
$key
 = 
$v®ue
;

88 
$»suÉ_objeù
[] = 
$objeù
;

92  
$this
->
cu¡om_»suÉ_objeù
[
$şass_Çme
] = 
$»suÉ_objeù
;

93 
	}
}

103 
public
 
funùiÚ
 
	$»suÉ_objeù
()

105 ià(
	`couÁ
(
$this
->
»suÉ_objeù
) > 0)

107  
$this
->
»suÉ_objeù
;

113 ià(
$this
->
»suÉ_id
 ==ğ
FALSE
 
OR
 $this->
	`num_rows
() == 0)

115  
	`¬¿y
();

118 
$this
->
	`_d©a_£ek
(0);

119 
$row
 = 
$this
->
	`_ãtch_objeù
())

121 
$this
->
»suÉ_objeù
[] = 
$row
;

124  
$this
->
»suÉ_objeù
;

125 
	}
}

135 
public
 
funùiÚ
 
	$»suÉ_¬¿y
()

137 ià(
	`couÁ
(
$this
->
»suÉ_¬¿y
) > 0)

139  
$this
->
»suÉ_¬¿y
;

145 ià(
$this
->
»suÉ_id
 ==ğ
FALSE
 
OR
 $this->
	`num_rows
() == 0)

147  
	`¬¿y
();

150 
$this
->
	`_d©a_£ek
(0);

151 
$row
 = 
$this
->
	`_ãtch_assoc
())

153 
$this
->
»suÉ_¬¿y
[] = 
$row
;

156  
$this
->
»suÉ_¬¿y
;

157 
	}
}

169 
public
 
funùiÚ
 
row
(
$n
 = 0, 
$ty³
 = 'object')

171 iàĞ! 
is_num”ic
(
$n
))

174 iàĞ! 
is_¬¿y
(
$this
->
row_d©a
))

176 
$this
->
row_d©a
 = $this->
row_¬¿y
(0);

180 ià(
¬¿y_key_exi¡s
(
$n
, 
$this
->
row_d©a
))

182  
	g$this
->
	grow_d©a
[
$n
];

185 
	g$n
 = 0;

188 ià(
	g$ty³
 =ğ'objeù'è 
$this
->
row_objeù
(
$n
);

189 ià(
	g$ty³
 =ğ'¬¿y'è 
$this
->
row_¬¿y
(
$n
);

190  
	g$this
->
cu¡om_row_objeù
(
$n
, 
$ty³
);

201 
public
 
funùiÚ
 
	$£t_row
(
$key
, 
$v®ue
 = 
NULL
)

204 iàĞ! 
	`is_¬¿y
(
$this
->
row_d©a
))

206 
$this
->
row_d©a
 = $this->
	`row_¬¿y
(0);

209 ià(
	`is_¬¿y
(
$key
))

211 
	`fÜ—ch
 (
$key
 
as
 
$k
 => 
$v
)

213 
$this
->
row_d©a
[
$k
] = 
$v
;

219 ià(
$key
 !ğ'' 
AND
 ! 
	`is_nuÎ
(
$v®ue
))

221 
$this
->
row_d©a
[
$key
] = 
$v®ue
;

223 
	}
}

233 
public
 
funùiÚ
 
	$cu¡om_row_objeù
(
$n
, 
$ty³
)

235 
$»suÉ
 = 
$this
->
	`cu¡om_»suÉ_objeù
(
$ty³
);

237 ià(
	`couÁ
(
$»suÉ
) == 0)

239  
$»suÉ
;

242 ià(
$n
 !ğ
$this
->
cu¼’t_row
 
AND
 
	`is£t
(
$»suÉ
[$n]))

244 
$this
->
cu¼’t_row
 = 
$n
;

247  
$»suÉ
[
$this
->
cu¼’t_row
];

248 
	}
}

256 
public
 
funùiÚ
 
	$row_objeù
(
$n
 = 0)

258 
$»suÉ
 = 
$this
->
	`»suÉ_objeù
();

260 ià(
	`couÁ
(
$»suÉ
) == 0)

262  
$»suÉ
;

265 ià(
$n
 !ğ
$this
->
cu¼’t_row
 
AND
 
	`is£t
(
$»suÉ
[$n]))

267 
$this
->
cu¼’t_row
 = 
$n
;

270  
$»suÉ
[
$this
->
cu¼’t_row
];

271 
	}
}

281 
public
 
funùiÚ
 
	$row_¬¿y
(
$n
 = 0)

283 
$»suÉ
 = 
$this
->
	`»suÉ_¬¿y
();

285 ià(
	`couÁ
(
$»suÉ
) == 0)

287  
$»suÉ
;

290 ià(
$n
 !ğ
$this
->
cu¼’t_row
 
AND
 
	`is£t
(
$»suÉ
[$n]))

292 
$this
->
cu¼’t_row
 = 
$n
;

295  
$»suÉ
[
$this
->
cu¼’t_row
];

296 
	}
}

307 
public
 
funùiÚ
 
fœ¡_row
(
$ty³
 = 'object')

309 
$»suÉ
 = 
$this
->
»suÉ
(
$ty³
);

311 ià(
couÁ
(
$»suÉ
) == 0)

313  
$»suÉ
;

315  
	g$»suÉ
[0];

326 
public
 
funùiÚ
 
Ï¡_row
(
$ty³
 = 'object')

328 
$»suÉ
 = 
$this
->
»suÉ
(
$ty³
);

330 ià(
couÁ
(
$»suÉ
) == 0)

332  
$»suÉ
;

334  
	g$»suÉ
[
couÁ
(
$»suÉ
) -1];

345 
public
 
funùiÚ
 
Ãxt_row
(
$ty³
 = 'object')

347 
$»suÉ
 = 
$this
->
»suÉ
(
$ty³
);

349 ià(
couÁ
(
$»suÉ
) == 0)

351  
$»suÉ
;

354 ià(
is£t
(
$»suÉ
[
$this
->
cu¼’t_row
 + 1]))

356 ++
	g$this
->
	gcu¼’t_row
;

359  
	g$»suÉ
[
$this
->
cu¼’t_row
];

370 
public
 
funùiÚ
 
´evious_row
(
$ty³
 = 'object')

372 
$»suÉ
 = 
$this
->
»suÉ
(
$ty³
);

374 ià(
couÁ
(
$»suÉ
) == 0)

376  
$»suÉ
;

379 ià(
is£t
(
$»suÉ
[
$this
->
cu¼’t_row
 - 1]))

381 --
	g$this
->
	gcu¼’t_row
;

383  
	g$»suÉ
[
$this
->
cu¼’t_row
];

397 
public
 
funùiÚ
 
	$num_rows
(è{  
$this
->
num_rows
; 
	}
}

398 
public
 
funùiÚ
 
	$num_f›lds
(è{  0; 
	}
}

399 
public
 
funùiÚ
 
	$li¡_f›lds
(è{  
	`¬¿y
(); 
	}
}

400 
public
 
funùiÚ
 
	$f›ld_d©a
(è{  
	`¬¿y
(); 
	}
}

401 
public
 
funùiÚ
 
	$ä“_»suÉ
(è{  
TRUE
; 
	}
}

402 
´Ùeùed
 
funùiÚ
 
	$_d©a_£ek
(è{  
TRUE
; 
	}
}

403 
´Ùeùed
 
funùiÚ
 
	$_ãtch_assoc
(è{  
	`¬¿y
(); 
	}
}

404 
´Ùeùed
 
funùiÚ
 
	$_ãtch_objeù
(è{  
	`¬¿y
(); 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_ut™y
 
ex‹nds
 
	mCI_DB_fÜge
 {

27 
v¬
 
	m$db
;

28 
v¬
 
	m$d©a_ÿche
 = 
¬¿y
();

36 
funùiÚ
 
	$__cÚ¡ruù
()

39 
$CI
 =& 
	`g‘_š¡ªû
();

40 
$this
->
db
 =& 
$CI
->db;

42 
	`log_mes§ge
('debug', "Database Utility Class Initialized");

53 
funùiÚ
 
	$li¡_d©aba£s
()

56 ià(
	`is£t
(
$this
->
d©a_ÿche
['db_names']))

58  
$this
->
d©a_ÿche
['db_names'];

61 
$qu”y
 = 
$this
->
db
->
	`qu”y
($this->
	`_li¡_d©aba£s
());

62 
$dbs
 = 
	`¬¿y
();

63 ià(
$qu”y
->
	`num_rows
() > 0)

65 
	`fÜ—ch
 (
$qu”y
->
	`»suÉ_¬¿y
(è
as
 
$row
)

67 
$dbs
[] = 
	`cu¼’t
(
$row
);

71 
$this
->
d©a_ÿche
['db_Çmes'] = 
$dbs
;

72  
$this
->
d©a_ÿche
['db_names'];

73 
	}
}

84 
funùiÚ
 
	$d©aba£_exi¡s
(
$d©aba£_Çme
)

89 ià(
	`m‘hod_exi¡s
(
$this
, '_database_exists'))

91  
$this
->
	`_d©aba£_exi¡s
(
$d©aba£_Çme
);

95  ( ! 
	`š_¬¿y
(
$d©aba£_Çme
, 
$this
->
	`li¡_d©aba£s
())è? 
FALSE
 : 
TRUE
;

97 
	}
}

109 
funùiÚ
 
	$İtimize_bË
(
$bË_Çme
)

111 
$sql
 = 
$this
->
	`_İtimize_bË
(
$bË_Çme
);

113 ià(
	`is_boŞ
(
$sql
))

115 
	`show_”rÜ
('db_must_use_set');

118 
$qu”y
 = 
$this
->
db
->
	`qu”y
(
$sql
);

119 
$»s
 = 
$qu”y
->
	`»suÉ_¬¿y
();

123  
	`cu¼’t
(
$»s
);

124 
	}
}

134 
funùiÚ
 
	$İtimize_d©aba£
()

136 
$»suÉ
 = 
	`¬¿y
();

137 
	`fÜ—ch
 (
$this
->
db
->
	`li¡_bËs
(è
as
 
$bË_Çme
)

139 
$sql
 = 
$this
->
	`_İtimize_bË
(
$bË_Çme
);

141 ià(
	`is_boŞ
(
$sql
))

143  
$sql
;

146 
$qu”y
 = 
$this
->
db
->
	`qu”y
(
$sql
);

151 
$»s
 = 
$qu”y
->
	`»suÉ_¬¿y
();

152 
$»s
 = 
	`cu¼’t
($res);

153 
$key
 = 
	`¡r_»¶aû
(
$this
->
db
->
d©aba£
.'.', '', 
	`cu¼’t
(
$»s
));

154 
$keys
 = 
	`¬¿y_keys
(
$»s
);

155 
	`un£t
(
$»s
[
$keys
[0]]);

157 
$»suÉ
[
$key
] = 
$»s
;

160  
$»suÉ
;

161 
	}
}

172 
funùiÚ
 
	$»·œ_bË
(
$bË_Çme
)

174 
$sql
 = 
$this
->
	`_»·œ_bË
(
$bË_Çme
);

176 ià(
	`is_boŞ
(
$sql
))

178  
$sql
;

181 
$qu”y
 = 
$this
->
db
->
	`qu”y
(
$sql
);

185 
$»s
 = 
$qu”y
->
	`»suÉ_¬¿y
();

186  
	`cu¼’t
(
$»s
);

187 
	}
}

201 
funùiÚ
 
csv_äom_»suÉ
(
$qu”y
, 
$d–im
 = ",", 
$Ãwlše
 = "\n", 
$’şosu»
 = '"')

203 iàĞ! 
is_objeù
(
$qu”y
è
OR
 ! 
m‘hod_exi¡s
($query, 'list_fields'))

205 
show_”rÜ
('You must submit‡ valid„esult object');

208 
	g$out
 = '';

211 
fÜ—ch
 (
$qu”y
->
li¡_f›lds
(è
as
 
$Çme
)

213 
	g$out
 .ğ
$’şosu»
.
¡r_»¶aû
($’şosu», $’şosu».$’şosu», 
$Çme
).
	g$’şosu»
.
	g$d–im
;

216 
	g$out
 = 
¹rim
(
$out
);

217 
	g$out
 .ğ
$Ãwlše
;

220 
fÜ—ch
 (
$qu”y
->
»suÉ_¬¿y
(è
as
 
$row
)

222 
fÜ—ch
 (
$row
 
as
 
$™em
)

224 
	g$out
 .ğ
$’şosu»
.
¡r_»¶aû
($’şosu», $’şosu».$’şosu», 
$™em
).
	g$’şosu»
.
	g$d–im
;

226 
	g$out
 = 
¹rim
(
$out
);

227 
	g$out
 .ğ
$Ãwlše
;

230  
	g$out
;

243 
funùiÚ
 
xml_äom_»suÉ
(
$qu”y
, 
$·¿ms
 = 
	$¬¿y
())

245 iàĞ! 
	`is_objeù
(
$qu”y
è
OR
 ! 
	`m‘hod_exi¡s
($query, 'list_fields'))

247 
	`show_”rÜ
('You must submit‡ valid„esult object');

251 
	`fÜ—ch
 (
	`¬¿y
('roÙ' => 'roÙ', '–em’t' => '–em’t', 'Ãwlše' => "\n", 'b' => "\t"è
as
 
$key
 => 
$v®
)

253 iàĞ! 
	`is£t
(
$·¿ms
[
$key
]))

255 
$·¿ms
[
$key
] = 
$v®
;

260 
	`exŒaù
(
$·¿ms
);

263 
$CI
 =& 
	`g‘_š¡ªû
();

264 
$CI
->
lßd
->
	`h–³r
('xml');

267 
$xml
 = "<{$roÙ}>".
$Ãwlše
;

268 
	`fÜ—ch
 (
$qu”y
->
	`»suÉ_¬¿y
(è
as
 
$row
)

270 
$xml
 .ğ
$b
."<{$–em’t}>".
$Ãwlše
;

272 
	`fÜ—ch
 (
$row
 
as
 
$key
 => 
$v®
)

274 
$xml
 .ğ
$b
.$b."<{$key}>".
	`xml_cÚv”t
(
$v®
)."</{$key}>".
$Ãwlše
;

276 
$xml
 .ğ
$b
."</{$–em’t}>".
$Ãwlše
;

278 
$xml
 .ğ"</$roÙ>".
$Ãwlše
;

280  
$xml
;

281 
	}
}

291 
funùiÚ
 
backup
(
$·¿ms
 = 
	$¬¿y
())

296 ià(
	`is_¡ršg
(
$·¿ms
))

298 
$·¿ms
 = 
	`¬¿y
('tables' => $params);

304 
$´efs
 = 
	`¬¿y
(

305 'bËs' => 
	`¬¿y
(),

306 'ignÜe' => 
	`¬¿y
(),

309 'add_drİ' => 
TRUE
,

310 'add_š£¹' => 
TRUE
,

315 ià(
	`couÁ
(
$·¿ms
) > 0)

317 
	`fÜ—ch
 (
$´efs
 
as
 
$key
 => 
$v®
)

319 ià(
	`is£t
(
$·¿ms
[
$key
]))

321 
$´efs
[
$key
] = 
$·¿ms
[$key];

330 ià(
	`couÁ
(
$´efs
['tables']) == 0)

332 
$´efs
['bËs'] = 
$this
->
db
->
	`li¡_bËs
();

338 iàĞ! 
	`š_¬¿y
(
$´efs
['fÜm©'], 
	`¬¿y
('gz', 'z', 'txt'), 
TRUE
))

340 
$´efs
['format'] = 'txt';

347 ià((
$´efs
['fÜm©'] =ğ'gz' 
AND
 ! @
	`funùiÚ_exi¡s
('gzencode'))

348 
	`OR
 (
$´efs
['fÜm©'] =ğ'z' 
AND
 ! @
	`funùiÚ_exi¡s
('gzcompress')))

350 ià(
$this
->
db
->
db_debug
)

352  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_compression');

355 
$´efs
['format'] = 'txt';

361 ià(
$´efs
['f’ame'] =ğ'' 
AND
 $prefs['format'] == 'zip')

363 
$´efs
['f’ame'] = (
	`couÁ
($´efs['bËs']è=ğ1è? $´efs['bËs'] : 
$this
->
db
->
d©aba£
;

364 
$´efs
['f’ame'] .ğ'_'.
	`d©e
('Y-m-d_H-i', 
	`time
());

370 ià(
$´efs
['format'] == 'gzip')

372  
	`gz’code
(
$this
->
	`_backup
(
$´efs
));

378 ià(
$´efs
['format'] == 'txt')

380  
$this
->
	`_backup
(
$´efs
);

386 ià(
$´efs
['format'] == 'zip')

389 ià(
	`´eg_m©ch
("|.+?\.z$|", 
$´efs
['filename']))

391 
$´efs
['f’ame'] = 
	`¡r_»¶aû
('.zip', '', $prefs['filename']);

395 iàĞ! 
	`´eg_m©ch
("|.+?\.sql$|", 
$´efs
['filename']))

397 
$´efs
['filename'] .= '.sql';

402 
$CI
 =& 
	`g‘_š¡ªû
();

403 
$CI
->
lßd
->
	`lib¿ry
('zip');

404 
$CI
->
z
->
	`add_d©a
(
$´efs
['f’ame'], 
$this
->
	`_backup
($prefs));

405  
$CI
->
z
->
	`g‘_z
();

408 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/cubrid/cubrid_driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

31 şas 
	cCI_DB_cubrid_driv”
 
ex‹nds
 
	mCI_DB
 {

35 cÚ¡ 
	mDEFAULT_PORT
 = 33000;

37 
v¬
 
	m$dbdriv”
 = 'cubrid';

40 
v¬
 
	m$_esÿ³_ch¬
 = '';

43 
v¬
 
	m$_like_esÿ³_¡r
 = '';

44 
v¬
 
	m$_like_esÿ³_chr
 = '';

51 
v¬
 
	m$_couÁ_¡ršg
 = 'SELECT COUNT(*) AS ';

52 
v¬
 
	m$_¿ndom_keywÜd
 = ' RAND()';

60 
funùiÚ
 
	$db_cÚÃù
()

63 ià(
$this
->
pÜt
 == '')

65 
$this
->
pÜt
 = 
£lf
::
DEFAULT_PORT
;

68 
$cÚn
 = 
	`cubrid_cÚÃù
(
$this
->
ho¡Çme
, $this->
pÜt
, $this->
d©aba£
, $this->
u£ºame
, $this->
·sswÜd
);

70 ià(
$cÚn
)

74 ià(
	`is£t
(
$this
->
auto_comm™
) && ! $this->auto_commit)

76 
	`cubrid_£t_autocomm™
(
$cÚn
, 
CUBRID_AUTOCOMMIT_FALSE
);

80 
	`cubrid_£t_autocomm™
(
$cÚn
, 
CUBRID_AUTOCOMMIT_TRUE
);

81 
$this
->
auto_comm™
 = 
TRUE
;

85  
$cÚn
;

103 
funùiÚ
 
	$db_pcÚÃù
()

105  
$this
->
	`db_cÚÃù
();

106 
	}
}

119 
funùiÚ
 
	$»cÚÃù
()

121 ià(
	`cubrid_pšg
(
$this
->
cÚn_id
è==ğ
FALSE
)

123 
$this
->
cÚn_id
 = 
FALSE
;

125 
	}
}

135 
funùiÚ
 
	$db_£Ëù
()

141  
	`cubrid_pšg
(
$this
->
cÚn_id
);

142 
	}
}

154 
funùiÚ
 
	$db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
)

159  
TRUE
;

160 
	}
}

170 
funùiÚ
 
	$_v”siÚ
()

177  
	`cubrid_g‘_£rv”_šfo
(
$this
->
cÚn_id
);

178 
	}
}

189 
funùiÚ
 
	$_execu‹
(
$sql
)

191 
$sql
 = 
$this
->
	`_´•_qu”y
($sql);

192  @
	`cubrid_qu”y
(
$sql
, 
$this
->
cÚn_id
);

193 
	}
}

206 
funùiÚ
 
	$_´•_qu”y
(
$sql
)

209  
$sql
;

210 
	}
}

220 
funùiÚ
 
	$Œªs_begš
(
$‹¡_mode
 = 
FALSE
)

222 iàĞ! 
$this
->
Œªs_’abËd
)

224  
TRUE
;

228 ià(
$this
->
_Œªs_d•th
 > 0)

230  
TRUE
;

236 
$this
->
_Œªs_çu»
 = (
$‹¡_mode
 ==ğ
TRUE
è? TRUE : 
FALSE
;

238 ià(
	`cubrid_g‘_autocomm™
(
$this
->
cÚn_id
))

240 
	`cubrid_£t_autocomm™
(
$this
->
cÚn_id
, 
CUBRID_AUTOCOMMIT_FALSE
);

243  
TRUE
;

244 
	}
}

254 
funùiÚ
 
	$Œªs_comm™
()

256 iàĞ! 
$this
->
Œªs_’abËd
)

258  
TRUE
;

262 ià(
$this
->
_Œªs_d•th
 > 0)

264  
TRUE
;

267 
	`cubrid_comm™
(
$this
->
cÚn_id
);

269 ià(
$this
->
auto_comm™
 && ! 
	`cubrid_g‘_autocomm™
($this->
cÚn_id
))

271 
	`cubrid_£t_autocomm™
(
$this
->
cÚn_id
, 
CUBRID_AUTOCOMMIT_TRUE
);

274  
TRUE
;

275 
	}
}

285 
funùiÚ
 
	$Œªs_rŞlback
()

287 iàĞ! 
$this
->
Œªs_’abËd
)

289  
TRUE
;

293 ià(
$this
->
_Œªs_d•th
 > 0)

295  
TRUE
;

298 
	`cubrid_rŞlback
(
$this
->
cÚn_id
);

300 ià(
$this
->
auto_comm™
 && ! 
	`cubrid_g‘_autocomm™
($this->
cÚn_id
))

302 
	`cubrid_£t_autocomm™
(
$this
->
cÚn_id
, 
CUBRID_AUTOCOMMIT_TRUE
);

305  
TRUE
;

306 
	}
}

318 
funùiÚ
 
	$esÿ³_¡r
(
$¡r
, 
$like
 = 
FALSE
)

320 ià(
	`is_¬¿y
(
$¡r
))

322 
	`fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

324 
$¡r
[
$key
] = 
$this
->
	`esÿ³_¡r
(
$v®
, 
$like
);

327  
$¡r
;

330 ià(
	`funùiÚ_exi¡s
('cubrid_»®_esÿ³_¡ršg'è
AND
 
	`is_»sourû
(
$this
->
cÚn_id
))

332 
$¡r
 = 
	`cubrid_»®_esÿ³_¡ršg
($¡r, 
$this
->
cÚn_id
);

336 
$¡r
 = 
	`add¦ashes
($str);

340 ià(
$like
 ==ğ
TRUE
)

342 
$¡r
 = 
	`¡r_»¶aû
(
	`¬¿y
('%', '_'),‡rray('\\%', '\\_'), $str);

345  
$¡r
;

346 
	}
}

356 
funùiÚ
 
	$afãùed_rows
()

358  @
	`cubrid_afãùed_rows
(
$this
->
cÚn_id
);

359 
	}
}

369 
funùiÚ
 
	$š£¹_id
()

371  @
	`cubrid_š£¹_id
(
$this
->
cÚn_id
);

372 
	}
}

386 
funùiÚ
 
couÁ_®l
(
$bË
 = '')

388 ià(
$bË
 == '')

393 
	g$qu”y
 = 
$this
->
qu”y
($this->
_couÁ_¡ršg
 . $this->
_´Ùeù_id’tif›rs
('numrows'è. " FROM " . $this->_´Ùeù_id’tif›rs(
$bË
, 
TRUE
, 
NULL
, 
FALSE
));

395 ià(
	g$qu”y
->
num_rows
() == 0)

400 
	g$row
 = 
$qu”y
->
row
();

401 
	g$this
->
_»£t_£Ëù
();

402  (è
	g$row
->
	gnumrows
;

416 
funùiÚ
 
	$_li¡_bËs
(
$´efix_lim™
 = 
FALSE
)

418 
$sql
 = "SHOW TABLES";

420 ià(
$´efix_lim™
 !=ğ
FALSE
 
AND
 
$this
->
db´efix
 != '')

422 
$sql
 .ğ" LIKE '".
$this
->
	`esÿ³_like_¡r
($this->
db´efix
)."%'";

425  
$sql
;

426 
	}
}

439 
funùiÚ
 
_li¡_cŞumns
(
$bË
 = '')

441  "SHOW COLUMNS FROM ".
$this
->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
);

455 
funùiÚ
 
	$_f›ld_d©a
(
$bË
)

457  "SELECT * FROM ".
$bË
." LIMIT 1";

458 
	}
}

468 
funùiÚ
 
	$_”rÜ_mes§ge
()

470  
	`cubrid_”rÜ
(
$this
->
cÚn_id
);

471 
	}
}

481 
funùiÚ
 
	$_”rÜ_numb”
()

483  
	`cubrid_”ºo
(
$this
->
cÚn_id
);

484 
	}
}

497 
funùiÚ
 
	$_esÿ³_id’tif›rs
(
$™em
)

499 ià(
$this
->
_esÿ³_ch¬
 == '')

501  
$™em
;

504 
	`fÜ—ch
 (
$this
->
_»£rved_id’tif›rs
 
as
 
$id
)

506 ià(
	`¡½os
(
$™em
, '.'.
$id
è!=ğ
FALSE
)

508 
$¡r
 = 
$this
->
_esÿ³_ch¬
. 
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.', 
$™em
);

511  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

515 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
)

517 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.'.$this->_esÿ³_ch¬, 
$™em
).$this->_escape_char;

521 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
$™em
.$this->_escape_char;

525  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

526 
	}
}

540 
funùiÚ
 
	$_äom_bËs
(
$bËs
)

542 iàĞ! 
	`is_¬¿y
(
$bËs
))

544 
$bËs
 = 
	`¬¿y
($tables);

547  '('.
	`im¶ode
(', ', 
$bËs
).')';

548 
	}
}

563 
funùiÚ
 
	$_š£¹
(
$bË
, 
$keys
, 
$v®ues
)

565  "INSERT INTO ".
$bË
." (\"".
	`im¶ode
('", "', 
$keys
)."\"èVALUES (".im¶ode(', ', 
$v®ues
).")";

566 
	}
}

582 
funùiÚ
 
	$_»¶aû
(
$bË
, 
$keys
, 
$v®ues
)

584  "REPLACE INTO ".
$bË
." (\"".
	`im¶ode
('", "', 
$keys
)."\"èVALUES (".im¶ode(', ', 
$v®ues
).")";

585 
	}
}

600 
funùiÚ
 
	$_š£¹_b©ch
(
$bË
, 
$keys
, 
$v®ues
)

602  "INSERT INTO ".
$bË
." (\"".
	`im¶ode
('", "', 
$keys
)."\"èVALUES ".im¶ode(', ', 
$v®ues
);

603 
	}
}

621 
funùiÚ
 
_upd©e
(
$bË
, 
$v®ues
, 
$wh”e
, 
$Üd”by
 = 
¬¿y
(), 
$lim™
 = 
FALSE
)

623 
fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

625 
$v®¡r
[] = 
¥rštf
('"%s" = %s', 
$key
, 
$v®
);

628 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

630 
	g$Üd”by
 = (
couÁ
(
$Üd”by
è>ğ1)?' ORDER BY '.
im¶ode
(", ", $orderby):'';

632 
	g$sql
 = "UPDATE ".
$bË
." SET ".
im¶ode
(', ', 
$v®¡r
);

634 
	g$sql
 .ğ(
$wh”e
 !ğ'' 
AND
 
couÁ
($wh”eè>=1è? " WHERE ".
im¶ode
(" ", $where) : '';

636 
	g$sql
 .ğ
$Üd”by
.
$lim™
;

638  
	g$sql
;

655 
funùiÚ
 
	$_upd©e_b©ch
(
$bË
, 
$v®ues
, 
$šdex
, 
$wh”e
 = 
NULL
)

657 
$ids
 = 
	`¬¿y
();

658 
$wh”e
 = ($wh”!ğ'' 
AND
 
	`couÁ
($wh”eè>=1è? 
	`im¶ode
(" ", $where).' AND ' : '';

660 
	`fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

662 
$ids
[] = 
$v®
[
$šdex
];

664 
	`fÜ—ch
 (
	`¬¿y_keys
(
$v®
è
as
 
$f›ld
)

666 ià(
$f›ld
 !ğ
$šdex
)

668 
$fš®
[
$f›ld
][] = 'WHEN '.
$šdex
.' = '.
$v®
[$index].' THEN '.$val[$field];

673 
$sql
 = "UPDATE ".
$bË
." SET ";

674 
$ÿ£s
 = '';

676 
	`fÜ—ch
 (
$fš®
 
as
 
$k
 => 
$v
)

678 
$ÿ£s
 .ğ
$k
.' = CASE '."\n";

679 
	`fÜ—ch
 (
$v
 
as
 
$row
)

681 
$ÿ£s
 .ğ
$row
."\n";

684 
$ÿ£s
 .ğ'ELSE '.
$k
.' END, ';

687 
$sql
 .ğ
	`sub¡r
(
$ÿ£s
, 0, -2);

689 
$sql
 .ğ' WHERE '.
$wh”e
.
$šdex
.' IN ('.
	`im¶ode
(',', 
$ids
).')';

691  
$sql
;

692 
	}
}

708 
funùiÚ
 
	$_Œunÿ‹
(
$bË
)

710  "TRUNCATE ".
$bË
;

711 
	}
}

726 
funùiÚ
 
_d–‘e
(
$bË
, 
$wh”e
 = 
¬¿y
(), 
$like
 =‡¼ay(), 
$lim™
 = 
FALSE
)

728 
$cÚd™iÚs
 = '';

730 ià(
couÁ
(
$wh”e
è> 0 
OR
 couÁ(
$like
) > 0)

732 
	g$cÚd™iÚs
 = "\nWHERE ";

733 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$this
->
¬_wh”e
);

735 ià(
couÁ
(
$wh”e
è> 0 && couÁ(
$like
) > 0)

737 
	g$cÚd™iÚs
 .= " AND ";

739 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$like
);

742 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

744  "DELETE FROM ".
	g$bË
.
	g$cÚd™iÚs
.
	g$lim™
;

760 
funùiÚ
 
	$_lim™
(
$sql
, 
$lim™
, 
$off£t
)

762 ià(
$off£t
 == 0)

764 
$off£t
 = '';

768 
$off£t
 .= ", ";

771  
$sql
."LIMIT ".
$off£t
.
$lim™
;

772 
	}
}

783 
funùiÚ
 
	$_şo£
(
$cÚn_id
)

785 @
	`cubrid_şo£
(
$cÚn_id
);

786 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/cubrid/cubrid_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_cubrid_fÜge
 
ex‹nds
 
	mCI_DB_fÜge
 {

34 
funùiÚ
 
	$_ü—‹_d©aba£
(
$Çme
)

38  
FALSE
;

50 
funùiÚ
 
	$_drİ_d©aba£
(
$Çme
)

54  
FALSE
;

55 
	}
}

66 
funùiÚ
 
	$_´oûss_f›lds
(
$f›lds
)

68 
$cu¼’t_f›ld_couÁ
 = 0;

69 
$sql
 = '';

71 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
=>
$©Œibu‹s
)

76 ià(
	`is_num”ic
(
$f›ld
))

78 
$sql
 .= "\n\t$attributes";

82 
$©Œibu‹s
 = 
	`¬¿y_chªge_key_ÿ£
($©Œibu‹s, 
CASE_UPPER
);

84 
$sql
 .ğ"\n\t\"" . 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$f›ld
) . "\"";

86 ià(
	`¬¿y_key_exi¡s
('NAME', 
$©Œibu‹s
))

88 
$sql
 .ğ' '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$©Œibu‹s
['NAME']).' ';

91 ià(
	`¬¿y_key_exi¡s
('TYPE', 
$©Œibu‹s
))

93 
$sql
 .ğ' '.
$©Œibu‹s
['TYPE'];

95 ià(
	`¬¿y_key_exi¡s
('CONSTRAINT', 
$©Œibu‹s
))

97 
$©Œibu‹s
['TYPE'])

102 
$sql
 .ğ'('.
	`im¶ode
(',', 
$©Œibu‹s
['CONSTRAINT']).')';

108 
$sql
 .ğ'("'.
	`im¶ode
('","', 
$©Œibu‹s
['CONSTRAINT']).'")';

111 
$sql
 .ğ'('.
$©Œibu‹s
['CONSTRAINT'].')';

116 ià(
	`¬¿y_key_exi¡s
('UNSIGNED', 
$©Œibu‹s
è&& $©Œibu‹s['UNSIGNED'] ==ğ
TRUE
)

123 ià(
	`¬¿y_key_exi¡s
('DEFAULT', 
$©Œibu‹s
))

125 
$sql
 .ğ' DEFAULT \''.
$©Œibu‹s
['DEFAULT'].'\'';

128 ià(
	`¬¿y_key_exi¡s
('NULL', 
$©Œibu‹s
è&& $©Œibu‹s['NULL'] ==ğ
TRUE
)

130 
$sql
 .= ' NULL';

134 
$sql
 .= ' NOT NULL';

137 ià(
	`¬¿y_key_exi¡s
('AUTO_INCREMENT', 
$©Œibu‹s
è&& $©Œibu‹s['AUTO_INCREMENT'] ==ğ
TRUE
)

139 
$sql
 .= ' AUTO_INCREMENT';

142 ià(
	`¬¿y_key_exi¡s
('UNIQUE', 
$©Œibu‹s
è&& $©Œibu‹s['UNIQUE'] ==ğ
TRUE
)

144 
$sql
 .= ' UNIQUE';

149 ià(++
$cu¼’t_f›ld_couÁ
 < 
	`couÁ
(
$f›lds
))

151 
$sql
 .= ',';

155  
$sql
;

156 
	}
}

171 
funùiÚ
 
	$_ü—‹_bË
(
$bË
, 
$f›lds
, 
$´im¬y_keys
, 
$keys
, 
$if_nÙ_exi¡s
)

173 
$sql
 = 'CREATE TABLE ';

175 ià(
$if_nÙ_exi¡s
 ==ğ
TRUE
)

181 
$sql
 .ğ
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
)." (";

183 
$sql
 .ğ
$this
->
	`_´oûss_f›lds
(
$f›lds
);

186 ià(
	`couÁ
(
$´im¬y_keys
) > 0)

188 
$key_Çme
 = "pk_" . 
$bË
 . "_" .

189 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
	`im¶ode
('_', 
$´im¬y_keys
));

191 
$´im¬y_keys
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($primary_keys);

192 
$sql
 .ğ",\n\tCONSTRAINT " . 
$key_Çme
 . " PRIMARY KEY(" . 
	`im¶ode
(', ', 
$´im¬y_keys
) . ")";

195 ià(
	`is_¬¿y
(
$keys
è&& 
	`couÁ
($keys) > 0)

197 
	`fÜ—ch
 (
$keys
 
as
 
$key
)

199 ià(
	`is_¬¿y
(
$key
))

201 
$key_Çme
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
	`im¶ode
('_', 
$key
));

202 
$key
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key);

206 
$key_Çme
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$key
);

207 
$key
 = 
	`¬¿y
(
$key_Çme
);

210 
$sql
 .ğ",\n\tKEY \"{$key_Çme}\" (" . 
	`im¶ode
(', ', 
$key
) . ")";

214 
$sql
 .= "\n);";

216  
$sql
;

217 
	}
}

227 
funùiÚ
 
	$_drİ_bË
(
$bË
)

229  "DROP TABLE IF EXISTS ".
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
);

230 
	}
}

247 
funùiÚ
 
_®‹r_bË
(
$®‹r_ty³
, 
$bË
, 
$f›lds
, 
$aá”_f›ld
 = '')

249 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$bË
)." $alter_type ";

252 ià(
	g$®‹r_ty³
 == 'DROP')

254  
$sql
.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$f›lds
);

257 
	g$sql
 .ğ
$this
->
_´oûss_f›lds
(
$f›lds
);

259 ià(
	g$aá”_f›ld
 != '')

261 
$sql
 .ğ' AFTER ' . 
$this
->
db
->
_´Ùeù_id’tif›rs
(
$aá”_f›ld
);

264  
	g$sql
;

279 
funùiÚ
 
	$_»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

281 
$sql
 = 'RENAME TABLE '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
)." AS ".$this->db->_´Ùeù_id’tif›rs(
$Ãw_bË_Çme
);

282  
$sql
;

283 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/cubrid/cubrid_result.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_DB_cubrid_»suÉ
 
ex‹nds
 
	mCI_DB_»suÉ
 {

35 
funùiÚ
 
	$num_rows
()

37  @
	`cubrid_num_rows
(
$this
->
»suÉ_id
);

48 
funùiÚ
 
	$num_f›lds
()

50  @
	`cubrid_num_f›lds
(
$this
->
»suÉ_id
);

51 
	}
}

63 
funùiÚ
 
	$li¡_f›lds
()

65  
	`cubrid_cŞumn_Çmes
(
$this
->
»suÉ_id
);

66 
	}
}

78 
funùiÚ
 
	$f›ld_d©a
()

80 
$»tv®
 = 
	`¬¿y
();

82 
$bËPrim¬yKeys
 = 
	`¬¿y
();

84 
$f›ld
 = 
	`cubrid_ãtch_f›ld
(
$this
->
»suÉ_id
))

86 
$F
 = 
Ãw
 
	`¡dCÏss
();

87 
$F
->
Çme
 = 
$f›ld
->name;

88 
$F
->
ty³
 = 
$f›ld
->type;

89 
$F
-> = 
$f›ld
->
def
;

90 
$F
->
max_Ëngth
 = 
$f›ld
->max_length;

105 
$»s
 = 
	`cubrid_qu”y
(
$this
->
cÚn_id
,

106 "SELECT COUNT(*èFROM db_šdex WHERE cÏss_Çmğ'" . 
$f›ld
->
bË
 .

108 
$f›ld
->
bË
 . "_" . $f›ld->
Çme
 . "'"

111 ià(
$»s
)

113 
$row
 = 
	`cubrid_ãtch_¬¿y
(
$»s
, 
CUBRID_NUM
);

114 
$F
->
´im¬y_key
 = (
$row
[0] > 0 ? 1 : 
nuÎ
);

118 
$F
->
´im¬y_key
 = 
nuÎ
;

121 ià(
	`is_»sourû
(
$»s
))

123 
	`cubrid_şo£_»que¡
(
$»s
);

124 
$this
->
»suÉ_id
 = 
FALSE
;

127 
$»tv®
[] = 
$F
;

130  
$»tv®
;

131 
	}
}

140 
funùiÚ
 
	$ä“_»suÉ
()

142 if(
	`is_»sourû
(
$this
->
»suÉ_id
) ||

143 
	`g‘_»sourû_ty³
(
$this
->
»suÉ_id
) == "Unknown" &&

144 
	`´eg_m©ch
('/Resourû id #/', 
	`¡rv®
(
$this
->
»suÉ_id
)))

146 
	`cubrid_şo£_»que¡
(
$this
->
»suÉ_id
);

147 
$this
->
»suÉ_id
 = 
FALSE
;

149 
	}
}

163 
funùiÚ
 
	$_d©a_£ek
(
$n
 = 0)

165  
	`cubrid_d©a_£ek
(
$this
->
»suÉ_id
, 
$n
);

166 
	}
}

178 
funùiÚ
 
	$_ãtch_assoc
()

180  
	`cubrid_ãtch_assoc
(
$this
->
»suÉ_id
);

181 
	}
}

193 
funùiÚ
 
	$_ãtch_objeù
()

195  
	`cubrid_ãtch_objeù
(
$this
->
»suÉ_id
);

196 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/cubrid/cubrid_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_cubrid_ut™y
 
ex‹nds
 
	mCI_DB_ut™y
 {

33 
funùiÚ
 
	$_li¡_d©aba£s
()

40 ià(
$this
->
cÚn_id
)

42  "SELECT '" . 
$this
->
d©aba£
 . "'";

46  
FALSE
;

62 
funùiÚ
 
	$_İtimize_bË
(
$bË
)

67  
FALSE
;

68 
	}
}

82 
funùiÚ
 
	$_»·œ_bË
(
$bË
)

87  
FALSE
;

88 
	}
}

98 
funùiÚ
 
_backup
(
$·¿ms
 = 
	$¬¿y
())

103  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

104 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mssql/mssql_driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

31 şas 
	cCI_DB_mssql_driv”
 
ex‹nds
 
	mCI_DB
 {

33 
v¬
 
	m$dbdriv”
 = 'mssql';

36 
v¬
 
	m$_esÿ³_ch¬
 = '';

39 
v¬
 
	m$_like_esÿ³_¡r
 = " ESCAPE '%s' ";

40 
v¬
 
	m$_like_esÿ³_chr
 = '!';

47 
v¬
 
	m$_couÁ_¡ršg
 = "SELECT COUNT(*) AS ";

48 
v¬
 
	m$_¿ndom_keywÜd
 = ' ASC';

56 
funùiÚ
 
	$db_cÚÃù
()

58 ià(
$this
->
pÜt
 != '')

60 
$this
->
ho¡Çme
 .ğ','.$this->
pÜt
;

63  @
	`mssql_cÚÃù
(
$this
->
ho¡Çme
, $this->
u£ºame
, $this->
·sswÜd
);

74 
funùiÚ
 
	$db_pcÚÃù
()

76 ià(
$this
->
pÜt
 != '')

78 
$this
->
ho¡Çme
 .ğ','.$this->
pÜt
;

81  @
	`mssql_pcÚÃù
(
$this
->
ho¡Çme
, $this->
u£ºame
, $this->
·sswÜd
);

82 
	}
}

95 
funùiÚ
 
	$»cÚÃù
()

98 
	}
}

108 
funùiÚ
 
	$db_£Ëù
()

112  @
	`mssql_£Ëù_db
('['.
$this
->
d©aba£
.']', $this->
cÚn_id
);

113 
	}
}

125 
funùiÚ
 
	$db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
)

128  
TRUE
;

129 
	}
}

140 
funùiÚ
 
	$_execu‹
(
$sql
)

142 
$sql
 = 
$this
->
	`_´•_qu”y
($sql);

143  @
	`mssql_qu”y
(
$sql
, 
$this
->
cÚn_id
);

144 
	}
}

157 
funùiÚ
 
	$_´•_qu”y
(
$sql
)

159  
$sql
;

160 
	}
}

170 
funùiÚ
 
	$Œªs_begš
(
$‹¡_mode
 = 
FALSE
)

172 iàĞ! 
$this
->
Œªs_’abËd
)

174  
TRUE
;

178 ià(
$this
->
_Œªs_d•th
 > 0)

180  
TRUE
;

186 
$this
->
_Œªs_çu»
 = (
$‹¡_mode
 ==ğ
TRUE
è? TRUE : 
FALSE
;

188 
$this
->
	`sim¶e_qu”y
('BEGIN TRAN');

189  
TRUE
;

190 
	}
}

200 
funùiÚ
 
	$Œªs_comm™
()

202 iàĞ! 
$this
->
Œªs_’abËd
)

204  
TRUE
;

208 ià(
$this
->
_Œªs_d•th
 > 0)

210  
TRUE
;

213 
$this
->
	`sim¶e_qu”y
('COMMIT TRAN');

214  
TRUE
;

215 
	}
}

225 
funùiÚ
 
	$Œªs_rŞlback
()

227 iàĞ! 
$this
->
Œªs_’abËd
)

229  
TRUE
;

233 ià(
$this
->
_Œªs_d•th
 > 0)

235  
TRUE
;

238 
$this
->
	`sim¶e_qu”y
('ROLLBACK TRAN');

239  
TRUE
;

240 
	}
}

252 
funùiÚ
 
	$esÿ³_¡r
(
$¡r
, 
$like
 = 
FALSE
)

254 ià(
	`is_¬¿y
(
$¡r
))

256 
	`fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

258 
$¡r
[
$key
] = 
$this
->
	`esÿ³_¡r
(
$v®
, 
$like
);

261  
$¡r
;

265 
$¡r
 = 
	`¡r_»¶aû
("'", "''", 
	`»move_švisibË_ch¬aù”s
($str));

268 ià(
$like
 ==ğ
TRUE
)

270 
$¡r
 = 
	`¡r_»¶aû
(

271 
	`¬¿y
(
$this
->
_like_esÿ³_chr
, '%', '_'),

272 
	`¬¿y
(
$this
->
_like_esÿ³_chr
.$this->_like_escape_chr, $this->_like_escape_chr.'%', $this->_like_escape_chr.'_'),

273 
$¡r


277  
$¡r
;

278 
	}
}

288 
funùiÚ
 
	$afãùed_rows
()

290  @
	`mssql_rows_afãùed
(
$this
->
cÚn_id
);

291 
	}
}

303 
funùiÚ
 
	$š£¹_id
()

305 
$v”
 = 
£lf
::
	`_·r£_majÜ_v”siÚ
(
$this
->
	`v”siÚ
());

306 
$sql
 = (
$v”
 >= 8 ? "SELECT SCOPE_IDENTITY() AS†ast_id" : "SELECT @@IDENTITY AS†ast_id");

307 
$qu”y
 = 
$this
->
	`qu”y
(
$sql
);

308 
$row
 = 
$qu”y
->
	`row
();

309  
$row
->
Ï¡_id
;

310 
	}
}

324 
funùiÚ
 
	$_·r£_majÜ_v”siÚ
(
$v”siÚ
)

326 
	`´eg_m©ch
('/([0-9]+)\.([0-9]+)\.([0-9]+)/', 
$v”siÚ
, 
$v”_šfo
);

327  
$v”_šfo
[1];

328 
	}
}

338 
funùiÚ
 
	$_v”siÚ
()

341 
	}
}

355 
funùiÚ
 
couÁ_®l
(
$bË
 = '')

357 ià(
$bË
 == '')

362 
	g$qu”y
 = 
$this
->
qu”y
($this->
_couÁ_¡ršg
 . $this->
_´Ùeù_id’tif›rs
('numrows'è. " FROM " . $this->_´Ùeù_id’tif›rs(
$bË
, 
TRUE
, 
NULL
, 
FALSE
));

364 ià(
	g$qu”y
->
num_rows
() == 0)

369 
	g$row
 = 
$qu”y
->
row
();

370 
	g$this
->
_»£t_£Ëù
();

371  (è
	g$row
->
	gnumrows
;

385 
funùiÚ
 
	$_li¡_bËs
(
$´efix_lim™
 = 
FALSE
)

387 
$sql
 = "SELECT‚ame FROM sysobjects WHEREype = 'U' ORDER BY‚ame";

390 ià(
$´efix_lim™
 !=ğ
FALSE
 
AND
 
$this
->
db´efix
 != '')

393  
FALSE
;

396  
$sql
;

397 
	}
}

410 
funùiÚ
 
_li¡_cŞumns
(
$bË
 = '')

412  "SELECT * FROM INFORMATION_SCHEMA.CŞumn WHERE TABLE_NAME = '".
$bË
."'";

426 
funùiÚ
 
	$_f›ld_d©a
(
$bË
)

428  "SELECT TOP 1 * FROM ".
$bË
;

429 
	}
}

439 
funùiÚ
 
	$_”rÜ_mes§ge
()

441  
	`mssql_g‘_Ï¡_mes§ge
();

442 
	}
}

452 
funùiÚ
 
	$_”rÜ_numb”
()

456 
	}
}

469 
funùiÚ
 
	$_esÿ³_id’tif›rs
(
$™em
)

471 ià(
$this
->
_esÿ³_ch¬
 == '')

473  
$™em
;

476 
	`fÜ—ch
 (
$this
->
_»£rved_id’tif›rs
 
as
 
$id
)

478 ià(
	`¡½os
(
$™em
, '.'.
$id
è!=ğ
FALSE
)

480 
$¡r
 = 
$this
->
_esÿ³_ch¬
. 
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.', 
$™em
);

483  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

487 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
)

489 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.'.$this->_esÿ³_ch¬, 
$™em
).$this->_escape_char;

493 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
$™em
.$this->_escape_char;

497  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

498 
	}
}

512 
funùiÚ
 
	$_äom_bËs
(
$bËs
)

514 iàĞ! 
	`is_¬¿y
(
$bËs
))

516 
$bËs
 = 
	`¬¿y
($tables);

519  
	`im¶ode
(', ', 
$bËs
);

520 
	}
}

535 
funùiÚ
 
	$_š£¹
(
$bË
, 
$keys
, 
$v®ues
)

537  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES (".im¶ode(', ', 
$v®ues
).")";

538 
	}
}

555 
funùiÚ
 
_upd©e
(
$bË
, 
$v®ues
, 
$wh”e
, 
$Üd”by
 = 
¬¿y
(), 
$lim™
 = 
FALSE
)

557 
fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

559 
$v®¡r
[] = 
$key
." = ".
$v®
;

562 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

564 
	g$Üd”by
 = (
couÁ
(
$Üd”by
è>ğ1)?' ORDER BY '.
im¶ode
(", ", $orderby):'';

566 
	g$sql
 = "UPDATE ".
$bË
." SET ".
im¶ode
(', ', 
$v®¡r
);

568 
	g$sql
 .ğ(
$wh”e
 !ğ'' 
AND
 
couÁ
($wh”eè>=1è? " WHERE ".
im¶ode
(" ", $where) : '';

570 
	g$sql
 .ğ
$Üd”by
.
$lim™
;

572  
	g$sql
;

589 
funùiÚ
 
	$_Œunÿ‹
(
$bË
)

591  "TRUNCATE ".
$bË
;

592 
	}
}

607 
funùiÚ
 
_d–‘e
(
$bË
, 
$wh”e
 = 
¬¿y
(), 
$like
 =‡¼ay(), 
$lim™
 = 
FALSE
)

609 
$cÚd™iÚs
 = '';

611 ià(
couÁ
(
$wh”e
è> 0 
OR
 couÁ(
$like
) > 0)

613 
	g$cÚd™iÚs
 = "\nWHERE ";

614 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$this
->
¬_wh”e
);

616 ià(
couÁ
(
$wh”e
è> 0 && couÁ(
$like
) > 0)

618 
	g$cÚd™iÚs
 .= " AND ";

620 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$like
);

623 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

625  "DELETE FROM ".
	g$bË
.
	g$cÚd™iÚs
.
	g$lim™
;

641 
funùiÚ
 
	$_lim™
(
$sql
, 
$lim™
, 
$off£t
)

643 
$i
 = 
$lim™
 + 
$off£t
;

645  
	`´eg_»¶aû
('/(^\SELECT (DISTINCT)?)/i','\\1 TOP '.
$i
.' ', 
$sql
);

646 
	}
}

657 
funùiÚ
 
	$_şo£
(
$cÚn_id
)

659 @
	`mssql_şo£
(
$cÚn_id
);

660 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mssql/mssql_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_mssql_fÜge
 
ex‹nds
 
	mCI_DB_fÜge
 {

34 
funùiÚ
 
	$_ü—‹_d©aba£
(
$Çme
)

36  "CREATE DATABASE ".
$Çme
;

48 
funùiÚ
 
	$_drİ_d©aba£
(
$Çme
)

50  "DROP DATABASE ".
$Çme
;

51 
	}
}

61 
funùiÚ
 
	$_drİ_bË
(
$bË
)

63  "DROP TABLE ".
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
);

64 
	}
}

79 
funùiÚ
 
	$_ü—‹_bË
(
$bË
, 
$f›lds
, 
$´im¬y_keys
, 
$keys
, 
$if_nÙ_exi¡s
)

81 
$sql
 = 'CREATE TABLE ';

83 ià(
$if_nÙ_exi¡s
 ==ğ
TRUE
)

85 
$sql
 .= 'IF NOT EXISTS ';

88 
$sql
 .ğ
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
)." (";

89 
$cu¼’t_f›ld_couÁ
 = 0;

91 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
=>
$©Œibu‹s
)

96 ià(
	`is_num”ic
(
$f›ld
))

98 
$sql
 .= "\n\t$attributes";

102 
$©Œibu‹s
 = 
	`¬¿y_chªge_key_ÿ£
($©Œibu‹s, 
CASE_UPPER
);

104 
$sql
 .ğ"\n\t".
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$f›ld
);

106 
$sql
 .ğ' '.
$©Œibu‹s
['TYPE'];

108 ià(
	`¬¿y_key_exi¡s
('CONSTRAINT', 
$©Œibu‹s
))

110 
$sql
 .ğ'('.
$©Œibu‹s
['CONSTRAINT'].')';

113 ià(
	`¬¿y_key_exi¡s
('UNSIGNED', 
$©Œibu‹s
è&& $©Œibu‹s['UNSIGNED'] ==ğ
TRUE
)

115 
$sql
 .= ' UNSIGNED';

118 ià(
	`¬¿y_key_exi¡s
('DEFAULT', 
$©Œibu‹s
))

120 
$sql
 .ğ' DEFAULT \''.
$©Œibu‹s
['DEFAULT'].'\'';

123 ià(
	`¬¿y_key_exi¡s
('NULL', 
$©Œibu‹s
è&& $©Œibu‹s['NULL'] ==ğ
TRUE
)

125 
$sql
 .= ' NULL';

129 
$sql
 .= ' NOT NULL';

132 ià(
	`¬¿y_key_exi¡s
('AUTO_INCREMENT', 
$©Œibu‹s
è&& $©Œibu‹s['AUTO_INCREMENT'] ==ğ
TRUE
)

134 
$sql
 .= ' AUTO_INCREMENT';

139 ià(++
$cu¼’t_f›ld_couÁ
 < 
	`couÁ
(
$f›lds
))

141 
$sql
 .= ',';

145 ià(
	`couÁ
(
$´im¬y_keys
) > 0)

147 
$´im¬y_keys
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($primary_keys);

148 
$sql
 .ğ",\n\tPRIMARY KEY (" . 
	`im¶ode
(', ', 
$´im¬y_keys
) . ")";

151 ià(
	`is_¬¿y
(
$keys
è&& 
	`couÁ
($keys) > 0)

153 
	`fÜ—ch
 (
$keys
 
as
 
$key
)

155 ià(
	`is_¬¿y
(
$key
))

157 
$key
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key);

161 
$key
 = 
	`¬¿y
(
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key));

164 
$sql
 .ğ",\n\tFOREIGN KEY (" . 
	`im¶ode
(', ', 
$key
) . ")";

168 
$sql
 .= "\n)";

170  
$sql
;

171 
	}
}

191 
funùiÚ
 
_®‹r_bË
(
$®‹r_ty³
, 
$bË
, 
$cŞumn_Çme
, 
$cŞumn_defš™iÚ
 = '', 
$deçuÉ_v®ue
 = '', 
$nuÎ
 = '', 
$aá”_f›ld
 = '')

193 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$bË
)." $®‹r_ty³ ".$this->db->_´Ùeù_id’tif›rs(
$cŞumn_Çme
);

196 ià(
	g$®‹r_ty³
 == 'DROP')

198  
$sql
;

201 
	g$sql
 .= " $column_definition";

203 ià(
	g$deçuÉ_v®ue
 != '')

205 
$sql
 .= " DEFAULT \"$default_value\"";

208 ià(
	g$nuÎ
 ==ğ
NULL
)

210 
$sql
 .= ' NULL';

214 
	g$sql
 .= ' NOT NULL';

217 ià(
	g$aá”_f›ld
 != '')

219 
$sql
 .ğ' AFTER ' . 
$this
->
db
->
_´Ùeù_id’tif›rs
(
$aá”_f›ld
);

222  
	g$sql
;

238 
funùiÚ
 
	$_»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

241 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
)." RENAME TO ".$this->db->_´Ùeù_id’tif›rs(
$Ãw_bË_Çme
);

242  
$sql
;

243 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mssql/mssql_result.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_DB_mssql_»suÉ
 
ex‹nds
 
	mCI_DB_»suÉ
 {

35 
funùiÚ
 
	$num_rows
()

37  @
	`mssql_num_rows
(
$this
->
»suÉ_id
);

48 
funùiÚ
 
	$num_f›lds
()

50  @
	`mssql_num_f›lds
(
$this
->
»suÉ_id
);

51 
	}
}

63 
funùiÚ
 
	$li¡_f›lds
()

65 
$f›ld_Çmes
 = 
	`¬¿y
();

66 
$f›ld
 = 
	`mssql_ãtch_f›ld
(
$this
->
»suÉ_id
))

68 
$f›ld_Çmes
[] = 
$f›ld
->
Çme
;

71  
$f›ld_Çmes
;

72 
	}
}

84 
funùiÚ
 
	$f›ld_d©a
()

86 
$»tv®
 = 
	`¬¿y
();

87 
$f›ld
 = 
	`mssql_ãtch_f›ld
(
$this
->
»suÉ_id
))

89 
$F
 = 
Ãw
 
	`¡dCÏss
();

90 
$F
->
Çme
 = 
$f›ld
->name;

91 
$F
->
ty³
 = 
$f›ld
->type;

92 
$F
->
max_Ëngth
 = 
$f›ld
->max_length;

93 
$F
->
´im¬y_key
 = 0;

94 
$F
-> = '';

96 
$»tv®
[] = 
$F
;

99  
$»tv®
;

100 
	}
}

109 
funùiÚ
 
	$ä“_»suÉ
()

111 ià(
	`is_»sourû
(
$this
->
»suÉ_id
))

113 
	`mssql_ä“_»suÉ
(
$this
->
»suÉ_id
);

114 
$this
->
»suÉ_id
 = 
FALSE
;

116 
	}
}

130 
funùiÚ
 
	$_d©a_£ek
(
$n
 = 0)

132  
	`mssql_d©a_£ek
(
$this
->
»suÉ_id
, 
$n
);

133 
	}
}

145 
funùiÚ
 
	$_ãtch_assoc
()

147  
	`mssql_ãtch_assoc
(
$this
->
»suÉ_id
);

148 
	}
}

160 
funùiÚ
 
	$_ãtch_objeù
()

162  
	`mssql_ãtch_objeù
(
$this
->
»suÉ_id
);

163 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mssql/mssql_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_mssql_ut™y
 
ex‹nds
 
	mCI_DB_ut™y
 {

33 
funùiÚ
 
	$_li¡_d©aba£s
()

49 
funùiÚ
 
	$_İtimize_bË
(
$bË
)

51  
FALSE
;

52 
	}
}

65 
funùiÚ
 
	$_»·œ_bË
(
$bË
)

67  
FALSE
;

68 
	}
}

79 
funùiÚ
 
_backup
(
$·¿ms
 = 
	$¬¿y
())

82  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

83 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysql/mysql_driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

31 şas 
	cCI_DB_mysql_driv”
 
ex‹nds
 
	mCI_DB
 {

33 
v¬
 
	m$dbdriv”
 = 'mysql';

36 
v¬
 
	m$_esÿ³_ch¬
 = '`';

39 
v¬
 
	m$_like_esÿ³_¡r
 = '';

40 
v¬
 
	m$_like_esÿ³_chr
 = '';

47 
v¬
 
	m$d–‘e_hack
 = 
TRUE
;

54 
v¬
 
	m$_couÁ_¡ršg
 = 'SELECT COUNT(*) AS ';

55 
v¬
 
	m$_¿ndom_keywÜd
 = ' RAND()';

58 
v¬
 
	m$u£_£t_Çmes
;

66 
funùiÚ
 
	$db_cÚÃù
()

68 ià(
$this
->
pÜt
 != '')

70 
$this
->
ho¡Çme
 .ğ':'.$this->
pÜt
;

73  @
	`mysql_cÚÃù
(
$this
->
ho¡Çme
, $this->
u£ºame
, $this->
·sswÜd
, 
TRUE
);

84 
funùiÚ
 
	$db_pcÚÃù
()

86 ià(
$this
->
pÜt
 != '')

88 
$this
->
ho¡Çme
 .ğ':'.$this->
pÜt
;

91  @
	`mysql_pcÚÃù
(
$this
->
ho¡Çme
, $this->
u£ºame
, $this->
·sswÜd
);

92 
	}
}

105 
funùiÚ
 
	$»cÚÃù
()

107 ià(
	`mysql_pšg
(
$this
->
cÚn_id
è==ğ
FALSE
)

109 
$this
->
cÚn_id
 = 
FALSE
;

111 
	}
}

121 
funùiÚ
 
	$db_£Ëù
()

123  @
	`mysql_£Ëù_db
(
$this
->
d©aba£
, $this->
cÚn_id
);

124 
	}
}

136 
funùiÚ
 
	$db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
)

138 iàĞ! 
	`is£t
(
$this
->
u£_£t_Çmes
))

141 
$this
->
u£_£t_Çmes
 = (
	`v”siÚ_com·»
(
PHP_VERSION
, '5.2.3', '>='è&& v”siÚ_com·»(
	`mysql_g‘_£rv”_šfo
(), '5.0.7', '>=')è? 
FALSE
 : 
TRUE
;

144 ià(
$this
->
u£_£t_Çmes
 ==ğ
TRUE
)

146  @
	`mysql_qu”y
("SET NAMES '".
$this
->
	`esÿ³_¡r
(
$ch¬£t
)."' COLLATE '".$this->esÿ³_¡r(
$cŞÏtiÚ
)."'", $this->
cÚn_id
);

150  @
	`mysql_£t_ch¬£t
(
$ch¬£t
, 
$this
->
cÚn_id
);

152 
	}
}

162 
funùiÚ
 
	$_v”siÚ
()

165 
	}
}

176 
funùiÚ
 
	$_execu‹
(
$sql
)

178 
$sql
 = 
$this
->
	`_´•_qu”y
($sql);

179  @
	`mysql_qu”y
(
$sql
, 
$this
->
cÚn_id
);

180 
	}
}

193 
funùiÚ
 
	$_´•_qu”y
(
$sql
)

197 ià(
$this
->
d–‘e_hack
 ==ğ
TRUE
)

199 ià(
	`´eg_m©ch
('/^\s*DELETE\s+FROM\s+(\S+)\s*$/i', 
$sql
))

201 
$sql
 = 
	`´eg_»¶aû
("/^\s*DELETE\s+FROM\s+(\S+)\s*$/", "DELETE FROM \\1 WHERE 1=1", $sql);

205  
$sql
;

206 
	}
}

216 
funùiÚ
 
	$Œªs_begš
(
$‹¡_mode
 = 
FALSE
)

218 iàĞ! 
$this
->
Œªs_’abËd
)

220  
TRUE
;

224 ià(
$this
->
_Œªs_d•th
 > 0)

226  
TRUE
;

232 
$this
->
_Œªs_çu»
 = (
$‹¡_mode
 ==ğ
TRUE
è? TRUE : 
FALSE
;

234 
$this
->
	`sim¶e_qu”y
('SET AUTOCOMMIT=0');

235 
$this
->
	`sim¶e_qu”y
('START TRANSACTION');

236  
TRUE
;

237 
	}
}

247 
funùiÚ
 
	$Œªs_comm™
()

249 iàĞ! 
$this
->
Œªs_’abËd
)

251  
TRUE
;

255 ià(
$this
->
_Œªs_d•th
 > 0)

257  
TRUE
;

260 
$this
->
	`sim¶e_qu”y
('COMMIT');

261 
$this
->
	`sim¶e_qu”y
('SET AUTOCOMMIT=1');

262  
TRUE
;

263 
	}
}

273 
funùiÚ
 
	$Œªs_rŞlback
()

275 iàĞ! 
$this
->
Œªs_’abËd
)

277  
TRUE
;

281 ià(
$this
->
_Œªs_d•th
 > 0)

283  
TRUE
;

286 
$this
->
	`sim¶e_qu”y
('ROLLBACK');

287 
$this
->
	`sim¶e_qu”y
('SET AUTOCOMMIT=1');

288  
TRUE
;

289 
	}
}

301 
funùiÚ
 
	$esÿ³_¡r
(
$¡r
, 
$like
 = 
FALSE
)

303 ià(
	`is_¬¿y
(
$¡r
))

305 
	`fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

307 
$¡r
[
$key
] = 
$this
->
	`esÿ³_¡r
(
$v®
, 
$like
);

310  
$¡r
;

313 ià(
	`funùiÚ_exi¡s
('mysql_»®_esÿ³_¡ršg'è
AND
 
	`is_»sourû
(
$this
->
cÚn_id
))

315 
$¡r
 = 
	`mysql_»®_esÿ³_¡ršg
($¡r, 
$this
->
cÚn_id
);

317 
	`–£if
 (
	`funùiÚ_exi¡s
('mysql_escape_string'))

319 
$¡r
 = 
	`mysql_esÿ³_¡ršg
($str);

323 
$¡r
 = 
	`add¦ashes
($str);

327 ià(
$like
 ==ğ
TRUE
)

329 
$¡r
 = 
	`¡r_»¶aû
(
	`¬¿y
('%', '_'),‡rray('\\%', '\\_'), $str);

332  
$¡r
;

333 
	}
}

343 
funùiÚ
 
	$afãùed_rows
()

345  @
	`mysql_afãùed_rows
(
$this
->
cÚn_id
);

346 
	}
}

356 
funùiÚ
 
	$š£¹_id
()

358  @
	`mysql_š£¹_id
(
$this
->
cÚn_id
);

359 
	}
}

373 
funùiÚ
 
couÁ_®l
(
$bË
 = '')

375 ià(
$bË
 == '')

380 
	g$qu”y
 = 
$this
->
qu”y
($this->
_couÁ_¡ršg
 . $this->
_´Ùeù_id’tif›rs
('numrows'è. " FROM " . $this->_´Ùeù_id’tif›rs(
$bË
, 
TRUE
, 
NULL
, 
FALSE
));

382 ià(
	g$qu”y
->
num_rows
() == 0)

387 
	g$row
 = 
$qu”y
->
row
();

388 
	g$this
->
_»£t_£Ëù
();

389  (è
	g$row
->
	gnumrows
;

403 
funùiÚ
 
	$_li¡_bËs
(
$´efix_lim™
 = 
FALSE
)

405 
$sql
 = "SHOW TABLES FROM ".
$this
->
_esÿ³_ch¬
.$this->
d©aba£
.$this->_escape_char;

407 ià(
$´efix_lim™
 !=ğ
FALSE
 
AND
 
$this
->
db´efix
 != '')

409 
$sql
 .ğ" LIKE '".
$this
->
	`esÿ³_like_¡r
($this->
db´efix
)."%'";

412  
$sql
;

413 
	}
}

426 
funùiÚ
 
_li¡_cŞumns
(
$bË
 = '')

428  "SHOW COLUMNS FROM ".
$this
->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
);

442 
funùiÚ
 
	$_f›ld_d©a
(
$bË
)

444  "DESCRIBE ".
$bË
;

445 
	}
}

455 
funùiÚ
 
	$_”rÜ_mes§ge
()

457  
	`mysql_”rÜ
(
$this
->
cÚn_id
);

458 
	}
}

468 
funùiÚ
 
	$_”rÜ_numb”
()

470  
	`mysql_”ºo
(
$this
->
cÚn_id
);

471 
	}
}

484 
funùiÚ
 
	$_esÿ³_id’tif›rs
(
$™em
)

486 ià(
$this
->
_esÿ³_ch¬
 == '')

488  
$™em
;

491 
	`fÜ—ch
 (
$this
->
_»£rved_id’tif›rs
 
as
 
$id
)

493 ià(
	`¡½os
(
$™em
, '.'.
$id
è!=ğ
FALSE
)

495 
$¡r
 = 
$this
->
_esÿ³_ch¬
. 
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.', 
$™em
);

498  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

502 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
)

504 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.'.$this->_esÿ³_ch¬, 
$™em
).$this->_escape_char;

508 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
$™em
.$this->_escape_char;

512  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

513 
	}
}

527 
funùiÚ
 
	$_äom_bËs
(
$bËs
)

529 iàĞ! 
	`is_¬¿y
(
$bËs
))

531 
$bËs
 = 
	`¬¿y
($tables);

534  '('.
	`im¶ode
(', ', 
$bËs
).')';

535 
	}
}

550 
funùiÚ
 
	$_š£¹
(
$bË
, 
$keys
, 
$v®ues
)

552  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES (".im¶ode(', ', 
$v®ues
).")";

553 
	}
}

569 
funùiÚ
 
	$_»¶aû
(
$bË
, 
$keys
, 
$v®ues
)

571  "REPLACE INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES (".im¶ode(', ', 
$v®ues
).")";

572 
	}
}

587 
funùiÚ
 
	$_š£¹_b©ch
(
$bË
, 
$keys
, 
$v®ues
)

589  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES ".im¶ode(', ', 
$v®ues
);

590 
	}
}

608 
funùiÚ
 
_upd©e
(
$bË
, 
$v®ues
, 
$wh”e
, 
$Üd”by
 = 
¬¿y
(), 
$lim™
 = 
FALSE
)

610 
fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

612 
$v®¡r
[] = 
$key
 . ' = ' . 
$v®
;

615 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

617 
	g$Üd”by
 = (
couÁ
(
$Üd”by
è>ğ1)?' ORDER BY '.
im¶ode
(", ", $orderby):'';

619 
	g$sql
 = "UPDATE ".
$bË
." SET ".
im¶ode
(', ', 
$v®¡r
);

621 
	g$sql
 .ğ(
$wh”e
 !ğ'' 
AND
 
couÁ
($wh”eè>=1è? " WHERE ".
im¶ode
(" ", $where) : '';

623 
	g$sql
 .ğ
$Üd”by
.
$lim™
;

625  
	g$sql
;

642 
funùiÚ
 
	$_upd©e_b©ch
(
$bË
, 
$v®ues
, 
$šdex
, 
$wh”e
 = 
NULL
)

644 
$ids
 = 
	`¬¿y
();

645 
$wh”e
 = ($wh”!ğ'' 
AND
 
	`couÁ
($wh”eè>=1è? 
	`im¶ode
(" ", $where).' AND ' : '';

647 
	`fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

649 
$ids
[] = 
$v®
[
$šdex
];

651 
	`fÜ—ch
 (
	`¬¿y_keys
(
$v®
è
as
 
$f›ld
)

653 ià(
$f›ld
 !ğ
$šdex
)

655 
$fš®
[
$f›ld
][] = 'WHEN '.
$šdex
.' = '.
$v®
[$index].' THEN '.$val[$field];

660 
$sql
 = "UPDATE ".
$bË
." SET ";

661 
$ÿ£s
 = '';

663 
	`fÜ—ch
 (
$fš®
 
as
 
$k
 => 
$v
)

665 
$ÿ£s
 .ğ
$k
.' = CASE '."\n";

666 
	`fÜ—ch
 (
$v
 
as
 
$row
)

668 
$ÿ£s
 .ğ
$row
."\n";

671 
$ÿ£s
 .ğ'ELSE '.
$k
.' END, ';

674 
$sql
 .ğ
	`sub¡r
(
$ÿ£s
, 0, -2);

676 
$sql
 .ğ' WHERE '.
$wh”e
.
$šdex
.' IN ('.
	`im¶ode
(',', 
$ids
).')';

678  
$sql
;

679 
	}
}

695 
funùiÚ
 
	$_Œunÿ‹
(
$bË
)

697  "TRUNCATE ".
$bË
;

698 
	}
}

713 
funùiÚ
 
_d–‘e
(
$bË
, 
$wh”e
 = 
¬¿y
(), 
$like
 =‡¼ay(), 
$lim™
 = 
FALSE
)

715 
$cÚd™iÚs
 = '';

717 ià(
couÁ
(
$wh”e
è> 0 
OR
 couÁ(
$like
) > 0)

719 
	g$cÚd™iÚs
 = "\nWHERE ";

720 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$this
->
¬_wh”e
);

722 ià(
couÁ
(
$wh”e
è> 0 && couÁ(
$like
) > 0)

724 
	g$cÚd™iÚs
 .= " AND ";

726 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$like
);

729 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

731  "DELETE FROM ".
	g$bË
.
	g$cÚd™iÚs
.
	g$lim™
;

747 
funùiÚ
 
	$_lim™
(
$sql
, 
$lim™
, 
$off£t
)

749 ià(
$off£t
 == 0)

751 
$off£t
 = '';

755 
$off£t
 .= ", ";

758  
$sql
."LIMIT ".
$off£t
.
$lim™
;

759 
	}
}

770 
funùiÚ
 
	$_şo£
(
$cÚn_id
)

772 @
	`mysql_şo£
(
$cÚn_id
);

773 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysql/mysql_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_mysql_fÜge
 
ex‹nds
 
	mCI_DB_fÜge
 {

34 
funùiÚ
 
	$_ü—‹_d©aba£
(
$Çme
)

36  "CREATE DATABASE ".
$Çme
;

48 
funùiÚ
 
	$_drİ_d©aba£
(
$Çme
)

50  "DROP DATABASE ".
$Çme
;

51 
	}
}

62 
funùiÚ
 
	$_´oûss_f›lds
(
$f›lds
)

64 
$cu¼’t_f›ld_couÁ
 = 0;

65 
$sql
 = '';

67 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
=>
$©Œibu‹s
)

72 ià(
	`is_num”ic
(
$f›ld
))

74 
$sql
 .= "\n\t$attributes";

78 
$©Œibu‹s
 = 
	`¬¿y_chªge_key_ÿ£
($©Œibu‹s, 
CASE_UPPER
);

80 
$sql
 .ğ"\n\t".
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$f›ld
);

82 ià(
	`¬¿y_key_exi¡s
('NAME', 
$©Œibu‹s
))

84 
$sql
 .ğ' '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$©Œibu‹s
['NAME']).' ';

87 ià(
	`¬¿y_key_exi¡s
('TYPE', 
$©Œibu‹s
))

89 
$sql
 .ğ' '.
$©Œibu‹s
['TYPE'];

91 ià(
	`¬¿y_key_exi¡s
('CONSTRAINT', 
$©Œibu‹s
))

93 
$©Œibu‹s
['TYPE'])

98 
$sql
 .ğ'('.
	`im¶ode
(',', 
$©Œibu‹s
['CONSTRAINT']).')';

103 
$sql
 .ğ'("'.
	`im¶ode
('","', 
$©Œibu‹s
['CONSTRAINT']).'")';

107 
$sql
 .ğ'('.
$©Œibu‹s
['CONSTRAINT'].')';

112 ià(
	`¬¿y_key_exi¡s
('UNSIGNED', 
$©Œibu‹s
è&& $©Œibu‹s['UNSIGNED'] ==ğ
TRUE
)

114 
$sql
 .= ' UNSIGNED';

117 ià(
	`¬¿y_key_exi¡s
('DEFAULT', 
$©Œibu‹s
))

119 
$sql
 .ğ' DEFAULT \''.
$©Œibu‹s
['DEFAULT'].'\'';

122 ià(
	`¬¿y_key_exi¡s
('NULL', 
$©Œibu‹s
è&& $©Œibu‹s['NULL'] ==ğ
TRUE
)

124 
$sql
 .= ' NULL';

128 
$sql
 .= ' NOT NULL';

131 ià(
	`¬¿y_key_exi¡s
('AUTO_INCREMENT', 
$©Œibu‹s
è&& $©Œibu‹s['AUTO_INCREMENT'] ==ğ
TRUE
)

133 
$sql
 .= ' AUTO_INCREMENT';

138 ià(++
$cu¼’t_f›ld_couÁ
 < 
	`couÁ
(
$f›lds
))

140 
$sql
 .= ',';

144  
$sql
;

145 
	}
}

160 
funùiÚ
 
	$_ü—‹_bË
(
$bË
, 
$f›lds
, 
$´im¬y_keys
, 
$keys
, 
$if_nÙ_exi¡s
)

162 
$sql
 = 'CREATE TABLE ';

164 ià(
$if_nÙ_exi¡s
 ==ğ
TRUE
)

166 
$sql
 .= 'IF NOT EXISTS ';

169 
$sql
 .ğ
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
)." (";

171 
$sql
 .ğ
$this
->
	`_´oûss_f›lds
(
$f›lds
);

173 ià(
	`couÁ
(
$´im¬y_keys
) > 0)

175 
$key_Çme
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
	`im¶ode
('_', 
$´im¬y_keys
));

176 
$´im¬y_keys
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($primary_keys);

177 
$sql
 .ğ",\n\tPRIMARY KEY ".
$key_Çme
." (" . 
	`im¶ode
(', ', 
$´im¬y_keys
) . ")";

180 ià(
	`is_¬¿y
(
$keys
è&& 
	`couÁ
($keys) > 0)

182 
	`fÜ—ch
 (
$keys
 
as
 
$key
)

184 ià(
	`is_¬¿y
(
$key
))

186 
$key_Çme
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
	`im¶ode
('_', 
$key
));

187 
$key
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key);

191 
$key_Çme
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$key
);

192 
$key
 = 
	`¬¿y
(
$key_Çme
);

195 
$sql
 .ğ",\n\tKEY {$key_Çme} (" . 
	`im¶ode
(', ', 
$key
) . ")";

199 
$sql
 .= "\n) DEFAULT CHARACTER SET {$this->db->char_set} COLLATE {$this->db->dbcollat};";

201  
$sql
;

202 
	}
}

212 
funùiÚ
 
	$_drİ_bË
(
$bË
)

214  "DROP TABLE IF EXISTS ".
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
);

215 
	}
}

232 
funùiÚ
 
_®‹r_bË
(
$®‹r_ty³
, 
$bË
, 
$f›lds
, 
$aá”_f›ld
 = '')

234 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$bË
)." $alter_type ";

237 ià(
	g$®‹r_ty³
 == 'DROP')

239  
$sql
.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$f›lds
);

242 
	g$sql
 .ğ
$this
->
_´oûss_f›lds
(
$f›lds
);

244 ià(
	g$aá”_f›ld
 != '')

246 
$sql
 .ğ' AFTER ' . 
$this
->
db
->
_´Ùeù_id’tif›rs
(
$aá”_f›ld
);

249  
	g$sql
;

264 
funùiÚ
 
	$_»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

266 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
)." RENAME TO ".$this->db->_´Ùeù_id’tif›rs(
$Ãw_bË_Çme
);

267  
$sql
;

268 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysql/mysql_result.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_DB_mysql_»suÉ
 
ex‹nds
 
	mCI_DB_»suÉ
 {

35 
funùiÚ
 
	$num_rows
()

37  @
	`mysql_num_rows
(
$this
->
»suÉ_id
);

48 
funùiÚ
 
	$num_f›lds
()

50  @
	`mysql_num_f›lds
(
$this
->
»suÉ_id
);

51 
	}
}

63 
funùiÚ
 
	$li¡_f›lds
()

65 
$f›ld_Çmes
 = 
	`¬¿y
();

66 
$f›ld
 = 
	`mysql_ãtch_f›ld
(
$this
->
»suÉ_id
))

68 
$f›ld_Çmes
[] = 
$f›ld
->
Çme
;

71  
$f›ld_Çmes
;

72 
	}
}

84 
funùiÚ
 
	$f›ld_d©a
()

86 
$»tv®
 = 
	`¬¿y
();

87 
$f›ld
 = 
	`mysql_ãtch_objeù
(
$this
->
»suÉ_id
))

89 
	`´eg_m©ch
('/([a-zA-Z]+)(\(\d+\))?/', 
$f›ld
->
Ty³
, 
$m©ches
);

91 
$ty³
 = (
	`¬¿y_key_exi¡s
(1, 
$m©ches
)è? $m©ches[1] : 
NULL
;

92 
$Ëngth
 = (
	`¬¿y_key_exi¡s
(2, 
$m©ches
)è? 
	`´eg_»¶aû
('/[^\d]/', '', $m©ches[2]è: 
NULL
;

94 
$F
 = 
Ãw
 
	`¡dCÏss
();

95 
$F
->
Çme
 = 
$f›ld
->
F›ld
;

96 
$F
->
ty³
 = 
$ty³
;

97 
$F
-> = 
$f›ld
->
DeçuÉ
;

98 
$F
->
max_Ëngth
 = 
$Ëngth
;

99 
$F
->
´im¬y_key
 = ( 
$f›ld
->
Key
 == 'PRI' ? 1 : 0 );

101 
$»tv®
[] = 
$F
;

104  
$»tv®
;

105 
	}
}

114 
funùiÚ
 
	$ä“_»suÉ
()

116 ià(
	`is_»sourû
(
$this
->
»suÉ_id
))

118 
	`mysql_ä“_»suÉ
(
$this
->
»suÉ_id
);

119 
$this
->
»suÉ_id
 = 
FALSE
;

121 
	}
}

135 
funùiÚ
 
	$_d©a_£ek
(
$n
 = 0)

137  
	`mysql_d©a_£ek
(
$this
->
»suÉ_id
, 
$n
);

138 
	}
}

150 
funùiÚ
 
	$_ãtch_assoc
()

152  
	`mysql_ãtch_assoc
(
$this
->
»suÉ_id
);

153 
	}
}

165 
funùiÚ
 
	$_ãtch_objeù
()

167  
	`mysql_ãtch_objeù
(
$this
->
»suÉ_id
);

168 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysql/mysql_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_mysql_ut™y
 
ex‹nds
 
	mCI_DB_ut™y
 {

33 
funùiÚ
 
	$_li¡_d©aba£s
()

49 
funùiÚ
 
	$_İtimize_bË
(
$bË
)

51  "OPTIMIZE TABLE ".
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
);

52 
	}
}

65 
funùiÚ
 
	$_»·œ_bË
(
$bË
)

67  "REPAIR TABLE ".
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
);

68 
	}
}

78 
funùiÚ
 
_backup
(
$·¿ms
 = 
	$¬¿y
())

80 ià(
	`couÁ
(
$·¿ms
) == 0)

82  
FALSE
;

86 
	`exŒaù
(
$·¿ms
);

89 
$ouut
 = '';

90 
	`fÜ—ch
 ((
¬¿y
)
$bËs
 
as
 
$bË
)

93 ià(
	`š_¬¿y
(
$bË
, (
¬¿y
)
$ignÜe
, 
TRUE
))

99 
$qu”y
 = 
$this
->
db
->
	`qu”y
("SHOW CREATE TABLE `".$this->db->
d©aba£
.'`.`'.
$bË
.'`');

102 ià(
$qu”y
 ==ğ
FALSE
)

108 
$ouut
 .ğ'#'.
$Ãwlše
.'# TABLE STRUCTURE FOR: '.
$bË
.$newline.'#'.$newline.$newline;

110 ià(
$add_drİ
 =ğ
TRUE
)

112 
$ouut
 .ğ'DROP TABLE IF EXISTS '.
$bË
.';'.
$Ãwlše
.$newline;

115 
$i
 = 0;

116 
$»suÉ
 = 
$qu”y
->
	`»suÉ_¬¿y
();

117 
	`fÜ—ch
 (
$»suÉ
[0] 
as
 
$v®
)

119 ià(
$i
++ % 2)

121 
$ouut
 .ğ
$v®
.';'.
$Ãwlše
.$newline;

126 ià(
$add_š£¹
 =ğ
FALSE
)

132 
$qu”y
 = 
$this
->
db
->
	`qu”y
("SELECT * FROM $table");

134 ià(
$qu”y
->
	`num_rows
() == 0)

143 
$i
 = 0;

144 
$f›ld_¡r
 = '';

145 
$is_št
 = 
	`¬¿y
();

146 
$f›ld
 = 
	`mysql_ãtch_f›ld
(
$qu”y
->
»suÉ_id
))

149 
$is_št
[
$i
] = (
	`š_¬¿y
(

150 
	`¡¹Şow”
(
	`mysql_f›ld_ty³
(
$qu”y
->
»suÉ_id
, 
$i
)),

151 
	`¬¿y
('tinyint', 'smallint', 'mediumint', 'int', 'bigint'),

152 
TRUE
)

153 è? 
TRUE
 : 
FALSE
;

156 
$f›ld_¡r
 .ğ'`'.
$f›ld
->
Çme
.'`, ';

157 
$i
++;

161 
$f›ld_¡r
 = 
	`´eg_»¶aû
( "/, $/" , "" , $field_str);

165 
	`fÜ—ch
 (
$qu”y
->
	`»suÉ_¬¿y
(è
as
 
$row
)

167 
$v®_¡r
 = '';

169 
$i
 = 0;

170 
	`fÜ—ch
 (
$row
 
as
 
$v
)

173 ià(
$v
 ==ğ
NULL
)

175 
$v®_¡r
 .= 'NULL';

180 ià(
$is_št
[
$i
] =ğ
FALSE
)

182 
$v®_¡r
 .ğ
$this
->
db
->
	`esÿ³
(
$v
);

186 
$v®_¡r
 .ğ
$v
;

191 
$v®_¡r
 .= ', ';

192 
$i
++;

196 
$v®_¡r
 = 
	`´eg_»¶aû
( "/, $/" , "" , $val_str);

199 
$ouut
 .ğ'INSERT INTO '.
$bË
.' ('.
$f›ld_¡r
.'èVALUES ('.
$v®_¡r
.');'.
$Ãwlše
;

202 
$ouut
 .ğ
$Ãwlše
.$newline;

205  
$ouut
;

206 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysqli/mysqli_driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

31 şas 
	cCI_DB_mysqli_driv”
 
ex‹nds
 
	mCI_DB
 {

33 
v¬
 
	m$dbdriv”
 = 'mysqli';

36 
v¬
 
	m$_esÿ³_ch¬
 = '`';

39 
v¬
 
	m$_like_esÿ³_¡r
 = '';

40 
v¬
 
	m$_like_esÿ³_chr
 = '';

47 
v¬
 
	m$_couÁ_¡ršg
 = "SELECT COUNT(*) AS ";

48 
v¬
 
	m$_¿ndom_keywÜd
 = ' RAND()';

55 
v¬
 
	m$d–‘e_hack
 = 
TRUE
;

58 
v¬
 
	m$u£_£t_Çmes
;

68 
funùiÚ
 
	$db_cÚÃù
()

70 ià(
$this
->
pÜt
 != '')

72  @
	`mysqli_cÚÃù
(
$this
->
ho¡Çme
, $this->
u£ºame
, $this->
·sswÜd
, $this->
d©aba£
, $this->
pÜt
);

76  @
	`mysqli_cÚÃù
(
$this
->
ho¡Çme
, $this->
u£ºame
, $this->
·sswÜd
, $this->
d©aba£
);

89 
funùiÚ
 
	$db_pcÚÃù
()

91  
$this
->
	`db_cÚÃù
();

92 
	}
}

105 
funùiÚ
 
	$»cÚÃù
()

107 ià(
	`mysqli_pšg
(
$this
->
cÚn_id
è==ğ
FALSE
)

109 
$this
->
cÚn_id
 = 
FALSE
;

111 
	}
}

121 
funùiÚ
 
	$db_£Ëù
()

123  @
	`mysqli_£Ëù_db
(
$this
->
cÚn_id
, $this->
d©aba£
);

124 
	}
}

136 
funùiÚ
 
	$_db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
)

138 iàĞ! 
	`is£t
(
$this
->
u£_£t_Çmes
))

141 
$this
->
u£_£t_Çmes
 = (
	`v”siÚ_com·»
(
	`mysqli_g‘_£rv”_šfo
($this->
cÚn_id
), '5.0.7', '>=')è? 
FALSE
 : 
TRUE
;

144 ià(
$this
->
u£_£t_Çmes
 ==ğ
TRUE
)

146  @
	`mysqli_qu”y
(
$this
->
cÚn_id
, "SET NAMES '".$this->
	`esÿ³_¡r
(
$ch¬£t
)."' COLLATE '".$this->esÿ³_¡r(
$cŞÏtiÚ
)."'");

150  @
	`mysqli_£t_ch¬£t
(
$this
->
cÚn_id
, 
$ch¬£t
);

152 
	}
}

162 
funùiÚ
 
	$_v”siÚ
()

165 
	}
}

176 
funùiÚ
 
	$_execu‹
(
$sql
)

178 
$sql
 = 
$this
->
	`_´•_qu”y
($sql);

179 
$»suÉ
 = @
	`mysqli_qu”y
(
$this
->
cÚn_id
, 
$sql
);

180  
$»suÉ
;

181 
	}
}

194 
funùiÚ
 
	$_´•_qu”y
(
$sql
)

198 ià(
$this
->
d–‘e_hack
 ==ğ
TRUE
)

200 ià(
	`´eg_m©ch
('/^\s*DELETE\s+FROM\s+(\S+)\s*$/i', 
$sql
))

202 
$sql
 = 
	`´eg_»¶aû
("/^\s*DELETE\s+FROM\s+(\S+)\s*$/", "DELETE FROM \\1 WHERE 1=1", $sql);

206  
$sql
;

207 
	}
}

217 
funùiÚ
 
	$Œªs_begš
(
$‹¡_mode
 = 
FALSE
)

219 iàĞ! 
$this
->
Œªs_’abËd
)

221  
TRUE
;

225 ià(
$this
->
_Œªs_d•th
 > 0)

227  
TRUE
;

233 
$this
->
_Œªs_çu»
 = (
$‹¡_mode
 ==ğ
TRUE
è? TRUE : 
FALSE
;

235 
$this
->
	`sim¶e_qu”y
('SET AUTOCOMMIT=0');

236 
$this
->
	`sim¶e_qu”y
('START TRANSACTION');

237  
TRUE
;

238 
	}
}

248 
funùiÚ
 
	$Œªs_comm™
()

250 iàĞ! 
$this
->
Œªs_’abËd
)

252  
TRUE
;

256 ià(
$this
->
_Œªs_d•th
 > 0)

258  
TRUE
;

261 
$this
->
	`sim¶e_qu”y
('COMMIT');

262 
$this
->
	`sim¶e_qu”y
('SET AUTOCOMMIT=1');

263  
TRUE
;

264 
	}
}

274 
funùiÚ
 
	$Œªs_rŞlback
()

276 iàĞ! 
$this
->
Œªs_’abËd
)

278  
TRUE
;

282 ià(
$this
->
_Œªs_d•th
 > 0)

284  
TRUE
;

287 
$this
->
	`sim¶e_qu”y
('ROLLBACK');

288 
$this
->
	`sim¶e_qu”y
('SET AUTOCOMMIT=1');

289  
TRUE
;

290 
	}
}

302 
funùiÚ
 
	$esÿ³_¡r
(
$¡r
, 
$like
 = 
FALSE
)

304 ià(
	`is_¬¿y
(
$¡r
))

306 
	`fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

308 
$¡r
[
$key
] = 
$this
->
	`esÿ³_¡r
(
$v®
, 
$like
);

311  
$¡r
;

314 ià(
	`funùiÚ_exi¡s
('mysqli_»®_esÿ³_¡ršg'è
AND
 
	`is_objeù
(
$this
->
cÚn_id
))

316 
$¡r
 = 
	`mysqli_»®_esÿ³_¡ršg
(
$this
->
cÚn_id
, $str);

318 
	`–£if
 (
	`funùiÚ_exi¡s
('mysql_escape_string'))

320 
$¡r
 = 
	`mysql_esÿ³_¡ršg
($str);

324 
$¡r
 = 
	`add¦ashes
($str);

328 ià(
$like
 ==ğ
TRUE
)

330 
$¡r
 = 
	`¡r_»¶aû
(
	`¬¿y
('%', '_'),‡rray('\\%', '\\_'), $str);

333  
$¡r
;

334 
	}
}

344 
funùiÚ
 
	$afãùed_rows
()

346  @
	`mysqli_afãùed_rows
(
$this
->
cÚn_id
);

347 
	}
}

357 
funùiÚ
 
	$š£¹_id
()

359  @
	`mysqli_š£¹_id
(
$this
->
cÚn_id
);

360 
	}
}

374 
funùiÚ
 
couÁ_®l
(
$bË
 = '')

376 ià(
$bË
 == '')

381 
	g$qu”y
 = 
$this
->
qu”y
($this->
_couÁ_¡ršg
 . $this->
_´Ùeù_id’tif›rs
('numrows'è. " FROM " . $this->_´Ùeù_id’tif›rs(
$bË
, 
TRUE
, 
NULL
, 
FALSE
));

383 ià(
	g$qu”y
->
num_rows
() == 0)

388 
	g$row
 = 
$qu”y
->
row
();

389 
	g$this
->
_»£t_£Ëù
();

390  (è
	g$row
->
	gnumrows
;

404 
funùiÚ
 
	$_li¡_bËs
(
$´efix_lim™
 = 
FALSE
)

406 
$sql
 = "SHOW TABLES FROM ".
$this
->
_esÿ³_ch¬
.$this->
d©aba£
.$this->_escape_char;

408 ià(
$´efix_lim™
 !=ğ
FALSE
 
AND
 
$this
->
db´efix
 != '')

410 
$sql
 .ğ" LIKE '".
$this
->
	`esÿ³_like_¡r
($this->
db´efix
)."%'";

413  
$sql
;

414 
	}
}

427 
funùiÚ
 
_li¡_cŞumns
(
$bË
 = '')

429  "SHOW COLUMNS FROM ".
$this
->
_´Ùeù_id’tif›rs
(
$bË
, 
TRUE
, 
NULL
, 
FALSE
);

443 
funùiÚ
 
	$_f›ld_d©a
(
$bË
)

445  "DESCRIBE ".
$bË
;

446 
	}
}

456 
funùiÚ
 
	$_”rÜ_mes§ge
()

458  
	`mysqli_”rÜ
(
$this
->
cÚn_id
);

459 
	}
}

469 
funùiÚ
 
	$_”rÜ_numb”
()

471  
	`mysqli_”ºo
(
$this
->
cÚn_id
);

472 
	}
}

485 
funùiÚ
 
	$_esÿ³_id’tif›rs
(
$™em
)

487 ià(
$this
->
_esÿ³_ch¬
 == '')

489  
$™em
;

492 
	`fÜ—ch
 (
$this
->
_»£rved_id’tif›rs
 
as
 
$id
)

494 ià(
	`¡½os
(
$™em
, '.'.
$id
è!=ğ
FALSE
)

496 
$¡r
 = 
$this
->
_esÿ³_ch¬
. 
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.', 
$™em
);

499  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

503 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
)

505 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.'.$this->_esÿ³_ch¬, 
$™em
).$this->_escape_char;

509 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
$™em
.$this->_escape_char;

513  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

514 
	}
}

528 
funùiÚ
 
	$_äom_bËs
(
$bËs
)

530 iàĞ! 
	`is_¬¿y
(
$bËs
))

532 
$bËs
 = 
	`¬¿y
($tables);

535  '('.
	`im¶ode
(', ', 
$bËs
).')';

536 
	}
}

551 
funùiÚ
 
	$_š£¹
(
$bË
, 
$keys
, 
$v®ues
)

553  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES (".im¶ode(', ', 
$v®ues
).")";

554 
	}
}

569 
funùiÚ
 
	$_š£¹_b©ch
(
$bË
, 
$keys
, 
$v®ues
)

571  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES ".im¶ode(', ', 
$v®ues
);

572 
	}
}

588 
funùiÚ
 
	$_»¶aû
(
$bË
, 
$keys
, 
$v®ues
)

590  "REPLACE INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES (".im¶ode(', ', 
$v®ues
).")";

591 
	}
}

608 
funùiÚ
 
_upd©e
(
$bË
, 
$v®ues
, 
$wh”e
, 
$Üd”by
 = 
¬¿y
(), 
$lim™
 = 
FALSE
)

610 
fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

612 
$v®¡r
[] = 
$key
." = ".
$v®
;

615 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

617 
	g$Üd”by
 = (
couÁ
(
$Üd”by
è>ğ1)?' ORDER BY '.
im¶ode
(", ", $orderby):'';

619 
	g$sql
 = "UPDATE ".
$bË
." SET ".
im¶ode
(', ', 
$v®¡r
);

621 
	g$sql
 .ğ(
$wh”e
 !ğ'' 
AND
 
couÁ
($wh”eè>=1è? " WHERE ".
im¶ode
(" ", $where) : '';

623 
	g$sql
 .ğ
$Üd”by
.
$lim™
;

625  
	g$sql
;

641 
funùiÚ
 
	$_upd©e_b©ch
(
$bË
, 
$v®ues
, 
$šdex
, 
$wh”e
 = 
NULL
)

643 
$ids
 = 
	`¬¿y
();

644 
$wh”e
 = ($wh”!ğ'' 
AND
 
	`couÁ
($wh”eè>=1è? 
	`im¶ode
(" ", $where).' AND ' : '';

646 
	`fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

648 
$ids
[] = 
$v®
[
$šdex
];

650 
	`fÜ—ch
 (
	`¬¿y_keys
(
$v®
è
as
 
$f›ld
)

652 ià(
$f›ld
 !ğ
$šdex
)

654 
$fš®
[
$f›ld
][] = 'WHEN '.
$šdex
.' = '.
$v®
[$index].' THEN '.$val[$field];

659 
$sql
 = "UPDATE ".
$bË
." SET ";

660 
$ÿ£s
 = '';

662 
	`fÜ—ch
 (
$fš®
 
as
 
$k
 => 
$v
)

664 
$ÿ£s
 .ğ
$k
.' = CASE '."\n";

665 
	`fÜ—ch
 (
$v
 
as
 
$row
)

667 
$ÿ£s
 .ğ
$row
."\n";

670 
$ÿ£s
 .ğ'ELSE '.
$k
.' END, ';

673 
$sql
 .ğ
	`sub¡r
(
$ÿ£s
, 0, -2);

675 
$sql
 .ğ' WHERE '.
$wh”e
.
$šdex
.' IN ('.
	`im¶ode
(',', 
$ids
).')';

677  
$sql
;

678 
	}
}

693 
funùiÚ
 
	$_Œunÿ‹
(
$bË
)

695  "TRUNCATE ".
$bË
;

696 
	}
}

711 
funùiÚ
 
_d–‘e
(
$bË
, 
$wh”e
 = 
¬¿y
(), 
$like
 =‡¼ay(), 
$lim™
 = 
FALSE
)

713 
$cÚd™iÚs
 = '';

715 ià(
couÁ
(
$wh”e
è> 0 
OR
 couÁ(
$like
) > 0)

717 
	g$cÚd™iÚs
 = "\nWHERE ";

718 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$this
->
¬_wh”e
);

720 ià(
couÁ
(
$wh”e
è> 0 && couÁ(
$like
) > 0)

722 
	g$cÚd™iÚs
 .= " AND ";

724 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$like
);

727 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

729  "DELETE FROM ".
	g$bË
.
	g$cÚd™iÚs
.
	g$lim™
;

745 
funùiÚ
 
	$_lim™
(
$sql
, 
$lim™
, 
$off£t
)

747 
$sql
 .ğ"LIMIT ".
$lim™
;

749 ià(
$off£t
 > 0)

751 
$sql
 .ğ" OFFSET ".
$off£t
;

754  
$sql
;

755 
	}
}

766 
funùiÚ
 
	$_şo£
(
$cÚn_id
)

768 @
	`mysqli_şo£
(
$cÚn_id
);

769 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysqli/mysqli_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_mysqli_fÜge
 
ex‹nds
 
	mCI_DB_fÜge
 {

34 
funùiÚ
 
	$_ü—‹_d©aba£
(
$Çme
)

36  "CREATE DATABASE ".
$Çme
;

48 
funùiÚ
 
	$_drİ_d©aba£
(
$Çme
)

50  "DROP DATABASE ".
$Çme
;

51 
	}
}

62 
funùiÚ
 
	$_´oûss_f›lds
(
$f›lds
)

64 
$cu¼’t_f›ld_couÁ
 = 0;

65 
$sql
 = '';

67 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
=>
$©Œibu‹s
)

72 ià(
	`is_num”ic
(
$f›ld
))

74 
$sql
 .= "\n\t$attributes";

78 
$©Œibu‹s
 = 
	`¬¿y_chªge_key_ÿ£
($©Œibu‹s, 
CASE_UPPER
);

80 
$sql
 .ğ"\n\t".
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$f›ld
);

82 ià(
	`¬¿y_key_exi¡s
('NAME', 
$©Œibu‹s
))

84 
$sql
 .ğ' '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$©Œibu‹s
['NAME']).' ';

87 ià(
	`¬¿y_key_exi¡s
('TYPE', 
$©Œibu‹s
))

89 
$sql
 .ğ' '.
$©Œibu‹s
['TYPE'];

92 ià(
	`¬¿y_key_exi¡s
('CONSTRAINT', 
$©Œibu‹s
))

94 
$sql
 .ğ'('.
$©Œibu‹s
['CONSTRAINT'].')';

97 ià(
	`¬¿y_key_exi¡s
('UNSIGNED', 
$©Œibu‹s
è&& $©Œibu‹s['UNSIGNED'] ==ğ
TRUE
)

99 
$sql
 .= ' UNSIGNED';

102 ià(
	`¬¿y_key_exi¡s
('DEFAULT', 
$©Œibu‹s
))

104 
$sql
 .ğ' DEFAULT \''.
$©Œibu‹s
['DEFAULT'].'\'';

107 ià(
	`¬¿y_key_exi¡s
('NULL', 
$©Œibu‹s
è&& $©Œibu‹s['NULL'] ==ğ
TRUE
)

109 
$sql
 .= ' NULL';

113 
$sql
 .= ' NOT NULL';

116 ià(
	`¬¿y_key_exi¡s
('AUTO_INCREMENT', 
$©Œibu‹s
è&& $©Œibu‹s['AUTO_INCREMENT'] ==ğ
TRUE
)

118 
$sql
 .= ' AUTO_INCREMENT';

123 ià(++
$cu¼’t_f›ld_couÁ
 < 
	`couÁ
(
$f›lds
))

125 
$sql
 .= ',';

129  
$sql
;

130 
	}
}

145 
funùiÚ
 
	$_ü—‹_bË
(
$bË
, 
$f›lds
, 
$´im¬y_keys
, 
$keys
, 
$if_nÙ_exi¡s
)

147 
$sql
 = 'CREATE TABLE ';

149 ià(
$if_nÙ_exi¡s
 ==ğ
TRUE
)

151 
$sql
 .= 'IF NOT EXISTS ';

154 
$sql
 .ğ
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
)." (";

156 
$sql
 .ğ
$this
->
	`_´oûss_f›lds
(
$f›lds
);

158 ià(
	`couÁ
(
$´im¬y_keys
) > 0)

160 
$key_Çme
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
	`im¶ode
('_', 
$´im¬y_keys
));

161 
$´im¬y_keys
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($primary_keys);

162 
$sql
 .ğ",\n\tPRIMARY KEY ".
$key_Çme
." (" . 
	`im¶ode
(', ', 
$´im¬y_keys
) . ")";

165 ià(
	`is_¬¿y
(
$keys
è&& 
	`couÁ
($keys) > 0)

167 
	`fÜ—ch
 (
$keys
 
as
 
$key
)

169 ià(
	`is_¬¿y
(
$key
))

171 
$key_Çme
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
	`im¶ode
('_', 
$key
));

172 
$key
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key);

176 
$key_Çme
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$key
);

177 
$key
 = 
	`¬¿y
(
$key_Çme
);

180 
$sql
 .ğ",\n\tKEY {$key_Çme} (" . 
	`im¶ode
(', ', 
$key
) . ")";

184 
$sql
 .= "\n) DEFAULT CHARACTER SET {$this->db->char_set} COLLATE {$this->db->dbcollat};";

186  
$sql
;

187 
	}
}

197 
funùiÚ
 
	$_drİ_bË
(
$bË
)

199  "DROP TABLE IF EXISTS ".
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
);

200 
	}
}

217 
funùiÚ
 
_®‹r_bË
(
$®‹r_ty³
, 
$bË
, 
$f›lds
, 
$aá”_f›ld
 = '')

219 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$bË
)." $alter_type ";

222 ià(
	g$®‹r_ty³
 == 'DROP')

224  
$sql
.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$f›lds
);

227 
	g$sql
 .ğ
$this
->
_´oûss_f›lds
(
$f›lds
);

229 ià(
	g$aá”_f›ld
 != '')

231 
$sql
 .ğ' AFTER ' . 
$this
->
db
->
_´Ùeù_id’tif›rs
(
$aá”_f›ld
);

234  
	g$sql
;

249 
funùiÚ
 
	$_»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

251 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
)." RENAME TO ".$this->db->_´Ùeù_id’tif›rs(
$Ãw_bË_Çme
);

252  
$sql
;

253 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysqli/mysqli_result.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_DB_mysqli_»suÉ
 
ex‹nds
 
	mCI_DB_»suÉ
 {

35 
funùiÚ
 
	$num_rows
()

37  @
	`mysqli_num_rows
(
$this
->
»suÉ_id
);

48 
funùiÚ
 
	$num_f›lds
()

50  @
	`mysqli_num_f›lds
(
$this
->
»suÉ_id
);

51 
	}
}

63 
funùiÚ
 
	$li¡_f›lds
()

65 
$f›ld_Çmes
 = 
	`¬¿y
();

66 
$f›ld
 = 
	`mysqli_ãtch_f›ld
(
$this
->
»suÉ_id
))

68 
$f›ld_Çmes
[] = 
$f›ld
->
Çme
;

71  
$f›ld_Çmes
;

72 
	}
}

84 
funùiÚ
 
	$f›ld_d©a
()

86 
$»tv®
 = 
	`¬¿y
();

87 
$f›ld
 = 
	`mysqli_ãtch_objeù
(
$this
->
»suÉ_id
))

89 
	`´eg_m©ch
('/([a-zA-Z]+)(\(\d+\))?/', 
$f›ld
->
Ty³
, 
$m©ches
);

91 
$ty³
 = (
	`¬¿y_key_exi¡s
(1, 
$m©ches
)è? $m©ches[1] : 
NULL
;

92 
$Ëngth
 = (
	`¬¿y_key_exi¡s
(2, 
$m©ches
)è? 
	`´eg_»¶aû
('/[^\d]/', '', $m©ches[2]è: 
NULL
;

94 
$F
 = 
Ãw
 
	`¡dCÏss
();

95 
$F
->
Çme
 = 
$f›ld
->
F›ld
;

96 
$F
->
ty³
 = 
$ty³
;

97 
$F
-> = 
$f›ld
->
DeçuÉ
;

98 
$F
->
max_Ëngth
 = 
$Ëngth
;

99 
$F
->
´im¬y_key
 = ( 
$f›ld
->
Key
 == 'PRI' ? 1 : 0 );

101 
$»tv®
[] = 
$F
;

104  
$»tv®
;

105 
	}
}

114 
funùiÚ
 
	$ä“_»suÉ
()

116 ià(
	`is_objeù
(
$this
->
»suÉ_id
))

118 
	`mysqli_ä“_»suÉ
(
$this
->
»suÉ_id
);

119 
$this
->
»suÉ_id
 = 
FALSE
;

121 
	}
}

135 
funùiÚ
 
	$_d©a_£ek
(
$n
 = 0)

137  
	`mysqli_d©a_£ek
(
$this
->
»suÉ_id
, 
$n
);

138 
	}
}

150 
funùiÚ
 
	$_ãtch_assoc
()

152  
	`mysqli_ãtch_assoc
(
$this
->
»suÉ_id
);

153 
	}
}

165 
funùiÚ
 
	$_ãtch_objeù
()

167  
	`mysqli_ãtch_objeù
(
$this
->
»suÉ_id
);

168 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysqli/mysqli_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_mysqli_ut™y
 
ex‹nds
 
	mCI_DB_ut™y
 {

33 
funùiÚ
 
	$_li¡_d©aba£s
()

49 
funùiÚ
 
	$_İtimize_bË
(
$bË
)

51  "OPTIMIZE TABLE ".
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
);

52 
	}
}

65 
funùiÚ
 
	$_»·œ_bË
(
$bË
)

67  "REPAIR TABLE ".
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
);

68 
	}
}

79 
funùiÚ
 
_backup
(
$·¿ms
 = 
	$¬¿y
())

82  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

83 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/oci8/oci8_driver.php

1 <?
php


3 ià(!
defšed
('BASEPATH'))

4 
ex™
('No direct script‡ccess‡llowed');

43 şas 
	cCI_DB_oci8_driv”
 
ex‹nds
 
	mCI_DB
 {

45 
v¬
 
	m$dbdriv”
 = 'oci8';

47 
v¬
 
	m$_esÿ³_ch¬
 = '';

49 
v¬
 
	m$_like_esÿ³_¡r
 = "ƒscape '%s' ";

50 
v¬
 
	m$_like_esÿ³_chr
 = '!';

57 
v¬
 
	m$_couÁ_¡ršg
 = "SELECT COUNT(1) AS ";

58 
v¬
 
	m$_¿ndom_keywÜd
 = ' ASC';

60 
v¬
 
	m$_comm™
 = 
OCI_COMMIT_ON_SUCCESS
;

62 
v¬
 
	m$¡mt_id
;

63 
v¬
 
	m$curs_id
;

66 
v¬
 
	m$lim™_u£d
;

74 
public
 
funùiÚ
 
	$db_cÚÃù
() {

75  @
	`oci_cÚÃù
(
$this
->
u£ºame
, $this->
·sswÜd
, $this->
ho¡Çme
, $this->
ch¬_£t
);

86 
public
 
funùiÚ
 
	$db_pcÚÃù
() {

87  @
	`oci_pcÚÃù
(
$this
->
u£ºame
, $this->
·sswÜd
, $this->
ho¡Çme
, $this->
ch¬_£t
);

88 
	}
}

101 
public
 
funùiÚ
 
	$»cÚÃù
() {

104 
	}
}

114 
public
 
funùiÚ
 
	$db_£Ëù
() {

116  
TRUE
;

117 
	}
}

129 
public
 
funùiÚ
 
	$db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
) {

131  
TRUE
;

132 
	}
}

142 
´Ùeùed
 
funùiÚ
 
	$_v”siÚ
() {

143  
	`oci_£rv”_v”siÚ
(
$this
->
cÚn_id
);

144 
	}
}

155 
´Ùeùed
 
funùiÚ
 
	$_execu‹
(
$sql
) {

158 
$this
->
¡mt_id
 = 
FALSE
;

159 
$this
->
	`_£t_¡mt_id
(
$sql
);

160 
	`oci_£t_´eãtch
(
$this
->
¡mt_id
, 1000);

161  @
	`oci_execu‹
(
$this
->
¡mt_id
, $this->
_comm™
);

162 
	}
}

171 
´iv©e
 
funùiÚ
 
	$_£t_¡mt_id
(
$sql
) {

172 ià(!
	`is_»sourû
(
$this
->
¡mt_id
)) {

173 
$this
->
¡mt_id
 = 
	`oci_·r£
($this->
cÚn_id
, $this->
	`_´•_qu”y
(
$sql
));

175 
	}
}

188 
´iv©e
 
funùiÚ
 
	$_´•_qu”y
(
$sql
) {

189  
$sql
;

190 
	}
}

200 
public
 
funùiÚ
 
	$g‘_cursÜ
() {

201 
$this
->
curs_id
 = 
	`oci_Ãw_cursÜ
($this->
cÚn_id
);

202  
$this
->
curs_id
;

203 
	}
}

225 
public
 
funùiÚ
 
	$¡Üed_´oûdu»
(
$·ckage
, 
$´oûdu»
, 
$·¿ms
) {

226 ià(
$·ckage
 =ğ'' 
OR
 
$´oûdu»
 =ğ'' OR ! 
	`is_¬¿y
(
$·¿ms
)) {

227 ià(
$this
->
db_debug
) {

228 
	`log_mes§ge
('”rÜ', 'Inv®id qu”y: ' . 
$·ckage
 . '.' . 
$´oûdu»
);

229  
$this
->
	`di¥Ïy_”rÜ
('db_invalid_query');

231  
FALSE
;

235 
$sql
 = "begin $package.$procedure(";

237 
$have_cursÜ
 = 
FALSE
;

238 
	`fÜ—ch
 (
$·¿ms
 
as
 
$·¿m
) {

239 
$sql
 .ğ
$·¿m
['name'] . ",";

241 ià(
	`¬¿y_key_exi¡s
('ty³', 
$·¿m
è&& ($·¿m['ty³'] ==ğ
OCI_B_CURSOR
)) {

242 
$have_cursÜ
 = 
TRUE
;

245 
$sql
 = 
	`Œim
($sql, ",") . ");ƒnd;";

247 
$this
->
¡mt_id
 = 
FALSE
;

248 
$this
->
	`_£t_¡mt_id
(
$sql
);

249 
$this
->
	`_bšd_·¿ms
(
$·¿ms
);

250 
$this
->
	`qu”y
(
$sql
, 
FALSE
, 
$have_cursÜ
);

251 
	}
}

261 
´iv©e
 
funùiÚ
 
	$_bšd_·¿ms
(
$·¿ms
) {

262 ià(!
	`is_¬¿y
(
$·¿ms
è
OR
 ! 
	`is_»sourû
(
$this
->
¡mt_id
)) {

266 
	`fÜ—ch
 (
$·¿ms
 
as
 
$·¿m
) {

267 
	`fÜ—ch
 (
	`¬¿y
('Çme', 'v®ue', 'ty³', 'Ëngth'è
as
 
$v®
) {

268 ià(!
	`is£t
(
$·¿m
[
$v®
])) {

269 
$·¿m
[
$v®
] = '';

273 
	`oci_bšd_by_Çme
(
$this
->
¡mt_id
, 
$·¿m
['name'], $param['value'], $param['length'], $param['type']);

275 
	}
}

285 
public
 
funùiÚ
 
	$Œªs_begš
(
$‹¡_mode
 = 
FALSE
) {

286 ià(!
$this
->
Œªs_’abËd
) {

287  
TRUE
;

291 ià(
$this
->
_Œªs_d•th
 > 0) {

292  
TRUE
;

298 
$this
->
_Œªs_çu»
 = (
$‹¡_mode
 ==ğ
TRUE
è? TRUE : 
FALSE
;

300 
$this
->
_comm™
 = 
OCI_DEFAULT
;

301  
TRUE
;

302 
	}
}

312 
public
 
funùiÚ
 
	$Œªs_comm™
() {

313 ià(!
$this
->
Œªs_’abËd
) {

314  
TRUE
;

318 ià(
$this
->
_Œªs_d•th
 > 0) {

319  
TRUE
;

322 
$»t
 = 
	`oci_comm™
(
$this
->
cÚn_id
);

323 
$this
->
_comm™
 = 
OCI_COMMIT_ON_SUCCESS
;

324  
$»t
;

325 
	}
}

335 
public
 
funùiÚ
 
	$Œªs_rŞlback
() {

336 ià(!
$this
->
Œªs_’abËd
) {

337  
TRUE
;

341 ià(
$this
->
_Œªs_d•th
 > 0) {

342  
TRUE
;

345 
$»t
 = 
	`oci_rŞlback
(
$this
->
cÚn_id
);

346 
$this
->
_comm™
 = 
OCI_COMMIT_ON_SUCCESS
;

347  
$»t
;

348 
	}
}

360 
public
 
funùiÚ
 
	$esÿ³_¡r
(
$¡r
, 
$like
 = 
FALSE
) {

361 ià(
	`is_¬¿y
(
$¡r
)) {

362 
	`fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
) {

363 
$¡r
[
$key
] = 
$this
->
	`esÿ³_¡r
(
$v®
, 
$like
);

366  
$¡r
;

369 
$¡r
 = 
	`»move_švisibË_ch¬aù”s
($str);

372 ià(
$like
 ==ğ
TRUE
) {

373 
$¡r
 = 
	`¡r_»¶aû
(
	`¬¿y
('%', '_', 
$this
->
_like_esÿ³_chr
),‡rray($this->_like_escape_chr . '%', $this->_like_escape_chr . '_', $this->_like_escape_chr . $this->_like_escape_chr), $str);

376  
$¡r
;

377 
	}
}

387 
public
 
funùiÚ
 
	$afãùed_rows
() {

388  @
	`oci_num_rows
(
$this
->
¡mt_id
);

389 
	}
}

399 
public
 
funùiÚ
 
š£¹_id
(
$tbl
 = "") {

401  
$this
->
di¥Ïy_”rÜ
('db_unsupported_function');

416 
public
 
funùiÚ
 
couÁ_®l
(
$bË
 = '') {

417 ià(
$bË
 == '') {

421 
	g$qu”y
 = 
$this
->
qu”y
($this->
_couÁ_¡ršg
 . $this->
_´Ùeù_id’tif›rs
('numrows'è. " FROM " . $this->_´Ùeù_id’tif›rs(
$bË
, 
TRUE
, 
NULL
, 
FALSE
));

423 ià(
	g$qu”y
 =ğ
FALSE
) {

427 
	g$row
 = 
$qu”y
->
row
();

428 
	g$this
->
_»£t_£Ëù
();

429  (è
	g$row
->
	gnumrows
;

443 
´Ùeùed
 
funùiÚ
 
	$_li¡_bËs
(
$´efix_lim™
 = 
FALSE
) {

444 
$sql
 = "SELECT TABLE_NAME FROM ALL_TABLES";

446 ià(
$´efix_lim™
 !=ğ
FALSE
 
AND
 
$this
->
db´efix
 != '') {

447 
$sql
 .ğ" WHERE TABLE_NAME LIKE '" . 
$this
->
	`esÿ³_like_¡r
($this->
db´efix
è. "%' " . 
	`¥rštf
($this->
_like_esÿ³_¡r
, $this->
_like_esÿ³_chr
);

450  
$sql
;

451 
	}
}

464 
´Ùeùed
 
funùiÚ
 
_li¡_cŞumns
(
$bË
 = '') {

479 
´Ùeùed
 
funùiÚ
 
	$_f›ld_d©a
(
$bË
) {

480  "SELECT * FROM " . 
$bË
 . " where„ownum = 1";

481 
	}
}

491 
´Ùeùed
 
funùiÚ
 
	$_”rÜ_mes§ge
() {

493 
$”rÜ
 = 
	`is_»sourû
(
$this
->
cÚn_id
è? 
	`oci_”rÜ
($this->conn_id) : oci_error();

494  
$”rÜ
['message'];

495 
	}
}

505 
´Ùeùed
 
funùiÚ
 
	$_”rÜ_numb”
() {

507 
$”rÜ
 = 
	`is_»sourû
(
$this
->
cÚn_id
è? 
	`oci_”rÜ
($this->conn_id) : oci_error();

508  
$”rÜ
['code'];

509 
	}
}

522 
´Ùeùed
 
funùiÚ
 
	$_esÿ³_id’tif›rs
(
$™em
) {

524 ià(
$this
->
_esÿ³_ch¬
 == '') {

525  
$™em
;

528 
	`fÜ—ch
 (
$this
->
_»£rved_id’tif›rs
 
as
 
$id
) {

529 ià(
	`¡½os
(
$™em
, '.' . 
$id
è!=ğ
FALSE
) {

530 
$¡r
 = 
$this
->
_esÿ³_ch¬
 . 
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬ . '.', 
$™em
);

533  
	`´eg_»¶aû
('/[' . 
$this
->
_esÿ³_ch¬
 . ']+/', $this->_esÿ³_ch¬, 
$¡r
);

538 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
) {

539 
$¡r
 = 
$this
->
_esÿ³_ch¬
 . 
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬ . '.' . $this->_esÿ³_ch¬, 
$™em
) . $this->_escape_char;

541 
$¡r
 = 
$this
->
_esÿ³_ch¬
 . 
$™em
 . $this->_escape_char;

544  
	`´eg_»¶aû
('/[' . 
$this
->
_esÿ³_ch¬
 . ']+/', $this->_esÿ³_ch¬, 
$¡r
);

545 
	}
}

559 
´Ùeùed
 
funùiÚ
 
	$_äom_bËs
(
$bËs
) {

560 ià(!
	`is_¬¿y
(
$bËs
)) {

561 
$bËs
 = 
	`¬¿y
($tables);

564  
	`im¶ode
(', ', 
$bËs
);

565 
	}
}

580 
´Ùeùed
 
funùiÚ
 
	$_š£¹
(
$bË
, 
$keys
, 
$v®ues
) {

581  "INSERT INTO " . 
$bË
 . " (" . 
	`im¶ode
(', ', 
$keys
è. "èVALUES (" . im¶ode(', ', 
$v®ues
) . ")";

582 
	}
}

597 
´Ùeùed
 
funùiÚ
 
	$_š£¹_b©ch
(
$bË
, 
$keys
, 
$v®ues
) {

598 
$keys
 = 
	`im¶ode
(', ', $keys);

599 
$sql
 = "INSERT ALL\n";

601 
$i
 = 0, 
$c
 = 
	`couÁ
(
$v®ues
); $i < $c; $i++) {

602 
$sql
 .ğ' INTO ' . 
$bË
 . ' (' . 
$keys
 . 'èVALUES ' . 
$v®ues
[
$i
] . "\n";

605 
$sql
 .= 'SELECT * FROM dual';

607  
$sql
;

608 
	}
}

625 
´Ùeùed
 
funùiÚ
 
_upd©e
(
$bË
, 
$v®ues
, 
$wh”e
, 
$Üd”by
 = 
¬¿y
(), 
$lim™
 = 
FALSE
) {

626 
fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
) {

627 
$v®¡r
[] = 
$key
 . " = " . 
$v®
;

630 
	g$lim™
 = (!
$lim™
) ? '' : ' LIMIT ' . $limit;

632 
	g$Üd”by
 = (
couÁ
(
$Üd”by
è>ğ1è? ' ORDER BY ' . 
im¶ode
(", ", $orderby) : '';

634 
	g$sql
 = "UPDATE " . 
$bË
 . " SET " . 
im¶ode
(', ', 
$v®¡r
);

636 
	g$sql
 .ğ(
$wh”e
 !ğ'' 
AND
 
couÁ
($wh”eè>ğ1è? " WHERE " . 
im¶ode
(" ", $where) : '';

638 
	g$sql
 .ğ
$Üd”by
 . 
$lim™
;

640  
	g$sql
;

656 
´Ùeùed
 
funùiÚ
 
	$_Œunÿ‹
(
$bË
) {

657  "TRUNCATE TABLE " . 
$bË
;

658 
	}
}

673 
´Ùeùed
 
funùiÚ
 
_d–‘e
(
$bË
, 
$wh”e
 = 
¬¿y
(), 
$like
 =‡¼ay(), 
$lim™
 = 
FALSE
) {

674 
$cÚd™iÚs
 = '';

676 ià(
couÁ
(
$wh”e
è> 0 
OR
 couÁ(
$like
) > 0) {

677 
	g$cÚd™iÚs
 = "\nWHERE ";

678 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$this
->
¬_wh”e
);

680 ià(
couÁ
(
$wh”e
è> 0 && couÁ(
$like
) > 0) {

681 
	g$cÚd™iÚs
 .= " AND ";

683 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$like
);

686 
	g$lim™
 = (!
$lim™
) ? '' : ' LIMIT ' . $limit;

688  "DELETE FROM " . 
	g$bË
 . 
	g$cÚd™iÚs
 . 
	g$lim™
;

704 
´Ùeùed
 
funùiÚ
 
	$_lim™
(
$sql
, 
$lim™
, 
$off£t
) {

705 
$lim™
 = 
$off£t
 + $limit;

706 
$Ãwsql
 = "SELECT * FROM (select inner_query.*,„ownum„num FROM ($sql) inner_query WHERE„ownum < $limit)";

708 ià(
$off£t
 != 0) {

709 
$Ãwsql
 .= " WHERE„num >= $offset";

713 
$this
->
lim™_u£d
 = 
TRUE
;

715  
$Ãwsql
;

716 
	}
}

727 
´Ùeùed
 
funùiÚ
 
	$_şo£
(
$cÚn_id
) {

728 @
	`oci_şo£
(
$cÚn_id
);

729 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/oci8/oci8_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_oci8_fÜge
 
ex‹nds
 
	mCI_DB_fÜge
 {

34 
funùiÚ
 
	$_ü—‹_d©aba£
(
$Çme
)

36  
FALSE
;

48 
funùiÚ
 
	$_drİ_d©aba£
(
$Çme
)

50  
FALSE
;

51 
	}
}

66 
funùiÚ
 
	$_ü—‹_bË
(
$bË
, 
$f›lds
, 
$´im¬y_keys
, 
$keys
, 
$if_nÙ_exi¡s
)

68 
$sql
 = 'CREATE TABLE ';

70 ià(
$if_nÙ_exi¡s
 ==ğ
TRUE
)

72 
$sql
 .= 'IF NOT EXISTS ';

75 
$sql
 .ğ
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
)." (";

76 
$cu¼’t_f›ld_couÁ
 = 0;

78 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
=>
$©Œibu‹s
)

83 ià(
	`is_num”ic
(
$f›ld
))

85 
$sql
 .= "\n\t$attributes";

89 
$©Œibu‹s
 = 
	`¬¿y_chªge_key_ÿ£
($©Œibu‹s, 
CASE_UPPER
);

91 
$sql
 .ğ"\n\t".
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$f›ld
);

93 
$sql
 .ğ' '.
$©Œibu‹s
['TYPE'];

95 ià(
	`¬¿y_key_exi¡s
('CONSTRAINT', 
$©Œibu‹s
))

97 
$sql
 .ğ'('.
$©Œibu‹s
['CONSTRAINT'].')';

100 ià(
	`¬¿y_key_exi¡s
('UNSIGNED', 
$©Œibu‹s
è&& $©Œibu‹s['UNSIGNED'] ==ğ
TRUE
)

102 
$sql
 .= ' UNSIGNED';

105 ià(
	`¬¿y_key_exi¡s
('DEFAULT', 
$©Œibu‹s
))

107 
$sql
 .ğ' DEFAULT \''.
$©Œibu‹s
['DEFAULT'].'\'';

110 ià(
	`¬¿y_key_exi¡s
('NULL', 
$©Œibu‹s
è&& $©Œibu‹s['NULL'] ==ğ
TRUE
)

112 
$sql
 .= ' NULL';

116 
$sql
 .= ' NOT NULL';

119 ià(
	`¬¿y_key_exi¡s
('AUTO_INCREMENT', 
$©Œibu‹s
è&& $©Œibu‹s['AUTO_INCREMENT'] ==ğ
TRUE
)

121 
$sql
 .= ' AUTO_INCREMENT';

126 ià(++
$cu¼’t_f›ld_couÁ
 < 
	`couÁ
(
$f›lds
))

128 
$sql
 .= ',';

132 ià(
	`couÁ
(
$´im¬y_keys
) > 0)

134 
$´im¬y_keys
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($primary_keys);

135 
$sql
 .ğ",\n\tPRIMARY KEY (" . 
	`im¶ode
(', ', 
$´im¬y_keys
) . ")";

138 ià(
	`is_¬¿y
(
$keys
è&& 
	`couÁ
($keys) > 0)

140 
	`fÜ—ch
 (
$keys
 
as
 
$key
)

142 ià(
	`is_¬¿y
(
$key
))

144 
$key
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key);

148 
$key
 = 
	`¬¿y
(
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key));

151 
$sql
 .ğ",\n\tUNIQUE COLUMNS (" . 
	`im¶ode
(', ', 
$key
) . ")";

155 
$sql
 .= "\n)";

157  
$sql
;

158 
	}
}

168 
funùiÚ
 
	$_drİ_bË
(
$bË
)

170  
FALSE
;

171 
	}
}

191 
funùiÚ
 
_®‹r_bË
(
$®‹r_ty³
, 
$bË
, 
$cŞumn_Çme
, 
$cŞumn_defš™iÚ
 = '', 
$deçuÉ_v®ue
 = '', 
$nuÎ
 = '', 
$aá”_f›ld
 = '')

193 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$bË
)." $®‹r_ty³ ".$this->db->_´Ùeù_id’tif›rs(
$cŞumn_Çme
);

196 ià(
	g$®‹r_ty³
 == 'DROP')

198  
$sql
;

201 
	g$sql
 .= " $column_definition";

203 ià(
	g$deçuÉ_v®ue
 != '')

205 
$sql
 .= " DEFAULT \"$default_value\"";

208 ià(
	g$nuÎ
 ==ğ
NULL
)

210 
$sql
 .= ' NULL';

214 
	g$sql
 .= ' NOT NULL';

217 ià(
	g$aá”_f›ld
 != '')

219 
$sql
 .ğ' AFTER ' . 
$this
->
db
->
_´Ùeù_id’tif›rs
(
$aá”_f›ld
);

222  
	g$sql
;

238 
funùiÚ
 
	$_»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

240 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
)." RENAME TO ".$this->db->_´Ùeù_id’tif›rs(
$Ãw_bË_Çme
);

241  
$sql
;

242 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/oci8/oci8_result.php

1 <?
php


3 ià(!
defšed
('BASEPATH'))

4 
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_DB_oci8_»suÉ
 
ex‹nds
 
	mCI_DB_»suÉ
 {

31 
public
 
	m$¡mt_id
;

32 
public
 
	m$curs_id
;

33 
public
 
	m$lim™_u£d
;

43 
public
 
funùiÚ
 
	$num_rows
() {

44 ià(
$this
->
num_rows
 ==ğ0 && 
	`couÁ
($this->
	`»suÉ_¬¿y
()) > 0) {

45 
$this
->
num_rows
 = 
	`couÁ
($this->
	`»suÉ_¬¿y
());

46 @
	`oci_execu‹
(
$this
->
¡mt_id
, 
OCI_DEFAULT
);

48 ià(
$this
->
curs_id
) {

49 @
	`oci_execu‹
(
$this
->
curs_id
, 
OCI_DEFAULT
);

53  
$this
->
num_rows
;

64 
public
 
funùiÚ
 
	$num_f›lds
() {

65 
$couÁ
 = @
	`oci_num_f›lds
(
$this
->
¡mt_id
);

68 ià(
$this
->
lim™_u£d
) {

69 
$couÁ
 = $count - 1;

72  
$couÁ
;

73 
	}
}

85 
public
 
funùiÚ
 
	$li¡_f›lds
() {

86 
$f›ld_Çmes
 = 
	`¬¿y
();

87 
$c
 = 1, 
$f›ldCouÁ
 = 
$this
->
	`num_f›lds
(); $c <= $fieldCount; $c++) {

88 
$f›ld_Çmes
[] = 
	`oci_f›ld_Çme
(
$this
->
¡mt_id
, 
$c
);

90  
$f›ld_Çmes
;

91 
	}
}

103 
public
 
funùiÚ
 
	$f›ld_d©a
() {

104 
$»tv®
 = 
	`¬¿y
();

105 
$c
 = 1, 
$f›ldCouÁ
 = 
$this
->
	`num_f›lds
(); $c <= $fieldCount; $c++) {

106 
$F
 = 
Ãw
 
	`¡dCÏss
();

107 
$F
->
Çme
 = 
	`oci_f›ld_Çme
(
$this
->
¡mt_id
, 
$c
);

108 
$F
->
ty³
 = 
	`oci_f›ld_ty³
(
$this
->
¡mt_id
, 
$c
);

109 
$F
->
max_Ëngth
 = 
	`oci_f›ld_size
(
$this
->
¡mt_id
, 
$c
);

111 
$»tv®
[] = 
$F
;

114  
$»tv®
;

115 
	}
}

124 
public
 
funùiÚ
 
	$ä“_»suÉ
() {

125 ià(
	`is_»sourû
(
$this
->
»suÉ_id
)) {

126 
	`oci_ä“_¡©em’t
(
$this
->
»suÉ_id
);

127 
$this
->
»suÉ_id
 = 
FALSE
;

129 
	}
}

141 
´Ùeùed
 
funùiÚ
 
	$_ãtch_assoc
() {

142 
$id
 = (
$this
->
curs_id
è? $this->curs_id : $this->
¡mt_id
;

143  @
	`oci_ãtch_assoc
(
$id
);

144 
	}
}

156 
´Ùeùed
 
funùiÚ
 
	$_ãtch_objeù
() {

157 
$id
 = (
$this
->
curs_id
è? $this->curs_id : $this->
¡mt_id
;

158  @
	`oci_ãtch_objeù
(
$id
);

159 
	}
}

169 
public
 
funùiÚ
 
	$»suÉ_¬¿y
() {

170 ià(
	`couÁ
(
$this
->
»suÉ_¬¿y
) > 0) {

171  
$this
->
»suÉ_¬¿y
;

174 
$row
 = 
NULL
;

175 
$row
 = 
$this
->
	`_ãtch_assoc
()) {

176 
$this
->
»suÉ_¬¿y
[] = 
$row
;

179  
$this
->
»suÉ_¬¿y
;

180 
	}
}

194 
´Ùeùed
 
funùiÚ
 
	$_d©a_£ek
(
$n
 = 0) {

195  
FALSE
;

196 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/oci8/oci8_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_oci8_ut™y
 
ex‹nds
 
	mCI_DB_ut™y
 {

33 
funùiÚ
 
	$_li¡_d©aba£s
()

35  
FALSE
;

49 
funùiÚ
 
	$_İtimize_bË
(
$bË
)

51  
FALSE
;

52 
	}
}

65 
funùiÚ
 
	$_»·œ_bË
(
$bË
)

67  
FALSE
;

68 
	}
}

79 
funùiÚ
 
_backup
(
$·¿ms
 = 
	$¬¿y
())

82  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

83 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/odbc/odbc_driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

31 şas 
	cCI_DB_odbc_driv”
 
ex‹nds
 
	mCI_DB
 {

33 
v¬
 
	m$dbdriv”
 = 'odbc';

36 
v¬
 
	m$_esÿ³_ch¬
 = '';

39 
v¬
 
	m$_like_esÿ³_¡r
 = " {escape '%s'} ";

40 
v¬
 
	m$_like_esÿ³_chr
 = '!';

47 
v¬
 
	m$_couÁ_¡ršg
 = "SELECT COUNT(*) AS ";

48 
v¬
 
	m$_¿ndom_keywÜd
;

51 
funùiÚ
 
	$__cÚ¡ruù
(
$·¿ms
)

53 
·»Á
::
	`__cÚ¡ruù
(
$·¿ms
);

55 
$this
->
_¿ndom_keywÜd
 = ' RND('.
	`time
().')';

64 
funùiÚ
 
	$db_cÚÃù
()

66  @
	`odbc_cÚÃù
(
$this
->
ho¡Çme
, $this->
u£ºame
, $this->
·sswÜd
);

67 
	}
}

77 
funùiÚ
 
	$db_pcÚÃù
()

79  @
	`odbc_pcÚÃù
(
$this
->
ho¡Çme
, $this->
u£ºame
, $this->
·sswÜd
);

80 
	}
}

93 
funùiÚ
 
	$»cÚÃù
()

96 
	}
}

106 
funùiÚ
 
	$db_£Ëù
()

109  
TRUE
;

110 
	}
}

122 
funùiÚ
 
	$db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
)

125  
TRUE
;

126 
	}
}

136 
funùiÚ
 
	$_v”siÚ
()

139 
	}
}

150 
funùiÚ
 
	$_execu‹
(
$sql
)

152 
$sql
 = 
$this
->
	`_´•_qu”y
($sql);

153  @
	`odbc_exec
(
$this
->
cÚn_id
, 
$sql
);

154 
	}
}

167 
funùiÚ
 
	$_´•_qu”y
(
$sql
)

169  
$sql
;

170 
	}
}

180 
funùiÚ
 
	$Œªs_begš
(
$‹¡_mode
 = 
FALSE
)

182 iàĞ! 
$this
->
Œªs_’abËd
)

184  
TRUE
;

188 ià(
$this
->
_Œªs_d•th
 > 0)

190  
TRUE
;

196 
$this
->
_Œªs_çu»
 = (
$‹¡_mode
 ==ğ
TRUE
è? TRUE : 
FALSE
;

198  
	`odbc_autocomm™
(
$this
->
cÚn_id
, 
FALSE
);

199 
	}
}

209 
funùiÚ
 
	$Œªs_comm™
()

211 iàĞ! 
$this
->
Œªs_’abËd
)

213  
TRUE
;

217 ià(
$this
->
_Œªs_d•th
 > 0)

219  
TRUE
;

222 
$»t
 = 
	`odbc_comm™
(
$this
->
cÚn_id
);

223 
	`odbc_autocomm™
(
$this
->
cÚn_id
, 
TRUE
);

224  
$»t
;

225 
	}
}

235 
funùiÚ
 
	$Œªs_rŞlback
()

237 iàĞ! 
$this
->
Œªs_’abËd
)

239  
TRUE
;

243 ià(
$this
->
_Œªs_d•th
 > 0)

245  
TRUE
;

248 
$»t
 = 
	`odbc_rŞlback
(
$this
->
cÚn_id
);

249 
	`odbc_autocomm™
(
$this
->
cÚn_id
, 
TRUE
);

250  
$»t
;

251 
	}
}

263 
funùiÚ
 
	$esÿ³_¡r
(
$¡r
, 
$like
 = 
FALSE
)

265 ià(
	`is_¬¿y
(
$¡r
))

267 
	`fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

269 
$¡r
[
$key
] = 
$this
->
	`esÿ³_¡r
(
$v®
, 
$like
);

272  
$¡r
;

276 
$¡r
 = 
	`»move_švisibË_ch¬aù”s
($str);

279 ià(
$like
 ==ğ
TRUE
)

281 
$¡r
 = 
	`¡r_»¶aû
Ğ
	`¬¿y
('%', '_', 
$this
->
_like_esÿ³_chr
),

282 
	`¬¿y
(
$this
->
_like_esÿ³_chr
.'%', $this->_like_escape_chr.'_', $this->_like_escape_chr.$this->_like_escape_chr),

283 
$¡r
);

286  
$¡r
;

287 
	}
}

297 
funùiÚ
 
	$afãùed_rows
()

299  @
	`odbc_num_rows
(
$this
->
cÚn_id
);

300 
	}
}

310 
funùiÚ
 
	$š£¹_id
()

312  @
	`odbc_š£¹_id
(
$this
->
cÚn_id
);

313 
	}
}

327 
funùiÚ
 
couÁ_®l
(
$bË
 = '')

329 ià(
$bË
 == '')

334 
	g$qu”y
 = 
$this
->
qu”y
($this->
_couÁ_¡ršg
 . $this->
_´Ùeù_id’tif›rs
('numrows'è. " FROM " . $this->_´Ùeù_id’tif›rs(
$bË
, 
TRUE
, 
NULL
, 
FALSE
));

336 ià(
	g$qu”y
->
num_rows
() == 0)

341 
	g$row
 = 
$qu”y
->
row
();

342 
	g$this
->
_»£t_£Ëù
();

343  (è
	g$row
->
	gnumrows
;

357 
funùiÚ
 
	$_li¡_bËs
(
$´efix_lim™
 = 
FALSE
)

359 
$sql
 = "SHOW TABLES FROM `".
$this
->
d©aba£
."`";

361 ià(
$´efix_lim™
 !=ğ
FALSE
 
AND
 
$this
->
db´efix
 != '')

364  
FALSE
;

367  
$sql
;

368 
	}
}

381 
funùiÚ
 
_li¡_cŞumns
(
$bË
 = '')

383  "SHOW COLUMNS FROM ".
$bË
;

397 
funùiÚ
 
	$_f›ld_d©a
(
$bË
)

399  "SELECT TOP 1 FROM ".
$bË
;

400 
	}
}

410 
funùiÚ
 
	$_”rÜ_mes§ge
()

412  
	`odbc_”rÜmsg
(
$this
->
cÚn_id
);

413 
	}
}

423 
funùiÚ
 
	$_”rÜ_numb”
()

425  
	`odbc_”rÜ
(
$this
->
cÚn_id
);

426 
	}
}

439 
funùiÚ
 
	$_esÿ³_id’tif›rs
(
$™em
)

441 ià(
$this
->
_esÿ³_ch¬
 == '')

443  
$™em
;

446 
	`fÜ—ch
 (
$this
->
_»£rved_id’tif›rs
 
as
 
$id
)

448 ià(
	`¡½os
(
$™em
, '.'.
$id
è!=ğ
FALSE
)

450 
$¡r
 = 
$this
->
_esÿ³_ch¬
. 
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.', 
$™em
);

453  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

457 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
)

459 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.'.$this->_esÿ³_ch¬, 
$™em
).$this->_escape_char;

463 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
$™em
.$this->_escape_char;

467  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

468 
	}
}

482 
funùiÚ
 
	$_äom_bËs
(
$bËs
)

484 iàĞ! 
	`is_¬¿y
(
$bËs
))

486 
$bËs
 = 
	`¬¿y
($tables);

489  '('.
	`im¶ode
(', ', 
$bËs
).')';

490 
	}
}

505 
funùiÚ
 
	$_š£¹
(
$bË
, 
$keys
, 
$v®ues
)

507  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES (".im¶ode(', ', 
$v®ues
).")";

508 
	}
}

525 
funùiÚ
 
_upd©e
(
$bË
, 
$v®ues
, 
$wh”e
, 
$Üd”by
 = 
¬¿y
(), 
$lim™
 = 
FALSE
)

527 
fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

529 
$v®¡r
[] = 
$key
." = ".
$v®
;

532 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

534 
	g$Üd”by
 = (
couÁ
(
$Üd”by
è>ğ1)?' ORDER BY '.
im¶ode
(", ", $orderby):'';

536 
	g$sql
 = "UPDATE ".
$bË
." SET ".
im¶ode
(', ', 
$v®¡r
);

538 
	g$sql
 .ğ(
$wh”e
 !ğ'' 
AND
 
couÁ
($wh”eè>=1è? " WHERE ".
im¶ode
(" ", $where) : '';

540 
	g$sql
 .ğ
$Üd”by
.
$lim™
;

542  
	g$sql
;

559 
funùiÚ
 
	$_Œunÿ‹
(
$bË
)

561  
$this
->
	`_d–‘e
(
$bË
);

562 
	}
}

577 
funùiÚ
 
_d–‘e
(
$bË
, 
$wh”e
 = 
¬¿y
(), 
$like
 =‡¼ay(), 
$lim™
 = 
FALSE
)

579 
$cÚd™iÚs
 = '';

581 ià(
couÁ
(
$wh”e
è> 0 
OR
 couÁ(
$like
) > 0)

583 
	g$cÚd™iÚs
 = "\nWHERE ";

584 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$this
->
¬_wh”e
);

586 ià(
couÁ
(
$wh”e
è> 0 && couÁ(
$like
) > 0)

588 
	g$cÚd™iÚs
 .= " AND ";

590 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$like
);

593 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

595  "DELETE FROM ".
	g$bË
.
	g$cÚd™iÚs
.
	g$lim™
;

611 
funùiÚ
 
	$_lim™
(
$sql
, 
$lim™
, 
$off£t
)

614  
$sql
;

615 
	}
}

626 
funùiÚ
 
	$_şo£
(
$cÚn_id
)

628 @
	`odbc_şo£
(
$cÚn_id
);

629 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/odbc/odbc_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_odbc_fÜge
 
ex‹nds
 
	mCI_DB_fÜge
 {

34 
funùiÚ
 
	$_ü—‹_d©aba£
()

38 ià(
$this
->
db
->
db_debug
)

40  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

42  
FALSE
;

54 
funùiÚ
 
	$_drİ_d©aba£
(
$Çme
)

58 ià(
$this
->
db
->
db_debug
)

60  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

62  
FALSE
;

63 
	}
}

78 
funùiÚ
 
	$_ü—‹_bË
(
$bË
, 
$f›lds
, 
$´im¬y_keys
, 
$keys
, 
$if_nÙ_exi¡s
)

80 
$sql
 = 'CREATE TABLE ';

82 ià(
$if_nÙ_exi¡s
 ==ğ
TRUE
)

84 
$sql
 .= 'IF NOT EXISTS ';

87 
$sql
 .ğ
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
)." (";

88 
$cu¼’t_f›ld_couÁ
 = 0;

90 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
=>
$©Œibu‹s
)

95 ià(
	`is_num”ic
(
$f›ld
))

97 
$sql
 .= "\n\t$attributes";

101 
$©Œibu‹s
 = 
	`¬¿y_chªge_key_ÿ£
($©Œibu‹s, 
CASE_UPPER
);

103 
$sql
 .ğ"\n\t".
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$f›ld
);

105 
$sql
 .ğ' '.
$©Œibu‹s
['TYPE'];

107 ià(
	`¬¿y_key_exi¡s
('CONSTRAINT', 
$©Œibu‹s
))

109 
$sql
 .ğ'('.
$©Œibu‹s
['CONSTRAINT'].')';

112 ià(
	`¬¿y_key_exi¡s
('UNSIGNED', 
$©Œibu‹s
è&& $©Œibu‹s['UNSIGNED'] ==ğ
TRUE
)

114 
$sql
 .= ' UNSIGNED';

117 ià(
	`¬¿y_key_exi¡s
('DEFAULT', 
$©Œibu‹s
))

119 
$sql
 .ğ' DEFAULT \''.
$©Œibu‹s
['DEFAULT'].'\'';

122 ià(
	`¬¿y_key_exi¡s
('NULL', 
$©Œibu‹s
è&& $©Œibu‹s['NULL'] ==ğ
TRUE
)

124 
$sql
 .= ' NULL';

128 
$sql
 .= ' NOT NULL';

131 ià(
	`¬¿y_key_exi¡s
('AUTO_INCREMENT', 
$©Œibu‹s
è&& $©Œibu‹s['AUTO_INCREMENT'] ==ğ
TRUE
)

133 
$sql
 .= ' AUTO_INCREMENT';

138 ià(++
$cu¼’t_f›ld_couÁ
 < 
	`couÁ
(
$f›lds
))

140 
$sql
 .= ',';

144 ià(
	`couÁ
(
$´im¬y_keys
) > 0)

146 
$´im¬y_keys
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($primary_keys);

147 
$sql
 .ğ",\n\tPRIMARY KEY (" . 
	`im¶ode
(', ', 
$´im¬y_keys
) . ")";

150 ià(
	`is_¬¿y
(
$keys
è&& 
	`couÁ
($keys) > 0)

152 
	`fÜ—ch
 (
$keys
 
as
 
$key
)

154 ià(
	`is_¬¿y
(
$key
))

156 
$key
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key);

160 
$key
 = 
	`¬¿y
(
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key));

163 
$sql
 .ğ",\n\tFOREIGN KEY (" . 
	`im¶ode
(', ', 
$key
) . ")";

167 
$sql
 .= "\n)";

169  
$sql
;

170 
	}
}

180 
funùiÚ
 
	$_drİ_bË
(
$bË
)

183 ià(
$this
->
db
->
db_debug
)

185  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

187  
FALSE
;

188 
	}
}

208 
funùiÚ
 
_®‹r_bË
(
$®‹r_ty³
, 
$bË
, 
$cŞumn_Çme
, 
$cŞumn_defš™iÚ
 = '', 
$deçuÉ_v®ue
 = '', 
$nuÎ
 = '', 
$aá”_f›ld
 = '')

210 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$bË
)." $®‹r_ty³ ".$this->db->_´Ùeù_id’tif›rs(
$cŞumn_Çme
);

213 ià(
	g$®‹r_ty³
 == 'DROP')

215  
$sql
;

218 
	g$sql
 .= " $column_definition";

220 ià(
	g$deçuÉ_v®ue
 != '')

222 
$sql
 .= " DEFAULT \"$default_value\"";

225 ià(
	g$nuÎ
 ==ğ
NULL
)

227 
$sql
 .= ' NULL';

231 
	g$sql
 .= ' NOT NULL';

234 ià(
	g$aá”_f›ld
 != '')

236 
$sql
 .ğ' AFTER ' . 
$this
->
db
->
_´Ùeù_id’tif›rs
(
$aá”_f›ld
);

239  
	g$sql
;

256 
funùiÚ
 
	$_»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

258 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
)." RENAME TO ".$this->db->_´Ùeù_id’tif›rs(
$Ãw_bË_Çme
);

259  
$sql
;

260 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/odbc/odbc_result.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_DB_odbc_»suÉ
 
ex‹nds
 
	mCI_DB_»suÉ
 {

35 
funùiÚ
 
	$num_rows
()

37  @
	`odbc_num_rows
(
$this
->
»suÉ_id
);

48 
funùiÚ
 
	$num_f›lds
()

50  @
	`odbc_num_f›lds
(
$this
->
»suÉ_id
);

51 
	}
}

63 
funùiÚ
 
	$li¡_f›lds
()

65 
$f›ld_Çmes
 = 
	`¬¿y
();

66 
$i
 = 0; $˜< 
$this
->
	`num_f›lds
(); $i++)

68 
$f›ld_Çmes
[] = 
	`odbc_f›ld_Çme
(
$this
->
»suÉ_id
, 
$i
);

71  
$f›ld_Çmes
;

72 
	}
}

84 
funùiÚ
 
	$f›ld_d©a
()

86 
$»tv®
 = 
	`¬¿y
();

87 
$i
 = 0; $˜< 
$this
->
	`num_f›lds
(); $i++)

89 
$F
 = 
Ãw
 
	`¡dCÏss
();

90 
$F
->
Çme
 = 
	`odbc_f›ld_Çme
(
$this
->
»suÉ_id
, 
$i
);

91 
$F
->
ty³
 = 
	`odbc_f›ld_ty³
(
$this
->
»suÉ_id
, 
$i
);

92 
$F
->
max_Ëngth
 = 
	`odbc_f›ld_Ën
(
$this
->
»suÉ_id
, 
$i
);

93 
$F
->
´im¬y_key
 = 0;

94 
$F
-> = '';

96 
$»tv®
[] = 
$F
;

99  
$»tv®
;

100 
	}
}

109 
funùiÚ
 
	$ä“_»suÉ
()

111 ià(
	`is_»sourû
(
$this
->
»suÉ_id
))

113 
	`odbc_ä“_»suÉ
(
$this
->
»suÉ_id
);

114 
$this
->
»suÉ_id
 = 
FALSE
;

116 
	}
}

130 
funùiÚ
 
	$_d©a_£ek
(
$n
 = 0)

132  
FALSE
;

133 
	}
}

145 
funùiÚ
 
	$_ãtch_assoc
()

147 ià(
	`funùiÚ_exi¡s
('odbc_fetch_object'))

149  
	`odbc_ãtch_¬¿y
(
$this
->
»suÉ_id
);

153  
$this
->
	`_odbc_ãtch_¬¿y
($this->
»suÉ_id
);

155 
	}
}

167 
funùiÚ
 
	$_ãtch_objeù
()

169 ià(
	`funùiÚ_exi¡s
('odbc_fetch_object'))

171  
	`odbc_ãtch_objeù
(
$this
->
»suÉ_id
);

175  
$this
->
	`_odbc_ãtch_objeù
($this->
»suÉ_id
);

177 
	}
}

189 
funùiÚ
 
	$_odbc_ãtch_objeù
(& 
$odbc_»suÉ
) {

190 
$rs
 = 
	`¬¿y
();

191 
$rs_obj
 = 
FALSE
;

192 ià(
	`odbc_ãtch_što
(
$odbc_»suÉ
, 
$rs
)) {

193 
	`fÜ—ch
 (
$rs
 
as
 
$k
=>
$v
) {

194 
$f›ld_Çme
ğ
	`odbc_f›ld_Çme
(
$odbc_»suÉ
, 
$k
+1);

195 
$rs_obj
->
$f›ld_Çme
 = 
$v
;

198  
$rs_obj
;

199 
	}
}

211 
funùiÚ
 
	$_odbc_ãtch_¬¿y
(& 
$odbc_»suÉ
) {

212 
$rs
 = 
	`¬¿y
();

213 
$rs_assoc
 = 
FALSE
;

214 ià(
	`odbc_ãtch_što
(
$odbc_»suÉ
, 
$rs
)) {

215 
$rs_assoc
=
	`¬¿y
();

216 
	`fÜ—ch
 (
$rs
 
as
 
$k
=>
$v
) {

217 
$f›ld_Çme
ğ
	`odbc_f›ld_Çme
(
$odbc_»suÉ
, 
$k
+1);

218 
$rs_assoc
[
$f›ld_Çme
] = 
$v
;

221  
$rs_assoc
;

222 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/odbc/odbc_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_odbc_ut™y
 
ex‹nds
 
	mCI_DB_ut™y
 {

33 
funùiÚ
 
	$_li¡_d©aba£s
()

36 ià(
$this
->
db
->
db_debug
)

38  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

40  
FALSE
;

54 
funùiÚ
 
	$_İtimize_bË
(
$bË
)

57 ià(
$this
->
db
->
db_debug
)

59  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

61  
FALSE
;

62 
	}
}

75 
funùiÚ
 
	$_»·œ_bË
(
$bË
)

78 ià(
$this
->
db
->
db_debug
)

80  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

82  
FALSE
;

83 
	}
}

94 
funùiÚ
 
_backup
(
$·¿ms
 = 
	$¬¿y
())

97  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

98 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/pdo/pdo_driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

31 şas 
	cCI_DB_pdo_driv”
 
ex‹nds
 
	mCI_DB
 {

33 
v¬
 
	m$dbdriv”
 = 'pdo';

36 
v¬
 
	m$_esÿ³_ch¬
 = '';

37 
v¬
 
	m$_like_esÿ³_¡r
;

38 
v¬
 
	m$_like_esÿ³_chr
;

46 
v¬
 
	m$_couÁ_¡ršg
 = "SELECT COUNT(*) AS ";

47 
v¬
 
	m$_¿ndom_keywÜd
;

49 
v¬
 
	m$İtiÚs
 = 
¬¿y
();

51 
funùiÚ
 
	$__cÚ¡ruù
(
$·¿ms
)

53 
·»Á
::
	`__cÚ¡ruù
(
$·¿ms
);

56 ià(
	`¡½os
(
$this
->
ho¡Çme
, 'mysql'è!=ğ
FALSE
)

58 
$this
->
_like_esÿ³_¡r
 = '';

59 
$this
->
_like_esÿ³_chr
 = '';

62 if(
	`is_php
('5.3.6'))

64 
$this
->
ho¡Çme
 .= ";charset={$this->char_set}";

68 
$this
->
İtiÚs
['PDO::MYSQL_ATTR_INIT_COMMAND'] = "SET NAMES {$this->char_set}";

70 
	`–£if
 (
	`¡½os
(
$this
->
ho¡Çme
, 'odbc'è!=ğ
FALSE
)

72 
$this
->
_like_esÿ³_¡r
 = " {escape '%s'} ";

73 
$this
->
_like_esÿ³_chr
 = '!';

77 
$this
->
_like_esÿ³_¡r
 = " ESCAPE '%s' ";

78 
$this
->
_like_esÿ³_chr
 = '!';

81 
	`em±y
(
$this
->
d©aba£
è
OR
 $this->
ho¡Çme
 .= ';dbname='.$this->database;

83 
$this
->
Œªs_’abËd
 = 
FALSE
;

85 
$this
->
_¿ndom_keywÜd
 = ' RND('.
	`time
().')';

94 
funùiÚ
 
	$db_cÚÃù
()

96 
$this
->
İtiÚs
['PDO::ATTR_ERRMODE'] = 
PDO
::
ERRMODE_SILENT
;

98  
Ãw
 
	`PDO
(
$this
->
ho¡Çme
, $this->
u£ºame
, $this->
·sswÜd
, $this->
İtiÚs
);

99 
	}
}

109 
funùiÚ
 
	$db_pcÚÃù
()

111 
$this
->
İtiÚs
['PDO::ATTR_ERRMODE'] = 
PDO
::
ERRMODE_SILENT
;

112 
$this
->
İtiÚs
['PDO::ATTR_PERSISTENT'] = 
TRUE
;

114  
Ãw
 
	`PDO
(
$this
->
ho¡Çme
, $this->
u£ºame
, $this->
·sswÜd
, $this->
İtiÚs
);

115 
	}
}

128 
funùiÚ
 
	$»cÚÃù
()

130 ià(
$this
->
db
->
db_debug
)

132  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

134  
FALSE
;

135 
	}
}

145 
funùiÚ
 
	$db_£Ëù
()

148  
TRUE
;

149 
	}
}

161 
funùiÚ
 
	$db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
)

164  
TRUE
;

165 
	}
}

175 
funùiÚ
 
	$_v”siÚ
()

177  
$this
->
cÚn_id
->
	`g‘A‰ribu‹
(
PDO
::
ATTR_CLIENT_VERSION
);

178 
	}
}

189 
funùiÚ
 
	$_execu‹
(
$sql
)

191 
$sql
 = 
$this
->
	`_´•_qu”y
($sql);

192 
$»suÉ_id
 = 
$this
->
cÚn_id
->
	`´•¬e
(
$sql
);

194 ià(
	`is_objeù
(
$»suÉ_id
è&& (
$»suÉ
 = $»suÉ_id->
	`execu‹
()))

196 ià(
	`is_num”ic
(
	`¡ros
(
$sql
, 'SELECT')))

198 
$this
->
afãù_rows
 = 
	`couÁ
(
$»suÉ_id
->
	`ãtchAÎ
());

202 
$this
->
afãù_rows
 = 
$»suÉ_id
->
	`rowCouÁ
();

207 
$this
->
afãù_rows
 = 0;

208 
$»suÉ
 = 
FALSE
;

211  
$»suÉ
;

212 
	}
}

225 
funùiÚ
 
	$_´•_qu”y
(
$sql
)

227  
$sql
;

228 
	}
}

238 
funùiÚ
 
	$Œªs_begš
(
$‹¡_mode
 = 
FALSE
)

240 iàĞ! 
$this
->
Œªs_’abËd
)

242  
TRUE
;

246 ià(
$this
->
_Œªs_d•th
 > 0)

248  
TRUE
;

254 
$this
->
_Œªs_çu»
 = (
boŞ
è(
$‹¡_mode
 ==ğ
TRUE
);

256  
$this
->
cÚn_id
->
	`begšT¿n§ùiÚ
();

257 
	}
}

267 
funùiÚ
 
	$Œªs_comm™
()

269 iàĞ! 
$this
->
Œªs_’abËd
)

271  
TRUE
;

275 ià(
$this
->
_Œªs_d•th
 > 0)

277  
TRUE
;

280 
$»t
 = 
$this
->
cÚn
->
	`comm™
();

281  
$»t
;

282 
	}
}

292 
funùiÚ
 
	$Œªs_rŞlback
()

294 iàĞ! 
$this
->
Œªs_’abËd
)

296  
TRUE
;

300 ià(
$this
->
_Œªs_d•th
 > 0)

302  
TRUE
;

305 
$»t
 = 
$this
->
cÚn_id
->
	`rŞlBack
();

306  
$»t
;

307 
	}
}

319 
funùiÚ
 
	$esÿ³_¡r
(
$¡r
, 
$like
 = 
FALSE
)

321 ià(
	`is_¬¿y
(
$¡r
))

323 
	`fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

325 
$¡r
[
$key
] = 
$this
->
	`esÿ³_¡r
(
$v®
, 
$like
);

328  
$¡r
;

332 
$¡r
 = 
$this
->
cÚn_id
->
	`quÙe
($str);

335 ià(
	`¡½os
(
$¡r
, "'") === 0)

337 
$¡r
 = 
	`sub¡r
($str, 1, -1);

341 ià(
$like
 ==ğ
TRUE
)

343 
$¡r
 = 
	`¡r_»¶aû
Ğ
	`¬¿y
('%', '_', 
$this
->
_like_esÿ³_chr
),

344 
	`¬¿y
(
$this
->
_like_esÿ³_chr
.'%', $this->_like_escape_chr.'_', $this->_like_escape_chr.$this->_like_escape_chr),

345 
$¡r
);

348  
$¡r
;

349 
	}
}

359 
funùiÚ
 
	$afãùed_rows
()

361  
$this
->
afãù_rows
;

362 
	}
}

372 
funùiÚ
 
	$š£¹_id
(
$Çme
=
NULL
)

375 ià(
	`¡½os
(
$this
->
ho¡Çme
, 'pgsql'è!=ğ
FALSE
)

377 
$v
 = 
$this
->
	`_v”siÚ
();

379 
$bË
 = 
	`func_num_¬gs
(è> 0 ? 
	`func_g‘_¬g
(0è: 
NULL
;

381 ià(
$bË
 =ğ
NULL
 && 
$v
 >= '8.1')

383 
$sql
='SELECT LASTVAL()‡s ins_id';

385 
$qu”y
 = 
$this
->
	`qu”y
(
$sql
);

386 
$row
 = 
$qu”y
->
	`row
();

387  
$row
->
šs_id
;

391  
$this
->
cÚn_id
->
	`Ï¡In£¹Id
(
$Çme
);

393 
	}
}

407 
funùiÚ
 
couÁ_®l
(
$bË
 = '')

409 ià(
$bË
 == '')

414 
	g$qu”y
 = 
$this
->
qu”y
($this->
_couÁ_¡ršg
 . $this->
_´Ùeù_id’tif›rs
('numrows'è. " FROM " . $this->_´Ùeù_id’tif›rs(
$bË
, 
TRUE
, 
NULL
, 
FALSE
));

416 ià(
	g$qu”y
->
num_rows
() == 0)

421 
	g$row
 = 
$qu”y
->
row
();

422 
	g$this
->
_»£t_£Ëù
();

423  (è
	g$row
->
	gnumrows
;

437 
funùiÚ
 
	$_li¡_bËs
(
$´efix_lim™
 = 
FALSE
)

439 
$sql
 = "SHOW TABLES FROM `".
$this
->
d©aba£
."`";

441 ià(
$´efix_lim™
 !=ğ
FALSE
 
AND
 
$this
->
db´efix
 != '')

444  
FALSE
;

447  
$sql
;

448 
	}
}

461 
funùiÚ
 
_li¡_cŞumns
(
$bË
 = '')

463  "SHOW COLUMNS FROM ".
$bË
;

477 
funùiÚ
 
	$_f›ld_d©a
(
$bË
)

479  "SELECT TOP 1 FROM ".
$bË
;

480 
	}
}

490 
funùiÚ
 
	$_”rÜ_mes§ge
()

492 
$”rÜ_¬¿y
 = 
$this
->
cÚn_id
->
	`”rÜInfo
();

493  
$”rÜ_¬¿y
[2];

494 
	}
}

504 
funùiÚ
 
	$_”rÜ_numb”
()

506  
$this
->
cÚn_id
->
	`”rÜCode
();

507 
	}
}

520 
funùiÚ
 
	$_esÿ³_id’tif›rs
(
$™em
)

522 ià(
$this
->
_esÿ³_ch¬
 == '')

524  
$™em
;

527 
	`fÜ—ch
 (
$this
->
_»£rved_id’tif›rs
 
as
 
$id
)

529 ià(
	`¡½os
(
$™em
, '.'.
$id
è!=ğ
FALSE
)

531 
$¡r
 = 
$this
->
_esÿ³_ch¬
. 
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.', 
$™em
);

534  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

538 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
)

540 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.'.$this->_esÿ³_ch¬, 
$™em
).$this->_escape_char;

545 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
$™em
.$this->_escape_char;

549  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

550 
	}
}

564 
funùiÚ
 
	$_äom_bËs
(
$bËs
)

566 iàĞ! 
	`is_¬¿y
(
$bËs
))

568 
$bËs
 = 
	`¬¿y
($tables);

571  (
	`couÁ
(
$bËs
è=ğ1è? $bËs[0] : '('.
	`im¶ode
(', ', $tables).')';

572 
	}
}

587 
funùiÚ
 
	$_š£¹
(
$bË
, 
$keys
, 
$v®ues
)

589  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES (".im¶ode(', ', 
$v®ues
).")";

590 
	}
}

605 
funùiÚ
 
	$_š£¹_b©ch
(
$bË
, 
$keys
, 
$v®ues
)

607  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES ".im¶ode(', ', 
$v®ues
);

608 
	}
}

625 
funùiÚ
 
_upd©e
(
$bË
, 
$v®ues
, 
$wh”e
, 
$Üd”by
 = 
¬¿y
(), 
$lim™
 = 
FALSE
)

627 
fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

629 
$v®¡r
[] = 
$key
." = ".
$v®
;

632 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

634 
	g$Üd”by
 = (
couÁ
(
$Üd”by
è>ğ1)?' ORDER BY '.
im¶ode
(", ", $orderby):'';

636 
	g$sql
 = "UPDATE ".
$bË
." SET ".
im¶ode
(', ', 
$v®¡r
);

638 
	g$sql
 .ğ(
$wh”e
 !ğ'' 
AND
 
couÁ
($wh”eè>=1è? " WHERE ".
im¶ode
(" ", $where) : '';

640 
	g$sql
 .ğ
$Üd”by
.
$lim™
;

642  
	g$sql
;

658 
funùiÚ
 
	$_upd©e_b©ch
(
$bË
, 
$v®ues
, 
$šdex
, 
$wh”e
 = 
NULL
)

660 
$ids
 = 
	`¬¿y
();

661 
$wh”e
 = ($wh”!ğ'' 
AND
 
	`couÁ
($wh”eè>=1è? 
	`im¶ode
(" ", $where).' AND ' : '';

663 
	`fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

665 
$ids
[] = 
$v®
[
$šdex
];

667 
	`fÜ—ch
 (
	`¬¿y_keys
(
$v®
è
as
 
$f›ld
)

669 ià(
$f›ld
 !ğ
$šdex
)

671 
$fš®
[
$f›ld
][] = 'WHEN '.
$šdex
.' = '.
$v®
[$index].' THEN '.$val[$field];

676 
$sql
 = "UPDATE ".
$bË
." SET ";

677 
$ÿ£s
 = '';

679 
	`fÜ—ch
 (
$fš®
 
as
 
$k
 => 
$v
)

681 
$ÿ£s
 .ğ
$k
.' = CASE '."\n";

682 
	`fÜ—ch
 (
$v
 
as
 
$row
)

684 
$ÿ£s
 .ğ
$row
."\n";

687 
$ÿ£s
 .ğ'ELSE '.
$k
.' END, ';

690 
$sql
 .ğ
	`sub¡r
(
$ÿ£s
, 0, -2);

692 
$sql
 .ğ' WHERE '.
$wh”e
.
$šdex
.' IN ('.
	`im¶ode
(',', 
$ids
).')';

694  
$sql
;

695 
	}
}

711 
funùiÚ
 
	$_Œunÿ‹
(
$bË
)

713  
$this
->
	`_d–‘e
(
$bË
);

714 
	}
}

729 
funùiÚ
 
_d–‘e
(
$bË
, 
$wh”e
 = 
¬¿y
(), 
$like
 =‡¼ay(), 
$lim™
 = 
FALSE
)

731 
$cÚd™iÚs
 = '';

733 ià(
couÁ
(
$wh”e
è> 0 
OR
 couÁ(
$like
) > 0)

735 
	g$cÚd™iÚs
 = "\nWHERE ";

736 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$this
->
¬_wh”e
);

738 ià(
couÁ
(
$wh”e
è> 0 && couÁ(
$like
) > 0)

740 
	g$cÚd™iÚs
 .= " AND ";

742 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$like
);

745 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

747  "DELETE FROM ".
	g$bË
.
	g$cÚd™iÚs
.
	g$lim™
;

763 
funùiÚ
 
	$_lim™
(
$sql
, 
$lim™
, 
$off£t
)

765 ià(
	`¡½os
(
$this
->
ho¡Çme
, 'cubrid'è!=ğ
FALSE
 || strpos($this->hostname, 'sqlite') !== FALSE)

767 ià(
$off£t
 == 0)

769 
$off£t
 = '';

773 
$off£t
 .= ", ";

776  
$sql
."LIMIT ".
$off£t
.
$lim™
;

780 
$sql
 .ğ"LIMIT ".
$lim™
;

782 ià(
$off£t
 > 0)

784 
$sql
 .ğ" OFFSET ".
$off£t
;

787  
$sql
;

789 
	}
}

800 
funùiÚ
 
	$_şo£
(
$cÚn_id
)

802 
$this
->
cÚn_id
 = 
nuÎ
;

803 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/pdo/pdo_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_pdo_fÜge
 
ex‹nds
 
	mCI_DB_fÜge
 {

34 
funùiÚ
 
	$_ü—‹_d©aba£
()

38 ià(
$this
->
db
->
db_debug
)

40  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

42  
FALSE
;

54 
funùiÚ
 
	$_drİ_d©aba£
(
$Çme
)

58 ià(
$this
->
db
->
db_debug
)

60  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

62  
FALSE
;

63 
	}
}

78 
funùiÚ
 
	$_ü—‹_bË
(
$bË
, 
$f›lds
, 
$´im¬y_keys
, 
$keys
, 
$if_nÙ_exi¡s
)

80 
$sql
 = 'CREATE TABLE ';

82 ià(
$if_nÙ_exi¡s
 ==ğ
TRUE
)

84 
$sql
 .= 'IF NOT EXISTS ';

87 
$sql
 .ğ
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
)." (";

88 
$cu¼’t_f›ld_couÁ
 = 0;

90 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
=>
$©Œibu‹s
)

95 ià(
	`is_num”ic
(
$f›ld
))

97 
$sql
 .= "\n\t$attributes";

101 
$©Œibu‹s
 = 
	`¬¿y_chªge_key_ÿ£
($©Œibu‹s, 
CASE_UPPER
);

103 
$sql
 .ğ"\n\t".
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$f›ld
);

105 
$sql
 .ğ' '.
$©Œibu‹s
['TYPE'];

107 ià(
	`¬¿y_key_exi¡s
('CONSTRAINT', 
$©Œibu‹s
))

109 
$sql
 .ğ'('.
$©Œibu‹s
['CONSTRAINT'].')';

112 ià(
	`¬¿y_key_exi¡s
('UNSIGNED', 
$©Œibu‹s
è&& $©Œibu‹s['UNSIGNED'] ==ğ
TRUE
)

114 
$sql
 .= ' UNSIGNED';

117 ià(
	`¬¿y_key_exi¡s
('DEFAULT', 
$©Œibu‹s
))

119 
$sql
 .ğ' DEFAULT \''.
$©Œibu‹s
['DEFAULT'].'\'';

122 ià(
	`¬¿y_key_exi¡s
('NULL', 
$©Œibu‹s
è&& $©Œibu‹s['NULL'] ==ğ
TRUE
)

124 
$sql
 .= ' NULL';

128 
$sql
 .= ' NOT NULL';

131 ià(
	`¬¿y_key_exi¡s
('AUTO_INCREMENT', 
$©Œibu‹s
è&& $©Œibu‹s['AUTO_INCREMENT'] ==ğ
TRUE
)

133 
$sql
 .= ' AUTO_INCREMENT';

138 ià(++
$cu¼’t_f›ld_couÁ
 < 
	`couÁ
(
$f›lds
))

140 
$sql
 .= ',';

144 ià(
	`couÁ
(
$´im¬y_keys
) > 0)

146 
$´im¬y_keys
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($primary_keys);

147 
$sql
 .ğ",\n\tPRIMARY KEY (" . 
	`im¶ode
(', ', 
$´im¬y_keys
) . ")";

150 ià(
	`is_¬¿y
(
$keys
è&& 
	`couÁ
($keys) > 0)

152 
	`fÜ—ch
 (
$keys
 
as
 
$key
)

154 ià(
	`is_¬¿y
(
$key
))

156 
$key
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key);

160 
$key
 = 
	`¬¿y
(
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key));

163 
$sql
 .ğ",\n\tFOREIGN KEY (" . 
	`im¶ode
(', ', 
$key
) . ")";

167 
$sql
 .= "\n)";

169  
$sql
;

170 
	}
}

180 
funùiÚ
 
	$_drİ_bË
(
$bË
)

183 ià(
$this
->
db
->
db_debug
)

185  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

187  
FALSE
;

188 
	}
}

208 
funùiÚ
 
_®‹r_bË
(
$®‹r_ty³
, 
$bË
, 
$cŞumn_Çme
, 
$cŞumn_defš™iÚ
 = '', 
$deçuÉ_v®ue
 = '', 
$nuÎ
 = '', 
$aá”_f›ld
 = '')

210 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$bË
)." $®‹r_ty³ ".$this->db->_´Ùeù_id’tif›rs(
$cŞumn_Çme
);

213 ià(
	g$®‹r_ty³
 == 'DROP')

215  
$sql
;

218 
	g$sql
 .= " $column_definition";

220 ià(
	g$deçuÉ_v®ue
 != '')

222 
$sql
 .= " DEFAULT \"$default_value\"";

225 ià(
	g$nuÎ
 ==ğ
NULL
)

227 
$sql
 .= ' NULL';

231 
	g$sql
 .= ' NOT NULL';

234 ià(
	g$aá”_f›ld
 != '')

236 
$sql
 .ğ' AFTER ' . 
$this
->
db
->
_´Ùeù_id’tif›rs
(
$aá”_f›ld
);

239  
	g$sql
;

256 
funùiÚ
 
	$_»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

258 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
)." RENAME TO ".$this->db->_´Ùeù_id’tif›rs(
$Ãw_bË_Çme
);

259  
$sql
;

260 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/pdo/pdo_result.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_DB_pdo_»suÉ
 
ex‹nds
 
	mCI_DB_»suÉ
 {

29 
public
 
	m$num_rows
;

36 
public
 
funùiÚ
 
	$num_rows
()

38 ià(
	`is_št
(
$this
->
num_rows
))

40  
$this
->
num_rows
;

42 
	`–£if
 ((
$this
->
num_rows
 = $this->
»suÉ_id
->
	`rowCouÁ
()) > 0)

44  
$this
->
num_rows
;

47 
$this
->
num_rows
 = 
	`couÁ
($this->
»suÉ_id
->
	`ãtchAÎ
());

48 
$this
->
»suÉ_id
->
	`execu‹
();

49  
$this
->
num_rows
;

60 
funùiÚ
 
	$num_f›lds
()

62  
$this
->
»suÉ_id
->
	`cŞumnCouÁ
();

63 
	}
}

75 
funùiÚ
 
	$li¡_f›lds
()

77 ià(
$this
->
db
->
db_debug
)

79  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

81  
FALSE
;

82 
	}
}

94 
funùiÚ
 
	$f›ld_d©a
()

96 
$d©a
 = 
	`¬¿y
();

98 
Œy


100 
$i
 = 0; $˜< 
$this
->
	`num_f›lds
(); $i++)

102 
$d©a
[] = 
$this
->
»suÉ_id
->
	`g‘CŞumnM‘a
(
$i
);

105  
$d©a
;

107 
	`ÿtch
 (
Exû±iÚ
 
$e
)

109 ià(
$this
->
db
->
db_debug
)

111  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

113  
FALSE
;

115 
	}
}

124 
funùiÚ
 
	$ä“_»suÉ
()

126 ià(
	`is_objeù
(
$this
->
»suÉ_id
))

128 
$this
->
»suÉ_id
 = 
FALSE
;

130 
	}
}

144 
funùiÚ
 
	$_d©a_£ek
(
$n
 = 0)

146  
FALSE
;

147 
	}
}

159 
funùiÚ
 
	$_ãtch_assoc
()

161  
$this
->
»suÉ_id
->
	`ãtch
(
PDO
::
FETCH_ASSOC
);

162 
	}
}

174 
funùiÚ
 
	$_ãtch_objeù
()

176  
$this
->
»suÉ_id
->
	`ãtchObjeù
();

177 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/pdo/pdo_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_pdo_ut™y
 
ex‹nds
 
	mCI_DB_ut™y
 {

33 
funùiÚ
 
	$_li¡_d©aba£s
()

36 ià(
$this
->
db
->
db_debug
)

38  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

40  
FALSE
;

54 
funùiÚ
 
	$_İtimize_bË
(
$bË
)

57 ià(
$this
->
db
->
db_debug
)

59  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

61  
FALSE
;

62 
	}
}

75 
funùiÚ
 
	$_»·œ_bË
(
$bË
)

78 ià(
$this
->
db
->
db_debug
)

80  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

82  
FALSE
;

83 
	}
}

94 
funùiÚ
 
_backup
(
$·¿ms
 = 
	$¬¿y
())

97  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

98 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/postgre/postgre_driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

31 şas 
	cCI_DB_po¡g»_driv”
 
ex‹nds
 
	mCI_DB
 {

33 
v¬
 
	m$dbdriv”
 = 'postgre';

35 
v¬
 
	m$_esÿ³_ch¬
 = '"';

38 
v¬
 
	m$_like_esÿ³_¡r
 = " ESCAPE '%s' ";

39 
v¬
 
	m$_like_esÿ³_chr
 = '!';

46 
v¬
 
	m$_couÁ_¡ršg
 = "SELECT COUNT(*) AS ";

47 
v¬
 
	m$_¿ndom_keywÜd
 = ' RANDOM()';

55 
funùiÚ
 
	$_cÚÃù_¡ršg
()

57 
$compÚ’ts
 = 
	`¬¿y
(

65 
$cÚÃù_¡ršg
 = "";

66 
	`fÜ—ch
 (
$compÚ’ts
 
as
 
$key
 => 
$v®
)

68 ià(
	`is£t
(
$this
->
$key
) && $this->$key != '')

70 
$cÚÃù_¡ršg
 .ğ" $v®=".
$this
->
$key
;

73  
	`Œim
(
$cÚÃù_¡ršg
);

84 
funùiÚ
 
	$db_cÚÃù
()

86  @
	`pg_cÚÃù
(
$this
->
	`_cÚÃù_¡ršg
());

87 
	}
}

97 
funùiÚ
 
	$db_pcÚÃù
()

99  @
	`pg_pcÚÃù
(
$this
->
	`_cÚÃù_¡ršg
());

100 
	}
}

113 
funùiÚ
 
	$»cÚÃù
()

115 ià(
	`pg_pšg
(
$this
->
cÚn_id
è==ğ
FALSE
)

117 
$this
->
cÚn_id
 = 
FALSE
;

119 
	}
}

129 
funùiÚ
 
	$db_£Ëù
()

132  
TRUE
;

133 
	}
}

145 
funùiÚ
 
	$db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
)

148  
TRUE
;

149 
	}
}

159 
funùiÚ
 
	$_v”siÚ
()

162 
	}
}

173 
funùiÚ
 
	$_execu‹
(
$sql
)

175 
$sql
 = 
$this
->
	`_´•_qu”y
($sql);

176  @
	`pg_qu”y
(
$this
->
cÚn_id
, 
$sql
);

177 
	}
}

190 
funùiÚ
 
	$_´•_qu”y
(
$sql
)

192  
$sql
;

193 
	}
}

203 
funùiÚ
 
	$Œªs_begš
(
$‹¡_mode
 = 
FALSE
)

205 iàĞ! 
$this
->
Œªs_’abËd
)

207  
TRUE
;

211 ià(
$this
->
_Œªs_d•th
 > 0)

213  
TRUE
;

219 
$this
->
_Œªs_çu»
 = (
$‹¡_mode
 ==ğ
TRUE
è? TRUE : 
FALSE
;

221  @
	`pg_exec
(
$this
->
cÚn_id
, "begin");

222 
	}
}

232 
funùiÚ
 
	$Œªs_comm™
()

234 iàĞ! 
$this
->
Œªs_’abËd
)

236  
TRUE
;

240 ià(
$this
->
_Œªs_d•th
 > 0)

242  
TRUE
;

245  @
	`pg_exec
(
$this
->
cÚn_id
, "commit");

246 
	}
}

256 
funùiÚ
 
	$Œªs_rŞlback
()

258 iàĞ! 
$this
->
Œªs_’abËd
)

260  
TRUE
;

264 ià(
$this
->
_Œªs_d•th
 > 0)

266  
TRUE
;

269  @
	`pg_exec
(
$this
->
cÚn_id
, "rollback");

270 
	}
}

282 
funùiÚ
 
	$esÿ³_¡r
(
$¡r
, 
$like
 = 
FALSE
)

284 ià(
	`is_¬¿y
(
$¡r
))

286 
	`fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

288 
$¡r
[
$key
] = 
$this
->
	`esÿ³_¡r
(
$v®
, 
$like
);

291  
$¡r
;

294 
$¡r
 = 
	`pg_esÿ³_¡ršg
($str);

297 ià(
$like
 ==ğ
TRUE
)

299 
$¡r
 = 
	`¡r_»¶aû
Ğ
	`¬¿y
('%', '_', 
$this
->
_like_esÿ³_chr
),

300 
	`¬¿y
(
$this
->
_like_esÿ³_chr
.'%', $this->_like_escape_chr.'_', $this->_like_escape_chr.$this->_like_escape_chr),

301 
$¡r
);

304  
$¡r
;

305 
	}
}

315 
funùiÚ
 
	$afãùed_rows
()

317  @
	`pg_afãùed_rows
(
$this
->
»suÉ_id
);

318 
	}
}

328 
funùiÚ
 
	$š£¹_id
()

330 
$v
 = 
$this
->
	`_v”siÚ
();

331 
$v
 = $v['server'];

333 
$bË
 = 
	`func_num_¬gs
(è> 0 ? 
	`func_g‘_¬g
(0è: 
NULL
;

334 
$cŞumn
 = 
	`func_num_¬gs
(è> 1 ? 
	`func_g‘_¬g
(1è: 
NULL
;

336 ià(
$bË
 =ğ
NULL
 && 
$v
 >= '8.1')

338 
$sql
='SELECT LASTVAL()‡s ins_id';

340 
	`–£if
 (
$bË
 !ğ
NULL
 && 
$cŞumn
 !ğNULL && 
$v
 >= '8.0')

342 
$sql
 = 
	`¥rštf
("SELECT…g_g‘_£rŸl_£qu’û('%s','%s'èa £q", 
$bË
, 
$cŞumn
);

343 
$qu”y
 = 
$this
->
	`qu”y
(
$sql
);

344 
$row
 = 
$qu”y
->
	`row
();

345 
$sql
 = 
	`¥rštf
("SELECT CURRVAL('%s'èa šs_id", 
$row
->
£q
);

347 
	`–£if
 (
$bË
 !ğ
NULL
)

350 
$sql
 = 
	`¥rštf
("SELECT CURRVAL('%s'èa šs_id", 
$bË
);

354  
	`pg_Ï¡_oid
(
$this
->
»suÉ_id
);

356 
$qu”y
 = 
$this
->
	`qu”y
(
$sql
);

357 
$row
 = 
$qu”y
->
	`row
();

358  
$row
->
šs_id
;

359 
	}
}

373 
funùiÚ
 
couÁ_®l
(
$bË
 = '')

375 ià(
$bË
 == '')

380 
	g$qu”y
 = 
$this
->
qu”y
($this->
_couÁ_¡ršg
 . $this->
_´Ùeù_id’tif›rs
('numrows'è. " FROM " . $this->_´Ùeù_id’tif›rs(
$bË
, 
TRUE
, 
NULL
, 
FALSE
));

382 ià(
	g$qu”y
->
num_rows
() == 0)

387 
	g$row
 = 
$qu”y
->
row
();

388 
	g$this
->
_»£t_£Ëù
();

389  (è
	g$row
->
	gnumrows
;

403 
funùiÚ
 
	$_li¡_bËs
(
$´efix_lim™
 = 
FALSE
)

405 
$sql
 = "SELECTable_name FROM information_schema.tables WHEREable_schema = 'public'";

407 ià(
$´efix_lim™
 !=ğ
FALSE
 
AND
 
$this
->
db´efix
 != '')

409 
$sql
 .ğ" ANDabË_ÇmLIKE '".
$this
->
	`esÿ³_like_¡r
($this->
db´efix
)."%' ".
	`¥rštf
($this->
_like_esÿ³_¡r
, $this->
_like_esÿ³_chr
);

412  
$sql
;

413 
	}
}

426 
funùiÚ
 
_li¡_cŞumns
(
$bË
 = '')

428  "SELECT cŞumn_ÇmFROM infÜm©iÚ_schema.cŞumn WHEREabË_Çm='".
$bË
."'";

442 
funùiÚ
 
	$_f›ld_d©a
(
$bË
)

444  "SELECT * FROM ".
$bË
." LIMIT 1";

445 
	}
}

455 
funùiÚ
 
	$_”rÜ_mes§ge
()

457  
	`pg_Ï¡_”rÜ
(
$this
->
cÚn_id
);

458 
	}
}

468 
funùiÚ
 
	$_”rÜ_numb”
()

471 
	}
}

484 
funùiÚ
 
	$_esÿ³_id’tif›rs
(
$™em
)

486 ià(
$this
->
_esÿ³_ch¬
 == '')

488  
$™em
;

491 
	`fÜ—ch
 (
$this
->
_»£rved_id’tif›rs
 
as
 
$id
)

493 ià(
	`¡½os
(
$™em
, '.'.
$id
è!=ğ
FALSE
)

495 
$¡r
 = 
$this
->
_esÿ³_ch¬
. 
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.', 
$™em
);

498  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

502 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
)

504 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.'.$this->_esÿ³_ch¬, 
$™em
).$this->_escape_char;

508 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
$™em
.$this->_escape_char;

512  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

513 
	}
}

527 
funùiÚ
 
	$_äom_bËs
(
$bËs
)

529 iàĞ! 
	`is_¬¿y
(
$bËs
))

531 
$bËs
 = 
	`¬¿y
($tables);

534  
	`im¶ode
(', ', 
$bËs
);

535 
	}
}

550 
funùiÚ
 
	$_š£¹
(
$bË
, 
$keys
, 
$v®ues
)

552  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES (".im¶ode(', ', 
$v®ues
).")";

553 
	}
}

568 
funùiÚ
 
	$_š£¹_b©ch
(
$bË
, 
$keys
, 
$v®ues
)

570  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES ".im¶ode(', ', 
$v®ues
);

571 
	}
}

588 
funùiÚ
 
_upd©e
(
$bË
, 
$v®ues
, 
$wh”e
, 
$Üd”by
 = 
¬¿y
(), 
$lim™
 = 
FALSE
)

590 
fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

592 
$v®¡r
[] = 
$key
." = ".
$v®
;

595 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

597 
	g$Üd”by
 = (
couÁ
(
$Üd”by
è>ğ1)?' ORDER BY '.
im¶ode
(", ", $orderby):'';

599 
	g$sql
 = "UPDATE ".
$bË
." SET ".
im¶ode
(', ', 
$v®¡r
);

601 
	g$sql
 .ğ(
$wh”e
 !ğ'' 
AND
 
couÁ
($wh”eè>=1è? " WHERE ".
im¶ode
(" ", $where) : '';

603 
	g$sql
 .ğ
$Üd”by
.
$lim™
;

605  
	g$sql
;

621 
funùiÚ
 
	$_Œunÿ‹
(
$bË
)

623  "TRUNCATE ".
$bË
;

624 
	}
}

639 
funùiÚ
 
_d–‘e
(
$bË
, 
$wh”e
 = 
¬¿y
(), 
$like
 =‡¼ay(), 
$lim™
 = 
FALSE
)

641 
$cÚd™iÚs
 = '';

643 ià(
couÁ
(
$wh”e
è> 0 
OR
 couÁ(
$like
) > 0)

645 
	g$cÚd™iÚs
 = "\nWHERE ";

646 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$this
->
¬_wh”e
);

648 ià(
couÁ
(
$wh”e
è> 0 && couÁ(
$like
) > 0)

650 
	g$cÚd™iÚs
 .= " AND ";

652 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$like
);

655 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

657  "DELETE FROM ".
	g$bË
.
	g$cÚd™iÚs
.
	g$lim™
;

672 
funùiÚ
 
	$_lim™
(
$sql
, 
$lim™
, 
$off£t
)

674 
$sql
 .ğ"LIMIT ".
$lim™
;

676 ià(
$off£t
 > 0)

678 
$sql
 .ğ" OFFSET ".
$off£t
;

681  
$sql
;

682 
	}
}

693 
funùiÚ
 
	$_şo£
(
$cÚn_id
)

695 @
	`pg_şo£
(
$cÚn_id
);

696 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/postgre/postgre_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_po¡g»_fÜge
 
ex‹nds
 
	mCI_DB_fÜge
 {

34 
funùiÚ
 
	$_ü—‹_d©aba£
(
$Çme
)

36  "CREATE DATABASE ".
$Çme
;

48 
funùiÚ
 
	$_drİ_d©aba£
(
$Çme
)

50  "DROP DATABASE ".
$Çme
;

51 
	}
}

66 
funùiÚ
 
	$_ü—‹_bË
(
$bË
, 
$f›lds
, 
$´im¬y_keys
, 
$keys
, 
$if_nÙ_exi¡s
)

68 
$sql
 = 'CREATE TABLE ';

70 ià(
$if_nÙ_exi¡s
 ==ğ
TRUE
)

72 ià(
$this
->
db
->
	`bË_exi¡s
(
$bË
))

78 
$sql
 .ğ
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
)." (";

79 
$cu¼’t_f›ld_couÁ
 = 0;

81 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
=>
$©Œibu‹s
)

86 ià(
	`is_num”ic
(
$f›ld
))

88 
$sql
 .= "\n\t$attributes";

92 
$©Œibu‹s
 = 
	`¬¿y_chªge_key_ÿ£
($©Œibu‹s, 
CASE_UPPER
);

94 
$sql
 .ğ"\n\t".
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$f›ld
);

96 
$is_unsigÃd
 = (
	`¬¿y_key_exi¡s
('UNSIGNED', 
$©Œibu‹s
è&& $©Œibu‹s['UNSIGNED'] ==ğ
TRUE
);

99 
	`¡¹ouµ”
(
$©Œibu‹s
['TYPE']))

102 
$©Œibu‹s
['TYPE'] = 'SMALLINT';

105 
$©Œibu‹s
['TYPE'] = (
$is_unsigÃd
) ? 'INTEGER' : 'SMALLINT';

108 
$©Œibu‹s
['TYPE'] = 'INTEGER';

111 
$©Œibu‹s
['TYPE'] = (
$is_unsigÃd
) ? 'BIGINT' : 'INTEGER';

114 
$©Œibu‹s
['TYPE'] = (
$is_unsigÃd
) ? 'NUMERIC' : 'BIGINT';

117 
$©Œibu‹s
['TYPE'] = 'DOUBLE PRECISION';

120 
$©Œibu‹s
['TYPE'] = 'TIMESTAMP';

123 
$©Œibu‹s
['TYPE'] = 'TEXT';

126 
$©Œibu‹s
['TYPE'] = 'BYTEA';

131 ià(
	`š_¬¿y
(
$f›ld
, 
$´im¬y_keys
è&& 
	`¬¿y_key_exi¡s
('AUTO_INCREMENT', 
$©Œibu‹s
)

132 && 
$©Œibu‹s
['AUTO_INCREMENT'] ==ğ
TRUE
)

134 
$sql
 .= ' SERIAL';

138 
$sql
 .ğ' '.
$©Œibu‹s
['TYPE'];

142 ià(
	`¬¿y_key_exi¡s
('CONSTRAINT', 
$©Œibu‹s
è&& 
	`¡½os
($©Œibu‹s['TYPE'], 'INT'è==ğ
çl£
)

144 
$sql
 .ğ'('.
$©Œibu‹s
['CONSTRAINT'].')';

147 ià(
	`¬¿y_key_exi¡s
('DEFAULT', 
$©Œibu‹s
))

149 
$sql
 .ğ' DEFAULT \''.
$©Œibu‹s
['DEFAULT'].'\'';

152 ià(
	`¬¿y_key_exi¡s
('NULL', 
$©Œibu‹s
è&& $©Œibu‹s['NULL'] ==ğ
TRUE
)

154 
$sql
 .= ' NULL';

158 
$sql
 .= ' NOT NULL';

162 ià(
	`¬¿y_key_exi¡s
('UNIQUE', 
$©Œibu‹s
è&& $©Œibu‹s['UNIQUE'] ==ğ
TRUE
)

164 
$sql
 .= ' UNIQUE';

169 ià(++
$cu¼’t_f›ld_couÁ
 < 
	`couÁ
(
$f›lds
))

171 
$sql
 .= ',';

175 ià(
	`couÁ
(
$´im¬y_keys
) > 0)

178 
	`fÜ—ch
 (
$´im¬y_keys
 
as
 
$šdex
 => 
$key
)

180 
$´im¬y_keys
[
$šdex
] = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$key
);

183 
$sql
 .ğ",\n\tPRIMARY KEY (" . 
	`im¶ode
(', ', 
$´im¬y_keys
) . ")";

186 
$sql
 .= "\n);";

188 ià(
	`is_¬¿y
(
$keys
è&& 
	`couÁ
($keys) > 0)

190 
	`fÜ—ch
 (
$keys
 
as
 
$key
)

192 ià(
	`is_¬¿y
(
$key
))

194 
$key
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key);

198 
$key
 = 
	`¬¿y
(
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key));

201 
	`fÜ—ch
 (
$key
 
as
 
$f›ld
)

203 
$sql
 .ğ"CREATE INDEX " . 
$bË
 . "_" . 
	`¡r_»¶aû
(
	`¬¿y
('"', "'"), '', 
$f›ld
) . "_index ON $table ($field); ";

208  
$sql
;

209 
	}
}

219 
funùiÚ
 
	$_drİ_bË
(
$bË
)

221  "DROP TABLE IF EXISTS ".
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
)." CASCADE";

222 
	}
}

242 
funùiÚ
 
_®‹r_bË
(
$®‹r_ty³
, 
$bË
, 
$cŞumn_Çme
, 
$cŞumn_defš™iÚ
 = '', 
$deçuÉ_v®ue
 = '', 
$nuÎ
 = '', 
$aá”_f›ld
 = '')

244 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$bË
)." $®‹r_ty³ ".$this->db->_´Ùeù_id’tif›rs(
$cŞumn_Çme
);

247 ià(
	g$®‹r_ty³
 == 'DROP')

249  
$sql
;

252 
	g$sql
 .= " $column_definition";

254 ià(
	g$deçuÉ_v®ue
 != '')

256 
$sql
 .= " DEFAULT \"$default_value\"";

259 ià(
	g$nuÎ
 ==ğ
NULL
)

261 
$sql
 .= ' NULL';

265 
	g$sql
 .= ' NOT NULL';

268 ià(
	g$aá”_f›ld
 != '')

270 
$sql
 .ğ' AFTER ' . 
$this
->
db
->
_´Ùeù_id’tif›rs
(
$aá”_f›ld
);

273  
	g$sql
;

289 
funùiÚ
 
	$_»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

291 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
)." RENAME TO ".$this->db->_´Ùeù_id’tif›rs(
$Ãw_bË_Çme
);

292  
$sql
;

293 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/postgre/postgre_result.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_DB_po¡g»_»suÉ
 
ex‹nds
 
	mCI_DB_»suÉ
 {

35 
funùiÚ
 
	$num_rows
()

37  @
	`pg_num_rows
(
$this
->
»suÉ_id
);

48 
funùiÚ
 
	$num_f›lds
()

50  @
	`pg_num_f›lds
(
$this
->
»suÉ_id
);

51 
	}
}

63 
funùiÚ
 
	$li¡_f›lds
()

65 
$f›ld_Çmes
 = 
	`¬¿y
();

66 
$i
 = 0; $˜< 
$this
->
	`num_f›lds
(); $i++)

68 
$f›ld_Çmes
[] = 
	`pg_f›ld_Çme
(
$this
->
»suÉ_id
, 
$i
);

71  
$f›ld_Çmes
;

72 
	}
}

84 
funùiÚ
 
	$f›ld_d©a
()

86 
$»tv®
 = 
	`¬¿y
();

87 
$i
 = 0; $˜< 
$this
->
	`num_f›lds
(); $i++)

89 
$F
 = 
Ãw
 
	`¡dCÏss
();

90 
$F
->
Çme
 = 
	`pg_f›ld_Çme
(
$this
->
»suÉ_id
, 
$i
);

91 
$F
->
ty³
 = 
	`pg_f›ld_ty³
(
$this
->
»suÉ_id
, 
$i
);

92 
$F
->
max_Ëngth
 = 
	`pg_f›ld_size
(
$this
->
»suÉ_id
, 
$i
);

93 
$F
->
´im¬y_key
 = 0;

94 
$F
-> = '';

96 
$»tv®
[] = 
$F
;

99  
$»tv®
;

100 
	}
}

109 
funùiÚ
 
	$ä“_»suÉ
()

111 ià(
	`is_»sourû
(
$this
->
»suÉ_id
))

113 
	`pg_ä“_»suÉ
(
$this
->
»suÉ_id
);

114 
$this
->
»suÉ_id
 = 
FALSE
;

116 
	}
}

130 
funùiÚ
 
	$_d©a_£ek
(
$n
 = 0)

132  
	`pg_»suÉ_£ek
(
$this
->
»suÉ_id
, 
$n
);

133 
	}
}

145 
funùiÚ
 
	$_ãtch_assoc
()

147  
	`pg_ãtch_assoc
(
$this
->
»suÉ_id
);

148 
	}
}

160 
funùiÚ
 
	$_ãtch_objeù
()

162  
	`pg_ãtch_objeù
(
$this
->
»suÉ_id
);

163 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/postgre/postgre_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_po¡g»_ut™y
 
ex‹nds
 
	mCI_DB_ut™y
 {

33 
funùiÚ
 
	$_li¡_d©aba£s
()

49 
funùiÚ
 
	$_İtimize_bË
(
$bË
)

51  
FALSE
;

52 
	}
}

65 
funùiÚ
 
	$_»·œ_bË
(
$bË
)

67  
FALSE
;

68 
	}
}

79 
funùiÚ
 
_backup
(
$·¿ms
 = 
	$¬¿y
())

82  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

83 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlite/sqlite_driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

33 şas 
	cCI_DB_sql™e_driv”
 
ex‹nds
 
	mCI_DB
 {

35 
v¬
 
	m$dbdriv”
 = 'sqlite';

38 
v¬
 
	m$_esÿ³_ch¬
 = '';

41 
v¬
 
	m$_like_esÿ³_¡r
 = " ESCAPE '%s' ";

42 
v¬
 
	m$_like_esÿ³_chr
 = '!';

49 
v¬
 
	m$_couÁ_¡ršg
 = "SELECT COUNT(*) AS ";

50 
v¬
 
	m$_¿ndom_keywÜd
 = ' Random()';

58 
funùiÚ
 
	$db_cÚÃù
()

60 iàĞ! 
$cÚn_id
 = @
	`sql™e_İ’
(
$this
->
d©aba£
, 
FILE_WRITE_MODE
, 
$”rÜ
))

62 
	`log_mes§ge
('”rÜ', 
$”rÜ
);

64 ià(
$this
->
db_debug
)

66 
$this
->
	`di¥Ïy_”rÜ
(
$”rÜ
, '', 
TRUE
);

69  
FALSE
;

72  
$cÚn_id
;

83 
funùiÚ
 
	$db_pcÚÃù
()

85 iàĞ! 
$cÚn_id
 = @
	`sql™e_pİ’
(
$this
->
d©aba£
, 
FILE_WRITE_MODE
, 
$”rÜ
))

87 
	`log_mes§ge
('”rÜ', 
$”rÜ
);

89 ià(
$this
->
db_debug
)

91 
$this
->
	`di¥Ïy_”rÜ
(
$”rÜ
, '', 
TRUE
);

94  
FALSE
;

97  
$cÚn_id
;

98 
	}
}

111 
funùiÚ
 
	$»cÚÃù
()

114 
	}
}

124 
funùiÚ
 
	$db_£Ëù
()

126  
TRUE
;

127 
	}
}

139 
funùiÚ
 
	$db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
)

142  
TRUE
;

143 
	}
}

153 
funùiÚ
 
	$_v”siÚ
()

155  
	`sql™e_libv”siÚ
();

156 
	}
}

167 
funùiÚ
 
	$_execu‹
(
$sql
)

169 
$sql
 = 
$this
->
	`_´•_qu”y
($sql);

170  @
	`sql™e_qu”y
(
$this
->
cÚn_id
, 
$sql
);

171 
	}
}

184 
funùiÚ
 
	$_´•_qu”y
(
$sql
)

186  
$sql
;

187 
	}
}

197 
funùiÚ
 
	$Œªs_begš
(
$‹¡_mode
 = 
FALSE
)

199 iàĞ! 
$this
->
Œªs_’abËd
)

201  
TRUE
;

205 ià(
$this
->
_Œªs_d•th
 > 0)

207  
TRUE
;

213 
$this
->
_Œªs_çu»
 = (
$‹¡_mode
 ==ğ
TRUE
è? TRUE : 
FALSE
;

215 
$this
->
	`sim¶e_qu”y
('BEGIN TRANSACTION');

216  
TRUE
;

217 
	}
}

227 
funùiÚ
 
	$Œªs_comm™
()

229 iàĞ! 
$this
->
Œªs_’abËd
)

231  
TRUE
;

235 ià(
$this
->
_Œªs_d•th
 > 0)

237  
TRUE
;

240 
$this
->
	`sim¶e_qu”y
('COMMIT');

241  
TRUE
;

242 
	}
}

252 
funùiÚ
 
	$Œªs_rŞlback
()

254 iàĞ! 
$this
->
Œªs_’abËd
)

256  
TRUE
;

260 ià(
$this
->
_Œªs_d•th
 > 0)

262  
TRUE
;

265 
$this
->
	`sim¶e_qu”y
('ROLLBACK');

266  
TRUE
;

267 
	}
}

279 
funùiÚ
 
	$esÿ³_¡r
(
$¡r
, 
$like
 = 
FALSE
)

281 ià(
	`is_¬¿y
(
$¡r
))

283 
	`fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

285 
$¡r
[
$key
] = 
$this
->
	`esÿ³_¡r
(
$v®
, 
$like
);

288  
$¡r
;

291 
$¡r
 = 
	`sql™e_esÿ³_¡ršg
($str);

294 ià(
$like
 ==ğ
TRUE
)

296 
$¡r
 = 
	`¡r_»¶aû
Ğ
	`¬¿y
('%', '_', 
$this
->
_like_esÿ³_chr
),

297 
	`¬¿y
(
$this
->
_like_esÿ³_chr
.'%', $this->_like_escape_chr.'_', $this->_like_escape_chr.$this->_like_escape_chr),

298 
$¡r
);

301  
$¡r
;

302 
	}
}

312 
funùiÚ
 
	$afãùed_rows
()

314  
	`sql™e_chªges
(
$this
->
cÚn_id
);

315 
	}
}

325 
funùiÚ
 
	$š£¹_id
()

327  @
	`sql™e_Ï¡_š£¹_rowid
(
$this
->
cÚn_id
);

328 
	}
}

342 
funùiÚ
 
couÁ_®l
(
$bË
 = '')

344 ià(
$bË
 == '')

349 
	g$qu”y
 = 
$this
->
qu”y
($this->
_couÁ_¡ršg
 . $this->
_´Ùeù_id’tif›rs
('numrows'è. " FROM " . $this->_´Ùeù_id’tif›rs(
$bË
, 
TRUE
, 
NULL
, 
FALSE
));

351 ià(
	g$qu”y
->
num_rows
() == 0)

356 
	g$row
 = 
$qu”y
->
row
();

357 
	g$this
->
_»£t_£Ëù
();

358  (è
	g$row
->
	gnumrows
;

372 
funùiÚ
 
	$_li¡_bËs
(
$´efix_lim™
 = 
FALSE
)

374 
$sql
 = "SELECT‚ame from sqlite_master WHEREype='table'";

376 ià(
$´efix_lim™
 !=ğ
FALSE
 
AND
 
$this
->
db´efix
 != '')

378 
$sql
 .ğ" AND 'Çme' LIKE '".
$this
->
	`esÿ³_like_¡r
($this->
db´efix
)."%' ".
	`¥rštf
($this->
_like_esÿ³_¡r
, $this->
_like_esÿ³_chr
);

380  
$sql
;

381 
	}
}

394 
funùiÚ
 
_li¡_cŞumns
(
$bË
 = '')

397  
FALSE
;

411 
funùiÚ
 
	$_f›ld_d©a
(
$bË
)

413  "SELECT * FROM ".
$bË
." LIMIT 1";

414 
	}
}

424 
funùiÚ
 
	$_”rÜ_mes§ge
()

426  
	`sql™e_”rÜ_¡ršg
(
	`sql™e_Ï¡_”rÜ
(
$this
->
cÚn_id
));

427 
	}
}

437 
funùiÚ
 
	$_”rÜ_numb”
()

439  
	`sql™e_Ï¡_”rÜ
(
$this
->
cÚn_id
);

440 
	}
}

453 
funùiÚ
 
	$_esÿ³_id’tif›rs
(
$™em
)

455 ià(
$this
->
_esÿ³_ch¬
 == '')

457  
$™em
;

460 
	`fÜ—ch
 (
$this
->
_»£rved_id’tif›rs
 
as
 
$id
)

462 ià(
	`¡½os
(
$™em
, '.'.
$id
è!=ğ
FALSE
)

464 
$¡r
 = 
$this
->
_esÿ³_ch¬
. 
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.', 
$™em
);

467  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

471 ià(
	`¡½os
(
$™em
, '.'è!=ğ
FALSE
)

473 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
	`¡r_»¶aû
('.', $this->_esÿ³_ch¬.'.'.$this->_esÿ³_ch¬, 
$™em
).$this->_escape_char;

477 
$¡r
 = 
$this
->
_esÿ³_ch¬
.
$™em
.$this->_escape_char;

481  
	`´eg_»¶aû
('/['.
$this
->
_esÿ³_ch¬
.']+/', $this->_esÿ³_ch¬, 
$¡r
);

482 
	}
}

496 
funùiÚ
 
	$_äom_bËs
(
$bËs
)

498 iàĞ! 
	`is_¬¿y
(
$bËs
))

500 
$bËs
 = 
	`¬¿y
($tables);

503  '('.
	`im¶ode
(', ', 
$bËs
).')';

504 
	}
}

519 
funùiÚ
 
	$_š£¹
(
$bË
, 
$keys
, 
$v®ues
)

521  "INSERT INTO ".
$bË
." (".
	`im¶ode
(', ', 
$keys
)."èVALUES (".im¶ode(', ', 
$v®ues
).")";

522 
	}
}

539 
funùiÚ
 
_upd©e
(
$bË
, 
$v®ues
, 
$wh”e
, 
$Üd”by
 = 
¬¿y
(), 
$lim™
 = 
FALSE
)

541 
fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®
)

543 
$v®¡r
[] = 
$key
." = ".
$v®
;

546 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

548 
	g$Üd”by
 = (
couÁ
(
$Üd”by
è>ğ1)?' ORDER BY '.
im¶ode
(", ", $orderby):'';

550 
	g$sql
 = "UPDATE ".
$bË
." SET ".
im¶ode
(', ', 
$v®¡r
);

552 
	g$sql
 .ğ(
$wh”e
 !ğ'' 
AND
 
couÁ
($wh”eè>=1è? " WHERE ".
im¶ode
(" ", $where) : '';

554 
	g$sql
 .ğ
$Üd”by
.
$lim™
;

556  
	g$sql
;

573 
funùiÚ
 
	$_Œunÿ‹
(
$bË
)

575  
$this
->
	`_d–‘e
(
$bË
);

576 
	}
}

591 
funùiÚ
 
_d–‘e
(
$bË
, 
$wh”e
 = 
¬¿y
(), 
$like
 =‡¼ay(), 
$lim™
 = 
FALSE
)

593 
$cÚd™iÚs
 = '';

595 ià(
couÁ
(
$wh”e
è> 0 
OR
 couÁ(
$like
) > 0)

597 
	g$cÚd™iÚs
 = "\nWHERE ";

598 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$this
->
¬_wh”e
);

600 ià(
couÁ
(
$wh”e
è> 0 && couÁ(
$like
) > 0)

602 
	g$cÚd™iÚs
 .= " AND ";

604 
	g$cÚd™iÚs
 .ğ
im¶ode
("\n", 
$like
);

607 
	g$lim™
 = ( ! 
$lim™
) ? '' : ' LIMIT '.$limit;

609  "DELETE FROM ".
	g$bË
.
	g$cÚd™iÚs
.
	g$lim™
;

625 
funùiÚ
 
	$_lim™
(
$sql
, 
$lim™
, 
$off£t
)

627 ià(
$off£t
 == 0)

629 
$off£t
 = '';

633 
$off£t
 .= ", ";

636  
$sql
."LIMIT ".
$off£t
.
$lim™
;

637 
	}
}

648 
funùiÚ
 
	$_şo£
(
$cÚn_id
)

650 @
	`sql™e_şo£
(
$cÚn_id
);

651 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlite/sqlite_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_sql™e_fÜge
 
ex‹nds
 
	mCI_DB_fÜge
 {

34 
funùiÚ
 
	$_ü—‹_d©aba£
()

38  
TRUE
;

50 
funùiÚ
 
	$_drİ_d©aba£
(
$Çme
)

52 iàĞ! @
	`fe_exi¡s
(
$this
->
db
->
d©aba£
è
OR
 ! @
	`uÆšk
($this->db->database))

54 ià(
$this
->
db
->
db_debug
)

56  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unable_to_drop');

58  
FALSE
;

60  
TRUE
;

61 
	}
}

75 
funùiÚ
 
	$_ü—‹_bË
(
$bË
, 
$f›lds
, 
$´im¬y_keys
, 
$keys
, 
$if_nÙ_exi¡s
)

77 
$sql
 = 'CREATE TABLE ';

80 ià(
$if_nÙ_exi¡s
 ==ğ
TRUE
 && 
	`v”siÚ_com·»
(
$this
->
db
->
	`_v”siÚ
(), '3.3.0', '>=') === TRUE)

82 
$sql
 .= 'IF NOT EXISTS ';

85 
$sql
 .ğ
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
)."(";

86 
$cu¼’t_f›ld_couÁ
 = 0;

88 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
=>
$©Œibu‹s
)

93 ià(
	`is_num”ic
(
$f›ld
))

95 
$sql
 .= "\n\t$attributes";

99 
$©Œibu‹s
 = 
	`¬¿y_chªge_key_ÿ£
($©Œibu‹s, 
CASE_UPPER
);

101 
$sql
 .ğ"\n\t".
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$f›ld
);

103 
$sql
 .ğ' '.
$©Œibu‹s
['TYPE'];

105 ià(
	`¬¿y_key_exi¡s
('CONSTRAINT', 
$©Œibu‹s
))

107 
$sql
 .ğ'('.
$©Œibu‹s
['CONSTRAINT'].')';

110 ià(
	`¬¿y_key_exi¡s
('UNSIGNED', 
$©Œibu‹s
è&& $©Œibu‹s['UNSIGNED'] ==ğ
TRUE
)

112 
$sql
 .= ' UNSIGNED';

115 ià(
	`¬¿y_key_exi¡s
('DEFAULT', 
$©Œibu‹s
))

117 
$sql
 .ğ' DEFAULT \''.
$©Œibu‹s
['DEFAULT'].'\'';

120 ià(
	`¬¿y_key_exi¡s
('NULL', 
$©Œibu‹s
è&& $©Œibu‹s['NULL'] ==ğ
TRUE
)

122 
$sql
 .= ' NULL';

126 
$sql
 .= ' NOT NULL';

129 ià(
	`¬¿y_key_exi¡s
('AUTO_INCREMENT', 
$©Œibu‹s
è&& $©Œibu‹s['AUTO_INCREMENT'] ==ğ
TRUE
)

131 
$sql
 .= ' AUTO_INCREMENT';

136 ià(++
$cu¼’t_f›ld_couÁ
 < 
	`couÁ
(
$f›lds
))

138 
$sql
 .= ',';

142 ià(
	`couÁ
(
$´im¬y_keys
) > 0)

144 
$´im¬y_keys
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($primary_keys);

145 
$sql
 .ğ",\n\tPRIMARY KEY (" . 
	`im¶ode
(', ', 
$´im¬y_keys
) . ")";

148 ià(
	`is_¬¿y
(
$keys
è&& 
	`couÁ
($keys) > 0)

150 
	`fÜ—ch
 (
$keys
 
as
 
$key
)

152 ià(
	`is_¬¿y
(
$key
))

154 
$key
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key);

158 
$key
 = 
	`¬¿y
(
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key));

161 
$sql
 .ğ",\n\tUNIQUE (" . 
	`im¶ode
(', ', 
$key
) . ")";

165 
$sql
 .= "\n)";

167  
$sql
;

168 
	}
}

180 
funùiÚ
 
	$_drİ_bË
(
$bË
)

182 ià(
$this
->
db
->
db_debug
)

184  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

186  
	`¬¿y
();

187 
	}
}

207 
funùiÚ
 
_®‹r_bË
(
$®‹r_ty³
, 
$bË
, 
$cŞumn_Çme
, 
$cŞumn_defš™iÚ
 = '', 
$deçuÉ_v®ue
 = '', 
$nuÎ
 = '', 
$aá”_f›ld
 = '')

209 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$bË
)." $®‹r_ty³ ".$this->db->_´Ùeù_id’tif›rs(
$cŞumn_Çme
);

212 ià(
	g$®‹r_ty³
 == 'DROP')

217  
FALSE
;

220 
	g$sql
 .= " $column_definition";

222 ià(
	g$deçuÉ_v®ue
 != '')

224 
$sql
 .= " DEFAULT \"$default_value\"";

227 ià(
	g$nuÎ
 ==ğ
NULL
)

229 
$sql
 .= ' NULL';

233 
	g$sql
 .= ' NOT NULL';

236 ià(
	g$aá”_f›ld
 != '')

238 
$sql
 .ğ' AFTER ' . 
$this
->
db
->
_´Ùeù_id’tif›rs
(
$aá”_f›ld
);

241  
	g$sql
;

257 
funùiÚ
 
	$_»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

259 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
)." RENAME TO ".$this->db->_´Ùeù_id’tif›rs(
$Ãw_bË_Çme
);

260  
$sql
;

261 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlite/sqlite_result.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_DB_sql™e_»suÉ
 
ex‹nds
 
	mCI_DB_»suÉ
 {

35 
funùiÚ
 
	$num_rows
()

37  @
	`sql™e_num_rows
(
$this
->
»suÉ_id
);

48 
funùiÚ
 
	$num_f›lds
()

50  @
	`sql™e_num_f›lds
(
$this
->
»suÉ_id
);

51 
	}
}

63 
funùiÚ
 
	$li¡_f›lds
()

65 
$f›ld_Çmes
 = 
	`¬¿y
();

66 
$i
 = 0; $˜< 
$this
->
	`num_f›lds
(); $i++)

68 
$f›ld_Çmes
[] = 
	`sql™e_f›ld_Çme
(
$this
->
»suÉ_id
, 
$i
);

71  
$f›ld_Çmes
;

72 
	}
}

84 
funùiÚ
 
	$f›ld_d©a
()

86 
$»tv®
 = 
	`¬¿y
();

87 
$i
 = 0; $˜< 
$this
->
	`num_f›lds
(); $i++)

89 
$F
 = 
Ãw
 
	`¡dCÏss
();

90 
$F
->
Çme
 = 
	`sql™e_f›ld_Çme
(
$this
->
»suÉ_id
, 
$i
);

91 
$F
->
ty³
 = 'varchar';

92 
$F
->
max_Ëngth
 = 0;

93 
$F
->
´im¬y_key
 = 0;

94 
$F
-> = '';

96 
$»tv®
[] = 
$F
;

99  
$»tv®
;

100 
	}
}

109 
funùiÚ
 
	$ä“_»suÉ
()

112 
	}
}

126 
funùiÚ
 
	$_d©a_£ek
(
$n
 = 0)

128  
	`sql™e_£ek
(
$this
->
»suÉ_id
, 
$n
);

129 
	}
}

141 
funùiÚ
 
	$_ãtch_assoc
()

143  
	`sql™e_ãtch_¬¿y
(
$this
->
»suÉ_id
);

144 
	}
}

156 
funùiÚ
 
	$_ãtch_objeù
()

158 ià(
	`funùiÚ_exi¡s
('sqlite_fetch_object'))

160  
	`sql™e_ãtch_objeù
(
$this
->
»suÉ_id
);

164 
$¬r
 = 
	`sql™e_ãtch_¬¿y
(
$this
->
»suÉ_id
, 
SQLITE_ASSOC
);

165 ià(
	`is_¬¿y
(
$¬r
))

167 
$obj
 = (
objeù
è
$¬r
;

168  
$obj
;

170  
NULL
;

173 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlite/sqlite_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_sql™e_ut™y
 
ex‹nds
 
	mCI_DB_ut™y
 {

38 
funùiÚ
 
	$_li¡_d©aba£s
()

40 ià(
$this
->
db_debug
)

42  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

44  
	`¬¿y
();

58 
funùiÚ
 
	$_İtimize_bË
(
$bË
)

60  
FALSE
;

61 
	}
}

74 
funùiÚ
 
	$_»·œ_bË
(
$bË
)

76  
FALSE
;

77 
	}
}

88 
funùiÚ
 
_backup
(
$·¿ms
 = 
	$¬¿y
())

91  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

92 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlsrv/sqlsrv_driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

31 şas 
	cCI_DB_sql¤v_driv”
 
ex‹nds
 
	mCI_DB
 {

33 
v¬
 
	m$dbdriv”
 = 'sqlsrv';

36 
v¬
 
	m$_esÿ³_ch¬
 = '';

39 
v¬
 
	m$_like_esÿ³_¡r
 = " ESCAPE '%s' ";

40 
v¬
 
	m$_like_esÿ³_chr
 = '!';

47 
v¬
 
	m$_couÁ_¡ršg
 = "SELECT COUNT(*) AS ";

48 
v¬
 
	m$_¿ndom_keywÜd
 = ' ASC';

56 
funùiÚ
 
	$db_cÚÃù
(
$poŞšg
 = 
çl£
)

59 
$ch¬aù”_£t
 = (0 ==ğ
	`¡rÿ£cmp
('utf8', 
$this
->
ch¬_£t
)) ? 'UTF-8' : $this->char_set;

61 
$cÚÃùiÚ
 = 
	`¬¿y
(

62 'UID' => 
	`em±y
(
$this
->
u£ºame
) ? '' : $this->username,

63 'PWD' => 
	`em±y
(
$this
->
·sswÜd
) ? '' : $this->password,

64 'D©aba£' => 
$this
->
d©aba£
,

65 'CÚÃùiÚPoŞšg' => 
$poŞšg
 ? 1 : 0,

66 'Ch¬aù”S‘' => 
$ch¬aù”_£t
,

72 if(
	`em±y
(
$cÚÃùiÚ
['UID']) &&ƒmpty($connection['PWD'])) {

73 
	`un£t
(
$cÚÃùiÚ
['UID'], $connection['PWD']);

76  
	`sql¤v_cÚÃù
(
$this
->
ho¡Çme
, 
$cÚÃùiÚ
);

87 
funùiÚ
 
	$db_pcÚÃù
()

89 
$this
->
	`db_cÚÃù
(
TRUE
);

90 
	}
}

103 
funùiÚ
 
	$»cÚÃù
()

106 
	}
}

116 
funùiÚ
 
	$db_£Ëù
()

118  
$this
->
	`_execu‹
('USE ' . $this->
d©aba£
);

119 
	}
}

131 
funùiÚ
 
	$db_£t_ch¬£t
(
$ch¬£t
, 
$cŞÏtiÚ
)

134  
TRUE
;

135 
	}
}

146 
funùiÚ
 
	$_execu‹
(
$sql
)

148 
$sql
 = 
$this
->
	`_´•_qu”y
($sql);

149  
	`sql¤v_qu”y
(
$this
->
cÚn_id
, 
$sql
, 
nuÎ
, 
	`¬¿y
(

150 'SüŞÏbË' => 
SQLSRV_CURSOR_STATIC
,

151 'S’dSŒ—mP¬amsAtExec' => 
Œue


153 
	}
}

166 
funùiÚ
 
	$_´•_qu”y
(
$sql
)

168  
$sql
;

169 
	}
}

179 
funùiÚ
 
	$Œªs_begš
(
$‹¡_mode
 = 
FALSE
)

181 iàĞ! 
$this
->
Œªs_’abËd
)

183  
TRUE
;

187 ià(
$this
->
_Œªs_d•th
 > 0)

189  
TRUE
;

195 
$this
->
_Œªs_çu»
 = (
$‹¡_mode
 ==ğ
TRUE
è? TRUE : 
FALSE
;

197  
	`sql¤v_begš_Œª§ùiÚ
(
$this
->
cÚn_id
);

198 
	}
}

208 
funùiÚ
 
	$Œªs_comm™
()

210 iàĞ! 
$this
->
Œªs_’abËd
)

212  
TRUE
;

216 ià(
$this
->
_Œªs_d•th
 > 0)

218  
TRUE
;

221  
	`sql¤v_comm™
(
$this
->
cÚn_id
);

222 
	}
}

232 
funùiÚ
 
	$Œªs_rŞlback
()

234 iàĞ! 
$this
->
Œªs_’abËd
)

236  
TRUE
;

240 ià(
$this
->
_Œªs_d•th
 > 0)

242  
TRUE
;

245  
	`sql¤v_rŞlback
(
$this
->
cÚn_id
);

246 
	}
}

258 
funùiÚ
 
	$esÿ³_¡r
(
$¡r
, 
$like
 = 
FALSE
)

261  
	`¡r_»¶aû
("'", "''", 
$¡r
);

262 
	}
}

272 
funùiÚ
 
	$afãùed_rows
()

274  @
	`sqÌv_rows_afãùed
(
$this
->
cÚn_id
);

275 
	}
}

287 
funùiÚ
 
	$š£¹_id
()

289  
$this
->
	`qu”y
('£Ëù @@IDENTITY‡ š£¹_id')->
	`row
('insert_id');

290 
	}
}

304 
funùiÚ
 
	$_·r£_majÜ_v”siÚ
(
$v”siÚ
)

306 
	`´eg_m©ch
('/([0-9]+)\.([0-9]+)\.([0-9]+)/', 
$v”siÚ
, 
$v”_šfo
);

307  
$v”_šfo
[1];

308 
	}
}

318 
funùiÚ
 
	$_v”siÚ
()

320 
$šfo
 = 
	`sql¤v_£rv”_šfo
(
$this
->
cÚn_id
);

321  
	`¥rštf
("£Ëù '%s'‡ v”", 
$šfo
['SQLServerVersion']);

322 
	}
}

336 
funùiÚ
 
couÁ_®l
(
$bË
 = '')

338 ià(
$bË
 == '')

341 
	g$qu”y
 = 
$this
->
qu”y
("SELECT COUNT(*èAS‚umrow FROM " . $this->
db´efix
 . 
$bË
);

343 ià(
	g$qu”y
->
num_rows
() == 0)

346 
	g$row
 = 
$qu”y
->
row
();

347 
	g$this
->
_»£t_£Ëù
();

348  
	g$row
->
	gnumrows
;

362 
funùiÚ
 
	$_li¡_bËs
(
$´efix_lim™
 = 
FALSE
)

365 
	}
}

378 
funùiÚ
 
_li¡_cŞumns
(
$bË
 = '')

380  "SELECT * FROM INFORMATION_SCHEMA.CŞumn WHERE TABLE_NAME = '".
$this
->
_esÿ³_bË
(
$bË
)."'";

394 
funùiÚ
 
	$_f›ld_d©a
(
$bË
)

396  "SELECT TOP 1 * FROM " . 
$this
->
	`_esÿ³_bË
(
$bË
);

397 
	}
}

407 
funùiÚ
 
	$_”rÜ_mes§ge
()

409 
$”rÜ
 = 
	`¬¿y_shiá
(
	`sql¤v_”rÜs
());

410  !
	`em±y
(
$”rÜ
['mes§ge']è? $”rÜ['mes§ge'] : 
nuÎ
;

411 
	}
}

421 
funùiÚ
 
	$_”rÜ_numb”
()

423 
$”rÜ
 = 
	`¬¿y_shiá
(
	`sql¤v_”rÜs
());

424  
	`is£t
(
$”rÜ
['SQLSTATE']è? $”rÜ['SQLSTATE'] : 
nuÎ
;

425 
	}
}

439 
funùiÚ
 
	$_esÿ³_bË
(
$bË
)

441  
$bË
;

442 
	}
}

454 
funùiÚ
 
	$_esÿ³_id’tif›rs
(
$™em
)

456  
$™em
;

457 
	}
}

471 
funùiÚ
 
	$_äom_bËs
(
$bËs
)

473 iàĞ! 
	`is_¬¿y
(
$bËs
))

475 
$bËs
 = 
	`¬¿y
($tables);

478  
	`im¶ode
(', ', 
$bËs
);

479 
	}
}

494 
funùiÚ
 
	$_š£¹
(
$bË
, 
$keys
, 
$v®ues
)

496  "INSERT INTO ".
$this
->
	`_esÿ³_bË
(
$bË
)." (".
	`im¶ode
(', ', 
$keys
)."èVALUES (".im¶ode(', ', 
$v®ues
).")";

497 
	}
}

514 
funùiÚ
 
	$_upd©e
(
$bË
, 
$v®ues
, 
$wh”e
)

516 
	`fÜ—ch
(
$v®ues
 
as
 
$key
 => 
$v®
)

518 
$v®¡r
[] = 
$key
." = ".
$v®
;

521  "UPDATE ".
$this
->
	`_esÿ³_bË
(
$bË
)." SET ".
	`im¶ode
(', ', 
$v®¡r
)." WHERE ".im¶ode(" ", 
$wh”e
);

522 
	}
}

537 
funùiÚ
 
	$_Œunÿ‹
(
$bË
)

539  "TRUNCATE TABLE ".
$bË
;

540 
	}
}

555 
funùiÚ
 
	$_d–‘e
(
$bË
, 
$wh”e
)

557  "DELETE FROM ".
$this
->
	`_esÿ³_bË
(
$bË
)." WHERE ".
	`im¶ode
(" ", 
$wh”e
);

558 
	}
}

573 
funùiÚ
 
	$_lim™
(
$sql
, 
$lim™
, 
$off£t
)

575 
$i
 = 
$lim™
 + 
$off£t
;

577  
	`´eg_»¶aû
('/(^\SELECT (DISTINCT)?)/i','\\1 TOP '.
$i
.' ', 
$sql
);

578 
	}
}

589 
funùiÚ
 
	$_şo£
(
$cÚn_id
)

591 @
	`sql¤v_şo£
(
$cÚn_id
);

592 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlsrv/sqlsrv_forge.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_sql¤v_fÜge
 
ex‹nds
 
	mCI_DB_fÜge
 {

34 
funùiÚ
 
	$_ü—‹_d©aba£
(
$Çme
)

36  "CREATE DATABASE ".
$Çme
;

48 
funùiÚ
 
	$_drİ_d©aba£
(
$Çme
)

50  "DROP DATABASE ".
$Çme
;

51 
	}
}

61 
funùiÚ
 
	$_drİ_bË
(
$bË
)

64 .
$bË
."')) DROP TABLE [dbo].[".$table."]";

65 
	}
}

80 
funùiÚ
 
	$_ü—‹_bË
(
$bË
, 
$f›lds
, 
$´im¬y_keys
, 
$keys
, 
$if_nÙ_exi¡s
)

82 
$sql
 = '';

83 ià(
$if_nÙ_exi¡s
 ==ğ
TRUE
)

85 
$sql
 = "IF (NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = ";

87 
$sql
 .ğ
$this
->
db
->
	`_esÿ³_id’tif›rs
(
$bË
).")) CREATE TABLE ".$this->db->_escape_identifiers($table)." (";

88 
$cu¼’t_f›ld_couÁ
 = 0;

90 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
=>
$©Œibu‹s
)

95 ià(
	`is_num”ic
(
$f›ld
))

97 
$sql
 .= "\n\t$attributes";

101 
$©Œibu‹s
 = 
	`¬¿y_chªge_key_ÿ£
($©Œibu‹s, 
CASE_UPPER
);

103 
$sql
 .ğ"\n\t".
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$f›ld
);

105 
$sql
 .ğ' '.
$©Œibu‹s
['TYPE'];

107 ià(
	`¬¿y_key_exi¡s
('CONSTRAINT', 
$©Œibu‹s
))

109 
$sql
 .ğ'('.
$©Œibu‹s
['CONSTRAINT'].')';

112 ià(
	`¬¿y_key_exi¡s
('UNSIGNED', 
$©Œibu‹s
è&& $©Œibu‹s['UNSIGNED'] ==ğ
TRUE
)

114 
$sql
 .= ' UNSIGNED';

117 ià(
	`¬¿y_key_exi¡s
('DEFAULT', 
$©Œibu‹s
))

119 
$sql
 .ğ' DEFAULT \''.
$©Œibu‹s
['DEFAULT'].'\'';

122 ià(
	`¬¿y_key_exi¡s
('NULL', 
$©Œibu‹s
è&& $©Œibu‹s['NULL'] ==ğ
TRUE
)

124 
$sql
 .= ' NULL';

128 
$sql
 .= ' NOT NULL';

131 ià(
	`¬¿y_key_exi¡s
('AUTO_INCREMENT', 
$©Œibu‹s
è&& $©Œibu‹s['AUTO_INCREMENT'] ==ğ
TRUE
)

133 
$sql
 .= ' IDENTITY(1,1)';

138 ià(++
$cu¼’t_f›ld_couÁ
 < 
	`couÁ
(
$f›lds
))

140 
$sql
 .= ',';

144 ià(
	`couÁ
(
$´im¬y_keys
) > 0)

146 
$´im¬y_keys
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($primary_keys);

147 
$sql
 .ğ",\n\tPRIMARY KEY (" . 
	`im¶ode
(', ', 
$´im¬y_keys
) . ")";

150 ià(
	`is_¬¿y
(
$keys
è&& 
	`couÁ
($keys) > 0)

152 
	`fÜ—ch
 (
$keys
 
as
 
$key
)

154 ià(
	`is_¬¿y
(
$key
))

156 
$key
 = 
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key);

160 
$key
 = 
	`¬¿y
(
$this
->
db
->
	`_´Ùeù_id’tif›rs
($key));

163 
$sql
 .ğ",\n\tFOREIGN KEY (" . 
	`im¶ode
(', ', 
$key
) . ")";

167 
$sql
 .= "\n)";

169  
$sql
;

170 
	}
}

190 
funùiÚ
 
_®‹r_bË
(
$®‹r_ty³
, 
$bË
, 
$cŞumn_Çme
, 
$cŞumn_defš™iÚ
 = '', 
$deçuÉ_v®ue
 = '', 
$nuÎ
 = '', 
$aá”_f›ld
 = '')

192 
$sql
 = 'ALTER TABLE '.
$this
->
db
->
_´Ùeù_id’tif›rs
(
$bË
)." $®‹r_ty³ ".$this->db->_´Ùeù_id’tif›rs(
$cŞumn_Çme
);

195 ià(
	g$®‹r_ty³
 == 'DROP')

197  
$sql
;

200 
	g$sql
 .= " $column_definition";

202 ià(
	g$deçuÉ_v®ue
 != '')

204 
$sql
 .= " DEFAULT \"$default_value\"";

207 ià(
	g$nuÎ
 ==ğ
NULL
)

209 
$sql
 .= ' NULL';

213 
	g$sql
 .= ' NOT NULL';

216 ià(
	g$aá”_f›ld
 != '')

218 
$sql
 .ğ' AFTER ' . 
$this
->
db
->
_´Ùeù_id’tif›rs
(
$aá”_f›ld
);

221  
	g$sql
;

237 
funùiÚ
 
	$_»Çme_bË
(
$bË_Çme
, 
$Ãw_bË_Çme
)

239  'EXEC sp_»Çm'.
$this
->
db
->
	`_´Ùeù_id’tif›rs
(
$bË_Çme
).", ".$this->db->_´Ùeù_id’tif›rs(
$Ãw_bË_Çme
);

240 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlsrv/sqlsrv_result.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_DB_sql¤v_»suÉ
 
ex‹nds
 
	mCI_DB_»suÉ
 {

35 
funùiÚ
 
	$num_rows
()

37  @
	`sql¤v_num_rows
(
$this
->
»suÉ_id
);

48 
funùiÚ
 
	$num_f›lds
()

50  @
	`sql¤v_num_f›lds
(
$this
->
»suÉ_id
);

51 
	}
}

63 
funùiÚ
 
	$li¡_f›lds
()

65 
$f›ld_Çmes
 = 
	`¬¿y
();

66 
	`fÜ—ch
(
	`sql¤v_f›ld_m‘ad©a
(
$this
->
»suÉ_id
è
as
 
$off£t
 => 
$f›ld
)

68 
$f›ld_Çmes
[] = 
$f›ld
['Name'];

71  
$f›ld_Çmes
;

72 
	}
}

84 
funùiÚ
 
	$f›ld_d©a
()

86 
$»tv®
 = 
	`¬¿y
();

87 
	`fÜ—ch
(
	`sql¤v_f›ld_m‘ad©a
(
$this
->
»suÉ_id
è
as
 
$off£t
 => 
$f›ld
)

89 
$F
 = 
Ãw
 
	`¡dCÏss
();

90 
$F
->
Çme
 = 
$f›ld
['Name'];

91 
$F
->
ty³
 = 
$f›ld
['Type'];

92 
$F
->
max_Ëngth
 = 
$f›ld
['Size'];

93 
$F
->
´im¬y_key
 = 0;

94 
$F
-> = '';

96 
$»tv®
[] = 
$F
;

99  
$»tv®
;

100 
	}
}

109 
funùiÚ
 
	$ä“_»suÉ
()

111 ià(
	`is_»sourû
(
$this
->
»suÉ_id
))

113 
	`sql¤v_ä“_¡mt
(
$this
->
»suÉ_id
);

114 
$this
->
»suÉ_id
 = 
FALSE
;

116 
	}
}

130 
funùiÚ
 
	$_d©a_£ek
(
$n
 = 0)

133 
	}
}

145 
funùiÚ
 
	$_ãtch_assoc
()

147  
	`sql¤v_ãtch_¬¿y
(
$this
->
»suÉ_id
, 
SQLSRV_FETCH_ASSOC
);

148 
	}
}

160 
funùiÚ
 
	$_ãtch_objeù
()

162  
	`sql¤v_ãtch_objeù
(
$this
->
»suÉ_id
);

163 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlsrv/sqlsrv_utility.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

25 şas 
	cCI_DB_sql¤v_ut™y
 
ex‹nds
 
	mCI_DB_ut™y
 {

33 
funùiÚ
 
	$_li¡_d©aba£s
()

49 
funùiÚ
 
	$_İtimize_bË
(
$bË
)

51  
FALSE
;

52 
	}
}

65 
funùiÚ
 
	$_»·œ_bË
(
$bË
)

67  
FALSE
;

68 
	}
}

79 
funùiÚ
 
_backup
(
$·¿ms
 = 
	$¬¿y
())

82  
$this
->
db
->
	`di¥Ïy_”rÜ
('db_unsuported_feature');

83 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/array_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

42 iàĞ! 
funùiÚ_exi¡s
('element'))

44 
funùiÚ
 
–em’t
(
$™em
, 
$¬¿y
, 
$deçuÉ
 = 
FALSE
)

46 iàĞ! 
is£t
(
$¬¿y
[
$™em
]è
OR
 $array[$item] == "")

48  
$deçuÉ
;

51  
	g$¬¿y
[
$™em
];

64 iàĞ! 
funùiÚ_exi¡s
('random_element'))

66 
funùiÚ
 
¿ndom_–em’t
(
$¬¿y
)

68 iàĞ! 
is_¬¿y
(
$¬¿y
))

70  
	g$¬¿y
;

73  
	g$¬¿y
[
¬¿y_¿nd
(
$¬¿y
)];

91 iàĞ! 
funùiÚ_exi¡s
('elements'))

93 
funùiÚ
 
–em’ts
(
$™ems
, 
$¬¿y
, 
$deçuÉ
 = 
FALSE
)

95 
$»tuº
 = 
¬¿y
();

97 iàĞ! 
is_¬¿y
(
$™ems
))

99 
	g$™ems
 = 
¬¿y
(
$™ems
);

102 
fÜ—ch
 (
$™ems
 
as
 
$™em
)

104 ià(
is£t
(
$¬¿y
[
$™em
]))

106 
	g$»tuº
[
$™em
] = 
$¬¿y
[$item];

110 
	g$»tuº
[
$™em
] = 
$deçuÉ
;

114  
	g$»tuº
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/captcha_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

40 iàĞ! 
funùiÚ_exi¡s
('create_captcha'))

42 
funùiÚ
 
ü—‹_ÿ±cha
(
$d©a
 = '', 
$img_·th
 = '', 
$img_u¾
 = '', 
$fÚt_·th
 = '')

44 
$deçuÉs
 = 
¬¿y
('word' => '', 'img_path' => '', 'img_url' => '', 'img_width' => '150', 'img_height' => '30', 'font_path' => '', 'expiration' => 7200);

46 
fÜ—ch
 (
$deçuÉs
 
as
 
$key
 => 
$v®
)

48 iàĞ! 
is_¬¿y
(
$d©a
))

50 iàĞ! 
is£t
(
$$key
è
OR
 $$key == '')

52 
$$key
 = 
$v®
;

57 
	g$$key
 = ( ! 
is£t
(
$d©a
[
$key
])è? 
$v®
 : $data[$key];

61 ià(
	g$img_·th
 =ğ'' 
OR
 
$img_u¾
 == '')

63  
FALSE
;

66 iàĞ! @
is_dœ
(
$img_·th
))

68  
	gFALSE
;

71 iàĞ! 
is_wr™abË
(
$img_·th
))

73  
	gFALSE
;

76 iàĞ! 
ex‹nsiÚ_lßded
('gd'))

78  
	gFALSE
;

85 
li¡
(
$u£c
, 
$£c
èğ
ex¶ode
(" ", 
miüÙime
());

86 
	g$now
 = (()
$u£c
 + ()
$£c
);

88 
	g$cu¼’t_dœ
 = @
İ’dœ
(
$img_·th
);

90 
	g$f’ame
 = @
»addœ
(
$cu¼’t_dœ
))

92 ià(
$f’ame
 !ğ"." 
ªd
 $filename != ".."‡nd $filename != "index.html")

94 
$Çme
 = 
¡r_»¶aû
(".jpg", "", 
$f’ame
);

96 ià((
	g$Çme
 + 
	g$expœ©iÚ
è< 
	g$now
)

98 @
uÆšk
(
$img_·th
.
$f’ame
);

103 @
şo£dœ
(
$cu¼’t_dœ
);

109 ià(
	g$wÜd
 == '')

111 
$poŞ
 = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';

113 
	g$¡r
 = '';

114 
	g$i
 = 0; $i < 8; $i++)

116 
	g$¡r
 .ğ
sub¡r
(
$poŞ
, 
mt_¿nd
(0, 
¡¾’
($pool) -1), 1);

119 
	g$wÜd
 = 
$¡r
;

126 
	g$Ëngth
 = 
¡¾’
(
$wÜd
);

127 
	g$ªgË
 = (
$Ëngth
 >ğ6è? 
¿nd
(-($length-6), ($length-6)) : 0;

128 
	g$x_axis
 = 
¿nd
(6, (360/
$Ëngth
)-16);

129 
	g$y_axis
 = (
$ªgË
 >ğ0 ) ? 
¿nd
(
$img_height
, 
$img_width
) :„and(6, $img_height);

136 ià(
funùiÚ_exi¡s
('imagecreatetruecolor'))

138 
	g$im
 = 
imageü—‹ŒuecŞÜ
(
$img_width
, 
$img_height
);

142 
	g$im
 = 
imageü—‹
(
$img_width
, 
$img_height
);

149 
	g$bg_cŞÜ
 = 
imagecŞÜ®loÿ‹
 (
$im
, 255, 255, 255);

150 
	g$bÜd”_cŞÜ
 = 
imagecŞÜ®loÿ‹
 (
$im
, 153, 102, 102);

151 
	g$‹xt_cŞÜ
 = 
imagecŞÜ®loÿ‹
 (
$im
, 204, 153, 153);

152 
	g$grid_cŞÜ
 = 
imagecŞÜ®loÿ‹
(
$im
, 255, 182, 182);

153 
	g$shadow_cŞÜ
 = 
imagecŞÜ®loÿ‹
(
$im
, 255, 240, 240);

159 
ImageFËdReùªgË
(
$im
, 0, 0, 
$img_width
, 
$img_height
, 
$bg_cŞÜ
);

165 
	g$th‘a
 = 1;

166 
	g$th‘ac
 = 7;

167 
	g$¿dius
 = 16;

168 
	g$cœşes
 = 20;

169 
	g$pošts
 = 32;

171 
	g$i
 = 0; $˜< (
$cœşes
 * 
	g$pošts
) - 1; $i++)

173 
	g$th‘a
 = 
$th‘a
 + 
$th‘ac
;

174 
	g$¿d
 = 
$¿dius
 * (
$i
 / 
$pošts
 );

175 
	g$x
 = (
$¿d
 * 
cos
(
$th‘a
)è+ 
$x_axis
;

176 
	g$y
 = (
$¿d
 * 
sš
(
$th‘a
)è+ 
$y_axis
;

177 
	g$th‘a
 = 
$th‘a
 + 
$th‘ac
;

178 
	g$¿d1
 = 
$¿dius
 * ((
$i
 + 1è/ 
$pošts
);

179 
	g$x1
 = (
$¿d1
 * 
cos
(
$th‘a
)è+ 
$x_axis
;

180 
	g$y1
 = (
$¿d1
 * 
sš
(
$th‘a
 )è+ 
$y_axis
;

181 
imag–še
(
$im
, 
$x
, 
$y
, 
$x1
, 
$y1
, 
$grid_cŞÜ
);

182 
	g$th‘a
 = 
$th‘a
 - 
$th‘ac
;

189 
	g$u£_fÚt
 = (
$fÚt_·th
 !ğ'' 
AND
 
fe_exi¡s
($fÚt_·thèAND 
funùiÚ_exi¡s
('imag‘táext')è? 
TRUE
 : 
FALSE
;

191 ià(
	g$u£_fÚt
 =ğ
FALSE
)

193 
$fÚt_size
 = 5;

194 
	g$x
 = 
¿nd
(0, 
$img_width
/(
$Ëngth
/3));

195 
	g$y
 = 0;

199 
	g$fÚt_size
 = 16;

200 
	g$x
 = 
¿nd
(0, 
$img_width
/(
$Ëngth
/1.5));

201 
	g$y
 = 
$fÚt_size
+2;

204 
	g$i
 = 0; $˜< 
¡¾’
(
$wÜd
); $i++)

206 ià(
	g$u£_fÚt
 =ğ
FALSE
)

208 
$y
 = 
¿nd
(0 , 
$img_height
/2);

209 
image¡ršg
(
$im
, 
$fÚt_size
, 
$x
, 
$y
, 
sub¡r
(
$wÜd
, 
$i
, 1), 
$‹xt_cŞÜ
);

210 
	g$x
 +ğ(
$fÚt_size
*2);

214 
	g$y
 = 
¿nd
(
$img_height
/2, $img_height-3);

215 
imag‘táext
(
$im
, 
$fÚt_size
, 
$ªgË
, 
$x
, 
$y
, 
$‹xt_cŞÜ
, 
$fÚt_·th
, 
sub¡r
(
$wÜd
, 
$i
, 1));

216 
	g$x
 +ğ
$fÚt_size
;

225 
imag”eùªgË
(
$im
, 0, 0, 
$img_width
-1, 
$img_height
-1, 
$bÜd”_cŞÜ
);

231 
	g$img_Çme
 = 
$now
.'.jpg';

233 
ImageJPEG
(
$im
, 
$img_·th
.
$img_Çme
);

235 
	g$img
 = "<img src=\"$img_url$img_name\" width=\"$img_width\" height=\"$img_height\" style=\"border:0;\"‡lt=\" \" />";

237 
ImageDe¡roy
(
$im
);

239  
¬¿y
('wÜd' => 
$wÜd
, 'time' => 
$now
, 'image' => 
$img
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/cookie_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

45 iàĞ! 
funùiÚ_exi¡s
('set_cookie'))

47 
funùiÚ
 
£t_cook›
(
$Çme
 = '', 
$v®ue
 = '', 
$expœe
 = '', 
$domaš
 = '', 
$·th
 = '/', 
$´efix
 = '', 
$£cu»
 = 
FALSE
)

50 
$CI
 =& 
g‘_š¡ªû
();

51 
	g$CI
->
	gšput
->
£t_cook›
(
$Çme
, 
$v®ue
, 
$expœe
, 
$domaš
, 
$·th
, 
$´efix
, 
$£cu»
);

65 iàĞ! 
funùiÚ_exi¡s
('get_cookie'))

67 
funùiÚ
 
g‘_cook›
(
$šdex
 = '', 
$xss_ş—n
 = 
FALSE
)

69 
$CI
 =& 
g‘_š¡ªû
();

71 
	g$´efix
 = '';

73 iàĞ! 
is£t
(
$_COOKIE
[
$šdex
]è&& 
cÚfig_™em
('cookie_prefix') != '')

75 
$´efix
 = 
cÚfig_™em
('cookie_prefix');

78  
	g$CI
->
	gšput
->
cook›
(
$´efix
.
$šdex
, 
$xss_ş—n
);

93 iàĞ! 
funùiÚ_exi¡s
('delete_cookie'))

95 
funùiÚ
 
d–‘e_cook›
(
$Çme
 = '', 
$domaš
 = '', 
$·th
 = '/', 
$´efix
 = '')

97 
£t_cook›
(
$Çme
, '', '', 
$domaš
, 
$·th
, 
$´efix
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/date_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

38 iàĞ! 
funùiÚ_exi¡s
('now'))

40 
funùiÚ
 
now
()

42 
	g$CI
 =& 
g‘_š¡ªû
();

44 ià(
¡¹Şow”
(
$CI
->
cÚfig
->
™em
('time_reference')) == 'gmt')

46 
$now
 = 
time
();

47 
	g$sy¡em_time
 = 
mktime
(
gmd©e
("H", 
$now
), gmdate("i", $now), gmdate("s", $now), gmdate("m", $now), gmdate("d", $now), gmdate("Y", $now));

49 ià(
¡¾’
(
$sy¡em_time
) < 10)

51 
	g$sy¡em_time
 = 
time
();

52 
log_mes§ge
('error', 'The Date class could‚ot set‡…roper GMTimestamp sohe†ocalime() value was used.');

55  
	g$sy¡em_time
;

59  
time
();

83 iàĞ! 
funùiÚ_exi¡s
('mdate'))

85 
funùiÚ
 
md©e
(
$d©e¡r
 = '', 
$time
 = '')

87 ià(
$d©e¡r
 == '')

90 ià(
	g$time
 == '')

91 
$time
 = 
now
();

93 
	g$d©e¡r
 = 
¡r_»¶aû
('%\\', '', 
´eg_»¶aû
("/([a-z]+?){1}/i", "\\\\\\1", 
$d©e¡r
));

94  
d©e
(
$d©e¡r
, 
$time
);

110 iàĞ! 
funùiÚ_exi¡s
('standard_date'))

112 
funùiÚ
 
¡ªd¬d_d©e
(
$fmt
 = 'DATE_RFC822', 
$time
 = '')

114 
$fÜm©s
 = 
¬¿y
(

126 iàĞ! 
is£t
(
$fÜm©s
[
$fmt
]))

128  
	gFALSE
;

131  
md©e
(
$fÜm©s
[
$fmt
], 
$time
);

148 iàĞ! 
funùiÚ_exi¡s
('timespan'))

150 
funùiÚ
 
time¥ª
(
$£cÚds
 = 1, 
$time
 = '')

152 
$CI
 =& 
g‘_š¡ªû
();

153 
	g$CI
->
	gÏng
->
lßd
('date');

155 iàĞ! 
is_num”ic
(
$£cÚds
))

157 
	g$£cÚds
 = 1;

160 iàĞ! 
is_num”ic
(
$time
))

162 
	g$time
 = 
time
();

165 ià(
	g$time
 <ğ
$£cÚds
)

167 
$£cÚds
 = 1;

171 
	g$£cÚds
 = 
$time
 - 
$£cÚds
;

174 
	g$¡r
 = '';

175 
	g$y—rs
 = 
æoÜ
(
$£cÚds
 / 31536000);

177 ià(
	g$y—rs
 > 0)

179 
	g$¡r
 .ğ
$y—rs
.' '.
$CI
->
Ïng
->
lše
((($years > 1) ? 'date_years' : 'date_year')).', ';

182 
	g$£cÚds
 -ğ
$y—rs
 * 31536000;

183 
	g$mÚths
 = 
æoÜ
(
$£cÚds
 / 2628000);

185 ià(
	g$y—rs
 > 0 
OR
 
	g$mÚths
 > 0)

187 ià(
	g$mÚths
 > 0)

189 
	g$¡r
 .ğ
$mÚths
.' '.
$CI
->
Ïng
->
lše
((($months > 1) ? 'date_months' : 'date_month')).', ';

192 
	g$£cÚds
 -ğ
$mÚths
 * 2628000;

195 
	g$w“ks
 = 
æoÜ
(
$£cÚds
 / 604800);

197 ià(
	g$y—rs
 > 0 
OR
 
	g$mÚths
 > 0 OR 
	g$w“ks
 > 0)

199 ià(
	g$w“ks
 > 0)

201 
	g$¡r
 .ğ
$w“ks
.' '.
$CI
->
Ïng
->
lše
((($weeks > 1) ? 'date_weeks' : 'date_week')).', ';

204 
	g$£cÚds
 -ğ
$w“ks
 * 604800;

207 
	g$days
 = 
æoÜ
(
$£cÚds
 / 86400);

209 ià(
	g$mÚths
 > 0 
OR
 
	g$w“ks
 > 0 OR 
	g$days
 > 0)

211 ià(
	g$days
 > 0)

213 
	g$¡r
 .ğ
$days
.' '.
$CI
->
Ïng
->
lše
((($days > 1) ? 'date_days' : 'date_day')).', ';

216 
	g$£cÚds
 -ğ
$days
 * 86400;

219 
	g$hours
 = 
æoÜ
(
$£cÚds
 / 3600);

221 ià(
	g$days
 > 0 
OR
 
	g$hours
 > 0)

223 ià(
	g$hours
 > 0)

225 
	g$¡r
 .ğ
$hours
.' '.
$CI
->
Ïng
->
lše
((($hours > 1) ? 'date_hours' : 'date_hour')).', ';

228 
	g$£cÚds
 -ğ
$hours
 * 3600;

231 
	g$mšu‹s
 = 
æoÜ
(
$£cÚds
 / 60);

233 ià(
	g$days
 > 0 
OR
 
	g$hours
 > 0 OR 
	g$mšu‹s
 > 0)

235 ià(
	g$mšu‹s
 > 0)

237 
	g$¡r
 .ğ
$mšu‹s
.' '.
$CI
->
Ïng
->
lše
((($minutes > 1) ? 'date_minutes' : 'date_minute')).', ';

240 
	g$£cÚds
 -ğ
$mšu‹s
 * 60;

243 ià(
	g$¡r
 == '')

245 
$¡r
 .ğ
$£cÚds
.' '.
$CI
->
Ïng
->
lše
((($seconds > 1) ? 'date_seconds' : 'date_second')).', ';

248  
sub¡r
(
Œim
(
$¡r
), 0, -1);

265 iàĞ! 
funùiÚ_exi¡s
('days_in_month'))

267 
funùiÚ
 
days_š_mÚth
(
$mÚth
 = 0, 
$y—r
 = '')

269 ià(
$mÚth
 < 1 
OR
 $month > 12)

274 iàĞ! 
is_num”ic
(
$y—r
è
OR
 
¡¾’
($year) != 4)

276 
$y—r
 = 
d©e
('Y');

279 ià(
	g$mÚth
 == 2)

281 ià(
$y—r
 % 400 =ğ0 
OR
 ($y—¸% 4 =ğ0 
AND
 $year % 100 != 0))

287 
	g$days_š_mÚth
 = 
¬¿y
(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);

288  
	g$days_š_mÚth
[
$mÚth
 - 1];

301 iàĞ! 
funùiÚ_exi¡s
('local_to_gmt'))

303 
funùiÚ
 
loÿl_to_gmt
(
$time
 = '')

305 ià(
$time
 == '')

306 
$time
 = 
time
();

308  
mktime
Ğ
gmd©e
("H", 
$time
), gmdate("i", $time), gmdate("s", $time), gmdate("m", $time), gmdate("d", $time), gmdate("Y", $time));

327 iàĞ! 
funùiÚ_exi¡s
('gmt_to_local'))

329 
funùiÚ
 
gmt_to_loÿl
(
$time
 = '', 
$timezÚe
 = 'UTC', 
$d¡
 = 
FALSE
)

331 ià(
$time
 == '')

333  
now
();

336 
	g$time
 +ğ
timezÚes
(
$timezÚe
) * 3600;

338 ià(
	g$d¡
 =ğ
TRUE
)

340 
$time
 += 3600;

343  
	g$time
;

356 iàĞ! 
funùiÚ_exi¡s
('mysql_to_unix'))

358 
funùiÚ
 
mysql_to_unix
(
$time
 = '')

364 
$time
 = 
¡r_»¶aû
('-', '', $time);

365 
	g$time
 = 
¡r_»¶aû
(':', '', 
$time
);

366 
	g$time
 = 
¡r_»¶aû
(' ', '', 
$time
);

369  
mktime
(

370 
sub¡r
(
$time
, 8, 2),

371 
sub¡r
(
$time
, 10, 2),

372 
sub¡r
(
$time
, 12, 2),

373 
sub¡r
(
$time
, 4, 2),

374 
sub¡r
(
$time
, 6, 2),

375 
sub¡r
(
$time
, 0, 4)

393 iàĞ! 
funùiÚ_exi¡s
('unix_to_human'))

395 
funùiÚ
 
unix_to_humª
(
$time
 = '', 
$£cÚds
 = 
FALSE
, 
$fmt
 = 'us')

397 
$r
 = 
d©e
('Y', 
$time
).'-'.date('m', $time).'-'.date('d', $time).' ';

399 ià(
	g$fmt
 == 'us')

401 
$r
 .ğ
d©e
('h', 
$time
).':'.date('i', $time);

405 
	g$r
 .ğ
d©e
('H', 
$time
).':'.date('i', $time);

408 ià(
	g$£cÚds
)

410 
	g$r
 .ğ':'.
d©e
('s', 
$time
);

413 ià(
	g$fmt
 == 'us')

415 
$r
 .ğ' '.
d©e
('A', 
$time
);

418  
	g$r
;

433 iàĞ! 
funùiÚ_exi¡s
('human_to_unix'))

435 
funùiÚ
 
humª_to_unix
(
$d©e¡r
 = '')

437 ià(
$d©e¡r
 == '')

439  
FALSE
;

442 
	g$d©e¡r
 = 
Œim
(
$d©e¡r
);

443 
	g$d©e¡r
 = 
´eg_»¶aû
("/\040+/", ' ', 
$d©e¡r
);

445 iàĞ! 
´eg_m©ch
('/^[0-9]{2,4}\-[0-9]{1,2}\-[0-9]{1,2}\s[0-9]{1,2}:[0-9]{1,2}(?::[0-9]{1,2})?(?:\s[AP]M)?$/i', 
$d©e¡r
))

447  
	gFALSE
;

450 
	g$¥l™
 = 
ex¶ode
(' ', 
$d©e¡r
);

452 
	g$ex
 = 
ex¶ode
("-", 
$¥l™
['0']);

454 
	g$y—r
 = (
¡¾’
(
$ex
['0']) == 2) ? '20'.$ex['0'] : $ex['0'];

455 
	g$mÚth
 = (
¡¾’
(
$ex
['1']) == 1) ? '0'.$ex['1'] : $ex['1'];

456 
	g$day
 = (
¡¾’
(
$ex
['2']) == 1) ? '0'.$ex['2'] : $ex['2'];

458 
	g$ex
 = 
ex¶ode
(":", 
$¥l™
['1']);

460 
	g$hour
 = (
¡¾’
(
$ex
['0']) == 1) ? '0'.$ex['0'] : $ex['0'];

461 
	g$mš
 = (
¡¾’
(
$ex
['1']) == 1) ? '0'.$ex['1'] : $ex['1'];

463 ià(
is£t
(
$ex
['2']è&& 
´eg_m©ch
('/[0-9]{1,2}/', $ex['2']))

465 
	g$£c
 = (
¡¾’
(
$ex
['2']) == 1) ? '0'.$ex['2'] : $ex['2'];

470 
	g$£c
 = '00';

473 ià(
is£t
(
$¥l™
['2']))

475 
	g$ampm
 = 
¡¹Şow”
(
$¥l™
['2']);

477 ià(
sub¡r
(
$ampm
, 0, 1è=ğ'p' 
AND
 
$hour
 < 12)

478 
$hour
 = $hour + 12;

480 ià(
sub¡r
(
$ampm
, 0, 1è=ğ'a' 
AND
 
$hour
 == 12)

481 
$hour
 = '00';

483 ià(
¡¾’
(
$hour
) == 1)

484 
$hour
 = '0'.$hour;

487  
mktime
(
$hour
, 
$mš
, 
$£c
, 
$mÚth
, 
$day
, 
$y—r
);

504 iàĞ! 
funùiÚ_exi¡s
('timezone_menu'))

506 
funùiÚ
 
timezÚe_m’u
(
$deçuÉ
 = 'UTC', 
$şass
 = "", 
$Çme
 = 'timezones')

508 
$CI
 =& 
g‘_š¡ªû
();

509 
	g$CI
->
	gÏng
->
lßd
('date');

511 ià(
	g$deçuÉ
 == 'GMT')

512 
$deçuÉ
 = 'UTC';

514 
	g$m’u
 = '<£Ëù‚ame="'.
$Çme
.'"';

516 ià(
	g$şass
 != '')

518 
$m’u
 .ğ' cÏss="'.
$şass
.'"';

521 
	g$m’u
 .= ">\n";

523 
fÜ—ch
 (
timezÚes
(è
as
 
$key
 => 
$v®
)

525 
$£Ëùed
 = (
$deçuÉ
 =ğ
$key
) ? " selected='selected'" : '';

526 
	g$m’u
 .ğ"<İtiÚ v®ue='{$key}'{$£Ëùed}>".
$CI
->
Ïng
->
lše
(
$key
)."</option>\n";

529 
	g$m’u
 .= "</select>";

531  
	g$m’u
;

547 iàĞ! 
funùiÚ_exi¡s
('timezones'))

549 
funùiÚ
 
timezÚes
(
$tz
 = '')

554 
$zÚes
 = 
¬¿y
(

597 ià(
	g$tz
 == '')

599  
$zÚes
;

602 ià(
	g$tz
 == 'GMT')

603 
$tz
 = 'UTC';

605  ( ! 
is£t
(
$zÚes
[
$tz
])) ? 0 : $zones[$tz];

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/directory_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

42 iàĞ! 
funùiÚ_exi¡s
('directory_map'))

44 
funùiÚ
 
dœeùÜy_m­
(
$sourû_dœ
, 
$dœeùÜy_d•th
 = 0, 
$hidd’
 = 
FALSE
)

46 ià(
$å
 = @
İ’dœ
(
$sourû_dœ
))

48 
$fed©a
 = 
¬¿y
();

49 
	g$Ãw_d•th
 = 
$dœeùÜy_d•th
 - 1;

50 
	g$sourû_dœ
 = 
¹rim
(
$sourû_dœ
, 
DIRECTORY_SEPARATOR
).
	gDIRECTORY_SEPARATOR
;

52 
	gFALSE
 !=ğ(
$fe
 = 
»addœ
(
$å
)))

55 iàĞ! 
Œim
(
$fe
, '.'è
OR
 (
$hidd’
 =ğ
FALSE
 && $file[0] == '.'))

60 ià((
	g$dœeùÜy_d•th
 < 1 
OR
 
	g$Ãw_d•th
 > 0è&& @
is_dœ
(
$sourû_dœ
.
$fe
))

62 
	g$fed©a
[
$fe
] = 
dœeùÜy_m­
(
$sourû_dœ
.$fe.
DIRECTORY_SEPARATOR
, 
$Ãw_d•th
, 
$hidd’
);

66 
	g$fed©a
[] = 
$fe
;

70 
şo£dœ
(
$å
);

71  
	g$fed©a
;

74  
	gFALSE
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/download_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

40 iàĞ! 
funùiÚ_exi¡s
('force_download'))

42 
funùiÚ
 
fÜû_dowÆßd
(
$f’ame
 = '', 
$d©a
 = '')

44 ià(
$f’ame
 =ğ'' 
OR
 
$d©a
 == '')

46  
FALSE
;

51 ià(
	gFALSE
 ==ğ
¡½os
(
$f’ame
, '.'))

53  
	gFALSE
;

57 
	g$x
 = 
ex¶ode
('.', 
$f’ame
);

58 
	g$ex‹nsiÚ
 = 
’d
(
$x
);

61 ià(
defšed
('ENVIRONMENT'è
AND
 
is_fe
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/mimes.php'))

63 
šşude
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/mimes.php');

65 
–£if
 (
is_fe
(
APPPATH
.'config/mimes.php'))

67 
šşude
(
APPPATH
.'config/mimes.php');

71 iàĞ! 
is£t
(
$mimes
[
$ex‹nsiÚ
]))

73 
	g$mime
 = 'application/octet-stream';

77 
	g$mime
 = (
is_¬¿y
(
$mimes
[
$ex‹nsiÚ
])) ? $mimes[$extension][0] : $mimes[$extension];

81 ià(
¡½os
(
$_SERVER
['HTTP_USER_AGENT'], "MSIE"è!=ğ
FALSE
)

83 
h—d”
('CÚ‹Á-Ty³: "'.
$mime
.'"');

84 
h—d”
('CÚ‹Á-Di¥os™iÚ:‡‰achm’t; f’ame="'.
$f’ame
.'"');

85 
h—d”
('Expires: 0');

86 
h—d”
('Cache-Control: must-revalidate,…ost-check=0,…re-check=0');

87 
h—d”
("Content-Transfer-Encoding: binary");

88 
h—d”
('Pragma:…ublic');

89 
h—d”
("CÚ‹Á-L’gth: ".
¡¾’
(
$d©a
));

93 
h—d”
('CÚ‹Á-Ty³: "'.
$mime
.'"');

94 
h—d”
('CÚ‹Á-Di¥os™iÚ:‡‰achm’t; f’ame="'.
$f’ame
.'"');

95 
h—d”
("Content-Transfer-Encoding: binary");

96 
h—d”
('Expires: 0');

97 
h—d”
('Pragma:‚o-cache');

98 
h—d”
("CÚ‹Á-L’gth: ".
¡¾’
(
$d©a
));

101 
ex™
(
$d©a
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/email_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

36 iàĞ! 
funùiÚ_exi¡s
('valid_email'))

38 
funùiÚ
 
v®id_ema
(
$add»ss
)

40  ( ! 
´eg_m©ch
("/^([a-z0-9\+_\-]+)(\.[a-z0-9\+_\-]+)*@([a-z0-9\-]+\.)+[a-z]{2,6}$/ix", 
$add»ss
)è? 
	gFALSE
 : 
TRUE
;

52 iàĞ! 
funùiÚ_exi¡s
('send_email'))

54 
funùiÚ
 
£nd_ema
(
$»c›Á
, 
$subjeù
 = 'Te¡ƒma', 
$mes§ge
 = 'Hello World')

56  
ma
(
$»c›Á
, 
$subjeù
, 
$mes§ge
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/file_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

39 iàĞ! 
funùiÚ_exi¡s
('read_file'))

41 
funùiÚ
 
»ad_fe
(
$fe
)

43 iàĞ! 
fe_exi¡s
(
$fe
))

45  
	gFALSE
;

48 ià(
funùiÚ_exi¡s
('file_get_contents'))

50  
fe_g‘_cÚ‹Ás
(
$fe
);

53 iàĞ! 
	g$å
 = @
fİ’
(
$fe
, 
FOPEN_READ
))

55  
	gFALSE
;

58 
æock
(
$å
, 
LOCK_SH
);

60 
	g$d©a
 = '';

61 ià(
fesize
(
$fe
) > 0)

63 
	g$d©a
 =& 
ä—d
(
$å
, 
fesize
(
$fe
));

66 
æock
(
$å
, 
LOCK_UN
);

67 
fşo£
(
$å
);

69  
	g$d©a
;

86 iàĞ! 
funùiÚ_exi¡s
('write_file'))

88 
funùiÚ
 
wr™e_fe
(
$·th
, 
$d©a
, 
$mode
 = 
FOPEN_WRITE_CREATE_DESTRUCTIVE
)

90 iàĞ! 
$å
 = @
fİ’
(
$·th
, 
$mode
))

92  
	gFALSE
;

95 
æock
(
$å
, 
LOCK_EX
);

96 
fwr™e
(
$å
, 
$d©a
);

97 
æock
(
$å
, 
LOCK_UN
);

98 
fşo£
(
$å
);

100  
	gTRUE
;

119 iàĞ! 
funùiÚ_exi¡s
('delete_files'))

121 
funùiÚ
 
d–‘e_fes
(
$·th
, 
$d–_dœ
 = 
FALSE
, 
$Ëv–
 = 0)

124 
$·th
 = 
¹rim
($·th, 
DIRECTORY_SEPARATOR
);

126 iàĞ! 
	g$cu¼’t_dœ
 = @
İ’dœ
(
$·th
))

128  
FALSE
;

131 
	gFALSE
 !=ğ(
$f’ame
 = @
»addœ
(
$cu¼’t_dœ
)))

133 ià(
$f’ame
 !ğ"." 
ªd
 $filename != "..")

135 ià(
is_dœ
(
$·th
.
DIRECTORY_SEPARATOR
.
$f’ame
))

138 ià(
sub¡r
(
$f’ame
, 0, 1) != '.')

140 
d–‘e_fes
(
$·th
.
DIRECTORY_SEPARATOR
.
$f’ame
, 
$d–_dœ
, 
$Ëv–
 + 1);

145 
uÆšk
(
$·th
.
DIRECTORY_SEPARATOR
.
$f’ame
);

149 @
şo£dœ
(
$cu¼’t_dœ
);

151 ià(
	g$d–_dœ
 =ğ
TRUE
 
AND
 
$Ëv–
 > 0)

153  @
rmdœ
(
$·th
);

156  
	gTRUE
;

174 iàĞ! 
funùiÚ_exi¡s
('get_filenames'))

176 
funùiÚ
 
g‘_f’ames
(
$sourû_dœ
, 
$šşude_·th
 = 
FALSE
, 
$_»cursiÚ
 = FALSE)

178 
$_fed©a
 = 
¬¿y
();

180 ià(
	g$å
 = @
İ’dœ
(
$sourû_dœ
))

183 ià(
$_»cursiÚ
 ==ğ
FALSE
)

185 
$_fed©a
 = 
¬¿y
();

186 
	g$sourû_dœ
 = 
¹rim
(
»®·th
(
$sourû_dœ
), 
DIRECTORY_SEPARATOR
).
	gDIRECTORY_SEPARATOR
;

189 
	gFALSE
 !=ğ(
$fe
 = 
»addœ
(
$å
)))

191 ià(@
is_dœ
(
$sourû_dœ
.
$fe
è&& 
¡ºcmp
($file, '.', 1) !== 0)

193 
g‘_f’ames
(
$sourû_dœ
.
$fe
.
DIRECTORY_SEPARATOR
, 
$šşude_·th
, 
TRUE
);

195 
–£if
 (
¡ºcmp
(
$fe
, '.', 1) !== 0)

197 
$_fed©a
[] = (
$šşude_·th
 =ğ
TRUE
è? 
$sourû_dœ
.
$fe
 : $file;

200  
	g$_fed©a
;

204  
	gFALSE
;

225 iàĞ! 
funùiÚ_exi¡s
('get_dir_file_info'))

227 
funùiÚ
 
g‘_dœ_fe_šfo
(
$sourû_dœ
, 
$tİ_Ëv–_Úly
 = 
TRUE
, 
$_»cursiÚ
 = 
FALSE
)

229 
$_fed©a
 = 
¬¿y
();

230 
	g$»Ïtive_·th
 = 
$sourû_dœ
;

232 ià(
	g$å
 = @
İ’dœ
(
$sourû_dœ
))

235 ià(
$_»cursiÚ
 ==ğ
FALSE
)

237 
$_fed©a
 = 
¬¿y
();

238 
	g$sourû_dœ
 = 
¹rim
(
»®·th
(
$sourû_dœ
), 
DIRECTORY_SEPARATOR
).
	gDIRECTORY_SEPARATOR
;

242 
	gFALSE
 !=ğ(
$fe
 = 
»addœ
(
$å
)))

244 ià(@
is_dœ
(
$sourû_dœ
.
$fe
è
AND
 
¡ºcmp
($fe, '.', 1è!=ğ0 AND 
$tİ_Ëv–_Úly
 ==ğ
FALSE
)

246 
g‘_dœ_fe_šfo
(
$sourû_dœ
.
$fe
.
DIRECTORY_SEPARATOR
, 
$tİ_Ëv–_Úly
, 
TRUE
);

248 
–£if
 (
¡ºcmp
(
$fe
, '.', 1) !== 0)

250 
$_fed©a
[
$fe
] = 
g‘_fe_šfo
(
$sourû_dœ
.$file);

251 
	g$_fed©a
[
$fe
]['»Ïtive_·th'] = 
$»Ïtive_·th
;

255  
	g$_fed©a
;

259  
	gFALSE
;

279 iàĞ! 
funùiÚ_exi¡s
('get_file_info'))

281 
funùiÚ
 
g‘_fe_šfo
(
$fe
, 
$»tuºed_v®ues
 = 
¬¿y
('name', 'server_path', 'size', 'date'))

284 iàĞ! 
fe_exi¡s
(
$fe
))

286  
	gFALSE
;

289 ià(
is_¡ršg
(
$»tuºed_v®ues
))

291 
	g$»tuºed_v®ues
 = 
ex¶ode
(',', 
$»tuºed_v®ues
);

294 
fÜ—ch
 (
$»tuºed_v®ues
 
as
 
$key
)

296 
	g$key
)

299 
$fešfo
['Çme'] = 
sub¡r
(
¡¼chr
(
$fe
, 
DIRECTORY_SEPARATOR
), 1);

302 
$fešfo
['£rv”_·th'] = 
$fe
;

305 
$fešfo
['size'] = 
fesize
(
$fe
);

308 
$fešfo
['d©e'] = 
femtime
(
$fe
);

311 
$fešfo
['»adabË'] = 
is_»adabË
(
$fe
);

315 
$fešfo
['wr™abË'] = 
is_wr™abË
(
$fe
);

318 
$fešfo
['execubË'] = 
is_execubË
(
$fe
);

321 
$fešfo
['f•”ms'] = 
f•”ms
(
$fe
);

326  
	g$fešfo
;

345 iàĞ! 
funùiÚ_exi¡s
('get_mime_by_extension'))

347 
funùiÚ
 
g‘_mime_by_ex‹nsiÚ
(
$fe
)

349 
	g$ex‹nsiÚ
 = 
¡¹Şow”
(
sub¡r
(
¡¼chr
(
$fe
, '.'), 1));

351 
glob®
 
	g$mimes
;

353 iàĞ! 
is_¬¿y
(
$mimes
))

355 ià(
defšed
('ENVIRONMENT'è
AND
 
is_fe
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/mimes.php'))

357 
šşude
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/mimes.php');

359 
–£if
 (
is_fe
(
APPPATH
.'config/mimes.php'))

361 
šşude
(
APPPATH
.'config/mimes.php');

364 iàĞ! 
is_¬¿y
(
$mimes
))

366  
	gFALSE
;

370 ià(
¬¿y_key_exi¡s
(
$ex‹nsiÚ
, 
$mimes
))

372 ià(
is_¬¿y
(
$mimes
[
$ex‹nsiÚ
]))

375  
cu¼’t
(
$mimes
[
$ex‹nsiÚ
]);

379  
	g$mimes
[
$ex‹nsiÚ
];

384  
	gFALSE
;

401 iàĞ! 
funùiÚ_exi¡s
('symbolic_permissions'))

403 
funùiÚ
 
symbŞic_³rmissiÚs
(
$³rms
)

405 ià((
	g$³rms
 & 0xC000) == 0xC000)

407 
$symbŞic
 = 's';

409 
–£if
 ((
$³rms
 & 0xA000) == 0xA000)

411 
$symbŞic
 = 'l';

413 
–£if
 ((
$³rms
 & 0x8000) == 0x8000)

415 
$symbŞic
 = '-';

417 
–£if
 ((
$³rms
 & 0x6000) == 0x6000)

419 
$symbŞic
 = 'b';

421 
–£if
 ((
$³rms
 & 0x4000) == 0x4000)

423 
$symbŞic
 = 'd';

425 
–£if
 ((
$³rms
 & 0x2000) == 0x2000)

427 
$symbŞic
 = 'c';

429 
–£if
 ((
$³rms
 & 0x1000) == 0x1000)

431 
$symbŞic
 = 'p';

435 
	g$symbŞic
 = 'u';

439 
	g$symbŞic
 .ğ((
$³rms
 & 0x0100) ? 'r' : '-');

440 
	g$symbŞic
 .ğ((
$³rms
 & 0x0080) ? 'w' : '-');

441 
	g$symbŞic
 .ğ((
$³rms
 & 0x0040) ? (($perms & 0x0800) ? 's' : 'x' ) : (($perms & 0x0800) ? 'S' : '-'));

444 
	g$symbŞic
 .ğ((
$³rms
 & 0x0020) ? 'r' : '-');

445 
	g$symbŞic
 .ğ((
$³rms
 & 0x0010) ? 'w' : '-');

446 
	g$symbŞic
 .ğ((
$³rms
 & 0x0008) ? (($perms & 0x0400) ? 's' : 'x' ) : (($perms & 0x0400) ? 'S' : '-'));

449 
	g$symbŞic
 .ğ((
$³rms
 & 0x0004) ? 'r' : '-');

450 
	g$symbŞic
 .ğ((
$³rms
 & 0x0002) ? 'w' : '-');

451 
	g$symbŞic
 .ğ((
$³rms
 & 0x0001) ? (($perms & 0x0200) ? 't' : 'x' ) : (($perms & 0x0200) ? 'T' : '-'));

453  
	g$symbŞic
;

469 iàĞ! 
funùiÚ_exi¡s
('octal_permissions'))

471 
funùiÚ
 
où®_³rmissiÚs
(
$³rms
)

473  
sub¡r
(
¥rštf
('%o', 
$³rms
), -3);

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/form_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

41 iàĞ! 
funùiÚ_exi¡s
('form_open'))

43 
funùiÚ
 
fÜm_İ’
(
$aùiÚ
 = '', 
$©Œibu‹s
 = '', 
$hidd’
 = 
¬¿y
())

45 
$CI
 =& 
g‘_š¡ªû
();

47 ià(
	g$©Œibu‹s
 == '')

49 
$©Œibu‹s
 = 'method="post"';

53 ià(
	g$aùiÚ
 && 
¡½os
(
$aùiÚ
, '://'è==ğ
FALSE
)

55 
$aùiÚ
 = 
$CI
->
cÚfig
->
s™e_u¾
($action);

59 
$aùiÚ
 
OR
 
	g$aùiÚ
 = 
$CI
->
cÚfig
->
s™e_u¾
($CI->
uri
->
uri_¡ršg
());

61 
	g$fÜm
 = '<fÜm‡ùiÚ="'.
$aùiÚ
.'"';

63 
	g$fÜm
 .ğ
_©Œibu‹s_to_¡ršg
(
$©Œibu‹s
, 
TRUE
);

65 
	g$fÜm
 .= '>';

68 ià(
	g$CI
->
	gcÚfig
->
™em
('c¤f_´ÙeùiÚ'è==ğ
TRUE
 
AND
 ! (
¡½os
(
$aùiÚ
, 
$CI
->
cÚfig
->
ba£_u¾
()è==ğ
FALSE
 
OR
 sŒpos(
$fÜm
, 'method="get"')))

70 
	g$hidd’
[
$CI
->
£cur™y
->
g‘_c¤f_tok’_Çme
()] = $CI->£cur™y->
g‘_c¤f_hash
();

73 ià(
is_¬¿y
(
$hidd’
è
AND
 
couÁ
($hidden) > 0)

75 
	g$fÜm
 .ğ
¥rštf
("<div styË=\"di¥Ïy:nÚe\">%s</div>", 
fÜm_hidd’
(
$hidd’
));

78  
	g$fÜm
;

95 iàĞ! 
funùiÚ_exi¡s
('form_open_multipart'))

97 
funùiÚ
 
fÜm_İ’_muÉ¬t
(
$aùiÚ
 = '', 
$©Œibu‹s
 = 
¬¿y
(), 
$hidd’
 =‡rray())

99 ià(
is_¡ršg
(
$©Œibu‹s
))

101 
$©Œibu‹s
 .= 'ƒnctype="multipart/form-data"';

105 
	g$©Œibu‹s
['enctype'] = 'multipart/form-data';

108  
fÜm_İ’
(
$aùiÚ
, 
$©Œibu‹s
, 
$hidd’
);

125 iàĞ! 
funùiÚ_exi¡s
('form_hidden'))

127 
funùiÚ
 
fÜm_hidd’
(
$Çme
, 
$v®ue
 = '', 
$»cursšg
 = 
FALSE
)

129 
$fÜm
;

131 ià(
	g$»cursšg
 ==ğ
FALSE
)

133 
$fÜm
 = "\n";

136 ià(
is_¬¿y
(
$Çme
))

138 
fÜ—ch
 (
$Çme
 
as
 
$key
 => 
$v®
)

140 
fÜm_hidd’
(
$key
, 
$v®
, 
TRUE
);

142  
	g$fÜm
;

145 iàĞ! 
is_¬¿y
(
$v®ue
))

147 
	g$fÜm
 .ğ'<špuˆty³="hidd’"‚ame="'.
$Çme
.'" v®ue="'.
fÜm_´•
(
$v®ue
, $name).'" />'."\n";

151 
fÜ—ch
 (
$v®ue
 
as
 
$k
 => 
$v
)

153 
$k
 = (
is_št
($k)) ? '' : $k;

154 
fÜm_hidd’
(
$Çme
.'['.
$k
.']', 
$v
, 
TRUE
);

158  
	g$fÜm
;

173 iàĞ! 
funùiÚ_exi¡s
('form_input'))

175 
funùiÚ
 
fÜm_šput
(
$d©a
 = '', 
$v®ue
 = '', 
$exŒa
 = '')

177 
$deçuÉs
 = 
¬¿y
('ty³' => '‹xt', 'Çme' => (Ğ! 
is_¬¿y
(
$d©a
)è? $d©¨: ''), 'v®ue' => 
$v®ue
);

179  "<špuˆ".
_·r£_fÜm_©Œibu‹s
(
$d©a
, 
$deçuÉs
).
	g$exŒa
." />";

196 iàĞ! 
funùiÚ_exi¡s
('form_password'))

198 
funùiÚ
 
fÜm_·sswÜd
(
$d©a
 = '', 
$v®ue
 = '', 
$exŒa
 = '')

200 iàĞ! 
is_¬¿y
(
$d©a
))

202 
$d©a
 = 
¬¿y
('name' => $data);

205 
	g$d©a
['type'] = 'password';

206  
fÜm_šput
(
$d©a
, 
$v®ue
, 
$exŒa
);

223 iàĞ! 
funùiÚ_exi¡s
('form_upload'))

225 
funùiÚ
 
fÜm_u¶ßd
(
$d©a
 = '', 
$v®ue
 = '', 
$exŒa
 = '')

227 iàĞ! 
is_¬¿y
(
$d©a
))

229 
$d©a
 = 
¬¿y
('name' => $data);

232 
	g$d©a
['type'] = 'file';

233  
fÜm_šput
(
$d©a
, 
$v®ue
, 
$exŒa
);

248 iàĞ! 
funùiÚ_exi¡s
('form_textarea'))

250 
funùiÚ
 
fÜm_‹x»a
(
$d©a
 = '', 
$v®ue
 = '', 
$exŒa
 = '')

252 
$deçuÉs
 = 
¬¿y
('Çme' => (Ğ! 
is_¬¿y
(
$d©a
)) ? $data : ''), 'cols' => '40', 'rows' => '10');

254 iàĞ! 
is_¬¿y
(
$d©a
è
	gOR
 ! 
is£t
($data['value']))

256 
	g$v®
 = 
$v®ue
;

260 
	g$v®
 = 
$d©a
['value'];

261 
un£t
(
$d©a
['value']);

264 
	g$Çme
 = (
is_¬¿y
(
$d©a
)) ? $data['name'] : $data;

265  "<‹x»¨".
_·r£_fÜm_©Œibu‹s
(
$d©a
, 
$deçuÉs
).
	g$exŒa
.">".
fÜm_´•
(
$v®
, 
$Çme
)."</textarea>";

281 iàĞ! 
funùiÚ_exi¡s
('form_multiselect'))

283 
funùiÚ
 
fÜm_muÉi£Ëù
(
$Çme
 = '', 
$İtiÚs
 = 
¬¿y
(), 
$£Ëùed
 =‡¼ay(), 
$exŒa
 = '')

285 iàĞ! 
¡½os
(
$exŒa
, 'multiple'))

287 
$exŒa
 .= ' multiple="multiple"';

290  
fÜm_drİdown
(
$Çme
, 
$İtiÚs
, 
$£Ëùed
, 
$exŒa
);

306 iàĞ! 
funùiÚ_exi¡s
('form_dropdown'))

308 
funùiÚ
 
fÜm_drİdown
(
$Çme
 = '', 
$İtiÚs
 = 
¬¿y
(), 
$£Ëùed
 =‡¼ay(), 
$exŒa
 = '')

310 iàĞ! 
is_¬¿y
(
$£Ëùed
))

312 
$£Ëùed
 = 
¬¿y
($selected);

316 ià(
couÁ
(
$£Ëùed
) === 0)

319 ià(
is£t
(
$_POST
[
$Çme
]))

321 
$£Ëùed
 = 
¬¿y
(
$_POST
[
$Çme
]);

325 ià(
	g$exŒa
 !ğ''è
$exŒa
 = ' '.$extra;

327 
	g$muÉË
 = (
couÁ
(
$£Ëùed
è> 1 && 
¡½os
(
$exŒa
, 'muÉË'è==ğ
FALSE
) ? ' multiple="multiple"' : '';

329 
	g$fÜm
 = '<£Ëù‚ame="'.
$Çme
.'"'.
$exŒa
.
$muÉË
.">\n";

331 
fÜ—ch
 (
$İtiÚs
 
as
 
$key
 => 
$v®
)

333 
$key
 = (
¡ršg
) $key;

335 ià(
is_¬¿y
(
$v®
è&& ! 
em±y
($val))

337 
	g$fÜm
 .ğ'<İtgrou°Ïb–="'.
$key
.'">'."\n";

339 
fÜ—ch
 (
$v®
 
as
 
$İtgroup_key
 => 
$İtgroup_v®
)

341 
$£l
 = (
š_¬¿y
(
$İtgroup_key
, 
$£Ëùed
)) ? ' selected="selected"' : '';

343 
	g$fÜm
 .ğ'<İtiÚ v®ue="'.
$İtgroup_key
.'"'.
$£l
.'>'.(
¡ršg
è
$İtgroup_v®
."</option>\n";

346 
	g$fÜm
 .= '</optgroup>'."\n";

350 
	g$£l
 = (
š_¬¿y
(
$key
, 
$£Ëùed
)) ? ' selected="selected"' : '';

352 
	g$fÜm
 .ğ'<İtiÚ v®ue="'.
$key
.'"'.
$£l
.'>'.(
¡ršg
è
$v®
."</option>\n";

356 
	g$fÜm
 .= '</select>';

358  
	g$fÜm
;

374 iàĞ! 
funùiÚ_exi¡s
('form_checkbox'))

376 
funùiÚ
 
fÜm_checkbox
(
$d©a
 = '', 
$v®ue
 = '', 
$checked
 = 
FALSE
, 
$exŒa
 = '')

378 
$deçuÉs
 = 
¬¿y
('ty³' => 'checkbox', 'Çme' => (Ğ! 
is_¬¿y
(
$d©a
)è? $d©¨: ''), 'v®ue' => 
$v®ue
);

380 ià(
is_¬¿y
(
$d©a
è
AND
 
¬¿y_key_exi¡s
('checked', $data))

382 
	g$checked
 = 
$d©a
['checked'];

384 ià(
	g$checked
 =ğ
FALSE
)

386 
un£t
(
$d©a
['checked']);

390 
	g$d©a
['checked'] = 'checked';

394 ià(
	g$checked
 =ğ
TRUE
)

396 
$deçuÉs
['checked'] = 'checked';

400 
un£t
(
$deçuÉs
['checked']);

403  "<špuˆ".
_·r£_fÜm_©Œibu‹s
(
$d©a
, 
$deçuÉs
).
	g$exŒa
." />";

419 iàĞ! 
funùiÚ_exi¡s
('form_radio'))

421 
funùiÚ
 
fÜm_¿dio
(
$d©a
 = '', 
$v®ue
 = '', 
$checked
 = 
FALSE
, 
$exŒa
 = '')

423 iàĞ! 
is_¬¿y
(
$d©a
))

425 
$d©a
 = 
¬¿y
('name' => $data);

428 
	g$d©a
['type'] = 'radio';

429  
fÜm_checkbox
(
$d©a
, 
$v®ue
, 
$checked
, 
$exŒa
);

444 iàĞ! 
funùiÚ_exi¡s
('form_submit'))

446 
funùiÚ
 
fÜm_subm™
(
$d©a
 = '', 
$v®ue
 = '', 
$exŒa
 = '')

448 
$deçuÉs
 = 
¬¿y
('ty³' => 'subm™', 'Çme' => (Ğ! 
is_¬¿y
(
$d©a
)è? $d©¨: ''), 'v®ue' => 
$v®ue
);

450  "<špuˆ".
_·r£_fÜm_©Œibu‹s
(
$d©a
, 
$deçuÉs
).
	g$exŒa
." />";

465 iàĞ! 
funùiÚ_exi¡s
('form_reset'))

467 
funùiÚ
 
fÜm_»£t
(
$d©a
 = '', 
$v®ue
 = '', 
$exŒa
 = '')

469 
$deçuÉs
 = 
¬¿y
('ty³' => '»£t', 'Çme' => (Ğ! 
is_¬¿y
(
$d©a
)è? $d©¨: ''), 'v®ue' => 
$v®ue
);

471  "<špuˆ".
_·r£_fÜm_©Œibu‹s
(
$d©a
, 
$deçuÉs
).
	g$exŒa
." />";

486 iàĞ! 
funùiÚ_exi¡s
('form_button'))

488 
funùiÚ
 
fÜm_bu‰Ú
(
$d©a
 = '', 
$cÚ‹Á
 = '', 
$exŒa
 = '')

490 
$deçuÉs
 = 
¬¿y
('Çme' => (Ğ! 
is_¬¿y
(
$d©a
)) ? $data : ''), 'type' => 'button');

492 iàĞ
is_¬¿y
(
$d©a
è
AND
 
is£t
($data['content']))

494 
	g$cÚ‹Á
 = 
$d©a
['content'];

495 
un£t
(
$d©a
['content']);

498  "<bu‰Ú ".
_·r£_fÜm_©Œibu‹s
(
$d©a
, 
$deçuÉs
).
	g$exŒa
.">".
	g$cÚ‹Á
."</button>";

513 iàĞ! 
funùiÚ_exi¡s
('form_label'))

515 
funùiÚ
 
fÜm_Ïb–
(
$Ïb–_‹xt
 = '', 
$id
 = '', 
$©Œibu‹s
 = 
¬¿y
())

518 
$Ïb–
 = '<label';

520 ià(
	g$id
 != '')

522 
$Ïb–
 .= " for=\"$id\"";

525 ià(
is_¬¿y
(
$©Œibu‹s
è
AND
 
couÁ
($attributes) > 0)

527 
fÜ—ch
 (
$©Œibu‹s
 
as
 
$key
 => 
$v®
)

529 
$Ïb–
 .ğ' '.
$key
.'="'.
$v®
.'"';

533 
	g$Ïb–
 .= ">$label_text</label>";

535  
	g$Ïb–
;

551 iàĞ! 
funùiÚ_exi¡s
('form_fieldset'))

553 
funùiÚ
 
fÜm_f›ld£t
(
$Ëg’d_‹xt
 = '', 
$©Œibu‹s
 = 
¬¿y
())

555 
$f›ld£t
 = "<fieldset";

557 
	g$f›ld£t
 .ğ
_©Œibu‹s_to_¡ršg
(
$©Œibu‹s
, 
FALSE
);

559 
	g$f›ld£t
 .= ">\n";

561 ià(
	g$Ëg’d_‹xt
 != '')

563 
$f›ld£t
 .= "<legend>$legend_text</legend>\n";

566  
	g$f›ld£t
;

579 iàĞ! 
funùiÚ_exi¡s
('form_fieldset_close'))

581 
funùiÚ
 
fÜm_f›ld£t_şo£
(
$exŒa
 = '')

583  "</f›ld£t>".
$exŒa
;

596 iàĞ! 
funùiÚ_exi¡s
('form_close'))

598 
funùiÚ
 
fÜm_şo£
(
$exŒa
 = '')

600  "</fÜm>".
$exŒa
;

615 iàĞ! 
funùiÚ_exi¡s
('form_prep'))

617 
funùiÚ
 
fÜm_´•
(
$¡r
 = '', 
$f›ld_Çme
 = '')

619 
$´•³d_f›lds
 = 
¬¿y
();

622 ià(
is_¬¿y
(
$¡r
))

624 
fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

626 
$¡r
[
$key
] = 
fÜm_´•
(
$v®
);

629  
	g$¡r
;

632 ià(
	g$¡r
 === '')

641 ià(
is£t
(
$´•³d_f›lds
[
$f›ld_Çme
]))

643  
	g$¡r
;

646 
	g$¡r
 = 
html¥ecŸlch¬s
(
$¡r
);

649 
	g$¡r
 = 
¡r_»¶aû
(
¬¿y
("'", '"'),‡¼ay("&#39;", "&quÙ;"), 
$¡r
);

651 ià(
	g$f›ld_Çme
 != '')

653 
$´•³d_f›lds
[
$f›ld_Çme
] = $field_name;

656  
	g$¡r
;

673 iàĞ! 
funùiÚ_exi¡s
('set_value'))

675 
funùiÚ
 
£t_v®ue
(
$f›ld
 = '', 
$deçuÉ
 = '')

677 ià(
FALSE
 ==ğ(
$OBJ
 =& 
_g‘_v®id©iÚ_objeù
()))

679 iàĞ! 
is£t
(
$_POST
[
$f›ld
]))

681  
$deçuÉ
;

684  
fÜm_´•
(
$_POST
[
$f›ld
], $field);

687  
fÜm_´•
(
$OBJ
->
£t_v®ue
(
$f›ld
, 
$deçuÉ
), $field);

705 iàĞ! 
funùiÚ_exi¡s
('set_select'))

707 
funùiÚ
 
£t_£Ëù
(
$f›ld
 = '', 
$v®ue
 = '', 
$deçuÉ
 = 
FALSE
)

709 
$OBJ
 =& 
_g‘_v®id©iÚ_objeù
();

711 ià(
	g$OBJ
 ==ğ
FALSE
)

713 iàĞ! 
is£t
(
$_POST
[
$f›ld
]))

715 ià(
couÁ
(
$_POST
è==ğ0 
AND
 
$deçuÉ
 =ğ
TRUE
)

722 
	g$f›ld
 = 
$_POST
[
$f›ld
];

724 ià(
is_¬¿y
(
$f›ld
))

726 iàĞ! 
š_¬¿y
(
$v®ue
, 
$f›ld
))

733 ià((
	g$f›ld
 =ğ'' 
OR
 
$v®ue
 =ğ''èOR (
$f›ld
 != $value))

742  
	g$OBJ
->
£t_£Ëù
(
$f›ld
, 
$v®ue
, 
$deçuÉ
);

760 iàĞ! 
funùiÚ_exi¡s
('set_checkbox'))

762 
funùiÚ
 
£t_checkbox
(
$f›ld
 = '', 
$v®ue
 = '', 
$deçuÉ
 = 
FALSE
)

764 
$OBJ
 =& 
_g‘_v®id©iÚ_objeù
();

766 ià(
	g$OBJ
 ==ğ
FALSE
)

768 iàĞ! 
is£t
(
$_POST
[
$f›ld
]))

770 ià(
couÁ
(
$_POST
è==ğ0 
AND
 
$deçuÉ
 =ğ
TRUE
)

777 
	g$f›ld
 = 
$_POST
[
$f›ld
];

779 ià(
is_¬¿y
(
$f›ld
))

781 iàĞ! 
š_¬¿y
(
$v®ue
, 
$f›ld
))

788 ià((
	g$f›ld
 =ğ'' 
OR
 
$v®ue
 =ğ''èOR (
$f›ld
 != $value))

797  
	g$OBJ
->
£t_checkbox
(
$f›ld
, 
$v®ue
, 
$deçuÉ
);

815 iàĞ! 
funùiÚ_exi¡s
('set_radio'))

817 
funùiÚ
 
£t_¿dio
(
$f›ld
 = '', 
$v®ue
 = '', 
$deçuÉ
 = 
FALSE
)

819 
$OBJ
 =& 
_g‘_v®id©iÚ_objeù
();

821 ià(
	g$OBJ
 ==ğ
FALSE
)

823 iàĞ! 
is£t
(
$_POST
[
$f›ld
]))

825 ià(
couÁ
(
$_POST
è==ğ0 
AND
 
$deçuÉ
 =ğ
TRUE
)

832 
	g$f›ld
 = 
$_POST
[
$f›ld
];

834 ià(
is_¬¿y
(
$f›ld
))

836 iàĞ! 
š_¬¿y
(
$v®ue
, 
$f›ld
))

843 ià((
	g$f›ld
 =ğ'' 
OR
 
$v®ue
 =ğ''èOR (
$f›ld
 != $value))

852  
	g$OBJ
->
£t_¿dio
(
$f›ld
, 
$v®ue
, 
$deçuÉ
);

870 iàĞ! 
funùiÚ_exi¡s
('form_error'))

872 
funùiÚ
 
fÜm_”rÜ
(
$f›ld
 = '', 
$´efix
 = '', 
$suffix
 = '')

874 ià(
FALSE
 ==ğ(
$OBJ
 =& 
_g‘_v®id©iÚ_objeù
()))

879  
	g$OBJ
->
”rÜ
(
$f›ld
, 
$´efix
, 
$suffix
);

896 iàĞ! 
funùiÚ_exi¡s
('validation_errors'))

898 
funùiÚ
 
v®id©iÚ_”rÜs
(
$´efix
 = '', 
$suffix
 = '')

900 ià(
FALSE
 ==ğ(
$OBJ
 =& 
_g‘_v®id©iÚ_objeù
()))

905  
	g$OBJ
->
”rÜ_¡ršg
(
$´efix
, 
$suffix
);

921 iàĞ! 
funùiÚ_exi¡s
('_parse_form_attributes'))

923 
funùiÚ
 
_·r£_fÜm_©Œibu‹s
(
$©Œibu‹s
, 
$deçuÉ
)

925 ià(
is_¬¿y
(
$©Œibu‹s
))

927 
fÜ—ch
 (
$deçuÉ
 
as
 
$key
 => 
$v®
)

929 ià(
is£t
(
$©Œibu‹s
[
$key
]))

931 
$deçuÉ
[
$key
] = 
$©Œibu‹s
[$key];

932 
un£t
(
$©Œibu‹s
[
$key
]);

936 ià(
couÁ
(
$©Œibu‹s
) > 0)

938 
	g$deçuÉ
 = 
¬¿y_m”ge
(
$deçuÉ
, 
$©Œibu‹s
);

942 
	g$©t
 = '';

944 
fÜ—ch
 (
$deçuÉ
 
as
 
$key
 => 
$v®
)

946 ià(
$key
 == 'value')

948 
$v®
 = 
fÜm_´•
($v®, 
$deçuÉ
['name']);

951 
	g$©t
 .ğ
$key
 . '="' . 
$v®
 . '" ';

954  
	g$©t
;

970 iàĞ! 
funùiÚ_exi¡s
('_attributes_to_string'))

972 
funùiÚ
 
_©Œibu‹s_to_¡ršg
(
$©Œibu‹s
, 
$fÜmg
 = 
FALSE
)

974 ià(
is_¡ršg
(
$©Œibu‹s
è
AND
 
¡¾’
($attributes) > 0)

976 ià(
$fÜmg
 =ğ
TRUE
 
AND
 
¡½os
(
$©Œibu‹s
, 'm‘hod='è==ğ
FALSE
)

978 
$©Œibu‹s
 .= ' method="post"';

981 ià(
	g$fÜmg
 =ğ
TRUE
 
AND
 
¡½os
(
$©Œibu‹s
, 'acû±-ch¬£t='è==ğ
FALSE
)

983 
$©Œibu‹s
 .ğ'‡cû±-ch¬£t="'.
¡¹Şow”
(
cÚfig_™em
('charset')).'"';

986  ' '.
	g$©Œibu‹s
;

989 ià(
is_objeù
(
$©Œibu‹s
è
AND
 
couÁ
($attributes) > 0)

991 
	g$©Œibu‹s
 = (
¬¿y
)
$©Œibu‹s
;

994 ià(
is_¬¿y
(
$©Œibu‹s
è
AND
 
couÁ
($attributes) > 0)

996 
	g$©ts
 = '';

998 iàĞ! 
is£t
(
$©Œibu‹s
['m‘hod']è
AND
 
	g$fÜmg
 ==ğ
TRUE
)

1000 
$©ts
 .= ' method="post"';

1003 iàĞ! 
is£t
(
$©Œibu‹s
['acû±-ch¬£t']è
AND
 
	g$fÜmg
 ==ğ
TRUE
)

1005 
$©ts
 .ğ'‡cû±-ch¬£t="'.
¡¹Şow”
(
cÚfig_™em
('charset')).'"';

1008 
fÜ—ch
 (
$©Œibu‹s
 
as
 
$key
 => 
$v®
)

1010 
$©ts
 .ğ' '.
$key
.'="'.
$v®
.'"';

1013  
	g$©ts
;

1029 iàĞ! 
funùiÚ_exi¡s
('_get_validation_object'))

1031 
	gfunùiÚ
 &
_g‘_v®id©iÚ_objeù
()

1033 
	g$CI
 =& 
g‘_š¡ªû
();

1036 
	g$»tuº
 = 
FALSE
;

1038 ià(
	gFALSE
 !=ğ(
$objeù
 = 
$CI
->
lßd
->
is_lßded
('form_validation')))

1040 iàĞ! 
is£t
(
$CI
->
$objeù
è
OR
 ! 
is_objeù
($CI->$object))

1042  
$»tuº
;

1045  
	g$CI
->
	g$objeù
;

1048  
	g$»tuº
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/html_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

41 iàĞ! 
funùiÚ_exi¡s
('heading'))

43 
funùiÚ
 
h—dšg
(
$d©a
 = '', 
$h
 = '1', 
$©Œibu‹s
 = '')

45 
$©Œibu‹s
 = ($attributes != '') ? ' '.$attributes : $attributes;

46  "<h".
	g$h
.
	g$©Œibu‹s
.">".
	g$d©a
."</h".$h.">";

62 iàĞ! 
funùiÚ_exi¡s
('ul'))

64 
funùiÚ
 
ul
(
$li¡
, 
$©Œibu‹s
 = '')

66  
_li¡
('ul', 
$li¡
, 
$©Œibu‹s
);

82 iàĞ! 
funùiÚ_exi¡s
('ol'))

84 
funùiÚ
 
Ş
(
$li¡
, 
$©Œibu‹s
 = '')

86  
_li¡
('Ş', 
$li¡
, 
$©Œibu‹s
);

104 iàĞ! 
funùiÚ_exi¡s
('_list'))

106 
funùiÚ
 
_li¡
(
$ty³
 = 'ul', 
$li¡
, 
$©Œibu‹s
 = '', 
$d•th
 = 0)

109 iàĞ! 
is_¬¿y
(
$li¡
))

111  
$li¡
;

115 
	g$out
 = 
¡r_»³©
(" ", 
$d•th
);

118 ià(
is_¬¿y
(
$©Œibu‹s
))

120 
	g$©ts
 = '';

121 
fÜ—ch
 (
$©Œibu‹s
 
as
 
$key
 => 
$v®
)

123 
$©ts
 .ğ' ' . 
$key
 . '="' . 
$v®
 . '"';

125 
	g$©Œibu‹s
 = 
$©ts
;

127 
–£if
 (
is_¡ršg
(
$©Œibu‹s
è
AND
 
¡¾’
($attributes) > 0)

129 
	g$©Œibu‹s
 = ' '. 
$©Œibu‹s
;

133 
	g$out
 .ğ"<".
$ty³
.
$©Œibu‹s
.">\n";

138 
	g$_Ï¡_li¡_™em
 = '';

139 
fÜ—ch
 (
$li¡
 
as
 
$key
 => 
$v®
)

141 
$_Ï¡_li¡_™em
 = 
$key
;

143 
	g$out
 .ğ
¡r_»³©
(" ", 
$d•th
 + 2);

144 
	g$out
 .= "<li>";

146 iàĞ! 
is_¬¿y
(
$v®
))

148 
	g$out
 .ğ
$v®
;

152 
	g$out
 .ğ
$_Ï¡_li¡_™em
."\n";

153 
	g$out
 .ğ
_li¡
(
$ty³
, 
$v®
, '', 
$d•th
 + 4);

154 
	g$out
 .ğ
¡r_»³©
(" ", 
$d•th
 + 2);

157 
	g$out
 .= "</li>\n";

161 
	g$out
 .ğ
¡r_»³©
(" ", 
$d•th
);

164 
	g$out
 .ğ"</".
$ty³
.">\n";

166  
	g$out
;

179 iàĞ! 
funùiÚ_exi¡s
('br'))

181 
funùiÚ
 
br
(
$num
 = 1)

183  
¡r_»³©
("<b¸/>", 
$num
);

198 iàĞ! 
funùiÚ_exi¡s
('img'))

200 
funùiÚ
 
img
(
$¤c
 = '', 
$šdex_·ge
 = 
FALSE
)

202 iàĞ! 
is_¬¿y
(
$¤c
) )

204 
$¤c
 = 
¬¿y
('src' => $src);

208 iàĞ! 
is£t
(
$¤c
['alt']))

210 
	g$¤c
['alt'] = '';

213 
	g$img
 = '<img';

215 
fÜ—ch
 (
$¤c
 
as
 
$k
=>
$v
)

218 ià(
$k
 =ğ'¤c' 
AND
 
¡½os
(
$v
, '://'è==ğ
FALSE
)

220 
$CI
 =& 
g‘_š¡ªû
();

222 ià(
	g$šdex_·ge
 ==ğ
TRUE
)

224 
$img
 .ğ' src="'.
$CI
->
cÚfig
->
s™e_u¾
(
$v
).'"';

228 
	g$img
 .ğ' src="'.
$CI
->
cÚfig
->
¦ash_™em
('ba£_u¾').
$v
.'"';

233 
	g$img
 .= " $k=\"$v\"";

237 
	g$img
 .= '/>';

239  
	g$img
;

258 iàĞ! 
funùiÚ_exi¡s
('doctype'))

260 
funùiÚ
 
doùy³
(
$ty³
 = 'xhtml1-strict')

262 
glob®
 
$_doùy³s
;

264 iàĞ! 
is_¬¿y
(
$_doùy³s
))

266 ià(
defšed
('ENVIRONMENT'è
AND
 
is_fe
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/doctypes.php'))

268 
šşude
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/doctypes.php');

270 
–£if
 (
is_fe
(
APPPATH
.'config/doctypes.php'))

272 
šşude
(
APPPATH
.'config/doctypes.php');

275 iàĞ! 
is_¬¿y
(
$_doùy³s
))

277  
	gFALSE
;

281 ià(
is£t
(
$_doùy³s
[
$ty³
]))

283  
	g$_doùy³s
[
$ty³
];

287  
	gFALSE
;

308 iàĞ! 
funùiÚ_exi¡s
('link_tag'))

310 
funùiÚ
 
lšk_g
(
$h»f
 = '', 
$»l
 = '¡yËsh“t', 
$ty³
 = '‹xt/css', 
$t™Ë
 = '', 
$medŸ
 = '', 
$šdex_·ge
 = 
FALSE
)

312 
$CI
 =& 
g‘_š¡ªû
();

314 
	g$lšk
 = '<link ';

316 ià(
is_¬¿y
(
$h»f
))

318 
fÜ—ch
 (
$h»f
 
as
 
$k
=>
$v
)

320 ià(
$k
 =ğ'h»f' 
AND
 
¡½os
(
$v
, '://'è==ğ
FALSE
)

322 ià(
$šdex_·ge
 ==ğ
TRUE
)

324 
$lšk
 .ğ'h»f="'.
$CI
->
cÚfig
->
s™e_u¾
(
$v
).'" ';

328 
	g$lšk
 .ğ'h»f="'.
$CI
->
cÚfig
->
¦ash_™em
('ba£_u¾').
$v
.'" ';

333 
	g$lšk
 .= "$k=\"$v\" ";

337 
	g$lšk
 .= "/>";

341 iàĞ
¡½os
(
$h»f
, '://'è!=ğ
FALSE
)

343 
$lšk
 .ğ'h»f="'.
$h»f
.'" ';

345 
–£if
 (
$šdex_·ge
 ==ğ
TRUE
)

347 
$lšk
 .ğ'h»f="'.
$CI
->
cÚfig
->
s™e_u¾
(
$h»f
).'" ';

351 
	g$lšk
 .ğ'h»f="'.
$CI
->
cÚfig
->
¦ash_™em
('ba£_u¾').
$h»f
.'" ';

354 
	g$lšk
 .ğ'»l="'.
$»l
.'"y³="'.
$ty³
.'" ';

356 ià(
	g$medŸ
 != '')

358 
$lšk
 .ğ'medŸ="'.
$medŸ
.'" ';

361 ià(
	g$t™Ë
 != '')

363 
$lšk
 .ğ't™Ë="'.
$t™Ë
.'" ';

366 
	g$lšk
 .= '/>';

370  
	g$lšk
;

383 iàĞ! 
funùiÚ_exi¡s
('meta'))

385 
funùiÚ
 
m‘a
(
$Çme
 = '', 
$cÚ‹Á
 = '', 
$ty³
 = 'Çme', 
$Ãwlše
 = "\n")

389 iàĞ! 
is_¬¿y
(
$Çme
))

391 
$Çme
 = 
¬¿y
×¼ay('Çme' => $Çme, 'cÚ‹Á' => 
$cÚ‹Á
, 'ty³' => 
$ty³
, 'Ãwlše' => 
$Ãwlše
));

396 ià(
is£t
(
$Çme
['name']))

398 
	g$Çme
 = 
¬¿y
(
$Çme
);

402 
	g$¡r
 = '';

403 
fÜ—ch
 (
$Çme
 
as
 
$m‘a
)

405 
	g$ty³
 = ( ! 
is£t
(
$m‘a
['ty³']è
OR
 $meta['type'] == 'name') ? 'name' : 'http-equiv';

406 
	g$Çme
 = ( ! 
is£t
(
$m‘a
['name'])) ? '' : $meta['name'];

407 
	g$cÚ‹Á
 = ( ! 
is£t
(
$m‘a
['content'])) ? '' : $meta['content'];

408 
	g$Ãwlše
 = ( ! 
is£t
(
$m‘a
['newline'])) ? "\n" : $meta['newline'];

410 
	g$¡r
 .ğ'<m‘¨'.
$ty³
.'="'.
$Çme
.'" cÚ‹Á="'.
$cÚ‹Á
.'" />'.
$Ãwlše
;

413  
	g$¡r
;

426 iàĞ! 
funùiÚ_exi¡s
('nbs'))

428 
funùiÚ
 
nbs
(
$num
 = 1)

430  
¡r_»³©
("&nb¥;", 
$num
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/inflector_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

40 iàĞ! 
funùiÚ_exi¡s
('singular'))

42 
funùiÚ
 
sšguÏr
(
$¡r
)

44 
	g$»suÉ
 = 
¡rv®
(
$¡r
);

46 
	g$sšguÏr_ruËs
 = 
¬¿y
(

76 
fÜ—ch
 (
$sšguÏr_ruËs
 
as
 
$ruË
 => 
$»¶aûm’t
)

78 ià(
´eg_m©ch
(
$ruË
, 
$»suÉ
))

80 
$»suÉ
 = 
´eg_»¶aû
(
$ruË
, 
$»¶aûm’t
, $result);

85  
	g$»suÉ
;

101 iàĞ! 
funùiÚ_exi¡s
('plural'))

103 
funùiÚ
 
¶u¿l
(
$¡r
, 
$fÜû
 = 
FALSE
)

105 
$»suÉ
 = 
¡rv®
(
$¡r
);

107 
	g$¶u¿l_ruËs
 = 
¬¿y
(

129 
fÜ—ch
 (
$¶u¿l_ruËs
 
as
 
$ruË
 => 
$»¶aûm’t
)

131 ià(
´eg_m©ch
(
$ruË
, 
$»suÉ
))

133 
$»suÉ
 = 
´eg_»¶aû
(
$ruË
, 
$»¶aûm’t
, $result);

138  
	g$»suÉ
;

153 iàĞ! 
funùiÚ_exi¡s
('camelize'))

155 
funùiÚ
 
ÿm–ize
(
$¡r
)

157 
	g$¡r
 = 'x'.
¡¹Şow”
(
Œim
(
$¡r
));

158 
	g$¡r
 = 
ucwÜds
(
´eg_»¶aû
('/[\s_]+/', ' ', 
$¡r
));

159  
sub¡r
(
¡r_»¶aû
(' ', '', 
$¡r
), 1);

174 iàĞ! 
funùiÚ_exi¡s
('underscore'))

176 
funùiÚ
 
und”scÜe
(
$¡r
)

178  
´eg_»¶aû
('/[\s]+/', '_', 
¡¹Şow”
(
Œim
(
$¡r
)));

193 iàĞ! 
funùiÚ_exi¡s
('humanize'))

195 
funùiÚ
 
humªize
(
$¡r
)

197  
ucwÜds
(
´eg_»¶aû
('/[_]+/', ' ', 
¡¹Şow”
(
Œim
(
$¡r
))));

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/language_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

40 iàĞ! 
funùiÚ_exi¡s
('lang'))

42 
funùiÚ
 
Ïng
(
$lše
, 
$id
 = '')

44 
$CI
 =& 
g‘_š¡ªû
();

45 
	g$lše
 = 
$CI
->
Ïng
->
lše
(
$lše
);

47 ià(
	g$id
 != '')

49 
$lše
 = '<Ïb– fÜ="'.
$id
.'">'.$line."</label>";

52  
	g$lše
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/number_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

37 iàĞ! 
funùiÚ_exi¡s
('byte_format'))

39 
funùiÚ
 
by‹_fÜm©
(
$num
, 
$´ecisiÚ
 = 1)

41 
$CI
 =& 
g‘_š¡ªû
();

42 
	g$CI
->
	gÏng
->
lßd
('number');

44 ià(
	g$num
 >= 1000000000000)

46 
$num
 = 
round
($num / 1099511627776, 
$´ecisiÚ
);

47 
	g$un™
 = 
$CI
->
Ïng
->
lše
('terabyte_abbr');

49 
–£if
 (
$num
 >= 1000000000)

51 
$num
 = 
round
($num / 1073741824, 
$´ecisiÚ
);

52 
	g$un™
 = 
$CI
->
Ïng
->
lše
('gigabyte_abbr');

54 
–£if
 (
$num
 >= 1000000)

56 
$num
 = 
round
($num / 1048576, 
$´ecisiÚ
);

57 
	g$un™
 = 
$CI
->
Ïng
->
lše
('megabyte_abbr');

59 
–£if
 (
$num
 >= 1000)

61 
$num
 = 
round
($num / 1024, 
$´ecisiÚ
);

62 
	g$un™
 = 
$CI
->
Ïng
->
lše
('kilobyte_abbr');

66 
	g$un™
 = 
$CI
->
Ïng
->
lše
('bytes');

67  
numb”_fÜm©
(
$num
).' '.
	g$un™
;

70  
numb”_fÜm©
(
$num
, 
$´ecisiÚ
).' '.
	g$un™
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/path_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

38 iàĞ! 
funùiÚ_exi¡s
('set_realpath'))

40 
funùiÚ
 
£t_»®·th
(
$·th
, 
$check_exi¡ªû
 = 
FALSE
)

43 ià(
´eg_m©ch
("#^(h‰p:\/\/|h‰ps:\/\/|www\.|áp|[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})#i", 
$·th
))

45 
show_”rÜ
('The…ath you submitted must be‡†ocal server…ath,‚ot‡ URL');

49 ià(
funùiÚ_exi¡s
('»®·th'è
	gAND
 @
»®·th
(
$·th
è!=ğ
FALSE
)

51 
$·th
 = 
»®·th
($path).'/';

55 
	g$·th
 = 
´eg_»¶aû
("#([^/])/*$#", "\\1/", 
$·th
);

58 ià(
	g$check_exi¡ªû
 =ğ
TRUE
)

60 iàĞ! 
is_dœ
(
$·th
))

62 
show_”rÜ
('NÙ‡ v®id…©h: '.
$·th
);

66  
	g$·th
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/security_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

38 iàĞ! 
funùiÚ_exi¡s
('xss_clean'))

40 
funùiÚ
 
xss_ş—n
(
$¡r
, 
$is_image
 = 
FALSE
)

42 
$CI
 =& 
g‘_š¡ªû
();

43  
	g$CI
->
	g£cur™y
->
xss_ş—n
(
$¡r
, 
$is_image
);

56 iàĞ! 
funùiÚ_exi¡s
('sanitize_filename'))

58 
funùiÚ
 
§n™ize_f’ame
(
$f’ame
)

60 
	g$CI
 =& 
g‘_š¡ªû
();

61  
	g$CI
->
	g£cur™y
->
§n™ize_f’ame
(
$f’ame
);

74 iàĞ! 
funùiÚ_exi¡s
('do_hash'))

76 
funùiÚ
 
do_hash
(
$¡r
, 
$ty³
 = 'sha1')

78 ià(
$ty³
 == 'sha1')

80  
sha1
(
$¡r
);

84  
md5
(
$¡r
);

98 iàĞ! 
funùiÚ_exi¡s
('strip_image_tags'))

100 
funùiÚ
 
¡r_image_gs
(
$¡r
)

102 
	g$¡r
 = 
´eg_»¶aû
("#<img\s+.*?¤c\s*=\s*[\"'](.+?)[\"'].*?\>#", "\\1", 
$¡r
);

103 
	g$¡r
 = 
´eg_»¶aû
("#<img\s+.*?¤c\s*=\s*(.+?).*?\>#", "\\1", 
$¡r
);

105  
	g$¡r
;

118 iàĞ! 
funùiÚ_exi¡s
('encode_php_tags'))

120 
funùiÚ
 
’code_php_gs
(
$¡r
)

122  
¡r_»¶aû
(
¬¿y
('<?php', '<?PHP', '<?', '?>'),‡¼ay('&É;?php', '&É;?PHP', '&É;?', '?&gt;'), 
$¡r
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/smiley_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

41 iàĞ! 
funùiÚ_exi¡s
('smiley_js'))

43 
funùiÚ
 
smey_js
(
$®Ÿs
 = '', 
$f›ld_id
 = '', 
$šlše
 = 
TRUE
)

45 
$do_£tup
 = 
TRUE
;

47 
	g$r
 = '';

49 ià(
	g$®Ÿs
 !ğ'' && ! 
is_¬¿y
(
$®Ÿs
))

51 
$®Ÿs
 = 
¬¿y
($®Ÿ => 
$f›ld_id
);

54 ià(
	g$do_£tup
 ==ğ
TRUE
)

56 
$do_£tup
 = 
FALSE
;

58 
	g$m
 = 
¬¿y
();

60 ià(
is_¬¿y
(
$®Ÿs
))

62 
fÜ—ch
 (
$®Ÿs
 
as
 
$Çme
 => 
$id
)

64 
$m
[] = '"'.
$Çme
.'" : "'.
$id
.'"';

68 
	g$m
 = '{'.
im¶ode
(',', 
$m
).'}';

70 
	g$r
 .ğ<<<
EOF


71 
v¬
 
smey_m­
 = {
$m
};

73 
funùiÚ
 
š£¹_smey
(
smey
, 
f›ld_id
) {

74 
v¬
 
	g–
 = 
docum’t
.
g‘EËm’tById
(
f›ld_id
), 
	gÃwS¹
;

76 iàĞ! 
	g–
 && 
	gsmey_m­
[
f›ld_id
]) {

77 
	g–
 = 
docum’t
.
g‘EËm’tById
(
smey_m­
[
f›ld_id
]);

79 iàĞ! 
	g–
)

80  
	gçl£
;

83 
	g–
.
focus
();

84 
	gsmey
 = " " + 
smey
;

86 ià('£ËùiÚS¹' 
š
 
	g–
) {

87 
	gÃwS¹
 = 
–
.
£ËùiÚS¹
 + 
smey
.
Ëngth
;

89 
	g–
.
	gv®ue
 = 
–
.
v®ue
.
sub¡r
(0,ƒl.
£ËùiÚS¹
) +

90 
	gsmey
 +

91 
	g–
.
	gv®ue
.
sub¡r
(
–
.
£ËùiÚEnd
,ƒl.
v®ue
.
Ëngth
);

92 
	g–
.
£tS–eùiÚRªge
(
ÃwS¹
,‚ewStart);

94 ià(
	gdocum’t
.
	g£ËùiÚ
) {

95 
	gdocum’t
.
	g£ËùiÚ
.
ü—‹Rªge
().
	g‹xt
 = 
smey
;

98 
	gEOF
;

102 ià(
is_¬¿y
(
$®Ÿs
))

104 
fÜ—ch
 (
$®Ÿs
 
as
 
$Çme
 => 
$id
)

106 
$r
 .ğ'smey_m­["'.
$Çme
.'"] = "'.
$id
.'";'."\n";

111 ià(
	g$šlše
)

113  '<süˆty³="‹xt/javasüt" ch¬£t="utf-8">/*<![CDATA[ */'.
	g$r
.'// ]]></script>';

117  
	g$r
;

134 iàĞ! 
funùiÚ_exi¡s
('get_clickable_smileys'))

136 
funùiÚ
 
g‘_şickabË_smeys
(
$image_u¾
, 
$®Ÿs
 = '', 
$smeys
 = 
NULL
)

140 ià(
is_¬¿y
(
$®Ÿs
))

142 
$smeys
 = 
$®Ÿs
;

145 iàĞ! 
is_¬¿y
(
$smeys
))

147 ià(
	gFALSE
 ==ğ(
$smeys
 = 
_g‘_smey_¬¿y
()))

149  
$smeys
;

154 
	g$image_u¾
 = 
¹rim
(
$image_u¾
, '/').'/';

156 
	g$u£d
 = 
¬¿y
();

157 
fÜ—ch
 (
$smeys
 
as
 
$key
 => 
$v®
)

163 ià(
is£t
(
$u£d
[
$smeys
[
$key
][0]]))

168 
	g$lšk
[] = "<¨h»f=\"javasüt:void(0);\" onşick=\"š£¹_smey('".
$key
."', '".
$®Ÿs
."')\"><img src=\"".
$image_u¾
.
$smeys
[$key][0]."\" width=\"".$smileys[$key][1]."\" height=\"".$smileys[$key][2]."\"‡lt=\"".$smileys[$key][3]."\" style=\"border:0;\" /></a>";

170 
	g$u£d
[
$smeys
[
$key
][0]] = 
TRUE
;

173  
	g$lšk
;

189 iàĞ! 
funùiÚ_exi¡s
('parse_smileys'))

191 
funùiÚ
 
·r£_smeys
(
$¡r
 = '', 
$image_u¾
 = '', 
$smeys
 = 
NULL
)

193 ià(
$image_u¾
 == '')

195  
$¡r
;

198 iàĞ! 
is_¬¿y
(
$smeys
))

200 ià(
	gFALSE
 ==ğ(
$smeys
 = 
_g‘_smey_¬¿y
()))

202  
$¡r
;

207 
	g$image_u¾
 = 
´eg_»¶aû
("/(.+?)\/*$/", "\\1/", 
$image_u¾
);

209 
fÜ—ch
 (
$smeys
 
as
 
$key
 => 
$v®
)

211 
$¡r
 = 
¡r_»¶aû
(
$key
, "<img src=\"".
$image_u¾
.
$smeys
[$key][0]."\" width=\"".$smileys[$key][1]."\" height=\"".$smileys[$key][2]."\"‡lt=\"".$smileys[$key][3]."\" style=\"border:0;\" />", $str);

214  
	g$¡r
;

228 iàĞ! 
funùiÚ_exi¡s
('_get_smiley_array'))

230 
funùiÚ
 
_g‘_smey_¬¿y
()

232 ià(
defšed
('ENVIRONMENT'è
AND
 
fe_exi¡s
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/smileys.php'))

234 
šşude
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/smileys.php');

236 
–£if
 (
fe_exi¡s
(
APPPATH
.'config/smileys.php'))

238 
šşude
(
APPPATH
.'config/smileys.php');

241 ià(
is£t
(
$smeys
è
AND
 
is_¬¿y
($smileys))

243  
	g$smeys
;

246  
	gFALSE
;

264 iàĞ! 
funùiÚ_exi¡s
('js_insert_smiley'))

266 
funùiÚ
 
js_š£¹_smey
(
$fÜm_Çme
 = '', 
$fÜm_f›ld
 = '')

268  <<<
EOF


269 <
süt
 
ty³
="text/javascript">

270 
funùiÚ
 
š£¹_smey
(
smey
)

272 
docum’t
.{
$fÜm_Çme
}.{
$fÜm_f›ld
}.
v®ue
 +ğ" " + 
smey
;

274 </
	gsüt
>

275 
	gEOF
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/string_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

45 iàĞ! 
funùiÚ_exi¡s
('trim_slashes'))

47 
funùiÚ
 
Œim_¦ashes
(
$¡r
)

49  
Œim
(
$¡r
, '/');

64 iàĞ! 
funùiÚ_exi¡s
('strip_slashes'))

66 
funùiÚ
 
¡r_¦ashes
(
$¡r
)

68 ià(
is_¬¿y
(
$¡r
))

70 
fÜ—ch
 (
$¡r
 
as
 
$key
 => 
$v®
)

72 
$¡r
[
$key
] = 
¡r_¦ashes
(
$v®
);

77 
	g$¡r
 = 
¡r¦ashes
(
$¡r
);

80  
	g$¡r
;

95 iàĞ! 
funùiÚ_exi¡s
('strip_quotes'))

97 
funùiÚ
 
¡r_quÙes
(
$¡r
)

99  
¡r_»¶aû
(
¬¿y
('"', "'"), '', 
$¡r
);

114 iàĞ! 
funùiÚ_exi¡s
('quotes_to_entities'))

116 
funùiÚ
 
quÙes_to_’t™›s
(
$¡r
)

118  
¡r_»¶aû
(
¬¿y
("\'","\"","'",'"'),‡¼ay("&#39;","&quÙ;","&#39;","&quÙ;"), 
$¡r
);

140 iàĞ! 
funùiÚ_exi¡s
('reduce_double_slashes'))

142 
funùiÚ
 
»duû_doubË_¦ashes
(
$¡r
)

144  
´eg_»¶aû
("#(^|[^:])//+#", "\\1/", 
$¡r
);

167 iàĞ! 
funùiÚ_exi¡s
('reduce_multiples'))

169 
funùiÚ
 
»duû_muÉËs
(
$¡r
, 
$ch¬aù”
 = ',', 
$Œim
 = 
FALSE
)

171 
$¡r
 = 
´eg_»¶aû
('#'.
´eg_quÙe
(
$ch¬aù”
, '#').'{2,}#', $character, $str);

173 ià(
	g$Œim
 ==ğ
TRUE
)

175 
$¡r
 = 
Œim
($¡r, 
$ch¬aù”
);

178  
	g$¡r
;

194 iàĞ! 
funùiÚ_exi¡s
('random_string'))

196 
funùiÚ
 
¿ndom_¡ršg
(
$ty³
 = '®num', 
$Ën
 = 8)

198 
$ty³
)

200 'basic' :  
mt_¿nd
();

207 
$ty³
)

209 '®pha' : 
$poŞ
 = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';

211 '®num' : 
$poŞ
 = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';

213 'num”ic' : 
$poŞ
 = '0123456789';

215 'noz”o' : 
$poŞ
 = '123456789';

219 
	g$¡r
 = '';

220 
	g$i
=0; $˜< 
	g$Ën
; $i++)

222 
	g$¡r
 .ğ
sub¡r
(
$poŞ
, 
mt_¿nd
(0, 
¡¾’
($pool) -1), 1);

224  
	g$¡r
;

229  
md5
(
uniqid
(
mt_¿nd
()));

234 
$CI
 =& 
g‘_š¡ªû
();

235 
	g$CI
->
	glßd
->
h–³r
('security');

237  
do_hash
(
uniqid
(
mt_¿nd
(), 
TRUE
), 'sha1');

253 
funùiÚ
 
šüem’t_¡ršg
(
$¡r
, 
$£·¿tÜ
 = '_', 
$fœ¡
 = 1)

255 
´eg_m©ch
('/(.+)'.
$£·¿tÜ
.'([0-9]+)$/', 
$¡r
, 
$m©ch
);

257  
is£t
(
$m©ch
[2]è? 
	g$m©ch
[1].
	g$£·¿tÜ
.($m©ch[2] + 1è: 
$¡r
.
$£·¿tÜ
.
$fœ¡
;

271 iàĞ! 
funùiÚ_exi¡s
('alternator'))

273 
funùiÚ
 
®‹º©Ü
()

275 
	g$i
;

277 ià(
func_num_¬gs
() == 0)

279 
$i
 = 0;

282 
	g$¬gs
 = 
func_g‘_¬gs
();

283  
	g$¬gs
[(
$i
++ % 
couÁ
(
$¬gs
))];

297 iàĞ! 
funùiÚ_exi¡s
('repeater'))

299 
funùiÚ
 
»³©”
(
$d©a
, 
$num
 = 1)

301  ((
$num
 > 0è? 
¡r_»³©
(
$d©a
, $num) : '');

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/text_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

41 iàĞ! 
funùiÚ_exi¡s
('word_limiter'))

43 
funùiÚ
 
wÜd_lim™”
(
$¡r
, 
$lim™
 = 100, 
$’d_ch¬
 = '&#8230;')

45 ià(
Œim
(
$¡r
) == '')

47  
$¡r
;

50 
´eg_m©ch
('/^\s*+(?:\S++\s*+){1,'.(è
$lim™
.'}/', 
$¡r
, 
$m©ches
);

52 ià(
¡¾’
(
$¡r
è=ğ¡¾’(
$m©ches
[0]))

54 
$’d_ch¬
 = '';

57  
¹rim
(
$m©ches
[0]).
	g$’d_ch¬
;

75 iàĞ! 
funùiÚ_exi¡s
('character_limiter'))

77 
funùiÚ
 
ch¬aù”_lim™”
(
$¡r
, 
$n
 = 500, 
$’d_ch¬
 = '&#8230;')

79 ià(
¡¾’
(
$¡r
è< 
$n
)

81  
$¡r
;

84 
	g$¡r
 = 
´eg_»¶aû
("/\s+/", ' ', 
¡r_»¶aû
(
¬¿y
("\r\n", "\r", "\n"), ' ', 
$¡r
));

86 ià(
¡¾’
(
$¡r
è<ğ
$n
)

88  
$¡r
;

91 
	g$out
 = "";

92 
fÜ—ch
 (
ex¶ode
(' ', 
Œim
(
$¡r
)è
as
 
$v®
)

94 
	g$out
 .ğ
$v®
.' ';

96 ià(
¡¾’
(
$out
è>ğ
$n
)

98 
$out
 = 
Œim
($out);

99  (
¡¾’
(
$out
è=ğ¡¾’(
$¡r
)è? $ouˆ: $out.
$’d_ch¬
;

116 iàĞ! 
funùiÚ_exi¡s
('ascii_to_entities'))

118 
funùiÚ
 
ascii_to_’t™›s
(
$¡r
)

120 
	g$couÁ
 = 1;

121 
	g$out
 = '';

122 
	g$‹mp
 = 
¬¿y
();

124 
	g$i
 = 0, 
	g$s
 = 
¡¾’
(
$¡r
); $i < $s; $i++)

126 
	g$Üdš®
 = 
Üd
(
$¡r
[
$i
]);

128 ià(
	g$Üdš®
 < 128)

134 ià(
couÁ
(
$‹mp
) == 1)

136 
$out
 .ğ'&#'.
¬¿y_shiá
(
$‹mp
).';';

137 
	g$couÁ
 = 1;

140 
	g$out
 .ğ
$¡r
[
$i
];

144 ià(
couÁ
(
$‹mp
) == 0)

146 
$couÁ
 = (
$Üdš®
 < 224) ? 2 : 3;

149 
	g$‹mp
[] = 
$Üdš®
;

151 ià(
couÁ
(
$‹mp
è=ğ
$couÁ
)

153 
$numb”
 = (
$couÁ
 =ğ3è? ((
$‹mp
['0'] % 16) * 4096) + (($temp['1'] % 64) * 64) + ($temp['2'] % 64) : (($temp['0'] % 32) * 64) + ($temp['1'] % 64);

155 
	g$out
 .ğ'&#'.
$numb”
.';';

156 
	g$couÁ
 = 1;

157 
	g$‹mp
 = 
¬¿y
();

162  
	g$out
;

178 iàĞ! 
funùiÚ_exi¡s
('entities_to_ascii'))

180 
funùiÚ
 
’t™›s_to_ascii
(
$¡r
, 
$®l
 = 
TRUE
)

182 ià(
´eg_m©ch_®l
('/\&#(\d+)\;/', 
$¡r
, 
$m©ches
))

184 
$i
 = 0, 
	g$s
 = 
couÁ
(
$m©ches
['0']); 
	g$i
 < $s; $i++)

186 
	g$dig™s
 = 
$m©ches
['1'][
$i
];

188 
	g$out
 = '';

190 ià(
	g$dig™s
 < 128)

192 
	g$out
 .ğ
chr
(
$dig™s
);

195 
–£if
 (
$dig™s
 < 2048)

197 
	g$out
 .ğ
chr
(192 + ((
$dig™s
 - ($digits % 64)) / 64));

198 
	g$out
 .ğ
chr
(128 + (
$dig™s
 % 64));

202 
	g$out
 .ğ
chr
(224 + ((
$dig™s
 - ($digits % 4096)) / 4096));

203 
	g$out
 .ğ
chr
(128 + (((
$dig™s
 % 4096) - ($digits % 64)) / 64));

204 
	g$out
 .ğ
chr
(128 + (
$dig™s
 % 64));

207 
	g$¡r
 = 
¡r_»¶aû
(
$m©ches
['0'][
$i
], 
$out
, 
$¡r
);

211 ià(
	g$®l
)

213 
	g$¡r
 = 
¡r_»¶aû
(
¬¿y
("&amp;", "&lt;", "&gt;", "&quot;", "&apos;", "&#45;"),

214 
¬¿y
("&","<",">","\"", "'", "-"),

215 
$¡r
);

218  
	g$¡r
;

237 iàĞ! 
funùiÚ_exi¡s
('word_censor'))

239 
funùiÚ
 
wÜd_ûnsÜ
(
$¡r
, 
$ûnsÜed
, 
$»¶aûm’t
 = '')

241 iàĞ! 
is_¬¿y
(
$ûnsÜed
))

243  
$¡r
;

246 
	g$¡r
 = ' '.
$¡r
.' ';

252 
	g$d–im
 = '[-_\'\"`(){}<>\[\]|!?@#%&,.:;^~*+=\/ 0-9\n\r\t]';

254 
fÜ—ch
 (
$ûnsÜed
 
as
 
$badwÜd
)

256 ià(
	g$»¶aûm’t
 != '')

258 
$¡r
 = 
´eg_»¶aû
("/({$d–im})(".
¡r_»¶aû
('\*', '\w*?', 
´eg_quÙe
(
$badwÜd
, '/')).")({$delim})/i", "\\1{$replacement}\\3", $str);

262 
	g$¡r
 = 
´eg_»¶aû
("/({$d–im})(".
¡r_»¶aû
('\*', '\w*?', 
´eg_quÙe
(
$badwÜd
, '/')).")({$d–im})/›", "'\\1'.¡r_»³©('#', sŒËn('\\2')).'\\3'", 
$¡r
);

266  
Œim
(
$¡r
);

281 iàĞ! 
funùiÚ_exi¡s
('highlight_code'))

283 
funùiÚ
 
highlight_code
(
$¡r
)

287 
	g$¡r
 = 
¡r_»¶aû
(
¬¿y
('&É;', '&gt;'),‡¼ay('<', '>'), 
$¡r
);

292 
	g$¡r
 = 
¡r_»¶aû
(
¬¿y
('<?', '?>', '<%', '%>', '\\', '</script>'),

293 
¬¿y
('ph±agİ’', 'ph±agşo£', 'a¥gİ’', 'a¥gşo£', 'back¦ashtmp', 'sütşo£'), 
$¡r
);

297 
	g$¡r
 = '<?ph°'.
$¡r
.' ?>';

300 
	g$¡r
 = 
highlight_¡ršg
(
$¡r
, 
TRUE
);

305 ià(
abs
(
PHP_VERSION
) < 5)

307 
	g$¡r
 = 
¡r_»¶aû
(
¬¿y
('<fÚˆ', '</fÚt>'),‡¼ay('<¥ª ', '</¥ª>'), 
$¡r
);

308 
	g$¡r
 = 
´eg_»¶aû
('#cŞÜ="(.*?)"#', '¡yË="cŞÜ: \\1"', 
$¡r
);

312 
	g$¡r
 = 
´eg_»¶aû
('/<¥ª styË="cŞÜ: #([A-Z0-9]+)">&É;\?php(&nb¥;| )/i', '<¥ª styË="cŞÜ: #$1">', 
$¡r
);

313 
	g$¡r
 = 
´eg_»¶aû
('/(<¥ª styË="cŞÜ: #[A-Z0-9]+">.*?)\?&gt;<\/¥ª>\n<\/¥ª>\n<\/code>/is', "$1</¥ª>\n</¥ª>\n</code>", 
$¡r
);

314 
	g$¡r
 = 
´eg_»¶aû
('/<¥ª styË="cŞÜ: #[A-Z0-9]+"\><\/¥ª>/i', '', 
$¡r
);

317 
	g$¡r
 = 
¡r_»¶aû
(
¬¿y
('phptagopen', 'phptagclose', 'asptagopen', 'asptagclose', 'backslashtmp', 'scriptclose'),

318 
¬¿y
('&É;?', '?&gt;', '&É;%', '%&gt;', '\\', '&É;/süt&gt;'), 
$¡r
);

320  
	g$¡r
;

338 iàĞ! 
funùiÚ_exi¡s
('highlight_phrase'))

340 
funùiÚ
 
highlight_ph¿£
(
$¡r
, 
$ph¿£
, 
$g_İ’
 = '<¡rÚg>', 
$g_şo£
 = '</strong>')

342 ià(
$¡r
 == '')

347 ià(
	g$ph¿£
 != '')

349  
´eg_»¶aû
('/('.
´eg_quÙe
(
$ph¿£
, '/').')/i', 
$g_İ’
."\\1".
$g_şo£
, 
$¡r
);

352  
	g$¡r
;

365 iàĞ! 
funùiÚ_exi¡s
('convert_accented_characters'))

367 
funùiÚ
 
cÚv”t_acûÁed_ch¬aù”s
(
$¡r
)

369 ià(
defšed
('ENVIRONMENT'è
AND
 
is_fe
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/foreign_chars.php'))

371 
šşude
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/foreign_chars.php');

373 
–£if
 (
is_fe
(
APPPATH
.'config/foreign_chars.php'))

375 
šşude
(
APPPATH
.'config/foreign_chars.php');

378 iàĞ! 
is£t
(
$fÜeign_ch¬aù”s
))

380  
	g$¡r
;

383  
´eg_»¶aû
(
¬¿y_keys
(
$fÜeign_ch¬aù”s
), 
¬¿y_v®ues
($fÜeign_ch¬aù”s), 
$¡r
);

401 iàĞ! 
funùiÚ_exi¡s
('word_wrap'))

403 
funùiÚ
 
wÜd_w¿p
(
$¡r
, 
$ch¬lim
 = '76')

406 iàĞ! 
is_num”ic
(
$ch¬lim
))

407 
$ch¬lim
 = 76;

410 
	g$¡r
 = 
´eg_»¶aû
("| +|", " ", 
$¡r
);

413 ià(
¡½os
(
$¡r
, "\r"è!=ğ
FALSE
)

415 
$¡r
 = 
¡r_»¶aû
(
¬¿y
("\r\n", "\r"), "\n", $str);

420 
	g$unw¿p
 = 
¬¿y
();

421 ià(
´eg_m©ch_®l
("|(\{unw¿p\}.+?\{/unw¿p\})|s", 
$¡r
, 
$m©ches
))

423 
	g$i
 = 0; $˜< 
couÁ
(
$m©ches
['0']); $i++)

425 
	g$unw¿p
[] = 
$m©ches
['1'][
$i
];

426 
	g$¡r
 = 
¡r_»¶aû
(
$m©ches
['1'][
$i
], "{{unw¿µed".$i."}}", 
$¡r
);

433 
	g$¡r
 = 
wÜdw¿p
(
$¡r
, 
$ch¬lim
, "\n", 
FALSE
);

436 
	g$ouut
 = "";

437 
fÜ—ch
 (
ex¶ode
("\n", 
$¡r
è
as
 
$lše
)

441 ià(
¡¾’
(
$lše
è<ğ
$ch¬lim
)

443 
$ouut
 .ğ
$lše
."\n";

447 
	g$‹mp
 = '';

448 (
¡¾’
(
$lše
)è> 
	g$ch¬lim
)

451 ià(
´eg_m©ch
("!\[u¾.+\]|://|wwww.!", 
$lše
))

457 
	g$‹mp
 .ğ
sub¡r
(
$lše
, 0, 
$ch¬lim
-1);

458 
	g$lše
 = 
sub¡r
(
$lše
, 
$ch¬lim
-1);

463 ià(
	g$‹mp
 != '')

465 
$ouut
 .ğ
$‹mp
."\n".
$lše
;

469 
	g$ouut
 .ğ
$lše
;

472 
	g$ouut
 .= "\n";

476 ià(
couÁ
(
$unw¿p
) > 0)

478 
fÜ—ch
 (
$unw¿p
 
as
 
$key
 => 
$v®
)

480 
$ouut
 = 
¡r_»¶aû
("{{unw¿µed".
$key
."}}", 
$v®
, $output);

485 
	g$ouut
 = 
¡r_»¶aû
(
¬¿y
('{unw¿p}', '{/unw¿p}'), '', 
$ouut
);

487  
	g$ouut
;

504 iàĞ! 
funùiÚ_exi¡s
('ellipsize'))

506 
funùiÚ
 
–lsize
(
$¡r
, 
$max_Ëngth
, 
$pos™iÚ
 = 1, 
$–lsis
 = '&hellip;')

509 
$¡r
 = 
Œim
(
¡r_gs
($str));

512 ià(
¡¾’
(
$¡r
è<ğ
$max_Ëngth
)

514  
$¡r
;

517 
	g$beg
 = 
sub¡r
(
$¡r
, 0, 
æoÜ
(
$max_Ëngth
 * 
$pos™iÚ
));

519 
	g$pos™iÚ
 = (
$pos™iÚ
 > 1) ? 1 : $position;

521 ià(
	g$pos™iÚ
 === 1)

523 
$’d
 = 
sub¡r
(
$¡r
, 0, -(
$max_Ëngth
 - 
¡¾’
(
$beg
)));

527 
	g$’d
 = 
sub¡r
(
$¡r
, -(
$max_Ëngth
 - 
¡¾’
(
$beg
)));

530  
	g$beg
.
	g$–lsis
.
	g$’d
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/typography_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

37 iàĞ! 
funùiÚ_exi¡s
('nl2br_except_pre'))

39 
funùiÚ
 
Æ2br_exû±_´e
(
$¡r
)

41 
	g$CI
 =& 
g‘_š¡ªû
();

43 
	g$CI
->
	glßd
->
lib¿ry
('typography');

45  
	g$CI
->
	gtypog¿phy
->
Æ2br_exû±_´e
(
$¡r
);

61 iàĞ! 
funùiÚ_exi¡s
('auto_typography'))

63 
funùiÚ
 
auto_typog¿phy
(
$¡r
, 
$¡r_js_ev’t_hªdËrs
 = 
TRUE
, 
$»duû_lšeb»aks
 = 
FALSE
)

65 
$CI
 =& 
g‘_š¡ªû
();

66 
	g$CI
->
	glßd
->
lib¿ry
('typography');

67  
	g$CI
->
	gtypog¿phy
->
auto_typog¿phy
(
$¡r
, 
$¡r_js_ev’t_hªdËrs
, 
$»duû_lšeb»aks
);

83 iàĞ! 
funùiÚ_exi¡s
('entity_decode'))

85 
funùiÚ
 
’t™y_decode
(
$¡r
, 
$ch¬£t
='UTF-8')

87 
glob®
 
$SEC
;

88  
	g$SEC
->
’t™y_decode
(
$¡r
, 
$ch¬£t
);

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/url_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

40 iàĞ! 
funùiÚ_exi¡s
('site_url'))

42 
funùiÚ
 
s™e_u¾
(
$uri
 = '')

44 
$CI
 =& 
g‘_š¡ªû
();

45  
	g$CI
->
	gcÚfig
->
s™e_u¾
(
$uri
);

62 iàĞ! 
funùiÚ_exi¡s
('base_url'))

64 
funùiÚ
 
ba£_u¾
(
$uri
 = '')

66 
$CI
 =& 
g‘_š¡ªû
();

67  
	g$CI
->
	gcÚfig
->
ba£_u¾
(
$uri
);

82 iàĞ! 
funùiÚ_exi¡s
('current_url'))

84 
funùiÚ
 
cu¼’t_u¾
()

86 
	g$CI
 =& 
g‘_š¡ªû
();

87  
	g$CI
->
	gcÚfig
->
s™e_u¾
(
$CI
->
uri
->
uri_¡ršg
());

100 iàĞ! 
funùiÚ_exi¡s
('uri_string'))

102 
funùiÚ
 
uri_¡ršg
()

104 
	g$CI
 =& 
g‘_š¡ªû
();

105  
	g$CI
->
	guri
->
uri_¡ršg
();

119 iàĞ! 
funùiÚ_exi¡s
('index_page'))

121 
funùiÚ
 
šdex_·ge
()

123 
	g$CI
 =& 
g‘_š¡ªû
();

124  
	g$CI
->
	gcÚfig
->
™em
('index_page');

141 iàĞ! 
funùiÚ_exi¡s
('anchor'))

143 
funùiÚ
 
ªchÜ
(
$uri
 = '', 
$t™Ë
 = '', 
$©Œibu‹s
 = '')

145 
$t™Ë
 = (
¡ršg
) $title;

147 iàĞ! 
is_¬¿y
(
$uri
))

149 
	g$s™e_u¾
 = ( ! 
´eg_m©ch
('!^\w+://! i', 
$uri
)è? 
s™e_u¾
($uri) : $uri;

153 
	g$s™e_u¾
 = 
s™e_u¾
(
$uri
);

156 ià(
	g$t™Ë
 == '')

158 
$t™Ë
 = 
$s™e_u¾
;

161 ià(
	g$©Œibu‹s
 != '')

163 
$©Œibu‹s
 = 
_·r£_©Œibu‹s
($attributes);

166  '<¨h»f="'.
	g$s™e_u¾
.'"'.
	g$©Œibu‹s
.'>'.
	g$t™Ë
.'</a>';

184 iàĞ! 
funùiÚ_exi¡s
('anchor_popup'))

186 
funùiÚ
 
ªchÜ_pİup
(
$uri
 = '', 
$t™Ë
 = '', 
$©Œibu‹s
 = 
FALSE
)

188 
$t™Ë
 = (
¡ršg
) $title;

190 
	g$s™e_u¾
 = ( ! 
´eg_m©ch
('!^\w+://! i', 
$uri
)è? 
s™e_u¾
($uri) : $uri;

192 ià(
	g$t™Ë
 == '')

194 
$t™Ë
 = 
$s™e_u¾
;

197 ià(
	g$©Œibu‹s
 ==ğ
FALSE
)

199  "<¨h»f='javasüt:void(0);' onşick=\"wšdow.İ’('".
$s™e_u¾
."', '_bÏnk');\">".
$t™Ë
."</a>";

202 iàĞ! 
is_¬¿y
(
$©Œibu‹s
))

204 
	g$©Œibu‹s
 = 
¬¿y
();

207 
fÜ—ch
 (
¬¿y
('width' => '800', 'height' => '600', 'süŞlb¬s' => 'yes', '¡©us' => 'yes', '»sizabË' => 'yes', 'sü“nx' => '0', 'sü“ny' => '0', ) 
as
 
$key
 => 
$v®
)

209 
$©ts
[
$key
] = ( ! 
is£t
(
$©Œibu‹s
[$key])è? 
$v®
 : $attributes[$key];

210 
un£t
(
$©Œibu‹s
[
$key
]);

213 ià(
	g$©Œibu‹s
 != '')

215 
$©Œibu‹s
 = 
_·r£_©Œibu‹s
($attributes);

218  "<¨h»f='javasüt:void(0);' onşick=\"wšdow.İ’('".
	g$s™e_u¾
."', '_bÏnk', '".
_·r£_©Œibu‹s
(
$©ts
, 
TRUE
)."');\"$©Œibu‹s>".
	g$t™Ë
."</a>";

233 iàĞ! 
funùiÚ_exi¡s
('mailto'))

235 
funùiÚ
 
mato
(
$ema
, 
$t™Ë
 = '', 
$©Œibu‹s
 = '')

237 
$t™Ë
 = (
¡ršg
) $title;

239 ià(
	g$t™Ë
 == "")

241 
$t™Ë
 = 
$ema
;

244 
	g$©Œibu‹s
 = 
_·r£_©Œibu‹s
(
$©Œibu‹s
);

246  '<¨h»f="mato:'.
	g$ema
.'"'.
	g$©Œibu‹s
.'>'.
	g$t™Ë
.'</a>';

263 iàĞ! 
funùiÚ_exi¡s
('safe_mailto'))

265 
funùiÚ
 
§ã_mato
(
$ema
, 
$t™Ë
 = '', 
$©Œibu‹s
 = '')

267 
$t™Ë
 = (
¡ršg
) $title;

269 ià(
	g$t™Ë
 == "")

271 
$t™Ë
 = 
$ema
;

274 
	g$i
 = 0; $i < 16; $i++)

276 
	g$x
[] = 
sub¡r
('<¨h»f="mato:', 
$i
, 1);

279 
	g$i
 = 0; $˜< 
¡¾’
(
$ema
); $i++)

281 
	g$x
[] = "|".
Üd
(
sub¡r
(
$ema
, 
$i
, 1));

284 
	g$x
[] = '"';

286 ià(
	g$©Œibu‹s
 != '')

288 ià(
is_¬¿y
(
$©Œibu‹s
))

290 
fÜ—ch
 (
$©Œibu‹s
 
as
 
$key
 => 
$v®
)

292 
$x
[] = ' '.
$key
.'="';

293 
	g$i
 = 0; $˜< 
¡¾’
(
$v®
); $i++)

295 
	g$x
[] = "|".
Üd
(
sub¡r
(
$v®
, 
$i
, 1));

297 
	g$x
[] = '"';

302 
	g$i
 = 0; $˜< 
¡¾’
(
$©Œibu‹s
); $i++)

304 
	g$x
[] = 
sub¡r
(
$©Œibu‹s
, 
$i
, 1);

309 
	g$x
[] = '>';

311 
	g$‹mp
 = 
¬¿y
();

312 
	g$i
 = 0; $˜< 
¡¾’
(
$t™Ë
); $i++)

314 
	g$Üdš®
 = 
Üd
(
$t™Ë
[
$i
]);

316 ià(
	g$Üdš®
 < 128)

318 
	g$x
[] = "|".
$Üdš®
;

322 ià(
couÁ
(
$‹mp
) == 0)

324 
$couÁ
 = (
$Üdš®
 < 224) ? 2 : 3;

327 
	g$‹mp
[] = 
$Üdš®
;

328 ià(
couÁ
(
$‹mp
è=ğ
$couÁ
)

330 
$numb”
 = (
$couÁ
 =ğ3è? ((
$‹mp
['0'] % 16) * 4096) + (($temp['1'] % 64) * 64) + ($temp['2'] % 64) : (($temp['0'] % 32) * 64) + ($temp['1'] % 64);

331 
	g$x
[] = "|".
$numb”
;

332 
	g$couÁ
 = 1;

333 
	g$‹mp
 = 
¬¿y
();

338 
	g$x
[] = '<'; $x[] = '/'; $x[] = 'a'; $x[] = '>';

340 
	g$x
 = 
¬¿y_»v”£
(
$x
);

341 
ob_¡¬t
();

343 ?><
süt
 
	gty³
="text/javascript">

345 
v¬
 
l
=
Ãw
 
A¼ay
();

346 <?
php


347 
	g$i
 = 0;

348 
fÜ—ch
 (
$x
 
as
 
$v®
){ ?>
	gl
[<?
php
 
echo
 
$i
++; ?>]='<?ph°echØ$v®; ?>';<?
	gphp
 } ?>

350 
v¬
 
	gi
 = 
l
.
Ëngth
-1; i >ğ0; i=
i
-1){

351 ià(
l
[
i
].
sub¡ršg
(0, 1è=ğ'|'è
docum’t
.
wr™e
("&#"+
uÃsÿ³
(l[i].substring(1))+";");

352 
	gdocum’t
.
wr™e
(
uÃsÿ³
(
l
[
i
]));}

354 </
	gsüt
><?
php


356 
	g$bufãr
 = 
ob_g‘_cÚ‹Ás
();

357 
ob_’d_ş—n
();

358  
	g$bufãr
;

378 iàĞ! 
funùiÚ_exi¡s
('auto_link'))

380 
funùiÚ
 
auto_lšk
(
$¡r
, 
$ty³
 = 'bÙh', 
$pİup
 = 
FALSE
)

382 ià(
$ty³
 != 'email')

384 ià(
´eg_m©ch_®l
("#(^|\s|\()((h‰p(s?)://)|(www\.))(\w+[^\s\)\<]+)#i", 
$¡r
, 
$m©ches
))

386 
$pİ
 = (
$pİup
 =ğ
TRUE
) ? "arget=\"_blank\" " : "";

388 
	g$i
 = 0; $˜< 
couÁ
(
$m©ches
['0']); $i++)

390 
	g$³riod
 = '';

391 ià(
´eg_m©ch
("|\.$|", 
$m©ches
['6'][
$i
]))

393 
	g$³riod
 = '.';

394 
	g$m©ches
['6'][
$i
] = 
sub¡r
(
$m©ches
['6'][$i], 0, -1);

397 
	g$¡r
 = 
¡r_»¶aû
(
$m©ches
['0'][
$i
],

398 
$m©ches
['1'][
$i
].'<a href="http'.

399 
$m©ches
['4'][
$i
].'://'.

400 
$m©ches
['5'][
$i
].

401 
$m©ches
['6'][
$i
].'"'.
$pİ
.'>http'.

402 
$m©ches
['4'][
$i
].'://'.

403 
$m©ches
['5'][
$i
].

404 
$m©ches
['6'][
$i
].'</a>'.

405 
$³riod
, 
$¡r
);

410 ià(
	g$ty³
 != 'url')

412 ià(
´eg_m©ch_®l
("/([a-zA-Z0-9_\.\-\+]+)@([a-zA-Z0-9\-]+)\.([a-zA-Z0-9\-\.]*)/i", 
$¡r
, 
$m©ches
))

414 
$i
 = 0; 
	g$i
 < 
couÁ
(
$m©ches
['0']); $i++)

416 
	g$³riod
 = '';

417 ià(
´eg_m©ch
("|\.$|", 
$m©ches
['3'][
$i
]))

419 
	g$³riod
 = '.';

420 
	g$m©ches
['3'][
$i
] = 
sub¡r
(
$m©ches
['3'][$i], 0, -1);

423 
	g$¡r
 = 
¡r_»¶aû
(
$m©ches
['0'][
$i
], 
§ã_mato
($m©ches['1'][$i].'@'.$m©ches['2'][$i].'.'.$m©ches['3'][$i]).
$³riod
, 
$¡r
);

428  
	g$¡r
;

443 iàĞ! 
funùiÚ_exi¡s
('prep_url'))

445 
funùiÚ
 
´•_u¾
(
$¡r
 = '')

447 ià(
$¡r
 =ğ'h‰p://' 
OR
 $str == '')

452 
	g$u¾
 = 
·r£_u¾
(
$¡r
);

454 iàĞ! 
$u¾
 
	gOR
 ! 
is£t
($url['scheme']))

456 
	g$¡r
 = 'h‰p://'.
$¡r
;

459  
	g$¡r
;

477 iàĞ! 
funùiÚ_exi¡s
('url_title'))

479 
funùiÚ
 
u¾_t™Ë
(
$¡r
, 
$£·¿tÜ
 = '-', 
$low”ÿ£
 = 
FALSE
)

481 ià(
$£·¿tÜ
 == 'dash')

483 
$£·¿tÜ
 = '-';

485 ià(
	g$£·¿tÜ
 == 'underscore')

487 
$£·¿tÜ
 = '_';

490 
	g$q_£·¿tÜ
 = 
´eg_quÙe
(
$£·¿tÜ
);

492 
	g$Œªs
 = 
¬¿y
(

495 '\s+' => 
$£·¿tÜ
,

496 '('.
$q_£·¿tÜ
.')+' => 
$£·¿tÜ


499 
	g$¡r
 = 
¡r_gs
(
$¡r
);

501 
fÜ—ch
 (
$Œªs
 
as
 
$key
 => 
$v®
)

503 
$¡r
 = 
´eg_»¶aû
("#".
$key
."#i", 
$v®
, $str);

506 ià(
	g$low”ÿ£
 ==ğ
TRUE
)

508 
$¡r
 = 
¡¹Şow”
($str);

511  
Œim
(
$¡r
, 
$£·¿tÜ
);

529 iàĞ! 
funùiÚ_exi¡s
('redirect'))

531 
funùiÚ
 
»dœeù
(
$uri
 = '', 
$m‘hod
 = 'loÿtiÚ', 
$h‰p_»¥Ú£_code
 = 302)

533 iàĞ! 
´eg_m©ch
('#^h‰ps?://#i', 
$uri
))

535 
$uri
 = 
s™e_u¾
($uri);

538 
	g$m‘hod
)

540 '»äesh' : 
h—d”
("Reäesh:0;u¾=".
$uri
);

542  : 
h—d”
("LoÿtiÚ: ".
$uri
, 
TRUE
, 
$h‰p_»¥Ú£_code
);

545 
	gex™
;

561 iàĞ! 
funùiÚ_exi¡s
('_parse_attributes'))

563 
funùiÚ
 
_·r£_©Œibu‹s
(
$©Œibu‹s
, 
$javasüt
 = 
FALSE
)

565 ià(
is_¡ršg
(
$©Œibu‹s
))

567  (
$©Œibu‹s
 != '') ? ' '.$attributes : '';

570 
	g$©t
 = '';

571 
fÜ—ch
 (
$©Œibu‹s
 
as
 
$key
 => 
$v®
)

573 ià(
$javasüt
 =ğ
TRUE
)

575 
$©t
 .ğ
$key
 . '=' . 
$v®
 . ',';

579 
	g$©t
 .ğ' ' . 
$key
 . '="' . 
$v®
 . '"';

583 ià(
	g$javasüt
 =ğ
TRUE
 
AND
 
$©t
 != '')

585 
$©t
 = 
sub¡r
($att, 0, -1);

588  
	g$©t
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/xml_helper.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

37 iàĞ! 
funùiÚ_exi¡s
('xml_convert'))

39 
funùiÚ
 
xml_cÚv”t
(
$¡r
, 
$´Ùeù_®l
 = 
FALSE
)

41 
$‹mp
 = '__TEMP_AMPERSANDS__';

45 
	g$¡r
 = 
´eg_»¶aû
("/&#(\d+);/", "$‹mp\\1;", 
$¡r
);

47 ià(
	g$´Ùeù_®l
 ==ğ
TRUE
)

49 
$¡r
 = 
´eg_»¶aû
("/&(\w+);/", "$temp\\1;", $str);

52 
	g$¡r
 = 
¡r_»¶aû
(
¬¿y
("&","<",">","\"", "'", "-"),

53 
¬¿y
("&amp;", "&lt;", "&gt;", "&quot;", "&apos;", "&#45;"),

54 
$¡r
);

57 
	g$¡r
 = 
´eg_»¶aû
("/$‹mp(\d+);/","&#\\1;",
$¡r
);

59 ià(
	g$´Ùeù_®l
 ==ğ
TRUE
)

61 
$¡r
 = 
´eg_»¶aû
("/$temp(\w+);/","&\\1;", $str);

64  
	g$¡r
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/calendar_lang.php

1 <?
php


3 
	g$Ïng
['cal_su'] = "Su";

4 
	g$Ïng
['cal_mo'] = "Mo";

5 
	g$Ïng
['cal_tu'] = "Tu";

6 
	g$Ïng
['cal_we'] = "We";

7 
	g$Ïng
['cal_th'] = "Th";

8 
	g$Ïng
['cal_fr'] = "Fr";

9 
	g$Ïng
['cal_sa'] = "Sa";

10 
	g$Ïng
['cal_sun'] = "Sun";

11 
	g$Ïng
['cal_mon'] = "Mon";

12 
	g$Ïng
['cal_tue'] = "Tue";

13 
	g$Ïng
['cal_wed'] = "Wed";

14 
	g$Ïng
['cal_thu'] = "Thu";

15 
	g$Ïng
['cal_fri'] = "Fri";

16 
	g$Ïng
['cal_sat'] = "Sat";

17 
	g$Ïng
['cal_sunday'] = "Sunday";

18 
	g$Ïng
['cal_monday'] = "Monday";

19 
	g$Ïng
['cal_tuesday'] = "Tuesday";

20 
	g$Ïng
['cal_wednesday'] = "Wednesday";

21 
	g$Ïng
['cal_thursday'] = "Thursday";

22 
	g$Ïng
['cal_friday'] = "Friday";

23 
	g$Ïng
['cal_saturday'] = "Saturday";

24 
	g$Ïng
['cal_jan'] = "Jan";

25 
	g$Ïng
['cal_feb'] = "Feb";

26 
	g$Ïng
['cal_mar'] = "Mar";

27 
	g$Ïng
['cal_apr'] = "Apr";

28 
	g$Ïng
['cal_may'] = "May";

29 
	g$Ïng
['cal_jun'] = "Jun";

30 
	g$Ïng
['cal_jul'] = "Jul";

31 
	g$Ïng
['cal_aug'] = "Aug";

32 
	g$Ïng
['cal_sep'] = "Sep";

33 
	g$Ïng
['cal_oct'] = "Oct";

34 
	g$Ïng
['cal_nov'] = "Nov";

35 
	g$Ïng
['cal_dec'] = "Dec";

36 
	g$Ïng
['cal_january'] = "January";

37 
	g$Ïng
['cal_february'] = "February";

38 
	g$Ïng
['cal_march'] = "March";

39 
	g$Ïng
['cal_april'] = "April";

40 
	g$Ïng
['cal_mayl'] = "May";

41 
	g$Ïng
['cal_june'] = "June";

42 
	g$Ïng
['cal_july'] = "July";

43 
	g$Ïng
['cal_august'] = "August";

44 
	g$Ïng
['cal_september'] = "September";

45 
	g$Ïng
['cal_october'] = "October";

46 
	g$Ïng
['cal_november'] = "November";

47 
	g$Ïng
['cal_december'] = "December";

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/date_lang.php

1 <?
php


3 
	g$Ïng
['date_year'] = "Year";

4 
	g$Ïng
['date_years'] = "Years";

5 
	g$Ïng
['date_month'] = "Month";

6 
	g$Ïng
['date_months'] = "Months";

7 
	g$Ïng
['date_week'] = "Week";

8 
	g$Ïng
['date_weeks'] = "Weeks";

9 
	g$Ïng
['date_day'] = "Day";

10 
	g$Ïng
['date_days'] = "Days";

11 
	g$Ïng
['date_hour'] = "Hour";

12 
	g$Ïng
['date_hours'] = "Hours";

13 
	g$Ïng
['date_minute'] = "Minute";

14 
	g$Ïng
['date_minutes'] = "Minutes";

15 
	g$Ïng
['date_second'] = "Second";

16 
	g$Ïng
['date_seconds'] = "Seconds";

18 
	g$Ïng
['UM12'] = '(UTC -12:00) Baker/Howland Island';

19 
	g$Ïng
['UM11'] = '(UTC -11:00) Samoa Time Zone, Niue';

20 
	g$Ïng
['UM10'] = '(UTC -10:00) Hawaii-Aleutian Standard Time, Cook Islands, Tahiti';

21 
	g$Ïng
['UM95'] = '(UTC -9:30) Marquesas Islands';

22 
	g$Ïng
['UM9'] = '(UTC -9:00) Alaska Standard Time, Gambier Islands';

23 
	g$Ïng
['UM8'] = '(UTC -8:00) Pacific Standard Time, Clipperton Island';

24 
	g$Ïng
['UM7'] = '(UTC -7:00) Mountain Standard Time';

25 
	g$Ïng
['UM6'] = '(UTC -6:00) Central Standard Time';

26 
	g$Ïng
['UM5'] = '(UTC -5:00) Eastern Standard Time, Western Caribbean Standard Time';

27 
	g$Ïng
['UM45'] = '(UTC -4:30) Venezuelan Standard Time';

28 
	g$Ïng
['UM4'] = '(UTC -4:00) Atlantic Standard Time, Eastern Caribbean Standard Time';

29 
	g$Ïng
['UM35'] = '(UTC -3:30) Newfoundland Standard Time';

30 
	g$Ïng
['UM3'] = '(UTC -3:00) Argentina, Brazil, French Guiana, Uruguay';

31 
	g$Ïng
['UM2'] = '(UTC -2:00) South Georgia/South Sandwich Islands';

32 
	g$Ïng
['UM1'] = '(UTC -1:00) Azores, Cape Verde Islands';

33 
	g$Ïng
['UTC'] = '(UTC) Greenwich Mean Time, Western European Time';

34 
	g$Ïng
['UP1'] = '(UTC +1:00) Central European Time, West Africa Time';

35 
	g$Ïng
['UP2'] = '(UTC +2:00) Central Africa Time, Eastern European Time, Kaliningrad Time';

36 
	g$Ïng
['UP3'] = '(UTC +3:00) Moscow Time, East Africa Time';

37 
	g$Ïng
['UP35'] = '(UTC +3:30) Iran Standard Time';

38 
	g$Ïng
['UP4'] = '(UTC +4:00) Azerbaijan Standard Time, Samara Time';

39 
	g$Ïng
['UP45'] = '(UTC +4:30) Afghanistan';

40 
	g$Ïng
['UP5'] = '(UTC +5:00) Pakistan Standard Time, Yekaterinburg Time';

41 
	g$Ïng
['UP55'] = '(UTC +5:30) Indian Standard Time, Sri Lanka Time';

42 
	g$Ïng
['UP575'] = '(UTC +5:45) Nepal Time';

43 
	g$Ïng
['UP6'] = '(UTC +6:00) Bangladesh Standard Time, Bhutan Time, Omsk Time';

44 
	g$Ïng
['UP65'] = '(UTC +6:30) Cocos Islands, Myanmar';

45 
	g$Ïng
['UP7'] = '(UTC +7:00) Krasnoyarsk Time, Cambodia, Laos, Thailand, Vietnam';

46 
	g$Ïng
['UP8'] = '(UTC +8:00) Australian Western Standard Time, Beijing Time, Irkutsk Time';

47 
	g$Ïng
['UP875'] = '(UTC +8:45) Australian Central Western Standard Time';

48 
	g$Ïng
['UP9'] = '(UTC +9:00) Japan Standard Time, Korea Standard Time, Yakutsk Time';

49 
	g$Ïng
['UP95'] = '(UTC +9:30) Australian Central Standard Time';

50 
	g$Ïng
['UP10'] = '(UTC +10:00) Australian Eastern Standard Time, Vladivostok Time';

51 
	g$Ïng
['UP105'] = '(UTC +10:30) Lord Howe Island';

52 
	g$Ïng
['UP11'] = '(UTC +11:00) Magadan Time, Solomon Islands, Vanuatu';

53 
	g$Ïng
['UP115'] = '(UTC +11:30) Norfolk Island';

54 
	g$Ïng
['UP12'] = '(UTC +12:00) Fiji, Gilbert Islands, Kamchatka Time, New Zealand Standard Time';

55 
	g$Ïng
['UP1275'] = '(UTC +12:45) Chatham Islands Standard Time';

56 
	g$Ïng
['UP13'] = '(UTC +13:00) Phoenix Islands Time, Tonga';

57 
	g$Ïng
['UP14'] = '(UTC +14:00) Line Islands';

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/db_lang.php

1 <?
php


3 
	g$Ïng
['db_invalid_connection_str'] = 'Unableo determinehe database settings based onhe connection string you submitted.';

4 
	g$Ïng
['db_unable_to_connect'] = 'Unableo connecto your database server usinghe…rovided settings.';

5 
	g$Ïng
['db_unable_to_select'] = 'Unableo selecthe specified database: %s';

6 
	g$Ïng
['db_unable_to_create'] = 'Unableo createhe specified database: %s';

7 
	g$Ïng
['db_invalid_query'] = 'The query you submitted is‚ot valid.';

8 
	g$Ïng
['db_must_set_table'] = 'You must sethe databaseableo be used with your query.';

9 
	g$Ïng
['db_must_use_set'] = 'You must usehe "set" methodo update‡nƒntry.';

10 
	g$Ïng
['db_must_use_index'] = 'You must specify‡n indexo match on for batch updates.';

11 
	g$Ïng
['db_batch_missing_index'] = 'One or more„ows submitted for batch updating is missinghe specified index.';

12 
	g$Ïng
['db_must_use_where'] = 'Updates‡re‚ot‡llowed unlesshey contain‡ "where" clause.';

13 
	g$Ïng
['db_del_must_use_where'] = 'Deletes‡re‚ot‡llowed unlesshey contain‡ "where" or "like" clause.';

14 
	g$Ïng
['db_field_param_missing'] = 'To fetch fields„equireshe‚ame ofheable‡s‡…arameter.';

15 
	g$Ïng
['db_unsupported_function'] = 'This feature is‚ot‡vailable forhe database you‡re using.';

16 
	g$Ïng
['db_transaction_failure'] = 'Transaction failure: Rollback…erformed.';

17 
	g$Ïng
['db_unable_to_drop'] = 'Unableo drophe specified database.';

18 
	g$Ïng
['db_unsuported_feature'] = 'Unsupported feature ofhe database…latform you‡re using.';

19 
	g$Ïng
['db_unsuported_compression'] = 'The file compression format you chose is‚ot supported by your server.';

20 
	g$Ïng
['db_filepath_error'] = 'Unableo write dataohe file…ath you have submitted.';

21 
	g$Ïng
['db_invalid_cache_path'] = 'The cache…ath you submitted is‚ot valid or writable.';

22 
	g$Ïng
['db_table_name_required'] = 'Aable‚ame is„equired forhat operation.';

23 
	g$Ïng
['db_column_name_required'] = 'A column‚ame is„equired forhat operation.';

24 
	g$Ïng
['db_column_definition_required'] = 'A column definition is„equired forhat operation.';

25 
	g$Ïng
['db_unable_to_set_charset'] = 'Unableo set client connection character set: %s';

26 
	g$Ïng
['db_error_heading'] = 'A Database Error Occurred';

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/email_lang.php

1 <?
php


3 
	g$Ïng
['email_must_be_array'] = "Theƒmail validation method must be…assed‡n‡rray.";

4 
	g$Ïng
['email_invalid_address'] = "Invalidƒmail‡ddress: %s";

5 
	g$Ïng
['email_attachment_missing'] = "Unableo†ocatehe followingƒmail‡ttachment: %s";

6 
	g$Ïng
['email_attachment_unreadable'] = "Unableo openhis‡ttachment: %s";

7 
	g$Ïng
['email_no_recipients'] = "You must include„ecipients: To, Cc, or Bcc";

8 
	g$Ïng
['email_send_failure_phpmail'] = "Unableo sendƒmail using PHP mail(). Your server might‚ot be configuredo send mail usinghis method.";

9 
	g$Ïng
['email_send_failure_sendmail'] = "Unableo sendƒmail using PHP Sendmail. Your server might‚ot be configuredo send mail usinghis method.";

10 
	g$Ïng
['email_send_failure_smtp'] = "Unableo sendƒmail using PHP SMTP. Your server might‚ot be configuredo send mail usinghis method.";

11 
	g$Ïng
['email_sent'] = "Your message has been successfully sent usinghe following…rotocol: %s";

12 
	g$Ïng
['email_no_socket'] = "Unableo open‡ socketo Sendmail. Please check settings.";

13 
	g$Ïng
['email_no_hostname'] = "You did‚ot specify‡ SMTP hostname.";

14 
	g$Ïng
['email_smtp_error'] = "The following SMTPƒrror wasƒncountered: %s";

15 
	g$Ïng
['email_no_smtp_unpw'] = "Error: You must‡ssign‡ SMTP username‡nd…assword.";

16 
	g$Ïng
['email_failed_smtp_login'] = "Failedo send AUTH LOGIN command. Error: %s";

17 
	g$Ïng
['email_smtp_auth_un'] = "Failedo‡uthenticate username. Error: %s";

18 
	g$Ïng
['email_smtp_auth_pw'] = "Failedo‡uthenticate…assword. Error: %s";

19 
	g$Ïng
['email_smtp_data_failure'] = "Unableo send data: %s";

20 
	g$Ïng
['email_exit_status'] = "Exit status code: %s";

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/form_validation_lang.php

1 <?
php


3 
	g$Ïng
['required'] = "The %s field is„equired.";

4 
	g$Ïng
['isset'] = "The %s field must have‡ value.";

5 
	g$Ïng
['valid_email'] = "The %s field must contain‡ validƒmail‡ddress.";

6 
	g$Ïng
['valid_emails'] = "The %s field must contain‡ll validƒmail‡ddresses.";

7 
	g$Ïng
['valid_url'] = "The %s field must contain‡ valid URL.";

8 
	g$Ïng
['valid_ip'] = "The %s field must contain‡ valid IP.";

9 
	g$Ïng
['min_length'] = "The %s field must be‡t†east %s characters in†ength.";

10 
	g$Ïng
['max_length'] = "The %s field can‚otƒxceed %s characters in†ength.";

11 
	g$Ïng
['exact_length'] = "The %s field must beƒxactly %s characters in†ength.";

12 
	g$Ïng
['alpha'] = "The %s field may only contain‡lphabetical characters.";

13 
	g$Ïng
['alpha_numeric'] = "The %s field may only contain‡lpha-numeric characters.";

14 
	g$Ïng
['alpha_dash'] = "The %s field may only contain‡lpha-numeric characters, underscores,‡nd dashes.";

15 
	g$Ïng
['numeric'] = "The %s field must contain only‚umbers.";

16 
	g$Ïng
['is_numeric'] = "The %s field must contain only‚umeric characters.";

17 
	g$Ïng
['integer'] = "The %s field must contain‡n integer.";

18 
	g$Ïng
['regex_match'] = "The %s field is‚ot inhe correct format.";

19 
	g$Ïng
['matches'] = "The %s field does‚ot matchhe %s field.";

20 
	g$Ïng
['is_unique'] = "The %s field must contain‡ unique value.";

21 
	g$Ïng
['is_natural'] = "The %s field must contain only…ositive‚umbers.";

22 
	g$Ïng
['is_natural_no_zero'] = "The %s field must contain‡‚umber greaterhan zero.";

23 
	g$Ïng
['decimal'] = "The %s field must contain‡ decimal‚umber.";

24 
	g$Ïng
['less_than'] = "The %s field must contain‡‚umber†esshan %s.";

25 
	g$Ïng
['greater_than'] = "The %s field must contain‡‚umber greaterhan %s.";

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/ftp_lang.php

1 <?
php


3 
	g$Ïng
['ftp_no_connection'] = "Unableo†ocate‡ valid connection ID. Please make sure you‡re connected before…eforming‡ny file„outines.";

4 
	g$Ïng
['ftp_unable_to_connect'] = "Unableo connecto your FTP server usinghe supplied hostname.";

5 
	g$Ïng
['ftp_unable_to_login'] = "Unableo†ogino your FTP server. Please check your username‡nd…assword.";

6 
	g$Ïng
['ftp_unable_to_makdir'] = "Unableo createhe directory you have specified.";

7 
	g$Ïng
['ftp_unable_to_changedir'] = "Unableo change directories.";

8 
	g$Ïng
['ftp_unable_to_chmod'] = "Unableo set file…ermissions. Please check your…ath. Note: This feature is only‡vailable in PHP 5 or higher.";

9 
	g$Ïng
['ftp_unable_to_upload'] = "Unableo uploadhe specified file. Please check your…ath.";

10 
	g$Ïng
['ftp_unable_to_download'] = "Unableo downloadhe specified file. Please check your…ath.";

11 
	g$Ïng
['ftp_no_source_file'] = "Unableo†ocatehe source file. Please check your…ath.";

12 
	g$Ïng
['ftp_unable_to_rename'] = "Unableo„enamehe file.";

13 
	g$Ïng
['ftp_unable_to_delete'] = "Unableo deletehe file.";

14 
	g$Ïng
['ftp_unable_to_move'] = "Unableo movehe file. Please make surehe destination directoryƒxists.";

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/imglib_lang.php

1 <?
php


3 
	g$Ïng
['imglib_source_image_required'] = "You must specify‡ source image in your…references.";

4 
	g$Ïng
['imglib_gd_required'] = "The GD image†ibrary is„equired forhis feature.";

5 
	g$Ïng
['imglib_gd_required_for_props'] = "Your server must supporthe GD image†ibrary in ordero determinehe image…roperties.";

6 
	g$Ïng
['imglib_unsupported_imagecreate'] = "Your server does‚ot supporthe GD function„equiredo…rocesshisype of image.";

7 
	g$Ïng
['imglib_gif_not_supported'] = "GIF images‡re often‚ot supported dueo†icensing„estrictions. You may haveo use JPG or PNG images instead.";

8 
	g$Ïng
['imglib_jpg_not_supported'] = "JPG images‡re‚ot supported.";

9 
	g$Ïng
['imglib_png_not_supported'] = "PNG images‡re‚ot supported.";

10 
	g$Ïng
['imglib_jpg_or_png_required'] = "The image„esize…rotocol specified in your…references only works with JPEG or PNG imageypes.";

11 
	g$Ïng
['imglib_copy_error'] = "Anƒrror wasƒncountered while‡ttemptingo„eplacehe file. Please make sure your file directory is writable.";

12 
	g$Ïng
['imglib_rotate_unsupported'] = "Image„otation does‚ot‡ppearo be supported by your server.";

13 
	g$Ïng
['imglib_libpath_invalid'] = "The…atho your image†ibrary is‚ot correct. Please sethe correct…ath in your image…references.";

14 
	g$Ïng
['imglib_image_process_failed'] = "Image…rocessing failed. Please verifyhat your server supportshe chosen…rotocol‡ndhathe…atho your image†ibrary is correct.";

15 
	g$Ïng
['imglib_rotation_angle_required'] = "An‡ngle of„otation is„equiredo„otatehe image.";

16 
	g$Ïng
['imglib_writing_failed_gif'] = "GIF image.";

17 
	g$Ïng
['imglib_invalid_path'] = "The…athohe image is‚ot correct.";

18 
	g$Ïng
['imglib_copy_failed'] = "The image copy„outine failed.";

19 
	g$Ïng
['imglib_missing_font'] = "Unableo find‡ fonto use.";

20 
	g$Ïng
['imglib_save_failed'] = "Unableo savehe image. Please make surehe image‡nd file directory‡re writable.";

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/migration_lang.php

1 <?
php


3 
	g$Ïng
['migration_none_found'] = "No migrations were found.";

4 
	g$Ïng
['migration_not_found'] = "This migration could‚ot be found.";

5 
	g$Ïng
['migration_multiple_version'] = "This‡re multiple migrations withhe same version‚umber: %d.";

6 
	g$Ïng
['migration_class_doesnt_exist'] = "The migration class \"%s\" could‚ot be found.";

7 
	g$Ïng
['migration_missing_up_method'] = "The migration class \"%s\" is missing‡n 'up' method.";

8 
	g$Ïng
['migration_missing_down_method'] = "The migration class \"%s\" is missing‡n 'down' method.";

9 
	g$Ïng
['migration_invalid_filename'] = "Migration \"%s\" has‡n invalid filename.";

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/number_lang.php

1 <?
php


3 
	g$Ïng
['terabyte_abbr'] = "TB";

4 
	g$Ïng
['gigabyte_abbr'] = "GB";

5 
	g$Ïng
['megabyte_abbr'] = "MB";

6 
	g$Ïng
['kilobyte_abbr'] = "KB";

7 
	g$Ïng
['bytes'] = "Bytes";

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/profiler_lang.php

1 <?
php


3 
	g$Ïng
['profiler_database'] = 'DATABASE';

4 
	g$Ïng
['profiler_controller_info'] = 'CLASS/METHOD';

5 
	g$Ïng
['profiler_benchmarks'] = 'BENCHMARKS';

6 
	g$Ïng
['profiler_queries'] = 'QUERIES';

7 
	g$Ïng
['profiler_get_data'] = 'GET DATA';

8 
	g$Ïng
['profiler_post_data'] = 'POST DATA';

9 
	g$Ïng
['profiler_uri_string'] = 'URI STRING';

10 
	g$Ïng
['profiler_memory_usage'] = 'MEMORY USAGE';

11 
	g$Ïng
['profiler_config'] = 'CONFIG VARIABLES';

12 
	g$Ïng
['profiler_session_data'] = 'SESSION DATA';

13 
	g$Ïng
['profiler_headers'] = 'HTTP HEADERS';

14 
	g$Ïng
['profiler_no_db'] = 'Database driver is‚ot currently†oaded';

15 
	g$Ïng
['profiler_no_queries'] = 'No queries were„un';

16 
	g$Ïng
['profiler_no_post'] = 'No POST dataƒxists';

17 
	g$Ïng
['profiler_no_get'] = 'No GET dataƒxists';

18 
	g$Ïng
['profiler_no_uri'] = 'No URI dataƒxists';

19 
	g$Ïng
['profiler_no_memory'] = 'Memory Usage Unavailable';

20 
	g$Ïng
['profiler_no_profiles'] = 'No Profile data -‡ll Profiler sections have been disabled.';

21 
	g$Ïng
['profiler_section_hide'] = 'Hide';

22 
	g$Ïng
['profiler_section_show'] = 'Show';

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/unit_test_lang.php

1 <?
php


3 
	g$Ïng
['ut_test_name'] = 'Test Name';

4 
	g$Ïng
['ut_test_datatype'] = 'Test Datatype';

5 
	g$Ïng
['ut_res_datatype'] = 'Expected Datatype';

6 
	g$Ïng
['ut_result'] = 'Result';

7 
	g$Ïng
['ut_undefined'] = 'Undefined Test Name';

8 
	g$Ïng
['ut_file'] = 'File Name';

9 
	g$Ïng
['ut_line'] = 'Line Number';

10 
	g$Ïng
['ut_passed'] = 'Passed';

11 
	g$Ïng
['ut_failed'] = 'Failed';

12 
	g$Ïng
['ut_boolean'] = 'Boolean';

13 
	g$Ïng
['ut_integer'] = 'Integer';

14 
	g$Ïng
['ut_float'] = 'Float';

15 
	g$Ïng
['ut_double'] = 'Float';

16 
	g$Ïng
['ut_string'] = 'String';

17 
	g$Ïng
['ut_array'] = 'Array';

18 
	g$Ïng
['ut_object'] = 'Object';

19 
	g$Ïng
['ut_resource'] = 'Resource';

20 
	g$Ïng
['ut_null'] = 'Null';

21 
	g$Ïng
['ut_notes'] = 'Notes';

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/upload_lang.php

1 <?
php


3 
	g$Ïng
['upload_userfile_not_set'] = "Unableo find‡…ost variable called userfile.";

4 
	g$Ïng
['upload_file_exceeds_limit'] = "The uploaded fileƒxceedshe maximum‡llowed size in your PHP configuration file.";

5 
	g$Ïng
['upload_file_exceeds_form_limit'] = "The uploaded fileƒxceedshe maximum size‡llowed byhe submission form.";

6 
	g$Ïng
['upload_file_partial'] = "The file was only…artially uploaded.";

7 
	g$Ïng
['upload_no_temp_directory'] = "Theemporary folder is missing.";

8 
	g$Ïng
['upload_unable_to_write_file'] = "The file could‚ot be writteno disk.";

9 
	g$Ïng
['upload_stopped_by_extension'] = "The file upload was stopped byƒxtension.";

10 
	g$Ïng
['upload_no_file_selected'] = "You did‚ot select‡ fileo upload.";

11 
	g$Ïng
['upload_invalid_filetype'] = "The filetype you‡re‡ttemptingo upload is‚ot‡llowed.";

12 
	g$Ïng
['upload_invalid_filesize'] = "The file you‡re‡ttemptingo upload is†argerhanhe…ermitted size.";

13 
	g$Ïng
['upload_invalid_dimensions'] = "The image you‡re‡ttemptingo uploadƒxceedeshe maximum height or width.";

14 
	g$Ïng
['upload_destination_error'] = "A…roblem wasƒncountered while‡ttemptingo movehe uploaded fileohe final destination.";

15 
	g$Ïng
['upload_no_filepath'] = "The upload…ath does‚ot‡ppearo be valid.";

16 
	g$Ïng
['upload_no_file_types'] = "You have‚ot specified‡ny‡llowed fileypes.";

17 
	g$Ïng
['upload_bad_filename'] = "The file‚ame you submitted‡lreadyƒxists onhe server.";

18 
	g$Ïng
['upload_not_writable'] = "The upload destination folder does‚ot‡ppearo be writable.";

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cache/Cache.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Cache
 
ex‹nds
 
	mCI_Driv”_Lib¿ry
 {

29 
´Ùeùed
 
	m$v®id_driv”s
 = 
¬¿y
(

33 
´Ùeùed
 
	m$_ÿche_·th
 = 
NULL
;

34 
´Ùeùed
 
	m$_ad­‹r
 = 'dummy';

35 
´Ùeùed
 
	m$_backup_driv”
;

44 
public
 
funùiÚ
 
__cÚ¡ruù
(
$cÚfig
 = 
	$¬¿y
())

46 iàĞ! 
	`em±y
(
$cÚfig
))

48 
$this
->
	`_š™Ÿlize
(
$cÚfig
);

63 
public
 
funùiÚ
 
	$g‘
(
$id
)

65  
$this
->{$this->
_ad­‹r
}->
	`g‘
(
$id
);

66 
	}
}

79 
public
 
funùiÚ
 
	$§ve
(
$id
, 
$d©a
, 
$‰l
 = 60)

81  
$this
->{$this->
_ad­‹r
}->
	`§ve
(
$id
, 
$d©a
, 
$‰l
);

82 
	}
}

92 
public
 
funùiÚ
 
	$d–‘e
(
$id
)

94  
$this
->{$this->
_ad­‹r
}->
	`d–‘e
(
$id
);

95 
	}
}

104 
public
 
funùiÚ
 
	$ş—n
()

106  
$this
->{$this->
_ad­‹r
}->
	`ş—n
();

107 
	}
}

117 
public
 
funùiÚ
 
ÿche_šfo
(
$ty³
 = 'user')

119  
$this
->{$this->
_ad­‹r
}->
ÿche_šfo
(
$ty³
);

130 
public
 
funùiÚ
 
	$g‘_m‘ad©a
(
$id
)

132  
$this
->{$this->
_ad­‹r
}->
	`g‘_m‘ad©a
(
$id
);

133 
	}
}

145 
´iv©e
 
funùiÚ
 
	$_š™Ÿlize
(
$cÚfig
)

147 
$deçuÉ_cÚfig
 = 
	`¬¿y
(

152 
	`fÜ—ch
 (
$deçuÉ_cÚfig
 
as
 
$key
)

154 ià(
	`is£t
(
$cÚfig
[
$key
]))

156 
$·¿m
 = '_'.
$key
;

158 
$this
->{
$·¿m
} = 
$cÚfig
[
$key
];

162 ià(
	`is£t
(
$cÚfig
['backup']))

164 ià(
	`š_¬¿y
('ÿche_'.
$cÚfig
['backup'], 
$this
->
v®id_driv”s
))

166 
$this
->
_backup_driv”
 = 
$cÚfig
['backup'];

169 
	}
}

179 
public
 
funùiÚ
 
	$is_suµÜ‹d
(
$driv”
)

181 
$suµÜt
 = 
	`¬¿y
();

183 iàĞ! 
	`is£t
(
$suµÜt
[
$driv”
]))

185 
$suµÜt
[
$driv”
] = 
$this
->{$driv”}->
	`is_suµÜ‹d
();

188  
$suµÜt
[
$driv”
];

189 
	}
}

199 
public
 
funùiÚ
 
	$__g‘
(
$chd
)

201 
$obj
 = 
·»Á
::
	`__g‘
(
$chd
);

203 iàĞ! 
$this
->
	`is_suµÜ‹d
(
$chd
))

205 
$this
->
_ad­‹r
 = $this->
_backup_driv”
;

208  
$obj
;

209 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cache/drivers/Cache_apc.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

28 şas 
	cCI_Cache_­c
 
ex‹nds
 
	mCI_Driv”
 {

39 
public
 
funùiÚ
 
	$g‘
(
$id
)

41 
$d©a
 = 
	`­c_ãtch
(
$id
);

43  (
	`is_¬¿y
(
$d©a
)è? $d©a[0] : 
FALSE
;

57 
public
 
funùiÚ
 
	$§ve
(
$id
, 
$d©a
, 
$‰l
 = 60)

59  
	`­c_¡Üe
(
$id
, 
	`¬¿y
(
$d©a
, 
	`time
(), 
$‰l
), $ttl);

60 
	}
}

70 
public
 
funùiÚ
 
	$d–‘e
(
$id
)

72  
	`­c_d–‘e
(
$id
);

73 
	}
}

82 
public
 
funùiÚ
 
	$ş—n
()

84  
	`­c_ş—r_ÿche
('user');

85 
	}
}

95 
public
 
funùiÚ
 
	$ÿche_šfo
(
$ty³
 = 
NULL
)

97  
	`­c_ÿche_šfo
(
$ty³
);

98 
	}
}

108 
public
 
funùiÚ
 
	$g‘_m‘ad©a
(
$id
)

110 
$¡Üed
 = 
	`­c_ãtch
(
$id
);

112 ià(
	`couÁ
(
$¡Üed
) !== 3)

114  
FALSE
;

117 
	`li¡
(
$d©a
, 
$time
, 
$‰l
èğ
$¡Üed
;

119  
	`¬¿y
(

120 'expœe' => 
$time
 + 
$‰l
,

121 'mtime' => 
$time
,

122 'd©a' => 
$d©a


124 
	}
}

133 
public
 
funùiÚ
 
	$is_suµÜ‹d
()

135 iàĞ! 
	`ex‹nsiÚ_lßded
('­c'è
OR
 
	`ši_g‘
('apc.enabled') != "1")

137 
	`log_mes§ge
('error', 'The APC PHPƒxtension must be†oadedo use APC Cache.');

138  
FALSE
;

141  
TRUE
;

142 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cache/drivers/Cache_dummy.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

28 şas 
	cCI_Cache_dummy
 
ex‹nds
 
	mCI_Driv”
 {

38 
public
 
funùiÚ
 
	$g‘
(
$id
)

40  
FALSE
;

54 
public
 
funùiÚ
 
	$§ve
(
$id
, 
$d©a
, 
$‰l
 = 60)

56  
TRUE
;

57 
	}
}

67 
public
 
funùiÚ
 
	$d–‘e
(
$id
)

69  
TRUE
;

70 
	}
}

79 
public
 
funùiÚ
 
	$ş—n
()

81  
TRUE
;

82 
	}
}

92 
public
 
funùiÚ
 
	$ÿche_šfo
(
$ty³
 = 
NULL
)

94  
FALSE
;

95 
	}
}

105 
public
 
funùiÚ
 
	$g‘_m‘ad©a
(
$id
)

107  
FALSE
;

108 
	}
}

118 
public
 
funùiÚ
 
	$is_suµÜ‹d
()

120  
TRUE
;

121 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cache/drivers/Cache_file.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

28 şas 
	cCI_Cache_fe
 
ex‹nds
 
	mCI_Driv”
 {

30 
´Ùeùed
 
	m$_ÿche_·th
;

35 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

37 
$CI
 =& 
	`g‘_š¡ªû
();

38 
$CI
->
lßd
->
	`h–³r
('file');

40 
$·th
 = 
$CI
->
cÚfig
->
	`™em
('cache_path');

42 
$this
->
_ÿche_·th
 = (
$·th
 =ğ''è? 
APPPATH
.'cache/' : $path;

53 
public
 
funùiÚ
 
	$g‘
(
$id
)

55 iàĞ! 
	`fe_exi¡s
(
$this
->
_ÿche_·th
.
$id
))

57  
FALSE
;

60 
$d©a
 = 
	`»ad_fe
(
$this
->
_ÿche_·th
.
$id
);

61 
$d©a
 = 
	`un£rŸlize
($data);

63 ià(
	`time
(è> 
$d©a
['time'] + $data['ttl'])

65 
	`uÆšk
(
$this
->
_ÿche_·th
.
$id
);

66  
FALSE
;

69  
$d©a
['data'];

70 
	}
}

83 
public
 
funùiÚ
 
	$§ve
(
$id
, 
$d©a
, 
$‰l
 = 60)

85 
$cÚ‹Ás
 = 
	`¬¿y
(

86 'time' => 
	`time
(),

87 '‰l' => 
$‰l
,

88 'd©a' => 
$d©a


91 ià(
	`wr™e_fe
(
$this
->
_ÿche_·th
.
$id
, 
	`£rŸlize
(
$cÚ‹Ás
)))

93 @
	`chmod
(
$this
->
_ÿche_·th
.
$id
, 0777);

94  
TRUE
;

97  
FALSE
;

98 
	}
}

108 
public
 
funùiÚ
 
	$d–‘e
(
$id
)

110  
	`uÆšk
(
$this
->
_ÿche_·th
.
$id
);

111 
	}
}

120 
public
 
funùiÚ
 
	$ş—n
()

122  
	`d–‘e_fes
(
$this
->
_ÿche_·th
);

123 
	}
}

135 
public
 
funùiÚ
 
	$ÿche_šfo
(
$ty³
 = 
NULL
)

137  
	`g‘_dœ_fe_šfo
(
$this
->
_ÿche_·th
);

138 
	}
}

148 
public
 
funùiÚ
 
	$g‘_m‘ad©a
(
$id
)

150 iàĞ! 
	`fe_exi¡s
(
$this
->
_ÿche_·th
.
$id
))

152  
FALSE
;

155 
$d©a
 = 
	`»ad_fe
(
$this
->
_ÿche_·th
.
$id
);

156 
$d©a
 = 
	`un£rŸlize
($data);

158 ià(
	`is_¬¿y
(
$d©a
))

160 
$mtime
 = 
	`femtime
(
$this
->
_ÿche_·th
.
$id
);

162 iàĞ! 
	`is£t
(
$d©a
['ttl']))

164  
FALSE
;

167  
	`¬¿y
(

168 'expœe' => 
$mtime
 + 
$d©a
['ttl'],

169 'mtime' => 
$mtime


173  
FALSE
;

174 
	}
}

185 
public
 
funùiÚ
 
	$is_suµÜ‹d
()

187  
	`is_»®ly_wr™abË
(
$this
->
_ÿche_·th
);

188 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cache/drivers/Cache_memcached.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

28 şas 
	cCI_Cache_memÿched
 
ex‹nds
 
	mCI_Driv”
 {

30 
´iv©e
 
	m$_memÿched
;

32 
´Ùeùed
 
	m$_memÿche_cÚf
 = 
¬¿y
(

33 'deçuÉ' => 
¬¿y
(

48 
public
 
funùiÚ
 
	$g‘
(
$id
)

50 
$d©a
 = 
$this
->
_memÿched
->
	`g‘
(
$id
);

52  (
	`is_¬¿y
(
$d©a
)è? $d©a[0] : 
FALSE
;

65 
public
 
funùiÚ
 
	$§ve
(
$id
, 
$d©a
, 
$‰l
 = 60)

67 ià(
	`g‘_şass
(
$this
->
_memÿched
) == 'Memcached')

69  
$this
->
_memÿched
->
	`£t
(
$id
, 
	`¬¿y
(
$d©a
, 
	`time
(), 
$‰l
), $ttl);

71 ià(
	`g‘_şass
(
$this
->
_memÿched
) == 'Memcache')

73  
$this
->
_memÿched
->
	`£t
(
$id
, 
	`¬¿y
(
$d©a
, 
	`time
(), 
$‰l
), 0, $ttl);

76  
FALSE
;

77 
	}
}

87 
public
 
funùiÚ
 
	$d–‘e
(
$id
)

89  
$this
->
_memÿched
->
	`d–‘e
(
$id
);

90 
	}
}

99 
public
 
funùiÚ
 
	$ş—n
()

101  
$this
->
_memÿched
->
	`æush
();

102 
	}
}

112 
public
 
funùiÚ
 
	$ÿche_šfo
(
$ty³
 = 
NULL
)

114  
$this
->
_memÿched
->
	`g‘Sts
();

115 
	}
}

125 
public
 
funùiÚ
 
	$g‘_m‘ad©a
(
$id
)

127 
$¡Üed
 = 
$this
->
_memÿched
->
	`g‘
(
$id
);

129 ià(
	`couÁ
(
$¡Üed
) !== 3)

131  
FALSE
;

134 
	`li¡
(
$d©a
, 
$time
, 
$‰l
èğ
$¡Üed
;

136  
	`¬¿y
(

137 'expœe' => 
$time
 + 
$‰l
,

138 'mtime' => 
$time
,

139 'd©a' => 
$d©a


141 
	}
}

148 
´iv©e
 
funùiÚ
 
	$_£tup_memÿched
()

151 
$CI
 =& 
	`g‘_š¡ªû
();

152 ià(
$CI
->
cÚfig
->
	`lßd
('memÿched', 
TRUE
, TRUE))

154 ià(
	`is_¬¿y
(
$CI
->
cÚfig
->config['memcached']))

156 
$this
->
_memÿche_cÚf
 = 
NULL
;

158 
	`fÜ—ch
 (
$CI
->
cÚfig
->cÚfig['memÿched'] 
as
 
$Çme
 => 
$cÚf
)

160 
$this
->
_memÿche_cÚf
[
$Çme
] = 
$cÚf
;

165 
$this
->
_memÿched
 = 
Ãw
 
	`Memÿched
();

167 
	`fÜ—ch
 (
$this
->
_memÿche_cÚf
 
as
 
$Çme
 => 
$ÿche_£rv”
)

169 iàĞ! 
	`¬¿y_key_exi¡s
('ho¡Çme', 
$ÿche_£rv”
))

171 
$ÿche_£rv”
['ho¡Çme'] = 
$this
->
_deçuÉ_İtiÚs
['default_host'];

174 iàĞ! 
	`¬¿y_key_exi¡s
('pÜt', 
$ÿche_£rv”
))

176 
$ÿche_£rv”
['pÜt'] = 
$this
->
_deçuÉ_İtiÚs
['default_port'];

179 iàĞ! 
	`¬¿y_key_exi¡s
('weight', 
$ÿche_£rv”
))

181 
$ÿche_£rv”
['weight'] = 
$this
->
_deçuÉ_İtiÚs
['default_weight'];

184 
$this
->
_memÿched
->
	`addS”v”
(

185 
$ÿche_£rv”
['hostname'], $cache_server['port'], $cache_server['weight']

188 
	}
}

199 
public
 
funùiÚ
 
	$is_suµÜ‹d
()

201 iàĞ! 
	`ex‹nsiÚ_lßded
('memcached'))

203 
	`log_mes§ge
('error', 'The Memcached Extension must be†oadedo use Memcached Cache.');

204  
FALSE
;

207 
$this
->
	`_£tup_memÿched
();

208  
TRUE
;

209 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Calendar.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_C®’d¬
 {

31 
v¬
 
	m$CI
;

32 
v¬
 
	m$Ïng
;

33 
v¬
 
	m$loÿl_time
;

34 
v¬
 
	m$‹m¶©e
 = '';

35 
v¬
 
	m$¡¬t_day
 = 'sunday';

36 
v¬
 
	m$mÚth_ty³
 = 'long';

37 
v¬
 
	m$day_ty³
 = 'abr';

38 
v¬
 
	m$show_Ãxt_´ev
 = 
FALSE
;

39 
v¬
 
	m$Ãxt_´ev_u¾
 = '';

46 
public
 
funùiÚ
 
__cÚ¡ruù
(
$cÚfig
 = 
	$¬¿y
())

48 
$this
->
CI
 =& 
	`g‘_š¡ªû
();

50 iàĞ! 
	`š_¬¿y
('ÿËnd¬_Ïng.php', 
$this
->
CI
->
Ïng
->
is_lßded
, 
TRUE
))

52 
$this
->
CI
->
Ïng
->
	`lßd
('calendar');

55 
$this
->
loÿl_time
 = 
	`time
();

57 ià(
	`couÁ
(
$cÚfig
) > 0)

59 
$this
->
	`š™Ÿlize
(
$cÚfig
);

62 
	`log_mes§ge
('debug', "Calendar Class Initialized");

76 
funùiÚ
 
	`š™Ÿlize
(
$cÚfig
 = 
	$¬¿y
())

78 
	`fÜ—ch
 (
$cÚfig
 
as
 
$key
 => 
$v®
)

80 ià(
	`is£t
(
$this
->
$key
))

82 
$this
->
$key
 = 
$v®
;

85 
	}
}

98 
funùiÚ
 
g’”©e
(
$y—r
 = '', 
$mÚth
 = '', 
$d©a
 = 
	$¬¿y
())

101 ià(
$y—r
 == '')

102 
$y—r
 = 
	`d©e
("Y", 
$this
->
loÿl_time
);

104 ià(
$mÚth
 == '')

105 
$mÚth
 = 
	`d©e
("m", 
$this
->
loÿl_time
);

107 ià(
	`¡¾’
(
$y—r
) == 1)

108 
$y—r
 = '200'.$year;

110 ià(
	`¡¾’
(
$y—r
) == 2)

111 
$y—r
 = '20'.$year;

113 ià(
	`¡¾’
(
$mÚth
) == 1)

114 
$mÚth
 = '0'.$month;

116 
$adju¡ed_d©e
 = 
$this
->
	`adju¡_d©e
(
$mÚth
, 
$y—r
);

118 
$mÚth
 = 
$adju¡ed_d©e
['month'];

119 
$y—r
 = 
$adju¡ed_d©e
['year'];

122 
$tÙ®_days
 = 
$this
->
	`g‘_tÙ®_days
(
$mÚth
, 
$y—r
);

125 
$¡¬t_days
 = 
	`¬¿y
('sunday' => 0, 'monday' => 1, 'tuesday' => 2, 'wednesday' => 3, 'thursday' => 4, 'friday' => 5, 'saturday' => 6);

126 
$¡¬t_day
 = ( ! 
	`is£t
(
$¡¬t_days
[
$this
->
¡¬t_day
])) ? 0 : $start_days[$this->start_day];

129 
$loÿl_d©e
 = 
	`mktime
(12, 0, 0, 
$mÚth
, 1, 
$y—r
);

130 
$d©e
 = 
	`g‘d©e
(
$loÿl_d©e
);

131 
$day
 = 
$¡¬t_day
 + 1 - 
$d©e
["wday"];

133 
$day
 > 1)

135 
$day
 -= 7;

140 
$cur_y—r
 = 
	`d©e
("Y", 
$this
->
loÿl_time
);

141 
$cur_mÚth
 = 
	`d©e
("m", 
$this
->
loÿl_time
);

142 
$cur_day
 = 
	`d©e
("j", 
$this
->
loÿl_time
);

144 
$is_cu¼’t_mÚth
 = (
$cur_y—r
 =ğ
$y—r
 
AND
 
$cur_mÚth
 =ğ
$mÚth
è? 
TRUE
 : 
FALSE
;

147 
$this
->
	`·r£_‹m¶©e
();

150 
$out
 = 
$this
->
‹mp
['table_open'];

151 
$out
 .= "\n";

153 
$out
 .= "\n";

154 
$out
 .ğ
$this
->
‹mp
['heading_row_start'];

155 
$out
 .= "\n";

158 ià(
$this
->
show_Ãxt_´ev
 =ğ
TRUE
)

161 
$this
->
Ãxt_´ev_u¾
 = 
	`´eg_»¶aû
("/(.+?)\/*$/", "\\1/", $this->next_prev_url);

163 
$adju¡ed_d©e
 = 
$this
->
	`adju¡_d©e
(
$mÚth
 - 1, 
$y—r
);

164 
$out
 .ğ
	`¡r_»¶aû
('{´evious_u¾}', 
$this
->
Ãxt_´ev_u¾
.
$adju¡ed_d©e
['y—r'].'/'.$adju¡ed_d©e['mÚth'], $this->
‹mp
['heading_previous_cell']);

165 
$out
 .= "\n";

169 
$cŞ¥ª
 = (
$this
->
show_Ãxt_´ev
 =ğ
TRUE
) ? 5 : 7;

171 
$this
->
‹mp
['h—dšg_t™Ë_ûÎ'] = 
	`¡r_»¶aû
('{cŞ¥ª}', 
$cŞ¥ª
, $this->temp['heading_title_cell']);

172 
$this
->
‹mp
['h—dšg_t™Ë_ûÎ'] = 
	`¡r_»¶aû
('{h—dšg}', $this->
	`g‘_mÚth_Çme
(
$mÚth
)."&nb¥;".
$y—r
, $this->temp['heading_title_cell']);

174 
$out
 .ğ
$this
->
‹mp
['heading_title_cell'];

175 
$out
 .= "\n";

178 ià(
$this
->
show_Ãxt_´ev
 =ğ
TRUE
)

180 
$adju¡ed_d©e
 = 
$this
->
	`adju¡_d©e
(
$mÚth
 + 1, 
$y—r
);

181 
$out
 .ğ
	`¡r_»¶aû
('{Ãxt_u¾}', 
$this
->
Ãxt_´ev_u¾
.
$adju¡ed_d©e
['y—r'].'/'.$adju¡ed_d©e['mÚth'], $this->
‹mp
['heading_next_cell']);

184 
$out
 .= "\n";

185 
$out
 .ğ
$this
->
‹mp
['heading_row_end'];

186 
$out
 .= "\n";

189 
$out
 .= "\n";

190 
$out
 .ğ
$this
->
‹mp
['week_row_start'];

191 
$out
 .= "\n";

193 
$day_Çmes
 = 
$this
->
	`g‘_day_Çmes
();

195 
$i
 = 0; $i < 7; $i ++)

197 
$out
 .ğ
	`¡r_»¶aû
('{w“k_day}', 
$day_Çmes
[(
$¡¬t_day
 + 
$i
è%7], 
$this
->
‹mp
['week_day_cell']);

200 
$out
 .= "\n";

201 
$out
 .ğ
$this
->
‹mp
['week_row_end'];

202 
$out
 .= "\n";

205 
$day
 <ğ
$tÙ®_days
)

207 
$out
 .= "\n";

208 
$out
 .ğ
$this
->
‹mp
['cal_row_start'];

209 
$out
 .= "\n";

211 
$i
 = 0; $i < 7; $i++)

213 
$out
 .ğ(
$is_cu¼’t_mÚth
 =ğ
TRUE
 
AND
 
$day
 =ğ
$cur_day
è? 
$this
->
‹mp
['cal_cell_start_today'] : $this->temp['cal_cell_start'];

215 ià(
$day
 > 0 
AND
 $day <ğ
$tÙ®_days
)

217 ià(
	`is£t
(
$d©a
[
$day
]))

220 
$‹mp
 = (
$is_cu¼’t_mÚth
 =ğ
TRUE
 
AND
 
$day
 =ğ
$cur_day
è? 
$this
->
‹mp
['cal_cell_content_today'] : $this->temp['cal_cell_content'];

221 
$out
 .ğ
	`¡r_»¶aû
('{day}', 
$day
, sŒ_»¶aû('{cÚ‹Á}', 
$d©a
[$day], 
$‹mp
));

226 
$‹mp
 = (
$is_cu¼’t_mÚth
 =ğ
TRUE
 
AND
 
$day
 =ğ
$cur_day
è? 
$this
->
‹mp
['cal_cell_no_content_today'] : $this->temp['cal_cell_no_content'];

227 
$out
 .ğ
	`¡r_»¶aû
('{day}', 
$day
, 
$‹mp
);

233 
$out
 .ğ
$this
->
‹mp
['cal_cell_blank'];

236 
$out
 .ğ(
$is_cu¼’t_mÚth
 =ğ
TRUE
 
AND
 
$day
 =ğ
$cur_day
è? 
$this
->
‹mp
['cal_cell_end_today'] : $this->temp['cal_cell_end'];

237 
$day
++;

240 
$out
 .= "\n";

241 
$out
 .ğ
$this
->
‹mp
['cal_row_end'];

242 
$out
 .= "\n";

245 
$out
 .= "\n";

246 
$out
 .ğ
$this
->
‹mp
['table_close'];

248  
$out
;

249 
	}
}

263 
funùiÚ
 
	$g‘_mÚth_Çme
(
$mÚth
)

265 ià(
$this
->
mÚth_ty³
 == 'short')

267 
$mÚth_Çmes
 = 
	`¬¿y
('01' => 'cal_jan', '02' => 'cal_feb', '03' => 'cal_mar', '04' => 'cal_apr', '05' => 'cal_may', '06' => 'cal_jun', '07' => 'cal_jul', '08' => 'cal_aug', '09' => 'cal_sep', '10' => 'cal_oct', '11' => 'cal_nov', '12' => 'cal_dec');

271 
$mÚth_Çmes
 = 
	`¬¿y
('01' => 'cal_january', '02' => 'cal_february', '03' => 'cal_march', '04' => 'cal_april', '05' => 'cal_mayl', '06' => 'cal_june', '07' => 'cal_july', '08' => 'cal_august', '09' => 'cal_september', '10' => 'cal_october', '11' => 'cal_november', '12' => 'cal_december');

274 
$mÚth
 = 
$mÚth_Çmes
[$month];

276 ià(
$this
->
CI
->
Ïng
->
	`lše
(
$mÚth
è==ğ
FALSE
)

278  
	`ucfœ¡
(
	`¡r_»¶aû
('ÿl_', '', 
$mÚth
));

281  
$this
->
CI
->
Ïng
->
	`lše
(
$mÚth
);

282 
	}
}

296 
funùiÚ
 
g‘_day_Çmes
(
$day_ty³
 = '')

298 ià(
$day_ty³
 != '')

299 
$this
->
day_ty³
 = 
$day_ty³
;

301 ià(
	g$this
->
	gday_ty³
 == 'long')

303 
$day_Çmes
 = 
¬¿y
('sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday');

305 
–£if
 (
$this
->
day_ty³
 == 'short')

307 
$day_Çmes
 = 
¬¿y
('sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat');

311 
	g$day_Çmes
 = 
¬¿y
('su', 'mo', 'tu', 'we', 'th', 'fr', 'sa');

314 
	g$days
 = 
¬¿y
();

315 
fÜ—ch
 (
$day_Çmes
 
as
 
$v®
)

317 
	g$days
[] = (
$this
->
CI
->
Ïng
->
lše
('ÿl_'.
$v®
è==ğ
FALSE
è? 
ucfœ¡
($val) : $this->CI->lang->line('cal_'.$val);

320  
	g$days
;

337 
funùiÚ
 
	$adju¡_d©e
(
$mÚth
, 
$y—r
)

339 
$d©e
 = 
	`¬¿y
();

341 
$d©e
['mÚth'] = 
$mÚth
;

342 
$d©e
['y—r'] = 
$y—r
;

344 
$d©e
['month'] > 12)

346 
$d©e
['month'] -= 12;

347 
$d©e
['year']++;

350 
$d©e
['month'] <= 0)

352 
$d©e
['month'] += 12;

353 
$d©e
['year']--;

356 ià(
	`¡¾’
(
$d©e
['month']) == 1)

358 
$d©e
['month'] = '0'.$date['month'];

361  
$d©e
;

362 
	}
}

374 
funùiÚ
 
	$g‘_tÙ®_days
(
$mÚth
, 
$y—r
)

376 
$days_š_mÚth
 = 
	`¬¿y
(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);

378 ià(
$mÚth
 < 1 
OR
 $month > 12)

384 ià(
$mÚth
 == 2)

386 ià(
$y—r
 % 400 =ğ0 
	`OR
 ($y—¸% 4 =ğ0 
AND
 $year % 100 != 0))

392  
$days_š_mÚth
[
$mÚth
 - 1];

393 
	}
}

405 
funùiÚ
 
	$deçuÉ_‹m¶©e
()

407  
	`¬¿y
 (

430 
	}
}

443 
funùiÚ
 
	$·r£_‹m¶©e
()

445 
$this
->
‹mp
 = $this->
	`deçuÉ_‹m¶©e
();

447 ià(
$this
->
‹m¶©e
 == '')

452 
$today
 = 
	`¬¿y
('cal_cell_start_today', 'cal_cell_content_today', 'cal_cell_no_content_today', 'cal_cell_end_today');

454 
	`fÜ—ch
 (
	`¬¿y
('bË_İ’', 'bË_şo£', 'h—dšg_row_¡¬t', 'h—dšg_´evious_ûÎ', 'h—dšg_t™Ë_ûÎ', 'h—dšg_Ãxt_ûÎ', 'h—dšg_row_’d', 'w“k_row_¡¬t', 'w“k_day_ûÎ', 'w“k_row_’d', 'ÿl_row_¡¬t', 'ÿl_ûÎ_¡¬t', 'ÿl_ûÎ_cÚ‹Á', 'ÿl_ûÎ_no_cÚ‹Á', 'ÿl_ûÎ_bÏnk', 'ÿl_ûÎ_’d', 'ÿl_row_’d', 'ÿl_ûÎ_¡¬t_today', 'ÿl_ûÎ_cÚ‹Á_today', 'ÿl_ûÎ_no_cÚ‹Á_today', 'ÿl_ûÎ_’d_today'è
as
 
$v®
)

456 ià(
	`´eg_m©ch
("/\{".
$v®
."\}(.*?)\{\/".$v®."\}/si", 
$this
->
‹m¶©e
, 
$m©ch
))

458 
$this
->
‹mp
[
$v®
] = 
$m©ch
['1'];

462 ià(
	`š_¬¿y
(
$v®
, 
$today
, 
TRUE
))

464 
$this
->
‹mp
[
$v®
] = $this->‹mp[
	`¡r_»¶aû
('_today', '', $val)];

468 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cart.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_C¬t
 {

30 
v¬
 
	m$´oduù_id_ruËs
 = '\.a-z0-9_-';

31 
v¬
 
	m$´oduù_Çme_ruËs
 = '\.\:\-_‡-z0-9';

34 
v¬
 
	m$CI
;

35 
v¬
 
	m$_ÿ¹_cÚ‹Ás
 = 
¬¿y
();

43 
public
 
funùiÚ
 
__cÚ¡ruù
(
$·¿ms
 = 
	$¬¿y
())

46 
$this
->
CI
 =& 
	`g‘_š¡ªû
();

49 
$cÚfig
 = 
	`¬¿y
();

50 ià(
	`couÁ
(
$·¿ms
) > 0)

52 
	`fÜ—ch
 (
$·¿ms
 
as
 
$key
 => 
$v®
)

54 
$cÚfig
[
$key
] = 
$v®
;

59 
$this
->
CI
->
lßd
->
	`lib¿ry
('£ssiÚ', 
$cÚfig
);

62 ià(
$this
->
CI
->
£ssiÚ
->
	`u£rd©a
('ÿ¹_cÚ‹Ás'è!=ğ
FALSE
)

64 
$this
->
_ÿ¹_cÚ‹Ás
 = $this->
CI
->
£ssiÚ
->
	`u£rd©a
('cart_contents');

69 
$this
->
_ÿ¹_cÚ‹Ás
['cart_total'] = 0;

70 
$this
->
_ÿ¹_cÚ‹Ás
['total_items'] = 0;

73 
	`log_mes§ge
('debug', "Cart Class Initialized");

85 
funùiÚ
 
	`š£¹
(
$™ems
 = 
	$¬¿y
())

88 iàĞ! 
	`is_¬¿y
(
$™ems
è
OR
 
	`couÁ
($items) == 0)

90 
	`log_mes§ge
('error', 'The insert method must be…assed‡n‡rray containing data.');

91  
FALSE
;

99 
$§ve_ÿ¹
 = 
FALSE
;

100 ià(
	`is£t
(
$™ems
['id']))

102 ià((
$rowid
 = 
$this
->
	`_š£¹
(
$™ems
)))

104 
$§ve_ÿ¹
 = 
TRUE
;

109 
	`fÜ—ch
 (
$™ems
 
as
 
$v®
)

111 ià(
	`is_¬¿y
(
$v®
è
AND
 
	`is£t
($val['id']))

113 ià(
$this
->
	`_š£¹
(
$v®
))

115 
$§ve_ÿ¹
 = 
TRUE
;

122 ià(
$§ve_ÿ¹
 =ğ
TRUE
)

124 
$this
->
	`_§ve_ÿ¹
();

125  
	`is£t
(
$rowid
è? $rowid : 
TRUE
;

128  
FALSE
;

129 
	}
}

140 
funùiÚ
 
_š£¹
(
$™ems
 = 
	$¬¿y
())

143 iàĞ! 
	`is_¬¿y
(
$™ems
è
OR
 
	`couÁ
($items) == 0)

145 
	`log_mes§ge
('error', 'The insert method must be…assed‡n‡rray containing data.');

146  
FALSE
;

152 iàĞ! 
	`is£t
(
$™ems
['id']è
OR
 ! isset($items['qty']) OR ! isset($items['price']) OR ! isset($items['name']))

154 
	`log_mes§ge
('error', 'The cart‡rray must contain‡…roduct ID, quantity,…rice,‡nd‚ame.');

155  
FALSE
;

161 
$™ems
['qty'] = 
	`Œim
(
	`´eg_»¶aû
('/([^0-9])/i', '', $items['qty']));

163 
$™ems
['qty'] = 
	`Œim
(
	`´eg_»¶aû
('/(^[0]+)/i', '', $items['qty']));

166 iàĞ! 
	`is_num”ic
(
$™ems
['qty']è
OR
 $items['qty'] == 0)

168  
FALSE
;

176 iàĞ! 
	`´eg_m©ch
("/^[".
$this
->
´oduù_id_ruËs
."]+$/i", 
$™ems
['id']))

178 
	`log_mes§ge
('error', 'Invalid…roduct ID. The…roduct ID can only contain‡lpha-numeric characters, dashes,‡nd underscores');

179  
FALSE
;

186 iàĞ! 
	`´eg_m©ch
("/^[".
$this
->
´oduù_Çme_ruËs
."]+$/i", 
$™ems
['name']))

188 
	`log_mes§ge
('”rÜ', 'AÀšv®id‚amwa subm™‹d‡ th´oduù‚ame: '.
$™ems
['name'].' The‚ame can only contain‡lpha-numeric characters, dashes, underscores, colons,‡nd spaces');

189  
FALSE
;

195 
$™ems
['´iû'] = 
	`Œim
(
	`´eg_»¶aû
('/([^0-9\.])/i', '', $items['price']));

197 
$™ems
['´iû'] = 
	`Œim
(
	`´eg_»¶aû
('/(^[0]+)/i', '', $items['price']));

200 iàĞ! 
	`is_num”ic
(
$™ems
['price']))

202 
	`log_mes§ge
('”rÜ', 'AÀšv®id…riû wa subm™‹d fÜ…roduù ID: '.
$™ems
['id']);

203  
FALSE
;

218 ià(
	`is£t
(
$™ems
['İtiÚs']è
AND
 
	`couÁ
($items['options']) > 0)

220 
$rowid
 = 
	`md5
(
$™ems
['id'].
	`im¶ode
('', $items['options']));

227 
$rowid
 = 
	`md5
(
$™ems
['id']);

235 
	`un£t
(
$this
->
_ÿ¹_cÚ‹Ás
[
$rowid
]);

238 
$this
->
_ÿ¹_cÚ‹Ás
[
$rowid
]['rowid'] = $rowid;

241 
	`fÜ—ch
 (
$™ems
 
as
 
$key
 => 
$v®
)

243 
$this
->
_ÿ¹_cÚ‹Ás
[
$rowid
][
$key
] = 
$v®
;

247  
$rowid
;

248 
	}
}

265 
funùiÚ
 
upd©e
(
$™ems
 = 
	$¬¿y
())

268 iàĞ! 
	`is_¬¿y
(
$™ems
è
OR
 
	`couÁ
($items) == 0)

270  
FALSE
;

277 
$§ve_ÿ¹
 = 
FALSE
;

278 ià(
	`is£t
(
$™ems
['rowid']è
AND
 isset($items['qty']))

280 ià(
$this
->
	`_upd©e
(
$™ems
è=ğ
TRUE
)

282 
$§ve_ÿ¹
 = 
TRUE
;

287 
	`fÜ—ch
 (
$™ems
 
as
 
$v®
)

289 ià(
	`is_¬¿y
(
$v®
è
AND
 
	`is£t
($val['rowid']) AND isset($val['qty']))

291 ià(
$this
->
	`_upd©e
(
$v®
è=ğ
TRUE
)

293 
$§ve_ÿ¹
 = 
TRUE
;

300 ià(
$§ve_ÿ¹
 =ğ
TRUE
)

302 
$this
->
	`_§ve_ÿ¹
();

303  
TRUE
;

306  
FALSE
;

307 
	}
}

323 
funùiÚ
 
_upd©e
(
$™ems
 = 
	$¬¿y
())

326 iàĞ! 
	`is£t
(
$™ems
['qty']è
OR
 ! is£t($™ems['rowid']èOR ! is£t(
$this
->
_ÿ¹_cÚ‹Ás
[$items['rowid']]))

328  
FALSE
;

332 
$™ems
['qty'] = 
	`´eg_»¶aû
('/([^0-9])/i', '', $items['qty']);

335 iàĞ! 
	`is_num”ic
(
$™ems
['qty']))

337  
FALSE
;

342 ià(
$this
->
_ÿ¹_cÚ‹Ás
[
$™ems
['rowid']]['qty'] == $items['qty'])

344  
FALSE
;

349 ià(
$™ems
['qty'] == 0)

351 
	`un£t
(
$this
->
_ÿ¹_cÚ‹Ás
[
$™ems
['rowid']]);

355 
$this
->
_ÿ¹_cÚ‹Ás
[
$™ems
['rowid']]['qty'] = $items['qty'];

358  
TRUE
;

359 
	}
}

369 
funùiÚ
 
	$_§ve_ÿ¹
()

372 
	`un£t
(
$this
->
_ÿ¹_cÚ‹Ás
['total_items']);

373 
	`un£t
(
$this
->
_ÿ¹_cÚ‹Ás
['cart_total']);

376 
$tÙ®
 = 0;

377 
$™ems
 = 0;

378 
	`fÜ—ch
 (
$this
->
_ÿ¹_cÚ‹Ás
 
as
 
$key
 => 
$v®
)

381 iàĞ! 
	`is_¬¿y
(
$v®
è
OR
 ! 
	`is£t
($val['price']) OR ! isset($val['qty']))

386 
$tÙ®
 +ğ(
$v®
['price'] * $val['qty']);

387 
$™ems
 +ğ
$v®
['qty'];

390 
$this
->
_ÿ¹_cÚ‹Ás
[
$key
]['subtotal'] = ($this->_cart_contents[$key]['price'] * $this->_cart_contents[$key]['qty']);

394 
$this
->
_ÿ¹_cÚ‹Ás
['tÙ®_™ems'] = 
$™ems
;

395 
$this
->
_ÿ¹_cÚ‹Ás
['ÿ¹_tÙ®'] = 
$tÙ®
;

398 ià(
	`couÁ
(
$this
->
_ÿ¹_cÚ‹Ás
) <= 2)

400 
$this
->
CI
->
£ssiÚ
->
	`un£t_u£rd©a
('cart_contents');

403  
FALSE
;

408 
$this
->
CI
->
£ssiÚ
->
	`£t_u£rd©a
(
	`¬¿y
('ÿ¹_cÚ‹Ás' => $this->
_ÿ¹_cÚ‹Ás
));

411  
TRUE
;

412 
	}
}

422 
funùiÚ
 
	$tÙ®
()

424  
$this
->
_ÿ¹_cÚ‹Ás
['cart_total'];

425 
	}
}

437 
funùiÚ
 
	$tÙ®_™ems
()

439  
$this
->
_ÿ¹_cÚ‹Ás
['total_items'];

440 
	}
}

452 
funùiÚ
 
	$cÚ‹Ás
()

454 
$ÿ¹
 = 
$this
->
_ÿ¹_cÚ‹Ás
;

457 
	`un£t
(
$ÿ¹
['total_items']);

458 
	`un£t
(
$ÿ¹
['cart_total']);

460  
$ÿ¹
;

461 
	}
}

474 
funùiÚ
 
has_İtiÚs
(
$rowid
 = '')

476 iàĞ! 
is£t
(
$this
->
_ÿ¹_cÚ‹Ás
[
$rowid
]['İtiÚs']è
OR
 
couÁ
($this->_cart_contents[$rowid]['options']) === 0)

478  
FALSE
;

481  
	gTRUE
;

494 
funùiÚ
 
´oduù_İtiÚs
(
$rowid
 = '')

496 iàĞ! 
is£t
(
$this
->
_ÿ¹_cÚ‹Ás
[
$rowid
]['options']))

498  
¬¿y
();

501  
	g$this
->
	g_ÿ¹_cÚ‹Ás
[
$rowid
]['options'];

514 
funùiÚ
 
fÜm©_numb”
(
$n
 = '')

516 ià(
$n
 == '')

522 
	g$n
 = 
Œim
(
´eg_»¶aû
('/([^0-9\.])/i', '', 
$n
));

524  
numb”_fÜm©
(
$n
, 2, '.', ',');

537 
funùiÚ
 
	$de¡roy
()

539 
	`un£t
(
$this
->
_ÿ¹_cÚ‹Ás
);

541 
$this
->
_ÿ¹_cÚ‹Ás
['cart_total'] = 0;

542 
$this
->
_ÿ¹_cÚ‹Ás
['total_items'] = 0;

544 
$this
->
CI
->
£ssiÚ
->
	`un£t_u£rd©a
('cart_contents');

545 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Driver.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

30 şas 
	cCI_Driv”_Lib¿ry
 {

32 
´Ùeùed
 
	m$v®id_driv”s
 = 
¬¿y
();

33 
´Ùeùed
 
	m$lib_Çme
;

37 
funùiÚ
 
	$__g‘
(
$chd
)

39 iàĞ! 
	`is£t
(
$this
->
lib_Çme
))

41 
$this
->
lib_Çme
 = 
	`g‘_şass
($this);

45 
$chd_şass
 = 
$this
->
lib_Çme
.'_'.
$chd
;

48 
$lib_Çme
 = 
	`ucfœ¡
(
	`¡¹Şow”
(
	`¡r_»¶aû
('CI_', '', 
$this
->
lib_Çme
)));

49 
$driv”_Çme
 = 
	`¡¹Şow”
(
	`¡r_»¶aû
('CI_', '', 
$chd_şass
));

51 ià(
	`š_¬¿y
(
$driv”_Çme
, 
	`¬¿y_m­
('¡¹Şow”', 
$this
->
v®id_driv”s
)))

54 iàĞ! 
	`şass_exi¡s
(
$chd_şass
))

57 
	`fÜ—ch
 (
	`g‘_š¡ªû
()->
lßd
->
	`g‘_·ckage_·ths
(
TRUE
è
as
 
$·th
)

60 
	`fÜ—ch
 (
	`¬¿y
(
	`ucfœ¡
(
$driv”_Çme
), $driv”_Çmeè
as
 
$şass
)

62 
$f•©h
 = 
$·th
.'lib¿r›s/'.
$lib_Çme
.'/driv”s/'.
$şass
.'.php';

64 ià(
	`fe_exi¡s
(
$f•©h
))

66 
šşude_Úû
 
$f•©h
;

73 iàĞ! 
	`şass_exi¡s
(
$chd_şass
))

75 
	`log_mes§ge
('”rÜ', "UÇbËØlßdh»que¡ed driv”: ".
$chd_şass
);

76 
	`show_”rÜ
("UÇbËØlßdh»que¡ed driv”: ".
$chd_şass
);

80 
$obj
 = 
Ãw
 
$chd_şass
;

81 
$obj
->
	`decÜ©e
(
$this
);

82 
$this
->
$chd
 = 
$obj
;

83  
$this
->
$chd
;

87 
	`log_mes§ge
('”rÜ', "Inv®id driv”„eque¡ed: ".
$chd_şass
);

88 
	`show_”rÜ
("Inv®id driv”„eque¡ed: ".
$chd_şass
);

93 
	}
}

109 şas 
	cCI_Driv”
 {

110 
´Ùeùed
 
	m$·»Á
;

112 
´iv©e
 
	m$m‘hods
 = 
¬¿y
();

113 
´iv©e
 
	m$´İ”t›s
 = 
¬¿y
();

115 
´iv©e
 
	m$»æeùiÚs
 = 
¬¿y
();

125 
public
 
funùiÚ
 
	$decÜ©e
(
$·»Á
)

127 
$this
->
·»Á
 = 
$·»Á
;

132 
$şass_Çme
 = 
	`g‘_şass
(
$·»Á
);

134 iàĞ! 
	`is£t
(
£lf
::
$»æeùiÚs
[
$şass_Çme
]))

136 
$r
 = 
Ãw
 
	`ReæeùiÚObjeù
(
$·»Á
);

138 
	`fÜ—ch
 (
$r
->
	`g‘M‘hods
(è
as
 
$m‘hod
)

140 ià(
$m‘hod
->
	`isPublic
())

142 
$this
->
m‘hods
[] = 
$m‘hod
->
	`g‘Name
();

146 
	`fÜ—ch
 (
$r
->
	`g‘Prİ”t›s
(è
as
 
$´İ
)

148 ià(
$´İ
->
	`isPublic
())

150 
$this
->
´İ”t›s
[] = 
$´İ
->
	`g‘Name
();

154 
£lf
::
$»æeùiÚs
[
$şass_Çme
] = 
	`¬¿y
(
$this
->
m‘hods
, $this->
´İ”t›s
);

158 
	`li¡
(
$this
->
m‘hods
, $this->
´İ”t›s
èğ
£lf
::
$»æeùiÚs
[
$şass_Çme
];

174 
public
 
funùiÚ
 
	`__ÿÎ
(
$m‘hod
, 
$¬gs
 = 
	$¬¿y
())

176 ià(
	`š_¬¿y
(
$m‘hod
, 
$this
->
m‘hods
))

178  
	`ÿÎ_u£r_func_¬¿y
(
	`¬¿y
(
$this
->
·»Á
, 
$m‘hod
), 
$¬gs
);

181 
$Œaû
 = 
	`debug_backŒaû
();

182 
	`_exû±iÚ_hªdËr
(
E_ERROR
, "NØsuch m‘hod '{$m‘hod}'", 
$Œaû
[1]['file'], $trace[1]['line']);

183 
ex™
;

184 
	}
}

196 
public
 
funùiÚ
 
	$__g‘
(
$v¬
)

198 ià(
	`š_¬¿y
(
$v¬
, 
$this
->
´İ”t›s
))

200  
$this
->
·»Á
->
$v¬
;

202 
	}
}

215 
public
 
funùiÚ
 
	$__£t
(
$v¬
, 
$v®
)

217 ià(
	`š_¬¿y
(
$v¬
, 
$this
->
´İ”t›s
))

219 
$this
->
·»Á
->
$v¬
 = 
$v®
;

221 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Email.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_Ema
 {

31 
v¬
 
	m$u£¿g’t
 = "CodeIgniter";

32 
v¬
 
	m$ma·th
 = "/usr/sbin/sendmail";

33 
v¬
 
	m$´ÙocŞ
 = "mail";

34 
v¬
 
	m$sm_ho¡
 = "";

35 
v¬
 
	m$sm_u£r
 = "";

36 
v¬
 
	m$sm_·ss
 = "";

37 
v¬
 
	m$sm_pÜt
 = "25";

38 
v¬
 
	m$sm_timeout
 = 5;

39 
v¬
 
	m$sm_üy±o
 = "";

40 
v¬
 
	m$wÜdw¿p
 = 
TRUE
;

41 
v¬
 
	m$w¿pch¬s
 = "76";

42 
v¬
 
	m$maty³
 = "text";

43 
v¬
 
	m$ch¬£t
 = "utf-8";

44 
v¬
 
	m$muÉ¬t
 = "mixed";

45 
v¬
 
	m$®t_mes§ge
 = '';

46 
v¬
 
	m$v®id©e
 = 
FALSE
;

47 
v¬
 
	m$´iÜ™y
 = "3";

48 
v¬
 
	m$Ãwlše
 = "\n";

49 
v¬
 
	m$ülf
 = "\n";

52 
v¬
 
	m$£nd_muÉ¬t
 = 
TRUE
;

53 
v¬
 
	m$bcc_b©ch_mode
 = 
FALSE
;

54 
v¬
 
	m$bcc_b©ch_size
 = 200;

55 
v¬
 
	m$_§ã_mode
 = 
FALSE
;

56 
v¬
 
	m$_subjeù
 = "";

57 
v¬
 
	m$_body
 = "";

58 
v¬
 
	m$_fš®body
 = "";

59 
v¬
 
	m$_®t_bound¬y
 = "";

60 
v¬
 
	m$_©c_bound¬y
 = "";

61 
v¬
 
	m$_h—d”_¡r
 = "";

62 
v¬
 
	m$_sm_cÚÃù
 = "";

63 
v¬
 
	m$_’codšg
 = "8bit";

64 
v¬
 
	m$_IP
 = 
FALSE
;

65 
v¬
 
	m$_sm_auth
 = 
FALSE
;

66 
v¬
 
	m$_»¶yto_æag
 = 
FALSE
;

67 
v¬
 
	m$_debug_msg
 = 
¬¿y
();

68 
v¬
 
	m$_»c›Ás
 = 
¬¿y
();

69 
v¬
 
	m$_cc_¬¿y
 = 
¬¿y
();

70 
v¬
 
	m$_bcc_¬¿y
 = 
¬¿y
();

71 
v¬
 
	m$_h—d”s
 = 
¬¿y
();

72 
v¬
 
	m$_©ch_Çme
 = 
¬¿y
();

73 
v¬
 
	m$_©ch_ty³
 = 
¬¿y
();

74 
v¬
 
	m$_©ch_di¥
 = 
¬¿y
();

75 
v¬
 
	m$_´ÙocŞs
 = 
¬¿y
('mail', 'sendmail', 'smtp');

76 
v¬
 
	m$_ba£_ch¬£ts
 = 
¬¿y
('us-ascii', 'iso-2022-');

77 
v¬
 
	m$_b™_d•ths
 = 
¬¿y
('7bit', '8bit');

78 
v¬
 
	m$_´iÜ™›s
 = 
¬¿y
('1 (Highest)', '2 (High)', '3 (Normal)', '4 (Low)', '5 (Lowest)');

86 
public
 
funùiÚ
 
__cÚ¡ruù
(
$cÚfig
 = 
	$¬¿y
())

88 ià(
	`couÁ
(
$cÚfig
) > 0)

90 
$this
->
	`š™Ÿlize
(
$cÚfig
);

94 
$this
->
_sm_auth
 = ($this->
sm_u£r
 =ğ'' 
AND
 $this->
sm_·ss
 =ğ''è? 
FALSE
 : 
TRUE
;

95 
$this
->
_§ã_mode
 = ((
boŞ—n
)@
	`ši_g‘
("§ã_mode"è==ğ
FALSE
è? FALSE : 
TRUE
;

98 
	`log_mes§ge
('debug', "Email Class Initialized");

110 
public
 
funùiÚ
 
	`š™Ÿlize
(
$cÚfig
 = 
	$¬¿y
())

112 
	`fÜ—ch
 (
$cÚfig
 
as
 
$key
 => 
$v®
)

114 ià(
	`is£t
(
$this
->
$key
))

116 
$m‘hod
 = '£t_'.
$key
;

118 ià(
	`m‘hod_exi¡s
(
$this
, 
$m‘hod
))

120 
$this
->
	`$m‘hod
(
$v®
);

124 
$this
->
$key
 = 
$v®
;

128 
$this
->
	`ş—r
();

130 
$this
->
_sm_auth
 = ($this->
sm_u£r
 =ğ'' 
AND
 $this->
sm_·ss
 =ğ''è? 
FALSE
 : 
TRUE
;

131 
$this
->
_§ã_mode
 = ((
boŞ—n
)@
	`ši_g‘
("§ã_mode"è==ğ
FALSE
è? FALSE : 
TRUE
;

133  
$this
;

134 
	}
}

144 
public
 
funùiÚ
 
	$ş—r
(
$ş—r_©chm’ts
 = 
FALSE
)

146 
$this
->
_subjeù
 = "";

147 
$this
->
_body
 = "";

148 
$this
->
_fš®body
 = "";

149 
$this
->
_h—d”_¡r
 = "";

150 
$this
->
_»¶yto_æag
 = 
FALSE
;

151 
$this
->
_»c›Ás
 = 
	`¬¿y
();

152 
$this
->
_cc_¬¿y
 = 
	`¬¿y
();

153 
$this
->
_bcc_¬¿y
 = 
	`¬¿y
();

154 
$this
->
_h—d”s
 = 
	`¬¿y
();

155 
$this
->
_debug_msg
 = 
	`¬¿y
();

157 
$this
->
	`_£t_h—d”
('U£r-Ag’t', $this->
u£¿g’t
);

158 
$this
->
	`_£t_h—d”
('D©e', $this->
	`_£t_d©e
());

160 ià(
$ş—r_©chm’ts
 !=ğ
FALSE
)

162 
$this
->
_©ch_Çme
 = 
	`¬¿y
();

163 
$this
->
_©ch_ty³
 = 
	`¬¿y
();

164 
$this
->
_©ch_di¥
 = 
	`¬¿y
();

167  
$this
;

168 
	}
}

180 
public
 
funùiÚ
 
äom
(
$äom
, 
$Çme
 = '')

182 ià(
´eg_m©ch
Ğ'/\<(.*)\>/', 
$äom
, 
$m©ch
))

184 
$äom
 = 
$m©ch
['1'];

187 ià(
	g$this
->
	gv®id©e
)

189 
	g$this
->
v®id©e_ema
(
$this
->
_¡r_to_¬¿y
(
$äom
));

193 ià(
	g$Çme
 != '')

196 iàĞ! 
´eg_m©ch
('/[\200-\377]/', 
$Çme
))

199 
$Çme
 = '"'.
addc¦ashes
($name, "\0..\37\177'\"\\").'"';

203 
	g$Çme
 = 
$this
->
_´•_q_’codšg
(
$Çme
, 
TRUE
);

207 
	g$this
->
_£t_h—d”
('From', 
$Çme
.' <'.
$äom
.'>');

208 
	g$this
->
_£t_h—d”
('R‘uº-P©h', '<'.
$äom
.'>');

210  
	g$this
;

223 
public
 
funùiÚ
 
»¶y_to
(
$»¶yto
, 
$Çme
 = '')

225 ià(
´eg_m©ch
Ğ'/\<(.*)\>/', 
$»¶yto
, 
$m©ch
))

227 
$»¶yto
 = 
$m©ch
['1'];

230 ià(
	g$this
->
	gv®id©e
)

232 
	g$this
->
v®id©e_ema
(
$this
->
_¡r_to_¬¿y
(
$»¶yto
));

235 ià(
	g$Çme
 == '')

237 
$Çme
 = 
$»¶yto
;

240 ià(
¡ºcmp
(
$Çme
, '"', 1) != 0)

242 
$Çme
 = '"'.$name.'"';

245 
	g$this
->
_£t_h—d”
('R•ly-To', 
$Çme
.' <'.
$»¶yto
.'>');

246 
	g$this
->
	g_»¶yto_æag
 = 
TRUE
;

248  
	g$this
;

260 
public
 
funùiÚ
 
	$to
(
$to
)

262 
$to
 = 
$this
->
	`_¡r_to_¬¿y
($to);

263 
$to
 = 
$this
->
	`ş—n_ema
($to);

265 ià(
$this
->
v®id©e
)

267 
$this
->
	`v®id©e_ema
(
$to
);

270 ià(
$this
->
	`_g‘_´ÙocŞ
() != 'mail')

272 
$this
->
	`_£t_h—d”
('To', 
	`im¶ode
(", ", 
$to
));

275 
$this
->
	`_g‘_´ÙocŞ
())

278 
$this
->
_»c›Ás
 = 
$to
;

282 
$this
->
_»c›Ás
 = 
	`im¶ode
(", ", 
$to
);

286  
$this
;

287 
	}
}

298 
public
 
funùiÚ
 
	$cc
(
$cc
)

300 
$cc
 = 
$this
->
	`_¡r_to_¬¿y
($cc);

301 
$cc
 = 
$this
->
	`ş—n_ema
($cc);

303 ià(
$this
->
v®id©e
)

305 
$this
->
	`v®id©e_ema
(
$cc
);

308 
$this
->
	`_£t_h—d”
('Cc', 
	`im¶ode
(", ", 
$cc
));

310 ià(
$this
->
	`_g‘_´ÙocŞ
() == "smtp")

312 
$this
->
_cc_¬¿y
 = 
$cc
;

315  
$this
;

316 
	}
}

328 
public
 
funùiÚ
 
bcc
(
$bcc
, 
$lim™
 = '')

330 ià(
$lim™
 !ğ'' && 
is_num”ic
($limit))

332 
$this
->
bcc_b©ch_mode
 = 
TRUE
;

333 
	g$this
->
	gbcc_b©ch_size
 = 
$lim™
;

336 
	g$bcc
 = 
$this
->
_¡r_to_¬¿y
(
$bcc
);

337 
	g$bcc
 = 
$this
->
ş—n_ema
(
$bcc
);

339 ià(
	g$this
->
	gv®id©e
)

341 
	g$this
->
v®id©e_ema
(
$bcc
);

344 ià((
	g$this
->
_g‘_´ÙocŞ
(è=ğ"sm"è
OR
 (
$this
->
bcc_b©ch_mode
 && 
couÁ
(
$bcc
è> $this->
bcc_b©ch_size
))

346 
$this
->
_bcc_¬¿y
 = 
$bcc
;

350 
	g$this
->
_£t_h—d”
('Bcc', 
im¶ode
(", ", 
$bcc
));

353  
	g$this
;

365 
public
 
funùiÚ
 
	$subjeù
(
$subjeù
)

367 
$subjeù
 = 
$this
->
	`_´•_q_’codšg
($subject);

368 
$this
->
	`_£t_h—d”
('Subjeù', 
$subjeù
);

369  
$this
;

370 
	}
}

381 
public
 
funùiÚ
 
	$mes§ge
(
$body
)

383 
$this
->
_body
 = 
	`¹rim
(
	`¡r_»¶aû
("\r", "", 
$body
));

391 iàĞ! 
	`is_php
('5.4'è&& 
	`g‘_magic_quÙes_gpc
())

393 
$this
->
_body
 = 
	`¡r¦ashes
($this->_body);

396  
$this
;

397 
	}
}

408 
public
 
funùiÚ
 
©ch
(
$f’ame
, 
$di¥os™iÚ
 = 'attachment')

410 
$this
->
_©ch_Çme
[] = 
$f’ame
;

411 
	g$this
->
	g_©ch_ty³
[] = 
$this
->
_mime_ty³s
(
·thšfo
(
$f’ame
, 
PATHINFO_EXTENSION
));

412 
	g$this
->
	g_©ch_di¥
[] = 
$di¥os™iÚ
;

413  
	g$this
;

426 
´Ùeùed
 
funùiÚ
 
	$_£t_h—d”
(
$h—d”
, 
$v®ue
)

428 
$this
->
_h—d”s
[
$h—d”
] = 
$v®ue
;

429 
	}
}

440 
´Ùeùed
 
funùiÚ
 
	$_¡r_to_¬¿y
(
$ema
)

442 iàĞ! 
	`is_¬¿y
(
$ema
))

444 ià(
	`¡½os
(
$ema
, ','è!=ğ
FALSE
)

446 
$ema
 = 
	`´eg_¥l™
('/[\s,]/', $ema, -1, 
PREG_SPLIT_NO_EMPTY
);

450 
$ema
 = 
	`Œim
($email);

451 
	`£‰y³
(
$ema
, "array");

454  
$ema
;

455 
	}
}

466 
public
 
funùiÚ
 
£t_®t_mes§ge
(
$¡r
 = '')

468 
$this
->
®t_mes§ge
 = 
$¡r
;

469  
	g$this
;

481 
public
 
funùiÚ
 
£t_maty³
(
$ty³
 = 'text')

483 
$this
->
maty³
 = (
$ty³
 == 'html') ? 'html' : 'text';

484  
	g$this
;

496 
public
 
funùiÚ
 
	$£t_wÜdw¿p
(
$wÜdw¿p
 = 
TRUE
)

498 
$this
->
wÜdw¿p
 = (
$wÜdw¿p
 ==ğ
FALSE
è? FALSE : 
TRUE
;

499  
$this
;

500 
	}
}

511 
public
 
funùiÚ
 
£t_´ÙocŞ
(
$´ÙocŞ
 = 'mail')

513 
$this
->
´ÙocŞ
 = ( ! 
š_¬¿y
(
$´ÙocŞ
, $this->
_´ÙocŞs
, 
TRUE
)è? 'ma' : 
¡¹Şow”
($protocol);

514  
	g$this
;

526 
public
 
funùiÚ
 
	$£t_´iÜ™y
(
$n
 = 3)

528 iàĞ! 
	`is_num”ic
(
$n
))

530 
$this
->
´iÜ™y
 = 3;

534 ià(
$n
 < 1 
OR
 $n > 5)

536 
$this
->
´iÜ™y
 = 3;

540 
$this
->
´iÜ™y
 = 
$n
;

541  
$this
;

542 
	}
}

553 
public
 
funùiÚ
 
£t_Ãwlše
(
$Ãwlše
 = "\n")

555 ià(
$Ãwlše
 !ğ"\n" 
AND
 $newline != "\r\n" AND $newline != "\r")

557 
$this
->
Ãwlše
 = "\n";

561 
	g$this
->
	gÃwlše
 = 
$Ãwlše
;

563  
	g$this
;

575 
public
 
funùiÚ
 
£t_ülf
(
$ülf
 = "\n")

577 ià(
$ülf
 !ğ"\n" 
AND
 $crlf != "\r\n" AND $crlf != "\r")

579 
$this
->
ülf
 = "\n";

583 
	g$this
->
	gülf
 = 
$ülf
;

585  
	g$this
;

596 
´Ùeùed
 
funùiÚ
 
	$_£t_bound¬›s
()

598 
$this
->
_®t_bound¬y
 = "B_ALT_".
	`uniqid
('');

599 
$this
->
_©c_bound¬y
 = "B_ATC_".
	`uniqid
('');

600 
	}
}

610 
´Ùeùed
 
funùiÚ
 
	$_g‘_mes§ge_id
()

612 
$äom
 = 
$this
->
_h—d”s
['Return-Path'];

613 
$äom
 = 
	`¡r_»¶aû
(">", "", $from);

614 
$äom
 = 
	`¡r_»¶aû
("<", "", $from);

616  "<".
	`uniqid
('').
	`¡r¡r
(
$äom
, '@').">";

617 
	}
}

628 
´Ùeùed
 
funùiÚ
 
	$_g‘_´ÙocŞ
(
$»tuº
 = 
TRUE
)

630 
$this
->
´ÙocŞ
 = 
	`¡¹Şow”
($this->protocol);

631 
$this
->
´ÙocŞ
 = ( ! 
	`š_¬¿y
($this->´ÙocŞ, $this->
_´ÙocŞs
, 
TRUE
)) ? 'mail' : $this->protocol;

633 ià(
$»tuº
 =ğ
TRUE
)

635  
$this
->
´ÙocŞ
;

637 
	}
}

648 
´Ùeùed
 
funùiÚ
 
	$_g‘_’codšg
(
$»tuº
 = 
TRUE
)

650 
$this
->
_’codšg
 = ( ! 
	`š_¬¿y
($this->_’codšg, $this->
_b™_d•ths
)) ? '8bit' : $this->_encoding;

652 
	`fÜ—ch
 (
$this
->
_ba£_ch¬£ts
 
as
 
$ch¬£t
)

654 ià(
	`¡ºcmp
(
$ch¬£t
, 
$this
->
ch¬£t
, 
	`¡¾’
($charset)) == 0)

656 
$this
->
_’codšg
 = '7bit';

660 ià(
$»tuº
 =ğ
TRUE
)

662  
$this
->
_’codšg
;

664 
	}
}

674 
´Ùeùed
 
funùiÚ
 
	$_g‘_cÚ‹Á_ty³
()

676 ià(
$this
->
maty³
 =ğ'html' && 
	`couÁ
($this->
_©ch_Çme
) == 0)

680 
	`–£if
 (
$this
->
maty³
 =ğ'html' && 
	`couÁ
($this->
_©ch_Çme
) > 0)

684 
	`–£if
 (
$this
->
maty³
 =ğ'‹xt' && 
	`couÁ
($this->
_©ch_Çme
) > 0)

692 
	}
}

702 
´Ùeùed
 
funùiÚ
 
	$_£t_d©e
()

704 
$timezÚe
 = 
	`d©e
("Z");

705 
$İ”©Ü
 = (
	`¡ºcmp
(
$timezÚe
, '-', 1) == 0) ? '-' : '+';

706 
$timezÚe
 = 
	`abs
($timezone);

707 
$timezÚe
 = 
	`æoÜ
($timezone/3600) * 100 + ($timezone % 3600 ) / 60;

709  
	`¥rštf
("% %s%04d", 
	`d©e
("D, j M Y H:i:s"), 
$İ”©Ü
, 
$timezÚe
);

710 
	}
}

720 
´Ùeùed
 
funùiÚ
 
	$_g‘_mime_mes§ge
()

722  "Thi i ¨muÉi-·¹ mes§gš MIME fÜm©.".
$this
->
Ãwlše
."Yourƒmail‡pplication may‚ot supporthis format.";

723 
	}
}

734 
public
 
funùiÚ
 
	$v®id©e_ema
(
$ema
)

736 iàĞ! 
	`is_¬¿y
(
$ema
))

738 
$this
->
	`_£t_”rÜ_mes§ge
('lang:email_must_be_array');

739  
FALSE
;

742 
	`fÜ—ch
 (
$ema
 
as
 
$v®
)

744 iàĞ! 
$this
->
	`v®id_ema
(
$v®
))

746 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_šv®id_add»ss', 
$v®
);

747  
FALSE
;

751  
TRUE
;

752 
	}
}

763 
public
 
funùiÚ
 
	$v®id_ema
(
$add»ss
)

765  ( ! 
	`´eg_m©ch
("/^([a-z0-9\+_\-]+)(\.[a-z0-9\+_\-]+)*@([a-z0-9\-]+\.)+[a-z]{2,6}$/ix", 
$add»ss
)è? 
FALSE
 : 
TRUE
;

766 
	}
}

777 
public
 
funùiÚ
 
	$ş—n_ema
(
$ema
)

779 iàĞ! 
	`is_¬¿y
(
$ema
))

781 ià(
	`´eg_m©ch
('/\<(.*)\>/', 
$ema
, 
$m©ch
))

783  
$m©ch
['1'];

787  
$ema
;

791 
$ş—n_ema
 = 
	`¬¿y
();

793 
	`fÜ—ch
 (
$ema
 
as
 
$addy
)

795 ià(
	`´eg_m©ch
Ğ'/\<(.*)\>/', 
$addy
, 
$m©ch
))

797 
$ş—n_ema
[] = 
$m©ch
['1'];

801 
$ş—n_ema
[] = 
$addy
;

805  
$ş—n_ema
;

806 
	}
}

821 
´Ùeùed
 
funùiÚ
 
	$_g‘_®t_mes§ge
()

823 ià(
$this
->
®t_mes§ge
 != "")

825  
$this
->
	`wÜd_w¿p
($this->
®t_mes§ge
, '76');

828 ià(
	`´eg_m©ch
('/\<body.*?\>(.*)\<\/body\>/si', 
$this
->
_body
, 
$m©ch
))

830 
$body
 = 
$m©ch
['1'];

834 
$body
 = 
$this
->
_body
;

837 
$body
 = 
	`Œim
(
	`¡r_gs
($body));

838 
$body
 = 
	`´eg_»¶aû
( '#<!--(.*)--\>#', "", $body);

839 
$body
 = 
	`¡r_»¶aû
("\t", "", $body);

841 
$i
 = 20; $i >= 3; $i--)

843 
$n
 = "";

845 
$x
 = 1; $x <ğ
$i
; $x ++)

847 
$n
 .= "\n";

850 
$body
 = 
	`¡r_»¶aû
(
$n
, "\n\n", $body);

853  
$this
->
	`wÜd_w¿p
(
$body
, '76');

854 
	}
}

866 
public
 
funùiÚ
 
wÜd_w¿p
(
$¡r
, 
$ch¬lim
 = '')

869 ià(
$ch¬lim
 == '')

871 
$ch¬lim
 = (
$this
->
w¿pch¬s
 == "") ? "76" : $this->wrapchars;

875 
	g$¡r
 = 
´eg_»¶aû
("| +|", " ", 
$¡r
);

878 ià(
¡½os
(
$¡r
, "\r"è!=ğ
FALSE
)

880 
$¡r
 = 
¡r_»¶aû
(
¬¿y
("\r\n", "\r"), "\n", $str);

885 
	g$unw¿p
 = 
¬¿y
();

886 ià(
´eg_m©ch_®l
("|(\{unw¿p\}.+?\{/unw¿p\})|s", 
$¡r
, 
$m©ches
))

888 
	g$i
 = 0; $˜< 
couÁ
(
$m©ches
['0']); $i++)

890 
	g$unw¿p
[] = 
$m©ches
['1'][
$i
];

891 
	g$¡r
 = 
¡r_»¶aû
(
$m©ches
['1'][
$i
], "{{unw¿µed".$i."}}", 
$¡r
);

898 
	g$¡r
 = 
wÜdw¿p
(
$¡r
, 
$ch¬lim
, "\n", 
FALSE
);

901 
	g$ouut
 = "";

902 
fÜ—ch
 (
ex¶ode
("\n", 
$¡r
è
as
 
$lše
)

906 ià(
¡¾’
(
$lše
è<ğ
$ch¬lim
)

908 
$ouut
 .ğ
$lše
.
$this
->
Ãwlše
;

912 
	g$‹mp
 = '';

913 (
¡¾’
(
$lše
)è> 
	g$ch¬lim
)

916 ià(
´eg_m©ch
("!\[u¾.+\]|://|wwww.!", 
$lše
))

922 
	g$‹mp
 .ğ
sub¡r
(
$lše
, 0, 
$ch¬lim
-1);

923 
	g$lše
 = 
sub¡r
(
$lše
, 
$ch¬lim
-1);

928 ià(
	g$‹mp
 != '')

930 
$ouut
 .ğ
$‹mp
.
$this
->
Ãwlše
.
$lše
;

934 
	g$ouut
 .ğ
$lše
;

937 
	g$ouut
 .ğ
$this
->
Ãwlše
;

941 ià(
couÁ
(
$unw¿p
) > 0)

943 
fÜ—ch
 (
$unw¿p
 
as
 
$key
 => 
$v®
)

945 
$ouut
 = 
¡r_»¶aû
("{{unw¿µed".
$key
."}}", 
$v®
, $output);

949  
	g$ouut
;

961 
´Ùeùed
 
funùiÚ
 
	$_bud_h—d”s
()

963 
$this
->
	`_£t_h—d”
('X-S’d”', $this->
	`ş—n_ema
($this->
_h—d”s
['From']));

964 
$this
->
	`_£t_h—d”
('X-Ma”', $this->
u£¿g’t
);

965 
$this
->
	`_£t_h—d”
('X-PriÜ™y', $this->
_´iÜ™›s
[$this->
´iÜ™y
 - 1]);

966 
$this
->
	`_£t_h—d”
('Mes§ge-ID', $this->
	`_g‘_mes§ge_id
());

967 
$this
->
	`_£t_h—d”
('Mime-Version', '1.0');

968 
	}
}

978 
´Ùeùed
 
funùiÚ
 
	$_wr™e_h—d”s
()

980 ià(
$this
->
´ÙocŞ
 == 'mail')

982 
$this
->
_subjeù
 = $this->
_h—d”s
['Subject'];

983 
	`un£t
(
$this
->
_h—d”s
['Subject']);

986 
	`»£t
(
$this
->
_h—d”s
);

987 
$this
->
_h—d”_¡r
 = "";

989 
	`fÜ—ch
 (
$this
->
_h—d”s
 
as
 
$key
 => 
$v®
)

991 
$v®
 = 
	`Œim
($val);

993 ià(
$v®
 != "")

995 
$this
->
_h—d”_¡r
 .ğ
$key
.": ".
$v®
.$this->
Ãwlše
;

999 ià(
$this
->
	`_g‘_´ÙocŞ
() == 'mail')

1001 
$this
->
_h—d”_¡r
 = 
	`¹rim
($this->_header_str);

1003 
	}
}

1013 
´Ùeùed
 
funùiÚ
 
	$_bud_mes§ge
()

1015 ià(
$this
->
wÜdw¿p
 ==ğ
TRUE
 
AND
 $this->
maty³
 != 'html')

1017 
$this
->
_body
 = $this->
	`wÜd_w¿p
($this->_body);

1020 
$this
->
	`_£t_bound¬›s
();

1021 
$this
->
	`_wr™e_h—d”s
();

1023 
$hdr
 = (
$this
->
	`_g‘_´ÙocŞ
(è=ğ'ma'è? $this->
Ãwlše
 : '';

1024 
$body
 = '';

1026 
$this
->
	`_g‘_cÚ‹Á_ty³
())

1030 
$hdr
 .ğ"CÚ‹Á-Ty³:ext/¶aš; ch¬£t=" . 
$this
->
ch¬£t
 . $this->
Ãwlše
;

1031 
$hdr
 .ğ"CÚ‹Á-T¿nsãr-Encodšg: " . 
$this
->
	`_g‘_’codšg
();

1033 ià(
$this
->
	`_g‘_´ÙocŞ
() == 'mail')

1035 
$this
->
_h—d”_¡r
 .ğ
	`¹rim
(
$hdr
);

1036 
$this
->
_fš®body
 = $this->
_body
;

1040 
$this
->
_fš®body
 = 
$hdr
 . $this->
Ãwlše
 . $this->Ãwlš. $this->
_body
;

1048 ià(
$this
->
£nd_muÉ¬t
 ==ğ
FALSE
)

1050 
$hdr
 .ğ"CÚ‹Á-Ty³:ext/html; ch¬£t=" . 
$this
->
ch¬£t
 . $this->
Ãwlše
;

1051 
$hdr
 .= "Content-Transfer-Encoding: quoted-printable";

1055 
$hdr
 .ğ"CÚ‹Á-Ty³: muÉ¬t/®‹º©ive; bound¬y=\"" . 
$this
->
_®t_bound¬y
 . "\"" . $this->
Ãwlše
 . $this->newline;

1057 
$body
 .ğ
$this
->
	`_g‘_mime_mes§ge
(è. $this->
Ãwlše
 . $this->newline;

1058 
$body
 .ğ"--" . 
$this
->
_®t_bound¬y
 . $this->
Ãwlše
;

1060 
$body
 .ğ"CÚ‹Á-Ty³:ext/¶aš; ch¬£t=" . 
$this
->
ch¬£t
 . $this->
Ãwlše
;

1061 
$body
 .ğ"CÚ‹Á-T¿nsãr-Encodšg: " . 
$this
->
	`_g‘_’codšg
(è. $this->
Ãwlše
 . $this->newline;

1062 
$body
 .ğ
$this
->
	`_g‘_®t_mes§ge
(è. $this->
Ãwlše
 . $this->Ãwlš. "--" . $this->
_®t_bound¬y
 . $this->newline;

1064 
$body
 .ğ"CÚ‹Á-Ty³:ext/html; ch¬£t=" . 
$this
->
ch¬£t
 . $this->
Ãwlše
;

1065 
$body
 .ğ"CÚ‹Á-T¿nsãr-Encodšg: quÙed-´šbË" . 
$this
->
Ãwlše
 . $this->newline;

1068 
$this
->
_fš®body
 = 
$body
 . $this->
	`_´•_quÙed_´šbË
($this->
_body
è. $this->
Ãwlše
 . $this->newline;

1071 ià(
$this
->
	`_g‘_´ÙocŞ
() == 'mail')

1073 
$this
->
_h—d”_¡r
 .ğ
	`¹rim
(
$hdr
);

1077 
$this
->
_fš®body
 = 
$hdr
 . $this->_finalbody;

1081 ià(
$this
->
£nd_muÉ¬t
 !=ğ
FALSE
)

1083 
$this
->
_fš®body
 .ğ"--" . $this->
_®t_bound¬y
 . "--";

1091 
$hdr
 .ğ"CÚ‹Á-Ty³: muÉ¬t/".
$this
->
muÉ¬t
."; bound¬y=\"" . $this->
_©c_bound¬y
."\"" . $this->
Ãwlše
 . $this->newline;

1093 ià(
$this
->
	`_g‘_´ÙocŞ
() == 'mail')

1095 
$this
->
_h—d”_¡r
 .ğ
	`¹rim
(
$hdr
);

1098 
$body
 .ğ
$this
->
	`_g‘_mime_mes§ge
(è. $this->
Ãwlše
 . $this->newline;

1099 
$body
 .ğ"--" . 
$this
->
_©c_bound¬y
 . $this->
Ãwlše
;

1101 
$body
 .ğ"CÚ‹Á-Ty³:ext/¶aš; ch¬£t=" . 
$this
->
ch¬£t
 . $this->
Ãwlše
;

1102 
$body
 .ğ"CÚ‹Á-T¿nsãr-Encodšg: " . 
$this
->
	`_g‘_’codšg
(è. $this->
Ãwlše
 . $this->newline;

1104 
$body
 .ğ
$this
->
_body
 . $this->
Ãwlše
 . $this->newline;

1109 
$hdr
 .ğ"CÚ‹Á-Ty³: muÉ¬t/".
$this
->
muÉ¬t
."; bound¬y=\"" . $this->
_©c_bound¬y
."\"" . $this->
Ãwlše
 . $this->newline;

1111 ià(
$this
->
	`_g‘_´ÙocŞ
() == 'mail')

1113 
$this
->
_h—d”_¡r
 .ğ
	`¹rim
(
$hdr
);

1116 
$body
 .ğ
$this
->
	`_g‘_mime_mes§ge
(è. $this->
Ãwlše
 . $this->newline;

1117 
$body
 .ğ"--" . 
$this
->
_©c_bound¬y
 . $this->
Ãwlše
;

1119 
$body
 .ğ"CÚ‹Á-Ty³: muÉ¬t/®‹º©ive; bound¬y=\"" . 
$this
->
_®t_bound¬y
 . "\"" . $this->
Ãwlše
 .$this->newline;

1120 
$body
 .ğ"--" . 
$this
->
_®t_bound¬y
 . $this->
Ãwlše
;

1122 
$body
 .ğ"CÚ‹Á-Ty³:ext/¶aš; ch¬£t=" . 
$this
->
ch¬£t
 . $this->
Ãwlše
;

1123 
$body
 .ğ"CÚ‹Á-T¿nsãr-Encodšg: " . 
$this
->
	`_g‘_’codšg
(è. $this->
Ãwlše
 . $this->newline;

1124 
$body
 .ğ
$this
->
	`_g‘_®t_mes§ge
(è. $this->
Ãwlše
 . $this->Ãwlš. "--" . $this->
_®t_bound¬y
 . $this->newline;

1126 
$body
 .ğ"CÚ‹Á-Ty³:ext/html; ch¬£t=" . 
$this
->
ch¬£t
 . $this->
Ãwlše
;

1127 
$body
 .ğ"CÚ‹Á-T¿nsãr-Encodšg: quÙed-´šbË" . 
$this
->
Ãwlše
 . $this->newline;

1129 
$body
 .ğ
$this
->
	`_´•_quÙed_´šbË
($this->
_body
è. $this->
Ãwlše
 . $this->newline;

1130 
$body
 .ğ"--" . 
$this
->
_®t_bound¬y
 . "--" . $this->
Ãwlše
 . $this->newline;

1135 
$©chm’t
 = 
	`¬¿y
();

1137 
$z
 = 0;

1139 
$i
=0; $˜< 
	`couÁ
(
$this
->
_©ch_Çme
); $i++)

1141 
$f’ame
 = 
$this
->
_©ch_Çme
[
$i
];

1142 
$ba£Çme
 = 
	`ba£Çme
(
$f’ame
);

1143 
$ùy³
 = 
$this
->
_©ch_ty³
[
$i
];

1145 iàĞ! 
	`fe_exi¡s
(
$f’ame
))

1147 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_©chm’t_missšg', 
$f’ame
);

1148  
FALSE
;

1151 
$h
 = "--".
$this
->
_©c_bound¬y
.$this->
Ãwlše
;

1152 
$h
 .ğ"CÚ‹Á-ty³: ".
$ùy³
."; ";

1153 
$h
 .ğ"Çme=\"".
$ba£Çme
."\"".
$this
->
Ãwlše
;

1154 
$h
 .ğ"CÚ‹Á-Di¥os™iÚ: ".
$this
->
_©ch_di¥
[
$i
].";".$this->
Ãwlše
;

1155 
$h
 .ğ"CÚ‹Á-T¿nsãr-Encodšg: ba£64".
$this
->
Ãwlše
;

1157 
$©chm’t
[
$z
++] = 
$h
;

1158 
$fe
 = 
	`fesize
(
$f’ame
) +1;

1160 iàĞ! 
$å
 = 
	`fİ’
(
$f’ame
, 
FOPEN_READ
))

1162 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_©chm’t_uÄ—dabË', 
$f’ame
);

1163  
FALSE
;

1166 
$©chm’t
[
$z
++] = 
	`chunk_¥l™
(
	`ba£64_’code
(
	`ä—d
(
$å
, 
$fe
)));

1167 
	`fşo£
(
$å
);

1170 
$body
 .ğ
	`im¶ode
(
$this
->
Ãwlše
, 
$©chm’t
).$this->Ãwlše."--".$this->
_©c_bound¬y
."--";

1173 ià(
$this
->
	`_g‘_´ÙocŞ
() == 'mail')

1175 
$this
->
_fš®body
 = 
$body
;

1179 
$this
->
_fš®body
 = 
$hdr
 . 
$body
;

1183 
	}
}

1198 
´Ùeùed
 
funùiÚ
 
_´•_quÙed_´šbË
(
$¡r
, 
$ch¬lim
 = '')

1203 ià(
$ch¬lim
 =ğ'' 
OR
 $charlim > '76')

1205 
$ch¬lim
 = '76';

1209 
	g$¡r
 = 
´eg_»¶aû
("| +|", " ", 
$¡r
);

1212 
	g$¡r
 = 
´eg_»¶aû
('/\x00+/', '', 
$¡r
);

1215 ià(
¡½os
(
$¡r
, "\r"è!=ğ
FALSE
)

1217 
$¡r
 = 
¡r_»¶aû
(
¬¿y
("\r\n", "\r"), "\n", $str);

1222 
	g$¡r
 = 
¡r_»¶aû
(
¬¿y
('{unw¿p}', '{/unw¿p}'), '', 
$¡r
);

1225 
	g$lšes
 = 
ex¶ode
("\n", 
$¡r
);

1227 
	g$esÿ³
 = '=';

1228 
	g$ouut
 = '';

1230 
fÜ—ch
 (
$lšes
 
as
 
$lše
)

1232 
	g$Ëngth
 = 
¡¾’
(
$lše
);

1233 
	g$‹mp
 = '';

1238 
	g$i
 = 0; $˜< 
	g$Ëngth
; $i++)

1241 
	g$ch¬
 = 
sub¡r
(
$lše
, 
$i
, 1);

1242 
	g$ascii
 = 
Üd
(
$ch¬
);

1245 ià(
	g$i
 =ğ(
$Ëngth
 - 1))

1247 
$ch¬
 = (
$ascii
 =ğ'32' 
OR
 $asci˜=ğ'9'è? 
$esÿ³
.
¥rštf
('%02s', 
dechex
($ascii)) : $char;

1251 ià(
	g$ascii
 == '61')

1253 
$ch¬
 = 
$esÿ³
.
¡¹ouµ”
(
¥rštf
('%02s', 
dechex
(
$ascii
)));

1258 ià((
¡¾’
(
$‹mp
è+ sŒËn(
$ch¬
)è>ğ
$ch¬lim
)

1260 
$ouut
 .ğ
$‹mp
.
$esÿ³
.
$this
->
ülf
;

1261 
	g$‹mp
 = '';

1265 
	g$‹mp
 .ğ
$ch¬
;

1269 
	g$ouut
 .ğ
$‹mp
.
$this
->
ülf
;

1273 
	g$ouut
 = 
sub¡r
(
$ouut
, 0, 
¡¾’
(
$this
->
ülf
) * -1);

1275  
	g$ouut
;

1291 
´Ùeùed
 
funùiÚ
 
	$_´•_q_’codšg
(
$¡r
, 
$äom
 = 
FALSE
)

1293 
$¡r
 = 
	`¡r_»¶aû
(
	`¬¿y
("\r", "\n"),‡rray('', ''), $str);

1297 
$lim™
 = 75 - 7 - 
	`¡¾’
(
$this
->
ch¬£t
);

1300 
$cÚv”t
 = 
	`¬¿y
('_', '=', '?');

1302 ià(
$äom
 ==ğ
TRUE
)

1304 
$cÚv”t
[] = ',';

1305 
$cÚv”t
[] = ';';

1308 
$ouut
 = '';

1309 
$‹mp
 = '';

1311 
$i
 = 0, 
$Ëngth
 = 
	`¡¾’
(
$¡r
); $i < $length; $i++)

1314 
$ch¬
 = 
	`sub¡r
(
$¡r
, 
$i
, 1);

1315 
$ascii
 = 
	`Üd
(
$ch¬
);

1318 ià(
$ascii
 < 32 
OR
 $asci˜> 126 OR 
	`š_¬¿y
(
$ch¬
, 
$cÚv”t
))

1320 
$ch¬
 = '='.
	`dechex
(
$ascii
);

1324 ià(
$ascii
 == 32)

1326 
$ch¬
 = '_';

1331 ià((
	`¡¾’
(
$‹mp
è+ sŒËn(
$ch¬
)è>ğ
$lim™
)

1333 
$ouut
 .ğ
$‹mp
.
$this
->
ülf
;

1334 
$‹mp
 = '';

1338 
$‹mp
 .ğ
$ch¬
;

1341 
$¡r
 = 
$ouut
.
$‹mp
;

1345 
$¡r
 = 
	`Œim
(
	`´eg_»¶aû
('/^(.*)$/m', ' =?'.
$this
->
ch¬£t
.'?Q?$1?=', $str));

1347  
$¡r
;

1348 
	}
}

1358 
public
 
funùiÚ
 
	$£nd
()

1360 ià(
$this
->
_»¶yto_æag
 =ğ
FALSE
)

1362 
$this
->
	`»¶y_to
($this->
_h—d”s
['From']);

1365 ià(Ğ! 
	`is£t
(
$this
->
_»c›Ás
è
AND
 ! is£t($this->
_h—d”s
['To'])) AND

1366 Ğ! 
	`is£t
(
$this
->
_bcc_¬¿y
è
AND
 ! is£t($this->
_h—d”s
['Bcc'])) AND

1367 Ğ! 
	`is£t
(
$this
->
_h—d”s
['Cc'])))

1369 
$this
->
	`_£t_”rÜ_mes§ge
('lang:email_no_recipients');

1370  
FALSE
;

1373 
$this
->
	`_bud_h—d”s
();

1375 ià(
$this
->
bcc_b©ch_mode
 
AND
 
	`couÁ
($this->
_bcc_¬¿y
) > 0)

1377 ià(
	`couÁ
(
$this
->
_bcc_¬¿y
è> $this->
bcc_b©ch_size
)

1378  
$this
->
	`b©ch_bcc_£nd
();

1381 
$this
->
	`_bud_mes§ge
();

1383 iàĞ! 
$this
->
	`_¥oŞ_ema
())

1385  
FALSE
;

1389  
TRUE
;

1391 
	}
}

1401 
public
 
funùiÚ
 
	$b©ch_bcc_£nd
()

1403 
$æßt
 = 
$this
->
bcc_b©ch_size
 -1;

1405 
$£t
 = "";

1407 
$chunk
 = 
	`¬¿y
();

1409 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
_bcc_¬¿y
); $i++)

1411 ià(
	`is£t
(
$this
->
_bcc_¬¿y
[
$i
]))

1413 
$£t
 .ğ", ".
$this
->
_bcc_¬¿y
[
$i
];

1416 ià(
$i
 =ğ
$æßt
)

1418 
$chunk
[] = 
	`sub¡r
(
$£t
, 1);

1419 
$æßt
 = $æßˆ+ 
$this
->
bcc_b©ch_size
;

1420 
$£t
 = "";

1423 ià(
$i
 =ğ
	`couÁ
(
$this
->
_bcc_¬¿y
)-1)

1425 
$chunk
[] = 
	`sub¡r
(
$£t
, 1);

1429 
$i
 = 0; $˜< 
	`couÁ
(
$chunk
); $i++)

1431 
	`un£t
(
$this
->
_h—d”s
['Bcc']);

1432 
	`un£t
(
$bcc
);

1434 
$bcc
 = 
$this
->
	`_¡r_to_¬¿y
(
$chunk
[
$i
]);

1435 
$bcc
 = 
$this
->
	`ş—n_ema
($bcc);

1437 ià(
$this
->
´ÙocŞ
 != 'smtp')

1439 
$this
->
	`_£t_h—d”
('Bcc', 
	`im¶ode
(", ", 
$bcc
));

1443 
$this
->
_bcc_¬¿y
 = 
$bcc
;

1446 
$this
->
	`_bud_mes§ge
();

1447 
$this
->
	`_¥oŞ_ema
();

1449 
	}
}

1459 
´Ùeùed
 
funùiÚ
 
	$_unw¿p_¥ecŸls
()

1461 
$this
->
_fš®body
 = 
	`´eg_»¶aû_ÿÎback
("/\{unw¿p\}(.*?)\{\/unw¿p\}/si", 
	`¬¿y
($this, '_remove_nl_callback'), $this->_finalbody);

1462 
	}
}

1472 
´Ùeùed
 
funùiÚ
 
	$_»move_Æ_ÿÎback
(
$m©ches
)

1474 ià(
	`¡½os
(
$m©ches
[1], "\r"è!=ğ
FALSE
 
OR
 strpos($matches[1], "\n") !== FALSE)

1476 
$m©ches
[1] = 
	`¡r_»¶aû
(
	`¬¿y
("\r\n", "\r", "\n"), '', $matches[1]);

1479  
$m©ches
[1];

1480 
	}
}

1490 
´Ùeùed
 
funùiÚ
 
	$_¥oŞ_ema
()

1492 
$this
->
	`_unw¿p_¥ecŸls
();

1494 
$this
->
	`_g‘_´ÙocŞ
())

1498 iàĞ! 
$this
->
	`_£nd_w™h_ma
())

1500 
$this
->
	`_£t_”rÜ_mes§ge
('lang:email_send_failure_phpmail');

1501  
FALSE
;

1506 iàĞ! 
$this
->
	`_£nd_w™h_£ndma
())

1508 
$this
->
	`_£t_”rÜ_mes§ge
('lang:email_send_failure_sendmail');

1509  
FALSE
;

1514 iàĞ! 
$this
->
	`_£nd_w™h_sm
())

1516 
$this
->
	`_£t_”rÜ_mes§ge
('lang:email_send_failure_smtp');

1517  
FALSE
;

1523 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_£Á', $this->
	`_g‘_´ÙocŞ
());

1524  
TRUE
;

1525 
	}
}

1535 
´Ùeùed
 
funùiÚ
 
	$_£nd_w™h_ma
()

1537 ià(
$this
->
_§ã_mode
 =ğ
TRUE
)

1539 iàĞ! 
	`ma
(
$this
->
_»c›Ás
, $this->
_subjeù
, $this->
_fš®body
, $this->
_h—d”_¡r
))

1541  
FALSE
;

1545  
TRUE
;

1553 iàĞ! 
	`ma
(
$this
->
_»c›Ás
, $this->
_subjeù
, $this->
_fš®body
, $this->
_h—d”_¡r
, "-à".$this->
	`ş—n_ema
($this->
_h—d”s
['From'])))

1555  
FALSE
;

1559  
TRUE
;

1562 
	}
}

1572 
´Ùeùed
 
funùiÚ
 
	$_£nd_w™h_£ndma
()

1574 
$å
 = @
	`pİ’
(
$this
->
ma·th
 . " -o˜-à".$this->
	`ş—n_ema
($this->
_h—d”s
['From'])." -t", 'w');

1576 ià(
$å
 ==ğ
FALSE
 
OR
 $å ==ğ
NULL
)

1579  
FALSE
;

1582 
	`åuts
(
$å
, 
$this
->
_h—d”_¡r
);

1583 
	`åuts
(
$å
, 
$this
->
_fš®body
);

1585 
$¡©us
 = 
	`pşo£
(
$å
);

1587 ià(
	`v”siÚ_com·»
(
PHP_VERSION
, '4.2.3') == -1)

1589 
$¡©us
 = $status >> 8 & 0xFF;

1592 ià(
$¡©us
 != 0)

1594 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_ex™_¡©us', 
$¡©us
);

1595 
$this
->
	`_£t_”rÜ_mes§ge
('lang:email_no_socket');

1596  
FALSE
;

1599  
TRUE
;

1600 
	}
}

1610 
´Ùeùed
 
funùiÚ
 
	$_£nd_w™h_sm
()

1612 ià(
$this
->
sm_ho¡
 == '')

1614 
$this
->
	`_£t_”rÜ_mes§ge
('lang:email_no_hostname');

1615  
FALSE
;

1618 
$this
->
	`_sm_cÚÃù
();

1619 
$this
->
	`_sm_auth’tiÿ‹
();

1621 
$this
->
	`_£nd_commªd
('äom', $this->
	`ş—n_ema
($this->
_h—d”s
['From']));

1623 
	`fÜ—ch
 (
$this
->
_»c›Ás
 
as
 
$v®
)

1625 
$this
->
	`_£nd_commªd
('to', 
$v®
);

1628 ià(
	`couÁ
(
$this
->
_cc_¬¿y
) > 0)

1630 
	`fÜ—ch
 (
$this
->
_cc_¬¿y
 
as
 
$v®
)

1632 ià(
$v®
 != "")

1634 
$this
->
	`_£nd_commªd
('to', 
$v®
);

1639 ià(
	`couÁ
(
$this
->
_bcc_¬¿y
) > 0)

1641 
	`fÜ—ch
 (
$this
->
_bcc_¬¿y
 
as
 
$v®
)

1643 ià(
$v®
 != "")

1645 
$this
->
	`_£nd_commªd
('to', 
$v®
);

1650 
$this
->
	`_£nd_commªd
('data');

1653 
$this
->
	`_£nd_d©a
($this->
_h—d”_¡r
 . 
	`´eg_»¶aû
('/^\./m', '..$1', $this->
_fš®body
));

1655 
$this
->
	`_£nd_d©a
('.');

1657 
$»¶y
 = 
$this
->
	`_g‘_sm_d©a
();

1659 
$this
->
	`_£t_”rÜ_mes§ge
(
$»¶y
);

1661 ià(
	`¡ºcmp
(
$»¶y
, '250', 3) != 0)

1663 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_sm_”rÜ', 
$»¶y
);

1664  
FALSE
;

1667 
$this
->
	`_£nd_commªd
('quit');

1668  
TRUE
;

1669 
	}
}

1680 
´Ùeùed
 
funùiÚ
 
	$_sm_cÚÃù
()

1682 
$s¦
 = 
NULL
;

1683 ià(
$this
->
sm_üy±o
 == 'ssl')

1684 
$s¦
 = 'ssl://';

1685 
$this
->
_sm_cÚÃù
 = 
	`fsockİ’
(
$s¦
.$this->
sm_ho¡
,

1686 
$this
->
sm_pÜt
,

1687 
$”ºo
,

1688 
$”r¡r
,

1689 
$this
->
sm_timeout
);

1691 iàĞ! 
	`is_»sourû
(
$this
->
_sm_cÚÃù
))

1693 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_sm_”rÜ', 
$”ºo
." ".
$”r¡r
);

1694  
FALSE
;

1697 
$this
->
	`_£t_”rÜ_mes§ge
($this->
	`_g‘_sm_d©a
());

1699 ià(
$this
->
sm_üy±o
 == 'tls')

1701 
$this
->
	`_£nd_commªd
('hello');

1702 
$this
->
	`_£nd_commªd
('starttls');

1703 
	`¡»am_sock‘_’abË_üy±o
(
$this
->
_sm_cÚÃù
, 
TRUE
, 
STREAM_CRYPTO_METHOD_TLS_CLIENT
);

1706  
$this
->
	`_£nd_commªd
('hello');

1707 
	}
}

1719 
´Ùeùed
 
funùiÚ
 
_£nd_commªd
(
$cmd
, 
$d©a
 = '')

1721 
$cmd
)

1725 ià(
$this
->
_sm_auth
 
OR
 $this->
_g‘_’codšg
() == '8bit')

1726 
$this
->
_£nd_d©a
('EHLO '.$this->
_g‘_ho¡Çme
());

1728 
	g$this
->
_£nd_d©a
('HELO '.
$this
->
_g‘_ho¡Çme
());

1730 
	g$»¥
 = 250;

1734 
$this
->
_£nd_d©a
('STARTTLS');

1736 
	g$»¥
 = 220;

1740 
$this
->
_£nd_d©a
('MAIL FROM:<'.
$d©a
.'>');

1742 
	g$»¥
 = 250;

1746 
$this
->
_£nd_d©a
('RCPT TO:<'.
$d©a
.'>');

1748 
	g$»¥
 = 250;

1752 
$this
->
_£nd_d©a
('DATA');

1754 
	g$»¥
 = 354;

1758 
$this
->
_£nd_d©a
('QUIT');

1760 
	g$»¥
 = 221;

1764 
	g$»¶y
 = 
$this
->
_g‘_sm_d©a
();

1766 
	g$this
->
	g_debug_msg
[] = "<´e>".
$cmd
.": ".
$»¶y
."</pre>";

1768 ià(
sub¡r
(
$»¶y
, 0, 3è!ğ
$»¥
)

1770 
$this
->
_£t_”rÜ_mes§ge
('Ïng:ema_sm_”rÜ', 
$»¶y
);

1771  
	gFALSE
;

1774 ià(
	g$cmd
 == 'quit')

1776 
fşo£
(
$this
->
_sm_cÚÃù
);

1779  
	gTRUE
;

1790 
´Ùeùed
 
funùiÚ
 
	$_sm_auth’tiÿ‹
()

1792 iàĞ! 
$this
->
_sm_auth
)

1794  
TRUE
;

1797 ià(
$this
->
sm_u£r
 =ğ"" 
AND
 $this->
sm_·ss
 == "")

1799 
$this
->
	`_£t_”rÜ_mes§ge
('lang:email_no_smtp_unpw');

1800  
FALSE
;

1803 
$this
->
	`_£nd_d©a
('AUTH LOGIN');

1805 
$»¶y
 = 
$this
->
	`_g‘_sm_d©a
();

1807 ià(
	`¡ºcmp
(
$»¶y
, '334', 3) != 0)

1809 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_çed_sm_logš', 
$»¶y
);

1810  
FALSE
;

1813 
$this
->
	`_£nd_d©a
(
	`ba£64_’code
($this->
sm_u£r
));

1815 
$»¶y
 = 
$this
->
	`_g‘_sm_d©a
();

1817 ià(
	`¡ºcmp
(
$»¶y
, '334', 3) != 0)

1819 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_sm_auth_un', 
$»¶y
);

1820  
FALSE
;

1823 
$this
->
	`_£nd_d©a
(
	`ba£64_’code
($this->
sm_·ss
));

1825 
$»¶y
 = 
$this
->
	`_g‘_sm_d©a
();

1827 ià(
	`¡ºcmp
(
$»¶y
, '235', 3) != 0)

1829 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_sm_auth_pw', 
$»¶y
);

1830  
FALSE
;

1833  
TRUE
;

1834 
	}
}

1844 
´Ùeùed
 
funùiÚ
 
	$_£nd_d©a
(
$d©a
)

1846 iàĞ! 
	`fwr™e
(
$this
->
_sm_cÚÃù
, 
$d©a
 . $this->
Ãwlše
))

1848 
$this
->
	`_£t_”rÜ_mes§ge
('Ïng:ema_sm_d©a_çu»', 
$d©a
);

1849  
FALSE
;

1853  
TRUE
;

1855 
	}
}

1865 
´Ùeùed
 
funùiÚ
 
	$_g‘_sm_d©a
()

1867 
$d©a
 = "";

1869 
$¡r
 = 
	`fg‘s
(
$this
->
_sm_cÚÃù
, 512))

1871 
$d©a
 .ğ
$¡r
;

1873 ià(
	`sub¡r
(
$¡r
, 3, 1) == " ")

1879  
$d©a
;

1880 
	}
}

1890 
´Ùeùed
 
funùiÚ
 
	$_g‘_ho¡Çme
()

1892  (
	`is£t
(
$_SERVER
['SERVER_NAME'])) ? $_SERVER['SERVER_NAME'] : 'localhost.localdomain';

1893 
	}
}

1903 
´Ùeùed
 
funùiÚ
 
	$_g‘_
()

1905 ià(
$this
->
_IP
 !=ğ
FALSE
)

1907  
$this
->
_IP
;

1910 
$c
 = (
	`is£t
(
$_SERVER
['HTTP_CLIENT_IP']è
AND
 $_SERVER['HTTP_CLIENT_IP'] !ğ""è? $_SERVER['HTTP_CLIENT_IP'] : 
FALSE
;

1911 
$r
 = (
	`is£t
(
$_SERVER
['REMOTE_ADDR']è
AND
 $_SERVER['REMOTE_ADDR'] !ğ""è? $_SERVER['REMOTE_ADDR'] : 
FALSE
;

1912 
$f
 = (
	`is£t
(
$_SERVER
['HTTP_X_FORWARDED_FOR']è
AND
 $_SERVER['HTTP_X_FORWARDED_FOR'] !ğ""è? $_SERVER['HTTP_X_FORWARDED_FOR'] : 
FALSE
;

1914 ià(
$c
 && 
$r
è
$this
->
_IP
 = $cip;

1915 
	`–£if
 (
$r
è
$this
->
_IP
 = $rip;

1916 
	`–£if
 (
$c
è
$this
->
_IP
 = $cip;

1917 
	`–£if
 (
$f
è
$this
->
_IP
 = $fip;

1919 ià(
	`¡½os
(
$this
->
_IP
, ','è!=ğ
FALSE
)

1921 
$x
 = 
	`ex¶ode
(',', 
$this
->
_IP
);

1922 
$this
->
_IP
 = 
	`’d
(
$x
);

1925 iàĞ! 
	`´eg_m©ch
Ğ"/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/", 
$this
->
_IP
))

1927 
$this
->
_IP
 = '0.0.0.0';

1930 
	`un£t
(
$c
);

1931 
	`un£t
(
$r
);

1932 
	`un£t
(
$f
);

1934  
$this
->
_IP
;

1935 
	}
}

1945 
public
 
funùiÚ
 
	$´št_debugg”
()

1947 
$msg
 = '';

1949 ià(
	`couÁ
(
$this
->
_debug_msg
) > 0)

1951 
	`fÜ—ch
 (
$this
->
_debug_msg
 
as
 
$v®
)

1953 
$msg
 .ğ
$v®
;

1957 
$msg
 .ğ"<´e>".
	`html¥ecŸlch¬s
(
$this
->
_h—d”_¡r
)."\n".html¥ecŸlch¬s($this->
_subjeù
)."\n".html¥ecŸlch¬s($this->
_fš®body
).'</pre>';

1958  
$msg
;

1959 
	}
}

1970 
´Ùeùed
 
funùiÚ
 
_£t_”rÜ_mes§ge
(
$msg
, 
$v®
 = '')

1972 
$CI
 =& 
g‘_š¡ªû
();

1973 
	g$CI
->
	gÏng
->
lßd
('email');

1975 ià(
sub¡r
(
$msg
, 0, 5è!ğ'Ïng:' || 
FALSE
 ==ğ(
$lše
 = 
$CI
->
Ïng
->
lše
(substr($msg, 5))))

1977 
	g$this
->
	g_debug_msg
[] = 
¡r_»¶aû
('%s', 
$v®
, 
$msg
)."<br />";

1981 
	g$this
->
	g_debug_msg
[] = 
¡r_»¶aû
('%s', 
$v®
, 
$lše
)."<br />";

1994 
´Ùeùed
 
funùiÚ
 
_mime_ty³s
(
$ext
 = "")

1996 
$mimes
 = 
¬¿y
( 'hqx' => 'application/mac-binhex40',

2085  ( ! 
is£t
(
$mimes
[
¡¹Şow”
(
$ext
)])) ? "application/x-unknown-content-type" : $mimes[strtolower($ext)];

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Encrypt.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_Enüy±
 {

31 
v¬
 
	m$CI
;

32 
v¬
 
	m$’üy±iÚ_key
 = '';

33 
v¬
 
	m$_hash_ty³
 = 'sha1';

34 
v¬
 
	m$_müy±_exi¡s
 = 
FALSE
;

35 
v¬
 
	m$_müy±_ch”
;

36 
v¬
 
	m$_müy±_mode
;

44 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

46 
$this
->
CI
 =& 
	`g‘_š¡ªû
();

47 
$this
->
_müy±_exi¡s
 = ( ! 
	`funùiÚ_exi¡s
('müy±_’üy±')è? 
FALSE
 : 
TRUE
;

49 ià(
$this
->
_müy±_exi¡s
 ==ğ
FALSE
)

51 
	`show_”rÜ
('The Encrypt†ibrary„equireshe Mcryptƒxtension.');

54 
	`log_mes§ge
('debug', "Encrypt Class Initialized");

69 
funùiÚ
 
	`g‘_key
(
$key
 = '')

71 ià(
$key
 == '')

73 ià(
$this
->
’üy±iÚ_key
 != '')

75  
$this
->
’üy±iÚ_key
;

78 
$CI
 =& 
	`g‘_š¡ªû
();

79 
$key
 = 
$CI
->
cÚfig
->
	`™em
('encryption_key');

81 ià(
$key
 =ğ
FALSE
)

83 
	`show_”rÜ
('In ordero useheƒncryption class„equireshat you set‡nƒncryption key in your config file.');

87  
	`md5
(
$key
);

88 
	}
}

99 
funùiÚ
 
£t_key
(
$key
 = '')

101 
$this
->
’üy±iÚ_key
 = 
$key
;

122 
funùiÚ
 
’code
(
$¡ršg
, 
$key
 = '')

124 
$key
 = 
$this
->
g‘_key
($key);

125 
	g$’c
 = 
$this
->
müy±_’code
(
$¡ršg
, 
$key
);

127  
ba£64_’code
(
$’c
);

142 
funùiÚ
 
decode
(
$¡ršg
, 
$key
 = '')

144 
$key
 = 
$this
->
g‘_key
($key);

146 ià(
´eg_m©ch
('/[^a-zA-Z0-9\/\+=]/', 
$¡ršg
))

148  
	gFALSE
;

151 
	g$dec
 = 
ba£64_decode
(
$¡ršg
);

153 ià((
	g$dec
 = 
$this
->
müy±_decode
(
$dec
, 
$key
)è==ğ
FALSE
)

155  
FALSE
;

158  
	g$dec
;

179 
funùiÚ
 
’code_äom_Ëgacy
(
$¡ršg
, 
$Ëgacy_mode
 = 
MCRYPT_MODE_ECB
, 
$key
 = '')

184 
$cu¼’t_mode
 = 
$this
->
_g‘_mode
();

185 
	g$this
->
£t_mode
(
$Ëgacy_mode
);

187 
	g$key
 = 
$this
->
g‘_key
(
$key
);

189 ià(
´eg_m©ch
('/[^a-zA-Z0-9\/\+=]/', 
$¡ršg
))

191  
	gFALSE
;

194 
	g$dec
 = 
ba£64_decode
(
$¡ršg
);

196 ià((
	g$dec
 = 
$this
->
müy±_decode
(
$dec
, 
$key
)è==ğ
FALSE
)

198  
FALSE
;

201 
	g$dec
 = 
$this
->
_xÜ_decode
(
$dec
, 
$key
);

204 
	g$this
->
£t_mode
(
$cu¼’t_mode
);

207  
ba£64_’code
(
$this
->
müy±_’code
(
$dec
, 
$key
));

223 
funùiÚ
 
	$_xÜ_decode
(
$¡ršg
, 
$key
)

225 
$¡ršg
 = 
$this
->
	`_xÜ_m”ge
($¡ršg, 
$key
);

227 
$dec
 = '';

228 
$i
 = 0; $˜< 
	`¡¾’
(
$¡ršg
); $i++)

230 
$dec
 .ğ(
	`sub¡r
(
$¡ršg
, 
$i
++, 1) ^ substr($string, $i, 1));

233  
$dec
;

234 
	}
}

248 
funùiÚ
 
	$_xÜ_m”ge
(
$¡ršg
, 
$key
)

250 
$hash
 = 
$this
->
	`hash
(
$key
);

251 
$¡r
 = '';

252 
$i
 = 0; $˜< 
	`¡¾’
(
$¡ršg
); $i++)

254 
$¡r
 .ğ
	`sub¡r
(
$¡ršg
, 
$i
, 1è^ sub¡r(
$hash
, ($˜% 
	`¡¾’
($hash)), 1);

257  
$¡r
;

258 
	}
}

270 
funùiÚ
 
	$müy±_’code
(
$d©a
, 
$key
)

272 
$š™_size
 = 
	`müy±_g‘_iv_size
(
$this
->
	`_g‘_ch”
(), $this->
	`_g‘_mode
());

273 
$š™_veù
 = 
	`müy±_ü—‹_iv
(
$š™_size
, 
MCRYPT_RAND
);

274  
$this
->
	`_add_ch”_noi£
(
$š™_veù
.
	`müy±_’üy±
($this->
	`_g‘_ch”
(), 
$key
, 
$d©a
, $this->
	`_g‘_mode
(), $init_vect), $key);

275 
	}
}

287 
funùiÚ
 
	$müy±_decode
(
$d©a
, 
$key
)

289 
$d©a
 = 
$this
->
	`_»move_ch”_noi£
($d©a, 
$key
);

290 
$š™_size
 = 
	`müy±_g‘_iv_size
(
$this
->
	`_g‘_ch”
(), $this->
	`_g‘_mode
());

292 ià(
$š™_size
 > 
	`¡¾’
(
$d©a
))

294  
FALSE
;

297 
$š™_veù
 = 
	`sub¡r
(
$d©a
, 0, 
$š™_size
);

298 
$d©a
 = 
	`sub¡r
($d©a, 
$š™_size
);

299  
	`¹rim
(
	`müy±_deüy±
(
$this
->
	`_g‘_ch”
(), 
$key
, 
$d©a
, $this->
	`_g‘_mode
(), 
$š™_veù
), "\0");

300 
	}
}

316 
funùiÚ
 
	$_add_ch”_noi£
(
$d©a
, 
$key
)

318 
$keyhash
 = 
$this
->
	`hash
(
$key
);

319 
$keyËn
 = 
	`¡¾’
(
$keyhash
);

320 
$¡r
 = '';

322 
$i
 = 0, 
$j
 = 0, 
$Ën
 = 
	`¡¾’
(
$d©a
); $i < $len; ++$i, ++$j)

324 ià(
$j
 >ğ
$keyËn
)

326 
$j
 = 0;

329 
$¡r
 .ğ
	`chr
((
	`Üd
(
$d©a
[
$i
]è+ ord(
$keyhash
[
$j
])) % 256);

332  
$¡r
;

333 
	}
}

347 
funùiÚ
 
	$_»move_ch”_noi£
(
$d©a
, 
$key
)

349 
$keyhash
 = 
$this
->
	`hash
(
$key
);

350 
$keyËn
 = 
	`¡¾’
(
$keyhash
);

351 
$¡r
 = '';

353 
$i
 = 0, 
$j
 = 0, 
$Ën
 = 
	`¡¾’
(
$d©a
); $i < $len; ++$i, ++$j)

355 ià(
$j
 >ğ
$keyËn
)

357 
$j
 = 0;

360 
$‹mp
 = 
	`Üd
(
$d©a
[
$i
]è- ord(
$keyhash
[
$j
]);

362 ià(
$‹mp
 < 0)

364 
$‹mp
 = $temp + 256;

367 
$¡r
 .ğ
	`chr
(
$‹mp
);

370  
$¡r
;

371 
	}
}

382 
funùiÚ
 
	$£t_ch”
(
$ch”
)

384 
$this
->
_müy±_ch”
 = 
$ch”
;

385 
	}
}

396 
funùiÚ
 
	$£t_mode
(
$mode
)

398 
$this
->
_müy±_mode
 = 
$mode
;

399 
	}
}

409 
funùiÚ
 
	$_g‘_ch”
()

411 ià(
$this
->
_müy±_ch”
 == '')

413 
$this
->
_müy±_ch”
 = 
MCRYPT_RIJNDAEL_256
;

416  
$this
->
_müy±_ch”
;

417 
	}
}

427 
funùiÚ
 
	$_g‘_mode
()

429 ià(
$this
->
_müy±_mode
 == '')

431 
$this
->
_müy±_mode
 = 
MCRYPT_MODE_CBC
;

434  
$this
->
_müy±_mode
;

435 
	}
}

446 
funùiÚ
 
£t_hash
(
$ty³
 = 'sha1')

448 
$this
->
_hash_ty³
 = (
$ty³
 !ğ'sha1' 
AND
 $type != 'md5') ? 'sha1' : $type;

460 
funùiÚ
 
	$hash
(
$¡r
)

462  (
$this
->
_hash_ty³
 =ğ'sha1'è? $this->
	`sha1
(
$¡r
è: 
	`md5
($str);

463 
	}
}

474 
funùiÚ
 
	$sha1
(
$¡r
)

476 iàĞ! 
	`funùiÚ_exi¡s
('sha1'))

478 iàĞ! 
	`funùiÚ_exi¡s
('mhash'))

480 
	`»quœe_Úû
(
BASEPATH
.'libraries/Sha1.php');

481 
$SH
 = 
Ãw
 
CI_SHA
;

482  
$SH
->
	`g’”©e
(
$¡r
);

486  
	`bš2hex
(
	`mhash
(
MHASH_SHA1
, 
$¡r
));

491  
	`sha1
(
$¡r
);

493 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Form_validation.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_FÜm_v®id©iÚ
 {

29 
´Ùeùed
 
	m$CI
;

30 
´Ùeùed
 
	m$_f›ld_d©a
 = 
¬¿y
();

31 
´Ùeùed
 
	m$_cÚfig_ruËs
 = 
¬¿y
();

32 
´Ùeùed
 
	m$_”rÜ_¬¿y
 = 
¬¿y
();

33 
´Ùeùed
 
	m$_”rÜ_mes§ges
 = 
¬¿y
();

34 
´Ùeùed
 
	m$_”rÜ_´efix
 = '<p>';

35 
´Ùeùed
 
	m$_”rÜ_suffix
 = '</p>';

36 
´Ùeùed
 
	m$”rÜ_¡ršg
 = '';

37 
´Ùeùed
 
	m$_§ã_fÜm_d©a
 = 
FALSE
;

42 
public
 
funùiÚ
 
__cÚ¡ruù
(
$ruËs
 = 
	$¬¿y
())

44 
$this
->
CI
 =& 
	`g‘_š¡ªû
();

47 
$this
->
_cÚfig_ruËs
 = 
$ruËs
;

50 
$this
->
CI
->
lßd
->
	`h–³r
('form');

53 ià(
	`funùiÚ_exi¡s
('mb_internal_encoding'))

55 
	`mb_š‹º®_’codšg
(
$this
->
CI
->
cÚfig
->
	`™em
('charset'));

58 
	`log_mes§ge
('debug', "Form Validation Class Initialized");

74 
public
 
funùiÚ
 
	`£t_ruËs
(
$f›ld
, 
$Ïb–
 = '', 
$ruËs
 = '')

77 ià(
	`couÁ
(
$_POST
) == 0)

79  
$this
;

84 ià(
	`is_¬¿y
(
$f›ld
))

86 
	`fÜ—ch
 (
$f›ld
 
as
 
$row
)

89 iàĞ! 
	`is£t
(
$row
['f›ld']è
OR
 ! isset($row['rules']))

95 
$Ïb–
 = ( ! 
	`is£t
(
$row
['label'])) ? $row['field'] : $row['label'];

98 
$this
->
	`£t_ruËs
(
$row
['f›ld'], 
$Ïb–
, $row['rules']);

100  
$this
;

104 iàĞ! 
	`is_¡ršg
(
$f›ld
è
OR
 ! is_¡ršg(
$ruËs
) OR $field == '')

106  
$this
;

110 
$Ïb–
 = ($Ïb– =ğ''è? 
$f›ld
 : $label;

115 ià(
	`¡½os
(
$f›ld
, '['è!=ğ
FALSE
 
AND
 
	`´eg_m©ch_®l
('/\[(.*?)\]/', $f›ld, 
$m©ches
))

119 
$x
 = 
	`ex¶ode
('[', 
$f›ld
);

120 
$šdexes
[] = 
	`cu¼’t
(
$x
);

122 
$i
 = 0; $˜< 
	`couÁ
(
$m©ches
['0']); $i++)

124 ià(
$m©ches
['1'][
$i
] != '')

126 
$šdexes
[] = 
$m©ches
['1'][
$i
];

130 
$is_¬¿y
 = 
TRUE
;

134 
$šdexes
 = 
	`¬¿y
();

135 
$is_¬¿y
 = 
FALSE
;

139 
$this
->
_f›ld_d©a
[
$f›ld
] = 
	`¬¿y
(

140 'f›ld' => 
$f›ld
,

141 'Ïb–' => 
$Ïb–
,

142 'ruËs' => 
$ruËs
,

143 'is_¬¿y' => 
$is_¬¿y
,

144 'keys' => 
$šdexes
,

145 'po¡d©a' => 
NULL
,

149  
$this
;

150 
	}
}

165 
public
 
funùiÚ
 
£t_mes§ge
(
$Ïng
, 
$v®
 = '')

167 iàĞ! 
is_¬¿y
(
$Ïng
))

169 
$Ïng
 = 
¬¿y
($Ïng => 
$v®
);

172 
	g$this
->
	g_”rÜ_mes§ges
 = 
¬¿y_m”ge
(
$this
->
_”rÜ_mes§ges
, 
$Ïng
);

174  
	g$this
;

189 
public
 
funùiÚ
 
£t_”rÜ_d–im™”s
(
$´efix
 = '<p>', 
$suffix
 = '</p>')

191 
$this
->
_”rÜ_´efix
 = 
$´efix
;

192 
	g$this
->
	g_”rÜ_suffix
 = 
$suffix
;

194  
	g$this
;

208 
public
 
funùiÚ
 
”rÜ
(
$f›ld
 = '', 
$´efix
 = '', 
$suffix
 = '')

210 iàĞ! 
is£t
(
$this
->
_f›ld_d©a
[
$f›ld
]['”rÜ']è
OR
 $this->_field_data[$field]['error'] == '')

215 ià(
	g$´efix
 == '')

217 
$´efix
 = 
$this
->
_”rÜ_´efix
;

220 ià(
	g$suffix
 == '')

222 
$suffix
 = 
$this
->
_”rÜ_suffix
;

225  
	g$´efix
.
	g$this
->
	g_f›ld_d©a
[
$f›ld
]['”rÜ'].
	g$suffix
;

240 
public
 
funùiÚ
 
”rÜ_¡ršg
(
$´efix
 = '', 
$suffix
 = '')

243 ià(
couÁ
(
$this
->
_”rÜ_¬¿y
) === 0)

248 ià(
	g$´efix
 == '')

250 
$´efix
 = 
$this
->
_”rÜ_´efix
;

253 ià(
	g$suffix
 == '')

255 
$suffix
 = 
$this
->
_”rÜ_suffix
;

259 
	g$¡r
 = '';

260 
fÜ—ch
 (
$this
->
_”rÜ_¬¿y
 
as
 
$v®
)

262 ià(
	g$v®
 != '')

264 
$¡r
 .ğ
$´efix
.
$v®
.
$suffix
."\n";

268  
	g$¡r
;

281 
public
 
funùiÚ
 
run
(
$group
 = '')

284 ià(
couÁ
(
$_POST
) == 0)

286  
FALSE
;

291 ià(
couÁ
(
$this
->
_f›ld_d©a
) == 0)

294 ià(
couÁ
(
$this
->
_cÚfig_ruËs
) == 0)

296  
FALSE
;

300 
	g$uri
 = (
$group
 =ğ''è? 
Œim
(
$this
->
CI
->
uri
->
ruri_¡ršg
(), '/') : $group;

302 ià(
	g$uri
 !ğ'' 
AND
 
is£t
(
$this
->
_cÚfig_ruËs
[
$uri
]))

304 
$this
->
£t_ruËs
($this->
_cÚfig_ruËs
[
$uri
]);

308 
	g$this
->
£t_ruËs
(
$this
->
_cÚfig_ruËs
);

312 ià(
couÁ
(
$this
->
_f›ld_d©a
) == 0)

314 
log_mes§ge
('debug', "Unableo find validation„ules");

315  
	gFALSE
;

320 
	g$this
->
	gCI
->
	gÏng
->
lßd
('form_validation');

324 
fÜ—ch
 (
$this
->
_f›ld_d©a
 
as
 
$f›ld
 => 
$row
)

329 ià(
$row
['is_¬¿y'] =ğ
TRUE
)

331 
$this
->
_f›ld_d©a
[
$f›ld
]['po¡d©a'] = $this->
_»duû_¬¿y
(
$_POST
, 
$row
['keys']);

335 ià(
is£t
(
$_POST
[
$f›ld
]è
AND
 
	g$_POST
[$field] != "")

337 
$this
->
_f›ld_d©a
[
$f›ld
]['po¡d©a'] = 
$_POST
[$field];

341 
	g$this
->
_execu‹
(
$row
, 
ex¶ode
('|', $row['ruËs']), 
$this
->
_f›ld_d©a
[
$f›ld
]['postdata']);

345 
	g$tÙ®_”rÜs
 = 
couÁ
(
$this
->
_”rÜ_¬¿y
);

347 ià(
	g$tÙ®_”rÜs
 > 0)

349 
	g$this
->
	g_§ã_fÜm_d©a
 = 
TRUE
;

353 
	g$this
->
_»£t_po¡_¬¿y
();

356 ià(
	g$tÙ®_”rÜs
 == 0)

358  
TRUE
;

362  
	gFALSE
;

376 
´Ùeùed
 
funùiÚ
 
	$_»duû_¬¿y
(
$¬¿y
, 
$keys
, 
$i
 = 0)

378 ià(
	`is_¬¿y
(
$¬¿y
))

380 ià(
	`is£t
(
$keys
[
$i
]))

382 ià(
	`is£t
(
$¬¿y
[
$keys
[
$i
]]))

384 
$¬¿y
 = 
$this
->
	`_»duû_¬¿y
($¬¿y[
$keys
[
$i
]], $keys, ($i+1));

388  
NULL
;

393  
$¬¿y
;

397  
$¬¿y
;

398 
	}
}

408 
´Ùeùed
 
funùiÚ
 
	$_»£t_po¡_¬¿y
()

410 
	`fÜ—ch
 (
$this
->
_f›ld_d©a
 
as
 
$f›ld
 => 
$row
)

412 iàĞ! 
	`is_nuÎ
(
$row
['postdata']))

414 ià(
$row
['is_¬¿y'] =ğ
FALSE
)

416 ià(
	`is£t
(
$_POST
[
$row
['field']]))

418 
$_POST
[
$row
['f›ld']] = 
$this
->
	`´•_fÜ_fÜm
($row['postdata']);

424 
$po¡_»f
 =& 
$_POST
;

427 ià(
	`couÁ
(
$row
['keys']) == 1)

429 
$po¡_»f
 =& $po¡_»f[
	`cu¼’t
(
$row
['keys'])];

433 
	`fÜ—ch
 (
$row
['keys'] 
as
 
$v®
)

435 
$po¡_»f
 =& $po¡_»f[
$v®
];

439 ià(
	`is_¬¿y
(
$row
['postdata']))

441 
$¬¿y
 = 
	`¬¿y
();

442 
	`fÜ—ch
 (
$row
['po¡d©a'] 
as
 
$k
 => 
$v
)

444 
$¬¿y
[
$k
] = 
$this
->
	`´•_fÜ_fÜm
(
$v
);

447 
$po¡_»f
 = 
$¬¿y
;

451 
$po¡_»f
 = 
$this
->
	`´•_fÜ_fÜm
(
$row
['postdata']);

456 
	}
}

470 
´Ùeùed
 
funùiÚ
 
	$_execu‹
(
$row
, 
$ruËs
, 
$po¡d©a
 = 
NULL
, 
$cyşes
 = 0)

473 ià(
	`is_¬¿y
(
$po¡d©a
))

475 
	`fÜ—ch
 (
$po¡d©a
 
as
 
$key
 => 
$v®
)

477 
$this
->
	`_execu‹
(
$row
, 
$ruËs
, 
$v®
, 
$cyşes
);

478 
$cyşes
++;

487 
$ÿÎback
 = 
FALSE
;

488 iàĞ! 
	`š_¬¿y
('»quœed', 
$ruËs
è
AND
 
	`is_nuÎ
(
$po¡d©a
))

491 ià(
	`´eg_m©ch
("/(ÿÎback_\w+(\[.*?\])?)/", 
	`im¶ode
(' ', 
$ruËs
), 
$m©ch
))

493 
$ÿÎback
 = 
TRUE
;

494 
$ruËs
 = (
	`¬¿y
('1' => 
$m©ch
[1]));

505 ià(
	`is_nuÎ
(
$po¡d©a
è
AND
 
$ÿÎback
 =ğ
FALSE
)

507 ià(
	`š_¬¿y
('is£t', 
$ruËs
, 
TRUE
è
OR
 in_array('required', $rules))

510 
$ty³
 = (
	`š_¬¿y
('»quœed', 
$ruËs
)) ? 'required' : 'isset';

512 iàĞ! 
	`is£t
(
$this
->
_”rÜ_mes§ges
[
$ty³
]))

514 ià(
FALSE
 ==ğ(
$lše
 = 
$this
->
CI
->
Ïng
->
	`lše
(
$ty³
)))

516 
$lše
 = 'The field was‚ot set';

521 
$lše
 = 
$this
->
_”rÜ_mes§ges
[
$ty³
];

525 
$mes§ge
 = 
	`¥rštf
(
$lše
, 
$this
->
	`_Œª¦©e_f›ldÇme
(
$row
['label']));

528 
$this
->
_f›ld_d©a
[
$row
['f›ld']]['”rÜ'] = 
$mes§ge
;

530 iàĞ! 
	`is£t
(
$this
->
_”rÜ_¬¿y
[
$row
['field']]))

532 
$this
->
_”rÜ_¬¿y
[
$row
['f›ld']] = 
$mes§ge
;

542 
	`fÜ—ch
 (
$ruËs
 
As
 
$ruË
)

544 
$_š_¬¿y
 = 
FALSE
;

548 ià(
$row
['is_¬¿y'] =ğ
TRUE
 
AND
 
	`is_¬¿y
(
$this
->
_f›ld_d©a
[$row['field']]['postdata']))

552 iàĞ! 
	`is£t
(
$this
->
_f›ld_d©a
[
$row
['f›ld']]['po¡d©a'][
$cyşes
]))

557 
$po¡d©a
 = 
$this
->
_f›ld_d©a
[
$row
['f›ld']]['po¡d©a'][
$cyşes
];

558 
$_š_¬¿y
 = 
TRUE
;

562 
$po¡d©a
 = 
$this
->
_f›ld_d©a
[
$row
['field']]['postdata'];

568 
$ÿÎback
 = 
FALSE
;

569 ià(
	`sub¡r
(
$ruË
, 0, 9) == 'callback_')

571 
$ruË
 = 
	`sub¡r
($rule, 9);

572 
$ÿÎback
 = 
TRUE
;

577 
$·¿m
 = 
FALSE
;

578 ià(
	`´eg_m©ch
("/(.*?)\[(.*)\]/", 
$ruË
, 
$m©ch
))

580 
$ruË
 = 
$m©ch
[1];

581 
$·¿m
 = 
$m©ch
[2];

585 ià(
$ÿÎback
 ==ğ
TRUE
)

587 iàĞ! 
	`m‘hod_exi¡s
(
$this
->
CI
, 
$ruË
))

593 
$»suÉ
 = 
$this
->
CI
->
	`$ruË
(
$po¡d©a
, 
$·¿m
);

596 ià(
$_š_¬¿y
 =ğ
TRUE
)

598 
$this
->
_f›ld_d©a
[
$row
['f›ld']]['po¡d©a'][
$cyşes
] = (
	`is_boŞ
(
$»suÉ
)è? 
$po¡d©a
 : $result;

602 
$this
->
_f›ld_d©a
[
$row
['f›ld']]['po¡d©a'] = (
	`is_boŞ
(
$»suÉ
)è? 
$po¡d©a
 : $result;

606 iàĞ! 
	`š_¬¿y
('»quœed', 
$ruËs
, 
TRUE
è
AND
 
$»suÉ
 !=ğ
FALSE
)

613 iàĞ! 
	`m‘hod_exi¡s
(
$this
, 
$ruË
))

617 ià(
	`funùiÚ_exi¡s
(
$ruË
))

619 
$»suÉ
 = 
	`$ruË
(
$po¡d©a
);

621 ià(
$_š_¬¿y
 =ğ
TRUE
)

623 
$this
->
_f›ld_d©a
[
$row
['f›ld']]['po¡d©a'][
$cyşes
] = (
	`is_boŞ
(
$»suÉ
)è? 
$po¡d©a
 : $result;

627 
$this
->
_f›ld_d©a
[
$row
['f›ld']]['po¡d©a'] = (
	`is_boŞ
(
$»suÉ
)è? 
$po¡d©a
 : $result;

632 
	`log_mes§ge
('debug', "UÇbËØfšd v®id©iÚ„uË: ".
$ruË
);

638 
$»suÉ
 = 
$this
->
	`$ruË
(
$po¡d©a
, 
$·¿m
);

640 ià(
$_š_¬¿y
 =ğ
TRUE
)

642 
$this
->
_f›ld_d©a
[
$row
['f›ld']]['po¡d©a'][
$cyşes
] = (
	`is_boŞ
(
$»suÉ
)è? 
$po¡d©a
 : $result;

646 
$this
->
_f›ld_d©a
[
$row
['f›ld']]['po¡d©a'] = (
	`is_boŞ
(
$»suÉ
)è? 
$po¡d©a
 : $result;

651 ià(
$»suÉ
 ==ğ
FALSE
)

653 iàĞ! 
	`is£t
(
$this
->
_”rÜ_mes§ges
[
$ruË
]))

655 ià(
FALSE
 ==ğ(
$lše
 = 
$this
->
CI
->
Ïng
->
	`lše
(
$ruË
)))

657 
$lše
 = 'Unableo‡ccess‡nƒrror message correspondingo your field‚ame.';

662 
$lše
 = 
$this
->
_”rÜ_mes§ges
[
$ruË
];

667 ià(
	`is£t
(
$this
->
_f›ld_d©a
[
$·¿m
]è
AND
 isset($this->_field_data[$param]['label']))

669 
$·¿m
 = 
$this
->
	`_Œª¦©e_f›ldÇme
($this->
_f›ld_d©a
[$param]['label']);

673 
$mes§ge
 = 
	`¥rštf
(
$lše
, 
$this
->
	`_Œª¦©e_f›ldÇme
(
$row
['Ïb–']), 
$·¿m
);

676 
$this
->
_f›ld_d©a
[
$row
['f›ld']]['”rÜ'] = 
$mes§ge
;

678 iàĞ! 
	`is£t
(
$this
->
_”rÜ_¬¿y
[
$row
['field']]))

680 
$this
->
_”rÜ_¬¿y
[
$row
['f›ld']] = 
$mes§ge
;

686 
	}
}

697 
´Ùeùed
 
funùiÚ
 
	$_Œª¦©e_f›ldÇme
(
$f›ldÇme
)

701 ià(
	`sub¡r
(
$f›ldÇme
, 0, 5) == 'lang:')

704 
$lše
 = 
	`sub¡r
(
$f›ldÇme
, 5);

707 ià(
FALSE
 ==ğ(
$f›ldÇme
 = 
$this
->
CI
->
Ïng
->
	`lše
(
$lše
)))

709  
$lše
;

713  
$f›ldÇme
;

714 
	}
}

729 
public
 
funùiÚ
 
£t_v®ue
(
$f›ld
 = '', 
$deçuÉ
 = '')

731 iàĞ! 
is£t
(
$this
->
_f›ld_d©a
[
$f›ld
]))

733  
$deçuÉ
;

738 ià(
is_¬¿y
(
$this
->
_f›ld_d©a
[
$f›ld
]['postdata']))

740  
¬¿y_shiá
(
$this
->
_f›ld_d©a
[
$f›ld
]['postdata']);

743  
	g$this
->
	g_f›ld_d©a
[
$f›ld
]['postdata'];

759 
public
 
funùiÚ
 
£t_£Ëù
(
$f›ld
 = '', 
$v®ue
 = '', 
$deçuÉ
 = 
FALSE
)

761 iàĞ! 
is£t
(
$this
->
_f›ld_d©a
[
$f›ld
]è
OR
 ! isset($this->_field_data[$field]['postdata']))

763 ià(
$deçuÉ
 ==ğ
TRUE
 
AND
 
couÁ
(
$this
->
_f›ld_d©a
) === 0)

770 
	g$f›ld
 = 
$this
->
_f›ld_d©a
[
$f›ld
]['postdata'];

772 ià(
is_¬¿y
(
$f›ld
))

774 iàĞ! 
š_¬¿y
(
$v®ue
, 
$f›ld
))

781 ià((
	g$f›ld
 =ğ'' 
OR
 
$v®ue
 =ğ''èOR (
$f›ld
 != $value))

803 
public
 
funùiÚ
 
£t_¿dio
(
$f›ld
 = '', 
$v®ue
 = '', 
$deçuÉ
 = 
FALSE
)

805 iàĞ! 
is£t
(
$this
->
_f›ld_d©a
[
$f›ld
]è
OR
 ! isset($this->_field_data[$field]['postdata']))

807 ià(
$deçuÉ
 ==ğ
TRUE
 
AND
 
couÁ
(
$this
->
_f›ld_d©a
) === 0)

814 
	g$f›ld
 = 
$this
->
_f›ld_d©a
[
$f›ld
]['postdata'];

816 ià(
is_¬¿y
(
$f›ld
))

818 iàĞ! 
š_¬¿y
(
$v®ue
, 
$f›ld
))

825 ià((
	g$f›ld
 =ğ'' 
OR
 
$v®ue
 =ğ''èOR (
$f›ld
 != $value))

847 
public
 
funùiÚ
 
£t_checkbox
(
$f›ld
 = '', 
$v®ue
 = '', 
$deçuÉ
 = 
FALSE
)

849 iàĞ! 
is£t
(
$this
->
_f›ld_d©a
[
$f›ld
]è
OR
 ! isset($this->_field_data[$field]['postdata']))

851 ià(
$deçuÉ
 ==ğ
TRUE
 
AND
 
couÁ
(
$this
->
_f›ld_d©a
) === 0)

858 
	g$f›ld
 = 
$this
->
_f›ld_d©a
[
$f›ld
]['postdata'];

860 ià(
is_¬¿y
(
$f›ld
))

862 iàĞ! 
š_¬¿y
(
$v®ue
, 
$f›ld
))

869 ià((
	g$f›ld
 =ğ'' 
OR
 
$v®ue
 =ğ''èOR (
$f›ld
 != $value))

887 
public
 
funùiÚ
 
	$»quœed
(
$¡r
)

889 iàĞ! 
	`is_¬¿y
(
$¡r
))

891  (
	`Œim
(
$¡r
è=ğ''è? 
FALSE
 : 
TRUE
;

895  ( ! 
	`em±y
(
$¡r
));

897 
	}
}

909 
public
 
funùiÚ
 
	$»gex_m©ch
(
$¡r
, 
$»gex
)

911 iàĞ! 
	`´eg_m©ch
(
$»gex
, 
$¡r
))

913  
FALSE
;

916  
TRUE
;

917 
	}
}

929 
public
 
funùiÚ
 
	$m©ches
(
$¡r
, 
$f›ld
)

931 iàĞ! 
	`is£t
(
$_POST
[
$f›ld
]))

933  
FALSE
;

936 
$f›ld
 = 
$_POST
[$field];

938  (
$¡r
 !=ğ
$f›ld
è? 
FALSE
 : 
TRUE
;

939 
	}
}

951 
public
 
funùiÚ
 
	$is_unique
(
$¡r
, 
$f›ld
)

953 
	`li¡
(
$bË
, 
$f›ld
)=
	`ex¶ode
('.', $field);

954 
$qu”y
 = 
$this
->
CI
->
db
->
	`lim™
(1)->
	`g‘_wh”e
(
$bË
, 
	`¬¿y
(
$f›ld
 => 
$¡r
));

956  
$qu”y
->
	`num_rows
() === 0;

957 
	}
}

969 
public
 
funùiÚ
 
	$mš_Ëngth
(
$¡r
, 
$v®
)

971 ià(
	`´eg_m©ch
("/[^0-9]/", 
$v®
))

973  
FALSE
;

976 ià(
	`funùiÚ_exi¡s
('mb_strlen'))

978  (
	`mb_¡¾’
(
$¡r
è< 
$v®
è? 
FALSE
 : 
TRUE
;

981  (
	`¡¾’
(
$¡r
è< 
$v®
è? 
FALSE
 : 
TRUE
;

982 
	}
}

994 
public
 
funùiÚ
 
	$max_Ëngth
(
$¡r
, 
$v®
)

996 ià(
	`´eg_m©ch
("/[^0-9]/", 
$v®
))

998  
FALSE
;

1001 ià(
	`funùiÚ_exi¡s
('mb_strlen'))

1003  (
	`mb_¡¾’
(
$¡r
è> 
$v®
è? 
FALSE
 : 
TRUE
;

1006  (
	`¡¾’
(
$¡r
è> 
$v®
è? 
FALSE
 : 
TRUE
;

1007 
	}
}

1019 
public
 
funùiÚ
 
	$exaù_Ëngth
(
$¡r
, 
$v®
)

1021 ià(
	`´eg_m©ch
("/[^0-9]/", 
$v®
))

1023  
FALSE
;

1026 ià(
	`funùiÚ_exi¡s
('mb_strlen'))

1028  (
	`mb_¡¾’
(
$¡r
è!ğ
$v®
è? 
FALSE
 : 
TRUE
;

1031  (
	`¡¾’
(
$¡r
è!ğ
$v®
è? 
FALSE
 : 
TRUE
;

1032 
	}
}

1043 
public
 
funùiÚ
 
	$v®id_ema
(
$¡r
)

1045  ( ! 
	`´eg_m©ch
("/^([a-z0-9\+_\-]+)(\.[a-z0-9\+_\-]+)*@([a-z0-9\-]+\.)+[a-z]{2,6}$/ix", 
$¡r
)è? 
FALSE
 : 
TRUE
;

1046 
	}
}

1057 
public
 
funùiÚ
 
	$v®id_emas
(
$¡r
)

1059 ià(
	`¡½os
(
$¡r
, ','è==ğ
FALSE
)

1061  
$this
->
	`v®id_ema
(
	`Œim
(
$¡r
));

1064 
	`fÜ—ch
 (
	`ex¶ode
(',', 
$¡r
è
as
 
$ema
)

1066 ià(
	`Œim
(
$ema
è!ğ'' && 
$this
->
	`v®id_ema
Ñrim($ema)è==ğ
FALSE
)

1068  
FALSE
;

1072  
TRUE
;

1073 
	}
}

1085 
public
 
funùiÚ
 
v®id_
(
$
, 
$which
 = '')

1087  
$this
->
CI
->
šput
->
v®id_
(
$
, 
$which
);

1099 
public
 
funùiÚ
 
	$®pha
(
$¡r
)

1101  ( ! 
	`´eg_m©ch
("/^([a-z])+$/i", 
$¡r
)è? 
FALSE
 : 
TRUE
;

1102 
	}
}

1113 
public
 
funùiÚ
 
	$®pha_num”ic
(
$¡r
)

1115  ( ! 
	`´eg_m©ch
("/^([a-z0-9])+$/i", 
$¡r
)è? 
FALSE
 : 
TRUE
;

1116 
	}
}

1127 
public
 
funùiÚ
 
	$®pha_dash
(
$¡r
)

1129  ( ! 
	`´eg_m©ch
("/^([-a-z0-9_-])+$/i", 
$¡r
)è? 
FALSE
 : 
TRUE
;

1130 
	}
}

1141 
public
 
funùiÚ
 
	$num”ic
(
$¡r
)

1143  (
boŞ
)
	`´eg_m©ch
Ğ'/^[\-+]?[0-9]*\.?[0-9]+$/', 
$¡r
);

1145 
	}
}

1156 
public
 
funùiÚ
 
	$is_num”ic
(
$¡r
)

1158  ( ! 
	`is_num”ic
(
$¡r
)è? 
FALSE
 : 
TRUE
;

1159 
	}
}

1170 
public
 
funùiÚ
 
	$š‹g”
(
$¡r
)

1172  (
boŞ
è
	`´eg_m©ch
('/^[\-+]?[0-9]+$/', 
$¡r
);

1173 
	}
}

1184 
public
 
funùiÚ
 
	$decim®
(
$¡r
)

1186  (
boŞ
è
	`´eg_m©ch
('/^[\-+]?[0-9]+\.[0-9]+$/', 
$¡r
);

1187 
	}
}

1198 
public
 
funùiÚ
 
	$g»©”_thª
(
$¡r
, 
$mš
)

1200 iàĞ! 
	`is_num”ic
(
$¡r
))

1202  
FALSE
;

1204  
$¡r
 > 
$mš
;

1205 
	}
}

1216 
public
 
funùiÚ
 
	$Ëss_thª
(
$¡r
, 
$max
)

1218 iàĞ! 
	`is_num”ic
(
$¡r
))

1220  
FALSE
;

1222  
$¡r
 < 
$max
;

1223 
	}
}

1234 
public
 
funùiÚ
 
	$is_Çtu¿l
(
$¡r
)

1236  (
boŞ
è
	`´eg_m©ch
Ğ'/^[0-9]+$/', 
$¡r
);

1237 
	}
}

1248 
public
 
funùiÚ
 
	$is_Çtu¿l_no_z”o
(
$¡r
)

1250 iàĞ! 
	`´eg_m©ch
Ğ'/^[0-9]+$/', 
$¡r
))

1252  
FALSE
;

1255 ià(
$¡r
 == 0)

1257  
FALSE
;

1260  
TRUE
;

1261 
	}
}

1275 
public
 
funùiÚ
 
	$v®id_ba£64
(
$¡r
)

1277  (
boŞ
è! 
	`´eg_m©ch
('/[^a-zA-Z0-9\/\+=]/', 
$¡r
);

1278 
	}
}

1292 
public
 
funùiÚ
 
´•_fÜ_fÜm
(
$d©a
 = '')

1294 ià(
is_¬¿y
(
$d©a
))

1296 
fÜ—ch
 (
$d©a
 
as
 
$key
 => 
$v®
)

1298 
$d©a
[
$key
] = 
$this
->
´•_fÜ_fÜm
(
$v®
);

1301  
	g$d©a
;

1304 ià(
	g$this
->
	g_§ã_fÜm_d©a
 =ğ
FALSE
 
OR
 
$d©a
 === '')

1306  
$d©a
;

1309  
¡r_»¶aû
(
¬¿y
("'", '"', '<', '>'),‡¼ay("&#39;", "&quÙ;", '&É;', '&gt;'), 
¡r¦ashes
(
$d©a
));

1321 
public
 
funùiÚ
 
´•_u¾
(
$¡r
 = '')

1323 ià(
$¡r
 =ğ'h‰p://' 
OR
 $str == '')

1328 ià(
sub¡r
(
$¡r
, 0, 7) != 'http://' && substr($str, 0, 8) != 'https://')

1330 
$¡r
 = 'http://'.$str;

1333  
	g$¡r
;

1345 
public
 
funùiÚ
 
	$¡r_image_gs
(
$¡r
)

1347  
$this
->
CI
->
šput
->
	`¡r_image_gs
(
$¡r
);

1348 
	}
}

1359 
public
 
funùiÚ
 
	$xss_ş—n
(
$¡r
)

1361  
$this
->
CI
->
£cur™y
->
	`xss_ş—n
(
$¡r
);

1362 
	}
}

1373 
public
 
funùiÚ
 
	$’code_php_gs
(
$¡r
)

1375  
	`¡r_»¶aû
(
	`¬¿y
('<?php', '<?PHP', '<?', '?>'),‡¼ay('&É;?php', '&É;?PHP', '&É;?', '?&gt;'), 
$¡r
);

1376 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Ftp.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_FTP
 {

29 
v¬
 
	m$ho¡Çme
 = '';

30 
v¬
 
	m$u£ºame
 = '';

31 
v¬
 
	m$·sswÜd
 = '';

32 
v¬
 
	m$pÜt
 = 21;

33 
v¬
 
	m$·ssive
 = 
TRUE
;

34 
v¬
 
	m$debug
 = 
FALSE
;

35 
v¬
 
	m$cÚn_id
 = 
FALSE
;

43 
public
 
funùiÚ
 
__cÚ¡ruù
(
$cÚfig
 = 
	$¬¿y
())

45 ià(
	`couÁ
(
$cÚfig
) > 0)

47 
$this
->
	`š™Ÿlize
(
$cÚfig
);

50 
	`log_mes§ge
('debug', "FTP Class Initialized");

62 
funùiÚ
 
	`š™Ÿlize
(
$cÚfig
 = 
	$¬¿y
())

64 
	`fÜ—ch
 (
$cÚfig
 
as
 
$key
 => 
$v®
)

66 ià(
	`is£t
(
$this
->
$key
))

68 
$this
->
$key
 = 
$v®
;

73 
$this
->
ho¡Çme
 = 
	`´eg_»¶aû
('|.+?://|', '', $this->hostname);

74 
	}
}

85 
funùiÚ
 
cÚÃù
(
$cÚfig
 = 
	$¬¿y
())

87 ià(
	`couÁ
(
$cÚfig
) > 0)

89 
$this
->
	`š™Ÿlize
(
$cÚfig
);

92 ià(
FALSE
 ==ğ(
$this
->
cÚn_id
 = @
	`áp_cÚÃù
($this->
ho¡Çme
, $this->
pÜt
)))

94 ià(
$this
->
debug
 =ğ
TRUE
)

96 
$this
->
	`_”rÜ
('ftp_unable_to_connect');

98  
FALSE
;

101 iàĞ! 
$this
->
	`_logš
())

103 ià(
$this
->
debug
 =ğ
TRUE
)

105 
$this
->
	`_”rÜ
('ftp_unable_to_login');

107  
FALSE
;

111 ià(
$this
->
·ssive
 =ğ
TRUE
)

113 
	`áp_·sv
(
$this
->
cÚn_id
, 
TRUE
);

116  
TRUE
;

117 
	}
}

127 
funùiÚ
 
	$_logš
()

129  @
	`áp_logš
(
$this
->
cÚn_id
, $this->
u£ºame
, $this->
·sswÜd
);

130 
	}
}

140 
funùiÚ
 
	$_is_cÚn
()

142 iàĞ! 
	`is_»sourû
(
$this
->
cÚn_id
))

144 ià(
$this
->
debug
 =ğ
TRUE
)

146 
$this
->
	`_”rÜ
('ftp_no_connection');

148  
FALSE
;

150  
TRUE
;

151 
	}
}

170 
funùiÚ
 
chªgedœ
(
$·th
 = '', 
$su´ess_debug
 = 
FALSE
)

172 ià(
$·th
 =ğ'' 
OR
 ! 
$this
->
_is_cÚn
())

174  
FALSE
;

177 
	g$»suÉ
 = @
áp_chdœ
(
$this
->
cÚn_id
, 
$·th
);

179 ià(
	g$»suÉ
 ==ğ
FALSE
)

181 ià(
$this
->
debug
 =ğ
TRUE
 
AND
 
$su´ess_debug
 =ğ
FALSE
)

183 
$this
->
_”rÜ
('ftp_unable_to_changedir');

185  
	gFALSE
;

188  
	gTRUE
;

200 
funùiÚ
 
mkdœ
(
$·th
 = '', 
$³rmissiÚs
 = 
NULL
)

202 ià(
$·th
 =ğ'' 
OR
 ! 
$this
->
_is_cÚn
())

204  
FALSE
;

207 
	g$»suÉ
 = @
áp_mkdœ
(
$this
->
cÚn_id
, 
$·th
);

209 ià(
	g$»suÉ
 ==ğ
FALSE
)

211 ià(
$this
->
debug
 =ğ
TRUE
)

213 
$this
->
_”rÜ
('ftp_unable_to_makdir');

215  
	gFALSE
;

219 iàĞ! 
is_nuÎ
(
$³rmissiÚs
))

221 
	g$this
->
chmod
(
$·th
, ()
$³rmissiÚs
);

224  
	gTRUE
;

238 
funùiÚ
 
u¶ßd
(
$loı©h
, 
$»m·th
, 
$mode
 = 'auto', 
$³rmissiÚs
 = 
NULL
)

240 iàĞ! 
$this
->
_is_cÚn
())

242  
FALSE
;

245 iàĞ! 
fe_exi¡s
(
$loı©h
))

247 
	g$this
->
_”rÜ
('ftp_no_source_file');

248  
	gFALSE
;

252 ià(
	g$mode
 == 'auto')

255 
$ext
 = 
$this
->
_g‘ext
(
$loı©h
);

256 
	g$mode
 = 
$this
->
_£‰y³
(
$ext
);

259 
	g$mode
 = (
$mode
 =ğ'ascii'è? 
FTP_ASCII
 : 
FTP_BINARY
;

261 
	g$»suÉ
 = @
áp_put
(
$this
->
cÚn_id
, 
$»m·th
, 
$loı©h
, 
$mode
);

263 ià(
	g$»suÉ
 ==ğ
FALSE
)

265 ià(
$this
->
debug
 =ğ
TRUE
)

267 
$this
->
_”rÜ
('ftp_unable_to_upload');

269  
	gFALSE
;

273 iàĞ! 
is_nuÎ
(
$³rmissiÚs
))

275 
	g$this
->
chmod
(
$»m·th
, ()
$³rmissiÚs
);

278  
	gTRUE
;

292 
funùiÚ
 
dowÆßd
(
$»m·th
, 
$loı©h
, 
$mode
 = 'auto')

294 iàĞ! 
$this
->
_is_cÚn
())

296  
FALSE
;

300 ià(
	g$mode
 == 'auto')

303 
$ext
 = 
$this
->
_g‘ext
(
$»m·th
);

304 
	g$mode
 = 
$this
->
_£‰y³
(
$ext
);

307 
	g$mode
 = (
$mode
 =ğ'ascii'è? 
FTP_ASCII
 : 
FTP_BINARY
;

309 
	g$»suÉ
 = @
áp_g‘
(
$this
->
cÚn_id
, 
$loı©h
, 
$»m·th
, 
$mode
);

311 ià(
	g$»suÉ
 ==ğ
FALSE
)

313 ià(
$this
->
debug
 =ğ
TRUE
)

315 
$this
->
_”rÜ
('ftp_unable_to_download');

317  
	gFALSE
;

320  
	gTRUE
;

334 
funùiÚ
 
	$»Çme
(
$Şd_fe
, 
$Ãw_fe
, 
$move
 = 
FALSE
)

336 iàĞ! 
$this
->
	`_is_cÚn
())

338  
FALSE
;

341 
$»suÉ
 = @
	`áp_»Çme
(
$this
->
cÚn_id
, 
$Şd_fe
, 
$Ãw_fe
);

343 ià(
$»suÉ
 ==ğ
FALSE
)

345 ià(
$this
->
debug
 =ğ
TRUE
)

347 
$msg
 = (
$move
 =ğ
FALSE
) ? 'ftp_unable_to_rename' : 'ftp_unable_to_move';

349 
$this
->
	`_”rÜ
(
$msg
);

351  
FALSE
;

354  
TRUE
;

355 
	}
}

367 
funùiÚ
 
	$move
(
$Şd_fe
, 
$Ãw_fe
)

369  
$this
->
	`»Çme
(
$Şd_fe
, 
$Ãw_fe
, 
TRUE
);

370 
	}
}

381 
funùiÚ
 
	$d–‘e_fe
(
$f•©h
)

383 iàĞ! 
$this
->
	`_is_cÚn
())

385  
FALSE
;

388 
$»suÉ
 = @
	`áp_d–‘e
(
$this
->
cÚn_id
, 
$f•©h
);

390 ià(
$»suÉ
 ==ğ
FALSE
)

392 ià(
$this
->
debug
 =ğ
TRUE
)

394 
$this
->
	`_”rÜ
('ftp_unable_to_delete');

396  
FALSE
;

399  
TRUE
;

400 
	}
}

412 
funùiÚ
 
	$d–‘e_dœ
(
$f•©h
)

414 iàĞ! 
$this
->
	`_is_cÚn
())

416  
FALSE
;

420 
$f•©h
 = 
	`´eg_»¶aû
("/(.+?)\/*$/", "\\1/", $filepath);

422 
$li¡
 = 
$this
->
	`li¡_fes
(
$f•©h
);

424 ià(
$li¡
 !=ğ
FALSE
 
AND
 
	`couÁ
($list) > 0)

426 
	`fÜ—ch
 (
$li¡
 
as
 
$™em
)

430 iàĞ! @
	`áp_d–‘e
(
$this
->
cÚn_id
, 
$™em
))

432 
$this
->
	`d–‘e_dœ
(
$™em
);

437 
$»suÉ
 = @
	`áp_rmdœ
(
$this
->
cÚn_id
, 
$f•©h
);

439 ià(
$»suÉ
 ==ğ
FALSE
)

441 ià(
$this
->
debug
 =ğ
TRUE
)

443 
$this
->
	`_”rÜ
('ftp_unable_to_delete');

445  
FALSE
;

448  
TRUE
;

449 
	}
}

461 
funùiÚ
 
	$chmod
(
$·th
, 
$³rm
)

463 iàĞ! 
$this
->
	`_is_cÚn
())

465  
FALSE
;

469 iàĞ! 
	`funùiÚ_exi¡s
('ftp_chmod'))

471 ià(
$this
->
debug
 =ğ
TRUE
)

473 
$this
->
	`_”rÜ
('ftp_unable_to_chmod');

475  
FALSE
;

478 
$»suÉ
 = @
	`áp_chmod
(
$this
->
cÚn_id
, 
$³rm
, 
$·th
);

480 ià(
$»suÉ
 ==ğ
FALSE
)

482 ià(
$this
->
debug
 =ğ
TRUE
)

484 
$this
->
	`_”rÜ
('ftp_unable_to_chmod');

486  
FALSE
;

489  
TRUE
;

490 
	}
}

500 
funùiÚ
 
li¡_fes
(
$·th
 = '.')

502 iàĞ! 
$this
->
_is_cÚn
())

504  
FALSE
;

507  
áp_Æi¡
(
$this
->
cÚn_id
, 
$·th
);

524 
funùiÚ
 
	$mœrÜ
(
$loı©h
, 
$»m·th
)

526 iàĞ! 
$this
->
	`_is_cÚn
())

528  
FALSE
;

532 ià(
$å
 = @
	`İ’dœ
(
$loı©h
))

535 iàĞ! 
$this
->
	`chªgedœ
(
$»m·th
, 
TRUE
))

538 iàĞ! 
$this
->
	`mkdœ
(
$»m·th
è
OR
 ! $this->
	`chªgedœ
($rempath))

540  
FALSE
;

545 
FALSE
 !=ğ(
$fe
 = 
	`»addœ
(
$å
)))

547 ià(@
	`is_dœ
(
$loı©h
.
$fe
è&& 
	`sub¡r
($file, 0, 1) != '.')

549 
$this
->
	`mœrÜ
(
$loı©h
.
$fe
."/", 
$»m·th
.$file."/");

551 
	`–£if
 (
	`sub¡r
(
$fe
, 0, 1) != ".")

554 
$ext
 = 
$this
->
	`_g‘ext
(
$fe
);

555 
$mode
 = 
$this
->
	`_£‰y³
(
$ext
);

557 
$this
->
	`u¶ßd
(
$loı©h
.
$fe
, 
$»m·th
.$fe, 
$mode
);

560  
TRUE
;

563  
FALSE
;

564 
	}
}

576 
funùiÚ
 
	$_g‘ext
(
$f’ame
)

578 ià(
FALSE
 ==ğ
	`¡½os
(
$f’ame
, '.'))

583 
$x
 = 
	`ex¶ode
('.', 
$f’ame
);

584  
	`’d
(
$x
);

585 
	}
}

597 
funùiÚ
 
	$_£‰y³
(
$ext
)

599 
$‹xt_ty³s
 = 
	`¬¿y
(

616  (
	`š_¬¿y
(
$ext
, 
$‹xt_ty³s
)) ? 'ascii' : 'binary';

617 
	}
}

629 
funùiÚ
 
	$şo£
()

631 iàĞ! 
$this
->
	`_is_cÚn
())

633  
FALSE
;

636 @
	`áp_şo£
(
$this
->
cÚn_id
);

637 
	}
}

648 
funùiÚ
 
	$_”rÜ
(
$lše
)

650 
$CI
 =& 
	`g‘_š¡ªû
();

651 
$CI
->
Ïng
->
	`lßd
('ftp');

652 
	`show_”rÜ
(
$CI
->
Ïng
->
	`lše
(
$lše
));

653 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Image_lib.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Image_lib
 {

29 
v¬
 
	m$image_lib¿ry
 = 'gd2';

30 
v¬
 
	m$lib¿ry_·th
 = '';

31 
v¬
 
	m$dyÇmic_ouut
 = 
FALSE
;

32 
v¬
 
	m$sourû_image
 = '';

33 
v¬
 
	m$Ãw_image
 = '';

34 
v¬
 
	m$width
 = '';

35 
v¬
 
	m$height
 = '';

36 
v¬
 
	m$qu®™y
 = '90';

37 
v¬
 
	m$ü—‹_thumb
 = 
FALSE
;

38 
v¬
 
	m$thumb_m¬k”
 = '_thumb';

39 
v¬
 
	m$mašš_¿tio
 = 
TRUE
;

40 
v¬
 
	m$ma¡”_dim
 = 'auto';

41 
v¬
 
	m$rÙ©iÚ_ªgË
 = '';

42 
v¬
 
	m$x_axis
 = '';

43 
v¬
 
	m$y_axis
 = '';

46 
v¬
 
	m$wm_‹xt
 = '';

47 
v¬
 
	m$wm_ty³
 = 'text';

48 
v¬
 
	m$wm_x_Œª¥
 = 4;

49 
v¬
 
	m$wm_y_Œª¥
 = 4;

50 
v¬
 
	m$wm_ov”Ïy_·th
 = '';

51 
v¬
 
	m$wm_fÚt_·th
 = '';

52 
v¬
 
	m$wm_fÚt_size
 = 17;

53 
v¬
 
	m$wm_v¹_®ignm’t
 = 'B';

54 
v¬
 
	m$wm_hÜ_®ignm’t
 = 'C';

55 
v¬
 
	m$wm_·ddšg
 = 0;

56 
v¬
 
	m$wm_hÜ_off£t
 = 0;

57 
v¬
 
	m$wm_v¹_off£t
 = 0;

58 
v¬
 
	m$wm_fÚt_cŞÜ
 = '#ffffff';

59 
v¬
 
	m$wm_shadow_cŞÜ
 = '';

60 
v¬
 
	m$wm_shadow_di¡ªû
 = 2;

61 
v¬
 
	m$wm_İac™y
 = 50;

64 
v¬
 
	m$sourû_fŞd”
 = '';

65 
v¬
 
	m$de¡_fŞd”
 = '';

66 
v¬
 
	m$mime_ty³
 = '';

67 
v¬
 
	m$Üig_width
 = '';

68 
v¬
 
	m$Üig_height
 = '';

69 
v¬
 
	m$image_ty³
 = '';

70 
v¬
 
	m$size_¡r
 = '';

71 
v¬
 
	m$fuÎ_¤c_·th
 = '';

72 
v¬
 
	m$fuÎ_d¡_·th
 = '';

73 
v¬
 
	m$ü—‹_âc
 = 'imagecreatetruecolor';

74 
v¬
 
	m$cİy_âc
 = 'imagecopyresampled';

75 
v¬
 
	m$”rÜ_msg
 = 
¬¿y
();

76 
v¬
 
	m$wm_u£_drİ_shadow
 = 
FALSE
;

77 
v¬
 
	m$wm_u£_Œu‘y³
 = 
FALSE
;

85 
public
 
funùiÚ
 
__cÚ¡ruù
(
$´İs
 = 
	$¬¿y
())

87 ià(
	`couÁ
(
$´İs
) > 0)

89 
$this
->
	`š™Ÿlize
(
$´İs
);

92 
	`log_mes§ge
('debug', "Image Lib Class Initialized");

105 
funùiÚ
 
	$ş—r
()

107 
$´İs
 = 
	`¬¿y
('source_folder', 'dest_folder', 'source_image', 'full_src_path', 'full_dst_path', 'new_image', 'image_type', 'size_str', 'quality', 'orig_width', 'orig_height', 'width', 'height', 'rotation_angle', 'x_axis', 'y_axis', 'create_fnc', 'copy_fnc', 'wm_overlay_path', 'wm_use_truetype', 'dynamic_output', 'wm_font_size', 'wm_text', 'wm_vrt_alignment', 'wm_hor_alignment', 'wm_padding', 'wm_hor_offset', 'wm_vrt_offset', 'wm_font_color', 'wm_use_drop_shadow', 'wm_shadow_color', 'wm_shadow_distance', 'wm_opacity');

109 
	`fÜ—ch
 (
$´İs
 
as
 
$v®
)

111 
$this
->
$v®
 = '';

115 
$this
->
ma¡”_dim
 = 'auto';

116 
	}
}

127 
funùiÚ
 
š™Ÿlize
(
$´İs
 = 
	$¬¿y
())

132 ià(
	`couÁ
(
$´İs
) > 0)

134 
	`fÜ—ch
 (
$´İs
 
as
 
$key
 => 
$v®
)

136 
$this
->
$key
 = 
$v®
;

146 ià(
$this
->
sourû_image
 == '')

148 
$this
->
	`£t_”rÜ
('imglib_source_image_required');

149  
FALSE
;

160 iàĞ! 
	`funùiÚ_exi¡s
('getimagesize'))

162 
$this
->
	`£t_”rÜ
('imglib_gd_required_for_props');

163  
FALSE
;

166 
$this
->
image_lib¿ry
 = 
	`¡¹Şow”
($this->image_library);

176 ià(
	`funùiÚ_exi¡s
('»®·th'è
AND
 @
	`»®·th
(
$this
->
sourû_image
è!=ğ
FALSE
)

178 
$fuÎ_sourû_·th
 = 
	`¡r_»¶aû
("\\", "/", 
	`»®·th
(
$this
->
sourû_image
));

182 
$fuÎ_sourû_·th
 = 
$this
->
sourû_image
;

185 
$x
 = 
	`ex¶ode
('/', 
$fuÎ_sourû_·th
);

186 
$this
->
sourû_image
 = 
	`’d
(
$x
);

187 
$this
->
sourû_fŞd”
 = 
	`¡r_»¶aû
($this->
sourû_image
, '', 
$fuÎ_sourû_·th
);

190 iàĞ! 
$this
->
	`g‘_image_´İ”t›s
($this->
sourû_fŞd”
.$this->
sourû_image
))

192  
FALSE
;

204 ià(
$this
->
Ãw_image
 == '')

206 
$this
->
de¡_image
 = $this->
sourû_image
;

207 
$this
->
de¡_fŞd”
 = $this->
sourû_fŞd”
;

211 ià(
	`¡½os
(
$this
->
Ãw_image
, '/'è==ğ
FALSE
 
AND
 strpos($this->new_image, '\\') === FALSE)

213 
$this
->
de¡_fŞd”
 = $this->
sourû_fŞd”
;

214 
$this
->
de¡_image
 = $this->
Ãw_image
;

218 ià(
	`funùiÚ_exi¡s
('»®·th'è
AND
 @
	`»®·th
(
$this
->
Ãw_image
è!=ğ
FALSE
)

220 
$fuÎ_de¡_·th
 = 
	`¡r_»¶aû
("\\", "/", 
	`»®·th
(
$this
->
Ãw_image
));

224 
$fuÎ_de¡_·th
 = 
$this
->
Ãw_image
;

228 iàĞ! 
	`´eg_m©ch
("#\.(jpg|j³g|gif|²g)$#i", 
$fuÎ_de¡_·th
))

230 
$this
->
de¡_fŞd”
 = 
$fuÎ_de¡_·th
.'/';

231 
$this
->
de¡_image
 = $this->
sourû_image
;

235 
$x
 = 
	`ex¶ode
('/', 
$fuÎ_de¡_·th
);

236 
$this
->
de¡_image
 = 
	`’d
(
$x
);

237 
$this
->
de¡_fŞd”
 = 
	`¡r_»¶aû
($this->
de¡_image
, '', 
$fuÎ_de¡_·th
);

252 ià(
$this
->
ü—‹_thumb
 ==ğ
FALSE
 
OR
 $this->
thumb_m¬k”
 == '')

254 
$this
->
thumb_m¬k”
 = '';

257 
$xp
 = 
$this
->
	`ex¶ode_Çme
($this->
de¡_image
);

259 
$f’ame
 = 
$xp
['name'];

260 
$fe_ext
 = 
$xp
['ext'];

262 
$this
->
fuÎ_¤c_·th
 = $this->
sourû_fŞd”
.$this->
sourû_image
;

263 
$this
->
fuÎ_d¡_·th
 = $this->
de¡_fŞd”
.
$f’ame
.$this->
thumb_m¬k”
.
$fe_ext
;

273 ià(
$this
->
mašš_¿tio
 ==ğ
TRUE
 && ($this->
width
 !ğ'' 
AND
 $this->
height
 != ''))

275 
$this
->
	`image_»´İÜtiÚ
();

286 ià(
$this
->
width
 == '')

287 
$this
->
width
 = $this->
Üig_width
;

289 ià(
$this
->
height
 == '')

290 
$this
->
height
 = $this->
Üig_height
;

293 
$this
->
qu®™y
 = 
	`Œim
(
	`¡r_»¶aû
("%", "", $this->quality));

295 ià(
$this
->
qu®™y
 =ğ'' 
OR
 $this->qu®™y =ğ0 OR ! 
	`is_num”ic
($this->quality))

296 
$this
->
qu®™y
 = 90;

299 
$this
->
x_axis
 = ($this->x_axi =ğ'' 
OR
 ! 
	`is_num”ic
($this->x_axis)) ? 0 : $this->x_axis;

300 
$this
->
y_axis
 = ($this->y_axi =ğ'' 
OR
 ! 
	`is_num”ic
($this->y_axis)) ? 0 : $this->y_axis;

303 ià(
$this
->
wm_fÚt_cŞÜ
 != '')

305 ià(
	`¡¾’
(
$this
->
wm_fÚt_cŞÜ
) == 6)

307 
$this
->
wm_fÚt_cŞÜ
 = '#'.$this->wm_font_color;

311 ià(
$this
->
wm_shadow_cŞÜ
 != '')

313 ià(
	`¡¾’
(
$this
->
wm_shadow_cŞÜ
) == 6)

315 
$this
->
wm_shadow_cŞÜ
 = '#'.$this->wm_shadow_color;

319 ià(
$this
->
wm_ov”Ïy_·th
 != '')

321 
$this
->
wm_ov”Ïy_·th
 = 
	`¡r_»¶aû
("\\", "/", 
	`»®·th
($this->wm_overlay_path));

324 ià(
$this
->
wm_shadow_cŞÜ
 != '')

326 
$this
->
wm_u£_drİ_shadow
 = 
TRUE
;

329 ià(
$this
->
wm_fÚt_·th
 != '')

331 
$this
->
wm_u£_Œu‘y³
 = 
TRUE
;

334  
TRUE
;

335 
	}
}

348 
funùiÚ
 
	$»size
()

350 
$´ÙocŞ
 = 'image_´oûss_'.
$this
->
image_lib¿ry
;

352 ià(
	`´eg_m©ch
('/gd2$/i', 
$´ÙocŞ
))

354 
$´ÙocŞ
 = 'image_process_gd';

357  
$this
->
	`$´ÙocŞ
('resize');

358 
	}
}

371 
funùiÚ
 
	$üİ
()

373 
$´ÙocŞ
 = 'image_´oûss_'.
$this
->
image_lib¿ry
;

375 ià(
	`´eg_m©ch
('/gd2$/i', 
$´ÙocŞ
))

377 
$´ÙocŞ
 = 'image_process_gd';

380  
$this
->
	`$´ÙocŞ
('crop');

381 
	}
}

394 
funùiÚ
 
	$rÙ©e
()

397 
$degs
 = 
	`¬¿y
(90, 180, 270, 'vrt', 'hor');

399 ià(
$this
->
rÙ©iÚ_ªgË
 =ğ'' 
OR
 ! 
	`š_¬¿y
($this->rÙ©iÚ_ªgË, 
$degs
))

401 
$this
->
	`£t_”rÜ
('imglib_rotation_angle_required');

402  
FALSE
;

406 ià(
$this
->
rÙ©iÚ_ªgË
 =ğ90 
OR
 $this->rotation_angle == 270)

408 
$this
->
width
 = $this->
Üig_height
;

409 
$this
->
height
 = $this->
Üig_width
;

413 
$this
->
width
 = $this->
Üig_width
;

414 
$this
->
height
 = $this->
Üig_height
;

419 ià(
$this
->
image_lib¿ry
 =ğ'imagemagick' 
OR
 $this->image_library == 'netpbm')

421 
$´ÙocŞ
 = 'image_´oûss_'.
$this
->
image_lib¿ry
;

423  
$this
->
	`$´ÙocŞ
('rotate');

426 ià(
$this
->
rÙ©iÚ_ªgË
 =ğ'hÜ' 
OR
 $this->rotation_angle == 'vrt')

428  
$this
->
	`image_mœrÜ_gd
();

432  
$this
->
	`image_rÙ©e_gd
();

434 
	}
}

447 
funùiÚ
 
image_´oûss_gd
(
$aùiÚ
 = 'resize')

449 
$v2_ov”ride
 = 
FALSE
;

453 ià(
	g$this
->
	gdyÇmic_ouut
 ==ğ
FALSE
)

455 ià(
$this
->
Üig_width
 =ğ$this->
width
 
AND
 $this->
Üig_height
 =ğ$this->
height
)

457 ià(
$this
->
sourû_image
 !ğ$this->
Ãw_image
)

459 ià(@
cİy
(
$this
->
fuÎ_¤c_·th
, $this->
fuÎ_d¡_·th
))

461 @
chmod
(
$this
->
fuÎ_d¡_·th
, 
FILE_WRITE_MODE
);

465  
	gTRUE
;

470 ià(
	g$aùiÚ
 == 'crop')

473 
$this
->
Üig_width
 = $this->
width
;

474 
	g$this
->
	gÜig_height
 = 
$this
->
height
;

477 ià(
	g$this
->
gd_v”siÚ
(è!=ğ
FALSE
)

479 
$gd_v”siÚ
 = 
¡r_»¶aû
('0', '', 
$this
->
gd_v”siÚ
());

480 
	g$v2_ov”ride
 = (
$gd_v”siÚ
 =ğ2è? 
TRUE
 : 
FALSE
;

486 
	g$this
->
	gx_axis
 = 0;

487 
	g$this
->
	gy_axis
 = 0;

491 iàĞ! (
	g$¤c_img
 = 
$this
->
image_ü—‹_gd
()))

493  
FALSE
;

503 ià(
	g$this
->
	gimage_lib¿ry
 =ğ'gd2' 
AND
 
funùiÚ_exi¡s
('imagecreatetruecolor'))

505 
$ü—‹
 = 'imagecreatetruecolor';

506 
	g$cİy
 = 'imagecopyresampled';

510 
	g$ü—‹
 = 'imagecreate';

511 
	g$cİy
 = 'imagecopyresized';

514 
	g$d¡_img
 = 
$ü—‹
(
$this
->
width
, $this->
height
);

516 ià(
	g$this
->
	gimage_ty³
 == 3)

518 
imag—ÍhabËndšg
(
$d¡_img
, 
FALSE
);

519 
image§v—Íha
(
$d¡_img
, 
TRUE
);

522 
$cİy
(
$d¡_img
, 
$¤c_img
, 0, 0, 
$this
->
x_axis
, $this->
y_axis
, $this->
width
, $this->
height
, $this->
Üig_width
, $this->
Üig_height
);

525 ià(
	g$this
->
	gdyÇmic_ouut
 =ğ
TRUE
)

527 
$this
->
image_di¥Ïy_gd
(
$d¡_img
);

532 iàĞ! 
	g$this
->
image_§ve_gd
(
$d¡_img
))

534  
	gFALSE
;

539 
imagede¡roy
(
$d¡_img
);

540 
imagede¡roy
(
$¤c_img
);

543 @
chmod
(
$this
->
fuÎ_d¡_·th
, 
FILE_WRITE_MODE
);

545  
	gTRUE
;

559 
funùiÚ
 
image_´oûss_imagemagick
(
$aùiÚ
 = 'resize')

562 ià(
$this
->
lib¿ry_·th
 == '')

564 
$this
->
£t_”rÜ
('imglib_libpath_invalid');

565  
	gFALSE
;

568 iàĞ! 
´eg_m©ch
("/cÚv”t$/i", 
$this
->
lib¿ry_·th
))

570 
	g$this
->
	glib¿ry_·th
 = 
¹rim
(
$this
->
lib¿ry_·th
, '/').'/';

572 
	g$this
->
	glib¿ry_·th
 .= 'convert';

576 
	g$cmd
 = 
$this
->
lib¿ry_·th
." -qu®™y ".$this->
qu®™y
;

578 ià(
	g$aùiÚ
 == 'crop')

580 
$cmd
 .ğ" -üİ ".
$this
->
width
."x".$this->
height
."+".$this->
x_axis
."+".$this->
y_axis
." \"$this->full_src_path\" \"$this->full_dst_path\" 2>&1";

582 
–£if
 (
$aùiÚ
 == 'rotate')

584 
$this
->
rÙ©iÚ_ªgË
)

586 'hÜ' : 
$ªgË
 = '-flop';

588 'v¹' : 
$ªgË
 = '-flip';

590  : 
$ªgË
 = '-rÙ©'.
$this
->
rÙ©iÚ_ªgË
;

594 
	g$cmd
 .ğ" ".
$ªgË
." \"$this->full_src_path\" \"$this->full_dst_path\" 2>&1";

598 
	g$cmd
 .ğ" -»siz".
$this
->
width
."x".$this->
height
." \"$this->full_src_path\" \"$this->full_dst_path\" 2>&1";

601 
	g$»tv®
 = 1;

603 @
exec
(
$cmd
, 
$ouut
, 
$»tv®
);

606 ià(
	g$»tv®
 > 0)

608 
	g$this
->
£t_”rÜ
('imglib_image_process_failed');

609  
	gFALSE
;

613 @
chmod
(
$this
->
fuÎ_d¡_·th
, 
FILE_WRITE_MODE
);

615  
	gTRUE
;

629 
funùiÚ
 
image_´oûss_Ãbm
(
$aùiÚ
 = 'resize')

631 ià(
$this
->
lib¿ry_·th
 == '')

633 
$this
->
£t_”rÜ
('imglib_libpath_invalid');

634  
	gFALSE
;

638 
	g$this
->
	gimage_ty³
)

641 
$cmd_š
 = 'giftopnm';

642 
	g$cmd_out
 = 'ppmtogif';

645 
$cmd_š
 = 'jpegtopnm';

646 
	g$cmd_out
 = 'ppmtojpeg';

649 
$cmd_š
 = 'pngtopnm';

650 
	g$cmd_out
 = 'ppmtopng';

654 ià(
	g$aùiÚ
 == 'crop')

656 
$cmd_šÃr
 = '²mcuˆ-Ëá '.
$this
->
x_axis
.' -tİ '.$this->
y_axis
.' -width '.$this->
width
.' -heighˆ'.$this->
height
;

658 
–£if
 (
$aùiÚ
 == 'rotate')

660 
$this
->
rÙ©iÚ_ªgË
)

662 90 : 
$ªgË
 = 'r270';

664 180 : 
$ªgË
 = 'r180';

666 270 : 
$ªgË
 = 'r90';

668 'v¹' : 
$ªgË
 = 'tb';

670 'hÜ' : 
$ªgË
 = 'lr';

674 
	g$cmd_šÃr
 = '²mæ -'.
$ªgË
.' ';

678 
	g$cmd_šÃr
 = '²msÿË -xysiz'.
$this
->
width
.' '.$this->
height
;

681 
	g$cmd
 = 
$this
->
lib¿ry_·th
.
$cmd_š
.' '.$this->
fuÎ_¤c_·th
.' | '.
$cmd_šÃr
.' | '.
$cmd_out
.' > '.$this->
de¡_fŞd”
.'netpbm.tmp';

683 
	g$»tv®
 = 1;

685 @
exec
(
$cmd
, 
$ouut
, 
$»tv®
);

688 ià(
	g$»tv®
 > 0)

690 
	g$this
->
£t_”rÜ
('imglib_image_process_failed');

691  
	gFALSE
;

697 
cİy
 (
$this
->
de¡_fŞd”
.'Ãbm.tmp', $this->
fuÎ_d¡_·th
);

698 
uÆšk
 (
$this
->
de¡_fŞd”
.'netpbm.tmp');

699 @
chmod
(
$this
->
fuÎ_d¡_·th
, 
FILE_WRITE_MODE
);

701  
	gTRUE
;

712 
funùiÚ
 
	$image_rÙ©e_gd
()

715 iàĞ! (
$¤c_img
 = 
$this
->
	`image_ü—‹_gd
()))

717  
FALSE
;

725 
$wh™e
 = 
	`imagecŞÜ®loÿ‹
(
$¤c_img
, 255, 255, 255);

728 
$d¡_img
 = 
	`imag”Ù©e
(
$¤c_img
, 
$this
->
rÙ©iÚ_ªgË
, 
$wh™e
);

731 ià(
$this
->
dyÇmic_ouut
 =ğ
TRUE
)

733 
$this
->
	`image_di¥Ïy_gd
(
$d¡_img
);

738 iàĞ! 
$this
->
	`image_§ve_gd
(
$d¡_img
))

740  
FALSE
;

745 
	`imagede¡roy
(
$d¡_img
);

746 
	`imagede¡roy
(
$¤c_img
);

750 @
	`chmod
(
$this
->
fuÎ_d¡_·th
, 
FILE_WRITE_MODE
);

752  
TRUE
;

753 
	}
}

765 
funùiÚ
 
	$image_mœrÜ_gd
()

767 iàĞ! 
$¤c_img
 = 
$this
->
	`image_ü—‹_gd
())

769  
FALSE
;

772 
$width
 = 
$this
->
Üig_width
;

773 
$height
 = 
$this
->
Üig_height
;

775 ià(
$this
->
rÙ©iÚ_ªgË
 == 'hor')

777 
$i
 = 0; $˜< 
$height
; $i++)

779 
$Ëá
 = 0;

780 
$right
 = 
$width
-1;

782 
$Ëá
 < 
$right
)

784 
$ş
 = 
	`imagecŞÜ©
(
$¤c_img
, 
$Ëá
, 
$i
);

785 
$ü
 = 
	`imagecŞÜ©
(
$¤c_img
, 
$right
, 
$i
);

787 
	`image£ix–
(
$¤c_img
, 
$Ëá
, 
$i
, 
$ü
);

788 
	`image£ix–
(
$¤c_img
, 
$right
, 
$i
, 
$ş
);

790 
$Ëá
++;

791 
$right
--;

797 
$i
 = 0; $˜< 
$width
; $i++)

799 
$tİ
 = 0;

800 
$bÙ
 = 
$height
-1;

802 
$tİ
 < 
$bÙ
)

804 
$ù
 = 
	`imagecŞÜ©
(
$¤c_img
, 
$i
, 
$tİ
);

805 
$cb
 = 
	`imagecŞÜ©
(
$¤c_img
, 
$i
, 
$bÙ
);

807 
	`image£ix–
(
$¤c_img
, 
$i
, 
$tİ
, 
$cb
);

808 
	`image£ix–
(
$¤c_img
, 
$i
, 
$bÙ
, 
$ù
);

810 
$tİ
++;

811 
$bÙ
--;

817 ià(
$this
->
dyÇmic_ouut
 =ğ
TRUE
)

819 
$this
->
	`image_di¥Ïy_gd
(
$¤c_img
);

824 iàĞ! 
$this
->
	`image_§ve_gd
(
$¤c_img
))

826  
FALSE
;

831 
	`imagede¡roy
(
$¤c_img
);

834 @
	`chmod
(
$this
->
fuÎ_d¡_·th
, 
FILE_WRITE_MODE
);

836  
TRUE
;

837 
	}
}

851 
funùiÚ
 
	$w©”m¬k
()

853 ià(
$this
->
wm_ty³
 == 'overlay')

855  
$this
->
	`ov”Ïy_w©”m¬k
();

859  
$this
->
	`‹xt_w©”m¬k
();

861 
	}
}

871 
funùiÚ
 
	$ov”Ïy_w©”m¬k
()

873 iàĞ! 
	`funùiÚ_exi¡s
('imagecolortransparent'))

875 
$this
->
	`£t_”rÜ
('imglib_gd_required');

876  
FALSE
;

880 
$this
->
	`g‘_image_´İ”t›s
();

883 
$´İs
 = 
$this
->
	`g‘_image_´İ”t›s
($this->
wm_ov”Ïy_·th
, 
TRUE
);

884 
$wm_img_ty³
 = 
$´İs
['image_type'];

885 
$wm_width
 = 
$´İs
['width'];

886 
$wm_height
 = 
$´İs
['height'];

889 
$wm_img
 = 
$this
->
	`image_ü—‹_gd
($this->
wm_ov”Ïy_·th
, 
$wm_img_ty³
);

890 
$¤c_img
 = 
$this
->
	`image_ü—‹_gd
($this->
fuÎ_¤c_·th
);

899 
$this
->
wm_v¹_®ignm’t
 = 
	`¡¹ouµ”
(
	`sub¡r
($this->wm_vrt_alignment, 0, 1));

900 
$this
->
wm_hÜ_®ignm’t
 = 
	`¡¹ouµ”
(
	`sub¡r
($this->wm_hor_alignment, 0, 1));

902 ià(
$this
->
wm_v¹_®ignm’t
 == 'B')

903 
$this
->
wm_v¹_off£t
 = $this->wm_vrt_offset * -1;

905 ià(
$this
->
wm_hÜ_®ignm’t
 == 'R')

906 
$this
->
wm_hÜ_off£t
 = $this->wm_hor_offset * -1;

909 
$x_axis
 = 
$this
->
wm_hÜ_off£t
 + $this->
wm_·ddšg
;

910 
$y_axis
 = 
$this
->
wm_v¹_off£t
 + $this->
wm_·ddšg
;

913 
$this
->
wm_v¹_®ignm’t
)

917 'M': 
$y_axis
 +ğ(
$this
->
Üig_height
 / 2è- (
$wm_height
 / 2);

919 'B': 
$y_axis
 +ğ
$this
->
Üig_height
 - 
$wm_height
;

924 
$this
->
wm_hÜ_®ignm’t
)

928 'C': 
$x_axis
 +ğ(
$this
->
Üig_width
 / 2è- (
$wm_width
 / 2);

930 'R': 
$x_axis
 +ğ
$this
->
Üig_width
 - 
$wm_width
;

935 ià(
$wm_img_ty³
 =ğ3 
AND
 
	`funùiÚ_exi¡s
('imagealphablending'))

937 @
	`imag—ÍhabËndšg
(
$¤c_img
, 
TRUE
);

941 
$rgba
 = 
	`imagecŞÜ©
(
$wm_img
, 
$this
->
wm_x_Œª¥
, $this->
wm_y_Œª¥
);

942 
$®pha
 = (
$rgba
 & 0x7F000000) >> 24;

945 ià(
$®pha
 > 0)

948 
	`imagecİy
(
$¤c_img
, 
$wm_img
, 
$x_axis
, 
$y_axis
, 0, 0, 
$wm_width
, 
$wm_height
);

953 
	`imagecŞÜŒª¥¬’t
(
$wm_img
, 
	`imagecŞÜ©
($wm_img, 
$this
->
wm_x_Œª¥
, $this->
wm_y_Œª¥
));

954 
	`imagecİym”ge
(
$¤c_img
, 
$wm_img
, 
$x_axis
, 
$y_axis
, 0, 0, 
$wm_width
, 
$wm_height
, 
$this
->
wm_İac™y
);

958 ià(
$this
->
dyÇmic_ouut
 =ğ
TRUE
)

960 
$this
->
	`image_di¥Ïy_gd
(
$¤c_img
);

964 iàĞ! 
$this
->
	`image_§ve_gd
(
$¤c_img
))

966  
FALSE
;

970 
	`imagede¡roy
(
$¤c_img
);

971 
	`imagede¡roy
(
$wm_img
);

973  
TRUE
;

974 
	}
}

984 
funùiÚ
 
	$‹xt_w©”m¬k
()

986 iàĞ! (
$¤c_img
 = 
$this
->
	`image_ü—‹_gd
()))

988  
FALSE
;

991 ià(
$this
->
wm_u£_Œu‘y³
 =ğ
TRUE
 
AND
 ! 
	`fe_exi¡s
($this->
wm_fÚt_·th
))

993 
$this
->
	`£t_”rÜ
('imglib_missing_font');

994  
FALSE
;

998 
$this
->
	`g‘_image_´İ”t›s
();

1001 
$this
->
wm_fÚt_cŞÜ
 = 
	`¡r_»¶aû
('#', '', $this->wm_font_color);

1002 
$this
->
wm_shadow_cŞÜ
 = 
	`¡r_»¶aû
('#', '', $this->wm_shadow_color);

1004 
$R1
 = 
	`hexdec
(
	`sub¡r
(
$this
->
wm_fÚt_cŞÜ
, 0, 2));

1005 
$G1
 = 
	`hexdec
(
	`sub¡r
(
$this
->
wm_fÚt_cŞÜ
, 2, 2));

1006 
$B1
 = 
	`hexdec
(
	`sub¡r
(
$this
->
wm_fÚt_cŞÜ
, 4, 2));

1008 
$R2
 = 
	`hexdec
(
	`sub¡r
(
$this
->
wm_shadow_cŞÜ
, 0, 2));

1009 
$G2
 = 
	`hexdec
(
	`sub¡r
(
$this
->
wm_shadow_cŞÜ
, 2, 2));

1010 
$B2
 = 
	`hexdec
(
	`sub¡r
(
$this
->
wm_shadow_cŞÜ
, 4, 2));

1012 
$txt_cŞÜ
 = 
	`imagecŞÜşo£¡
(
$¤c_img
, 
$R1
, 
$G1
, 
$B1
);

1013 
$d½_cŞÜ
 = 
	`imagecŞÜşo£¡
(
$¤c_img
, 
$R2
, 
$G2
, 
$B2
);

1022 ià(
$this
->
wm_v¹_®ignm’t
 == 'B')

1023 
$this
->
wm_v¹_off£t
 = $this->wm_vrt_offset * -1;

1025 ià(
$this
->
wm_hÜ_®ignm’t
 == 'R')

1026 
$this
->
wm_hÜ_off£t
 = $this->wm_hor_offset * -1;

1031 ià(
$this
->
wm_u£_Œu‘y³
 =ğ
TRUE
)

1033 ià(
$this
->
wm_fÚt_size
 == '')

1034 
$this
->
wm_fÚt_size
 = '17';

1036 
$fÚtwidth
 = 
$this
->
wm_fÚt_size
-($this->wm_font_size/4);

1037 
$fÚtheight
 = 
$this
->
wm_fÚt_size
;

1038 
$this
->
wm_v¹_off£t
 +ğ$this->
wm_fÚt_size
;

1042 
$fÚtwidth
 = 
	`imagefÚtwidth
(
$this
->
wm_fÚt_size
);

1043 
$fÚtheight
 = 
	`imagefÚtheight
(
$this
->
wm_fÚt_size
);

1047 
$x_axis
 = 
$this
->
wm_hÜ_off£t
 + $this->
wm_·ddšg
;

1048 
$y_axis
 = 
$this
->
wm_v¹_off£t
 + $this->
wm_·ddšg
;

1051 ià(
$this
->
wm_u£_drİ_shadow
 =ğ
FALSE
)

1052 
$this
->
wm_shadow_di¡ªû
 = 0;

1054 
$this
->
wm_v¹_®ignm’t
 = 
	`¡¹ouµ”
(
	`sub¡r
($this->wm_vrt_alignment, 0, 1));

1055 
$this
->
wm_hÜ_®ignm’t
 = 
	`¡¹ouµ”
(
	`sub¡r
($this->wm_hor_alignment, 0, 1));

1057 
$this
->
wm_v¹_®ignm’t
)

1061 "M": 
$y_axis
 +ğ(
$this
->
Üig_height
/2)+(
$fÚtheight
/2);

1063 "B": 
$y_axis
 +ğ(
$this
->
Üig_height
 - 
$fÚtheight
 - $this->
wm_shadow_di¡ªû
 - ($fontheight/2));

1067 
$x_shad
 = 
$x_axis
 + 
$this
->
wm_shadow_di¡ªû
;

1068 
$y_shad
 = 
$y_axis
 + 
$this
->
wm_shadow_di¡ªû
;

1071 
$this
->
wm_hÜ_®ignm’t
)

1076 ià(
$this
->
wm_u£_drİ_shadow
)

1077 
$x_shad
 +ğ(
$this
->
Üig_width
 - 
$fÚtwidth
*
	`¡¾’
($this->
wm_‹xt
));

1078 
$x_axis
 +ğ(
$this
->
Üig_width
 - 
$fÚtwidth
*
	`¡¾’
($this->
wm_‹xt
));

1081 ià(
$this
->
wm_u£_drİ_shadow
)

1082 
$x_shad
 +ğ
	`æoÜ
((
$this
->
Üig_width
 - 
$fÚtwidth
*
	`¡¾’
($this->
wm_‹xt
))/2);

1083 
$x_axis
 +ğ
	`æoÜ
((
$this
->
Üig_width
 -
$fÚtwidth
*
	`¡¾’
($this->
wm_‹xt
))/2);

1088 ià(
$this
->
wm_u£_Œu‘y³
)

1090 ià(
$this
->
wm_u£_drİ_shadow
)

1091 
	`imag‘táext
(
$¤c_img
, 
$this
->
wm_fÚt_size
, 0, 
$x_shad
, 
$y_shad
, 
$d½_cŞÜ
, $this->
wm_fÚt_·th
, $this->
wm_‹xt
);

1092 
	`imag‘táext
(
$¤c_img
, 
$this
->
wm_fÚt_size
, 0, 
$x_axis
, 
$y_axis
, 
$txt_cŞÜ
, $this->
wm_fÚt_·th
, $this->
wm_‹xt
);

1096 ià(
$this
->
wm_u£_drİ_shadow
)

1097 
	`image¡ršg
(
$¤c_img
, 
$this
->
wm_fÚt_size
, 
$x_shad
, 
$y_shad
, $this->
wm_‹xt
, 
$d½_cŞÜ
);

1098 
	`image¡ršg
(
$¤c_img
, 
$this
->
wm_fÚt_size
, 
$x_axis
, 
$y_axis
, $this->
wm_‹xt
, 
$txt_cŞÜ
);

1102 ià(
$this
->
dyÇmic_ouut
 =ğ
TRUE
)

1104 
$this
->
	`image_di¥Ïy_gd
(
$¤c_img
);

1108 
$this
->
	`image_§ve_gd
(
$¤c_img
);

1111 
	`imagede¡roy
(
$¤c_img
);

1113  
TRUE
;

1114 
	}
}

1128 
funùiÚ
 
image_ü—‹_gd
(
$·th
 = '', 
$image_ty³
 = '')

1130 ià(
$·th
 == '')

1131 
$·th
 = 
$this
->
fuÎ_¤c_·th
;

1133 ià(
	g$image_ty³
 == '')

1134 
$image_ty³
 = 
$this
->
image_ty³
;

1137 
	g$image_ty³
)

1140 iàĞ! 
funùiÚ_exi¡s
('imagecreatefromgif'))

1142 
$this
->
£t_”rÜ
(
¬¿y
('imglib_unsupported_imagecreate', 'imglib_gif_not_supported'));

1143  
	gFALSE
;

1146  
imageü—‹äomgif
(
$·th
);

1149 iàĞ! 
funùiÚ_exi¡s
('imagecreatefromjpeg'))

1151 
$this
->
£t_”rÜ
(
¬¿y
('imglib_unsupported_imagecreate', 'imglib_jpg_not_supported'));

1152  
	gFALSE
;

1155  
imageü—‹äomj³g
(
$·th
);

1158 iàĞ! 
funùiÚ_exi¡s
('imagecreatefrompng'))

1160 
$this
->
£t_”rÜ
(
¬¿y
('imglib_unsupported_imagecreate', 'imglib_png_not_supported'));

1161  
	gFALSE
;

1164  
imageü—‹äom²g
(
$·th
);

1169 
	g$this
->
£t_”rÜ
(
¬¿y
('imglib_unsupported_imagecreate'));

1170  
	gFALSE
;

1185 
funùiÚ
 
	$image_§ve_gd
(
$»sourû
)

1187 
$this
->
image_ty³
)

1190 iàĞ! 
	`funùiÚ_exi¡s
('imagegif'))

1192 
$this
->
	`£t_”rÜ
(
	`¬¿y
('imglib_unsupported_imagecreate', 'imglib_gif_not_supported'));

1193  
FALSE
;

1196 iàĞ! @
	`imagegif
(
$»sourû
, 
$this
->
fuÎ_d¡_·th
))

1198 
$this
->
	`£t_”rÜ
('imglib_save_failed');

1199  
FALSE
;

1203 iàĞ! 
	`funùiÚ_exi¡s
('imagejpeg'))

1205 
$this
->
	`£t_”rÜ
(
	`¬¿y
('imglib_unsupported_imagecreate', 'imglib_jpg_not_supported'));

1206  
FALSE
;

1209 iàĞ! @
	`imagej³g
(
$»sourû
, 
$this
->
fuÎ_d¡_·th
, $this->
qu®™y
))

1211 
$this
->
	`£t_”rÜ
('imglib_save_failed');

1212  
FALSE
;

1216 iàĞ! 
	`funùiÚ_exi¡s
('imagepng'))

1218 
$this
->
	`£t_”rÜ
(
	`¬¿y
('imglib_unsupported_imagecreate', 'imglib_png_not_supported'));

1219  
FALSE
;

1222 iàĞ! @
	`imag•ng
(
$»sourû
, 
$this
->
fuÎ_d¡_·th
))

1224 
$this
->
	`£t_”rÜ
('imglib_save_failed');

1225  
FALSE
;

1229 
$this
->
	`£t_”rÜ
(
	`¬¿y
('imglib_unsupported_imagecreate'));

1230  
FALSE
;

1234  
TRUE
;

1235 
	}
}

1246 
funùiÚ
 
	$image_di¥Ïy_gd
(
$»sourû
)

1248 
	`h—d”
("Content-Disposition: filename={$this->source_image};");

1249 
	`h—d”
("Content-Type: {$this->mime_type}");

1250 
	`h—d”
('Content-Transfer-Encoding: binary');

1251 
	`h—d”
('La¡-Modif›d: '.
	`gmd©e
('D, d M Y H:i:s', 
	`time
()).' GMT');

1253 
$this
->
image_ty³
)

1255 1 : 
	`imagegif
(
$»sourû
);

1257 2 : 
	`imagej³g
(
$»sourû
, '', 
$this
->
qu®™y
);

1259 3 : 
	`imag•ng
(
$»sourû
);

1261  : 
echo
 'Unableo displayhe image';

1264 
	}
}

1281 
funùiÚ
 
	$image_»´İÜtiÚ
()

1283 iàĞ! 
	`is_num”ic
(
$this
->
width
è
OR
 ! is_num”ic($this->
height
) OR $this->width == 0 OR $this->height == 0)

1286 iàĞ! 
	`is_num”ic
(
$this
->
Üig_width
è
OR
 ! is_num”ic($this->
Üig_height
) OR $this->orig_width == 0 OR $this->orig_height == 0)

1289 
$Ãw_width
 = 
	`û
(
$this
->
Üig_width
*$this->
height
/$this->
Üig_height
);

1290 
$Ãw_height
 = 
	`û
(
$this
->
width
*$this->
Üig_height
/$this->
Üig_width
);

1292 
$¿tio
 = ((
$this
->
Üig_height
/$this->
Üig_width
è- ($this->
height
/$this->
width
));

1294 ià(
$this
->
ma¡”_dim
 !ğ'width' 
AND
 $this->master_dim != 'height')

1296 
$this
->
ma¡”_dim
 = (
$¿tio
 < 0) ? 'width' : 'height';

1299 ià((
$this
->
width
 !ğ
$Ãw_width
è
	`AND
 ($this->
height
 !ğ
$Ãw_height
))

1301 ià(
$this
->
ma¡”_dim
 == 'height')

1303 
$this
->
width
 = 
$Ãw_width
;

1307 
$this
->
height
 = 
$Ãw_height
;

1310 
	}
}

1323 
funùiÚ
 
g‘_image_´İ”t›s
(
$·th
 = '', 
$»tuº
 = 
FALSE
)

1328 ià(
$·th
 == '')

1329 
$·th
 = 
$this
->
fuÎ_¤c_·th
;

1331 iàĞ! 
fe_exi¡s
(
$·th
))

1333 
	g$this
->
£t_”rÜ
('imglib_invalid_path');

1334  
	gFALSE
;

1337 
	g$v®s
 = @
g‘imagesize
(
$·th
);

1339 
	g$ty³s
 = 
¬¿y
(1 => 'gif', 2 => 'jpeg', 3 => 'png');

1341 
	g$mime
 = (
is£t
(
$ty³s
[
$v®s
['2']])) ? 'image/'.$types[$vals['2']] : 'image/jpg';

1343 ià(
	g$»tuº
 =ğ
TRUE
)

1345 
$v
['width'] = 
$v®s
['0'];

1346 
	g$v
['height'] = 
$v®s
['1'];

1347 
	g$v
['image_ty³'] = 
$v®s
['2'];

1348 
	g$v
['size_¡r'] = 
$v®s
['3'];

1349 
	g$v
['mime_ty³'] = 
$mime
;

1351  
	g$v
;

1354 
	g$this
->
	gÜig_width
 = 
$v®s
['0'];

1355 
	g$this
->
	gÜig_height
 = 
$v®s
['1'];

1356 
	g$this
->
	gimage_ty³
 = 
$v®s
['2'];

1357 
	g$this
->
	gsize_¡r
 = 
$v®s
['3'];

1358 
	g$this
->
	gmime_ty³
 = 
$mime
;

1360  
	gTRUE
;

1383 
funùiÚ
 
	$size_ÿlcuÏtÜ
(
$v®s
)

1385 iàĞ! 
	`is_¬¿y
(
$v®s
))

1390 
$®lowed
 = 
	`¬¿y
('new_width', 'new_height', 'width', 'height');

1392 
	`fÜ—ch
 (
$®lowed
 
as
 
$™em
)

1394 iàĞ! 
	`is£t
(
$v®s
[
$™em
]è
OR
 $vals[$item] == '')

1395 
$v®s
[
$™em
] = 0;

1398 ià(
$v®s
['width'] =ğ0 
OR
 $vals['height'] == 0)

1400  
$v®s
;

1403 ià(
$v®s
['new_width'] == 0)

1405 
$v®s
['Ãw_width'] = 
	`û
($vals['width']*$vals['new_height']/$vals['height']);

1407 
	`–£if
 (
$v®s
['new_height'] == 0)

1409 
$v®s
['Ãw_height'] = 
	`û
($vals['new_width']*$vals['height']/$vals['width']);

1412  
$v®s
;

1413 
	}
}

1431 
funùiÚ
 
	$ex¶ode_Çme
(
$sourû_image
)

1433 
$ext
 = 
	`¡¼chr
(
$sourû_image
, '.');

1434 
$Çme
 = (
$ext
 ==ğ
FALSE
è? 
$sourû_image
 : 
	`sub¡r
($sourû_image, 0, -
	`¡¾’
($ext));

1436  
	`¬¿y
('ext' => 
$ext
, 'Çme' => 
$Çme
);

1437 
	}
}

1447 
funùiÚ
 
	$gd_lßded
()

1449 iàĞ! 
	`ex‹nsiÚ_lßded
('gd'))

1451 iàĞ! 
	`dl
('gd.so'))

1453  
FALSE
;

1457  
TRUE
;

1458 
	}
}

1468 
funùiÚ
 
	$gd_v”siÚ
()

1470 ià(
	`funùiÚ_exi¡s
('gd_info'))

1472 
$gd_v”siÚ
 = @
	`gd_šfo
();

1473 
$gd_v”siÚ
 = 
	`´eg_»¶aû
("/\D/", "", $gd_version['GD Version']);

1475  
$gd_v”siÚ
;

1478  
FALSE
;

1479 
	}
}

1490 
funùiÚ
 
	$£t_”rÜ
(
$msg
)

1492 
$CI
 =& 
	`g‘_š¡ªû
();

1493 
$CI
->
Ïng
->
	`lßd
('imglib');

1495 ià(
	`is_¬¿y
(
$msg
))

1497 
	`fÜ—ch
 (
$msg
 
as
 
$v®
)

1500 
$msg
 = (
$CI
->
Ïng
->
	`lše
(
$v®
è=ğ
FALSE
) ? $val : $CI->lang->line($val);

1501 
$this
->
”rÜ_msg
[] = 
$msg
;

1502 
	`log_mes§ge
('”rÜ', 
$msg
);

1507 
$msg
 = (
$CI
->
Ïng
->
	`lše
($msgè=ğ
FALSE
) ? $msg : $CI->lang->line($msg);

1508 
$this
->
”rÜ_msg
[] = 
$msg
;

1509 
	`log_mes§ge
('”rÜ', 
$msg
);

1511 
	}
}

1522 
funùiÚ
 
di¥Ïy_”rÜs
(
$İ’
 = '<p>', 
$şo£
 = '</p>')

1524 
$¡r
 = '';

1525 
fÜ—ch
 (
$this
->
”rÜ_msg
 
as
 
$v®
)

1527 
	g$¡r
 .ğ
$İ’
.
$v®
.
$şo£
;

1530  
	g$¡r
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Javascript.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Javasüt
 {

29 
v¬
 
	m$_javasüt_loÿtiÚ
 = 'js';

31 
public
 
funùiÚ
 
__cÚ¡ruù
(
$·¿ms
 = 
	$¬¿y
())

33 
$deçuÉs
 = 
	`¬¿y
('js_lib¿ry_driv”' => 'jqu”y', 'autŞßd' => 
TRUE
);

35 
	`fÜ—ch
 (
$deçuÉs
 
as
 
$key
 => 
$v®
)

37 ià(
	`is£t
(
$·¿ms
[
$key
]) && $params[$key] !== "")

39 
$deçuÉs
[
$key
] = 
$·¿ms
[$key];

43 
	`exŒaù
(
$deçuÉs
);

45 
$this
->
CI
 =& 
	`g‘_š¡ªû
();

48 
$this
->
CI
->
lßd
->
	`lib¿ry
('javasüt/'.
$js_lib¿ry_driv”
, 
	`¬¿y
('autŞßd' => 
$autŞßd
));

50 
$this
->
js
 =& $this->
CI
->
$js_lib¿ry_driv”
;

52 
	`log_mes§ge
('debug', "Javascript Class Initialized‡nd†oaded. Driver used: $js_library_driver");

69 
funùiÚ
 
	`blur
(
$–em’t
 = 'this', 
$js
 = '')

71  
$this
->
js
->
	`_blur
(
$–em’t
, 
$js
);

72 
	}
}

86 
funùiÚ
 
chªge
(
$–em’t
 = 'this', 
$js
 = '')

88  
$this
->
js
->
_chªge
(
$–em’t
, 
$js
);

104 
funùiÚ
 
şick
(
$–em’t
 = 'this', 
$js
 = '', 
$»t_çl£
 = 
TRUE
)

106  
$this
->
js
->
_şick
(
$–em’t
, 
$js
, 
$»t_çl£
);

121 
funùiÚ
 
dblşick
(
$–em’t
 = 'this', 
$js
 = '')

123  
$this
->
js
->
_dblşick
(
$–em’t
, 
$js
);

138 
funùiÚ
 
”rÜ
(
$–em’t
 = 'this', 
$js
 = '')

140  
$this
->
js
->
_”rÜ
(
$–em’t
, 
$js
);

155 
funùiÚ
 
focus
(
$–em’t
 = 'this', 
$js
 = '')

157  
$this
->
js
->
__add_ev’t
(
$focus
, 
$js
);

173 
funùiÚ
 
hov”
(
$–em’t
 = 'this', 
$ov”
, 
$out
)

175  
	g$this
->
	gjs
->
__hov”
(
$–em’t
, 
$ov”
, 
$out
);

190 
funùiÚ
 
keydown
(
$–em’t
 = 'this', 
$js
 = '')

192  
$this
->
js
->
_keydown
(
$–em’t
, 
$js
);

207 
funùiÚ
 
keyup
(
$–em’t
 = 'this', 
$js
 = '')

209  
$this
->
js
->
_keyup
(
$–em’t
, 
$js
);

224 
funùiÚ
 
lßd
(
$–em’t
 = 'this', 
$js
 = '')

226  
$this
->
js
->
_lßd
(
$–em’t
, 
$js
);

241 
funùiÚ
 
mou£down
(
$–em’t
 = 'this', 
$js
 = '')

243  
$this
->
js
->
_mou£down
(
$–em’t
, 
$js
);

258 
funùiÚ
 
mou£out
(
$–em’t
 = 'this', 
$js
 = '')

260  
$this
->
js
->
_mou£out
(
$–em’t
, 
$js
);

275 
funùiÚ
 
mou£ov”
(
$–em’t
 = 'this', 
$js
 = '')

277  
$this
->
js
->
_mou£ov”
(
$–em’t
, 
$js
);

292 
funùiÚ
 
mou£up
(
$–em’t
 = 'this', 
$js
 = '')

294  
$this
->
js
->
_mou£up
(
$–em’t
, 
$js
);

308 
funùiÚ
 
	$ouut
(
$js
)

310  
$this
->
js
->
	`_ouut
(
$js
);

311 
	}
}

325 
funùiÚ
 
	$»ady
(
$js
)

327  
$this
->
js
->
	`_docum’t_»ady
(
$js
);

328 
	}
}

342 
funùiÚ
 
»size
(
$–em’t
 = 'this', 
$js
 = '')

344  
$this
->
js
->
_»size
(
$–em’t
, 
$js
);

359 
funùiÚ
 
süŞl
(
$–em’t
 = 'this', 
$js
 = '')

361  
$this
->
js
->
_süŞl
(
$–em’t
, 
$js
);

376 
funùiÚ
 
uÆßd
(
$–em’t
 = 'this', 
$js
 = '')

378  
$this
->
js
->
_uÆßd
(
$–em’t
, 
$js
);

396 
funùiÚ
 
addCÏss
(
$–em’t
 = 'this', 
$şass
 = '')

398  
$this
->
js
->
_addCÏss
(
$–em’t
, 
$şass
);

414 
funùiÚ
 
ªim©e
(
$–em’t
 = 'this', 
$·¿ms
 = 
¬¿y
(), 
$¥“d
 = '', 
$exŒa
 = '')

416  
$this
->
js
->
_ªim©e
(
$–em’t
, 
$·¿ms
, 
$¥“d
, 
$exŒa
);

432 
funùiÚ
 
çdeIn
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

434  
$this
->
js
->
_çdeIn
(
$–em’t
, 
$¥“d
, 
$ÿÎback
);

450 
funùiÚ
 
çdeOut
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

452  
$this
->
js
->
_çdeOut
(
$–em’t
, 
$¥“d
, 
$ÿÎback
);

467 
funùiÚ
 
¦ideUp
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

469  
$this
->
js
->
_¦ideUp
(
$–em’t
, 
$¥“d
, 
$ÿÎback
);

485 
funùiÚ
 
»moveCÏss
(
$–em’t
 = 'this', 
$şass
 = '')

487  
$this
->
js
->
_»moveCÏss
(
$–em’t
, 
$şass
);

503 
funùiÚ
 
¦ideDown
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

505  
$this
->
js
->
_¦ideDown
(
$–em’t
, 
$¥“d
, 
$ÿÎback
);

521 
funùiÚ
 
¦ideToggË
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

523  
$this
->
js
->
_¦ideToggË
(
$–em’t
, 
$¥“d
, 
$ÿÎback
);

540 
funùiÚ
 
hide
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

542  
$this
->
js
->
_hide
(
$–em’t
, 
$¥“d
, 
$ÿÎback
);

556 
funùiÚ
 
toggË
(
$–em’t
 = 'this')

558  
$this
->
js
->
_toggË
(
$–em’t
);

573 
funùiÚ
 
toggËCÏss
(
$–em’t
 = 'this', 
$şass
='')

575  
$this
->
js
->
_toggËCÏss
(
$–em’t
, 
$şass
);

591 
funùiÚ
 
show
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

593  
$this
->
js
->
_show
(
$–em’t
, 
$¥“d
, 
$ÿÎback
);

608 
funùiÚ
 
compe
(
$v›w_v¬
 = 'süt_foÙ', 
$süt_gs
 = 
TRUE
)

610 
$this
->
js
->
_compe
(
$v›w_v¬
, 
$süt_gs
);

621 
funùiÚ
 
	$ş—r_compe
()

623 
$this
->
js
->
	`_ş—r_compe
();

624 
	}
}

637 
funùiÚ
 
ex‹º®
(
$ex‹º®_fe
 = '', 
$»Ïtive
 = 
FALSE
)

639 ià(
$ex‹º®_fe
 !== '')

641 
$this
->
_javasüt_loÿtiÚ
 = 
$ex‹º®_fe
;

645 ià(
	g$this
->
	gCI
->
	gcÚfig
->
™em
('javascript_location') != '')

647 
$this
->
_javasüt_loÿtiÚ
 = $this->
CI
->
cÚfig
->
™em
('javascript_location');

651 ià(
	g$»Ïtive
 ==ğ
TRUE
 
OR
 
¡ºcmp
(
$ex‹º®_fe
, 'http://', 7) == 0 OR strncmp($external_file, 'https://', 8) == 0)

653 
$¡r
 = 
$this
->
_İ’_süt
(
$ex‹º®_fe
);

655 
–£if
 (
¡½os
(
$this
->
_javasüt_loÿtiÚ
, 'h‰p://'è!=ğ
FALSE
)

657 
$¡r
 = 
$this
->
_İ’_süt
($this->
_javasüt_loÿtiÚ
.
$ex‹º®_fe
);

661 
	g$¡r
 = 
$this
->
_İ’_süt
($this->
CI
->
cÚfig
->
¦ash_™em
('ba£_u¾').$this->
_javasüt_loÿtiÚ
.
$ex‹º®_fe
);

664 
	g$¡r
 .ğ
$this
->
_şo£_süt
();

665  
	g$¡r
;

680 
funùiÚ
 
	$šlše
(
$süt
, 
$cd©a
 = 
TRUE
)

682 
$¡r
 = 
$this
->
	`_İ’_süt
();

683 
$¡r
 .ğ(
$cd©a
) ? "\n// <![CDATA[\n{$script}\n// ]]>\n" : "\n{$script}\n";

684 
$¡r
 .ğ
$this
->
	`_şo£_süt
();

686  
$¡r
;

687 
	}
}

700 
funùiÚ
 
_İ’_süt
(
$¤c
 = '')

702 
$¡r
 = '<süˆty³="‹xt/javasüt" ch¬£t="'.
¡¹Şow”
(
$this
->
CI
->
cÚfig
->
™em
('charset')).'"';

703 
	g$¡r
 .ğ(
$¤c
 == '') ? '>' : ' src="'.$src.'">';

704  
	g$¡r
;

718 
funùiÚ
 
_şo£_süt
(
$exŒa
 = "\n")

741 
funùiÚ
 
upd©e
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

743  
$this
->
js
->
_upd©”
(
$–em’t
, 
$¥“d
, 
$ÿÎback
);

757 
funùiÚ
 
	$g’”©e_jsÚ
(
$»suÉ
 = 
NULL
, 
$m©ch_¬¿y_ty³
 = 
FALSE
)

761 iàĞ! 
	`is_nuÎ
(
$»suÉ
))

763 ià(
	`is_objeù
(
$»suÉ
))

765 
$jsÚ_»suÉ
 = 
$»suÉ
->
	`»suÉ_¬¿y
();

767 
	`–£if
 (
	`is_¬¿y
(
$»suÉ
))

769 
$jsÚ_»suÉ
 = 
$»suÉ
;

773  
$this
->
	`_´•_¬gs
(
$»suÉ
);

781 
$jsÚ
 = 
	`¬¿y
();

782 
$_is_assoc
 = 
TRUE
;

784 iàĞ! 
	`is_¬¿y
(
$jsÚ_»suÉ
è
AND
 
	`em±y
($json_result))

786 
	`show_”rÜ
("Generate JSON Failed - Illegal key, value…air.");

788 
	`–£if
 (
$m©ch_¬¿y_ty³
)

790 
$_is_assoc
 = 
$this
->
	`_is_assocŸtive_¬¿y
(
$jsÚ_»suÉ
);

793 
	`fÜ—ch
 (
$jsÚ_»suÉ
 
as
 
$k
 => 
$v
)

795 ià(
$_is_assoc
)

797 
$jsÚ
[] = 
$this
->
	`_´•_¬gs
(
$k
, 
TRUE
).':'.$this->
	`g’”©e_jsÚ
(
$v
, 
$m©ch_¬¿y_ty³
);

801 
$jsÚ
[] = 
$this
->
	`g’”©e_jsÚ
(
$v
, 
$m©ch_¬¿y_ty³
);

805 
$jsÚ
 = 
	`im¶ode
(',', $json);

807  
$_is_assoc
 ? "{".
$jsÚ
."}" : "[".$json."]";

809 
	}
}

822 
funùiÚ
 
	$_is_assocŸtive_¬¿y
(
$¬r
)

824 
	`fÜ—ch
 (
	`¬¿y_keys
(
$¬r
è
as
 
$key
 => 
$v®
)

826 ià(
$key
 !=ğ
$v®
)

828  
TRUE
;

832  
FALSE
;

833 
	}
}

846 
funùiÚ
 
	$_´•_¬gs
(
$»suÉ
, 
$is_key
 = 
FALSE
)

848 ià(
	`is_nuÎ
(
$»suÉ
))

852 
	`–£if
 (
	`is_boŞ
(
$»suÉ
))

854  (
$»suÉ
 ==ğ
TRUE
) ? 'true' : 'false';

856 
	`–£if
 (
	`is_¡ršg
(
$»suÉ
è
OR
 
$is_key
)

858  '"'.
	`¡r_»¶aû
(
	`¬¿y
('\\', "\t", "\n", "\r", '"', '/'),‡¼ay('\\\\', '\\t', '\\n', "\\r", '\"', '\/'), 
$»suÉ
).'"';

860 
	`–£if
 (
	`is_sÿÏr
(
$»suÉ
))

862  
$»suÉ
;

864 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Log.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Log
 {

29 
´Ùeùed
 
	m$_log_·th
;

30 
´Ùeùed
 
	m$_th»shŞd
 = 1;

31 
´Ùeùed
 
	m$_d©e_fmt
 = 'Y-m-d H:i:s';

32 
´Ùeùed
 
	m$_’abËd
 = 
TRUE
;

33 
´Ùeùed
 
	m$_Ëv–s
 = 
¬¿y
('ERROR' => '1', 'DEBUG' => '2', 'INFO' => '3', 'ALL' => '4');

38 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

40 
$cÚfig
 =& 
	`g‘_cÚfig
();

42 
$this
->
_log_·th
 = (
$cÚfig
['log_·th'] !ğ''è? $cÚfig['log_·th'] : 
APPPATH
.'logs/';

44 iàĞ! 
	`is_dœ
(
$this
->
_log_·th
è
OR
 ! 
	`is_»®ly_wr™abË
($this->_log_path))

46 
$this
->
_’abËd
 = 
FALSE
;

49 ià(
	`is_num”ic
(
$cÚfig
['log_threshold']))

51 
$this
->
_th»shŞd
 = 
$cÚfig
['log_threshold'];

54 ià(
$cÚfig
['log_date_format'] != '')

56 
$this
->
_d©e_fmt
 = 
$cÚfig
['log_date_format'];

72 
public
 
funùiÚ
 
	`wr™e_log
(
$Ëv–
 = '”rÜ', 
$msg
, 
$php_”rÜ
 = 
FALSE
)

74 ià(
$this
->
_’abËd
 ==ğ
FALSE
)

76  
FALSE
;

79 
$Ëv–
 = 
	`¡¹ouµ”
($level);

81 iàĞ! 
	`is£t
(
$this
->
_Ëv–s
[
$Ëv–
]è
	`OR
 ($this->_Ëv–s[$Ëv–] > $this->
_th»shŞd
))

83  
FALSE
;

86 
$f•©h
 = 
$this
->
_log_·th
.'log-'.
	`d©e
('Y-m-d').'.php';

87 
$mes§ge
 = '';

89 iàĞ! 
	`fe_exi¡s
(
$f•©h
))

91 
$mes§ge
 .= "<"."?php if ( ! defined('BASEPATH'))ƒxit('No direct script‡ccess‡llowed'); ?".">\n\n";

94 iàĞ! 
$å
 = @
	`fİ’
(
$f•©h
, 
FOPEN_WRITE_CREATE
))

96  
FALSE
;

99 
$mes§ge
 .ğ
$Ëv–
.' '.(($Ëv– =ğ'INFO'è? ' -' : '-').' '.
	`d©e
(
$this
->
_d©e_fmt
). ' --> '.
$msg
."\n";

101 
	`æock
(
$å
, 
LOCK_EX
);

102 
	`fwr™e
(
$å
, 
$mes§ge
);

103 
	`æock
(
$å
, 
LOCK_UN
);

104 
	`fşo£
(
$å
);

106 @
	`chmod
(
$f•©h
, 
FILE_WRITE_MODE
);

107  
TRUE
;

108 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Migration.php

1 <?
php
 
defšed
('BASEPATH'è
OR
 
ex™
('No direct script‡ccess‡llowed');

30 şas 
	cCI_Mig¿tiÚ
 {

32 
´Ùeùed
 
	m$_mig¿tiÚ_’abËd
 = 
FALSE
;

33 
´Ùeùed
 
	m$_mig¿tiÚ_·th
 = 
NULL
;

34 
´Ùeùed
 
	m$_mig¿tiÚ_v”siÚ
 = 0;

36 
´Ùeùed
 
	m$_”rÜ_¡ršg
 = '';

38 
public
 
funùiÚ
 
__cÚ¡ruù
(
$cÚfig
 = 
	$¬¿y
())

40 #OÆy 
run
 
this
 
cÚ¡ruùÜ
 
Ú
 
maš
 
lib¿ry
 
lßd


41 ià(
	`g‘_·»Á_şass
(
$this
è!=ğ
FALSE
)

46 
	`fÜ—ch
 (
$cÚfig
 
as
 
$key
 => 
$v®
)

48 
$this
->{'_' . 
$key
} = 
$v®
;

51 
	`log_mes§ge
('debug', 'Migrations class initialized');

54 ià(
$this
->
_mig¿tiÚ_’abËd
 !=ğ
TRUE
)

56 
	`show_”rÜ
('Migrations has been†oaded but is disabled or set up incorrectly.');

60 
$this
->
_mig¿tiÚ_·th
 =ğ'' 
AND
 $this->_mig¿tiÚ_·th = 
APPPATH
 . 'migrations/';

63 
$this
->
_mig¿tiÚ_·th
 = 
	`¹rim
($this->_migration_path, '/').'/';

66 
$this
->
Ïng
->
	`lßd
('migration');

69 
$this
->
lßd
->
	`dbfÜge
();

72 iàĞ! 
$this
->
db
->
	`bË_exi¡s
('migrations'))

74 
$this
->
dbfÜge
->
	`add_f›ld
(
	`¬¿y
(

75 'v”siÚ' => 
	`¬¿y
('type' => 'INT', 'constraint' => 3),

78 
$this
->
dbfÜge
->
	`ü—‹_bË
('mig¿tiÚs', 
TRUE
);

80 
$this
->
db
->
	`š£¹
('mig¿tiÚs', 
	`¬¿y
('version' => 0));

95 
public
 
funùiÚ
 
	$v”siÚ
(
$rg‘_v”siÚ
)

97 
$¡¬t
 = 
$cu¼’t_v”siÚ
 = 
$this
->
	`_g‘_v”siÚ
();

98 
$¡İ
 = 
$rg‘_v”siÚ
;

100 ià(
$rg‘_v”siÚ
 > 
$cu¼’t_v”siÚ
)

103 ++
$¡¬t
;

104 ++
$¡İ
;

105 
$¡•
 = 1;

110 
$¡•
 = -1;

113 
$m‘hod
 = (
$¡•
 === 1) ? 'up' : 'down';

114 
$mig¿tiÚs
 = 
	`¬¿y
();

118 
$i
 = 
$¡¬t
; $˜!ğ
$¡İ
; $˜+ğ
$¡•
)

120 
$f
 = 
	`glob
(
	`¥rštf
(
$this
->
_mig¿tiÚ_·th
 . '%03d_*.php', 
$i
));

123 ià(
	`couÁ
(
$f
) > 1)

125 
$this
->
_”rÜ_¡ršg
 = 
	`¥rštf
($this->
Ïng
->
	`lše
('mig¿tiÚ_muÉË_v”siÚ'), 
$i
);

126  
FALSE
;

130 ià(
	`couÁ
(
$f
) == 0)

134 ià(
$¡•
 == 1)

141 
$this
->
_”rÜ_¡ršg
 = 
	`¥rštf
($this->
Ïng
->
	`lše
('mig¿tiÚ_nÙ_found'), 
$i
);

142  
FALSE
;

145 
$fe
 = 
	`ba£Çme
(
$f
[0]);

146 
$Çme
 = 
	`ba£Çme
(
$f
[0], '.php');

149 ià(
	`´eg_m©ch
('/^\d{3}_(\w+)$/', 
$Çme
, 
$m©ch
))

151 
$m©ch
[1] = 
	`¡¹Şow”
($match[1]);

154 ià(
	`š_¬¿y
(
$m©ch
[1], 
$mig¿tiÚs
))

156 
$this
->
_”rÜ_¡ršg
 = 
	`¥rštf
($this->
Ïng
->
	`lše
('mig¿tiÚ_muÉË_v”siÚ'), 
$m©ch
[1]);

157  
FALSE
;

160 
šşude
 
$f
[0];

161 
$şass
 = 'Mig¿tiÚ_' . 
	`ucfœ¡
(
$m©ch
[1]);

163 iàĞ! 
	`şass_exi¡s
(
$şass
))

165 
$this
->
_”rÜ_¡ršg
 = 
	`¥rštf
($this->
Ïng
->
	`lše
('mig¿tiÚ_şass_dÛ¢t_exi¡'), 
$şass
);

166  
FALSE
;

169 iàĞ! 
	`is_ÿÎabË
(
	`¬¿y
(
$şass
, 
$m‘hod
)))

171 
$this
->
_”rÜ_¡ršg
 = 
	`¥rštf
($this->
Ïng
->
	`lše
('mig¿tiÚ_missšg_'.
$m‘hod
.'_m‘hod'), 
$şass
);

172  
FALSE
;

175 
$mig¿tiÚs
[] = 
$m©ch
[1];

179 
$this
->
_”rÜ_¡ršg
 = 
	`¥rštf
($this->
Ïng
->
	`lše
('mig¿tiÚ_šv®id_f’ame'), 
$fe
);

180  
FALSE
;

184 
	`log_mes§ge
('debug', 'Cu¼’ˆmig¿tiÚ: ' . 
$cu¼’t_v”siÚ
);

186 
$v”siÚ
 = 
$i
 + (
$¡•
 == 1 ? -1 : 0);

189 ià(
$mig¿tiÚs
 ==ğ
	`¬¿y
())

191  
TRUE
;

194 
	`log_mes§ge
('debug', 'Mig¿tšg from ' . 
$m‘hod
 . 'Øv”siÚ ' . 
$v”siÚ
);

197 
	`fÜ—ch
 (
$mig¿tiÚs
 
AS
 
$mig¿tiÚ
)

200 
$şass
 = 'Mig¿tiÚ_' . 
	`ucfœ¡
(
	`¡¹Şow”
(
$mig¿tiÚ
));

201 
	`ÿÎ_u£r_func
(
	`¬¿y
(
Ãw
 
$şass
, 
$m‘hod
));

203 
$cu¼’t_v”siÚ
 +ğ
$¡•
;

204 
$this
->
	`_upd©e_v”siÚ
(
$cu¼’t_v”siÚ
);

207 
	`log_mes§ge
('debug', 'Fšished mig¿tšgØ'.
$cu¼’t_v”siÚ
);

209  
$cu¼’t_v”siÚ
;

210 
	}
}

219 
public
 
funùiÚ
 
	$Ï‹¡
()

221 iàĞ! 
$mig¿tiÚs
 = 
$this
->
	`fšd_mig¿tiÚs
())

223 
$this
->
_”rÜ_¡ršg
 = $this->
Ïng
->
	`lše
('migration_none_found');

224  
çl£
;

227 
$Ï¡_mig¿tiÚ
 = 
	`ba£Çme
(
	`’d
(
$mig¿tiÚs
));

231  
$this
->
	`v”siÚ
((è
	`sub¡r
(
$Ï¡_mig¿tiÚ
, 0, 3));

232 
	}
}

241 
public
 
funùiÚ
 
	$cu¼’t
()

243  
$this
->
	`v”siÚ
($this->
_mig¿tiÚ_v”siÚ
);

244 
	}
}

253 
public
 
funùiÚ
 
	$”rÜ_¡ršg
()

255  
$this
->
_”rÜ_¡ršg
;

256 
	}
}

265 
´Ùeùed
 
funùiÚ
 
	$fšd_mig¿tiÚs
()

268 
$fes
 = 
	`glob
(
$this
->
_mig¿tiÚ_·th
 . '*_*.php');

269 
$fe_couÁ
 = 
	`couÁ
(
$fes
);

271 
$i
 = 0; $˜< 
$fe_couÁ
; $i++)

274 
$Çme
 = 
	`ba£Çme
(
$fes
[
$i
], '.php');

275 iàĞ! 
	`´eg_m©ch
('/^\d{3}_(\w+)$/', 
$Çme
))

277 
$fes
[
$i
] = 
FALSE
;

281 
	`sÜt
(
$fes
);

282  
$fes
;

283 
	}
}

292 
´Ùeùed
 
funùiÚ
 
	$_g‘_v”siÚ
()

294 
$row
 = 
$this
->
db
->
	`g‘
('mig¿tiÚs')->
	`row
();

295  
$row
 ? $row->
v”siÚ
 : 0;

296 
	}
}

306 
´Ùeùed
 
funùiÚ
 
	$_upd©e_v”siÚ
(
$mig¿tiÚs
)

308  
$this
->
db
->
	`upd©e
('mig¿tiÚs', 
	`¬¿y
(

309 'v”siÚ' => 
$mig¿tiÚs


311 
	}
}

321 
public
 
funùiÚ
 
	$__g‘
(
$v¬
)

323  
	`g‘_š¡ªû
()->
$v¬
;

324 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Pagination.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Pagš©iÚ
 {

29 
v¬
 
	m$ba£_u¾
 = '';

30 
v¬
 
	m$´efix
 = '';

31 
v¬
 
	m$suffix
 = '';

33 
v¬
 
	m$tÙ®_rows
 = 0;

34 
v¬
 
	m$³r_·ge
 = 10;

35 
v¬
 
	m$num_lšks
 = 2;

36 
v¬
 
	m$cur_·ge
 = 0;

37 
v¬
 
	m$u£_·ge_numb”s
 = 
FALSE
;

38 
v¬
 
	m$fœ¡_lšk
 = '&lsaquo; First';

39 
v¬
 
	m$Ãxt_lšk
 = '&gt;';

40 
v¬
 
	m$´ev_lšk
 = '&lt;';

41 
v¬
 
	m$Ï¡_lšk
 = 'Last &rsaquo;';

42 
v¬
 
	m$uri_£gm’t
 = 3;

43 
v¬
 
	m$fuÎ_g_İ’
 = '';

44 
v¬
 
	m$fuÎ_g_şo£
 = '';

45 
v¬
 
	m$fœ¡_g_İ’
 = '';

46 
v¬
 
	m$fœ¡_g_şo£
 = '&nbsp;';

47 
v¬
 
	m$Ï¡_g_İ’
 = '&nbsp;';

48 
v¬
 
	m$Ï¡_g_şo£
 = '';

49 
v¬
 
	m$fœ¡_u¾
 = '';

50 
v¬
 
	m$cur_g_İ’
 = '&nbsp;<strong>';

51 
v¬
 
	m$cur_g_şo£
 = '</strong>';

52 
v¬
 
	m$Ãxt_g_İ’
 = '&nbsp;';

53 
v¬
 
	m$Ãxt_g_şo£
 = '&nbsp;';

54 
v¬
 
	m$´ev_g_İ’
 = '&nbsp;';

55 
v¬
 
	m$´ev_g_şo£
 = '';

56 
v¬
 
	m$num_g_İ’
 = '&nbsp;';

57 
v¬
 
	m$num_g_şo£
 = '';

58 
v¬
 
	m$·ge_qu”y_¡ršg
 = 
FALSE
;

59 
v¬
 
	m$qu”y_¡ršg_£gm’t
 = 'per_page';

60 
v¬
 
	m$di¥Ïy_·ges
 = 
TRUE
;

61 
v¬
 
	m$ªchÜ_şass
 = '';

69 
public
 
funùiÚ
 
__cÚ¡ruù
(
$·¿ms
 = 
	$¬¿y
())

71 ià(
	`couÁ
(
$·¿ms
) > 0)

73 
$this
->
	`š™Ÿlize
(
$·¿ms
);

76 ià(
$this
->
ªchÜ_şass
 != '')

78 
$this
->
ªchÜ_şass
 = 'class="'.$this->anchor_class.'" ';

81 
	`log_mes§ge
('debug', "Pagination Class Initialized");

93 
funùiÚ
 
	`š™Ÿlize
(
$·¿ms
 = 
	$¬¿y
())

95 ià(
	`couÁ
(
$·¿ms
) > 0)

97 
	`fÜ—ch
 (
$·¿ms
 
as
 
$key
 => 
$v®
)

99 ià(
	`is£t
(
$this
->
$key
))

101 
$this
->
$key
 = 
$v®
;

105 
	}
}

115 
funùiÚ
 
	$ü—‹_lšks
()

118 ià(
$this
->
tÙ®_rows
 =ğ0 
OR
 $this->
³r_·ge
 == 0)

124 
$num_·ges
 = 
	`û
(
$this
->
tÙ®_rows
 / $this->
³r_·ge
);

127 ià(
$num_·ges
 == 1)

133 ià(
$this
->
u£_·ge_numb”s
)

135 
$ba£_·ge
 = 1;

139 
$ba£_·ge
 = 0;

143 
$CI
 =& 
	`g‘_š¡ªû
();

145 ià(
$CI
->
cÚfig
->
	`™em
('’abË_qu”y_¡ršgs'è==ğ
TRUE
 
OR
 
$this
->
·ge_qu”y_¡ršg
 === TRUE)

147 ià(
$CI
->
šput
->
	`g‘
(
$this
->
qu”y_¡ršg_£gm’t
è!ğ
$ba£_·ge
)

149 
$this
->
cur_·ge
 = 
$CI
->
šput
->
	`g‘
($this->
qu”y_¡ršg_£gm’t
);

152 
$this
->
cur_·ge
 = () $this->cur_page;

157 ià(
$CI
->
uri
->
	`£gm’t
(
$this
->
uri_£gm’t
è!ğ
$ba£_·ge
)

159 
$this
->
cur_·ge
 = 
$CI
->
uri
->
	`£gm’t
($this->
uri_£gm’t
);

162 
$this
->
cur_·ge
 = () $this->cur_page;

167 ià(
$this
->
u£_·ge_numb”s
 
AND
 $this->
cur_·ge
 == 0)

169 
$this
->
cur_·ge
 = 
$ba£_·ge
;

172 
$this
->
num_lšks
 = ()$this->num_links;

174 ià(
$this
->
num_lšks
 < 1)

176 
	`show_”rÜ
('Your‚umber of†inks must be‡…ositive‚umber.');

179 iàĞ! 
	`is_num”ic
(
$this
->
cur_·ge
))

181 
$this
->
cur_·ge
 = 
$ba£_·ge
;

186 ià(
$this
->
u£_·ge_numb”s
)

188 ià(
$this
->
cur_·ge
 > 
$num_·ges
)

190 
$this
->
cur_·ge
 = 
$num_·ges
;

195 ià(
$this
->
cur_·ge
 > $this->
tÙ®_rows
)

197 
$this
->
cur_·ge
 = (
$num_·ges
 - 1è* $this->
³r_·ge
;

201 
$uri_·ge_numb”
 = 
$this
->
cur_·ge
;

203 iàĞ! 
$this
->
u£_·ge_numb”s
)

205 
$this
->
cur_·ge
 = 
	`æoÜ
(($this->cur_·ge/$this->
³r_·ge
) + 1);

210 
$¡¬t
 = ((
$this
->
cur_·ge
 - $this->
num_lšks
) > 0) ? $this->cur_page - ($this->num_links - 1) : 1;

211 
$’d
 = ((
$this
->
cur_·ge
 + $this->
num_lšks
è< 
$num_·ges
) ? $this->cur_page + $this->num_links : $num_pages;

215 ià(
$CI
->
cÚfig
->
	`™em
('’abË_qu”y_¡ršgs'è==ğ
TRUE
 
OR
 
$this
->
·ge_qu”y_¡ršg
 === TRUE)

217 
$this
->
ba£_u¾
 = 
	`¹rim
($this->ba£_u¾).'&amp;'.$this->
qu”y_¡ršg_£gm’t
.'=';

221 
$this
->
ba£_u¾
 = 
	`¹rim
($this->base_url, '/') .'/';

225 
$ouut
 = '';

228 ià(
$this
->
fœ¡_lšk
 !=ğ
FALSE
 
AND
 $this->
cur_·ge
 > ($this->
num_lšks
 + 1))

230 
$fœ¡_u¾
 = (
$this
->
fœ¡_u¾
 =ğ''è? $this->
ba£_u¾
 : $this->first_url;

231 
$ouut
 .ğ
$this
->
fœ¡_g_İ’
.'<¨'.$this->
ªchÜ_şass
.'h»f="'.
$fœ¡_u¾
.'">'.$this->
fœ¡_lšk
.'</a>'.$this->
fœ¡_g_şo£
;

235 ià(
$this
->
´ev_lšk
 !=ğ
FALSE
 
AND
 $this->
cur_·ge
 != 1)

237 ià(
$this
->
u£_·ge_numb”s
)

239 
$i
 = 
$uri_·ge_numb”
 - 1;

243 
$i
 = 
$uri_·ge_numb”
 - 
$this
->
³r_·ge
;

246 ià(
$i
 =ğ0 && 
$this
->
fœ¡_u¾
 != '')

248 
$ouut
 .ğ
$this
->
´ev_g_İ’
.'<¨'.$this->
ªchÜ_şass
.'h»f="'.$this->
fœ¡_u¾
.'">'.$this->
´ev_lšk
.'</a>'.$this->
´ev_g_şo£
;

252 
$i
 = ($˜=ğ0è? '' : 
$this
->
´efix
.$i.$this->
suffix
;

253 
$ouut
 .ğ
$this
->
´ev_g_İ’
.'<¨'.$this->
ªchÜ_şass
.'h»f="'.$this->
ba£_u¾
.
$i
.'">'.$this->
´ev_lšk
.'</a>'.$this->
´ev_g_şo£
;

259 ià(
$this
->
di¥Ïy_·ges
 !=ğ
FALSE
)

262 
$loİ
 = 
$¡¬t
 -1; $loİ <ğ
$’d
; $loop++)

264 ià(
$this
->
u£_·ge_numb”s
)

266 
$i
 = 
$loİ
;

270 
$i
 = (
$loİ
 * 
$this
->
³r_·ge
) - $this->per_page;

273 ià(
$i
 >ğ
$ba£_·ge
)

275 ià(
$this
->
cur_·ge
 =ğ
$loİ
)

277 
$ouut
 .ğ
$this
->
cur_g_İ’
.
$loİ
.$this->
cur_g_şo£
;

281 
$n
 = (
$i
 =ğ
$ba£_·ge
) ? '' : $i;

283 ià(
$n
 =ğ'' && 
$this
->
fœ¡_u¾
 != '')

285 
$ouut
 .ğ
$this
->
num_g_İ’
.'<¨'.$this->
ªchÜ_şass
.'h»f="'.$this->
fœ¡_u¾
.'">'.
$loİ
.'</a>'.$this->
num_g_şo£
;

289 
$n
 = ($À=ğ''è? '' : 
$this
->
´efix
.$n.$this->
suffix
;

291 
$ouut
 .ğ
$this
->
num_g_İ’
.'<¨'.$this->
ªchÜ_şass
.'h»f="'.$this->
ba£_u¾
.
$n
.'">'.
$loİ
.'</a>'.$this->
num_g_şo£
;

299 ià(
$this
->
Ãxt_lšk
 !=ğ
FALSE
 
AND
 $this->
cur_·ge
 < 
$num_·ges
)

301 ià(
$this
->
u£_·ge_numb”s
)

303 
$i
 = 
$this
->
cur_·ge
 + 1;

307 
$i
 = (
$this
->
cur_·ge
 * $this->
³r_·ge
);

310 
$ouut
 .ğ
$this
->
Ãxt_g_İ’
.'<¨'.$this->
ªchÜ_şass
.'h»f="'.$this->
ba£_u¾
.$this->
´efix
.
$i
.$this->
suffix
.'">'.$this->
Ãxt_lšk
.'</a>'.$this->
Ãxt_g_şo£
;

314 ià(
$this
->
Ï¡_lšk
 !=ğ
FALSE
 
	`AND
 ($this->
cur_·ge
 + $this->
num_lšks
è< 
$num_·ges
)

316 ià(
$this
->
u£_·ge_numb”s
)

318 
$i
 = 
$num_·ges
;

322 
$i
 = ((
$num_·ges
 * 
$this
->
³r_·ge
) - $this->per_page);

324 
$ouut
 .ğ
$this
->
Ï¡_g_İ’
.'<¨'.$this->
ªchÜ_şass
.'h»f="'.$this->
ba£_u¾
.$this->
´efix
.
$i
.$this->
suffix
.'">'.$this->
Ï¡_lšk
.'</a>'.$this->
Ï¡_g_şo£
;

329 
$ouut
 = 
	`´eg_»¶aû
("#([^:])//+#", "\\1/", $output);

332 
$ouut
 = 
$this
->
fuÎ_g_İ’
.$ouut.$this->
fuÎ_g_şo£
;

334  
$ouut
;

335 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Parser.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_P¬£r
 {

29 
v¬
 
	m$l_d–im
 = '{';

30 
v¬
 
	m$r_d–im
 = '}';

31 
v¬
 
	m$objeù
;

45 
public
 
funùiÚ
 
	$·r£
(
$‹m¶©e
, 
$d©a
, 
$»tuº
 = 
FALSE
)

47 
$CI
 =& 
	`g‘_š¡ªû
();

48 
$‹m¶©e
 = 
$CI
->
lßd
->
	`v›w
($‹m¶©e, 
$d©a
, 
TRUE
);

50  
$this
->
	`_·r£
(
$‹m¶©e
, 
$d©a
, 
$»tuº
);

67 
funùiÚ
 
	$·r£_¡ršg
(
$‹m¶©e
, 
$d©a
, 
$»tuº
 = 
FALSE
)

69  
$this
->
	`_·r£
(
$‹m¶©e
, 
$d©a
, 
$»tuº
);

70 
	}
}

86 
funùiÚ
 
	$_·r£
(
$‹m¶©e
, 
$d©a
, 
$»tuº
 = 
FALSE
)

88 ià(
$‹m¶©e
 == '')

90  
FALSE
;

93 
	`fÜ—ch
 (
$d©a
 
as
 
$key
 => 
$v®
)

95 ià(
	`is_¬¿y
(
$v®
))

97 
$‹m¶©e
 = 
$this
->
	`_·r£_·œ
(
$key
, 
$v®
, $template);

101 
$‹m¶©e
 = 
$this
->
	`_·r£_sšgË
(
$key
, (
¡ršg
)
$v®
, $template);

105 ià(
$»tuº
 =ğ
FALSE
)

107 
$CI
 =& 
	`g‘_š¡ªû
();

108 
$CI
->
ouut
->
	`­³nd_ouut
(
$‹m¶©e
);

111  
$‹m¶©e
;

112 
	}
}

124 
funùiÚ
 
£t_d–im™”s
(
$l
 = '{', 
$r
 = '}')

126 
$this
->
l_d–im
 = 
$l
;

127 
	g$this
->
	gr_d–im
 = 
$r
;

141 
funùiÚ
 
	$_·r£_sšgË
(
$key
, 
$v®
, 
$¡ršg
)

143  
	`¡r_»¶aû
(
$this
->
l_d–im
.
$key
.$this->
r_d–im
, 
$v®
, 
$¡ršg
);

144 
	}
}

159 
funùiÚ
 
	$_·r£_·œ
(
$v¬ŸbË
, 
$d©a
, 
$¡ršg
)

161 ià(
FALSE
 ==ğ(
$m©ch
 = 
$this
->
	`_m©ch_·œ
(
$¡ršg
, 
$v¬ŸbË
)))

163  
$¡ršg
;

166 
$¡r
 = '';

167 
	`fÜ—ch
 (
$d©a
 
as
 
$row
)

169 
$‹mp
 = 
$m©ch
['1'];

170 
	`fÜ—ch
 (
$row
 
as
 
$key
 => 
$v®
)

172 iàĞ! 
	`is_¬¿y
(
$v®
))

174 
$‹mp
 = 
$this
->
	`_·r£_sšgË
(
$key
, 
$v®
, $temp);

178 
$‹mp
 = 
$this
->
	`_·r£_·œ
(
$key
, 
$v®
, $temp);

182 
$¡r
 .ğ
$‹mp
;

185  
	`¡r_»¶aû
(
$m©ch
['0'], 
$¡r
, 
$¡ršg
);

186 
	}
}

198 
funùiÚ
 
	$_m©ch_·œ
(
$¡ršg
, 
$v¬ŸbË
)

200 iàĞ! 
	`´eg_m©ch
("|" . 
	`´eg_quÙe
(
$this
->
l_d–im
è. 
$v¬ŸbË
 .…»g_quÙe($this->
r_d–im
è. "(.+?)".…»g_quÙe($this->l_d–imè. '/' . $v¬ŸbË .…»g_quÙe($this->r_d–imè. "|s", 
$¡ršg
, 
$m©ch
))

202  
FALSE
;

205  
$m©ch
;

206 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Profiler.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

33 şas 
	cCI_Prof”
 {

35 
´Ùeùed
 
	m$_avaabË_£ùiÚs
 = 
¬¿y
(

48 
´Ùeùed
 
	m$_qu”y_toggË_couÁ
 = 25;

50 
´Ùeùed
 
	m$CI
;

54 
public
 
funùiÚ
 
__cÚ¡ruù
(
$cÚfig
 = 
	$¬¿y
())

56 
$this
->
CI
 =& 
	`g‘_š¡ªû
();

57 
$this
->
CI
->
lßd
->
	`Ïnguage
('profiler');

59 ià(
	`is£t
(
$cÚfig
['query_toggle_count']))

61 
$this
->
_qu”y_toggË_couÁ
 = (è
$cÚfig
['query_toggle_count'];

62 
	`un£t
(
$cÚfig
['query_toggle_count']);

66 
	`fÜ—ch
 (
$this
->
_avaabË_£ùiÚs
 
as
 
$£ùiÚ
)

68 iàĞ! 
	`is£t
(
$cÚfig
[
$£ùiÚ
]))

70 
$this
->
_compe_
{
$£ùiÚ
} = 
TRUE
;

74 
$this
->
	`£t_£ùiÚs
(
$cÚfig
);

87 
public
 
funùiÚ
 
	$£t_£ùiÚs
(
$cÚfig
)

89 
	`fÜ—ch
 (
$cÚfig
 
as
 
$m‘hod
 => 
$’abË
)

91 ià(
	`š_¬¿y
(
$m‘hod
, 
$this
->
_avaabË_£ùiÚs
))

93 
$this
->
_compe_
{
$m‘hod
} = (
$’abË
 !=ğ
FALSE
è? 
TRUE
 : FALSE;

96 
	}
}

110 
´Ùeùed
 
funùiÚ
 
	$_compe_b’chm¬ks
()

112 
$´ofe
 = 
	`¬¿y
();

113 
	`fÜ—ch
 (
$this
->
CI
->
b’chm¬k
->
m¬k”
 
as
 
$key
 => 
$v®
)

117 ià(
	`´eg_m©ch
("/(.+?)_’d/i", 
$key
, 
$m©ch
))

119 ià(
	`is£t
(
$this
->
CI
->
b’chm¬k
->
m¬k”
[
$m©ch
[1].'_’d']è
AND
 isset($this->CI->benchmark->marker[$match[1].'_start']))

121 
$´ofe
[
$m©ch
[1]] = 
$this
->
CI
->
b’chm¬k
->
	`–­£d_time
($m©ch[1].'_¡¬t', 
$key
);

130 
$ouut
 = "\n\n";

131 
$ouut
 .= '<fieldset id="ci_profiler_benchmarks" style="border:1px solid #900;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

132 
$ouut
 .= "\n";

133 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#900;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_benchmarks').'&nbsp;&nbsp;</legend>';

134 
$ouut
 .= "\n";

135 
$ouut
 .= "\n\n<table style='width:100%'>\n";

137 
	`fÜ—ch
 (
$´ofe
 
as
 
$key
 => 
$v®
)

139 
$key
 = 
	`ucwÜds
(
	`¡r_»¶aû
(
	`¬¿y
('_', '-'), ' ', $key));

140 
$ouut
 .ğ"<Œ><td styË='·ddšg:5px;width:50%;cŞÜ:#000;fÚt-weight:bŞd;background-cŞÜ:#ddd;'>".
$key
."&nb¥;&nb¥;</td><td styË='·ddšg:5px;width:50%;cŞÜ:#900;fÚt-weight:nÜm®;background-cŞÜ:#ddd;'>".
$v®
."</td></tr>\n";

143 
$ouut
 .= "</table>\n";

144 
$ouut
 .= "</fieldset>";

146  
$ouut
;

147 
	}
}

156 
´Ùeùed
 
funùiÚ
 
	$_compe_qu”›s
()

158 
$dbs
 = 
	`¬¿y
();

161 
	`fÜ—ch
 (
	`g‘_objeù_v¬s
(
$this
->
CI
è
as
 
$CI_objeù
)

163 ià(
	`is_objeù
(
$CI_objeù
è&& 
	`is_subşass_of
(
	`g‘_şass
($CI_object), 'CI_DB') )

165 
$dbs
[] = 
$CI_objeù
;

169 ià(
	`couÁ
(
$dbs
) == 0)

171 
$ouut
 = "\n\n";

172 
$ouut
 .= '<fieldset id="ci_profiler_queries" style="border:1px solid #0000FF;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

173 
$ouut
 .= "\n";

174 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#0000FF;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_queries').'&nbsp;&nbsp;</legend>';

175 
$ouut
 .= "\n";

176 
$ouut
 .= "\n\n<table style='border:none; width:100%;'>\n";

177 
$ouut
 .="<Œ><td styË='width:100%;cŞÜ:#0000FF;fÚt-weight:nÜm®;background-cŞÜ:#“e;·ddšg:5px'>".
$this
->
CI
->
Ïng
->
	`lše
('profiler_no_db')."</td></tr>\n";

178 
$ouut
 .= "</table>\n";

179 
$ouut
 .= "</fieldset>";

181  
$ouut
;

185 
$this
->
CI
->
lßd
->
	`h–³r
('text');

188 
$highlight
 = 
	`¬¿y
('SELECT', 'DISTINCT', 'FROM', 'WHERE', 'AND', 'LEFT&nbsp;JOIN', 'ORDER&nbsp;BY', 'GROUP&nbsp;BY', 'LIMIT', 'INSERT', 'INTO', 'VALUES', 'UPDATE', 'OR&nbsp;', 'HAVING', 'OFFSET', 'NOT&nbsp;IN', 'IN', 'LIKE', 'NOT&nbsp;LIKE', 'COUNT', 'MAX', 'MIN', 'ON', 'AS', 'AVG', 'SUM', '(', ')');

190 
$ouut
 = "\n\n";

192 
$couÁ
 = 0;

194 
	`fÜ—ch
 (
$dbs
 
as
 
$db
)

196 
$couÁ
++;

198 
$hide_qu”›s
 = (
	`couÁ
(
$db
->
qu”›s
è> 
$this
->
_qu”y_toggË_couÁ
) ? ' display:none' : '';

200 
$show_hide_js
 = '(<¥ª styË="cursÜ:…oš‹r;" onşick="v¬ s=docum’t.g‘EËm’tById(\'ci_´of”_qu”›s_db_'.
$couÁ
.'\').¡yË;s.di¥Ïy=s.di¥Ïy==\'nÚe\'?\'\':\'nÚe\';this.šÃrHTMLñhis.šÃrHTML==\''.
$this
->
CI
->
Ïng
->
	`lše
('profiler_section_hide').'\'?\''.$this->CI->lang->line('profiler_section_show').'\':\''.$this->CI->lang->line('profiler_section_hide').'\';">'.$this->CI->lang->line('profiler_section_hide').'</span>)';

202 ià(
$hide_qu”›s
 != '')

204 
$show_hide_js
 = '(<¥ª styË="cursÜ:…oš‹r;" onşick="v¬ s=docum’t.g‘EËm’tById(\'ci_´of”_qu”›s_db_'.
$couÁ
.'\').¡yË;s.di¥Ïy=s.di¥Ïy==\'nÚe\'?\'\':\'nÚe\';this.šÃrHTMLñhis.šÃrHTML==\''.
$this
->
CI
->
Ïng
->
	`lše
('profiler_section_show').'\'?\''.$this->CI->lang->line('profiler_section_hide').'\':\''.$this->CI->lang->line('profiler_section_show').'\';">'.$this->CI->lang->line('profiler_section_show').'</span>)';

207 
$ouut
 .= '<fieldset style="border:1px solid #0000FF;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

208 
$ouut
 .= "\n";

209 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#0000FF;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('´of”_d©aba£').':&nb¥; '.
$db
->
d©aba£
.'&nb¥;&nb¥;&nb¥;'.$this->CI->Ïng->lše('´of”_qu”›s').': '.
	`couÁ
($db->
qu”›s
).'&nb¥;&nb¥;'.
$show_hide_js
.'</legend>';

210 
$ouut
 .= "\n";

211 
$ouut
 .= "\n\n<table style='width:100%;{$hide_queries}' id='ci_profiler_queries_db_{$count}'>\n";

213 ià(
	`couÁ
(
$db
->
qu”›s
) == 0)

215 
$ouut
 .ğ"<Œ><td styË='width:100%;cŞÜ:#0000FF;fÚt-weight:nÜm®;background-cŞÜ:#“e;·ddšg:5px;'>".
$this
->
CI
->
Ïng
->
	`lše
('profiler_no_queries')."</td></tr>\n";

219 
	`fÜ—ch
 (
$db
->
qu”›s
 
as
 
$key
 => 
$v®
)

221 
$time
 = 
	`numb”_fÜm©
(
$db
->
qu”y_times
[
$key
], 4);

223 
$v®
 = 
	`highlight_code
($v®, 
ENT_QUOTES
);

225 
	`fÜ—ch
 (
$highlight
 
as
 
$bŞd
)

227 
$v®
 = 
	`¡r_»¶aû
(
$bŞd
, '<strong>'.$bold.'</strong>', $val);

230 
$ouut
 .ğ"<Œ><td styË='·ddšg:5px; v”tiÿl-®ign:İ;width:1%;cŞÜ:#900;fÚt-weight:nÜm®;background-cŞÜ:#ddd;'>".
$time
."&nb¥;&nb¥;</td><td styË='·ddšg:5px; cŞÜ:#000;fÚt-weight:nÜm®;background-cŞÜ:#ddd;'>".
$v®
."</td></tr>\n";

234 
$ouut
 .= "</table>\n";

235 
$ouut
 .= "</fieldset>";

239  
$ouut
;

240 
	}
}

250 
´Ùeùed
 
funùiÚ
 
	$_compe_g‘
()

252 
$ouut
 = "\n\n";

253 
$ouut
 .= '<fieldset id="ci_profiler_get" style="border:1px solid #cd6e00;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

254 
$ouut
 .= "\n";

255 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#cd6e00;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_get_data').'&nbsp;&nbsp;</legend>';

256 
$ouut
 .= "\n";

258 ià(
	`couÁ
(
$_GET
) == 0)

260 
$ouut
 .ğ"<div styË='cŞÜ:#cd6e00;fÚt-weight:nÜm®;·ddšg:4px 0 4px 0'>".
$this
->
CI
->
Ïng
->
	`lše
('profiler_no_get')."</div>";

264 
$ouut
 .= "\n\n<table style='width:100%; border:none'>\n";

266 
	`fÜ—ch
 (
$_GET
 
as
 
$key
 => 
$v®
)

268 iàĞ! 
	`is_num”ic
(
$key
))

270 
$key
 = "'".$key."'";

273 
$ouut
 .ğ"<Œ><td styË='width:50%;cŞÜ:#000;background-cŞÜ:#ddd;·ddšg:5px'>&#36;_GET[".
$key
."]&nbsp;&nbsp; </td><td style='width:50%;padding:5px;color:#cd6e00;font-weight:normal;background-color:#ddd;'>";

274 ià(
	`is_¬¿y
(
$v®
))

276 
$ouut
 .ğ"<´e>" . 
	`html¥ecŸlch¬s
(
	`¡r¦ashes
(
	`´št_r
(
$v®
, 
Œue
))) . "</pre>";

280 
$ouut
 .ğ
	`html¥ecŸlch¬s
(
	`¡r¦ashes
(
$v®
));

282 
$ouut
 .= "</td></tr>\n";

285 
$ouut
 .= "</table>\n";

287 
$ouut
 .= "</fieldset>";

289  
$ouut
;

290 
	}
}

299 
´Ùeùed
 
funùiÚ
 
	$_compe_po¡
()

301 
$ouut
 = "\n\n";

302 
$ouut
 .= '<fieldset id="ci_profiler_post" style="border:1px solid #009900;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

303 
$ouut
 .= "\n";

304 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#009900;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_post_data').'&nbsp;&nbsp;</legend>';

305 
$ouut
 .= "\n";

307 ià(
	`couÁ
(
$_POST
) == 0)

309 
$ouut
 .ğ"<div styË='cŞÜ:#009900;fÚt-weight:nÜm®;·ddšg:4px 0 4px 0'>".
$this
->
CI
->
Ïng
->
	`lše
('profiler_no_post')."</div>";

313 
$ouut
 .= "\n\n<table style='width:100%'>\n";

315 
	`fÜ—ch
 (
$_POST
 
as
 
$key
 => 
$v®
)

317 iàĞ! 
	`is_num”ic
(
$key
))

319 
$key
 = "'".$key."'";

322 
$ouut
 .ğ"<Œ><td styË='width:50%;·ddšg:5px;cŞÜ:#000;background-cŞÜ:#ddd;'>&#36;_POST[".
$key
."]&nbsp;&nbsp; </td><td style='width:50%;padding:5px;color:#009900;font-weight:normal;background-color:#ddd;'>";

323 ià(
	`is_¬¿y
(
$v®
))

325 
$ouut
 .ğ"<´e>" . 
	`html¥ecŸlch¬s
(
	`¡r¦ashes
(
	`´št_r
(
$v®
, 
TRUE
))) . "</pre>";

329 
$ouut
 .ğ
	`html¥ecŸlch¬s
(
	`¡r¦ashes
(
$v®
));

331 
$ouut
 .= "</td></tr>\n";

334 
$ouut
 .= "</table>\n";

336 
$ouut
 .= "</fieldset>";

338  
$ouut
;

339 
	}
}

348 
´Ùeùed
 
funùiÚ
 
	$_compe_uri_¡ršg
()

350 
$ouut
 = "\n\n";

351 
$ouut
 .= '<fieldset id="ci_profiler_uri_string" style="border:1px solid #000;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

352 
$ouut
 .= "\n";

353 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#000;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_uri_string').'&nbsp;&nbsp;</legend>';

354 
$ouut
 .= "\n";

356 ià(
$this
->
CI
->
uri
->
uri_¡ršg
 == '')

358 
$ouut
 .ğ"<div styË='cŞÜ:#000;fÚt-weight:nÜm®;·ddšg:4px 0 4px 0'>".
$this
->
CI
->
Ïng
->
	`lše
('profiler_no_uri')."</div>";

362 
$ouut
 .ğ"<div styË='cŞÜ:#000;fÚt-weight:nÜm®;·ddšg:4px 0 4px 0'>".
$this
->
CI
->
uri
->
uri_¡ršg
."</div>";

365 
$ouut
 .= "</fieldset>";

367  
$ouut
;

368 
	}
}

377 
´Ùeùed
 
funùiÚ
 
	$_compe_cÚŒŞËr_šfo
()

379 
$ouut
 = "\n\n";

380 
$ouut
 .= '<fieldset id="ci_profiler_controller_info" style="border:1px solid #995300;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

381 
$ouut
 .= "\n";

382 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#995300;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_controller_info').'&nbsp;&nbsp;</legend>';

383 
$ouut
 .= "\n";

385 
$ouut
 .ğ"<div styË='cŞÜ:#995300;fÚt-weight:nÜm®;·ddšg:4px 0 4px 0'>".
$this
->
CI
->
rou‹r
->
	`ãtch_şass
()."/".$this->CI->rou‹r->
	`ãtch_m‘hod
()."</div>";

387 
$ouut
 .= "</fieldset>";

389  
$ouut
;

390 
	}
}

401 
´Ùeùed
 
funùiÚ
 
	$_compe_memÜy_u§ge
()

403 
$ouut
 = "\n\n";

404 
$ouut
 .= '<fieldset id="ci_profiler_memory_usage" style="border:1px solid #5a0099;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

405 
$ouut
 .= "\n";

406 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#5a0099;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_memory_usage').'&nbsp;&nbsp;</legend>';

407 
$ouut
 .= "\n";

409 ià(
	`funùiÚ_exi¡s
('memÜy_g‘_u§ge'è&& (
$u§ge
 = 
	`memÜy_g‘_u§ge
()) != '')

411 
$ouut
 .ğ"<div styË='cŞÜ:#5a0099;fÚt-weight:nÜm®;·ddšg:4px 0 4px 0'>".
	`numb”_fÜm©
(
$u§ge
).' bytes</div>';

415 
$ouut
 .ğ"<div styË='cŞÜ:#5a0099;fÚt-weight:nÜm®;·ddšg:4px 0 4px 0'>".
$this
->
CI
->
Ïng
->
	`lše
('profiler_no_memory')."</div>";

418 
$ouut
 .= "</fieldset>";

420  
$ouut
;

421 
	}
}

432 
´Ùeùed
 
funùiÚ
 
	$_compe_h‰p_h—d”s
()

434 
$ouut
 = "\n\n";

435 
$ouut
 .= '<fieldset id="ci_profiler_http_headers" style="border:1px solid #000;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

436 
$ouut
 .= "\n";

437 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#000;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_headers').'&nbsp;&nbsp;(<span style="cursor:…ointer;" onclick="var s=document.getElementById(\'ci_profiler_httpheaders_table\').style;s.display=s.display==\'none\'?\'\':\'none\';this.innerHTML=this.innerHTML==\''.$this->CI->lang->line('profiler_section_show').'\'?\''.$this->CI->lang->line('profiler_section_hide').'\':\''.$this->CI->lang->line('profiler_section_show').'\';">'.$this->CI->lang->line('profiler_section_show').'</span>)</legend>';

438 
$ouut
 .= "\n";

440 
$ouut
 .= "\n\n<table style='width:100%;display:none' id='ci_profiler_httpheaders_table'>\n";

442 
	`fÜ—ch
 (
	`¬¿y
('HTTP_ACCEPT', 'HTTP_USER_AGENT', 'HTTP_CONNECTION', 'SERVER_PORT', 'SERVER_NAME', 'REMOTE_ADDR', 'SERVER_SOFTWARE', 'HTTP_ACCEPT_LANGUAGE', 'SCRIPT_NAME', 'REQUEST_METHOD',' HTTP_HOST', 'REMOTE_HOST', 'CONTENT_TYPE', 'SERVER_PROTOCOL', 'QUERY_STRING', 'HTTP_ACCEPT_ENCODING', 'HTTP_X_FORWARDED_FOR'è
as
 
$h—d”
)

444 
$v®
 = (
	`is£t
(
$_SERVER
[
$h—d”
])) ? $_SERVER[$header] : '';

445 
$ouut
 .ğ"<Œ><td styË='v”tiÿl-®ign:İ;width:50%;·ddšg:5px;cŞÜ:#900;background-cŞÜ:#ddd;'>".
$h—d”
."&nb¥;&nb¥;</td><td styË='width:50%;·ddšg:5px;cŞÜ:#000;background-cŞÜ:#ddd;'>".
$v®
."</td></tr>\n";

448 
$ouut
 .= "</table>\n";

449 
$ouut
 .= "</fieldset>";

451  
$ouut
;

452 
	}
}

463 
´Ùeùed
 
funùiÚ
 
	$_compe_cÚfig
()

465 
$ouut
 = "\n\n";

466 
$ouut
 .= '<fieldset id="ci_profiler_config" style="border:1px solid #000;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

467 
$ouut
 .= "\n";

468 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#000;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_config').'&nbsp;&nbsp;(<span style="cursor:…ointer;" onclick="var s=document.getElementById(\'ci_profiler_config_table\').style;s.display=s.display==\'none\'?\'\':\'none\';this.innerHTML=this.innerHTML==\''.$this->CI->lang->line('profiler_section_show').'\'?\''.$this->CI->lang->line('profiler_section_hide').'\':\''.$this->CI->lang->line('profiler_section_show').'\';">'.$this->CI->lang->line('profiler_section_show').'</span>)</legend>';

469 
$ouut
 .= "\n";

471 
$ouut
 .= "\n\n<table style='width:100%; display:none' id='ci_profiler_config_table'>\n";

473 
	`fÜ—ch
 (
$this
->
CI
->
cÚfig
->cÚfig 
as
 
$cÚfig
=>
$v®
)

475 ià(
	`is_¬¿y
(
$v®
))

477 
$v®
 = 
	`´št_r
($v®, 
TRUE
);

480 
$ouut
 .ğ"<Œ><td styË='·ddšg:5px; v”tiÿl-®ign:İ;cŞÜ:#900;background-cŞÜ:#ddd;'>".
$cÚfig
."&nb¥;&nb¥;</td><td styË='·ddšg:5px; cŞÜ:#000;background-cŞÜ:#ddd;'>".
	`html¥ecŸlch¬s
(
$v®
)."</td></tr>\n";

483 
$ouut
 .= "</table>\n";

484 
$ouut
 .= "</fieldset>";

486  
$ouut
;

487 
	}
}

496 
´iv©e
 
funùiÚ
 
	$_compe_£ssiÚ_d©a
()

498 iàĞ! 
	`is£t
(
$this
->
CI
->
£ssiÚ
))

503 
$ouut
 = '<fieldset id="ci_profiler_csession" style="border:1px solid #000;padding:6px 10px 10px 10px;margin:20px 0 20px 0;background-color:#eee">';

504 
$ouut
 .ğ'<Ëg’d styË="cŞÜ:#000;">&nb¥;&nb¥;'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_session_data').'&nbsp;&nbsp;(<span style="cursor:…ointer;" onclick="var s=document.getElementById(\'ci_profiler_session_data\').style;s.display=s.display==\'none\'?\'\':\'none\';this.innerHTML=this.innerHTML==\''.$this->CI->lang->line('profiler_section_show').'\'?\''.$this->CI->lang->line('profiler_section_hide').'\':\''.$this->CI->lang->line('profiler_section_show').'\';">'.$this->CI->lang->line('profiler_section_show').'</span>)</legend>';

505 
$ouut
 .= "<table style='width:100%;display:none' id='ci_profiler_session_data'>";

507 
	`fÜ—ch
 (
$this
->
CI
->
£ssiÚ
->
	`®l_u£rd©a
(è
as
 
$key
 => 
$v®
)

509 ià(
	`is_¬¿y
(
$v®
è
OR
 
	`is_objeù
($val))

511 
$v®
 = 
	`´št_r
($v®, 
TRUE
);

514 
$ouut
 .ğ"<Œ><td styË='·ddšg:5px; v”tiÿl-®ign:İ;cŞÜ:#900;background-cŞÜ:#ddd;'>".
$key
."&nb¥;&nb¥;</td><td styË='·ddšg:5px; cŞÜ:#000;background-cŞÜ:#ddd;'>".
	`html¥ecŸlch¬s
(
$v®
)."</td></tr>\n";

517 
$ouut
 .= '</table>';

518 
$ouut
 .= "</fieldset>";

519  
$ouut
;

520 
	}
}

529 
public
 
funùiÚ
 
	$run
()

531 
$ouut
 = "<div id='codeigniter_profiler' style='clear:both;background-color:#fff;padding:10px;'>";

532 
$f›lds_di¥Ïyed
 = 0;

534 
	`fÜ—ch
 (
$this
->
_avaabË_£ùiÚs
 
as
 
$£ùiÚ
)

536 ià(
$this
->
_compe_
{
$£ùiÚ
} !=ğ
FALSE
)

538 
$func
 = "_compile_{$section}";

539 
$ouut
 .ğ
$this
->{
$func
}();

540 
$f›lds_di¥Ïyed
++;

544 ià(
$f›lds_di¥Ïyed
 == 0)

546 
$ouut
 .ğ'<°¡yË="bÜd”:1px sŞid #5a0099;·ddšg:10px;m¬gš:20px 0;background-cŞÜ:#“e">'.
$this
->
CI
->
Ïng
->
	`lše
('profiler_no_profiles').'</p>';

549 
$ouut
 .= '</div>';

551  
$ouut
;

552 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Session.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_SessiÚ
 {

29 
v¬
 
	m$£ss_’üy±_cook›
 = 
FALSE
;

30 
v¬
 
	m$£ss_u£_d©aba£
 = 
FALSE
;

31 
v¬
 
	m$£ss_bË_Çme
 = '';

32 
v¬
 
	m$£ss_expœ©iÚ
 = 7200;

33 
v¬
 
	m$£ss_expœe_Ú_şo£
 = 
FALSE
;

34 
v¬
 
	m$£ss_m©ch_
 = 
FALSE
;

35 
v¬
 
	m$£ss_m©ch_u£¿g’t
 = 
TRUE
;

36 
v¬
 
	m$£ss_cook›_Çme
 = 'ci_session';

37 
v¬
 
	m$cook›_´efix
 = '';

38 
v¬
 
	m$cook›_·th
 = '';

39 
v¬
 
	m$cook›_domaš
 = '';

40 
v¬
 
	m$cook›_£cu»
 = 
FALSE
;

41 
v¬
 
	m$£ss_time_to_upd©e
 = 300;

42 
v¬
 
	m$’üy±iÚ_key
 = '';

43 
v¬
 
	m$æashd©a_key
 = 'flash';

44 
v¬
 
	m$time_»ã»nû
 = 'time';

45 
v¬
 
	m$gc_´obab™y
 = 5;

46 
v¬
 
	m$u£rd©a
 = 
¬¿y
();

47 
v¬
 
	m$CI
;

48 
v¬
 
	m$now
;

56 
public
 
funùiÚ
 
__cÚ¡ruù
(
$·¿ms
 = 
	$¬¿y
())

58 
	`log_mes§ge
('debug', "Session Class Initialized");

61 
$this
->
CI
 =& 
	`g‘_š¡ªû
();

65 
	`fÜ—ch
 (
	`¬¿y
('£ss_’üy±_cook›', '£ss_u£_d©aba£', '£ss_bË_Çme', '£ss_expœ©iÚ', '£ss_expœe_Ú_şo£', '£ss_m©ch_', '£ss_m©ch_u£¿g’t', '£ss_cook›_Çme', 'cook›_·th', 'cook›_domaš', 'cook›_£cu»', '£ss_time_to_upd©e', 'time_»ã»nû', 'cook›_´efix', '’üy±iÚ_key'è
as
 
$key
)

67 
$this
->
$key
 = (
	`is£t
(
$·¿ms
[$key])è? $·¿ms[$key] : $this->
CI
->
cÚfig
->
	`™em
($key);

70 ià(
$this
->
’üy±iÚ_key
 == '')

72 
	`show_”rÜ
('In ordero usehe Session class you‡re„equiredo set‡nƒncryption key in your config file.');

76 
$this
->
CI
->
lßd
->
	`h–³r
('string');

79 ià(
$this
->
£ss_’üy±_cook›
 =ğ
TRUE
)

81 
$this
->
CI
->
lßd
->
	`lib¿ry
('encrypt');

85 ià(
$this
->
£ss_u£_d©aba£
 ==ğ
TRUE
 
AND
 $this->
£ss_bË_Çme
 != '')

87 
$this
->
CI
->
lßd
->
	`d©aba£
();

92 
$this
->
now
 = $this->
	`_g‘_time
();

96 ià(
$this
->
£ss_expœ©iÚ
 == 0)

98 
$this
->
£ss_expœ©iÚ
 = (60*60*24*365*2);

102 
$this
->
£ss_cook›_Çme
 = $this->
cook›_´efix
.$this->sess_cookie_name;

106 iàĞ! 
$this
->
	`£ss_»ad
())

108 
$this
->
	`£ss_ü—‹
();

112 
$this
->
	`£ss_upd©e
();

116 
$this
->
	`_æashd©a_sw“p
();

119 
$this
->
	`_æashd©a_m¬k
();

122 
$this
->
	`_£ss_gc
();

124 
	`log_mes§ge
('debug', "Session„outines successfully„un");

135 
funùiÚ
 
	$£ss_»ad
()

138 
$£ssiÚ
 = 
$this
->
CI
->
šput
->
	`cook›
($this->
£ss_cook›_Çme
);

141 ià(
$£ssiÚ
 ==ğ
FALSE
)

143 
	`log_mes§ge
('debug', 'A session cookie was‚ot found.');

144  
FALSE
;

148 
$Ën
 = 
	`¡¾’
(
$£ssiÚ
) - 40;

150 ià(
$Ën
 <= 0)

152 
	`log_mes§ge
('error', 'Session: The session cookie was‚ot signed.');

153  
FALSE
;

157 
$hmac
 = 
	`sub¡r
(
$£ssiÚ
, 
$Ën
);

158 
$£ssiÚ
 = 
	`sub¡r
($£ssiÚ, 0, 
$Ën
);

161 
$hmac_check
 = 
	`hash_hmac
('sha1', 
$£ssiÚ
, 
$this
->
’üy±iÚ_key
);

162 
$diff
 = 0;

164 
$i
 = 0; $i < 40; $i++)

166 
$xÜ
 = 
	`Üd
(
$hmac
[
$i
]è^ ord(
$hmac_check
[$i]);

167 
$diff
 |ğ
$xÜ
;

170 ià(
$diff
 !== 0)

172 
	`log_mes§ge
('error', 'Session: HMAC mismatch. The session cookie data did‚ot match what wasƒxpected.');

173 
$this
->
	`£ss_de¡roy
();

174  
FALSE
;

178 ià(
$this
->
£ss_’üy±_cook›
 =ğ
TRUE
)

180 
$£ssiÚ
 = 
$this
->
CI
->
’üy±
->
	`decode
($session);

184 
$£ssiÚ
 = 
$this
->
	`_un£rŸlize
($session);

187 iàĞ! 
	`is_¬¿y
(
$£ssiÚ
è
OR
 ! 
	`is£t
($session['session_id']) OR ! isset($session['ip_address']) OR ! isset($session['user_agent']) OR ! isset($session['last_activity']))

189 
$this
->
	`£ss_de¡roy
();

190  
FALSE
;

194 ià((
$£ssiÚ
['Ï¡_aùiv™y'] + 
$this
->
£ss_expœ©iÚ
è< $this->
now
)

196 
$this
->
	`£ss_de¡roy
();

197  
FALSE
;

201 ià(
$this
->
£ss_m©ch_
 =ğ
TRUE
 
AND
 
$£ssiÚ
['_add»ss'] !ğ$this->
CI
->
šput
->
	`_add»ss
())

203 
$this
->
	`£ss_de¡roy
();

204  
FALSE
;

208 ià(
$this
->
£ss_m©ch_u£¿g’t
 =ğ
TRUE
 
AND
 
	`Œim
(
$£ssiÚ
['u£r_ag’t']è!ğŒim(
	`sub¡r
($this->
CI
->
šput
->
	`u£r_ag’t
(), 0, 120)))

210 
$this
->
	`£ss_de¡roy
();

211  
FALSE
;

215 ià(
$this
->
£ss_u£_d©aba£
 ==ğ
TRUE
)

217 
$this
->
CI
->
db
->
	`wh”e
('£ssiÚ_id', 
$£ssiÚ
['session_id']);

219 ià(
$this
->
£ss_m©ch_
 =ğ
TRUE
)

221 
$this
->
CI
->
db
->
	`wh”e
('_add»ss', 
$£ssiÚ
['ip_address']);

224 ià(
$this
->
£ss_m©ch_u£¿g’t
 =ğ
TRUE
)

226 
$this
->
CI
->
db
->
	`wh”e
('u£r_ag’t', 
$£ssiÚ
['user_agent']);

229 
$qu”y
 = 
$this
->
CI
->
db
->
	`g‘
($this->
£ss_bË_Çme
);

232 ià(
$qu”y
->
	`num_rows
() == 0)

234 
$this
->
	`£ss_de¡roy
();

235  
FALSE
;

239 
$row
 = 
$qu”y
->
	`row
();

240 ià(
	`is£t
(
$row
->
u£r_d©a
è
AND
 $row->user_data != '')

242 
$cu¡om_d©a
 = 
$this
->
	`_un£rŸlize
(
$row
->
u£r_d©a
);

244 ià(
	`is_¬¿y
(
$cu¡om_d©a
))

246 
	`fÜ—ch
 (
$cu¡om_d©a
 
as
 
$key
 => 
$v®
)

248 
$£ssiÚ
[
$key
] = 
$v®
;

255 
$this
->
u£rd©a
 = 
$£ssiÚ
;

256 
	`un£t
(
$£ssiÚ
);

258  
TRUE
;

259 
	}
}

269 
funùiÚ
 
	$£ss_wr™e
()

272 ià(
$this
->
£ss_u£_d©aba£
 ==ğ
FALSE
)

274 
$this
->
	`_£t_cook›
();

279 
$cu¡om_u£rd©a
 = 
$this
->
u£rd©a
;

280 
$cook›_u£rd©a
 = 
	`¬¿y
();

285 
	`fÜ—ch
 (
	`¬¿y
('£ssiÚ_id','_add»ss','u£r_ag’t','Ï¡_aùiv™y'è
as
 
$v®
)

287 
	`un£t
(
$cu¡om_u£rd©a
[
$v®
]);

288 
$cook›_u£rd©a
[
$v®
] = 
$this
->
u£rd©a
[$val];

293 ià(
	`couÁ
(
$cu¡om_u£rd©a
) === 0)

295 
$cu¡om_u£rd©a
 = '';

300 
$cu¡om_u£rd©a
 = 
$this
->
	`_£rŸlize
($custom_userdata);

304 
$this
->
CI
->
db
->
	`wh”e
('£ssiÚ_id', $this->
u£rd©a
['session_id']);

305 
$this
->
CI
->
db
->
	`upd©e
($this->
£ss_bË_Çme
, 
	`¬¿y
('Ï¡_aùiv™y' => $this->
u£rd©a
['Ï¡_aùiv™y'], 'u£r_d©a' => 
$cu¡om_u£rd©a
));

310 
$this
->
	`_£t_cook›
(
$cook›_u£rd©a
);

311 
	}
}

321 
funùiÚ
 
	$£ss_ü—‹
()

323 
$£ssid
 = '';

324 
	`¡¾’
(
$£ssid
) < 32)

326 
$£ssid
 .ğ
	`mt_¿nd
(0, 
	`mt_g‘¿ndmax
());

330 
$£ssid
 .ğ
$this
->
CI
->
šput
->
	`_add»ss
();

332 
$this
->
u£rd©a
 = 
	`¬¿y
(

333 '£ssiÚ_id' => 
	`md5
(
	`uniqid
(
$£ssid
, 
TRUE
)),

334 '_add»ss' => 
$this
->
CI
->
šput
->
	`_add»ss
(),

335 'u£r_ag’t' => 
	`sub¡r
(
$this
->
CI
->
šput
->
	`u£r_ag’t
(), 0, 120),

336 'Ï¡_aùiv™y' => 
$this
->
now
,

342 ià(
$this
->
£ss_u£_d©aba£
 ==ğ
TRUE
)

344 
$this
->
CI
->
db
->
	`qu”y
($this->CI->db->
	`š£¹_¡ršg
($this->
£ss_bË_Çme
, $this->
u£rd©a
));

348 
$this
->
	`_£t_cook›
();

349 
	}
}

359 
funùiÚ
 
	$£ss_upd©e
()

362 ià((
$this
->
u£rd©a
['Ï¡_aùiv™y'] + $this->
£ss_time_to_upd©e
è>ğ$this->
now
)

369 
$Şd_£ssid
 = 
$this
->
u£rd©a
['session_id'];

370 
$Ãw_£ssid
 = '';

371 
	`¡¾’
(
$Ãw_£ssid
) < 32)

373 
$Ãw_£ssid
 .ğ
	`mt_¿nd
(0, 
	`mt_g‘¿ndmax
());

377 
$Ãw_£ssid
 .ğ
$this
->
CI
->
šput
->
	`_add»ss
();

380 
$Ãw_£ssid
 = 
	`md5
(
	`uniqid
($Ãw_£ssid, 
TRUE
));

383 
$this
->
u£rd©a
['£ssiÚ_id'] = 
$Ãw_£ssid
;

384 
$this
->
u£rd©a
['Ï¡_aùiv™y'] = $this->
now
;

388 
$cook›_d©a
 = 
NULL
;

391 ià(
$this
->
£ss_u£_d©aba£
 ==ğ
TRUE
)

394 
$cook›_d©a
 = 
	`¬¿y
();

395 
	`fÜ—ch
 (
	`¬¿y
('£ssiÚ_id','_add»ss','u£r_ag’t','Ï¡_aùiv™y'è
as
 
$v®
)

397 
$cook›_d©a
[
$v®
] = 
$this
->
u£rd©a
[$val];

400 
$this
->
CI
->
db
->
	`qu”y
($this->CI->db->
	`upd©e_¡ršg
($this->
£ss_bË_Çme
, 
	`¬¿y
('Ï¡_aùiv™y' => $this->
now
, '£ssiÚ_id' => 
$Ãw_£ssid
),‡¼ay('£ssiÚ_id' => 
$Şd_£ssid
)));

404 
$this
->
	`_£t_cook›
(
$cook›_d©a
);

405 
	}
}

415 
funùiÚ
 
	$£ss_de¡roy
()

418 ià(
$this
->
£ss_u£_d©aba£
 ==ğ
TRUE
 && 
	`is£t
($this->
u£rd©a
['session_id']))

420 
$this
->
CI
->
db
->
	`wh”e
('£ssiÚ_id', $this->
u£rd©a
['session_id']);

421 
$this
->
CI
->
db
->
	`d–‘e
($this->
£ss_bË_Çme
);

425 
	`£tcook›
(

426 
$this
->
£ss_cook›_Çme
,

427 
	`add¦ashes
(
	`£rŸlize
(
	`¬¿y
())),

428 (
$this
->
now
 - 31500000),

429 
$this
->
cook›_·th
,

430 
$this
->
cook›_domaš
,

435 
$this
->
u£rd©a
 = 
	`¬¿y
();

436 
	}
}

447 
funùiÚ
 
	$u£rd©a
(
$™em
)

449  ( ! 
	`is£t
(
$this
->
u£rd©a
[
$™em
])è? 
FALSE
 : $this->userdata[$item];

450 
	}
}

460 
funùiÚ
 
	$®l_u£rd©a
()

462  
$this
->
u£rd©a
;

463 
	}
}

475 
funùiÚ
 
£t_u£rd©a
(
$Ãwd©a
 = 
¬¿y
(), 
$Ãwv®
 = '')

477 ià(
is_¡ršg
(
$Ãwd©a
))

479 
$Ãwd©a
 = 
¬¿y
($Ãwd©¨=> 
$Ãwv®
);

482 ià(
couÁ
(
$Ãwd©a
) > 0)

484 
fÜ—ch
 (
$Ãwd©a
 
as
 
$key
 => 
$v®
)

486 
$this
->
u£rd©a
[
$key
] = 
$v®
;

490 
	g$this
->
£ss_wr™e
();

501 
funùiÚ
 
un£t_u£rd©a
(
$Ãwd©a
 = 
	$¬¿y
())

503 ià(
	`is_¡ršg
(
$Ãwd©a
))

505 
$Ãwd©a
 = 
	`¬¿y
($newdata => '');

508 ià(
	`couÁ
(
$Ãwd©a
) > 0)

510 
	`fÜ—ch
 (
$Ãwd©a
 
as
 
$key
 => 
$v®
)

512 
	`un£t
(
$this
->
u£rd©a
[
$key
]);

516 
$this
->
	`£ss_wr™e
();

517 
	}
}

530 
funùiÚ
 
£t_æashd©a
(
$Ãwd©a
 = 
¬¿y
(), 
$Ãwv®
 = '')

532 ià(
is_¡ršg
(
$Ãwd©a
))

534 
$Ãwd©a
 = 
¬¿y
($Ãwd©¨=> 
$Ãwv®
);

537 ià(
couÁ
(
$Ãwd©a
) > 0)

539 
fÜ—ch
 (
$Ãwd©a
 
as
 
$key
 => 
$v®
)

541 
$æashd©a_key
 = 
$this
->
æashd©a_key
.':Ãw:'.
$key
;

542 
	g$this
->
£t_u£rd©a
(
$æashd©a_key
, 
$v®
);

556 
funùiÚ
 
	$k“p_æashd©a
(
$key
)

562 
$Şd_æashd©a_key
 = 
$this
->
æashd©a_key
.':Şd:'.
$key
;

563 
$v®ue
 = 
$this
->
	`u£rd©a
(
$Şd_æashd©a_key
);

565 
$Ãw_æashd©a_key
 = 
$this
->
æashd©a_key
.':Ãw:'.
$key
;

566 
$this
->
	`£t_u£rd©a
(
$Ãw_æashd©a_key
, 
$v®ue
);

567 
	}
}

578 
funùiÚ
 
	$æashd©a
(
$key
)

580 
$æashd©a_key
 = 
$this
->
æashd©a_key
.':Şd:'.
$key
;

581  
$this
->
	`u£rd©a
(
$æashd©a_key
);

582 
	}
}

593 
funùiÚ
 
	$_æashd©a_m¬k
()

595 
$u£rd©a
 = 
$this
->
	`®l_u£rd©a
();

596 
	`fÜ—ch
 (
$u£rd©a
 
as
 
$Çme
 => 
$v®ue
)

598 
$·¹s
 = 
	`ex¶ode
(':Ãw:', 
$Çme
);

599 ià(
	`is_¬¿y
(
$·¹s
è&& 
	`couÁ
($parts) === 2)

601 
$Ãw_Çme
 = 
$this
->
æashd©a_key
.':Şd:'.
$·¹s
[1];

602 
$this
->
	`£t_u£rd©a
(
$Ãw_Çme
, 
$v®ue
);

603 
$this
->
	`un£t_u£rd©a
(
$Çme
);

606 
	}
}

617 
funùiÚ
 
	$_æashd©a_sw“p
()

619 
$u£rd©a
 = 
$this
->
	`®l_u£rd©a
();

620 
	`fÜ—ch
 (
$u£rd©a
 
as
 
$key
 => 
$v®ue
)

622 ià(
	`¡½os
(
$key
, ':old:'))

624 
$this
->
	`un£t_u£rd©a
(
$key
);

628 
	}
}

638 
funùiÚ
 
	$_g‘_time
()

640 ià(
	`¡¹Şow”
(
$this
->
time_»ã»nû
) == 'gmt')

642 
$now
 = 
	`time
();

643 
$time
 = 
	`mktime
(
	`gmd©e
("H", 
$now
), gmdate("i", $now), gmdate("s", $now), gmdate("m", $now), gmdate("d", $now), gmdate("Y", $now));

647 
$time
 = 
	`time
();

650  
$time
;

651 
	}
}

661 
funùiÚ
 
	$_£t_cook›
(
$cook›_d©a
 = 
NULL
)

663 ià(
	`is_nuÎ
(
$cook›_d©a
))

665 
$cook›_d©a
 = 
$this
->
u£rd©a
;

669 
$cook›_d©a
 = 
$this
->
	`_£rŸlize
($cookie_data);

671 ià(
$this
->
£ss_’üy±_cook›
 =ğ
TRUE
)

673 
$cook›_d©a
 = 
$this
->
CI
->
’üy±
->
	`’code
($cookie_data);

676 
$cook›_d©a
 .ğ
	`hash_hmac
('sha1', $cook›_d©a, 
$this
->
’üy±iÚ_key
);

678 
$expœe
 = (
$this
->
£ss_expœe_Ú_şo£
 ==ğ
TRUE
è? 0 : $this->
£ss_expœ©iÚ
 + 
	`time
();

681 
	`£tcook›
(

682 
$this
->
£ss_cook›_Çme
,

683 
$cook›_d©a
,

684 
$expœe
,

685 
$this
->
cook›_·th
,

686 
$this
->
cook›_domaš
,

687 
$this
->
cook›_£cu»


689 
	}
}

703 
funùiÚ
 
	$_£rŸlize
(
$d©a
)

705 ià(
	`is_¬¿y
(
$d©a
))

707 
	`fÜ—ch
 (
$d©a
 
as
 
$key
 => 
$v®
)

709 ià(
	`is_¡ršg
(
$v®
))

711 
$d©a
[
$key
] = 
	`¡r_»¶aû
('\\', '{{¦ash}}', 
$v®
);

717 ià(
	`is_¡ršg
(
$d©a
))

719 
$d©a
 = 
	`¡r_»¶aû
('\\', '{{slash}}', $data);

723  
	`£rŸlize
(
$d©a
);

724 
	}
}

738 
funùiÚ
 
	$_un£rŸlize
(
$d©a
)

740 
$d©a
 = @
	`un£rŸlize
(
	`¡r_¦ashes
($data));

742 ià(
	`is_¬¿y
(
$d©a
))

744 
	`fÜ—ch
 (
$d©a
 
as
 
$key
 => 
$v®
)

746 ià(
	`is_¡ršg
(
$v®
))

748 
$d©a
[
$key
] = 
	`¡r_»¶aû
('{{¦ash}}', '\\', 
$v®
);

752  
$d©a
;

755  (
	`is_¡ršg
(
$d©a
)è? 
	`¡r_»¶aû
('{{slash}}', '\\', $data) : $data;

756 
	}
}

769 
funùiÚ
 
	$_£ss_gc
()

771 ià(
$this
->
£ss_u£_d©aba£
 !ğ
TRUE
)

776 
	`¤ªd
(
	`time
());

777 ià((
	`¿nd
(è% 100è< 
$this
->
gc_´obab™y
)

779 
$expœe
 = 
$this
->
now
 - $this->
£ss_expœ©iÚ
;

781 
$this
->
CI
->
db
->
	`wh”e
("last_activity < {$expire}");

782 
$this
->
CI
->
db
->
	`d–‘e
($this->
£ss_bË_Çme
);

784 
	`log_mes§ge
('debug', 'Session garbage collection…erformed.');

786 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Sha1.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

45 şas 
	cCI_SHA1
 {

47 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

49 
	`log_mes§ge
('debug', "SHA1 Class Initialized");

59 
funùiÚ
 
	$g’”©e
(
$¡r
)

61 
$n
 = ((
	`¡¾’
(
$¡r
) + 8) >> 6) + 1;

63 
$i
 = 0; $˜< 
$n
 * 16; $i++)

65 
$x
[
$i
] = 0;

68 
$i
 = 0; $˜< 
	`¡¾’
(
$¡r
); $i++)

70 
$x
[
$i
 >> 2] |ğ
	`Üd
(
	`sub¡r
(
$¡r
, $i, 1)) << (24 - ($i % 4) * 8);

73 
$x
[
$i
 >> 2] |= 0x80 << (24 - ($i % 4) * 8);

75 
$x
[
$n
 * 16 - 1] = 
	`¡¾’
(
$¡r
) * 8;

77 
$a
 = 1732584193;

78 
$b
 = -271733879;

79 
$c
 = -1732584194;

80 
$d
 = 271733878;

81 
$e
 = -1009589776;

83 
$i
 = 0; $˜< 
	`couÁ
(
$x
); $i += 16)

85 
$Şda
 = 
$a
;

86 
$Şdb
 = 
$b
;

87 
$Şdc
 = 
$c
;

88 
$Şdd
 = 
$d
;

89 
$Şde
 = 
$e
;

91 
$j
 = 0; $j < 80; $j++)

93 ià(
$j
 < 16)

95 
$w
[
$j
] = 
$x
[
$i
 + $j];

99 
$w
[
$j
] = 
$this
->
	`_rŞ
($w[$j - 3] ^ $w[$j - 8] ^ $w[$j - 14] ^ $w[$j - 16], 1);

102 
$t
 = 
$this
->
	`_§ã_add
($this->_§ã_add($this->
	`_rŞ
(
$a
, 5), $this->
	`_á
(
$j
, 
$b
, 
$c
, 
$d
)), $this->_§ã_add($this->_§ã_add(
$e
, 
$w
[$j]), $this->
	`_kt
($j)));

104 
$e
 = 
$d
;

105 
$d
 = 
$c
;

106 
$c
 = 
$this
->
	`_rŞ
(
$b
, 30);

107 
$b
 = 
$a
;

108 
$a
 = 
$t
;

111 
$a
 = 
$this
->
	`_§ã_add
($a, 
$Şda
);

112 
$b
 = 
$this
->
	`_§ã_add
($b, 
$Şdb
);

113 
$c
 = 
$this
->
	`_§ã_add
($c, 
$Şdc
);

114 
$d
 = 
$this
->
	`_§ã_add
($d, 
$Şdd
);

115 
$e
 = 
$this
->
	`_§ã_add
($e, 
$Şde
);

118  
$this
->
	`_hex
(
$a
).$this->_hex(
$b
).$this->_hex(
$c
).$this->_hex(
$d
).$this->_hex(
$e
);

119 
	}
}

130 
funùiÚ
 
	$_hex
(
$¡r
)

132 
$¡r
 = 
	`dechex
($str);

134 ià(
	`¡¾’
(
$¡r
) == 7)

136 
$¡r
 = '0'.$str;

139  
$¡r
;

140 
	}
}

150 
funùiÚ
 
	$_á
(
$t
, 
$b
, 
$c
, 
$d
)

152 ià(
$t
 < 20)

153  (
$b
 & 
$c
è| ((~$bè& 
$d
);

154 ià(
$t
 < 40)

155  
$b
 ^ 
$c
 ^ 
$d
;

156 ià(
$t
 < 60)

157  (
$b
 & 
$c
è| ($b & 
$d
) | ($c & $d);

159  
$b
 ^ 
$c
 ^ 
$d
;

160 
	}
}

170 
funùiÚ
 
	$_kt
(
$t
)

172 ià(
$t
 < 20)

176 ià(
$t
 < 40)

180 ià(
$t
 < 60)

188 
	}
}

198 
funùiÚ
 
	$_§ã_add
(
$x
, 
$y
)

200 
$lsw
 = (
$x
 & 0xFFFFè+ (
$y
 & 0xFFFF);

201 
$msw
 = (
$x
 >> 16è+ (
$y
 >> 16è+ (
$lsw
 >> 16);

203  (
$msw
 << 16è| (
$lsw
 & 0xFFFF);

204 
	}
}

214 
funùiÚ
 
	$_rŞ
(
$num
, 
$út
)

216  (
$num
 << 
$út
è| 
$this
->
	`_z”o_fl
($num, 32 - $cnt);

217 
	}
}

227 
funùiÚ
 
	$_z”o_fl
(
$a
, 
$b
)

229 
$bš
 = 
	`decbš
(
$a
);

231 ià(
	`¡¾’
(
$bš
è< 
$b
)

233 
$bš
 = 0;

237 
$bš
 = 
	`sub¡r
($bš, 0, 
	`¡¾’
($bšè- 
$b
);

240 
$i
=0; $˜< 
$b
; $i++)

242 
$bš
 = "0".$bin;

245  
	`bšdec
(
$bš
);

246 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Table.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_TabË
 {

31 
v¬
 
	m$rows
 = 
¬¿y
();

32 
v¬
 
	m$h—dšg
 = 
¬¿y
();

33 
v¬
 
	m$auto_h—dšg
 = 
TRUE
;

34 
v¬
 
	m$ÿ±iÚ
 = 
NULL
;

35 
v¬
 
	m$‹m¶©e
 = 
NULL
;

36 
v¬
 
	m$Ãwlše
 = "\n";

37 
v¬
 
	m$em±y_ûÎs
 = "";

38 
v¬
 
	m$funùiÚ
 = 
FALSE
;

40 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

42 
	`log_mes§ge
('debug', "Table Class Initialized");

54 
funùiÚ
 
	$£t_‹m¶©e
(
$‹m¶©e
)

56 iàĞ! 
	`is_¬¿y
(
$‹m¶©e
))

58  
FALSE
;

61 
$this
->
‹m¶©e
 = 
$‹m¶©e
;

62 
	}
}

75 
funùiÚ
 
	$£t_h—dšg
()

77 
$¬gs
 = 
	`func_g‘_¬gs
();

78 
$this
->
h—dšg
 = $this->
	`_´•_¬gs
(
$¬gs
);

79 
	}
}

94 
funùiÚ
 
make_cŞumns
(
$¬¿y
 = 
¬¿y
(), 
$cŞ_lim™
 = 0)

96 iàĞ! 
is_¬¿y
(
$¬¿y
è
OR
 
couÁ
($array) == 0)

98  
FALSE
;

103 
	g$this
->
	gauto_h—dšg
 = 
FALSE
;

105 ià(
	g$cŞ_lim™
 == 0)

107  
$¬¿y
;

110 
	g$Ãw
 = 
¬¿y
();

111 
couÁ
(
$¬¿y
) > 0)

113 
	g$‹mp
 = 
¬¿y_¥liû
(
$¬¿y
, 0, 
$cŞ_lim™
);

115 ià(
couÁ
(
$‹mp
è< 
	g$cŞ_lim™
)

117 
	g$i
 = 
couÁ
(
$‹mp
); $˜< 
	g$cŞ_lim™
; $i++)

119 
	g$‹mp
[] = '&nbsp;';

123 
	g$Ãw
[] = 
$‹mp
;

126  
	g$Ãw
;

140 
funùiÚ
 
	$£t_em±y
(
$v®ue
)

142 
$this
->
em±y_ûÎs
 = 
$v®ue
;

143 
	}
}

156 
funùiÚ
 
	$add_row
()

158 
$¬gs
 = 
	`func_g‘_¬gs
();

159 
$this
->
rows
[] = $this->
	`_´•_¬gs
(
$¬gs
);

160 
	}
}

173 
funùiÚ
 
	$_´•_¬gs
(
$¬gs
)

178 ià(
	`is£t
(
$¬gs
[0]è
	`AND
 (
	`couÁ
($¬gsè=ğ1 && 
	`is_¬¿y
($args[0])))

181 iàĞ! 
	`is£t
(
$¬gs
[0]['data']))

183 
	`fÜ—ch
 (
$¬gs
[0] 
as
 
$key
 => 
$v®
)

185 ià(
	`is_¬¿y
(
$v®
è&& 
	`is£t
($val['data']))

187 
$¬gs
[
$key
] = 
$v®
;

191 
$¬gs
[
$key
] = 
	`¬¿y
('d©a' => 
$v®
);

198 
	`fÜ—ch
 (
$¬gs
 
as
 
$key
 => 
$v®
)

200 iàĞ! 
	`is_¬¿y
(
$v®
))

202 
$¬gs
[
$key
] = 
	`¬¿y
('d©a' => 
$v®
);

207  
$¬gs
;

208 
	}
}

219 
funùiÚ
 
	$£t_ÿ±iÚ
(
$ÿ±iÚ
)

221 
$this
->
ÿ±iÚ
 = 
$ÿ±iÚ
;

222 
	}
}

233 
funùiÚ
 
	$g’”©e
(
$bË_d©a
 = 
NULL
)

237 iàĞ! 
	`is_nuÎ
(
$bË_d©a
))

239 ià(
	`is_objeù
(
$bË_d©a
))

241 
$this
->
	`_£t_äom_objeù
(
$bË_d©a
);

243 
	`–£if
 (
	`is_¬¿y
(
$bË_d©a
))

245 
$£t_h—dšg
 = (
	`couÁ
(
$this
->
h—dšg
è=ğ0 
AND
 $this->
auto_h—dšg
 =ğ
FALSE
è? FALSE : 
TRUE
;

246 
$this
->
	`_£t_äom_¬¿y
(
$bË_d©a
, 
$£t_h—dšg
);

251 ià(
	`couÁ
(
$this
->
h—dšg
è=ğ0 
AND
 couÁ($this->
rows
) == 0)

257 
$this
->
	`_compe_‹m¶©e
();

260 
$funùiÚ
 = 
$this
->
funùiÚ
;

264 
$out
 = 
$this
->
‹m¶©e
['table_open'];

265 
$out
 .ğ
$this
->
Ãwlše
;

268 ià(
$this
->
ÿ±iÚ
)

270 
$out
 .ğ
$this
->
Ãwlše
;

271 
$out
 .ğ'<ÿ±iÚ>' . 
$this
->
ÿ±iÚ
 . '</caption>';

272 
$out
 .ğ
$this
->
Ãwlše
;

276 ià(
	`couÁ
(
$this
->
h—dšg
) > 0)

278 
$out
 .ğ
$this
->
‹m¶©e
['thead_open'];

279 
$out
 .ğ
$this
->
Ãwlše
;

280 
$out
 .ğ
$this
->
‹m¶©e
['heading_row_start'];

281 
$out
 .ğ
$this
->
Ãwlše
;

283 
	`fÜ—ch
 (
$this
->
h—dšg
 
as
 
$h—dšg
)

285 
$‹mp
 = 
$this
->
‹m¶©e
['heading_cell_start'];

287 
	`fÜ—ch
 (
$h—dšg
 
as
 
$key
 => 
$v®
)

289 ià(
$key
 != 'data')

291 
$‹mp
 = 
	`¡r_»¶aû
('<th', "<th $key='$val'", $temp);

295 
$out
 .ğ
$‹mp
;

296 
$out
 .ğ
	`is£t
(
$h—dšg
['data']) ? $heading['data'] : '';

297 
$out
 .ğ
$this
->
‹m¶©e
['heading_cell_end'];

300 
$out
 .ğ
$this
->
‹m¶©e
['heading_row_end'];

301 
$out
 .ğ
$this
->
Ãwlše
;

302 
$out
 .ğ
$this
->
‹m¶©e
['thead_close'];

303 
$out
 .ğ
$this
->
Ãwlše
;

307 ià(
	`couÁ
(
$this
->
rows
) > 0)

309 
$out
 .ğ
$this
->
‹m¶©e
['tbody_open'];

310 
$out
 .ğ
$this
->
Ãwlše
;

312 
$i
 = 1;

313 
	`fÜ—ch
 (
$this
->
rows
 
as
 
$row
)

315 iàĞ! 
	`is_¬¿y
(
$row
))

321 
$Çme
 = (
	`fmod
(
$i
++, 2)) ? '' : 'alt_';

323 
$out
 .ğ
$this
->
‹m¶©e
['row_'.
$Çme
.'start'];

324 
$out
 .ğ
$this
->
Ãwlše
;

326 
	`fÜ—ch
 (
$row
 
as
 
$ûÎ
)

328 
$‹mp
 = 
$this
->
‹m¶©e
['ûÎ_'.
$Çme
.'start'];

330 
	`fÜ—ch
 (
$ûÎ
 
as
 
$key
 => 
$v®
)

332 ià(
$key
 != 'data')

334 
$‹mp
 = 
	`¡r_»¶aû
('<td', "<td $key='$val'", $temp);

338 
$ûÎ
 = 
	`is£t
($cell['data']) ? $cell['data'] : '';

339 
$out
 .ğ
$‹mp
;

341 ià(
$ûÎ
 ==ğ"" 
OR
 $ûÎ ==ğ
NULL
)

343 
$out
 .ğ
$this
->
em±y_ûÎs
;

347 ià(
$funùiÚ
 !=ğ
FALSE
 && 
	`is_ÿÎabË
($function))

349 
$out
 .ğ
	`ÿÎ_u£r_func
(
$funùiÚ
, 
$ûÎ
);

353 
$out
 .ğ
$ûÎ
;

357 
$out
 .ğ
$this
->
‹m¶©e
['ûÎ_'.
$Çme
.'end'];

360 
$out
 .ğ
$this
->
‹m¶©e
['row_'.
$Çme
.'end'];

361 
$out
 .ğ
$this
->
Ãwlše
;

364 
$out
 .ğ
$this
->
‹m¶©e
['tbody_close'];

365 
$out
 .ğ
$this
->
Ãwlše
;

368 
$out
 .ğ
$this
->
‹m¶©e
['table_close'];

371 
$this
->
	`ş—r
();

373  
$out
;

374 
	}
}

384 
funùiÚ
 
	$ş—r
()

386 
$this
->
rows
 = 
	`¬¿y
();

387 
$this
->
h—dšg
 = 
	`¬¿y
();

388 
$this
->
auto_h—dšg
 = 
TRUE
;

389 
	}
}

400 
funùiÚ
 
	$_£t_äom_objeù
(
$qu”y
)

402 iàĞ! 
	`is_objeù
(
$qu”y
))

404  
FALSE
;

408 ià(
	`couÁ
(
$this
->
h—dšg
) == 0)

410 iàĞ! 
	`m‘hod_exi¡s
(
$qu”y
, 'list_fields'))

412  
FALSE
;

415 
$this
->
h—dšg
 = $this->
	`_´•_¬gs
(
$qu”y
->
	`li¡_f›lds
());

420 ià(
$qu”y
->
	`num_rows
() > 0)

422 
	`fÜ—ch
 (
$qu”y
->
	`»suÉ_¬¿y
(è
as
 
$row
)

424 
$this
->
rows
[] = $this->
	`_´•_¬gs
(
$row
);

427 
	}
}

438 
funùiÚ
 
	$_£t_äom_¬¿y
(
$d©a
, 
$£t_h—dšg
 = 
TRUE
)

440 iàĞ! 
	`is_¬¿y
(
$d©a
è
OR
 
	`couÁ
($data) == 0)

442  
FALSE
;

445 
$i
 = 0;

446 
	`fÜ—ch
 (
$d©a
 
as
 
$row
)

449 ià(
$i
 =ğ0 
AND
 
	`couÁ
(
$d©a
è> 1 AND couÁ(
$this
->
h—dšg
è=ğ0 AND 
$£t_h—dšg
 =ğ
TRUE
)

451 
$this
->
h—dšg
 = $this->
	`_´•_¬gs
(
$row
);

455 
$this
->
rows
[] = $this->
	`_´•_¬gs
(
$row
);

458 
$i
++;

460 
	}
}

470 
funùiÚ
 
	$_compe_‹m¶©e
()

472 ià(
$this
->
‹m¶©e
 =ğ
NULL
)

474 
$this
->
‹m¶©e
 = $this->
	`_deçuÉ_‹m¶©e
();

478 
$this
->
‹mp
 = $this->
	`_deçuÉ_‹m¶©e
();

479 
	`fÜ—ch
 (
	`¬¿y
('bË_İ’', 'th—d_İ’', 'th—d_şo£', 'h—dšg_row_¡¬t', 'h—dšg_row_’d', 'h—dšg_ûÎ_¡¬t', 'h—dšg_ûÎ_’d', 'tbody_İ’', 'tbody_şo£', 'row_¡¬t', 'row_’d', 'ûÎ_¡¬t', 'ûÎ_’d', 'row_®t_¡¬t', 'row_®t_’d', 'ûÎ_®t_¡¬t', 'ûÎ_®t_’d', 'bË_şo£'è
as
 
$v®
)

481 iàĞ! 
	`is£t
(
$this
->
‹m¶©e
[
$v®
]))

483 
$this
->
‹m¶©e
[
$v®
] = $this->
‹mp
[$val];

486 
	}
}

496 
funùiÚ
 
	$_deçuÉ_‹m¶©e
()

498  
	`¬¿y
 (

524 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Trackback.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_T¿ckback
 {

31 
v¬
 
	m$time_fÜm©
 = 'local';

32 
v¬
 
	m$ch¬£t
 = 'UTF-8';

33 
v¬
 
	m$d©a
 = 
¬¿y
('url' => '', 'title' => '', 'excerpt' => '', 'blog_name' => '', 'charset' => '');

34 
v¬
 
	m$cÚv”t_ascii
 = 
TRUE
;

35 
v¬
 
	m$»¥Ú£
 = '';

36 
v¬
 
	m$”rÜ_msg
 = 
¬¿y
();

43 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

45 
	`log_mes§ge
('debug', "Trackback Class Initialized");

57 
funùiÚ
 
	$£nd
(
$tb_d©a
)

59 iàĞ! 
	`is_¬¿y
(
$tb_d©a
))

61 
$this
->
	`£t_”rÜ
('The send() method must be…assed‡n‡rray');

62  
FALSE
;

66 
	`fÜ—ch
 (
	`¬¿y
('u¾', 't™Ë', 'exû½t', 'blog_Çme', 'pšg_u¾'è
as
 
$™em
)

68 iàĞ! 
	`is£t
(
$tb_d©a
[
$™em
]))

70 
$this
->
	`£t_”rÜ
('Requœed i‹m missšg: '.
$™em
);

71  
FALSE
;

74 
$™em
)

76 'pšg_u¾' : 
$$™em
 = 
$this
->
	`exŒaù_u¾s
(
$tb_d©a
[
$™em
]);

78 'exû½t' : 
$$™em
 = 
$this
->
	`lim™_ch¬aù”s
($this->
	`cÚv”t_xml
(
	`¡r_gs
(
	`¡r¦ashes
(
$tb_d©a
[
$™em
]))));

80 'u¾' : 
$$™em
 = 
	`¡r_»¶aû
('&#45;', '-', 
$this
->
	`cÚv”t_xml
(
	`¡r_gs
(
	`¡r¦ashes
(
$tb_d©a
[
$™em
]))));

82  : 
$$™em
 = 
$this
->
	`cÚv”t_xml
(
	`¡r_gs
(
	`¡r¦ashes
(
$tb_d©a
[
$™em
])));

87 ià(
$this
->
cÚv”t_ascii
 =ğ
TRUE
)

89 ià(
$™em
 == 'excerpt')

91 
$$™em
 = 
$this
->
	`cÚv”t_ascii
($$item);

93 
	`–£if
 (
$™em
 == 'title')

95 
$$™em
 = 
$this
->
	`cÚv”t_ascii
($$item);

97 
	`–£if
 (
$™em
 == 'blog_name')

99 
$$™em
 = 
$this
->
	`cÚv”t_ascii
($$item);

105 
$ch¬£t
 = ( ! 
	`is£t
(
$tb_d©a
['ch¬£t'])è? 
$this
->
ch¬£t
 : $tb_data['charset'];

107 
$d©a
 = "u¾=".
	`¿wu¾’code
(
$u¾
)."&t™Ë=".¿wu¾’code(
$t™Ë
)."&blog_Çme=".¿wu¾’code(
$blog_Çme
)."&exû½t=".¿wu¾’code(
$exû½t
)."&ch¬£t=".¿wu¾’code(
$ch¬£t
);

110 
$»tuº
 = 
TRUE
;

111 ià(
	`couÁ
(
$pšg_u¾
) > 0)

113 
	`fÜ—ch
 (
$pšg_u¾
 
as
 
$u¾
)

115 ià(
$this
->
	`´oûss
(
$u¾
, 
$d©a
è=ğ
FALSE
)

117 
$»tuº
 = 
FALSE
;

122  
$»tuº
;

123 
	}
}

138 
funùiÚ
 
	$»ûive
()

140 
	`fÜ—ch
 (
	`¬¿y
('u¾', 't™Ë', 'blog_Çme', 'exû½t'è
as
 
$v®
)

142 iàĞ! 
	`is£t
(
$_POST
[
$v®
]è
OR
 $_POST[$val] == '')

144 
$this
->
	`£t_”rÜ
('ThfŞlowšg„equœed POST v¬ŸbË i missšg: '.
$v®
);

145  
FALSE
;

148 
$this
->
d©a
['ch¬£t'] = ( ! 
	`is£t
(
$_POST
['ch¬£t'])è? 'auto' : 
	`¡¹ouµ”
(
	`Œim
($_POST['charset']));

150 ià(
$v®
 !ğ'u¾' && 
	`funùiÚ_exi¡s
('mb_convert_encoding'))

152 
$_POST
[
$v®
] = 
	`mb_cÚv”t_’codšg
($_POST[$v®], 
$this
->
ch¬£t
, $this->
d©a
['charset']);

155 
$_POST
[
$v®
] = ($v® !ğ'u¾'è? 
$this
->
	`cÚv”t_xml
(
	`¡r_gs
($_POST[$val])) : strip_tags($_POST[$val]);

157 ià(
$v®
 == 'excerpt')

159 
$_POST
['exû½t'] = 
$this
->
	`lim™_ch¬aù”s
($_POST['excerpt']);

162 
$this
->
d©a
[
$v®
] = 
$_POST
[$val];

165  
TRUE
;

166 
	}
}

181 
funùiÚ
 
£nd_”rÜ
(
$mes§ge
 = 'Incomplete Information')

183 
echo
 "<?xmÈv”siÚ=\"1.0\"ƒncodšg=\"utf-8\"?".">\n<»¥Ú£>\n<”rÜ>1</”rÜ>\n<mes§ge>".
$mes§ge
."</message>\n</response>";

184 
	gex™
;

198 
funùiÚ
 
	$£nd_sucûss
()

200 
echo
 "<?xml version=\"1.0\"ƒncoding=\"utf-8\"?".">\n<response>\n<error>0</error>\n</response>";

201 
ex™
;

202 
	}
}

213 
funùiÚ
 
	$d©a
(
$™em
)

215  ( ! 
	`is£t
(
$this
->
d©a
[
$™em
])) ? '' : $this->data[$item];

216 
	}
}

231 
funùiÚ
 
	$´oûss
(
$u¾
, 
$d©a
)

233 
$rg‘
 = 
	`·r£_u¾
(
$u¾
);

236 iàĞ! 
$å
 = @
	`fsockİ’
(
$rg‘
['host'], 80))

238 
$this
->
	`£t_”rÜ
('Inv®id CÚÃùiÚ: '.
$u¾
);

239  
FALSE
;

243 
$µ©h
 = ( ! 
	`is£t
(
$rg‘
['·th'])è? 
$u¾
 : $target['path'];

245 
$·th
 = (
	`is£t
(
$rg‘
['qu”y']è&& $rg‘['qu”y'] !ğ""è? 
$µ©h
.'?'.$target['query'] : $ppath;

248 ià(
$id
 = 
$this
->
	`g‘_id
(
$u¾
))

250 
$d©a
 = "tb_id=".
$id
."&".$data;

254 
	`åuts
 (
$å
, "POST " . 
$·th
 . " HTTP/1.0\r\n" );

255 
	`åuts
 (
$å
, "Ho¡: " . 
$rg‘
['host'] . "\r\n" );

256 
	`åuts
 (
$å
, "Content-type:‡pplication/x-www-form-urlencoded\r\n" );

257 
	`åuts
 (
$å
, "CÚ‹Á-Ëngth: " . 
	`¡¾’
(
$d©a
) . "\r\n" );

258 
	`åuts
 (
$å
, "Connection: close\r\n\r\n" );

259 
	`åuts
 (
$å
, 
$d©a
);

262 
$this
->
»¥Ú£
 = "";

264  ! 
	`ãof
(
$å
))

266 
$this
->
»¥Ú£
 .ğ
	`fg‘s
(
$å
, 128);

268 @
	`fşo£
(
$å
);

271 ià(
	`¡ri¡r
(
$this
->
»¥Ú£
, '<”rÜ>0</”rÜ>'è==ğ
FALSE
)

273 
$mes§ge
 = 'An unknownƒrror wasƒncountered';

275 ià(
	`´eg_m©ch
("/<mes§ge>(.*?)<\/mes§ge>/is", 
$this
->
»¥Ú£
, 
$m©ch
))

277 
$mes§ge
 = 
	`Œim
(
$m©ch
['1']);

280 
$this
->
	`£t_”rÜ
(
$mes§ge
);

281  
FALSE
;

284  
TRUE
;

285 
	}
}

300 
funùiÚ
 
	$exŒaù_u¾s
(
$u¾s
)

303 
$u¾s
 = 
	`´eg_»¶aû
("/\s*(\S+)\s*/", "\\1,", $urls);

306 
$u¾s
 = 
	`¡r_»¶aû
(",,", ",", $urls);

309 ià(
	`sub¡r
(
$u¾s
, -1) == ",")

311 
$u¾s
 = 
	`sub¡r
($urls, 0, -1);

315 
$u¾s
 = 
	`´eg_¥l™
('/[,]/', $urls);

318 
$u¾s
 = 
	`¬¿y_unique
($urls);

320 
	`¬¿y_w®k
(
$u¾s
, 
	`¬¿y
(
$this
, 'validate_url'));

322  
$u¾s
;

323 
	}
}

336 
funùiÚ
 
	$v®id©e_u¾
(
$u¾
)

338 
$u¾
 = 
	`Œim
($url);

340 ià(
	`sub¡r
(
$u¾
, 0, 4) != "http")

342 
$u¾
 = "http://".$url;

344 
	}
}

355 
funùiÚ
 
	$g‘_id
(
$u¾
)

357 
$tb_id
 = "";

359 ià(
	`¡½os
(
$u¾
, '?'è!=ğ
FALSE
)

361 
$tb_¬¿y
 = 
	`ex¶ode
('/', 
$u¾
);

362 
$tb_’d
 = 
$tb_¬¿y
[
	`couÁ
($tb_array)-1];

364 iàĞ! 
	`is_num”ic
(
$tb_’d
))

366 
$tb_’d
 = 
$tb_¬¿y
[
	`couÁ
($tb_array)-2];

369 
$tb_¬¿y
 = 
	`ex¶ode
('=', 
$tb_’d
);

370 
$tb_id
 = 
$tb_¬¿y
[
	`couÁ
($tb_array)-1];

374 
$u¾
 = 
	`¹rim
($url, '/');

376 
$tb_¬¿y
 = 
	`ex¶ode
('/', 
$u¾
);

377 
$tb_id
 = 
$tb_¬¿y
[
	`couÁ
($tb_array)-1];

379 iàĞ! 
	`is_num”ic
(
$tb_id
))

381 
$tb_id
 = 
$tb_¬¿y
[
	`couÁ
($tb_array)-2];

385 iàĞ! 
	`´eg_m©ch
 ("/^([0-9]+)$/", 
$tb_id
))

387  
FALSE
;

391  
$tb_id
;

393 
	}
}

404 
funùiÚ
 
	$cÚv”t_xml
(
$¡r
)

406 
$‹mp
 = '__TEMP_AMPERSANDS__';

408 
$¡r
 = 
	`´eg_»¶aû
("/&#(\d+);/", "$temp\\1;", $str);

409 
$¡r
 = 
	`´eg_»¶aû
("/&(\w+);/", "$temp\\1;", $str);

411 
$¡r
 = 
	`¡r_»¶aû
(
	`¬¿y
("&","<",">","\"", "'", "-"),

412 
	`¬¿y
("&amp;", "&lt;", "&gt;", "&quot;", "&#39;", "&#45;"),

413 
$¡r
);

415 
$¡r
 = 
	`´eg_»¶aû
("/$temp(\d+);/","&#\\1;",$str);

416 
$¡r
 = 
	`´eg_»¶aû
("/$temp(\w+);/","&\\1;", $str);

418  
$¡r
;

419 
	}
}

434 
funùiÚ
 
lim™_ch¬aù”s
(
$¡r
, 
$n
 = 500, 
$’d_ch¬
 = '&#8230;')

436 ià(
¡¾’
(
$¡r
è< 
$n
)

438  
$¡r
;

441 
	g$¡r
 = 
´eg_»¶aû
("/\s+/", ' ', 
¡r_»¶aû
(
¬¿y
("\r\n", "\r", "\n"), ' ', 
$¡r
));

443 ià(
¡¾’
(
$¡r
è<ğ
$n
)

445  
$¡r
;

448 
	g$out
 = "";

449 
fÜ—ch
 (
ex¶ode
(' ', 
Œim
(
$¡r
)è
as
 
$v®
)

451 
	g$out
 .ğ
$v®
.' ';

452 ià(
¡¾’
(
$out
è>ğ
$n
)

454  
Œim
(
$out
).
$’d_ch¬
;

471 
funùiÚ
 
	$cÚv”t_ascii
(
$¡r
)

473 
$couÁ
 = 1;

474 
$out
 = '';

475 
$‹mp
 = 
	`¬¿y
();

477 
$i
 = 0, 
$s
 = 
	`¡¾’
(
$¡r
); $i < $s; $i++)

479 
$Üdš®
 = 
	`Üd
(
$¡r
[
$i
]);

481 ià(
$Üdš®
 < 128)

483 
$out
 .ğ
$¡r
[
$i
];

487 ià(
	`couÁ
(
$‹mp
) == 0)

489 
$couÁ
 = (
$Üdš®
 < 224) ? 2 : 3;

492 
$‹mp
[] = 
$Üdš®
;

494 ià(
	`couÁ
(
$‹mp
è=ğ
$couÁ
)

496 
$numb”
 = (
$couÁ
 =ğ3è? ((
$‹mp
['0'] % 16) * 4096) + (($temp['1'] % 64) * 64) + ($temp['2'] % 64) : (($temp['0'] % 32) * 64) + ($temp['1'] % 64);

498 
$out
 .ğ'&#'.
$numb”
.';';

499 
$couÁ
 = 1;

500 
$‹mp
 = 
	`¬¿y
();

505  
$out
;

506 
	}
}

517 
funùiÚ
 
	$£t_”rÜ
(
$msg
)

519 
	`log_mes§ge
('”rÜ', 
$msg
);

520 
$this
->
”rÜ_msg
[] = 
$msg
;

521 
	}
}

533 
funùiÚ
 
di¥Ïy_”rÜs
(
$İ’
 = '<p>', 
$şo£
 = '</p>')

535 
$¡r
 = '';

536 
fÜ—ch
 (
$this
->
”rÜ_msg
 
as
 
$v®
)

538 
	g$¡r
 .ğ
$İ’
.
$v®
.
$şo£
;

541  
	g$¡r
;

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Typography.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Typog¿phy
 {

30 
v¬
 
	m$block_–em’ts
 = 'address|blockquote|div|dl|fieldset|form|h\d|hr|noscript|object|ol|p|pre|script|table|ul';

33 
v¬
 
	m$sk_–em’ts
 = 'p|pre|ol|ul|dl|object|table|h\d';

36 
v¬
 
	m$šlše_–em’ts
 = 'a|abbr|acronym|b|bdo|big|br|button|cite|code|del|dfn|em|i|img|ins|input|label|map|kbd|q|samp|select|small|span|strong|sub|sup|textarea|tt|var';

39 
v¬
 
	m$šÃr_block_»quœed
 = 
¬¿y
('blockquote');

42 
v¬
 
	m$Ï¡_block_–em’t
 = '';

45 
v¬
 
	m$´Ùeù_b¿ûd_quÙes
 = 
FALSE
;

63 
funùiÚ
 
	$auto_typog¿phy
(
$¡r
, 
$»duû_lšeb»aks
 = 
FALSE
)

65 ià(
$¡r
 == '')

71 ià(
	`¡½os
(
$¡r
, "\r"è!=ğ
FALSE
)

73 
$¡r
 = 
	`¡r_»¶aû
(
	`¬¿y
("\r\n", "\r"), "\n", $str);

78 ià(
$»duû_lšeb»aks
 ==ğ
TRUE
)

80 
$¡r
 = 
	`´eg_»¶aû
("/\n\n+/", "\n\n", $str);

84 
$html_comm’ts
 = 
	`¬¿y
();

85 ià(
	`¡½os
(
$¡r
, '<!--'è!=ğ
FALSE
)

87 ià(
	`´eg_m©ch_®l
("#(<!\-\-.*?\-\->)#s", 
$¡r
, 
$m©ches
))

89 
$i
 = 0, 
$tÙ®
 = 
	`couÁ
(
$m©ches
[0]); $i < $total; $i++)

91 
$html_comm’ts
[] = 
$m©ches
[0][
$i
];

92 
$¡r
 = 
	`¡r_»¶aû
(
$m©ches
[0][
$i
], '{@HC'.$i.'}', $str);

99 ià(
	`¡½os
(
$¡r
, '<´e'è!=ğ
FALSE
)

101 
$¡r
 = 
	`´eg_»¶aû_ÿÎback
("#<´e.*?>.*?</´e>#si", 
	`¬¿y
(
$this
, '_protect_characters'), $str);

105 
$¡r
 = 
	`´eg_»¶aû_ÿÎback
("#<.+?>#si", 
	`¬¿y
(
$this
, '_protect_characters'), $str);

108 ià(
$this
->
´Ùeù_b¿ûd_quÙes
 ==ğ
TRUE
)

110 
$¡r
 = 
	`´eg_»¶aû_ÿÎback
("#\{.+?\}#si", 
	`¬¿y
(
$this
, '_protect_characters'), $str);

116 
$¡r
 = 
	`´eg_»¶aû
("#<(/*)(".
$this
->
šlše_–em’ts
.")([ >])#i", "{@TAG}\\1\\2\\3", $str);

127 
$chunks
 = 
	`´eg_¥l™
('/(<(?:[^<>]+(?:"[^"]*"|\'[^\']*\')?)+>)/', 
$¡r
, -1, 
PREG_SPLIT_DELIM_CAPTURE
|
PREG_SPLIT_NO_EMPTY
);

130 
$¡r
 = '';

131 
$´oûss
 = 
TRUE
;

132 
$·¿g¿ph
 = 
FALSE
;

133 
$cu¼’t_chunk
 = 0;

134 
$tÙ®_chunks
 = 
	`couÁ
(
$chunks
);

136 
	`fÜ—ch
 (
$chunks
 
as
 
$chunk
)

138 
$cu¼’t_chunk
++;

142 ià(
	`´eg_m©ch
("#<(/*)(".
$this
->
block_–em’ts
.").*?>#", 
$chunk
, 
$m©ch
))

144 ià(
	`´eg_m©ch
("#".
$this
->
sk_–em’ts
."#", 
$m©ch
[2]))

146 
$´oûss
 = (
$m©ch
[1] =ğ'/'è? 
TRUE
 : 
FALSE
;

149 ià(
$m©ch
[1] == '')

151 
$this
->
Ï¡_block_–em’t
 = 
$m©ch
[2];

154 
$¡r
 .ğ
$chunk
;

158 ià(
$´oûss
 =ğ
FALSE
)

160 
$¡r
 .ğ
$chunk
;

165 ià(
$cu¼’t_chunk
 =ğ
$tÙ®_chunks
)

167 
$chunk
 .= "\n";

171 
$¡r
 .ğ
$this
->
	`_fÜm©_Ãwlšes
(
$chunk
);

175 iàĞ! 
	`´eg_m©ch
("/^\s*<(?:".
$this
->
block_–em’ts
.")/i", 
$¡r
))

177 
$¡r
 = 
	`´eg_»¶aû
("/^(.*?)<(".
$this
->
block_–em’ts
.")/i", '<p>$1</p><$2', $str);

181 
$¡r
 = 
$this
->
	`fÜm©_ch¬aù”s
($str);

184 
$i
 = 0, 
$tÙ®
 = 
	`couÁ
(
$html_comm’ts
); $i < $total; $i++)

189 
$¡r
 = 
	`´eg_»¶aû
('#(?(?=<p>\{@HC'.
$i
.'\})<p>\{@HC'.$i.'\}(\s*</p>)|\{@HC'.$i.'\})#s', 
$html_comm’ts
[$i], $str);

193 
$bË
 = 
	`¬¿y
(

204 '#<p></p><('.
$this
->
block_–em’ts
.')#' => '<$1',

207 '#(&nb¥;\s*)+<('.
$this
->
block_–em’ts
.')#' => ' <$2',

228 ià(
$»duû_lšeb»aks
 ==ğ
TRUE
)

230 
$bË
['#<p>\n*</p>#'] = '';

236 
$bË
['#<p></p>#'] = '<p>&nbsp;</p>';

239  
	`´eg_»¶aû
(
	`¬¿y_keys
(
$bË
), $bË, 
$¡r
);

256 
funùiÚ
 
	$fÜm©_ch¬aù”s
(
$¡r
)

258 
$bË
;

260 iàĞ! 
	`is£t
(
$bË
))

262 
$bË
 = 
	`¬¿y
(

306  
	`´eg_»¶aû
(
	`¬¿y_keys
(
$bË
), $bË, 
$¡r
);

307 
	}
}

320 
funùiÚ
 
	$_fÜm©_Ãwlšes
(
$¡r
)

322 ià(
$¡r
 == '')

324  
$¡r
;

327 ià(
	`¡½os
(
$¡r
, "\n"è==ğ
FALSE
 && ! 
	`š_¬¿y
(
$this
->
Ï¡_block_–em’t
, $this->
šÃr_block_»quœed
))

329  
$¡r
;

333 
$¡r
 = 
	`¡r_»¶aû
("\n\n", "</p>\n\n<p>", $str);

336 
$¡r
 = 
	`´eg_»¶aû
("/([^\n])(\n)([^\n])/", "\\1<br />\\2\\3", $str);

339 ià(
$¡r
 != "\n")

344 
$¡r
 = '<p>'.
	`¹rim
($str).'</p>';

349 
$¡r
 = 
	`´eg_»¶aû
("/<p><\/p>(.*)/", "\\1", $str, 1);

351  
$¡r
;

352 
	}
}

368 
funùiÚ
 
	$_´Ùeù_ch¬aù”s
(
$m©ch
)

370  
	`¡r_»¶aû
(
	`¬¿y
("'",'"','--',' '),‡¼ay('{@SQ}', '{@DQ}', '{@DD}', '{@NBS}'), 
$m©ch
[0]);

371 
	}
}

382 
funùiÚ
 
	$Æ2br_exû±_´e
(
$¡r
)

384 
$ex
 = 
	`ex¶ode
("´e>",
$¡r
);

385 
$ù
 = 
	`couÁ
(
$ex
);

387 
$Ãw¡r
 = "";

388 
$i
 = 0; $˜< 
$ù
; $i++)

390 ià((
$i
 % 2) == 0)

392 
$Ãw¡r
 .ğ
	`Æ2br
(
$ex
[
$i
]);

396 
$Ãw¡r
 .ğ
$ex
[
$i
];

399 ià(
$ù
 - 1 !ğ
$i
)

400 
$Ãw¡r
 .= "pre>";

403  
$Ãw¡r
;

404 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Unit_test.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_Un™_‹¡
 {

31 
v¬
 
	m$aùive
 = 
TRUE
;

32 
v¬
 
	m$»suÉs
 = 
¬¿y
();

33 
v¬
 
	m$¡riù
 = 
FALSE
;

34 
v¬
 
	m$_‹m¶©e
 = 
NULL
;

35 
v¬
 
	m$_‹m¶©e_rows
 = 
NULL
;

36 
v¬
 
	m$_‹¡_™ems_visibË
 = 
¬¿y
();

38 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

41 
$this
->
_‹¡_™ems_visibË
 = 
	`¬¿y
 (

51 
	`log_mes§ge
('debug', "Unit Testing Class Initialized");

65 
funùiÚ
 
	`£t_‹¡_™ems
(
$™ems
 = 
	$¬¿y
())

67 iàĞ! 
	`em±y
(
$™ems
è
AND
 
	`is_¬¿y
($items))

69 
$this
->
_‹¡_™ems_visibË
 = 
$™ems
;

71 
	}
}

86 
funùiÚ
 
run
(
$‹¡
, 
$ex³ùed
 = 
TRUE
, 
$‹¡_Çme
 = 'undefšed', 
$nÙes
 = '')

88 ià(
$this
->
aùive
 =ğ
FALSE
)

90  
FALSE
;

93 ià(
š_¬¿y
(
$ex³ùed
, 
¬¿y
('is_objeù', 'is_¡ršg', 'is_boŞ', 'is_Œue', 'is_çl£', 'is_št', 'is_num”ic', 'is_æßt', 'is_doubË', 'is_¬¿y', 'is_nuÎ'), 
TRUE
))

95 
	g$ex³ùed
 = 
¡r_»¶aû
('is_æßt', 'is_doubË', 
$ex³ùed
);

96 
	g$»suÉ
 = (
$ex³ùed
(
$‹¡
)è? 
TRUE
 : 
FALSE
;

97 
	g$exty³
 = 
¡r_»¶aû
(
¬¿y
('Œue', 'çl£'), 'boŞ', sŒ_»¶aû('is_', '', 
$ex³ùed
));

101 ià(
	g$this
->
	g¡riù
 =ğ
TRUE
)

102 
$»suÉ
 = (
$‹¡
 ==ğ
$ex³ùed
è? 
TRUE
 : 
FALSE
;

104 
	g$»suÉ
 = (
$‹¡
 =ğ
$ex³ùed
è? 
TRUE
 : 
FALSE
;

106 
	g$exty³
 = 
g‘ty³
(
$ex³ùed
);

109 
	g$back
 = 
$this
->
_backŒaû
();

111 
	g$»pÜt
[] = 
¬¿y
 (

112 '‹¡_Çme' => 
$‹¡_Çme
,

113 '‹¡_d©©y³' => 
g‘ty³
(
$‹¡
),

114 '»s_d©©y³' => 
$exty³
,

115 '»suÉ' => (
$»suÉ
 ==ğ
TRUE
) ? 'passed' : 'failed',

116 'fe' => 
$back
['file'],

117 'lše' => 
$back
['line'],

118 'nÙes' => 
$nÙes


121 
	g$this
->
	g»suÉs
[] = 
$»pÜt
;

123 (
	g$this
->
»pÜt
(
$this
->
»suÉ
(
$»pÜt
)));

136 
funùiÚ
 
»pÜt
(
$»suÉ
 = 
	$¬¿y
())

138 ià(
	`couÁ
(
$»suÉ
) == 0)

140 
$»suÉ
 = 
$this
->
	`»suÉ
();

143 
$CI
 =& 
	`g‘_š¡ªû
();

144 
$CI
->
lßd
->
	`Ïnguage
('unit_test');

146 
$this
->
	`_·r£_‹m¶©e
();

148 
$r
 = '';

149 
	`fÜ—ch
 (
$»suÉ
 
as
 
$»s
)

151 
$bË
 = '';

153 
	`fÜ—ch
 (
$»s
 
as
 
$key
 => 
$v®
)

155 ià(
$key
 =ğ
$CI
->
Ïng
->
	`lše
('ut_result'))

157 ià(
$v®
 =ğ
$CI
->
Ïng
->
	`lše
('ut_passed'))

159 
$v®
 = '<span style="color: #0C0;">'.$val.'</span>';

161 
	`–£if
 (
$v®
 =ğ
$CI
->
Ïng
->
	`lše
('ut_failed'))

163 
$v®
 = '<span style="color: #C00;">'.$val.'</span>';

167 
$‹mp
 = 
$this
->
_‹m¶©e_rows
;

168 
$‹mp
 = 
	`¡r_»¶aû
('{™em}', 
$key
, $temp);

169 
$‹mp
 = 
	`¡r_»¶aû
('{»suÉ}', 
$v®
, $temp);

170 
$bË
 .ğ
$‹mp
;

173 
$r
 .ğ
	`¡r_»¶aû
('{rows}', 
$bË
, 
$this
->
_‹m¶©e
);

176  
$r
;

177 
	}
}

190 
funùiÚ
 
	$u£_¡riù
(
$¡©e
 = 
TRUE
)

192 
$this
->
¡riù
 = (
$¡©e
 =ğ
FALSE
è? FALSE : 
TRUE
;

193 
	}
}

206 
funùiÚ
 
	$aùive
(
$¡©e
 = 
TRUE
)

208 
$this
->
aùive
 = (
$¡©e
 =ğ
FALSE
è? FALSE : 
TRUE
;

209 
	}
}

221 
funùiÚ
 
»suÉ
(
$»suÉs
 = 
	$¬¿y
())

223 
$CI
 =& 
	`g‘_š¡ªû
();

224 
$CI
->
lßd
->
	`Ïnguage
('unit_test');

226 ià(
	`couÁ
(
$»suÉs
) == 0)

228 
$»suÉs
 = 
$this
->
»suÉs
;

231 
$»tv®
 = 
	`¬¿y
();

232 
	`fÜ—ch
 (
$»suÉs
 
as
 
$»suÉ
)

234 
$‹mp
 = 
	`¬¿y
();

235 
	`fÜ—ch
 (
$»suÉ
 
as
 
$key
 => 
$v®
)

237 iàĞ! 
	`š_¬¿y
(
$key
, 
$this
->
_‹¡_™ems_visibË
))

242 ià(
	`is_¬¿y
(
$v®
))

244 
	`fÜ—ch
 (
$v®
 
as
 
$k
 => 
$v
)

246 ià(
FALSE
 !=ğ(
$lše
 = 
$CI
->
Ïng
->
	`lše
(
	`¡¹Şow”
('ut_'.
$v
))))

248 
$v
 = 
$lše
;

250 
$‹mp
[
$CI
->
Ïng
->
	`lše
('ut_'.
$k
)] = 
$v
;

255 ià(
FALSE
 !=ğ(
$lše
 = 
$CI
->
Ïng
->
	`lše
(
	`¡¹Şow”
('ut_'.
$v®
))))

257 
$v®
 = 
$lše
;

259 
$‹mp
[
$CI
->
Ïng
->
	`lše
('ut_'.
$key
)] = 
$v®
;

263 
$»tv®
[] = 
$‹mp
;

266  
$»tv®
;

267 
	}
}

280 
funùiÚ
 
	$£t_‹m¶©e
(
$‹m¶©e
)

282 
$this
->
_‹m¶©e
 = 
$‹m¶©e
;

283 
	}
}

295 
funùiÚ
 
	$_backŒaû
()

297 ià(
	`funùiÚ_exi¡s
('debug_backtrace'))

299 
$back
 = 
	`debug_backŒaû
();

301 
$fe
 = ( ! 
	`is£t
(
$back
['1']['file'])) ? '' : $back['1']['file'];

302 
$lše
 = ( ! 
	`is£t
(
$back
['1']['line'])) ? '' : $back['1']['line'];

304  
	`¬¿y
('fe' => 
$fe
, 'lše' => 
$lše
);

306  
	`¬¿y
('file' => 'Unknown', 'line' => 'Unknown');

307 
	}
}

317 
funùiÚ
 
	$_deçuÉ_‹m¶©e
()

319 
$this
->
_‹m¶©e
 = "\n".'<table style="width:100%; font-size:small; margin:10px 0; border-collapse:collapse; border:1px solid #CCC;">';

320 
$this
->
_‹m¶©e
 .= '{rows}';

321 
$this
->
_‹m¶©e
 .= "\n".'</table>';

323 
$this
->
_‹m¶©e_rows
 = "\n\t".'<tr>';

324 
$this
->
_‹m¶©e_rows
 .= "\n\t\t".'<th style="text-align:†eft; border-bottom:1px solid #CCC;">{item}</th>';

325 
$this
->
_‹m¶©e_rows
 .= "\n\t\t".'<td style="border-bottom:1px solid #CCC;">{result}</td>';

326 
$this
->
_‹m¶©e_rows
 .= "\n\t".'</tr>';

327 
	}
}

339 
funùiÚ
 
	$_·r£_‹m¶©e
()

341 iàĞ! 
	`is_nuÎ
(
$this
->
_‹m¶©e_rows
))

346 ià(
	`is_nuÎ
(
$this
->
_‹m¶©e
))

348 
$this
->
	`_deçuÉ_‹m¶©e
();

352 iàĞ! 
	`´eg_m©ch
("/\{rows\}(.*?)\{\/rows\}/si", 
$this
->
_‹m¶©e
, 
$m©ch
))

354 
$this
->
	`_deçuÉ_‹m¶©e
();

358 
$this
->
_‹m¶©e_rows
 = 
$m©ch
['1'];

359 
$this
->
_‹m¶©e
 = 
	`¡r_»¶aû
(
$m©ch
['0'], '{rows}', $this->_template);

360 
	}
}

372 
funùiÚ
 
	$is_Œue
(
$‹¡
)

374  (
	`is_boŞ
(
$‹¡
è
AND
 $‹¡ ==ğ
TRUE
è? TRUE : 
FALSE
;

375 
	}
}

376 
funùiÚ
 
	$is_çl£
(
$‹¡
)

378  (
	`is_boŞ
(
$‹¡
è
AND
 $‹¡ ==ğ
FALSE
è? 
TRUE
 : FALSE;

379 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Upload.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_U¶ßd
 {

29 
public
 
	m$max_size
 = 0;

30 
public
 
	m$max_width
 = 0;

31 
public
 
	m$max_height
 = 0;

32 
public
 
	m$max_f’ame
 = 0;

33 
public
 
	m$®lowed_ty³s
 = "";

34 
public
 
	m$fe_‹mp
 = "";

35 
public
 
	m$fe_Çme
 = "";

36 
public
 
	m$Üig_Çme
 = "";

37 
public
 
	m$fe_ty³
 = "";

38 
public
 
	m$fe_size
 = "";

39 
public
 
	m$fe_ext
 = "";

40 
public
 
	m$u¶ßd_·th
 = "";

41 
public
 
	m$ov”wr™e
 = 
FALSE
;

42 
public
 
	m$’üy±_Çme
 = 
FALSE
;

43 
public
 
	m$is_image
 = 
FALSE
;

44 
public
 
	m$image_width
 = '';

45 
public
 
	m$image_height
 = '';

46 
public
 
	m$image_ty³
 = '';

47 
public
 
	m$image_size_¡r
 = '';

48 
public
 
	m$”rÜ_msg
 = 
¬¿y
();

49 
public
 
	m$mimes
 = 
¬¿y
();

50 
public
 
	m$»move_¥aûs
 = 
TRUE
;

51 
public
 
	m$xss_ş—n
 = 
FALSE
;

52 
public
 
	m$‹mp_´efix
 = "temp_file_";

53 
public
 
	m$ş›Á_Çme
 = '';

55 
´Ùeùed
 
	m$_fe_Çme_ov”ride
 = '';

62 
public
 
funùiÚ
 
__cÚ¡ruù
(
$´İs
 = 
	$¬¿y
())

64 ià(
	`couÁ
(
$´İs
) > 0)

66 
$this
->
	`š™Ÿlize
(
$´İs
);

69 
	`log_mes§ge
('debug', "Upload Class Initialized");

80 
public
 
funùiÚ
 
	`š™Ÿlize
(
$cÚfig
 = 
	$¬¿y
())

82 
$deçuÉs
 = 
	`¬¿y
(

95 'ov”wr™e' => 
FALSE
,

96 '’üy±_Çme' => 
FALSE
,

97 'is_image' => 
FALSE
,

102 '”rÜ_msg' => 
	`¬¿y
(),

103 'mimes' => 
	`¬¿y
(),

104 '»move_¥aûs' => 
TRUE
,

105 'xss_ş—n' => 
FALSE
,

111 
	`fÜ—ch
 (
$deçuÉs
 
as
 
$key
 => 
$v®
)

113 ià(
	`is£t
(
$cÚfig
[
$key
]))

115 
$m‘hod
 = '£t_'.
$key
;

116 ià(
	`m‘hod_exi¡s
(
$this
, 
$m‘hod
))

118 
$this
->
	`$m‘hod
(
$cÚfig
[
$key
]);

122 
$this
->
$key
 = 
$cÚfig
[$key];

127 
$this
->
$key
 = 
$v®
;

133 
$this
->
_fe_Çme_ov”ride
 = $this->
fe_Çme
;

134 
	}
}

143 
public
 
funùiÚ
 
do_u¶ßd
(
$f›ld
 = 'userfile')

147 iàĞ! 
is£t
(
$_FILES
[
$f›ld
]))

149 
$this
->
£t_”rÜ
('upload_no_file_selected');

150  
	gFALSE
;

154 iàĞ! 
	g$this
->
v®id©e_u¶ßd_·th
())

157  
	gFALSE
;

161 iàĞ! 
is_u¶ßded_fe
(
$_FILES
[
$f›ld
]['tmp_name']))

163 
	g$”rÜ
 = ( ! 
is£t
(
$_FILES
[
$f›ld
]['error'])) ? 4 : $_FILES[$field]['error'];

165 
	g$”rÜ
)

168 
$this
->
£t_”rÜ
('upload_file_exceeds_limit');

171 
$this
->
£t_”rÜ
('upload_file_exceeds_form_limit');

174 
$this
->
£t_”rÜ
('upload_file_partial');

177 
$this
->
£t_”rÜ
('upload_no_file_selected');

180 
$this
->
£t_”rÜ
('upload_no_temp_directory');

183 
$this
->
£t_”rÜ
('upload_unable_to_write_file');

186 
$this
->
£t_”rÜ
('upload_stopped_by_extension');

188  : 
$this
->
£t_”rÜ
('upload_no_file_selected');

192  
	gFALSE
;

197 
	g$this
->
	gfe_‹mp
 = 
$_FILES
[
$f›ld
]['tmp_name'];

198 
	g$this
->
	gfe_size
 = 
$_FILES
[
$f›ld
]['size'];

199 
	g$this
->
_fe_mime_ty³
(
$_FILES
[
$f›ld
]);

200 
	g$this
->
	gfe_ty³
 = 
´eg_»¶aû
("/^(.+?);.*$/", "\\1", 
$this
->
fe_ty³
);

201 
	g$this
->
	gfe_ty³
 = 
¡¹Şow”
(
Œim
(
¡r¦ashes
(
$this
->
fe_ty³
), '"'));

202 
	g$this
->
	gfe_Çme
 = 
$this
->
_´•_f’ame
(
$_FILES
[
$f›ld
]['name']);

203 
	g$this
->
	gfe_ext
 = 
$this
->
g‘_ex‹nsiÚ
($this->
fe_Çme
);

204 
	g$this
->
	gş›Á_Çme
 = 
$this
->
fe_Çme
;

207 iàĞ! 
	g$this
->
is_®lowed_f‘y³
())

209 
	g$this
->
£t_”rÜ
('upload_invalid_filetype');

210  
	gFALSE
;

214 ià(
	g$this
->
	g_fe_Çme_ov”ride
 != '')

216 
$this
->
fe_Çme
 = $this->
_´•_f’ame
($this->
_fe_Çme_ov”ride
);

219 ià(
¡½os
(
$this
->
_fe_Çme_ov”ride
, '.'è==ğ
FALSE
)

221 
$this
->
fe_Çme
 .ğ$this->
fe_ext
;

227 
	g$this
->
	gfe_ext
 = 
$this
->
g‘_ex‹nsiÚ
($this->
_fe_Çme_ov”ride
);

230 iàĞ! 
	g$this
->
is_®lowed_f‘y³
(
TRUE
))

232 
	g$this
->
£t_”rÜ
('upload_invalid_filetype');

233  
	gFALSE
;

238 ià(
	g$this
->
	gfe_size
 > 0)

240 
	g$this
->
	gfe_size
 = 
round
(
$this
->
fe_size
/1024, 2);

244 iàĞ! 
	g$this
->
is_®lowed_fesize
())

246 
	g$this
->
£t_”rÜ
('upload_invalid_filesize');

247  
	gFALSE
;

252 iàĞ! 
	g$this
->
is_®lowed_dim’siÚs
())

254 
	g$this
->
£t_”rÜ
('upload_invalid_dimensions');

255  
	gFALSE
;

259 
	g$this
->
	gfe_Çme
 = 
$this
->
ş—n_fe_Çme
($this->
fe_Çme
);

262 ià(
	g$this
->
	gmax_f’ame
 > 0)

264 
	g$this
->
	gfe_Çme
 = 
$this
->
lim™_f’ame_Ëngth
($this->
fe_Çme
, $this->
max_f’ame
);

268 ià(
	g$this
->
	g»move_¥aûs
 =ğ
TRUE
)

270 
$this
->
fe_Çme
 = 
´eg_»¶aû
("/\s+/", "_", $this->file_name);

279 
	g$this
->
	gÜig_Çme
 = 
$this
->
fe_Çme
;

281 ià(
	g$this
->
	gov”wr™e
 =ğ
FALSE
)

283 
$this
->
fe_Çme
 = $this->
£t_f’ame
($this->
u¶ßd_·th
, $this->file_name);

285 ià(
	g$this
->
	gfe_Çme
 ==ğ
FALSE
)

287  
FALSE
;

297 ià(
	g$this
->
	gxss_ş—n
)

299 ià(
	g$this
->
do_xss_ş—n
(è==ğ
FALSE
)

301 
$this
->
£t_”rÜ
('upload_unable_to_write_file');

302  
	gFALSE
;

313 iàĞ! @
cİy
(
$this
->
fe_‹mp
, $this->
u¶ßd_·th
.$this->
fe_Çme
))

315 iàĞ! @
move_u¶ßded_fe
(
$this
->
fe_‹mp
, $this->
u¶ßd_·th
.$this->
fe_Çme
))

317 
	g$this
->
£t_”rÜ
('upload_destination_error');

318  
	gFALSE
;

328 
	g$this
->
£t_image_´İ”t›s
(
$this
->
u¶ßd_·th
.$this->
fe_Çme
);

330  
	gTRUE
;

343 
public
 
funùiÚ
 
	$d©a
()

345  
	`¬¿y
 (

346 'fe_Çme' => 
$this
->
fe_Çme
,

347 'fe_ty³' => 
$this
->
fe_ty³
,

348 'fe_·th' => 
$this
->
u¶ßd_·th
,

349 'fuÎ_·th' => 
$this
->
u¶ßd_·th
.$this->
fe_Çme
,

350 '¿w_Çme' => 
	`¡r_»¶aû
(
$this
->
fe_ext
, '', $this->
fe_Çme
),

351 'Üig_Çme' => 
$this
->
Üig_Çme
,

352 'ş›Á_Çme' => 
$this
->
ş›Á_Çme
,

353 'fe_ext' => 
$this
->
fe_ext
,

354 'fe_size' => 
$this
->
fe_size
,

355 'is_image' => 
$this
->
	`is_image
(),

356 'image_width' => 
$this
->
image_width
,

357 'image_height' => 
$this
->
image_height
,

358 'image_ty³' => 
$this
->
image_ty³
,

359 'image_size_¡r' => 
$this
->
image_size_¡r
,

361 
	}
}

371 
public
 
funùiÚ
 
	$£t_u¶ßd_·th
(
$·th
)

374 
$this
->
u¶ßd_·th
 = 
	`¹rim
(
$·th
, '/').'/';

375 
	}
}

390 
public
 
funùiÚ
 
	$£t_f’ame
(
$·th
, 
$f’ame
)

392 ià(
$this
->
’üy±_Çme
 =ğ
TRUE
)

394 
	`mt_¤ªd
();

395 
$f’ame
 = 
	`md5
(
	`uniqid
(
	`mt_¿nd
())).
$this
->
fe_ext
;

398 iàĞ! 
	`fe_exi¡s
(
$·th
.
$f’ame
))

400  
$f’ame
;

403 
$f’ame
 = 
	`¡r_»¶aû
(
$this
->
fe_ext
, '', $filename);

405 
$Ãw_f’ame
 = '';

406 
$i
 = 1; $i < 100; $i++)

408 iàĞ! 
	`fe_exi¡s
(
$·th
.
$f’ame
.
$i
.
$this
->
fe_ext
))

410 
$Ãw_f’ame
 = 
$f’ame
.
$i
.
$this
->
fe_ext
;

415 ià(
$Ãw_f’ame
 == '')

417 
$this
->
	`£t_”rÜ
('upload_bad_filename');

418  
FALSE
;

422  
$Ãw_f’ame
;

424 
	}
}

434 
public
 
funùiÚ
 
	$£t_max_fesize
(
$n
)

436 
$this
->
max_size
 = ((è
$n
 < 0) ? 0: () $n;

437 
	}
}

447 
public
 
funùiÚ
 
	$£t_max_f’ame
(
$n
)

449 
$this
->
max_f’ame
 = ((è
$n
 < 0) ? 0: () $n;

450 
	}
}

460 
public
 
funùiÚ
 
	$£t_max_width
(
$n
)

462 
$this
->
max_width
 = ((è
$n
 < 0) ? 0: () $n;

463 
	}
}

473 
public
 
funùiÚ
 
	$£t_max_height
(
$n
)

475 
$this
->
max_height
 = ((è
$n
 < 0) ? 0: () $n;

476 
	}
}

486 
public
 
funùiÚ
 
	$£t_®lowed_ty³s
(
$ty³s
)

488 iàĞ! 
	`is_¬¿y
(
$ty³s
) && $types == '*')

490 
$this
->
®lowed_ty³s
 = '*';

493 
$this
->
®lowed_ty³s
 = 
	`ex¶ode
('|', 
$ty³s
);

494 
	}
}

506 
public
 
funùiÚ
 
£t_image_´İ”t›s
(
$·th
 = '')

508 iàĞ! 
$this
->
is_image
())

513 ià(
funùiÚ_exi¡s
('getimagesize'))

515 ià(
	gFALSE
 !=ğ(
$D
 = @
g‘imagesize
(
$·th
)))

517 
$ty³s
 = 
¬¿y
(1 => 'gif', 2 => 'jpeg', 3 => 'png');

519 
	g$this
->
	gimage_width
 = 
$D
['0'];

520 
	g$this
->
	gimage_height
 = 
$D
['1'];

521 
	g$this
->
	gimage_ty³
 = ( ! 
is£t
(
$ty³s
[
$D
['2']])) ? 'unknown' : $types[$D['2']];

522 
	g$this
->
	gimage_size_¡r
 = 
$D
['3'];

538 
public
 
funùiÚ
 
	$£t_xss_ş—n
(
$æag
 = 
FALSE
)

540 
$this
->
xss_ş—n
 = (
$æag
 =ğ
TRUE
è? TRUE : 
FALSE
;

541 
	}
}

550 
public
 
funùiÚ
 
	$is_image
()

555 
$²g_mimes
 = 
	`¬¿y
('image/x-png');

556 
$j³g_mimes
 = 
	`¬¿y
('image/jpg', 'image/jpe', 'image/jpeg', 'image/pjpeg');

558 ià(
	`š_¬¿y
(
$this
->
fe_ty³
, 
$²g_mimes
))

560 
$this
->
fe_ty³
 = 'image/png';

563 ià(
	`š_¬¿y
(
$this
->
fe_ty³
, 
$j³g_mimes
))

565 
$this
->
fe_ty³
 = 'image/jpeg';

568 
$img_mimes
 = 
	`¬¿y
(

574  (
	`š_¬¿y
(
$this
->
fe_ty³
, 
$img_mimes
, 
TRUE
)è? TRUE : 
FALSE
;

575 
	}
}

584 
public
 
funùiÚ
 
	$is_®lowed_f‘y³
(
$ignÜe_mime
 = 
FALSE
)

586 ià(
$this
->
®lowed_ty³s
 == '*')

588  
TRUE
;

591 ià(
	`couÁ
(
$this
->
®lowed_ty³s
è=ğ0 
OR
 ! 
	`is_¬¿y
($this->allowed_types))

593 
$this
->
	`£t_”rÜ
('upload_no_file_types');

594  
FALSE
;

597 
$ext
 = 
	`¡¹Şow”
(
	`Érim
(
$this
->
fe_ext
, '.'));

599 iàĞ! 
	`š_¬¿y
(
$ext
, 
$this
->
®lowed_ty³s
))

601  
FALSE
;

605 
$image_ty³s
 = 
	`¬¿y
('gif', 'jpg', 'jpeg', 'png', 'jpe');

607 ià(
	`š_¬¿y
(
$ext
, 
$image_ty³s
))

609 ià(
	`g‘imagesize
(
$this
->
fe_‹mp
è==ğ
FALSE
)

611  
FALSE
;

615 ià(
$ignÜe_mime
 ==ğ
TRUE
)

617  
TRUE
;

620 
$mime
 = 
$this
->
	`mimes_ty³s
(
$ext
);

622 ià(
	`is_¬¿y
(
$mime
))

624 ià(
	`š_¬¿y
(
$this
->
fe_ty³
, 
$mime
, 
TRUE
))

626  
TRUE
;

629 
	`–£if
 (
$mime
 =ğ
$this
->
fe_ty³
)

631  
TRUE
;

634  
FALSE
;

635 
	}
}

644 
public
 
funùiÚ
 
	$is_®lowed_fesize
()

646 ià(
$this
->
max_size
 !ğ0 
AND
 $this->
fe_size
 > $this->max_size)

648  
FALSE
;

652  
TRUE
;

654 
	}
}

663 
public
 
funùiÚ
 
	$is_®lowed_dim’siÚs
()

665 iàĞ! 
$this
->
	`is_image
())

667  
TRUE
;

670 ià(
	`funùiÚ_exi¡s
('getimagesize'))

672 
$D
 = @
	`g‘imagesize
(
$this
->
fe_‹mp
);

674 ià(
$this
->
max_width
 > 0 
AND
 
$D
['0'] > $this->max_width)

676  
FALSE
;

679 ià(
$this
->
max_height
 > 0 
AND
 
$D
['1'] > $this->max_height)

681  
FALSE
;

684  
TRUE
;

687  
TRUE
;

688 
	}
}

700 
public
 
funùiÚ
 
	$v®id©e_u¶ßd_·th
()

702 ià(
$this
->
u¶ßd_·th
 == '')

704 
$this
->
	`£t_”rÜ
('upload_no_filepath');

705  
FALSE
;

708 ià(
	`funùiÚ_exi¡s
('»®·th'è
AND
 @
	`»®·th
(
$this
->
u¶ßd_·th
è!=ğ
FALSE
)

710 
$this
->
u¶ßd_·th
 = 
	`¡r_»¶aû
("\\", "/", 
	`»®·th
($this->upload_path));

713 iàĞ! @
	`is_dœ
(
$this
->
u¶ßd_·th
))

715 
$this
->
	`£t_”rÜ
('upload_no_filepath');

716  
FALSE
;

719 iàĞ! 
	`is_»®ly_wr™abË
(
$this
->
u¶ßd_·th
))

721 
$this
->
	`£t_”rÜ
('upload_not_writable');

722  
FALSE
;

725 
$this
->
u¶ßd_·th
 = 
	`´eg_»¶aû
("/(.+?)\/*$/", "\\1/", $this->upload_path);

726  
TRUE
;

727 
	}
}

737 
public
 
funùiÚ
 
	$g‘_ex‹nsiÚ
(
$f’ame
)

739 
$x
 = 
	`ex¶ode
('.', 
$f’ame
);

740  '.'.
	`’d
(
$x
);

741 
	}
}

751 
public
 
funùiÚ
 
	$ş—n_fe_Çme
(
$f’ame
)

753 
$bad
 = 
	`¬¿y
(

782 
$f’ame
 = 
	`¡r_»¶aû
(
$bad
, '', $filename);

784  
	`¡r¦ashes
(
$f’ame
);

785 
	}
}

795 
public
 
funùiÚ
 
	$lim™_f’ame_Ëngth
(
$f’ame
, 
$Ëngth
)

797 ià(
	`¡¾’
(
$f’ame
è< 
$Ëngth
)

799  
$f’ame
;

802 
$ext
 = '';

803 ià(
	`¡½os
(
$f’ame
, '.'è!=ğ
FALSE
)

805 
$·¹s
 = 
	`ex¶ode
('.', 
$f’ame
);

806 
$ext
 = '.'.
	`¬¿y_pİ
(
$·¹s
);

807 
$f’ame
 = 
	`im¶ode
('.', 
$·¹s
);

810  
	`sub¡r
(
$f’ame
, 0, (
$Ëngth
 - 
	`¡¾’
(
$ext
))).$ext;

811 
	}
}

824 
public
 
funùiÚ
 
	$do_xss_ş—n
()

826 
$fe
 = 
$this
->
fe_‹mp
;

828 ià(
	`fesize
(
$fe
) == 0)

830  
FALSE
;

833 ià(
	`funùiÚ_exi¡s
('memÜy_g‘_u§ge'è&& 
	`memÜy_g‘_u§ge
(è&& 
	`ši_g‘
('memory_limit') != '')

835 
$cu¼’t
 = 
	`ši_g‘
('memory_limit') * 1024 * 1024;

841 
$Ãw_memÜy
 = 
	`numb”_fÜm©
(
	`û
(
	`fesize
(
$fe
è+ 
$cu¼’t
), 0, '.', '');

843 
	`ši_£t
('memÜy_lim™', 
$Ãw_memÜy
);

853 ià(
	`funùiÚ_exi¡s
('g‘imagesize'è&& @
	`g‘imagesize
(
$fe
è!=ğ
FALSE
)

855 ià((
$fe
 = @
	`fİ’
($fe, 'rb')è==ğ
FALSE
)

857  
FALSE
;

860 
$İ’šg_by‹s
 = 
	`ä—d
(
$fe
, 256);

861 
	`fşo£
(
$fe
);

867 iàĞ! 
	`´eg_m©ch
('/<×|body|h—d|html|img|¶aš‹xt|´e|süt|bË|t™Ë)[\s>]/i', 
$İ’šg_by‹s
))

869  
TRUE
;

873  
FALSE
;

877 ià((
$d©a
 = @
	`fe_g‘_cÚ‹Ás
(
$fe
)è==ğ
FALSE
)

879  
FALSE
;

882 
$CI
 =& 
	`g‘_š¡ªû
();

883  
$CI
->
£cur™y
->
	`xss_ş—n
(
$d©a
, 
TRUE
);

884 
	}
}

894 
public
 
funùiÚ
 
	$£t_”rÜ
(
$msg
)

896 
$CI
 =& 
	`g‘_š¡ªû
();

897 
$CI
->
Ïng
->
	`lßd
('upload');

899 ià(
	`is_¬¿y
(
$msg
))

901 
	`fÜ—ch
 (
$msg
 
as
 
$v®
)

903 
$msg
 = (
$CI
->
Ïng
->
	`lše
(
$v®
è=ğ
FALSE
) ? $val : $CI->lang->line($val);

904 
$this
->
”rÜ_msg
[] = 
$msg
;

905 
	`log_mes§ge
('”rÜ', 
$msg
);

910 
$msg
 = (
$CI
->
Ïng
->
	`lše
($msgè=ğ
FALSE
) ? $msg : $CI->lang->line($msg);

911 
$this
->
”rÜ_msg
[] = 
$msg
;

912 
	`log_mes§ge
('”rÜ', 
$msg
);

914 
	}
}

925 
public
 
funùiÚ
 
di¥Ïy_”rÜs
(
$İ’
 = '<p>', 
$şo£
 = '</p>')

927 
$¡r
 = '';

928 
fÜ—ch
 (
$this
->
”rÜ_msg
 
as
 
$v®
)

930 
	g$¡r
 .ğ
$İ’
.
$v®
.
$şo£
;

933  
	g$¡r
;

947 
public
 
funùiÚ
 
	$mimes_ty³s
(
$mime
)

949 
glob®
 
$mimes
;

951 ià(
	`couÁ
(
$this
->
mimes
) == 0)

953 ià(
	`defšed
('ENVIRONMENT'è
AND
 
	`is_fe
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/mimes.php'))

955 
	`šşude
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/mimes.php');

957 
	`–£if
 (
	`is_fe
(
APPPATH
.'config/mimes.php'))

959 
	`šşude
(
APPPATH
.'config//mimes.php');

963  
FALSE
;

966 
$this
->
mimes
 = 
$mimes
;

967 
	`un£t
(
$mimes
);

970  ( ! 
	`is£t
(
$this
->
mimes
[
$mime
])è? 
FALSE
 : $this->mimes[$mime];

971 
	}
}

984 
´Ùeùed
 
funùiÚ
 
	$_´•_f’ame
(
$f’ame
)

986 ià(
	`¡½os
(
$f’ame
, '.'è==ğ
FALSE
 
OR
 
$this
->
®lowed_ty³s
 == '*')

988  
$f’ame
;

991 
$·¹s
 = 
	`ex¶ode
('.', 
$f’ame
);

992 
$ext
 = 
	`¬¿y_pİ
(
$·¹s
);

993 
$f’ame
 = 
	`¬¿y_shiá
(
$·¹s
);

995 
	`fÜ—ch
 (
$·¹s
 
as
 
$·¹
)

997 iàĞ! 
	`š_¬¿y
(
	`¡¹Şow”
(
$·¹
), 
$this
->
®lowed_ty³s
è
OR
 $this->
	`mimes_ty³s
(¡¹Şow”($·¹)è==ğ
FALSE
)

999 
$f’ame
 .ğ'.'.
$·¹
.'_';

1003 
$f’ame
 .ğ'.'.
$·¹
;

1007 
$f’ame
 .ğ'.'.
$ext
;

1009  
$f’ame
;

1010 
	}
}

1023 
´Ùeùed
 
funùiÚ
 
	$_fe_mime_ty³
(
$fe
)

1026 
$»gexp
 = '/^([a-z\-]+\/[a-z0-9\-\.\+]+)(;\s.+)?$/';

1033 ià(
	`funùiÚ_exi¡s
('finfo_file'))

1035 
$fšfo
 = 
	`fšfo_İ’
(
FILEINFO_MIME
);

1036 ià(
	`is_»sourû
(
$fšfo
))

1038 
$mime
 = @
	`fšfo_fe
(
$fšfo
, 
$fe
['tmp_name']);

1039 
	`fšfo_şo£
(
$fšfo
);

1045 ià(
	`is_¡ršg
(
$mime
è&& 
	`´eg_m©ch
(
$»gexp
, $mime, 
$m©ches
))

1047 
$this
->
fe_ty³
 = 
$m©ches
[1];

1064 ià(
DIRECTORY_SEPARATOR
 !== '\\')

1066 
$cmd
 = 'f--br›à--mim' . 
	`esÿ³sh–Ïrg
(
$fe
['tmp_name']) . ' 2>&1';

1068 ià(
	`funùiÚ_exi¡s
('exec'))

1075 
$mime
 = @
	`exec
(
$cmd
, $mime, 
$»tuº_¡©us
);

1076 ià(
$»tuº_¡©us
 ==ğ0 && 
	`is_¡ršg
(
$mime
è&& 
	`´eg_m©ch
(
$»gexp
, $mime, 
$m©ches
))

1078 
$this
->
fe_ty³
 = 
$m©ches
[1];

1083 iàĞ(
boŞ
è@
	`ši_g‘
('§ã_mode'è==ğ
FALSE
 && 
	`funùiÚ_exi¡s
('shell_exec'))

1085 
$mime
 = @
	`sh–l_exec
(
$cmd
);

1086 ià(
	`¡¾’
(
$mime
) > 0)

1088 
$mime
 = 
	`ex¶ode
("\n", 
	`Œim
($mime));

1089 ià(
	`´eg_m©ch
(
$»gexp
, 
$mime
[(
	`couÁ
($mimeè- 1)], 
$m©ches
))

1091 
$this
->
fe_ty³
 = 
$m©ches
[1];

1097 ià(
	`funùiÚ_exi¡s
('popen'))

1099 
$´oc
 = @
	`pİ’
(
$cmd
, 'r');

1100 ià(
	`is_»sourû
(
$´oc
))

1102 
$mime
 = @
	`ä—d
(
$´oc
, 512);

1103 @
	`pşo£
(
$´oc
);

1104 ià(
$mime
 !=ğ
FALSE
)

1106 
$mime
 = 
	`ex¶ode
("\n", 
	`Œim
($mime));

1107 ià(
	`´eg_m©ch
(
$»gexp
, 
$mime
[(
	`couÁ
($mimeè- 1)], 
$m©ches
))

1109 
$this
->
fe_ty³
 = 
$m©ches
[1];

1118 ià(
	`funùiÚ_exi¡s
('mime_content_type'))

1120 
$this
->
fe_ty³
 = @
	`mime_cÚ‹Á_ty³
(
$fe
['tmp_name']);

1121 ià(
	`¡¾’
(
$this
->
fe_ty³
) > 0)

1127 
$this
->
fe_ty³
 = 
$fe
['type'];

1128 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/User_agent.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

29 şas 
	cCI_U£r_ag’t
 {

31 
v¬
 
	m$ag’t
 = 
NULL
;

33 
v¬
 
	m$is_brow£r
 = 
FALSE
;

34 
v¬
 
	m$is_robÙ
 = 
FALSE
;

35 
v¬
 
	m$is_mobe
 = 
FALSE
;

37 
v¬
 
	m$Ïnguages
 = 
¬¿y
();

38 
v¬
 
	m$ch¬£ts
 = 
¬¿y
();

40 
v¬
 
	m$¶©fÜms
 = 
¬¿y
();

41 
v¬
 
	m$brow£rs
 = 
¬¿y
();

42 
v¬
 
	m$mobes
 = 
¬¿y
();

43 
v¬
 
	m$robÙs
 = 
¬¿y
();

45 
v¬
 
	m$¶©fÜm
 = '';

46 
v¬
 
	m$brow£r
 = '';

47 
v¬
 
	m$v”siÚ
 = '';

48 
v¬
 
	m$mobe
 = '';

49 
v¬
 
	m$robÙ
 = '';

59 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

61 ià(
	`is£t
(
$_SERVER
['HTTP_USER_AGENT']))

63 
$this
->
ag’t
 = 
	`Œim
(
$_SERVER
['HTTP_USER_AGENT']);

66 iàĞ! 
	`is_nuÎ
(
$this
->
ag’t
))

68 ià(
$this
->
	`_lßd_ag’t_fe
())

70 
$this
->
	`_compe_d©a
();

74 
	`log_mes§ge
('debug', "User Agent Class Initialized");

85 
´iv©e
 
funùiÚ
 
	$_lßd_ag’t_fe
()

87 ià(
	`defšed
('ENVIRONMENT'è
AND
 
	`is_fe
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/user_agents.php'))

89 
	`šşude
(
APPPATH
.'cÚfig/'.
ENVIRONMENT
.'/user_agents.php');

91 
	`–£if
 (
	`is_fe
(
APPPATH
.'config/user_agents.php'))

93 
	`šşude
(
APPPATH
.'config/user_agents.php');

97  
FALSE
;

100 
$»tuº
 = 
FALSE
;

102 ià(
	`is£t
(
$¶©fÜms
))

104 
$this
->
¶©fÜms
 = 
$¶©fÜms
;

105 
	`un£t
(
$¶©fÜms
);

106 
$»tuº
 = 
TRUE
;

109 ià(
	`is£t
(
$brow£rs
))

111 
$this
->
brow£rs
 = 
$brow£rs
;

112 
	`un£t
(
$brow£rs
);

113 
$»tuº
 = 
TRUE
;

116 ià(
	`is£t
(
$mobes
))

118 
$this
->
mobes
 = 
$mobes
;

119 
	`un£t
(
$mobes
);

120 
$»tuº
 = 
TRUE
;

123 ià(
	`is£t
(
$robÙs
))

125 
$this
->
robÙs
 = 
$robÙs
;

126 
	`un£t
(
$robÙs
);

127 
$»tuº
 = 
TRUE
;

130  
$»tuº
;

131 
	}
}

141 
´iv©e
 
funùiÚ
 
	$_compe_d©a
()

143 
$this
->
	`_£t_¶©fÜm
();

145 
	`fÜ—ch
 (
	`¬¿y
('_£t_robÙ', '_£t_brow£r', '_£t_mobe'è
as
 
$funùiÚ
)

147 ià(
$this
->
	`$funùiÚ
(è==ğ
TRUE
)

152 
	}
}

162 
´iv©e
 
funùiÚ
 
	$_£t_¶©fÜm
()

164 ià(
	`is_¬¿y
(
$this
->
¶©fÜms
è
AND
 
	`couÁ
($this->platforms) > 0)

166 
	`fÜ—ch
 (
$this
->
¶©fÜms
 
as
 
$key
 => 
$v®
)

168 ià(
	`´eg_m©ch
("|".
	`´eg_quÙe
(
$key
)."|i", 
$this
->
ag’t
))

170 
$this
->
¶©fÜm
 = 
$v®
;

171  
TRUE
;

175 
$this
->
¶©fÜm
 = 'Unknown Platform';

176 
	}
}

186 
´iv©e
 
funùiÚ
 
	$_£t_brow£r
()

188 ià(
	`is_¬¿y
(
$this
->
brow£rs
è
AND
 
	`couÁ
($this->browsers) > 0)

190 
	`fÜ—ch
 (
$this
->
brow£rs
 
as
 
$key
 => 
$v®
)

192 ià(
	`´eg_m©ch
("|".
	`´eg_quÙe
(
$key
).".*?([0-9\.]+)|i", 
$this
->
ag’t
, 
$m©ch
))

194 
$this
->
is_brow£r
 = 
TRUE
;

195 
$this
->
v”siÚ
 = 
$m©ch
[1];

196 
$this
->
brow£r
 = 
$v®
;

197 
$this
->
	`_£t_mobe
();

198  
TRUE
;

202  
FALSE
;

203 
	}
}

213 
´iv©e
 
funùiÚ
 
	$_£t_robÙ
()

215 ià(
	`is_¬¿y
(
$this
->
robÙs
è
AND
 
	`couÁ
($this->robots) > 0)

217 
	`fÜ—ch
 (
$this
->
robÙs
 
as
 
$key
 => 
$v®
)

219 ià(
	`´eg_m©ch
("|".
	`´eg_quÙe
(
$key
)."|i", 
$this
->
ag’t
))

221 
$this
->
is_robÙ
 = 
TRUE
;

222 
$this
->
robÙ
 = 
$v®
;

223  
TRUE
;

227  
FALSE
;

228 
	}
}

238 
´iv©e
 
funùiÚ
 
	$_£t_mobe
()

240 ià(
	`is_¬¿y
(
$this
->
mobes
è
AND
 
	`couÁ
($this->mobiles) > 0)

242 
	`fÜ—ch
 (
$this
->
mobes
 
as
 
$key
 => 
$v®
)

244 ià(
FALSE
 !=ğ(
	`¡½os
(
	`¡¹Şow”
(
$this
->
ag’t
), 
$key
)))

246 
$this
->
is_mobe
 = 
TRUE
;

247 
$this
->
mobe
 = 
$v®
;

248  
TRUE
;

252  
FALSE
;

253 
	}
}

263 
´iv©e
 
funùiÚ
 
	$_£t_Ïnguages
()

265 ià((
	`couÁ
(
$this
->
Ïnguages
è=ğ0è
AND
 
	`is£t
(
$_SERVER
['HTTP_ACCEPT_LANGUAGE']) AND $_SERVER['HTTP_ACCEPT_LANGUAGE'] != '')

267 
$Ïnguages
 = 
	`´eg_»¶aû
('/(;q=[0-9\.]+)/i', '', 
	`¡¹Şow”
(
	`Œim
(
$_SERVER
['HTTP_ACCEPT_LANGUAGE'])));

269 
$this
->
Ïnguages
 = 
	`ex¶ode
(',', 
$Ïnguages
);

272 ià(
	`couÁ
(
$this
->
Ïnguages
) == 0)

274 
$this
->
Ïnguages
 = 
	`¬¿y
('Undefined');

276 
	}
}

286 
´iv©e
 
funùiÚ
 
	$_£t_ch¬£ts
()

288 ià((
	`couÁ
(
$this
->
ch¬£ts
è=ğ0è
AND
 
	`is£t
(
$_SERVER
['HTTP_ACCEPT_CHARSET']) AND $_SERVER['HTTP_ACCEPT_CHARSET'] != '')

290 
$ch¬£ts
 = 
	`´eg_»¶aû
('/(;q=.+)/i', '', 
	`¡¹Şow”
(
	`Œim
(
$_SERVER
['HTTP_ACCEPT_CHARSET'])));

292 
$this
->
ch¬£ts
 = 
	`ex¶ode
(',', 
$ch¬£ts
);

295 ià(
	`couÁ
(
$this
->
ch¬£ts
) == 0)

297 
$this
->
ch¬£ts
 = 
	`¬¿y
('Undefined');

299 
	}
}

309 
public
 
funùiÚ
 
	$is_brow£r
(
$key
 = 
NULL
)

311 iàĞ! 
$this
->
is_brow£r
)

313  
FALSE
;

317 ià(
$key
 ==ğ
NULL
)

319  
TRUE
;

323  
	`¬¿y_key_exi¡s
(
$key
, 
$this
->
brow£rs
è
AND
 $this->
brow£r
 === $this->browsers[$key];

324 
	}
}

334 
public
 
funùiÚ
 
	$is_robÙ
(
$key
 = 
NULL
)

336 iàĞ! 
$this
->
is_robÙ
)

338  
FALSE
;

342 ià(
$key
 ==ğ
NULL
)

344  
TRUE
;

348  
	`¬¿y_key_exi¡s
(
$key
, 
$this
->
robÙs
è
AND
 $this->
robÙ
 === $this->robots[$key];

349 
	}
}

359 
public
 
funùiÚ
 
	$is_mobe
(
$key
 = 
NULL
)

361 iàĞ! 
$this
->
is_mobe
)

363  
FALSE
;

367 ià(
$key
 ==ğ
NULL
)

369  
TRUE
;

373  
	`¬¿y_key_exi¡s
(
$key
, 
$this
->
mobes
è
AND
 $this->
mobe
 === $this->mobiles[$key];

374 
	}
}

384 
public
 
funùiÚ
 
	$is_»ã¼®
()

386 iàĞ! 
	`is£t
(
$_SERVER
['HTTP_REFERER']è
OR
 $_SERVER['HTTP_REFERER'] == '')

388  
FALSE
;

390  
TRUE
;

391 
	}
}

401 
public
 
funùiÚ
 
	$ag’t_¡ršg
()

403  
$this
->
ag’t
;

404 
	}
}

414 
public
 
funùiÚ
 
	$¶©fÜm
()

416  
$this
->
¶©fÜm
;

417 
	}
}

427 
public
 
funùiÚ
 
	$brow£r
()

429  
$this
->
brow£r
;

430 
	}
}

440 
public
 
funùiÚ
 
	$v”siÚ
()

442  
$this
->
v”siÚ
;

443 
	}
}

453 
public
 
funùiÚ
 
	$robÙ
()

455  
$this
->
robÙ
;

456 
	}
}

465 
public
 
funùiÚ
 
	$mobe
()

467  
$this
->
mobe
;

468 
	}
}

478 
public
 
funùiÚ
 
	$»ã¼”
()

480  ( ! 
	`is£t
(
$_SERVER
['HTTP_REFERER']è
OR
 $_SERVER['HTTP_REFERER'] =ğ''è? '' : 
	`Œim
($_SERVER['HTTP_REFERER']);

481 
	}
}

491 
public
 
funùiÚ
 
	$Ïnguages
()

493 ià(
	`couÁ
(
$this
->
Ïnguages
) == 0)

495 
$this
->
	`_£t_Ïnguages
();

498  
$this
->
Ïnguages
;

499 
	}
}

509 
public
 
funùiÚ
 
	$ch¬£ts
()

511 ià(
	`couÁ
(
$this
->
ch¬£ts
) == 0)

513 
$this
->
	`_£t_ch¬£ts
();

516  
$this
->
ch¬£ts
;

517 
	}
}

527 
public
 
funùiÚ
 
acû±_Ïng
(
$Ïng
 = 'en')

529  (
š_¬¿y
(
¡¹Şow”
(
$Ïng
), 
$this
->
Ïnguages
(), 
TRUE
));

540 
public
 
funùiÚ
 
acû±_ch¬£t
(
$ch¬£t
 = 'utf-8')

542  (
š_¬¿y
(
¡¹Şow”
(
$ch¬£t
), 
$this
->
ch¬£ts
(), 
TRUE
));

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Xmlrpc.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

16 iàĞ! 
funùiÚ_exi¡s
('xml_parser_create'))

18 
show_”rÜ
('Your PHP installation does‚ot support XML');

33 şas 
	cCI_XmÌpc
 {

35 
v¬
 
	m$debug
 = 
FALSE
;

36 
v¬
 
	m$xmÌpcI4
 = 'i4';

37 
v¬
 
	m$xmÌpcIÁ
 = 'int';

38 
v¬
 
	m$xmÌpcBoŞ—n
 = 'boolean';

39 
v¬
 
	m$xmÌpcDoubË
 = 'double';

40 
v¬
 
	m$xmÌpcSŒšg
 = 'string';

41 
v¬
 
	m$xmÌpcD©eTime
 = 'dateTime.iso8601';

42 
v¬
 
	m$xmÌpcBa£64
 = 'base64';

43 
v¬
 
	m$xmÌpcA¼ay
 = 'array';

44 
v¬
 
	m$xmÌpcSŒuù
 = 'struct';

46 
v¬
 
	m$xmÌpcTy³s
 = 
¬¿y
();

47 
v¬
 
	m$v®id_·»Ás
 = 
¬¿y
();

48 
v¬
 
	m$xmÌpû¼
 = 
¬¿y
();

49 
v¬
 
	m$xmÌpc¡r
 = 
¬¿y
();

51 
v¬
 
	m$xmÌpc_deãncodšg
 = 'UTF-8';

52 
v¬
 
	m$xmÌpcName
 = 'XML-RPC for CodeIgniter';

53 
v¬
 
	m$xmÌpcV”siÚ
 = '1.1';

54 
v¬
 
	m$xmÌpû¼u£r
 = 800;

55 
v¬
 
	m$xmÌpû¼xml
 = 100;

56 
v¬
 
	m$xmÌpc_back¦ash
 = '';

58 
v¬
 
	m$ş›Á
;

59 
v¬
 
	m$m‘hod
;

60 
v¬
 
	m$d©a
;

61 
v¬
 
	m$mes§ge
 = '';

62 
v¬
 
	m$”rÜ
 = '';

63 
v¬
 
	m$»suÉ
;

64 
v¬
 
	m$»¥Ú£
 = 
¬¿y
();

66 
v¬
 
	m$xss_ş—n
 = 
TRUE
;

72 
public
 
funùiÚ
 
__cÚ¡ruù
(
$cÚfig
 = 
	$¬¿y
())

74 
$this
->
xmÌpcName
 = $this->xmlrpcName;

75 
$this
->
xmÌpc_back¦ash
 = 
	`chr
(92).chr(92);

78 
$this
->
xmÌpcTy³s
 = 
	`¬¿y
(

79 
$this
->
xmÌpcI4
 => '1',

80 
$this
->
xmÌpcIÁ
 => '1',

81 
$this
->
xmÌpcBoŞ—n
 => '1',

82 
$this
->
xmÌpcSŒšg
 => '1',

83 
$this
->
xmÌpcDoubË
 => '1',

84 
$this
->
xmÌpcD©eTime
 => '1',

85 
$this
->
xmÌpcBa£64
 => '1',

86 
$this
->
xmÌpcA¼ay
 => '2',

87 
$this
->
xmÌpcSŒuù
 => '3'

91 
$this
->
v®id_·»Ás
 = 
	`¬¿y
('BOOLEAN' =>‡rray('VALUE'),

92 'I4' => 
	`¬¿y
('VALUE'),

93 'INT' => 
	`¬¿y
('VALUE'),

94 'STRING' => 
	`¬¿y
('VALUE'),

95 'DOUBLE' => 
	`¬¿y
('VALUE'),

96 'DATETIME.ISO8601' => 
	`¬¿y
('VALUE'),

97 'BASE64' => 
	`¬¿y
('VALUE'),

98 'ARRAY' => 
	`¬¿y
('VALUE'),

99 'STRUCT' => 
	`¬¿y
('VALUE'),

100 'PARAM' => 
	`¬¿y
('PARAMS'),

101 'METHODNAME' => 
	`¬¿y
('METHODCALL'),

102 'PARAMS' => 
	`¬¿y
('METHODCALL', 'METHODRESPONSE'),

103 'MEMBER' => 
	`¬¿y
('STRUCT'),

104 'NAME' => 
	`¬¿y
('MEMBER'),

105 'DATA' => 
	`¬¿y
('ARRAY'),

106 'FAULT' => 
	`¬¿y
('METHODRESPONSE'),

107 'VALUE' => 
	`¬¿y
('MEMBER', 'DATA', 'PARAM', 'FAULT')

112 
$this
->
xmÌpû¼
['unknown_method'] = '1';

113 
$this
->
xmÌpc¡r
['unknown_method'] = 'This is‚ot‡ known method forhis XML-RPC Server';

114 
$this
->
xmÌpû¼
['invalid_return'] = '2';

115 
$this
->
xmÌpc¡r
['invalid_return'] = 'The XML data„eceived wasƒither invalid or‚ot inhe correct form for XML-RPC. Turn on debuggingoƒxaminehe XML data further.';

116 
$this
->
xmÌpû¼
['incorrect_params'] = '3';

117 
$this
->
xmÌpc¡r
['incorrect_params'] = 'Incorrect…arameters were…assedo method';

118 
$this
->
xmÌpû¼
['introspect_unknown'] = '4';

119 
$this
->
xmÌpc¡r
['introspect_unknown'] = "Cannot inspect signature for„equest: method unknown";

120 
$this
->
xmÌpû¼
['http_error'] = '5';

121 
$this
->
xmÌpc¡r
['http_error'] = "Did‚ot„eceive‡ '200 OK'„esponse from„emote server.";

122 
$this
->
xmÌpû¼
['no_data'] = '6';

123 
$this
->
xmÌpc¡r
['no_data'] ='No data„eceived from server.';

125 
$this
->
	`š™Ÿlize
(
$cÚfig
);

127 
	`log_mes§ge
('debug', "XML-RPC Class Initialized");

135 
funùiÚ
 
	`š™Ÿlize
(
$cÚfig
 = 
	$¬¿y
())

137 ià(
	`couÁ
(
$cÚfig
) > 0)

139 
	`fÜ—ch
 (
$cÚfig
 
as
 
$key
 => 
$v®
)

141 ià(
	`is£t
(
$this
->
$key
))

143 
$this
->
$key
 = 
$v®
;

147 
	}
}

154 
funùiÚ
 
	$£rv”
(
$u¾
, 
$pÜt
=80)

156 ià(
	`sub¡r
(
$u¾
, 0, 4) != "http")

158 
$u¾
 = "http://".$url;

161 
$·¹s
 = 
	`·r£_u¾
(
$u¾
);

163 
$·th
 = ( ! 
	`is£t
(
$·¹s
['path'])) ? '/' : $parts['path'];

165 ià(
	`is£t
(
$·¹s
['query']) && $parts['query'] != '')

167 
$·th
 .ğ'?'.
$·¹s
['query'];

170 
$this
->
ş›Á
 = 
Ãw
 
	`XML_RPC_Cl›Á
(
$·th
, 
$·¹s
['ho¡'], 
$pÜt
);

171 
	}
}

178 
funùiÚ
 
	$timeout
(
$£cÚds
=5)

180 iàĞ! 
	`is_nuÎ
(
$this
->
ş›Á
è&& 
	`is_št
(
$£cÚds
))

182 
$this
->
ş›Á
->
timeout
 = 
$£cÚds
;

184 
	}
}

191 
funùiÚ
 
	$m‘hod
(
$funùiÚ
)

193 
$this
->
m‘hod
 = 
$funùiÚ
;

194 
	}
}

201 
funùiÚ
 
	$»que¡
(
$šcomšg
)

203 iàĞ! 
	`is_¬¿y
(
$šcomšg
))

208 
$this
->
d©a
 = 
	`¬¿y
();

210 
	`fÜ—ch
 (
$šcomšg
 
as
 
$key
 => 
$v®ue
)

212 
$this
->
d©a
[
$key
] = $this->
	`v®ues_·rsšg
(
$v®ue
);

214 
	}
}

222 
funùiÚ
 
	$£t_debug
(
$æag
 = 
TRUE
)

224 
$this
->
debug
 = (
$æag
 =ğ
TRUE
è? TRUE : 
FALSE
;

225 
	}
}

231 
funùiÚ
 
	$v®ues_·rsšg
(
$v®ue
, 
$»tuº
 = 
FALSE
)

233 ià(
	`is_¬¿y
(
$v®ue
è&& 
	`¬¿y_key_exi¡s
(0, $value))

235 iàĞ! 
	`is£t
(
$v®ue
['1']è
	`OR
 ( ! is£t(
$this
->
xmÌpcTy³s
[$value['1']])))

237 ià(
	`is_¬¿y
(
$v®ue
[0]))

239 
$‹mp
 = 
Ãw
 
	`XML_RPC_V®ues
(
$v®ue
['0'], 'array');

243 
$‹mp
 = 
Ãw
 
	`XML_RPC_V®ues
(
$v®ue
['0'], 'string');

246 
	`–£if
 (
	`is_¬¿y
(
$v®ue
['0']è&& ($v®ue['1'] =ğ'¡ruù' 
OR
 $value['1'] == 'array'))

248 
	`li¡
(
$k
èğ
	`—ch
(
$v®ue
['0']))

250 
$v®ue
['0'][
$k
] = 
$this
->
	`v®ues_·rsšg
($v®ue['0'][$k], 
TRUE
);

253 
$‹mp
 = 
Ãw
 
	`XML_RPC_V®ues
(
$v®ue
['0'], $value['1']);

257 
$‹mp
 = 
Ãw
 
	`XML_RPC_V®ues
(
$v®ue
['0'], $value['1']);

262 
$‹mp
 = 
Ãw
 
	`XML_RPC_V®ues
(
$v®ue
, 'string');

265  
$‹mp
;

266 
	}
}

274 
funùiÚ
 
	$£nd_»que¡
()

276 
$this
->
mes§ge
 = 
Ãw
 
	`XML_RPC_Mes§ge
($this->
m‘hod
,$this->
d©a
);

277 
$this
->
mes§ge
->
debug
 = $this->debug;

279 iàĞ! 
$this
->
»suÉ
 = $this->
ş›Á
->
	`£nd
($this->
mes§ge
))

281 
$this
->
”rÜ
 = $this->
»suÉ
->
”r¡r
;

282  
FALSE
;

284 
	`–£if
 ( ! 
	`is_objeù
(
$this
->
»suÉ
->
v®
))

286 
$this
->
”rÜ
 = $this->
»suÉ
->
”r¡r
;

287  
FALSE
;

290 
$this
->
»¥Ú£
 = $this->
»suÉ
->
	`decode
();

292  
TRUE
;

293 
	}
}

300 
funùiÚ
 
	$di¥Ïy_”rÜ
()

302  
$this
->
”rÜ
;

303 
	}
}

310 
funùiÚ
 
	$di¥Ïy_»¥Ú£
()

312  
$this
->
»¥Ú£
;

313 
	}
}

320 
funùiÚ
 
	$£nd_”rÜ_mes§ge
(
$numb”
, 
$mes§ge
)

322  
Ãw
 
	`XML_RPC_Re¥Ú£
('0',
$numb”
, 
$mes§ge
);

323 
	}
}

331 
funùiÚ
 
	$£nd_»¥Ú£
(
$»¥Ú£
)

336 
$»¥Ú£
 = 
$this
->
	`v®ues_·rsšg
($response);

338  
Ãw
 
	`XML_RPC_Re¥Ú£
(
$»¥Ú£
);

339 
	}
}

353 şas 
	cXML_RPC_Cl›Á
 
ex‹nds
 
	mCI_XmÌpc


355 
v¬
 
	m$·th
 = '';

356 
v¬
 
	m$£rv”
 = '';

357 
v¬
 
	m$pÜt
 = 80;

358 
v¬
 
	m$”ºo
 = '';

359 
v¬
 
	m$”r¡ršg
 = '';

360 
v¬
 
	m$timeout
 = 5;

361 
v¬
 
	m$no_muÉiÿÎ
 = 
FALSE
;

363 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$·th
, 
$£rv”
, 
$pÜt
=80)

365 
·»Á
::
	`__cÚ¡ruù
();

367 
$this
->
pÜt
 = 
$pÜt
;

368 
$this
->
£rv”
 = 
$£rv”
;

369 
$this
->
·th
 = 
$·th
;

372 
funùiÚ
 
	$£nd
(
$msg
)

374 ià(
	`is_¬¿y
(
$msg
))

377 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['muÉiÿÎ_»cursiÚ'],$this->
xmÌpc¡r
['multicall_recursion']);

378  
$r
;

381  
$this
->
	`£ndPaylßd
(
$msg
);

382 
	}
}

384 
funùiÚ
 
	$£ndPaylßd
(
$msg
)

386 
$å
 = @
	`fsockİ’
(
$this
->
£rv”
, $this->
pÜt
,$this->
”ºo
, $this->
”r¡r
, $this->
timeout
);

388 iàĞ! 
	`is_»sourû
(
$å
))

390 
	`”rÜ_log
(
$this
->
xmÌpc¡r
['http_error']);

391 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['h‰p_”rÜ'],$this->
xmÌpc¡r
['http_error']);

392  
$r
;

395 ià(
	`em±y
(
$msg
->
·ylßd
))

398 
$msg
->
	`ü—‹Paylßd
();

401 
$r
 = "\r\n";

402 
$İ
 = "POST {$this->path} HTTP/1.0$r";

403 
$İ
 .= "Host: {$this->server}$r";

404 
$İ
 .= "Content-Type:ext/xml$r";

405 
$İ
 .= "User-Agent: {$this->xmlrpcName}$r";

406 
$İ
 .ğ"CÚ‹Á-L’gth: ".
	`¡¾’
(
$msg
->
·ylßd
). "$r$r";

407 
$İ
 .ğ
$msg
->
·ylßd
;

410 iàĞ! 
	`åuts
(
$å
, 
$İ
, 
	`¡¾’
($op)))

412 
	`”rÜ_log
(
$this
->
xmÌpc¡r
['http_error']);

413 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['h‰p_”rÜ'], $this->
xmÌpc¡r
['http_error']);

414  
$r
;

416 
$»¥
 = 
$msg
->
	`·r£Re¥Ú£
(
$å
);

417 
	`fşo£
(
$å
);

418  
$»¥
;

419 
	}
}

431 şas 
	cXML_RPC_Re¥Ú£


433 
v¬
 
	m$v®
 = 0;

434 
v¬
 
	m$”ºo
 = 0;

435 
v¬
 
	m$”r¡r
 = '';

436 
v¬
 
	m$h—d”s
 = 
¬¿y
();

437 
v¬
 
	m$xss_ş—n
 = 
TRUE
;

439 
public
 
funùiÚ
 
__cÚ¡ruù
(
$v®
, 
$code
 = 0, 
$f¡r
 = '')

441 ià(
$code
 != 0)

444 
$this
->
”ºo
 = 
$code
;

445 
	m$this
->
	m”r¡r
 = 
htmËÁ™›s
(
$f¡r
);

447 iàĞ! 
is_objeù
(
$v®
))

450 
”rÜ_log
("Inv®idy³ '" . 
g‘ty³
(
$v®
) . "' (value: $val)…assedo XML_RPC_Response. Defaultingoƒmpty value.");

451 
	m$this
->
	mv®
 = 
Ãw
 
XML_RPC_V®ues
();

455 
	m$this
->
	mv®
 = 
$v®
;

459 
funùiÚ
 
	$çuÉCode
()

461  
$this
->
”ºo
;

462 
	}
}

464 
funùiÚ
 
	$çuÉSŒšg
()

466  
$this
->
”r¡r
;

467 
	}
}

469 
funùiÚ
 
	$v®ue
()

471  
$this
->
v®
;

472 
	}
}

474 
funùiÚ
 
	$´•¬e_»¥Ú£
()

476 
$»suÉ
 = "<methodResponse>\n";

477 ià(
$this
->
”ºo
)

479 
$»suÉ
 .= '<fault>

480 <
v®ue
>

482 <
memb”
>

483 <
Çme
>
çuÉCode
</name>

484 <
v®ue
><>' . $this->errno . '</></value>

485 </
memb”
>

486 <
memb”
>

487 <
Çme
>
çuÉSŒšg
</name>

488 <
v®ue
><
¡ršg
>' . $this->errstr . '</string></value>

489 </
memb”
>

491 </
v®ue
>

492 </
çuÉ
>';

496 
$»suÉ
 .= "<params>\n<param>\n" .

497 
$this
->
v®
->
	`£rŸlize_şass
() .

500 
$»suÉ
 .= "\n</methodResponse>";

501  
$»suÉ
;

502 
	}
}

504 
funùiÚ
 
	$decode
(
$¬¿y
=
FALSE
)

506 
$CI
 =& 
	`g‘_š¡ªû
();

508 ià(
$¬¿y
 !=ğ
FALSE
 && 
	`is_¬¿y
($array))

510 
	`li¡
(
$key
èğ
	`—ch
(
$¬¿y
))

512 ià(
	`is_¬¿y
(
$¬¿y
[
$key
]))

514 
$¬¿y
[
$key
] = 
$this
->
	`decode
($array[$key]);

518 
$¬¿y
[
$key
] = (
$this
->
xss_ş—n
è? 
$CI
->
£cur™y
->
	`xss_ş—n
($array[$key]) : $array[$key];

522 
$»suÉ
 = 
$¬¿y
;

526 
$»suÉ
 = 
$this
->
	`xmÌpc_decod”
($this->
v®
);

528 ià(
	`is_¬¿y
(
$»suÉ
))

530 
$»suÉ
 = 
$this
->
	`decode
($result);

534 
$»suÉ
 = (
$this
->
xss_ş—n
è? 
$CI
->
£cur™y
->
	`xss_ş—n
($result) : $result;

538  
$»suÉ
;

539 
	}
}

547 
funùiÚ
 
	$xmÌpc_decod”
(
$xmÌpc_v®
)

549 
$kšd
 = 
$xmÌpc_v®
->
	`kšdOf
();

551 ià(
$kšd
 == 'scalar')

553  
$xmÌpc_v®
->
	`sÿÏrv®
();

555 
	`–£if
 (
$kšd
 == 'array')

557 
	`»£t
(
$xmÌpc_v®
->
me
);

558 
	`li¡
(
$a
,
$b
èğ
	`—ch
(
$xmÌpc_v®
->
me
);

559 
$size
 = 
	`couÁ
(
$b
);

561 
$¬r
 = 
	`¬¿y
();

563 
$i
 = 0; $˜< 
$size
; $i++)

565 
$¬r
[] = 
$this
->
	`xmÌpc_decod”
(
$xmÌpc_v®
->
me
['¬¿y'][
$i
]);

567  
$¬r
;

569 
	`–£if
 (
$kšd
 == 'struct')

571 
	`»£t
(
$xmÌpc_v®
->
me
['struct']);

572 
$¬r
 = 
	`¬¿y
();

574 
	`li¡
(
$key
,
$v®ue
èğ
	`—ch
(
$xmÌpc_v®
->
me
['struct']))

576 
$¬r
[
$key
] = 
$this
->
	`xmÌpc_decod”
(
$v®ue
);

578  
$¬r
;

580 
	}
}

587 
funùiÚ
 
	$iso8601_decode
(
$time
, 
$utc
=0)

590 
$t
 = 0;

591 ià(
	`´eg_m©ch
('/([0-9]{4})([0-9]{2})([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})/', 
$time
, 
$»gs
))

593 
$âc
 = (
$utc
 == 1) ? 'gmmktime' : 'mktime';

594 
$t
 = 
	`$âc
(
$»gs
[4], $regs[5], $regs[6], $regs[2], $regs[3], $regs[1]);

596  
$t
;

597 
	}
}

610 şas 
	cXML_RPC_Mes§ge
 
ex‹nds
 
	mCI_XmÌpc


612 
v¬
 
	m$·ylßd
;

613 
v¬
 
	m$m‘hod_Çme
;

614 
v¬
 
	m$·¿ms
 = 
¬¿y
();

615 
v¬
 
	m$xh
 = 
¬¿y
();

617 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$m‘hod
, 
$·rs
=0)

619 
·»Á
::
	`__cÚ¡ruù
();

621 
$this
->
m‘hod_Çme
 = 
$m‘hod
;

622 ià(
	`is_¬¿y
(
$·rs
è&& 
	`couÁ
($pars) > 0)

624 
$i
=0; $i<
	`couÁ
(
$·rs
); $i++)

627 
$this
->
·¿ms
[] = 
$·rs
[
$i
];

636 
funùiÚ
 
	$ü—‹Paylßd
()

638 
$this
->
·ylßd
 = "<?xml version=\"1.0\"?".">\r\n<methodCall>\r\n";

639 
$this
->
·ylßd
 .ğ'<m‘hodName>' . $this->
m‘hod_Çme
 . "</methodName>\r\n";

640 
$this
->
·ylßd
 .= "<params>\r\n";

642 
$i
=0; $i<
	`couÁ
(
$this
->
·¿ms
); $i++)

645 
$p
 = 
$this
->
·¿ms
[
$i
];

646 
$this
->
·ylßd
 .ğ"<·¿m>\r\n".
$p
->
	`£rŸlize_şass
()."</param>\r\n";

649 
$this
->
·ylßd
 .= "</params>\r\n</methodCall>\r\n";

650 
	}
}

656 
funùiÚ
 
	$·r£Re¥Ú£
(
$å
)

658 
$d©a
 = '';

660 
$d©um
 = 
	`ä—d
(
$å
, 4096))

662 
$d©a
 .ğ
$d©um
;

669 ià(
$this
->
debug
 ==ğ
TRUE
)

671 
echo
 "<pre>";

672 
echo
 "---DATA---\n" . 
	`html¥ecŸlch¬s
(
$d©a
) . "\n---END DATA---\n\n";

673 
echo
 "</pre>";

680 ià(
$d©a
 == "")

682 
	`”rÜ_log
(
$this
->
xmÌpc¡r
['no_data']);

683 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['no_d©a'], $this->
xmÌpc¡r
['no_data']);

684  
$r
;

692 ià(
	`¡ºcmp
(
$d©a
, 'HTTP', 4è=ğ0 && ! 
	`´eg_m©ch
('/^HTTP\/[0-9\.]+ 200 /', $data))

694 
$”r¡r
ğ
	`sub¡r
(
$d©a
, 0, 
	`¡½os
($data, "\n")-1);

695 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['h‰p_”rÜ'], $this->
xmÌpc¡r
['h‰p_”rÜ']. ' (' . 
$”r¡r
 . ')');

696  
$r
;

703 
$·r£r
 = 
	`xml_·r£r_ü—‹
(
$this
->
xmÌpc_deãncodšg
);

705 
$this
->
xh
[
$·r£r
] = 
	`¬¿y
();

706 
$this
->
xh
[
$·r£r
]['isf'] = 0;

707 
$this
->
xh
[
$·r£r
]['ac'] = '';

708 
$this
->
xh
[
$·r£r
]['h—d”s'] = 
	`¬¿y
();

709 
$this
->
xh
[
$·r£r
]['¡ack'] = 
	`¬¿y
();

710 
$this
->
xh
[
$·r£r
]['v®ue¡ack'] = 
	`¬¿y
();

711 
$this
->
xh
[
$·r£r
]['isf_reason'] = 0;

713 
	`xml_£t_objeù
(
$·r£r
, 
$this
);

714 
	`xml_·r£r_£t_İtiÚ
(
$·r£r
, 
XML_OPTION_CASE_FOLDING
, 
Œue
);

715 
	`xml_£t_–em’t_hªdËr
(
$·r£r
, 'open_tag', 'closing_tag');

716 
	`xml_£t_ch¬aù”_d©a_hªdËr
(
$·r£r
, 'character_data');

724 
$lšes
 = 
	`ex¶ode
("\r\n", 
$d©a
);

725 (
$lše
 = 
	`¬¿y_shiá
(
$lšes
)))

727 ià(
	`¡¾’
(
$lše
) < 1)

731 
$this
->
xh
[
$·r£r
]['h—d”s'][] = 
$lše
;

733 
$d©a
 = 
	`im¶ode
("\r\n", 
$lšes
);

740 iàĞ! 
	`xml_·r£
(
$·r£r
, 
$d©a
, 
	`couÁ
($data)))

742 
$”r¡r
 = 
	`¥rštf
('XMLƒrror: %s‡t†ine %d',

743 
	`xml_”rÜ_¡ršg
(
	`xml_g‘_”rÜ_code
(
$·r£r
)),

744 
	`xml_g‘_cu¼’t_lše_numb”
(
$·r£r
));

746 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['šv®id_»tuº'], $this->
xmÌpc¡r
['invalid_return']);

747 
	`xml_·r£r_ä“
(
$·r£r
);

748  
$r
;

750 
	`xml_·r£r_ä“
(
$·r£r
);

756 ià(
$this
->
xh
[
$·r£r
]['isf'] > 1)

758 ià(
$this
->
debug
 ==ğ
TRUE
)

760 
echo
 "---Invalid Return---\n";

761 
echo
 
$this
->
xh
[
$·r£r
]['isf_reason'];

762 
echo
 "---Invalid Return---\n\n";

765 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['šv®id_»tuº'],$this->
xmÌpc¡r
['šv®id_»tuº'].' '.$this->
xh
[
$·r£r
]['isf_reason']);

766  
$r
;

768 
	`–£if
 ( ! 
	`is_objeù
(
$this
->
xh
[
$·r£r
]['value']))

770 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['šv®id_»tuº'],$this->
xmÌpc¡r
['šv®id_»tuº'].' '.$this->
xh
[
$·r£r
]['isf_reason']);

771  
$r
;

778 ià(
$this
->
debug
 ==ğ
TRUE
)

780 
echo
 "<pre>";

782 ià(
	`couÁ
(
$this
->
xh
[
$·r£r
]['headers'] > 0))

784 
echo
 "---HEADERS---\n";

785 
	`fÜ—ch
 (
$this
->
xh
[
$·r£r
]['h—d”s'] 
as
 
$h—d”
)

787 
echo
 "$header\n";

789 
echo
 "---END HEADERS---\n\n";

792 
echo
 "---DATA---\n" . 
	`html¥ecŸlch¬s
(
$d©a
) . "\n---END DATA---\n\n";

794 
echo
 "---PARSED---\n" ;

795 
	`v¬_dump
(
$this
->
xh
[
$·r£r
]['value']);

796 
echo
 "\n---END PARSED---</pre>";

803 
$v
 = 
$this
->
xh
[
$·r£r
]['value'];

805 ià(
$this
->
xh
[
$·r£r
]['isf'])

807 
$”ºo_v
 = 
$v
->
me
['struct']['faultCode'];

808 
$”r¡r_v
 = 
$v
->
me
['struct']['faultString'];

809 
$”ºo
 = 
$”ºo_v
->
	`sÿÏrv®
();

811 ià(
$”ºo
 == 0)

814 
$”ºo
 = -1;

817 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(
$v
, 
$”ºo
, 
$”r¡r_v
->
	`sÿÏrv®
());

821 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(
$v
);

824 
$r
->
h—d”s
 = 
$this
->
xh
[
$·r£r
]['headers'];

825  
$r
;

826 
	}
}

846 
funùiÚ
 
	$İ’_g
(
$the_·r£r
, 
$Çme
, 
$©Œs
)

849 ià(
$this
->
xh
[
$the_·r£r
]['isf'] > 1) ;

853 ià(
	`couÁ
(
$this
->
xh
[
$the_·r£r
]['stack']) == 0)

855 ià(
$Çme
 != 'METHODRESPONSE' && $name != 'METHODCALL')

857 
$this
->
xh
[
$the_·r£r
]['isf'] = 2;

858 
$this
->
xh
[
$the_·r£r
]['isf_reason'] = 'Top†evel XML-RPCƒlement is missing';

865 iàĞ! 
	`š_¬¿y
(
$this
->
xh
[
$the_·r£r
]['¡ack'][0], $this->
v®id_·»Ás
[
$Çme
], 
TRUE
))

867 
$this
->
xh
[
$the_·r£r
]['isf'] = 2;

868 
$this
->
xh
[
$the_·r£r
]['isf_reason'] = "XML-RPCƒlement $name cannot be child of ".$this->xh[$the_parser]['stack'][0];

873 
$Çme
)

879 
$cur_v®
 = 
	`¬¿y
('value' =>‡rray(),

880 'ty³' => 
$Çme
);

882 
	`¬¿y_unshiá
(
$this
->
xh
[
$the_·r£r
]['v®ue¡ack'], 
$cur_v®
);

886 
$this
->
xh
[
$the_·r£r
]['ac'] = '';

889 
$this
->
xh
[
$the_·r£r
]['isf'] = 1;

892 
$this
->
xh
[
$the_·r£r
]['v®ue'] = 
NULL
;

895 
$this
->
xh
[
$the_·r£r
]['vt'] = 'value';

896 
$this
->
xh
[
$the_·r£r
]['ac'] = '';

897 
$this
->
xh
[
$the_·r£r
]['lv'] = 1;

906 ià(
$this
->
xh
[
$the_·r£r
]['vt'] != 'value')

909 
$this
->
xh
[
$the_·r£r
]['isf'] = 2;

910 
$this
->
xh
[
$the_·r£r
]['isf_reason'] = "'Twas‡ $nameƒlement following‡ ".$this->xh[$the_parser]['vt']."ƒlement inside‡ single value";

914 
$this
->
xh
[
$the_·r£r
]['ac'] = '';

918 
$this
->
xh
[
$the_·r£r
]['valuestack'][0]['name'] = '';

921 
$this
->
xh
[
$the_·r£r
]['v®ue'] = 
NULL
;

931 
$this
->
xh
[
$the_·r£r
]['isf'] = 2;

932 
$this
->
xh
[
$the_·r£r
]['isf_reason'] = "Invalid XML-RPCƒlement found: $name";

937 
	`¬¿y_unshiá
(
$this
->
xh
[
$the_·r£r
]['¡ack'], 
$Çme
);

939 ià(
$Çme
 !ğ'VALUE'è
$this
->
xh
[
$the_·r£r
]['lv'] = 0;

940 
	}
}

948 
funùiÚ
 
	$şosšg_g
(
$the_·r£r
, 
$Çme
)

950 ià(
$this
->
xh
[
$the_·r£r
]['isf'] > 1) ;

957 
$cu¼_–em
 = 
	`¬¿y_shiá
(
$this
->
xh
[
$the_·r£r
]['stack']);

959 
$Çme
)

963 
$cur_v®
 = 
	`¬¿y_shiá
(
$this
->
xh
[
$the_·r£r
]['valuestack']);

964 
$this
->
xh
[
$the_·r£r
]['v®ue'] = ( ! 
	`is£t
(
$cur_v®
['v®ues'])è? 
	`¬¿y
() : $cur_val['values'];

965 
$this
->
xh
[
$the_·r£r
]['vt'] = 
	`¡¹Şow”
(
$Çme
);

968 
$this
->
xh
[
$the_·r£r
]['valuestack'][0]['name'] = $this->xh[$the_parser]['ac'];

977 
$this
->
xh
[
$the_·r£r
]['vt'] = 
	`¡¹Şow”
(
$Çme
);

979 ià(
$Çme
 == 'STRING')

981 
$this
->
xh
[
$the_·r£r
]['value'] = $this->xh[$the_parser]['ac'];

983 
	`–£if
 (
$Çme
=='DATETIME.ISO8601')

985 
$this
->
xh
[
$the_·r£r
]['vt'] = $this->
xmÌpcD©eTime
;

986 
$this
->
xh
[
$the_·r£r
]['value'] = $this->xh[$the_parser]['ac'];

988 
	`–£if
 (
$Çme
=='BASE64')

990 
$this
->
xh
[
$the_·r£r
]['v®ue'] = 
	`ba£64_decode
($this->xh[$the_parser]['ac']);

992 
	`–£if
 (
$Çme
=='BOOLEAN')

995 ià(
$this
->
xh
[
$the_·r£r
]['ac'] == '1')

997 
$this
->
xh
[
$the_·r£r
]['v®ue'] = 
TRUE
;

1001 
$this
->
xh
[
$the_·r£r
]['v®ue'] = 
FALSE
;

1004 
	`–£if
 (
$Çme
=='DOUBLE')

1008 iàĞ! 
	`´eg_m©ch
('/^[+-]?[eE0-9\ˆ\.]+$/', 
$this
->
xh
[
$the_·r£r
]['ac']))

1010 
$this
->
xh
[
$the_·r£r
]['value'] = 'ERROR_NON_NUMERIC_FOUND';

1014 
$this
->
xh
[
$the_·r£r
]['value'] = ()$this->xh[$the_parser]['ac'];

1021 iàĞ! 
	`´eg_m©ch
('/^[+-]?[0-9\ˆ]+$/', 
$this
->
xh
[
$the_·r£r
]['ac']))

1023 
$this
->
xh
[
$the_·r£r
]['value'] = 'ERROR_NON_NUMERIC_FOUND';

1027 
$this
->
xh
[
$the_·r£r
]['value'] = ()$this->xh[$the_parser]['ac'];

1030 
$this
->
xh
[
$the_·r£r
]['ac'] = '';

1031 
$this
->
xh
[
$the_·r£r
]['lv'] = 3;

1035 ià(
$this
->
xh
[
$the_·r£r
]['vt']=='value')

1037 
$this
->
xh
[
$the_·r£r
]['value'] = $this->xh[$the_parser]['ac'];

1038 
$this
->
xh
[
$the_·r£r
]['vt'] = $this->
xmÌpcSŒšg
;

1042 
$‹mp
 = 
Ãw
 
	`XML_RPC_V®ues
(
$this
->
xh
[
$the_·r£r
]['value'], $this->xh[$the_parser]['vt']);

1044 ià(
	`couÁ
(
$this
->
xh
[
$the_·r£r
]['valuestack']) && $this->xh[$the_parser]['valuestack'][0]['type'] == 'ARRAY')

1047 
$this
->
xh
[
$the_·r£r
]['v®ue¡ack'][0]['v®ues'][] = 
$‹mp
;

1052 
$this
->
xh
[
$the_·r£r
]['v®ue'] = 
$‹mp
;

1056 
$this
->
xh
[
$the_·r£r
]['ac']='';

1059 ià(
$this
->
xh
[
$the_·r£r
]['value'])

1061 
$this
->
xh
[
$the_·r£r
]['valuestack'][0]['values'][$this->xh[$the_parser]['valuestack'][0]['name']] = $this->xh[$the_parser]['value'];

1065 
$this
->
xh
[
$the_·r£r
]['ac']='';

1068 ià(
$this
->
xh
[
$the_·r£r
]['value'])

1070 
$this
->
xh
[
$the_·r£r
]['params'][] = $this->xh[$the_parser]['value'];

1074 
$this
->
xh
[
$the_·r£r
]['m‘hod'] = 
	`Érim
($this->xh[$the_parser]['ac']);

1086 
	}
}

1092 
funùiÚ
 
	$ch¬aù”_d©a
(
$the_·r£r
, 
$d©a
)

1094 ià(
$this
->
xh
[
$the_·r£r
]['isf'] > 1) ;

1097 ià(
$this
->
xh
[
$the_·r£r
]['lv'] != 3)

1099 ià(
$this
->
xh
[
$the_·r£r
]['lv'] == 1)

1101 
$this
->
xh
[
$the_·r£r
]['lv'] = 2;

1104 iàĞ! @
	`is£t
(
$this
->
xh
[
$the_·r£r
]['ac']))

1106 
$this
->
xh
[
$the_·r£r
]['ac'] = '';

1109 
$this
->
xh
[
$the_·r£r
]['ac'] .ğ
$d©a
;

1111 
	}
}

1114 
funùiÚ
 
	$addP¬am
(
$·r
è{ 
$this
->
·¿ms
[]=$·r; 
	}
}

1116 
funùiÚ
 
	$ouut_·¿m‘”s
(
$¬¿y
=
FALSE
)

1118 
$CI
 =& 
	`g‘_š¡ªû
();

1120 ià(
$¬¿y
 !=ğ
FALSE
 && 
	`is_¬¿y
($array))

1122 
	`li¡
(
$key
èğ
	`—ch
(
$¬¿y
))

1124 ià(
	`is_¬¿y
(
$¬¿y
[
$key
]))

1126 
$¬¿y
[
$key
] = 
$this
->
	`ouut_·¿m‘”s
($array[$key]);

1132 
$¬¿y
[
$key
] = ($key =ğ'b™s' 
OR
 
$this
->
xss_ş—n
 =ğ
FALSE
è? $¬¿y[$key] : 
$CI
->
£cur™y
->
	`xss_ş—n
($array[$key]);

1136 
$·¿m‘”s
 = 
$¬¿y
;

1140 
$·¿m‘”s
 = 
	`¬¿y
();

1142 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
·¿ms
); $i++)

1144 
$a_·¿m
 = 
$this
->
	`decode_mes§ge
($this->
·¿ms
[
$i
]);

1146 ià(
	`is_¬¿y
(
$a_·¿m
))

1148 
$·¿m‘”s
[] = 
$this
->
	`ouut_·¿m‘”s
(
$a_·¿m
);

1152 
$·¿m‘”s
[] = (
$this
->
xss_ş—n
è? 
$CI
->
£cur™y
->
	`xss_ş—n
(
$a_·¿m
) : $a_param;

1157  
$·¿m‘”s
;

1158 
	}
}

1161 
funùiÚ
 
	$decode_mes§ge
(
$·¿m
)

1163 
$kšd
 = 
$·¿m
->
	`kšdOf
();

1165 ià(
$kšd
 == 'scalar')

1167  
$·¿m
->
	`sÿÏrv®
();

1169 
	`–£if
 (
$kšd
 == 'array')

1171 
	`»£t
(
$·¿m
->
me
);

1172 
	`li¡
(
$a
,
$b
èğ
	`—ch
(
$·¿m
->
me
);

1174 
$¬r
 = 
	`¬¿y
();

1176 
$i
 = 0; $˜< 
	`couÁ
(
$b
); $i++)

1178 
$¬r
[] = 
$this
->
	`decode_mes§ge
(
$·¿m
->
me
['¬¿y'][
$i
]);

1181  
$¬r
;

1183 
	`–£if
 (
$kšd
 == 'struct')

1185 
	`»£t
(
$·¿m
->
me
['struct']);

1187 
$¬r
 = 
	`¬¿y
();

1189 
	`li¡
(
$key
,
$v®ue
èğ
	`—ch
(
$·¿m
->
me
['struct']))

1191 
$¬r
[
$key
] = 
$this
->
	`decode_mes§ge
(
$v®ue
);

1194  
$¬r
;

1196 
	}
}

1209 şas 
	cXML_RPC_V®ues
 
ex‹nds
 
	mCI_XmÌpc


1211 
v¬
 
	m$me
 = 
¬¿y
();

1212 
v¬
 
	m$myty³
 = 0;

1214 
public
 
funùiÚ
 
__cÚ¡ruù
(
$v®
=-1, 
$ty³
='')

1216 
·»Á
::
__cÚ¡ruù
();

1218 ià(
	m$v®
 !ğ-1 
OR
 
$ty³
 != '')

1220 
$ty³
 = $type == '' ? 'string' : $type;

1222 ià(
	m$this
->
	mxmÌpcTy³s
[
$ty³
] == 1)

1224 
$this
->
addSÿÏr
(
$v®
,
$ty³
);

1226 
–£if
 (
$this
->
xmÌpcTy³s
[
$ty³
] == 2)

1228 
$this
->
addA¼ay
(
$v®
);

1230 
–£if
 (
$this
->
xmÌpcTy³s
[
$ty³
] == 3)

1232 
$this
->
addSŒuù
(
$v®
);

1237 
funùiÚ
 
addSÿÏr
(
$v®
, 
$ty³
='string')

1239 
$ty³of
 = 
$this
->
xmÌpcTy³s
[
$ty³
];

1241 ià(
	g$this
->
	gmyty³
==1)

1243 
echo
 '<strong>XML_RPC_Values</strong>: scalar can have only one value<br />';

1247 ià(
	g$ty³of
 != 1)

1249 
echo
 '<strong>XML_RPC_Values</strong>:‚ot‡ scalarype (${typeof})<br />';

1253 ià(
	g$ty³
 =ğ
$this
->
xmÌpcBoŞ—n
)

1255 ià(
¡rÿ£cmp
(
$v®
,'Œue')==0 
OR
 $v®==1 OR ($v®==
Œue
 && strcasecmp($val,'false')))

1257 
	g$v®
 = 1;

1261 
	g$v®
=0;

1265 ià(
	g$this
->
	gmyty³
 == 2)

1268 
$¬
 = 
$this
->
me
['array'];

1269 
	g$¬
[] = 
Ãw
 
XML_RPC_V®ues
(
$v®
, 
$ty³
);

1270 
	g$this
->
	gme
['¬¿y'] = 
$¬
;

1275 
	g$this
->
	gme
[
$ty³
] = 
$v®
;

1276 
	g$this
->
	gmyty³
 = 
$ty³of
;

1281 
funùiÚ
 
	$addA¼ay
(
$v®s
)

1283 ià(
$this
->
myty³
 != 0)

1285 
echo
 '<¡rÚg>XML_RPC_V®ues</¡rÚg>:‡Ì—dy in™Ÿlized‡ ¨[' . 
$this
->
	`kšdOf
() . ']<br />';

1289 
$this
->
myty³
 = $this->
xmÌpcTy³s
['array'];

1290 
$this
->
me
['¬¿y'] = 
$v®s
;

1292 
	}
}

1294 
funùiÚ
 
	$addSŒuù
(
$v®s
)

1296 ià(
$this
->
myty³
 != 0)

1298 
echo
 '<¡rÚg>XML_RPC_V®ues</¡rÚg>:‡Ì—dy in™Ÿlized‡ ¨[' . 
$this
->
	`kšdOf
() . ']<br />';

1301 
$this
->
myty³
 = $this->
xmÌpcTy³s
['struct'];

1302 
$this
->
me
['¡ruù'] = 
$v®s
;

1304 
	}
}

1306 
funùiÚ
 
	$kšdOf
()

1308 
$this
->
myty³
)

1322 
	}
}

1324 
funùiÚ
 
	$£rŸlized©a
(
$typ
, 
$v®
)

1326 
$rs
 = '';

1328 
$this
->
xmÌpcTy³s
[
$typ
])

1332 
$rs
 .= "<struct>\n";

1333 
	`»£t
(
$v®
);

1334 
	`li¡
(
$key2
, 
$v®2
èğ
	`—ch
(
$v®
))

1336 
$rs
 .= "<member>\n<name>{$key2}</name>\n";

1337 
$rs
 .ğ
$this
->
	`£rŸlizev®
(
$v®2
);

1338 
$rs
 .= "</member>\n";

1340 
$rs
 .= '</struct>';

1344 
$rs
 .= "<array>\n<data>\n";

1345 
$i
=0; $˜< 
	`couÁ
(
$v®
); $i++)

1347 
$rs
 .ğ
$this
->
	`£rŸlizev®
(
$v®
[
$i
]);

1349 
$rs
.="</data>\n</array>\n";

1353 
$typ
)

1355 
$this
->
xmÌpcBa£64
:

1356 
$rs
 .ğ"<{$typ}>" . 
	`ba£64_’code
((
¡ršg
)
$v®
) . "</{$typ}>\n";

1358 
$this
->
xmÌpcBoŞ—n
:

1359 
$rs
 .ğ"<{$typ}>" . ((
boŞ
)
$v®
 ? '1' : '0') . "</{$typ}>\n";

1361 
$this
->
xmÌpcSŒšg
:

1362 
$rs
 .ğ"<{$typ}>" . 
	`html¥ecŸlch¬s
((
¡ršg
)
$v®
). "</{$typ}>\n";

1365 
$rs
 .= "<{$typ}>{$val}</{$typ}>\n";

1371  
$rs
;

1372 
	}
}

1374 
funùiÚ
 
	$£rŸlize_şass
()

1376  
$this
->
	`£rŸlizev®
($this);

1377 
	}
}

1379 
funùiÚ
 
	$£rŸlizev®
(
$o
)

1381 
$¬
 = 
$o
->
me
;

1382 
	`»£t
(
$¬
);

1384 
	`li¡
(
$typ
, 
$v®
èğ
	`—ch
(
$¬
);

1385 
$rs
 = "<v®ue>\n".
$this
->
	`£rŸlized©a
(
$typ
, 
$v®
)."</value>\n";

1386  
$rs
;

1387 
	}
}

1389 
funùiÚ
 
	$sÿÏrv®
()

1391 
	`»£t
(
$this
->
me
);

1392 
	`li¡
(
$a
,
$b
èğ
	`—ch
(
$this
->
me
);

1393  
$b
;

1394 
	}
}

1403 
funùiÚ
 
	$iso8601_’code
(
$time
, 
$utc
=0)

1405 ià(
$utc
 == 1)

1407 
$t
 = 
	`¡ráime
("%Y%m%dT%H:%i:%s", 
$time
);

1411 ià(
	`funùiÚ_exi¡s
('gmstrftime'))

1412 
$t
 = 
	`gm¡ráime
("%Y%m%dT%H:%i:%s", 
$time
);

1414 
$t
 = 
	`¡ráime
("%Y%m%dT%H:%i:%s", 
$time
 - 
	`d©e
('Z'));

1416  
$t
;

1417 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Xmlrpcs.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

16 iàĞ! 
funùiÚ_exi¡s
('xml_parser_create'))

18 
show_”rÜ
('Your PHP installation does‚ot support XML');

21 iàĞ! 
şass_exi¡s
('CI_Xmlrpc'))

23 
show_”rÜ
('You must†oadhe Xmlrpc class before†oadinghe Xmlrpcs class in ordero create‡ server.');

37 şas 
	cCI_XmÌpcs
 
ex‹nds
 
	mCI_XmÌpc


39 
v¬
 
	m$m‘hods
 = 
¬¿y
();

40 
v¬
 
	m$debug_msg
 = '';

41 
v¬
 
	m$sy¡em_m‘hods
 = 
¬¿y
();

42 
v¬
 
	m$cÚŒŞËr_obj
;

44 
v¬
 
	m$objeù
 = 
FALSE
;

49 
public
 
funùiÚ
 
__cÚ¡ruù
(
$cÚfig
=
	$¬¿y
())

51 
·»Á
::
	`__cÚ¡ruù
();

52 
$this
->
	`£t_sy¡em_m‘hods
();

54 ià(
	`is£t
(
$cÚfig
['funùiÚs']è&& 
	`is_¬¿y
($config['functions']))

56 
$this
->
m‘hods
 = 
	`¬¿y_m”ge
($this->m‘hods, 
$cÚfig
['functions']);

59 
	`log_mes§ge
('debug', "XML-RPC Server Class Initialized");

71 
funùiÚ
 
	`š™Ÿlize
(
$cÚfig
=
	$¬¿y
())

73 ià(
	`is£t
(
$cÚfig
['funùiÚs']è&& 
	`is_¬¿y
($config['functions']))

75 
$this
->
m‘hods
 = 
	`¬¿y_m”ge
($this->m‘hods, 
$cÚfig
['functions']);

78 ià(
	`is£t
(
$cÚfig
['debug']))

80 
$this
->
debug
 = 
$cÚfig
['debug'];

83 ià(
	`is£t
(
$cÚfig
['objeù']è&& 
	`is_objeù
($config['object']))

85 
$this
->
objeù
 = 
$cÚfig
['object'];

88 ià(
	`is£t
(
$cÚfig
['xss_clean']))

90 
$this
->
xss_ş—n
 = 
$cÚfig
['xss_clean'];

92 
	}
}

102 
funùiÚ
 
	$£t_sy¡em_m‘hods
()

104 
$this
->
m‘hods
 = 
	`¬¿y
(

105 'sy¡em.li¡M‘hods' => 
	`¬¿y
(

107 'sigÇtu»' => 
	`¬¿y
×¼ay(
$this
->
xmÌpcA¼ay
, $this->
xmÌpcSŒšg
),‡rray($this->xmlrpcArray)),

109 'sy¡em.m‘hodH–p' => 
	`¬¿y
(

111 'sigÇtu»' => 
	`¬¿y
×¼ay(
$this
->
xmÌpcSŒšg
, $this->xmlrpcString)),

113 'sy¡em.m‘hodSigÇtu»' => 
	`¬¿y
(

115 'sigÇtu»' => 
	`¬¿y
×¼ay(
$this
->
xmÌpcA¼ay
, $this->
xmÌpcSŒšg
)),

117 'sy¡em.muÉiÿÎ' => 
	`¬¿y
(

119 'sigÇtu»' => 
	`¬¿y
×¼ay(
$this
->
xmÌpcA¼ay
, $this->xmlrpcArray)),

122 
	}
}

132 
funùiÚ
 
	$£rve
()

134 
$r
 = 
$this
->
	`·r£Reque¡
();

135 
$·ylßd
 = '<?xmÈv”siÚ="1.0"ƒncodšg="'.
$this
->
xmÌpc_deãncodšg
.'"?'.'>'."\n";

136 
$·ylßd
 .ğ
$this
->
debug_msg
;

137 
$·ylßd
 .ğ
$r
->
	`´•¬e_»¥Ú£
();

139 
	`h—d”
("Content-Type:ext/xml");

140 
	`h—d”
("CÚ‹Á-L’gth: ".
	`¡¾’
(
$·ylßd
));

141 
	`ex™
(
$·ylßd
);

142 
	}
}

156 
funùiÚ
 
	$add_to_m­
(
$m‘hodÇme
, 
$funùiÚ
, 
$sig
, 
$doc
)

158 
$this
->
m‘hods
[
$m‘hodÇme
] = 
	`¬¿y
(

159 'funùiÚ' => 
$funùiÚ
,

160 'sigÇtu»' => 
$sig
,

161 'doc¡ršg' => 
$doc


163 
	}
}

174 
funùiÚ
 
·r£Reque¡
(
$d©a
='')

176 
glob®
 
$HTTP_RAW_POST_DATA
;

182 ià(
	g$d©a
 == '')

184 
$d©a
 = 
$HTTP_RAW_POST_DATA
;

191 
	g$·r£r
 = 
xml_·r£r_ü—‹
(
$this
->
xmÌpc_deãncodšg
);

192 
	g$·r£r_objeù
 = 
Ãw
 
XML_RPC_Mes§ge
("filler");

194 
	g$·r£r_objeù
->
	gxh
[
$·r£r
] = 
¬¿y
();

195 
	g$·r£r_objeù
->
	gxh
[
$·r£r
]['isf'] = 0;

196 
	g$·r£r_objeù
->
	gxh
[
$·r£r
]['isf_reason'] = '';

197 
	g$·r£r_objeù
->
	gxh
[
$·r£r
]['·¿ms'] = 
¬¿y
();

198 
	g$·r£r_objeù
->
	gxh
[
$·r£r
]['¡ack'] = 
¬¿y
();

199 
	g$·r£r_objeù
->
	gxh
[
$·r£r
]['v®ue¡ack'] = 
¬¿y
();

200 
	g$·r£r_objeù
->
	gxh
[
$·r£r
]['method'] = '';

202 
xml_£t_objeù
(
$·r£r
, 
$·r£r_objeù
);

203 
xml_·r£r_£t_İtiÚ
(
$·r£r
, 
XML_OPTION_CASE_FOLDING
, 
Œue
);

204 
xml_£t_–em’t_hªdËr
(
$·r£r
, 'open_tag', 'closing_tag');

205 
xml_£t_ch¬aù”_d©a_hªdËr
(
$·r£r
, 'character_data');

213 iàĞ! 
xml_·r£
(
$·r£r
, 
$d©a
, 1))

216 
	g$r
 = 
Ãw
 
XML_RPC_Re¥Ú£
(0,

217 
$this
->
xmÌpû¼xml
 + 
xml_g‘_”rÜ_code
(
$·r£r
),

218 
¥rštf
('XMLƒrror: %s‡t†ine %d',

219 
xml_”rÜ_¡ršg
(
xml_g‘_”rÜ_code
(
$·r£r
)),

220 
xml_g‘_cu¼’t_lše_numb”
(
$·r£r
)));

221 
xml_·r£r_ä“
(
$·r£r
);

223 
–£if
 (
$·r£r_objeù
->
xh
[
$·r£r
]['isf'])

225  
Ãw
 
XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['šv®id_»tuº'], $this->
xmÌpc¡r
['invalid_return']);

229 
xml_·r£r_ä“
(
$·r£r
);

231 
	g$m
 = 
Ãw
 
XML_RPC_Mes§ge
(
$·r£r_objeù
->
xh
[
$·r£r
]['method']);

232 
	g$¶i¡
='';

234 
	g$i
=0; $˜< 
couÁ
(
$·r£r_objeù
->
xh
[
$·r£r
]['params']); $i++)

236 ià(
	g$this
->
	gdebug
 ==ğ
TRUE
)

238 
$¶i¡
 .ğ"$˜- " . 
´št_r
(
g‘_objeù_v¬s
(
$·r£r_objeù
->
xh
[
$·r£r
]['·¿ms'][
$i
]), 
TRUE
). ";\n";

241 
	g$m
->
addP¬am
(
$·r£r_objeù
->
xh
[
$·r£r
]['·¿ms'][
$i
]);

244 ià(
	g$this
->
	gdebug
 ==ğ
TRUE
)

246 
echo
 "<pre>";

247 
	gecho
 "---PLIST---\n" . 
	g$¶i¡
 . "\n---PLIST END---\n\n";

248 
	gecho
 "</pre>";

251 
	g$r
 = 
$this
->
_execu‹
(
$m
);

258 ià(
	g$this
->
	gdebug
 ==ğ
TRUE
)

260 
$this
->
debug_msg
 = "<!-- DEBUG INFO:\n\n".
$¶i¡
."\n END DEBUG-->\n";

263  
	g$r
;

275 
funùiÚ
 
	$_execu‹
(
$m
)

277 
$m‘hName
 = 
$m
->
m‘hod_Çme
;

280 
$sy¡em_ÿÎ
 = (
	`¡ºcmp
(
$m‘hName
, 'sy¡em', 5è=ğ0è? 
TRUE
 : 
FALSE
;

282 ià(
$this
->
xss_ş—n
 =ğ
FALSE
)

284 
$m
->
xss_ş—n
 = 
FALSE
;

291 iàĞ! 
	`is£t
(
$this
->
m‘hods
[
$m‘hName
]['function']))

293  
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['unknown_m‘hod'], $this->
xmÌpc¡r
['unknown_method']);

300 
$m‘hod_·¹s
 = 
	`ex¶ode
(".", 
$this
->
m‘hods
[
$m‘hName
]['function']);

301 
$objeùC®l
 = (
	`is£t
(
$m‘hod_·¹s
['1']è&& $m‘hod_·¹s['1'] !ğ""è? 
TRUE
 : 
FALSE
;

303 ià(
$sy¡em_ÿÎ
 ==ğ
TRUE
)

305 iàĞ! 
	`is_ÿÎabË
(
	`¬¿y
(
$this
,
$m‘hod_·¹s
['1'])))

307  
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['unknown_m‘hod'], $this->
xmÌpc¡r
['unknown_method']);

312 ià(
$objeùC®l
 && ! 
	`is_ÿÎabË
(
	`¬¿y
(
$m‘hod_·¹s
['0'],$method_parts['1'])))

314  
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['unknown_m‘hod'], $this->
xmÌpc¡r
['unknown_method']);

316 
	`–£if
 ( ! 
$objeùC®l
 && ! 
	`is_ÿÎabË
(
$this
->
m‘hods
[
$m‘hName
]['function']))

318  
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['unknown_m‘hod'], $this->
xmÌpc¡r
['unknown_method']);

326 ià(
	`is£t
(
$this
->
m‘hods
[
$m‘hName
]['signature']))

328 
$sig
 = 
$this
->
m‘hods
[
$m‘hName
]['signature'];

329 
$i
=0; $i<
	`couÁ
(
$sig
); $i++)

331 
$cu¼’t_sig
 = 
$sig
[
$i
];

333 ià(
	`couÁ
(
$cu¼’t_sig
è=ğcouÁ(
$m
->
·¿ms
)+1)

335 
$n
=0; $À< 
	`couÁ
(
$m
->
·¿ms
); $n++)

337 
$p
 = 
$m
->
·¿ms
[
$n
];

338 
$±
 = (
$p
->
	`kšdOf
(è=ğ'sÿÏr'è? $p->
	`sÿÏrv®
() : $p->kindOf();

340 ià(
$±
 !ğ
$cu¼’t_sig
[
$n
+1])

342 
$²o
 = 
$n
+1;

343 
$wª‹d
 = 
$cu¼’t_sig
[
$n
+1];

345  
Ãw
 
	`XML_RPC_Re¥Ú£
(0,

346 
$this
->
xmÌpû¼
['incorrect_params'],

347 
$this
->
xmÌpc¡r
['incorrect_params'] .

359 ià(
$objeùC®l
 ==ğ
TRUE
)

361 ià(
$m‘hod_·¹s
[0] =ğ"this" && 
$sy¡em_ÿÎ
 =ğ
TRUE
)

363  
	`ÿÎ_u£r_func
(
	`¬¿y
(
$this
, 
$m‘hod_·¹s
[1]), 
$m
);

367 ià(
$this
->
objeù
 ==ğ
FALSE
)

369 
$CI
 =& 
	`g‘_š¡ªû
();

370  
$CI
->
$m‘hod_·¹s
['1'](
$m
);

374  
$this
->
objeù
->
$m‘hod_·¹s
['1'](
$m
);

381  
	`ÿÎ_u£r_func
(
$this
->
m‘hods
[
$m‘hName
]['funùiÚ'], 
$m
);

383 
	}
}

394 
funùiÚ
 
	$li¡M‘hods
(
$m
)

396 
$v
 = 
Ãw
 
	`XML_RPC_V®ues
();

397 
$ouut
 = 
	`¬¿y
();

399 
	`fÜ—ch
 (
$this
->
m‘hods
 
as
 
$key
 => 
$v®ue
)

401 
$ouut
[] = 
Ãw
 
	`XML_RPC_V®ues
(
$key
, 'string');

404 
	`fÜ—ch
 (
$this
->
sy¡em_m‘hods
 
as
 
$key
 => 
$v®ue
)

406 
$ouut
[]ğ
Ãw
 
	`XML_RPC_V®ues
(
$key
, 'string');

409 
$v
->
	`addA¼ay
(
$ouut
);

410  
Ãw
 
	`XML_RPC_Re¥Ú£
(
$v
);

411 
	}
}

422 
funùiÚ
 
	$m‘hodSigÇtu»
(
$m
)

424 
$·¿m‘”s
 = 
$m
->
	`ouut_·¿m‘”s
();

425 
$m‘hod_Çme
 = 
$·¿m‘”s
[0];

427 ià(
	`is£t
(
$this
->
m‘hods
[
$m‘hod_Çme
]))

429 ià(
$this
->
m‘hods
[
$m‘hod_Çme
]['signature'])

431 
$sigs
 = 
	`¬¿y
();

432 
$sigÇtu»
 = 
$this
->
m‘hods
[
$m‘hod_Çme
]['signature'];

434 
$i
=0; $˜< 
	`couÁ
(
$sigÇtu»
); $i++)

436 
$cursig
 = 
	`¬¿y
();

437 
$šSig
 = 
$sigÇtu»
[
$i
];

438 
$j
=0; $j<
	`couÁ
(
$šSig
); $j++)

440 
$cursig
[]ğ
Ãw
 
	`XML_RPC_V®ues
(
$šSig
[
$j
], 'string');

442 
$sigs
[]ğ
Ãw
 
	`XML_RPC_V®ues
(
$cursig
, 'array');

444 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
Òew 
	`XML_RPC_V®ues
(
$sigs
, 'array'));

448 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
Òew 
	`XML_RPC_V®ues
('undef', 'string'));

453 
$r
 = 
Ãw
 
	`XML_RPC_Re¥Ú£
(0,
$this
->
xmÌpû¼
['šŒo¥eù_unknown'], $this->
xmÌpc¡r
['introspect_unknown']);

455  
$r
;

456 
	}
}

467 
funùiÚ
 
	$m‘hodH–p
(
$m
)

469 
$·¿m‘”s
 = 
$m
->
	`ouut_·¿m‘”s
();

470 
$m‘hod_Çme
 = 
$·¿m‘”s
[0];

472 ià(
	`is£t
(
$this
->
m‘hods
[
$m‘hod_Çme
]))

474 
$doc¡ršg
 = 
	`is£t
(
$this
->
m‘hods
[
$m‘hod_Çme
]['docstring']) ? $this->methods[$method_name]['docstring'] : '';

476  
Ãw
 
	`XML_RPC_Re¥Ú£
Òew 
	`XML_RPC_V®ues
(
$doc¡ršg
, 'string'));

480  
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['šŒo¥eù_unknown'], $this->
xmÌpc¡r
['introspect_unknown']);

482 
	}
}

493 
funùiÚ
 
	$muÉiÿÎ
(
$m
)

496  
Ãw
 
	`XML_RPC_Re¥Ú£
(0, 
$this
->
xmÌpû¼
['unknown_m‘hod'], $this->
xmÌpc¡r
['unknown_method']);

498 
$·¿m‘”s
 = 
$m
->
	`ouut_·¿m‘”s
();

499 
$ÿÎs
 = 
$·¿m‘”s
[0];

501 
$»suÉ
 = 
	`¬¿y
();

503 
	`fÜ—ch
 (
$ÿÎs
 
as
 
$v®ue
)

507 
$m
 = 
Ãw
 
	`XML_RPC_Mes§ge
(
$v®ue
[0]);

508 
$¶i¡
='';

510 
$i
=0; $˜< 
	`couÁ
(
$v®ue
[1]); $i++)

512 
$m
->
	`addP¬am
(
Ãw
 
	`XML_RPC_V®ues
(
$v®ue
[1][
$i
], 'string'));

515 
$©‹m±
 = 
$this
->
	`_execu‹
(
$m
);

517 ià(
$©‹m±
->
	`çuÉCode
() != 0)

519  
$©‹m±
;

522 
$»suÉ
[] = 
Ãw
 
	`XML_RPC_V®ues
(
	`¬¿y
(
$©‹m±
->
	`v®ue
()), 'array');

525  
Ãw
 
	`XML_RPC_Re¥Ú£
Òew 
	`XML_RPC_V®ues
(
$»suÉ
, 'array'));

526 
	}
}

537 
funùiÚ
 
	$muÉiÿÎ_”rÜ
(
$”r
)

539 
$¡r
 = 
	`is_¡ršg
(
$”r
è? 
$this
->
xmÌpc¡r
["muÉiÿÎ_${”r}"] : $”r->
	`çuÉSŒšg
();

540 
$code
 = 
	`is_¡ršg
(
$”r
è? 
$this
->
xmÌpû¼
["muÉiÿÎ_${”r}"] : $”r->
	`çuÉCode
();

542 
$¡ruù
['çuÉCode'] = 
Ãw
 
	`XML_RPC_V®ues
(
$code
, 'int');

543 
$¡ruù
['çuÉSŒšg'] = 
Ãw
 
	`XML_RPC_V®ues
(
$¡r
, 'string');

545  
Ãw
 
	`XML_RPC_V®ues
(
$¡ruù
, 'struct');

546 
	}
}

557 
funùiÚ
 
	$do_muÉiÿÎ
(
$ÿÎ
)

559 ià(
$ÿÎ
->
	`kšdOf
() != 'struct')

561  
$this
->
	`muÉiÿÎ_”rÜ
('notstruct');

563 
	`–£if
 ( ! 
$m‘hName
 = 
$ÿÎ
->
me
['struct']['methodName'])

565  
$this
->
	`muÉiÿÎ_”rÜ
('nomethod');

568 
	`li¡
(
$sÿÏr_ty³
,
$sÿÏr_v®ue
)=
	`—ch
(
$m‘hName
->
me
);

569 
$sÿÏr_ty³
 = $sÿÏr_ty³ =ğ
$this
->
xmÌpcI4
 ? $this->
xmÌpcIÁ
 : $scalar_type;

571 ià(
$m‘hName
->
	`kšdOf
(è!ğ'sÿÏr' 
OR
 
$sÿÏr_ty³
 != 'string')

573  
$this
->
	`muÉiÿÎ_”rÜ
('notstring');

575 
	`–£if
 (
$sÿÏr_v®ue
 == 'system.multicall')

577  
$this
->
	`muÉiÿÎ_”rÜ
('recursion');

579 
	`–£if
 ( ! 
$·¿ms
 = 
$ÿÎ
->
me
['struct']['params'])

581  
$this
->
	`muÉiÿÎ_”rÜ
('noparams');

583 
	`–£if
 (
$·¿ms
->
	`kšdOf
() != 'array')

585  
$this
->
	`muÉiÿÎ_”rÜ
('notarray');

588 
	`li¡
(
$a
,
$b
)=
	`—ch
(
$·¿ms
->
me
);

589 
$numP¬ams
 = 
	`couÁ
(
$b
);

591 
$msg
 = 
Ãw
 
	`XML_RPC_Mes§ge
(
$sÿÏr_v®ue
);

592 
$i
 = 0; $˜< 
$numP¬ams
; $i++)

594 
$msg
->
·¿ms
[] = 
$·¿ms
->
me
['¬¿y'][
$i
];

597 
$»suÉ
 = 
$this
->
	`_execu‹
(
$msg
);

599 ià(
$»suÉ
->
	`çuÉCode
() != 0)

601  
$this
->
	`muÉiÿÎ_”rÜ
(
$»suÉ
);

604  
Ãw
 
	`XML_RPC_V®ues
(
	`¬¿y
(
$»suÉ
->
	`v®ue
()), 'array');

605 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Zip.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

33 şas 
	cCI_Z
 {

35 
v¬
 
	m$zd©a
 = '';

36 
v¬
 
	m$dœeùÜy
 = '';

37 
v¬
 
	m$’Œ›s
 = 0;

38 
v¬
 
	m$fe_num
 = 0;

39 
v¬
 
	m$off£t
 = 0;

40 
v¬
 
	m$now
;

45 
public
 
funùiÚ
 
	$__cÚ¡ruù
()

47 
	`log_mes§ge
('debug', "Zip Compression Class Initialized");

49 
$this
->
now
 = 
	`time
();

63 
funùiÚ
 
	$add_dœ
(
$dœeùÜy
)

65 
	`fÜ—ch
 ((
¬¿y
)
$dœeùÜy
 
as
 
$dœ
)

67 iàĞ! 
	`´eg_m©ch
("|.+/$|", 
$dœ
))

69 
$dœ
 .= '/';

72 
$dœ_time
 = 
$this
->
	`_g‘_mod_time
(
$dœ
);

74 
$this
->
	`_add_dœ
(
$dœ
, 
$dœ_time
['file_mtime'], $dir_time['file_mdate']);

76 
	}
}

88 
funùiÚ
 
	$_g‘_mod_time
(
$dœ
)

91 
$d©e
 = (@
	`femtime
(
$dœ
)è? femtime($dœè: 
	`g‘d©e
(
$this
->
now
);

93 
$time
['fe_mtime'] = (
$d©e
['hours'] << 11) + ($date['minutes'] << 5) + $date['seconds'] / 2;

94 
$time
['fe_md©e'] = ((
$d©e
['year'] - 1980) << 9) + ($date['mon'] << 5) + $date['mday'];

96  
$time
;

97 
	}
}

108 
funùiÚ
 
	$_add_dœ
(
$dœ
, 
$fe_mtime
, 
$fe_md©e
)

110 
$dœ
 = 
	`¡r_»¶aû
("\\", "/", $dir);

112 
$this
->
zd©a
 .=

114 .
	`·ck
('v', 
$fe_mtime
)

115 .
	`·ck
('v', 
$fe_md©e
)

116 .
	`·ck
('V', 0)

117 .
	`·ck
('V', 0)

118 .
	`·ck
('V', 0)

119 .
	`·ck
('v', 
	`¡¾’
(
$dœ
))

120 .
	`·ck
('v', 0)

121 .
$dœ


123 .
	`·ck
('V', 0)

124 .
	`·ck
('V', 0)

125 .
	`·ck
('V', 0);

127 
$this
->
dœeùÜy
 .=

129 .
	`·ck
('v', 
$fe_mtime
)

130 .
	`·ck
('v', 
$fe_md©e
)

131 .
	`·ck
('V',0)

132 .
	`·ck
('V',0)

133 .
	`·ck
('V',0)

134 .
	`·ck
('v', 
	`¡¾’
(
$dœ
))

135 .
	`·ck
('v', 0)

136 .
	`·ck
('v', 0)

137 .
	`·ck
('v', 0)

138 .
	`·ck
('v', 0)

139 .
	`·ck
('V', 16)

140 .
	`·ck
('V', 
$this
->
off£t
)

141 .
$dœ
;

143 
$this
->
off£t
 = 
	`¡¾’
($this->
zd©a
);

144 
$this
->
’Œ›s
++;

145 
	}
}

161 
funùiÚ
 
	$add_d©a
(
$f•©h
, 
$d©a
 = 
NULL
)

163 ià(
	`is_¬¿y
(
$f•©h
))

165 
	`fÜ—ch
 (
$f•©h
 
as
 
$·th
 => 
$d©a
)

167 
$fe_d©a
 = 
$this
->
	`_g‘_mod_time
(
$·th
);

169 
$this
->
	`_add_d©a
(
$·th
, 
$d©a
, 
$fe_d©a
['file_mtime'], $file_data['file_mdate']);

174 
$fe_d©a
 = 
$this
->
	`_g‘_mod_time
(
$f•©h
);

176 
$this
->
	`_add_d©a
(
$f•©h
, 
$d©a
, 
$fe_d©a
['file_mtime'], $file_data['file_mdate']);

178 
	}
}

190 
funùiÚ
 
	$_add_d©a
(
$f•©h
, 
$d©a
, 
$fe_mtime
, 
$fe_md©e
)

192 
$f•©h
 = 
	`¡r_»¶aû
("\\", "/", $filepath);

194 
$uncom´es£d_size
 = 
	`¡¾’
(
$d©a
);

195 
$üc32
 = 
	`üc32
(
$d©a
);

197 
$gzd©a
 = 
	`gzcom´ess
(
$d©a
);

198 
$gzd©a
 = 
	`sub¡r
($gzdata, 2, -4);

199 
$com´es£d_size
 = 
	`¡¾’
(
$gzd©a
);

201 
$this
->
zd©a
 .=

203 .
	`·ck
('v', 
$fe_mtime
)

204 .
	`·ck
('v', 
$fe_md©e
)

205 .
	`·ck
('V', 
$üc32
)

206 .
	`·ck
('V', 
$com´es£d_size
)

207 .
	`·ck
('V', 
$uncom´es£d_size
)

208 .
	`·ck
('v', 
	`¡¾’
(
$f•©h
))

209 .
	`·ck
('v', 0)

210 .
$f•©h


211 .
$gzd©a
;

213 
$this
->
dœeùÜy
 .=

215 .
	`·ck
('v', 
$fe_mtime
)

216 .
	`·ck
('v', 
$fe_md©e
)

217 .
	`·ck
('V', 
$üc32
)

218 .
	`·ck
('V', 
$com´es£d_size
)

219 .
	`·ck
('V', 
$uncom´es£d_size
)

220 .
	`·ck
('v', 
	`¡¾’
(
$f•©h
))

221 .
	`·ck
('v', 0)

222 .
	`·ck
('v', 0)

223 .
	`·ck
('v', 0)

224 .
	`·ck
('v', 0)

225 .
	`·ck
('V', 32)

226 .
	`·ck
('V', 
$this
->
off£t
)

227 .
$f•©h
;

229 
$this
->
off£t
 = 
	`¡¾’
($this->
zd©a
);

230 
$this
->
’Œ›s
++;

231 
$this
->
fe_num
++;

232 
	}
}

242 
funùiÚ
 
	$»ad_fe
(
$·th
, 
$´e£rve_f•©h
 = 
FALSE
)

244 iàĞ! 
	`fe_exi¡s
(
$·th
))

246  
FALSE
;

249 ià(
FALSE
 !=ğ(
$d©a
 = 
	`fe_g‘_cÚ‹Ás
(
$·th
)))

251 
$Çme
 = 
	`¡r_»¶aû
("\\", "/", 
$·th
);

253 ià(
$´e£rve_f•©h
 ==ğ
FALSE
)

255 
$Çme
 = 
	`´eg_»¶aû
("|.*/(.+)|", "\\1", $name);

258 
$this
->
	`add_d©a
(
$Çme
, 
$d©a
);

259  
TRUE
;

261  
FALSE
;

262 
	}
}

277 
funùiÚ
 
	$»ad_dœ
(
$·th
, 
$´e£rve_f•©h
 = 
TRUE
, 
$roÙ_·th
 = 
NULL
)

279 iàĞ! 
$å
 = @
	`İ’dœ
(
$·th
))

281  
FALSE
;

285 ià(
$roÙ_·th
 ==ğ
NULL
)

287 
$roÙ_·th
 = 
	`dœÇme
(
$·th
).'/';

290 
FALSE
 !=ğ(
$fe
 = 
	`»addœ
(
$å
)))

292 ià(
	`sub¡r
(
$fe
, 0, 1) == '.')

297 ià(@
	`is_dœ
(
$·th
.
$fe
))

299 
$this
->
	`»ad_dœ
(
$·th
.
$fe
."/", 
$´e£rve_f•©h
, 
$roÙ_·th
);

303 ià(
FALSE
 !=ğ(
$d©a
 = 
	`fe_g‘_cÚ‹Ás
(
$·th
.
$fe
)))

305 
$Çme
 = 
	`¡r_»¶aû
("\\", "/", 
$·th
);

307 ià(
$´e£rve_f•©h
 ==ğ
FALSE
)

309 
$Çme
 = 
	`¡r_»¶aû
(
$roÙ_·th
, '', $name);

312 
$this
->
	`add_d©a
(
$Çme
.
$fe
, 
$d©a
);

317  
TRUE
;

318 
	}
}

328 
funùiÚ
 
	$g‘_z
()

331 ià(
$this
->
’Œ›s
 == 0)

333  
FALSE
;

336 
$z_d©a
 = 
$this
->
zd©a
;

337 
$z_d©a
 .ğ
$this
->
dœeùÜy
."\x50\x4b\x05\x06\x00\x00\x00\x00";

338 
$z_d©a
 .ğ
	`·ck
('v', 
$this
->
’Œ›s
);

339 
$z_d©a
 .ğ
	`·ck
('v', 
$this
->
’Œ›s
);

340 
$z_d©a
 .ğ
	`·ck
('V', 
	`¡¾’
(
$this
->
dœeùÜy
));

341 
$z_d©a
 .ğ
	`·ck
('V', 
	`¡¾’
(
$this
->
zd©a
));

342 
$z_d©a
 .= "\x00\x00";

344  
$z_d©a
;

345 
	}
}

358 
funùiÚ
 
	$¬chive
(
$f•©h
)

360 iàĞ! (
$å
 = @
	`fİ’
(
$f•©h
, 
FOPEN_WRITE_CREATE_DESTRUCTIVE
)))

362  
FALSE
;

365 
	`æock
(
$å
, 
LOCK_EX
);

366 
	`fwr™e
(
$å
, 
$this
->
	`g‘_z
());

367 
	`æock
(
$å
, 
LOCK_UN
);

368 
	`fşo£
(
$å
);

370  
TRUE
;

371 
	}
}

383 
funùiÚ
 
dowÆßd
(
$f’ame
 = 'backup.zip')

385 iàĞ! 
´eg_m©ch
("|.+?\.z$|", 
$f’ame
))

387 
$f’ame
 .= '.zip';

390 
	g$CI
 =& 
g‘_š¡ªû
();

391 
	g$CI
->
	glßd
->
h–³r
('download');

393 
	g$g‘_z
 = 
$this
->
g‘_z
();

395 
	g$z_cÚ‹Á
 =& 
$g‘_z
;

397 
fÜû_dowÆßd
(
$f’ame
, 
$z_cÚ‹Á
);

411 
funùiÚ
 
	$ş—r_d©a
()

413 
$this
->
zd©a
 = '';

414 
$this
->
dœeùÜy
 = '';

415 
$this
->
’Œ›s
 = 0;

416 
$this
->
fe_num
 = 0;

417 
$this
->
off£t
 = 0;

418 
	}
}

	@/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/javascript/Jquery.php

1 <?
php
 iàĞ! 
defšed
('BASEPATH')è
ex™
('No direct script‡ccess‡llowed');

27 şas 
	cCI_Jqu”y
 
ex‹nds
 
	mCI_Javasüt
 {

29 
v¬
 
	m$_javasüt_fŞd”
 = 'js';

30 
v¬
 
	m$jqu”y_code_fÜ_lßd
 = 
¬¿y
();

31 
v¬
 
	m$jqu”y_code_fÜ_compe
 = 
¬¿y
();

32 
v¬
 
	m$jqu”y_cÜÃr_aùive
 = 
FALSE
;

33 
v¬
 
	m$jqu”y_bË_sÜ‹r_aùive
 = 
FALSE
;

34 
v¬
 
	m$jqu”y_bË_sÜ‹r_·g”_aùive
 = 
FALSE
;

35 
v¬
 
	m$jqu”y_ajax_img
 = '';

37 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$·¿ms
)

39 
$this
->
CI
 =& 
	`g‘_š¡ªû
();

40 
	`exŒaù
(
$·¿ms
);

42 ià(
$autŞßd
 ==ğ
TRUE
)

44 
$this
->
	`süt
();

47 
	`log_mes§ge
('debug', "Jquery Class Initialized");

64 
funùiÚ
 
	`_blur
(
$–em’t
 = 'this', 
$js
 = '')

66  
$this
->
	`_add_ev’t
(
$–em’t
, 
$js
, 'blur');

67 
	}
}

81 
funùiÚ
 
_chªge
(
$–em’t
 = 'this', 
$js
 = '')

83  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'change');

99 
funùiÚ
 
_şick
(
$–em’t
 = 'this', 
$js
 = '', 
$»t_çl£
 = 
TRUE
)

101 iàĞ! 
is_¬¿y
(
$js
))

103 
$js
 = 
¬¿y
($js);

106 ià(
	g$»t_çl£
)

108 
	g$js
[] = "return false;";

111  
	g$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'click');

126 
funùiÚ
 
_dblşick
(
$–em’t
 = 'this', 
$js
 = '')

128  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'dblclick');

143 
funùiÚ
 
_”rÜ
(
$–em’t
 = 'this', 
$js
 = '')

145  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'error');

160 
funùiÚ
 
_focus
(
$–em’t
 = 'this', 
$js
 = '')

162  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'focus');

178 
funùiÚ
 
_hov”
(
$–em’t
 = 'this', 
$ov”
, 
$out
)

180 
	g$ev’t
 = "\n\t$(" . 
$this
->
_´•_–em’t
(
$–em’t
) . ").hover(\n\t\tfunction()\n\t\t{\n\t\t\t{$over}\n\t\t}, \n\t\tfunction()\n\t\t{\n\t\t\t{$out}\n\t\t});\n";

182 
	g$this
->
	gjqu”y_code_fÜ_compe
[] = 
$ev’t
;

184  
	g$ev’t
;

199 
funùiÚ
 
_keydown
(
$–em’t
 = 'this', 
$js
 = '')

201  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'keydown');

216 
funùiÚ
 
_keyup
(
$–em’t
 = 'this', 
$js
 = '')

218  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'keyup');

233 
funùiÚ
 
_lßd
(
$–em’t
 = 'this', 
$js
 = '')

235  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'load');

250 
funùiÚ
 
_mou£down
(
$–em’t
 = 'this', 
$js
 = '')

252  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'mousedown');

267 
funùiÚ
 
_mou£out
(
$–em’t
 = 'this', 
$js
 = '')

269  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'mouseout');

284 
funùiÚ
 
_mou£ov”
(
$–em’t
 = 'this', 
$js
 = '')

286  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'mouseover');

301 
funùiÚ
 
_mou£up
(
$–em’t
 = 'this', 
$js
 = '')

303  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'mouseup');

318 
funùiÚ
 
_ouut
(
$¬¿y_js
 = '')

320 iàĞ! 
is_¬¿y
(
$¬¿y_js
))

322 
$¬¿y_js
 = 
¬¿y
($array_js);

325 
fÜ—ch
 (
$¬¿y_js
 
as
 
$js
)

327 
	g$this
->
	gjqu”y_code_fÜ_compe
[] = "\t$js\n";

343 
funùiÚ
 
_»size
(
$–em’t
 = 'this', 
$js
 = '')

345  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'resize');

360 
funùiÚ
 
_süŞl
(
$–em’t
 = 'this', 
$js
 = '')

362  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'scroll');

377 
funùiÚ
 
_uÆßd
(
$–em’t
 = 'this', 
$js
 = '')

379  
$this
->
_add_ev’t
(
$–em’t
, 
$js
, 'unload');

395 
funùiÚ
 
_addCÏss
(
$–em’t
 = 'this', 
$şass
='')

397 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

398 
	g$¡r
 = "$({$element}).addClass(\"$class\");";

399  
	g$¡r
;

415 
funùiÚ
 
_ªim©e
(
$–em’t
 = 'this', 
$·¿ms
 = 
¬¿y
(), 
$¥“d
 = '', 
$exŒa
 = '')

417 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

418 
	g$¥“d
 = 
$this
->
_v®id©e_¥“d
(
$¥“d
);

420 
	g$ªim©iÚs
 = "\t\t\t";

422 
fÜ—ch
 (
$·¿ms
 
as
 
$·¿m
=>
$v®ue
)

424 
$ªim©iÚs
 .ğ
$·¿m
.': \''.
$v®ue
.'\', ';

427 
	g$ªim©iÚs
 = 
sub¡r
(
$ªim©iÚs
, 0, -2);

429 ià(
	g$¥“d
 != '')

431 
$¥“d
 = ', '.$speed;

434 ià(
	g$exŒa
 != '')

436 
$exŒa
 = ', '.$extra;

439 
	g$¡r
 = "$({$–em’t}).ªim©e({\n$ªim©iÚs\n\t\t}".
$¥“d
.
$exŒa
.");";

441  
	g$¡r
;

457 
funùiÚ
 
_çdeIn
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

459 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

460 
	g$¥“d
 = 
$this
->
_v®id©e_¥“d
(
$¥“d
);

462 ià(
	g$ÿÎback
 != '')

464 
$ÿÎback
 = ", function(){\n{$callback}\n}";

467 
	g$¡r
 = "$({$element}).fadeIn({$speed}{$callback});";

469  
	g$¡r
;

485 
funùiÚ
 
_çdeOut
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

487 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

488 
	g$¥“d
 = 
$this
->
_v®id©e_¥“d
(
$¥“d
);

490 ià(
	g$ÿÎback
 != '')

492 
$ÿÎback
 = ", function(){\n{$callback}\n}";

495 
	g$¡r
 = "$({$element}).fadeOut({$speed}{$callback});";

497  
	g$¡r
;

513 
funùiÚ
 
_hide
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

515 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

516 
	g$¥“d
 = 
$this
->
_v®id©e_¥“d
(
$¥“d
);

518 ià(
	g$ÿÎback
 != '')

520 
$ÿÎback
 = ", function(){\n{$callback}\n}";

523 
	g$¡r
 = "$({$element}).hide({$speed}{$callback});";

525  
	g$¡r
;

539 
funùiÚ
 
_»moveCÏss
(
$–em’t
 = 'this', 
$şass
='')

541 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

542 
	g$¡r
 = "$({$element}).removeClass(\"$class\");";

543  
	g$¡r
;

559 
funùiÚ
 
_¦ideUp
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

561 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

562 
	g$¥“d
 = 
$this
->
_v®id©e_¥“d
(
$¥“d
);

564 ià(
	g$ÿÎback
 != '')

566 
$ÿÎback
 = ", function(){\n{$callback}\n}";

569 
	g$¡r
 = "$({$element}).slideUp({$speed}{$callback});";

571  
	g$¡r
;

587 
funùiÚ
 
_¦ideDown
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

589 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

590 
	g$¥“d
 = 
$this
->
_v®id©e_¥“d
(
$¥“d
);

592 ià(
	g$ÿÎback
 != '')

594 
$ÿÎback
 = ", function(){\n{$callback}\n}";

597 
	g$¡r
 = "$({$element}).slideDown({$speed}{$callback});";

599  
	g$¡r
;

615 
funùiÚ
 
_¦ideToggË
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

617 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

618 
	g$¥“d
 = 
$this
->
_v®id©e_¥“d
(
$¥“d
);

620 ià(
	g$ÿÎback
 != '')

622 
$ÿÎback
 = ", function(){\n{$callback}\n}";

625 
	g$¡r
 = "$({$element}).slideToggle({$speed}{$callback});";

627  
	g$¡r
;

641 
funùiÚ
 
_toggË
(
$–em’t
 = 'this')

643 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

644 
	g$¡r
 = "$({$element}).toggle();";

645  
	g$¡r
;

659 
funùiÚ
 
_toggËCÏss
(
$–em’t
 = 'this', 
$şass
='')

661 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

662 
	g$¡r
 = "$({$element}).toggleClass(\"$class\");";

663  
	g$¡r
;

679 
funùiÚ
 
_show
(
$–em’t
 = 'this', 
$¥“d
 = '', 
$ÿÎback
 = '')

681 
$–em’t
 = 
$this
->
_´•_–em’t
($element);

682 
	g$¥“d
 = 
$this
->
_v®id©e_¥“d
(
$¥“d
);

684 ià(
	g$ÿÎback
 != '')

686 
$ÿÎback
 = ", function(){\n{$callback}\n}";

689 
	g$¡r
 = "$({$element}).show({$speed}{$callback});";

691  
	g$¡r
;

709 
funùiÚ
 
_upd©”
(
$cÚš”
 = 'this', 
$cÚŒŞËr
, 
$İtiÚs
 = '')

711 
$cÚš”
 = 
$this
->
_´•_–em’t
($container);

713 
	g$cÚŒŞËr
 = (
¡½os
('://', 
$cÚŒŞËr
è==ğ
FALSE
è? $cÚŒŞË¸: 
$this
->
CI
->
cÚfig
->
s™e_u¾
($controller);

716 ià(
	g$this
->
	gCI
->
	gcÚfig
->
™em
('javascript_ajax_img') == '')

718 
$lßdšg_nÙif›r
 = "Loading...";

722 
	g$lßdšg_nÙif›r
 = '<img src=\'' . 
$this
->
CI
->
cÚfig
->
¦ash_™em
('ba£_u¾'è. $this->CI->cÚfig->
™em
('javascript_ajax_img') . '\'‡lt=\'Loading\' />';

725 
	g$upd©”
 = "$($container).empty();\n";

726 
	g$upd©”
 .= "\t\t$($container).prepend(\"$loading_notifier\");\n";

728 
	g$»que¡_İtiÚs
 = '';

729 ià(
	g$İtiÚs
 != '')

731 
$»que¡_İtiÚs
 .= ", {";

732 
	g$»que¡_İtiÚs
 .ğ(
is_¬¿y
(
$İtiÚs
)è? "'".
im¶ode
("', '", $İtiÚs)."'" : "'".
¡r_»¶aû
(":", "':'", $options)."'";

733 
	g$»que¡_İtiÚs
 .= "}";

736 
	g$upd©”
 .= "\t\t$($container).load('$controller'$request_options);";

737  
	g$upd©”
;

753 
funùiÚ
 
_zeb¿TabËs
(
$şass
 = '', 
$odd
 = 'odd', 
$hov”
 = '')

755 
$şass
 = ($class != '') ? '.'.$class : '';

757 
	g$zeb¿
 = "\t\$(\"table{$class}bodyr:nth-child(even)\").addClass(\"{$odd}\");";

759 
	g$this
->
	gjqu”y_code_fÜ_compe
[] = 
$zeb¿
;

761 ià(
	g$hov”
 != '')

763 
$hov”
 = 
$this
->
hov”
("table{$class}bodyr", "$(this).addClass('hover');", "$(this).removeClass('hover');");

766  
	g$zeb¿
;

784 
funùiÚ
 
cÜÃr
(
$–em’t
 = '', 
$cÜÃr_¡yË
 = '')

787 
$cÜÃr_loÿtiÚ
 = '/plugins/jquery.corner.js';

789 ià(
	g$cÜÃr_¡yË
 != '')

791 
$cÜÃr_¡yË
 = '"'.$corner_style.'"';

794  "$(" . 
	g$this
->
_´•_–em’t
(
$–em’t
è. ").cÜÃr(".
	g$cÜÃr_¡yË
.");";

807 
funùiÚ
 
	$mod®
(
$¤c
, 
$»Ïtive
 = 
FALSE
)

809 
$this
->
jqu”y_code_fÜ_lßd
[] = $this->
	`ex‹º®
(
$¤c
, 
$»Ïtive
);

810 
	}
}

822 
funùiÚ
 
	$efãù
(
$¤c
, 
$»Ïtive
 = 
FALSE
)

824 
$this
->
jqu”y_code_fÜ_lßd
[] = $this->
	`ex‹º®
(
$¤c
, 
$»Ïtive
);

825 
	}
}

837 
funùiÚ
 
	$¶ugš
(
$¤c
, 
$»Ïtive
 = 
FALSE
)

839 
$this
->
jqu”y_code_fÜ_lßd
[] = $this->
	`ex‹º®
(
$¤c
, 
$»Ïtive
);

840 
	}
}

852 
funùiÚ
 
	$ui
(
$¤c
, 
$»Ïtive
 = 
FALSE
)

854 
$this
->
jqu”y_code_fÜ_lßd
[] = $this->
	`ex‹º®
(
$¤c
, 
$»Ïtive
);

855 
	}
}

866 
funùiÚ
 
sÜbË
(
$–em’t
, 
$İtiÚs
 = 
	$¬¿y
())

869 ià(
	`couÁ
(
$İtiÚs
) > 0)

871 
$sÜt_İtiÚs
 = 
	`¬¿y
();

872 
	`fÜ—ch
 (
$İtiÚs
 
as
 
$k
=>
$v
)

874 
$sÜt_İtiÚs
[] = "\n\t\t".
$k
.': '.
$v
."";

876 
$sÜt_İtiÚs
 = 
	`im¶ode
(",", $sort_options);

880 
$sÜt_İtiÚs
 = '';

883  "$(" . 
$this
->
	`_´•_–em’t
(
$–em’t
è. ").sÜbË({".
$sÜt_İtiÚs
."\n\t});";

884 
	}
}

896 
funùiÚ
 
bËsÜ‹r
(
$bË
 = '', 
$İtiÚs
 = '')

898 
$this
->
jqu”y_code_fÜ_compe
[] = "\t$(" . $this->
_´•_–em’t
(
$bË
) . ").tablesorter($options);\n";

916 
funùiÚ
 
	$_add_ev’t
(
$–em’t
, 
$js
, 
$ev’t
)

918 ià(
	`is_¬¿y
(
$js
))

920 
$js
 = 
	`im¶ode
("\n\t\t", $js);

924 
$ev’t
 = "\n\t$(" . 
$this
->
	`_´•_–em’t
(
$–em’t
) . ").{$event}(function(){\n\t\t{$js}\n\t});\n";

925 
$this
->
jqu”y_code_fÜ_compe
[] = 
$ev’t
;

926  
$ev’t
;

927 
	}
}

940 
funùiÚ
 
_compe
(
$v›w_v¬
 = 'süt_foÙ', 
$süt_gs
 = 
TRUE
)

943 
$ex‹º®_süts
 = 
im¶ode
('', 
$this
->
jqu”y_code_fÜ_lßd
);

944 
	g$this
->
	gCI
->
	glßd
->
v¬s
(
¬¿y
('lib¿ry_¤c' => 
$ex‹º®_süts
));

946 ià(
couÁ
(
$this
->
jqu”y_code_fÜ_compe
) == 0 )

953 
	g$süt
 = '$(document).ready(function() {' . "\n";

954 
	g$süt
 .ğ
im¶ode
('', 
$this
->
jqu”y_code_fÜ_compe
);

955 
	g$süt
 .= '});';

957 
	g$ouut
 = (
$süt_gs
 ==ğ
FALSE
è? 
$süt
 : 
$this
->
šlše
($script);

959 
	g$this
->
	gCI
->
	glßd
->
v¬s
(
¬¿y
(
$v›w_v¬
 => 
$ouut
));

973 
funùiÚ
 
	$_ş—r_compe
()

975 
$this
->
jqu”y_code_fÜ_compe
 = 
	`¬¿y
();

976 
	}
}

988 
funùiÚ
 
	$_docum’t_»ady
(
$js
)

990 iàĞ! 
	`is_¬¿y
(
$js
))

992 
$js
 = 
	`¬¿y
 ($js);

996 
	`fÜ—ch
 (
$js
 
as
 
$süt
)

998 
$this
->
jqu”y_code_fÜ_compe
[] = 
$süt
;

1000 
	}
}

1013 
funùiÚ
 
süt
(
$lib¿ry_¤c
 = '', 
$»Ïtive
 = 
FALSE
)

1015 
$lib¿ry_¤c
 = 
$this
->
ex‹º®
($lib¿ry_¤c, 
$»Ïtive
);

1016 
	g$this
->
	gjqu”y_code_fÜ_lßd
[] = 
$lib¿ry_¤c
;

1017  
	g$lib¿ry_¤c
;

1033 
funùiÚ
 
	$_´•_–em’t
(
$–em’t
)

1035 ià(
$–em’t
 != 'this')

1037 
$–em’t
 = '"'.$element.'"';

1040  
$–em’t
;

1041 
	}
}

1054 
funùiÚ
 
	$_v®id©e_¥“d
(
$¥“d
)

1056 ià(
	`š_¬¿y
(
$¥“d
, 
	`¬¿y
('slow', 'normal', 'fast')))

1058 
$¥“d
 = '"'.$speed.'"';

1060 
	`–£if
 (
	`´eg_m©ch
("/[^0-9]/", 
$¥“d
))

1062 
$¥“d
 = '';

1065  
$¥“d
;

1066 
	}
}

	@
1
.
1
/usr/include
578
55223
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/autoload.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/config.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/constants.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/database.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/doctypes.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/foreign_chars.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/hooks.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/migration.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/mimes.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/profiler.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/routes.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/smileys.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/config/user_agents.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/admin/enum.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/admin/home.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/admin/install.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/admin/login.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/announcement.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/api.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/banner.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/contants.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/customer.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/express.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/home.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/info.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/lead.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/lee.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/login.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/message.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/objects.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/opportunity.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/platform.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/portal.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/relprivilege.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/reluser.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/remind.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/controllers/www/user.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/core/MY_Controller.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/errors/error_404.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/errors/error_db.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/errors/error_general.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/errors/error_php.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/calendar_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/date_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/db_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/email_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/error_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/form_validation_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/ftp_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/imglib_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/migration_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/number_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/profiler_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/unit_test_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/language/ch/upload_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/Code.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/Curl.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/Excel.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/FileBase.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/Page.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/Snoopy.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/TemplateEngine.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/oauth.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/oauth/request.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/libraries/oauth/response.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/attr_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/customer_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/enum_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/format_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/menu_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/nextid_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/obj_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/org_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/rel_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/remind_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/admin/type_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/service/contants_service_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/service/express_service_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/service/info_service_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/service/platform_service_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/account_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/announcement_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/api_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/banner_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/campaign_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/contants_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/department_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/info_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/lead_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/marteria_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/message_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/objects_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/opportunity_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/platform_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/relobjectprofile_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/relprivilege_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/relprofile_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/reluser_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/remind_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/role_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/type_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/models/www/user_model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/add.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/ajax_list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/ajax_select.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/ajax_select_quote-type.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/ajax_select_quote.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/controller.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/del.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/detailed_list_edit.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/detailed_list_view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/index.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/index_type.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/update.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/controllers/view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/lee_cs.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/models/model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/order/controllers/index_type.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/order/models/model.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/order/views/index.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/order/views/list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/salespay/controllers/ajax_add.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/salespay/views/ajax_add.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/add.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/ajax_list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/ajax_select.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/ajax_select_quote.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/aaa.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/date.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/edit.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/password.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/quote.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/radio.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/select.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/edit/time.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/view/checkbox.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/view/quote.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/view/radio.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/view/select.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/attrtype/view/view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/detailed_list_edit.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/detailed_list_view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/layouts/bottom.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/layouts/head.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/list111.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/list_type.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/list_y.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/update.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/template/views/view1.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Autoloader.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/APC.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/CacheBase.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/DiscISAM.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/ICache.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/Igbinary.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/Memcache.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/Memory.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/MemoryGZip.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/MemorySerialized.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/PHPTemp.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/SQLite.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/SQLite3.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorage/Wincache.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CachedObjectStorageFactory.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CalcEngine/CyclicReferenceStack.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/CalcEngine/Logger.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Database.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/DateTime.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Engineering.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Exception.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/ExceptionHandler.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Financial.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/FormulaParser.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/FormulaToken.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Function.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Functions.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Logical.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/LookupRef.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/MathTrig.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Statistical.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/TextData.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Calculation/Token/Stack.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/AdvancedValueBinder.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/DataType.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/DataValidation.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/DefaultValueBinder.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/Hyperlink.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Cell/IValueBinder.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Axis.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/DataSeries.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/DataSeriesValues.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Exception.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/GridLines.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Layout.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Legend.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/PlotArea.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Properties.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Renderer/jpgraph.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Chart/Title.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Comment.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/DocumentProperties.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/DocumentSecurity.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Exception.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/HashTable.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Helper/HTML.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/IComparable.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/IOFactory.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/NamedRange.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Abstract.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/CSV.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/DefaultReadFilter.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel2003XML.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel2007.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel2007/Chart.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel2007/Theme.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel5.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel5/Escher.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel5/MD5.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Excel5/RC4.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Exception.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/Gnumeric.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/HTML.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/IReadFilter.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/IReader.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/OOCalc.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Reader/SYLK.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/ReferenceHelper.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/RichText.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/RichText/ITextElement.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/RichText/Run.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/RichText/TextElement.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Settings.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/CodePage.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Date.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Drawing.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DgContainer.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DgContainer/SpgrContainer.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DgContainer/SpgrContainer/SpContainer.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DggContainer.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DggContainer/BstoreContainer.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DggContainer/BstoreContainer/BSE.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Escher/DggContainer/BstoreContainer/BSE/Blip.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Excel5.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/File.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/Font.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/CholeskyDecomposition.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/EigenvalueDecomposition.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/LUDecomposition.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/Matrix.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/QRDecomposition.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/SingularValueDecomposition.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/utils/Error.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/JAMA/utils/Maths.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLE.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLE/ChainedBlockStream.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLE/PPS.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLE/PPS/File.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLE/PPS/Root.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/OLERead.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/PCLZip/pclzip.lib.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/PasswordHasher.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/String.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/TimeZone.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/XMLWriter.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/ZipArchive.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/ZipStreamWrapper.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/bestFitClass.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/exponentialBestFitClass.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/linearBestFitClass.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/logarithmicBestFitClass.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/polynomialBestFitClass.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/powerBestFitClass.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Shared/trend/trendClass.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Alignment.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Border.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Borders.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Color.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Conditional.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Fill.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Font.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/NumberFormat.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Protection.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Style/Supervisor.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/AutoFilter.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/AutoFilter/Column.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/AutoFilter/Column/Rule.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/BaseDrawing.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/CellIterator.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Column.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/ColumnCellIterator.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/ColumnDimension.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/ColumnIterator.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Dimension.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Drawing.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Drawing/Shadow.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/HeaderFooter.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/HeaderFooterDrawing.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/MemoryDrawing.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/PageMargins.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/PageSetup.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Protection.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/Row.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/RowCellIterator.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/RowDimension.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/RowIterator.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Worksheet/SheetView.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/WorksheetIterator.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Abstract.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/CSV.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Chart.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Comments.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/ContentTypes.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/DocProps.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Drawing.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Rels.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/RelsRibbon.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/RelsVBA.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/StringTable.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Style.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Theme.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Workbook.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/Worksheet.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel2007/WriterPart.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/BIFFwriter.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Escher.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Font.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Parser.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Workbook.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Worksheet.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Excel5/Xf.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/Exception.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/HTML.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/IWriter.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Cell/Comment.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Content.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Meta.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/MetaInf.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Mimetype.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Settings.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Styles.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/Thumbnails.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/OpenDocument/WriterPart.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/PDF.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/PDF/Core.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/PDF/DomPDF.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/PDF/mPDF.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/third_party/PHPExcel/Writer/PDF/tcPDF.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/admin/home/home.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/admin/home/login.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/admin/layouts/bottom.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/admin/layouts/head.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/add.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/ajax_add.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/ajax_list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/ajax_view_list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/assign_staff.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/batch_up.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/button.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/detail.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/detail_check.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/detail_single.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/distribution.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/edit.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/export.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/exportf.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/exportm.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/imagesupload.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/import.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/importf.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/object_list_view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/recyc_staff.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/recycling.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/customer/view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/home/index.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/layouts/bottom.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/layouts/head.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/add.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/conversion.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/detail.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/edit.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/edit_format.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/format.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lead/view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/lee/export.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/login/index.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/login/modify_password.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/message/add.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/message/list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/message/view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/add.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/ajax_add.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/ajax_list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/ajax_view_list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/assign_staff.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/batch_up.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/button.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/detail.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/detail_check.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/detail_single.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/distribution.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/edit.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/export.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/exportf.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/exportm.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/imagesupload.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/import.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/importf.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/list.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/object_list_view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/recyc_staff.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/recycling.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/objects/view.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/opportunity/phase_promotion.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/announcement.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/contacts.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/expressManager.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/images.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/info.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/reviewAnnouncement.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/system.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/viewAnnouncement.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/viewContants.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/portal/viewExpressDetail.php
/Library/WebServer/Documents/truecolorpro/newpbi/application/views/www/remind/list.php
/Library/WebServer/Documents/truecolorpro/newpbi/demo.php
/Library/WebServer/Documents/truecolorpro/newpbi/index.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/Uploader.class.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/config.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/fileUp.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/getContent.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/getMovie.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/getRemoteImage.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/imageManager.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/imageUp.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/admin/js/ueditor/php/scrawlUp.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/ckeditor/samples/old/assets/posteddata.php
/Library/WebServer/Documents/truecolorpro/newpbi/style/ckeditor/samples/old/sample_posteddata.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Benchmark.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/CodeIgniter.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Common.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Config.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Controller.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Exceptions.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Hooks.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Input.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Loader.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Model.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Output.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Router.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Security.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/URI.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/core/Utf8.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_active_rec.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_cache.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/DB_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/cubrid/cubrid_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/cubrid/cubrid_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/cubrid/cubrid_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/cubrid/cubrid_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mssql/mssql_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mssql/mssql_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mssql/mssql_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mssql/mssql_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysql/mysql_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysql/mysql_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysql/mysql_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysql/mysql_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysqli/mysqli_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysqli/mysqli_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysqli/mysqli_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/mysqli/mysqli_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/oci8/oci8_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/oci8/oci8_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/oci8/oci8_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/oci8/oci8_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/odbc/odbc_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/odbc/odbc_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/odbc/odbc_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/odbc/odbc_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/pdo/pdo_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/pdo/pdo_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/pdo/pdo_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/pdo/pdo_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/postgre/postgre_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/postgre/postgre_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/postgre/postgre_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/postgre/postgre_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlite/sqlite_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlite/sqlite_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlite/sqlite_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlite/sqlite_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlsrv/sqlsrv_driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlsrv/sqlsrv_forge.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlsrv/sqlsrv_result.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/database/drivers/sqlsrv/sqlsrv_utility.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/array_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/captcha_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/cookie_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/date_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/directory_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/download_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/email_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/file_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/form_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/html_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/inflector_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/language_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/number_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/path_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/security_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/smiley_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/string_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/text_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/typography_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/url_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/helpers/xml_helper.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/calendar_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/date_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/db_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/email_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/form_validation_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/ftp_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/imglib_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/migration_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/number_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/profiler_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/unit_test_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/language/english/upload_lang.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cache/Cache.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cache/drivers/Cache_apc.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cache/drivers/Cache_dummy.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cache/drivers/Cache_file.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cache/drivers/Cache_memcached.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Calendar.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Cart.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Driver.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Email.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Encrypt.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Form_validation.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Ftp.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Image_lib.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Javascript.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Log.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Migration.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Pagination.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Parser.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Profiler.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Session.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Sha1.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Table.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Trackback.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Typography.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Unit_test.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Upload.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/User_agent.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Xmlrpc.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Xmlrpcs.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/Zip.php
/Library/WebServer/Documents/truecolorpro/newpbi/system/libraries/javascript/Jquery.php
